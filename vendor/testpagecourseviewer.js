var testpagecourseviewer =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"testpagecourseviewer": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/test/testpage-courseviewer.tsx","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./kedbackend/KED.Backend.API/schema.json":
/*!************************************************!*\
  !*** ./kedbackend/KED.Backend.API/schema.json ***!
  \************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "./kedbackend/client.js":
/*!******************************!*\
  !*** ./kedbackend/client.js ***!
  \******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "./kedbackend/clientweb.js":
/*!*********************************!*\
  !*** ./kedbackend/clientweb.js ***!
  \*********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "./kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!***************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \***************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!***********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \***********************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \***************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "./kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \***********************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "./kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "./kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
// | 'otherFlag' | 'thirdFlag';...
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.undoLink = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.undoLink(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.undoLink = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'undo-link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \*************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \***********************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!**************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \**************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                case 'undo-link':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js":
/*!**********************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js ***!
  \**********************************************************************************************/
/*! exports provided: applyMutationsOnDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyMutationsOnDeltas", function() { return applyMutationsOnDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");


function applyMutationsOnDeltas(branchId, deltas, mutations, optimistic, userDisplayName, hasAdditionalFilter) {
    var _loop_1 = function (m) {
        switch (m.op) {
            case 'add-related':
                //
                // AddRelated RepoMutation
                //
                if (!hasAdditionalFilter && m.branchId === branchId) {
                    deltas = [{
                            type: 'add',
                            sourceId: m.id,
                            targetId: m.relatedDoc.id,
                            label: m.graphProp,
                            sourceTable: m.table,
                            $meta: optimistic ? 'adding' : 'persisted',
                            dateTime: Date.now(),
                            targetName: m.relatedDoc.name,
                            contributor: userDisplayName
                        }].concat(deltas);
                }
                break;
            case 'clear-branch':
                //
                // ClearBranch RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                break;
            case 'delete':
                //
                // Delete RepoMutation
                //
                // This type of mutation can not be performed onto branches. There's no branchId property on m.
                break;
            case 'merge':
                //
                // Merge RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                else if (m.targetBranchId === branchId) {
                    // This change will append new deltas to our deltas array but we don't know what would come.
                    // Need to refetch from server.
                    if (!optimistic)
                        return { value: null }; // Caller should check for null and re-fetch data from server.
                }
                break;
            case 'remove-related':
                //
                // Remove-Related RepoMutation
                //
                if (hasAdditionalFilter || m.branchId !== branchId)
                    return "continue";
                deltas = [{
                        type: 'remove',
                        sourceId: m.id,
                        targetId: m.relatedDoc.id,
                        targetName: m.relatedDoc.name,
                        label: m.graphProp,
                        sourceTable: m.table,
                        contributor: userDisplayName,
                        dateTime: Date.now(),
                        $meta: optimistic ? 'adding' : 'persisted'
                    }].concat(deltas);
                break;
            case 'undo-link':
                //
                // Undo-Link RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (d) {
                        return (d.type === 'add' || d.type === 'remove' || d.type === 'undo-link') &&
                            d.sourceId === m.id &&
                            d.targetId === m.relatedId;
                    });
                    if (idx < 0)
                        return "continue";
                    // Found an "add" or "remove" delta to change:
                    if (optimistic) {
                        var deltaRelation = deltas[idx];
                        // Mark the existing add/remove delta as currenlty being deleted
                        deltas = deltas.slice(0, idx).concat([
                            tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaRelation, { $meta: optimistic ? 'removing' : 'persisted' })
                        ], deltas.slice(idx + 1));
                    }
                    else {
                        // Persisted. Just remove it:
                        deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                    }
                }
                break;
            case 'update':
                //
                // Update RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (delta) {
                        return delta.type === 'modify' &&
                            delta.targetId === m.id;
                    });
                    if (idx < 0 && !hasAdditionalFilter) {
                        deltas = [{
                                type: 'modify',
                                table: m.table,
                                targetId: m.id,
                                targetName: m.targetName,
                                data: m.deltaDoc,
                                dateTime: Date.now(),
                                contributors: [userDisplayName],
                                $meta: optimistic ? 'adding' : 'persisted',
                            }].concat(deltas);
                    }
                    else {
                        var existingDeltaDoc = deltas[idx];
                        var contributors = existingDeltaDoc.contributors.slice();
                        if (!contributors.includes(userDisplayName)) {
                            contributors.push(userDisplayName);
                        }
                        var newData = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_1__["mergeDeltas"])(existingDeltaDoc.data, m.deltaDoc, { removeUnsetProps: true });
                        if (!optimistic && Object.keys(newData).length === 0) {
                            // Committed mutation that resets a deltaDoc. Remove the deltaDoc entirely:
                            deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                        }
                        else {
                            // 
                            deltas = [
                                {
                                    type: 'modify',
                                    table: m.table,
                                    targetId: m.id,
                                    targetName: m.targetName,
                                    data: newData,
                                    dateTime: Date.now(),
                                    contributors: contributors,
                                    $meta: optimistic ? 'updating' : 'persisted',
                                }
                            ].concat(deltas.slice(0, idx), deltas.slice(idx + 1));
                        }
                    }
                }
                break;
        }
    };
    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {
        var m = mutations_1[_i];
        var state_1 = _loop_1(m);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return deltas;
}
//# sourceMappingURL=apply-mutations-on-deltas.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js":
/*!********************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js ***!
  \********************************************************************************/
/*! exports provided: DeltaCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCache", function() { return DeltaCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./apply-mutations-on-deltas */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js");



var DeltaCache = /** @class */ (function () {
    function DeltaCache(getClient, getUser, getUserDisplayName) {
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.lookup = {};
    }
    DeltaCache.prototype.applyMutations = function (mutations, _a) {
        var optimistic = (_a === void 0 ? { optimistic: false } : _a).optimistic;
        // Apply mutations locally onto the DeltaCache and notify their subscribers
        for (var _i = 0, _b = Object.keys(this.lookup); _i < _b.length; _i++) {
            var queryKey = _b[_i];
            var cacheEntry = this.lookup[queryKey];
            if (cacheEntry.value) {
                // Instead here: Store the mutations on cacheEntry. No matter if it yet has value or not.
                // Then apply mutation whenever subscribing! (Better handling of mutations that arrives before fetch() is done)
                // (See how I handle this in query-set.ts)
                var newValue = Object(_apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__["applyMutationsOnDeltas"])(cacheEntry.query.branchId, cacheEntry.value, mutations, optimistic, this.getUserDisplayName(), !!cacheEntry.query.tags);
                if (newValue === null) {
                    // The mutation requires cacheEntry to be refetched from server
                    if (!optimistic) {
                        // Caller has successfully performed the mutations and got success back from server.
                        // It's ok to refetch the deltas from server now:
                        cacheEntry.fetch();
                        // After fetch completes, it will notify the subscribers.
                    }
                }
                if (newValue !== cacheEntry.value) {
                    cacheEntry.optimisticValue = newValue;
                    if (!optimistic)
                        cacheEntry.value = newValue;
                    cacheEntry.notify(newValue);
                }
            }
        }
    };
    DeltaCache.prototype.subscribe = function (query, observer) {
        var _this = this;
        var cacheEntry = this.lookup[query.branchId + query.tags];
        if (!cacheEntry) {
            cacheEntry = new DeltaCacheEntry(this.getClient(), query);
            this.lookup[query.branchId + query.tags] = cacheEntry;
        }
        if (cacheEntry.cleanupTimer) {
            clearTimeout(cacheEntry.cleanupTimer);
            cacheEntry.cleanupTimer = null;
        }
        var subscription = {
            unsubscribe: function () {
                cacheEntry.subscribers = cacheEntry.subscribers.filter(function (_a) {
                    var o = _a.observer;
                    return o !== observer;
                });
                if (cacheEntry.subscribers.length === 0) {
                    cacheEntry.cleanupTimer = setTimeout(function () {
                        if (cacheEntry.subscribers.length === 0) {
                            delete _this.lookup[query.branchId + query.tags];
                        }
                    }, 100);
                }
            }
        };
        cacheEntry.subscribers.push({ observer: observer, subscription: subscription });
        if (cacheEntry.value) {
            // Value has been successfully retrieved already. Pick from cache.
            observer(cacheEntry.optimisticValue || cacheEntry.value, null, subscription);
        }
        else if (cacheEntry.isFetching) {
            // A value is on its way. Sit back and relax. All registered
            // observers (including this one) will be notified when data arrives
            // or fails.
        }
        else if (cacheEntry.error) {
            observer(null, cacheEntry.error, subscription);
        }
        else {
            cacheEntry.fetch();
        }
        return subscription;
    };
    return DeltaCache;
}());

var DeltaCacheEntry = /** @class */ (function () {
    function DeltaCacheEntry(client, query) {
        this.fetchOperationId = 0; // Makes sure a re-fetch will discard the result from any ongoing fetch.
        this.client = client;
        this.query = query;
        this.value = null;
        this.error = null;
        this.optimisticValue = null;
        this.subscribers = [];
        this.isFetching = false;
        this.cleanupTimer = null;
    }
    DeltaCacheEntry.prototype.fetch = function () {
        var _this = this;
        var fetchOperationId = ++this.fetchOperationId;
        this.isFetching = true;
        this.fetchFromServer().then(function (value) {
            // Success
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                value.sort(function (a, b) { return b.dateTime - a.dateTime; }); // Latest first
                _this.value = value;
                _this.optimisticValue = value;
                _this.notify(value);
            }
        }).catch(function (error) {
            // Fail
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                _this.error = error;
                _this.fail(error);
            }
        });
    };
    DeltaCacheEntry.prototype.fetchFromServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!this.query.branchId)
                            throw new Error('Deltas only available on branches');
                        return [4 /*yield*/, this.client.http.get('deltas', this.query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 300 || res.status < 200)) return [3 /*break*/, 3];
                        _a = _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    DeltaCacheEntry.prototype.notify = function (value) {
        for (var _i = 0, _a = this.subscribers; _i < _a.length; _i++) {
            var _b = _a[_i], observer = _b.observer, subscription = _b.subscription;
            observer(value, null, subscription);
        }
    };
    DeltaCacheEntry.prototype.fail = function (error) {
        var copy = this.subscribers.slice();
        this.subscribers = [];
        for (var _i = 0, copy_1 = copy; _i < copy_1.length; _i++) {
            var _a = copy_1[_i], observer = _a.observer, subscription = _a.subscription;
            observer(null, error, subscription);
        }
    };
    return DeltaCacheEntry;
}());
//# sourceMappingURL=delta-cache.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js":
/*!*************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js ***!
  \*************************************************************************************/
/*! exports provided: DeltaCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCollection", function() { return DeltaCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../observable */ "./kedbackend/js/dist/js/observable/index.js");


var DeltaCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DeltaCollection, _super);
    function DeltaCollection(deltaCache, query) {
        var _this = _super.call(this, function (observer) { return _this.deltaCache.subscribe(query, observer); }) || this;
        _this.deltaCache = deltaCache;
        _this.query = query;
        return _this;
    }
    DeltaCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return new DeltaCollection(this.deltaCache, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, { tags: tags }));
    };
    return DeltaCollection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Collection"]));

//# sourceMappingURL=delta-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \***************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            // Do nothing on target doc!
                            targetDoc.$wasUnset = true; // Just mark it for re-retrieval after successful posting changes.
                            break;
                        }
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
// {name: "Ulla"}, {name: {$unset:0}
// {tags: {$add: "hej"}}, {tags: {$unset:0}"}
function mergeDeltas(delta1, delta2, _a) {
    var removeUnsetProps = (_a === void 0 ? { removeUnsetProps: false } : _a).removeUnsetProps;
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            if (removeUnsetProps) {
                                delete targetDelta[key];
                            }
                            else {
                                // No matter if targetDelta is empty or has value. Set it to {$unset:0}
                                // to make sure the very end result will have {$unset:0}
                                targetDelta[key] = { $unset: 0 };
                            }
                            break;
                        }
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _b = 0, metaInstructions_2 = metaInstructions; _b < metaInstructions_2.length; _b++) {
                    var mi = metaInstructions_2[_b];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \*********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "./kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \*************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "./kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (doc, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: doc.id,
                deltaDoc: changes,
                targetName: doc.name
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.undoLink = function (id, label, relatedId) {
        if (!this.query.branchId)
            throw new Error("undo links can only be performed on branches");
        this.repo.writer.mutate([{
                op: 'undo-link',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedDoc.id ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedDoc.id; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedDoc.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedDoc.id; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!*******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \*******************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony import */ var _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-collection */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js");







var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, getUserDisplayName, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!defaultQueryOptions)
            this.defaultQueryOptions = {};
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser, getUserDisplayName);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
        this.deltas = new _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__["DeltaCollection"](this.writer.deltaCache, {
            branchId: this.defaultQueryOptions.branchId // If branchId is undefined. DeltaCollection will respond with Error on subscribe()
        });
    }
    KedBackendRepo.prototype.table = function (tableName) {
        var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](this, tableName, this.defaultQueryOptions);
        if (this.cacheOptimized)
            collection = collection.cacheOptimized();
        return collection;
    };
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, this.getUserDisplayName, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!***************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \***************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!*********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony import */ var _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-cache */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js");







var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser, getUserDisplayName) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
        this.deltaCache = new _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__["DeltaCache"](getClient, getUser, getUserDisplayName);
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        this.deltaCache.applyMutations(this.mutationQueue.get(), { optimistic: true });
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] },
                            targetName: null // We don't have the target name. But this mutation won't be visible in a DeltaCollection anyway, so it wont be used.
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        this.deltaCache.applyMutations(mutations, { optimistic: false });
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'undo-link':
                    br.undoLink(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \*************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \*********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \***********************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/collection.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/collection.js ***!
  \********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/emitter.js":
/*!*****************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/emitter.js ***!
  \*****************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/fiber-context.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/fiber-context.js ***!
  \***********************************************************/
/*! exports provided: FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return FiberContext; });
var stack = [];
var currentFiber = null;
var providers = [function () { return currentFiber; }];
function pushFiber(fiber) {
    stack.push(currentFiber);
    currentFiber = fiber;
}
function popFiber() {
    currentFiber = stack.pop();
}
var FiberContext = {
    get current() { return currentFiber; },
    /*run: function rerun<R>(fiber: Fiber, fn: ()=>R): R | Promise<R> {
      pushFiber(fiber);
      try {
        return Promise.resolve(fn());
      } catch (p) {
        if (p && typeof p.then === 'function') {
          return p.then(()=>rerun(fiber, fn));
        } else {
          return Promise.reject(p);
        }
      } finally {
        popFiber();
      }
    },*/
    addProvider: function (getCurrentFiber) {
        providers.push(getCurrentFiber);
        setCurrentGetterFromProviders();
    },
    removeProvider: function (getCurrentFiber) {
        providers = providers.filter(function (p) { return p !== getCurrentFiber; });
        setCurrentGetterFromProviders();
    }
};
function setCurrentGetterFromProviders() {
    Object.defineProperty(FiberContext, "current", {
        get: providers.reduce(function (p, c) { return function () { return p() || c(); }; }),
        set: function () { throw new Error("Use FiberContext.push() to change current fiber"); }
    });
}
//# sourceMappingURL=fiber-context.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/index.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/index.js ***!
  \***************************************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });

/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"]; });






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/map.js":
/*!*************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/map.js ***!
  \*************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/mixin.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/mixin.js ***!
  \***************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/observable.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/observable.js ***!
  \********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/value.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/value.js ***!
  \***************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");





var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.read = function () {
        var resolved = false, result, err, notify;
        var subscription = this.subscribe(function (value, error, subsciption) {
            resolved = true;
            result = value;
            err = error;
            if (error && notify)
                notify(null, error, subsciption);
            else if (notify)
                notify(value, null, subsciption);
        });
        if (resolved) {
            var currentFiber = _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"].current;
            if (!currentFiber) {
                subscription.unsubscribe();
                throw new Error("Invalid Fiber Context");
            }
            if (err) {
                subscription.unsubscribe();
                throw err;
            }
            var subscriptions = currentFiber.subscriptions, observer = currentFiber.observer;
            subscriptions.push(subscription);
            notify = observer;
            return result;
        }
        throw new Promise(function (resolve, reject) {
            notify = function (value, error, subscription) {
                subscription.unsubscribe();
                if (error)
                    reject(error);
                else
                    resolve(value);
            };
        });
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "./kedbackend/repo.js":
/*!****************************!*\
  !*** ./kedbackend/repo.js ***!
  \****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = [
    "user",
    "role",
    "school",
    "debug",
    "testVersion",
    "testversion",
    "features",
    "schoolType",
    "schooltype"
];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/buttons.tsx":
/*!******************************!*\
  !*** ./src/apis/buttons.tsx ***!
  \******************************/
/*! exports provided: DriveButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DriveButton", function() { return DriveButton; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var IconDrive = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, version: "1.1", xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 508.52 508.52", fill: "#ffffff", style: { verticalAlign: "middle", marginRight: "4px" } },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "484.492,284.58 339.024,32.577 169.496,32.577 314.996,284.58" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "145.437,74.276 0,326.279 84.764,473.05 230.169,221.143" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "234.396,316.363 143.371,475.943 423.756,475.943 508.52,316.36" })));
};
var IconClassroom = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 24 24", version: "1.1" },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("path", { d: "M5 2C3.348 2 2 3.348 2 5v14c0 1.652 1.348 3 3 3h14c1.652 0 3-1.348 3-3V5c0-1.652-1.348-3-3-3zm0 2h14c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1h-1v-2h-5v2H5c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1zm7 2a1.999 1.999 0 1 0 0 4 1.999 1.999 0 1 0 0-4zM7.5 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm9 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 11c-2.66 0-3.5 2.5-3.5 2.5 0-.848.5-1.5.5-1.5-.3-.188-1.07-.313-1.438-.313-1.214 0-2.562 1.192-2.562 2V16h14v-2.313c0-.808-1.512-2-2.563-2-.367 0-1.136.126-1.437.313 0 0 .5.652.5 1.5 0 0-.84-2.5-3.5-2.5z" })));
};
var DriveButton = function (_a) {
    var _b = _a.label, label = _b === void 0 ? 'Google Drive' : _b, action = _a.action;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a", { className: "btn", onClick: action },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(IconDrive, { size: 16 }),
        " ",
        label);
};


/***/ }),

/***/ "./src/apis/configs.ts":
/*!*****************************!*\
  !*** ./src/apis/configs.ts ***!
  \*****************************/
/*! exports provided: WebClientId, TemplatesFileId */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebClientId", function() { return WebClientId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TemplatesFileId", function() { return TemplatesFileId; });
// Client id for GoogleWebClient
var WebClientId = "421572262269-u68v5lf5o8ss5t68l8gkq3pfarh6dbkv.apps.googleusercontent.com";
// Google Drive File Id to json file with Tamplates for Course Builder (Classroom)
var TemplatesFileId = 'https://docs.google.com/document/d/1V7exG6vN83Sq8kb6uz1B6DaZDVO9eLcJbP7XF0vL4dY/export?format=txt';


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json");
var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json", 1);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/make-suspense-api */ "./src/utils/make-suspense-api.ts");









var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        var _this = this;
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        var isApiMethod = function (m) {
            return typeof _this[m] === 'function' &&
                m !== 'constructor' && // Since makeSuspenseApi() walks prototype chain
                m !== 'privatizingCacheBust' &&
                m !== 'userEmailGetter';
        } // List non-API methods here...
        ;
        Object.keys(EdsClient.prototype).forEach(function (method) {
            if (isApiMethod(method)) {
                _this[method] = avoidSimultanousCalls(_this[method]);
            }
        });
        this.suspense = Object(_utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__["makeSuspenseApi"])(this, { isApiMethod: isApiMethod });
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    /**
     * getSchoolTuitionGroups()
     *
     * Return tuitiongroups for school
     *
     * @param schoolName - name of school
     * @param courseCode - Skolverkets code for course
     */
    EdsClient.prototype.getSchoolTuitionGroups = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTuitionGroups", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTuitionGroups];
                }
            });
        });
    };
    /**
     * getTuitionGroupStudents()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     * @param tuitionGroupName - tuition gruop name in EDS
     */
    EdsClient.prototype.getTuitionGroupStudents = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("TuitionGroupStudents", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.tuitionGroupStudents];
                }
            });
        });
    };
    /**
     * getSchoolTeachers()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     */
    EdsClient.prototype.getSchoolTeachers = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTeachers", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTeachers];
                }
            });
        });
    };
    // we assume that the EDS will return the current academic year dates determined by the current date
    EdsClient.prototype.getAcademicYearTerms = function (schoolLocale, date) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var holidays, firstTermMoment, secondTermMoment, startFirstTermDate, startSecondTermDate, endFirstTermDate, endSecondTermDate, firstTerm, secondTerm;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                // mock data
                switch (schoolLocale) {
                    case 'en_sin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.SouthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'en_nin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.NorthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'sv':
                        {
                            holidays = [];
                            firstTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, true);
                            secondTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, false);
                            startFirstTermDate = firstTermMoment[0];
                            startSecondTermDate = secondTermMoment[0];
                            endFirstTermDate = firstTermMoment[1];
                            endSecondTermDate = secondTermMoment[1];
                            firstTerm = { startDate: new Date(startFirstTermDate.year(), startFirstTermDate.month(), startFirstTermDate.date()).toDateString(), endDate: new Date(startFirstTermDate.year(), endFirstTermDate.month(), endFirstTermDate.date()).toDateString() };
                            secondTerm = { startDate: new Date(startSecondTermDate.year(), startSecondTermDate.month(), startSecondTermDate.date()).toDateString(), endDate: new Date(startSecondTermDate.year(), endSecondTermDate.month(), endSecondTermDate.date()).toDateString() };
                            return [2 /*return*/, { firstTerm: firstTerm, secondTerm: secondTerm, holidays: holidays }];
                        }
                }
                return [2 /*return*/];
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/apis/google-client.ts":
/*!***********************************!*\
  !*** ./src/apis/google-client.ts ***!
  \***********************************/
/*! exports provided: GoogleClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleClient", function() { return GoogleClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


var GoogleClient = /** @class */ (function () {
    function GoogleClient(discoveryDocs) {
        this.googleTokenProvider = _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["env"].googleTokenProvider;
        this.discoveryDocs = [];
        this.discoveryDocs.push(discoveryDocs);
    }
    GoogleClient.prototype.setBearerProvider = function (googleTokenProvider) {
        this.googleTokenProvider = googleTokenProvider;
    };
    GoogleClient.prototype.ensureInited = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var tokenResult;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(typeof gapi === 'undefined')) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadGapi()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        if (!(!this.tokenExpiration || this.tokenExpiration < new Date())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.googleTokenProvider.getBearer()];
                    case 3:
                        tokenResult = _a.sent();
                        this.tokenExpiration = new Date(tokenResult.expires);
                        this.token = tokenResult.token;
                        gapi.client.setToken({
                            access_token: tokenResult.token
                        });
                        _a.label = 4;
                    case 4: 
                    // Load all discovyerDocs
                    return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: this.discoveryDocs
                        })];
                    case 5:
                        // Load all discovyerDocs
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    GoogleClient.prototype.loadGapi = function () {
        return new Promise(function (resolve) {
            if (typeof gapi !== 'undefined')
                return resolve();
            var script = document.createElement('script');
            script.src = "https://apis.google.com/js/client.js?onload=gaapi_loaded";
            document.getElementsByTagName("head")[0].appendChild(script);
            window.gaapi_loaded = resolve;
        });
    };
    return GoogleClient;
}());



/***/ }),

/***/ "./src/apis/google-drive.ts":
/*!**********************************!*\
  !*** ./src/apis/google-drive.ts ***!
  \**********************************/
/*! exports provided: GoogleDrive */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleDrive", function() { return GoogleDrive; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _google_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-client */ "./src/apis/google-client.ts");


var GoogleDrive = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoogleDrive, _super);
    function GoogleDrive() {
        return _super.call(this, 'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest') || this;
    }
    GoogleDrive.prototype.getFile = function (fileId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, gapi.client.drive.files.get({
                                fileId: fileId,
                                supportsAllDrives: true,
                                fields: 'id,name,mimeType,webViewLink,iconLink,modifiedTime,thumbnailLink'
                            }).then(function (resp) {
                                if (resp.result.name) {
                                    var file = resp.result;
                                    return { fileId: file.id, url: file.webViewLink, mimeType: file.mimeType, name: file.name, modiifiedTime: file.modifiedTime, iconUrl: file.iconLink, thumbnailUrl: file.thumbnailLink };
                                }
                                return false;
                            })];
                }
            });
        });
    };
    /**
     * updatePermissions()
     *
     * @param fileId
     *
     * Make the file accessible to all in the domain. Should be unnecessary but some
     * teachers have changed their default permissions.
     * We don't care right now if this fails because this is just an extra precaution.
     * If we plan on using this on other domains the domain-attribute needs to be dynamic.
     *
     */
    GoogleDrive.prototype.updatePermissions = function (fileId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        console.log('updating permissions');
                        return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        gapi.client.drive.permissions.create({
                            fileId: fileId,
                            sendNotificationEmail: false,
                            role: 'reader',
                            type: 'anyone',
                            // type: 'domain', 
                            // domain: 'kunskapsskolan.se'
                            supportsAllDrives: true
                        }).then(function (resp) { return console.log(resp); });
                        return [2 /*return*/];
                }
            });
        });
    };
    GoogleDrive.prototype.createFolder = function (name, parent) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        console.log('Creating folder ' + name);
                        return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, gapi.client.drive.files.create({
                                name: name,
                                mimeType: 'application/vnd.google-apps.folder',
                                parents: [parent]
                            }).then(function (resp) { return resp.result; })];
                }
            });
        });
    };
    GoogleDrive.prototype.getIdForFolderPath = function (path) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var parent, path_1, path_1_1, folder, folderId, newFolder, e_1_1;
            var e_1, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        console.log('Getting id for ' + path.join('/'));
                        return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _b.sent();
                        parent = 'root';
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, 9, 10, 11]);
                        path_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](path), path_1_1 = path_1.next();
                        _b.label = 3;
                    case 3:
                        if (!!path_1_1.done) return [3 /*break*/, 8];
                        folder = path_1_1.value;
                        return [4 /*yield*/, this.getIdForFolder(folder, parent)];
                    case 4:
                        folderId = _b.sent();
                        if (!folderId) return [3 /*break*/, 5];
                        parent = folderId;
                        return [3 /*break*/, 7];
                    case 5: return [4 /*yield*/, this.createFolder(folder, parent)];
                    case 6:
                        newFolder = _b.sent();
                        parent = newFolder.id;
                        _b.label = 7;
                    case 7:
                        path_1_1 = path_1.next();
                        return [3 /*break*/, 3];
                    case 8: return [3 /*break*/, 11];
                    case 9:
                        e_1_1 = _b.sent();
                        e_1 = { error: e_1_1 };
                        return [3 /*break*/, 11];
                    case 10:
                        try {
                            if (path_1_1 && !path_1_1.done && (_a = path_1.return)) _a.call(path_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                        return [7 /*endfinally*/];
                    case 11: return [2 /*return*/, parent];
                }
            });
        });
    };
    GoogleDrive.prototype.getIdForFolder = function (name, parent) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        console.log('Getting id for ' + name);
                        return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, gapi.client.drive.files.list({
                                corpora: 'user',
                                q: "'" + parent + "' in parents and mimeType = 'application/vnd.google-apps.folder' and name = '" + name + "'"
                            }).then(function (resp) {
                                if (resp.result.files.length) {
                                    return resp.result.files[0].id;
                                }
                                else {
                                    return false;
                                }
                            })];
                }
            });
        });
    };
    GoogleDrive.prototype.copyFile = function (file, destination) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var parent_1, parent_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        console.log('Copying file: ' + file.name);
                        return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        if (!destination) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.getIdForFolderPath(destination)];
                    case 2:
                        parent_1 = _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        parent_2 = 'root';
                        _a.label = 4;
                    case 4: return [2 /*return*/, gapi.client.drive.files.copy({
                            fileId: file.id,
                            supportsAllDrives: true,
                            parents: [parent],
                            name: file.name,
                            fields: 'id,name,mimeType,webViewLink,iconLink,modifiedTime,thumbnailLink'
                        }).then(function (resp) { return resp.result; })];
                }
            });
        });
    };
    /**
     * downloadFile()
     * @param file
     *
     * When Classroom has been integrated we will want to handle only the fileId:s
     * so that editing capabilities are peserved on the file (if it is a google-apps file)
     * Right now google-apps files are converted to pdf and passed into the current flow.
     *
     * TODO: error handling
     */
    GoogleDrive.prototype.downloadFile = function (_a) {
        var file = _a.file, limitSize = _a.limitSize;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var xhrDownload_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: 
                    // A file that can be exported to PDF is retreived with
                    // file.export() from Drive, converted to a blob and then
                    // to a File.
                    // A file that can not be exported to PDF is retrieved
                    // through XHR and converted to a File.
                    // If we don't need to handle the physical files on the client
                    // we could save only the fileId:s and display filename and mimeType
                    // for the file in our listings. When/if we use Google Classroom for
                    // our task-handling that would be the preferred approach to keep
                    // the file as an editable Google file
                    // Init the drive-api (only needed for download so not loaded initially)
                    return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        // A file that can be exported to PDF is retreived with
                        // file.export() from Drive, converted to a blob and then
                        // to a File.
                        // A file that can not be exported to PDF is retrieved
                        // through XHR and converted to a File.
                        // If we don't need to handle the physical files on the client
                        // we could save only the fileId:s and display filename and mimeType
                        // for the file in our listings. When/if we use Google Classroom for
                        // our task-handling that would be the preferred approach to keep
                        // the file as an editable Google file
                        // Init the drive-api (only needed for download so not loaded initially)
                        _b.sent();
                        if (file.canExport) {
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    gapi.client.drive.files.export({
                                        fileId: file.fileId,
                                        mimeType: 'application/pdf'
                                    }).then(function (resp) {
                                        var len = resp.body.length;
                                        var data = new Uint8Array(new ArrayBuffer(len));
                                        for (var i = 0; i < len; i++) {
                                            data[i] = resp.body.charCodeAt(i);
                                        }
                                        var blob = new Blob([data], { type: 'application/pdf' });
                                        var filename = file.name + '.pdf';
                                        resolve(new File([blob], filename, { type: 'application/pdf', lastModified: file.modifiedTime }));
                                    });
                                })];
                        }
                        else {
                            xhrDownload_1 = function (file) {
                                return new Promise(function (resolve, reject) {
                                    var xhr = new XMLHttpRequest();
                                    xhr.open("GET", "https://www.googleapis.com/drive/v3/files/" + file.fileId + '?alt=media', true);
                                    xhr.setRequestHeader('Authorization', 'Bearer ' + _this.token);
                                    xhr.responseType = 'blob';
                                    xhr.onload = function () {
                                        resolve(new File([xhr.response], file.name, { type: file.mimeType, lastModified: file.modifiedTime }));
                                    };
                                    xhr.send();
                                });
                            };
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    if (limitSize !== undefined) {
                                        gapi.client.drive.files.get({
                                            fileId: file.fileId,
                                            fields: 'size'
                                        }).then(function (resp) {
                                            var size = Number(resp.result.size);
                                            if (size > limitSize * 1024 * 1024) {
                                                reject('GooglePickerError: Filsize is too laarge');
                                            }
                                        }).then(function () {
                                            xhrDownload_1(file).then(function (resp) {
                                                resolve(resp);
                                            });
                                        });
                                    }
                                    else {
                                        xhrDownload_1(file).then(function (resp) {
                                            resolve(resp);
                                        });
                                    }
                                })];
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    return GoogleDrive;
}(_google_client__WEBPACK_IMPORTED_MODULE_1__["GoogleClient"]));



/***/ }),

/***/ "./src/apis/google-picker.ts":
/*!***********************************!*\
  !*** ./src/apis/google-picker.ts ***!
  \***********************************/
/*! exports provided: GooglePicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GooglePicker", function() { return GooglePicker; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _google_webclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-webclient */ "./src/apis/google-webclient.ts");
/* harmony import */ var _google_drive__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./google-drive */ "./src/apis/google-drive.ts");



var mimeTypeCollections = {
    'google-apps': 'application/vnd.google-apps.document,application/vnd.google-apps.presentation,application/vnd.google-apps.spreadsheet',
    'pdf': 'application/pdf'
};
/**
 * GooglePicker
 * Includes the initiation of the correct api:s.
 * Certain options can be passed to the constructor
 * and there could be others worth incorporating (i.e. Team Drive-support).
 *
 * Right now two options are handled:
 * - upload: if a user can upload to Drive in the Google Drive Picker
 * - multiple: if a user can select multiple files
 * - limitType: active limits to certain mimeTypesCollections
 *
 * We could probably split this into google-picker and google-drive where google-drive
 * handles the explicit calls to the google drive api.
 */
var GooglePicker = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GooglePicker, _super);
    function GooglePicker(options) {
        var _this = _super.call(this, ['https://www.googleapis.com/auth/drive']) || this;
        _this.options = { upload: false, multiple: false, limitType: false };
        Object.assign(_this.options, options);
        console.log(_this.options);
        _this.drive = new _google_drive__WEBPACK_IMPORTED_MODULE_2__["GoogleDrive"]();
        return _this;
    }
    /**
     * show()
     *
     * If a single file is requested from the picker a list of files with one element is returned.
     * It is up to the caller to handle the list in a relevant manner.
     *
     * More data from the file could be extracted if it is deemed necessary.
     *
     */
    GooglePicker.prototype.show = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, new Promise(function (resolve, reject) {
                                var callback = function (response) {
                                    if (response['action'] == google.picker.Action.CANCEL) {
                                        reject();
                                    }
                                    else if (response['action'] == google.picker.Action.PICKED) {
                                        var selected_1 = [];
                                        response.docs.map(function (doc) {
                                            var fileId = doc.id, mimeType = doc.mimeType, name = doc.name, modifiedTime = doc.modifiedTime, iconUrl = doc.iconUrl, url = doc.url;
                                            var canExport = mimeType.includes('google-apps');
                                            selected_1.push({ fileId: fileId, mimeType: mimeType, name: name, modifiedTime: modifiedTime, canExport: canExport, iconUrl: iconUrl, url: url });
                                            // update permissions to read by all in domain
                                            _this.drive.updatePermissions(fileId);
                                        });
                                        console.log(selected_1);
                                        resolve(selected_1);
                                    }
                                };
                                var pickerbuilder = new google.picker.PickerBuilder()
                                    .enableFeature(google.picker.Feature.SUPPORT_DRIVES)
                                    .enableFeature(google.picker.Feature.SUPPORT_TEAM_DRIVES)
                                    .addView(new google.picker.DocsView()
                                    .setOwnedByMe(true) // should this be an option?
                                    .setIncludeFolders(true))
                                    .addView(new google.picker.DocsView()
                                    .setIncludeFolders(true)
                                    .setEnableTeamDrives(true))
                                    .setLocale("sv") // should this be an option?
                                    .setSize(1051, 650) // should this be an option?
                                    .setOAuthToken(_this.authToken)
                                    .setCallback(callback);
                                if (_this.options.upload) {
                                    pickerbuilder.addView(new google.picker.DocsUploadView().setIncludeFolders(true));
                                }
                                if (_this.options.multiple) {
                                    pickerbuilder.enableFeature(google.picker.Feature.MULTISELECT_ENABLED);
                                }
                                if (_this.options.limitType) {
                                    var mimeTypes = mimeTypeCollections[_this.options.limitType];
                                    console.log(mimeTypes);
                                    pickerbuilder.setSelectableMimeTypes(mimeTypes);
                                }
                                _this.picker = pickerbuilder.build();
                                _this.picker.setVisible(true);
                            })];
                }
            });
        });
    };
    return GooglePicker;
}(_google_webclient__WEBPACK_IMPORTED_MODULE_1__["GoogleWebClient"]));



/***/ }),

/***/ "./src/apis/google-webclient.ts":
/*!**************************************!*\
  !*** ./src/apis/google-webclient.ts ***!
  \**************************************/
/*! exports provided: GoogleWebClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleWebClient", function() { return GoogleWebClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _configs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./configs */ "./src/apis/configs.ts");



var GoogleWebClient = /** @class */ (function () {
    function GoogleWebClient(scopes) {
        var _a;
        this.scopes = ['https://www.googleapis.com/auth/userinfo.email', 'https://www.googleapis.com/auth/userinfo.profile'];
        (_a = this.scopes).push.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](scopes));
    }
    GoogleWebClient.prototype.ensureInited = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var SCOPES;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(typeof gapi === "undefined")) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadGapi()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        SCOPES = this.scopes.join(' ');
                        return [4 /*yield*/, new Promise(function (resolve, reject) {
                                gapi.load("client:auth2", function () {
                                    // Calls authorize without prompting the user. If authorization hasn't been given by
                                    // the user an error is returned and we call authorize again with consent-screen
                                    var reauthorize = false;
                                    return gapi.auth2.authorize({
                                        client_id: _configs__WEBPACK_IMPORTED_MODULE_2__["WebClientId"],
                                        scope: SCOPES,
                                        response_type: 'permission',
                                        login_hint: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.mail,
                                        prompt: 'none'
                                    }, function (resp) {
                                        console.log(resp);
                                        if (resp.error) {
                                            // no consent given so reauthorize
                                            reauthorize = true;
                                        }
                                        else {
                                            // check if we have all the scopes we want
                                            var scopeset_1 = new Set(resp.scope.split(' '));
                                            var missingScopes = _this.scopes.filter(function (x) { return !scopeset_1.has(x); });
                                            if (missingScopes.length > 0) {
                                                console.log('missing scopes');
                                                // scopes are missing from our consent so reauthorize
                                                reauthorize = true;
                                            }
                                            else {
                                                // everything seems to be ok so store our token
                                                _this.authToken = resp.access_token;
                                                resolve();
                                            }
                                        }
                                        if (reauthorize) {
                                            console.log('reauthorize');
                                            return gapi.auth2.authorize({
                                                client_id: _configs__WEBPACK_IMPORTED_MODULE_2__["WebClientId"],
                                                scope: SCOPES,
                                                response_type: 'permission',
                                                login_hint: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.mail,
                                                prompt: 'consent'
                                            }, function (resp) {
                                                console.log(resp);
                                                if (resp.error) {
                                                    // something is still wrong so throw an error
                                                    reject('Google Web Client: No access token');
                                                }
                                                else {
                                                    // we now have a token (hopefully with the right scopes)
                                                    // should we check again?
                                                    _this.authToken = resp.access_token;
                                                    resolve();
                                                }
                                            });
                                        }
                                        if (resp.expires_in < 500) {
                                            return gapi.auth2.authorize({
                                                client_id: _configs__WEBPACK_IMPORTED_MODULE_2__["WebClientId"],
                                                scope: SCOPES,
                                                response_type: 'permission',
                                                login_hint: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.mail,
                                                prompt: 'none'
                                            }, function (resp) {
                                                _this.authToken = resp.access_token;
                                                resolve();
                                            });
                                        }
                                    });
                                });
                            })];
                    case 3:
                        _a.sent();
                        if (!(typeof google === "undefined" || typeof google.picker === "undefined")) return [3 /*break*/, 5];
                        return [4 /*yield*/, new Promise(function (resolve) {
                                gapi.load("picker", function () { resolve(); });
                            })];
                    case 4:
                        _a.sent();
                        _a.label = 5;
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    GoogleWebClient.prototype.loadGapi = function () {
        return new Promise(function (resolve, reject) {
            if (typeof gapi !== "undefined")
                return resolve();
            var script = document.createElement("script");
            script.src = "https://apis.google.com/js/client.js?onload=gaapi_loaded";
            document.getElementsByTagName("head")[0].appendChild(script);
            window.gaapi_loaded = resolve;
        });
    };
    return GoogleWebClient;
}());



/***/ }),

/***/ "./src/apis/mock/mock-eds-data.json":
/*!******************************************!*\
  !*** ./src/apis/mock/mock-eds-data.json ***!
  \******************************************/
/*! exports provided: SouthIndia, NorthIndia, default */
/***/ (function(module) {

module.exports = {"SouthIndia":[{"firstTerm":{"startDate":"2015-06-01T00:00:00.000Z","endDate":"2015-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2015-11-01T00:00:00.000Z","endDate":"2016-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-06-23T00:00:00.000Z","endDate":"2016-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2016-11-01T00:00:00.000Z","endDate":"2017-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-06-05T00:00:00.000Z","endDate":"2017-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2017-11-01T00:00:00.000Z","endDate":"2018-03-30T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2018-06-04T00:00:00.000Z","endDate":"2018-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2018-11-01T00:00:00.000Z","endDate":"2019-04-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2019-06-03T00:00:00.000Z","endDate":"2019-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2019-11-01T00:00:00.000Z","endDate":"2020-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-06-01T00:00:00.000Z","endDate":"2020-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2020-11-01T00:00:00.000Z","endDate":"2021-03-26T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-06-06T00:00:00.000Z","endDate":"2021-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2021-11-01T00:00:00.000Z","endDate":"2022-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-06-05T00:00:00.000Z","endDate":"2022-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2022-11-01T00:00:00.000Z","endDate":"2023-03-31T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-06-04T00:00:00.000Z","endDate":"2023-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2023-11-01T00:00:00.000Z","endDate":"2024-03-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2024-06-03T00:00:00.000Z","endDate":"2024-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2024-11-01T00:00:00.000Z","endDate":"2025-03-28T00:00:00.000Z"},"holidays":[]}],"NorthIndia":[{"firstTerm":{"startDate":"2024-04-03T00:00:00.000Z","endDate":"2024-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2024-10-01T00:00:00.000Z","endDate":"2025-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-04-05T00:00:00.000Z","endDate":"2023-10-01T00:00:00.000Z"},"secondTerm":{"startDate":"2023-10-02T00:00:00.000Z","endDate":"2024-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-04-06T00:00:00.000Z","endDate":"2022-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2022-10-04T00:00:00.000Z","endDate":"2023-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-04-01T00:00:00.000Z","endDate":"2021-10-04T00:00:00.000Z"},"secondTerm":{"startDate":"2021-10-05T00:00:00.000Z","endDate":"2022-04-05T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-04-01T00:00:00.000Z","endDate":"2020-09-28T00:00:00.000Z"},"secondTerm":{"startDate":"2020-09-29T00:00:00.000Z","endDate":"2021-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2020-05-17","endDate":"2020-06-28"}]},{"firstTerm":{"startDate":"2019-04-04T00:00:00.000Z","endDate":"2019-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2019-10-01T00:00:00.000Z","endDate":"2020-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2019-05-19","endDate":"2019-06-29"}]},{"firstTerm":{"startDate":"2018-04-04T00:00:00.000Z","endDate":"2018-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2018-10-01T00:00:00.000Z","endDate":"2019-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-04-05T00:00:00.000Z","endDate":"2017-10-02T00:00:00.000Z"},"secondTerm":{"startDate":"2017-10-03T00:00:00.000Z","endDate":"2018-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-04-06T00:00:00.000Z","endDate":"2016-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2016-10-04T00:00:00.000Z","endDate":"2017-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2015-04-01T00:00:00.000Z","endDate":"2015-10-05T00:00:00.000Z"},"secondTerm":{"startDate":"2015-10-06T00:00:00.000Z","endDate":"2016-04-05T00:00:00.000Z"},"holidays":[]}]};

/***/ }),

/***/ "./src/components/calendar/course-name-to-css-class.ts":
/*!*************************************************************!*\
  !*** ./src/components/calendar/course-name-to-css-class.ts ***!
  \*************************************************************/
/*! exports provided: courseNameToCssClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "courseNameToCssClass", function() { return courseNameToCssClass; });
function courseNameToCssClass(cssPrefix, courseName) {
    return "" + cssPrefix + courseName.substr(0, 3).toLowerCase();
}


/***/ }),

/***/ "./src/components/charts/charts-utils.ts":
/*!***********************************************!*\
  !*** ./src/components/charts/charts-utils.ts ***!
  \***********************************************/
/*! exports provided: getWeekplannerProgressData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getWeekplannerProgressData", function() { return getWeekplannerProgressData; });
function getWeekplannerProgressData(taskSets) {
    var chartTasks = { completedTasks: 0, totalNumberOfTasks: 0, subjectData: {} };
    taskSets.forEach(function (elem) { return elem.learningGoals.forEach(function (x) {
        var subjectCompletedTasks = x.tasks.filter(function (t) { return t.done; }).length;
        var courseSubjectData = chartTasks.subjectData[elem.courseName];
        if (!courseSubjectData) {
            courseSubjectData = chartTasks.subjectData[elem.courseName] = {
                completedNumberOfTasks: 0,
                numberOfTasks: 0
            };
        }
        courseSubjectData.completedNumberOfTasks += subjectCompletedTasks;
        courseSubjectData.numberOfTasks += x.tasks.length;
        chartTasks.completedTasks += subjectCompletedTasks;
        chartTasks.totalNumberOfTasks += x.tasks.length;
    }); });
    return chartTasks;
}


/***/ }),

/***/ "./src/components/charts/goal-progress.tsx":
/*!*************************************************!*\
  !*** ./src/components/charts/goal-progress.tsx ***!
  \*************************************************/
/*! exports provided: GoalProgress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoalProgress", function() { return GoalProgress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var GoalProgress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoalProgress, _super);
    function GoalProgress() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.createProgress = function () {
            var _a = _this.props, numberOfTasks = _a.numberOfTasks, completedNumberOfTasks = _a.completedNumberOfTasks, maximumTasksDisplayed = _a.maximumTasksDisplayed, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
            var progress = [];
            if (numberOfTasks > maximumTasksDisplayed) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progress-overview" },
                    " ",
                    completedNumberOfTasks,
                    " / ",
                    numberOfTasks,
                    " ");
            }
            for (var taskNo = 1; taskNo <= numberOfTasks; taskNo++) {
                progress.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { key: taskNo },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", fill: taskNo > completedNumberOfTasks ? backgroundColor : progressColor, cx: "8", cy: "8", r: "8" })));
            }
            return progress;
        };
        return _this;
    }
    GoalProgress.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "goals-progress" }, this.createProgress());
    };
    GoalProgress.defaultProps = {
        numberofTasks: 0,
        completedNumberOfTasks: 0,
        maximumTasksDisplayed: 10,
        backgroundColor: "lightgrey",
        progressColor: "#3dbca2",
    };
    return GoalProgress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/charts/progress.tsx":
/*!********************************************!*\
  !*** ./src/components/charts/progress.tsx ***!
  \********************************************/
/*! exports provided: Progress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Progress", function() { return Progress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var Progress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.render = function () {
        var _a = this.props, percentage = _a.percentage, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
        var roundedPercentage = Math.round(percentage);
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { className: "progress-chart", width: "100%", height: "25" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { fill: backgroundColor, width: "100%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { className: "fill", fill: progressColor, width: roundedPercentage + "%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("text", { className: "filled-text", textAnchor: "middle", x: "50%", y: "50%", dy: ".3em" }, roundedPercentage + "%")));
    };
    Progress.defaultProps = {
        percentage: 0,
        backgroundColor: "#F1F5F4",
        progressColor: "#3dbca2",
    };
    return Progress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder-ks/logic/is-employee.ts":
/*!***************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/is-employee.ts ***!
  \***************************************************************/
/*! exports provided: isEmployee */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isEmployee", function() { return isEmployee; });
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");


function isEmployee(atSchool) {
    return atSchool ?
        Object(_access_control__WEBPACK_IMPORTED_MODULE_1__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser, atSchool) || _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.includes("ADMIN") :
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
}


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, getEmailFromDocAccess, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse, hasChanges */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEmailFromDocAccess", function() { return getEmailFromDocAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasChanges", function() { return hasChanges; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added)), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = (e_3 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed)), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = (e_4 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated)), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: now },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function getEmailFromDocAccess(resource) {
    if (resource.email)
        return resource.email;
    return resource.url ?
        resource.url.startsWith('mailto:') ?
            resource.url.substring('mailto:'.length) :
            resource.url :
        resource.url;
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}
// Check differences between two array of type T
function hasChanges(originalValues, currentValues) {
    return originalValues === undefined || currentValues.filter(function (x) { return !originalValues.includes(x); }).length > 0 || originalValues.filter(function (x) { return !currentValues.includes(x); }).length > 0;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-banner.tsx":
/*!********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-banner.tsx ***!
  \********************************************************************/
/*! exports provided: CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var CourseBanner = function (props) {
    var title = props.title, backgroundImage = props.backgroundImage, tabs = props.tabs, activeTab = props.activeTab;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pageHeader" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("ul", null, tabs.map(function (_a, idx) {
                                    var name = _a.name, key = _a.key, link = _a.link;
                                    var isActive = activeTab === link;
                                    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("li", { key: key || (typeof name === 'string' ? name : idx), className: isActive ? "activePage" : "" },
                                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: link }, name));
                                })))))))));
};


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-module-page.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-module-page.tsx ***!
  \*************************************************************************/
/*! exports provided: CourseModulePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModulePage", function() { return CourseModulePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/get-included-ids */ "./src/components/course-viewer/utils/get-included-ids.ts");
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../subcomponents/learning-goals-list */ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx");
/* harmony import */ var _subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../subcomponents/task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");










var CourseModulePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModulePage, _super);
    function CourseModulePage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    CourseModulePage.prototype.render = function () {
        var _a = this.props, module = _a.module, course = _a.course;
        var incluedIds = Object(_utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__["default"])(module, course);
        var learningTasks = module.taskIds
            .map(function (id) { return course.tasks.find(function (t) { return t.id === id; }); })
            .filter(function (task) { return !!task; })
            .map(function (task) { return ({
            id: task.id,
            task: Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task),
            course: course,
            name: task.name,
            url: "#" + encodeURIComponent(module.name.trim()) + "/" + task.id,
            courseName: course.name,
            learningGoal: task.learningGoal || module.name,
        }); });
        var assignmentTasks = learningTasks.filter(function (t) { return t.task && t.task.assignment; });
        var nonAssignmentTasks = learningTasks.filter(function (t) { return !t.task || !t.task.assignment; });
        var commonTasks = nonAssignmentTasks.filter(function (t) { return !t.task.learningGoal; });
        var learningGoals = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(nonAssignmentTasks.filter(function (t) { return !!t.task.learningGoal; }), function (t) { return t.learningGoal; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, module.name))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: module.mandatoryContent } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Modulens kunskapskrav, f\u00F6rm\u00E5gor och centrala inneh\u00E5ll"),
                    (!!module.startWeek || !!module.endWeek) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "week-period-div" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Startvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.startWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Slutvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.endWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__["KnowledgeRequirementsBox"], { title: "I den h\u00E4r modulen bed\u00F6ms f\u00F6ljande kunskapskrav", requirements: course.knowledgeRequirements, includedIds: incluedIds }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__["AbilitiesBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande f\u00F6rm\u00E5gor", abilities: course.abilities.filter(function (a) { return incluedIds[a.id]; }) }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__["CentralContentBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande centrala inneh\u00E5ll", centralContent: course.centralContent.filter(function (c) { return incluedIds[c.id]; }) }))),
            module.taskIds.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    assignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__["TaskList"], { learningTasks: assignmentTasks })),
                    nonAssignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__["LearningGoalsList"], { commonTasks: commonTasks, learningGoals: Object.keys(learningGoals).map(function (learningGoal) { return ({
                                name: learningGoal,
                                learningTasks: learningGoals[learningGoal]
                            }); }) })))),
            module.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, module.resources.map(function (r, idx) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                    })))));
    };
    return CourseModulePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/get-customized-task.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/get-customized-task.ts ***!
  \*************************************************************************/
/*! exports provided: getCustomizedTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCustomizedTask", function() { return getCustomizedTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function getCustomizedTask(module, task) {
    return module.taskCustomizations ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, module.taskCustomizations[task.id]) :
        task;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/index.tsx":
/*!************************************************************!*\
  !*** ./src/components/course-viewer/course-page/index.tsx ***!
  \************************************************************/
/*! exports provided: CoursePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CoursePage", function() { return CoursePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _course_module_page__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./course-module-page */ "./src/components/course-viewer/course-page/course-module-page.tsx");
/* harmony import */ var _run_up_page__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./run-up-page */ "./src/components/course-viewer/course-page/run-up-page.tsx");
/* harmony import */ var _utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/manual-scroll-restoration */ "./src/components/course-viewer/utils/manual-scroll-restoration.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../weekplanner */ "./src/components/weekplanner/index.ts");
/* harmony import */ var _task_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./task-page */ "./src/components/course-viewer/course-page/task-page.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");











Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["initManualScrollRestoration"])();
var CoursePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CoursePage, _super);
    function CoursePage(props) {
        var _this = _super.call(this, props) || this;
        _this.onHashChange = _this.onHashChange.bind(_this);
        var _a = _this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        _this.state = {
            module: module,
            task: task
        };
        return _this;
    }
    CoursePage.prototype.getModuleAndTaskFromHash = function () {
        var split = (location.hash.substr(1) || "").split('/');
        if (split.length > 0 && !split[0])
            split = split.slice(1); // Allow leading slash #/module/task
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](split.map(function (part) { return decodeURIComponent(part); }), 2), moduleName = _a[0], taskId = _a[1];
        var module = this.props.course.modules
            .filter(function (m) { return (m.name || "")
            .trim().toLowerCase() === (moduleName || "").trim().toLowerCase(); })[0] || null;
        var task = taskId ?
            this.props.course.tasks.find(function (t) { return t.id === taskId; }) || null :
            null;
        if (task && !module) {
            // Resolve module by finding the module that holds the task:
            module = this.getOrderedModules()
                .filter(function (m) { return m.taskIds
                .some(function (taskId) { return task.id === taskId; }); })[0];
        }
        if (task && module) {
            task = Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task);
        }
        return { module: module, task: task };
    };
    CoursePage.prototype.componentDidMount = function () {
        window.addEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.componentWillUnmount = function () {
        window.removeEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.onHashChange = function () {
        var _a = this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        this.setState({
            module: module,
            task: task
        }, function () {
            var fallbackScrollPosition = undefined;
            if (task) {
                var taskAnchor = document.getElementById('ked-task-anchor');
                if (taskAnchor)
                    fallbackScrollPosition = (window.pageYOffset + taskAnchor.getBoundingClientRect().top);
                else
                    fallbackScrollPosition = 0;
            }
            Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["restoreScrollPosition"])({ fallbackScrollPosition: fallbackScrollPosition });
        });
    };
    CoursePage.prototype.getOrderedModules = function () {
        var course = this.props.course;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        return moduleOrder
            // Map ordered id to module
            .map(function (id) { return course.modules.find(function (m) { return m.id === id && !m.inactive; }); })
            // Ignore entries that only exists in moduleOrder but not in modules
            .filter(function (m) { return !!m; })
            // Append modules at end that are not listed in moduleOrder
            .concat(course.modules.filter(function (m) { return !moduleOrder.find(function (id) { return m.id === id; }); }));
    };
    CoursePage.prototype.render = function () {
        var _a = this.props, course = _a.course, courseBuilderUrl = _a.courseBuilderUrl;
        var _b = this.state, module = _b.module, task = _b.task;
        var orderedModules = this.getOrderedModules();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: course.name + " - " + course.points + "p", backgroundImage: (course.images.find(function (img) { return img.id === course.imageId; }) || { url: '' }).url, tabs: [{ name: "Upptakt", link: "#", key: "Upptakt" }]
                    .concat(orderedModules.map(function (_a) {
                    var name = _a.name;
                    return ({ name: name, link: "#" + encodeURIComponent(name), key: name });
                }))
                    .concat(course.workFlowLink ? [{
                        name: "Arbetsgång",
                        key: "workflow",
                        link: course.workFlowLink
                    }] : [])
                    .concat(Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"].currentUser, course) ? [{
                        name: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-pencil", "aria-hidden": "true" }),
                            " Redigera denna kurs"),
                        key: "edit",
                        link: Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(courseBuilderUrl, {}) + "#/courses/" + course.id + "/edit"
                    }] : []), activeTab: module ? "#" + encodeURIComponent(module.name) : "#" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" }, task ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_page__WEBPACK_IMPORTED_MODULE_8__["TaskPage"], { task: task, course: course }) :
                                    module ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module_page__WEBPACK_IMPORTED_MODULE_3__["CourseModulePage"], { course: course, module: module }) :
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_run_up_page__WEBPACK_IMPORTED_MODULE_4__["RunUpPage"], { course: course })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout sv-skip-spacer" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_weekplanner__WEBPACK_IMPORTED_MODULE_7__["WeekPlanner"], { viewCourseUrl: '', env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"] }))))))))));
    };
    return CoursePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/run-up-page.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/run-up-page.tsx ***!
  \******************************************************************/
/*! exports provided: RunUpPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RunUpPage", function() { return RunUpPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/resource-list */ "./src/components/course-viewer/subcomponents/resource-list.tsx");


// Views




var RunUpPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RunUpPage, _super);
    function RunUpPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    RunUpPage.prototype.render = function () {
        var course = this.props.course;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                course.runUpText && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, "Upptakt"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "normal", dangerouslySetInnerHTML: { __html: course.runUpText } })),
                course.responsibleTeachers && course.responsibleTeachers.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "L\u00E4rare"),
                    course.responsibleTeachers.map(function (teacher, i) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: i },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: interpretTeacherUrl(teacher.email || teacher.url || '') }, teacher.name));
                    })),
                course.workFlowLink && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", href: course.workFlowLink }, "Arbetsg\u00E5ng"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "\u00C4mnets f\u00F6rm\u00E5gor", subTitle: "F\u00F6rm\u00E5gor", abilities: course.abilities, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Kursens centrala inneh\u00E5ll", subTitle: "Centralt inneh\u00E5ll", centralContent: course.centralContent, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsBox"], { title: "Kursens kunskapskrav", requirements: course.knowledgeRequirements, className: "larger" })),
            course.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__["ResourceList"], { resources: course.resources }))));
    };
    return RunUpPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function interpretTeacherUrl(url) {
    if (url.indexOf(':') === -1 && url.indexOf('@') >= 0)
        return "mailto:" + url;
    return url;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/task-assignments.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-assignments.tsx ***!
  \***********************************************************************/
/*! exports provided: TaskAssignments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskAssignments", function() { return TaskAssignments; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! downloadjs */ "./node_modules/downloadjs/download.js");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _urkund_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./urkund-utils */ "./src/components/course-viewer/course-page/urkund-utils.ts");
/* harmony import */ var _course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../course-builder-ks/logic/is-employee */ "./src/components/course-builder-ks/logic/is-employee.ts");
/* harmony import */ var _apis_google_picker__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../apis/google-picker */ "./src/apis/google-picker.ts");
/* harmony import */ var _apis_buttons__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../apis/buttons */ "./src/apis/buttons.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");
/* harmony import */ var _apis_google_drive__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../apis/google-drive */ "./src/apis/google-drive.ts");















var MAX_URKUND_FILE_SIZE_MB = 50;
var MAX_NONURKUND_FILE_SIZE_MB = 100;
var ALLOWED_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc",
    ".cad",
    ".wav",
    ".mp3",
    ".mpeg4",
    ".mp4",
    ".zip",
    ".png",
    ".jpg",
    ".jpeg",
    ".gif"
];
var URKUND_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc"
];
var TaskAssignments = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskAssignments, _super);
    function TaskAssignments(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            assignments: [],
            loading: true
        };
        return _this;
    }
    TaskAssignments.prototype.setStatePromised = function (cb) {
        var _this = this;
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, cb, resolve); });
    };
    TaskAssignments.prototype.componentDidMount = function () {
        this.load();
    };
    TaskAssignments.prototype.componentWillReceiveProps = function (nextProps) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 4, , 5]);
                        if (!(nextProps.taskId !== this.props.taskId ||
                            nextProps.courseId !== this.props.courseId)) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.setStatePromised(function () { return ({
                                assignments: [],
                                loading: true
                            }); })];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [3 /*break*/, 5];
                    case 4:
                        err_1 = _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err_1);
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.update = function (assignments, assignment) {
        var retval = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([
            assignment
        ], assignments.filter(function (_a) {
            var user = _a.user, filename = _a.filename;
            return user !== assignment.user ||
                filename !== assignment.filename;
        }));
        return retval;
    };
    TaskAssignments.prototype.refreshAssignment = function (assignment) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, user, filename, req, _b, _c, resJson_1, e_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        user = assignment.user, filename = assignment.filename;
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: true }))
                                });
                            })];
                    case 1:
                        _d.sent();
                        _d.label = 2;
                    case 2:
                        _d.trys.push([2, 8, , 10]);
                        return [4 /*yield*/, client.get("assignments/urkund/" + school + "/" + courseId + "/" + taskId + "/" + user + "/" + filename)];
                    case 3:
                        req = _d.sent();
                        if (!(req.status >= 400)) return [3 /*break*/, 5];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, req.status];
                        return [4 /*yield*/, req.text()];
                    case 4: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 5: return [4 /*yield*/, req.text()];
                    case 6:
                        resJson_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment.metadata, { urkundResponse: resJson_1 }) }))
                                });
                            })];
                    case 7:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 8:
                        e_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, refreshError: e_1 }))
                                });
                            })];
                    case 9:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 10: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, teacherAtSchool, res, _b, _c, assignments, refreshableAssigments, refreshableAssigments_1, refreshableAssigments_1_1, a, e_2_1, error_1;
            var e_2, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        _e.trys.push([0, 13, , 14]);
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        teacherAtSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
                        return [4 /*yield*/, (teacherAtSchool ?
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId) :
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail))];
                    case 1:
                        res = _e.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_e.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        assignments = _e.sent();
                        this.setState({
                            error: null,
                            loading: false,
                            assignments: assignments
                        });
                        if (!teacherAtSchool) return [3 /*break*/, 12];
                        refreshableAssigments = assignments.filter(function (a) {
                            return a.metadata && // Must have metadata.urkundExternalId Otherwise not possible to refresh
                                !a.metadata.urkundUploadError && ( // Not possible to refresh if upload has failed
                            !a.metadata.urkundLastPoll || // Never checked status yet
                                (['Accepted', 'Submitted'].indexOf(JSON.parse(a.metadata.urkundResponse)[0].Status.State) >= 0 &&
                                    parseInt(a.metadata.urkundLastPoll) < moment__WEBPACK_IMPORTED_MODULE_5___default()().add(-15, "seconds").toDate().getTime()));
                        }
                        // Checked status for a long time ago
                        );
                        _e.label = 5;
                    case 5:
                        _e.trys.push([5, 10, 11, 12]);
                        refreshableAssigments_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](refreshableAssigments), refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        _e.label = 6;
                    case 6:
                        if (!!refreshableAssigments_1_1.done) return [3 /*break*/, 9];
                        a = refreshableAssigments_1_1.value;
                        return [4 /*yield*/, this.refreshAssignment(a)];
                    case 7:
                        _e.sent();
                        _e.label = 8;
                    case 8:
                        refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        return [3 /*break*/, 6];
                    case 9: return [3 /*break*/, 12];
                    case 10:
                        e_2_1 = _e.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 12];
                    case 11:
                        try {
                            if (refreshableAssigments_1_1 && !refreshableAssigments_1_1.done && (_d = refreshableAssigments_1.return)) _d.call(refreshableAssigments_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                        return [7 /*endfinally*/];
                    case 12: return [3 /*break*/, 14];
                    case 13:
                        error_1 = _e.sent();
                        this.setState({
                            loading: false,
                            error: "Kunde inte ladda inl\u00E4mningsuppgifter",
                            assignments: []
                        });
                        console.error(error_1);
                        return [3 /*break*/, 14];
                    case 14: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.onDrag = function (ev) {
        ev.stopPropagation();
        ev.preventDefault();
        ev.dataTransfer.dropEffect = 'copy';
    };
    TaskAssignments.prototype.verifyAndUpload = function (file, driveFile) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 3, , 4]);
                        if (!file)
                            return [2 /*return*/];
                        if (this.state.assignments.some(function (a) {
                            return a.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                a.filename === file.name;
                        })) {
                            if (!confirm("Ers\u00E4tta befintlig fil (" + file.name + ")?")) {
                                return [2 /*return*/];
                            }
                        }
                        if (this.props.school.toLowerCase() !== _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school.toLowerCase()) {
                            if (!confirm("Uppgiften tillh\u00F6r en annan skola (" + this.props.school + ").\n" +
                                "Vill du \u00E4nd\u00E5 l\u00E4mna in ditt arbete h\u00E4r?")) {
                                return [2 /*return*/];
                            }
                        }
                        this.setState({ uploadingFile: file });
                        return [4 /*yield*/, this.upload(file, driveFile)];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        this.setState({
                            uploadingFile: null
                        });
                        return [3 /*break*/, 4];
                    case 3:
                        error_2 = _a.sent();
                        this.setState({
                            error: "Kunde inte ladda upp filen. " + (error_2.message || error_2),
                            uploadingFile: null
                        });
                        console.error(error_2);
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.upload = function (file, driveFile) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, sendToUrkund, mail, isUrkundExtension, lowerFilename, body, queryParams, res, _b, _c;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school, sendToUrkund = _a.sendToUrkund;
                        mail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail;
                        isUrkundExtension = URKUND_EXTENSIONS
                            .indexOf("." + file.name.split('.').reverse()[0].toLowerCase()) >= 0;
                        if (isUrkundExtension) {
                            if (file.size > MAX_URKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filer av denna typ f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_URKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        else {
                            if (file.size > MAX_NONURKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filen f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_NONURKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        lowerFilename = file.name.toLowerCase();
                        if (!ALLOWED_EXTENSIONS.some(function (ext) { return lowerFilename.endsWith(ext); })) {
                            throw new Error("Filens \u00E4ndelse m\u00E5ste vara " + ALLOWED_EXTENSIONS.join(' / '));
                        }
                        body = new FormData();
                        body.append('files', file);
                        queryParams = {
                            userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName,
                            verifyWithUrkund: sendToUrkund
                        };
                        if (driveFile) {
                            queryParams = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, queryParams, { driveFileId: driveFile.fileId, driveFileUrl: driveFile.url, driveFileIconUrl: driveFile.iconUrl });
                        }
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch("assignments/" + school + "/" + courseId + "/" + taskId + "/" + mail, 'put', {}, queryParams, {
                                body: body
                            })];
                    case 1:
                        res = _d.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.download = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, blob, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(file.mediaLink, 'get', {})];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.blob()];
                    case 4:
                        blob = _c.sent();
                        downloadjs__WEBPACK_IMPORTED_MODULE_8___default()(blob, file.filename, file.contentType);
                        return [3 /*break*/, 6];
                    case 5:
                        err_2 = _c.sent();
                        this.setState({ error: "Kunde inte ladda ned filen. " + (err_2.message || err_2) });
                        console.error(err_2);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.delete = function (url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, err_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 6, , 7]);
                        return [4 /*yield*/, this.setStatePromised(function (_a) {
                                var assignments = _a.assignments;
                                return ({ assignments: assignments.map(function (a) { return a.mediaLink === url ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a, { metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.metadata, { $meta: 'delete' }) }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a); }) });
                            })];
                    case 1:
                        _c.sent();
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(url, 'delete', {})];
                    case 2:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 4];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 3: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 4: return [4 /*yield*/, this.load()];
                    case 5:
                        _c.sent();
                        return [3 /*break*/, 7];
                    case 6:
                        err_3 = _c.sent();
                        this.setState({ error: "Kunde inte ta bort filen. " + (err_3.message || err_3) });
                        console.error(err_3);
                        return [3 /*break*/, 7];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
        var _b = this.state, loading = _b.loading, assignments = _b.assignments, error = _b.error, uploadingFile = _b.uploadingFile;
        var teacherAtThisSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
        var files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](assignments);
        var showGooglePicker = _features__WEBPACK_IMPORTED_MODULE_13__["features"].picker;
        if (uploadingFile) {
            var virtualFile_1 = {
                school: school,
                courseId: courseId,
                taskId: taskId,
                filename: uploadingFile.name,
                size: uploadingFile.size,
                user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail,
                contentType: uploadingFile.type,
                uploadDate: Date.now(),
                mediaLink: "assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail + "/" + uploadingFile.name,
                metadata: {
                    $meta: 'add',
                    userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName
                }
            };
            files = files.filter(function (file) { return file.mediaLink !== virtualFile_1.mediaLink; });
            files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](files, [virtualFile_1]);
        }
        files = files.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProps"])([
            "metadata.userDisplayName",
            "filename",
            "uploadDate"
        ], ["sv", "en"], { sensitivity: 'base' }));
        var hasOwnDocs = files.some(function (file) { return file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail; });
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { onDragOver: function (ev) { return _this.onDrag(ev); }, onDrop: function (ev) {
                ev.stopPropagation();
                ev.preventDefault();
                _this.verifyAndUpload(ev.dataTransfer.files[0]);
            } },
            error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "error" }, error)) : undefined,
            loading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                " Laddar inl\u00E4mnade filer...") : files.length === 0 ?
                teacherAtThisSchool ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Ingen elev har l\u00E4mnat in n\u00E5got arbete \u00E4nnu.") :
                    undefined
                : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "task-assignments-table" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                teacherAtThisSchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Elev") : undefined,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Filnamn"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inl\u00E4mnat den"),
                                teacherAtThisSchool && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Rapport"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Niv\u00E5")),
                                hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, files.map(function (file) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: file.mediaLink, style: file.metadata.$meta ? { opacity: 0.5 } : {} },
                            teacherAtThisSchool ?
                                //
                                // Teacher View
                                // 
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "mailto:" + file.user }, file.metadata.userDisplayName || file.user)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, file.metadata.driveFileId ?
                                        // The file can be edited on drive. Link to editing it.
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](DriveFileListing, { file: file }) :
                                        // The file cannot be edited on drive. Link to downloading it.
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                                ev.preventDefault();
                                                ev.stopPropagation();
                                                _this.download(file);
                                            } }, file.filename)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm')),
                                    file.metadata.$meta === 'add' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Laddar upp...") :
                                        file.metadata.$meta === 'delete' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                                " Tar bort...") :
                                            (function () {
                                                var metadata = file.metadata;
                                                var urkundResponses = metadata.urkundResponse && JSON.parse(metadata.urkundResponse);
                                                var urkundResponse = urkundResponses && urkundResponses[0];
                                                if (!urkundResponse && file.metadata.urkundUploadError) {
                                                    urkundResponse = {
                                                        Status: {
                                                            ErrorCode: -1,
                                                            Message: file.metadata.urkundUploadError,
                                                            State: 'Error'
                                                        },
                                                        ExternalId: file.metadata.urkundExternalId
                                                    };
                                                }
                                                if (file.isRefreshing)
                                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                                        " Uppdaterar...");
                                                return urkundResponse ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: urkundResponse.Report && urkundResponse.Report.ReportUrl, onClick: function (ev) {
                                                                if (['Accepted', 'Submitted'].indexOf(urkundResponse.Status.State) === -1)
                                                                    return; // Follow HREF instead.
                                                                ev.preventDefault();
                                                                ev.stopPropagation();
                                                                _this.refreshAssignment(file);
                                                            }, target: "_blank", title: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundHoverText"])(urkundResponse) },
                                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundStatusClass"])(urkundResponse) }))),
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundSignificanceClass"])(urkundResponse) }, urkundResponse.Report && typeof urkundResponse.Report.Significance === 'number' ?
                                                            urkundResponse.Report.Significance.toFixed() + "%" : ' '))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 });
                                            })()) :
                                //
                                // STUDENT VIEW
                                //
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, file.metadata.driveFileId ?
                                        // The file can be edited on drive. Link to editing it.
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](DriveFileListing, { file: file }) :
                                        // The file cannot be edited on drive. Link to downloading it.
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                                ev.preventDefault();
                                                ev.stopPropagation();
                                                _this.download(file);
                                            } }, file.filename)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, file.metadata.$meta === 'add' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Laddar upp...") :
                                        file.metadata.$meta === 'delete' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                                " Tar bort...") :
                                            moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm'))),
                            hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, !file.metadata.$meta && file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                        ev.stopPropagation();
                                        ev.preventDefault();
                                        if (confirm("Radera inl\u00E4mnad fil " + file.filename + "?"))
                                            _this.delete(file.mediaLink);
                                    } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))); })))),
            Object(_course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__["isEmployee"])() ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone task-assignment-drop-zone" },
                    "Droppa ditt f\u00E4rdiga arbete h\u00E4r.",
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    "Det g\u00E5r ocks\u00E5 bra att anv\u00E4nda bl\u00E4ddra-knappen nedan."),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "file", onChange: function (ev) { return _this.verifyAndUpload(ev.target.files[0]); } }),
                showGooglePicker && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_apis_buttons__WEBPACK_IMPORTED_MODULE_12__["DriveButton"], { label: "H\u00E4mta fr\u00E5n Google Drive", action: function () {
                        var picker = new _apis_google_picker__WEBPACK_IMPORTED_MODULE_11__["GooglePicker"]({ upload: true });
                        var drive = new _apis_google_drive__WEBPACK_IMPORTED_MODULE_14__["GoogleDrive"]();
                        picker.show().then(function (files) {
                            var pickedFile = files[0];
                            if (!pickedFile)
                                return;
                            drive.downloadFile({
                                file: pickedFile,
                                limitSize: MAX_NONURKUND_FILE_SIZE_MB
                            }).then(function (file) { return _this.verifyAndUpload(file, pickedFile); });
                        });
                    } }))));
    };
    return TaskAssignments;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function DriveFileListing(_a) {
    var file = _a.file;
    var _b = file.metadata, driveFileIconUrl = _b.driveFileIconUrl, driveFileUrl = _b.driveFileUrl;
    var filename = file.filename.substr(0, file.filename.lastIndexOf('.'));
    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("img", { className: "file-icon", src: driveFileIconUrl })),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { target: "_blank", href: driveFileUrl }, filename)))));
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/task-page.tsx":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-page.tsx ***!
  \****************************************************************/
/*! exports provided: TaskPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskPage", function() { return TaskPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _task_assignments__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./task-assignments */ "./src/components/course-viewer/course-page/task-assignments.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");












var TaskPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskPage, _super);
    function TaskPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: undefined,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()().week()
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    TaskPage.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.task.id !== this.props.task.id) {
            var userTask = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === nextProps.task.id; }) || null;
            this.setState({
                userTask: userTask,
                weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
            });
        }
    };
    TaskPage.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var userTask = userTasks.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === _this.props.task.id; }) || null;
        this.setState({
            userTask: userTask,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
        });
    };
    TaskPage.prototype.toggleTask = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var weekDate, userTask, _a, course, task, module, latestTimeStamp, userTask_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        weekDate = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate;
                        userTask = this.state.userTask;
                        _a = this.props, course = _a.course, task = _a.task;
                        module = course.modules.find(function (m) { return m.taskIds.some(function (id) { return id === task.id; }); });
                        if (!module)
                            return [2 /*return*/]; // Oh uh!
                        if (userTask === undefined)
                            return [2 /*return*/]; // Not yet loaded.
                        if (!!userTask) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.map(function (t) { return t.dateTime; })));
                        userTask_1 = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["createUUID"])(),
                            courseName: course.name,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: task.learningGoal || module.name,
                            name: task.name,
                            url: task.url,
                            task: [task],
                            course: [course],
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not own tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (task.deadline) {
                            userTask_1.deadline = task.deadline;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(this.props.course.name, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask_1])
                            ])];
                    case 1:
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete([userTask.id])];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskPage.prototype.render = function () {
        var _this = this;
        var _a = this.props, task = _a.task, course = _a.course;
        var _b = this.state, userTask = _b.userTask, weekPlannerWeek = _b.weekPlannerWeek;
        var abilities = task.abilities.map(function (a) { return course.abilities.find(function (ab) { return ab.id === a.id; }); }).filter(function (a) { return !!a; });
        var centralContent = task.centralContent.map(function (c) { return course.centralContent.find(function (cc) { return cc.id == c.id; }); }).filter(function (c) { return !!c; });
        var requirements = task.knowledgeRequirements.map(function (k) { return course.knowledgeRequirements.find(function (kr) { return kr.id === k.id; }); }).filter(function (k) { return !!k; });
        var isWorking = userTask && (userTask.$meta === 'adding' || userTask.$meta === 'deleting');
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_9___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "loggboken" :
            weekPlannerWeek === currentWeek + 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (n\u00E4sta vecka)"], ["vald vecka (n\u00E4sta vecka)"]))) :
                weekPlannerWeek === currentWeek - 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (f\u00F6rra veckan)"], ["vald vecka (f\u00F6rra veckan)"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (v ", ")"], ["vald vecka (v ", ")"])), weekPlannerWeek);
        var deadlineTooLate = task.deadline && moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).endOf('day') < moment__WEBPACK_IMPORTED_MODULE_9___default()();
        if (course.googleCreateClassrooms) {
            // we have google classroom active
            if (task.templateFile && task.templateFile.mimeType.includes('google-apps')) {
                // we have a google apps file so this should be in classroom
            }
            else {
                // we have a template file that is not a google apps file
            }
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null,
                        task.name,
                        task.assignment && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("small", null, " (inl\u00E4mningsuppgift)")))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                task.content && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: task.content } })),
                task.learningGoal && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgiftens l\u00E4randem\u00E5l"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, task.learningGoal)),
                task.url && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: task.url, className: "btn btn-large" }, "G\u00E5 till uppgiften")),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            task.assignment &&
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgift"),
                    task.templateFile ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Till denna uppgift finns en mall") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        Object(_access_control__WEBPACK_IMPORTED_MODULE_11__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser, course.school) ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "H\u00E4r kan du som l\u00E4rare se elevernas inl\u00E4mnade arbeten.") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Det h\u00E4r \u00E4r en inl\u00E4mningsuppgift. L\u00E4mna in ditt arbete som en pdf, doc eller odt fil genom att dra det till f\u00E4ltet under. Du kan \u00E4ven ladda up en fil eller v\u00E4lja en fil fr\u00E5n din Google Drive."),
                            task.deadline ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("b", null,
                                    "Den h\u00E4r uppgiften ",
                                    deadlineTooLate ? 'skulle ha lämnats in ' : 'ska vara inlämnad ',
                                    moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).format('YYYY-MM-DD'))) : undefined),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_assignments__WEBPACK_IMPORTED_MODULE_10__["TaskAssignments"], { courseId: course.id, taskId: task.id, school: course.school, sendToUrkund: task.sendToUrkund }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                abilities.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande f\u00F6rm\u00E5gor", className: "larger", headerOpen: false, abilities: abilities }),
                centralContent.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande centrala inneh\u00E5ll", className: "larger", headerOpen: false, centralContent: centralContent }),
                requirements.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsBox"], { title: "I den h\u00E4r uppgiften bed\u00F6ms f\u00F6ljande kunskapskrav", className: "larger", headerOpen: false, requirements: requirements })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            userTask !== undefined && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (userTask && userTask.$meta !== 'deleting' ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && _this.toggleTask(); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, userTask ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort uppgiften fr\u00E5n ", ""], ["Ta bort uppgiften fr\u00E5n ", ""])), forWeekString) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till uppgiften i ", ""], ["L\u00E4gg till uppgiften i ", ""])), forWeekString)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            task.resources && task.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser kopplade till uppgiften"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, task.resources.map(function (r, idx) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
    };
    return TaskPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-viewer/course-page/urkund-utils.ts":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/urkund-utils.ts ***!
  \******************************************************************/
/*! exports provided: getUrkundStatusClass, getUrkundHoverText, getUrkundSignificanceClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundStatusClass", function() { return getUrkundStatusClass; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundHoverText", function() { return getUrkundHoverText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundSignificanceClass", function() { return getUrkundSignificanceClass; });
function getUrkundStatusClass(res) {
    if (!res || !res.Status) {
        return null;
    }
    else
        switch (res.Status.State) {
            case 'Error':
                return "urkund-status urkund-status-error";
            case 'Submitted':
                return "urkund-status urkund-status-submitted";
            case 'Accepted':
                return "urkund-status urkund-status-accepted";
            case 'Analyzed':
                return "urkund-status urkund-status-analyzed";
        }
}
function getUrkundHoverText(res) {
    if (!res || !res.Status)
        return null;
    switch (res.Status.State) {
        case 'Error':
            return res.ExternalId ?
                "Kunde inte tas emot av urkund. Felkod: " + res.Status.ErrorCode + "\n" +
                    ("External ID: " + res.ExternalId + "\nFelmeddelande: " + res.Status.Message)
                :
                    res.Status.Message;
        case 'Submitted':
            return "Filen \u00E4r uppladdad till Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Accepted':
            return "Filen analyseras fortfarande av Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Analyzed':
            return "Rapport skapad. Klicka f\u00F6r att \u00F6ppna rapporten i nytt f\u00F6nster";
    }
}
function getUrkundSignificanceClass(res) {
    if (!res || !res.Status)
        return '';
    switch (res.Status.State) {
        case 'Error': return 'urkund-significance-error';
        case 'Submitted': return 'urkund-significance-submitted';
        case 'Accepted': return 'urkund-significance-accepted';
    }
    var report = res.Report;
    if (!report) {
        return "";
    }
    if (report.Significance < 1)
        //return `${cdn}/images/urkund/0.gif`;
        return "urkund-significance urkund-significance-0";
    if (report.Significance < 10)
        //return `${cdn}/images/urkund/1.gif`;
        return "urkund-significance urkund-significance-1";
    if (report.Significance < 25)
        return "urkund-significance urkund-significance-2";
    //return `${cdn}/images/urkund/2.gif`;
    if (report.Significance < 40)
        return "urkund-significance urkund-significance-3";
    //return `${cdn}/images/urkund/3.gif`;
    if (report.Significance < 55)
        return "urkund-significance urkund-significance-4";
    //return `${cdn}/images/urkund/4.gif`;
    if (report.Significance < 70)
        return "urkund-significance urkund-significance-5";
    //return `${cdn}/images/urkund/5.gif`;
    if (report.Significance < 85)
        return "urkund-significance urkund-significance-6";
    //return `${cdn}/images/urkund/6.gif`;
    if (report.Significance < 99.9)
        return "urkund-significance urkund-significance-7";
    //return `${cdn}/images/urkund/7.gif`;
    if (report.Significance >= 99.9)
        return "urkund-significance urkund-significance-8";
    //return `${cdn}/images/urkund/8.gif`;
    return "";
}


/***/ }),

/***/ "./src/components/course-viewer/index.tsx":
/*!************************************************!*\
  !*** ./src/components/course-viewer/index.tsx ***!
  \************************************************/
/*! exports provided: CourseViewer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseViewer", function() { return CourseViewer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _course_builder_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _course_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./course-page */ "./src/components/course-viewer/course-page/index.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../list-courses/list-courses-page */ "./src/components/list-courses/list-courses-page.tsx");









var CourseViewer = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseViewer, _super);
    function CourseViewer(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            course: null,
            isLoading: true
        };
        return _this;
    }
    CourseViewer.prototype.componentWillMount = function () {
        var _this = this;
        this.load().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showError"])
            .then(function () { return _this.setState({ isLoading: false }); });
    };
    CourseViewer.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var courseId, course, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        courseId = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_7__["parseQueryString"])(location.search)["courseId"];
                        if (!courseId) return [3 /*break*/, 2];
                        return [4 /*yield*/, Object(_course_builder_utils__WEBPACK_IMPORTED_MODULE_4__["loadCourse"])(courseId)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = null;
                        _b.label = 3;
                    case 3:
                        course = _a;
                        this.setState({ course: course });
                        document.title =
                            course ?
                                course.name + " - " + course.points + "p" :
                                "Kurser";
                        return [2 /*return*/];
                }
            });
        });
    };
    CourseViewer.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-viewer" },
            this.state.isLoading ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__["Spinner"], null) :
                this.state.course ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_page__WEBPACK_IMPORTED_MODULE_6__["CoursePage"], { course: this.state.course, courseBuilderUrl: this.props.courseBuilderUrl }) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__["ListCoursesPage"], null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__["ErrorSuccessFeedback"], null));
    };
    return CourseViewer;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/abilities-box.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/abilities-box.tsx ***!
  \**********************************************************************/
/*! exports provided: AbilitiesBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbilitiesBox", function() { return AbilitiesBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var AbilitiesBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AbilitiesBox, _super);
    function AbilitiesBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    AbilitiesBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, abilities = _a.abilities, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    abilities.map(function (a) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: a.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: a.name } })));
                    }))));
    };
    return AbilitiesBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/central-content-box.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/central-content-box.tsx ***!
  \****************************************************************************/
/*! exports provided: CentralContentBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CentralContentBox", function() { return CentralContentBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var CentralContentBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CentralContentBox, _super);
    function CentralContentBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    CentralContentBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, centralContent = _a.centralContent, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    centralContent.map(function (cc) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: cc.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: cc.name } })));
                    }))));
    };
    return CentralContentBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/confirmation.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/confirmation.tsx ***!
  \*********************************************************************/
/*! exports provided: Confirmation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Confirmation", function() { return Confirmation; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

function Confirmation(props) {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "confirmation-box " + props.className + (props.visible ? " visible" : "") },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null, props.text),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onConfirm(); } }, "OK"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onCancel(); } }, "Avbryt"));
}


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx":
/*!*************************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx ***!
  \*************************************************************************************/
/*! exports provided: KnowledgeRequirementsBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeRequirementsBox", function() { return KnowledgeRequirementsBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var KnowledgeRequirementsBox = function (props) {
    var title = props.title, className = props.className, headerOpen = props.headerOpen, idsToSubjectMap = props.idsToSubjectMap, requirements = props.requirements;
    if (!idsToSubjectMap) {
        // Normal case
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: className, headerOpen: headerOpen },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](KnowledgeRequirementsTable, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props)))));
    }
    // Special case: Requirements that spans multiple subjects:
    var requirementsPerSubjectLookup = idsToSubjectMap ?
        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToLookup"])(requirements, function (r) { return idsToSubjectMap[r.id] || ""; }) : { "": requirements };
    var reqsPerSubject = Object.keys(requirementsPerSubjectLookup)
        .map(function (subject) { return ({ subject: subject, requirements: requirementsPerSubjectLookup[subject] }); });
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: className, headerOpen: headerOpen }, reqsPerSubject.map(function (_a) {
        var subject = _a.subject, requirements = _a.requirements;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](KnowledgeRequirementsTable, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props, { key: subject, heading: subject, requirements: requirements })));
    }));
};
var KnowledgeRequirementsTable = function (_a) {
    var requirements = _a.requirements, includedIds = _a.includedIds, explainedRequirements = _a.explainedRequirements, partialRequirments = _a.partialRequirments, heading = _a.heading;
    var columns = ["E", "C", "A"];
    var rows = [];
    var reqs = requirements.slice();
    var row = null;
    while (true) {
        row = columns.map(function (grade) {
            var pNext = reqs.findIndex(function (r) { return r.gradeStep.toUpperCase() === grade; });
            if (pNext < 0)
                return null;
            var rv = reqs[pNext];
            reqs.splice(pNext, 1);
            return includedIds ?
                (includedIds[rv.id] ? rv : undefined) :
                rv;
        });
        if (row.every(function (r) { return r === null; }))
            break;
        if (!row.every(function (r) { return !r; })) {
            rows.push(row);
        }
    }
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
        heading && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, heading),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i }, row.map(function (column, j) {
                    var columnPartialReq = column && partialRequirments && partialRequirments[column.id];
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: columnPartialReq ? columnPartialReq.join(".") : column ? column.name : "" } });
                }
                // <td key={j}>
                // {partialRequirments.map((pr, k) => pr[column.id] ?
                //   <span key={k} dangerouslySetInnerHTML={{}}/>
                // )}
                // </td>
                )),
                explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (column, j) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, className: "explained-requirement" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, (column && explainedRequirements[column.id]) || ""));
                }))); }))));
};


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/learning-goals-list.tsx ***!
  \****************************************************************************/
/*! exports provided: LearningGoalsList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LearningGoalsList", function() { return LearningGoalsList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _task_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");




var LearningGoalsList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LearningGoalsList, _super);
    function LearningGoalsList() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LearningGoalsList.prototype.render = function () {
        var _a = this.props, commonTasks = _a.commonTasks, learningGoals = _a.learningGoals;
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            learningGoals.map(function (lg) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, lg.name),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: lg.learningTasks })); }),
            commonTasks.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                learningGoals.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, intl.formatMessage({ id: "learningGoalsLost.overall", defaultMessage: "Övergripande" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: commonTasks })));
    };
    LearningGoalsList.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"];
    return LearningGoalsList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/resource-list.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/resource-list.tsx ***!
  \**********************************************************************/
/*! exports provided: ResourceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceList", function() { return ResourceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var ResourceList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ResourceList, _super);
    function ResourceList(props) {
        return _super.call(this, props) || this;
    }
    ResourceList.prototype.render = function () {
        var resources = this.props.resources;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, resources.map(function (resource, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: resource.url }, resource.name)));
            })));
    };
    return ResourceList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/task-list.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/task-list.tsx ***!
  \******************************************************************/
/*! exports provided: TaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskList", function() { return TaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _confirmation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./confirmation */ "./src/components/course-viewer/subcomponents/confirmation.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");









var TaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskList, _super);
    function TaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            confirmations: []
        };
        _this.onChange = _this.onChange.bind(_this);
        return _this;
    }
    TaskList.prototype.onChange = function (userTasks, persisted) {
        if (persisted.weekDate !== this.state.weekDate) {
            this.setState({
                confirmations: []
            });
        }
        this.setState({
            userTasks: userTasks,
            weekDate: persisted.weekDate
        });
    };
    TaskList.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onChange);
    };
    TaskList.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onChange);
    };
    TaskList.prototype.toggleTask = function (learningTask) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var userTasks, weekDate, latestTimeStamp, userTask;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        userTasks = this.state.userTasks.filter(function (ut) {
                            return learningTask.task ?
                                ut.task && ut.task.some(function (t) { return t.id === learningTask.id; }) :
                                ut.siteVisionPageId === learningTask.id;
                        });
                        weekDate = this.state.weekDate;
                        if (!(userTasks.length === 0)) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        userTask = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                            courseName: learningTask.courseName,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: learningTask.learningGoal,
                            name: learningTask.name,
                            url: learningTask.url,
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not custom tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (learningTask.task && learningTask.task.deadline) {
                            userTask.deadline = learningTask.task.deadline;
                        }
                        if (learningTask.task) {
                            userTask.task = [learningTask.task];
                            if (learningTask.course) {
                                userTask.course = [learningTask.course];
                            }
                            else if (learningTask.courseInfo) {
                                userTask.courseInfo = learningTask.courseInfo;
                            }
                        }
                        else {
                            userTask.siteVisionPageId = learningTask.id;
                        }
                        if (learningTask.step) {
                            userTask.step = learningTask.step;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(learningTask.courseName, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask])
                            ])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Already present in weekplanner. It's time to delete those that matched us.
                    return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete(userTasks.map(function (t) { return t.id; }))];
                    case 3:
                        // Already present in weekplanner. It's time to delete those that matched us.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskList.prototype.render = function () {
        var _this = this;
        var intl = this.context.intl;
        var learningTasks = this.props.learningTasks;
        var userTasks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["arrayToMap"])(this.state.userTasks, function (ut) { return ut.task && ut.task.length > 0 ?
            ut.task.map(function (t) { return t.id; })[0] : // course-builder tasks looked up by id
            ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks
                ut.url; });
        var confirmations = this.state.confirmations;
        var weekPlannerWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()(this.state.weekDate).week();
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "" :
            weekPlannerWeek === currentWeek + 1 ? intl.formatMessage({ id: "taskList.nextWeekTask", defaultMessage: "för nästa vecka (v{week})" }, { week: weekPlannerWeek }) :
                weekPlannerWeek === currentWeek - 1 ? intl.formatMessage({ id: "taskList.lastWeekTask", defaultMessage: "för förra veckan (v{week})" }, { week: weekPlannerWeek }) :
                    intl.formatMessage({ id: "taskList.currentWeekTask", defaultMessage: "för vecka {week}" }, { week: weekPlannerWeek });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, learningTasks.map(function (learningTask, idx) {
            var taskLookupId = learningTask.id;
            var userTask = userTasks[taskLookupId] || { $meta: 'deleted' }; // No exist = $meta: 'deleted'
            var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';
            var selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';
            var describedAction = selected ?
                intl.formatMessage({ id: "taskList.removeTaskFromWeeklyPlanning", defaultMessage: "Ta bort uppgiften från egen veckoplanering {week}" }, { week: forWeekString }) :
                intl.formatMessage({ id: "taskList.addTaskToWeeklyPlanning", defaultMessage: "Lägg till uppgiften i egen veckoplanering {week}" }, { week: forWeekString });
            var confirmationVisible = confirmations.some(function (tid) { return taskLookupId === tid; });
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: learningTask.id },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: taskLookupId, className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (selected ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && weekPlannerWeek === currentWeek ?
                                _this.toggleTask(learningTask) :
                                confirmationVisible ?
                                    _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) }) :
                                    _this.setState({ confirmations: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](confirmations).concat(taskLookupId) }); }, title: describedAction })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: learningTask.url }, learningTask.name))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_confirmation__WEBPACK_IMPORTED_MODULE_7__["Confirmation"], { visible: confirmationVisible, text: describedAction, onConfirm: function () {
                        _this.toggleTask(learningTask);
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    }, onCancel: function () {
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    } }));
        }));
    };
    TaskList.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__["LanguageContext"];
    return TaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/utils/get-included-ids.ts":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/utils/get-included-ids.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getIncludedIds; });
function getIncludedIds(module, course) {
    var result = {};
    course.tasks.filter(function (t) { return module.taskIds.indexOf(t.id) !== -1; }).forEach(function (task) {
        task.abilities.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.centralContent.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.knowledgeRequirements.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
    });
    return result;
}


/***/ }),

/***/ "./src/components/course-viewer/utils/manual-scroll-restoration.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/utils/manual-scroll-restoration.ts ***!
  \*************************************************************************/
/*! exports provided: initManualScrollRestoration, restoreScrollPosition */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initManualScrollRestoration", function() { return initManualScrollRestoration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "restoreScrollPosition", function() { return restoreScrollPosition; });
var initialized = false;
function initManualScrollRestoration() {
    if (!initialized) {
        initialized = true;
        document.documentElement.addEventListener('click', function (ev) {
            var target = ev.target;
            if (target && target.tagName === 'A') {
                history.replaceState({ pageYOffset: window.pageYOffset }, null, null);
            }
        });
        if (history.scrollRestoration)
            history.scrollRestoration = 'manual';
    }
}
function restoreScrollPosition(_a) {
    var fallbackScrollPosition = _a.fallbackScrollPosition;
    if (history.state && history.state.pageYOffset !== undefined) {
        window.scrollTo(0, history.state.pageYOffset);
    }
    else if (fallbackScrollPosition !== undefined) {
        window.scrollTo(0, fallbackScrollPosition);
    }
}


/***/ }),

/***/ "./src/components/list-courses/list-courses-page.tsx":
/*!***********************************************************!*\
  !*** ./src/components/list-courses/list-courses-page.tsx ***!
  \***********************************************************/
/*! exports provided: ListCoursesPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCoursesPage", function() { return ListCoursesPage; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../course-viewer/course-page/course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _list_courses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./list-courses */ "./src/components/list-courses/list-courses.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");




function ListCoursesPage() {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__["CourseBanner"], { title: _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.school, backgroundImage: "", tabs: [{ name: "Skolans kurser", link: "#" }], activeTab: "#" }),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_list_courses__WEBPACK_IMPORTED_MODULE_2__["ListCourses"], null)))));
}


/***/ }),

/***/ "./src/components/list-courses/list-courses.tsx":
/*!******************************************************!*\
  !*** ./src/components/list-courses/list-courses.tsx ***!
  \******************************************************/
/*! exports provided: ListCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCourses", function() { return ListCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../repos/hidden-courses-repo */ "./src/repos/hidden-courses-repo.ts");








var ListCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ListCourses, _super);
    function ListCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isLoading: true,
            courses: [],
            headerOpen: false
        };
        _this.updateHiddenCourses = _this.updateHiddenCourses.bind(_this);
        return _this;
    }
    ListCourses.prototype.componentWillMount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].subscribe(this.updateHiddenCourses, { fullCourse: true });
    };
    ListCourses.prototype.componentWillUnmount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].unsubscribe(this.updateHiddenCourses);
    };
    ListCourses.prototype.updateHiddenCourses = function (courses) {
        this.setState({ courses: courses, isLoading: false });
    };
    ListCourses.prototype.hideCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].hideCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.showCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].showCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.render = function () {
        var _this = this;
        if (this.state.isLoading)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null);
        var courses = this.state.courses;
        var visibleCourses = courses.filter(function (course) { return course.visible; });
        var hiddenCourses = courses.filter(function (course) { return !course.visible; });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["parseQueryString"])(location.search);
        var viewCourseUrl = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["default"].KED_COURSE_VIEWER_URL;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, visibleCourses.map(function (course) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "hideItem", onClick: function () { return _this.hideCourse(course); } })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_access_control_index__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: course.id }) }, course.name))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose" + (this.state.headerOpen ? " open" : "") },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "Dolda kurser")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, hiddenCourses.map(function (course) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "showItem", onClick: function () { return _this.showCourse(course); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { courseId: course.id })) }, course.name)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
                    })))));
    };
    return ListCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/utility-components/LanguageContext.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/LanguageContext.tsx ***!
  \***************************************************************/
/*! exports provided: LanguageContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LanguageContext", function() { return LanguageContext; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var LanguageContext = react__WEBPACK_IMPORTED_MODULE_0__["createContext"]({ intl: null });


/***/ }),

/***/ "./src/components/utility-components/SetupLanguageIntl.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/SetupLanguageIntl.tsx ***!
  \*****************************************************************/
/*! exports provided: setupIntl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupIntl", function() { return setupIntl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl/locale-data/en */ "./node_modules/react-intl/locale-data/en.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl/locale-data/sv */ "./node_modules/react-intl/locale-data/sv.js");
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../translations/sv.json */ "./src/translations/sv.json");
var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/sv.json */ "./src/translations/sv.json", 1);
/* harmony import */ var _translations_en_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../translations/en.json */ "./src/translations/en.json");
var _translations_en_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/en.json */ "./src/translations/en.json", 1);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__);









var setupIntl = function (Component) {
    return /** @class */ (function (_super) {
        tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_SetupLanguageIntl, _super);
        function _SetupLanguageIntl(props) {
            var _this = _super.call(this, props) || this;
            Object(react_intl__WEBPACK_IMPORTED_MODULE_1__["addLocaleData"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default.a, react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default.a));
            _this.messages = {
                'sv': _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__,
                'en': _translations_en_json__WEBPACK_IMPORTED_MODULE_5__
            };
            moment__WEBPACK_IMPORTED_MODULE_8___default()().locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE);
            return _this;
        }
        _SetupLanguageIntl.prototype.render = function () {
            return react__WEBPACK_IMPORTED_MODULE_6__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_1__["IntlProvider"], { locale: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE, messages: this.messages[_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE] },
                react__WEBPACK_IMPORTED_MODULE_6__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.props)));
        };
        return _SetupLanguageIntl;
    }(react__WEBPACK_IMPORTED_MODULE_6__["Component"]));
};


/***/ }),

/***/ "./src/components/utility-components/dialogs.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/dialogs.tsx ***!
  \*******************************************************/
/*! exports provided: Dialogs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialogs", function() { return Dialogs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);





var Dialogs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Dialogs, _super);
    function Dialogs(props) {
        return _super.call(this, props) || this;
    }
    Dialogs.prototype.componentDidUpdate = function (prevProps) {
        if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {
            // A dialog was closed. Now focus the last dialog:
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(this.lastDiv)).find(':input').first().focus();
        }
    };
    Dialogs.prototype.render = function () {
        var _this = this;
        this.lastDiv = null;
        var _a = this.props, dialogs = _a.dialogs, popDialog = _a.popDialog;
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').attr('aria-disabled', dialogs.length > 0);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');
        return dialogs.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, dialogs.map(function (dialog, idx) {
            var div;
            function onKeyPress(ev) {
                if (ev.which === 13 && (!ev.target || ev.target.tagName !== 'TEXTAREA')) {
                    jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div)).find('.btn-default').click();
                }
                ev.stopPropagation();
            }
            function onKeyDown(ev) {
                if (ev.which === 27) { // Escape
                    popDialog();
                    ev.stopPropagation();
                    return;
                }
                if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
                    var domNode = Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div);
                    ev.preventDefault();
                    var defaultButton = jquery__WEBPACK_IMPORTED_MODULE_4___default()(domNode).find('.btn-default');
                    defaultButton.click();
                    ev.stopPropagation();
                }
            }
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page", ref: function (elem) {
                            div = elem;
                            if (idx === dialogs.length - 1)
                                _this.lastDiv = elem;
                        }, tabIndex: 0, "aria-disabled": idx < dialogs.length - 1, onKeyPress: onKeyPress, onKeyDown: onKeyDown },
                        dialog,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__["RemoveItem"], { onClick: popDialog }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stopFloats" }))));
        }));
    };
    return Dialogs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-text-input.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/utility-components/form-field-text-input.tsx ***!
  \*********************************************************************/
/*! exports provided: TextInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextInput", function() { return TextInput; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextInput = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextInput, _super);
    function TextInput(props) {
        return _super.call(this, props) || this;
    }
    TextInput.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: this.props.autoFocus, id: this.props.id, size: 35, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder }))));
    };
    return TextInput;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-textarea.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/form-field-textarea.tsx ***!
  \*******************************************************************/
/*! exports provided: TextAreaFormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextAreaFormField", function() { return TextAreaFormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextAreaFormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextAreaFormField, _super);
    function TextAreaFormField(props) {
        return _super.call(this, props) || this;
    }
    TextAreaFormField.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label, id: this.props.id },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: this.props.autoFocus, id: this.props.id, cols: 35, rows: this.props.rows || 5, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder })),
                !!this.props.children && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" }, this.props.children))));
    };
    return TextAreaFormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field.tsx":
/*!**********************************************************!*\
  !*** ./src/components/utility-components/form-field.tsx ***!
  \**********************************************************/
/*! exports provided: FormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormField", function() { return FormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function findId(node) {
    var recucheck = new Set();
    return (function findId(node) {
        if (typeof node === 'string')
            return null;
        if (recucheck.has(node)) {
            return;
        }
        recucheck.add(node);
        if (node.props) {
            if (node.props.id)
                return node.props.id;
            if (node.props.children) {
                return findId(node.props.children);
            }
            return;
        }
        if (node.length) {
            for (var i = 0; i < node.length; ++i) {
                var child = node[i];
                if (child) {
                    var childId = findId(child);
                    if (childId)
                        return childId;
                    //console.log(child);
                }
            }
        }
    })(node);
}
var FormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FormField, _super);
    function FormField(props) {
        return _super.call(this, props) || this;
    }
    FormField.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel", htmlFor: this.props.id || findId(this.props.children) }, this.props.label),
            this.props.children);
    };
    return FormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../charts/goal-progress */ "./src/components/charts/goal-progress.tsx");
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/



var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName, displayProgress = _a.displayProgress, progressData = _a.progressData, inactivated = _a.inactivated, inactivatedRender = _a.inactivatedRender;
        var headerOpen = this.state.headerOpen;
        if (inactivated)
            return inactivatedRender === 'titleAndChildren' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children)) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children);
        //var currentProgressData = //progressData();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeaderContainer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, title),
                    displayProgress && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__["GoalProgress"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, progressData)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-goal.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-goal.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomGoal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomGoal", function() { return AddCustomGoal; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");



var AddCustomGoal = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomGoal, _super);
    function AddCustomGoal(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            learningGoal: props.learningGoal || ''
        };
        return _this;
    }
    AddCustomGoal.prototype.render = function () {
        var _this = this;
        var learningGoal = this.state.learningGoal;
        var onSave = this.props.onSave;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalTitle", defaultMessage: "L\u00E4gg till eget l\u00E4randem\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoal", defaultMessage: "M\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, autoFocus: true, value: learningGoal, onChange: function (e) { return _this.setState({ learningGoal: e.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(learningGoal); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "common.save", defaultMessage: "save" }))));
    };
    return AddCustomGoal;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-task.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-task.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomTask", function() { return AddCustomTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");






var AddCustomTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomTask, _super);
    function AddCustomTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            name: '',
            description: '',
            url: ''
        };
        return _this;
    }
    AddCustomTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var _b = this.props, isTask = _b.isTask, onSave = _b.onSave;
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "customTask.addWorkGoalTitle", defaultMessage: "L\u00E4gg till eget arbetsm\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.nameLabel', defaultMessage: 'Namn' }), id: "AddCustomTask:name", placeholder: intl.formatMessage({ id: 'customTask.enterNamePlhd', defaultMessage: 'Ange namn...' }), value: name, autoFocus: true, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { rows: 7, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddCustomTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: "Lägg till en beskrivning..." }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Länk' }), id: "AddCustomTask:url", placeholder: "http://www...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(name, description, url); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddCustomTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__["LanguageContext"];
    return AddCustomTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-or-edit-sub-task.tsx":
/*!*************************************************************!*\
  !*** ./src/components/weekplanner/add-or-edit-sub-task.tsx ***!
  \*************************************************************/
/*! exports provided: AddOrEditSubTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddOrEditSubTask", function() { return AddOrEditSubTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");







var AddOrEditSubTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddOrEditSubTask, _super);
    function AddOrEditSubTask(props) {
        var _this = _super.call(this, props) || this;
        if (props.mode === 'edit') {
            var subTask = props.subTask;
            _this.state = {
                name: subTask.name || '',
                description: subTask.description || '',
                url: subTask.url || ''
            };
        }
        else {
            _this.state = {
                name: '',
                description: '',
                url: ''
            };
        }
        return _this;
    }
    AddOrEditSubTask.prototype.save = function () {
        // Update repo:
        var props = this.props;
        var userTask = props.userTask, closeDialog = props.closeDialog, userTasksRepo = props.userTasksRepo;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        if (props.mode === 'edit') {
            // Edit existing:
            userTasksRepo.update([userTask], function (ut) {
                var subTasks = ut.subTasks;
                if (subTasks) {
                    ut.subTasks = subTasks.map(function (st) {
                        return st.id === props.subTask.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st, { name: name, description: description, url: url }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st);
                    });
                }
            });
        }
        else {
            // Create new task
            var newSubTask_1 = {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                name: name,
                description: description,
                url: url
            };
            // Update repo:
            userTasksRepo.update([userTask], function (ut) {
                if (!ut.subTasks) {
                    ut.subTasks = [];
                }
                ut.subTasks = ut.subTasks.concat(newSubTask_1);
            });
        }
        // Close dialog
        closeDialog();
    };
    AddOrEditSubTask.prototype.delete = function () {
        // Update repo:
        var props = this.props;
        if (props.mode !== 'edit') {
            throw new Error("Can only delete in edit mode");
        }
        props.userTasksRepo.update([props.userTask], function (ut) {
            if (ut.subTasks) {
                ut.subTasks = ut.subTasks.filter(function (t) { return t.id !== props.subTask.id; });
            }
        });
        // Close dialog:
        props.closeDialog();
    };
    AddOrEditSubTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var props = this.props;
        var isEditMode = props.mode === 'edit';
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isEditMode ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.editSubtask", defaultMessage: 'Redigera underuppgift' }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.addSubtask", defaultMessage: 'L\u00E4gg till underuppgift' })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { autoFocus: true, label: intl.formatMessage({ id: 'addeditsubtask.nameLabel', defaultMessage: 'Underuppgiftens namn' }), id: "AddUserSubTask:name", placeholder: "", value: this.state.name, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddUserSubTask:description", rows: 7, placeholder: "", value: this.state.description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Länk' }), id: "AddUserSubTask:url", placeholder: "", value: this.state.url, onChange: function (url) { return _this.setState({ url: url }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                props.mode === 'edit' && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn btn-warning btn-large pull-right", onClick: function (ev) { return _this.delete(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.deleteSubtask", defaultMessage: "Ta bort underuppgift" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddOrEditSubTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__["LanguageContext"];
    return AddOrEditSubTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/edit-user-task.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/edit-user-task.tsx ***!
  \*******************************************************/
/*! exports provided: EditUserTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditUserTask", function() { return EditUserTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/form-field */ "./src/components/utility-components/form-field.tsx");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");












var EditUserTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditUserTask, _super);
    function EditUserTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: props.userTask,
            name: props.userTask.name,
            description: props.userTask.description,
            url: props.userTask.url,
            deadline: props.userTask.deadline,
            subTasks: props.userTask.subTasks
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    EditUserTask.prototype.componentDidMount = function () {
        this.props.userTasksRepo.subscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var myUserTask = userTasks.find(function (ut) { return ut.id === _this.props.userTask.id; });
        if (!myUserTask) {
            this.props.closeDialog();
            return;
        }
        this.setState({
            userTask: myUserTask,
            subTasks: myUserTask.subTasks
        });
    };
    EditUserTask.prototype.componentWillUnmount = function () {
        this.props.userTasksRepo.unsubscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.isModified = function () {
        // Don't count subtask changes! They live their own life and is maintained
        // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks
        // to be persisted right away. May click away this dialog.
        // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner
        // when clicking the subtask for example!
        var _a = this.state, deadline = _a.deadline, description = _a.description, name = _a.name, url = _a.url, userTask = _a.userTask;
        return (deadline !== userTask.deadline ||
            description !== userTask.description ||
            name !== userTask.name ||
            url !== userTask.url);
    };
    EditUserTask.prototype.addSubTask = function () {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "add", userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.editSubTask = function (subTask) {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "edit", subTask: subTask, userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url, deadline = _a.deadline, subTasks = _a.subTasks, showCalendar = _a.showCalendar, userTask = _a.userTask;
        var id = userTask.id, courseName = userTask.courseName;
        var _b = this.props, onUpdate = _b.onUpdate, onDelete = _b.onDelete;
        var isModified = this.isModified();
        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_2__["getTaskType"])(userTask);
        var isCustomTask = taskType === 'customTask';
        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline) < moment__WEBPACK_IMPORTED_MODULE_6___default()();
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isCustomTask ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editWorkGoals", defaultMessage: 'Redigera arbetsm\u00E5l' }) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editTask", defaultMessage: 'Redigera uppgift' })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { autoFocus: true, label: isCustomTask ? intl.formatMessage({ id: 'task.targetNameLabel', defaultMessage: 'Arbetsmålets namn' }) : intl.formatMessage({ id: 'task.taskNameLabel', defaultMessage: 'Uppgiftens namn' }), id: "EditUserTask:name", placeholder: isCustomTask ? intl.formatMessage({ id: 'task.whatShouldYouDoPlhd', defaultMessage: 'Vad ska du göra?' }) : intl.formatMessage({ id: 'task.enterTaskNamePlhd', defaultMessage: 'Ange uppgiftens namn...' }), value: name, onChange: function (name) { return _this.setState({ name: name }); } }),
            isCustomTask && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__["TextAreaFormField"], { rows: 5, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "EditUserTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: 'Lägg till en beskrivning...' }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: "Länk" }), id: "EdutUserTask:url", placeholder: "http(s)://...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.setDeadline', defaultMessage: 'Ange deadline' }) }, (deadline || showCalendar) ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_3__["default"], { ref: function (elem) { return _this.datePicker = elem; }, id: "EditUserTask:deadline", nextMonthButtonLabel: "", previousMonthButtonLabel: "", showWeekNumbers: true, selected: deadline && moment__WEBPACK_IMPORTED_MODULE_6___default()(deadline).toDate(), autoFocus: showCalendar, dateFormat: "yyyy-MM-dd", className: expired ? "expired" : undefined, locale: intl.locale, popperPlacement: isCustomTask ? "top-start" : "bottom-start", onBlur: function () { return _this.setState({ showCalendar: false }); }, onChange: function (value) {
                                _this.setState({
                                    deadline: value && moment__WEBPACK_IMPORTED_MODULE_6___default()(value).format("YYYY-MM-DD"),
                                    showCalendar: false
                                });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "deleteDate", href: "#", title: intl.formatMessage({ id: 'task.removeDeadline', defaultMessage: 'Ta bort deadline' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.setState({ deadline: null, showCalendar: false });
                            } }))) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top", ref: function () { _this.datePicker = null; } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function (ev) {
                            if (_this.datePicker) {
                                _this.datePicker.setOpen(true);
                            }
                            _this.setState({
                                showCalendar: true
                            });
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-calendar", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.setDeadlineLabel", defaultMessage: "Ange deadline..." })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.subTasks', defaultMessage: 'Underuppgifter' }) },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, subTasks && subTasks.map(function (subTask) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () { return _this.editSubTask(subTask); }, href: "#" }, subTask.name))); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { id: "EditUserTask:addSubTask", className: "btn", onClick: function () { return _this.addSubTask(); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                            " ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.addSubtask", defaultMessage: "L\u00E4gg till underuppgift" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "divider large" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-default", onClick: function () {
                            isModified ? onUpdate(function (userTask) {
                                userTask.name = name;
                                userTask.description = description;
                                userTask.url = url;
                                userTask.deadline = deadline;
                            }) : _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn", onClick: function () {
                            _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.cancel", defaultMessage: "Avbryt" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "confirm top pull-right" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-warning", onClick: function () {
                            onDelete(id);
                        } }, isCustomTask ?
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeWorkGoals", defaultMessage: "Ta bort arbetsm\u00E5l" }) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeThisTask", defaultMessage: "Ta bort den h\u00E4r uppgiften" })))));
    };
    EditUserTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__["LanguageContext"];
    return EditUserTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/get-task-type.ts":
/*!*****************************************************!*\
  !*** ./src/components/weekplanner/get-task-type.ts ***!
  \*****************************************************/
/*! exports provided: getTaskType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTaskType", function() { return getTaskType; });
function getTaskType(userTask) {
    return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?
        'courseBuilderTask' :
        userTask.siteVisionPageId ?
            'siteVisionTask' :
            userTask.courseInfo ?
                'subjectPlannerTask' :
                'customTask';
}


/***/ }),

/***/ "./src/components/weekplanner/index.ts":
/*!*********************************************!*\
  !*** ./src/components/weekplanner/index.ts ***!
  \*********************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./weekplanner */ "./src/components/weekplanner/weekplanner.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return _weekplanner__WEBPACK_IMPORTED_MODULE_0__["WeekPlanner"]; });




/***/ }),

/***/ "./src/components/weekplanner/refiner.ts":
/*!***********************************************!*\
  !*** ./src/components/weekplanner/refiner.ts ***!
  \***********************************************/
/*! exports provided: refine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "refine", function() { return refine; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


function refine(tasks) {
    var e_1, _a, e_2, _b;
    var result = [];
    var mapper = {};
    var tasksPerCourse = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(tasks, function (t) { return t.courseName || ''; });
    try {
        for (var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerCourse).sort().filter(function (x) { return x; }).concat(tasksPerCourse[''] ?
            [''] : [])), _d = _c.next(); !_d.done; _d = _c.next()) {
            var courseName = _d.value;
            var courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];
            var tasksPerLearningGoal = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(courseTasks, function (t) { return t.learningGoal; });
            var resultLearningGoals = [];
            try {
                for (var _e = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerLearningGoal))), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var learningGoal = _f.value;
                    var lgTasks = tasksPerLearningGoal[learningGoal].sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["compareProp"])("dateTime"));
                    var learningGoalTask = lgTasks
                        .filter(function (t) { return t.name == null; }) // If name is undefined or null, this represents a learning goal
                    [0];
                    var url = learningGoalTask && learningGoalTask.url;
                    resultLearningGoals.push({
                        name: learningGoal,
                        allTasks: lgTasks,
                        url: url,
                        step: lgTasks.map(function (t) { return t.step; }).filter(function (step) { return step; })[0],
                        tasks: lgTasks.filter(function (t) { return t.name; })
                    });
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            result.push({
                courseName: courseName,
                learningGoals: resultLearningGoals
            });
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}


/***/ }),

/***/ "./src/components/weekplanner/user-tasks-box.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/user-tasks-box.tsx ***!
  \*******************************************************/
/*! exports provided: UserTasksBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksBox", function() { return UserTasksBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../calendar/course-name-to-css-class */ "./src/components/calendar/course-name-to-css-class.ts");
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");











;
var UserTasksBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksBox, _super);
    function UserTasksBox(props) {
        return _super.call(this, props) || this;
    }
    UserTasksBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseName = _a.courseName, learningGoals = _a.learningGoals, progressData = _a.progressData, displayProgress = _a.displayProgress;
        var isOpen = !!this.props.openCourses[courseName];
        var features = new _features__WEBPACK_IMPORTED_MODULE_7__["Features"]();
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, courseName || react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: "userTasks.goals", defaultMessage: "Egna l\u00E4randem\u00E5l" })), headerOpen: isOpen, className: courseName && Object(_calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__["courseNameToCssClass"])('wp-course-', courseName), onOpenClose: function (becameOpen) { return _this.props.setIsOpen(courseName, becameOpen); }, displayProgress: displayProgress, progressData: progressData }, learningGoals.map(function (lg) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name, className: "learningGoalContainer" },
                lg.step && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stepIndicator" }, lg.step),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalText horizontalItem top" }, lg.name),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        "\u00A0",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "trash", href: "#", title: intl.formatMessage({ id: 'userTasks.deleteLearningGoal', defaultMessage: 'Ta bort lärandemålet och dess uppgifter' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.props.removeLearningGoal(lg);
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, lg.tasks.map(function (userTask) {
                        var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';
                        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_5__["getTaskType"])(userTask);
                        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).startOf('day') < moment__WEBPACK_IMPORTED_MODULE_6___default()().startOf('day');
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: userTask.id, style: isWorking ? { opacity: 0.5 } : {} },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (userTask.done ? " checked" : ""), onClick: function (ev) { return !isWorking && _this.props.setTaskDone(userTask, !userTask.done); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    taskType === 'courseBuilderTask' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getTaskUrl(userTask, _this.props.viewCourseUrl) }, userTask.name) :
                                        taskType === 'subjectPlannerTask' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getSubjectPlannerTaskUrl(userTask) }, userTask.name) :
                                            taskType === 'siteVisionTask' ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: userTask.url }, userTask.name) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: !userTask.url ? "link-less" : "", href: userTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                        "_self" :
                                                        "_blank" }, userTask.name),
                                    userTask.deadline && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "dateSet" + (expired ? ' expired' : '') },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { title: moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).format("YYYY-MM-DD"), className: "fa fa-calendar", "aria-hidden": "true", onClick: function () { } }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editTask(userTask); } }))),
                            userTask.subTasks && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "subtasks" }, userTask.subTasks.map(function (subTask) {
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (subTask.done ? " checked" : ""), onClick: function (ev) {
                                                return !isWorking &&
                                                    _this.props.setSubTaskDone(userTask, subTask, !subTask.done);
                                            } })),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: subTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                "_self" :
                                                "_blank", className: subTask.url ?
                                                undefined :
                                                'link-less' }, subTask.name)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editSubTask(userTask, subTask); } })));
                            })));
                    }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTools" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn addOwnGoal", onClick: function () { return _this.props.addOwnTask(_this.props.courseName, lg.name); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                        " ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: 'userTasks.addLearningGoal', defaultMessage: 'Eget arbetsm\u00E5l' }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
        }));
    };
    UserTasksBox.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__["LanguageContext"];
    return UserTasksBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getTaskUrl(userTask, viewCourseUrl) {
    if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: userTask.course[0].id });
        return courseUrl + "#/task/" + userTask.task[0].id;
    }
    return userTask.url;
}
function getSubjectPlannerTaskUrl(userTask) {
    if (userTask.courseInfo && userTask.task && userTask.task.length > 0) {
        var _a = userTask.courseInfo, school = _a.school, course = _a.course, tab = _a.tab;
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__["default"].KED_SUBJECT_PLANNER_URL, {});
        return courseUrl + "#/" + school + "/courses/" + course + "/tabs/" + tab + "/tasks/" + userTask.task[0].id;
    }
    return userTask.url;
}


/***/ }),

/***/ "./src/components/weekplanner/weekplanner-persisted-state.ts":
/*!*******************************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-persisted-state.ts ***!
  \*******************************************************************/
/*! exports provided: WeekPlannerPersistedState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerPersistedState", function() { return WeekPlannerPersistedState; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");



var WeekPlannerPersistedState = /** @class */ (function () {
    function WeekPlannerPersistedState(userOrCopy) {
        if (typeof userOrCopy === 'string') {
            this.user = userOrCopy;
            this.lastWrite = Date.now();
            this.weekDate = Object(_globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__["localMoment"])().startOf('week').valueOf();
            this.openCourses = {};
        }
        else {
            Object.assign(this, userOrCopy);
        }
    }
    WeekPlannerPersistedState.load = function (user) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var cookie, storedData, state;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                cookie = localStorage.getItem('WeekPlannerPersistedState2');
                storedData = cookie && JSON.parse(cookie);
                state = new WeekPlannerPersistedState(user);
                if (storedData)
                    Object.assign(state, storedData);
                return [2 /*return*/, state.user === user && !state.isExpired(moment__WEBPACK_IMPORTED_MODULE_1___default()()) ?
                        state : new WeekPlannerPersistedState(user)];
            });
        });
    };
    WeekPlannerPersistedState.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.lastWrite = Date.now();
                json = JSON.stringify(this);
                localStorage.setItem('WeekPlannerPersistedState2', json);
                return [2 /*return*/];
            });
        });
    };
    WeekPlannerPersistedState.prototype.isExpired = function (asOf) {
        return moment__WEBPACK_IMPORTED_MODULE_1___default()(this.lastWrite)
            .isBefore(asOf.add(0 - WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours'));
    };
    WeekPlannerPersistedState.EXPIRATION_HOURS = 12;
    WeekPlannerPersistedState.VERSION = 2;
    return WeekPlannerPersistedState;
}());



/***/ }),

/***/ "./src/components/weekplanner/weekplanner.tsx":
/*!****************************************************!*\
  !*** ./src/components/weekplanner/weekplanner.tsx ***!
  \****************************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return WeekPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _user_tasks_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./user-tasks-box */ "./src/components/weekplanner/user-tasks-box.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _refiner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./refiner */ "./src/components/weekplanner/refiner.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _add_custom_goal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-custom-goal */ "./src/components/weekplanner/add-custom-goal.tsx");
/* harmony import */ var _add_custom_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./add-custom-task */ "./src/components/weekplanner/add-custom-task.tsx");
/* harmony import */ var _edit_user_task__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./edit-user-task */ "./src/components/weekplanner/edit-user-task.tsx");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/pending-job */ "./src/utils/pending-job.ts");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _charts_progress__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../charts/progress */ "./src/components/charts/progress.tsx");
/* harmony import */ var _charts_charts_utils__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../charts/charts-utils */ "./src/components/charts/charts-utils.ts");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");





















var MAX_STRATEGY_LENGTH = 16384;
var MAX_ASSESSMENT_LENGTH = 16384;
var WeekPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekPlanner, _super);
    function WeekPlanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            openCourses: {},
            dialogs: [],
            saving: false,
            weekTextsUT: null,
            isLoading: true,
            isCopyingTasks: false
        };
        _this.onChange = _this.onChange.bind(_this);
        _this.weekTextsSavingJob = new _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__["PendingJob"](function () { return _this.saveWeekTexts(); });
        return _this;
    }
    WeekPlanner.prototype.componentDidMount = function () {
        this.props.env.userTasksRepo.subscribe(this.onChange);
    };
    WeekPlanner.prototype.componentWillUnmount = function () {
        this.props.env.userTasksRepo.unsubscribe(this.onChange);
        this.weekTextsSavingJob.stop();
    };
    WeekPlanner.prototype.onChange = function (userTasks, persisted, weekTextsUT) {
        var newState = {
            userTasks: userTasks,
            weekDate: persisted.weekDate,
            openCourses: persisted.openCourses,
            weekTextsUT: weekTextsUT,
            isLoading: false
        };
        if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {
            // Changing week. Reset to new week's values
            newState.strategy = weekTextsUT.weekTexts.strategy;
            newState.assessment = weekTextsUT.weekTexts.assessment;
        }
        this.setState(newState); // React's use of Pick instead of Partial makes things complex here.
    };
    WeekPlanner.prototype.isWeekTextsEdited = function () {
        var _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
        return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);
    };
    WeekPlanner.prototype.saveWeekTexts = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, strategy, assessment, weekTextsUT;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        console.log("Saving texts...");
                        _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
                        if (!this.isWeekTextsEdited()) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.props.env.userTasksRepo.upsert(weekTextsUT, function (ut) {
                                ut.weekTexts = { strategy: strategy, assessment: assessment };
                            })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.prevWeek = function () {
        //this.saveWeekTexts(); 
        var prevWeekObj = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["getPrevWeekDate"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate));
        this.props.env.userTasksRepo.changeWeek(prevWeekObj.nextDate, prevWeekObj.adjusted);
    };
    WeekPlanner.prototype.nextWeek = function () {
        //this.saveWeekTexts();
        var nextWeekObj = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["getNextWeekDate"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate));
        this.props.env.userTasksRepo.changeWeek(nextWeekObj.nextDate, nextWeekObj.adjusted);
    };
    WeekPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    WeekPlanner.prototype.openAddGoalDialog = function () {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_goal__WEBPACK_IMPORTED_MODULE_8__["AddCustomGoal"], { onSave: function (learningGoal) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!learningGoal)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.emptyLearningGoalErr', defaultMessage: 'Lärandemålet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomGoal(learningGoal)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.openAddOwnTaskDialog = function (courseName, learningGoalName) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_task__WEBPACK_IMPORTED_MODULE_9__["AddCustomTask"], { isTask: !courseName, onSave: function (name, description, url) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameCannotBeEmpty', defaultMessage: 'Namnet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomTask(courseName, learningGoalName, name, description, url)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.editTask = function (userTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_user_task__WEBPACK_IMPORTED_MODULE_10__["EditUserTask"], { userTasksRepo: this.props.env.userTasksRepo, userTask: userTask, onUpdate: function (updater) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var test;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            test = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, userTask);
                            updater(test);
                            if (!test.name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameMustNotBeEmpty', defaultMessage: 'Namnet får inte vara tomt' }));
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.update([userTask], updater)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, onDelete: function (id) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.delete([id])];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, openDialog: function (dialog) { return _this.openDialog(dialog); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.editSubTask = function (userTask, subTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__["AddOrEditSubTask"], { userTasksRepo: this.props.env.userTasksRepo, mode: "edit", userTask: userTask, subTask: subTask, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    WeekPlanner.prototype.addCustomGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    learningGoal: learningGoal,
                                    dateTime: latestTimeStamp + 2000
                                }])];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.props.env.userTasksRepo.setWeekPlannerBoxOpen("", true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.removeLearningGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (learningGoal.tasks.length > 0) {
                            if (!confirm(this.context.intl.formatMessage({ id: 'weekplanner.confirmRemoveLearningObjectives', defaultMessage: 'Ta bort lärandemål samt {learningGoalsNumber} uppgifter?' }, { learningGoalsNumber: learningGoal.tasks.length }))) {
                                return [2 /*return*/];
                            }
                        }
                        return [4 /*yield*/, this.props.env.userTasksRepo.delete(learningGoal.allTasks.map(function (t) { return t.id; }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.addCustomTask = function (courseName, learningGoal, name, description, url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    dateTime: latestTimeStamp + 2000,
                                    courseName: courseName,
                                    learningGoal: learningGoal,
                                    name: name,
                                    description: description,
                                    url: url
                                }])];
                    case 1:
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setIsOpen = function (courseName, isOpen) {
        this.props.env.userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);
    };
    WeekPlanner.prototype.setTaskDone = function (task, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setTaskDoneState(task, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setSubTaskDone = function (task, subTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setSubTaskDoneState(task, subTask.id, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.copyFromPreviousWeek = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, userTasks_1, openCourses, weekDate, prevWeek, prevWeekNo, prevKEDWeek, prevTasks, test, latestTimeStamp_1, copies;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.setState({ isCopyingTasks: true })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, , 5, 6]);
                        _a = this.state, userTasks_1 = _a.userTasks, openCourses = _a.openCourses, weekDate = _a.weekDate;
                        prevWeek = moment__WEBPACK_IMPORTED_MODULE_6___default()(weekDate).add(-1, 'week');
                        prevWeekNo = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["getAdjustedWeek"])(prevWeek);
                        prevKEDWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["KEDWeek"])(prevWeek.year(), prevWeekNo);
                        return [4 /*yield*/, this.props.env.kedBackendClient.list("usertasks", {
                                from: prevKEDWeek.notBefore,
                                to: prevKEDWeek.notAfter,
                                role: "USER",
                                include: ["task", "course", "acl"],
                                flags: ["includeIdsOnly"]
                            })];
                    case 3:
                        prevTasks = _b.sent();
                        prevTasks = prevTasks
                            .filter(function (prevTask) { return !prevTask.done; }) // Don't copy done tasks
                            .filter(function (prevTask) { return !!prevTask.name; }) // Don't copy empty learning goals
                            .filter(function (prevTask) { return !userTasks_1.some(function (taskOfCurrentWeek) {
                            return taskOfCurrentWeek.name === prevTask.name &&
                                taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&
                                taskOfCurrentWeek.courseName === prevTask.courseName;
                        }); }); // Ignore identical tasks (already copied)
                        test = [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; }));
                        latestTimeStamp_1 = Math.max.apply(Math.max, [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; })));
                        copies = prevTasks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("dateTime")).map(function (task) {
                            var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, { dateTime: latestTimeStamp_1 += 1000 });
                            copy.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])();
                            if (copy.subTasks) {
                                copy.subTasks = copy.subTasks.filter(function (st) { return !st.done; });
                            }
                            delete copy.$etag;
                            return copy;
                        });
                        // Store it
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert(copies)];
                    case 4:
                        // Store it
                        _b.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        this.setState({ isCopyingTasks: false });
                        return [7 /*endfinally*/];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.getHeaderTitle = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.logBook", defaultMessage: "Loggbok" }));
    };
    WeekPlanner.prototype.render = function () {
        var _this = this;
        var weekNumber = moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).week();
        var showProgressCharts = _features__WEBPACK_IMPORTED_MODULE_20__["features"].weekplannerCharts;
        //console.log("Weekydate: "  + new Date(this.state.weekDate) + " which is week no " + weekNumber);
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_6___default()().week();
        var taskSets = Object(_refiner__WEBPACK_IMPORTED_MODULE_4__["refine"])(this.state.userTasks);
        var _a = this.state, dialogs = _a.dialogs, weekTextsUT = _a.weekTextsUT, strategy = _a.strategy, assessment = _a.assessment, isLoading = _a.isLoading, isCopyingTasks = _a.isCopyingTasks;
        var isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');
        var isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);
        var isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);
        var enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);
        var chartTasks = Object(_charts_charts_utils__WEBPACK_IMPORTED_MODULE_19__["getWeekplannerProgressData"])(taskSets);
        var percentage = chartTasks.totalNumberOfTasks > 0 ? chartTasks.completedTasks / chartTasks.totalNumberOfTasks * 100 : 0;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed weekPlanner" + (weekNumber === currentWeek ? " currentWeek" : ""), onKeyDown: function (ev) {
                    if (ev.which === 83 && ev.ctrlKey) {
                        ev.preventDefault();
                        if (!isSaving && _this.isWeekTextsEdited()) {
                            _this.weekTextsSavingJob.triggerChange(0);
                        }
                    }
                } },
                showProgressCharts && chartTasks.totalNumberOfTasks > 0 && this.getHeaderTitle(),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "widgets" },
                    showProgressCharts && chartTasks.totalNumberOfTasks > 0 ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progressBar" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_progress__WEBPACK_IMPORTED_MODULE_18__["Progress"], { percentage: percentage })) : this.getHeaderTitle(),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "weekSelect" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.weekNumber", values: { weekNumber: weekNumber }, defaultMessage: "Vecka {weekNumber}" }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.prevWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.nextWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" })))))),
                taskSets.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                taskSets.map(function (props) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_user_tasks_box__WEBPACK_IMPORTED_MODULE_2__["UserTasksBox"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ key: props.courseName }, props, { courseName: props.courseName, learningGoals: props.learningGoals, viewCourseUrl: _this.props.viewCourseUrl, openCourses: _this.state.openCourses, addOwnTask: function (courseName, learningGoalName) { return _this.openAddOwnTaskDialog(courseName, learningGoalName); }, setIsOpen: _this.setIsOpen.bind(_this), setTaskDone: _this.setTaskDone.bind(_this), setSubTaskDone: _this.setSubTaskDone.bind(_this), editTask: function (task) { return _this.editTask(task); }, editSubTask: function (task, subTask) { return _this.editSubTask(task, subTask); }, removeLearningGoal: function (lg) { return _this.removeLearningGoal(lg); }, displayProgress: showProgressCharts, progressData: chartTasks.subjectData[props.courseName] }));
                }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                isLoading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__["Spinner"], null) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", onClick: function (ev) { return _this.openAddGoalDialog(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-list-alt", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.learningGoal", defaultMessage: "Eget l\u00E4randem\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", style: isCopyingTasks ? { opacity: 0.5 } : undefined, onClick: function (ev) { return (!isCopyingTasks) && _this.copyFromPreviousWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-clone", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.copyPreviousWeekTaks", defaultMessage: "Kopiera ej klara fr\u00E5n f\u00F6reg\u00E5ende vecka" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategyAndEvaluation", defaultMessage: "Strategi & Utv\u00E4rdering" })), headerOpen: this.state.openCourses["StratUtv"], onOpenClose: function (becameOpen) { return _this.setIsOpen("StratUtv", becameOpen); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategy", defaultMessage: "Strategi" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategyDescription", defaultMessage: "Hur jag ska g\u00F6ra f\u00F6r att l\u00E4ra mig." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", disabled: this.props.env.tutored, value: strategy && strategy.substr(0, MAX_STRATEGY_LENGTH), onChange: function (ev) {
                                _this.setState({ strategy: (ev.target.value || '').substr(0, MAX_STRATEGY_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.evaluation", defaultMessage: "Utv\u00E4rdering" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.evaluationDescription", defaultMessage: "Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utv\u00E4rdera i f\u00F6rh\u00E5llande till dina m\u00E5l." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", value: assessment && assessment.substr(0, MAX_ASSESSMENT_LENGTH), disabled: this.props.env.tutored, onChange: function (ev) {
                                _this.setState({ assessment: (ev.target.value || '').substr(0, MAX_ASSESSMENT_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", tabIndex: 0, style: enableSaveButton ? {} : { opacity: 0.5 }, onClick: function () { return !isSaving && _this.weekTextsSavingJob.triggerChange(0); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-floppy-o", "aria-hidden": "true" }),
                            enableSaveButton ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "common.save", defaultMessage: " Spara" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "common.saved", defaultMessage: " Sparad" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__["Dialogs"], { dialogs: dialogs, popDialog: function () {
                    _this.setState(function (_a) {
                        var dialogs = _a.dialogs;
                        return ({ dialogs: dialogs.slice(0, dialogs.length - 1) });
                    });
                } }));
    };
    WeekPlanner.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_17__["LanguageContext"];
    return WeekPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/features/feature-flags.json":
/*!*****************************************!*\
  !*** ./src/features/feature-flags.json ***!
  \*****************************************/
/*! exports provided: picker, ksTutorComment, kgTutorComment, termplannerCharts, weekplannerCharts, teacherRights, studyGroups, cbCollapseBoxes, ksAssignments, markPartialKRs, default */
/***/ (function(module) {

module.exports = {"picker":"Integrate coursebuilder and subjectplanner with Google Picker","ksTutorComment":"Integrate KSTermplanner with tutor comments","kgTutorComment":"Integrate KSTermplanner  with tutor comments","termplannerCharts":"Integrate KSTermplanner with progress charts","weekplannerCharts":"Integrate Weekplanner with progress charts","teacherRights":"Activate course builder teacher rights","studyGroups":"Add study groups and google classroom functionality","cbCollapseBoxes":"Course Builder: Collapse modules by default","ksAssignments":"KS show hand-in assignments","markPartialKRs":"Activate mark partial knowledge requirments functionality"};

/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "features", function() { return features; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./feature-flags.json */ "./src/features/feature-flags.json");
var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./feature-flags.json */ "./src/features/feature-flags.json", 1);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");




var Features = /** @class */ (function () {
    function Features() {
        var e_1, _a;
        this._initialized = false;
        var _loop_1 = function (featureName) {
            Object.defineProperty(this_1, featureName, {
                get: function () {
                    if (!this._initialized)
                        this.init();
                    return this._features[featureName];
                },
                set: function (value) {
                    throw new Error('Feature flags cannot be set here');
                }
            });
        };
        var this_1 = this;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                _loop_1(featureName);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    Features.prototype.init = function () {
        var e_2, _a;
        if (this._initialized)
            return;
        var turnedOnFeatures = (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["cfg"].KED_FEATURES || "").split(',').map(function (name) { return name.trim().toLowerCase(); });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(location.search, { toLower: true });
        if (query.testversion) {
            turnedOnFeatures = ["*"];
        }
        if (query.features) {
            turnedOnFeatures = query.features
                .split(',')
                .map(function (feature) { return feature.trim().toLowerCase(); });
        }
        var turnOnAll = turnedOnFeatures.includes('*');
        this._features = {};
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                this._features[featureName] = turnOnAll ||
                    turnedOnFeatures.includes(featureName.toLowerCase());
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._initialized = true;
    };
    return Features;
}());

var features = new Features();


/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://backend.kedschools.com/kedbackend-next/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE || "sv"; // "sv", "en". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE || "sv"; // "sv", "en_sin", "en_nin". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL || process.env.KED_RESOURCES_URL;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive"
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive"
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default, cfg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cfg", function() { return cfg; });
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);
var cfg = _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg;


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default, env */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "env", function() { return env; });
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);
var env = _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env;


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "./kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.displayName || _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/moment-sv-locale.ts":
/*!*****************************************!*\
  !*** ./src/globals/moment-sv-locale.ts ***!
  \*****************************************/
/*! exports provided: localMoment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localMoment", function() { return localMoment; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");


if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE === "sv") {
    moment__WEBPACK_IMPORTED_MODULE_0___default.a.updateLocale('sv', {
        months: 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),
        monthsShort: 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),
        weekdays: 'söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag'.split('_'),
        weekdaysShort: 'sön_mån_tis_ons_tor_fre_lör'.split('_'),
        weekdaysMin: 'sö_må_ti_on_to_fr_lö'.split('_'),
        longDateFormat: {
            LT: 'HH:mm',
            LTS: 'HH:mm:ss',
            L: 'YYYY-MM-DD',
            LL: 'D MMMM YYYY',
            LLL: 'D MMMM YYYY [kl.] HH:mm',
            LLLL: 'dddd D MMMM YYYY [kl.] HH:mm',
            lll: 'D MMM YYYY HH:mm',
            llll: 'ddd D MMM YYYY HH:mm'
        },
        calendar: {
            sameDay: '[Idag] LT',
            nextDay: '[Imorgon] LT',
            lastDay: '[Igår] LT',
            nextWeek: '[På] dddd LT',
            lastWeek: '[I] dddd[s] LT',
            sameElse: 'L'
        },
        relativeTime: {
            future: 'om %s',
            past: 'för %s sedan',
            s: 'några sekunder',
            ss: '%d sekunder',
            m: 'en minut',
            mm: '%d minuter',
            h: 'en timme',
            hh: '%d timmar',
            d: 'en dag',
            dd: '%d dagar',
            M: 'en månad',
            MM: '%d månader',
            y: 'ett år',
            yy: '%d år'
        },
        dayOfMonthOrdinalParse: /\d{1,2}(e|a)/,
        ordinal: function (number) {
            var b = number % 10, output = (~~(number % 100 / 10) === 1) ? 'e' :
                (b === 1) ? 'a' :
                    (b === 2) ? 'a' :
                        (b === 3) ? 'e' : 'e';
            return number + output;
        },
        week: {
            dow: 1,
            doy: 4 // The week that contains Jan 4th is the first week of the year.
        }
    });
}
var localMoment = function () {
    return moment__WEBPACK_IMPORTED_MODULE_0___default.a.apply(this, arguments).locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE);
};


/***/ }),

/***/ "./src/repos/hidden-courses-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/hidden-courses-repo.ts ***!
  \******************************************/
/*! exports provided: hiddenCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hiddenCoursesRepo", function() { return hiddenCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);








var hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo;
var HiddenCoursesRepo = /** @class */ (function () {
    function HiddenCoursesRepo() {
        var _this = this;
        this.result = null;
        this.subscribers = [];
        this.fullCourse = false;
        this.notifySubscriber = function (subscriber, options) {
            try {
                subscriber(options.fullCourse ? _this.result : _this.result.filter(function (c) { return c.visible; }));
            }
            catch (err) {
                console.error(err);
            }
        };
        this.kedRepo = new _ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]({
            getClient: function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; },
            optimistic: true,
            table: "userhiddencourses",
            user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, ({ role: "USER" })];
            }); }); },
        });
        var initPromise = this.init();
        Promise.all([
            initPromise,
            this.kedCoursesPromise,
            this.edsCoursesPromise
        ]).catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    }
    HiddenCoursesRepo.prototype.init = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var bearerPromise, resolveUserHiddenCoursesPromise, userHiddenCoursesResolved;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer() : Promise.resolve({});
                        // In parallell, we request:
                        //  1) KEDBackend: Schools.activeCourses
                        //  2) EDS.getActiveAcourses()
                        //  3) (via subscription): KEDBackend: userHiddenCourses
                        this.kedCoursesPromise = bearerPromise.then(function () { return _this.listKedCourses(); });
                        this.edsCoursesPromise = bearerPromise.then(function () { return _this.listEDSCourses(); });
                        userHiddenCoursesResolved = false;
                        this.userHiddenCoursesPromise = new Promise(function (resolve) { return resolveUserHiddenCoursesPromise = function (x) {
                            if (userHiddenCoursesResolved) {
                                _this.userHiddenCoursesPromise = Promise.resolve(x);
                            }
                            else {
                                userHiddenCoursesResolved = true;
                                resolve(x);
                            }
                        }; });
                        return [4 /*yield*/, bearerPromise];
                    case 1:
                        _a.sent();
                        this.kedRepo.mem.subscribe(function (userHiddenCourses) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a, activeCourses, edsActiveCourses, _b;
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                                switch (_c.label) {
                                    case 0: return [4 /*yield*/, Promise.all([
                                            this.kedCoursesPromise,
                                            this.edsCoursesPromise
                                        ])];
                                    case 1:
                                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 2]), activeCourses = _a[0], edsActiveCourses = _a[1];
                                        // Refine the three results into a single result
                                        _b = this;
                                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                                    case 2:
                                        // Refine the three results into a single result
                                        _b.result = _c.sent();
                                        // Notify our subscribers:
                                        this.subscribers.forEach(function (subscriber) { return _this.notifySubscriber(subscriber.subscriber, subscriber.options); });
                                        resolveUserHiddenCoursesPromise(userHiddenCourses);
                                        return [2 /*return*/];
                                }
                            });
                        }); });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listKedCourses = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var fullCourse, schools, activeCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        fullCourse = this.fullCourse;
                        console.log("FullCourse: " + fullCourse);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list('schools', {
                                role: "USER",
                                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school,
                                include: "activeCourses",
                                flags: fullCourse ? [] : ["includeIdsAndNamesOnly"],
                                cacheBust: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.username
                            })];
                    case 1:
                        schools = _a.sent();
                        activeCourses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.activeCourses; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        return [2 /*return*/, activeCourses];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listEDSCourses = function () {
        var periodName = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__["EDSPeriod"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_7___default()())).period;
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.indexOf('EMPLOYEE') === -1 ?
            // STUDENTs should, by default, only show courses that is listed in EDS
            _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].edsClient.getActiveCourses({ periodName: periodName }) :
            // EMPLOYEEs should, by default, show all courses on school - no need to query EDS
            null;
    };
    HiddenCoursesRepo.prototype.createCoursesList = function (edsActiveCourses, userHiddenCourses, activeCourses) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var hiddenCoursesMap, visibleCoursesMap, isStudent, edsCourseMap, result;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        hiddenCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return !hc.show; }), function (hc) { return hc.name; });
                        visibleCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return hc.show; }), function (hc) { return hc.name; });
                        isStudent = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.some(function (role) { return role === 'STUDENT'; });
                        edsCourseMap = edsActiveCourses ?
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(edsActiveCourses, function (c) { return c.name; }) :
                            {};
                        return [4 /*yield*/, Promise.all(activeCourses.map(function (_a) {
                                var id = _a.id, name = _a.name, description = _a.description, modifiedBy = _a.modifiedBy;
                                return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                                    var edsCourse, defaultVisible, visible;
                                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                        edsCourse = edsCourseMap[name];
                                        defaultVisible = isStudent ?
                                            edsCourse != null : // Course name also listed in EDS
                                            true;
                                        visible = defaultVisible ?
                                            !hiddenCoursesMap[id] : // Visible unless user has overridden that.
                                            !!visibleCoursesMap[id];
                                        // Resolve description:
                                        if (modifiedBy && modifiedBy.name && !description) {
                                            description = modifiedBy.name + "s version";
                                        }
                                        return [2 /*return*/, {
                                                id: id,
                                                name: name,
                                                description: description,
                                                visible: visible,
                                                defaultVisible: defaultVisible
                                            }];
                                    });
                                });
                            }))];
                    case 1:
                        result = _a.sent();
                        return [2 /*return*/, result.sort(function (_a, _b) {
                                var a = _a.name;
                                var b = _b.name;
                                return a < b ? -1 : a > b ? 1 : 0;
                            })];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.hideCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                    name: c.id
                                }])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.showCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.insert([{
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                name: c.id,
                                show: true
                            }])];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.subscribe = function (subscriber, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, activeCourses, edsActiveCourses, userHiddenCourses, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!(!this.fullCourse && options.fullCourse)) return [3 /*break*/, 3];
                        // The subscriber demands full courses
                        // Need to query that before notifying
                        // Also affect state for future internal notification
                        this.fullCourse = options.fullCourse;
                        this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses
                        return [4 /*yield*/, Promise.all([
                                this.kedCoursesPromise,
                                this.edsCoursesPromise,
                                this.userHiddenCoursesPromise
                            ])];
                    case 1:
                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 3]), activeCourses = _a[0], edsActiveCourses = _a[1], userHiddenCourses = _a[2];
                        // Assemble result:
                        _b = this;
                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                    case 2:
                        // Assemble result:
                        _b.result = _c.sent();
                        _c.label = 3;
                    case 3: return [4 /*yield*/, this.userHiddenCoursesPromise];
                    case 4:
                        _c.sent(); // So we know that this.result is there.
                        this.notifySubscriber(subscriber, options);
                        this.subscribers.push({ subscriber: subscriber, options: options });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s.subscriber !== subscriber; });
    };
    return HiddenCoursesRepo;
}());
if (!hiddenCoursesRepo) {
    hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo = new HiddenCoursesRepo();
}


/***/ }),

/***/ "./src/repos/ked-repo.ts":
/*!*******************************!*\
  !*** ./src/repos/ked-repo.ts ***!
  \*******************************/
/*! exports provided: KedRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedRepo", function() { return KedRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");



var KedRepo = /** @class */ (function () {
    function KedRepo(options) {
        var _this = this;
        var table = options.table, getClient = options.getClient, getQueryOptions = options.getQueryOptions;
        this.mem = new _repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]({ query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var queryOptions;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, getQueryOptions()];
                        case 1:
                            queryOptions = _a.sent();
                            return [4 /*yield*/, getClient().list(table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, queryOptions, { cacheBust: this.getCacheBust() }))];
                        case 2: return [2 /*return*/, _a.sent()];
                    }
                });
            }); } });
        this.options = options;
    }
    KedRepo.prototype.getCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);
        return cacheBust || this.regenerateCacheBust();
    };
    KedRepo.prototype.regenerateCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
        localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);
        return cacheBust;
    };
    KedRepo.prototype.upsert = function (item, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItem;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!!item.$etag) return [3 /*break*/, 2];
                        updatedItem = Object.assign({}, item);
                        updater(updatedItem);
                        return [4 /*yield*/, this.insert([updatedItem])];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2: 
                    // We have an $etag, so we can expect it to live on the server.
                    // However, take care of the unlikely situation that it was deleted from server,
                    // and if so, insert it again.
                    return [4 /*yield*/, this.update([item], updater).catch(function (e) {
                            if (e.name === "http404") {
                                var updatedItem = Object.assign({}, item);
                                updater(updatedItem);
                                return _this.insert([updatedItem]);
                            }
                            return Promise.reject(e);
                        })];
                    case 3:
                        // We have an $etag, so we can expect it to live on the server.
                        // However, take care of the unlikely situation that it was deleted from server,
                        // and if so, insert it again.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.update = function (items, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItems, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItems = items.map(function (item) {
                            var memRepoItem = _this.mem.items.find(function (it) { return it.id === item.id; });
                            item = Object.assign({}, memRepoItem || item);
                            updater(item);
                            return item;
                        });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(modifiedItems.map(function (x) { return Object.assign({}, x, { $meta: 'updating' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); })
                            .catch(function (e) { return e.name === "http409" ? // conflict
                            // Get a fresh version from server:
                            client.list(table, { ids: items.map(function (item) { return item.id; }) }, { cache: 'no-cache' }).then(function (freshItems) {
                                // Update local version:
                                var modifiedItems = freshItems.map(function (freshItem) {
                                    // Clone the fresh item
                                    var modified = Object.assign({}, freshItem);
                                    // Re-run the updater on the clone:
                                    updater(modified);
                                    return modified;
                                });
                                // Re-do the the put operation towards the server.
                                return client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); });
                            }) :
                            // Other unexpected error:
                            Promise.resolve(optimistic &&
                                _this.mem.update(items)) // Undo optimistic update
                                .then(function () {
                                return Promise.reject(e); // Reject with the error no matter.
                            }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        modifiedItems.forEach(function (item) {
                            item.$etag = res.newEtags[item.id];
                            item.$meta = undefined;
                        });
                        return [4 /*yield*/, this.mem.update(modifiedItems)];
                    case 4:
                        _b.sent(); // Ensures new etag is is applied on next action.
                        return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.stripGraphs = function (items, graphs) {
        return items.map(function (item) {
            var clone = Object.assign({}, item);
            graphs.forEach(function (graph) {
                if (item[graph]) {
                    clone[graph] = item[graph].map(function (doc) { return ({ id: doc.id }); });
                }
            });
            return clone;
        });
    };
    KedRepo.prototype.insert = function (items) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, getQueryOptions, client, queryOptions, graphs, stripped, br, _loop_1, stripped_1, stripped_1_1, item, res;
            var e_1, _b;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table, getQueryOptions = _a.getQueryOptions;
                        client = getClient();
                        return [4 /*yield*/, getQueryOptions()];
                    case 1:
                        queryOptions = _c.sent();
                        graphs = [].concat(queryOptions.include);
                        // Give IDs to each item:
                        items = items.map(function (item) { return item.id ? item : Object.assign({}, item, { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])() }); });
                        stripped = this.stripGraphs(items, graphs);
                        if (!optimistic) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.mem.insert(stripped.map(function (x) { return Object.assign({}, x, { $meta: 'adding' }); }))];
                    case 2:
                        _c.sent();
                        _c.label = 3;
                    case 3:
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
                        _loop_1 = function (item) {
                            var e_2, _a;
                            var _loop_2 = function (graph) {
                                var foreignItems = item[graph];
                                if (foreignItems) {
                                    foreignItems.forEach(function (doc) {
                                        br.link2(table, item.id, graph, doc.id);
                                    });
                                }
                            };
                            try {
                                // Also add links to all foreign related items:
                                for (var graphs_1 = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs)), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
                                    var graph = graphs_1_1.value;
                                    _loop_2(graph);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                            br.add(table, item);
                        };
                        try {
                            for (stripped_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](stripped), stripped_1_1 = stripped_1.next(); !stripped_1_1.done; stripped_1_1 = stripped_1.next()) {
                                item = stripped_1_1.value;
                                _loop_1(item);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (stripped_1_1 && !stripped_1_1.done && (_b = stripped_1.return)) _b.call(stripped_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        return [4 /*yield*/, client.batch(br.mutationRequests).catch(function (e) {
                                if (optimistic)
                                    _this.mem.delete(items.map(function (item) { return item.id; }));
                                return Promise.reject(e);
                            })];
                    case 4:
                        res = _c.sent();
                        this.regenerateCacheBust();
                        items.forEach(function (item) { return item.$etag = res.newEtags[item.id]; });
                        if (!optimistic) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.mem.update(items)];
                    case 5:
                        _c.sent(); // Update with new $etag.
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.mem.insert(items)];
                    case 7:
                        _c.sent();
                        _c.label = 8;
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.delete = function (ids) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(ids
                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                .filter(function (x) { return x; })
                                .map(function (x) { return Object.assign({}, x, { $meta: 'deleting' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return ids.forEach(function (id) { return br.delete(table, id); }); }).catch(function (e) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        if (!optimistic) return [3 /*break*/, 2];
                                        return [4 /*yield*/, this.mem.update(ids
                                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                                .filter(function (x) { return x; })
                                                .map(function (x) {
                                                x = Object.assign({}, x);
                                                delete x.$meta;
                                                return x;
                                            }))];
                                    case 1:
                                        _a.sent();
                                        _a.label = 2;
                                    case 2: throw e;
                                }
                            });
                        }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        return [4 /*yield*/, this.mem.delete(ids)];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedRepo;
}());



/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/user-tasks-repo.ts":
/*!**************************************!*\
  !*** ./src/repos/user-tasks-repo.ts ***!
  \**************************************/
/*! exports provided: userTasksRepo, UserTasksRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "userTasksRepo", function() { return userTasksRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksRepo", function() { return UserTasksRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/weekplanner/weekplanner-persisted-state */ "./src/components/weekplanner/weekplanner-persisted-state.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/weekutil */ "./src/utils/weekutil.ts");







var userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo;
var UserTasksRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksRepo, _super);
    function UserTasksRepo(getClient, getCurrentUser) {
        var _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "usertasks",
            user: getCurrentUser() ? getCurrentUser().mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var currentUser, userEmail, _a, weekDate, weekNumber, kedWeek;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            currentUser = getCurrentUser();
                            userEmail = currentUser ? currentUser.mail : "";
                            if (!!this.persistedState) return [3 /*break*/, 2];
                            _a = this;
                            return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(userEmail)];
                        case 1:
                            _a.persistedState = _b.sent();
                            _b.label = 2;
                        case 2:
                            weekDate = this.persistedState.weekDate;
                            weekNumber = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).week();
                            kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_6__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).year(), weekNumber);
                            /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]
                              .map(m => m.toDate().getTime());*/
                            return [2 /*return*/, {
                                    from: kedWeek.notBefore,
                                    to: kedWeek.notAfter,
                                    role: "USER",
                                    include: ["task", "course"],
                                    flags: ["includeIdsOnly"],
                                }];
                    }
                });
            }); }
        }) || this;
        _this.persistedState = null;
        _this.getCurrentUser = getCurrentUser;
        return _this;
    }
    UserTasksRepo.prototype.updatePersistedState = function (stateChanges) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object.assign(this.persistedState, stateChanges);
                        return [4 /*yield*/, this.persistedState.save()];
                    case 1:
                        _a.sent();
                        this.mem.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setTaskDoneState = function (userTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItem, similarTasks, identicalTasks;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItem = Object.assign({}, userTask, { done: done });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(Object.assign({}, modifiedItem, { $meta: 'updating' }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.list('usertasks', {
                            name: userTask.name,
                            role: "USER",
                            include: ["task", "course"],
                            flags: ["includeIdsOnly"],
                            from: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),
                            to: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(3, 'weeks').valueOf()
                        }, {
                            cache: 'no-cache'
                        })];
                    case 3:
                        similarTasks = _b.sent();
                        identicalTasks = similarTasks.filter(function (t) {
                            return t.courseName === userTask.courseName &&
                                t.learningGoal === userTask.learningGoal &&
                                (!userTask.task || t.task.map(function (t) { return t.id; }).join('') === userTask.task.map(function (t) { return t.id; }).join('')) &&
                                (!userTask.course || t.course.map(function (c) { return c.id; }).join('') === userTask.course.map(function (c) { return c.id; }).join(''));
                        });
                        if (identicalTasks.length === 0) {
                            // Workaround for issue in SubjectPlanner migration (usertasks with long names is not found)
                            identicalTasks.push(userTask);
                        }
                        return [4 /*yield*/, this.update(identicalTasks, function (t) { return t.done = done; })];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setSubTaskDoneState = function (userTask, subTaskId, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        return [4 /*yield*/, this.update([userTask], function (t) { return t.subTasks && t.subTasks.filter(function (st) { return st.id === subTaskId; })
                                .forEach(function (st) { return st.done = done; }); })];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setWeekPlannerBoxOpen = function (courseName, isOpen) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var openCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        openCourses = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.persistedState.openCourses);
                        if (isOpen)
                            openCourses[courseName] = true;
                        else
                            delete openCourses[courseName];
                        return [4 /*yield*/, this.updatePersistedState({ openCourses: openCourses })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.changeWeek = function (weekDate, keepCurrentDate) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedState, newPersisted;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        persistedState = this.persistedState;
                        if (!!persistedState) return [3 /*break*/, 2];
                        return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(this.options.user)];
                    case 1:
                        persistedState = _a.sent();
                        _a.label = 2;
                    case 2:
                        newPersisted = new _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"](persistedState);
                        newPersisted.weekDate = keepCurrentDate ? moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).valueOf() : moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).startOf('week').valueOf();
                        newPersisted.save();
                        this.persistedState = newPersisted;
                        return [4 /*yield*/, this.mem.refreshFromServer()];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.subscribe = function (subscriber) {
        var _this = this;
        var proxySubscriber = function (userTasks) {
            subscriber(userTasks.filter(function (ut) { return !ut.weekTexts; }), _this.persistedState, userTasks.filter(function (ut) { return !!ut.weekTexts; })[0] || {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                dateTime: _this.persistedState.weekDate,
                weekTexts: { assessment: '', strategy: '' },
                acl: [
                    // Default ACL: Let user self have full control over this item:
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("email", _this.getCurrentUser().mail, "S"),
                    // Additional ACL: Let employees on same school have read access to it.
                    // This currently only applies to tasks that refer to course tasks (not own tasks!)
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", _this.getCurrentUser().school + "/EMPLOYEE", "R")
                ].map(function (ac) { return ac.toString(); })
            });
        };
        proxySubscriber["subscriber"] = subscriber;
        this.mem.subscribe(proxySubscriber);
    };
    UserTasksRepo.prototype.unsubscribe = function (subscriber) {
        this.mem.subscribers = this.mem.subscribers.filter(function (s) { return s["subscriber"] !== subscriber; });
    };
    return UserTasksRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

if (!userTasksRepo) {
    userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo = new UserTasksRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser; });
    userTasksRepo.mem.ensureHasData();
}


/***/ }),

/***/ "./src/test/data/users.ts":
/*!********************************!*\
  !*** ./src/test/data/users.ts ***!
  \********************************/
/*! exports provided: users */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "users", function() { return users; });
var users = [{
        displayName: "Administratör",
        mail: "vemendo@kedschools.com",
        roles: ['ADMIN', 'EMPLOYEE'],
        school: 'KED',
        username: "admin"
    }, {
        displayName: "David",
        mail: "david.fahlander@vemendo.se",
        roles: ['ADMIN', 'EMPLOYEE'],
        school: 'KED',
        username: "david"
    },
    {
        displayName: "Andrei",
        mail: "andrei.spatarelu@vemendo.se",
        roles: ['ADMIN', 'EMPLOYEE', 'STUDENT'],
        school: 'KED',
        username: "andrei"
    }, {
        displayName: "Carl Holmberg",
        mail: "carl.holmberg@kunskapsgymnasiet.se",
        roles: ['ADMIN', 'EMPLOYEE'],
        school: 'Norrköping',
        username: "carl.holmberg@kunskapsgymnasiet.se"
    }, {
        displayName: "Carl",
        mail: "carl@kedschools.com",
        roles: ['ADMIN', 'EMPLOYEE', 'STUDENT'],
        school: 'KED',
        username: "carl"
    }, {
        displayName: "david.fahlander@kedschools.com",
        mail: "david.fahlander@kedschools.com",
        roles: ["ADMIN", "EMPLOYEE", "STUDENT"],
        school: "KED",
        username: "david.fahlander@kedschools.com"
    }, {
        displayName: "Teacher 1",
        mail: "teacher1.classroom@kedschools.com",
        roles: ['EMPLOYEE'],
        school: 'KED',
        username: "teacher1.classroom@kedschools.com"
    }, {
        displayName: "Test-Live-Elev1",
        mail: "ubw6757@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "ubw6757@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev2",
        mail: "ums4302@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "ums4302@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev3",
        mail: "uhh3460@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "uhh3460@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev4(fel goals issue)",
        mail: "umt6826@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "umt6826@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Elev5(future abilities)",
        mail: "ujg3833@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "ujg3833@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Elev6(future abilities)",
        mail: "ujt1363@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "ujt1363@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Lärare1",
        mail: "rickard.albertsson@kunskapsgymnasiet.se",
        roles: ['EMPLOYEE'],
        school: 'Uppsala',
        username: "rickard.albertsson@kunskapsgymnasiet.se"
    }, {
        displayName: "EDSTestUserGymnasium",
        mail: "uhh3200@edu.kunskapsgymnasiet.se",
        //mail: "UHH3200@EDU.KUNSKAPSGYMNASIET.SE",
        roles: ["STUDENT"],
        username: "EDSTestUser1",
        school: "KED",
        schoolType: "Gymnasium"
    }, {
        displayName: "vemendo.elev@kedschools.com",
        mail: "vemendo.elev@kedschools.com",
        roles: ["STUDENT"],
        username: "vemendo.elev@kedschools.com",
        school: "KED",
        schoolType: "Gymnasium"
    }, {
        displayName: "Medarbetare Nacka",
        mail: "medarbetare.nacka@kunskapsskolan.se",
        roles: ["EMPLOYEE"],
        username: "medarbetare.nacka/KS",
        school: "Nacka",
        schoolType: "Grundskolor"
    }, {
        displayName: "Medarbetare Globen",
        mail: "medarbetare.globen@kunskapsgymnasiet.se",
        roles: ["EMPLOYEE"],
        username: "medarbetare.globen/KS",
        school: "Globen",
        schoolType: "Gymnasium"
    }, {
        displayName: "Elev Globen",
        mail: "elev.globen@edu.kunskapsgymnasiet.se",
        schoolGrade: 2,
        roles: ['STUDENT'],
        username: "elev.globen",
        school: "Globen",
        schoolType: "Gymnasium"
    }, {
        displayName: "Elev Borås",
        mail: "elev.boras@edu.kunskapsskolan.se",
        schoolGrade: 7,
        roles: ['STUDENT'],
        username: "elev.boras",
        school: "Borås",
        schoolType: "Grundskolor"
    }, {
        displayName: "Elev Borlänge",
        mail: "elev.borlange@edu.kunskapsskolan.se",
        schoolGrade: 9,
        roles: ['STUDENT'],
        username: 'elev.borlange/KS',
        school: 'Borlänge',
        schoolType: "Gymnasium"
    }, {
        displayName: "Roll-lös",
        mail: "none@kunskapsskolan.se",
        username: "none",
        roles: []
    }];


/***/ }),

/***/ "./src/test/set-current-user.ts":
/*!**************************************!*\
  !*** ./src/test/set-current-user.ts ***!
  \**************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _data_users__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data/users */ "./src/test/data/users.ts");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");



var username = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_2__["parseQueryString"])(location.search).user;
if (username) {
    var user = _data_users__WEBPACK_IMPORTED_MODULE_1__["users"].find(function (u) { return u.username === username; });
    if (user) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser = user;
    }
}
var _a = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_2__["parseQueryString"])(location.search), role = _a.role, school = _a.school;
if (_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser) {
    if (role) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles = role.split(',');
    }
    if (school) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school = school;
    }
}


/***/ }),

/***/ "./src/test/test-config.ts":
/*!*********************************!*\
  !*** ./src/test/test-config.ts ***!
  \*********************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = 'sv';
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = 'sv';


/***/ }),

/***/ "./src/test/testpage-courseviewer.tsx":
/*!********************************************!*\
  !*** ./src/test/testpage-courseviewer.tsx ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _set_current_user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-current-user */ "./src/test/set-current-user.ts");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _test_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./test-config */ "./src/test/test-config.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _utils_choose_user__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils/choose-user */ "./src/test/utils/choose-user.tsx");
/* harmony import */ var _components_course_viewer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../components/course-viewer */ "./src/components/course-viewer/index.tsx");
/* harmony import */ var _utils_include_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils/include-css */ "./src/test/utils/include-css.ts");
/* harmony import */ var _utils_include_optional_css__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils/include-optional-css */ "./src/utils/include-optional-css.ts");
/* harmony import */ var _components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../components/utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../components/utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");

// <Initialization>
 // Emulate server-side script to set current user
 // Client-side initialization

// </Initialization>









Object(_utils_include_optional_css__WEBPACK_IMPORTED_MODULE_9__["includeOptionalCSS"])({
    v1: [
        'css/courseviewer.css',
        'css/dialog.css',
        'css/grid-css-patch.css'
    ],
    includeCSS: _utils_include_css__WEBPACK_IMPORTED_MODULE_8__["includeCSS"],
    version: 6,
    versionFolder: 'css/delta-css/courseviewer'
});
var _App = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_App, _super);
    function _App() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    _App.prototype.render = function () {
        var intl = this.props.intl;
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser ?
            react__WEBPACK_IMPORTED_MODULE_5__["createElement"](_components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_12__["LanguageContext"].Provider, { value: { intl: intl } },
                react__WEBPACK_IMPORTED_MODULE_5__["createElement"](_components_course_viewer__WEBPACK_IMPORTED_MODULE_7__["CourseViewer"], { courseBuilderUrl: "coursebuilder.html" })) :
            react__WEBPACK_IMPORTED_MODULE_5__["createElement"](_utils_choose_user__WEBPACK_IMPORTED_MODULE_6__["ChooseUser"], null);
    };
    return _App;
}(react__WEBPACK_IMPORTED_MODULE_5__["Component"]));
var App = Object(_components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_11__["injectIntl"])(_App));
/* harmony default export */ __webpack_exports__["default"] = (App);


/***/ }),

/***/ "./src/test/utils/choose-user.tsx":
/*!****************************************!*\
  !*** ./src/test/utils/choose-user.tsx ***!
  \****************************************/
/*! exports provided: ChooseUser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChooseUser", function() { return ChooseUser; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _data_users__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data/users */ "./src/test/data/users.ts");


function ChooseUser() {
    var select;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "V\u00E4lj anv\u00E4ndare"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("table", { className: "login-table" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("thead", null,
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", null,
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Namn"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Roller"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "E-post"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Skola"))),
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tbody", null, _data_users__WEBPACK_IMPORTED_MODULE_1__["users"].map(function (_a) {
                var username = _a.username, displayName = _a.displayName, mail = _a.mail, school = _a.school, roles = _a.roles;
                return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", { key: mail, onClick: function () { return location.search = "?user=" + username; } },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, displayName),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", { style: roles.length === 0 ? { fontStyle: 'italic' } : {} }, roles.length === 0 ? "saknar roller" : roles.join(', ')),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, mail),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", { style: school ? {} : { fontStyle: 'italic' } }, school || "saknar skola"));
            }))));
}
;


/***/ }),

/***/ "./src/test/utils/include-css.ts":
/*!***************************************!*\
  !*** ./src/test/utils/include-css.ts ***!
  \***************************************/
/*! exports provided: includeCSS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "includeCSS", function() { return includeCSS; });
function resolve(uri) {
    var href = location.protocol + "//" + location.host + location.pathname;
    var pLastSlash = href.lastIndexOf('/');
    return href.substr(0, pLastSlash + 1) + uri;
}
function includeCSS(cssFile) {
    document.write('<link rel="stylesheet" href="' + resolve(cssFile) + '" />');
}


/***/ }),

/***/ "./src/translations/en.json":
/*!**********************************!*\
  !*** ./src/translations/en.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, addeditsubtask.addSubtask, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.ict, termplanner.loadingTermplanner, termplanner.maths, termplanner.modernLanguage, termplanner.noFinalStepAvailable, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, termplanner.yoga, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.deleteSubtask":"Delete subtask","addeditsubtask.editSubtask":"Edit subtask","addeditsubtask.nameLabel":"Name of subtask","addeditsubtask.addSubtask":"Add sub-task","calendar.currentDate":"Week {week}, {year}","calendar.fullDayEventLocation":"Place: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"W{weekNumber}","common.addDescriptionPlhd":"Add description...","common.cancel":"Cancel","common.changesNotSavedErrorOccured":"An error occured while saving data. Your changes were not saved.","common.changesNotSavedUnauthorized":"The changes were not saved due to insufficient authority","common.descriptionLabel":"Description","common.errorSavingData":"An error occured while saving data.","common.linkLabel":"Link","common.loading":"Loading...","common.nameLabel":"Name","common.save":" Save","common.saved":" Saved","common.saving":"Saving","common.remove":"Delete","customTask.addWorkGoalTitle":"Add own working goal","customTask.enterNamePlhd":"Enter Name...","learningGoalsLost.overall":"Overall","task.addSubtask":"Add subtask","task.editTask":"Edit task","task.editWorkGoals":"Edit working goal","task.enterTaskNamePlhd":"Enter the name of task...","task.removeDeadline":"Delete deadline","task.removeThisTask":"Delete this task","task.removeWorkGoals":"Delete working goal","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Set deadline...","task.subTasks":"Subtasks","task.targetNameLabel":"Name of working goal","task.taskNameLabel":"Name of task","task.whatShouldYouDoPlhd":"What should you do?","taskList.nextWeekTask":"for next week (w{week})","taskList.lastWeekTask":"for last week (w{week})","taskList.currentWeekTask":"for week {week}","taskList.removeTaskFromWeeklyPlanning":"Delete task from your weekly planning {week}","taskList.addTaskToWeeklyPlanning":"Add task to your weekly planning {week}","termplanner.comments":"Comments","termplanner.course":"Theme course","termplanner.edsGoalGrades":"Intermediate goals","termplanner.englishLanguage":"Eng","termplanner.finalStep":"Final Step","termplanner.firstTerm":"FT {year}","termplanner.hindiLanguage":"Hindi","termplanner.ict":"ICT","termplanner.loadingTermplanner":"Loading Termplanner","termplanner.maths":"Maths","termplanner.modernLanguage":"MFL","termplanner.noFinalStepAvailable":"No final step available","termplanner.secondTerm":"ST {year}","termplanner.termPlanning":"Term planner","termplanner.weekNumber":"Week","termplanner.chartsBoxTitle":"Progress Charts","termplanner.yoga":"Yoga","tutorNoteDialog.weekComment":"Note for week {weekNumber}","test.chooseComponentLabel":"Component","test.pageDescription":"Test page for the components on the starting page","userTasks.addLearningGoal":"Own working goal","userTasks.deleteLearningGoal":"Delete learning goal and its tasks","userTasks.goals":"Own learning goal","weekNotebook.title":"Notepad","weekplanner.addLearningGoal":"Goal:","weekplanner.addLearningGoalTitle":"Add own learning goal","weekplanner.confirmRemoveLearningObjectives":"Delete learning goal and {learningGoalsNumber} tasks?","weekplanner.copyPreviousWeekTaks":"Copy from previous week","weekplanner.emptyLearningGoalErr":"The learning goal cannot be empty","weekplanner.evaluation":"Evaluation","weekplanner.evaluationDescription":"Reflection on your work effort and your chosen strategies during the week. Evaluate in relation to your goals.","weekplanner.learningGoal":"Own learning goal","weekplanner.logBook":"Logbook","weekplanner.nameCannotBeEmpty":"Name cannot be empty","weekplanner.nameMustNotBeEmpty":"Name must not be empty","weekplanner.strategy":"Strategy","weekplanner.strategyAndEvaluation":"Strategy & Evaluation","weekplanner.strategyDescription":"What I should do to learn","weekplanner.weekNumber":"Week {weekNumber}","wysiwyg.bold":"Bold","wysiwyg.code":"Code","wysiwyg.heading1":"Heading 1","wysiwyg.heading2":"Heading 2","wysiwyg.heading3":"Heading 3","wysiwyg.image":"Insert image","wysiwyg.imagePromptMsg":"Enter the URL of the image","wysiwyg.italic":"Italics","wysiwyg.line":"Horizontal line","wysiwyg.link":"Insert link","wysiwyg.olist":"Ordered list","wysiwyg.paragraph":"Paragraph","wysiwyg.quote":"Quote","wysiwyg.strikethrough":"Strikethrough","wysiwyg.ulist":"Bullet list","wysiwyg.underline":"Underline"};

/***/ }),

/***/ "./src/translations/sv.json":
/*!**********************************!*\
  !*** ./src/translations/sv.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.addSubtask, addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.swedishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.loadingTermplanner, termplanner.modernLanguageFullname, termplanner.mathsFullname, termplanner.noFinalStepAvailable, termplanner.swedishLanguageFullName, termplanner.englishLanguageFullName, termplanner.maths, termplanner.modernLanguage, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.addSubtask":"Lägg till underuppgift","addeditsubtask.deleteSubtask":"Ta bort underuppgift","addeditsubtask.editSubtask":"Redigera underuppgift","addeditsubtask.nameLabel":"Underuppgiftens namn","calendar.currentDate":"Vecka {week}, {year}","calendar.fullDayEventLocation":"Plats: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"V{weekNumber}","common.addDescriptionPlhd":"Lägg till en beskrivning...","common.cancel":"Avbryt","common.changesNotSavedErrorOccured":"För tillfället problem att spara data. Dina ändringar sparades inte.","common.changesNotSavedUnauthorized":"Ändringarna sparades inte p.g.a. otillräcklig behörighet.","common.descriptionLabel":"Beskrivning","common.errorSavingData":"Kunde inte spara.","common.linkLabel":"Länk","common.loading":"Laddar...","common.nameLabel":"Namn","common.save":" Spara","common.saved":" Sparad","common.saving":"Sparar...","common.remove":"Ta bort","customTask.addWorkGoalTitle":"Lägg till eget arbetsmål","customTask.enterNamePlhd":"Ange namn...","learningGoalsLost.overall":"Övergripande","task.addSubtask":"Lägg till underuppgift","task.editTask":"Redigera uppgift","task.editWorkGoals":"Redigera arbetsmål","task.enterTaskNamePlhd":"Ange uppgiftens namn...","task.removeDeadline":"Ta bort deadline","task.removeThisTask":"Ta bort den här uppgiften","task.removeWorkGoals":"Ta bort arbetsmål","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Ange deadline...","task.subTasks":"Underuppgifter","task.targetNameLabel":"Arbetsmålets namn","task.taskNameLabel":"Uppgiftens namn","task.whatShouldYouDoPlhd":"Vad ska du göra?","taskList.nextWeekTask":"för nästa vecka (v{week})","taskList.lastWeekTask":"för förra veckan (v{week})","taskList.currentWeekTask":"för vecka {week}","taskList.removeTaskFromWeeklyPlanning":"Ta bort uppgiften från egen veckoplanering {week}","taskList.addTaskToWeeklyPlanning":"Lägg till uppgiften i egen veckoplanering {week}","termplanner.comments":"Kommentar","termplanner.course":"Kurs","termplanner.edsGoalGrades":"Terminsmål","termplanner.englishLanguage":"Eng","termplanner.swedishLanguage":"Sv/SvA","termplanner.finalStep":"Slutsteg","termplanner.firstTerm":"HT {year}","termplanner.hindiLanguage":"","termplanner.loadingTermplanner":"V.g. vänta medan terminsplaner laddas...","termplanner.modernLanguageFullname":"M.språk","termplanner.mathsFullname":"Matematik","termplanner.noFinalStepAvailable":"Inget slutsteg tillgängligt","termplanner.swedishLanguageFullName":"Svenska","termplanner.englishLanguageFullName":"Engelska","termplanner.maths":"Ma","termplanner.modernLanguage":"M.spr","termplanner.secondTerm":"VT {year}","termplanner.termPlanning":"Terminsplanering","termplanner.weekNumber":"Vecka","termplanner.chartsBoxTitle":"Min progression","tutorNoteDialog.weekComment":"Kommentar för vecka {weekNumber}","test.chooseComponentLabel":"Komponent","test.pageDescription":"Testsida för komponenter till nya startsidan","userTasks.addLearningGoal":"Eget arbetsmål","userTasks.deleteLearningGoal":"Ta bort lärandemålet och dess uppgifter","userTasks.goals":"Egna lärandemål","weekNotebook.title":"Anteckningar","weekplanner.addLearningGoal":"Mål:","weekplanner.addLearningGoalTitle":"Lägg till eget lärandemål","weekplanner.confirmRemoveLearningObjectives":"Ta bort lärandemål samt {learningGoalsNumber} uppgifter?","weekplanner.copyPreviousWeekTaks":"Kopiera ej klara från föregående vecka","weekplanner.emptyLearningGoalErr":"Lärandemålet kan inte vara tomt","weekplanner.evaluation":"Utvärdering","weekplanner.evaluationDescription":"Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utvärdera i förhållande till dina mål.","weekplanner.learningGoal":"Eget lärandemål","weekplanner.logBook":"Loggbok","weekplanner.nameCannotBeEmpty":"Namnet kan inte vara tomt","weekplanner.nameMustNotBeEmpty":"Namnet får inte vara tomt","weekplanner.strategy":"Strategi","weekplanner.strategyAndEvaluation":"Strategi & Utvärdering","weekplanner.strategyDescription":"Hur jag ska göra för att lära mig.","weekplanner.weekNumber":"Vecka {weekNumber}","wysiwyg.bold":"Fetstil","wysiwyg.code":"Programkod","wysiwyg.heading1":"Rubrik 1","wysiwyg.heading2":"Rubrik 2","wysiwyg.heading3":"Rubrik 3","wysiwyg.image":"Infoga bild","wysiwyg.imagePromptMsg":"Ange bildens URL","wysiwyg.italic":"Kursiv","wysiwyg.line":"Vågrät linje","wysiwyg.link":"Infoga länk","wysiwyg.olist":"Ordnad lista","wysiwyg.paragraph":"Paragraf","wysiwyg.quote":"Citat","wysiwyg.strikethrough":"Struken","wysiwyg.ulist":"Punktlista","wysiwyg.underline":"Understruken"};

/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 1)
                infos = infos.slice(1);
            return {
                infos: [message] // was: infos.concat(message). But it sucks!
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/include-optional-css.ts":
/*!*******************************************!*\
  !*** ./src/utils/include-optional-css.ts ***!
  \*******************************************/
/*! exports provided: includeOptionalCSS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "includeOptionalCSS", function() { return includeOptionalCSS; });
function includeOptionalCSS(_a) {
    var v1 = _a.v1, versionFolder = _a.versionFolder, version = _a.version, includeCSS = _a.includeCSS, NOCSS = _a.NOCSS;
    if (!NOCSS) {
        if (v1)
            v1.forEach(function (cssFile) { return includeCSS(cssFile); });
    }
    var cssVer = parseInt(NOCSS);
    if (isNaN(cssVer))
        cssVer = 1;
    for (var ver = cssVer + 1; ver <= version; ++ver) {
        includeCSS(versionFolder + "/v" + ver + ".css");
    }
}


/***/ }),

/***/ "./src/utils/make-suspense-api.ts":
/*!****************************************!*\
  !*** ./src/utils/make-suspense-api.ts ***!
  \****************************************/
/*! exports provided: makeSuspenseApi */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeSuspenseApi", function() { return makeSuspenseApi; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var DEFAULT_CACHE_EXPIRATION = 30 * 60 * 1000; // 30 minutes.
var defaultOptions = {
    isApiMethod: function (f) { return typeof f === 'function'; },
    cacheExpiration: DEFAULT_CACHE_EXPIRATION
};
function makeSuspenseApi(api, options) {
    if (options === void 0) { options = defaultOptions; }
    options = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultOptions, options);
    var isApiMethod = options.isApiMethod, cacheExpiration = options.cacheExpiration;
    var rv = Object.create(api);
    var cache = {};
    // Walk the instance + prototype chain to generate suspense version of each promise returning method
    for (var proto = api; proto && proto !== Object.prototype; proto = Object.getPrototypeOf(proto)) {
        suspendify(proto);
    }
    function suspendify(proto) {
        Object.keys(proto).forEach(function (prop) {
            if (!rv.hasOwnProperty(prop) && isApiMethod(prop)) {
                rv[prop] = function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    var key = JSON.stringify(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([prop], args));
                    var cachedEntry = cache[key];
                    if (cachedEntry !== undefined) {
                        if (cachedEntry.promise)
                            throw cachedEntry.promise;
                        if (cachedEntry.error)
                            throw cachedEntry.error;
                        if (cachedEntry.timeout > Date.now()) {
                            return cachedEntry.value;
                        }
                    }
                    try {
                        var promise = proto[prop].apply(api, args).then(function (result) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, value: result };
                        }).catch(function (error) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                        });
                        cache[key] = { timeout: Date.now() + cacheExpiration, promise: promise };
                        throw promise;
                    }
                    catch (error) {
                        if (error.then)
                            throw error;
                        cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                    }
                };
            }
        });
    }
    return rv;
}


/***/ }),

/***/ "./src/utils/pending-job.ts":
/*!**********************************!*\
  !*** ./src/utils/pending-job.ts ***!
  \**********************************/
/*! exports provided: PendingJob */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PendingJob", function() { return PendingJob; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var PendingJob = /** @class */ (function () {
    function PendingJob(callback) {
        this.timeoutId = null;
        this.cancelled = false;
        this.pending = false;
        this.isJobExecuting = false;
        this.jobCallback = callback;
    }
    PendingJob.prototype.triggerChange = function (throttle) {
        var _this = this;
        if (this.cancelled)
            return;
        this.pending = true;
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = setTimeout(function () { return _this.launchJob(); }, throttle);
    };
    PendingJob.prototype.stop = function () {
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = null;
        this.cancelled = true;
    };
    PendingJob.prototype.launchJob = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.cancelled)
                            return [2 /*return*/];
                        if (!this.pending)
                            return [2 /*return*/];
                        if (this.isJobExecuting)
                            return [2 /*return*/];
                        this.timeoutId = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        this.isJobExecuting = true;
                        this.pending = false;
                        return [4 /*yield*/, this.jobCallback()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.isJobExecuting = false;
                        return [7 /*endfinally*/];
                    case 4:
                        if (!this.pending) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.launchJob()];
                    case 5:
                        _a.sent();
                        _a.label = 6;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    return PendingJob;
}());



/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStarEndDate, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStarEndDate", function() { return getTermStarEndDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
//Not used anymore
// export function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {
//     return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
//     [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31
//     [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31
// }
function getTermStarEndDate(date, isFirstTerm) {
    var addYear = date.getMonth() >= 7;
    var termYear = null;
    if (addYear) {
        termYear = isFirstTerm ? date.getFullYear() : date.getFullYear() + 1;
    }
    else {
        termYear = isFirstTerm ? date.getFullYear() - 1 : date.getFullYear();
    }
    var termYearMoment = moment__WEBPACK_IMPORTED_MODULE_1___default()(termYear.toString(), "YYYY");
    if (termYearMoment.week() != 1) {
        termYearMoment = termYearMoment.clone().add(1, 'week');
    }
    return isFirstTerm ? [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(32).startOf('week'), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(51).endOf('week')] :
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(25).endOf('week')];
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6; // determine 
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");


function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        return this.term === 'AT' ? intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'HT {year}' }, { year: year }) :
            intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'VT {year}' }, { year: year });
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        var firstB = b[firstPart];
        if (firstA === firstB)
            return 0;
        if (firstA == null)
            return -1;
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/utils/weekutil.ts":
/*!*******************************!*\
  !*** ./src/utils/weekutil.ts ***!
  \*******************************/
/*! exports provided: KEDWeek, getNextWeekDate, getPrevWeekDate, getAdjustedWeek */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDWeek", function() { return KEDWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getNextWeekDate", function() { return getNextWeekDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPrevWeekDate", function() { return getPrevWeekDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAdjustedWeek", function() { return getAdjustedWeek; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

function KEDWeek(year, week) {
    var m = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(year, 1, 1)).week(week);
    var res = {
        year: year,
        week: week,
        notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),
        notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()
    };
    return res;
}
function getNextWeekDate(date) {
    var nextDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(date).add(1, 'week');
    //Set the 01.01 of the next year in case the next week is in the same year 
    //and the previous week is the last week of the year
    if (date.week() === date.weeksInYear() && nextDate.year() === date.year()) {
        return { adjusted: true, nextDate: moment__WEBPACK_IMPORTED_MODULE_0___default()(date.year() + 1 + "-01-01").toDate() };
    }
    return { adjusted: false, nextDate: nextDate.toDate() };
}
function getPrevWeekDate(date) {
    var prevDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(date).add(-1, 'week');
    //Set the 01.01 of the current year in case the prev week is in the previous year
    if (date.week() === 2 && prevDate.year() !== date.year()) {
        return { adjusted: true, nextDate: moment__WEBPACK_IMPORTED_MODULE_0___default()(date.year() + "-01-01").toDate() };
    }
    return { adjusted: false, nextDate: prevDate.toDate() };
}
function getAdjustedWeek(m) {
    var clone = m.clone();
    return m.weekday() >= 5 ? // Lördag 00:00 / Söndag 00:00?
        m.week() + 1 : // Tillhör nästa vecka
        m.week();
}
/*export function getWeekLimits (m: Moment) {
  const clonedSwedish = m.clone().locale('sv');
  const limits = {
    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),
    notAfter: clonedSwedish.startOf('week').add(5, 'days')
  };
}
*/


/***/ }),

/***/ 0:
/*!*****************************************!*\
  !*** ../locale-data/index.js (ignored) ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 1:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnR3ZWIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvaGFzaC1yZXN0b3Jlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50LXdlYi9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaHR0cC1lcnJvci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3Jlc3RjbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vYXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1jb2xsZWN0aW9uL2RlbHRhLWNhY2hlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXJlcG8uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vbXV0YXRpb24tcXVldWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vcXVlcnktc2V0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtbW9kZWwtbWlncmF0b3IvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLWNvdXJzZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL2ZpYmVyLWNvbnRleHQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL21peGluLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9yZXBvLmpzIiwid2VicGFjazovL1tuYW1lXS8uL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlIHN5bmMgc3Z8ZW4iLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2dldC11c2VyLWNsYWltcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYWNjZXNzLWNvbnRyb2wvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvYnV0dG9ucy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvY29uZmlncy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9lZHNjbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvZ29vZ2xlLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9nb29nbGUtZHJpdmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvZ29vZ2xlLXBpY2tlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9nb29nbGUtd2ViY2xpZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL2NvdXJzZS1uYW1lLXRvLWNzcy1jbGFzcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvY2hhcnRzLXV0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NoYXJ0cy9nb2FsLXByb2dyZXNzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvcHJvZ3Jlc3MudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyLWtzL2xvZ2ljL2lzLWVtcGxveWVlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci91dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL2NvdXJzZS1iYW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvY291cnNlLW1vZHVsZS1wYWdlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL2dldC1jdXN0b21pemVkLXRhc2sudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS9ydW4tdXAtcGFnZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS90YXNrLWFzc2lnbm1lbnRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL3Rhc2stcGFnZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS91cmt1bmQtdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL2FiaWxpdGllcy1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9jZW50cmFsLWNvbnRlbnQtYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvY29uZmlybWF0aW9uLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMva25vd2xlZGdlLXJlcXVpcmVtZW50cy10YWJsZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL2xlYXJuaW5nLWdvYWxzLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9yZXNvdXJjZS1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvdGFzay1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3V0aWxzL2dldC1pbmNsdWRlZC1pZHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci91dGlscy9tYW51YWwtc2Nyb2xsLXJlc3RvcmF0aW9uLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2xpc3QtY291cnNlcy9saXN0LWNvdXJzZXMtcGFnZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvbGlzdC1jb3Vyc2VzL2xpc3QtY291cnNlcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZGlhbG9ncy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dGFyZWEudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2FkZC1jdXN0b20tZ29hbC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvYWRkLWN1c3RvbS10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9hZGQtb3ItZWRpdC1zdWItdGFzay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvZWRpdC11c2VyLXRhc2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2dldC10YXNrLXR5cGUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvcmVmaW5lci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci91c2VyLXRhc2tzLWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL3dlZWtwbGFubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZmVhdHVyZXMvZmVhdHVyZXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2ZlYXR1cmVzL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9jb25maWd1cmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1iZWFyZXItcHJvdmlkZXJzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtZWRzLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWtlZC1iYWNrZW5kLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuY2ZnLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC5lbnYudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL2RiLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL2tlZC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy9oaWRkZW4tY291cnNlcy1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy9rZWQtcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3MvcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3MvdXNlci10YXNrcy1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy90ZXN0L2RhdGEvdXNlcnMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3Rlc3Qvc2V0LWN1cnJlbnQtdXNlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdGVzdC90ZXN0LWNvbmZpZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdGVzdC90ZXN0cGFnZS1jb3Vyc2V2aWV3ZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy90ZXN0L3V0aWxzL2Nob29zZS11c2VyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdGVzdC91dGlscy9pbmNsdWRlLWNzcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvZXJyb3Itc3VjY2Vzcy1mZWVkYmFjay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2luY2x1ZGUtb3B0aW9uYWwtY3NzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9tYWtlLXN1c3BlbnNlLWFwaS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcGVuZGluZy1qb2IudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3F1ZXJ5LXN0cmluZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLW1vbWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLXRlcm0udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy93ZWVrdXRpbC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4vbG9jYWxlLWRhdGEvaW5kZXguanMgKGlnbm9yZWQpIiwid2VicGFjazovL1tuYW1lXS8uL2xpYi9sb2NhbGVzIChpZ25vcmVkKSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9saWIvbG9jYWxlcyAoaWdub3JlZCk/YTE3NyIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJqUXVlcnlcIiIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJSZWFjdFwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0RE9NXCIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFRLG9CQUFvQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUFpQiw0QkFBNEI7QUFDN0M7QUFDQTtBQUNBLDBCQUFrQiwyQkFBMkI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtEQUEw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QUN0RCxPQUFPLEVBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsNkNBQU0sQ0FBSSxJQUFJLENBQUMsSUFBSSxFQUFFLFdBQVEsQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFDLENBQUM7S0FDNUU7SUFFRCxPQUFPLEVBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLE1BQU0sRUFBRSxFQUFDLENBQUM7QUFDeEQsQ0FBQztBQUVNLFNBQVMsZUFBZSxDQUFDLENBQVM7SUFDdkMsSUFBTSxLQUFLLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3hCLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsK0JBQStCO1FBQ3JELENBQUMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLHNCQUFzQjtRQUNyQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDZixDQUFDO0FBRUQ7Ozs7Ozs7RUFPRTs7Ozs7Ozs7Ozs7O0FDaERGLGU7Ozs7Ozs7Ozs7O0FDQUEsZTs7Ozs7Ozs7Ozs7QUNBQSxlOzs7Ozs7Ozs7OztBQ0FBLHdCOzs7Ozs7Ozs7OztBQ0FBLHVCOzs7Ozs7Ozs7OztBQ0FBLDBCIiwiZmlsZSI6InRlc3RwYWdlY291cnNldmlld2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuXG4gXHRcdHJldHVybiByZXN1bHQ7XG4gXHR9XG5cbiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gXHQvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiBcdC8vIFByb21pc2UgPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG4gXHR2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuIFx0XHRcInRlc3RwYWdlY291cnNldmlld2VyXCI6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goW1wiLi9zcmMvdGVzdC90ZXN0cGFnZS1jb3Vyc2V2aWV3ZXIudHN4XCIsXCJ2ZW5kb3JzXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudCc7IiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWInOyIsInZhciBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoaWQsIHRva2VuSW5mbykge1xyXG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJiZWFyZXItXCIgKyBpZCwgSlNPTi5zdHJpbmdpZnkodG9rZW5JbmZvKSk7XHJcbiAgICB9O1xyXG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGpzb24gPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZTtcclxufSgpKTtcclxuZXhwb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlLmpzLm1hcCIsInZhciByZWRpckhhc2ggPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwicmVkaXItaGFzaFwiKTtcclxuaWYgKHJlZGlySGFzaClcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIF9hID0gSlNPTi5wYXJzZShyZWRpckhhc2gpLCB0aW1lID0gX2EudGltZSwgaGFzaCA9IF9hLmhhc2g7XHJcbiAgICAgICAgaWYgKHRpbWUgJiYgdGltZSA+IERhdGUubm93KCkgLSA2MDAwMCkge1xyXG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFwicmVkaXItaGFzaFwiKTtcclxuICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKF8pIHsgfVxyXG5leHBvcnQgZnVuY3Rpb24gcmVtZW1iZXJIYXNoTG9jYXRpb24oKSB7XHJcbiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwicmVkaXItaGFzaFwiLCBKU09OLnN0cmluZ2lmeSh7IHRpbWU6IERhdGUubm93KCksIGhhc2g6IGxvY2F0aW9uLmhhc2ggfSkpO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhhc2gtcmVzdG9yZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCwgSHR0cEVycm9yIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH0gZnJvbSBcIi4vYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2VcIjtcclxuaW1wb3J0IHsgYXZvaWRTaW11bHRhbm91c0NhbGxzIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcclxuaW1wb3J0IHsgS2VkTW9kZWxNaWdyYXRvck1peGluIH0gZnJvbSAnLi4va2VkLW1vZGVsLW1pZ3JhdG9yJztcclxuaW1wb3J0ICcuL2hhc2gtcmVzdG9yZXInO1xyXG5pbXBvcnQgeyByZW1lbWJlckhhc2hMb2NhdGlvbiB9IGZyb20gJy4vaGFzaC1yZXN0b3Jlcic7XHJcbktlZE1vZGVsTWlncmF0b3JNaXhpbihLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZSk7XHJcbmV4cG9ydCB2YXIgc3RvcmFnZSA9IG5ldyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKTtcclxudmFyIHRpbWVPZlBhZ2VMb2FkID0gRGF0ZS5ub3coKTtcclxudmFyIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIodG9rZW5QYXRoLCB0b2tlblJlc3BvbnNlTWFwcGVyLCB0b2tlbklkKSB7XHJcbiAgICAgICAgdGhpcy50b2tlblBhdGggPSB0b2tlblBhdGg7XHJcbiAgICAgICAgdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyID0gdG9rZW5SZXNwb25zZU1hcHBlcjtcclxuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xyXG4gICAgICAgIHRoaXMudG9rZW5JbmZvID0geyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9O1xyXG4gICAgICAgIHRoaXMuZ2V0QmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMuZ2V0QmVhcmVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlci5wcm90b3R5cGUuZ2V0QmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy50b2tlbkluZm8udG9rZW4pIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudG9rZW5JZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgc3RvcmFnZS5sb2FkKHRoaXMudG9rZW5JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudG9rZW5JbmZvID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnRva2VuSW5mby5leHBpcmVzIDwgRGF0ZS5ub3coKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2IsIF9jLCBfZDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBmZXRjaCh0aGlzLnRva2VuUGF0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBY2NlcHQ6IFwidGV4dC9wbGFpbjsgYXBwbGljYXRpb24vanNvblwiIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZTogJ25vLWNhY2hlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMzAyIHx8ICghcmVzLnN0YXR1cyAmJiByZXMudHlwZSA9PT0gXCJvcGFxdWVyZWRpcmVjdFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlciBzZXNzaW9uIHRpbWVkIG91dCBhbmQgc2VydmVyIHdhbnRzIHRvIHJlZGlyZWN0IGVudGlyZSBwYWdlIHRvIGxvZ2luIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRpbWUgdG8gcmVsb2FkIGN1cnJlbnQgcGFnZSB0byBmb3JjZSBhIHJlZGlyZWN0IG9mIHRoZSBlbnRpcmUgcGFnZSBpbnN0ZWFkIGZvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZWRpcmVjdGluZyB0byAvYXBpL3Rva2VuIG9yIHdoYXRldmVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aW1lT2ZQYWdlTG9hZCA+IDYwMDAwKSB7IC8vIHByb2hpYml0IGVuZGxlc3MgbG9vcCBvZiByZWxvYWRpbmcgc2VsZi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhbnRzUmVkaXJlY3QgPSB0cnVlOyAvLyBTbyB0aGF0IGxpc3RlbmVycyB0byBvbmJlZm9yZXVubG9hZCBjb3VsZCBzaG93IGFsdGVybmF0ZSBtZXNzYWdlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVkaXJlY3Qgd2FudGVkLiBSZWxvYWQgcGFnZS5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtZW1iZXJIYXNoTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoMzAyLCBcIlJlZGlyZWN0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFwiSFRUUFwiICsgcmVzLnN0YXR1cyArIFwiIFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoRXJyb3IsIFt2b2lkIDAsIF9iICsgKF9lLnNlbnQoKSldKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSB0aGlzLnRva2VuUmVzcG9uc2VNYXBwZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudG9rZW5JbmZvID0gX2QuYXBwbHkodGhpcywgW19lLnNlbnQoKV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlLnNhdmUodGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcjtcclxufSgpKTtcclxuZXhwb3J0IHsgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIgfTtcclxuZXhwb3J0IHZhciBpc29tb3JwaGljID0geyBmZXRjaDogZmV0Y2guYmluZChzZWxmKSwgYnRvYTogYnRvYS5iaW5kKHNlbGYpIH07XHJcbnZhciBLZWRCYWNrZW5kQ2xpZW50V2ViID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoS2VkQmFja2VuZENsaWVudFdlYiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDbGllbnRXZWIoYXBpQmFzZVVybCwgcHJvdmlkZXJPclRva2VuUGF0aCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJlYXJlclByb3ZpZGVyID0gdHlwZW9mIHByb3ZpZGVyT3JUb2tlblBhdGggIT09ICdzdHJpbmcnID9cclxuICAgICAgICAgICAgcHJvdmlkZXJPclRva2VuUGF0aCA6XHJcbiAgICAgICAgICAgIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihwcm92aWRlck9yVG9rZW5QYXRoLCAob3B0aW9ucyAmJiBvcHRpb25zLnRva2VuUmVzcG9uc2VNYXBwZXIpIHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4gKHsgdG9rZW46IHgsIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogNjAgfSk7IH0pLCBvcHRpb25zICYmIG9wdGlvbnMudG9rZW5JZCk7XHJcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBpc29tb3JwaGljLCBiZWFyZXJQcm92aWRlciwgYXBpQmFzZVVybCkgfHwgdGhpcztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZENsaWVudFdlYjtcclxufShLZWRCYWNrZW5kQ2xpZW50KSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwidmFyIERvY3VtZW50QWNjZXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRBY2Nlc3MoYWNjZXNzQ2xhaW1UeXBlLCBhY2Nlc3NDbGFpbVZhbHVlLCByaWdodCkge1xyXG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1UeXBlID0gYWNjZXNzQ2xhaW1UeXBlO1xyXG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1WYWx1ZSA9IGFjY2Vzc0NsYWltVmFsdWU7XHJcbiAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0O1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChhYykge1xyXG4gICAgICAgIGlmICghYWMpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIHZhciBzcGxpdCA9IGFjLnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgaWYgKHNwbGl0Lmxlbmd0aCA8IDMpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XHJcbiAgICAgICAgdmFyIGNsYWltVHlwZSA9IERvY3VtZW50QWNjZXNzLnVuZXNjYXBlKHNwbGl0WzBdKTtcclxuICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IERvY3VtZW50QWNjZXNzLnVuZXNjYXBlKHNwbGl0WzFdKTtcclxuICAgICAgICB2YXIgcmlnaHQgPSBzcGxpdFsyXTtcclxuICAgICAgICBpZiAocmlnaHQgIT09ICdSJyAmJiByaWdodCAhPT0gJ1cnICYmIHJpZ2h0ICE9PSAnUycpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEFjY2VzcyhjbGFpbVR5cGUsIGNsYWltVmFsdWUsIHJpZ2h0KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIGFjY2Vzc0NvbXBvbmVudC5yZXBsYWNlKC9cXCUvZywgXCIlMjVcIikucmVwbGFjZSgvXFw6L2csIFwiJTNBXCIpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50QWNjZXNzLnVuZXNjYXBlID0gZnVuY3Rpb24gKGFjY2Vzc0NvbXBvbmVudCkge1xyXG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlM0EvZywgXCI6XCIpLnJlcGxhY2UoL1xcJTI1L2csIFwiJVwiKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVHlwZSkgKyBcIjpcIiArXHJcbiAgICAgICAgICAgIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVmFsdWUpICsgXCI6XCIgK1xyXG4gICAgICAgICAgICB0aGlzLnJpZ2h0O1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmdBcnJheSA9IGZ1bmN0aW9uIChhY2wpIHtcclxuICAgICAgICByZXR1cm4gYWNsXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nKGFjKTsgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjOyB9KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy50b1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xyXG4gICAgICAgIHJldHVybiBhY2wubWFwKGZ1bmN0aW9uIChhYykgeyByZXR1cm4gYWMudG9TdHJpbmcoKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50QWNjZXNzO1xyXG59KCkpO1xyXG5leHBvcnQgeyBEb2N1bWVudEFjY2VzcyB9O1xyXG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKGFjbCwgdXNlckNsYWltcywgcmVxdWVzdGVkUmlnaHQpIHtcclxuICAgIGlmICh1c2VyQ2xhaW1zLnNvbWUoZnVuY3Rpb24gKGNsYWltKSB7IHJldHVybiBjbGFpbS50eXBlID09PSAncm9sZScgJiYgY2xhaW0udmFsdWUgPT09IFwiQURNSU5cIjsgfSkpXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gYWNsLnNvbWUoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICByZXR1cm4gdXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhLmFjY2Vzc0NsYWltVHlwZSA9PT0gYy50eXBlICYmXHJcbiAgICAgICAgICAgICAgICBhLmFjY2Vzc0NsYWltVmFsdWUgPT09IGMudmFsdWUgJiYgKChhLnJpZ2h0ID09PSAnUicgJiYgcmVxdWVzdGVkUmlnaHQgPT09ICdSJykgfHxcclxuICAgICAgICAgICAgICAgIChhLnJpZ2h0ID09PSAnVycgJiYgWydSJywgJ1cnXS5pbmRleE9mKHJlcXVlc3RlZFJpZ2h0KSA+PSAwKSB8fFxyXG4gICAgICAgICAgICAgICAgKGEucmlnaHQgPT09ICdTJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjZXNzLWNvbnRyb2wuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxudmFyIEh0dHBFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEh0dHBFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEh0dHBFcnJvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgXCJIVFRQXCIgKyBjb2RlICsgXCIgXCIgKyBtZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSBcImh0dHBcIiArIGNvZGU7XHJcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSHR0cEVycm9yO1xyXG59KEVycm9yKSk7XHJcbmV4cG9ydCB7IEh0dHBFcnJvciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1odHRwLWVycm9yLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xyXG5leHBvcnQgKiBmcm9tICcuL3V0aWxzJztcclxuZXhwb3J0IHsgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICcuL2tlZC1iZWFyZXItcHJvdmlkZXInO1xyXG5leHBvcnQgKiBmcm9tICcuL2FjY2Vzcy1jb250cm9sJztcclxuZXhwb3J0IHsgUmVzdENsaWVudCB9O1xyXG5pbXBvcnQgeyBIdHRwRXJyb3IgfSBmcm9tICcuL2h0dHAtZXJyb3InO1xyXG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcclxuZXhwb3J0ICogZnJvbSAnLi9yZXN0Y2xpZW50JztcclxuO1xyXG4vLyB8ICdvdGhlckZsYWcnIHwgJ3RoaXJkRmxhZyc7Li4uXHJcbnZhciBLZWRCYWNrZW5kQ2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENsaWVudChpc29tb3JwaGljLCBiZWFyZXJQcm92aWRlciwgYmFzZVVybCkge1xyXG4gICAgICAgIHRoaXMuaHR0cCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIHsgYmVhcmVyUHJvdmlkZXI6IGJlYXJlclByb3ZpZGVyIH0pO1xyXG4gICAgfVxyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0TXlDbGFpbXMgPSBmdW5jdGlvbiAodGFibGUsIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmdldChcIm1lL2NsYWltcy9cIiArICh0YWJsZSB8fCBcIlwiKSwgbnVsbCwgZmV0Y2hPcHRpb25zKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KHRhYmxlICsgXCIvXCIgKyBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGlzdCA9IGZ1bmN0aW9uICh0YWJsZSwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeSwgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBvcHRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5tdXRhdGlvbnNPbkVtcHR5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkubXV0YXRpb25zT25FbXB0eSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubXV0YXRpb25zT25FbXB0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQoXCJcIiArIHRhYmxlLCBxdWVyeSwgZmV0Y2hPcHRpb25zKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYmF0Y2ggPSBmdW5jdGlvbiAocmVxcywgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW9yZGVyIG9wZXJhdGlvbnMgc28gdGhhdCAnYWRkJ3MgY29tZSBmaXJzdCBhbmQgJ2RlbGV0ZSdzIGNvbWUgbGFzdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxcyA9IHJlcXMuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChyZXExLCByZXEyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVxMS5vcCA9PT0gJ2FkZCcgPyAtMSA6IHJlcTIub3AgPT09ICdhZGQnID8gMSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxMS5vcCA9PT0gJ2RlbGV0ZScgPyAxIDogcmVxMi5vcCA9PT0gJ2RlbGV0ZScgPyAtMSA6IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAucG9zdChcImJhdGNoXCIsIHJlcXMsIGZldGNoT3B0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmRvID0gZnVuY3Rpb24gKHNjb3BlRm4pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJ1bm5lcjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uZXIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVGbihydW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJhdGNoKHJ1bm5lci5tdXRhdGlvblJlcXVlc3RzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlUmVhbG0gPSBmdW5jdGlvbiAocmVhbG0pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5kZWxldGUoXCJyZWFsbXMvXCIgKyByZWFsbSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmFkZCh0YWJsZSwgZG9jKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5wdXQodGFibGUsIGRvYyk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGRlbHRhRG9jLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVwZGF0ZSh0YWJsZSwgaWQsIGRlbHRhRG9jLCBicmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLm1lcmdlKGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuY2xlYXJCcmFuY2goYnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAodGFibGUsIGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGVsZXRlKHRhYmxlLCBpZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuc2hhcmUodGFibGUsIGlkLCBhY2wpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubGluayhzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saW5rMiA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldElkLCBsYWJlbCwgYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rMihzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmxpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5saW5rMihzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmRvTGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldElkLCBsYWJlbCwgYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmRvTGluayhzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZENsaWVudDtcclxufSgpKTtcclxuZXhwb3J0IHsgS2VkQmFja2VuZENsaWVudCB9O1xyXG52YXIgQmF0Y2hSdW5uZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCYXRjaFJ1bm5lcigpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMgPSBbXTtcclxuICAgIH1cclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnYWRkJywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xyXG4gICAgICAgIGRvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XHJcbiAgICAgICAgZGVsZXRlIGRvYy5hY2w7IC8vIEZvcmJpZGRlbiB0byBzZW5kIGFjbCB3aXRoIHB1dCgpIGNhbGxzLlxyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdwdXQnLCB0YWJsZTogdGFibGUsIGRvYzogZG9jIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcclxuICAgICAgICBkZWx0YURvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhRG9jKTtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndXBkYXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQsIGRlbHRhRG9jOiBkZWx0YURvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnbWVyZ2UnLCBicmFuY2hJZDogYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9KTtcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnY2xlYXItYnJhbmNoJywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAodGFibGUsIGlkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2RlbGV0ZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdzaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bnNoYXJlJywgdGFibGU6IHRhYmxlLCBpZDogaWQsIGFjbDogYWNsIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3VubGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCwgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51bmRvTGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5kby1saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJhdGNoUnVubmVyO1xyXG59KCkpO1xyXG5leHBvcnQgeyBCYXRjaFJ1bm5lciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAnLi9yZXN0Y2xpZW50JztcclxuaW1wb3J0IHsgYXZvaWRTaW11bHRhbm91c0NhbGxzIH0gZnJvbSAnLi91dGlscyc7XHJcbnZhciBLZWRCZWFyZXJQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJlYXJlclByb3ZpZGVyKGlzb21vcnBoaWMsIHN0b3JhZ2UsIHRva2VuSWQsIGNsaWVudElkLCBjbGllbnRTZWNyZXQsIHRva2VuVXJsLCB0b2tlblF1ZXJ5KSB7XHJcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcclxuICAgICAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xyXG4gICAgICAgIHRoaXMudG9rZW5JZCA9IHRva2VuSWQ7XHJcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xyXG4gICAgICAgIHRoaXMuY2xpZW50U2VjcmV0ID0gY2xpZW50U2VjcmV0O1xyXG4gICAgICAgIHRoaXMudG9rZW5VcmwgPSB0b2tlblVybDtcclxuICAgICAgICB0aGlzLnRva2VuUXVlcnkgPSB0b2tlblF1ZXJ5O1xyXG4gICAgICAgIHRoaXMudG9rZW5JbmZvID0geyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9O1xyXG4gICAgICAgIHRoaXMuY2xpZW50ID0gbmV3IFJlc3RDbGllbnQoaXNvbW9ycGhpYywgXCJcIiwge1xyXG4gICAgICAgICAgICB1c2VybmFtZTogdGhpcy5jbGllbnRJZCxcclxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuY2xpZW50U2VjcmV0XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoQmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMucmVmcmVzaEJlYXJlci5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSwgdG9rZW4sIGV4cGlyZXMsIF9iLCBlXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLnRva2VuSW5mbywgdG9rZW4gPSBfYS50b2tlbiwgZXhwaXJlcyA9IF9hLmV4cGlyZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiAmJiBleHBpcmVzID49IERhdGUubm93KCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50cnlzLnB1c2goWzEsIDQsICwgNl0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3RvcmFnZS5sb2FkKHRoaXMuY2xpZW50SWQgKyBcIi9cIiArIHRoaXMudG9rZW5JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudG9rZW5JbmZvID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b2tlbkluZm8udG9rZW4gJiYgdGhpcy50b2tlbkluZm8uZXhwaXJlcyA+PSBEYXRlLm5vdygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCByZXRyaWVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJldHJpZXMgPCA2KSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmV0cmlldmluZyB0b2tlbiBmb3IgXCIgKyB0aGlzLnRva2VuSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsaWVudC5nZXQodGhpcy50b2tlblVybCwgdGhpcy50b2tlblF1ZXJ5LCB7IGNhY2hlOiAncmVsb2FkJyB9KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkdvdCBcIiArIHJlcy5zdGF0dXMgKyBcIiBcIiArIHJlcy5zdGF0dXNUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50b2tlbkluZm8gPSAoX2IudG9rZW4gPSBfYy5zZW50KCksIF9iLmV4cGlyZXMgPSBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAsIF9iKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgdG9rZW4gZm9yIFwiICsgdGhpcy50b2tlbklkICsgXCI6IFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50b2tlbkluZm8pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNhdmUodGhpcy5jbGllbnRJZCArIFwiL1wiICsgdGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICArK3JldHJpZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIHRva2VuIGZvciBcIiArIEpTT04uc3RyaW5naWZ5KHRoaXMudG9rZW5JZCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmVhcmVyUHJvdmlkZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJlYXJlclByb3ZpZGVyIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZC1iZWFyZXItcHJvdmlkZXIuanMubWFwIiwiLypcclxuZGVjbGFyZSB2YXIgQnVmZmVyOyAvLyBub2RlIGJ1aWx0LWluXHJcblxyXG5cclxuZnVuY3Rpb24gYmFzaWNBdXRoSGVhZGVyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgcmV0dXJuIFwiQmFzaWMgXCIgKyBuZXcgQnVmZmVyKHVzZXJuYW1lICsgXCI6XCIgKyBwYXNzd29yZCkudG9TdHJpbmcoXCJiYXNlNjRcIik7XHJcbn1cclxuKi9cclxuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gXCIuL3V0aWxzXCI7XHJcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tICcuLi9vYnNlcnZhYmxlL2VtaXR0ZXInO1xyXG52YXIgUmVzdENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlc3RDbGllbnQoaXNvbW9ycGhpYywgYmFzZVVybCwgb3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMuaXNvbW9ycGhpYyA9IGlzb21vcnBoaWM7XHJcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgICAgIHRoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zID0gMDtcclxuICAgICAgICB0aGlzLl9zdGF0dXMgPSBuZXcgRW1pdHRlcih0aGlzKTtcclxuICAgICAgICB0aGlzLmZldGNoT3B0aW9ucyA9IHsgbW9kZTogJ2NvcnMnIH07XHJcbiAgICAgICAgdGhpcy5hdXRoSGVhZGVyID0gb3B0aW9ucy5iZWFyZXIgP1xyXG4gICAgICAgICAgICBcIkJlYXJlciBcIiArIG9wdGlvbnMuYmVhcmVyIDpcclxuICAgICAgICAgICAgb3B0aW9ucy51c2VybmFtZSA/XHJcbiAgICAgICAgICAgICAgICBcIkJhc2ljIFwiICsgaXNvbW9ycGhpYy5idG9hKG9wdGlvbnMudXNlcm5hbWUgKyBcIjpcIiArIChvcHRpb25zLnBhc3N3b3JkIHx8IFwiXCIpKSA6XHJcbiAgICAgICAgICAgICAgICBudWxsO1xyXG4gICAgICAgIHRoaXMuYmVhcmVyUHJvdmlkZXIgPSBvcHRpb25zLmJlYXJlclByb3ZpZGVyIHx8IG51bGw7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdENsaWVudC5wcm90b3R5cGUsIFwic3RhdHVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmZldGNoID0gZnVuY3Rpb24gKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgKyt0aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcclxuICAgICAgICB0aGlzLl9zdGF0dXMuZGlzcGF0Y2godGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZldGNoKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucylcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICAtLV90aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcclxuICAgICAgICAgICAgX3RoaXMuX3N0YXR1cy5kaXNwYXRjaChfdGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXM7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAtLV90aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcclxuICAgICAgICAgICAgX3RoaXMuX3N0YXR1cy5kaXNwYXRjaChfdGhpcyk7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLl9mZXRjaCA9IGZ1bmN0aW9uIChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyLCBfYSwgYXV0aEhlYWRlciwgdG9rZW5JbmZvLCBiZWFyZXJQcm92aWRlciwgX2IsIF9jLCB1cmwsIHJlcywgd3d3YXV0aCwgX2Q7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZldGNoT3B0aW9ucyAmJiBmZXRjaE9wdGlvbnMuY2FjaGUgPT09ICduby1jYWNoZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGJhY2stYnV0dG9uIG5vdCByZXNwZWN0aW5nIGNhY2hlIGNvbnRyb2wgaW4gQ2hyb21lL09wZXJhLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kIGEgcXVlcnkgcGFyYW1ldGVyIHRvIGZvcmNlIGEgY2FjaGUgZW50cnlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgcXVlcnksIHsgbm9jYWNoZTogY3JlYXRlVVVJRCgpIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyID0gcXVlcnkgJiYgT2JqZWN0LmtleXMocXVlcnkpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBxdWVyeVtrZXldICE9PSB1bmRlZmluZWQ7IH0pLm1hcChmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPVwiICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQocXVlcnlba2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbignJicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMsIGF1dGhIZWFkZXIgPSBfYS5hdXRoSGVhZGVyLCB0b2tlbkluZm8gPSBfYS50b2tlbkluZm8sIGJlYXJlclByb3ZpZGVyID0gX2EuYmVhcmVyUHJvdmlkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFhdXRoSGVhZGVyICYmICF0b2tlbkluZm8gJiYgYmVhcmVyUHJvdmlkZXIpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBiZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50b2tlbkluZm8gPSB0b2tlbkluZm8gPSBfZS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG9rZW5JbmZvKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodG9rZW5JbmZvLmV4cGlyZXMgPCBEYXRlLm5vdygpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVG9rZW4gZXhwaXJlZC4gUmVmcmVzaCBpdDpcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYmVhcmVyUHJvdmlkZXIucmVmcmVzaEJlYXJlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IHRva2VuSW5mbyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aEhlYWRlciA9IFwiQmVhcmVyIFwiICsgdG9rZW5JbmZvLnRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBvbmUgd2F5IG9yIGFub3RoZXIsIHdlJ3ZlIGNvbmNsdWRlZCBhbiBBdXRob3JpemF0aW9uIGhlYWRlciB0byB1c2U6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRoSGVhZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLkF1dGhvcml6YXRpb24gPSBhdXRoSGVhZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuYmFzZVVybCArIHBhdGggKyAocXVlcnlTdHIgPyBcIj9cIiArIHF1ZXJ5U3RyIDogXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaXNvbW9ycGhpYy5mZXRjaCh1cmwsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZmV0Y2hPcHRpb25zLCB7IGhlYWRlcnM6IGhlYWRlcnMsIG1ldGhvZDogbWV0aG9kIH0sIGZldGNoT3B0aW9ucykpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyA9PSA0MDEgJiYgdGhpcy5iZWFyZXJQcm92aWRlcikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3d3dhdXRoID0gcmVzLmhlYWRlcnMuZ2V0KFwid3d3LWF1dGhlbnRpY2F0ZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgXCIgKyByZXMuc3RhdHVzICsgXCIgZnJvbSBcIiArICh0aGlzLmJhc2VVcmwgKyBwYXRoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHd3d2F1dGggJiYgL0JlYXJlci9pLnRlc3Qod3d3YXV0aCkpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJlYXJlclByb3ZpZGVyLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZC50b2tlbkluZm8gPSBfZS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IFwiQmVhcmVyIFwiICsgdGhpcy50b2tlbkluZm8udG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaXNvbW9ycGhpYy5mZXRjaCh1cmwsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZmV0Y2hPcHRpb25zLCB7IGhlYWRlcnM6IGhlYWRlcnMsIG1ldGhvZDogbWV0aG9kIH0sIGZldGNoT3B0aW9ucykpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA5O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChwYXRoLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJHRVRcIiwgeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvbjsgdGV4dC9wbGFpblwiIH0sIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpO1xyXG4gICAgfTtcclxuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLnBvc3QgPSBmdW5jdGlvbiAocGF0aCwgZGF0YSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJQT1NUXCIsIHtcclxuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgfSwgbnVsbCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpIH0pKTtcclxuICAgIH07XHJcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAocGF0aCwgcXVlcnksIGJvZHksIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiREVMRVRFXCIsIHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb247IHRleHQvcGxhaW5cIiB9LCBxdWVyeSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IGJvZHkgfSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZXN0Q2xpZW50O1xyXG59KCkpO1xyXG5leHBvcnQgeyBSZXN0Q2xpZW50IH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlc3RjbGllbnQuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVVSUQoKSB7XHJcbiAgICAvLyBEZWNlbnQgc29sdXRpb24gZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHRcclxuICAgIHZhciBkID0gRGF0ZS5ub3coKTtcclxuICAgIHZhciB1dWlkID0gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwO1xyXG4gICAgICAgIGQgPSBNYXRoLmZsb29yKGQgLyAxNik7XHJcbiAgICAgICAgcmV0dXJuIChjID09PSAneCcgPyByIDogKHIgJiAweDcgfCAweDgpKS50b1N0cmluZygxNik7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB1dWlkO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHMobWV0aG9kKSB7XHJcbiAgICB2YXIgb25nb2luZ1Byb21pc2UgPSBudWxsO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIW9uZ29pbmdQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIG9uZ29pbmdQcm9taXNlID0gbWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlO1xyXG4gICAgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0R2xvYmFsSWQocmVhbG0pIHtcclxuICAgIHZhciBwcmVmaXggPSAnZWM5NmIzYmUtNDVmYy00MWQzLWI2OWUtJztcclxuICAgIHZhciBwYWQgPSBbJzUwJywgJzA4JywgJ2UxJywgJzQwJywgJ2U0JywgJ2U3J107XHJcbiAgICBpZiAocmVhbG0ubGVuZ3RoID4gNilcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUb28gbG9uZyByZWFsbVwiKTtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhbG0ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICB2YXIgaGV4ID0gcmVhbG0uY2hhckNvZGVBdChpKS50b1N0cmluZygxNik7XHJcbiAgICAgICAgcGFkW2ldID0gaGV4Lmxlbmd0aCA9PT0gMiA/XHJcbiAgICAgICAgICAgIGhleCA6XHJcbiAgICAgICAgICAgICcwJyArIGhleDtcclxuICAgIH1cclxuICAgIHJldHVybiBwcmVmaXggKyBwYWQuam9pbignJyk7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVQcmVkZXN0aW5hdGVkSWQoaW5wdXQpIHtcclxuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBlbmNvZGVyLCBkYXRhLCBkaWdlc3QsIF9hLCBpO1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlbmNvZGVyLmVuY29kZShpbnB1dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBVaW50OEFycmF5LmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgY3J5cHRvLnN1YnRsZS5kaWdlc3QoJ1NIQS0yNTYnLCBkYXRhKV07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgZGlnZXN0ID0gbmV3IChfYS5hcHBseShVaW50OEFycmF5LCBbdm9pZCAwLCBfYi5zZW50KCldKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBpID0gMDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5pYmJsZSA9IGRpZ2VzdFtpKytdICUgMTYgfCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdhc2hlZE5pYmJsZSA9IGMgPT09ICd4JyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgJiAweDcgfCAweDg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2FzaGVkTmliYmxlLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG4vKmV4cG9ydCBmdW5jdGlvbiBidWYyaGV4KGJ1ZmZlcjogQXJyYXlCdWZmZXIpIHtcclxuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKFxyXG4gICAgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSxcclxuICAgICh4OiBudW1iZXIpID0+ICgnMDAnICsgeC50b1N0cmluZygxNikpLnNsaWNlKC0yKSkuam9pbignJyk7XHJcbn0qL1xyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQXJyYXkoYSwgbWFwcGVyKSB7XHJcbiAgICB2YXIgcmV0dmFsID0gYTtcclxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcclxuICAgICAgICB2YXIgdCA9IGFbaV07XHJcbiAgICAgICAgdmFyIG1hcHBlZCA9IG1hcHBlcih0KTtcclxuICAgICAgICBpZiAobWFwcGVkICE9PSB0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXR2YWwgPT09IGEpXHJcbiAgICAgICAgICAgICAgICByZXR2YWwgPSBhLnNsaWNlKCk7XHJcbiAgICAgICAgICAgIHJldHZhbFtpXSA9IG1hcHBlZDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmV0dmFsO1xyXG59XHJcbi8qXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBcnJheTxUPihhOiBUW10sIG1hcHBlcjogKHQ6IFQpID0+IFQgfCBmYWxzZSk6IFRbXSB7XHJcbiAgbGV0IHJldHZhbCA9IGE7XHJcbiAgbGV0IGogPSAwO1xyXG4gIGZvciAobGV0IGk9MCxsPWEubGVuZ3RoOyBpPGw7ICsraSwgKytqKSB7XHJcbiAgICBjb25zdCB0ID0gYVtpXTtcclxuICAgIGNvbnN0IG1hcHBlZCA9IG1hcHBlcih0KTtcclxuICAgIGlmIChtYXBwZWQgPT09IGZhbHNlKSB7XHJcbiAgICAgIC8vIE1hcHBlciB3YW50cyB0byBkZWxldGUgdGhpcyBkb2MuXHJcbiAgICAgIGlmIChyZXR2YWwgPT09IGEpIHJldHZhbCA9IGEuc2xpY2UoKTtcclxuICAgICAgcmV0dmFsLnNwbGljZShqLCAxKTtcclxuICAgICAgLS1qOyAvLyBjb21wZW5zYXRlIGZvciArK2pcclxuICAgIH0gZWxzZSBpZiAobWFwcGVkICE9PSB0KSB7XHJcbiAgICAgIGlmIChyZXR2YWwgPT09IGEpIHJldHZhbCA9IGEuc2xpY2UoKTtcclxuICAgICAgcmV0dmFsW2pdID0gbWFwcGVkO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gcmV0dmFsO1xyXG59XHJcbiovIFxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiLCJpbXBvcnQgKiBhcyBKc29uU2NoZW1hIGZyb20gXCJrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvblwiO1xyXG5pbXBvcnQgeyBnZXRUYWJsZUZyb21MYWJlbCB9IGZyb20gXCIuL3V0aWxzXCI7XHJcbnZhciBDYWNoZUJ1c3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDYWNoZUJ1c3QoKSB7XHJcbiAgICB9XHJcbiAgICBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgdXNlciwgaW5jbHVkZXMpIHtcclxuICAgICAgICB2YXIgaW52b2x2ZWRJdGVtcyA9IENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpO1xyXG4gICAgICAgIHJldHVybiBpbnZvbHZlZEl0ZW1zXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0pOyB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gISF2YWx1ZTsgfSlcclxuICAgICAgICAgICAgLmpvaW4oJy8nKSB8fCAnc3RhdGljJztcclxuICAgIH07XHJcbiAgICBDYWNoZUJ1c3QuaW52YWxpZGF0ZUNhY2hlID0gZnVuY3Rpb24gKHJlcXMsIHVzZXIpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gQ2FjaGVCdXN0LmdldENhY2hlSW52YWxpZGF0aW9ucyhyZXFzKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGl0ZW0gPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0sICcnICsgRGF0ZS5ub3coKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcclxuICAgICAgICB2YXIgaGFzRWRnZXNGcm9tID0gcXVlcnkuaGFzRWRnZXNGcm9tO1xyXG4gICAgICAgIHZhciByZWxhdGVkVGFibGVzID0gaW5jbHVkZXNcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTsgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodGFibGUpIHsgcmV0dXJuICEhdGFibGU7IH0pO1xyXG4gICAgICAgIGlmIChoYXNFZGdlc0Zyb20pXHJcbiAgICAgICAgICAgIHJlbGF0ZWRUYWJsZXMucHVzaChcImhlZlwiICsgdGFibGUpO1xyXG4gICAgICAgIHJldHVybiBbdGFibGUsICdtYXN0ZXInLCBxdWVyeS5icmFuY2hJZF0uZmlsdGVyKGZ1bmN0aW9uICh4KSB7IHJldHVybiAhIXg7IH0pLmNvbmNhdChyZWxhdGVkVGFibGVzKS5zb3J0KCk7XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVCdXN0LmdldENhY2hlSW52YWxpZGF0aW9ucyA9IGZ1bmN0aW9uIChyZXFzKSB7XHJcbiAgICAgICAgdmFyIGludmFsaWRhdGlvblNldCA9IHt9O1xyXG4gICAgICAgIHJlcXMuZm9yRWFjaChmdW5jdGlvbiAocmVxKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocmVxLm9wKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhZGQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAncHV0JzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFibGVdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2xpbmsnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndW5saW5rJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5zb3VyY2VUYWJsZV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtcImhlZi1cIiArIGdldFRhYmxlRnJvbUxhYmVsKHJlcS5zb3VyY2VUYWJsZSwgcmVxLmxhYmVsKV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLmJyYW5jaElkXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5icmFuY2hJZF0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFyZ2V0QnJhbmNoSWQgfHwgXCJtYXN0ZXJcIl0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGludmFsaWRhdGlvblNldCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENhY2hlQnVzdDtcclxufSgpKTtcclxuZXhwb3J0IHsgQ2FjaGVCdXN0IH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNhY2hlLWJ1c3QuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgbWVyZ2VEZWx0YXMgfSBmcm9tICcuLi9kZWx0YS1tZXJnZSc7XHJcbmV4cG9ydCBmdW5jdGlvbiBhcHBseU11dGF0aW9uc09uRGVsdGFzKGJyYW5jaElkLCBkZWx0YXMsIG11dGF0aW9ucywgb3B0aW1pc3RpYywgdXNlckRpc3BsYXlOYW1lLCBoYXNBZGRpdGlvbmFsRmlsdGVyKSB7XHJcbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgc3dpdGNoIChtLm9wKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2FkZC1yZWxhdGVkJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBBZGRSZWxhdGVkIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmICghaGFzQWRkaXRpb25hbEZpbHRlciAmJiBtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYWRkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0ucmVsYXRlZERvYy5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBtLmdyYXBoUHJvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRhYmxlOiBtLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAnYWRkaW5nJyA6ICdwZXJzaXN0ZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnJlbGF0ZWREb2MubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yOiB1c2VyRGlzcGxheU5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfV0uY29uY2F0KGRlbHRhcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBDbGVhckJyYW5jaCBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHR5cGUgb2YgbXV0YXRpb24gY2FuIG5vdCBiZSBwZXJmb3JtZWQgb250byBicmFuY2hlcy4gVGhlcmUncyBubyBicmFuY2hJZCBwcm9wZXJ0eSBvbiBtLlxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ21lcmdlJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBNZXJnZSBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG0udGFyZ2V0QnJhbmNoSWQgPT09IGJyYW5jaElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBjaGFuZ2Ugd2lsbCBhcHBlbmQgbmV3IGRlbHRhcyB0byBvdXIgZGVsdGFzIGFycmF5IGJ1dCB3ZSBkb24ndCBrbm93IHdoYXQgd291bGQgY29tZS5cclxuICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHJlZmV0Y2ggZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbnVsbCB9OyAvLyBDYWxsZXIgc2hvdWxkIGNoZWNrIGZvciBudWxsIGFuZCByZS1mZXRjaCBkYXRhIGZyb20gc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUtUmVsYXRlZCBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzQWRkaXRpb25hbEZpbHRlciB8fCBtLmJyYW5jaElkICE9PSBicmFuY2hJZClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3JlbW92ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5yZWxhdGVkRG9jLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnJlbGF0ZWREb2MubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG0uZ3JhcGhQcm9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUYWJsZTogbS50YWJsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3I6IHVzZXJEaXNwbGF5TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJ1xyXG4gICAgICAgICAgICAgICAgICAgIH1dLmNvbmNhdChkZWx0YXMpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gVW5kby1MaW5rIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkICE9PSBicmFuY2hJZClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBkZWx0YXMuZmluZEluZGV4KGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoZC50eXBlID09PSAnYWRkJyB8fCBkLnR5cGUgPT09ICdyZW1vdmUnIHx8IGQudHlwZSA9PT0gJ3VuZG8tbGluaycpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnNvdXJjZUlkID09PSBtLmlkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnRhcmdldElkID09PSBtLnJlbGF0ZWRJZDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgICAgICAvLyBGb3VuZCBhbiBcImFkZFwiIG9yIFwicmVtb3ZlXCIgZGVsdGEgdG8gY2hhbmdlOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YVJlbGF0aW9uID0gZGVsdGFzW2lkeF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgdGhlIGV4aXN0aW5nIGFkZC9yZW1vdmUgZGVsdGEgYXMgY3VycmVubHR5IGJlaW5nIGRlbGV0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gZGVsdGFzLnNsaWNlKDAsIGlkeCkuY29uY2F0KFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhUmVsYXRpb24sIHsgJG1ldGE6IG9wdGltaXN0aWMgPyAncmVtb3ZpbmcnIDogJ3BlcnNpc3RlZCcgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgXSwgZGVsdGFzLnNsaWNlKGlkeCArIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBlcnNpc3RlZC4gSnVzdCByZW1vdmUgaXQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gZGVsdGFzLmZpbmRJbmRleChmdW5jdGlvbiAoZGVsdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbHRhLnR5cGUgPT09ICdtb2RpZnknICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YS50YXJnZXRJZCA9PT0gbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMCAmJiAhaGFzQWRkaXRpb25hbEZpbHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdtb2RpZnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG0udGFyZ2V0TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBtLmRlbHRhRG9jLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yczogW3VzZXJEaXNwbGF5TmFtZV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAnYWRkaW5nJyA6ICdwZXJzaXN0ZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0uY29uY2F0KGRlbHRhcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdEZWx0YURvYyA9IGRlbHRhc1tpZHhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udHJpYnV0b3JzID0gZXhpc3RpbmdEZWx0YURvYy5jb250cmlidXRvcnMuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250cmlidXRvcnMuaW5jbHVkZXModXNlckRpc3BsYXlOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3JzLnB1c2godXNlckRpc3BsYXlOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IG1lcmdlRGVsdGFzKGV4aXN0aW5nRGVsdGFEb2MuZGF0YSwgbS5kZWx0YURvYywgeyByZW1vdmVVbnNldFByb3BzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMgJiYgT2JqZWN0LmtleXMobmV3RGF0YSkubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb21taXR0ZWQgbXV0YXRpb24gdGhhdCByZXNldHMgYSBkZWx0YURvYy4gUmVtb3ZlIHRoZSBkZWx0YURvYyBlbnRpcmVseTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9kaWZ5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG0udGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnRhcmdldE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG5ld0RhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnM6IGNvbnRyaWJ1dG9ycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAndXBkYXRpbmcnIDogJ3BlcnNpc3RlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5jb25jYXQoZGVsdGFzLnNsaWNlKDAsIGlkeCksIGRlbHRhcy5zbGljZShpZHggKyAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBtdXRhdGlvbnNfMSA9IG11dGF0aW9uczsgX2kgPCBtdXRhdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIgbSA9IG11dGF0aW9uc18xW19pXTtcclxuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEobSk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzdGF0ZV8xID09PSBcIm9iamVjdFwiKVxyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBkZWx0YXM7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBIdHRwRXJyb3IgfSBmcm9tICcuLi8uLi9rZWQtYmFja2VuZC1jbGllbnQnO1xyXG5pbXBvcnQgeyBhcHBseU11dGF0aW9uc09uRGVsdGFzIH0gZnJvbSAnLi9hcHBseS1tdXRhdGlvbnMtb24tZGVsdGFzJztcclxudmFyIERlbHRhQ2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEZWx0YUNhY2hlKGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5nZXRDbGllbnQgPSBnZXRDbGllbnQ7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcclxuICAgICAgICB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSA9IGdldFVzZXJEaXNwbGF5TmFtZTtcclxuICAgICAgICB0aGlzLmxvb2t1cCA9IHt9O1xyXG4gICAgfVxyXG4gICAgRGVsdGFDYWNoZS5wcm90b3R5cGUuYXBwbHlNdXRhdGlvbnMgPSBmdW5jdGlvbiAobXV0YXRpb25zLCBfYSkge1xyXG4gICAgICAgIHZhciBvcHRpbWlzdGljID0gKF9hID09PSB2b2lkIDAgPyB7IG9wdGltaXN0aWM6IGZhbHNlIH0gOiBfYSkub3B0aW1pc3RpYztcclxuICAgICAgICAvLyBBcHBseSBtdXRhdGlvbnMgbG9jYWxseSBvbnRvIHRoZSBEZWx0YUNhY2hlIGFuZCBub3RpZnkgdGhlaXIgc3Vic2NyaWJlcnNcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9iID0gT2JqZWN0LmtleXModGhpcy5sb29rdXApOyBfaSA8IF9iLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlLZXkgPSBfYltfaV07XHJcbiAgICAgICAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5sb29rdXBbcXVlcnlLZXldO1xyXG4gICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW5zdGVhZCBoZXJlOiBTdG9yZSB0aGUgbXV0YXRpb25zIG9uIGNhY2hlRW50cnkuIE5vIG1hdHRlciBpZiBpdCB5ZXQgaGFzIHZhbHVlIG9yIG5vdC5cclxuICAgICAgICAgICAgICAgIC8vIFRoZW4gYXBwbHkgbXV0YXRpb24gd2hlbmV2ZXIgc3Vic2NyaWJpbmchIChCZXR0ZXIgaGFuZGxpbmcgb2YgbXV0YXRpb25zIHRoYXQgYXJyaXZlcyBiZWZvcmUgZmV0Y2goKSBpcyBkb25lKVxyXG4gICAgICAgICAgICAgICAgLy8gKFNlZSBob3cgSSBoYW5kbGUgdGhpcyBpbiBxdWVyeS1zZXQudHMpXHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBhcHBseU11dGF0aW9uc09uRGVsdGFzKGNhY2hlRW50cnkucXVlcnkuYnJhbmNoSWQsIGNhY2hlRW50cnkudmFsdWUsIG11dGF0aW9ucywgb3B0aW1pc3RpYywgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUoKSwgISFjYWNoZUVudHJ5LnF1ZXJ5LnRhZ3MpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIG11dGF0aW9uIHJlcXVpcmVzIGNhY2hlRW50cnkgdG8gYmUgcmVmZXRjaGVkIGZyb20gc2VydmVyXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGxlciBoYXMgc3VjY2Vzc2Z1bGx5IHBlcmZvcm1lZCB0aGUgbXV0YXRpb25zIGFuZCBnb3Qgc3VjY2VzcyBiYWNrIGZyb20gc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJdCdzIG9rIHRvIHJlZmV0Y2ggdGhlIGRlbHRhcyBmcm9tIHNlcnZlciBub3c6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkuZmV0Y2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWZ0ZXIgZmV0Y2ggY29tcGxldGVzLCBpdCB3aWxsIG5vdGlmeSB0aGUgc3Vic2NyaWJlcnMuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjYWNoZUVudHJ5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5vcHRpbWlzdGljVmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkudmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5Lm5vdGlmeShuZXdWYWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRGVsdGFDYWNoZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHF1ZXJ5LCBvYnNlcnZlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNhY2hlRW50cnkgPSB0aGlzLmxvb2t1cFtxdWVyeS5icmFuY2hJZCArIHF1ZXJ5LnRhZ3NdO1xyXG4gICAgICAgIGlmICghY2FjaGVFbnRyeSkge1xyXG4gICAgICAgICAgICBjYWNoZUVudHJ5ID0gbmV3IERlbHRhQ2FjaGVFbnRyeSh0aGlzLmdldENsaWVudCgpLCBxdWVyeSk7XHJcbiAgICAgICAgICAgIHRoaXMubG9va3VwW3F1ZXJ5LmJyYW5jaElkICsgcXVlcnkudGFnc10gPSBjYWNoZUVudHJ5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIpIHtcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNhY2hlRW50cnkuY2xlYW51cFRpbWVyKTtcclxuICAgICAgICAgICAgY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5zdWJzY3JpYmVycyA9IGNhY2hlRW50cnkuc3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvID0gX2Eub2JzZXJ2ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG8gIT09IG9ic2VydmVyO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LmNsZWFudXBUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5sb29rdXBbcXVlcnkuYnJhbmNoSWQgKyBxdWVyeS50YWdzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNhY2hlRW50cnkuc3Vic2NyaWJlcnMucHVzaCh7IG9ic2VydmVyOiBvYnNlcnZlciwgc3Vic2NyaXB0aW9uOiBzdWJzY3JpcHRpb24gfSk7XHJcbiAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gVmFsdWUgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IHJldHJpZXZlZCBhbHJlYWR5LiBQaWNrIGZyb20gY2FjaGUuXHJcbiAgICAgICAgICAgIG9ic2VydmVyKGNhY2hlRW50cnkub3B0aW1pc3RpY1ZhbHVlIHx8IGNhY2hlRW50cnkudmFsdWUsIG51bGwsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNhY2hlRW50cnkuaXNGZXRjaGluZykge1xyXG4gICAgICAgICAgICAvLyBBIHZhbHVlIGlzIG9uIGl0cyB3YXkuIFNpdCBiYWNrIGFuZCByZWxheC4gQWxsIHJlZ2lzdGVyZWRcclxuICAgICAgICAgICAgLy8gb2JzZXJ2ZXJzIChpbmNsdWRpbmcgdGhpcyBvbmUpIHdpbGwgYmUgbm90aWZpZWQgd2hlbiBkYXRhIGFycml2ZXNcclxuICAgICAgICAgICAgLy8gb3IgZmFpbHMuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGNhY2hlRW50cnkuZXJyb3IpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgY2FjaGVFbnRyeS5lcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNhY2hlRW50cnkuZmV0Y2goKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVsdGFDYWNoZTtcclxufSgpKTtcclxuZXhwb3J0IHsgRGVsdGFDYWNoZSB9O1xyXG52YXIgRGVsdGFDYWNoZUVudHJ5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZUVudHJ5KGNsaWVudCwgcXVlcnkpIHtcclxuICAgICAgICB0aGlzLmZldGNoT3BlcmF0aW9uSWQgPSAwOyAvLyBNYWtlcyBzdXJlIGEgcmUtZmV0Y2ggd2lsbCBkaXNjYXJkIHRoZSByZXN1bHQgZnJvbSBhbnkgb25nb2luZyBmZXRjaC5cclxuICAgICAgICB0aGlzLmNsaWVudCA9IGNsaWVudDtcclxuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vcHRpbWlzdGljVmFsdWUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLmlzRmV0Y2hpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmNsZWFudXBUaW1lciA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBEZWx0YUNhY2hlRW50cnkucHJvdG90eXBlLmZldGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZldGNoT3BlcmF0aW9uSWQgPSArK3RoaXMuZmV0Y2hPcGVyYXRpb25JZDtcclxuICAgICAgICB0aGlzLmlzRmV0Y2hpbmcgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuZmV0Y2hGcm9tU2VydmVyKCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gU3VjY2Vzc1xyXG4gICAgICAgICAgICBpZiAoZmV0Y2hPcGVyYXRpb25JZCA9PT0gX3RoaXMuZmV0Y2hPcGVyYXRpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmFsdWUuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYi5kYXRlVGltZSAtIGEuZGF0ZVRpbWU7IH0pOyAvLyBMYXRlc3QgZmlyc3RcclxuICAgICAgICAgICAgICAgIF90aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vcHRpbWlzdGljVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIF90aGlzLm5vdGlmeSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgLy8gRmFpbFxyXG4gICAgICAgICAgICBpZiAoZmV0Y2hPcGVyYXRpb25JZCA9PT0gX3RoaXMuZmV0Y2hPcGVyYXRpb25JZCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgICAgIF90aGlzLmZhaWwoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mZXRjaEZyb21TZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucXVlcnkuYnJhbmNoSWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RlbHRhcyBvbmx5IGF2YWlsYWJsZSBvbiBicmFuY2hlcycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsaWVudC5odHRwLmdldCgnZGVsdGFzJywgdGhpcy5xdWVyeSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzID49IDMwMCB8fCByZXMuc3RhdHVzIDwgMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5zdWJzY3JpYmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBvYnNlcnZlciA9IF9iLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYi5zdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEZWx0YUNhY2hlRW50cnkucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICB2YXIgY29weSA9IHRoaXMuc3Vic2NyaWJlcnMuc2xpY2UoKTtcclxuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjb3B5XzEgPSBjb3B5OyBfaSA8IGNvcHlfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIF9hID0gY29weV8xW19pXSwgb2JzZXJ2ZXIgPSBfYS5vYnNlcnZlciwgc3Vic2NyaXB0aW9uID0gX2Euc3Vic2NyaXB0aW9uO1xyXG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlbHRhQ2FjaGVFbnRyeTtcclxufSgpKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtY2FjaGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gJy4uLy4uL29ic2VydmFibGUnO1xyXG52YXIgRGVsdGFDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRGVsdGFDb2xsZWN0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gRGVsdGFDb2xsZWN0aW9uKGRlbHRhQ2FjaGUsIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBfdGhpcy5kZWx0YUNhY2hlLnN1YnNjcmliZShxdWVyeSwgb2JzZXJ2ZXIpOyB9KSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmRlbHRhQ2FjaGUgPSBkZWx0YUNhY2hlO1xyXG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRGVsdGFDb2xsZWN0aW9uLnByb3RvdHlwZS50YWdzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0YWdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IERlbHRhQ29sbGVjdGlvbih0aGlzLmRlbHRhQ2FjaGUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMucXVlcnksIHsgdGFnczogdGFncyB9KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlbHRhQ29sbGVjdGlvbjtcclxufShDb2xsZWN0aW9uKSk7XHJcbmV4cG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmV4cG9ydCBmdW5jdGlvbiBhcHBseURlbHRhKGRvYywgZGVsdGEpIHtcclxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEpO1xyXG4gICAgdmFyIHRhcmdldERvYyA9IGRvYztcclxuICAgIGZvciAodmFyIF9pID0gMCwga2V5c18xID0ga2V5czsgX2kgPCBrZXlzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XHJcbiAgICAgICAgaWYgKHRhcmdldERvYyA9PT0gZG9jKVxyXG4gICAgICAgICAgICB0YXJnZXREb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xyXG4gICAgICAgIHZhciB2YWwgPSBkZWx0YVtrZXldO1xyXG4gICAgICAgIGlmICh2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xyXG4gICAgICAgICAgICBpZiAobWV0YUluc3RydWN0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChtaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkdW5zZXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZyBvbiB0YXJnZXQgZG9jIVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RG9jLiR3YXNVbnNldCA9IHRydWU7IC8vIEp1c3QgbWFyayBpdCBmb3IgcmUtcmV0cmlldmFsIGFmdGVyIHN1Y2Nlc3NmdWwgcG9zdGluZyBjaGFuZ2VzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvQWRkID0gbWlWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb0FkZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkYWRkIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBcnJheSA9IHRhcmdldERvY1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IHRhcmdldEFycmF5LnNsaWNlKCk7IC8vIE9uIEpTIHNpZGUsIHdlIG11c3QgYmUgaW1tdXRhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB2YWx1ZXNUb0FkZF8xID0gdmFsdWVzVG9BZGQ7IF9pIDwgdmFsdWVzVG9BZGRfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IHZhbHVlc1RvQWRkXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0QXJyYXkuaW5jbHVkZXModikpIHsgLy8gYXZvaWQgZHVwc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheS5wdXNoKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb1JlbW92ZV8xID0gbWlWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8xKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFyZ2V0QXJyYXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvY1trZXldID0gdGFyZ2V0QXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9SZW1vdmVfMS5pbmNsdWRlcyh0KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMSA9IG1ldGFJbnN0cnVjdGlvbnM7IF9hIDwgbWV0YUluc3RydWN0aW9uc18xLmxlbmd0aDsgX2ErKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMVtfYV07XHJcbiAgICAgICAgICAgICAgICAgICAgX2xvb3BfMShtaSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHZhbDtcclxuICAgIH1cclxuICAgIHJldHVybiB0YXJnZXREb2M7XHJcbn1cclxuLy8ge25hbWU6IFwiVWxsYVwifSwge25hbWU6IHskdW5zZXQ6MH1cclxuLy8ge3RhZ3M6IHskYWRkOiBcImhlalwifX0sIHt0YWdzOiB7JHVuc2V0OjB9XCJ9XHJcbmV4cG9ydCBmdW5jdGlvbiBtZXJnZURlbHRhcyhkZWx0YTEsIGRlbHRhMiwgX2EpIHtcclxuICAgIHZhciByZW1vdmVVbnNldFByb3BzID0gKF9hID09PSB2b2lkIDAgPyB7IHJlbW92ZVVuc2V0UHJvcHM6IGZhbHNlIH0gOiBfYSkucmVtb3ZlVW5zZXRQcm9wcztcclxuICAgIC8vcmV0dXJuIHsuLi5kZWx0YTEsIC4uLmRlbHRhMn07XHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRlbHRhMik7XHJcbiAgICB2YXIgdGFyZ2V0RGVsdGEgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YTEpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzOyBfaSA8IGtleXNfMi5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga2V5ID0ga2V5c18yW19pXTtcclxuICAgICAgICB2YXIgdmFsID0gZGVsdGEyW2tleV07XHJcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4ga2V5LnN0YXJ0c1dpdGgoJyQnKTsgfSk7XHJcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8yID0gZnVuY3Rpb24gKG1pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pVmFsdWUgPSB2YWxbbWldO1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiR1bnNldFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtb3ZlVW5zZXRQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXREZWx0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gbWF0dGVyIGlmIHRhcmdldERlbHRhIGlzIGVtcHR5IG9yIGhhcyB2YWx1ZS4gU2V0IGl0IHRvIHskdW5zZXQ6MH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBtYWtlIHN1cmUgdGhlIHZlcnkgZW5kIHJlc3VsdCB3aWxsIGhhdmUgeyR1bnNldDowfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB7ICR1bnNldDogMCB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvQWRkXzIgPSBtaVZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkXzIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXRNZXRhUHJvcCA/IHRzbGliXzEuX19hc3NpZ24oe30sIHRhcmdldE1ldGFQcm9wKSA6IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHRhcmdldE1ldGFQcm9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JHJlbW92ZTogWy4uLml0ZW1zXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCByZW1vdmUgYW55IGVxdWFsIGl0ZW1zIGZyb20gdGhlcmUgYmVmb3JlIG1lcmdpbmcgdGhlIHskYWRkOiBbLi4uXX0gYXJyYXlzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJlbW92ZUFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFJlbW92ZUFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRyZW1vdmUgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdmVBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsgcmV0dXJuICF2YWx1ZXNUb0FkZF8yLmluY2x1ZGVzKHQpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJHJlbW92ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgJHJlbW92ZSBhcnJheSBiZWNhbWUgZW10cHkuIFJlbW92ZSB0aGUgJHJlbW92ZSBwcm9wLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3cgaXQncyB0aW1lIHRvIG1lcmdlIG9yIGNyZWF0ZSB0YXJnZXQgJGFkZCBhcnJheS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBZGRBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRhZGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheSA9IHRhcmdldEFkZEFycmF5ID8gdGFyZ2V0QWRkQXJyYXkuY29uY2F0KHZhbHVlc1RvQWRkXzIpIDogdmFsdWVzVG9BZGRfMi5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJGFkZCA9IHRhcmdldEFkZEFycmF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRyZW1vdmVcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzIgPSBtaVZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJHJlbW92ZSBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXRNZXRhUHJvcCA/IHRzbGliXzEuX19hc3NpZ24oe30sIHRhcmdldE1ldGFQcm9wKSA6IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHRhcmdldE1ldGFQcm9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JGFkZDogWy4uLml0ZW1zXX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCByZW1vdmUgYW55IGVxdWFsIGl0ZW1zIGZyb20gdGhlcmUgYmVmb3JlIG1lcmdpbmcgdGhlIHskcmVtb3ZlOiBbLi4uXX0gYXJyYXlzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldEFkZEFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRhZGQgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsgcmV0dXJuICF2YWx1ZXNUb1JlbW92ZV8yLmluY2x1ZGVzKHQpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJGFkZC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgJGFkZCBhcnJheSBiZWNhbWUgZW10cHkuIFJlbW92ZSB0aGUgJGFkZCBwcm9wLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0TWV0YVByb3AuJGFkZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3cgaXQncyB0aW1lIHRvIG1lcmdlIG9yIGNyZWF0ZSB0YXJnZXQgJHJlbW92ZSBhcnJheS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldFJlbW92ZUFycmF5ID8gdGFyZ2V0UmVtb3ZlQXJyYXkuY29uY2F0KHZhbHVlc1RvUmVtb3ZlXzIpIDogdmFsdWVzVG9SZW1vdmVfMi5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJHJlbW92ZSA9IHRhcmdldFJlbW92ZUFycmF5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2IgPSAwLCBtZXRhSW5zdHJ1Y3Rpb25zXzIgPSBtZXRhSW5zdHJ1Y3Rpb25zOyBfYiA8IG1ldGFJbnN0cnVjdGlvbnNfMi5sZW5ndGg7IF9iKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzJbX2JdO1xyXG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzIobWkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHZhbDtcclxuICAgIH1cclxuICAgIHJldHVybiB0YXJnZXREZWx0YTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1tZXJnZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XHJcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XHJcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1yZXBvJztcclxuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbic7XHJcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC13cml0ZXInO1xyXG5leHBvcnQgKiBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcclxuZXhwb3J0ICogZnJvbSAnLi9xdWVyeS1zZXQnO1xyXG5leHBvcnQgKiBmcm9tICcuLi9vYnNlcnZhYmxlL21peGluJztcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgQmF0Y2hSdW5uZXIgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uIH0gZnJvbSBcIi4va2VkYmFja2VuZC1zdWJzY3JpcHRpb25cIjtcclxuaW1wb3J0IHsgQ2FjaGVCdXN0IH0gZnJvbSAnLi9jYWNoZS1idXN0JztcclxuaW1wb3J0IHsgS2VkQmFja2VuZFF1ZXJ5IH0gZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcclxuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gJy4uL29ic2VydmFibGUvY29sbGVjdGlvbic7XHJcbi8qKlxyXG4gKiBSZXByZXNlbnRzIGEgXCJsaXZlXCIgcXVlcnkgYWdhaW5zdCBhIHRhYmxlIG9yIGZpbHRlcmVkIHRhYmxlLlxyXG4gKi9cclxudmFyIEtlZEJhY2tlbmRDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoS2VkQmFja2VuZENvbGxlY3Rpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ29sbGVjdGlvbihyZXBvLCB0YWJsZSwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG5ldyBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uKG9ic2VydmVyLCBfdGhpcyk7XHJcbiAgICAgICAgICAgIF90aGlzLnJlcG8ucXVlcnlTZXQuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5yZXBvID0gcmVwbztcclxuICAgICAgICBfdGhpcy50YWJsZSA9IHRhYmxlO1xyXG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJxdWVyeUtleVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLCBcImluY2x1ZGVzXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luY2x1ZGVzIHx8ICh0aGlzLl9pbmNsdWRlcyA9IFtdLmNvbmNhdCh0aGlzLnF1ZXJ5LmluY2x1ZGUgfHwgW10pKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBLZWRCYWNrZW5kQ29sbGVjdGlvbih0aGlzLnJlcG8sIHRoaXMudGFibGUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMucXVlcnksIHF1ZXJ5KSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFRvUXVlcnlBcnJheVByb3AgPSBmdW5jdGlvbiAoYXJyYXlQcm9wLCBlbnRyaWVzKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoKF9hID0ge30sIF9hW2FycmF5UHJvcF0gPSAodGhpcy5xdWVyeVthcnJheVByb3BdIHx8IFtdKS5jb25jYXQoZW50cmllcyksIF9hKSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZEZsYWdzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBmbGFncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGZsYWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJmbGFnc1wiLCBmbGFncyk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBkZWJ1ZzogdHJ1ZSB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzT25seSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc09ubHlcIik7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkc0FuZE5hbWVzT25seSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc0FuZE5hbWVzT25seVwiKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5jbHVkZUlkc09ubHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpbmNsdWRlSWRzT25seVwiKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaW5jbHVkZUlkc0FuZE5hbWVzT25seSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNBbmROYW1lc09ubHlcIik7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmJldHdlZW4gPSBmdW5jdGlvbiAoZnJvbSwgdG8pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgZnJvbTogZnJvbSwgdG86IHRvIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5yb2xlID0gZnVuY3Rpb24gKHJvbGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgcm9sZTogcm9sZSB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaGFzRWRnZXNGcm9tID0gZnVuY3Rpb24gKGlkcykge1xyXG4gICAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8IGlkcy5zb21lKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gIWlkOyB9KSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBpZCBsaXN0IGdpdmVuIHRvIENvbGxlY3Rpb24uaGFzRWRnZXNGcm9tKFwiICsgSlNPTi5zdHJpbmdpZnkoaWRzKSArIFwiKVwiKTtcclxuICAgICAgICB2YXIgaGVmID0gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaGFzRWRnZXNGcm9tXCIsIGlkcyk7XHJcbiAgICAgICAgcmV0dXJuIGhlZjtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaGFzRWRnZXNUbyA9IGZ1bmN0aW9uIChpZHMpIHtcclxuICAgICAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCB8fCBpZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICFpZDsgfSkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzVG8oXCIgKyBKU09OLnN0cmluZ2lmeShpZHMpICsgXCIpXCIpO1xyXG4gICAgICAgIHZhciBoZXQgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc1RvXCIsIGlkcyk7XHJcbiAgICAgICAgcmV0dXJuIGhldDtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcclxuICAgICAgICAgICAgb25aZXJvOiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBmaW5kIGVudGl0eSBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcclxuICAgICAgICAgICAgb25NYW55OiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIk11bHRpcGxlIGVudHJpZXMgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkcyA9IGZ1bmN0aW9uIChpZHMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS50YWdzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0YWdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgdGFnczogdGFncyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBncmFwaHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImluY2x1ZGVcIiwgZ3JhcGhzKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuY2FjaGVPcHRpbWl6ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGNhY2hlQnVzdDogQ2FjaGVCdXN0LmdldENhY2hlQnVzdCh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLnJlcG8uZ2V0VXNlcigpLCB0aGlzLmluY2x1ZGVzKSB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubXV0YXRpb25zT25FbXB0eSA9IGZ1bmN0aW9uIChtdXRhdGlvbkZhY3RvcnkpIHtcclxuICAgICAgICB2YXIgdHggPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBtdXRhdGlvbnNPbkVtcHR5OiB0eC5tdXRhdGlvblJlcXVlc3RzIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBfYSA9IHRocm93ZXJzIHx8IHt9LCBvblplcm8gPSBfYS5vblplcm8sIG9uTWFueSA9IF9hLm9uTWFueTtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob25aZXJvKVxyXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBub25lIHdhcyBmb3VuZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnZ2VyO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcclxuICAgICAgICAgICAgICAgICAgICBvbk1hbnkoKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zWzBdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qY29tYmluZUxhdGVzdDxUT3RoZXI+KG90aGVyOiBRdWVyeU9ic2VydmFibGU8VE90aGVyPikge1xyXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcclxuICAgIH0qL1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkb2MsIGNoYW5nZXMsIGRlYm91bmNlKSB7XHJcbiAgICAgICAgaWYgKGRlYm91bmNlID09PSB2b2lkIDApIHsgZGVib3VuY2UgPSAxMDAwOyB9XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAndXBkYXRlJyxcclxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgICAgICAgICAgZGVsdGFEb2M6IGNoYW5nZXMsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBkb2MubmFtZVxyXG4gICAgICAgICAgICB9XSwgZGVib3VuY2UpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRSZWxhdGVkID0gZnVuY3Rpb24gKGlkLCBsYWJlbCwgcmVsYXRlZERvYykge1xyXG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XHJcbiAgICAgICAgICAgICAgICBvcDogJ2FkZC1yZWxhdGVkJyxcclxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICBncmFwaFByb3A6IGxhYmVsLFxyXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvYzogcmVsYXRlZERvY1xyXG4gICAgICAgICAgICB9XSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZVJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkRG9jKSB7XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAncmVtb3ZlLXJlbGF0ZWQnLFxyXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoUHJvcDogbGFiZWwsXHJcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXHJcbiAgICAgICAgICAgIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMucXVlcnkuYnJhbmNoSWQpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVuZG8gbGlua3MgY2FuIG9ubHkgYmUgcGVyZm9ybWVkIG9uIGJyYW5jaGVzXCIpO1xyXG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XHJcbiAgICAgICAgICAgICAgICBvcDogJ3VuZG8tbGluaycsXHJcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcclxuICAgICAgICAgICAgICAgIHJlbGF0ZWRJZDogcmVsYXRlZElkXHJcbiAgICAgICAgICAgIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGlkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGlkc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShpZHMubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcclxuICAgICAgICAgICAgb3A6ICdkZWxldGUnLFxyXG4gICAgICAgICAgICB0YWJsZTogX3RoaXMudGFibGUsXHJcbiAgICAgICAgICAgIGlkOiBpZFxyXG4gICAgICAgIH0pOyB9KSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHRoaXMucmVwby5xdWVyeVNldC51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kQ29sbGVjdGlvbjtcclxufShDb2xsZWN0aW9uKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH07XHJcbi8qbWl4aW4oXHJcbiAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLFxyXG4gIE1hcHBlZENvbGxlY3Rpb24ucHJvdG90eXBlLFxyXG4gIFwibWFwXCIsIFwiZmxhdFwiLCBcImNvbmNhdFwiLCBcInJlbmRlclwiLCBcImxvYWRcIik7Ki9cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IHVwZGF0ZUFycmF5IH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcclxuaW1wb3J0IHsgYnJhbmNoU2Vuc2l0aXZlLCBnZXRUYWJsZUZyb21MYWJlbCB9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQgeyBhcHBseURlbHRhIH0gZnJvbSAnLi9kZWx0YS1tZXJnZSc7XHJcbnZhciBLZWRCYWNrZW5kUXVlcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUXVlcnkodGFibGUsIHF1ZXJ5LCB1c2VyLCByZXBvLCBtdXRhdGlvblF1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy50YWJsZSA9IHRhYmxlO1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMucmVwbyA9IHJlcG87XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLmRhdGEgPSBbXTtcclxuICAgICAgICB0aGlzLmdvdEluaXRpYWxSZXNwb25zZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW52YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubG9hZGVkVmVyc2lvbiA9IDA7XHJcbiAgICAgICAgdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW5jbHVkZXMgPSBxdWVyeS5pbmNsdWRlID9cclxuICAgICAgICAgICAgdHlwZW9mIHF1ZXJ5LmluY2x1ZGUgPT09ICdzdHJpbmcnID9cclxuICAgICAgICAgICAgICAgIFtxdWVyeS5pbmNsdWRlXSA6XHJcbiAgICAgICAgICAgICAgICBxdWVyeS5pbmNsdWRlIDpcclxuICAgICAgICAgICAgW107XHJcbiAgICB9XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uc09uRW1wdHkgPSBxdWVyeS5tdXRhdGlvbnNPbkVtcHR5LCBjb21wYXJhYmxlUHJvcHMgPSB0c2xpYl8xLl9fcmVzdChxdWVyeSwgW1wibXV0YXRpb25zT25FbXB0eVwiXSk7XHJcbiAgICAgICAgcmV0dXJuIHRhYmxlICsgSlNPTi5zdHJpbmdpZnkoY29tcGFyYWJsZVByb3BzKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZSwgXCJxdWVyeUtleVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEsIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgJiYgIXRoaXMuaW52YWxpZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQodGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLCB0cnVlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5xdWVyeUxvY2FsbHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbG9hZFByb21pc2U7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtdXRhdGlvbnNPbkVtcHR5IHNob3VsZCBuZXZlciBiZSB1c2VkIHR3aWNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucXVlcnkubXV0YXRpb25zT25FbXB0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghdmVyc2lvbiAmJiB0aGlzLl9sb2FkUHJvbWlzZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9sb2FkUHJvbWlzZV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiBcclxuICAgICAgICAgICAgICAgICAgICAvLyBsb2FkaW5nIGlzIG9uZ29pbmcsIGFuZCBjYWxsZXIgZG9lcyBub3QgcmVxdWlyZSBhIHJlY2VudCByZWZyZXNoLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBvbmdvaW5nIGxvYWQgdG8gY29tcGxldGVcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IHRoaXMucmVwby53cml0ZXIucGVyc2lzdGVkVmVyc2lvbi52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkUHJvbWlzZSA9IHRoaXMuX2xvYWQodmVyc2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkZWRWZXJzaW9uID0gTWF0aC5tYXgoX3RoaXMubG9hZGVkVmVyc2lvbiwgdmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBUaGUgZXJyb3IgaXMgdGhlIGZpbmFsIHJlc3VsdC4gU2V0IGl0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBXZSdyZSBmaW5pc2hlZC4gRGF0YSBvciBlcnJvciBpcyBhbHJlYWR5IHNldC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGdvdEluaXRpYWxSZXNwb25zZSB0byB0cnVlIGFuZCBub3RpZnkgc3Vic2NyaWJlcnMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm5vdGlmeVN1YnNjcmliZXJzKF90aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSBtb3JlIHJlY2VudCBjYWxsIHRvIGxvYWQoKSBpcyBvbmdvaW5nLCBPUiB3YXMgb25nb2luZyBidXQgcmVzcG9uZGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVmb3JlIHVzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIGFueSBjYXNlIHJldHVybiB0aGlzLl9sb2FkUHJvbWlzZS4gSWYgaXQncyBvbmdvaW5nIHdlJ2xsIHdhaXQgZm9yIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gZmluaXNoLiBJZiBpdCdzIG51bGwsIHdlJ2xsIGJlIHJldHVybmluZyBmaW5hbGx5IGhlcmUgd2l0aG91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFueSBhY3Rpb24sIGJlY2F1c2UgdGhlIGFjdGlvbiB3YXMgdGFrZW4gYnkgdGhlIHJlZnJlc2hlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2xvYWRQcm9taXNlOyAvLyBXYWl0IGZvciB0aGUgcmVmcmVzaGVkIGxvYWQgdG8gY29tcGxldGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRQcm9taXNlXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLl9sb2FkID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubXV0YXRpb25RdWV1ZS5hZmZlY3RzUXVlcnkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSwgdGhpcy5pbmNsdWRlcykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIuIE90aGVyd2lzZSwgd2UgbWF5IGdldCBpbmFjY3VyYXRlIGRhdGEgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVwby53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgYXJlIG91dGdvaW5nIG11dGF0aW9ucyB0aGF0IGFmZmVjdHMgdGhpcyBxdWVyeS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXJ2ZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB0aGlzLnN1YnNjcmlwdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBzdWJzY3JpcHRpb247IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuY29tbWl0TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgdmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2ksIG11dGF0aW9uc18xLCBtLCBkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBtdXRhdGlvbnNfMSA9IG11dGF0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBtdXRhdGlvbnNfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG11dGF0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgJiYgKG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaE9ySW52YWxpZGF0ZSh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdtZXJnZScgJiYgKCFtLnRhcmdldEJyYW5jaElkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRhcmdldEJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAndXBkYXRlJyAmJiAoKG0uZGVsdGFEb2MudGFncyAmJiB0aGlzLnF1ZXJ5LnRhZ3MpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobS5kZWx0YURvYy5uYW1lICYmIHRoaXMucXVlcnkubmFtZSkpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgdGFnIG1heSBoYXZlIGJlZW4gYWRkZWQsIG9yIHJlbmFtZWQsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbW1pdCB0aGUgbXV0YXRpb25zIGxvY2FsbHkgYXMgd2UgZG9uJ3QgaGF2ZSBhbGwgaW5mby5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgdGFnIG1heSBoYXZlIGJlZW4gYWRkZWQsIG9yIHJlbmFtZWQsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbW1pdCB0aGUgbXV0YXRpb25zIGxvY2FsbHkgYXMgd2UgZG9uJ3QgaGF2ZSBhbGwgaW5mby5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChtdXRhdGlvbnMsIGZhbHNlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucmVmcmVzaE9ySW52YWxpZGF0ZSA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVycyA9IGZ1bmN0aW9uIChvcHRpbWlzdGljTXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhXzEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChvcHRpbWlzdGljTXV0YXRpb25zLCB0cnVlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcy5ub3RpZnlTdWJzY3JpYmVyKGRhdGFfMSwgX3RoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwby5xdWVyeVNldC5xdWVyeUxvY2FsbHkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSwgdGhpcy5pbmNsdWRlcyk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeVNlcnZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLmdldENsaWVudCgpLmxpc3QodGhpcy50YWJsZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBkYXRhXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQgPSBmdW5jdGlvbiAobXV0YXRpb25zLCBvcHRpbWlzdGljLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgZGF0YSA9IF90aGlzLmFwcGx5TXV0YXRpb25zT25EYXRhKGRhdGEsIG11dGF0aW9uLCBvcHRpbWlzdGljKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zT25EYXRhID0gZnVuY3Rpb24gKGRhdGEsIG0sIG9wdGltaXN0aWMpIHtcclxuICAgICAgICBpZiAoYnJhbmNoU2Vuc2l0aXZlKG0pICYmIG0uYnJhbmNoSWQgIT0gdGhpcy5xdWVyeS5icmFuY2hJZClcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgdmFyIF9hID0gdGhpcywgdGFibGUgPSBfYS50YWJsZSwgaW5jbHVkZXMgPSBfYS5pbmNsdWRlcywgbGlzdE9wdGlvbnMgPSBfYS5xdWVyeTtcclxuICAgICAgICB2YXIgc291cmNlSWRzID0gbGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tID8gW10uY29uY2F0KGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSB8fCBbXSkgOiBbXTtcclxuICAgICAgICB2YXIgcmVxdWVzdGVkVGFncyA9IGxpc3RPcHRpb25zLnRhZ3MgPyBbXS5jb25jYXQobGlzdE9wdGlvbnMudGFncyB8fCBbXSkgOiBbXTtcclxuICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcclxuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzoge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkID09PSBtLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGRlbHRhIG9uIHVwZGF0ZWQgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWREb2MgPSBhcHBseURlbHRhKGRvYywgbS5kZWx0YURvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZERvYy4kbWV0YSA9ICd1cGRhdGluZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRG9jO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBpZCBkb2VzIG5vdCBhcHBseSB0byB0aGlzIGRvYywgc2VhcmNoIGluIGdyYXBocyB0aGUgaWQgaXMgZm91bmRcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbW9uZyBncmFwaCBpbmNsdWRlZCBkb2NzLCBhbmQgaWYgc28sIHVwZGF0ZSB0aGF0IG9uZTpcclxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZERvY3MgPSBkb2NbbGFiZWxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZWREb2NzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZEFycmF5ID0gdXBkYXRlQXJyYXkoaW5jbHVkZWREb2NzLCBmdW5jdGlvbiAocmVsYXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsYXRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZFJlbGF0ZWQgPSBhcHBseURlbHRhKHJlbGF0ZWQsIG0uZGVsdGFEb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUmVsYXRlZC4kbWV0YSA9ICd1cGRhdGluZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRSZWxhdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZEFycmF5ICE9PSBpbmNsdWRlZERvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVtsYWJlbF0gPSB1cGRhdGVkQXJyYXksIF9hKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXMgYGRiLmNvdXJzZUJsb2Nrcy4uLi53aGF0ZXZlci4uIC5pbmNsdWRlKFwiYWJpbGl0aWVzXCIpYCwgZGV0ZWN0OiBkYi5jb3Vyc2VCbG9ja3MuYWRkUmVsYXRlZChibG9ja0lkLCAnYWJpbGl0aWVzJywgLi4uKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIC4uLmJlY2F1c2UgdGFibGUgPSAnY291cnNlQmxvY2tzJyBhbmQgaW5jbHVkZXMgaGFzIFwiYWJpbGl0aWVzXCIuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLnJlbGF0ZWREb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW1pc3RpYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2MuJG1ldGEgPSAnYWRkaW5nJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IGRvY1ttLmdyYXBoUHJvcF0uY29uY2F0KFtyZWxhdGVkRG9jXSksIF9hKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUlkcy5pbmNsdWRlcyhtLmlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGBkYi5jb3Vyc2VCbG9ja3MuaGFzRWRnZXNGcm9tKFtjb3Vyc2VJZF0pYCAgKG1lYW5pbmcgdGFibGU9J2NvdXJzZUJsb2NrcycgYW5kIHNvdXJjZUlkcyBpbmNsdWRlcyBjb3Vyc2VJZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLCBkZXRlY3Q6IGRiLmNvdXJzZUluc3RhbmNlcy5hZGRSZWxhdGVkKGNvdXJzZUlkLCAnY291cnNlQmxvY2tzJywgLi4uLikgLy8gbS5ncmFwaFByb3AgPT09ICdibG9ja3MnLS0+IGdldFRhYmxlRnJvbUxhYmVsIC0tPiAnY291cnNlQmxvY2tzJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IGdldFRhYmxlRnJvbUxhYmVsKG0udGFibGUsIG0uZ3JhcGhQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0T3B0aW9ucy50YWdzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvbmNhdCh0aGlzLnNldEdyYXBoUHJvcHMobS5yZWxhdGVkRG9jKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5yZWxhdGVkRG9jLnRhZ3MgJiYgcmVxdWVzdGVkVGFncy5zb21lKGZ1bmN0aW9uICh0YWcpIHsgcmV0dXJuIG0ucmVsYXRlZERvYy50YWdzLmluY2x1ZGVzKHRhZyk7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5pZHMgJiYgbGlzdE9wdGlvbnMuaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiBpZCA9PT0gbS5yZWxhdGVkRG9jLmlkOyB9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEEgY2VydGFpbiBJRCBpcyBvYnNlcnZlZC4gQSBkb2Mgd2l0aCB0aGlzIGlkIGlzIGJlaW5nIGFkZGVkLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgZG9jIHRvIHRoZSByZXN1bHQuIEV4YWN0bHkgdGhpcyBXSUxMIGhhcHBlbiBpbiB0aGUgZm9sbG93aW5nIHR5cGljYWwgc2NlbmFyaW86XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gVXNlciBhZGRzIGEgcmVsYXRlZCBkb2N1bWVudCB0byBhIGxpc3QuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMi4gRG9jdW1lbnQgcmVtYWlucyB3aXRoaW4gdGhlIE11dGF0aW9uUXVldWUgd2hpbGUgYmF0Y2gtcmVxdWVzdCBpcyBiZWluZyBwcm9jZXNzZWQgYnkgc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIDMuIFVzZXIgY2xpY2tzIHRoZSBhZGRlZCBpdGVtIHRvIGVkaXQgb3IgdmlldyBpdCAob3Igb3VyIGNvbXBvbmVudCByZWRpcmVjdHMgdG8gaXRzIGVkaXRvcilcclxuICAgICAgICAgICAgICAgICAgICAvLyA0LiBBIG5ldyBxdWVyeSBvZiB0aGF0IHBhcnRpY3VsYXIgSUQgaXMgc3Vic2NyaWJlZCB0byB7aWRzPVt0aGVJZF19XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgS2VkQmFja2VuZFF1ZXJ5LnN1YnNjcmliZSB0aGVuIGRvZXMgdGhpczpcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDEuIENhbGwgcXVlcnlMb2NhbGx5KCkgYmVmb3JlIHF1ZXJ5aW5nIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMi4gcXVlcnlMb2NhbGx5KCkgaW5zcGVjdHMgbXV0YXRpb25zIGFuZCBmaW5kcyBhIG1hdGNoLCByZXR1cm5pbmcgYW4gZW1wdHkgbGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgKGFzc3VtZXMgYXMgd2UgYXJlIGFkZGluZyBpdCwgaXQgY2FuJ3QgZXhpc3Qgb24gdGhlIHNlcnZlciBhbnl3YXkpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAzLiBLZWRCYWNrZW5kUVVlcnkgYXBwbGllcyBtdXRhdGlvbnMgb250byB0aGUgZW1wdHkgbGlzdCwgYW5kIGVuZHMgdXAgaGVyZSB0byBhZGRcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGl0IG9wdGltaXN0aWNhbGx5LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNC4gV2hlbiBzZXJ2ZXIgcmVzcG9uZHMgd2l0aCAyMDAgT0ssIGNhbGxzIHVzIGhlcmUgYWdhaW4gd2l0aCBvcHRpbWlzdGljPWZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB0byBcInBlcnNpc3RcIiBpdCBpbiB0aGUgcXVlcnkncyBkYXRhIGFycmF5LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNEI6IElmIG5vdCAyMDAgT0ssIG11dGF0aW9uIG1heSBiZSBnb25lIGFuZCB0aGUgc3Vic2NyaWJlciB3aWxsIHNlIGFuIGVycm9yIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwiQ291bGQgbm90IGZpbmQgZW50aXR5IHdpdGggaWQgWC5cIiBhbG9uZyB3aXRoIGEgcmVkIGVycm9yIG1lc3NhZ2Ugb24gdGhlIHNjcmVlblxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgYWJvdXQgdGhhdCBpdCBmYWlsZWQgdG8gc2F2ZSBvbiBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW20uZ3JhcGhQcm9wXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbmNsdWRlZERvY3MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IG9wdGltaXN0aWMgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayByZWxhdGVkLWRvYy10by1yZW1vdmUgd2l0aCAkbWV0YTogJ2RlbGV0aW5nJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkIDogdHNsaWJfMS5fX2Fzc2lnbih7fSwgZCwgeyAkbWV0YTogJ2RlbGV0aW5nJyB9KTsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZERvY3MuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLnJlbGF0ZWREb2MuaWQ7IH0pLCBfYSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VJZHMuaW5jbHVkZXMobS5pZCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpbWlzdGljID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkID09PSBtLnJlbGF0ZWREb2MuaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZERvYy5pZDsgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5pZDsgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkVGFibGVzID0gaW5jbHVkZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuICh7IGxhYmVsOiBsYWJlbCwgdGFibGU6IGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgfSk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gX2EudGFibGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWJsZSA9PT0gbS50YWJsZTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGFiZWxzXzEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBfYS5sYWJlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRlZERvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2IgPSB7fSwgX2JbbGFiZWxdID0gb3B0aW1pc3RpYyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZERvY3MuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IF9hLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBfYikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5zZXRHcmFwaFByb3BzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciBjb3B5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jKTtcclxuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyB0YWJsZXMgfSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH0gZnJvbSAnLi9rZWRiYWNrZW5kLWNvbGxlY3Rpb24nO1xyXG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcclxuaW1wb3J0IHsgTXV0YXRpb25RdWV1ZSB9IGZyb20gJy4vbXV0YXRpb24tcXVldWUnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH0gZnJvbSAnLi9rZWRiYWNrZW5kLXdyaXRlcic7XHJcbmltcG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jb2xsZWN0aW9uJztcclxudmFyIEtlZEJhY2tlbmRSZXBvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFJlcG8oZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUsIGRlZmF1bHRRdWVyeU9wdGlvbnMsIG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCB3cml0ZXIsIGNhY2hlT3B0aW1pemVkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcclxuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyA9IGRlZmF1bHRRdWVyeU9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XHJcbiAgICAgICAgdGhpcy53cml0ZXIgPSB3cml0ZXI7XHJcbiAgICAgICAgdGhpcy5jYWNoZU9wdGltaXplZCA9IGNhY2hlT3B0aW1pemVkO1xyXG4gICAgICAgIGlmICghZGVmYXVsdFF1ZXJ5T3B0aW9ucylcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zID0ge307XHJcbiAgICAgICAgaWYgKCFtdXRhdGlvblF1ZXVlKVxyXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBuZXcgTXV0YXRpb25RdWV1ZSgpO1xyXG4gICAgICAgIGlmICghcXVlcnlTZXQpXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZXQgPSBuZXcgUXVlcnlTZXQodGhpcy5tdXRhdGlvblF1ZXVlKTtcclxuICAgICAgICBpZiAoIXdyaXRlcilcclxuICAgICAgICAgICAgdGhpcy53cml0ZXIgPSBuZXcgS2VkQmFja2VuZFdyaXRlcih0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKTtcclxuICAgICAgICBPYmplY3Qua2V5cyh0YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZU9wdGltaXplZCkge1xyXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb24uY2FjaGVPcHRpbWl6ZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpc1t0YWJsZV0gPSBjb2xsZWN0aW9uO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZGVsdGFzID0gbmV3IERlbHRhQ29sbGVjdGlvbih0aGlzLndyaXRlci5kZWx0YUNhY2hlLCB7XHJcbiAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQgLy8gSWYgYnJhbmNoSWQgaXMgdW5kZWZpbmVkLiBEZWx0YUNvbGxlY3Rpb24gd2lsbCByZXNwb25kIHdpdGggRXJyb3Igb24gc3Vic2NyaWJlKClcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS50YWJsZSA9IGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcclxuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IG5ldyBLZWRCYWNrZW5kQ29sbGVjdGlvbih0aGlzLCB0YWJsZU5hbWUsIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVPcHRpbWl6ZWQpXHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uLmNhY2hlT3B0aW1pemVkKCk7XHJcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uIChxdWVyeU9wdGlvbnMsIGNhY2hlT3B0aW1pemVkKSB7XHJcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IEtlZEJhY2tlbmRSZXBvKHRoaXMuZ2V0Q2xpZW50LCB0aGlzLmdldFVzZXIsIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMsIHF1ZXJ5T3B0aW9ucyksIHRoaXMubXV0YXRpb25RdWV1ZSwgdGhpcy5xdWVyeVNldCwgdGhpcy53cml0ZXIsIGNhY2hlT3B0aW1pemVkID09PSB1bmRlZmluZWQgPyB0aGlzLmNhY2hlT3B0aW1pemVkIDogY2FjaGVPcHRpbWl6ZWQpO1xyXG4gICAgICAgIHJldHVybiBjbG9uZTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuYnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5yb2xlID0gZnVuY3Rpb24gKHJvbGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyByb2xlOiByb2xlIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5vcHRpbWl6ZUNhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7fSwgdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgY2xlYXIgbWFzdGVyIGJyYW5jaFwiKTtcclxuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAodGFyZ2V0QnJhbmNoSWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IG1lcmdlIGZyb20gbWFzdGVyIGJyYW5jaFwiKTtcclxuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdtZXJnZScsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9XSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnNhdmVOb3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodGhpcy53cml0ZXIuY3VycmVudFZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFJlcG87XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRSZXBvIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtcmVwby5qcy5tYXAiLCJ2YXIgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24oc3Vic2NyaWJlciwgY29sbGVjdGlvbikge1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlciA9IHN1YnNjcmliZXI7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24ucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXIgPSBmdW5jdGlvbiAoZGF0YSwgZXJyb3IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoW10sIGVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YSAhPT0gdGhpcy5sYXN0Tm90aWZpZWREYXRhKSB7IC8vIFdpbGwgaW4tZmFjdCBiZSBlcXVhbCBieSByZWZlcmVuY2UgaWYgZGF0YSBpcyBzYW1lIGFzIGxhc3Qgbm90aWZpY2F0aW9uIChhcyB3ZSB1c2UgYW4gaW1tdXRhYmxlIGFwcHJvYWNoIG9uIGRhdGEpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZERhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyKGRhdGEsIGVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXgsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChleDIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBub3RpZnlpbmcgS2VkQmFja2VuZFN1YnNjcmliZXI6XCIsIGV4MiwgJ29yaWdpbmFsbHkgbm90aWZpZWQgZXJyb3I6JywgZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi51bnN1YnNjcmliZSh0aGlzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFN1YnNjcmlwdGlvbjtcclxufSgpKTtcclxuZXhwb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBNdXRhdGlvblF1ZXVlIH0gZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XHJcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xyXG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xyXG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZSc7XHJcbmltcG9ydCB7IERlbHRhQ2FjaGUgfSBmcm9tICcuL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY2FjaGUnO1xyXG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRXcml0ZXIobXV0YXRpb25RdWV1ZSwgcXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XHJcbiAgICAgICAgdGhpcy5nZXRDbGllbnQgPSBnZXRDbGllbnQ7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcclxuICAgICAgICB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSA9IGdldFVzZXJEaXNwbGF5TmFtZTtcclxuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2lzU2F2aW5nUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uID0gbmV3IEVtaXR0ZXIoMCk7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5kZWx0YUNhY2hlID0gbmV3IERlbHRhQ2FjaGUoZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzU2F2aW5nXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEhdGhpcy5faXNTYXZpbmdQcm9taXNlOyB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc0VkaXRlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMDsgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLnB1c2goY2FsbGJhY2spO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9uU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gdGhpcy5lcnJvclN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gY2FsbGJhY2s7IH0pO1xyXG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycyA9IHRoaXMuc3RhdGVTdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IGNhbGxiYWNrOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yLCByZXRyeWFibGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZXJyb3JTdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJldHJ5YWJsZSwgX3RoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChfKSB7IH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaFN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhfdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm11dGF0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIGRlYm91bmNlKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmFkZChtdXRhdGlvbnMpO1xyXG4gICAgICAgICsrdGhpcy5jdXJyZW50VmVyc2lvbjtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICAgICAgdGhpcy5kZWx0YUNhY2hlLmFwcGx5TXV0YXRpb25zKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSwgeyBvcHRpbWlzdGljOiB0cnVlIH0pO1xyXG4gICAgICAgIGlmICghdGhpcy5faXNTYXZpbmdQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcclxuICAgICAgICAgICAgdGhpcy5fdGltZW91dElkID0gc2V0VGltZW91dCh0aGlzLnNhdmUuYmluZCh0aGlzKSwgZGVib3VuY2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBpc1NhdmluZywgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZywgYmVjYXNlIGl0IHdpbGwgcmUtY2hlY2sgaWYgYWRkaXRpb25hbFxyXG4gICAgICAgIC8vIG11dGF0aW9ucyBoYXZlIGNvbWUsIHdoZW4gc2F2aW5nIGlzIGRvbmUuXHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUucmV0cnlTYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmUoKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZWRWZXJzaW9uO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5sb2FkKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVkVmVyc2lvbiA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGVyc2lzdGVkVmVyc2lvbiA8IHZlcnNpb24pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7IC8vIEJlIG1vcmUgZWFnZXIgdG8gc2F2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZmlsdGVyKGZ1bmN0aW9uIChwZXJzaXN0ZWRWZXJzaW9uKSB7IHJldHVybiBwZXJzaXN0ZWRWZXJzaW9uID49IHZlcnNpb247IH0pLmxvYWQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SWQpO1xyXG4gICAgICAgIGlmICh0aGlzLl9pc1NhdmluZ1Byb21pc2UpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRWRpdGVkKVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9pc1NhdmluZ1Byb21pc2UgPSB0aGlzLl9zYXZlKCk7XHJcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDsgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2F2aW5nUHJvbWlzZTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5fc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9ucywgdmVyc2lvbiwgbXV0YXRpb25SZXF1ZXN0cywgcmVzXzEsIGV0YWdNdXRhdGlvbnMsIGVycm9yXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHRoaXMuY3VycmVudFZlcnNpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5tb3ZlVG9TYXZpbmdRdWV1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvblJlcXVlc3RzID0gdGhpcy5tYXBNdXRhdGlvbnMobXV0YXRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCAxMSwgMTJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5nZXRDbGllbnQoKS5iYXRjaChtdXRhdGlvblJlcXVlc3RzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXRhZ011dGF0aW9ucyA9IE9iamVjdC5rZXlzKHJlc18xLm5ld0V0YWdzKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YURvYzogeyAkZXRhZzogcmVzXzEubmV3RXRhZ3NbaWRdIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBudWxsIC8vIFdlIGRvbid0IGhhdmUgdGhlIHRhcmdldCBuYW1lLiBCdXQgdGhpcyBtdXRhdGlvbiB3b24ndCBiZSB2aXNpYmxlIGluIGEgRGVsdGFDb2xsZWN0aW9uIGFueXdheSwgc28gaXQgd29udCBiZSB1c2VkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZShtdXRhdGlvblJlcXVlc3RzLCB0aGlzLmdldFVzZXIoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1taXQgbXV0YXRpb25zIGFsb25nIHdpdGggZXRhZ011dGF0aW9ucyBpbnRvIHF1ZXJpZXMgY2FjaGVkIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoKHZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbHRhQ2FjaGUuYXBwbHlNdXRhdGlvbnMobXV0YXRpb25zLCB7IG9wdGltaXN0aWM6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2V0LmNvbW1pdE11dGF0aW9ucyhNdXRhdGlvblF1ZXVlLm1lcmdlKG11dGF0aW9ucywgZXRhZ011dGF0aW9ucyksIHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT24gc3VjY2VzcywgY2xlYXIgc2F2aW5nIHF1ZXVlIGFzIHRoZSBtdXRhdGlvbnMgd2lsbCBub3cgYmUgY29tbWl0dGVkIHRvIGFsbCBxdWVyeSdzIGRhdGEgaW5zdGVhZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7IC8vIGlzRWRpdGVkIG1heSBoYXZlIHR1cm5lZCB0byBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBub3RpZnkgc3Vic2NyaWJlcnMgc28gdGhhdCB2aWV3cyBnZXQgdXBkYXRlZCB3aXRoIGNvbW1pdHRlZCByZXN1bHRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLmxlbmd0aCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc2F2ZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFzIHdlbGwuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGVycm9yXzEgJiYgZXJyb3JfMS5uYW1lICYmIGVycm9yXzEubmFtZS5zdGFydHNXaXRoKFwiaHR0cDRcIikpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWNjZXNzIENvbnRyb2wgZGVuaWVkLCBiYWQgcmVxdWVzdCBvciBzaW1pbGFyLiBUaHJvdyBtdXRhdGlvbnMgYXdheS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7IC8vIGlzRWRpdGVkIG1heSBoYXZlIHR1cm5lZCB0byBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvIGhvISBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhbG9uZS4gVEhleSBtaWdodCBiZSBtb3JlIGx1Y2t5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zYXZlKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG8gaG8hIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFsb25lLiBUSGV5IG1pZ2h0IGJlIG1vcmUgbHVja3kuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEyXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm1hcE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudXBkYXRlKG0udGFibGUsIG0uaWQsIG0uZGVsdGFEb2MsIG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbS5yZWxhdGVkRG9jLiRldGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vICRldGFnIG1lYW5zIHRoaXMgaXMgYSBuZXcgZG9jdW1lbnQuIEFkZCBpdCBiZWZvcmUgbGlua2luZyB0byBpdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnIuYWRkKHRhYmxlc1ttLnRhYmxlXS5yZWxhdGlvbnNoaXBzW20uZ3JhcGhQcm9wXSwgbS5yZWxhdGVkRG9jLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnIubGluazIobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZERvYy5pZCwgbS5icmFuY2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudW5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkRG9jLmlkLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudW5kb0xpbmsobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZElkLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIuZGVsZXRlKG0udGFibGUsIG0uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcclxuICAgICAgICAgICAgICAgICAgICBici5jbGVhckJyYW5jaChtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21lcmdlJzpcclxuICAgICAgICAgICAgICAgICAgICBici5tZXJnZShtLmJyYW5jaElkLCBtLnRhcmdldEJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kV3JpdGVyO1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtd3JpdGVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XHJcbmltcG9ydCB7IG1lcmdlRGVsdGFzIH0gZnJvbSAnLi9kZWx0YS1tZXJnZSc7XHJcbnZhciBNdXRhdGlvblF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gW107XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xyXG4gICAgfVxyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBNdXRhdGlvblF1ZXVlLm1lcmdlKHRoaXMucXVldWUsIG11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubW92ZVRvU2F2aW5nUXVldWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5zYXZpbmdRdWV1ZSwgdGhpcy5xdWV1ZSk7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmNsZWFyU2F2aW5nUXVldWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWZmZWN0c1F1ZXJ5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcclxuICAgICAgICBpZiAobXV0YXRpb25zLnNvbWUoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0ub3AgPT09ICdtZXJnZScgfHwgbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCc7IH0pKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XHJcbiAgICAgICAgICAgIC8vIEEgcXVlcnkgd2l0aCBcImlkc1wiIGZpbHRlciB3aWxsIGJlIGVhc3kgdG8gZGV0ZWN0IGEgbm8tbWF0Y2ggb246XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gZ2xvYmFsT3AobSkgfHwgKCFicmFuY2hTZW5zaXRpdmUobSkgfHwgbS5icmFuY2hJZCA9PT0gcXVlcnkuYnJhbmNoSWQpICYmXHJcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBPdGhlcndpc2UsIGNoZWNrIGlmIG11dGF0aW9ucyBhZmZlY3Qgc2FtZSBicmFuY2ggYW5kIHRhYmxlLiBDb3VsZCBiZSBkb25lIG1vcmUgZmluZSBncmFpbmVkLFxyXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtLm9wID09PSAnZGVsZXRlJyA/XHJcbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XHJcbiAgICAgICAgICAgICAgICBnbG9iYWxPcChtKSA/IHRydWUgOlxyXG4gICAgICAgICAgICAgICAgICAgIG0uYnJhbmNoSWQgPT0gcXVlcnkuYnJhbmNoSWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XHJcbiAgICAgICAgdmFyIG11dGFibGVRdWV1ZTEgPSBxdWV1ZTEuc2xpY2UoKTtcclxuICAgICAgICB2YXIgbXV0YWJsZVF1ZXVlMiA9IHF1ZXVlMi5zbGljZSgpO1xyXG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XHJcbiAgICAgICAgdmFyIGxlbiA9IHF1ZXVlMS5sZW5ndGg7XHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcclxuICAgICAgICAgICAgaWYgKG0ub3AgPT09ICd1cGRhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3ZlcmxhcHBpbmdJZE9wSWR4ID0gbXV0YWJsZVF1ZXVlMi5maW5kSW5kZXgoZnVuY3Rpb24gKG5ld011dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5icmFuY2hJZCA9PT0gbS5icmFuY2hJZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuaWQgPT09IG0uaWQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChvdmVybGFwcGluZ0lkT3BJZHggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTFbaV0gPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLCB7IGRlbHRhRG9jOiBtZXJnZURlbHRhcyhtLmRlbHRhRG9jLCBtdXRhYmxlUXVldWUyW292ZXJsYXBwaW5nSWRPcElkeF0uZGVsdGFEb2MpIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcclxuICAgICAgICAgICAgX2xvb3BfMShpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG11dGFibGVRdWV1ZTEuY29uY2F0KG11dGFibGVRdWV1ZTIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xyXG59KCkpO1xyXG5leHBvcnQgeyBNdXRhdGlvblF1ZXVlIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9IGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XHJcbmltcG9ydCAqIGFzIEpzb25TY2hlbWEgZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xyXG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XHJcbnZhciBRdWVyeVNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5U2V0KG11dGF0aW9uUXVldWUpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgICAgIHRoaXMucXVlcmllcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbCh0aGlzLnF1ZXJpZXMubWFwKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLmNvbW1pdE11dGF0aW9ucyhtdXRhdGlvbnMsIHZlcnNpb24pOyB9KSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXBJbnZhbGlkUXVlcmllcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5jbGVhbnVwSW52YWxpZFF1ZXJpZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gdGhpcy5xdWVyaWVzLmZpbHRlcihmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocS50aW1lb3V0SGFuZGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHEudGltZW91dEhhbmRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG9wdGltaXN0aWNNdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcclxuICAgICAgICAgICAgcS5ub3RpZnlTdWJzY3JpYmVycyhvcHRpbWlzdGljTXV0YXRpb25zKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuZmluZFF1ZXJ5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJpZXMuZmluZChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5xdWVyeUtleSA9PT0gS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5KHRhYmxlLCBxdWVyeSk7IH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xyXG4gICAgICAgIC8vIEZvciBub3csIG9ubHkgaGFuZGxlIHRoaXMgdmVyeSBjb21tb24gYW5kIHNwZWNpYWwgY2FzZSAod2hpY2hcclxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHF1ZXJ5IHdhbnRzIHRvIGdldCBhIHNpbmdsZSBlbnRpdHkgYnkgaXRzIElEOlxyXG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAvLyBBbmQgaWYgc28sIGlmIHdlIGhhdmUgYW4gb3V0Z29pbmcgbXV0YXRpb24gdG8gY3JlYXRlIHRoYXQgZW50aXR5OlxyXG4gICAgICAgICAgICBpZiAobXV0YXRpb25zLnNvbWUoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0ub3AgPT09ICdhZGQtcmVsYXRlZCcgJiYgbS5yZWxhdGVkRG9jLmlkID09PSBxdWVyeS5pZHNbMF07IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCBsZXQgdGhlIG9wdGlzdGljIGZlYXR1cmUgb2YgS2VkQmFja2VuZFF1ZXJ5IGFwcGx5IHRoZSBtdXRhdGlvbiBiZWZvcmVcclxuICAgICAgICAgICAgICAgIC8vIG5vdGlmeWluZyBzdWJzY3JpYmVycyAod2UgZG9uJ3Qgd2FudCBpdCB0byBiZSBwZXJzaXN0ZW50IGJlZm9yZSB0aGUgc2VydmVyXHJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE9LLCBhbm90aGVyIHF1aXRlIGNvbW1vbiBjYXNlIGlzIHdoZW4gd2UgYXNrIGZvciBhIGNlcnRhaW4gSUQgYW5kIHRoYXQgSUQgcmVwbGllc1xyXG4gICAgICAgIC8vIHdpdGhpbiBhbm90aGVyIHF1ZXJ5XHJcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gTm90IHBvc3NpYmxlIHRvIGhhbmRsZVxyXG4gICAgICAgIGlmICghcXVlcnkuaWRzKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICBpZiAoIXEuZ290SW5pdGlhbFJlc3BvbnNlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgaWYgKHEucXVlcnkuYnJhbmNoSWQgIT09IHF1ZXJ5LmJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiOyAvLyBJdCB3b3VsZCBiZSBjb21wbGV4IHRvIHN1cHBvcnQgdmFyaW91cyBmbGFncy4gUXVlcnkncyBkYXRhIG1heSBpbmNsdWRlIGlkcyBvbmx5LiBDYW4ndCByZWx5IG9uIHRoZSBxdWVyeS5cclxuICAgICAgICAgICAgdmFyIHFJbmNsdWRlcyA9IHEuaW5jbHVkZXM7XHJcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCBpbmNsdWRlLCBidXQgdGhpcyBxdWVyeSBkb2VzLiBDaGVjayBpZiB3ZSBjYW4gZmluZCBvdXIgcmVzdWx0IHdpdGhpbiBpdC5cclxuICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IHFJbmNsdWRlcy5maW5kKGZ1bmN0aW9uIChsKSB7IHJldHVybiBKc29uU2NoZW1hLnRhYmxlc1txLnRhYmxlXVtcInJlbGF0aW9uc2hpcHNcIl1bbF0gPT09IHRhYmxlOyB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNfMSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBxLmRhdGE7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJEYXRhID0gcXVlcnlBcnJheShxdWVyeSwgZW50aXR5W2xhYmVsXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEuZm9yRWFjaChmdW5jdGlvbiAocikgeyByZXR1cm4gcmVzXzFbci5pZF0gPSByOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8xID0gT2JqZWN0LmtleXMocmVzXzEpLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIHJlc18xW2lkXTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT25seSByZXR1cm4gcmVzdWx0IGlmIHdlIGNvdWxkIGxvb2sgdXAgZXZlcnkgcmVxdWVzdGVkIElEOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogcmVzdWx0XzEgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWluY2x1ZGVzLmV2ZXJ5KGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gcUluY2x1ZGVzLmluY2x1ZGVzKGxhYmVsKTsgfSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAvLyBMYXN0bHksIGlmIHRoZSBxdWVyeSBpbmNsdWRlcyBhbGwgZ3JhcGhzIHRoYXQgd2UgZG8sIHBpY2sgdGhlIHN1YnNldCBmcm9tIHRoYXQgcXVlcnkuXHJcbiAgICAgICAgICAgIC8vIENvbmNyZXRlIGV4YW1wbGU6IFdlIG9ic2VydmUgYSBjZXJ0YWluIFRhc2sgYnkgSUQgYW5kIHdhbnQgaXRzIGtub3dsZWRnZVJlcXVpcmVtZW50cyBhbG9uZyB3aXRoIGl0LFxyXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxyXG4gICAgICAgICAgICBpZiAocS50YWJsZSA9PT0gdGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMiA9IHF1ZXJ5QXJyYXkocXVlcnksIHEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5Lmlkcy5ldmVyeShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIHJlc3VsdF8yLnNvbWUoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaWQgPT09IGlkOyB9KTsgfSkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgcSA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKHEpO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB2YXIgX2EgPSBzdWJzY3JpcHRpb24uY29sbGVjdGlvbiwgdGFibGUgPSBfYS50YWJsZSwgcXVlcnkgPSBfYS5xdWVyeSwgcmVwbyA9IF9hLnJlcG87XHJcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xyXG4gICAgICAgIGlmICgha2JRdWVyeSkge1xyXG4gICAgICAgICAgICBrYlF1ZXJ5ID0gbmV3IEtlZEJhY2tlbmRRdWVyeSh0YWJsZSwgcXVlcnksIHJlcG8uZ2V0VXNlcigpLCByZXBvLCB0aGlzLm11dGF0aW9uUXVldWUpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpO1xyXG4gICAgICAgICAgICAgICAga2JRdWVyeS50aW1lb3V0SGFuZGxlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBrYlF1ZXJ5LnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcclxuICAgICAgICB2YXIga2JRdWVyeSA9IHRoaXMuZmluZFF1ZXJ5KHRhYmxlLCBxdWVyeSk7XHJcbiAgICAgICAgaWYgKGtiUXVlcnkpIHtcclxuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxyXG4gICAgICAgICAgICBrYlF1ZXJ5LnVuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIC8vIFJlbGVhc2UgdW5uZXNjZXNzYXJ5IG1lbW9yeSB3aGVuIHRoZXJlIGFyZSBubyBtb3JlIHN1YnNjcmlwdGlvbnMgb2YgdGhpcyBxdWVyeSwgYnkgcmVtb3ZpbmcgdGhlIHF1ZXJ5IGl0c2VsZlxyXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxyXG4gICAgICAgICAgICBpZiAoa2JRdWVyeS5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU2NoZWR1bGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiBpbiA1IG1pbnV0ZXM6XHJcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBrYlF1ZXJ5IHN0aWxsIGhhcyBubyBzdWJzY3JpcHRpb25zIChub3QgY2VydGFpbiEgQSBuZXcgc3Vic2NyaWJlciBtYXkgaGF2ZSBjb21lIGFsb25nLi4uKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnN1YnNjcmlwdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWVyaWVzID0gX3RoaXMucXVlcmllcy5maWx0ZXIoZnVuY3Rpb24gKHEpIHsgcmV0dXJuIHEgIT09IGtiUXVlcnk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XHJcbiAgICAgICAgICAgICAgICAgICAgNTAwIDogLy8gRG9uJ3QgaG9zdCB0b28gbWFueSBxdWVyaWVzLiBHYXJiYWdlIGNvbGxlY3QgdGhpcyB3aXRoaW4gNTAwIG1zXHJcbiAgICAgICAgICAgICAgICAgICAgNSAqIDYwMDAwKTsgLy8gQWxsb3cgcXVlcnkgaW4gbWVtb3J5IGZvciBhbm90aGVyIDUgbWludXRlc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeVNldDtcclxufSgpKTtcclxuZXhwb3J0IHsgUXVlcnlTZXQgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkge1xyXG4gICAgcmV0dXJuIHRhYmxlc1t0YWJsZV0ucmVsYXRpb25zaGlwc1tsYWJlbF07XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIHF1ZXJ5QXJyYXkocXVlcnksIGRhdGEpIHtcclxuICAgIHZhciBmaWx0ZXIgPSBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpO1xyXG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIEFORChmaWx0ZXIxLCBmaWx0ZXIyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsdGVyRnJvbVF1ZXJ5KHF1ZXJ5KSB7XHJcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XHJcbiAgICBpZiAocXVlcnkuZnJvbSlcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZGF0ZVRpbWUgPj0gcXVlcnkuZnJvbTsgfSk7XHJcbiAgICBpZiAocXVlcnkudG8pXHJcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmRhdGVUaW1lIDwgcXVlcnkudG87IH0pO1xyXG4gICAgaWYgKHF1ZXJ5LmlkcylcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XHJcbiAgICBpZiAocXVlcnkubmFtZSlcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgubmFtZSA9PT0gcXVlcnkubmFtZTsgfSk7XHJcbiAgICBpZiAocXVlcnkudGFncylcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudGFncyAmJiBbXS5jb25jYXQocXVlcnkudGFncyB8fCBbXSkuc29tZShmdW5jdGlvbiAodGFnKSB7IHJldHVybiB4LnRhZ3MuaW5jbHVkZXModGFnKTsgfSk7IH0pO1xyXG4gICAgLy8gcXVlcnkuaGFzRWRnZXNGcm9tIGFuZCBxdWVyeS5oYXNFZGdlc1RvIGNhbm5vdCBieSBmaWx0ZXJlZCBoZXJlXHJcbiAgICByZXR1cm4gZmlsdGVyO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBicmFuY2hTZW5zaXRpdmUobSkge1xyXG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnbG9iYWxPcChtKSB7XHJcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZSBmcm9tICcuL21pZ3JhdGUnO1xyXG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcclxuICAgIGlmIChjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbilcclxuICAgICAgICByZXR1cm47XHJcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XHJcbiAgICB2YXIgZ2V0ID0gY2xpZW50LmdldDtcclxuICAgIHZhciBsaXN0ID0gY2xpZW50Lmxpc3Q7XHJcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBpbmNsdWRlID0gb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGU7XHJcbiAgICAgICAgcmV0dXJuIGdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIGNsaWVudC5saXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIGluY2x1ZGUgPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZTtcclxuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7IHJldHVybiBtaWdyYXRlKGRvYywgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpOyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gY2xpZW50O1xyXG59O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZVRhc2sgZnJvbSAnLi9taWdyYXRlLXRhc2snO1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlQ291cnNlKGNvdXJzZSwgZ3JhcGhzKSB7XHJcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxyXG4gICAgICAgIGNvdXJzZS5tb2R1bGVzID0gW107XHJcbiAgICBjb3Vyc2UubW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGUpIHtcclxuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgbW9kdWxlLnJlc291cmNlcyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XHJcbiAgICAgICAgICAgIG1vZHVsZS50YXNrSWRzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBpZiAoIWNvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzKSB7XHJcbiAgICAgICAgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMgPSBbXTtcclxuICAgIH1cclxuICAgIC8vIEVhcmxpZXIgd3Jvbmcgc3BlbGxpbmcgb2YgcmVzb3VyY2VzXHJcbiAgICBpZiAoJ3Jlc291cnNlcycgaW4gY291cnNlICYmICEoJ3Jlc291cmNlcycgaW4gY291cnNlKSkge1xyXG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xyXG4gICAgICAgIGRlbGV0ZSBjb3Vyc2UucmVzb3Vyc2VzO1xyXG4gICAgfVxyXG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XHJcbiAgICAgICAgY291cnNlLnJlc291cmNlcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgaWYgKGdyYXBocykge1xyXG4gICAgICAgIGdyYXBocy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XHJcbiAgICAgICAgICAgICAgICAgICAgY291cnNlLnRhc2tzLmZvckVhY2goZnVuY3Rpb24gKHRhc2spIHsgcmV0dXJuIG1pZ3JhdGVUYXNrKHRhc2spOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtY291cnNlLmpzLm1hcCIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVUYXNrKHRhc2spIHtcclxuICAgIGlmICghdGFzay5yZXNvdXJjZXMpXHJcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLXRhc2suanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVDb3Vyc2UgZnJvbSAnLi9taWdyYXRlLWNvdXJzZSc7XHJcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGUoZG9jLCB0YWJsZSwgZ3JhcGhzKSB7XHJcbiAgICBzd2l0Y2ggKHRhYmxlKSB7XHJcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcclxuICAgICAgICAgICAgbWlncmF0ZUNvdXJzZShkb2MsIGdyYXBocyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxyXG4gICAgICAgICAgICBtaWdyYXRlVGFzayhkb2MpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XHJcbmltcG9ydCB7IGluaXRNYXBNZXRob2QgfSBmcm9tIFwiLi9tYXBcIjtcclxuaW1wb3J0IHsgVmFsdWUgfSBmcm9tIFwiLi92YWx1ZVwiO1xyXG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xyXG52YXIgQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENvbGxlY3Rpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBzdWJzY3JpYmUpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xyXG4gICAgICAgIHRocm93IFwibWl4ZWRpblwiO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgaWYgKHguc3Vic2NyaWJlKVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHguc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xyXG4gICAgICAgICAgICB2YXIgZW1pdHRlcl8xID0gbmV3IEVtaXR0ZXIoeCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gZW1pdHRlcl8xLnN1YnNjcmliZShzKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9ic2VydmFibGVDb2xsZWN0aW9uLmZyb20oKSBjYW4gb25seSB0YWtlIGFycmF5cyBvciBvYnNlcnZhYmxlc1wiKTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gbWFwcGVyKGl0ZW0pOyB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCBpdGVtcyk7IH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMuZmlsdGVyKGZpbHRlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBDb2xsZWN0aW9uLmZyb20odGhpcy50b1ZhbHVlKCkuY29tYmluZUxhdGVzdChvdGhlcikubWFwKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICB2YXIgbWUgPSBfYVswXSwgb3RoZXIgPSBfYVsxXTtcclxuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVmFsdWUoKS5tYXAoZnVuY3Rpb24gKGFycmF5KSB7IHJldHVybiBhcnJheS5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGFQcm9wID0gYSAmJiBhW3Byb3BdO1xyXG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XHJcbiAgICAgICAgICAgIHJldHVybiBhUHJvcCA+IGJQcm9wID8gMSA6IGFQcm9wIDwgYlByb3AgPyAtMSA6IDA7XHJcbiAgICAgICAgfSk7IH0pLnRvQ29sbGVjdGlvbihmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUudG9WYWx1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ3JvdXBCeSA9IGZ1bmN0aW9uIChwcm9wKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcclxuICAgICAgICAgICAgdmFyIHJ2ID0ge307XHJcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVmFsdWUoKS5tYXAoZnVuY3Rpb24gKGFycikgeyByZXR1cm4gYXJyWzBdOyB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcclxufShPYnNlcnZhYmxlKSk7XHJcbmV4cG9ydCB7IENvbGxlY3Rpb24gfTtcclxuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgVmFsdWUgfSBmcm9tIFwiLi92YWx1ZVwiO1xyXG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEVtaXR0ZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBFbWl0dGVyKGluaXRpYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZXJzID0gX3RoaXMuc3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHMgIT09IG9ic2VydmVyO1xyXG4gICAgICAgICAgICAgICAgfSk7IH0sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZXJzLnB1c2goW29ic2VydmVyLCBzdWJzY3JpcHRpb25dKTtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCB1bmRlZmluZWQsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zdWJzY3JpYmVycyA9IFtdO1xyXG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcclxuICAgIH07XHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xyXG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoKCk7XHJcbiAgICB9O1xyXG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihfdGhpcy52YWx1ZSwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEVtaXR0ZXI7XHJcbn0oVmFsdWUpKTtcclxuZXhwb3J0IHsgRW1pdHRlciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsInZhciBzdGFjayA9IFtdO1xyXG52YXIgY3VycmVudEZpYmVyID0gbnVsbDtcclxudmFyIHByb3ZpZGVycyA9IFtmdW5jdGlvbiAoKSB7IHJldHVybiBjdXJyZW50RmliZXI7IH1dO1xyXG5mdW5jdGlvbiBwdXNoRmliZXIoZmliZXIpIHtcclxuICAgIHN0YWNrLnB1c2goY3VycmVudEZpYmVyKTtcclxuICAgIGN1cnJlbnRGaWJlciA9IGZpYmVyO1xyXG59XHJcbmZ1bmN0aW9uIHBvcEZpYmVyKCkge1xyXG4gICAgY3VycmVudEZpYmVyID0gc3RhY2sucG9wKCk7XHJcbn1cclxuZXhwb3J0IHZhciBGaWJlckNvbnRleHQgPSB7XHJcbiAgICBnZXQgY3VycmVudCgpIHsgcmV0dXJuIGN1cnJlbnRGaWJlcjsgfSxcclxuICAgIC8qcnVuOiBmdW5jdGlvbiByZXJ1bjxSPihmaWJlcjogRmliZXIsIGZuOiAoKT0+Uik6IFIgfCBQcm9taXNlPFI+IHtcclxuICAgICAgcHVzaEZpYmVyKGZpYmVyKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZuKCkpO1xyXG4gICAgICB9IGNhdGNoIChwKSB7XHJcbiAgICAgICAgaWYgKHAgJiYgdHlwZW9mIHAudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgcmV0dXJuIHAudGhlbigoKT0+cmVydW4oZmliZXIsIGZuKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgcG9wRmliZXIoKTtcclxuICAgICAgfVxyXG4gICAgfSwqL1xyXG4gICAgYWRkUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcclxuICAgICAgICBwcm92aWRlcnMucHVzaChnZXRDdXJyZW50RmliZXIpO1xyXG4gICAgICAgIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCk7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcclxuICAgICAgICBwcm92aWRlcnMgPSBwcm92aWRlcnMuZmlsdGVyKGZ1bmN0aW9uIChwKSB7IHJldHVybiBwICE9PSBnZXRDdXJyZW50RmliZXI7IH0pO1xyXG4gICAgICAgIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCkge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpYmVyQ29udGV4dCwgXCJjdXJyZW50XCIsIHtcclxuICAgICAgICBnZXQ6IHByb3ZpZGVycy5yZWR1Y2UoZnVuY3Rpb24gKHAsIGMpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHAoKSB8fCBjKCk7IH07IH0pLFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJVc2UgRmliZXJDb250ZXh0LnB1c2goKSB0byBjaGFuZ2UgY3VycmVudCBmaWJlclwiKTsgfVxyXG4gICAgfSk7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmliZXItY29udGV4dC5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL29ic2VydmFibGUnO1xyXG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcclxuZXhwb3J0ICogZnJvbSAnLi9jb2xsZWN0aW9uJztcclxuZXhwb3J0ICogZnJvbSAnLi9lbWl0dGVyJztcclxuZXhwb3J0ICogZnJvbSAnLi9maWJlci1jb250ZXh0JztcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIGluaXRNYXBNZXRob2QoY3Rvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgY3RvcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobWFwcGVyKHZhbHVlKSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFwLmpzLm1hcCIsImV4cG9ydCBmdW5jdGlvbiBtaXhpbih0YXJnZXRQcm90bywgbWl4aW5Qcm90bykge1xyXG4gICAgdmFyIHByb3BzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHByb3BzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgcHJvcHMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkgeyByZXR1cm4gdGFyZ2V0UHJvdG9bcHJvcF0gPSBtaXhpblByb3RvW3Byb3BdOyB9KTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taXhpbi5qcy5tYXAiLCJ2YXIgT2JzZXJ2YWJsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vc3RhdGljIGdldCBbU3ltYm9sLnNwZWNpZXNdKCkgeyByZXR1cm4gdGhpczsgfVxyXG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZShfc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlID0gX3N1YnNjcmliZTtcclxuICAgIH1cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHsgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHsgfSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9ic2VydmFibGU7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IE9ic2VydmFibGUgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2YWJsZS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcIi4vb2JzZXJ2YWJsZVwiO1xyXG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XHJcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tIFwiLi9jb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IEZpYmVyQ29udGV4dCB9IGZyb20gJy4vZmliZXItY29udGV4dCc7XHJcbnZhciBWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVmFsdWUoc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHN1YnNjcmliZSkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFZhbHVlLmZyb20gPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlLmZyb20oKSBjYW4gb25seSB0YWtlIG9ic2VydmFibGVzXCIpO1xyXG4gICAgfTtcclxuICAgIFZhbHVlLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXNvbHZlZCA9IGZhbHNlLCByZXN1bHQsIGVyciwgbm90aWZ5O1xyXG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY2lwdGlvbikge1xyXG4gICAgICAgICAgICByZXNvbHZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBlcnIgPSBlcnJvcjtcclxuICAgICAgICAgICAgaWYgKGVycm9yICYmIG5vdGlmeSlcclxuICAgICAgICAgICAgICAgIG5vdGlmeShudWxsLCBlcnJvciwgc3Vic2NpcHRpb24pO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChub3RpZnkpXHJcbiAgICAgICAgICAgICAgICBub3RpZnkodmFsdWUsIG51bGwsIHN1YnNjaXB0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAocmVzb2x2ZWQpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWJlciA9IEZpYmVyQ29udGV4dC5jdXJyZW50O1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEZpYmVyIENvbnRleHRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSBjdXJyZW50RmliZXIuc3Vic2NyaXB0aW9ucywgb2JzZXJ2ZXIgPSBjdXJyZW50RmliZXIub2JzZXJ2ZXI7XHJcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICBub3RpZnkgPSBvYnNlcnZlcjtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBub3RpZnkgPSBmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGZuKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocHJlZml4LCB4KTtcclxuICAgICAgICAgICAgcmV0dXJuIHg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLnRvQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gX3RoaXMubWFwKG1hcHBlcikuc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtudWxsLCBudWxsXTtcclxuICAgICAgICAgICAgdmFyIG15U3Vic2NyaXB0aW9uLCBvdGhlclN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBteVN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMsIGVycm9yLCBzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSBpdGVtcztcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbMV0gIT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgb3RoZXJTdWJzY3JpcHRpb24gPSBvdGhlci5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzWzBdICE9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlcywgbnVsbCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLnN3aXRjaE1hcCA9IGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgdmFyIHJldHVybmVkU3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGVkU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gcztcclxuICAgICAgICAgICAgICAgIGlmIChtYXBwZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZU9yVmFsdWUgPSBtYXBwZXIoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZhYmxlT3JWYWx1ZSAmJiB0eXBlb2Ygb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG9ic2VydmFibGVPclZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuZWRTdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFZhbHVlO1xyXG59KE9ic2VydmFibGUpKTtcclxuZXhwb3J0IHsgVmFsdWUgfTtcclxuVmFsdWUucHJvdG90eXBlLm1hcCA9IGluaXRNYXBNZXRob2QoVmFsdWUpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWx1ZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwbyc7XHJcbiIsInZhciBtYXAgPSB7XG5cdFwiLi9lbi1TR1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tU0cuanNcIixcblx0XCIuL2VuLVNHLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1TRy5qc1wiLFxuXHRcIi4vZW4tYXVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWF1LmpzXCIsXG5cdFwiLi9lbi1hdS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWNhXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1jYS5qc1wiLFxuXHRcIi4vZW4tY2EuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1nYlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tZ2IuanNcIixcblx0XCIuL2VuLWdiLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4taWVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWllLmpzXCIsXG5cdFwiLi9lbi1pZS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLWlsXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pbC5qc1wiLFxuXHRcIi4vZW4taWwuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWlsLmpzXCIsXG5cdFwiLi9lbi1uelwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tbnouanNcIixcblx0XCIuL2VuLW56LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vc3ZcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL3N2LmpzXCIsXG5cdFwiLi9zdi5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIlxufTtcblxuXG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dChyZXEpIHtcblx0dmFyIGlkID0gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSk7XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKGlkKTtcbn1cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpIHtcblx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhtYXAsIHJlcSkpIHtcblx0XHR2YXIgZSA9IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyByZXEgKyBcIidcIik7XG5cdFx0ZS5jb2RlID0gJ01PRFVMRV9OT1RfRk9VTkQnO1xuXHRcdHRocm93IGU7XG5cdH1cblx0cmV0dXJuIG1hcFtyZXFdO1xufVxud2VicGFja0NvbnRleHQua2V5cyA9IGZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0S2V5cygpIHtcblx0cmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xud2VicGFja0NvbnRleHQucmVzb2x2ZSA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZTtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0NvbnRleHQ7XG53ZWJwYWNrQ29udGV4dC5pZCA9IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHJlY3Vyc2l2ZSBzdnxlblwiOyIsImltcG9ydCB7IFVzZXIgfSBmcm9tIFwiLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVzZXJDbGFpbXMgKHVzZXI6IFVzZXIpIHtcclxuICByZXR1cm4gW3tcclxuICAgIHR5cGU6IFwiZW1haWxcIixcclxuICAgIHZhbHVlOiB1c2VyLm1haWxcclxuICB9LHtcclxuICAgIHR5cGU6IFwic2Nob29sXCIsXHJcbiAgICB2YWx1ZTogdXNlci5zY2hvb2xcclxuICB9XS5jb25jYXQodXNlci5yb2xlcy5tYXAocm9sZSA9PiAoe1xyXG4gICAgdHlwZTogXCJyb2xlXCIsXHJcbiAgICB2YWx1ZTogcm9sZVxyXG4gIH0pKSkuY29uY2F0KHVzZXIucm9sZXMubWFwKHJvbGUgPT4gKHtcclxuICAgIHR5cGU6IFwic2Nob29sUm9sZVwiLFxyXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sICsgXCIvXCIgKyByb2xlXHJcbiAgfSkpKTtcclxufVxyXG4iLCJpbXBvcnQgeyBBY2Nlc3NDbGFpbSwgRG9jdW1lbnRBY2Nlc3MsIGhhc0FjY2VzcyBhcyBfaGFzQWNjZXNzLCBBY2Nlc3NSaWdodCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgRG9jdW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBnZXRVc2VyQ2xhaW1zIGZyb20gJy4vZ2V0LXVzZXItY2xhaW1zJztcclxuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZyB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuZXhwb3J0IHsgZ2V0VXNlckNsYWltcyB9O1xyXG5cclxuZXhwb3J0IGNvbnN0IElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TID0gW1xyXG4gIFwidXNlclwiLFxyXG4gIFwicm9sZVwiLFxyXG4gIFwic2Nob29sXCIsXHJcbiAgXCJkZWJ1Z1wiLFxyXG4gIFwidGVzdFZlcnNpb25cIixcclxuICBcInRlc3R2ZXJzaW9uXCIsXHJcbiAgXCJmZWF0dXJlc1wiLFxyXG4gIFwic2Nob29sVHlwZVwiLFxyXG4gIFwic2Nob29sdHlwZVwiXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCwgcmVxdWVzdGVkUmlnaHQ6IEFjY2Vzc1JpZ2h0KSB7XHJcbiAgdmFyIGNsYWltcyA9IGdldFVzZXJDbGFpbXModXNlcik7XHJcbiAgaWYgKHJlcXVlc3RlZFJpZ2h0ICE9PSAnUicgJiYgdXNlci50dXRvckZvcikge1xyXG4gICAgY2xhaW1zID0gY2xhaW1zLmZpbHRlcihjbGFpbSA9PiBjbGFpbS50eXBlICE9PSAnZW1haWwnKTtcclxuICB9XHJcbiAgdmFyIHJlc3VsdCA9IF9oYXNBY2Nlc3MoRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZ0FycmF5KGRvYy5hY2wgfHwgW10pLCBjbGFpbXMsIHJlcXVlc3RlZFJpZ2h0KTtcclxuICAvL2NvbnNvbGUubG9nKGBIYXMgJHtyZXF1ZXN0ZWRSaWdodH0gYWNjZXNzIHRvICR7ZG9jLm5hbWV9LyR7ZG9jLmlkfTogJHtyZXN1bHR9YCk7XHJcbiAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1JlYWRBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xyXG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUicpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzV3JpdGVBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xyXG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnVycpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzU2hhcmVBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xyXG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUycpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUZWFjaGVyQXRTY2hvb2wodXNlcjogVXNlciwgc2Nob29sOiBzdHJpbmcpIHtcclxuICBjb25zdCBpc1RlYWNoZXIgPSB1c2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnRU1QTE9ZRUUnIHx8IHJvbGUgPT09ICdBRE1JTicpO1xyXG4gIGNvbnN0IGJlbG9uZ3NUb1NjaG9vbCA9IChzY2hvb2x8fFwiXCIpLnRvTG93ZXJDYXNlKCkgPT09IHVzZXIuc2Nob29sLnRvTG93ZXJDYXNlKCk7XHJcbiAgcmV0dXJuIChpc1RlYWNoZXIgJiYgYmVsb25nc1RvU2Nob29sKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQWRtaW5PclRlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xyXG4gIHJldHVybiB1c2VyLnJvbGVzLmluY2x1ZGVzKFwiQURNSU5cIikgfHwgaXNUZWFjaGVyQXRTY2hvb2wodXNlciwgc2Nob29sKTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGltcGVyc29uYXRpb25FbnYgPSB7XHJcbiAgYWN0QXMgKG9wdGlvbnM6IHtyb2xlLCBzY2hvb2wsIHVybD99KSB7XHJcbiAgICBjb25zdCB7cm9sZSwgc2Nob29sLCB1cmx9ID0gb3B0aW9ucztcclxuICAgIGNvbnN0IGN1cnJlbnRRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcclxuICAgIGNvbnN0IG5ld1F1ZXJ5ID0gey4uLmN1cnJlbnRRdWVyeSwgcm9sZSwgc2Nob29sfTtcclxuICAgIGNvbnN0IG5ld1F1ZXJ5U3RyaW5nID0gZ2VuZXJhdGVRdWVyeVN0cmluZyhuZXdRdWVyeSk7XHJcbiAgICBpZiAodXJsKSB7XHJcbiAgICAgIGxvY2F0aW9uLmhyZWYgPSBgJHt1cmx9JHtuZXdRdWVyeVN0cmluZ31gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbG9jYXRpb24uaGFzaCA9IFwiI1wiO1xyXG4gICAgICBsb2NhdGlvbi5zZWFyY2ggPSBuZXdRdWVyeVN0cmluZztcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhY3RBcyhvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xyXG4gIGltcGVyc29uYXRpb25FbnYuYWN0QXMob3B0aW9ucyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSAodXJsOiBzdHJpbmcsIHF1ZXJ5OiB7W25hbWU6IHN0cmluZ10gOiBzdHJpbmd9KSB7XHJcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xyXG4gIGNvbnN0IHByZXNlcnZlZFF1ZXJ5ID0ge307XHJcbiAgZm9yIChjb25zdCBwYXJhbSBvZiBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUykge1xyXG4gICAgaWYgKGN1cnJlbnRRdWVyeVtwYXJhbV0pIHByZXNlcnZlZFF1ZXJ5W3BhcmFtXSA9IGN1cnJlbnRRdWVyeVtwYXJhbV07XHJcbiAgfVxyXG4gIGNvbnN0IG5ld1F1ZXJ5U3RyaW5nID0gZ2VuZXJhdGVRdWVyeVN0cmluZyh7Li4ucHJlc2VydmVkUXVlcnksIC4uLnF1ZXJ5fSk7XHJcbiAgY29uc3QgcEhhc2ggPSB1cmwuaW5kZXhPZignIycpO1xyXG4gIHJldHVybiBwSGFzaCA+PSAwID9cclxuICAgIGAke3VybC5zdWJzdHIoMCxwSGFzaCl9JHtuZXdRdWVyeVN0cmluZ30ke3VybC5zdWJzdHIocEhhc2gpfWAgOlxyXG4gICAgYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcclxufVxyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCI7XHJcblxyXG5jb25zdCBJY29uRHJpdmUgPSAoeyBzaXplID0gMzAgfSkgPT4gKFxyXG4gIDxzdmdcclxuICAgIHdpZHRoPXtzaXplfVxyXG4gICAgdmVyc2lvbj1cIjEuMVwiXHJcbiAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcclxuICAgIHhtbG5zWGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCJcclxuICAgIHZpZXdCb3g9XCIwIDAgNTA4LjUyIDUwOC41MlwiXHJcbiAgICBmaWxsPVwiI2ZmZmZmZlwiXHJcbiAgICBzdHlsZT17e3ZlcnRpY2FsQWxpZ246IFwibWlkZGxlXCIsIG1hcmdpblJpZ2h0OiBcIjRweFwifX1cclxuICA+XHJcbiAgICA8cG9seWdvbiBwb2ludHM9XCI0ODQuNDkyLDI4NC41OCAzMzkuMDI0LDMyLjU3NyAxNjkuNDk2LDMyLjU3NyAzMTQuOTk2LDI4NC41OFwiIC8+XHJcbiAgICA8cG9seWdvbiBwb2ludHM9XCIxNDUuNDM3LDc0LjI3NiAwLDMyNi4yNzkgODQuNzY0LDQ3My4wNSAyMzAuMTY5LDIyMS4xNDNcIiAvPlxyXG4gICAgPHBvbHlnb24gcG9pbnRzPVwiMjM0LjM5NiwzMTYuMzYzIDE0My4zNzEsNDc1Ljk0MyA0MjMuNzU2LDQ3NS45NDMgNTA4LjUyLDMxNi4zNlwiIC8+XHJcbiAgPC9zdmc+XHJcbik7XHJcblxyXG5jb25zdCBJY29uQ2xhc3Nyb29tID0gKHsgc2l6ZSA9IDMwIH0pID0+IChcclxuICA8c3ZnXHJcbiAgICB3aWR0aD17c2l6ZX1cclxuICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxyXG4gICAgeG1sbnNYbGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIlxyXG4gICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXHJcbiAgICB2ZXJzaW9uPVwiMS4xXCJcclxuICA+XHJcbiAgICA8cGF0aCBkPVwiTTUgMkMzLjM0OCAyIDIgMy4zNDggMiA1djE0YzAgMS42NTIgMS4zNDggMyAzIDNoMTRjMS42NTIgMCAzLTEuMzQ4IDMtM1Y1YzAtMS42NTItMS4zNDgtMy0zLTN6bTAgMmgxNGMuNTUgMCAxIC40NSAxIDF2MTRjMCAuNTUtLjQ1IDEtMSAxaC0xdi0yaC01djJINWMtLjU1IDAtMS0uNDUtMS0xVjVjMC0uNTUuNDUtMSAxLTF6bTcgMmExLjk5OSAxLjk5OSAwIDEgMCAwIDQgMS45OTkgMS45OTkgMCAxIDAgMC00ek03LjUgOGExLjUgMS41IDAgMSAwIDAgMyAxLjUgMS41IDAgMCAwIDAtM3ptOSAwYTEuNSAxLjUgMCAxIDAgMCAzIDEuNSAxLjUgMCAwIDAgMC0zek0xMiAxMWMtMi42NiAwLTMuNSAyLjUtMy41IDIuNSAwLS44NDguNS0xLjUuNS0xLjUtLjMtLjE4OC0xLjA3LS4zMTMtMS40MzgtLjMxMy0xLjIxNCAwLTIuNTYyIDEuMTkyLTIuNTYyIDJWMTZoMTR2LTIuMzEzYzAtLjgwOC0xLjUxMi0yLTIuNTYzLTItLjM2NyAwLTEuMTM2LjEyNi0xLjQzNy4zMTMgMCAwIC41LjY1Mi41IDEuNSAwIDAtLjg0LTIuNS0zLjUtMi41elwiIC8+XHJcbiAgPC9zdmc+XHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgRHJpdmVCdXR0b24gPSAoe2xhYmVsPSdHb29nbGUgRHJpdmUnLCBhY3Rpb259KSA9PiBcclxuICA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXthY3Rpb259PjxJY29uRHJpdmUgc2l6ZT17MTZ9IC8+IHtsYWJlbH08L2E+XHJcbiIsIi8vIENsaWVudCBpZCBmb3IgR29vZ2xlV2ViQ2xpZW50XHJcbmV4cG9ydCBjb25zdCBXZWJDbGllbnRJZCA9IFwiNDIxNTcyMjYyMjY5LXU2OHY1bGY1bzhzczV0NjhsOGdrcTNwZmFyaDZkYmt2LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tXCI7XHJcblxyXG4vLyBHb29nbGUgRHJpdmUgRmlsZSBJZCB0byBqc29uIGZpbGUgd2l0aCBUYW1wbGF0ZXMgZm9yIENvdXJzZSBCdWlsZGVyIChDbGFzc3Jvb20pXHJcbmV4cG9ydCBjb25zdCBUZW1wbGF0ZXNGaWxlSWQgPSAnaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xVjdleEc2dk44M1NxOGtiNnV6MUI2RGFaRFZPOWVMY0piUDdYRjB2TDRkWS9leHBvcnQ/Zm9ybWF0PXR4dCc7XHJcbiIsImltcG9ydCB7IEVEU0NvdXJzZSwgRURTQXNzZXNzbWVudCwgRURTU3R1ZHlQbGFuLCBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eSwgRURTU3R1ZGVudCwgRURTVHVpdGlvbkdyb3VwLCBFRFNUdWl0aW9uU3R1ZGVudCwgRURTVGVhY2hlciwgTW9ja0VEU0FjYWRlbWljWWVhciwgTW9ja0VEU0RhdGVSYW5nZSB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xyXG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBJc29tb3JwaGljRW52LCBCZWFyZXJQcm92aWRlciwgSHR0cEVycm9yIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFRlcm1TdGFyRW5kRGF0ZSB9IGZyb20gJy4uL3V0aWxzL3NjaG9vbC1tb21lbnQnO1xyXG5pbXBvcnQgeyBTY2hvb2xUZXJtIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLXRlcm0nO1xyXG5pbXBvcnQgeyBkYXRlVGltZVJldml2ZXIsIEwgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBtb2NrSnNvbkZpbGUgZnJvbSAnLi9tb2NrL21vY2stZWRzLWRhdGEuanNvbic7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgU3VzcGVuc2VCYXNlZEFQSSwgbWFrZVN1c3BlbnNlQXBpIH0gZnJvbSAnLi4vdXRpbHMvbWFrZS1zdXNwZW5zZS1hcGknO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVkc0NsaWVudCB7XHJcbiAgaHR0cDogUmVzdENsaWVudDtcclxuICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmc7XHJcbiAgc3VzcGVuc2U6IFN1c3BlbnNlQmFzZWRBUEk8RWRzQ2xpZW50PjtcclxuXHJcbiAgY29uc3RydWN0b3IgKFxyXG4gICAgaXNvbW9ycGhpYzogSXNvbW9ycGhpY0VudixcclxuICAgIGJhc2VVcmw6IHN0cmluZyxcclxuICAgIGJlYXJlclByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcixcclxuICAgIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZ1xyXG4gICkge1xyXG4gICAgdGhpcy5odHRwID0gbmV3IFJlc3RDbGllbnQgKGlzb21vcnBoaWMsIGJhc2VVcmwsIHtiZWFyZXJQcm92aWRlcn0pO1xyXG4gICAgdGhpcy51c2VyRW1haWxHZXR0ZXIgPSB1c2VyRW1haWxHZXR0ZXI7XHJcbiAgICBjb25zdCBpc0FwaU1ldGhvZCA9IG0gPT5cclxuICAgICAgdHlwZW9mIHRoaXNbbV0gPT09ICdmdW5jdGlvbicgJiZcclxuICAgICAgbSAhPT0gJ2NvbnN0cnVjdG9yJyAmJiAvLyBTaW5jZSBtYWtlU3VzcGVuc2VBcGkoKSB3YWxrcyBwcm90b3R5cGUgY2hhaW5cclxuICAgICAgbSAhPT0gJ3ByaXZhdGl6aW5nQ2FjaGVCdXN0JyAmJlxyXG4gICAgICBtICE9PSAndXNlckVtYWlsR2V0dGVyJyAvLyBMaXN0IG5vbi1BUEkgbWV0aG9kcyBoZXJlLi4uXHJcbiAgICAgIDtcclxuXHJcbiAgICBPYmplY3Qua2V5cyhFZHNDbGllbnQucHJvdG90eXBlKS5mb3JFYWNoKG1ldGhvZCA9PiB7XHJcbiAgICAgIGlmIChpc0FwaU1ldGhvZChtZXRob2QpKSB7XHJcbiAgICAgICAgdGhpc1ttZXRob2RdID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXNbbWV0aG9kXSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdGhpcy5zdXNwZW5zZSA9IG1ha2VTdXNwZW5zZUFwaSh0aGlzLCB7aXNBcGlNZXRob2R9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcHJpdmF0aXppbmdDYWNoZUJ1c3QoKSB7XHJcbiAgICByZXR1cm4ge3VzZXI6IHRoaXMudXNlckVtYWlsR2V0dGVyKCl9O1xyXG4gIH1cclxuXHJcbi8qKlxyXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxyXG4gICAqXHJcbiAgICogQHBhcmFtIGNvdXJzZUNvZGUgU2hvcnQtbmFtZSBvZiB0aGUgY291cnNlLiBPcHRpb25hbC5cclxuICAgKi9cclxuICBhc3luYyBnZXRBY3RpdmVDb3Vyc2VzKHE6IHtjb3Vyc2VDb2RlPzogc3RyaW5nLCBwZXJpb2ROYW1lOiBzdHJpbmd9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XHJcbiAgICAgIGlmIChxKSB7XHJcbiAgICAgICAgaWYgKHEuY291cnNlQ29kZSkgcXVlcnkuQ291cnNlQ29kZSA9IHEuY291cnNlQ29kZTtcclxuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50YWN0aXZlY291cnNlc1wiLCBxdWVyeSk7XHJcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICAgIHJldHVybiBqc29uLmNvdXJzZXMgYXMgRURTQ291cnNlW107XHJcbiAgICB9IGNhdGNoIChleCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZnJvbSBFRFM6IFwiICsgZXgpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoTGBLdW5kZSB0eXbDpHJyIGludGUgbGFkZGEgdGVybWluc23DpWwgZWxsZXIgYXZrbGFyYWRlIHN0ZWcgZnLDpW4gRURTLiBGw7Zyc8O2ayBpZ2VuIHNlbmFyZS4uLmApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0cmlldmUgbGF0ZXN0IGFzc2Vzc21lbnRzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiB1c2VyLlxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxyXG4gICAqL1xyXG4gIGFzeW5jIGdldExhdGVzdEFzc2Vzc21lbnRzKGxpbWl0PzogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XHJcbiAgICBpZiAoIWlzTmFOKGxpbWl0KSkgcXVlcnkuQ291bnQgPSBsaW1pdDtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50YXNzZXNzbWVudHNcIiwgcXVlcnkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5hc3Nlc3NtZW50cyBhcyBFRFNBc3Nlc3NtZW50W107ICAgIFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxyXG4gICAqL1xyXG4gIGFzeW5jIGdldFN0dWRlbnRHb2FscygpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwic3R1ZGVudEZ1dHVyZUFiaWxpdGllc1wiLCB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zdHVkZW50RnV0dXJlQWJpbGl0aWVzIGFzIEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5W107XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRUZWFjaGVyVHV0b3JTdHVkZW50cygpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJ0ZWFjaGVydHV0b3JzdHVkZW50c1wiLCB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zdHVkZW50cyBhcyBFRFNTdHVkZW50W107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBnZXRTY2hvb2xUdWl0aW9uR3JvdXBzKClcclxuICAgKiBcclxuICAgKiBSZXR1cm4gdHVpdGlvbmdyb3VwcyBmb3Igc2Nob29sXHJcbiAgICogXHJcbiAgICogQHBhcmFtIHNjaG9vbE5hbWUgLSBuYW1lIG9mIHNjaG9vbFxyXG4gICAqIEBwYXJhbSBjb3Vyc2VDb2RlIC0gU2tvbHZlcmtldHMgY29kZSBmb3IgY291cnNlXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0U2Nob29sVHVpdGlvbkdyb3VwcyhxOiB7c2Nob29sTmFtZTogc3RyaW5nLCBjb3Vyc2VDb2RlOiBzdHJpbmd9KSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiU2Nob29sVHVpdGlvbkdyb3Vwc1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBqc29uLnNjaG9vbFR1aXRpb25Hcm91cHMgYXMgRURTVHVpdGlvbkdyb3VwW107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cygpXHJcbiAgICogXHJcbiAgICogUmV0dXJuIG5hbWUgYW5kIG1haWxhZHJlc3NlcyBmb3IgdHV0aXRpb25ncm91cHMgaW4gc2Nob29sc1xyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBzY2hvb2xOYW1lIC0gbmFtZSBvZiBzY2hvb2xcclxuICAgKiBAcGFyYW0gdHVpdGlvbkdyb3VwTmFtZSAtIHR1aXRpb24gZ3J1b3AgbmFtZSBpbiBFRFNcclxuICAgKi9cclxuICBhc3luYyBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cyhxOiB7c2Nob29sTmFtZTogc3RyaW5nLCB0dWl0aW9uR3JvdXBOYW1lOiBzdHJpbmd9KSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiVHVpdGlvbkdyb3VwU3R1ZGVudHNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi50dWl0aW9uR3JvdXBTdHVkZW50cyBhcyBFRFNUdWl0aW9uU3R1ZGVudFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0U2Nob29sVGVhY2hlcnMoKVxyXG4gICAqIFxyXG4gICAqIFJldHVybiBuYW1lIGFuZCBtYWlsYWRyZXNzZXMgZm9yIHR1dGl0aW9uZ3JvdXBzIGluIHNjaG9vbHNcclxuICAgKiBcclxuICAgKiBAcGFyYW0gc2Nob29sTmFtZSAtIG5hbWUgb2Ygc2Nob29sXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0U2Nob29sVGVhY2hlcnMocToge3NjaG9vbE5hbWU6IHN0cmluZ30pIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJTY2hvb2xUZWFjaGVyc1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBqc29uLnNjaG9vbFRlYWNoZXJzIGFzIEVEU1RlYWNoZXJbXTtcclxuICB9XHJcbiAgLy8gd2UgYXNzdW1lIHRoYXQgdGhlIEVEUyB3aWxsIHJldHVybiB0aGUgY3VycmVudCBhY2FkZW1pYyB5ZWFyIGRhdGVzIGRldGVybWluZWQgYnkgdGhlIGN1cnJlbnQgZGF0ZVxyXG4gIGFzeW5jIGdldEFjYWRlbWljWWVhclRlcm1zKHNjaG9vbExvY2FsZTogc3RyaW5nLCBkYXRlOiBEYXRlKSB7XHJcbiAgICAvLyBtb2NrIGRhdGFcclxuICAgIHN3aXRjaCAoc2Nob29sTG9jYWxlKSB7XHJcbiAgICAgIGNhc2UgJ2VuX3Npbic6XHJcbiAgICAgIHJldHVybiBtb2NrSnNvbkZpbGUuU291dGhJbmRpYS5maWx0ZXIoZiA9PiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JBZnRlcihmLmZpcnN0VGVybS5zdGFydERhdGUpICYmIG1vbWVudChkYXRlKS5pc1NhbWVPckJlZm9yZShmLnNlY29uZFRlcm0uZW5kRGF0ZSkpWzBdIGFzIE1vY2tFRFNBY2FkZW1pY1llYXI7XHJcbiAgICAgIGNhc2UgJ2VuX25pbic6XHJcbiAgICAgIHJldHVybiBtb2NrSnNvbkZpbGUuTm9ydGhJbmRpYS5maWx0ZXIoZiA9PiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JBZnRlcihmLmZpcnN0VGVybS5zdGFydERhdGUpICYmIG1vbWVudChkYXRlKS5pc1NhbWVPckJlZm9yZShmLnNlY29uZFRlcm0uZW5kRGF0ZSkpWzBdIGFzIE1vY2tFRFNBY2FkZW1pY1llYXI7XHJcbiAgICAgIGNhc2UgJ3N2JzpcclxuICAgICAge1xyXG4gICAgICB2YXIgaG9saWRheXMgPSBbXSBhcyBNb2NrRURTRGF0ZVJhbmdlW107XHJcbiAgICAgIHZhciBmaXJzdFRlcm1Nb21lbnQgPSBnZXRUZXJtU3RhckVuZERhdGUoZGF0ZSwgdHJ1ZSk7XHJcbiAgICAgIHZhciBzZWNvbmRUZXJtTW9tZW50ID0gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGUsIGZhbHNlKTtcclxuXHJcbiAgICAgIHZhciBzdGFydEZpcnN0VGVybURhdGUgPSBmaXJzdFRlcm1Nb21lbnRbMF07XHJcbiAgICAgIHZhciBzdGFydFNlY29uZFRlcm1EYXRlID0gc2Vjb25kVGVybU1vbWVudFswXTtcclxuICAgICAgdmFyIGVuZEZpcnN0VGVybURhdGUgPSBmaXJzdFRlcm1Nb21lbnRbMV07XHJcbiAgICAgIHZhciBlbmRTZWNvbmRUZXJtRGF0ZSA9IHNlY29uZFRlcm1Nb21lbnRbMV07XHJcblxyXG4gICAgICBjb25zdCBmaXJzdFRlcm0gPSB7c3RhcnREYXRlOiBuZXcgRGF0ZShzdGFydEZpcnN0VGVybURhdGUueWVhcigpLCBzdGFydEZpcnN0VGVybURhdGUubW9udGgoKSwgc3RhcnRGaXJzdFRlcm1EYXRlLmRhdGUoKSkudG9EYXRlU3RyaW5nKCksIGVuZERhdGU6IG5ldyBEYXRlKHN0YXJ0Rmlyc3RUZXJtRGF0ZS55ZWFyKCksIGVuZEZpcnN0VGVybURhdGUubW9udGgoKSwgZW5kRmlyc3RUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpfTtcclxuICAgICAgY29uc3Qgc2Vjb25kVGVybSA9IHtzdGFydERhdGU6IG5ldyBEYXRlKHN0YXJ0U2Vjb25kVGVybURhdGUueWVhcigpLCBzdGFydFNlY29uZFRlcm1EYXRlLm1vbnRoKCksIHN0YXJ0U2Vjb25kVGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKSwgZW5kRGF0ZTogbmV3IERhdGUoc3RhcnRTZWNvbmRUZXJtRGF0ZS55ZWFyKCksIGVuZFNlY29uZFRlcm1EYXRlLm1vbnRoKCksIGVuZFNlY29uZFRlcm1EYXRlLmRhdGUoKSkudG9EYXRlU3RyaW5nKCl9O1xyXG4gICAgICByZXR1cm4ge2ZpcnN0VGVybSwgc2Vjb25kVGVybSwgaG9saWRheXN9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBFRFNQZXJpb2Qge1xyXG4gIHBlcmlvZDogc3RyaW5nO1xyXG4gIHRlcm06ICdBVCcgfCAnU1QnO1xyXG4gIHllYXI6IG51bWJlcjtcclxuICBjb25zdHJ1Y3RvciAocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtOiBzdHJpbmcgfCBTY2hvb2xNb21lbnQpIHtcclxuICAgIGlmICh0eXBlb2YgcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtID09PSAnc3RyaW5nJykge1xyXG4gICAgICB0aGlzLnBlcmlvZCA9IHBlcmlvZFN0cmluZ09yU2Nob29sVGVybTtcclxuICAgICAgdGhpcy50ZXJtID0gdGhpcy5wZXJpb2Quc3RhcnRzV2l0aCgnSFQnKSA/ICdBVCcgOiAnU1QnO1xyXG4gICAgICB0aGlzLnllYXIgPSBwYXJzZUludCh0aGlzLnBlcmlvZC5zdWJzdHIoMikpO1xyXG4gICAgICBpZiAoaXNOYU4odGhpcy55ZWFyKSkgdGhyb3cgbmV3IEVycm9yIChgSW52YWxpZCBwZXJpb2Q6ICR7dGhpcy5wZXJpb2R9YCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBzY2hvb2xUZXJtID0gbmV3IFNjaG9vbFRlcm0ocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtKTtcclxuICAgICAgdGhpcy5wZXJpb2QgPSAoc2Nob29sVGVybS50ZXJtID09PSAnQVQnID8gXCJIVFwiIDogXCJWVFwiKSArIHNjaG9vbFRlcm0ueWVhcjtcclxuICAgICAgdGhpcy50ZXJtID0gc2Nob29sVGVybS50ZXJtO1xyXG4gICAgICB0aGlzLnllYXIgPSBzY2hvb2xUZXJtLnllYXI7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXQgc2Nob29sVGVybSAoKSA6IFNjaG9vbFRlcm0ge1xyXG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHtcclxuICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLnRlcm0gPT09ICdBVCcgP1xyXG4gICAgICAgIGAke3RoaXMueWVhcn0vJHt0aGlzLnllYXIgKyAxfWAgOlxyXG4gICAgICAgIGAke3RoaXMueWVhci0xfS8ke3RoaXMueWVhcn1gLFxyXG4gICAgICB0ZXJtOiB0aGlzLnRlcm1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9TdHJpbmcoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wZXJpb2Q7XHJcbiAgfVxyXG5cclxuICB2YWx1ZU9mKCkge1xyXG4gICAgcmV0dXJuIHRoaXMueWVhciArIFwiOlwiICsgKHRoaXMudGVybSA9PT0gJ1NUJyA/IFwiMVwiIDogXCIyXCIpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSnNvbkRhdGVfb2xkIChqc29uRGF0ZVN0cjogc3RyaW5nKSA6IERhdGUge1xyXG4gIGNvbnN0IGRhdGUgPSBkYXRlVGltZVJldml2ZXIoXCJcIiwganNvbkRhdGVTdHIpO1xyXG4gIGlmICghKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBKU09OIGRhdGUgc3RyaW5nOiBcIiArIGpzb25EYXRlU3RyKTtcclxuICByZXR1cm4gZGF0ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gYXZvaWRTaW11bHRhbm91c0NhbGxzPFQsQT4obWV0aG9kOiAoLi4uYXJnczpBW10pPT5Qcm9taXNlPFQ+KSA6ICguLi5hcmdzOkFbXSk9PlByb21pc2U8VD4ge1xyXG4gIGxldCBvbmdvaW5nUHJvbWlzZXM6IHtbYXJnc0pzb246IHN0cmluZ106IFByb21pc2U8VD59ID0ge307XHJcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgY29uc3QgYXJnc0pzb24gPSBKU09OLnN0cmluZ2lmeShbXS5zbGljZS5jYWxsKGFyZ3VtZW50cykpO1xyXG4gICAgaWYgKCFvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dKSB7XHJcbiAgICAgIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0gPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKHJlc3VsdD0+e1xyXG4gICAgICAgIGRlbGV0ZSBvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dO1xyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBlbnYgfSBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdvb2dsZUNsaWVudCB7XHJcbiAgdG9rZW5FeHBpcmF0aW9uOiBEYXRlO1xyXG4gIGdvb2dsZVRva2VuUHJvdmlkZXI6IEJlYXJlclByb3ZpZGVyO1xyXG4gIGRpc2NvdmVyeURvY3M6IHN0cmluZ1tdO1xyXG4gIHRva2VuOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGRpc2NvdmVyeURvY3M6IHN0cmluZykge1xyXG4gICAgdGhpcy5nb29nbGVUb2tlblByb3ZpZGVyID0gZW52Lmdvb2dsZVRva2VuUHJvdmlkZXI7XHJcbiAgICB0aGlzLmRpc2NvdmVyeURvY3MgPSBbXTtcclxuICAgIHRoaXMuZGlzY292ZXJ5RG9jcy5wdXNoKGRpc2NvdmVyeURvY3MpO1xyXG4gIH1cclxuXHJcbiAgc2V0QmVhcmVyUHJvdmlkZXIoZ29vZ2xlVG9rZW5Qcm92aWRlcjogQmVhcmVyUHJvdmlkZXIpIHtcclxuICAgIHRoaXMuZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGdvb2dsZVRva2VuUHJvdmlkZXI7XHJcbiAgfVxyXG5cclxuICBhc3luYyBlbnN1cmVJbml0ZWQoKSB7XHJcbiAgICAvLyBMb2FkIEdBUElcclxuICAgIGlmICh0eXBlb2YgZ2FwaSA9PT0gJ3VuZGVmaW5lZCcpIGF3YWl0IHRoaXMubG9hZEdhcGkoKTtcclxuXHJcbiAgICAvLyBTZXQgdG9rZW5cclxuICAgIGlmICghdGhpcy50b2tlbkV4cGlyYXRpb24gfHwgdGhpcy50b2tlbkV4cGlyYXRpb24gPCBuZXcgRGF0ZSgpKSB7XHJcbiAgICAgIGNvbnN0IHRva2VuUmVzdWx0ID0gYXdhaXQgdGhpcy5nb29nbGVUb2tlblByb3ZpZGVyLmdldEJlYXJlcigpO1xyXG4gICAgICB0aGlzLnRva2VuRXhwaXJhdGlvbiA9IG5ldyBEYXRlKHRva2VuUmVzdWx0LmV4cGlyZXMpO1xyXG4gICAgICB0aGlzLnRva2VuID0gdG9rZW5SZXN1bHQudG9rZW47XHJcbiAgICAgIGdhcGkuY2xpZW50LnNldFRva2VuKHtcclxuICAgICAgICBhY2Nlc3NfdG9rZW46IHRva2VuUmVzdWx0LnRva2VuXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBMb2FkIGFsbCBkaXNjb3Z5ZXJEb2NzXHJcbiAgICBhd2FpdCBnYXBpLmNsaWVudC5pbml0KHtcclxuICAgICAgZGlzY292ZXJ5RG9jczogdGhpcy5kaXNjb3ZlcnlEb2NzXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxvYWRHYXBpKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgIGlmICh0eXBlb2YgZ2FwaSAhPT0gJ3VuZGVmaW5lZCcpIHJldHVybiByZXNvbHZlKCk7XHJcbiAgICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xyXG4gICAgICBzY3JpcHQuc3JjID0gXCJodHRwczovL2FwaXMuZ29vZ2xlLmNvbS9qcy9jbGllbnQuanM/b25sb2FkPWdhYXBpX2xvYWRlZFwiO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoc2NyaXB0KTtcclxuICAgICAgKHdpbmRvdyBhcyBhbnkpLmdhYXBpX2xvYWRlZCA9IHJlc29sdmU7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgR29vZ2xlQ2xpZW50IH0gZnJvbSAnLi9nb29nbGUtY2xpZW50JztcclxuXHJcbmludGVyZmFjZSBkb3dubG9hZEFyZ3Mge1xyXG4gIGZpbGU6IHNlbGVjdGVkRmlsZTtcclxuICBsaW1pdFNpemU/OiBudW1iZXI7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIHNlbGVjdGVkRmlsZSB7XHJcbiAgZmlsZUlkOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgbWltZVR5cGU6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgbW9kaWZpZWRUaW1lOiBudW1iZXI7XHJcbiAgY2FuRXhwb3J0PzogYm9vbGVhbjtcclxuICBpY29uVXJsPzogc3RyaW5nO1xyXG4gIHRodW1ibmFpbFVybD86IHN0cmluZztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVEcml2ZSBleHRlbmRzIEdvb2dsZUNsaWVudCB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2Rpc2NvdmVyeS92MS9hcGlzL2RyaXZlL3YzL3Jlc3QnKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldEZpbGUoZmlsZUlkKSB7XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRlZCgpO1xyXG4gICAgcmV0dXJuIGdhcGkuY2xpZW50LmRyaXZlLmZpbGVzLmdldCg8YW55PntcclxuICAgICAgZmlsZUlkOiBmaWxlSWQsXHJcbiAgICAgIHN1cHBvcnRzQWxsRHJpdmVzOiB0cnVlLFxyXG4gICAgICBmaWVsZHM6ICdpZCxuYW1lLG1pbWVUeXBlLHdlYlZpZXdMaW5rLGljb25MaW5rLG1vZGlmaWVkVGltZSx0aHVtYm5haWxMaW5rJ1xyXG4gICAgfSkudGhlbihyZXNwID0+IHtcclxuICAgICAgaWYgKHJlc3AucmVzdWx0Lm5hbWUpIHtcclxuICAgICAgICB2YXIgZmlsZSA9IHJlc3AucmVzdWx0O1xyXG4gICAgICAgIHJldHVybiB7ZmlsZUlkOiBmaWxlLmlkLCB1cmw6IGZpbGUud2ViVmlld0xpbmssIG1pbWVUeXBlOiBmaWxlLm1pbWVUeXBlLCBuYW1lOiBmaWxlLm5hbWUsIG1vZGlpZmllZFRpbWU6IGZpbGUubW9kaWZpZWRUaW1lLCBpY29uVXJsOiBmaWxlLmljb25MaW5rLCB0aHVtYm5haWxVcmw6IGZpbGUudGh1bWJuYWlsTGlua307XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB1cGRhdGVQZXJtaXNzaW9ucygpXHJcbiAgICogXHJcbiAgICogQHBhcmFtIGZpbGVJZCBcclxuICAgKiBcclxuICAgKiBNYWtlIHRoZSBmaWxlIGFjY2Vzc2libGUgdG8gYWxsIGluIHRoZSBkb21haW4uIFNob3VsZCBiZSB1bm5lY2Vzc2FyeSBidXQgc29tZVxyXG4gICAqIHRlYWNoZXJzIGhhdmUgY2hhbmdlZCB0aGVpciBkZWZhdWx0IHBlcm1pc3Npb25zLlxyXG4gICAqIFdlIGRvbid0IGNhcmUgcmlnaHQgbm93IGlmIHRoaXMgZmFpbHMgYmVjYXVzZSB0aGlzIGlzIGp1c3QgYW4gZXh0cmEgcHJlY2F1dGlvbi5cclxuICAgKiBJZiB3ZSBwbGFuIG9uIHVzaW5nIHRoaXMgb24gb3RoZXIgZG9tYWlucyB0aGUgZG9tYWluLWF0dHJpYnV0ZSBuZWVkcyB0byBiZSBkeW5hbWljLlxyXG4gICAqIFxyXG4gICAqL1xyXG4gIGFzeW5jIHVwZGF0ZVBlcm1pc3Npb25zKGZpbGVJZCkge1xyXG4gICAgY29uc29sZS5sb2coJ3VwZGF0aW5nIHBlcm1pc3Npb25zJylcclxuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGVkKCk7XHJcbiAgICBnYXBpLmNsaWVudC5kcml2ZS5wZXJtaXNzaW9ucy5jcmVhdGUoPGFueT57XHJcbiAgICAgIGZpbGVJZDogZmlsZUlkLFxyXG4gICAgICBzZW5kTm90aWZpY2F0aW9uRW1haWw6IGZhbHNlLFxyXG4gICAgICByb2xlOiAncmVhZGVyJyxcclxuICAgICAgdHlwZTogJ2FueW9uZScsIC8vIG9yIHNob3VsZCB3ZSBsaW1pdCB0byBkb21haW4gKGVycm9yIGlmIGluIEtlZHNjaG9vbHMuY29tKVxyXG4gICAgICAvLyB0eXBlOiAnZG9tYWluJywgXHJcbiAgICAgIC8vIGRvbWFpbjogJ2t1bnNrYXBzc2tvbGFuLnNlJ1xyXG4gICAgICBzdXBwb3J0c0FsbERyaXZlczogdHJ1ZVxyXG4gICAgfSkudGhlbihyZXNwID0+IGNvbnNvbGUubG9nKHJlc3ApKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNyZWF0ZUZvbGRlcihuYW1lLCBwYXJlbnQpwqB7XHJcbiAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgZm9sZGVyICcgKyBuYW1lKTtcclxuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGVkKCk7XHJcbiAgICByZXR1cm4gZ2FwaS5jbGllbnQuZHJpdmUuZmlsZXMuY3JlYXRlKDxhbnk+e1xyXG4gICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICBtaW1lVHlwZTogJ2FwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5mb2xkZXInLFxyXG4gICAgICBwYXJlbnRzOiBbcGFyZW50XVxyXG4gICAgfSkudGhlbihyZXNwID0+IHJlc3AucmVzdWx0KTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldElkRm9yRm9sZGVyUGF0aChwYXRoOiBzdHJpbmdbXSkge1xyXG4gICAgY29uc29sZS5sb2coJ0dldHRpbmcgaWQgZm9yICcgKyBwYXRoLmpvaW4oJy8nKSk7XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRlZCgpO1xyXG4gICAgbGV0IHBhcmVudCA9ICdyb290JztcclxuICAgIGZvciAodmFyIGZvbGRlciBvZiBwYXRoKSB7XHJcbiAgICAgIGNvbnN0IGZvbGRlcklkID0gYXdhaXQgdGhpcy5nZXRJZEZvckZvbGRlcihmb2xkZXIsIHBhcmVudCk7XHJcbiAgICAgIGlmIChmb2xkZXJJZCkge1xyXG4gICAgICAgIHBhcmVudCA9IGZvbGRlcklkO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IG5ld0ZvbGRlciA9IGF3YWl0IHRoaXMuY3JlYXRlRm9sZGVyKGZvbGRlciwgcGFyZW50KTtcclxuICAgICAgICBwYXJlbnQgPSBuZXdGb2xkZXIuaWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJlbnQ7XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRJZEZvckZvbGRlcihuYW1lOiBzdHJpbmcsIHBhcmVudDogc3RyaW5nKSB7XHJcbiAgICBjb25zb2xlLmxvZygnR2V0dGluZyBpZCBmb3IgJyArIG5hbWUpO1xyXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0ZWQoKTtcclxuICAgIHJldHVybiBnYXBpLmNsaWVudC5kcml2ZS5maWxlcy5saXN0KHtcclxuICAgICAgY29ycG9yYTogJ3VzZXInLFxyXG4gICAgICBxOiBcIidcIitwYXJlbnQrXCInIGluIHBhcmVudHMgYW5kIG1pbWVUeXBlID0gJ2FwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5mb2xkZXInIGFuZCBuYW1lID0gJ1wiK25hbWUrXCInXCJcclxuICAgIH0pLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgIGlmIChyZXNwLnJlc3VsdC5maWxlcy5sZW5ndGgpIHtcclxuICAgICAgICByZXR1cm4gcmVzcC5yZXN1bHQuZmlsZXNbMF0uaWQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNvcHlGaWxlKGZpbGUsIGRlc3RpbmF0aW9uKSB7XHJcbiAgICBjb25zb2xlLmxvZygnQ29weWluZyBmaWxlOiAnICsgZmlsZS5uYW1lKTtcclxuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGVkKCk7XHJcbiAgICBpZiAoZGVzdGluYXRpb24pIHtcclxuICAgICAgY29uc3QgcGFyZW50ID0gYXdhaXQgdGhpcy5nZXRJZEZvckZvbGRlclBhdGgoZGVzdGluYXRpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgcGFyZW50ID0gJ3Jvb3QnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGdhcGkuY2xpZW50LmRyaXZlLmZpbGVzLmNvcHkoPGFueT57XHJcbiAgICAgIGZpbGVJZDogZmlsZS5pZCxcclxuICAgICAgc3VwcG9ydHNBbGxEcml2ZXM6IHRydWUsXHJcbiAgICAgIHBhcmVudHM6IFtwYXJlbnRdLFxyXG4gICAgICBuYW1lOiBmaWxlLm5hbWUsXHJcbiAgICAgIGZpZWxkczogJ2lkLG5hbWUsbWltZVR5cGUsd2ViVmlld0xpbmssaWNvbkxpbmssbW9kaWZpZWRUaW1lLHRodW1ibmFpbExpbmsnXHJcbiAgICB9KS50aGVuKHJlc3AgPT4gcmVzcC5yZXN1bHQpO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIGRvd25sb2FkRmlsZSgpXHJcbiAgICogQHBhcmFtIGZpbGUgXHJcbiAgICogXHJcbiAgICogV2hlbiBDbGFzc3Jvb20gaGFzIGJlZW4gaW50ZWdyYXRlZCB3ZSB3aWxsIHdhbnQgdG8gaGFuZGxlIG9ubHkgdGhlIGZpbGVJZDpzXHJcbiAgICogc28gdGhhdCBlZGl0aW5nIGNhcGFiaWxpdGllcyBhcmUgcGVzZXJ2ZWQgb24gdGhlIGZpbGUgKGlmIGl0IGlzIGEgZ29vZ2xlLWFwcHMgZmlsZSlcclxuICAgKiBSaWdodCBub3cgZ29vZ2xlLWFwcHMgZmlsZXMgYXJlIGNvbnZlcnRlZCB0byBwZGYgYW5kIHBhc3NlZCBpbnRvIHRoZSBjdXJyZW50IGZsb3cuXHJcbiAgICogXHJcbiAgICogVE9ETzogZXJyb3IgaGFuZGxpbmdcclxuICAgKi9cclxuXHJcbiAgYXN5bmMgZG93bmxvYWRGaWxlKHtmaWxlLCBsaW1pdFNpemV9OmRvd25sb2FkQXJncykge1xyXG4gICAgLy8gQSBmaWxlIHRoYXQgY2FuIGJlIGV4cG9ydGVkIHRvIFBERiBpcyByZXRyZWl2ZWQgd2l0aFxyXG4gICAgLy8gZmlsZS5leHBvcnQoKSBmcm9tIERyaXZlLCBjb252ZXJ0ZWQgdG8gYSBibG9iIGFuZCB0aGVuXHJcbiAgICAvLyB0byBhIEZpbGUuXHJcbiAgICAvLyBBIGZpbGUgdGhhdCBjYW4gbm90IGJlIGV4cG9ydGVkIHRvIFBERiBpcyByZXRyaWV2ZWRcclxuICAgIC8vIHRocm91Z2ggWEhSIGFuZCBjb252ZXJ0ZWQgdG8gYSBGaWxlLlxyXG5cclxuICAgIC8vIElmIHdlIGRvbid0IG5lZWQgdG8gaGFuZGxlIHRoZSBwaHlzaWNhbCBmaWxlcyBvbiB0aGUgY2xpZW50XHJcbiAgICAvLyB3ZSBjb3VsZCBzYXZlIG9ubHkgdGhlIGZpbGVJZDpzIGFuZCBkaXNwbGF5IGZpbGVuYW1lIGFuZCBtaW1lVHlwZVxyXG4gICAgLy8gZm9yIHRoZSBmaWxlIGluIG91ciBsaXN0aW5ncy4gV2hlbi9pZiB3ZSB1c2UgR29vZ2xlIENsYXNzcm9vbSBmb3JcclxuICAgIC8vIG91ciB0YXNrLWhhbmRsaW5nIHRoYXQgd291bGQgYmUgdGhlIHByZWZlcnJlZCBhcHByb2FjaCB0byBrZWVwXHJcbiAgICAvLyB0aGUgZmlsZSBhcyBhbiBlZGl0YWJsZSBHb29nbGUgZmlsZVxyXG5cclxuICAgIC8vIEluaXQgdGhlIGRyaXZlLWFwaSAob25seSBuZWVkZWQgZm9yIGRvd25sb2FkIHNvIG5vdCBsb2FkZWQgaW5pdGlhbGx5KVxyXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0ZWQoKTtcclxuXHJcbiAgICBpZiAoZmlsZS5jYW5FeHBvcnQpIHtcclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPEZpbGU+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBnYXBpLmNsaWVudC5kcml2ZS5maWxlcy5leHBvcnQoe1xyXG4gICAgICAgICAgZmlsZUlkOiBmaWxlLmZpbGVJZCxcclxuICAgICAgICAgIG1pbWVUeXBlOiAnYXBwbGljYXRpb24vcGRmJ31cclxuICAgICAgICApLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICBjb25zdCBsZW4gPSByZXNwLmJvZHkubGVuZ3RoO1xyXG4gICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KG5ldyBBcnJheUJ1ZmZlcihsZW4pKTtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgZGF0YVtpXSA9IHJlc3AuYm9keS5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwge3R5cGU6ICdhcHBsaWNhdGlvbi9wZGYnfSk7XHJcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZSA9IGZpbGUubmFtZSsnLnBkZic7XHJcbiAgICAgICAgICByZXNvbHZlKG5ldyBGaWxlKFtibG9iXSwgZmlsZW5hbWUsIHt0eXBlOiAnYXBwbGljYXRpb24vcGRmJywgbGFzdE1vZGlmaWVkOiBmaWxlLm1vZGlmaWVkVGltZX0pKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9KTsgIFxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIC8vIGEgZmlsZSB0aGF0IGlzbid0IGEgZ29vZ2xlLWFwcHMgZmlsZSBuZWVkcyB0byBiZSBmZXRjaGVkIHZpYSBYSFJcclxuICAgICAgLy8gYmVjYXVzZSByZXNwb25zZVR5cGUgYW5kID9hbHQ9bWVkaWEgbmVlZHMgdG8gYmUgc2V0IHRvIGF2b2lkIENPUlNcclxuICAgICAgY29uc3QgeGhyRG93bmxvYWQgPSAoZmlsZTpzZWxlY3RlZEZpbGUpID0+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8RmlsZT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICB4aHIub3BlbihcIkdFVFwiLCBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2RyaXZlL3YzL2ZpbGVzL1wiK2ZpbGUuZmlsZUlkKyc/YWx0PW1lZGlhJywgdHJ1ZSk7XHJcbiAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQXV0aG9yaXphdGlvbicsJ0JlYXJlciAnK3RoaXMudG9rZW4pO1xyXG4gICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xyXG4gICAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJlc29sdmUobmV3IEZpbGUoW3hoci5yZXNwb25zZV0sIGZpbGUubmFtZSwge3R5cGU6IGZpbGUubWltZVR5cGUsIGxhc3RNb2RpZmllZDogZmlsZS5tb2RpZmllZFRpbWV9KSk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgeGhyLnNlbmQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPEZpbGU+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBpZiAobGltaXRTaXplICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGdhcGkuY2xpZW50LmRyaXZlLmZpbGVzLmdldCh7XHJcbiAgICAgICAgICAgIGZpbGVJZDogZmlsZS5maWxlSWQsXHJcbiAgICAgICAgICAgIGZpZWxkczogJ3NpemUnXHJcbiAgICAgICAgICB9KS50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzaXplID0gTnVtYmVyKHJlc3AucmVzdWx0LnNpemUpO1xyXG4gICAgICAgICAgICBpZiAoc2l6ZSA+IGxpbWl0U2l6ZSoxMDI0KjEwMjQpIHtcclxuICAgICAgICAgICAgICByZWplY3QoJ0dvb2dsZVBpY2tlckVycm9yOiBGaWxzaXplIGlzIHRvbyBsYWFyZ2UnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgeGhyRG93bmxvYWQoZmlsZSkudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICByZXNvbHZlKHJlc3ApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgeGhyRG93bmxvYWQoZmlsZSkudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXNwKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBHb29nbGVXZWJDbGllbnQgfSBmcm9tICcuL2dvb2dsZS13ZWJjbGllbnQnO1xyXG5pbXBvcnQgeyBHb29nbGVEcml2ZSwgc2VsZWN0ZWRGaWxlIH0gZnJvbSAnLi9nb29nbGUtZHJpdmUnO1xyXG5cclxuaW50ZXJmYWNlIG9wdGlvbnMge1xyXG4gIHVwbG9hZD86IGJvb2xlYW47XHJcbiAgbXVsdGlwbGU/OiBib29sZWFuO1xyXG4gIGxpbWl0VHlwZT86IGZhbHNlIHwgJ2dvb2dsZS1hcHBzJyB8wqAncGRmJztcclxufVxyXG5cclxuY29uc3QgbWltZVR5cGVDb2xsZWN0aW9ucyA9IHtcclxuICAnZ29vZ2xlLWFwcHMnIDogJ2FwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5kb2N1bWVudCxhcHBsaWNhdGlvbi92bmQuZ29vZ2xlLWFwcHMucHJlc2VudGF0aW9uLGFwcGxpY2F0aW9uL3ZuZC5nb29nbGUtYXBwcy5zcHJlYWRzaGVldCcsXHJcbiAgJ3BkZic6ICdhcHBsaWNhdGlvbi9wZGYnXHJcbn07XHJcblxyXG4vKipcclxuICogR29vZ2xlUGlja2VyXHJcbiAqIEluY2x1ZGVzIHRoZSBpbml0aWF0aW9uIG9mIHRoZSBjb3JyZWN0IGFwaTpzLlxyXG4gKiBDZXJ0YWluIG9wdGlvbnMgY2FuIGJlIHBhc3NlZCB0byB0aGUgY29uc3RydWN0b3JcclxuICogYW5kIHRoZXJlIGNvdWxkIGJlIG90aGVycyB3b3J0aCBpbmNvcnBvcmF0aW5nIChpLmUuIFRlYW0gRHJpdmUtc3VwcG9ydCkuXHJcbiAqIFxyXG4gKiBSaWdodCBub3cgdHdvIG9wdGlvbnMgYXJlIGhhbmRsZWQ6XHJcbiAqIC0gdXBsb2FkOiBpZiBhIHVzZXIgY2FuIHVwbG9hZCB0byBEcml2ZSBpbiB0aGUgR29vZ2xlIERyaXZlIFBpY2tlclxyXG4gKiAtIG11bHRpcGxlOiBpZiBhIHVzZXIgY2FuIHNlbGVjdCBtdWx0aXBsZSBmaWxlc1xyXG4gKiAtIGxpbWl0VHlwZTogYWN0aXZlIGxpbWl0cyB0byBjZXJ0YWluIG1pbWVUeXBlc0NvbGxlY3Rpb25zXHJcbiAqIFxyXG4gKiBXZSBjb3VsZCBwcm9iYWJseSBzcGxpdCB0aGlzIGludG8gZ29vZ2xlLXBpY2tlciBhbmQgZ29vZ2xlLWRyaXZlIHdoZXJlIGdvb2dsZS1kcml2ZVxyXG4gKiBoYW5kbGVzIHRoZSBleHBsaWNpdCBjYWxscyB0byB0aGUgZ29vZ2xlIGRyaXZlIGFwaS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVQaWNrZXIgZXh0ZW5kcyBHb29nbGVXZWJDbGllbnQge1xyXG4gIHBpY2tlcjogZ29vZ2xlLnBpY2tlci5QaWNrZXI7XHJcbiAgb3B0aW9uczogb3B0aW9ucztcclxuICBkcml2ZTogR29vZ2xlRHJpdmU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBvcHRpb25zKSB7XHJcbiAgICBzdXBlcihbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmUnXSk7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSB7dXBsb2FkOiBmYWxzZSwgbXVsdGlwbGU6IGZhbHNlLCBsaW1pdFR5cGU6IGZhbHNlfTtcclxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5vcHRpb25zLCBvcHRpb25zKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMub3B0aW9ucyk7XHJcbiAgICB0aGlzLmRyaXZlID0gbmV3IEdvb2dsZURyaXZlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBzaG93KClcclxuICAgKiBcclxuICAgKiBJZiBhIHNpbmdsZSBmaWxlIGlzIHJlcXVlc3RlZCBmcm9tIHRoZSBwaWNrZXIgYSBsaXN0IG9mIGZpbGVzIHdpdGggb25lIGVsZW1lbnQgaXMgcmV0dXJuZWQuXHJcbiAgICogSXQgaXMgdXAgdG8gdGhlIGNhbGxlciB0byBoYW5kbGUgdGhlIGxpc3QgaW4gYSByZWxldmFudCBtYW5uZXIuXHJcbiAgICogXHJcbiAgICogTW9yZSBkYXRhIGZyb20gdGhlIGZpbGUgY291bGQgYmUgZXh0cmFjdGVkIGlmIGl0IGlzIGRlZW1lZCBuZWNlc3NhcnkuXHJcbiAgICogXHJcbiAgICovXHJcbiAgYXN5bmMgc2hvdygpIHtcclxuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGVkKCk7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8c2VsZWN0ZWRGaWxlW10+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgY29uc3QgY2FsbGJhY2sgPSAocmVzcG9uc2UpID0+IHtcclxuICAgICAgICBpZiAocmVzcG9uc2VbJ2FjdGlvbiddID09IGdvb2dsZS5waWNrZXIuQWN0aW9uLkNBTkNFTCkge1xyXG4gICAgICAgICAgICByZWplY3QoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlc3BvbnNlWydhY3Rpb24nXSA9PSBnb29nbGUucGlja2VyLkFjdGlvbi5QSUNLRUQpIHtcclxuICAgICAgICAgIGxldCBzZWxlY3RlZCA9IFtdO1xyXG4gICAgICAgICAgcmVzcG9uc2UuZG9jcy5tYXAoZG9jID0+IHtcclxuICAgICAgICAgICAgY29uc3Qge2lkOiBmaWxlSWQsIG1pbWVUeXBlLCBuYW1lLCBtb2RpZmllZFRpbWUsIGljb25VcmwsIHVybH0gPSBkb2M7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhbkV4cG9ydCA9IG1pbWVUeXBlLmluY2x1ZGVzKCdnb29nbGUtYXBwcycpO1xyXG4gICAgICAgICAgICBzZWxlY3RlZC5wdXNoKHtmaWxlSWQsIG1pbWVUeXBlLCBuYW1lLCBtb2RpZmllZFRpbWUsIGNhbkV4cG9ydCwgaWNvblVybCwgdXJsfSk7XHJcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBwZXJtaXNzaW9ucyB0byByZWFkIGJ5IGFsbCBpbiBkb21haW5cclxuICAgICAgICAgICAgdGhpcy5kcml2ZS51cGRhdGVQZXJtaXNzaW9ucyhmaWxlSWQpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3RlZCk7XHJcbiAgICAgICAgICByZXNvbHZlKHNlbGVjdGVkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBwaWNrZXJidWlsZGVyID0gbmV3IGdvb2dsZS5waWNrZXIuUGlja2VyQnVpbGRlcigpXHJcbiAgICAgICAgLmVuYWJsZUZlYXR1cmUoZ29vZ2xlLnBpY2tlci5GZWF0dXJlLlNVUFBPUlRfRFJJVkVTKVxyXG4gICAgICAgIC5lbmFibGVGZWF0dXJlKGdvb2dsZS5waWNrZXIuRmVhdHVyZS5TVVBQT1JUX1RFQU1fRFJJVkVTKVxyXG4gICAgICAgIC5hZGRWaWV3KFxyXG4gICAgICAgICAgbmV3IGdvb2dsZS5waWNrZXIuRG9jc1ZpZXcoKVxyXG4gICAgICAgICAgICAuc2V0T3duZWRCeU1lKHRydWUpIC8vIHNob3VsZCB0aGlzIGJlIGFuIG9wdGlvbj9cclxuICAgICAgICAgICAgLnNldEluY2x1ZGVGb2xkZXJzKHRydWUpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIC5hZGRWaWV3KFxyXG4gICAgICAgICAgbmV3IGdvb2dsZS5waWNrZXIuRG9jc1ZpZXcoKVxyXG4gICAgICAgICAgICAuc2V0SW5jbHVkZUZvbGRlcnModHJ1ZSlcclxuICAgICAgICAgICAgLnNldEVuYWJsZVRlYW1Ecml2ZXModHJ1ZSlcclxuICAgICAgICApXHJcbiAgICAgICAgLnNldExvY2FsZShcInN2XCIpIC8vIHNob3VsZCB0aGlzIGJlIGFuIG9wdGlvbj9cclxuICAgICAgICAuc2V0U2l6ZSgxMDUxLDY1MCkgLy8gc2hvdWxkIHRoaXMgYmUgYW4gb3B0aW9uP1xyXG4gICAgICAgIC5zZXRPQXV0aFRva2VuKHRoaXMuYXV0aFRva2VuKVxyXG4gICAgICAgIC5zZXRDYWxsYmFjayhjYWxsYmFjayk7XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudXBsb2FkKSB7XHJcbiAgICAgICAgcGlja2VyYnVpbGRlci5hZGRWaWV3KG5ldyBnb29nbGUucGlja2VyLkRvY3NVcGxvYWRWaWV3KCkuc2V0SW5jbHVkZUZvbGRlcnModHJ1ZSkpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcclxuICAgICAgICBwaWNrZXJidWlsZGVyLmVuYWJsZUZlYXR1cmUoZ29vZ2xlLnBpY2tlci5GZWF0dXJlLk1VTFRJU0VMRUNUX0VOQUJMRUQpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubGltaXRUeXBlKSB7XHJcbiAgICAgICAgdmFyIG1pbWVUeXBlcyA9IG1pbWVUeXBlQ29sbGVjdGlvbnNbdGhpcy5vcHRpb25zLmxpbWl0VHlwZV07XHJcbiAgICAgICAgY29uc29sZS5sb2cobWltZVR5cGVzKTtcclxuICAgICAgICBwaWNrZXJidWlsZGVyLnNldFNlbGVjdGFibGVNaW1lVHlwZXMobWltZVR5cGVzKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnBpY2tlciA9IHBpY2tlcmJ1aWxkZXIuYnVpbGQoKTtcclxuICAgICAgdGhpcy5waWNrZXIuc2V0VmlzaWJsZSh0cnVlKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFdlYkNsaWVudElkIH0gZnJvbSAnLi9jb25maWdzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVXZWJDbGllbnQge1xyXG4gIGF1dGhUb2tlbjogc3RyaW5nO1xyXG4gIHNjb3Blczogc3RyaW5nW107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHNjb3Blcykge1xyXG4gICAgdGhpcy5zY29wZXMgPSBbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvdXNlcmluZm8uZW1haWwnLCAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC91c2VyaW5mby5wcm9maWxlJ107XHJcbiAgICB0aGlzLnNjb3Blcy5wdXNoKC4uLnNjb3Blcyk7XHJcbiAgfVxyXG4gIGFzeW5jIGVuc3VyZUluaXRlZCgpIHtcclxuICAgIC8vIExvYWQgR0FQSVxyXG4gICAgaWYgKHR5cGVvZiBnYXBpID09PSBcInVuZGVmaW5lZFwiKSBhd2FpdCB0aGlzLmxvYWRHYXBpKCk7XHJcblxyXG4gICAgLy8gS0VEU1NjaG9vbHNcclxuICAgIGNvbnN0IFNDT1BFUyA9IHRoaXMuc2NvcGVzLmpvaW4oJyAnKTtcclxuICAgIFxyXG4gICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUscmVqZWN0KSA9PiB7XHJcbiAgICAgIGdhcGkubG9hZChcImNsaWVudDphdXRoMlwiLCAoKSA9PiB7XHJcbiAgICAgICAgLy8gQ2FsbHMgYXV0aG9yaXplIHdpdGhvdXQgcHJvbXB0aW5nIHRoZSB1c2VyLiBJZiBhdXRob3JpemF0aW9uIGhhc24ndCBiZWVuIGdpdmVuIGJ5XHJcbiAgICAgICAgLy8gdGhlIHVzZXIgYW4gZXJyb3IgaXMgcmV0dXJuZWQgYW5kIHdlIGNhbGwgYXV0aG9yaXplIGFnYWluIHdpdGggY29uc2VudC1zY3JlZW5cclxuICAgICAgICBsZXQgcmVhdXRob3JpemUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGdhcGkuYXV0aDIuYXV0aG9yaXplKHtcclxuICAgICAgICAgIGNsaWVudF9pZDogV2ViQ2xpZW50SWQsXHJcbiAgICAgICAgICBzY29wZTogU0NPUEVTLFxyXG4gICAgICAgICAgcmVzcG9uc2VfdHlwZTogJ3Blcm1pc3Npb24nLFxyXG4gICAgICAgICAgbG9naW5faGludDogZW52LmN1cnJlbnRVc2VyLm1haWwsXHJcbiAgICAgICAgICBwcm9tcHQ6ICdub25lJ1xyXG4gICAgICAgIH0sIChyZXNwKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTtcclxuICAgICAgICAgIGlmIChyZXNwLmVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIG5vIGNvbnNlbnQgZ2l2ZW4gc28gcmVhdXRob3JpemVcclxuICAgICAgICAgICAgcmVhdXRob3JpemUgPSB0cnVlOyAgICAgICAgICAgIFxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgd2UgaGF2ZSBhbGwgdGhlIHNjb3BlcyB3ZSB3YW50XHJcbiAgICAgICAgICAgIGNvbnN0IHNjb3Blc2V0ID0gbmV3IFNldChyZXNwLnNjb3BlLnNwbGl0KCcgJykpO1xyXG4gICAgICAgICAgICBjb25zdCBtaXNzaW5nU2NvcGVzID0gdGhpcy5zY29wZXMuZmlsdGVyKHggPT4gIXNjb3Blc2V0Lmhhcyh4KSk7XHJcbiAgICAgICAgICAgIGlmIChtaXNzaW5nU2NvcGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbWlzc2luZyBzY29wZXMnKTtcclxuICAgICAgICAgICAgICAvLyBzY29wZXMgYXJlIG1pc3NpbmcgZnJvbSBvdXIgY29uc2VudCBzbyByZWF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgIHJlYXV0aG9yaXplID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAvLyBldmVyeXRoaW5nIHNlZW1zIHRvIGJlIG9rIHNvIHN0b3JlIG91ciB0b2tlblxyXG4gICAgICAgICAgICAgIHRoaXMuYXV0aFRva2VuID0gcmVzcC5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKHJlYXV0aG9yaXplKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWF1dGhvcml6ZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gZ2FwaS5hdXRoMi5hdXRob3JpemUoe1xyXG4gICAgICAgICAgICAgIGNsaWVudF9pZDogV2ViQ2xpZW50SWQsXHJcbiAgICAgICAgICAgICAgc2NvcGU6IFNDT1BFUyxcclxuICAgICAgICAgICAgICByZXNwb25zZV90eXBlOiAncGVybWlzc2lvbicsXHJcbiAgICAgICAgICAgICAgbG9naW5faGludDogZW52LmN1cnJlbnRVc2VyLm1haWwsXHJcbiAgICAgICAgICAgICAgcHJvbXB0OiAnY29uc2VudCdcclxuICAgICAgICAgICAgfSwgKHJlc3ApID0+IHtcclxuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTtcclxuICAgICAgICAgICAgICBpZiAocmVzcC5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgLy8gc29tZXRoaW5nIGlzIHN0aWxsIHdyb25nIHNvIHRocm93IGFuIGVycm9yXHJcbiAgICAgICAgICAgICAgICByZWplY3QoJ0dvb2dsZSBXZWIgQ2xpZW50OiBObyBhY2Nlc3MgdG9rZW4nKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gd2Ugbm93IGhhdmUgYSB0b2tlbiAoaG9wZWZ1bGx5IHdpdGggdGhlIHJpZ2h0IHNjb3BlcylcclxuICAgICAgICAgICAgICAgIC8vIHNob3VsZCB3ZSBjaGVjayBhZ2Fpbj9cclxuICAgICAgICAgICAgICAgIHRoaXMuYXV0aFRva2VuID0gcmVzcC5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAocmVzcC5leHBpcmVzX2luIDwgNTAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnYXBpLmF1dGgyLmF1dGhvcml6ZSh7XHJcbiAgICAgICAgICAgICAgY2xpZW50X2lkOiBXZWJDbGllbnRJZCxcclxuICAgICAgICAgICAgICBzY29wZTogU0NPUEVTLFxyXG4gICAgICAgICAgICAgIHJlc3BvbnNlX3R5cGU6ICdwZXJtaXNzaW9uJyxcclxuICAgICAgICAgICAgICBsb2dpbl9oaW50OiBlbnYuY3VycmVudFVzZXIubWFpbCxcclxuICAgICAgICAgICAgICBwcm9tcHQ6ICdub25lJ1xyXG4gICAgICAgICAgICB9LCAocmVzcCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuYXV0aFRva2VuID0gcmVzcC5hY2Nlc3NfdG9rZW47XHJcbiAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBMb2FkIFBpY2tlciBBUElcclxuICAgIGlmICh0eXBlb2YgZ29vZ2xlID09PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiBnb29nbGUucGlja2VyID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xyXG4gICAgICAgIGdhcGkubG9hZChcInBpY2tlclwiLCAoKSA9PiB7IHJlc29sdmUoKSB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHJcbiAgbG9hZEdhcGkoKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBpZiAodHlwZW9mIGdhcGkgIT09IFwidW5kZWZpbmVkXCIpIHJldHVybiByZXNvbHZlKCk7XHJcbiAgICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XHJcbiAgICAgIHNjcmlwdC5zcmMgPSBcImh0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL2NsaWVudC5qcz9vbmxvYWQ9Z2FhcGlfbG9hZGVkXCI7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChzY3JpcHQpO1xyXG4gICAgICAod2luZG93IGFzIGFueSkuZ2FhcGlfbG9hZGVkID0gcmVzb2x2ZTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gY291cnNlTmFtZVRvQ3NzQ2xhc3MoY3NzUHJlZml4OiBzdHJpbmcsIGNvdXJzZU5hbWU6IHN0cmluZykge1xyXG4gIHJldHVybiBgJHtjc3NQcmVmaXh9JHtjb3Vyc2VOYW1lLnN1YnN0cigwLDMpLnRvTG93ZXJDYXNlKCl9YDtcclxufVxyXG4iLCJpbXBvcnQgeyBVc2VyVGFza3NCb3hQcm9wcyB9IGZyb20gXCIuLi93ZWVrcGxhbm5lci91c2VyLXRhc2tzLWJveFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhKHRhc2tTZXRzOiBQYXJ0aWFsPFVzZXJUYXNrc0JveFByb3BzPltdKSB7XHJcbiAgICB2YXIgY2hhcnRUYXNrczoge1xyXG4gICAgICAgIGNvbXBsZXRlZFRhc2tzOiBudW1iZXIsIFxyXG4gICAgICAgIHRvdGFsTnVtYmVyT2ZUYXNrczogbnVtYmVyLFxyXG4gICAgICAgIHN1YmplY3REYXRhOiB7XHJcbiAgICAgICAgICAgIFtjb2x1bW5IZWFkZXI6IHN0cmluZ106IHsgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogbnVtYmVyLCBudW1iZXJPZlRhc2tzOiBudW1iZXIgfVxyXG4gICAgICAgIH1cclxuICAgIH0gPSB7Y29tcGxldGVkVGFza3M6IDAsIHRvdGFsTnVtYmVyT2ZUYXNrczogMCAsIHN1YmplY3REYXRhOiB7fX07XHJcblxyXG4gICAgdGFza1NldHMuZm9yRWFjaChlbGVtID0+IGVsZW0ubGVhcm5pbmdHb2Fscy5mb3JFYWNoKHggPT4ge1xyXG4gICAgICAgIHZhciBzdWJqZWN0Q29tcGxldGVkVGFza3MgPSB4LnRhc2tzLmZpbHRlcih0ID0+IHQuZG9uZSkubGVuZ3RoO1xyXG4gICAgICAgIGxldCBjb3Vyc2VTdWJqZWN0RGF0YSA9IGNoYXJ0VGFza3Muc3ViamVjdERhdGFbZWxlbS5jb3Vyc2VOYW1lXTtcclxuICAgICAgICBpZiAoIWNvdXJzZVN1YmplY3REYXRhKSB7XHJcbiAgICAgICAgICAgIGNvdXJzZVN1YmplY3REYXRhID0gY2hhcnRUYXNrcy5zdWJqZWN0RGF0YVtlbGVtLmNvdXJzZU5hbWVdID0ge1xyXG4gICAgICAgICAgICAgICAgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogMCxcclxuICAgICAgICAgICAgICAgIG51bWJlck9mVGFza3M6IDBcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY291cnNlU3ViamVjdERhdGEuY29tcGxldGVkTnVtYmVyT2ZUYXNrcyArPSBzdWJqZWN0Q29tcGxldGVkVGFza3M7XHJcbiAgICAgICAgY291cnNlU3ViamVjdERhdGEubnVtYmVyT2ZUYXNrcyArPSB4LnRhc2tzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgY2hhcnRUYXNrcy5jb21wbGV0ZWRUYXNrcyArPSBzdWJqZWN0Q29tcGxldGVkVGFza3M7XHJcbiAgICAgICAgY2hhcnRUYXNrcy50b3RhbE51bWJlck9mVGFza3MgKz0geC50YXNrcy5sZW5ndGg7XHJcbiAgICB9KSk7XHJcbiAgICByZXR1cm4gY2hhcnRUYXNrcztcclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgICBudW1iZXJPZlRhc2tzOiBudW1iZXI7XHJcbiAgICBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXI7XHJcbiAgICBtYXhpbXVtVGFza3NEaXNwbGF5ZWQ/OiBudW1iZXI7XHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmc7XHJcbiAgICBwcm9ncmVzc0NvbG9yPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgR29hbFByb2dyZXNzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgICBwdWJsaWMgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBudW1iZXJvZlRhc2tzOiAwLFxyXG4gICAgICAgIGNvbXBsZXRlZE51bWJlck9mVGFza3M6IDAsXHJcbiAgICAgICAgbWF4aW11bVRhc2tzRGlzcGxheWVkOiAxMCxcclxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwibGlnaHRncmV5XCIsXHJcbiAgICAgICAgcHJvZ3Jlc3NDb2xvcjogXCIjM2RiY2EyXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIGNyZWF0ZVByb2dyZXNzID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgbnVtYmVyT2ZUYXNrcywgY29tcGxldGVkTnVtYmVyT2ZUYXNrcywgbWF4aW11bVRhc2tzRGlzcGxheWVkLCBiYWNrZ3JvdW5kQ29sb3IsIHByb2dyZXNzQ29sb3IgfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgbGV0IHByb2dyZXNzID0gW107XHJcbiAgICAgICAgaWYobnVtYmVyT2ZUYXNrcyA+IG1heGltdW1UYXNrc0Rpc3BsYXllZCl7XHJcbiAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwicHJvZ3Jlc3Mtb3ZlcnZpZXdcIj4ge2NvbXBsZXRlZE51bWJlck9mVGFza3N9IC8ge251bWJlck9mVGFza3N9IDwvZGl2PjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IHRhc2tObyA9IDE7IHRhc2tObyA8PSBudW1iZXJPZlRhc2tzOyB0YXNrTm8rKykge1xyXG4gICAgICAgICAgICBwcm9ncmVzcy5wdXNoKFxyXG4gICAgICAgICAgICA8c3ZnIGtleT17dGFza05vfT5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3NOYW1lPVwiY2lyY2xlLWNoYXJ0LWJhY2tncm91bmRcIiBmaWxsPXt0YXNrTm8gPiBjb21wbGV0ZWROdW1iZXJPZlRhc2tzID8gYmFja2dyb3VuZENvbG9yIDogcHJvZ3Jlc3NDb2xvcn0gY3g9XCI4XCIgY3k9XCI4XCIgcj1cIjhcIiAvPlxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByb2dyZXNzO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpeyAgXHJcbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZ29hbHMtcHJvZ3Jlc3NcIj57dGhpcy5jcmVhdGVQcm9ncmVzcygpfTwvZGl2PlxyXG4gICAgfVxyXG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICAgIHBlcmNlbnRhZ2U6IG51bWJlcjtcclxuICAgIGJhY2tncm91bmRDb2xvcj86IHN0cmluZztcclxuICAgIHByb2dyZXNzQ29sb3I/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQcm9ncmVzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gICAgcHVibGljIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XHJcbiAgICAgICAgcGVyY2VudGFnZTogMCxcclxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI0YxRjVGNFwiLFxyXG4gICAgICAgIHByb2dyZXNzQ29sb3I6IFwiIzNkYmNhMlwiLFxyXG4gICAgfTtcclxuXHJcbiAgICByZW5kZXIoKXtcclxuICAgICAgICBjb25zdCB7cGVyY2VudGFnZSwgYmFja2dyb3VuZENvbG9yLCBwcm9ncmVzc0NvbG9yfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3Qgcm91bmRlZFBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKHBlcmNlbnRhZ2UpO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwicHJvZ3Jlc3MtY2hhcnRcIiB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIyNVwiPlxyXG4gICAgICAgICAgICA8cmVjdCBmaWxsPXtiYWNrZ3JvdW5kQ29sb3J9ICB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgcng9XCI0XCIvPlxyXG4gICAgICAgICAgICA8cmVjdCBjbGFzc05hbWU9XCJmaWxsXCIgZmlsbD17cHJvZ3Jlc3NDb2xvcn0gd2lkdGg9e2Ake3JvdW5kZWRQZXJjZW50YWdlfSVgfSBoZWlnaHQ9XCIxMDAlXCIgcng9XCI0XCIvPlxyXG4gICAgICAgICAgICA8dGV4dCBjbGFzc05hbWU9XCJmaWxsZWQtdGV4dFwiIHRleHRBbmNob3I9XCJtaWRkbGVcIiB4PVwiNTAlXCIgeT1cIjUwJVwiIGR5PVwiLjNlbVwiPntgJHtyb3VuZGVkUGVyY2VudGFnZX0lYH08L3RleHQ+XHRcclxuICAgICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBpc1RlYWNoZXJBdFNjaG9vbCB9IGZyb20gJy4uLy4uLy4uL2FjY2Vzcy1jb250cm9sJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VtcGxveWVlKGF0U2Nob29sPzogc3RyaW5nKSB7XHJcbiAgcmV0dXJuIGF0U2Nob29sID9cclxuICAgIGlzVGVhY2hlckF0U2Nob29sKGVudi5jdXJyZW50VXNlciwgYXRTY2hvb2wpIHx8IGVudi5jdXJyZW50VXNlci5yb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpIDpcclxuICAgIGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ0VNUExPWUVFJyB8fCByb2xlID09PSAnQURNSU4nKTtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgb25DbGljayxcclxuICBjbGFzc05hbWU/LFxyXG4gIHN0eWxlPyxcclxuICB0aXRsZT9cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBSZW1vdmVJdGVtID0gKHsgb25DbGljaywgY2xhc3NOYW1lLCBzdHlsZSwgdGl0bGUgfTogUHJvcHMpID0+XHJcblxyXG4gIDxkaXZcclxuICAgIHRpdGxlPXt0aXRsZSB8fCBMYFJhZGVyYWB9XHJcbiAgICBjbGFzc05hbWU9e1wicmVtb3ZlSXRlbSBcIiArIChjbGFzc05hbWUgfHwgXCJcIil9XHJcbiAgICBvbkNsaWNrPXtvbkNsaWNrfSBzdHlsZT17c3R5bGV9IC8+XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmV4cG9ydCBjb25zdCBTcGlubmVyID0gKCk9PiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYSBmYS1zcGlubmVyIGZhLXNwaW5cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+Jm5ic3A7PC9zcGFuPjtcclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBEb2N1bWVudCwgUmVzb3VyY2UsIE1vZGlmaWNhdGlvblRyYWNrZWQsIENvdXJzZSwgVGFzaywgU29mdERvY3VtZW50QWNjZXNzIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBCYXRjaFJ1bm5lciwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBnZXRGaXJzdEFuZExhc3RXZWVrT2ZUZXJtIH0gZnJvbSAnLi4vLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlRG9jdW1lbnRHcmFwaHMob2xkRG9jLCBuZXdEb2MsIHRhYmxlOiBzdHJpbmcsIGdyYXBoczogeyBbbGFiZWw6IHN0cmluZ106IHN0cmluZyB9LCBiYXRjaDogQmF0Y2hSdW5uZXIpIHtcclxuICBjb25zdCBkb2NVcGRhdGVzID0ge307XHJcbiAgY29uc3QgZG9jSWQgPSBuZXdEb2MuaWQ7XHJcbiAgZm9yIChsZXQgbmF2UHJvcCBvZiBPYmplY3Qua2V5cyhncmFwaHMpKSB7XHJcbiAgICBjb25zdCBmb3JlaWduVGFibGUgPSBncmFwaHNbbmF2UHJvcF07XHJcbiAgICBjb25zdCBvbGRMaXN0OiBEb2N1bWVudFtdID0gb2xkRG9jW25hdlByb3BdIHx8IFtdO1xyXG4gICAgY29uc3QgbmV3TGlzdDogRG9jdW1lbnRbXSA9IG5ld0RvY1tuYXZQcm9wXTtcclxuICAgIGlmICghbmV3TGlzdCkgY29udGludWU7XHJcbiAgICBjb25zdCB0dXBsZXMgPSBuZXdMaXN0XHJcbiAgICAgIC5tYXAoKGRvYywgaWR4KT0+KHtkb2MsIGlkeH0pKTsgLy8gQ3JlYXRlIHR1YmxlcyBvZiB7ZG9jLCBhcnJheS1pbmRleH0gc28gd2UgY2FuIHVwZGF0ZSByZXN1bHRcclxuICAgIGNvbnN0IGFkZGVkID0gdHVwbGVzLmZpbHRlcih0dXBsZSA9PiAhb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkKSk7IC8vIEZpbmQgYWRkZWQgaXRlbXNcclxuXHJcbiAgICBmb3IgKGxldCBhIG9mIGFkZGVkKSB7XHJcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4uYS5kb2N9O1xyXG4gICAgICBjb25zdCBtZXRhID0gbXV0YXRlZFN1YkRvYy4kbWV0YTtcclxuICAgICAgZGVsZXRlIG11dGF0ZWRTdWJEb2MuJG1ldGE7IC8vIERlbGV0ZSAkbWV0YSBzbyB0aGF0IFwiYWRkXCIgb3IgXCJ1cGRhdGVcIiBkb2VzIG5vdCBwZXJzaXN0ZSB0byBuZXh0IHN0YXRlLlxyXG4gICAgICBpZiAobWV0YSA9PT0gJ2FkZCcpIHtcclxuICAgICAgICBpZiAoIW11dGF0ZWRTdWJEb2MuaWQpIG11dGF0ZWRTdWJEb2MuaWQgPSBjcmVhdGVVVUlEKCk7IC8vIEdlbmVyYXRlIElEIGlmIG5vdCBkb25lIHlldC5cclxuICAgICAgICAvLyBOb3cgcHV0IGFuICdhZGQnIG11dGF0aW9uIGluIHRoZSBiYXRjaCBxdWV1ZS5cclxuICAgICAgICBiYXRjaC5hZGQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcclxuICAgICAgfSBlbHNlIGlmIChtZXRhID09PSAndXBkYXRlJykge1xyXG4gICAgICAgIGJhdGNoLnB1dChmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MpO1xyXG4gICAgICB9XHJcbiAgICAgIGJhdGNoLmxpbmsodGFibGUsIGRvY0lkLCBmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MuaWQsIG5hdlByb3ApO1xyXG5cclxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0IHN0YXRlIGlzIHJlZmxlY3RlZCBhZnRlciBzdWNjZXNmdWwgUE9TVCB0byBzZXJ2ZXIuXHJcbiAgICAgIGlmICghZG9jVXBkYXRlc1tuYXZQcm9wXSkgZG9jVXBkYXRlc1tuYXZQcm9wXSA9IHt9O1xyXG4gICAgICBkb2NVcGRhdGVzW25hdlByb3BdW2EuaWR4XSA9IHskc2V0OiBtdXRhdGVkU3ViRG9jfTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlbW92ZWQgPSBvbGRMaXN0LmZpbHRlcihvID0+ICFuZXdMaXN0LnNvbWUobiA9PiBuLmlkID09PSBvLmlkKSk7XHJcbiAgICBmb3IgKGxldCByIG9mIHJlbW92ZWQpIHtcclxuICAgICAgYmF0Y2gudW5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCByLmlkLCBuYXZQcm9wKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHVwZGF0ZWQgPSB0dXBsZXMuZmlsdGVyKHR1cGxlID0+IG9sZExpc3Quc29tZShvID0+IG8uaWQgPT09IHR1cGxlLmRvYy5pZCAmJiB0dXBsZS5kb2MuJG1ldGEgPT09ICd1cGRhdGUnKSk7XHJcbiAgICBmb3IgKGxldCB1IG9mIHVwZGF0ZWQpIHtcclxuICAgICAgY29uc3QgbXV0YXRlZFN1YkRvYyA9IHsuLi51LmRvY307XHJcbiAgICAgIGRlbGV0ZSBtdXRhdGVkU3ViRG9jLiRtZXRhO1xyXG4gICAgICBiYXRjaC5wdXQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcclxuXHJcbiAgICAgIC8vIFVwZGF0ZSByZXN1bHQgc28gdGhhdCAkbWV0YSBpcyByZW1vdmVkIGZyb20gbmF2aWdhdGlvbiBwcm9wIGFmdGVyIHN1Y2Nlc3NmdWwgUE9TVCB0byBzZXJ2ZXIuXHJcbiAgICAgIGlmICghZG9jVXBkYXRlc1tuYXZQcm9wXSkgZG9jVXBkYXRlc1tuYXZQcm9wXSA9IHt9O1xyXG4gICAgICBkb2NVcGRhdGVzW25hdlByb3BdW3UuaWR4XSA9IHskc2V0OiBtdXRhdGVkU3ViRG9jfTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHVwZGF0ZShuZXdEb2MsIGRvY1VwZGF0ZXMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZHRGb3JtYXQoZGF0ZVRpbWU6IG51bWJlciB8IERhdGUgfCBtb21lbnQuTW9tZW50KSB7XHJcbiAgcmV0dXJuIG1vbWVudChkYXRlVGltZSkuZm9ybWF0KCdZWU1NREQgSEg6bW0nKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3J0RGF0ZUZvcm1hdChkYXRlVGltZTogbnVtYmVyIHwgRGF0ZSB8IG1vbWVudC5Nb21lbnQpIHtcclxuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvcnRQZXJzb25OYW1lRm9ybWF0KG5hbWU6IHN0cmluZykge1xyXG4gIGlmICghbmFtZSkgcmV0dXJuIFwiXCI7XHJcbiAgY29uc3QgbmFtZXMgPSBuYW1lLnNwbGl0KCcgJykuZmlsdGVyKG4gPT4gISFuKTtcclxuICBjb25zdCBsYXN0TmFtZSA9IG5hbWVzLnBvcCgpO1xyXG4gIHJldHVybiBuYW1lcy5tYXAobmFtZSA9PiBgJHtuYW1lWzBdfS5gKS5jb25jYXQobGFzdE5hbWUpLmpvaW4oJyAnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wIChub3c6IG51bWJlciwgb2JqOiBNb2RpZmljYXRpb25UcmFja2VkLCB1c2VyOiBVc2VyKSB7XHJcbiAgcmV0dXJuIHVwZGF0ZShvYmosIHtcclxuICAgIGRhdGVUaW1lOiB7JHNldDogbm93fSwgLy8gRm9yIHF1ZXJpZXMuLi5cclxuICAgIG1vZGlmaWVkRGF0ZTogeyRzZXQ6IG5vd30sXHJcbiAgICBtb2RpZmllZEJ5OiB7XHJcbiAgICAgICRzZXQ6IHtcclxuICAgICAgICBuYW1lOiB1c2VyLmRpc3BsYXlOYW1lLFxyXG4gICAgICAgIHVybDogXCJtYWlsdG86XCIgKyB1c2VyLm1haWxcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ3JlYXRpb25TdGFtcDxUIGV4dGVuZHMgTW9kaWZpY2F0aW9uVHJhY2tlZD4gKG5vdzogbnVtYmVyLCBvYmo6IFQsIHVzZXI6IFVzZXIpOiBUIHtcclxuICByZXR1cm4gdXBkYXRlKG9iaiwge1xyXG4gICAgY3JlYXRlZERhdGU6IHskc2V0OiBub3d9LFxyXG4gICAgY3JlYXRlZEJ5OiB7XHJcbiAgICAgICRzZXQ6IHtcclxuICAgICAgICBuYW1lOiB1c2VyLmRpc3BsYXlOYW1lLFxyXG4gICAgICAgIHVybDogXCJtYWlsdG86XCIgKyB1c2VyLm1haWxcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW1haWxGcm9tRG9jQWNjZXNzIChyZXNvdXJjZTogU29mdERvY3VtZW50QWNjZXNzKSB7XHJcbiAgaWYgKHJlc291cmNlLmVtYWlsKSByZXR1cm4gcmVzb3VyY2UuZW1haWw7XHJcbiAgcmV0dXJuIHJlc291cmNlLnVybCA/XHJcbiAgICByZXNvdXJjZS51cmwuc3RhcnRzV2l0aCgnbWFpbHRvOicpID9cclxuICAgICAgcmVzb3VyY2UudXJsLnN1YnN0cmluZygnbWFpbHRvOicubGVuZ3RoKSA6XHJcbiAgICAgIHJlc291cmNlLnVybCA6XHJcbiAgICByZXNvdXJjZS51cmw7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhvYmo6IE1vZGlmaWNhdGlvblRyYWNrZWQsIHVzZXI6IFVzZXIpIHtcclxuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gIG9iaiA9IHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wKG5vdywgb2JqLCB1c2VyKTtcclxuICBpZiAoIW9iai5jcmVhdGVkQnkpIG9iaiA9IHVwZGF0ZUNyZWF0aW9uU3RhbXAobm93LCBvYmosIHVzZXIpO1xyXG4gIHJldHVybiBvYmo7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcHBseUV0YWdzKGRvYzogRG9jdW1lbnQsIG5ld0V0YWdzOiB7W2lkOiBzdHJpbmddOiBzdHJpbmd9LCBncmFwaHM6IHN0cmluZ1tdKSB7XHJcbiAgY29uc3QgcmVzID0gey4uLmRvY307XHJcbiAgY29uc3QgZXRhZyA9IG5ld0V0YWdzW2RvYy5pZF07XHJcbiAgaWYgKGV0YWcpXHJcbiAgICByZXMuJGV0YWcgPSBldGFnO1xyXG4gIGZvciAobGV0IGxhYmVsIG9mIGdyYXBocykge1xyXG4gICAgY29uc3QgbmV3TGlzdCA9IGRvY1tsYWJlbF0ubWFwKGQgPT4gYXBwbHlFdGFncyhkLCBuZXdFdGFncywgW10pKTtcclxuICAgIHJlc1tsYWJlbF0gPSBuZXdMaXN0O1xyXG4gIH1cclxuICByZXR1cm4gcmVzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2IoYmxvYjogQmxvYiwgbTogKHI6RmlsZVJlYWRlcik9PnZvaWQpIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuICAgIHJlYWRlci5vbmxvYWQgPSBldiA9PiByZXNvbHZlKChldi50YXJnZXQgYXMgYW55KS5yZXN1bHQpO1xyXG4gICAgcmVhZGVyLm9uYWJvcnQgPSBldiA9PiByZWplY3QobmV3IEVycm9yKFwiZmlsZSByZWFkIGFib3J0ZWRcIikpO1xyXG4gICAgcmVhZGVyLm9uZXJyb3IgPSBldiA9PiByZWplY3QoKGV2LnRhcmdldCBhcyBhbnkpLmVycm9yKTtcclxuICAgIG0ocmVhZGVyKTtcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0IChibG9iOiBCbG9iKSB7XHJcbiAgcmV0dXJuIHJlYWRCbG9iKGJsb2IsIHI9PnIucmVhZEFzVGV4dChibG9iKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYkFzRGF0YVVybCAoYmxvYjogQmxvYikge1xyXG4gIHJldHVybiByZWFkQmxvYihibG9iLCByPT5yLnJlYWRBc0RhdGFVUkwoYmxvYikpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWxsb3dDb3B5KGU6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcclxuICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cyhzdGF0dXM6ICd1bnNhdmVkJyB8ICdzYXZlZCcgfCAnZXJyb3InIHwgJycpIHtcclxuICBjb25zdCBkaXYgPSAkKCdkaXYuY291cnNlLWJ1aWxkZXInKVswXTtcclxuICBpZiAoZGl2KSBkaXYuY2xhc3NOYW1lID0gXCJjb3Vyc2UtYnVpbGRlclwiICsgKHN0YXR1cyA/IFwiIHN0YXR1cyBcIiArIHN0YXR1cyA6IFwiXCIpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZENvdXJzZShpZDogc3RyaW5nLCBvcHRpb25zPzoge1xyXG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4/OiBib29sZWFuLFxyXG4gICAgaW5jbHVkZT86IHN0cmluZ1tdXHJcbiAgfSk6IFByb21pc2U8Q291cnNlPlxyXG57XHJcbiAgY29uc3QgY2xpZW50ID0gZW52LmtlZEJhY2tlbmRDbGllbnQ7XHJcbiAgY29uc3QgaW5jbHVkZVRlbXBsYXRlQ2hhaW4gPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZVRlbXBsYXRlQ2hhaW47XHJcbiAgY29uc3QgaW5jbHVkZVRhc2tzID0gIW9wdGlvbnMgfHwgIW9wdGlvbnMuaW5jbHVkZSB8fCBvcHRpb25zLmluY2x1ZGUuaW5kZXhPZihcInRhc2tzXCIpICE9PSAtMTtcclxuICBjb25zdCBbY291cnNlLCBjb3Vyc2VUYXNrcywgdGVtcGxhdGVDaGFpbl0gPSAoYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgY2xpZW50LmdldChcImNvdXJzZXNcIiwgaWQsIHtcclxuICAgICAgaW5jbHVkZTogb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGUgPyBvcHRpb25zLmluY2x1ZGUuZmlsdGVyKGkgPT4gaSAhPT0gXCJ0YXNrc1wiKSA6IFtcclxuICAgICAgICBcImNlbnRyYWxDb250ZW50XCIsXHJcbiAgICAgICAgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIixcclxuICAgICAgICBcImFiaWxpdGllc1wiLFxyXG4gICAgICAgIFwiaW1hZ2VzXCIsXHJcbiAgICAgICAgXCJhY2xcIiAvLyBEb24ndCBpbmNsdWRlIHRhc2tzIGhlcmUuLi5cclxuICAgICAgXVxyXG4gICAgfSksXHJcbiAgICAvLyAuLi4gYnV0IGluY2x1ZGUgdGFza3MgaGVyZSBpbnN0ZWFkIHNvIHRoYXQgd2UgY2FuIGxvYWQgdGhlIGdyYXBocyBmb3IgdGhlXHJcbiAgICAvLyB0YXNrcyBhcyB3ZWxsIVxyXG4gICAgaW5jbHVkZVRhc2tzICYmIGNsaWVudC5saXN0KFwidGFza3NcIiwge1xyXG4gICAgICBoYXNFZGdlc0Zyb206IGlkLFxyXG4gICAgICBpbmNsdWRlOiBbJ2tub3dsZWRnZVJlcXVpcmVtZW50cycsICdjZW50cmFsQ29udGVudCcsICdhYmlsaXRpZXMnLCAnYWNsJ10sXHJcbiAgICAgIGZsYWdzOiBbJ2luY2x1ZGVJZHNPbmx5J10gLy8gRG9uJ3QgbmVlZCByZWR1bmRhbnQgaW5mbyB0aGF0J3MgYWxyZWFkeSBvbiBjb3Vyc2VcclxuICAgIH0pLFxyXG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4gJiYgY2xpZW50Lmxpc3QoXCJjb3Vyc2VzXCIsIHtcclxuICAgICAgaGFzRWRnZXNGcm9tOiBpZCxcclxuICAgICAgZmxhZ3M6IFsnaWRzT25seSddXHJcbiAgICB9KVxyXG4gIF0pKSBhcyBbQ291cnNlLCBUYXNrW10sIENvdXJzZVtdXTtcclxuICBjb3Vyc2UudGFza3MgPSBjb3Vyc2VUYXNrcztcclxuXHJcbiAgLy8gQ29ycmVjdCB0aGUgb3JkZXIgb2YgQWJpbGl0aWVzXHJcbiAgaWYgKGNvdXJzZS5hYmlsaXRpZXMgJiYgY291cnNlLmFiaWxpdGllc09yZGVyKSB7XHJcbiAgICBjb3Vyc2UuYWJpbGl0aWVzID0gY291cnNlLmFiaWxpdGllc09yZGVyLm1hcChpZCA9PlxyXG4gICAgICBjb3Vyc2UuYWJpbGl0aWVzLmZpbmQoYSA9PiBhLmlkID09PSBpZCkpO1xyXG4gIH1cclxuXHJcbiAgLy8gQ29ycmVjdCB0aGUgb3JkZXIgb2YgS25vd2xlZGdlUmVxdWlyZW1lbnRzXHJcbiAgaWYgKGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMgJiYgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyKSB7XHJcbiAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzID0gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyLm1hcChpZCA9PlxyXG4gICAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZpbmQoYyA9PiBjLmlkID09PSBpZCkpO1xyXG4gIH1cclxuXHJcbiAgLy8gQ29ycmVjdCB0aGUgb3JkZXIgb2YgQ2VudHJhbENvbnRlbnRcclxuICBpZiAoY291cnNlLmNlbnRyYWxDb250ZW50ICYmIGNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyKSB7XHJcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQgPSBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlci5tYXAoaWQgPT5cclxuICAgICAgY291cnNlLmNlbnRyYWxDb250ZW50LmZpbmQoY2MgPT4gY2MuaWQgPT09IGlkKSk7Ly8uZmlsdGVyKHggPT4gISF4KTsvLyBEZWJ1Z2dpbmcgc29tdGhpbicgLiBOb3JtYWxseSB0aGUgbGFzdCAuZmlsdGVyKCkuLi4gcGFydCBzaG91bGQgbm90IGJlIG5lc2Nlc3NhcnkuLi5cclxuICB9XHJcbiAgXHJcbiAgLy8gSW5jbHVkZSB0ZW1wbGF0ZSBjaGFpbiBpZiByZXF1ZXN0ZWQuXHJcbiAgaWYgKGluY2x1ZGVUZW1wbGF0ZUNoYWluKSBjb3Vyc2UudGVtcGxhdGVDaGFpbiA9IHRlbXBsYXRlQ2hhaW47XHJcbiAgcmV0dXJuIGNvdXJzZTtcclxufVxyXG5cclxuLy8gQ2hlY2sgZGlmZmVyZW5jZXMgYmV0d2VlbiB0d28gYXJyYXkgb2YgdHlwZSBUXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNDaGFuZ2VzKG9yaWdpbmFsVmFsdWVzOiBBcnJheTxhbnk+LCBjdXJyZW50VmFsdWVzOiBBcnJheTxhbnk+KTogYm9vbGVhbntcclxuICByZXR1cm4gb3JpZ2luYWxWYWx1ZXMgPT09IHVuZGVmaW5lZCB8fCBjdXJyZW50VmFsdWVzLmZpbHRlcigoeCkgPT4gIW9yaWdpbmFsVmFsdWVzLmluY2x1ZGVzKHgpKS5sZW5ndGggPiAwIHx8IG9yaWdpbmFsVmFsdWVzLmZpbHRlcigoeCkgPT4gIWN1cnJlbnRWYWx1ZXMuaW5jbHVkZXMoeCkpLmxlbmd0aCA+IDA7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG50eXBlIENhbGxiYWNrID0gKCk9PnZvaWQ7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmcsXHJcbiAgYmFja2dyb3VuZEltYWdlOiBzdHJpbmcsXHJcbiAgdGFiczoge25hbWU6IHN0cmluZyB8IEpTWC5FbGVtZW50LCBrZXk/OiBzdHJpbmcsIGxpbms6IHN0cmluZ31bXSxcclxuICBhY3RpdmVUYWI6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQ291cnNlQmFubmVyID0gKHByb3BzOiBQcm9wcykgPT4ge1xyXG4gIGNvbnN0IHsgdGl0bGUsIGJhY2tncm91bmRJbWFnZSwgdGFicywgYWN0aXZlVGFiIH0gPSBwcm9wcztcclxuXHJcbiAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytc2NyaXB0LXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIHtiYWNrZ3JvdW5kSW1hZ2UgJiYgPHN0eWxlPntgXHJcbiAgICAgICAgLnBhZ2VIZWFkZXIge1xyXG4gICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCcke2JhY2tncm91bmRJbWFnZX0nKSAhaW1wb3J0YW50O1xyXG4gICAgICAgIH1cclxuICAgICAgYH08L3N0eWxlPn1cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2VIZWFkZXJcIj5cclxuICAgICAgICAgIDxhPlxyXG4gICAgICAgICAgICA8aDE+e3RpdGxlfTwvaDE+XHJcbiAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbnNGaWVsZFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbnNDb250YWluZXJcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj48L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0naG9yaXpvbnRhbE1lbnUnPlxyXG4gICAgICAgICAgICAgICAgPHVsPlxyXG4gICAgICAgICAgICAgICAgICB7dGFicy5tYXAoKHtuYW1lLCBrZXksIGxpbmt9LCBpZHgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FjdGl2ZSA9IGFjdGl2ZVRhYiA9PT0gbGluaztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGxpIGtleT17a2V5IHx8ICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgPyBuYW1lIDogaWR4KX0gY2xhc3NOYW1lPXtpc0FjdGl2ZSA/IFwiYWN0aXZlUGFnZVwiIDogXCJcIn0+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtsaW5rfT57bmFtZX08L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgICAgICA8L3VsPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIDwvZGl2PlxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCwgYXJyYXlUb0xvb2t1cCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IEtub3dsZWRnZVJlcXVpcmVtZW50c0JveCB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2tub3dsZWRnZS1yZXF1aXJlbWVudHMtdGFibGVcIjtcclxuaW1wb3J0IGdldEluY2x1ZGVkSWRzIGZyb20gJy4uL3V0aWxzL2dldC1pbmNsdWRlZC1pZHMnO1xyXG5pbXBvcnQgeyBBYmlsaXRpZXNCb3ggfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9hYmlsaXRpZXMtYm94XCI7XHJcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveFwiO1xyXG5pbXBvcnQgeyBMZWFybmluZ0dvYWxzTGlzdCB9IGZyb20gJy4uL3N1YmNvbXBvbmVudHMvbGVhcm5pbmctZ29hbHMtbGlzdCc7XHJcbmltcG9ydCB7IFRhc2tMaXN0IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy90YXNrLWxpc3QnO1xyXG5pbXBvcnQgeyBnZXRDdXN0b21pemVkVGFzayB9IGZyb20gJy4vZ2V0LWN1c3RvbWl6ZWQtdGFzayc7XHJcblxyXG4vLyBWaWV3c1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBtb2R1bGU6IENvdXJzZU1vZHVsZTtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvdXJzZU1vZHVsZVBhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBtb2R1bGUsIGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IGluY2x1ZWRJZHMgPSBnZXRJbmNsdWRlZElkcyhtb2R1bGUsIGNvdXJzZSk7XHJcbiAgICBjb25zdCBsZWFybmluZ1Rhc2tzID0gbW9kdWxlLnRhc2tJZHNcclxuICAgICAgLm1hcChpZCA9PiBjb3Vyc2UudGFza3MuZmluZCh0ID0+IHQuaWQgPT09IGlkKSlcclxuICAgICAgLmZpbHRlcih0YXNrID0+ICEhdGFzaylcclxuICAgICAgLm1hcCh0YXNrID0+ICh7XHJcbiAgICAgICAgaWQ6IHRhc2suaWQsXHJcbiAgICAgICAgdGFzazogZ2V0Q3VzdG9taXplZFRhc2sobW9kdWxlLCB0YXNrKSxcclxuICAgICAgICBjb3Vyc2UsXHJcbiAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgIHVybDogYCMke2VuY29kZVVSSUNvbXBvbmVudChtb2R1bGUubmFtZS50cmltKCkpfS8ke3Rhc2suaWR9YCwgLy8gRsO2cnPDpHR0c2JsYWRldHMgVVJMXHJcbiAgICAgICAgY291cnNlTmFtZTogY291cnNlLm5hbWUsXHJcbiAgICAgICAgbGVhcm5pbmdHb2FsOiB0YXNrLmxlYXJuaW5nR29hbCB8fCBtb2R1bGUubmFtZSxcclxuICAgICAgfSkpO1xyXG4gICAgY29uc3QgYXNzaWdubWVudFRhc2tzID0gbGVhcm5pbmdUYXNrcy5maWx0ZXIodCA9PiB0LnRhc2sgJiYgdC50YXNrLmFzc2lnbm1lbnQpO1xyXG4gICAgY29uc3Qgbm9uQXNzaWdubWVudFRhc2tzID0gbGVhcm5pbmdUYXNrcy5maWx0ZXIodCA9PiAhdC50YXNrIHx8ICF0LnRhc2suYXNzaWdubWVudCk7XHJcbiAgICBjb25zdCBjb21tb25UYXNrcyA9IG5vbkFzc2lnbm1lbnRUYXNrcy5maWx0ZXIodCA9PiAhdC50YXNrLmxlYXJuaW5nR29hbCk7XHJcbiAgICBjb25zdCBsZWFybmluZ0dvYWxzID0gYXJyYXlUb0xvb2t1cChcclxuICAgICAgbm9uQXNzaWdubWVudFRhc2tzLmZpbHRlcih0ID0+ICEhdC50YXNrLmxlYXJuaW5nR29hbCksXHJcbiAgICAgIHQgPT4gdC5sZWFybmluZ0dvYWwpO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdGV4dC1wb3J0bGV0IHN2LXVzZS1tYXJnaW5zIHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxyXG4gICAgICAgICAgPGgxIGNsYXNzTmFtZT1cImgxXCI+e21vZHVsZS5uYW1lfTwvaDE+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXZlcnRpY2FsIHN2LWxheW91dFwiPlxyXG4gICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiBtb2R1bGUubWFuZGF0b3J5Q29udGVudCB9fT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgICAgIDxoMz5Nb2R1bGVucyBrdW5za2Fwc2tyYXYsIGbDtnJtw6Vnb3Igb2NoIGNlbnRyYWxhIGlubmVow6VsbDwvaDM+XHJcbiAgICAgICAgICB7KCEhbW9kdWxlLnN0YXJ0V2VlayB8fCAhIW1vZHVsZS5lbmRXZWVrKSAmJiA8ZGl2IGNsYXNzTmFtZT1cIndlZWstcGVyaW9kLWRpdlwiPlxyXG4gICAgICAgICAgICA8ZGl2PlN0YXJ0dmVja2E8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdj57bW9kdWxlLnN0YXJ0V2VlayB8fCBcIi0tXCJ9PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXY+U2x1dHZlY2thPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXY+e21vZHVsZS5lbmRXZWVrIHx8IFwiLS1cIn08L2Rpdj5cclxuICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICA8aHIgLz5cclxuXHJcbiAgICAgICAgICA8S25vd2xlZGdlUmVxdWlyZW1lbnRzQm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiSSBkZW4gaMOkciBtb2R1bGVuIGJlZMO2bXMgZsO2bGphbmRlIGt1bnNrYXBza3JhdlwiXHJcbiAgICAgICAgICAgIHJlcXVpcmVtZW50cz17Y291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c31cclxuICAgICAgICAgICAgaW5jbHVkZWRJZHM9e2luY2x1ZWRJZHN9IC8+XHJcblxyXG4gICAgICAgICAgPEFiaWxpdGllc0JveFxyXG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIG1vZHVsZW4gYmVoYW5kbGFyIGbDtmxqYW5kZSBmw7ZybcOlZ29yXCJcclxuICAgICAgICAgICAgYWJpbGl0aWVzPXtjb3Vyc2UuYWJpbGl0aWVzLmZpbHRlcihhID0+IGluY2x1ZWRJZHNbYS5pZF0pfSAvPlxyXG5cclxuICAgICAgICAgIDxDZW50cmFsQ29udGVudEJveFxyXG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIG1vZHVsZW4gYmVoYW5kbGFyIGbDtmxqYW5kZSBjZW50cmFsYSBpbm5laMOlbGxcIlxyXG4gICAgICAgICAgICBjZW50cmFsQ29udGVudD17Y291cnNlLmNlbnRyYWxDb250ZW50LmZpbHRlcihjID0+IGluY2x1ZWRJZHNbYy5pZF0pfSAvPlxyXG5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICB7bW9kdWxlLnRhc2tJZHMubGVuZ3RoID4gMCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiPlxyXG4gICAgICAgICAge2Fzc2lnbm1lbnRUYXNrcy5sZW5ndGggPT09IDAgPyB1bmRlZmluZWQgOiA8PlxyXG4gICAgICAgICAgICA8aDI+SW5sw6RtbmluZ3N1cHBnaWZ0ZXI8L2gyPlxyXG4gICAgICAgICAgICA8aHIgLz5cclxuICAgICAgICAgICAgPFRhc2tMaXN0IGxlYXJuaW5nVGFza3M9e2Fzc2lnbm1lbnRUYXNrc30gLz5cclxuICAgICAgICAgIDwvPn1cclxuICAgICAgICAgIHtub25Bc3NpZ25tZW50VGFza3MubGVuZ3RoID09PSAwID8gdW5kZWZpbmVkIDogPD5cclxuICAgICAgICAgICAgPGgyPlVwcGdpZnRlcjwvaDI+XHJcbiAgICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgICA8TGVhcm5pbmdHb2Fsc0xpc3RcclxuICAgICAgICAgICAgICBjb21tb25UYXNrcz17Y29tbW9uVGFza3N9XHJcbiAgICAgICAgICAgICAgbGVhcm5pbmdHb2Fscz17T2JqZWN0LmtleXMobGVhcm5pbmdHb2FscykubWFwKGxlYXJuaW5nR29hbCA9PiAoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbGVhcm5pbmdHb2FsLFxyXG4gICAgICAgICAgICAgICAgbGVhcm5pbmdUYXNrczogbGVhcm5pbmdHb2Fsc1tsZWFybmluZ0dvYWxdXHJcbiAgICAgICAgICAgICAgfSkpfSAvPlxyXG4gICAgICAgICAgICA8Lz59XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2Pn1cclxuICAgICAge21vZHVsZS5yZXNvdXJjZXMubGVuZ3RoID4gMCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgICAgIDxoMj5SZXN1cnNlcjwvaDI+XHJcbiAgICAgICAgICA8aHIgLz5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPnttb2R1bGUucmVzb3VyY2VzLm1hcCgociwgaWR4KSA9PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2lkeH0+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3IudXJsfT57ci5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+KX1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj59XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ291cnNlTW9kdWxlLCBUYXNrIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VzdG9taXplZFRhc2sobW9kdWxlOiBDb3Vyc2VNb2R1bGUsIHRhc2s6IFRhc2spIHtcclxuICByZXR1cm4gbW9kdWxlLnRhc2tDdXN0b21pemF0aW9ucyA/XHJcbiAgICB7Li4udGFzaywgLi4ubW9kdWxlLnRhc2tDdXN0b21pemF0aW9uc1t0YXNrLmlkXX0gOlxyXG4gICAgdGFzaztcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwsIHNob3dFcnJvciB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4vY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgcGFyc2VIYXNoUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XHJcbmltcG9ydCB7IENvdXJzZU1vZHVsZVBhZ2UgfSBmcm9tICcuL2NvdXJzZS1tb2R1bGUtcGFnZSc7XHJcbmltcG9ydCB7IFJ1blVwUGFnZSB9IGZyb20gJy4vcnVuLXVwLXBhZ2UnO1xyXG5pbXBvcnQgeyBpbml0TWFudWFsU2Nyb2xsUmVzdG9yYXRpb24sIHJlc3RvcmVTY3JvbGxQb3NpdGlvbiB9IGZyb20gJy4uL3V0aWxzL21hbnVhbC1zY3JvbGwtcmVzdG9yYXRpb24nO1xyXG5pbXBvcnQgeyBoYXNXcml0ZUFjY2VzcywgcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgfSBmcm9tICcuLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XHJcbmltcG9ydCB7IFdlZWtQbGFubmVyIH0gZnJvbSBcIi4uLy4uL3dlZWtwbGFubmVyXCI7XHJcbmltcG9ydCB7IFRhc2tQYWdlIH0gZnJvbSBcIi4vdGFzay1wYWdlXCI7XHJcbmltcG9ydCB7IGdldEN1c3RvbWl6ZWRUYXNrIH0gZnJvbSAnLi9nZXQtY3VzdG9taXplZC10YXNrJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBjb3Vyc2VCdWlsZGVyVXJsOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgbW9kdWxlOiBDb3Vyc2VNb2R1bGUgfCBudWxsO1xyXG4gIHRhc2s6IFRhc2sgfCBudWxsO1xyXG59XHJcblxyXG5cclxuaW5pdE1hbnVhbFNjcm9sbFJlc3RvcmF0aW9uKCk7XHJcblxyXG5leHBvcnQgY2xhc3MgQ291cnNlUGFnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5vbkhhc2hDaGFuZ2UgPSB0aGlzLm9uSGFzaENoYW5nZS5iaW5kKHRoaXMpO1xyXG4gICAgY29uc3Qge21vZHVsZSwgdGFza30gPSB0aGlzLmdldE1vZHVsZUFuZFRhc2tGcm9tSGFzaCgpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgbW9kdWxlLFxyXG4gICAgICB0YXNrXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0TW9kdWxlQW5kVGFza0Zyb21IYXNoKCkge1xyXG4gICAgbGV0IHNwbGl0ID0gKGxvY2F0aW9uLmhhc2guc3Vic3RyKDEpIHx8IFwiXCIpLnNwbGl0KCcvJyk7XHJcbiAgICBpZiAoc3BsaXQubGVuZ3RoID4gMCAmJiAhc3BsaXRbMF0pIHNwbGl0ID0gc3BsaXQuc2xpY2UoMSk7IC8vIEFsbG93IGxlYWRpbmcgc2xhc2ggIy9tb2R1bGUvdGFza1xyXG4gICAgY29uc3QgW21vZHVsZU5hbWUsIHRhc2tJZF0gPSBzcGxpdC5tYXAocGFydCA9PiBkZWNvZGVVUklDb21wb25lbnQocGFydCkpO1xyXG4gICAgbGV0IG1vZHVsZSA9IHRoaXMucHJvcHMuY291cnNlLm1vZHVsZXNcclxuICAgICAgLmZpbHRlcihtID0+IChtLm5hbWUgfHwgXCJcIilcclxuICAgICAgICAudHJpbSgpLnRvTG93ZXJDYXNlKCkgPT09IChtb2R1bGVOYW1lIHx8IFwiXCIpLnRyaW0oKS50b0xvd2VyQ2FzZSgpKVswXSB8fCBudWxsO1xyXG4gICAgbGV0IHRhc2sgPSB0YXNrSWQgP1xyXG4gICAgICB0aGlzLnByb3BzLmNvdXJzZS50YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKSB8fCBudWxsIDpcclxuICAgICAgbnVsbDtcclxuICAgIGlmICh0YXNrICYmICFtb2R1bGUpIHtcclxuICAgICAgLy8gUmVzb2x2ZSBtb2R1bGUgYnkgZmluZGluZyB0aGUgbW9kdWxlIHRoYXQgaG9sZHMgdGhlIHRhc2s6XHJcbiAgICAgIG1vZHVsZSA9IHRoaXMuZ2V0T3JkZXJlZE1vZHVsZXMoKVxyXG4gICAgICAgIC5maWx0ZXIobSA9PiBtLnRhc2tJZHNcclxuICAgICAgICAgIC5zb21lKHRhc2tJZCA9PiB0YXNrLmlkID09PSB0YXNrSWQpKVswXTtcclxuICAgIH1cclxuICAgIGlmICh0YXNrICYmIG1vZHVsZSkge1xyXG4gICAgICB0YXNrID0gZ2V0Q3VzdG9taXplZFRhc2sobW9kdWxlLCB0YXNrKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7bW9kdWxlLCB0YXNrfTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLm9uSGFzaENoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5vbkhhc2hDaGFuZ2UpO1xyXG4gIH1cclxuXHJcbiAgb25IYXNoQ2hhbmdlKCkge1xyXG4gICAgY29uc3Qge21vZHVsZSwgdGFza30gPSB0aGlzLmdldE1vZHVsZUFuZFRhc2tGcm9tSGFzaCgpO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgIG1vZHVsZSxcclxuICAgICAgdGFza1xyXG4gICAgfSwgKCk9PntcclxuICAgICAgXHJcbiAgICAgIGxldCBmYWxsYmFja1Njcm9sbFBvc2l0aW9uID0gdW5kZWZpbmVkO1xyXG4gICAgICBpZiAodGFzaykge1xyXG4gICAgICAgIGNvbnN0IHRhc2tBbmNob3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgna2VkLXRhc2stYW5jaG9yJyk7XHJcbiAgICAgICAgaWYgKHRhc2tBbmNob3IpIGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gPSAod2luZG93LnBhZ2VZT2Zmc2V0ICsgdGFza0FuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApO1xyXG4gICAgICAgIGVsc2UgZmFsbGJhY2tTY3JvbGxQb3NpdGlvbiA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgcmVzdG9yZVNjcm9sbFBvc2l0aW9uKHtmYWxsYmFja1Njcm9sbFBvc2l0aW9ufSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldE9yZGVyZWRNb2R1bGVzKCkge1xyXG4gICAgY29uc3QgeyBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCBtb2R1bGVPcmRlciA9IGNvdXJzZS5tb2R1bGVPcmRlciB8fCBjb3Vyc2UubW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcclxuICAgIHJldHVybiBtb2R1bGVPcmRlclxyXG4gICAgICAvLyBNYXAgb3JkZXJlZCBpZCB0byBtb2R1bGVcclxuICAgICAgLm1hcChpZCA9PiBjb3Vyc2UubW9kdWxlcy5maW5kKG0gPT4gbS5pZCA9PT0gaWQgJiYgIW0uaW5hY3RpdmUpKVxyXG4gICAgICAvLyBJZ25vcmUgZW50cmllcyB0aGF0IG9ubHkgZXhpc3RzIGluIG1vZHVsZU9yZGVyIGJ1dCBub3QgaW4gbW9kdWxlc1xyXG4gICAgICAuZmlsdGVyKG0gPT4gISFtKVxyXG4gICAgICAvLyBBcHBlbmQgbW9kdWxlcyBhdCBlbmQgdGhhdCBhcmUgbm90IGxpc3RlZCBpbiBtb2R1bGVPcmRlclxyXG4gICAgICAuY29uY2F0IChjb3Vyc2UubW9kdWxlcy5maWx0ZXIobSA9PiAhbW9kdWxlT3JkZXIuZmluZChpZCA9PiBtLmlkID09PSBpZCkpKTtcclxuICB9ICBcclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2NvdXJzZSwgY291cnNlQnVpbGRlclVybH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qge21vZHVsZSwgdGFza30gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3Qgb3JkZXJlZE1vZHVsZXMgPSB0aGlzLmdldE9yZGVyZWRNb2R1bGVzKCk7XHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPENvdXJzZUJhbm5lclxyXG4gICAgICAgIHRpdGxlPXtjb3Vyc2UubmFtZSArIFwiIC0gXCIgKyBjb3Vyc2UucG9pbnRzICsgXCJwXCJ9XHJcbiAgICAgICAgYmFja2dyb3VuZEltYWdlPXsoY291cnNlLmltYWdlcy5maW5kKGltZyA9PiBpbWcuaWQgPT09IGNvdXJzZS5pbWFnZUlkKSB8fCB7dXJsOicnfSkudXJsfVxyXG4gICAgICAgIHRhYnM9e1t7bmFtZTogXCJVcHB0YWt0XCIgYXMgc3RyaW5nIHwgSlNYLkVsZW1lbnQsIGxpbms6IFwiI1wiLCBrZXk6IFwiVXBwdGFrdFwifV1cclxuICAgICAgICAgIC5jb25jYXQob3JkZXJlZE1vZHVsZXMubWFwKCh7IG5hbWUgfSkgPT4gKHsgbmFtZSwgbGluazogXCIjXCIgKyBlbmNvZGVVUklDb21wb25lbnQobmFtZSksIGtleTogbmFtZSB9KSkpXHJcbiAgICAgICAgICAuY29uY2F0KGNvdXJzZS53b3JrRmxvd0xpbmsgPyBbe1xyXG4gICAgICAgICAgICBuYW1lOiBcIkFyYmV0c2fDpW5nXCIsXHJcbiAgICAgICAgICAgIGtleTogXCJ3b3JrZmxvd1wiLFxyXG4gICAgICAgICAgICBsaW5rOiBjb3Vyc2Uud29ya0Zsb3dMaW5rXHJcbiAgICAgICAgICB9XSA6IFtdKVxyXG4gICAgICAgICAgLmNvbmNhdChoYXNXcml0ZUFjY2VzcyhlbnYuY3VycmVudFVzZXIsIGNvdXJzZSkgPyBbe1xyXG4gICAgICAgICAgICBuYW1lOiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYSBmYS1wZW5jaWxcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IFJlZGlnZXJhIGRlbm5hIGt1cnM8L3NwYW4+LFxyXG4gICAgICAgICAgICBrZXk6IFwiZWRpdFwiLFxyXG4gICAgICAgICAgICBsaW5rOiBgJHtwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeShjb3Vyc2VCdWlsZGVyVXJsLCB7fSl9Iy9jb3Vyc2VzLyR7Y291cnNlLmlkfS9lZGl0YH1dIDogW10pXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBhY3RpdmVUYWI9e21vZHVsZSA/IFwiI1wiK2VuY29kZVVSSUNvbXBvbmVudChtb2R1bGUubmFtZSkgOiBcIiNcIn1cclxuICAgICAgLz5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0XCJcclxuICAgICAgICAvL2lkPVwia2VkLXRhc2stYW5jaG9yXCIgLy8gRm9yIHdpbmRvdy5zY3JvbGxUbyB0byBwb3NpdGlvbiBoZXJlIS4gU2tpcHBpbmcgdGhpcy4gc2Nyb2xsIHRvIHRvcCBpbnN0ZWFkIVxyXG4gICAgICA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNwYWNlci0yMHB4dnQgc3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZWNvbnRlbnQgc3YtbGF5b3V0IHN2LXNwYWNlci0yMHB4dnQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi03XCI+XHJcbiAgICAgICAgICAgICAgICAgIHt0YXNrID9cclxuICAgICAgICAgICAgICAgICAgICA8VGFza1BhZ2UgdGFzaz17dGFza30gY291cnNlPXtjb3Vyc2V9IC8+IDpcclxuICAgICAgICAgICAgICAgICAgIG1vZHVsZSA/XHJcbiAgICAgICAgICAgICAgICAgICAgPENvdXJzZU1vZHVsZVBhZ2UgY291cnNlPXtjb3Vyc2V9IG1vZHVsZT17bW9kdWxlfSAvPiA6XHJcbiAgICAgICAgICAgICAgICAgICAgPFJ1blVwUGFnZSBjb3Vyc2U9e2NvdXJzZX0gLz59XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LWNvbHVtbi01XCI+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPFdlZWtQbGFubmVyIHZpZXdDb3Vyc2VVcmw9eycnfSBlbnY9e2Vudn0vPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbi8vIFZpZXdzXHJcbmltcG9ydCB7IEFiaWxpdGllc0JveCB9IGZyb20gJy4uL3N1YmNvbXBvbmVudHMvYWJpbGl0aWVzLWJveCc7XHJcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy9jZW50cmFsLWNvbnRlbnQtYm94JztcclxuaW1wb3J0IHsgS25vd2xlZGdlUmVxdWlyZW1lbnRzQm94IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy9rbm93bGVkZ2UtcmVxdWlyZW1lbnRzLXRhYmxlJztcclxuaW1wb3J0IHsgUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy9yZXNvdXJjZS1saXN0JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgY291cnNlOiBDb3Vyc2U7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSdW5VcFBhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7fVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAge2NvdXJzZS5ydW5VcFRleHQgJiYgPGRpdj5cclxuICAgICAgICAgICAgPGgxPlVwcHRha3Q8L2gxPlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJub3JtYWxcIiBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogY291cnNlLnJ1blVwVGV4dH19IC8+XHJcbiAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICB7Y291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMgJiYgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMubGVuZ3RoID4gMCAmJiA8ZGl2PlxyXG4gICAgICAgICAgICA8aDI+TMOkcmFyZTwvaDI+XHJcbiAgICAgICAgICAgIHtjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycy5tYXAoKHRlYWNoZXIsIGkpID0+XHJcbiAgICAgICAgICAgICAgPHAga2V5PXtpfT48YSBocmVmPXtpbnRlcnByZXRUZWFjaGVyVXJsKHRlYWNoZXIuZW1haWwgfHwgdGVhY2hlci51cmwgfHwgJycpfT57dGVhY2hlci5uYW1lfTwvYT48L3A+XHJcbiAgICAgICAgICAgICl9XHJcbiAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICB7Y291cnNlLndvcmtGbG93TGluayAmJiA8YSBjbGFzc05hbWU9XCJidG5cIiBocmVmPXtjb3Vyc2Uud29ya0Zsb3dMaW5rfT5BcmJldHNnw6VuZzwvYT59XHJcbiAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgPEFiaWxpdGllc0JveFxyXG4gICAgICAgICAgICB0aXRsZT1cIsOEbW5ldHMgZsO2cm3DpWdvclwiXHJcbiAgICAgICAgICAgIHN1YlRpdGxlPVwiRsO2cm3DpWdvclwiXHJcbiAgICAgICAgICAgIGFiaWxpdGllcz17Y291cnNlLmFiaWxpdGllc31cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibGFyZ2VyXCIgLz5cclxuXHJcbiAgICAgICAgICA8Q2VudHJhbENvbnRlbnRCb3hcclxuICAgICAgICAgICAgdGl0bGU9XCJLdXJzZW5zIGNlbnRyYWxhIGlubmVow6VsbFwiXHJcbiAgICAgICAgICAgIHN1YlRpdGxlPVwiQ2VudHJhbHQgaW5uZWjDpWxsXCJcclxuICAgICAgICAgICAgY2VudHJhbENvbnRlbnQ9e2NvdXJzZS5jZW50cmFsQ29udGVudH1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibGFyZ2VyXCIgLz5cclxuXHJcbiAgICAgICAgICA8S25vd2xlZGdlUmVxdWlyZW1lbnRzQm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiS3Vyc2VucyBrdW5za2Fwc2tyYXZcIlxyXG4gICAgICAgICAgICByZXF1aXJlbWVudHM9e2NvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHN9XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiIC8+XHJcblxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIHtjb3Vyc2UucmVzb3VyY2VzLmxlbmd0aCA+IDAgJiYgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgICAgICAgPGgyPlJlc3Vyc2VyPC9oMj5cclxuICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICAgIDxSZXNvdXJjZUxpc3QgcmVzb3VyY2VzPXtjb3Vyc2UucmVzb3VyY2VzfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+fVxyXG4gICAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGludGVycHJldFRlYWNoZXJVcmwodXJsOiBzdHJpbmcpIHtcclxuICBpZiAodXJsLmluZGV4T2YoJzonKSA9PT0gLTEgJiYgdXJsLmluZGV4T2YoJ0AnKSA+PSAwKSByZXR1cm4gXCJtYWlsdG86XCIgKyB1cmw7XHJcbiAgcmV0dXJuIHVybDtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgQXNzaWdubWVudCwgVXJrdW5kUmVzcG9uc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IHNob3dFcnJvciwgY29tcGFyZVByb3BzIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgSHR0cEVycm9yLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBoYXNXcml0ZUFjY2VzcywgaXNUZWFjaGVyQXRTY2hvb2wgfSBmcm9tICcuLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XHJcbmltcG9ydCBkb3dubG9hZCBmcm9tICdkb3dubG9hZGpzJztcclxuaW1wb3J0IHtcclxuICBnZXRVcmt1bmRTaWduaWZpY2FuY2VDbGFzcyxcclxuICBnZXRVcmt1bmRTdGF0dXNDbGFzcyxcclxuICBnZXRVcmt1bmRIb3ZlclRleHR9IGZyb20gJy4vdXJrdW5kLXV0aWxzJztcclxuaW1wb3J0IHsgaXNFbXBsb3llZSB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyLWtzL2xvZ2ljL2lzLWVtcGxveWVlJztcclxuaW1wb3J0IHsgR29vZ2xlUGlja2VyIH0gZnJvbSAnLi4vLi4vLi4vYXBpcy9nb29nbGUtcGlja2VyJztcclxuaW1wb3J0IHsgRHJpdmVCdXR0b24gfSBmcm9tIFwiLi4vLi4vLi4vYXBpcy9idXR0b25zXCI7XHJcbmltcG9ydCB7IGZlYXR1cmVzIH0gZnJvbSAnLi4vLi4vLi4vZmVhdHVyZXMnO1xyXG5pbXBvcnQgeyBHb29nbGVEcml2ZSwgc2VsZWN0ZWRGaWxlIH0gZnJvbSAnLi4vLi4vLi4vYXBpcy9nb29nbGUtZHJpdmUnO1xyXG5cclxuY29uc3QgTUFYX1VSS1VORF9GSUxFX1NJWkVfTUIgPSA1MDtcclxuY29uc3QgTUFYX05PTlVSS1VORF9GSUxFX1NJWkVfTUIgPSAxMDA7XHJcbmNvbnN0IEFMTE9XRURfRVhURU5TSU9OUyA9IFtcclxuICBcIi5wZGZcIixcclxuICBcIi5vZHRcIixcclxuICBcIi5kb2N4XCIsXHJcbiAgXCIuZG9jXCIsXHJcbiAgXCIuY2FkXCIsXHJcbiAgXCIud2F2XCIsXHJcbiAgXCIubXAzXCIsXHJcbiAgXCIubXBlZzRcIixcclxuICBcIi5tcDRcIixcclxuICBcIi56aXBcIixcclxuICBcIi5wbmdcIixcclxuICBcIi5qcGdcIixcclxuICBcIi5qcGVnXCIsXHJcbiAgXCIuZ2lmXCJcclxuXTtcclxuY29uc3QgVVJLVU5EX0VYVEVOU0lPTlMgPSBbXHJcbiAgXCIucGRmXCIsXHJcbiAgXCIub2R0XCIsXHJcbiAgXCIuZG9jeFwiLFxyXG4gIFwiLmRvY1wiXHJcbl07XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNvdXJzZUlkOiBzdHJpbmc7XHJcbiAgdGFza0lkOiBzdHJpbmc7XHJcbiAgc2Nob29sOiBzdHJpbmc7XHJcbiAgc2VuZFRvVXJrdW5kOiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGFzc2lnbm1lbnRzOiBBc3NpZ25tZW50W107XHJcbiAgbG9hZGluZzogYm9vbGVhbjtcclxuICB1cGxvYWRpbmdGaWxlPzogRmlsZTtcclxuICBlcnJvcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRhc2tBc3NpZ25tZW50cyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGFzc2lnbm1lbnRzOiBbXSxcclxuICAgICAgbG9hZGluZzogdHJ1ZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFN0YXRlUHJvbWlzZWQoY2I6IChwcmV2U3RhdGU6IFJlYWRvbmx5PFN0YXRlPiwgcHJvcHM6IFByb3BzKSA9PiBQYXJ0aWFsPFN0YXRlPikge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3VwZXIuc2V0U3RhdGUoY2IgYXMgYW55LCByZXNvbHZlKSk7XHJcbiAgfSAgXHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdGhpcy5sb2FkKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChuZXh0UHJvcHMudGFza0lkICE9PSB0aGlzLnByb3BzLnRhc2tJZCB8fFxyXG4gICAgICAgICAgbmV4dFByb3BzLmNvdXJzZUlkICE9PSB0aGlzLnByb3BzLmNvdXJzZUlkKVxyXG4gICAgICB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKCgpPT4oe1xyXG4gICAgICAgICAgYXNzaWdubWVudHM6IFtdLFxyXG4gICAgICAgICAgbG9hZGluZzogdHJ1ZVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWQoKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIHNob3dFcnJvcihlcnIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGFzc2lnbm1lbnRzOiBBc3NpZ25tZW50W10sIGFzc2lnbm1lbnQ6IEFzc2lnbm1lbnQpOiBBc3NpZ25tZW50W10ge1xyXG4gICAgY29uc3QgcmV0dmFsID0gW1xyXG4gICAgICBhc3NpZ25tZW50LFxyXG4gICAgICAuLi5hc3NpZ25tZW50cy5maWx0ZXIoKHt1c2VyLCBmaWxlbmFtZX0pID0+XHJcbiAgICAgICAgdXNlciAhPT0gYXNzaWdubWVudC51c2VyIHx8XHJcbiAgICAgICAgZmlsZW5hbWUgIT09IGFzc2lnbm1lbnQuZmlsZW5hbWUpXTtcclxuICAgIHJldHVybiByZXR2YWw7XHJcbiAgfVxyXG5cclxuICBhc3luYyByZWZyZXNoQXNzaWdubWVudChhc3NpZ25tZW50OiBBc3NpZ25tZW50KSB7XHJcbiAgICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudC5odHRwO1xyXG4gICAgY29uc3Qge2NvdXJzZUlkLCB0YXNrSWQsIHNjaG9vbH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qge3VzZXIsIGZpbGVuYW1lfSA9IGFzc2lnbm1lbnQ7XHJcbiAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICBhc3NpZ25tZW50czogdGhpcy51cGRhdGUoYXNzaWdubWVudHMsIHsuLi5hc3NpZ25tZW50LCBpc1JlZnJlc2hpbmc6IHRydWV9KVxyXG4gICAgfSkpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVxID0gYXdhaXQgY2xpZW50LmdldChgYXNzaWdubWVudHMvdXJrdW5kLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH0vJHt1c2VyfS8ke2ZpbGVuYW1lfWApO1xyXG4gICAgICBpZiAocmVxLnN0YXR1cyA+PSA0MDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVxLnN0YXR1cywgYXdhaXQgcmVxLnRleHQoKSk7XHJcbiAgICAgIGNvbnN0IHJlc0pzb24gPSBhd2FpdCByZXEudGV4dCgpO1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICAgIGFzc2lnbm1lbnRzOiB0aGlzLnVwZGF0ZShhc3NpZ25tZW50cywgey4uLmFzc2lnbm1lbnQsIGlzUmVmcmVzaGluZzogZmFsc2UsIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAuLi5hc3NpZ25tZW50Lm1ldGFkYXRhLFxyXG4gICAgICAgICAgdXJrdW5kUmVzcG9uc2U6IHJlc0pzb25cclxuICAgICAgICB9fSlcclxuICAgICAgfSkpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICAgIGFzc2lnbm1lbnRzOiB0aGlzLnVwZGF0ZShhc3NpZ25tZW50cywge1xyXG4gICAgICAgICAgLi4uYXNzaWdubWVudCxcclxuICAgICAgICAgIGlzUmVmcmVzaGluZzogZmFsc2UsXHJcbiAgICAgICAgICByZWZyZXNoRXJyb3I6IGVcclxuICAgICAgICB9KVxyXG4gICAgICB9KSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2xpZW50ID0gZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cDtcclxuICAgICAgY29uc3Qge2NvdXJzZUlkLCB0YXNrSWQsIHNjaG9vbH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICBjb25zdCB0ZWFjaGVyQXRTY2hvb2wgPSBpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIHNjaG9vbCk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0ICh0ZWFjaGVyQXRTY2hvb2wgP1xyXG4gICAgICAgIGNsaWVudC5nZXQoYGFzc2lnbm1lbnRzLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH1gKSA6XHJcbiAgICAgICAgY2xpZW50LmdldChgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke2Vudi5jdXJyZW50VXNlci5tYWlsfWApKTtcclxuICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGFzc2lnbm1lbnRzID0gYXdhaXQgcmVzLmpzb24oKSBhcyBBc3NpZ25tZW50W107XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGVycm9yOiBudWxsLFxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGFzc2lnbm1lbnRzXHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAodGVhY2hlckF0U2Nob29sKSB7XHJcbiAgICAgICAgY29uc3QgcmVmcmVzaGFibGVBc3NpZ21lbnRzID0gYXNzaWdubWVudHMuZmlsdGVyKGEgPT5cclxuICAgICAgICAgIGEubWV0YWRhdGEgJiYgLy8gTXVzdCBoYXZlIG1ldGFkYXRhLnVya3VuZEV4dGVybmFsSWQgT3RoZXJ3aXNlIG5vdCBwb3NzaWJsZSB0byByZWZyZXNoXHJcbiAgICAgICAgICAhYS5tZXRhZGF0YS51cmt1bmRVcGxvYWRFcnJvciAmJiAoIC8vIE5vdCBwb3NzaWJsZSB0byByZWZyZXNoIGlmIHVwbG9hZCBoYXMgZmFpbGVkXHJcbiAgICAgICAgICAgICFhLm1ldGFkYXRhLnVya3VuZExhc3RQb2xsIHx8IC8vIE5ldmVyIGNoZWNrZWQgc3RhdHVzIHlldFxyXG4gICAgICAgICAgICAoXHJcbiAgICAgICAgICAgICAgWydBY2NlcHRlZCcsICdTdWJtaXR0ZWQnXS5pbmRleE9mKChKU09OLnBhcnNlKGEubWV0YWRhdGEudXJrdW5kUmVzcG9uc2UpWzBdIGFzIFVya3VuZFJlc3BvbnNlKS5TdGF0dXMuU3RhdGUpID49IDAgJiZcclxuICAgICAgICAgICAgICBwYXJzZUludChhLm1ldGFkYXRhLnVya3VuZExhc3RQb2xsKSA8IG1vbWVudCgpLmFkZCgtMTUsIFwic2Vjb25kc1wiKS50b0RhdGUoKS5nZXRUaW1lKCkpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLy8gQ2hlY2tlZCBzdGF0dXMgZm9yIGEgbG9uZyB0aW1lIGFnb1xyXG4gICAgICAgICAgKTtcclxuICAgICAgICBmb3IgKGxldCBhIG9mIHJlZnJlc2hhYmxlQXNzaWdtZW50cykge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoQXNzaWdubWVudChhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBgS3VuZGUgaW50ZSBsYWRkYSBpbmzDpG1uaW5nc3VwcGdpZnRlcmAsXHJcbiAgICAgICAgYXNzaWdubWVudHM6IFtdXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uRHJhZyAoZXY6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcclxuICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIGV2LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xyXG4gIH1cclxuICBcclxuICBhc3luYyB2ZXJpZnlBbmRVcGxvYWQoZmlsZTogRmlsZSwgZHJpdmVGaWxlPzogc2VsZWN0ZWRGaWxlKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoIWZpbGUpIHJldHVybjtcclxuICAgICAgaWYgKHRoaXMuc3RhdGUuYXNzaWdubWVudHMuc29tZShhID0+XHJcbiAgICAgICAgYS51c2VyID09PSBlbnYuY3VycmVudFVzZXIubWFpbCAmJlxyXG4gICAgICAgIGEuZmlsZW5hbWUgPT09IGZpbGUubmFtZSkpXHJcbiAgICAgIHtcclxuICAgICAgICBpZiAoIWNvbmZpcm0oYEVyc8OkdHRhIGJlZmludGxpZyBmaWwgKCR7ZmlsZS5uYW1lfSk/YCkpIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMucHJvcHMuc2Nob29sLnRvTG93ZXJDYXNlKCkgIT09IGVudi5jdXJyZW50VXNlci5zY2hvb2wudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgIGlmICghY29uZmlybShgVXBwZ2lmdGVuIHRpbGxow7ZyIGVuIGFubmFuIHNrb2xhICgke3RoaXMucHJvcHMuc2Nob29sfSkuXFxuYCtcclxuICAgICAgICAgIGBWaWxsIGR1IMOkbmTDpSBsw6RtbmEgaW4gZGl0dCBhcmJldGUgaMOkcj9gKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe3VwbG9hZGluZ0ZpbGU6IGZpbGV9KTtcclxuICAgICAgYXdhaXQgdGhpcy51cGxvYWQoZmlsZSwgZHJpdmVGaWxlKTtcclxuICAgICAgYXdhaXQgdGhpcy5sb2FkKCk7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIHVwbG9hZGluZ0ZpbGU6IG51bGxcclxuICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICBlcnJvcjogXCJLdW5kZSBpbnRlIGxhZGRhIHVwcCBmaWxlbi4gXCIgKyAoZXJyb3IubWVzc2FnZSB8fCBlcnJvciksXHJcbiAgICAgICAgdXBsb2FkaW5nRmlsZTogbnVsbFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIGFzeW5jIHVwbG9hZChmaWxlOiBGaWxlLCBkcml2ZUZpbGU/OiBzZWxlY3RlZEZpbGUpIHtcclxuICAgIGNvbnN0IGNsaWVudCA9IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHA7XHJcbiAgICBjb25zdCB7Y291cnNlSWQsIHRhc2tJZCwgc2Nob29sLCBzZW5kVG9Vcmt1bmR9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHttYWlsfSA9IGVudi5jdXJyZW50VXNlcjtcclxuICAgIGNvbnN0IGlzVXJrdW5kRXh0ZW5zaW9uID0gVVJLVU5EX0VYVEVOU0lPTlNcclxuICAgICAgLmluZGV4T2YoXCIuXCIrZmlsZS5uYW1lLnNwbGl0KCcuJykucmV2ZXJzZSgpWzBdLnRvTG93ZXJDYXNlKCkpID49IDA7XHJcbiAgICBpZiAoaXNVcmt1bmRFeHRlbnNpb24pIHtcclxuICAgICAgaWYgKGZpbGUuc2l6ZSA+IE1BWF9VUktVTkRfRklMRV9TSVpFX01CICogMTAyNCAqIDEwMjQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVyIGF2IGRlbm5hIHR5cCBmw6VyIGludGUgdmFyYSBzdMO2cnJlIMOkbiAke01BWF9VUktVTkRfRklMRV9TSVpFX01CfSBNQmApO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpZiAoZmlsZS5zaXplID4gTUFYX05PTlVSS1VORF9GSUxFX1NJWkVfTUIgKiAxMDI0ICogMTAyNCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZW4gZsOlciBpbnRlIHZhcmEgc3TDtnJyZSDDpG4gJHtNQVhfTk9OVVJLVU5EX0ZJTEVfU0laRV9NQn0gTUJgKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgbG93ZXJGaWxlbmFtZSA9IGZpbGUubmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgaWYgKCFBTExPV0VEX0VYVEVOU0lPTlMuc29tZShleHQgPT4gbG93ZXJGaWxlbmFtZS5lbmRzV2l0aChleHQpKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVucyDDpG5kZWxzZSBtw6VzdGUgdmFyYSAke0FMTE9XRURfRVhURU5TSU9OUy5qb2luKCcgLyAnKX1gKTtcclxuICAgIH0gXHJcbiAgICBjb25zdCBib2R5ID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICBib2R5LmFwcGVuZCgnZmlsZXMnLCBmaWxlKTtcclxuICAgIGxldCBxdWVyeVBhcmFtczphbnkgPSB7XHJcbiAgICAgIHVzZXJEaXNwbGF5TmFtZTogZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lLFxyXG4gICAgICB2ZXJpZnlXaXRoVXJrdW5kOiBzZW5kVG9Vcmt1bmRcclxuICAgIH07XHJcbiAgICBpZiAoZHJpdmVGaWxlKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1zID0ge1xyXG4gICAgICAgIC4uLnF1ZXJ5UGFyYW1zLFxyXG4gICAgICAgIGRyaXZlRmlsZUlkOiBkcml2ZUZpbGUuZmlsZUlkLFxyXG4gICAgICAgIGRyaXZlRmlsZVVybDogZHJpdmVGaWxlLnVybCxcclxuICAgICAgICBkcml2ZUZpbGVJY29uVXJsOiBkcml2ZUZpbGUuaWNvblVybFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKFxyXG4gICAgICBgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke21haWx9YCxcclxuICAgICAgJ3B1dCcsXHJcbiAgICAgIHt9LFxyXG4gICAgICBxdWVyeVBhcmFtcyxcclxuICAgICAge1xyXG4gICAgICAgIGJvZHlcclxuICAgICAgfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XHJcbiAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBkb3dubG9hZChmaWxlOiBBc3NpZ25tZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKGZpbGUubWVkaWFMaW5rLCAnZ2V0Jywge30pO1xyXG4gICAgICBpZiAocmVzLnN0YXR1cyA+PSA0MDApIHtcclxuICAgICAgICB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXMuYmxvYigpO1xyXG4gICAgICBkb3dubG9hZChibG9iLCBmaWxlLmZpbGVuYW1lLCBmaWxlLmNvbnRlbnRUeXBlKTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtlcnJvcjogXCJLdW5kZSBpbnRlIGxhZGRhIG5lZCBmaWxlbi4gXCIgKyAoZXJyLm1lc3NhZ2UgfHwgZXJyKX0pO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9ICAgIFxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZGVsZXRlKHVybDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlUHJvbWlzZWQoKHthc3NpZ25tZW50c30pID0+ICh7YXNzaWdubWVudHM6IGFzc2lnbm1lbnRzLm1hcChhID0+IGEubWVkaWFMaW5rID09PSB1cmwgP1xyXG4gICAgICAgIHsuLi5hLCBtZXRhZGF0YTogey4uLmEubWV0YWRhdGEsICRtZXRhOiAnZGVsZXRlJ319IDogey4uLmF9KX0pKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cC5mZXRjaCh1cmwsICdkZWxldGUnLCB7fSk7XHJcbiAgICAgIGlmIChyZXMuc3RhdHVzID49IDQwMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICAgIH1cclxuICAgICAgYXdhaXQgdGhpcy5sb2FkKCk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IFwiS3VuZGUgaW50ZSB0YSBib3J0IGZpbGVuLiBcIiArIChlcnIubWVzc2FnZSB8fCBlcnIpfSk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtjb3Vyc2VJZCwgdGFza0lkLCBzY2hvb2x9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHtsb2FkaW5nLCBhc3NpZ25tZW50cywgZXJyb3IsIHVwbG9hZGluZ0ZpbGV9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHRlYWNoZXJBdFRoaXNTY2hvb2wgPSBpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIHNjaG9vbCk7XHJcbiAgICBsZXQgZmlsZXMgPSBbLi4uYXNzaWdubWVudHNdO1xyXG4gICAgY29uc3Qgc2hvd0dvb2dsZVBpY2tlciA9IGZlYXR1cmVzLnBpY2tlcjtcclxuICAgIFxyXG4gICAgaWYgKHVwbG9hZGluZ0ZpbGUpIHtcclxuICAgICAgY29uc3QgdmlydHVhbEZpbGU6IEFzc2lnbm1lbnQgPSB7XHJcbiAgICAgICAgc2Nob29sLFxyXG4gICAgICAgIGNvdXJzZUlkLFxyXG4gICAgICAgIHRhc2tJZCxcclxuICAgICAgICBmaWxlbmFtZTogdXBsb2FkaW5nRmlsZS5uYW1lLFxyXG4gICAgICAgIHNpemU6IHVwbG9hZGluZ0ZpbGUuc2l6ZSxcclxuICAgICAgICB1c2VyOiBlbnYuY3VycmVudFVzZXIubWFpbCxcclxuICAgICAgICBjb250ZW50VHlwZTogdXBsb2FkaW5nRmlsZS50eXBlLFxyXG4gICAgICAgIHVwbG9hZERhdGU6IERhdGUubm93KCksXHJcbiAgICAgICAgbWVkaWFMaW5rOiBgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke2Vudi5jdXJyZW50VXNlci5tYWlsfS8ke3VwbG9hZGluZ0ZpbGUubmFtZX1gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAkbWV0YTogJ2FkZCcsXHJcbiAgICAgICAgICB1c2VyRGlzcGxheU5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZVxyXG4gICAgICAgIH0gYXMgQXNzaWdubWVudFtcIm1ldGFkYXRhXCJdXHJcbiAgICAgIH07XHJcbiAgICAgIGZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5tZWRpYUxpbmsgIT09IHZpcnR1YWxGaWxlLm1lZGlhTGluayk7XHJcbiAgICAgIGZpbGVzID0gWy4uLmZpbGVzLCB2aXJ0dWFsRmlsZV07XHJcbiAgICB9XHJcbiAgICBmaWxlcyA9IGZpbGVzLnNvcnQoY29tcGFyZVByb3BzKFtcclxuICAgICAgXCJtZXRhZGF0YS51c2VyRGlzcGxheU5hbWVcIixcclxuICAgICAgXCJmaWxlbmFtZVwiLFxyXG4gICAgICBcInVwbG9hZERhdGVcIlxyXG4gICAgICBdLCBbXCJzdlwiLCBcImVuXCJdLCB7c2Vuc2l0aXZpdHk6ICdiYXNlJ30pKTtcclxuICAgIGNvbnN0IGhhc093bkRvY3MgPSBmaWxlcy5zb21lKGZpbGUgPT4gZmlsZS51c2VyID09PSBlbnYuY3VycmVudFVzZXIubWFpbCk7XHJcbiAgICBcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgb25EcmFnT3Zlcj17ZXYgPT4gdGhpcy5vbkRyYWcoZXYpfSBvbkRyb3A9e2V2PT57XHJcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLnZlcmlmeUFuZFVwbG9hZChldi5kYXRhVHJhbnNmZXIuZmlsZXNbMF0pO1xyXG4gICAgICB9fT5cclxuICAgICAgICB7ZXJyb3IgPyA8PlxyXG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZXJyb3JcIj57ZXJyb3J9PC9wPlxyXG4gICAgICAgIDwvPjogdW5kZWZpbmVkfVxyXG4gICAgICAgIHtsb2FkaW5nID8gPD5cclxuICAgICAgICAgIDxTcGlubmVyIC8+IExhZGRhciBpbmzDpG1uYWRlIGZpbGVyLi4uXHJcbiAgICAgICAgPC8+IDogZmlsZXMubGVuZ3RoID09PSAwID9cclxuICAgICAgICAgIHRlYWNoZXJBdFRoaXNTY2hvb2wgP1xyXG4gICAgICAgICAgICA8cD5JbmdlbiBlbGV2IGhhciBsw6RtbmF0IGluIG7DpWdvdCBhcmJldGUgw6RubnUuPC9wPiA6XHJcbiAgICAgICAgICAgIHVuZGVmaW5lZFxyXG4gICAgICAgIDogPD5cclxuICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YXNrLWFzc2lnbm1lbnRzLXRhYmxlXCI+PHRoZWFkPjx0cj5cclxuICAgICAgICAgICAge3RlYWNoZXJBdFRoaXNTY2hvb2wgPyA8dGg+RWxldjwvdGg+IDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICA8dGg+RmlsbmFtbjwvdGg+XHJcbiAgICAgICAgICAgIDx0aD5JbmzDpG1uYXQgZGVuPC90aD5cclxuICAgICAgICAgICAge3RlYWNoZXJBdFRoaXNTY2hvb2wgJiYgPD5cclxuICAgICAgICAgICAgICA8dGg+UmFwcG9ydDwvdGg+XHJcbiAgICAgICAgICAgICAgPHRoPk5pdsOlPC90aD5cclxuICAgICAgICAgICAgPC8+fVxyXG4gICAgICAgICAgICB7aGFzT3duRG9jcyAmJiA8dGggLz59XHJcbiAgICAgICAgICA8L3RyPjwvdGhlYWQ+PHRib2R5PntcclxuICAgICAgICAgICAgZmlsZXMubWFwKGZpbGUgPT4gPHRyXHJcbiAgICAgICAgICAgICAga2V5PXtmaWxlLm1lZGlhTGlua31cclxuICAgICAgICAgICAgICBzdHlsZT17ZmlsZS5tZXRhZGF0YS4kbWV0YSA/IHtvcGFjaXR5OiAwLjV9OiB7fX1cclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgIHt0ZWFjaGVyQXRUaGlzU2Nob29sID9cclxuICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgIC8vIFRlYWNoZXIgVmlld1xyXG4gICAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICAgIDw+PHRkPlxyXG4gICAgICAgICAgICAgICAgICA8YSBocmVmPXtgbWFpbHRvOiR7ZmlsZS51c2VyfWB9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtmaWxlLm1ldGFkYXRhLnVzZXJEaXNwbGF5TmFtZSB8fCBmaWxlLnVzZXJ9XHJcbiAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8dGQ+e2ZpbGUubWV0YWRhdGEuZHJpdmVGaWxlSWQgP1xyXG4gICAgICAgICAgICAgICAgICAvLyBUaGUgZmlsZSBjYW4gYmUgZWRpdGVkIG9uIGRyaXZlLiBMaW5rIHRvIGVkaXRpbmcgaXQuXHJcbiAgICAgICAgICAgICAgICAgIDxEcml2ZUZpbGVMaXN0aW5nIGZpbGU9e2ZpbGV9IC8+IDpcclxuICAgICAgICAgICAgICAgICAgLy8gVGhlIGZpbGUgY2Fubm90IGJlIGVkaXRlZCBvbiBkcml2ZS4gTGluayB0byBkb3dubG9hZGluZyBpdC5cclxuICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIlxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG93bmxvYWQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfX0+e2ZpbGUuZmlsZW5hbWV9PC9hPn1cclxuICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiYXNzaWdubWVudC1kYXRlLWNvbFwiPnttb21lbnQoZmlsZS51cGxvYWREYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKX08L3RkPlxyXG4gICAgICAgICAgICAgICAge2ZpbGUubWV0YWRhdGEuJG1ldGEgPT09ICdhZGQnID9cclxuICAgICAgICAgICAgICAgICAgPHRkIGNvbFNwYW49ezJ9PjxTcGlubmVyIC8+IExhZGRhciB1cHAuLi48L3RkPjpcclxuICAgICAgICAgICAgICAgICAgZmlsZS5tZXRhZGF0YS4kbWV0YSA9PT0gJ2RlbGV0ZScgP1xyXG4gICAgICAgICAgICAgICAgICA8dGQgY29sU3Bhbj17Mn0+PFNwaW5uZXIgLz4gVGFyIGJvcnQuLi48L3RkPiA6XHJcbiAgICAgICAgICAgICAgICAgICgoKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHttZXRhZGF0YX0gPSBmaWxlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVya3VuZFJlc3BvbnNlczogVXJrdW5kUmVzcG9uc2VbXSA9IG1ldGFkYXRhLnVya3VuZFJlc3BvbnNlICYmIEpTT04ucGFyc2UobWV0YWRhdGEudXJrdW5kUmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB1cmt1bmRSZXNwb25zZSA9IHVya3VuZFJlc3BvbnNlcyAmJiB1cmt1bmRSZXNwb25zZXNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1cmt1bmRSZXNwb25zZSAmJiBmaWxlLm1ldGFkYXRhLnVya3VuZFVwbG9hZEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICB1cmt1bmRSZXNwb25zZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgU3RhdHVzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgRXJyb3JDb2RlOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlOiBmaWxlLm1ldGFkYXRhLnVya3VuZFVwbG9hZEVycm9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFN0YXRlOiAnRXJyb3InXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEV4dGVybmFsSWQ6IGZpbGUubWV0YWRhdGEudXJrdW5kRXh0ZXJuYWxJZFxyXG4gICAgICAgICAgICAgICAgICAgICAgfSBhcyBVcmt1bmRSZXNwb25zZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUuaXNSZWZyZXNoaW5nKSByZXR1cm4gPHRkIGNvbFNwYW49ezJ9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPFNwaW5uZXIgLz4gVXBwZGF0ZXJhci4uLlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+O1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmt1bmRSZXNwb25zZSA/IDw+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidXJrdW5kLXN0YXR1cy1jb2xcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmPXt1cmt1bmRSZXNwb25zZS5SZXBvcnQgJiYgdXJrdW5kUmVzcG9uc2UuUmVwb3J0LlJlcG9ydFVybH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtldj0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFsnQWNjZXB0ZWQnLCAnU3VibWl0dGVkJ10uaW5kZXhPZih1cmt1bmRSZXNwb25zZS5TdGF0dXMuU3RhdGUpID09PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBGb2xsb3cgSFJFRiBpbnN0ZWFkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQXNzaWdubWVudChmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD1cIl9ibGFua1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU9e2dldFVya3VuZEhvdmVyVGV4dCh1cmt1bmRSZXNwb25zZSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtnZXRVcmt1bmRTdGF0dXNDbGFzcyh1cmt1bmRSZXNwb25zZSl9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwidXJrdW5kLXN0YXR1cy1jb2xcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2dldFVya3VuZFNpZ25pZmljYW5jZUNsYXNzKHVya3VuZFJlc3BvbnNlKX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge3Vya3VuZFJlc3BvbnNlLlJlcG9ydCAmJiB0eXBlb2YgdXJrdW5kUmVzcG9uc2UuUmVwb3J0LlNpZ25pZmljYW5jZSA9PT0gJ251bWJlcicgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7dXJrdW5kUmVzcG9uc2UuUmVwb3J0LlNpZ25pZmljYW5jZS50b0ZpeGVkKCl9JWAgOiAnICd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8Lz4gOiA8dGQgY29sU3Bhbj17Mn0vPlxyXG4gICAgICAgICAgICAgICAgICB9KSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgPC8+IDpcclxuICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgIC8vIFNUVURFTlQgVklFV1xyXG4gICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgPD5cclxuICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAge2ZpbGUubWV0YWRhdGEuZHJpdmVGaWxlSWQgP1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBmaWxlIGNhbiBiZSBlZGl0ZWQgb24gZHJpdmUuIExpbmsgdG8gZWRpdGluZyBpdC5cclxuICAgICAgICAgICAgICAgICAgICA8RHJpdmVGaWxlTGlzdGluZyBmaWxlPXtmaWxlfSAvPiA6XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBmaWxlIGNhbm5vdCBiZSBlZGl0ZWQgb24gZHJpdmUuIExpbmsgdG8gZG93bmxvYWRpbmcgaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXtldiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvd25sb2FkKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH19PntmaWxlLmZpbGVuYW1lfTwvYT59XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImFzc2lnbm1lbnQtZGF0ZS1jb2xcIj57ZmlsZS5tZXRhZGF0YS4kbWV0YSA9PT0gJ2FkZCcgP1xyXG4gICAgICAgICAgICAgICAgICA8PjxTcGlubmVyIC8+IExhZGRhciB1cHAuLi48Lz4gOlxyXG4gICAgICAgICAgICAgICAgICBmaWxlLm1ldGFkYXRhLiRtZXRhID09PSAnZGVsZXRlJyA/XHJcbiAgICAgICAgICAgICAgICAgIDw+PFNwaW5uZXIgLz4gVGFyIGJvcnQuLi48Lz4gOlxyXG4gICAgICAgICAgICAgICAgICBtb21lbnQoZmlsZS51cGxvYWREYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKX08L3RkPlxyXG4gICAgICAgICAgICAgIDwvPn1cclxuICAgICAgICAgICAgICB7aGFzT3duRG9jcyAmJiA8dGQ+eyFmaWxlLm1ldGFkYXRhLiRtZXRhICYmIGZpbGUudXNlciA9PT0gZW52LmN1cnJlbnRVc2VyLm1haWwgJiZcclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgb25DbGljaz17ZXYgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oYFJhZGVyYSBpbmzDpG1uYWQgZmlsICR7ZmlsZS5maWxlbmFtZX0/YCkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGUoZmlsZS5tZWRpYUxpbmspO1xyXG4gICAgICAgICAgICAgICAgfX0+PGkgY2xhc3NOYW1lPVwiZmEgZmEtdHJhc2hcIi8+PC9hPn08L3RkPn1cclxuICAgICAgICAgICAgPC90cj4pXHJcbiAgICAgICAgICB9PC90Ym9keT48L3RhYmxlPlxyXG4gICAgICAgIDwvPn1cclxuICAgICAgICB7aXNFbXBsb3llZSgpID8gdW5kZWZpbmVkIDogPD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRyb3Atem9uZSB0YXNrLWFzc2lnbm1lbnQtZHJvcC16b25lXCI+XHJcbiAgICAgICAgICAgIERyb3BwYSBkaXR0IGbDpHJkaWdhIGFyYmV0ZSBow6RyLjxici8+RGV0IGfDpXIgb2Nrc8OlIGJyYSBhdHQgYW52w6RuZGEgYmzDpGRkcmEta25hcHBlbiBuZWRhbi5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJmaWxlXCIgb25DaGFuZ2U9e2V2ID0+IHRoaXMudmVyaWZ5QW5kVXBsb2FkKGV2LnRhcmdldC5maWxlc1swXSl9IC8+XHJcbiAgICAgICAgICB7c2hvd0dvb2dsZVBpY2tlciAmJiA8RHJpdmVCdXR0b24gbGFiZWw9XCJIw6RtdGEgZnLDpW4gR29vZ2xlIERyaXZlXCIgYWN0aW9uPXsoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpY2tlciA9IG5ldyBHb29nbGVQaWNrZXIoe3VwbG9hZDp0cnVlfSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRyaXZlID0gbmV3IEdvb2dsZURyaXZlKCk7XHJcbiAgICAgICAgICAgIHBpY2tlci5zaG93KCkudGhlbihmaWxlcyA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcGlja2VkRmlsZSA9IGZpbGVzWzBdO1xyXG4gICAgICAgICAgICAgIGlmICghcGlja2VkRmlsZSkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgIGRyaXZlLmRvd25sb2FkRmlsZSh7XHJcbiAgICAgICAgICAgICAgICAgZmlsZTogcGlja2VkRmlsZSxcclxuICAgICAgICAgICAgICAgIGxpbWl0U2l6ZTogTUFYX05PTlVSS1VORF9GSUxFX1NJWkVfTUJcclxuICAgICAgICAgICAgICB9KS50aGVuKGZpbGUgPT4gdGhpcy52ZXJpZnlBbmRVcGxvYWQoZmlsZSwgcGlja2VkRmlsZSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgPC8+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcblxyXG4gIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIERyaXZlRmlsZUxpc3RpbmcgKHtmaWxlfToge2ZpbGU6IEFzc2lnbm1lbnR9KSB7XHJcbiAgY29uc3Qge2RyaXZlRmlsZUljb25VcmwsIGRyaXZlRmlsZVVybH0gPSBmaWxlLm1ldGFkYXRhO1xyXG4gIGNvbnN0IGZpbGVuYW1lID0gZmlsZS5maWxlbmFtZS5zdWJzdHIoMCwgZmlsZS5maWxlbmFtZS5sYXN0SW5kZXhPZignLicpKTtcclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgIDxpbWcgY2xhc3NOYW1lPVwiZmlsZS1pY29uXCIgc3JjPXtkcml2ZUZpbGVJY29uVXJsfSAvPlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICA8cD48YSB0YXJnZXQ9XCJfYmxhbmtcIiBocmVmPXtkcml2ZUZpbGVVcmx9PntmaWxlbmFtZX08L2E+PC9wPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBUYXNrLCBDb3Vyc2UsIFVzZXJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBBYmlsaXRpZXNCb3ggfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9hYmlsaXRpZXMtYm94XCI7XHJcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveFwiO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VSZXF1aXJlbWVudHNCb3ggfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9rbm93bGVkZ2UtcmVxdWlyZW1lbnRzLXRhYmxlXCI7XHJcbmltcG9ydCB7IHVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IFRhc2tBc3NpZ25tZW50cyB9IGZyb20gJy4vdGFzay1hc3NpZ25tZW50cyc7XHJcbmltcG9ydCB7IGlzVGVhY2hlckF0U2Nob29sIH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0YXNrOiBUYXNrXHJcbiAgY291cnNlOiBDb3Vyc2VcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICB1c2VyVGFzazogVXNlclRhc2sgfCBudWxsIHwgdW5kZWZpbmVkO1xyXG4gIHdlZWtQbGFubmVyV2VlazogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGFza1BhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHVzZXJUYXNrOiB1bmRlZmluZWQsXHJcbiAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KCkud2VlaygpXHJcbiAgICB9O1xyXG4gICAgdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQgPSB0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB1c2VyVGFza3NSZXBvLnN1YnNjcmliZSh0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZCk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vblVzZXJUYXNrc0NoYW5nZWQpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XHJcbiAgICBpZiAobmV4dFByb3BzLnRhc2suaWQgIT09IHRoaXMucHJvcHMudGFzay5pZCkge1xyXG4gICAgICBjb25zdCB1c2VyVGFzayA9IHVzZXJUYXNrc1JlcG8ubWVtLml0ZW1zLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gbmV4dFByb3BzLnRhc2suaWQpIHx8IG51bGw7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIHVzZXJUYXNrLFxyXG4gICAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KHVzZXJUYXNrc1JlcG8ucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUpLndlZWsoKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uVXNlclRhc2tzQ2hhbmdlZCh1c2VyVGFza3M6IFVzZXJUYXNrW10pIHtcclxuICAgIGNvbnN0IHVzZXJUYXNrID0gdXNlclRhc2tzLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gdGhpcy5wcm9wcy50YXNrLmlkKSB8fCBudWxsO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgIHVzZXJUYXNrLFxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWs6IG1vbWVudCh1c2VyVGFza3NSZXBvLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlKS53ZWVrKClcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdG9nZ2xlVGFzayAoKSB7XHJcbiAgICBjb25zdCB7IHdlZWtEYXRlIH0gPSB1c2VyVGFza3NSZXBvLnBlcnNpc3RlZFN0YXRlO1xyXG4gICAgY29uc3QgeyB1c2VyVGFzayB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHsgY291cnNlLCB0YXNrIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgbW9kdWxlID0gY291cnNlLm1vZHVsZXMuZmluZChtID0+IG0udGFza0lkcy5zb21lKGlkID0+IGlkID09PSB0YXNrLmlkKSk7XHJcbiAgICBpZiAoIW1vZHVsZSkgcmV0dXJuOyAvLyBPaCB1aCFcclxuICAgIGlmICh1c2VyVGFzayA9PT0gdW5kZWZpbmVkKSByZXR1cm47IC8vIE5vdCB5ZXQgbG9hZGVkLlxyXG4gICAgaWYgKCF1c2VyVGFzaykge1xyXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXHJcbiAgICAgICAgTWF0aC5tYXgsXHJcbiAgICAgICAgW3dlZWtEYXRlXS5jb25jYXQodXNlclRhc2tzUmVwby5tZW0uaXRlbXMubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXJUYXNrOiBVc2VyVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIGNvdXJzZU5hbWU6IGNvdXJzZS5uYW1lLFxyXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxyXG4gICAgICAgIGxlYXJuaW5nR29hbDogdGFzay5sZWFybmluZ0dvYWwgfHwgbW9kdWxlLm5hbWUsXHJcbiAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgIHVybDogdGFzay51cmwsXHJcbiAgICAgICAgdGFzazogW3Rhc2tdLFxyXG4gICAgICAgIGNvdXJzZTogW2NvdXJzZV0sXHJcbiAgICAgICAgYWNsOiBbXHJcbiAgICAgICAgICAvLyBEZWZhdWx0IEFDTDogTGV0IHVzZXIgc2VsZiBoYXZlIGZ1bGwgY29udHJvbCBvdmVyIHRoaXMgaXRlbTpcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIEFDTDogTGV0IGVtcGxveWVlcyBvbiBzYW1lIHNjaG9vbCBoYXZlIHJlYWQgYWNjZXNzIHRvIGl0LlxyXG4gICAgICAgICAgLy8gVGhpcyBjdXJyZW50bHkgb25seSBhcHBsaWVzIHRvIHRhc2tzIHRoYXQgcmVmZXIgdG8gY291cnNlIHRhc2tzIChub3Qgb3duIHRhc2tzISlcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAodGFzay5kZWFkbGluZSkge1xyXG4gICAgICAgIHVzZXJUYXNrLmRlYWRsaW5lID0gdGFzay5kZWFkbGluZTtcclxuICAgICAgfVxyXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4odGhpcy5wcm9wcy5jb3Vyc2UubmFtZSwgdHJ1ZSksXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5pbnNlcnQoW3VzZXJUYXNrXSldKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8uZGVsZXRlKFt1c2VyVGFzay5pZF0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyB0YXNrLCBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IHVzZXJUYXNrLCB3ZWVrUGxhbm5lcldlZWsgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBhYmlsaXRpZXMgPSB0YXNrLmFiaWxpdGllcy5tYXAoYSA9PiBjb3Vyc2UuYWJpbGl0aWVzLmZpbmQoYWIgPT4gYWIuaWQgPT09IGEuaWQpKS5maWx0ZXIoYSA9PiAhIWEpO1xyXG4gICAgY29uc3QgY2VudHJhbENvbnRlbnQgPSB0YXNrLmNlbnRyYWxDb250ZW50Lm1hcChjID0+IGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09IGMuaWQpKS5maWx0ZXIoYyA9PiAhIWMpO1xyXG4gICAgY29uc3QgcmVxdWlyZW1lbnRzID0gdGFzay5rbm93bGVkZ2VSZXF1aXJlbWVudHMubWFwKGsgPT4gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5maW5kKGtyID0+IGtyLmlkID09PSBrLmlkKSkuZmlsdGVyKGsgPT4gISFrKTtcclxuICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrICYmICh1c2VyVGFzay4kbWV0YSA9PT0gJ2FkZGluZycgfHwgdXNlclRhc2suJG1ldGEgPT09ICdkZWxldGluZycpO1xyXG4gICAgY29uc3QgY3VycmVudFdlZWsgPSBtb21lbnQoKS53ZWVrKCk7XHJcbiAgICBjb25zdCBmb3JXZWVrU3RyaW5nID0gd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/IFwibG9nZ2Jva2VuXCIgOlxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrICsgMSA/IExgdmFsZCB2ZWNrYSAobsOkc3RhIHZlY2thKWAgOlxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrIC0gMSA/IExgdmFsZCB2ZWNrYSAoZsO2cnJhIHZlY2thbilgIDpcclxuICAgICAgTGB2YWxkIHZlY2thICh2ICR7d2Vla1BsYW5uZXJXZWVrfSlgO1xyXG4gICAgY29uc3QgZGVhZGxpbmVUb29MYXRlID0gdGFzay5kZWFkbGluZSAmJiBtb21lbnQodGFzay5kZWFkbGluZSkuZW5kT2YoJ2RheScpIDwgbW9tZW50KCk7XHJcblxyXG4gICAgaWYgKGNvdXJzZS5nb29nbGVDcmVhdGVDbGFzc3Jvb21zKSB7XHJcbiAgICAgIC8vIHdlIGhhdmUgZ29vZ2xlIGNsYXNzcm9vbSBhY3RpdmVcclxuICAgICAgaWYgKHRhc2sudGVtcGxhdGVGaWxlICYmIHRhc2sudGVtcGxhdGVGaWxlLm1pbWVUeXBlLmluY2x1ZGVzKCdnb29nbGUtYXBwcycpKSB7XHJcbiAgICAgICAgLy8gd2UgaGF2ZSBhIGdvb2dsZSBhcHBzIGZpbGUgc28gdGhpcyBzaG91bGQgYmUgaW4gY2xhc3Nyb29tXHJcbiAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gd2UgaGF2ZSBhIHRlbXBsYXRlIGZpbGUgdGhhdCBpcyBub3QgYSBnb29nbGUgYXBwcyBmaWxlXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQgc3YtdXNlLW1hcmdpbnMgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXRleHQtcG9ydGxldC1jb250ZW50XCI+XHJcbiAgICAgICAgICA8aDE+e3Rhc2submFtZX17dGFzay5hc3NpZ25tZW50ICYmIDxzbWFsbD4gKGlubMOkbW5pbmdzdXBwZ2lmdCk8L3NtYWxsPn08L2gxPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgIHt0YXNrLmNvbnRlbnQgJiYgPD5cclxuICAgICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRhc2suY29udGVudH19IC8+XHJcbiAgICAgICAgPC8+fVxyXG4gICAgICAgIHt0YXNrLmxlYXJuaW5nR29hbCAmJiA8ZGl2PjxoMj5VcHBnaWZ0ZW5zIGzDpHJhbmRlbcOlbDwvaDI+XHJcbiAgICAgICAgICA8cD57dGFzay5sZWFybmluZ0dvYWx9PC9wPlxyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgICB7dGFzay51cmwgJiYgPGEgaHJlZj17dGFzay51cmx9IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIj5Hw6UgdGlsbCB1cHBnaWZ0ZW48L2E+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGJyLz5cclxuICAgICAge3Rhc2suYXNzaWdubWVudCAmJlxyXG4gICAgICA8PlxyXG4gICAgICAgIDxoMj5JbmzDpG1uaW5nc3VwcGdpZnQ8L2gyPlxyXG4gICAgICAgIHt0YXNrLnRlbXBsYXRlRmlsZSA/IDxwPlRpbGwgZGVubmEgdXBwZ2lmdCBmaW5ucyBlbiBtYWxsPC9wPiA6ICA8PlxyXG4gICAgICAgIHtpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIGNvdXJzZS5zY2hvb2wpID9cclxuICAgICAgICAgIDxwPkjDpHIga2FuIGR1IHNvbSBsw6RyYXJlIHNlIGVsZXZlcm5hcyBpbmzDpG1uYWRlIGFyYmV0ZW4uXHJcbiAgICAgICAgICA8L3A+IDogPD5cclxuICAgICAgICAgICAgPHA+RGV0IGjDpHIgw6RyIGVuIGlubMOkbW5pbmdzdXBwZ2lmdC4gTMOkbW5hIGluIGRpdHQgYXJiZXRlIHNvbSBlbiBwZGYsIGRvYyBlbGxlciBvZHQgZmlsXHJcbiAgICAgICAgICAgICAgZ2Vub20gYXR0IGRyYSBkZXQgdGlsbCBmw6RsdGV0IHVuZGVyLiBEdSBrYW4gw6R2ZW4gbGFkZGEgdXAgZW4gZmlsIGVsbGVyIHbDpGxqYSBlbiBmaWxcclxuICAgICAgICAgICAgICBmcsOlbiBkaW4gR29vZ2xlIERyaXZlLlxyXG4gICAgICAgICAgICA8L3A+XHJcbiAgICAgICAgICAgIHt0YXNrLmRlYWRsaW5lID8gPHA+PGI+XHJcbiAgICAgICAgICAgICAgRGVuIGjDpHIgdXBwZ2lmdGVuIHtkZWFkbGluZVRvb0xhdGUgPyAnc2t1bGxlIGhhIGzDpG1uYXRzIGluICcgOiAnc2thIHZhcmEgaW5sw6RtbmFkICd9XHJcbiAgICAgICAgICAgICAge21vbWVudCh0YXNrLmRlYWRsaW5lKS5mb3JtYXQoJ1lZWVktTU0tREQnKX1cclxuICAgICAgICAgICAgPC9iPjwvcD4gOiB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgIDwvPn1cclxuICAgICAgICAgIDxUYXNrQXNzaWdubWVudHNcclxuICAgICAgICAgICAgY291cnNlSWQ9e2NvdXJzZS5pZH1cclxuICAgICAgICAgICAgdGFza0lkPXt0YXNrLmlkfVxyXG4gICAgICAgICAgICBzY2hvb2w9e2NvdXJzZS5zY2hvb2x9XHJcbiAgICAgICAgICAgIHNlbmRUb1Vya3VuZCA9IHt0YXNrLnNlbmRUb1Vya3VuZH1cclxuICAgICAgICAgICAvPlxyXG4gICAgICAgIDxici8+XHJcbiAgICAgIDwvPlxyXG4gICAgICB9XHJcbiAgICAgIDwvPlxyXG4gICAgICB9XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICB7YWJpbGl0aWVzLmxlbmd0aCA+IDAgJiYgPEFiaWxpdGllc0JveFxyXG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIHVwcGdpZnRlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGbDtnJtw6Vnb3JcIlxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIlxyXG4gICAgICAgICAgICBoZWFkZXJPcGVuPXtmYWxzZX1cclxuICAgICAgICAgICAgYWJpbGl0aWVzPXthYmlsaXRpZXN9IC8+fVxyXG5cclxuICAgICAgICB7Y2VudHJhbENvbnRlbnQubGVuZ3RoID4gMCAmJiA8Q2VudHJhbENvbnRlbnRCb3hcclxuICAgICAgICAgICAgdGl0bGU9XCJEZW4gaMOkciB1cHBnaWZ0ZW4gYmVoYW5kbGFyIGbDtmxqYW5kZSBjZW50cmFsYSBpbm5laMOlbGxcIlxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIlxyXG4gICAgICAgICAgICBoZWFkZXJPcGVuPXtmYWxzZX1cclxuICAgICAgICAgICAgY2VudHJhbENvbnRlbnQ9e2NlbnRyYWxDb250ZW50fSAvPn1cclxuXHJcbiAgICAgICAge3JlcXVpcmVtZW50cy5sZW5ndGggPiAwICYmIDxLbm93bGVkZ2VSZXF1aXJlbWVudHNCb3hcclxuICAgICAgICAgIHRpdGxlPVwiSSBkZW4gaMOkciB1cHBnaWZ0ZW4gYmVkw7ZtcyBmw7ZsamFuZGUga3Vuc2thcHNrcmF2XCJcclxuICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiXHJcbiAgICAgICAgICBoZWFkZXJPcGVuPXtmYWxzZX1cclxuICAgICAgICAgIHJlcXVpcmVtZW50cz17cmVxdWlyZW1lbnRzfVxyXG4gICAgICAgICAgLz59XHJcbiAgICAgIDwvZGl2PiAgICAgIFxyXG4gICAgICA8aHIvPlxyXG4gICAgICB7dXNlclRhc2sgIT09IHVuZGVmaW5lZCAmJiA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BzZWxlY3RlZEJveCR7dXNlclRhc2sgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZycgPyAnIHNlbGVjdGVkJyA6ICcnfWB9XHJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtpc1dvcmtpbmcgPyB7b3BhY2l0eTogMC41fToge319XHJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT4haXNXb3JraW5nICYmIHRoaXMudG9nZ2xlVGFzaygpfT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICB7dXNlclRhc2sgP1xyXG4gICAgICAgICAgICAgICAgTGBUYSBib3J0IHVwcGdpZnRlbiBmcsOlbiAke2ZvcldlZWtTdHJpbmd9YDpcclxuICAgICAgICAgICAgICAgIExgTMOkZ2cgdGlsbCB1cHBnaWZ0ZW4gaSAke2ZvcldlZWtTdHJpbmd9YH1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj59XHJcbiAgICAgIDxoci8+XHJcbiAgICAgIHt0YXNrLnJlc291cmNlcyAmJiB0YXNrLnJlc291cmNlcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8aDI+UmVzdXJzZXIga29wcGxhZGUgdGlsbCB1cHBnaWZ0ZW48L2gyPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxyXG4gICAgICAgICAge3Rhc2sucmVzb3VyY2VzLm1hcCgociwgaWR4KSA9PlxyXG4gICAgICAgICAgICA8ZGl2IGtleT17aWR4fSBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3IudXJsfT57ci5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxiciAvPlxyXG4gICAgICA8L2Rpdj59XHJcblxyXG4gXHJcbiAgICAgIDxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7VXJrdW5kUmVzcG9uc2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTdGF0dXNDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9IGVsc2Ugc3dpdGNoIChyZXMuU3RhdHVzLlN0YXRlKSB7XHJcbiAgICBjYXNlICdFcnJvcic6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLWVycm9yYDtcclxuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLXN1Ym1pdHRlZGA7XHJcbiAgICBjYXNlICdBY2NlcHRlZCc6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLWFjY2VwdGVkYDtcclxuICAgIGNhc2UgJ0FuYWx5emVkJzpcclxuICAgICAgcmV0dXJuIGB1cmt1bmQtc3RhdHVzIHVya3VuZC1zdGF0dXMtYW5hbHl6ZWRgO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFVya3VuZEhvdmVyVGV4dCAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSByZXR1cm4gbnVsbDtcclxuICBzd2l0Y2ggKHJlcy5TdGF0dXMuU3RhdGUpIHtcclxuICAgIGNhc2UgJ0Vycm9yJzpcclxuICAgICAgcmV0dXJuIHJlcy5FeHRlcm5hbElkID9cclxuICAgICAgICBgS3VuZGUgaW50ZSB0YXMgZW1vdCBhdiB1cmt1bmQuIEZlbGtvZDogJHtyZXMuU3RhdHVzLkVycm9yQ29kZX1cXG5gK1xyXG4gICAgICAgIGBFeHRlcm5hbCBJRDogJHtyZXMuRXh0ZXJuYWxJZH1cXG5GZWxtZWRkZWxhbmRlOiAke3Jlcy5TdGF0dXMuTWVzc2FnZX1gXHJcbiAgICAgICAgOlxyXG4gICAgICAgIHJlcy5TdGF0dXMuTWVzc2FnZTtcclxuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XHJcbiAgICAgIHJldHVybiBgRmlsZW4gw6RyIHVwcGxhZGRhZCB0aWxsIFVya3VuZC4gS2xpY2thIGbDtnIgYXR0IHVwcGRhdGVyYSBzdGF0dXMuYDtcclxuICAgIGNhc2UgJ0FjY2VwdGVkJzpcclxuICAgICAgcmV0dXJuIGBGaWxlbiBhbmFseXNlcmFzIGZvcnRmYXJhbmRlIGF2IFVya3VuZC4gS2xpY2thIGbDtnIgYXR0IHVwcGRhdGVyYSBzdGF0dXMuYDtcclxuICAgIGNhc2UgJ0FuYWx5emVkJzpcclxuICAgICAgcmV0dXJuIGBSYXBwb3J0IHNrYXBhZC4gS2xpY2thIGbDtnIgYXR0IMO2cHBuYSByYXBwb3J0ZW4gaSBueXR0IGbDtm5zdGVyYDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTaWduaWZpY2FuY2VDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSByZXR1cm4gJyc7XHJcblxyXG4gIHN3aXRjaCAocmVzLlN0YXR1cy5TdGF0ZSkge1xyXG4gICAgY2FzZSAnRXJyb3InOiByZXR1cm4gJ3Vya3VuZC1zaWduaWZpY2FuY2UtZXJyb3InO1xyXG4gICAgY2FzZSAnU3VibWl0dGVkJzogcmV0dXJuICd1cmt1bmQtc2lnbmlmaWNhbmNlLXN1Ym1pdHRlZCc7XHJcbiAgICBjYXNlICdBY2NlcHRlZCc6IHJldHVybiAndXJrdW5kLXNpZ25pZmljYW5jZS1hY2NlcHRlZCc7XHJcbiAgfVxyXG4gIGNvbnN0IHJlcG9ydCA9IHJlcy5SZXBvcnQ7XHJcbiAgaWYgKCFyZXBvcnQpIHtcclxuICAgIHJldHVybiBcIlwiO1xyXG4gIH1cclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEpXHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvMC5naWZgO1xyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTBcIjtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEwKVxyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzEuZ2lmYDtcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS0xXCI7XHJcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCAyNSlcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS0yXCI7XHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvMi5naWZgO1xyXG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgNDApXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtM1wiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzMuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDU1KVxyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTRcIjtcclxuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC80LmdpZmA7XHJcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCA3MClcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS01XCI7XHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvNS5naWZgO1xyXG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgODUpXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtNlwiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzYuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDk5LjkpXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtN1wiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzcuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA+PSA5OS45KVxyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLThcIjtcclxuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC84LmdpZmA7XHJcbiAgcmV0dXJuIFwiXCI7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMLCBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IEVycm9yU3VjY2Vzc0ZlZWRiYWNrIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3Itc3VjY2Vzcy1mZWVkYmFjayc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBsb2FkQ291cnNlIH0gZnJvbSBcIi4uL2NvdXJzZS1idWlsZGVyL3V0aWxzXCI7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xyXG5pbXBvcnQgeyBDb3Vyc2VQYWdlIH0gZnJvbSBcIi4vY291cnNlLXBhZ2VcIjtcclxuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gXCIuLi8uLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgTGlzdENvdXJzZXNQYWdlIH0gZnJvbSAnLi4vbGlzdC1jb3Vyc2VzL2xpc3QtY291cnNlcy1wYWdlJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgY291cnNlQnVpbGRlclVybD86IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBjb3Vyc2U6IENvdXJzZSB8IG51bGwsXHJcbiAgaXNMb2FkaW5nOiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb3Vyc2VWaWV3ZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGNvdXJzZTogbnVsbCxcclxuICAgICAgaXNMb2FkaW5nOiB0cnVlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChzaG93RXJyb3IpXHJcbiAgICAgIC50aGVuKCgpPT50aGlzLnNldFN0YXRlKHtpc0xvYWRpbmc6IGZhbHNlfSkpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZCgpIHtcclxuICAgIGNvbnN0IGNvdXJzZUlkID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpW1wiY291cnNlSWRcIl07XHJcbiAgICBjb25zdCBjb3Vyc2UgPSBjb3Vyc2VJZCA/IGF3YWl0IGxvYWRDb3Vyc2UgKGNvdXJzZUlkKSA6IG51bGw7XHJcbiAgICB0aGlzLnNldFN0YXRlKHtjb3Vyc2V9KTtcclxuICAgIGRvY3VtZW50LnRpdGxlID1cclxuICAgICAgY291cnNlID9cclxuICAgICAgICBjb3Vyc2UubmFtZSArIFwiIC0gXCIgKyBjb3Vyc2UucG9pbnRzICsgXCJwXCIgOlxyXG4gICAgICAgIFwiS3Vyc2VyXCI7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJjb3Vyc2Utdmlld2VyXCI+XHJcbiAgICAgIHt0aGlzLnN0YXRlLmlzTG9hZGluZyA/XHJcbiAgICAgICAgPFNwaW5uZXIgLz4gOlxyXG4gICAgICAgIHRoaXMuc3RhdGUuY291cnNlID9cclxuICAgICAgICAgIDxDb3Vyc2VQYWdlXHJcbiAgICAgICAgICAgIGNvdXJzZT17dGhpcy5zdGF0ZS5jb3Vyc2V9IFxyXG4gICAgICAgICAgICBjb3Vyc2VCdWlsZGVyVXJsPXt0aGlzLnByb3BzLmNvdXJzZUJ1aWxkZXJVcmx9IC8+IDpcclxuICAgICAgICAgIDxMaXN0Q291cnNlc1BhZ2UgLz5cclxuICAgICAgfVxyXG4gICAgICA8RXJyb3JTdWNjZXNzRmVlZGJhY2sgLz5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEFiaWxpdHkgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3ViVGl0bGU/OiBzdHJpbmc7XHJcbiAgYWJpbGl0aWVzOiBBYmlsaXR5W107XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGhlYWRlck9wZW46IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBYmlsaXRpZXNCb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGhlYWRlck9wZW46IHByb3BzLmhlYWRlck9wZW4gfHwgZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IHRpdGxlLCBzdWJUaXRsZSwgYWJpbGl0aWVzLCBjbGFzc05hbWUgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXsoY2xhc3NOYW1lfHwnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XHJcbiAgICAgICAgPHA+e3RpdGxlfTwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFiaWxpdHlMaXN0XCI+XHJcbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XHJcbiAgICAgICAgICAgIDxoNT57c3ViVGl0bGV9PC9oNT5cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgIHthYmlsaXRpZXMubWFwKGEgPT5cclxuICAgICAgICAgICAgPGRpdiBrZXk9e2EuaWR9IGNsYXNzTmFtZT1cImNvbnRlbnRQYXJ0XCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50VGV4dFwiPlxyXG4gICAgICAgICAgICAgICAgPHAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGEubmFtZX19IC8+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgKX1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ2VudHJhbENvbnRlbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3ViVGl0bGU/OiBzdHJpbmc7XHJcbiAgY2VudHJhbENvbnRlbnQ6IENlbnRyYWxDb250ZW50W107XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGhlYWRlck9wZW46IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDZW50cmFsQ29udGVudEJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgdGl0bGUsIHN1YlRpdGxlLCBjZW50cmFsQ29udGVudCwgY2xhc3NOYW1lIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgeyBoZWFkZXJPcGVuIH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZSB8fCAnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XHJcbiAgICAgICAgPHA+e3RpdGxlfTwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFiaWxpdHlMaXN0XCI+XHJcbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XHJcbiAgICAgICAgICAgIDxoNT57c3ViVGl0bGV9PC9oNT5cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgIHtjZW50cmFsQ29udGVudC5tYXAoY2MgPT5cclxuICAgICAgICAgICAgPGRpdiBrZXk9e2NjLmlkfSBjbGFzc05hbWU9XCJjb250ZW50UGFydFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudFRleHRcIj5cclxuICAgICAgICAgICAgICAgIDxwIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjYy5uYW1lfX0gLz5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB2aXNpYmxlOiBib29sZWFuO1xyXG4gIHRleHQ6IHN0cmluZztcclxuICBjbGFzc05hbWU/OiBzdHJpbmc7XHJcbiAgb25Db25maXJtOiAoKT0+dm9pZDtcclxuICBvbkNhbmNlbDogKCk9PnZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBDb25maXJtYXRpb24gKHByb3BzOiBQcm9wcykge1xyXG4gIHJldHVybiA8ZGl2XHJcbiAgICBjbGFzc05hbWU9e2Bjb25maXJtYXRpb24tYm94ICR7cHJvcHMuY2xhc3NOYW1lfSR7cHJvcHMudmlzaWJsZSA/IFwiIHZpc2libGVcIiA6IFwiXCJ9YH0+XHJcbiAgICA8cD57cHJvcHMudGV4dH08L3A+XHJcbiAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT5wcm9wcy5vbkNvbmZpcm0oKX0+T0s8L2J1dHRvbj5cclxuICAgIDxidXR0b24gb25DbGljaz17KCk9PnByb3BzLm9uQ2FuY2VsKCl9PkF2YnJ5dDwvYnV0dG9uPlxyXG4gIDwvZGl2PjtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEtub3dsZWRnZVJlcXVpcmVtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBPcGVuQ2xvc2VCb3ggfSBmcm9tIFwiLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94XCI7XHJcbmltcG9ydCB7IGFycmF5VG9Mb29rdXAgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIHJlcXVpcmVtZW50czogS25vd2xlZGdlUmVxdWlyZW1lbnRbXTtcclxuICBleHBsYWluZWRSZXF1aXJlbWVudHM/OiB7W3JlcXVpcmVtZW50SWQ6IHN0cmluZ106IHN0cmluZ307XHJcbiAgaWRzVG9TdWJqZWN0TWFwPzoge1tyZXF1aXJlbWVuZElkOiBzdHJpbmddOiBzdHJpbmd9O1xyXG4gIGluY2x1ZGVkSWRzPzoge1tpZDogc3RyaW5nXSA6IHRydWV9O1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG4gIHBhcnRpYWxSZXF1aXJtZW50cz86IHtbaWQ6IHN0cmluZ106IHN0cmluZ1tdfTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEtub3dsZWRnZVJlcXVpcmVtZW50c0JveCA9IChwcm9wczogUHJvcHMpID0+IHtcclxuICBjb25zdCB7dGl0bGUsIGNsYXNzTmFtZSwgaGVhZGVyT3BlbiwgaWRzVG9TdWJqZWN0TWFwLCByZXF1aXJlbWVudHN9ID0gcHJvcHM7XHJcbiAgaWYgKCFpZHNUb1N1YmplY3RNYXApIHtcclxuICAgIC8vIE5vcm1hbCBjYXNlXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8T3BlbkNsb3NlQm94IHRpdGxlPXs8cD57dGl0bGV9PC9wPn0gY2xhc3NOYW1lPXtjbGFzc05hbWV9IGhlYWRlck9wZW49e2hlYWRlck9wZW59PlxyXG4gICAgICAgIDxLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZSB7Li4uey4uLnByb3BzfX0gLz5cclxuICAgICAgPC9PcGVuQ2xvc2VCb3g+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gU3BlY2lhbCBjYXNlOiBSZXF1aXJlbWVudHMgdGhhdCBzcGFucyBtdWx0aXBsZSBzdWJqZWN0czpcclxuICBjb25zdCByZXF1aXJlbWVudHNQZXJTdWJqZWN0TG9va3VwID0gaWRzVG9TdWJqZWN0TWFwID9cclxuICAgIGFycmF5VG9Mb29rdXAocmVxdWlyZW1lbnRzLCByID0+IGlkc1RvU3ViamVjdE1hcFtyLmlkXSB8fCBcIlwiKSA6IHtcIlwiOiByZXF1aXJlbWVudHN9O1xyXG4gIGNvbnN0IHJlcXNQZXJTdWJqZWN0ID0gT2JqZWN0LmtleXMocmVxdWlyZW1lbnRzUGVyU3ViamVjdExvb2t1cClcclxuICAgIC5tYXAoc3ViamVjdCA9PiAoe3N1YmplY3QsIHJlcXVpcmVtZW50czogcmVxdWlyZW1lbnRzUGVyU3ViamVjdExvb2t1cFtzdWJqZWN0XX0pKTtcclxuXHJcbiAgcmV0dXJuIDxPcGVuQ2xvc2VCb3ggdGl0bGU9ezxwPnt0aXRsZX08L3A+fSBjbGFzc05hbWU9e2NsYXNzTmFtZX0gaGVhZGVyT3Blbj17aGVhZGVyT3Blbn0+XHJcbiAgICB7cmVxc1BlclN1YmplY3QubWFwKCh7c3ViamVjdCwgcmVxdWlyZW1lbnRzfSkgPT4gPEtub3dsZWRnZVJlcXVpcmVtZW50c1RhYmxlIHsuLi57XHJcbiAgICAgIC4uLnByb3BzLFxyXG4gICAgICBrZXk6IHN1YmplY3QsXHJcbiAgICAgIGhlYWRpbmc6IHN1YmplY3QsXHJcbiAgICAgIHJlcXVpcmVtZW50c1xyXG4gICAgfX0gLz4pfVxyXG4gIDwvT3BlbkNsb3NlQm94PjtcclxufVxyXG5cclxuY29uc3QgS25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGUgPSAoe1xyXG4gIHJlcXVpcmVtZW50cyxcclxuICBpbmNsdWRlZElkcyxcclxuICBleHBsYWluZWRSZXF1aXJlbWVudHMsXHJcbiAgcGFydGlhbFJlcXVpcm1lbnRzLFxyXG4gIGhlYWRpbmcgfTogUHJvcHMgJiB7aGVhZGluZz86IHN0cmluZ30pID0+XHJcbntcclxuICBjb25zdCBjb2x1bW5zID0gW1wiRVwiLCBcIkNcIiwgXCJBXCJdO1xyXG4gIGNvbnN0IHJvd3M6IEtub3dsZWRnZVJlcXVpcmVtZW50W11bXSA9IFtdO1xyXG4gIGNvbnN0IHJlcXMgPSByZXF1aXJlbWVudHMuc2xpY2UoKTtcclxuICBsZXQgcm93OiBLbm93bGVkZ2VSZXF1aXJlbWVudFtdIHwgbnVsbCA9IG51bGw7XHJcbiAgd2hpbGUgKHRydWUpIHtcclxuICAgIHJvdyA9IGNvbHVtbnMubWFwKGdyYWRlID0+IHtcclxuICAgICAgY29uc3QgcE5leHQgPSByZXFzLmZpbmRJbmRleChyID0+IHIuZ3JhZGVTdGVwLnRvVXBwZXJDYXNlKCkgPT09IGdyYWRlKTtcclxuICAgICAgaWYgKHBOZXh0IDwgMCkgcmV0dXJuIG51bGw7XHJcbiAgICAgIGNvbnN0IHJ2ID0gcmVxc1twTmV4dF07XHJcbiAgICAgIHJlcXMuc3BsaWNlKHBOZXh0LCAxKTtcclxuICAgICAgcmV0dXJuIGluY2x1ZGVkSWRzID9cclxuICAgICAgICAoaW5jbHVkZWRJZHNbcnYuaWRdID8gcnYgOiB1bmRlZmluZWQpIDpcclxuICAgICAgICBydjtcclxuICAgIH0pO1xyXG4gICAgaWYgKHJvdy5ldmVyeShyID0+IHIgPT09IG51bGwpKVxyXG4gICAgICBicmVhaztcclxuICAgIGlmICghcm93LmV2ZXJ5KHIgPT4gIXIpKSB7XHJcbiAgICAgIHJvd3MucHVzaChyb3cpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIDw+XHJcbiAgICB7aGVhZGluZyAmJiA8aDQ+e2hlYWRpbmd9PC9oND59XHJcbiAgICA8dGFibGU+XHJcbiAgICAgIDx0aGVhZD5cclxuICAgICAgICA8dHI+XHJcbiAgICAgICAgICB7Y29sdW1ucy5tYXAoYyA9PiA8dGgga2V5PXtjfT57Y308L3RoPil9XHJcbiAgICAgICAgPC90cj5cclxuICAgICAgPC90aGVhZD5cclxuICAgICAgPHRib2R5PlxyXG4gICAgICAgIHtyb3dzLm1hcCgocm93LGkpID0+IDxSZWFjdC5GcmFnbWVudCBrZXk9e2l9PlxyXG4gICAgICAgICAgICA8dHIga2V5PXtpfT5cclxuICAgICAgICAgICAgICB7cm93Lm1hcCgoY29sdW1uLGopID0+XHJcbiAgICAgICAgICAgICAgICB7dmFyIGNvbHVtblBhcnRpYWxSZXEgPSBjb2x1bW4gJiYgcGFydGlhbFJlcXVpcm1lbnRzICYmIHBhcnRpYWxSZXF1aXJtZW50c1tjb2x1bW4uaWRdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDx0ZCBrZXk9e2p9IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjb2x1bW5QYXJ0aWFsUmVxID8gY29sdW1uUGFydGlhbFJlcS5qb2luKFwiLlwiKSA6IGNvbHVtbiA/IGNvbHVtbi5uYW1lIDogXCJcIn19IC8+XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyA8dGQga2V5PXtqfT5cclxuICAgICAgICAgICAgICAgIC8vIHtwYXJ0aWFsUmVxdWlybWVudHMubWFwKChwciwgaykgPT4gcHJbY29sdW1uLmlkXSA/XHJcbiAgICAgICAgICAgICAgICAvLyAgIDxzcGFuIGtleT17a30gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3t9fS8+XHJcbiAgICAgICAgICAgICAgICAvLyApfVxyXG4gICAgICAgICAgICAgICAgLy8gPC90ZD5cclxuICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICB7ZXhwbGFpbmVkUmVxdWlyZW1lbnRzICYmIDx0cj5cclxuICAgICAgICAgICAgICB7cm93Lm1hcCgoY29sdW1uLGopID0+XHJcbiAgICAgICAgICAgICAgICA8dGQga2V5PXtqfSBjbGFzc05hbWU9XCJleHBsYWluZWQtcmVxdWlyZW1lbnRcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdj57KGNvbHVtbiAmJiBleHBsYWluZWRSZXF1aXJlbWVudHNbY29sdW1uLmlkXSkgfHwgXCJcIn08L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvdGQ+KX1cclxuICAgICAgICAgICAgPC90cj59XHJcbiAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvdGJvZHk+XHJcbiAgICA8L3RhYmxlPlxyXG4gIDwvPjtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IExlYXJuaW5nTW9kdWxlVGFzaywgVGFza0xpc3QgfSBmcm9tICcuL3Rhc2stbGlzdCc7XHJcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb21tb25UYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cclxuICBsZWFybmluZ0dvYWxzOiBMZWFybmluZ0dvYWxbXVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIExlYXJuaW5nR29hbCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGxlYXJuaW5nVGFza3M6IExlYXJuaW5nTW9kdWxlVGFza1tdO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTGVhcm5pbmdHb2Fsc0xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2NvbW1vblRhc2tzLCBsZWFybmluZ0dvYWxzfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICByZXR1cm4gPGRpdj57bGVhcm5pbmdHb2Fscy5tYXAobGcgPT4gPGRpdiBrZXk9e2xnLm5hbWV9PlxyXG4gICAgICA8aDU+e2xnLm5hbWV9PC9oNT5cclxuICAgICAgPFRhc2tMaXN0IGxlYXJuaW5nVGFza3M9e2xnLmxlYXJuaW5nVGFza3N9IC8+XHJcbiAgICA8L2Rpdj4pfVxyXG4gICAge2NvbW1vblRhc2tzLmxlbmd0aCA+IDAgJiYgPGRpdj5cclxuICAgICAge2xlYXJuaW5nR29hbHMubGVuZ3RoID4gMCAmJiA8aDU+e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJsZWFybmluZ0dvYWxzTG9zdC5vdmVyYWxsXCIsIGRlZmF1bHRNZXNzYWdlOlwiw5Z2ZXJncmlwYW5kZVwifSkgfTwvaDU+fSBcclxuICAgICAgPFRhc2tMaXN0IGxlYXJuaW5nVGFza3M9e2NvbW1vblRhc2tzfSAvPlxyXG4gICAgPC9kaXY+fVxyXG4gICAgPC9kaXY+O1xyXG4gIH1cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtSZXNvdXJjZX0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICByZXNvdXJjZXM6IFJlc291cmNlW107XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSZXNvdXJjZUxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtyZXNvdXJjZXN9ID0gdGhpcy5wcm9wcztcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICB7cmVzb3VyY2VzLm1hcCgocmVzb3VyY2UsIGlkeCkgPT4gXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2lkeH0+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgPGEgaHJlZj17cmVzb3VyY2UudXJsfT57cmVzb3VyY2UubmFtZX08L2E+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+KX1cclxuICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBUYXNrLCBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIH0gZnJvbSBcIi4uLy4uL3dlZWtwbGFubmVyL3dlZWtwbGFubmVyLXBlcnNpc3RlZC1zdGF0ZVwiO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEJhdGNoUnVubmVyLCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgdXNlclRhc2tzUmVwbyB9IGZyb20gJy4uLy4uLy4uL3JlcG9zL3VzZXItdGFza3MtcmVwbyc7XHJcbmltcG9ydCB7IGFycmF5VG9NYXAsIEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcclxuaW1wb3J0IHsgQ29uZmlybWF0aW9uIH0gZnJvbSAnLi9jb25maXJtYXRpb24nO1xyXG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgbGVhcm5pbmdUYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICB3ZWVrRGF0ZTogbnVtYmVyO1xyXG4gIHVzZXJUYXNrczogVXNlclRhc2tbXTtcclxuICBjb25maXJtYXRpb25zOiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ01vZHVsZVRhc2sge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHVybDogc3RyaW5nO1xyXG4gIC8qKiBjb3Vyc2VOYW1lXHJcbiAgICogRm9yIEtHOiBjb3Vyc2VOYW1lXHJcbiAgICogRm9yIEtTOiBTdWJqZWN0IG5hbWVcclxuICAgKi9cclxuICBjb3Vyc2VOYW1lOiBzdHJpbmc7XHJcbiAgLyoqIGxlYXJuaW5nR29hbFxyXG4gICAqIEZvciBLRzogbW9kdWxlIG5hbWUgb3IgbGVhcm5pbmcgZ29hbCBvZiB0aGUgdGFza1xyXG4gICAqIEZvciBLUy9zdGVwLWNvdXJzZTogY291cnNlIG5hbWVcclxuICAgKiBGb3IgS1MvdGhlbWUtY291cnNlOiBsZWFybmluZyBnb2FsXHJcbiAgICovXHJcbiAgbGVhcm5pbmdHb2FsOiBzdHJpbmc7XHJcbiAgLyoqIFN0ZXBcclxuICAgKiBPbmx5IHByZXNlbnQgaW4gS1Mvc3RlcC1jb3Vyc2VcclxuICAgKi9cclxuICBzdGVwPzogbnVtYmVyO1xyXG4gIC8qKiB0YXNrXHJcbiAgICogT25seSBmb3IgY291cnNlcyBidWlsdCBieSBjb3Vyc2VidWlsZGVyXHJcbiAgICovXHJcbiAgdGFzaz86IFRhc2s7XHJcbiAgLyoqIGNvdXJzZVxyXG4gICAqIE9ubHkgZm9yIGNvdXJzZXMgYnVpbHQgYnkgY291cnNlYnVpbGRlclxyXG4gICAqL1xyXG4gIGNvdXJzZT86IENvdXJzZTtcclxuICAvKiogY291cnNlSW5mb1xyXG4gICAqIE9ubHkgZm9yIGNvdXJzZXMgYnVpbGQgYnkgc3ViamVjdHBsYW5uZXJcclxuICAgKi9cclxuICBjb3Vyc2VJbmZvPzoge1xyXG4gICAgc2Nob29sOiBzdHJpbmcgLy8gU2Nob29sIG5hbWVcclxuICAgIGNvdXJzZTogc3RyaW5nIC8vIENvdXJzZSBJbnN0YW5jZSBJRFxyXG4gICAgdGFiOiBzdHJpbmcgICAgLy8gQ291cnNlVGFiIElEXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGFza0xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICB1c2VyVGFza3M6IFtdLFxyXG4gICAgICB3ZWVrRGF0ZTogRGF0ZS5ub3coKSxcclxuICAgICAgY29uZmlybWF0aW9uczogW11cclxuICAgIH1cclxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7ICAgIFxyXG4gIH1cclxuXHJcbiAgb25DaGFuZ2UgKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKSB7XHJcbiAgICBpZiAocGVyc2lzdGVkLndlZWtEYXRlICE9PSB0aGlzLnN0YXRlLndlZWtEYXRlKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGNvbmZpcm1hdGlvbnM6IFtdXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgdXNlclRhc2tzLFxyXG4gICAgICB3ZWVrRGF0ZTogcGVyc2lzdGVkLndlZWtEYXRlXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyB0b2dnbGVUYXNrIChsZWFybmluZ1Rhc2s6IExlYXJuaW5nTW9kdWxlVGFzaykge1xyXG4gICAgY29uc3QgdXNlclRhc2tzID0gdGhpcy5zdGF0ZS51c2VyVGFza3MuZmlsdGVyKHV0ID0+IHtcclxuICAgICAgcmV0dXJuIGxlYXJuaW5nVGFzay50YXNrID9cclxuICAgICAgICB1dC50YXNrICYmIHV0LnRhc2suc29tZSh0ID0+IHQuaWQgPT09IGxlYXJuaW5nVGFzay5pZCkgOlxyXG4gICAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPT09IGxlYXJuaW5nVGFzay5pZDtcclxuICAgIH0pO1xyXG4gICAgY29uc3Qge3dlZWtEYXRlfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBcclxuICAgIGlmICh1c2VyVGFza3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIC8vIE5vIHRhc2sgbWF0Y2hlcyB0aGlzIGxlYXJuaW5nTW9kdWxlVGFzayAtIG5vdCBwcmVzZW50IGluIHdlZWtwbGFubmVyLlxyXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXHJcbiAgICAgICAgTWF0aC5tYXgsXHJcbiAgICAgICAgW3dlZWtEYXRlXS5jb25jYXQodGhpcy5zdGF0ZS51c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXJUYXNrOiBVc2VyVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIGNvdXJzZU5hbWU6IGxlYXJuaW5nVGFzay5jb3Vyc2VOYW1lLFxyXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxyXG4gICAgICAgIGxlYXJuaW5nR29hbDogbGVhcm5pbmdUYXNrLmxlYXJuaW5nR29hbCxcclxuICAgICAgICBuYW1lOiBsZWFybmluZ1Rhc2submFtZSxcclxuICAgICAgICB1cmw6IGxlYXJuaW5nVGFzay51cmwsXHJcbiAgICAgICAgYWNsOiBbXHJcbiAgICAgICAgICAvLyBEZWZhdWx0IEFDTDogTGV0IHVzZXIgc2VsZiBoYXZlIGZ1bGwgY29udHJvbCBvdmVyIHRoaXMgaXRlbTpcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIEFDTDogTGV0IGVtcGxveWVlcyBvbiBzYW1lIHNjaG9vbCBoYXZlIHJlYWQgYWNjZXNzIHRvIGl0LlxyXG4gICAgICAgICAgLy8gVGhpcyBjdXJyZW50bHkgb25seSBhcHBsaWVzIHRvIHRhc2tzIHRoYXQgcmVmZXIgdG8gY291cnNlIHRhc2tzIChub3QgY3VzdG9tIHRhc2tzISlcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAobGVhcm5pbmdUYXNrLnRhc2sgJiYgbGVhcm5pbmdUYXNrLnRhc2suZGVhZGxpbmUpIHtcclxuICAgICAgICB1c2VyVGFzay5kZWFkbGluZSA9IGxlYXJuaW5nVGFzay50YXNrLmRlYWRsaW5lO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZWFybmluZ1Rhc2sudGFzaykge1xyXG4gICAgICAgIHVzZXJUYXNrLnRhc2sgPSBbbGVhcm5pbmdUYXNrLnRhc2tdO1xyXG4gICAgICAgIGlmIChsZWFybmluZ1Rhc2suY291cnNlKSB7XHJcbiAgICAgICAgICB1c2VyVGFzay5jb3Vyc2UgPSBbbGVhcm5pbmdUYXNrLmNvdXJzZV07XHJcbiAgICAgICAgfSBlbHNlIGlmIChsZWFybmluZ1Rhc2suY291cnNlSW5mbykge1xyXG4gICAgICAgICAgdXNlclRhc2suY291cnNlSW5mbyA9IGxlYXJuaW5nVGFzay5jb3Vyc2VJbmZvO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1c2VyVGFzay5zaXRlVmlzaW9uUGFnZUlkID0gbGVhcm5pbmdUYXNrLmlkO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZWFybmluZ1Rhc2suc3RlcCkge1xyXG4gICAgICAgIHVzZXJUYXNrLnN0ZXAgPSBsZWFybmluZ1Rhc2suc3RlcDtcclxuICAgICAgfVxyXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4obGVhcm5pbmdUYXNrLmNvdXJzZU5hbWUsIHRydWUpLFxyXG4gICAgICAgIHVzZXJUYXNrc1JlcG8uaW5zZXJ0KFt1c2VyVGFza10pXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBBbHJlYWR5IHByZXNlbnQgaW4gd2Vla3BsYW5uZXIuIEl0J3MgdGltZSB0byBkZWxldGUgdGhvc2UgdGhhdCBtYXRjaGVkIHVzLlxyXG4gICAgICBhd2FpdCB1c2VyVGFza3NSZXBvLmRlbGV0ZSh1c2VyVGFza3MubWFwKHQgPT4gdC5pZCkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICBjb25zdCB7bGVhcm5pbmdUYXNrc30gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgdXNlclRhc2tzID0gYXJyYXlUb01hcCh0aGlzLnN0YXRlLnVzZXJUYXNrcywgdXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgP1xyXG4gICAgICB1dC50YXNrLm1hcCh0ID0+IHQuaWQpWzBdIDogLy8gY291cnNlLWJ1aWxkZXIgdGFza3MgbG9va2VkIHVwIGJ5IGlkXHJcbiAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPyB1dC5zaXRlVmlzaW9uUGFnZUlkIDogLy8gbm9uLWNvdXJzZS1idWlsZGVyIHRhc2tzXHJcbiAgICAgIHV0LnVybCk7XHJcbiAgICBjb25zdCB7Y29uZmlybWF0aW9uc30gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3Qgd2Vla1BsYW5uZXJXZWVrID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcclxuICAgIGNvbnN0IGN1cnJlbnRXZWVrID0gbW9tZW50KCkud2VlaygpO1xyXG4gICAgY29uc3QgZm9yV2Vla1N0cmluZyA9IHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgPyBcIlwiIDpcclxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgKyAxID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0Lm5leHRXZWVrVGFza1wiLCBkZWZhdWx0TWVzc2FnZTpcImbDtnIgbsOkc3RhIHZlY2thICh2e3dlZWt9KVwifSwge3dlZWs6IHdlZWtQbGFubmVyV2Vla30pIDpcclxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgLSAxID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0Lmxhc3RXZWVrVGFza1wiLCBkZWZhdWx0TWVzc2FnZTpcImbDtnIgZsO2cnJhIHZlY2thbiAodnt3ZWVrfSlcIn0sIHt3ZWVrOiB3ZWVrUGxhbm5lcldlZWt9KSA6XHJcbiAgICBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOlwidGFza0xpc3QuY3VycmVudFdlZWtUYXNrXCIsIGRlZmF1bHRNZXNzYWdlOlwiZsO2ciB2ZWNrYSB7d2Vla31cIn0sIHt3ZWVrOiB3ZWVrUGxhbm5lcldlZWt9KTtcclxuXHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcbiAgICAgIHtsZWFybmluZ1Rhc2tzLm1hcCgobGVhcm5pbmdUYXNrLCBpZHgpID0+IHtcclxuICAgICAgICBjb25zdCB0YXNrTG9va3VwSWQgPSBsZWFybmluZ1Rhc2suaWQ7XHJcbiAgICAgICAgY29uc3QgdXNlclRhc2sgPSB1c2VyVGFza3NbdGFza0xvb2t1cElkXSB8fCB7JG1ldGE6ICdkZWxldGVkJ30gYXMgUGFydGlhbDxVc2VyVGFzaz47IC8vIE5vIGV4aXN0ID0gJG1ldGE6ICdkZWxldGVkJ1xyXG4gICAgICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJztcclxuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHVzZXJUYXNrLiRtZXRhICE9PSAnZGVsZXRlZCcgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZyc7XHJcbiAgICAgICAgY29uc3QgZGVzY3JpYmVkQWN0aW9uID0gc2VsZWN0ZWQgP1xyXG4gICAgICAgIGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJ0YXNrTGlzdC5yZW1vdmVUYXNrRnJvbVdlZWtseVBsYW5uaW5nXCIsIGRlZmF1bHRNZXNzYWdlOlwiVGEgYm9ydCB1cHBnaWZ0ZW4gZnLDpW4gZWdlbiB2ZWNrb3BsYW5lcmluZyB7d2Vla31cIn0sIHt3ZWVrOiBmb3JXZWVrU3RyaW5nfSk6XHJcbiAgICAgICAgaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0LmFkZFRhc2tUb1dlZWtseVBsYW5uaW5nXCIsIGRlZmF1bHRNZXNzYWdlOlwiTMOkZ2cgdGlsbCB1cHBnaWZ0ZW4gaSBlZ2VuIHZlY2tvcGxhbmVyaW5nIHt3ZWVrfVwifSwge3dlZWs6IGZvcldlZWtTdHJpbmd9KVxyXG4gICAgICAgIGNvbnN0IGNvbmZpcm1hdGlvblZpc2libGUgPVxyXG4gICAgICAgICAgY29uZmlybWF0aW9ucy5zb21lKHRpZCA9PiB0YXNrTG9va3VwSWQgPT09IHRpZCk7XHJcblxyXG4gICAgICAgIHJldHVybiA8ZGl2IGtleT17bGVhcm5pbmdUYXNrLmlkfT48ZGl2IGtleT17dGFza0xvb2t1cElkfSBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxkaXZcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHNlbGVjdGVkQm94JHtzZWxlY3RlZCA/ICcgc2VsZWN0ZWQnIDogJyd9YH1cclxuICAgICAgICAgICAgICAgIHN0eWxlPXtpc1dvcmtpbmcgPyB7b3BhY2l0eTogMC41fToge319XHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+IWlzV29ya2luZyAmJiB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrID9cclxuICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVUYXNrKGxlYXJuaW5nVGFzaykgOlxyXG4gICAgICAgICAgICAgICAgICBjb25maXJtYXRpb25WaXNpYmxlID8gXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y29uZmlybWF0aW9uczogY29uZmlybWF0aW9ucy5maWx0ZXIodGlkID0+IHRpZCAhPT0gdGFza0xvb2t1cElkKX0pIDpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBbLi4uY29uZmlybWF0aW9uc10uY29uY2F0KHRhc2tMb29rdXBJZCl9KX1cclxuICAgICAgICAgICAgICAgIHRpdGxlPXtkZXNjcmliZWRBY3Rpb259PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICA8YSBocmVmPXtsZWFybmluZ1Rhc2sudXJsfT57bGVhcm5pbmdUYXNrLm5hbWV9PC9hPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPENvbmZpcm1hdGlvblxyXG4gICAgICAgICAgICB2aXNpYmxlPXtjb25maXJtYXRpb25WaXNpYmxlfVxyXG4gICAgICAgICAgICB0ZXh0PXtkZXNjcmliZWRBY3Rpb259XHJcbiAgICAgICAgICAgIG9uQ29uZmlybT17KCk9PntcclxuICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVRhc2sobGVhcm5pbmdUYXNrKTtcclxuICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBjb25maXJtYXRpb25zLmZpbHRlcih0aWQgPT4gdGlkICE9PSB0YXNrTG9va3VwSWQpfSk7XHJcbiAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgIG9uQ2FuY2VsPXsoKT0+e1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IGNvbmZpcm1hdGlvbnMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IHRhc2tMb29rdXBJZCl9KTtcclxuICAgICAgICAgICAgfX0gLz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICB9XHJcbiAgICAgICl9XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHtDb3Vyc2VNb2R1bGUsIENvdXJzZX0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0SW5jbHVkZWRJZHMgKG1vZHVsZTogQ291cnNlTW9kdWxlLCBjb3Vyc2U6IENvdXJzZSkge1xyXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gIGNvdXJzZS50YXNrcy5maWx0ZXIodCA9PiBtb2R1bGUudGFza0lkcy5pbmRleE9mKHQuaWQpICE9PSAtMSkuZm9yRWFjaCh0YXNrID0+IHtcclxuICAgIHRhc2suYWJpbGl0aWVzLmZvckVhY2goKHtpZH0pID0+IHJlc3VsdFtpZF0gPSB0cnVlKTtcclxuICAgIHRhc2suY2VudHJhbENvbnRlbnQuZm9yRWFjaCgoe2lkfSkgPT4gcmVzdWx0W2lkXSA9IHRydWUpO1xyXG4gICAgdGFzay5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZm9yRWFjaCgoe2lkfSkgPT4gcmVzdWx0W2lkXSA9IHRydWUpO1xyXG4gIH0pO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwibGV0IGluaXRpYWxpemVkID0gZmFsc2U7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5pdE1hbnVhbFNjcm9sbFJlc3RvcmF0aW9uKCkge1xyXG4gIGlmICghaW5pdGlhbGl6ZWQpIHtcclxuICAgIGluaXRpYWxpemVkID0gdHJ1ZTtcclxuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ID0+IHtcclxuICAgICAgY29uc3QgdGFyZ2V0ID0gZXYudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICBpZiAodGFyZ2V0ICYmIHRhcmdldC50YWdOYW1lID09PSAnQScpIHtcclxuICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7IHBhZ2VZT2Zmc2V0OiB3aW5kb3cucGFnZVlPZmZzZXQgfSwgbnVsbCwgbnVsbCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgaWYgKGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24pIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSAnbWFudWFsJztcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXN0b3JlU2Nyb2xsUG9zaXRpb24gKHtmYWxsYmFja1Njcm9sbFBvc2l0aW9ufSkge1xyXG4gIGlmIChoaXN0b3J5LnN0YXRlICYmIGhpc3Rvcnkuc3RhdGUucGFnZVlPZmZzZXQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgd2luZG93LnNjcm9sbFRvKDAsIGhpc3Rvcnkuc3RhdGUucGFnZVlPZmZzZXQpO1xyXG4gIH0gZWxzZSBpZiAoZmFsbGJhY2tTY3JvbGxQb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgZmFsbGJhY2tTY3JvbGxQb3NpdGlvbik7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgeyBMaXN0Q291cnNlcyB9IGZyb20gJy4vbGlzdC1jb3Vyc2VzJztcclxuaW1wb3J0IHsgTCB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsc1wiO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gTGlzdENvdXJzZXNQYWdlKCkge1xyXG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICA8Q291cnNlQmFubmVyXHJcbiAgICAgIHRpdGxlPXtlbnYuY3VycmVudFVzZXIuc2Nob29sfVxyXG4gICAgICBiYWNrZ3JvdW5kSW1hZ2U9XCJcIlxyXG4gICAgICB0YWJzPXtbeyBuYW1lOiBcIlNrb2xhbnMga3Vyc2VyXCIsIGxpbms6IFwiI1wiIH1dfVxyXG4gICAgICBhY3RpdmVUYWI9e1wiI1wifVxyXG4gICAgLz5cclxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tMTJcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNwYWNlci0yMHB4dnQgc3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICA8TGlzdENvdXJzZXMgLz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlLCBTY2hvb2wsIFVzZXJIaWRkZW5Db3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHsgc2hvd0Vycm9yLCBmbGF0dGVuLCBjb21wYXJlUHJvcCwgc2hvd0luZm8sIEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XHJcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcsIGdlbmVyYXRlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XHJcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vYWNjZXNzLWNvbnRyb2wvaW5kZXgnO1xyXG5pbXBvcnQgeyBoaWRkZW5Db3Vyc2VzUmVwbywgQ291cnNlV2l0aEhpZGRlblN0YXRlIH0gZnJvbSAnLi4vLi4vcmVwb3MvaGlkZGVuLWNvdXJzZXMtcmVwbyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGlzTG9hZGluZzogYm9vbGVhblxyXG4gIGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdXHJcbiAgaGVhZGVyT3BlbjogYm9vbGVhblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTGlzdENvdXJzZXMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGlzTG9hZGluZzogdHJ1ZSxcclxuICAgICAgY291cnNlczogW10sXHJcbiAgICAgIGhlYWRlck9wZW46IGZhbHNlXHJcbiAgICB9O1xyXG4gICAgdGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzID0gdGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICBoaWRkZW5Db3Vyc2VzUmVwby5zdWJzY3JpYmUodGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzLCB7ZnVsbENvdXJzZTogdHJ1ZX0pO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICBoaWRkZW5Db3Vyc2VzUmVwby51bnN1YnNjcmliZSh0aGlzLnVwZGF0ZUhpZGRlbkNvdXJzZXMpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlSGlkZGVuQ291cnNlcyhjb3Vyc2VzOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXSkge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7Y291cnNlcywgaXNMb2FkaW5nOiBmYWxzZX0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgaGlkZUNvdXJzZShjb3Vyc2U6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xyXG4gICAgc2hvd0luZm8oTGBTcGFyYXIuLi5gKTtcclxuICAgIGF3YWl0IGhpZGRlbkNvdXJzZXNSZXBvLmhpZGVDb3Vyc2UoY291cnNlKTtcclxuICAgIHNob3dJbmZvKFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2hvd0NvdXJzZShjb3Vyc2U6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xyXG4gICAgc2hvd0luZm8oTGBTcGFyYXIuLi5gKTtcclxuICAgIGF3YWl0IGhpZGRlbkNvdXJzZXNSZXBvLnNob3dDb3Vyc2UoY291cnNlKTtcclxuICAgIHNob3dJbmZvKFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgaWYgKHRoaXMuc3RhdGUuaXNMb2FkaW5nKSByZXR1cm4gPFNwaW5uZXIgLz47XHJcbiAgICBjb25zdCB7Y291cnNlc30gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgdmlzaWJsZUNvdXJzZXMgPSBjb3Vyc2VzLmZpbHRlcihjb3Vyc2UgPT4gY291cnNlLnZpc2libGUpO1xyXG4gICAgY29uc3QgaGlkZGVuQ291cnNlcyA9IGNvdXJzZXMuZmlsdGVyKGNvdXJzZSA9PiAhY291cnNlLnZpc2libGUpO1xyXG4gICAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICBjb25zdCB2aWV3Q291cnNlVXJsID0gY2ZnLktFRF9DT1VSU0VfVklFV0VSX1VSTDtcclxuXHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgPGgzPlNrb2xhbnMga3Vyc2VyPC9oMz5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyIG9kZC1ldmVuXCI+XHJcbiAgICAgICAge3Zpc2libGVDb3Vyc2VzLm1hcChjb3Vyc2UgPT5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3R1ZGVudENvdXJzZVwiIGtleT17Y291cnNlLmlkfT5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgcHVsbC1yaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiaGlkZUl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLmhpZGVDb3Vyc2UoY291cnNlKX0gLz5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgPGEgaHJlZj17cHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkodmlld0NvdXJzZVVybCwge2NvdXJzZUlkOiBjb3Vyc2UuaWR9KX0+e2NvdXJzZS5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic21hbGxcIj57Y291cnNlLmRlc2NyaXB0aW9ufTwvcD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtcIm9wZW5DbG9zZVwiICsgKHRoaXMuc3RhdGUuaGVhZGVyT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XHJcbiAgICAgICAgICA8aDU+RG9sZGEga3Vyc2VyPC9oNT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5Db250ZW50XCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXIgb2RkLWV2ZW5cIj5cclxuICAgICAgICAgICAge2hpZGRlbkNvdXJzZXMubWFwKGNvdXJzZSA9PiBcclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdHVkZW50Q291cnNlXCIga2V5PXtjb3Vyc2UuaWR9PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgcHVsbC1yaWdodFwiPlxyXG4gICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJzaG93SXRlbVwiIG9uQ2xpY2s9eygpID0+IHRoaXMuc2hvd0NvdXJzZShjb3Vyc2UpfT48L2E+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dlbmVyYXRlUXVlcnlTdHJpbmcoey4uLnF1ZXJ5LCBjb3Vyc2VJZDogY291cnNlLmlkfSl9Pntjb3Vyc2UubmFtZX08L2E+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInNtYWxsXCI+e2NvdXJzZS5kZXNjcmlwdGlvbn08L3A+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2Pil9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5leHBvcnQgY29uc3QgTGFuZ3VhZ2VDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dCh7aW50bDogbnVsbH0pOyIsImltcG9ydCB7SW50bFByb3ZpZGVyLCBhZGRMb2NhbGVEYXRhfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IGxvY2FsZV9lbiBmcm9tICdyZWFjdC1pbnRsL2xvY2FsZS1kYXRhL2VuJztcclxuaW1wb3J0IGxvY2FsZV9zdiBmcm9tICdyZWFjdC1pbnRsL2xvY2FsZS1kYXRhL3N2JztcclxuaW1wb3J0IG1lc3NhZ2VzX3N2IGZyb20gXCIuLi8uLi90cmFuc2xhdGlvbnMvc3YuanNvblwiO1xyXG5pbXBvcnQgbWVzc2FnZXNfZW4gZnJvbSBcIi4uLy4uL3RyYW5zbGF0aW9ucy9lbi5qc29uXCI7XHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IGNmZyBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0dXBJbnRsID0gPFAgZXh0ZW5kcyBvYmplY3Q+KENvbXBvbmVudDogUmVhY3QuQ29tcG9uZW50VHlwZTxQPikgPT5cclxuICAgIGNsYXNzIF9TZXR1cExhbmd1YWdlSW50bCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQPntcclxuICAgICAgICBtZXNzYWdlcyA6IG9iamVjdDtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3IocHJvcHMpe1xyXG4gICAgICAgICAgICBzdXBlcihwcm9wcyk7XHJcbiAgICAgICAgICAgIGFkZExvY2FsZURhdGEoWy4uLmxvY2FsZV9lbiwuLi5sb2NhbGVfc3ZdKTtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IHtcclxuICAgICAgICAgICAgJ3N2JzogbWVzc2FnZXNfc3YsXHJcbiAgICAgICAgICAgICdlbic6IG1lc3NhZ2VzX2VuXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1vbWVudCgpLmxvY2FsZShjZmcuS0VEX0xPQ0FMRSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZW5kZXIoKXtcclxuICAgICAgICAgICAgcmV0dXJuIDxJbnRsUHJvdmlkZXIgbG9jYWxlPXtjZmcuS0VEX0xPQ0FMRX0gbWVzc2FnZXM9e3RoaXMubWVzc2FnZXNbY2ZnLktFRF9MT0NBTEVdfT5cclxuICAgICAgICAgICAgICAgIDxDb21wb25lbnQgey4uLnRoaXMucHJvcHMgYXMgUH0gLz5cclxuICAgICAgICAgICAgPC9JbnRsUHJvdmlkZXI+XHJcbiAgICAgICAgfVxyXG4gICAgfSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcclxuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBkaWFsb2dzOiBSZWFjdC5Db21wb25lbnRbXTtcclxuICBwb3BEaWFsb2c6ICgpPT52b2lkO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRGlhbG9ncyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gIGxhc3REaXY6IEhUTUxEaXZFbGVtZW50IHwgbnVsbDtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBQcm9wcykge1xyXG4gICAgaWYgKHRoaXMubGFzdERpdiAhPT0gbnVsbCAmJiBwcmV2UHJvcHMuZGlhbG9ncy5sZW5ndGggPiB0aGlzLnByb3BzLmRpYWxvZ3MubGVuZ3RoKSB7XHJcbiAgICAgIC8vIEEgZGlhbG9nIHdhcyBjbG9zZWQuIE5vdyBmb2N1cyB0aGUgbGFzdCBkaWFsb2c6XHJcbiAgICAgICQoZmluZERPTU5vZGUodGhpcy5sYXN0RGl2KSkuZmluZCgnOmlucHV0JykuZmlyc3QoKS5mb2N1cygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyICgpIHtcclxuICAgIHRoaXMubGFzdERpdiA9IG51bGw7XHJcbiAgICBjb25zdCB7ZGlhbG9ncywgcG9wRGlhbG9nfSA9IHRoaXMucHJvcHM7XHJcbiAgICAkKCdib2R5JykuYXR0cignYXJpYS1kaXNhYmxlZCcsIGRpYWxvZ3MubGVuZ3RoID4gMCk7XHJcbiAgICAkKCdib2R5JykuY3NzKCdvdmVyZmxvdycsIGRpYWxvZ3MubGVuZ3RoID4gMCA/ICdoaWRkZW4nIDogJ2F1dG8nKTtcclxuXHJcbiAgICByZXR1cm4gZGlhbG9ncy5sZW5ndGggPiAwICYmIDxkaXY+XHJcbiAgICAgIHtkaWFsb2dzLm1hcCgoZGlhbG9nLCBpZHgpID0+IHtcclxuICAgICAgICBsZXQgZGl2OiBIVE1MRGl2RWxlbWVudDtcclxuICAgICAgICBmdW5jdGlvbiBvbktleVByZXNzKGV2OiBSZWFjdC5LZXlib2FyZEV2ZW50PEhUTUxEaXZFbGVtZW50Pikge1xyXG4gICAgICAgICAgaWYgKGV2LndoaWNoID09PSAxMyAmJiAoIWV2LnRhcmdldCB8fCAoZXYudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS50YWdOYW1lICE9PSAnVEVYVEFSRUEnKSkge1xyXG4gICAgICAgICAgICAkKGZpbmRET01Ob2RlKGRpdikpLmZpbmQoJy5idG4tZGVmYXVsdCcpLmNsaWNrKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25LZXlEb3duKGV2KSB7XHJcbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDI3KSB7IC8vIEVzY2FwZVxyXG4gICAgICAgICAgICBwb3BEaWFsb2coKTtcclxuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gODMgJiYgKGV2LmN0cmxLZXkgfHwgZXYubWV0YUtleSkpIHsgLy8gQ1RSTC1TXHJcbiAgICAgICAgICAgIGNvbnN0IGRvbU5vZGUgPSBmaW5kRE9NTm9kZShkaXYpO1xyXG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0QnV0dG9uID0gJChkb21Ob2RlKS5maW5kKCcuYnRuLWRlZmF1bHQnKTtcclxuICAgICAgICAgICAgZGVmYXVsdEJ1dHRvbi5jbGljaygpO1xyXG4gICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIDxkaXYga2V5PXtpZHh9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImRhcmtlblwiIC8+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtcGFnZS13cmFwXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlXCIgcmVmPXtlbGVtID0+IHtcclxuICAgICAgICAgIGRpdiA9IGVsZW07XHJcbiAgICAgICAgICBpZiAoaWR4ID09PSBkaWFsb2dzLmxlbmd0aCAtIDEpIHRoaXMubGFzdERpdiA9IGVsZW07XHJcbiAgICAgICAgfX1cclxuICAgICAgICAgICAgdGFiSW5kZXg9ezB9XHJcbiAgICAgICAgICAgIGFyaWEtZGlzYWJsZWQ9e2lkeCA8IGRpYWxvZ3MubGVuZ3RoIC0gMX1cclxuICAgICAgICAgICAgb25LZXlQcmVzcz17b25LZXlQcmVzc31cclxuICAgICAgICAgICAgb25LZXlEb3duPXtvbktleURvd259PlxyXG4gICAgICAgICAge2RpYWxvZ31cclxuICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9e3BvcERpYWxvZ30gLz5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RvcEZsb2F0c1wiPjwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2Pn0pfVxyXG4gIDwvZGl2PjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBGb3JtRmllbGQgfSBmcm9tICcuL2Zvcm0tZmllbGQnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBsYWJlbDogYW55O1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdmFsdWU6IHN0cmluZztcclxuICBwbGFjZWhvbGRlcj86IHN0cmluZztcclxuICBhdXRvRm9jdXM/OiBib29sZWFuO1xyXG4gIG9uQ2hhbmdlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRJbnB1dCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxGb3JtRmllbGQgbGFiZWw9e3RoaXMucHJvcHMubGFiZWx9PlxyXG4gICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGF1dG9Gb2N1cz17dGhpcy5wcm9wcy5hdXRvRm9jdXN9IGlkPXt0aGlzLnByb3BzLmlkfSBzaXplPXszNX0gdmFsdWU9e3RoaXMucHJvcHMudmFsdWV9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMucHJvcHMub25DaGFuZ2UoZXYudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4vZm9ybS1maWVsZCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGxhYmVsOiBhbnk7XHJcbiAgaWQ6IHN0cmluZztcclxuICB2YWx1ZTogc3RyaW5nO1xyXG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xyXG4gIGF1dG9Gb2N1cz86IGJvb2xlYW47XHJcbiAgcm93cz86IG51bWJlcjtcclxuICBjaGlsZHJlbj87XHJcbiAgb25DaGFuZ2U6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dEFyZWFGb3JtRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Rm9ybUZpZWxkIGxhYmVsPXt0aGlzLnByb3BzLmxhYmVsfSBpZD17dGhpcy5wcm9wcy5pZH0+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICA8dGV4dGFyZWEgYXV0b0ZvY3VzPXt0aGlzLnByb3BzLmF1dG9Gb2N1c30gaWQ9e3RoaXMucHJvcHMuaWR9IGNvbHM9ezM1fSByb3dzPXt0aGlzLnByb3BzLnJvd3MgfHwgNX0gdmFsdWU9e3RoaXMucHJvcHMudmFsdWV9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMucHJvcHMub25DaGFuZ2UoZXYudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgeyEhdGhpcy5wcm9wcy5jaGlsZHJlbiAmJiA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XHJcbiAgICAgICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxyXG4gICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGxhYmVsOiBhbnk7XHJcbiAgY2hpbGRyZW46IGFueTtcclxuICBpZD86IHN0cmluZztcclxufVxyXG5cclxuZnVuY3Rpb24gZmluZElkKG5vZGUpIHtcclxuICBjb25zdCByZWN1Y2hlY2sgPSBuZXcgU2V0KCk7XHJcbiAgcmV0dXJuIChmdW5jdGlvbiBmaW5kSWQobm9kZSl7XHJcbiAgICBpZiAodHlwZW9mIG5vZGUgPT09ICdzdHJpbmcnKSByZXR1cm4gbnVsbDtcclxuICAgIGlmIChyZWN1Y2hlY2suaGFzKG5vZGUpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHJlY3VjaGVjay5hZGQobm9kZSk7XHJcbiAgICBpZiAobm9kZS5wcm9wcykge1xyXG4gICAgICBpZiAobm9kZS5wcm9wcy5pZCkgcmV0dXJuIG5vZGUucHJvcHMuaWQ7XHJcbiAgICAgIGlmIChub2RlLnByb3BzLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgcmV0dXJuIGZpbmRJZChub2RlLnByb3BzLmNoaWxkcmVuKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAobm9kZS5sZW5ndGgpIHtcclxuICAgICAgZm9yIChsZXQgaT0wO2k8bm9kZS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkID0gbm9kZVtpXTtcclxuICAgICAgICBpZiAoY2hpbGQpIHtcclxuICAgICAgICAgIGNvbnN0IGNoaWxkSWQgPSBmaW5kSWQoY2hpbGQpO1xyXG4gICAgICAgICAgaWYgKGNoaWxkSWQpIHJldHVybiBjaGlsZElkO1xyXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhjaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSkobm9kZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBGb3JtRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gPD5cclxuICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwia2NsYWJlbFwiIGh0bWxGb3I9e3RoaXMucHJvcHMuaWQgfHwgZmluZElkKHRoaXMucHJvcHMuY2hpbGRyZW4pfT57dGhpcy5wcm9wcy5sYWJlbH08L2xhYmVsPlxyXG4gICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxyXG4gICAgPC8+XHJcbiAgfVxyXG59XHJcbiIsIi8qIFJFRkFDVE9SOiBNb3ZlIHRoaXMgY29tcG9uZW50IG91dHNpZGUgY291cnNlYnVpbGRlciFcclxuICAgVGhpcyBpcyBhIGdlbmVyYWwtcHVycG9zZSBjb21wb25lbnRcclxuKi9cclxuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgR29hbFByb2dyZXNzIH0gZnJvbSAnLi4vY2hhcnRzL2dvYWwtcHJvZ3Jlc3MnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0aXRsZTogc3RyaW5nIHwgSlNYLkVsZW1lbnQ7XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlckNsYXNzTmFtZT86IHN0cmluZztcclxuICBjb250ZW50Q2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG4gIGluYWN0aXZhdGVkPzogYm9vbGVhbjtcclxuICBpbmFjdGl2YXRlZFJlbmRlcj86ICdjaGlsZHJlbicgfCAndGl0bGVBbmRDaGlsZHJlbic7XHJcbiAgb25PcGVuQ2xvc2U/OiAoYmVjYW1lT3BlbjogYm9vbGVhbikgPT4gdm9pZDtcclxuICBkaXNwbGF5UHJvZ3Jlc3M/OiBib29sZWFuO1xyXG4gIHByb2dyZXNzRGF0YT86IHtjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXIsIG51bWJlck9mVGFza3M6IG51bWJlcn07XHJcbiAgY2hpbGRyZW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgaGVhZGVyT3BlbjogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE9wZW5DbG9zZUJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgIGlmIChuZXh0UHJvcHMuaGVhZGVyT3BlbiAhPT0gdGhpcy5wcm9wcy5oZWFkZXJPcGVuKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2hlYWRlck9wZW46IG5leHRQcm9wcy5oZWFkZXJPcGVufSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IHRpdGxlLCBjbGFzc05hbWUsIGNoaWxkcmVuLCBoZWFkZXJDbGFzc05hbWUsIGNvbnRlbnRDbGFzc05hbWUsIGRpc3BsYXlQcm9ncmVzcywgcHJvZ3Jlc3NEYXRhLFxyXG4gICAgICBpbmFjdGl2YXRlZCwgaW5hY3RpdmF0ZWRSZW5kZXIgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgaWYgKGluYWN0aXZhdGVkKSByZXR1cm4gaW5hY3RpdmF0ZWRSZW5kZXIgPT09ICd0aXRsZUFuZENoaWxkcmVuJyA/IDw+XHJcbiAgICAgIDw+e3RpdGxlfTwvPlxyXG4gICAgICA8PntjaGlsZHJlbn08Lz5cclxuICAgIDwvPiA6IDw+XHJcbiAgICAgIHtjaGlsZHJlbn1cclxuICAgIDwvPjtcclxuXHJcbiAgICAvL3ZhciBjdXJyZW50UHJvZ3Jlc3NEYXRhID0gLy9wcm9ncmVzc0RhdGEoKTtcclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZXx8JycpICsgXCIgb3BlbkNsb3NlXCIgKyAoaGVhZGVyT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkhlYWRlclwiICsgKGhlYWRlckNsYXNzTmFtZSA/IFwiIFwiICsgaGVhZGVyQ2xhc3NOYW1lIDogXCJcIil9XHJcbiAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMucHJvcHMub25PcGVuQ2xvc2UpIHRoaXMucHJvcHMub25PcGVuQ2xvc2UoIXRoaXMuc3RhdGUuaGVhZGVyT3Blbik7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KTtcclxuICAgICAgICB9fSA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICA8ZGl2Pnt0aXRsZX08L2Rpdj5cclxuICAgICAgICAgIHtkaXNwbGF5UHJvZ3Jlc3MgJiYgPEdvYWxQcm9ncmVzcyB7Li4ucHJvZ3Jlc3NEYXRhfS8+fVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkNvbnRlbnRcIiArIChjb250ZW50Q2xhc3NOYW1lID8gXCIgXCIgKyBjb250ZW50Q2xhc3NOYW1lIDogXCJcIil9PlxyXG4gICAgICAgIHtjaGlsZHJlbn1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgbGVhcm5pbmdHb2FsPzogc3RyaW5nO1xyXG4gIG9uU2F2ZTogKGxlYXJuaW5nR29hbDogc3RyaW5nKSA9PiB2b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGxlYXJuaW5nR29hbDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWRkQ3VzdG9tR29hbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKVxyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgbGVhcm5pbmdHb2FsOiBwcm9wcy5sZWFybmluZ0dvYWwgfHwgJydcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtsZWFybmluZ0dvYWx9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHtvblNhdmV9ID0gdGhpcy5wcm9wcztcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICA8aDI+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxUaXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiTMOkZ2cgdGlsbCBlZ2V0IGzDpHJhbmRlbcOlbFwiLz48L2gyPlxyXG4gICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxcIiBkZWZhdWx0TWVzc2FnZT1cIk3DpWxcIi8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIHRhYkluZGV4PXsxfSBzaXplPXs1MH0gYXV0b0ZvY3VzXHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17bGVhcm5pbmdHb2FsfVxyXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e2UgPT4gdGhpcy5zZXRTdGF0ZSh7bGVhcm5pbmdHb2FsOiBlLnRhcmdldC52YWx1ZX0pfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCIgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGJyIC8+PC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxyXG4gICAgICAgICAgb25DbGljaz17KCk9Pm9uU2F2ZShsZWFybmluZ0dvYWwpfT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCJzYXZlXCIvPjwvYnV0dG9uPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBUZXh0SW5wdXQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0LWlucHV0JztcclxuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XHJcbmltcG9ydCB7TGFuZ3VhZ2VDb250ZXh0fSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgaXNUYXNrOiBib29sZWFuXHJcbiAgb25TYXZlOiAobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFkZEN1c3RvbVRhc2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcylcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIG5hbWU6ICcnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJycsXHJcbiAgICAgIHVybDogJydcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHVybCB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHsgaXNUYXNrLCBvblNhdmUgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIDxoMj48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImN1c3RvbVRhc2suYWRkV29ya0dvYWxUaXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiTMOkZ2cgdGlsbCBlZ2V0IGFyYmV0c23DpWxcIi8+PC9oMj5cclxuICAgICAgICA8aHIgLz5cclxuICAgICAgICA8VGV4dElucHV0XHJcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLm5hbWVMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOiAnTmFtbid9KX1cclxuICAgICAgICAgIGlkPVwiQWRkQ3VzdG9tVGFzazpuYW1lXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidjdXN0b21UYXNrLmVudGVyTmFtZVBsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ0FuZ2UgbmFtbi4uLid9KX1cclxuICAgICAgICAgIHZhbHVlPXtuYW1lfVxyXG4gICAgICAgICAgYXV0b0ZvY3VzXHJcbiAgICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XHJcblxyXG4gICAgICAgIDxUZXh0QXJlYUZvcm1GaWVsZFxyXG4gICAgICAgICAgcm93cz17N31cclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonQmVza3Jpdm5pbmcnfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZEN1c3RvbVRhc2s6ZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J2NvbW1vbi5hZGREZXNjcmlwdGlvblBsaGQnLCBkZWZhdWx0TWVzc2FnZTogXCJMw6RnZyB0aWxsIGVuIGJlc2tyaXZuaW5nLi4uXCJ9KX1cclxuICAgICAgICAgIHZhbHVlPXtkZXNjcmlwdGlvbn1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbj0+dGhpcy5zZXRTdGF0ZSh7ZGVzY3JpcHRpb259KX0gLz5cclxuXHJcbiAgICAgICAgPFRleHRJbnB1dFxyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidjb21tb24ubGlua0xhYmVsJywgZGVmYXVsdE1lc3NhZ2U6J0zDpG5rJ30pfSBcclxuICAgICAgICAgIGlkPVwiQWRkQ3VzdG9tVGFzazp1cmxcIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJodHRwOi8vd3d3Li4uXCJcclxuICAgICAgICAgIHZhbHVlPXt1cmx9XHJcbiAgICAgICAgICBvbkNoYW5nZT17dXJsID0+IHRoaXMuc2V0U3RhdGUoe3VybH0pfSAvPlxyXG5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxyXG4gICAgICAgICAgb25DbGljaz17KCkgPT4gb25TYXZlKG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwpfT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCJTcGFyYVwiLz48L2J1dHRvbj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XHJcbmltcG9ydCB7IFRleHRBcmVhRm9ybUZpZWxkIH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dGFyZWEnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xyXG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xyXG5pbXBvcnQge0xhbmd1YWdlQ29udGV4dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XHJcblxyXG50eXBlIFByb3BzID0ge1xyXG4gIC8vIEVkaXQgTW9kZVxyXG4gIG1vZGU6ICdhZGQnO1xyXG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcclxuICBjbG9zZURpYWxvZztcclxuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXHJcbn0gfCB7XHJcbiAgbW9kZTogJ2VkaXQnO1xyXG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcclxuICBzdWJUYXNrOiBVc2VyU3ViVGFzaztcclxuICBjbG9zZURpYWxvZzogKCk9PnZvaWQ7XHJcbiAgdXNlclRhc2tzUmVwbzogVXNlclRhc2tzUmVwb1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHVybDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWRkT3JFZGl0U3ViVGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XHJcbiAgICAgIGNvbnN0IHtzdWJUYXNrfSA9IHByb3BzO1xyXG4gICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgIG5hbWU6IHN1YlRhc2submFtZSB8fCAnJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogc3ViVGFzay5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICB1cmw6IHN1YlRhc2sudXJsIHx8ICcnXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2UgeyAgXHJcbiAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxyXG4gICAgICAgIHVybDogJydcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNhdmUoKSB7XHJcbiAgICAvLyBVcGRhdGUgcmVwbzpcclxuICAgIGNvbnN0IHtwcm9wc30gPSB0aGlzO1xyXG4gICAgY29uc3Qge3VzZXJUYXNrLCBjbG9zZURpYWxvZywgdXNlclRhc2tzUmVwb30gPSBwcm9wcztcclxuICAgIGNvbnN0IHtuYW1lLCBkZXNjcmlwdGlvbiwgdXJsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XHJcbiAgICAgIC8vIEVkaXQgZXhpc3Rpbmc6XHJcbiAgICAgIHVzZXJUYXNrc1JlcG8udXBkYXRlKFt1c2VyVGFza10sIHV0ID0+IHtcclxuICAgICAgICBjb25zdCB7c3ViVGFza3N9ID0gdXQ7XHJcbiAgICAgICAgaWYgKHN1YlRhc2tzKSB7XHJcbiAgICAgICAgICB1dC5zdWJUYXNrcyA9IHN1YlRhc2tzLm1hcChzdCA9PlxyXG4gICAgICAgICAgICBzdC5pZCA9PT0gcHJvcHMuc3ViVGFzay5pZCA/IHsuLi5zdCwgbmFtZSwgZGVzY3JpcHRpb24sIHVybH0gOlxyXG4gICAgICAgICAgICB7Li4uc3R9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBDcmVhdGUgbmV3IHRhc2tcclxuICAgICAgY29uc3QgbmV3U3ViVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgdXJsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBVcGRhdGUgcmVwbzpcclxuICAgICAgdXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXQgPT4ge1xyXG4gICAgICAgIGlmICghdXQuc3ViVGFza3MpIHtcclxuICAgICAgICAgIHV0LnN1YlRhc2tzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHV0LnN1YlRhc2tzID0gdXQuc3ViVGFza3MuY29uY2F0KG5ld1N1YlRhc2spO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDbG9zZSBkaWFsb2dcclxuICAgIGNsb3NlRGlhbG9nKCk7ICAgIFxyXG4gIH1cclxuXHJcbiAgZGVsZXRlKCkge1xyXG4gICAgLy8gVXBkYXRlIHJlcG86XHJcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7ICBcclxuICAgIGlmIChwcm9wcy5tb2RlICE9PSAnZWRpdCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuIG9ubHkgZGVsZXRlIGluIGVkaXQgbW9kZVwiKTtcclxuICAgIH1cclxuICAgIHByb3BzLnVzZXJUYXNrc1JlcG8udXBkYXRlKFtwcm9wcy51c2VyVGFza10sIHV0ID0+IHtcclxuICAgICAgaWYgKHV0LnN1YlRhc2tzKSB7XHJcbiAgICAgICAgdXQuc3ViVGFza3MgPSB1dC5zdWJUYXNrcy5maWx0ZXIodCA9PiB0LmlkICE9PSBwcm9wcy5zdWJUYXNrLmlkKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xvc2UgZGlhbG9nOlxyXG4gICAgcHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtuYW1lLCBkZXNjcmlwdGlvbiwgdXJsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCB7cHJvcHN9ID0gdGhpcztcclxuICAgIGNvbnN0IGlzRWRpdE1vZGUgPSBwcm9wcy5tb2RlID09PSAnZWRpdCc7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICByZXR1cm4gPD5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIDxoMj57aXNFZGl0TW9kZSA/IDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiYWRkZWRpdHN1YnRhc2suZWRpdFN1YnRhc2tcIiBkZWZhdWx0TWVzc2FnZT0nUmVkaWdlcmEgdW5kZXJ1cHBnaWZ0Jy8+IDogPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5hZGRTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9J0zDpGdnIHRpbGwgdW5kZXJ1cHBnaWZ0Jy8+IH08L2gyPlxyXG4gICAgICAgIDxociAvPlxyXG4gICAgICAgIDxUZXh0SW5wdXRcclxuICAgICAgICAgIGF1dG9Gb2N1c1xyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidhZGRlZGl0c3VidGFzay5uYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonVW5kZXJ1cHBnaWZ0ZW5zIG5hbW4nfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZFVzZXJTdWJUYXNrOm5hbWVcIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxyXG4gICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUubmFtZX1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtuYW1lID0+IHRoaXMuc2V0U3RhdGUoe25hbWV9KX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICA8VGV4dEFyZWFGb3JtRmllbGRcclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonQmVza3Jpdm5pbmcnfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZFVzZXJTdWJUYXNrOmRlc2NyaXB0aW9uXCJcclxuICAgICAgICAgIHJvd3M9ezd9XHJcbiAgICAgICAgICBwbGFjZWhvbGRlcj1cIlwiXHJcbiAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5kZXNjcmlwdGlvbn1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbiA9PiB0aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgIDxUZXh0SW5wdXRcclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOidMw6Ruayd9KX1cclxuICAgICAgICAgIGlkPVwiQWRkVXNlclN1YlRhc2s6dXJsXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiXCJcclxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnVybH1cclxuICAgICAgICAgIG9uQ2hhbmdlPXt1cmwgPT4gdGhpcy5zZXRTdGF0ZSh7dXJsfSl9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgPGJyIC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcHJvcHMubW9kZSA9PT0gJ2VkaXQnICYmIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCJcclxuICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+IHRoaXMuZGVsZXRlKCl9PlxyXG4gICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5kZWxldGVTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IHVuZGVydXBwZ2lmdFwiLz48L2J1dHRvbj59XHJcbiAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLnNhdmUoKX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwiU3BhcmFcIi8+PC9idXR0b24+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC8+XHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgUmVuYW1lYWJsZVRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvcmVuYW1lYWJsZS10ZXh0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgZ2V0VGFza1R5cGUgfSBmcm9tICcuL2dldC10YXNrLXR5cGUnO1xyXG5pbXBvcnQgUmVhY3REYXRlUGlja2VyLCB7IFJlYWN0RGF0ZVBpY2tlclByb3BzIH0gZnJvbSAncmVhY3QtZGF0ZXBpY2tlcic7XHJcbmltcG9ydCAnLi4vLi4vZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlJztcclxuaW1wb3J0IHtUZXh0SW5wdXR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkJztcclxuaW1wb3J0IHsgQWRkT3JFZGl0U3ViVGFzayB9IGZyb20gJy4vYWRkLW9yLWVkaXQtc3ViLXRhc2snO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyBVc2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcclxuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XHJcbmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gXCIuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0XCJcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgdXNlclRhc2s6IFVzZXJUYXNrO1xyXG4gIG9uVXBkYXRlOiAodXBkYXRlcjogKHVzZXJUYXNrOiBVc2VyVGFzaykgPT4gdm9pZCkgPT4gdm9pZDtcclxuICBvbkRlbGV0ZTogKHVzZXJUYXNrSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuICBvcGVuRGlhbG9nOiAoZGlhbG9nKSA9PiB2b2lkO1xyXG4gIGNsb3NlRGlhbG9nOiAoKT0+dm9pZDtcclxuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgdXNlclRhc2s6IFVzZXJUYXNrO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbj86IHN0cmluZztcclxuICBkZWFkbGluZT86IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBzdWJUYXNrcz86IFVzZXJTdWJUYXNrW107XHJcbiAgc2hvd0NhbGVuZGFyPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVkaXRVc2VyVGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGRhdGVQaWNrZXI6IGFueTtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgdXNlclRhc2s6IHByb3BzLnVzZXJUYXNrLFxyXG4gICAgICBuYW1lOiBwcm9wcy51c2VyVGFzay5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcHJvcHMudXNlclRhc2suZGVzY3JpcHRpb24sXHJcbiAgICAgIHVybDogcHJvcHMudXNlclRhc2sudXJsLFxyXG4gICAgICBkZWFkbGluZTogcHJvcHMudXNlclRhc2suZGVhZGxpbmUsXHJcbiAgICAgIHN1YlRhc2tzOiBwcm9wcy51c2VyVGFzay5zdWJUYXNrc1xyXG4gICAgfVxyXG4gICAgdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQgPSB0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG8uc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIG9uVXNlclRhc2tzQ2hhbmdlZCh1c2VyVGFza3M6IFVzZXJUYXNrW10pIHtcclxuICAgIGNvbnN0IG15VXNlclRhc2sgPSB1c2VyVGFza3MuZmluZCh1dCA9PiB1dC5pZCA9PT0gdGhpcy5wcm9wcy51c2VyVGFzay5pZCk7XHJcbiAgICBpZiAoIW15VXNlclRhc2spIHtcclxuICAgICAgdGhpcy5wcm9wcy5jbG9zZURpYWxvZygpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgdXNlclRhc2s6IG15VXNlclRhc2ssXHJcbiAgICAgIHN1YlRhc2tzOiBteVVzZXJUYXNrLnN1YlRhc2tzXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgdGhpcy5wcm9wcy51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIGlzTW9kaWZpZWQoKSB7XHJcbiAgICAvLyBEb24ndCBjb3VudCBzdWJ0YXNrIGNoYW5nZXMhIFRoZXkgbGl2ZSB0aGVpciBvd24gbGlmZSBhbmQgaXMgbWFpbnRhaW5lZFxyXG4gICAgLy8gaW4gYWRkLW9yLWVkaXQtc3ViLXRhc2sudHN4LiBSZWFzb246IFVzZXIgd291bGQgZXhwZWN0IGFkZGVkIC9lZGl0ZWQgc3VidGFza3NcclxuICAgIC8vIHRvIGJlIHBlcnNpc3RlZCByaWdodCBhd2F5LiBNYXkgY2xpY2sgYXdheSB0aGlzIGRpYWxvZy5cclxuICAgIC8vIEFsc28gcmVhc29uOiBDYW4gaW52b2tlIHRoYXQgZGlhbG9nIGJ5IGl0c2VsZiBmcm9tIG90aGVyIGNvbXBvbmVudHMuIEZyb20gV2Vla1BsYW5uZXJcclxuICAgIC8vIHdoZW4gY2xpY2tpbmcgdGhlIHN1YnRhc2sgZm9yIGV4YW1wbGUhXHJcblxyXG4gICAgY29uc3Qge2RlYWRsaW5lLCBkZXNjcmlwdGlvbiwgbmFtZSwgdXJsLCB1c2VyVGFza30gPSB0aGlzLnN0YXRlO1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZGVhZGxpbmUgIT09IHVzZXJUYXNrLmRlYWRsaW5lIHx8XHJcbiAgICAgIGRlc2NyaXB0aW9uICE9PSB1c2VyVGFzay5kZXNjcmlwdGlvbiB8fFxyXG4gICAgICBuYW1lICE9PSB1c2VyVGFzay5uYW1lIHx8XHJcbiAgICAgIHVybCAhPT0gdXNlclRhc2sudXJsKTtcclxuICB9XHJcblxyXG4gIGFkZFN1YlRhc2soKTogYW55IHtcclxuICAgIHRoaXMucHJvcHMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xyXG4gICAgICBtb2RlPVwiYWRkXCJcclxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XHJcbiAgICAgIGNsb3NlRGlhbG9nPXt0aGlzLnByb3BzLmNsb3NlRGlhbG9nfVxyXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XHJcbiAgICAvPik7XHJcbiAgfVxyXG5cclxuICBlZGl0U3ViVGFzayhzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xyXG4gICAgdGhpcy5wcm9wcy5vcGVuRGlhbG9nKDxBZGRPckVkaXRTdWJUYXNrXHJcbiAgICAgIG1vZGU9XCJlZGl0XCJcclxuICAgICAgc3ViVGFzaz17c3ViVGFza31cclxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XHJcbiAgICAgIGNsb3NlRGlhbG9nPXt0aGlzLnByb3BzLmNsb3NlRGlhbG9nfVxyXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XHJcbiAgICAvPik7XHJcbiAgfVxyXG4gIFxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHVybCwgZGVhZGxpbmUsIHN1YlRhc2tzLCBzaG93Q2FsZW5kYXIsIHVzZXJUYXNrIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgeyBpZCwgY291cnNlTmFtZSB9ID0gdXNlclRhc2s7XHJcbiAgICBjb25zdCB7IG9uVXBkYXRlLCBvbkRlbGV0ZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IGlzTW9kaWZpZWQgPSB0aGlzLmlzTW9kaWZpZWQoKTtcclxuXHJcbiAgICBjb25zdCB0YXNrVHlwZSA9IGdldFRhc2tUeXBlKHVzZXJUYXNrKTtcclxuICAgIGNvbnN0IGlzQ3VzdG9tVGFzayA9IHRhc2tUeXBlID09PSAnY3VzdG9tVGFzayc7XHJcbiAgICBjb25zdCBleHBpcmVkID0gbW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKSA8IG1vbWVudCgpO1xyXG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5jb250ZXh0O1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImVkaXRUYXNrRGlhbG9nIHN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxoMj57aXNDdXN0b21UYXNrID8gXHJcbiAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLmVkaXRXb3JrR29hbHNcIiBkZWZhdWx0TWVzc2FnZT0nUmVkaWdlcmEgYXJiZXRzbcOlbCcvPiA6IFxyXG4gICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGFzay5lZGl0VGFza1wiIGRlZmF1bHRNZXNzYWdlPSdSZWRpZ2VyYSB1cHBnaWZ0Jy8+fVxyXG4gICAgICA8L2gyPlxyXG4gICAgICA8aHIgLz5cclxuICAgICAgPFRleHRJbnB1dFxyXG4gICAgICAgIGF1dG9Gb2N1c1xyXG4gICAgICAgIGxhYmVsPXtpc0N1c3RvbVRhc2sgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndGFzay50YXJnZXROYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTogJ0FyYmV0c23DpWxldHMgbmFtbid9KSAgOiBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndGFzay50YXNrTmFtZUxhYmVsJywgZGVmYXVsdE1lc3NhZ2U6ICdVcHBnaWZ0ZW5zIG5hbW4nfSl9XHJcbiAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6bmFtZVwiXHJcbiAgICAgICAgcGxhY2Vob2xkZXI9e2lzQ3VzdG9tVGFzayA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLndoYXRTaG91bGRZb3VEb1BsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ1ZhZCBza2EgZHUgZ8O2cmE/J30pIDogaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2suZW50ZXJUYXNrTmFtZVBsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ0FuZ2UgdXBwZ2lmdGVucyBuYW1uLi4uJ30pIH1cclxuICAgICAgICB2YWx1ZT17bmFtZX1cclxuICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XHJcbiAgICAgIFxyXG4gICAgICB7aXNDdXN0b21UYXNrICYmIDw+XHJcbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXHJcbiAgICAgICAgICByb3dzPXs1fVxyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAnY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTogJ0Jlc2tyaXZuaW5nJ30pfVxyXG4gICAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6ZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICdjb21tb24uYWRkRGVzY3JpcHRpb25QbGhkJywgZGVmYXVsdE1lc3NhZ2U6ICdMw6RnZyB0aWxsIGVuIGJlc2tyaXZuaW5nLi4uJ30pfVxyXG4gICAgICAgICAgdmFsdWU9e2Rlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uPT50aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfSAvPlxyXG5cclxuICAgICAgICA8VGV4dElucHV0XHJcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOlwiTMOkbmtcIn0pfVxyXG4gICAgICAgICAgaWQ9XCJFZHV0VXNlclRhc2s6dXJsXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiaHR0cChzKTovLy4uLlwiXHJcbiAgICAgICAgICB2YWx1ZT17dXJsfVxyXG4gICAgICAgICAgb25DaGFuZ2U9e3VybCA9PiB0aGlzLnNldFN0YXRlKHt1cmx9KX0gPlxyXG5cclxuICAgICAgICA8L1RleHRJbnB1dD48Lz59XHJcblxyXG4gICAgICAgIDxGb3JtRmllbGQgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLnNldERlYWRsaW5lJywgZGVmYXVsdE1lc3NhZ2U6ICdBbmdlIGRlYWRsaW5lJ30pfT5cclxuICAgICAgICAgIHsoZGVhZGxpbmUgfHwgc2hvd0NhbGVuZGFyKSA/XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICA8UmVhY3REYXRlUGlja2VyIHJlZj17ZWxlbSA9PiB0aGlzLmRhdGVQaWNrZXIgPSBlbGVtfVxyXG4gICAgICAgICAgICAgICAgICBpZD1cIkVkaXRVc2VyVGFzazpkZWFkbGluZVwiXHJcbiAgICAgICAgICAgICAgICAgIG5leHRNb250aEJ1dHRvbkxhYmVsPVwiXCIgXHJcbiAgICAgICAgICAgICAgICAgIHByZXZpb3VzTW9udGhCdXR0b25MYWJlbD1cIlwiIFxyXG4gICAgICAgICAgICAgICAgICBzaG93V2Vla051bWJlcnM9e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkPXtkZWFkbGluZSAmJiBtb21lbnQoZGVhZGxpbmUpLnRvRGF0ZSgpfVxyXG4gICAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e3Nob3dDYWxlbmRhcn1cclxuICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdD1cInl5eXktTU0tZGRcIlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2V4cGlyZWQgPyBcImV4cGlyZWRcIiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgICAgbG9jYWxlPXtpbnRsLmxvY2FsZX1cclxuICAgICAgICAgICAgICAgICAgcG9wcGVyUGxhY2VtZW50PXtpc0N1c3RvbVRhc2sgPyBcInRvcC1zdGFydFwiIDogXCJib3R0b20tc3RhcnRcIn1cclxuICAgICAgICAgICAgICAgICAgb25CbHVyPXsoKT0+dGhpcy5zZXRTdGF0ZSh7c2hvd0NhbGVuZGFyOiBmYWxzZX0pfVxyXG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dmFsdWU9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRlYWRsaW5lOiB2YWx1ZSAmJiBtb21lbnQodmFsdWUpLmZvcm1hdChcIllZWVktTU0tRERcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FsZW5kYXI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJkZWxldGVEYXRlXCIgaHJlZj1cIiNcIiB0aXRsZT17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2sucmVtb3ZlRGVhZGxpbmUnLCBkZWZhdWx0TWVzc2FnZTogJ1RhIGJvcnQgZGVhZGxpbmUnfSl9IG9uQ2xpY2s9e2V2PT57XHJcbiAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2RlYWRsaW5lOiBudWxsLCBzaG93Q2FsZW5kYXI6IGZhbHNlfSk7XHJcbiAgICAgICAgICAgICAgICB9fT48L2E+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PiA6XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9wXCIgcmVmPXsoKT0+e3RoaXMuZGF0ZVBpY2tlciA9IG51bGx9fT5cclxuICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0ZVBpY2tlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0ZVBpY2tlci5zZXRPcGVuKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dDYWxlbmRhcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2FsZW5kYXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnNldERlYWRsaW5lTGFiZWxcIiBkZWZhdWx0TWVzc2FnZT1cIkFuZ2UgZGVhZGxpbmUuLi5cIi8+XHJcbiAgICAgICAgICAgICAgPC9hPiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2suc3ViVGFza3MnLCBkZWZhdWx0TWVzc2FnZTogJ1VuZGVydXBwZ2lmdGVyJ30pfSA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcblxyXG4gICAgICAgICAgICAgIHtzdWJUYXNrcyAmJiBzdWJUYXNrcy5tYXAoc3ViVGFzayA9PiA8ZGl2IGtleT17c3ViVGFzay5pZH0gY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj48YVxyXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5lZGl0U3ViVGFzayhzdWJUYXNrKX1cclxuICAgICAgICAgICAgICAgICAgaHJlZj1cIiNcIj57c3ViVGFzay5uYW1lfTwvYT48L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRvcFwiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiRWRpdFVzZXJUYXNrOmFkZFN1YlRhc2tcIiBjbGFzc05hbWU9XCJidG5cIlxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLmFkZFN1YlRhc2soKX0+XHJcbiAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtcGx1c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLmFkZFN1YnRhc2tcIiBkZWZhdWx0TWVzc2FnZT1cIkzDpGdnIHRpbGwgdW5kZXJ1cHBnaWZ0XCIvPlxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZpZGVyIGxhcmdlXCIgLz5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsQnV0dG9uIHRvcFwiPlxyXG4gICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgICAgb25DbGljaz17KCk9PntcclxuICAgICAgICAgICAgICBpc01vZGlmaWVkID8gb25VcGRhdGUodXNlclRhc2sgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICB1c2VyVGFzay5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2sudXJsID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2suZGVhZGxpbmUgPSBkZWFkbGluZTtcclxuICAgICAgICAgICAgICB9KSA6IHRoaXMucHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgfX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwiU3BhcmFcIi8+IFxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxCdXR0b24gdG9wXCI+XHJcbiAgICAgICAgICA8YnV0dG9uIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJidG5cIlxyXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xyXG4gICAgICAgICAgICAgIHRoaXMucHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgfX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uY2FuY2VsXCIgZGVmYXVsdE1lc3NhZ2U9XCJBdmJyeXRcIi8+PC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25maXJtIHRvcCBwdWxsLXJpZ2h0XCI+XHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmdcIlxyXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xyXG4gICAgICAgICAgICAgIG9uRGVsZXRlKGlkKTtcclxuICAgICAgICAgICAgfX0+e2lzQ3VzdG9tVGFzayA/XHJcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnJlbW92ZVdvcmtHb2Fsc1wiIGRlZmF1bHRNZXNzYWdlPVwiVGEgYm9ydCBhcmJldHNtw6VsXCIvPiA6XHJcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnJlbW92ZVRoaXNUYXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IGRlbiBow6RyIHVwcGdpZnRlblwiLz5cclxuICAgICAgICAgIH08L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICB7Lyo8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiIG9uQ2xpY2s9e2V2ID0+IG9uRGVsZXRlKGlkKX0+XHJcbiAgICAgICAge0xgVGEgYm9ydCBhcmJldHNtw6VsYH08L2Rpdj5cclxuICAgICAge2lzTW9kaWZpZWQgJiZcclxuICAgICAgICA8ZGl2XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgIHRhYkluZGV4PXswfVxyXG4gICAgICAgICAgb25DbGljaz17KCk9Pm9uVXBkYXRlKHVzZXJUYXNrID0+IHtcclxuICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgIHVzZXJUYXNrLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgIHVzZXJUYXNrLnVybCA9IHVybDtcclxuICAgICAgICAgIH0pfT4gU3BhcmE8L2Rpdj59Ki99XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFVzZXJUYXNrIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFza1R5cGUgKHVzZXJUYXNrOiBVc2VyVGFzaykgOiAnY291cnNlQnVpbGRlclRhc2snIHwgJ3NpdGVWaXNpb25UYXNrJyB8ICdzdWJqZWN0UGxhbm5lclRhc2snIHwgJ2N1c3RvbVRhc2snIHtcclxuICByZXR1cm4gdXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2suY291cnNlLmxlbmd0aCA+IDAgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwID9cclxuICAgICdjb3Vyc2VCdWlsZGVyVGFzaycgOlxyXG4gICAgdXNlclRhc2suc2l0ZVZpc2lvblBhZ2VJZCA/XHJcbiAgICAgICdzaXRlVmlzaW9uVGFzaycgOlxyXG4gICAgICAgIHVzZXJUYXNrLmNvdXJzZUluZm8gP1xyXG4gICAgICAgICAgJ3N1YmplY3RQbGFubmVyVGFzaycgOlxyXG4gICAgICAgICAgJ2N1c3RvbVRhc2snO1xyXG59XHJcbiIsImV4cG9ydCB7V2Vla1BsYW5uZXJ9IGZyb20gJy4vd2Vla3BsYW5uZXInO1xyXG4iLCJpbXBvcnQgeyBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgVXNlclRhc2tzQm94UHJvcHMgfSBmcm9tICcuL3VzZXItdGFza3MtYm94JztcclxuaW1wb3J0IHsgYXJyYXlUb01hcCwgYXJyYXlUb0xvb2t1cCwgY29tcGFyZVByb3AsIEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmlydHVhbExlYXJuaW5nR29hbCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGFsbFRhc2tzOiBVc2VyVGFza1tdO1xyXG4gIHN0ZXA/OiBudW1iZXI7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHRhc2tzOiBVc2VyVGFza1tdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVmaW5lKHRhc2tzOiBVc2VyVGFza1tdKSB7XHJcbiAgY29uc3QgcmVzdWx0ID0gW10gYXMgUGFydGlhbDxVc2VyVGFza3NCb3hQcm9wcz5bXTtcclxuICBjb25zdCBtYXBwZXIgPSB7fSBhcyB7IFtuYW1lOiBzdHJpbmddOiBVc2VyVGFza3NCb3hQcm9wcyB9O1xyXG4gIGNvbnN0IHRhc2tzUGVyQ291cnNlID0gYXJyYXlUb0xvb2t1cCh0YXNrcywgdCA9PiB0LmNvdXJzZU5hbWUgfHwgJycpO1xyXG4gIGZvciAoY29uc3QgY291cnNlTmFtZSBvZiBPYmplY3Qua2V5cyh0YXNrc1BlckNvdXJzZSkuc29ydCgpLmZpbHRlcih4ID0+IHgpLmNvbmNhdCh0YXNrc1BlckNvdXJzZVsnJ10gP1xyXG4gICAgWycnXSA6IFtdKSkge1xyXG4gICAgY29uc3QgY291cnNlVGFza3MgPSB0YXNrc1BlckNvdXJzZVtjb3Vyc2VOYW1lXSB8fCB0YXNrc1BlckNvdXJzZVsnJ107XHJcbiAgICBjb25zdCB0YXNrc1BlckxlYXJuaW5nR29hbCA9IGFycmF5VG9Mb29rdXAoY291cnNlVGFza3MsIHQgPT4gdC5sZWFybmluZ0dvYWwpO1xyXG4gICAgY29uc3QgcmVzdWx0TGVhcm5pbmdHb2FsczogVmlydHVhbExlYXJuaW5nR29hbFtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGxlYXJuaW5nR29hbCBvZiBPYmplY3Qua2V5cyh0YXNrc1BlckxlYXJuaW5nR29hbCkpIHtcclxuICAgICAgY29uc3QgbGdUYXNrcyA9IHRhc2tzUGVyTGVhcm5pbmdHb2FsW2xlYXJuaW5nR29hbF0uc29ydChjb21wYXJlUHJvcChcImRhdGVUaW1lXCIpKTtcclxuICAgICAgY29uc3QgbGVhcm5pbmdHb2FsVGFzayA9IGxnVGFza3NcclxuICAgICAgICAuZmlsdGVyKHQgPT4gdC5uYW1lID09IG51bGwpIC8vIElmIG5hbWUgaXMgdW5kZWZpbmVkIG9yIG51bGwsIHRoaXMgcmVwcmVzZW50cyBhIGxlYXJuaW5nIGdvYWxcclxuICAgICAgICBbMF07XHJcbiAgICAgIGNvbnN0IHVybCA9IGxlYXJuaW5nR29hbFRhc2sgJiYgbGVhcm5pbmdHb2FsVGFzay51cmw7XHJcbiAgICAgIHJlc3VsdExlYXJuaW5nR29hbHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogbGVhcm5pbmdHb2FsLFxyXG4gICAgICAgIGFsbFRhc2tzOiBsZ1Rhc2tzLFxyXG4gICAgICAgIHVybCxcclxuICAgICAgICBzdGVwOiBsZ1Rhc2tzLm1hcCh0ID0+IHQuc3RlcCkuZmlsdGVyKHN0ZXAgPT4gc3RlcClbMF0sXHJcbiAgICAgICAgdGFza3M6IGxnVGFza3MuZmlsdGVyKHQgPT4gdC5uYW1lKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJlc3VsdC5wdXNoKHtcclxuICAgICAgY291cnNlTmFtZSxcclxuICAgICAgbGVhcm5pbmdHb2FsczogcmVzdWx0TGVhcm5pbmdHb2Fsc1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5pbXBvcnQgeyBjb3Vyc2VOYW1lVG9Dc3NDbGFzcyB9IGZyb20gJy4uL2NhbGVuZGFyL2NvdXJzZS1uYW1lLXRvLWNzcy1jbGFzcyc7XHJcbmltcG9ydCB7IGdldFRhc2tUeXBlIH0gZnJvbSAnLi9nZXQtdGFzay10eXBlJztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBWaXJ0dWFsTGVhcm5pbmdHb2FsIH0gZnJvbSAnLi9yZWZpbmVyJztcclxuaW1wb3J0IHsgRmVhdHVyZXMgfSBmcm9tICcuLi8uLi9mZWF0dXJlcyc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2VyVGFza3NCb3hQcm9wcyB7XHJcbiAgY291cnNlTmFtZTogc3RyaW5nO1xyXG4gIGxlYXJuaW5nR29hbHM6IFZpcnR1YWxMZWFybmluZ0dvYWxbXSxcclxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XHJcbiAgb3BlbkNvdXJzZXM/OiB7IFtwYXRoOiBzdHJpbmddOiBib29sZWFuIH07XHJcbiAgc2V0SXNPcGVuPzogKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIHNldFRhc2tEb25lPzogKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIHNldFN1YlRhc2tEb25lOiAodGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIGFkZE93blRhc2s/OiAoY291cnNlTmFtZTogc3RyaW5nLCBsZWFybmluZ0dvYWxOYW1lOiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgZWRpdFRhc2s6ICh0YXNrOiBVc2VyVGFzaykgPT4gdm9pZDtcclxuICBlZGl0U3ViVGFzazogKHRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaykgPT4gdm9pZDtcclxuICByZW1vdmVMZWFybmluZ0dvYWw6IChsZzogVmlydHVhbExlYXJuaW5nR29hbCk9PnZvaWQ7XHJcbiAgZGlzcGxheVByb2dyZXNzOiBib29sZWFuO1xyXG4gIHByb2dyZXNzRGF0YToge2NvbXBsZXRlZE51bWJlck9mVGFza3M6IG51bWJlciwgbnVtYmVyT2ZUYXNrczogbnVtYmVyfTtcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBVc2VyVGFza3NCb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8VXNlclRhc2tzQm94UHJvcHM+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFVzZXJUYXNrc0JveFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICBjb3Vyc2VOYW1lLFxyXG4gICAgICBsZWFybmluZ0dvYWxzLCBcclxuICAgICAgcHJvZ3Jlc3NEYXRhLFxyXG4gICAgICBkaXNwbGF5UHJvZ3Jlc3NcclxuICAgIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgaXNPcGVuID0gISF0aGlzLnByb3BzLm9wZW5Db3Vyc2VzW2NvdXJzZU5hbWVdO1xyXG4gICAgY29uc3QgZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcclxuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcclxuXHJcbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveFxyXG4gIHRpdGxlPXs8aDU+e2NvdXJzZU5hbWUgfHwgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ1c2VyVGFza3MuZ29hbHNcIiAgZGVmYXVsdE1lc3NhZ2U9XCJFZ25hIGzDpHJhbmRlbcOlbFwiLz4gfTwvaDU+fVxyXG4gICAgICBoZWFkZXJPcGVuPXtpc09wZW59XHJcbiAgICAgIGNsYXNzTmFtZT17Y291cnNlTmFtZSAmJiBjb3Vyc2VOYW1lVG9Dc3NDbGFzcygnd3AtY291cnNlLScsIGNvdXJzZU5hbWUpfVxyXG4gICAgICBvbk9wZW5DbG9zZT17YmVjYW1lT3BlbiA9PiB0aGlzLnByb3BzLnNldElzT3Blbihjb3Vyc2VOYW1lLCBiZWNhbWVPcGVuKX1cclxuICAgICAgZGlzcGxheVByb2dyZXNzPSB7ZGlzcGxheVByb2dyZXNzfSAgICAgICBcclxuICAgICAgcHJvZ3Jlc3NEYXRhID0ge3Byb2dyZXNzRGF0YX1cclxuICAgICAgPlxyXG4gICAgICB7bGVhcm5pbmdHb2Fscy5tYXAobGcgPT5cclxuICAgICAgICA8ZGl2IGtleT17bGcubmFtZX0gY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICB7bGcuc3RlcCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN0ZXBJbmRpY2F0b3JcIj57bGcuc3RlcH08L2Rpdj59XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUZXh0IGhvcml6b250YWxJdGVtIHRvcFwiPntsZy5uYW1lfTwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XHJcbiAgICAgICAgICAgICAgJm5ic3A7PGFcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRyYXNoXCJcclxuICAgICAgICAgICAgICAgIGhyZWY9XCIjXCJcclxuICAgICAgICAgICAgICAgICB0aXRsZT17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDondXNlclRhc2tzLmRlbGV0ZUxlYXJuaW5nR29hbCcsIGRlZmF1bHRNZXNzYWdlOiAnVGEgYm9ydCBsw6RyYW5kZW3DpWxldCBvY2ggZGVzcyB1cHBnaWZ0ZXInfSl9XHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtldj0+e1xyXG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnJlbW92ZUxlYXJuaW5nR29hbChsZyk7XHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXRyYXNoXCIgLz5cclxuICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICAgICAgICB7bGcudGFza3MubWFwKHVzZXJUYXNrID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ3VwZGF0aW5nJztcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXNrVHlwZSA9IGdldFRhc2tUeXBlKHVzZXJUYXNrKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZWQgPSBtb21lbnQodXNlclRhc2suZGVhZGxpbmUpLnN0YXJ0T2YoJ2RheScpIDwgbW9tZW50KCkuc3RhcnRPZignZGF5Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxkaXYga2V5PXt1c2VyVGFzay5pZH0gc3R5bGU9e2lzV29ya2luZyA/IHsgb3BhY2l0eTogMC41IH0gOiB7fX0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKHVzZXJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZXYgPT4gIWlzV29ya2luZyAmJiB0aGlzLnByb3BzLnNldFRhc2tEb25lKHVzZXJUYXNrLCAhdXNlclRhc2suZG9uZSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIHt0YXNrVHlwZSA9PT0gJ2NvdXJzZUJ1aWxkZXJUYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dldFRhc2tVcmwodXNlclRhc2ssIHRoaXMucHJvcHMudmlld0NvdXJzZVVybCl9Pnt1c2VyVGFzay5uYW1lfTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgIHRhc2tUeXBlID09PSAnc3ViamVjdFBsYW5uZXJUYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dldFN1YmplY3RQbGFubmVyVGFza1VybCh1c2VyVGFzayl9Pnt1c2VyVGFzay5uYW1lfTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrVHlwZSA9PT0gJ3NpdGVWaXNpb25UYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17dXNlclRhc2sudXJsfT57dXNlclRhc2submFtZX08L2E+IDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXshdXNlclRhc2sudXJsID8gXCJsaW5rLWxlc3NcIjogXCJcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e3VzZXJUYXNrLnVybCB8fCB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ9eyh1c2VyVGFzay51cmwrJycpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChsb2NhdGlvbi5ob3N0LnRvTG93ZXJDYXNlKCkpID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfc2VsZlwiIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA+e3VzZXJUYXNrLm5hbWV9PC9hPn1cclxuICAgICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5kZWFkbGluZSAmJiA8ZGl2IGNsYXNzTmFtZT17XCJkYXRlU2V0XCIgKyAoZXhwaXJlZCA/ICcgZXhwaXJlZCcgOiAnJyl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aSB0aXRsZT17bW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKS5mb3JtYXQoXCJZWVlZLU1NLUREXCIpfSBjbGFzc05hbWU9XCJmYSBmYS1jYWxlbmRhclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCk9Pnt9fT48L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgdGFza0VkaXRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmVkaXRUYXNrKHVzZXJUYXNrKX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PiBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICB7dXNlclRhc2suc3ViVGFza3MgJiYgPGRpdiBjbGFzc05hbWU9XCJzdWJ0YXNrc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5zdWJUYXNrcy5tYXAoc3ViVGFzayA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e3N1YlRhc2suaWR9ID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArIChzdWJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpc1dvcmtpbmcgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZXRTdWJUYXNrRG9uZSh1c2VyVGFzaywgc3ViVGFzaywgIXN1YlRhc2suZG9uZSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZj17c3ViVGFzay51cmwgfHwgdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PXsodXNlclRhc2sudXJsKycnKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobG9jYXRpb24uaG9zdC50b0xvd2VyQ2FzZSgpKSA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9zZWxmXCIgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRhc2sudXJsID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsaW5rLWxlc3MnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfT57c3ViVGFzay5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHRhc2tFZGl0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmVkaXRTdWJUYXNrKHVzZXJUYXNrLCBzdWJUYXNrKX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxlYXJuaW5nR29hbFRvb2xzXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGFkZE93bkdvYWxcIlxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMuYWRkT3duVGFzayh0aGlzLnByb3BzLmNvdXJzZU5hbWUsIGxnLm5hbWUpfT5cclxuICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wbHVzXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD0ndXNlclRhc2tzLmFkZExlYXJuaW5nR29hbCcgZGVmYXVsdE1lc3NhZ2U9J0VnZXQgYXJiZXRzbcOlbCcvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICA8L09wZW5DbG9zZUJveD5cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRhc2tVcmwodXNlclRhc2s6IFVzZXJUYXNrLCB2aWV3Q291cnNlVXJsOiBzdHJpbmcpIHtcclxuICBpZiAodXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLmNvdXJzZS5sZW5ndGggPiAwICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XHJcbiAgICBjb25zdCBjb3Vyc2VVcmwgPSBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSh2aWV3Q291cnNlVXJsLCB7IGNvdXJzZUlkOiB1c2VyVGFzay5jb3Vyc2VbMF0uaWQgfSk7XHJcbiAgICByZXR1cm4gYCR7Y291cnNlVXJsfSMvdGFzay8ke3VzZXJUYXNrLnRhc2tbMF0uaWR9YDtcclxuICB9XHJcbiAgcmV0dXJuIHVzZXJUYXNrLnVybDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3ViamVjdFBsYW5uZXJUYXNrVXJsKHVzZXJUYXNrOiBVc2VyVGFzaykge1xyXG4gIGlmICh1c2VyVGFzay5jb3Vyc2VJbmZvICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XHJcbiAgICBjb25zdCB7c2Nob29sLCBjb3Vyc2UsIHRhYiB9ID0gdXNlclRhc2suY291cnNlSW5mbztcclxuICAgIGNvbnN0IGNvdXJzZVVybCA9IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KGNmZy5LRURfU1VCSkVDVF9QTEFOTkVSX1VSTCwge30pO1xyXG4gICAgcmV0dXJuIGAke2NvdXJzZVVybH0jLyR7c2Nob29sfS9jb3Vyc2VzLyR7Y291cnNlfS90YWJzLyR7dGFifS90YXNrcy8ke3VzZXJUYXNrLnRhc2tbMF0uaWR9YDtcclxuICB9XHJcbiAgcmV0dXJuIHVzZXJUYXNrLnVybDtcclxufVxyXG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IGxvY2FsTW9tZW50IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlJztcclxuXHJcbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIHtcclxuICBzdGF0aWMgRVhQSVJBVElPTl9IT1VSUyA9IDEyO1xyXG4gIHN0YXRpYyBWRVJTSU9OID0gMjtcclxuXHJcbiAgdXNlcjogc3RyaW5nO1xyXG4gIGxhc3RXcml0ZTogbnVtYmVyO1xyXG4gIHdlZWtEYXRlOiBudW1iZXI7XHJcbiAgb3BlbkNvdXJzZXM6IHsgW3BhdGg6IHN0cmluZ106IGJvb2xlYW4gfVxyXG5cclxuICBjb25zdHJ1Y3RvciAodXNlck9yQ29weTogc3RyaW5nIHwgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSkge1xyXG4gICAgaWYgKHR5cGVvZiB1c2VyT3JDb3B5ID09PSAnc3RyaW5nJykge1xyXG4gICAgICB0aGlzLnVzZXIgPSB1c2VyT3JDb3B5O1xyXG4gICAgICB0aGlzLmxhc3RXcml0ZSA9IERhdGUubm93KCk7XHJcbiAgICAgIHRoaXMud2Vla0RhdGUgPSBsb2NhbE1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XHJcbiAgICAgIHRoaXMub3BlbkNvdXJzZXMgPSB7fTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgdXNlck9yQ29weSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgYXN5bmMgbG9hZCh1c2VyOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGNvb2tpZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlMicpO1xyXG4gICAgY29uc3Qgc3RvcmVkRGF0YSA9IGNvb2tpZSAmJiAoSlNPTi5wYXJzZShjb29raWUpIGFzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUpO1xyXG4gICAgY29uc3Qgc3RhdGUgPSBuZXcgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSh1c2VyKTtcclxuICAgIGlmIChzdG9yZWREYXRhKSBPYmplY3QuYXNzaWduKHN0YXRlLCBzdG9yZWREYXRhKTtcclxuXHJcbiAgICByZXR1cm4gc3RhdGUudXNlciA9PT0gdXNlciAmJiAhc3RhdGUuaXNFeHBpcmVkKG1vbWVudCgpKSA/XHJcbiAgICAgIHN0YXRlIDogbmV3IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUodXNlcik7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlKCkge1xyXG4gICAgdGhpcy5sYXN0V3JpdGUgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KHRoaXMpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ1dlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUyJywganNvbik7XHJcbiAgfVxyXG5cclxuICBpc0V4cGlyZWQgKGFzT2Y6IE1vbWVudCkge1xyXG4gICAgICByZXR1cm4gbW9tZW50KHRoaXMubGFzdFdyaXRlKVxyXG4gICAgICAgIC5pc0JlZm9yZShcclxuICAgICAgICAgICAgYXNPZi5hZGQoXHJcbiAgICAgICAgICAgICAgICAwLVdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUuRVhQSVJBVElPTl9IT1VSUywgJ2hvdXJzJylcclxuICAgICAgICApO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrc0JveCB9IGZyb20gJy4vdXNlci10YXNrcy1ib3gnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEh0dHBFcnJvciB9IGZyb20gXCJrZWRiYWNrZW5kL2NsaWVudFwiO1xyXG5pbXBvcnQgeyByZWZpbmUsIFZpcnR1YWxMZWFybmluZ0dvYWwgfSBmcm9tICcuL3JlZmluZXInO1xyXG5pbXBvcnQgeyBFbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBMLCBjb21wYXJlUHJvcCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG4vL2ltcG9ydCB7IEN1c3RvbUdvYWwgfSBmcm9tICcuLi8uLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmltcG9ydCB7IFRTT04gfSBmcm9tICcuLi8uLi91dGlscy90c29uJztcclxuaW1wb3J0IHsgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB9IGZyb20gJy4vd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlJztcclxuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcclxuaW1wb3J0IHsgRGlhbG9ncyB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9kaWFsb2dzJztcclxuaW1wb3J0IHsgQWRkQ3VzdG9tR29hbCB9IGZyb20gJy4vYWRkLWN1c3RvbS1nb2FsJztcclxuaW1wb3J0IHsgQWRkQ3VzdG9tVGFzayB9IGZyb20gJy4vYWRkLWN1c3RvbS10YXNrJztcclxuaW1wb3J0IHsgRWRpdFVzZXJUYXNrIH0gZnJvbSAnLi9lZGl0LXVzZXItdGFzayc7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcclxuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcclxuaW1wb3J0IHsgUGVuZGluZ0pvYiB9IGZyb20gJy4uLy4uL3V0aWxzL3BlbmRpbmctam9iJztcclxuaW1wb3J0IHsgQWRkT3JFZGl0U3ViVGFzayB9IGZyb20gJy4vYWRkLW9yLWVkaXQtc3ViLXRhc2snO1xyXG5pbXBvcnQgeyBnZXRBZGp1c3RlZFdlZWssIEtFRFdlZWssIGdldE5leHRXZWVrRGF0ZSwgZ2V0UHJldldlZWtEYXRlIH0gZnJvbSAnLi4vLi4vdXRpbHMvd2Vla3V0aWwnO1xyXG5pbXBvcnQgeyBGb3JtYXR0ZWRNZXNzYWdlIH0gZnJvbSAncmVhY3QtaW50bCc7XHJcbmltcG9ydCB7TGFuZ3VhZ2VDb250ZXh0fSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuaW1wb3J0IHsgUHJvZ3Jlc3MgfSBmcm9tICcuLi9jaGFydHMvcHJvZ3Jlc3MnO1xyXG5pbXBvcnQge2dldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhfSBmcm9tICcuLi9jaGFydHMvY2hhcnRzLXV0aWxzJ1xyXG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uL2ZlYXR1cmVzJztcclxuXHJcbmNvbnN0IE1BWF9TVFJBVEVHWV9MRU5HVEggPSAxNjM4NDtcclxuY29uc3QgTUFYX0FTU0VTU01FTlRfTEVOR1RIID0gMTYzODQ7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcclxuICBlbnY6IEVudjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICB3ZWVrRGF0ZTogbnVtYmVyO1xyXG4gIGRpYWxvZ3M6IGFueVtdO1xyXG4gIHVzZXJUYXNrczogVXNlclRhc2tbXTtcclxuICBvcGVuQ291cnNlczogeyBbcGF0aDogc3RyaW5nXTogYm9vbGVhbiB9XHJcbiAgc3RyYXRlZ3k/OiBzdHJpbmc7XHJcbiAgYXNzZXNzbWVudD86IHN0cmluZztcclxuICB3ZWVrVGV4dHNVVDogVXNlclRhc2sgfCBudWxsO1xyXG4gIHNhdmluZzogYm9vbGVhbjtcclxuICBpc0xvYWRpbmc6IGJvb2xlYW47XHJcbiAgaXNDb3B5aW5nVGFza3M6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBXZWVrUGxhbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuICB3ZWVrVGV4dHNTYXZpbmdKb2I6IFBlbmRpbmdKb2I7XHJcbiAgc3RhdGljIGNvbnRleHRUeXBlID0gTGFuZ3VhZ2VDb250ZXh0O1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHVzZXJUYXNrczogW10sXHJcbiAgICAgIHdlZWtEYXRlOiBEYXRlLm5vdygpLFxyXG4gICAgICBvcGVuQ291cnNlczoge30sXHJcbiAgICAgIGRpYWxvZ3M6IFtdLFxyXG4gICAgICBzYXZpbmc6IGZhbHNlLFxyXG4gICAgICB3ZWVrVGV4dHNVVDogbnVsbCxcclxuICAgICAgaXNMb2FkaW5nOiB0cnVlLFxyXG4gICAgICBpc0NvcHlpbmdUYXNrczogZmFsc2VcclxuICAgIH1cclxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYiA9IG5ldyBQZW5kaW5nSm9iKCgpPT50aGlzLnNhdmVXZWVrVGV4dHMoKSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xyXG4gICAgdGhpcy53ZWVrVGV4dHNTYXZpbmdKb2Iuc3RvcCgpO1xyXG4gIH1cclxuXHJcbiAgb25DaGFuZ2UodXNlclRhc2tzOiBVc2VyVGFza1tdLCBwZXJzaXN0ZWQ6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUsIHdlZWtUZXh0c1VUOiBVc2VyVGFzaykge1xyXG4gICAgY29uc3QgbmV3U3RhdGUgOiBQYXJ0aWFsPFN0YXRlPiA9IHtcclxuICAgICAgdXNlclRhc2tzLFxyXG4gICAgICB3ZWVrRGF0ZTogcGVyc2lzdGVkLndlZWtEYXRlLFxyXG4gICAgICBvcGVuQ291cnNlczogcGVyc2lzdGVkLm9wZW5Db3Vyc2VzLFxyXG4gICAgICB3ZWVrVGV4dHNVVCxcclxuICAgICAgaXNMb2FkaW5nOiBmYWxzZVxyXG4gICAgfVxyXG4gICAgaWYgKCF0aGlzLnN0YXRlLndlZWtUZXh0c1VUIHx8ICh3ZWVrVGV4dHNVVC5kYXRlVGltZSAhPT0gdGhpcy5zdGF0ZS53ZWVrVGV4dHNVVC5kYXRlVGltZSkpIHtcclxuICAgICAgLy8gQ2hhbmdpbmcgd2Vlay4gUmVzZXQgdG8gbmV3IHdlZWsncyB2YWx1ZXNcclxuICAgICAgbmV3U3RhdGUuc3RyYXRlZ3kgPSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuc3RyYXRlZ3k7XHJcbiAgICAgIG5ld1N0YXRlLmFzc2Vzc21lbnQgPSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuYXNzZXNzbWVudDtcclxuICAgIH1cclxuICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUgYXMgYW55KTsgLy8gUmVhY3QncyB1c2Ugb2YgUGljayBpbnN0ZWFkIG9mIFBhcnRpYWwgbWFrZXMgdGhpbmdzIGNvbXBsZXggaGVyZS5cclxuICB9XHJcblxyXG4gIGlzV2Vla1RleHRzRWRpdGVkKCkge1xyXG4gICAgY29uc3QgeyBzdHJhdGVneSwgYXNzZXNzbWVudCwgd2Vla1RleHRzVVQgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICByZXR1cm4gISF3ZWVrVGV4dHNVVCAmJiAoc3RyYXRlZ3kgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5zdHJhdGVneSB8fCBhc3Nlc3NtZW50ICE9PSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuYXNzZXNzbWVudCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIHNhdmVXZWVrVGV4dHMoKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIlNhdmluZyB0ZXh0cy4uLlwiKTtcclxuICAgIGNvbnN0IHsgc3RyYXRlZ3ksIGFzc2Vzc21lbnQsIHdlZWtUZXh0c1VUIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgaWYgKHRoaXMuaXNXZWVrVGV4dHNFZGl0ZWQoKSkge1xyXG4gICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnVwc2VydCh3ZWVrVGV4dHNVVCwgdXQgPT4ge1xyXG4gICAgICAgIHV0LndlZWtUZXh0cyA9IHsgc3RyYXRlZ3ksIGFzc2Vzc21lbnQgfTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcmV2V2VlaygpIHtcclxuICAgIC8vdGhpcy5zYXZlV2Vla1RleHRzKCk7IFxyXG4gICAgdmFyIHByZXZXZWVrT2JqID0gZ2V0UHJldldlZWtEYXRlKG1vbWVudCh0aGlzLnN0YXRlLndlZWtEYXRlKSk7XHJcbiAgICB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmNoYW5nZVdlZWsocHJldldlZWtPYmoubmV4dERhdGUsIHByZXZXZWVrT2JqLmFkanVzdGVkKTtcclxuICB9XHJcblxyXG4gIG5leHRXZWVrKCkge1xyXG4gICAgLy90aGlzLnNhdmVXZWVrVGV4dHMoKTtcclxuICAgIHZhciBuZXh0V2Vla09iaiA9IGdldE5leHRXZWVrRGF0ZShtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkpO1xyXG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5jaGFuZ2VXZWVrKG5leHRXZWVrT2JqLm5leHREYXRlLCBuZXh0V2Vla09iai5hZGp1c3RlZCk7XHJcbiAgfVxyXG5cclxuICBvcGVuRGlhbG9nKGRpYWxvZykge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRpYWxvZ3M6IFsuLi50aGlzLnN0YXRlLmRpYWxvZ3MsIGRpYWxvZ10gfSk7XHJcbiAgfVxyXG5cclxuICBvcGVuQWRkR29hbERpYWxvZygpIHtcclxuICAgIHRoaXMub3BlbkRpYWxvZyg8QWRkQ3VzdG9tR29hbFxyXG4gICAgICBvblNhdmU9e2FzeW5jIChsZWFybmluZ0dvYWw6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIGlmICghbGVhcm5pbmdHb2FsKSB0aHJvdyBuZXcgRXJyb3IgKHRoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid3ZWVrcGxhbm5lci5lbXB0eUxlYXJuaW5nR29hbEVycicsIGRlZmF1bHRNZXNzYWdlOiAnTMOkcmFuZGVtw6VsZXQga2FuIGludGUgdmFyYSB0b210J30pKTtcclxuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuc2F2aW5nKSB7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiB0cnVlIH0pO1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRDdXN0b21Hb2FsKGxlYXJuaW5nR29hbCk7XHJcbiAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiBmYWxzZSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICB9XHJcbiAgICAgIH19IC8+KTtcclxuICB9XHJcblxyXG4gIG9wZW5BZGRPd25UYXNrRGlhbG9nKGNvdXJzZU5hbWU6IHN0cmluZywgbGVhcm5pbmdHb2FsTmFtZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLm9wZW5EaWFsb2coPEFkZEN1c3RvbVRhc2tcclxuICAgICAgaXNUYXNrPXshY291cnNlTmFtZX1cclxuICAgICAgb25TYXZlPXthc3luYyAobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4ge1xyXG4gICAgICAgIGlmICghbmFtZSkgdGhyb3cgbmV3IEVycm9yICh0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDond2Vla3BsYW5uZXIubmFtZUNhbm5vdEJlRW1wdHknLCBkZWZhdWx0TWVzc2FnZTogJ05hbW5ldCBrYW4gaW50ZSB2YXJhIHRvbXQnfSkpO1xyXG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5zYXZpbmcpIHtcclxuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IHRydWUgfSk7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFkZEN1c3RvbVRhc2soY291cnNlTmFtZSwgbGVhcm5pbmdHb2FsTmFtZSwgbmFtZSwgZGVzY3JpcHRpb24sIHVybCk7XHJcbiAgICAgICAgICB9IGZpbmFsbHkge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiBmYWxzZSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICB9XHJcbiAgICAgIH19IC8+KTtcclxuICB9XHJcblxyXG4gIGVkaXRUYXNrKHVzZXJUYXNrOiBVc2VyVGFzaykge1xyXG4gICAgdGhpcy5vcGVuRGlhbG9nKDxFZGl0VXNlclRhc2tcclxuICAgICAgdXNlclRhc2tzUmVwbz17dGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwb31cclxuICAgICAgdXNlclRhc2s9e3VzZXJUYXNrfVxyXG4gICAgICBvblVwZGF0ZT17YXN5bmMgKHVwZGF0ZXI6ICh1dDogVXNlclRhc2spID0+IHZvaWQpID0+IHtcclxuICAgICAgICBjb25zdCB0ZXN0ID0gey4uLnVzZXJUYXNrfTtcclxuICAgICAgICB1cGRhdGVyKHRlc3QpO1xyXG4gICAgICAgIGlmICghdGVzdC5uYW1lKSB0aHJvdyBuZXcgRXJyb3IgKHRoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid3ZWVrcGxhbm5lci5uYW1lTXVzdE5vdEJlRW1wdHknLCBkZWZhdWx0TWVzc2FnZTogJ05hbW5ldCBmw6VyIGludGUgdmFyYSB0b210J30pKTtcclxuICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXBkYXRlcik7XHJcbiAgICAgIH19XHJcbiAgICAgIG9uRGVsZXRlPXthc3luYyBpZCA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uZGVsZXRlKFtpZF0pO1xyXG4gICAgICB9fVxyXG4gICAgICBvcGVuRGlhbG9nPXtkaWFsb2c9PnRoaXMub3BlbkRpYWxvZyhkaWFsb2cpfVxyXG4gICAgICBjbG9zZURpYWxvZz17KCk9PnRoaXMuY2xvc2VEaWFsb2coKX1cclxuICAgIC8+KTtcclxuICB9XHJcblxyXG4gIGVkaXRTdWJUYXNrKHVzZXJUYXNrOiBVc2VyVGFzaywgc3ViVGFzazogVXNlclN1YlRhc2spIHtcclxuICAgIHRoaXMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xyXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvfVxyXG4gICAgICBtb2RlPVwiZWRpdFwiXHJcbiAgICAgIHVzZXJUYXNrPXt1c2VyVGFza31cclxuICAgICAgc3ViVGFzaz17c3ViVGFza31cclxuICAgICAgY2xvc2VEaWFsb2c9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9XHJcbiAgICAvPik7XHJcbiAgfVxyXG5cclxuICBjbG9zZURpYWxvZygpIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsb2dzOiB0aGlzLnN0YXRlLmRpYWxvZ3Muc2xpY2UoMCwgdGhpcy5zdGF0ZS5kaWFsb2dzLmxlbmd0aCAtIDEpIH0pO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBhc3luYyBhZGRDdXN0b21Hb2FsKGxlYXJuaW5nR29hbDogc3RyaW5nKSB7XHJcbiAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXHJcbiAgICAgIE1hdGgubWF4LFxyXG4gICAgICBbdGhpcy5zdGF0ZS53ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XHJcblxyXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5pbnNlcnQoW3tcclxuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgbGVhcm5pbmdHb2FsLFxyXG4gICAgICBkYXRlVGltZTogbGF0ZXN0VGltZVN0YW1wICsgMjAwMFxyXG4gICAgfV0pO1xyXG5cclxuICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uc2V0V2Vla1BsYW5uZXJCb3hPcGVuKFwiXCIsIHRydWUpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVtb3ZlTGVhcm5pbmdHb2FsKGxlYXJuaW5nR29hbDogVmlydHVhbExlYXJuaW5nR29hbCkge1xyXG4gICAgaWYgKGxlYXJuaW5nR29hbC50YXNrcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGlmICghY29uZmlybSh0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDond2Vla3BsYW5uZXIuY29uZmlybVJlbW92ZUxlYXJuaW5nT2JqZWN0aXZlcycsIGRlZmF1bHRNZXNzYWdlOiAnVGEgYm9ydCBsw6RyYW5kZW3DpWwgc2FtdCB7bGVhcm5pbmdHb2Fsc051bWJlcn0gdXBwZ2lmdGVyPyd9LCB7bGVhcm5pbmdHb2Fsc051bWJlcjogbGVhcm5pbmdHb2FsLnRhc2tzLmxlbmd0aH0pKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5kZWxldGUobGVhcm5pbmdHb2FsLmFsbFRhc2tzLm1hcCh0ID0+IHQuaWQpKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGFkZEN1c3RvbVRhc2soY291cnNlTmFtZTogc3RyaW5nLCBsZWFybmluZ0dvYWw6IHN0cmluZywgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykge1xyXG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxyXG4gICAgICBNYXRoLm1heCxcclxuICAgICAgW3RoaXMuc3RhdGUud2Vla0RhdGVdLmNvbmNhdCh0aGlzLnN0YXRlLnVzZXJUYXNrcy5tYXAodCA9PiB0LmRhdGVUaW1lKSkpO1xyXG5cclxuICAgIC8qY29uc3QgZW1wdHlMZWFybmluZ0dvYWxQbGFjZWhvbGRlciA9IHRoaXMuc3RhdGUudXNlclRhc2tzLmZpbmQodXQgPT5cclxuICAgICAgdXQubmFtZSA9PSBudWxsICYmXHJcbiAgICAgICF1dC5jb3Vyc2VOYW1lICYmXHJcbiAgICAgIHV0LmxlYXJuaW5nR29hbCA9PT0gbGVhcm5pbmdHb2FsKTtcclxuXHJcbiAgICBpZiAoZW1wdHlMZWFybmluZ0dvYWxQbGFjZWhvbGRlcikge1xyXG4gICAgICAvLyBIaWphY2sgbGVhcm5pbmctZ29hbCBwbGFjZWhvbGRlciBhbmQgbWFrZSBpdCB0aGUgcmVhbCB0YXNrLlxyXG4gICAgICAvLyBUaGlzIHdpbGwgbWFrZSB0aGUgbGVhcm5pbmcgZ29hbCBkaXNhcHBlYXIgb25jZSB0aGlzIHRhc2tcclxuICAgICAgLy8gaXMgZGVsZXRlZC5cclxuICAgICAgYXdhaXQgdXNlclRhc2tzUmVwby51cGRhdGUoW2VtcHR5TGVhcm5pbmdHb2FsUGxhY2Vob2xkZXJdLCB1dCA9PiB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih1dCwgeyBuYW1lLCBkZXNjcmlwdGlvbiwgdXJsIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7Ki9cclxuICAgICAgLy8gQWRkIGFub3RoZXIgdGFzayB0byBzYW1lIGxlYXJuaW5nLWdvYWxcclxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5pbnNlcnQoW3tcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxyXG4gICAgICAgIGNvdXJzZU5hbWUsXHJcbiAgICAgICAgbGVhcm5pbmdHb2FsLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgdXJsXHJcbiAgICAgIH1dKTtcclxuICAgIC8vfVxyXG4gIH1cclxuXHJcbiAgc2V0SXNPcGVuKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnNldFdlZWtQbGFubmVyQm94T3Blbihjb3Vyc2VOYW1lLCBpc09wZW4pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0VGFza0RvbmUodGFzazogVXNlclRhc2ssIGRvbmU6IGJvb2xlYW4pIHtcclxuICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uc2V0VGFza0RvbmVTdGF0ZSh0YXNrLCBkb25lKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNldFN1YlRhc2tEb25lKHRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaywgZG9uZTogYm9vbGVhbikge1xyXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRTdWJUYXNrRG9uZVN0YXRlKHRhc2ssIHN1YlRhc2suaWQsIGRvbmUpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgY29weUZyb21QcmV2aW91c1dlZWsoKSB7XHJcbiAgICBhd2FpdCB0aGlzLnNldFN0YXRlKHtpc0NvcHlpbmdUYXNrczogdHJ1ZX0pO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyB1c2VyVGFza3MsIG9wZW5Db3Vyc2VzLCB3ZWVrRGF0ZSB9ID0gdGhpcy5zdGF0ZTtcclxuXHJcbiAgICAgIGNvbnN0IHByZXZXZWVrID0gbW9tZW50KHdlZWtEYXRlKS5hZGQoLTEsICd3ZWVrJyk7XHJcbiAgICAgIGNvbnN0IHByZXZXZWVrTm8gPSBnZXRBZGp1c3RlZFdlZWsgKHByZXZXZWVrKTtcclxuICAgICAgY29uc3QgcHJldktFRFdlZWsgPSBLRURXZWVrKHByZXZXZWVrLnllYXIoKSwgcHJldldlZWtObyk7XHJcbiAgICAgIC8vIFJlYWQgbGFzdCB3ZWVrJ3MgZ29hbHMgYW5kIHRhc2tzXHJcbiAgICAgIGxldCBwcmV2VGFza3MgPSBhd2FpdCB0aGlzLnByb3BzLmVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8VXNlclRhc2s+KFwidXNlcnRhc2tzXCIsIHtcclxuICAgICAgICBmcm9tOiBwcmV2S0VEV2Vlay5ub3RCZWZvcmUsXHJcbiAgICAgICAgdG86IHByZXZLRURXZWVrLm5vdEFmdGVyLFxyXG4gICAgICAgIHJvbGU6IFwiVVNFUlwiLFxyXG4gICAgICAgIGluY2x1ZGU6IFtcInRhc2tcIiwgXCJjb3Vyc2VcIiwgXCJhY2xcIl0sXHJcbiAgICAgICAgZmxhZ3M6IFtcImluY2x1ZGVJZHNPbmx5XCJdXHJcbiAgICAgIH0pO1xyXG4gICAgICBwcmV2VGFza3MgPSBwcmV2VGFza3NcclxuICAgICAgICAuZmlsdGVyKHByZXZUYXNrID0+ICFwcmV2VGFzay5kb25lKSAgLy8gRG9uJ3QgY29weSBkb25lIHRhc2tzXHJcbiAgICAgICAgLmZpbHRlcihwcmV2VGFzayA9PiAhIXByZXZUYXNrLm5hbWUpIC8vIERvbid0IGNvcHkgZW1wdHkgbGVhcm5pbmcgZ29hbHNcclxuICAgICAgICAuZmlsdGVyKHByZXZUYXNrID0+ICF1c2VyVGFza3Muc29tZSh0YXNrT2ZDdXJyZW50V2VlayA9PlxyXG4gICAgICAgICAgdGFza09mQ3VycmVudFdlZWsubmFtZSA9PT0gcHJldlRhc2submFtZSAmJlxyXG4gICAgICAgICAgdGFza09mQ3VycmVudFdlZWsubGVhcm5pbmdHb2FsID09PSBwcmV2VGFzay5sZWFybmluZ0dvYWwgJiZcclxuICAgICAgICAgIHRhc2tPZkN1cnJlbnRXZWVrLmNvdXJzZU5hbWUgPT09IHByZXZUYXNrLmNvdXJzZU5hbWUpKTsgLy8gSWdub3JlIGlkZW50aWNhbCB0YXNrcyAoYWxyZWFkeSBjb3BpZWQpXHJcbiAgICAgICAgICBcclxuICAgICAgdmFyIHRlc3QgPSBbd2Vla0RhdGVdLmNvbmNhdCh1c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpO1xyXG4gICAgICAvLyBOb3cgY3JlYXRlIGNvcGllcyBidXQgcGxhY2UgdGhlbSBpbiB0aGUgY3VycmVudCB3ZWVrLlxyXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoTWF0aC5tYXgsIFt3ZWVrRGF0ZV0uY29uY2F0KHVzZXJUYXNrcy5tYXAodCA9PiB0LmRhdGVUaW1lKSkpO1xyXG5cclxuICAgICAgY29uc3QgY29waWVzID0gcHJldlRhc2tzLnNvcnQoY29tcGFyZVByb3AoXCJkYXRlVGltZVwiKSkubWFwKHRhc2sgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvcHk6IFVzZXJUYXNrID0geyAuLi50YXNrLCBkYXRlVGltZTogbGF0ZXN0VGltZVN0YW1wICs9IDEwMDAgfTtcclxuICAgICAgICBjb3B5LmlkID0gY3JlYXRlVVVJRCgpO1xyXG4gICAgICAgIGlmIChjb3B5LnN1YlRhc2tzKSB7XHJcbiAgICAgICAgICBjb3B5LnN1YlRhc2tzID0gY29weS5zdWJUYXNrcy5maWx0ZXIoc3QgPT4gIXN0LmRvbmUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWxldGUgY29weS4kZXRhZztcclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBTdG9yZSBpdFxyXG4gICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmluc2VydChjb3BpZXMpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNDb3B5aW5nVGFza3M6IGZhbHNlfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRIZWFkZXJUaXRsZSgpe1xyXG4gICAgcmV0dXJuIDxoND48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmxvZ0Jvb2tcIiAgZGVmYXVsdE1lc3NhZ2U9XCJMb2dnYm9rXCIvPjwvaDQ+O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qgd2Vla051bWJlciA9IG1vbWVudCh0aGlzLnN0YXRlLndlZWtEYXRlKS53ZWVrKCk7XHJcbiAgICBjb25zdCBzaG93UHJvZ3Jlc3NDaGFydHMgPSBmZWF0dXJlcy53ZWVrcGxhbm5lckNoYXJ0cztcclxuICAgIC8vY29uc29sZS5sb2coXCJXZWVreWRhdGU6IFwiICArIG5ldyBEYXRlKHRoaXMuc3RhdGUud2Vla0RhdGUpICsgXCIgd2hpY2ggaXMgd2VlayBubyBcIiArIHdlZWtOdW1iZXIpO1xyXG4gICAgY29uc3QgY3VycmVudFdlZWsgPSBtb21lbnQoKS53ZWVrKCk7XHJcbiAgICBjb25zdCB0YXNrU2V0cyA9IHJlZmluZSh0aGlzLnN0YXRlLnVzZXJUYXNrcyk7XHJcbiAgICBjb25zdCB7IGRpYWxvZ3MsIHdlZWtUZXh0c1VULCBzdHJhdGVneSwgYXNzZXNzbWVudCwgaXNMb2FkaW5nLCBpc0NvcHlpbmdUYXNrcyB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IGlzU2F2aW5nID0gd2Vla1RleHRzVVQgJiYgKHdlZWtUZXh0c1VULiRtZXRhID09PSAnYWRkaW5nJyB8fCB3ZWVrVGV4dHNVVC4kbWV0YSA9PT0gJ3VwZGF0aW5nJyk7XHJcbiAgICBjb25zdCBpc1N0cmF0ZWd5RWRpdGVkID0gISF3ZWVrVGV4dHNVVCAmJiAoc3RyYXRlZ3kgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5zdHJhdGVneSk7XHJcbiAgICBjb25zdCBpc0Fzc2Vzc21lbnRFZGl0ZWQgPSAhIXdlZWtUZXh0c1VUICYmIChhc3Nlc3NtZW50ICE9PSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuYXNzZXNzbWVudCk7XHJcbiAgICBjb25zdCBlbmFibGVTYXZlQnV0dG9uID0gIWlzU2F2aW5nICYmIChpc1N0cmF0ZWd5RWRpdGVkIHx8IGlzQXNzZXNzbWVudEVkaXRlZCk7XHJcblxyXG4gICAgdmFyIGNoYXJ0VGFza3MgPSBnZXRXZWVrcGxhbm5lclByb2dyZXNzRGF0YSh0YXNrU2V0cyk7XHJcblxyXG4gICAgdmFyIHBlcmNlbnRhZ2UgPSBjaGFydFRhc2tzLnRvdGFsTnVtYmVyT2ZUYXNrcyA+IDAgPyBjaGFydFRhc2tzLmNvbXBsZXRlZFRhc2tzIC8gY2hhcnRUYXNrcy50b3RhbE51bWJlck9mVGFza3MgKiAxMDAgOiAwO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtga2VkX2JveGVkIHdlZWtQbGFubmVyJHt3ZWVrTnVtYmVyID09PSBjdXJyZW50V2VlayA/IFwiIGN1cnJlbnRXZWVrXCIgOiBcIlwifWB9XHJcbiAgICAgICAgb25LZXlEb3duPXtldiA9PiB7XHJcbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDgzICYmIGV2LmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKCFpc1NhdmluZyAmJiB0aGlzLmlzV2Vla1RleHRzRWRpdGVkKCkpIHtcclxuICAgICAgICAgICAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfX0+XHJcbiAgICAgICAge3Nob3dQcm9ncmVzc0NoYXJ0cyAmJiBjaGFydFRhc2tzLnRvdGFsTnVtYmVyT2ZUYXNrcyA+IDAgJiYgIHRoaXMuZ2V0SGVhZGVyVGl0bGUoKX1cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndpZGdldHNcIj5cclxuICAgICAgICAgIHtzaG93UHJvZ3Jlc3NDaGFydHMgJiYgY2hhcnRUYXNrcy50b3RhbE51bWJlck9mVGFza3MgPiAwID8gPGRpdiBjbGFzc05hbWU9XCJwcm9ncmVzc0JhclwiPjxQcm9ncmVzcyBwZXJjZW50YWdlID0ge3BlcmNlbnRhZ2V9Lz48L2Rpdj4gOiB0aGlzLmdldEhlYWRlclRpdGxlKCl9XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHdlZWtTZWxlY3RgfT5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxyXG4gICAgICAgICAgICAgIDxwPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIud2Vla051bWJlclwiIHZhbHVlcz17e3dlZWtOdW1iZXI6IHdlZWtOdW1iZXJ9fSBkZWZhdWx0TWVzc2FnZT1cIlZlY2thIHt3ZWVrTnVtYmVyfVwiLz48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCkgPT4gdGhpcy5wcmV2V2VlaygpfT5cclxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYW5nbGUtbGVmdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLm5leHRXZWVrKCl9PlxyXG4gICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1yaWdodFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7dGFza1NldHMubGVuZ3RoID4gMCAmJiA8aHIgLz59XHJcblxyXG4gICAgICAgIHt0YXNrU2V0cy5tYXAocHJvcHMgPT5cclxuICAgICAgICAgIDxVc2VyVGFza3NCb3hcclxuICAgICAgICAgICAga2V5PXtwcm9wcy5jb3Vyc2VOYW1lfVxyXG4gICAgICAgICAgICB7Li4ucHJvcHN9XHJcbiAgICAgICAgICAgIGNvdXJzZU5hbWU9e3Byb3BzLmNvdXJzZU5hbWV9XHJcbiAgICAgICAgICAgIGxlYXJuaW5nR29hbHM9e3Byb3BzLmxlYXJuaW5nR29hbHN9XHJcbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cclxuICAgICAgICAgICAgb3BlbkNvdXJzZXM9e3RoaXMuc3RhdGUub3BlbkNvdXJzZXN9XHJcbiAgICAgICAgICAgIGFkZE93blRhc2s9eyhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykgPT4gdGhpcy5vcGVuQWRkT3duVGFza0RpYWxvZyhjb3Vyc2VOYW1lLCBsZWFybmluZ0dvYWxOYW1lKX1cclxuICAgICAgICAgICAgc2V0SXNPcGVuPXt0aGlzLnNldElzT3Blbi5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBzZXRUYXNrRG9uZT17dGhpcy5zZXRUYXNrRG9uZS5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBzZXRTdWJUYXNrRG9uZT17dGhpcy5zZXRTdWJUYXNrRG9uZS5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBlZGl0VGFzaz17dGFzayA9PiB0aGlzLmVkaXRUYXNrKHRhc2spfVxyXG4gICAgICAgICAgICBlZGl0U3ViVGFzaz17KHRhc2ssIHN1YlRhc2spID0+IHRoaXMuZWRpdFN1YlRhc2sodGFzaywgc3ViVGFzayl9XHJcbiAgICAgICAgICAgIHJlbW92ZUxlYXJuaW5nR29hbD17bGcgPT4gdGhpcy5yZW1vdmVMZWFybmluZ0dvYWwobGcpfSBcclxuICAgICAgICAgICAgZGlzcGxheVByb2dyZXNzID0ge3Nob3dQcm9ncmVzc0NoYXJ0c31cclxuICAgICAgICAgICAgcHJvZ3Jlc3NEYXRhID0ge2NoYXJ0VGFza3Muc3ViamVjdERhdGFbcHJvcHMuY291cnNlTmFtZV19IC8+KX1cclxuXHJcbiAgICAgICAgPGhyIC8+XHJcblxyXG4gICAgICAgIHtpc0xvYWRpbmcgPyA8U3Bpbm5lciAvPiA6IDxkaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2V2ID0+IHRoaXMub3BlbkFkZEdvYWxEaWFsb2coKX0+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWxpc3QtYWx0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxyXG4gICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmxlYXJuaW5nR29hbFwiIGRlZmF1bHRNZXNzYWdlPVwiRWdldCBsw6RyYW5kZW3DpWxcIi8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuXCIgc3R5bGU9e2lzQ29weWluZ1Rhc2tzID8ge29wYWNpdHk6IDAuNX0gOiB1bmRlZmluZWR9IG9uQ2xpY2s9e2V2ID0+ICghaXNDb3B5aW5nVGFza3MpICYmIHRoaXMuY29weUZyb21QcmV2aW91c1dlZWsoKX0+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWNsb25lXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxyXG4gICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmNvcHlQcmV2aW91c1dlZWtUYWtzXCIgZGVmYXVsdE1lc3NhZ2U9XCJLb3BpZXJhIGVqIGtsYXJhIGZyw6VuIGbDtnJlZ8OlZW5kZSB2ZWNrYVwiLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPE9wZW5DbG9zZUJveFxyXG4gICAgICAgICAgICB0aXRsZT17PGg1PjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuc3RyYXRlZ3lBbmRFdmFsdWF0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJTdHJhdGVnaSAmIFV0dsOkcmRlcmluZ1wiLz48L2g1Pn1cclxuICAgICAgICAgICAgaGVhZGVyT3Blbj17dGhpcy5zdGF0ZS5vcGVuQ291cnNlc1tcIlN0cmF0VXR2XCJdfVxyXG4gICAgICAgICAgICBvbk9wZW5DbG9zZT17YmVjYW1lT3BlbiA9PiB0aGlzLnNldElzT3BlbihcIlN0cmF0VXR2XCIsIGJlY2FtZU9wZW4pfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8aDM+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneVwiIGRlZmF1bHRNZXNzYWdlPVwiU3RyYXRlZ2lcIi8+PC9oMz5cclxuICAgICAgICAgICAgPHA+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneURlc2NyaXB0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJIdXIgamFnIHNrYSBnw7ZyYSBmw7ZyIGF0dCBsw6RyYSBtaWcuXCIvPjwvcD5cclxuICAgICAgICAgICAgPGhyLz5cclxuICAgICAgICAgICAgPHRleHRhcmVhXHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2Vla3BsYW5uZXItdGV4dGFyZWFcIlxyXG4gICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnByb3BzLmVudi50dXRvcmVkfVxyXG4gICAgICAgICAgICAgIHZhbHVlPXtzdHJhdGVneSAmJiBzdHJhdGVneS5zdWJzdHIoMCwgTUFYX1NUUkFURUdZX0xFTkdUSCl9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3N0cmF0ZWd5OiAoZXYudGFyZ2V0LnZhbHVlIHx8ICcnKS5zdWJzdHIoMCwgTUFYX1NUUkFURUdZX0xFTkdUSCl9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcclxuICAgICAgICAgICAgICB9fSAvPlxyXG5cclxuICAgICAgICAgICAgPGgzPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuZXZhbHVhdGlvblwiIGRlZmF1bHRNZXNzYWdlPVwiVXR2w6RyZGVyaW5nXCIvPjwvaDM+XHJcbiAgICAgICAgICAgIDxwPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuZXZhbHVhdGlvbkRlc2NyaXB0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJSZWZsZWt0aW9uIGtyaW5nIGRpbiBhcmJldHNpbnNhdHMgb2NoIGRpbmEgdmFsZGEgc3RyYXRlZ2llciB1bmRlciB2ZWNrYW4uVXR2w6RyZGVyYSBpIGbDtnJow6VsbGFuZGUgdGlsbCBkaW5hIG3DpWwuXCIvPjwvcD5cclxuICAgICAgICAgICAgPGhyLz5cclxuICAgICAgICAgICAgPHRleHRhcmVhXHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2Vla3BsYW5uZXItdGV4dGFyZWFcIlxyXG4gICAgICAgICAgICAgIHZhbHVlPXthc3Nlc3NtZW50ICYmIGFzc2Vzc21lbnQuc3Vic3RyKDAsIE1BWF9BU1NFU1NNRU5UX0xFTkdUSCl9XHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZW52LnR1dG9yZWR9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Fzc2Vzc21lbnQ6IChldi50YXJnZXQudmFsdWUgfHwgJycpLnN1YnN0cigwLCBNQVhfQVNTRVNTTUVOVF9MRU5HVEgpfSlcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcclxuICAgICAgICAgICAgICB9IH0vPlxyXG4gICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuXCJcclxuICAgICAgICAgICAgICB0YWJJbmRleD17MH1cclxuICAgICAgICAgICAgICBzdHlsZT17ZW5hYmxlU2F2ZUJ1dHRvbiA/IHt9IDoge29wYWNpdHk6IDAuNX19XHJcbiAgICAgICAgICAgICAgb25DbGljaz17KCk9PiFpc1NhdmluZyAmJiB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDApfT5cclxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWZsb3BweS1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAge2VuYWJsZVNhdmVCdXR0b24gPyA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCIgU3BhcmFcIi8+IDogPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZWRcIiBkZWZhdWx0TWVzc2FnZT1cIiBTcGFyYWRcIi8+fVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L09wZW5DbG9zZUJveD5cclxuXHJcbiAgICAgICAgPC9kaXY+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPERpYWxvZ3NcclxuICAgICAgICBkaWFsb2dzPXtkaWFsb2dzfVxyXG4gICAgICAgIHBvcERpYWxvZz17KCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKFxyXG4gICAgICAgICAgICAgICh7ZGlhbG9nc30pID0+ICh7IGRpYWxvZ3M6IGRpYWxvZ3Muc2xpY2UoMCwgZGlhbG9ncy5sZW5ndGggLSAxKSB9KSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSAvPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJy4uL3V0aWxzL3F1ZXJ5LXN0cmluZyc7XHJcbmltcG9ydCBGZWF0dXJlRGVzY3JpcHRpb25zIGZyb20gJy4vZmVhdHVyZS1mbGFncy5qc29uJztcclxuaW1wb3J0IHsgY2ZnIH0gZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuXHJcbnR5cGUgRmVhdHVyZUZsYWdzID0ge3JlYWRvbmx5IFtQIGluIGtleW9mIHR5cGVvZiBGZWF0dXJlRGVzY3JpcHRpb25zXTogYm9vbGVhbn07XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVzIGV4dGVuZHMgRmVhdHVyZUZsYWdzIHt9XHJcblxyXG5leHBvcnQgY2xhc3MgRmVhdHVyZXMge1xyXG4gIHByaXZhdGUgX2ZlYXR1cmVzOiBGZWF0dXJlRmxhZ3M7XHJcbiAgcHJpdmF0ZSBfaW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIGlmICh0aGlzLl9pbml0aWFsaXplZCkgcmV0dXJuO1xyXG4gICAgbGV0IHR1cm5lZE9uRmVhdHVyZXMgPSAoY2ZnLktFRF9GRUFUVVJFUyB8fCBcIlwiKS5zcGxpdCgnLCcpLm1hcChuYW1lID0+IG5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCwge3RvTG93ZXI6IHRydWV9KTtcclxuXHJcbiAgICBpZiAocXVlcnkudGVzdHZlcnNpb24pIHtcclxuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IFtcIipcIl07XHJcbiAgICB9XHJcbiAgICBpZiAocXVlcnkuZmVhdHVyZXMpIHtcclxuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IHF1ZXJ5LmZlYXR1cmVzXHJcbiAgICAgICAgLnNwbGl0KCcsJylcclxuICAgICAgICAubWFwKGZlYXR1cmUgPT4gZmVhdHVyZS50cmltKCkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB0dXJuT25BbGwgPSB0dXJuZWRPbkZlYXR1cmVzLmluY2x1ZGVzKCcqJyk7XHJcbiAgICB0aGlzLl9mZWF0dXJlcyA9IHt9IGFzIEZlYXR1cmVGbGFncztcclxuICAgIGZvciAoY29uc3QgZmVhdHVyZU5hbWUgb2YgT2JqZWN0LmtleXMoRmVhdHVyZURlc2NyaXB0aW9ucykpIHtcclxuICAgICAgdGhpcy5fZmVhdHVyZXNbZmVhdHVyZU5hbWVdID0gdHVybk9uQWxsIHx8XHJcbiAgICAgICAgdHVybmVkT25GZWF0dXJlcy5pbmNsdWRlcyhmZWF0dXJlTmFtZS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgfVxyXG4gICAgdGhpcy5faW5pdGlhbGl6ZWQgPSB0cnVlOyAgICBcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yICgpIHtcclxuICAgIGZvciAoY29uc3QgZmVhdHVyZU5hbWUgb2YgT2JqZWN0LmtleXMoRmVhdHVyZURlc2NyaXB0aW9ucykpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGZlYXR1cmVOYW1lLCB7XHJcbiAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgaWYgKCF0aGlzLl9pbml0aWFsaXplZCkgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZmVhdHVyZXNbZmVhdHVyZU5hbWVdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0KHZhbHVlKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlYXR1cmUgZmxhZ3MgY2Fubm90IGJlIHNldCBoZXJlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGZlYXR1cmVzID0gbmV3IEZlYXR1cmVzKCk7XHJcbiIsImV4cG9ydCAqIGZyb20gJy4vZmVhdHVyZXMnO1xyXG4iLCJpbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcblxyXG5kZWNsYXJlIHZhciBwcm9jZXNzOiBhbnk7XHJcblxyXG5jZmcuRU5WSVJPTk1FTlQgPSBwcm9jZXNzLmVudi5FTlZJUk9OTUVOVCBhcyBcInByb2R1Y3Rpb25cIiB8IFwiZGV2ZWxvcG1lbnRcIiB8IFwidGVzdFwiO1xyXG5jZmcuS0VEX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5LRURfQVBJX1VSTDsgLy8gXCJodHRwczovL2tlZGJhY2tlbmR0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxyXG5jZmcuRURTX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5FRFNfQVBJX1VSTDsgLy8gXCJodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXHJcbmNmZy5LRURfVE9LRU5fVVJMID0gcHJvY2Vzcy5lbnYuS0VEX1RPS0VOX1VSTDsgLy8gXCJodHRwczovL2tlZGF1dGh0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L3Rva2VuXCJcclxuY2ZnLktFRF9DTElFTlRfSUQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX0lEOyAvLyBcImRldmNsaWVudFwiLCBcInRlc3RjbGllbnRcIiwgXCIuLi5cIlxyXG5jZmcuS0VEX0NMSUVOVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX1NFQ1JFVDtcclxuY2ZnLktFRF9SRUFMTSA9IHByb2Nlc3MuZW52LktFRF9SRUFMTTsgLy8gXCJTRTFcIlxyXG5jZmcuS0VEX0xPQ0FMRSA9IGNmZy5LRURfTE9DQUxFIHx8IHByb2Nlc3MuZW52LktFRF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlblwiLiBPbmx5IHNldCBmcm9tIHByb2Nlc3MuZW52IGlmIG5vdCBzZXQgZnJvbSBTaXRlVmlzaW9uIGVsZW1lbnQgY29uZmlnLlxyXG5jZmcuS0VEX1NDSE9PTF9MT0NBTEUgPSBjZmcuS0VEX1NDSE9PTF9MT0NBTEUgfHwgcHJvY2Vzcy5lbnYuS0VEX1NDSE9PTF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlbl9zaW5cIiwgXCJlbl9uaW5cIi4gT25seSBzZXQgZnJvbSBwcm9jZXNzLmVudiBpZiBub3Qgc2V0IGZyb20gU2l0ZVZpc2lvbiBlbGVtZW50IGNvbmZpZy5cclxuY2ZnLktFRF9SRVNPVVJDRVNfVVJMID0gY2ZnLktFRF9SRVNPVVJDRVNfVVJMIHx8IHByb2Nlc3MuZW52LktFRF9SRVNPVVJDRVNfVVJMO1xyXG4iLCIvKiBUaGVzZSBzY3JpcHRzIGFzc3VtZSBzb21lIG9mIHRoZSBnbG9iYWwgdmFycyBoYXZlIGFscmVhZHkgYmVlbiBzZXQ6XHJcbiAgKiBLRUQuY2ZnXHJcbiAgKiBLRUQuZW52LmN1cnJlbnRVc2VyXHJcblxyXG4gIFRoZSByZXN0IHdpbGwgYmUgc2V0IGhlcmUgKGNsaWVudCBzaWRlKVxyXG4qL1xyXG5pbXBvcnQgJy4vY29uZmlndXJlJztcclxuaW1wb3J0ICcuL3NldC1iZWFyZXItcHJvdmlkZXJzJztcclxuaW1wb3J0ICcuL3NldC1rZWQtYmFja2VuZC1jbGllbnQnO1xyXG5pbXBvcnQgJy4vc2V0LWVkcy1jbGllbnQnO1xyXG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nLCBzcGxpdFVybEFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViLCBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlciwgaXNvbW9ycGhpYywgc3RvcmFnZSB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50d2ViJztcclxuaW1wb3J0IHsgQmVhcmVyUHJvdmlkZXIsIEtlZEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9jb250cmFjdHMva2VkLW1vZGVsc1wiO1xyXG5pbXBvcnQgeyBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyB9IGZyb20gXCIuLi9hY2Nlc3MtY29udHJvbC9pbmRleFwiO1xyXG5pbXBvcnQgeyBjaGVycnlQaWNrUHJvcHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmZ1bmN0aW9uIGdldE1lcmdlZFRva2VuUGF0aCh0b2tlblBhdGg6IHN0cmluZywgbG9jYXRpb25TZWFyY2g6IHN0cmluZywgc2NvcGVzOiBzdHJpbmdbXSkge1xyXG4gIC8vIE1lcmdlIGNvbmZpZ3VyZWQgcXVlcnkgcGFyYW1zIG9mIHRva2VuIHBhdGggd2l0aCBwYXJhbXMgZ2l2ZW4gdG8gY3VycmVudCBwYWdlXHJcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaCk7XHJcbiAgY29uc3QgaW1wZXJzb25hdGlvblByb3BzID0gY2hlcnJ5UGlja1Byb3BzKGN1cnJlbnRRdWVyeSwgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpO1xyXG4gIGNvbnN0IFt0b2tlblBhdGhXaXRob3V0UXVlcnksIHRva2VuUXVlcnlTdHJpbmddID0gc3BsaXRVcmxBbmRRdWVyeSh0b2tlblBhdGgpO1xyXG4gIGNvbnN0IHRva2VuUGF0aFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyh0b2tlblF1ZXJ5U3RyaW5nKTtcclxuICByZXR1cm4gdG9rZW5QYXRoV2l0aG91dFF1ZXJ5ICsgZ2VuZXJhdGVRdWVyeVN0cmluZyh7XHJcbiAgICAuLi50b2tlblBhdGhRdWVyeSxcclxuICAgIC4uLmltcGVyc29uYXRpb25Qcm9wcyxcclxuICAgIHNjb3Blczogc2NvcGVzLmpvaW4oJywnKVxyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIHJldHVybiBtZXJnZWRUb2tlblBhdGggKyBcIi9cIiArIHVzZXJFbWFpbDtcclxufVxyXG5cclxuZnVuY3Rpb24gc2F2ZVVzZXJJbmZvKHVzZXI6IFVzZXIsIHRva2VuSWQ6IHN0cmluZykge1xyXG4gIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInVzZXJJbmZvXCIgKyB0b2tlbklkLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxvYWRVc2VySW5mbyh0b2tlbklkOiBzdHJpbmcpIHtcclxuICBjb25zdCBzdG9yZWRTZXNzaW9uVXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCk7XHJcbiAgaWYgKHN0b3JlZFNlc3Npb25Vc2VyKSB7XHJcbiAgICBlbnYuY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKHN0b3JlZFNlc3Npb25Vc2VyKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcclxuICByZXR1cm4gbmV3IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aCwgcmVzcG9uc2VUZXh0ID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XHJcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XHJcbiAgICBpZiAocmVzLnVzZXIpIHtcclxuICAgICAgc2F2ZVVzZXJJbmZvKHJlcy51c2VyLCB0b2tlbklkKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7IHRva2VuOiByZXMudG9rZW4sIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogMTAwMCB9O1xyXG4gIH0sIHRva2VuSWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVHb29nbGVUb2tlblByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcclxuICByZXR1cm4gbmV3IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aCwgcmVzcG9uc2VUZXh0ID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XHJcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XHJcbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcclxuICB9LCB0b2tlbklkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIodG9rZW5Vcmw6IHN0cmluZywgdXNlcjogVXNlciwgc2NvcGVzOiBzdHJpbmdbXSkge1xyXG4gIHJldHVybiBuZXcgS2VkQmVhcmVyUHJvdmlkZXIoXHJcbiAgICBpc29tb3JwaGljLFxyXG4gICAgc3RvcmFnZSxcclxuICAgIHRva2VuVXJsICsgdXNlci5tYWlsICsgbG9jYXRpb24uc2VhcmNoLFxyXG4gICAgY2ZnLktFRF9DTElFTlRfSUQsXHJcbiAgICBjZmcuS0VEX0NMSUVOVF9TRUNSRVQsXHJcbiAgICB0b2tlblVybCwge1xyXG4gICAgICBlbWFpbDogdXNlci5tYWlsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHJvbGVzOiB1c2VyLnJvbGVzLFxyXG4gICAgICBzY2hvb2w6IHVzZXIuc2Nob29sLFxyXG4gICAgICBzY2hvb2xUeXBlOiB1c2VyLnNjaG9vbFR5cGUsXHJcbiAgICAgIHNjb3Blc1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIGVudi5jdXJyZW50VXNlci5tYWlsIGlzIHNldCBieSBTaXRlVmlzaW9uIHNlcnZlciBpbml0aWFsbHkuXHJcbi8vIEEgcmVzcG9uc2UgZnJvbSAvYXBpL3Rva2VuIG1heSBjaGFuZ2UgdGhlIG1haWwgYXR0cmlidXRlIG9mIHRoZSBjdXJyZW50XHJcbi8vIHVzZXIsIHNvIGVudi5jdXJyZW50VXNlci5tYWlsIG1heSBiZSBkaWZmZXJlbnQgYWZ0ZXIgZ2V0dGluZyBhIHJlc3BvbnNlLlxyXG4vLyBIb3dldmVyLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB2YWx1YWJsZSBhbHdheXMgaW4gb3JkZXIgdG8gZGlzdGluZ3Vpc2ggdGhlIGNhc2VcclxuLy8gd2hlbiBvbmUgbm9ybWFsIHVzZXIgbG9ncyBvdXQgYW5kIGFub3RoZXIgdXNlciBsb2dzIGluLlxyXG5jb25zdCBpbml0aWFsVXNlckVtYWlsID0gZW52LmN1cnJlbnRVc2VyICYmIGVudi5jdXJyZW50VXNlci5tYWlsOyAvLyBJbml0aWFsIHZhbHVlIG9mIG1haWwuIE1heSBjaGFuZ2UuXHJcbmlmIChpbml0aWFsVXNlckVtYWlsKSB7XHJcbiAgLy8gS0VEXHJcbiAgaWYgKGNmZy5LRURfVE9LRU5fUEFUSCkge1xyXG4gICAgLy9cclxuICAgIC8vXHJcbiAgICAvLyBQcm9kdWN0aW9uIC8gU2l0ZVZpc2lvbiBwcm94aWVkIC9hcGkvdG9rZW4gdG8gcmVxdWVzdCB0b2tlbnMgZnJvbTpcclxuICAgIC8vXHJcbiAgICAvL1xyXG4gICAgY29uc3QgbWVyZ2VkVG9rZW5QYXRoID0gZ2V0TWVyZ2VkVG9rZW5QYXRoKFxyXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXHJcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCwgW1xyXG4gICAgICAgIFwia2VkYmFja2VuZFwiLFxyXG4gICAgICAgIFwiRURTXCIsXHJcbiAgICAgIF0pO1xyXG4gICAgZW52LmJlYXJlclByb3ZpZGVyID0gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcclxuICAgIGxvYWRVc2VySW5mbyhnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCkpO1xyXG5cclxuICAgIC8vIEdvb2dsZVxyXG4gICAgY29uc3QgZ29vZ2xlTWVyZ2VkUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcclxuICAgICAgY2ZnLktFRF9UT0tFTl9QQVRILFxyXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcclxuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcclxuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmVcIlxyXG4gICAgICBdKTtcclxuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlR29vZ2xlVG9rZW5Qcm92aWRlcihnb29nbGVNZXJnZWRQYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcclxuICB9IGVsc2UgaWYgKGNmZy5LRURfVE9LRU5fVVJMICYmIGNmZy5LRURfQ0xJRU5UX0lEICYmIGNmZy5LRURfQ0xJRU5UX1NFQ1JFVCkge1xyXG4gICAgLy9cclxuICAgIC8vXHJcbiAgICAvLyBUZXN0IC0gZ28gZGlyZWN0bHkgdG8gS0VEQVVUSCBzZXJ2ZXIgdG8gcmV0cmlldmUgdG9rZW5zXHJcbiAgICAvL1xyXG4gICAgLy9cclxuICAgIGVudi5iZWFyZXJQcm92aWRlciA9IGNyZWF0ZVRlc3RUb2tlblByb3ZpZGVyKGNmZy5LRURfVE9LRU5fVVJMLCBlbnYuY3VycmVudFVzZXIsIFtcclxuICAgICAgXCJrZWRiYWNrZW5kXCIsXHJcbiAgICAgIFwiRURTXCIsXHJcbiAgICBdKTtcclxuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIoY2ZnLktFRF9UT0tFTl9VUkwgKyBcIi9nb29nbGVcIiwgZW52LmN1cnJlbnRVc2VyLCBbXHJcbiAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5yZWFkb25seVwiLFxyXG4gICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmVcIlxyXG4gICAgXSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBjb25maWd1cmF0aW9uIHBhcmFtZXRlciBLRURfVE9LRU5fUEFUSGApO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHsgaXNvbW9ycGhpYyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50d2ViJztcclxuaW1wb3J0IHsgRWRzQ2xpZW50IH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xyXG5cclxuZW52LmVkc0NsaWVudCA9IG5ldyBFZHNDbGllbnQgKFxyXG4gIGlzb21vcnBoaWMsXHJcbiAgY2ZnLkVEU19BUElfVVJMLFxyXG4gIGVudi5iZWFyZXJQcm92aWRlcixcclxuICAoKT0+ZW52LmN1cnJlbnRVc2VyLm1haWwpO1xyXG5cclxuIiwiaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XHJcblxyXG5lbnYua2VkQmFja2VuZENsaWVudCA9IG5ldyBLZWRCYWNrZW5kQ2xpZW50V2ViIChcclxuICBjZmcuS0VEX0FQSV9VUkwsXHJcbiAgZW52LmJlYXJlclByb3ZpZGVyKTtcclxuXHJcbiIsImltcG9ydCBLRUQgZnJvbSAnLi9LRUQnO1xyXG5cclxuLyogVGhpcyBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaXMgdXNlZCBhcyBhIGZhbGxiYWNrLlxyXG5Ob3JtYWxseSBib3RoIHRlc3QgcGFnZXMgYW5kIHByb2R1Y3Rpb24gcGFnZXMgd2lsbCBvdmVycmlkZSB0aGVzZSBjb25maWdyYXRpb25zXHJcbiovXHJcbi8qY29uc3QgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7XHJcbiAgLy8gRW52aXJvbm1lbnRcclxuICBFTlZJUk9OTUVOVDogJ2RldmVsb3BtZW50JyBhcyAncHJvZHVjdGlvbicgfCAnZGV2ZWxvcG1lbnQnIHwgJ3Rlc3QnLFxyXG4gIC8vIEF1dGhlbnRpY2F0aW9uIFNlcnZlcjpcclxuICBLRURfVE9LRU5fVVJMOiAnaHR0cHM6Ly9rZWRhdXRodGVzdC5henVyZXdlYnNpdGVzLm5ldC90b2tlbicsXHJcbiAgS0VEX1RPS0VOX1BBVEg6ICcvYXBpL3Rva2VuLlNrcmlwdC5wb3J0bGV0P3N2LmNvbnRlbnR0eXBlPWFwcGxpY2F0aW9uL2pzb24nLFxyXG4gIEtFRF9DTElFTlRfSUQ6ICdkZXZjbGllbnQnLFxyXG4gIEtFRF9DTElFTlRfU0VDUkVUOiAnNGZSZGZRcFd0SnFqVFdmJyxcclxuICAvLyBTZXJ2aWNlczpcclxuICBLRURfQVBJX1VSTDogJ2h0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLycsICBcclxuICBFRFNfQVBJX1VSTDogJ2h0dHBzOi8vZWRzcG9ydGFsb3dpbmFwaS5henVyZXdlYnNpdGVzLm5ldC9hcGkvJ1xyXG59Ki9cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUtlZENvbmZpZ3VyYXRpb24ge1xyXG4gIEVOVklST05NRU5UOiAncHJvZHVjdGlvbicgfCAnZGV2ZWxvcG1lbnQnIHwgJ3Rlc3QnO1xyXG4gIEtFRF9SRUFMTTogc3RyaW5nO1xyXG4gIEtFRF9UT0tFTl9VUkw6IHN0cmluZztcclxuICBLRURfVE9LRU5fUEFUSDogc3RyaW5nO1xyXG4gIEtFRF9DTElFTlRfSUQ6IHN0cmluZztcclxuICBLRURfQ0xJRU5UX1NFQ1JFVDogc3RyaW5nO1xyXG4gIEtFRF9BUElfVVJMOiBzdHJpbmc7XHJcbiAgRURTX0FQSV9VUkw6IHN0cmluZztcclxuICBLRURfTE9DQUxFOiBzdHJpbmc7XHJcbiAgS0VEX1NDSE9PTF9MT0NBTEU6IHN0cmluZztcclxuICBLRURfQ09VUlNFX0JVSUxERVJfVVJMOiBzdHJpbmc7XHJcbiAgS0VEX0NPVVJTRV9WSUVXRVJfVVJMOiBzdHJpbmc7XHJcbiAgS0VEX1NVQkpFQ1RfUExBTk5FUl9BRE1JTl9VUkw6IHN0cmluZztcclxuICBLRURfU1VCSkVDVF9QTEFOTkVSX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9GRUFUVVJFUzogc3RyaW5nO1xyXG4gIEtFRF9LRUVQX0FMSVZFX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9FTlVNX1dPUkRCQU5LU19VUkw6IHN0cmluZztcclxuICBLRURfV09SREJBTktTX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9SRVNPVVJDRVNfVVJMOiBzdHJpbmc7XHJcbn07XHJcblxyXG5pZiAoIUtFRC5jZmcpIEtFRC5jZmcgPSB7fTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEtFRC5jZmcgYXMgSUtlZENvbmZpZ3VyYXRpb247XHJcbmV4cG9ydCBjb25zdCBjZmc6IElLZWRDb25maWd1cmF0aW9uID0gS0VELmNmZztcclxuIiwiaW1wb3J0IHtVc2VyLCBMZWFybmluZ01vZHVsZVRhc2tzfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQge1VzZXJUYXNrfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi4vcmVwb3Mva2VkLXJlcG8nO1xyXG5pbXBvcnQge0Vkc0NsaWVudH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xyXG5pbXBvcnQgS0VEIGZyb20gJy4va2VkJztcclxuaW1wb3J0IHsgS1NUZXJtUGxhbm5lclJlcG8gfSBmcm9tICcuLi9yZXBvcy9rcy10ZXJtcGxhbm5lci1yZXBvJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52IHtcclxuICAgIGN1cnJlbnRVc2VyPzogVXNlcjtcclxuICAgIGxlYXJuaW5nTW9kdWxlVGFza3M/OiBMZWFybmluZ01vZHVsZVRhc2tzO1xyXG4gICAgYmVhcmVyUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcclxuICAgIGdvb2dsZVRva2VuUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcclxuICAgIGtlZEJhY2tlbmRDbGllbnQ/OiBLZWRCYWNrZW5kQ2xpZW50O1xyXG4gICAgZWRzQ2xpZW50PzogRWRzQ2xpZW50O1xyXG4gICAgdXNlclRhc2tzUmVwbz87XHJcbiAgICBoaWRkZW5Db3Vyc2VzUmVwbz87XHJcbiAgICB3ZWVrTm90ZXNSZXBvPztcclxuICAgIGtnVGVybVBsYW5uZXJSZXBvPztcclxuICAgIGtzVGVybVBsYW5uZXJSZXBvPzogS1NUZXJtUGxhbm5lclJlcG9cclxuICAgIHR1dG9yZWQ6IGJvb2xlYW47XHJcbiAgICBlcnJvcj86IEVycm9yO1xyXG59XHJcblxyXG5pZiAoIUtFRC5lbnYpIEtFRC5lbnYgPSB7fTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEtFRC5lbnYgYXMgRW52O1xyXG5leHBvcnQgY29uc3QgZW52OiBFbnYgPSBLRUQuZW52O1xyXG4iLCJcclxuZXhwb3J0IGNvbnN0IEtFRF9OQU1FU1BBQ0UgPSBcIktFRFwiO1xyXG5cclxuZGVjbGFyZSB2YXIgS0VEOiBhbnk7XHJcblxyXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XHJcbiIsImltcG9ydCBlbnYgZnJvbSAnLi9LRUQuZW52JztcclxuaW1wb3J0IHsgS2VkQmFja2VuZFJlcG8gfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xyXG5pbXBvcnQgeyBnZXRHbG9iYWxJZCwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IGNmZyBmcm9tICcuL0tFRC5jZmcnO1xyXG5pbXBvcnQgeyBTY2hvb2wsIEJyYW5jaCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgVmFsdWUgfSBmcm9tICdrZWRiYWNrZW5kL29ic2VydmFibGUnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRiID0gbmV3IEtlZEJhY2tlbmRSZXBvKFxyXG4gICgpPT5lbnYua2VkQmFja2VuZENsaWVudCxcclxuICAoKT0+ZW52LmN1cnJlbnRVc2VyID9cclxuICAgIGVudi5jdXJyZW50VXNlci5tYWlsIDpcclxuICAgIFwiXCIsXHJcbiAgKCk9PmVudi5jdXJyZW50VXNlciA/XHJcbiAgICBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUgfHwgZW52LmN1cnJlbnRVc2VyLm1haWwgOlxyXG4gICAgXCJcIik7XHJcblxyXG5leHBvcnQgY29uc3QgZ2xvYmFsSWQgPSBnZXRHbG9iYWxJZChjZmcuS0VEX1JFQUxNKTtcclxuZXhwb3J0IGNvbnN0IFNjaG9vbHMgPSB7XHJcbiAgc3RhbmRhcmRTY2hvb2w6IGRiLnNjaG9vbHMubmFtZShcInN0YW5kYXJkXCIpLmNhY2hlT3B0aW1pemVkKCkuc2luZ2xlKCksXHJcbiAgZ2V0IG15U2Nob29sICgpIHsgcmV0dXJuIGRiLnNjaG9vbHMubmFtZShlbnYuY3VycmVudFVzZXIuc2Nob29sKS5jYWNoZU9wdGltaXplZCgpLnNpbmdsZSgpOyB9XHJcbn07XHJcbmV4cG9ydCBjb25zdCBDb3Vyc2VJbnN0YW5jZXMgPSB7XHJcbiAgZ2V0QnJhbmNoSWQoc2Nob29sOiBWYWx1ZTxTY2hvb2w+LCBjb3Vyc2VJZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gc2Nob29sLnN3aXRjaE1hcChzY2hvb2wgPT5cclxuICAgICAgZGIuYnJhbmNoZXNcclxuICAgICAgICAuaGFzRWRnZXNGcm9tKFtzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZF0pXHJcbiAgICAgICAgLm5hbWUoXCJkcmFmdFwiKVxyXG4gICAgICAgIC50YWdzKGNvdXJzZUlkKVxyXG4gICAgICAgIC5pZHNPbmx5KClcclxuICAgICAgICAubWFwKCh7aWR9KSA9PiBpZClcclxuICAgICAgICAudG9WYWx1ZSgpXHJcbiAgICAgICAgLm1hcChpZHMgPT4gaWRzLmxlbmd0aCA+IDAgPyBpZHNbMF0gOiB1bmRlZmluZWQpKTtcclxuICB9LFxyXG5cclxuICAvKiogR2V0IGEgRFJBRlQgYnJhbmNoIGZvciBnaXZlbiBjb3Vyc2UgSUQgYW5kIGdpdmVuIHNjaG9vbC5cclxuICAgKiBJZiB0aGVyZSBpcyBub3QgeWV0IHN1Y2ggYSBicmFuY2gsIGNyZWF0ZSBpdCB1c2luZyBtdXRhdGlvbnNPbkVtcHR5KCkgd2hpY2ggd2lsbFxyXG4gICAqIGxlYWQgdG8gdGhlIEMjIGNvZGUgRG9jdW1lbnRSZXBvc2l0b3J5LlJlYWRPck11dGF0ZSgpIHZpYSBEb2N1bWVudENvbnRyb2xsZXIuXHJcbiAgICovXHJcbiAgZ2V0T3JDcmVhdGVCcmFuY2hJZChzY2hvb2w6IFZhbHVlPFNjaG9vbD4sIGNvdXJzZUlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBkYi5jb3Vyc2VJbnN0YW5jZXMuaWRzT25seSgpLmlkKGNvdXJzZUlkKS5zd2l0Y2hNYXAoKCk9PiAvLyBUSGlzIGZpcnN0IGxpbmUgdmVyaWZpZXMgY291cnNlIGV4aXN0cy4gSWYgZGVsZXRlZCwgZG9uJ3QgdHJ5IHRvIHJlY3JlYXRlIGl0cyBicmFuY2ghXHJcbiAgICAgIHNjaG9vbC5zd2l0Y2hNYXAoc2Nob29sID0+IFxyXG4gICAgICBkYi5icmFuY2hlc1xyXG4gICAgICAgIC5oYXNFZGdlc0Zyb20oW3NjaG9vbC5vZmZpY2lhbEJyYW5jaElkXSlcclxuICAgICAgICAubmFtZShcImRyYWZ0XCIpXHJcbiAgICAgICAgLnRhZ3MoY291cnNlSWQpXHJcbiAgICAgICAgLmlkc09ubHkoKVxyXG4gICAgICAgIC5tdXRhdGlvbnNPbkVtcHR5KHR4ID0+IHtcclxuICAgICAgICAgIC8vIFRoZXNlIDIgbXV0YXRpb25zIHdpbGwgb2NjdXIgc2VydmVyIHNpZGUsIGF0b21pY2FsbHkuXHJcbiAgICAgICAgICAvLyBXaWxsIGJlIHNlbnQgb24gZWFjaCByZXF1ZXN0IGluIHRoZSBxdWVyeSwgYnV0IHdpbGwgb25seSBleGVjdXRlIGlmIHF1ZXJ5IHJlc3VsdHMgaW4gemVybyBpdGVtcy5cclxuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTY2hvb2w6XCIsIHNjaG9vbCk7XHJcbiAgICAgICAgICBjb25zdCBpZCA9IGNyZWF0ZVVVSUQoKTtcclxuICAgICAgICAgIHR4LmFkZChcImJyYW5jaGVzXCIsIHtcclxuICAgICAgICAgICAgaWQsXHJcbiAgICAgICAgICAgIGFjbDogW1xyXG4gICAgICAgICAgICAgIFwicm9sZTpVU0VSOlJcIixcclxuICAgICAgICAgICAgICBgc2Nob29sUm9sZToke3NjaG9vbC5uYW1lfS9FTVBMT1lFRTpTYFxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBuYW1lOiAnZHJhZnQnLFxyXG4gICAgICAgICAgICBzY2hvb2xJZDogc2Nob29sLmlkLFxyXG4gICAgICAgICAgICB0cmVlUGFyZW50SWQ6IHNjaG9vbC5vZmZpY2lhbEJyYW5jaElkLFxyXG4gICAgICAgICAgICB0YWdzOiBbY291cnNlSWRdXHJcbiAgICAgICAgICB9IGFzIEJyYW5jaCk7XHJcbiAgICAgICAgICAvLyBBcHByb3ZpbmcgdGhlIGJyYW5jaCBtYWtlcyBzdXJlIHRoYXQgaXQgd2FzIGNyZWF0ZWQgYnkgYW4gRU1QTE9ZRUUgb24gZ2l2ZW4gc2Nob29sLlxyXG4gICAgICAgICAgdHgubGluazIoXCJicmFuY2hlc1wiLCBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCwgXCJhcHByb3ZlZENoaWxkcmVuXCIsIGlkKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5zaW5nbGUoKVxyXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKSkpO1xyXG4gIH0sXHJcblxyXG4gIGdldEFsbERlc2NlbmRhbnRJZHMoY291cnNlSWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGRiLmNvdXJzZUJsb2Nrcy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkuY29uY2F0KFxyXG4gICAgICBkYi5jb3Vyc2VDb250ZW50cy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpLmNvbmNhdChcclxuICAgICAgZGIuY291cnNlVGFicy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpLmNvbmNhdChcclxuICAgICAgZGIudGFza3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKVxyXG4gICAgICAubWFwKHggPT4geC5pZCk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XHJcblxyXG5kZWNsYXJlIHZhciBLRUQ6IGFueTtcclxuXHJcbnZhciByZXN1bHQgPSB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJyA/IHt9IDogS0VEO1xyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICB3aW5kb3dbS0VEX05BTUVTUEFDRV0gPSByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJlc3VsdDtcclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcblxyXG5pZiAoY2ZnLktFRF9MT0NBTEUgPT09IFwic3ZcIikge1xyXG4gICAgbW9tZW50LnVwZGF0ZUxvY2FsZSgnc3YnLCB7XHJcbiAgICAgICAgbW9udGhzOiAnamFudWFyaV9mZWJydWFyaV9tYXJzX2FwcmlsX21hal9qdW5pX2p1bGlfYXVndXN0aV9zZXB0ZW1iZXJfb2t0b2Jlcl9ub3ZlbWJlcl9kZWNlbWJlcicuc3BsaXQoJ18nKSxcclxuICAgICAgICBtb250aHNTaG9ydDogJ2phbl9mZWJfbWFyX2Fwcl9tYWpfanVuX2p1bF9hdWdfc2VwX29rdF9ub3ZfZGVjJy5zcGxpdCgnXycpLFxyXG4gICAgICAgIHdlZWtkYXlzOiAnc8O2bmRhZ19tw6VuZGFnX3Rpc2RhZ19vbnNkYWdfdG9yc2RhZ19mcmVkYWdfbMO2cmRhZycuc3BsaXQoJ18nKSxcclxuICAgICAgICB3ZWVrZGF5c1Nob3J0OiAnc8O2bl9tw6VuX3Rpc19vbnNfdG9yX2ZyZV9sw7ZyJy5zcGxpdCgnXycpLFxyXG4gICAgICAgIHdlZWtkYXlzTWluOiAnc8O2X23DpV90aV9vbl90b19mcl9sw7YnLnNwbGl0KCdfJyksXHJcbiAgICAgICAgbG9uZ0RhdGVGb3JtYXQ6IHtcclxuICAgICAgICAgICAgTFQ6ICdISDptbScsXHJcbiAgICAgICAgICAgIExUUzogJ0hIOm1tOnNzJyxcclxuICAgICAgICAgICAgTDogJ1lZWVktTU0tREQnLFxyXG4gICAgICAgICAgICBMTDogJ0QgTU1NTSBZWVlZJyxcclxuICAgICAgICAgICAgTExMOiAnRCBNTU1NIFlZWVkgW2tsLl0gSEg6bW0nLFxyXG4gICAgICAgICAgICBMTExMOiAnZGRkZCBEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXHJcbiAgICAgICAgICAgIGxsbDogJ0QgTU1NIFlZWVkgSEg6bW0nLFxyXG4gICAgICAgICAgICBsbGxsOiAnZGRkIEQgTU1NIFlZWVkgSEg6bW0nXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYWxlbmRhcjoge1xyXG4gICAgICAgICAgICBzYW1lRGF5OiAnW0lkYWddIExUJyxcclxuICAgICAgICAgICAgbmV4dERheTogJ1tJbW9yZ29uXSBMVCcsXHJcbiAgICAgICAgICAgIGxhc3REYXk6ICdbSWfDpXJdIExUJyxcclxuICAgICAgICAgICAgbmV4dFdlZWs6ICdbUMOlXSBkZGRkIExUJyxcclxuICAgICAgICAgICAgbGFzdFdlZWs6ICdbSV0gZGRkZFtzXSBMVCcsXHJcbiAgICAgICAgICAgIHNhbWVFbHNlOiAnTCdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbGF0aXZlVGltZToge1xyXG4gICAgICAgICAgICBmdXR1cmU6ICdvbSAlcycsXHJcbiAgICAgICAgICAgIHBhc3Q6ICdmw7ZyICVzIHNlZGFuJyxcclxuICAgICAgICAgICAgczogJ27DpWdyYSBzZWt1bmRlcicsXHJcbiAgICAgICAgICAgIHNzOiAnJWQgc2VrdW5kZXInLFxyXG4gICAgICAgICAgICBtOiAnZW4gbWludXQnLFxyXG4gICAgICAgICAgICBtbTogJyVkIG1pbnV0ZXInLFxyXG4gICAgICAgICAgICBoOiAnZW4gdGltbWUnLFxyXG4gICAgICAgICAgICBoaDogJyVkIHRpbW1hcicsXHJcbiAgICAgICAgICAgIGQ6ICdlbiBkYWcnLFxyXG4gICAgICAgICAgICBkZDogJyVkIGRhZ2FyJyxcclxuICAgICAgICAgICAgTTogJ2VuIG3DpW5hZCcsXHJcbiAgICAgICAgICAgIE1NOiAnJWQgbcOlbmFkZXInLFxyXG4gICAgICAgICAgICB5OiAnZXR0IMOlcicsXHJcbiAgICAgICAgICAgIHl5OiAnJWQgw6VyJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF5T2ZNb250aE9yZGluYWxQYXJzZTogL1xcZHsxLDJ9KGV8YSkvLFxyXG4gICAgICAgIG9yZGluYWw6IGZ1bmN0aW9uIChudW1iZXIpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSBudW1iZXIgJSAxMCxcclxuICAgICAgICAgICAgICAgIG91dHB1dCA9ICh+fihudW1iZXIgJSAxMDAgLyAxMCkgPT09IDEpID8gJ2UnIDpcclxuICAgICAgICAgICAgICAgICAgICAoYiA9PT0gMSkgPyAnYScgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYiA9PT0gMikgPyAnYScgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGIgPT09IDMpID8gJ2UnIDogJ2UnO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVtYmVyICsgb3V0cHV0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgd2Vlazoge1xyXG4gICAgICAgICAgICBkb3c6IDEsIC8vIE1vbmRheSBpcyB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrLlxyXG4gICAgICAgICAgICBkb3k6IDQgIC8vIFRoZSB3ZWVrIHRoYXQgY29udGFpbnMgSmFuIDR0aCBpcyB0aGUgZmlyc3Qgd2VlayBvZiB0aGUgeWVhci5cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnQgY29uc3QgbG9jYWxNb21lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4gbW9tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykubG9jYWxlKGNmZy5LRURfTE9DQUxFKTtcclxufVxyXG4iLCJpbXBvcnQgeyBLZWRSZXBvIH0gZnJvbSAnLi9rZWQtcmVwbyc7XHJcbmltcG9ydCB7IFVzZXJIaWRkZW5Db3Vyc2UsIFNjaG9vbCwgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IEVEU0NvdXJzZSB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xyXG5pbXBvcnQgeyBzaG93RXJyb3IsIGZsYXR0ZW4sIGNvbXBhcmVQcm9wLCBhcnJheVRvTWFwIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBFRFNQZXJpb2QgfSBmcm9tICcuLi9hcGlzL2Vkc2NsaWVudCc7XHJcbmltcG9ydCB7IGdldFNjaG9vbE1vbWVudCB9IGZyb20gJy4uL3V0aWxzL3NjaG9vbC1tb21lbnQnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmV4cG9ydCBsZXQgaGlkZGVuQ291cnNlc1JlcG8gPSBlbnYuaGlkZGVuQ291cnNlc1JlcG8gYXMgSGlkZGVuQ291cnNlc1JlcG87XHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gIHZpc2libGU6IGJvb2xlYW47XHJcbiAgZGVmYXVsdFZpc2libGU6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyID0gKGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTdWJzY3JpYmVyT3B0aW9ucyB7XHJcbiAgZnVsbENvdXJzZTogYm9vbGVhbjtcclxufVxyXG5cclxuY2xhc3MgSGlkZGVuQ291cnNlc1JlcG8ge1xyXG4gIHJlc3VsdDogQ291cnNlV2l0aEhpZGRlblN0YXRlW10gfCBudWxsID0gbnVsbDtcclxuICBzdWJzY3JpYmVyczoge3N1YnNjcmliZXI6IEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyLCBvcHRpb25zOiBTdWJzY3JpYmVyT3B0aW9uc31bXSA9IFtdO1xyXG4gIGZ1bGxDb3Vyc2U6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBrZWRDb3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxQYXJ0aWFsPENvdXJzZT5bXT47XHJcbiAgZWRzQ291cnNlc1Byb21pc2U6IFByb21pc2U8RURTQ291cnNlW10+O1xyXG4gIHVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxVc2VySGlkZGVuQ291cnNlW10+O1xyXG4gIGtlZFJlcG86IEtlZFJlcG88VXNlckhpZGRlbkNvdXJzZT47XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5rZWRSZXBvID0gbmV3IEtlZFJlcG88VXNlckhpZGRlbkNvdXJzZT4oe1xyXG4gICAgICBnZXRDbGllbnQ6ICgpID0+IGVudi5rZWRCYWNrZW5kQ2xpZW50LFxyXG4gICAgICBvcHRpbWlzdGljOiB0cnVlLFxyXG4gICAgICB0YWJsZTogXCJ1c2VyaGlkZGVuY291cnNlc1wiLFxyXG4gICAgICB1c2VyOiBlbnYuY3VycmVudFVzZXIgPyBlbnYuY3VycmVudFVzZXIubWFpbCA6IFwiXCIsXHJcbiAgICAgIGdldFF1ZXJ5T3B0aW9uczogYXN5bmMgKCkgPT4gKHtyb2xlOiBcIlVTRVJcIn0pLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgaW5pdFByb21pc2UgPSB0aGlzLmluaXQoKTtcclxuXHJcbiAgICBQcm9taXNlLmFsbChbXHJcbiAgICAgIGluaXRQcm9taXNlLFxyXG4gICAgICB0aGlzLmtlZENvdXJzZXNQcm9taXNlLFxyXG4gICAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlXHJcbiAgICBdKS5jYXRjaChlcnIgPT4gc2hvd0Vycm9yKGVycikpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5pdCgpIHtcclxuICAgIC8vIFdhaXQgdGlsbCB3ZSBoYXZlIGEgY3VycmVudFVzZXIgdGhhdCBpcyBhY2N1cmF0ZSBhbHNvIGZvciBpbXBlcnNvbmF0ZWQgdXNlcnMuXHJcbiAgICBjb25zdCBiZWFyZXJQcm9taXNlID0gZW52LmJlYXJlclByb3ZpZGVyID8gZW52LmJlYXJlclByb3ZpZGVyLmdldEJlYXJlcigpIDogUHJvbWlzZS5yZXNvbHZlKHt9KTtcclxuXHJcbiAgICAvLyBJbiBwYXJhbGxlbGwsIHdlIHJlcXVlc3Q6XHJcbiAgICAvLyAgMSkgS0VEQmFja2VuZDogU2Nob29scy5hY3RpdmVDb3Vyc2VzXHJcbiAgICAvLyAgMikgRURTLmdldEFjdGl2ZUFjb3Vyc2VzKClcclxuICAgIC8vICAzKSAodmlhIHN1YnNjcmlwdGlvbik6IEtFREJhY2tlbmQ6IHVzZXJIaWRkZW5Db3Vyc2VzXHJcbiAgICBcclxuICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UgPSBiZWFyZXJQcm9taXNlLnRoZW4oKCk9PnRoaXMubGlzdEtlZENvdXJzZXMoKSk7XHJcbiAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlID0gYmVhcmVyUHJvbWlzZS50aGVuKCgpPT50aGlzLmxpc3RFRFNDb3Vyc2VzKCkpO1xyXG4gICAgbGV0IHJlc29sdmVVc2VySGlkZGVuQ291cnNlc1Byb21pc2U6ICh4OiBVc2VySGlkZGVuQ291cnNlW10pPT52b2lkO1xyXG4gICAgbGV0IHVzZXJIaWRkZW5Db3Vyc2VzUmVzb2x2ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMudXNlckhpZGRlbkNvdXJzZXNQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXNvbHZlVXNlckhpZGRlbkNvdXJzZXNQcm9taXNlID0geCA9PiB7XHJcbiAgICAgIGlmICh1c2VySGlkZGVuQ291cnNlc1Jlc29sdmVkKSB7XHJcbiAgICAgICAgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoeCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdXNlckhpZGRlbkNvdXJzZXNSZXNvbHZlZCA9IHRydWU7XHJcbiAgICAgICAgcmVzb2x2ZSh4KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhd2FpdCBiZWFyZXJQcm9taXNlO1xyXG5cclxuICAgIHRoaXMua2VkUmVwby5tZW0uc3Vic2NyaWJlKGFzeW5jIHVzZXJIaWRkZW5Db3Vyc2VzID0+IHtcclxuICAgICAgLy8gQ2hhbmdlIG9yIGluaXRpYWwgdmFsdWUgcmVhZHkgdG8gYmUgbm90aWZpZWQgb3V0LlxyXG4gICAgICAvLyBCdXQgZmlyc3QsIGNoZWNrIHdlIGhhdmUgYWxsIHRoZSByZWxhdGVkIGRhdGEgcmVzcG9uc2VzIHdlIG5lZWQuXHJcbiAgICAgIGNvbnN0IFthY3RpdmVDb3Vyc2VzLCBlZHNBY3RpdmVDb3Vyc2VzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICB0aGlzLmtlZENvdXJzZXNQcm9taXNlLCBcclxuICAgICAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlXSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZWZpbmUgdGhlIHRocmVlIHJlc3VsdHMgaW50byBhIHNpbmdsZSByZXN1bHRcclxuICAgICAgdGhpcy5yZXN1bHQgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvdXJzZXNMaXN0KGVkc0FjdGl2ZUNvdXJzZXMsIHVzZXJIaWRkZW5Db3Vyc2VzLCBhY3RpdmVDb3Vyc2VzKTtcclxuICAgICAgLy8gTm90aWZ5IG91ciBzdWJzY3JpYmVyczpcclxuICAgICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHN1YnNjcmliZXIgPT4gdGhpcy5ub3RpZnlTdWJzY3JpYmVyKHN1YnNjcmliZXIuc3Vic2NyaWJlciwgc3Vic2NyaWJlci5vcHRpb25zKSk7XHJcbiAgICAgIHJlc29sdmVVc2VySGlkZGVuQ291cnNlc1Byb21pc2UodXNlckhpZGRlbkNvdXJzZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsaXN0S2VkQ291cnNlcygpIHtcclxuICAgIGNvbnN0IGZ1bGxDb3Vyc2UgPSB0aGlzLmZ1bGxDb3Vyc2U7XHJcbiAgICBjb25zb2xlLmxvZyhcIkZ1bGxDb3Vyc2U6IFwiKyBmdWxsQ291cnNlKTtcclxuICAgIGNvbnN0IHNjaG9vbHMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFNjaG9vbD4oJ3NjaG9vbHMnLCB7XHJcbiAgICAgIHJvbGU6IFwiVVNFUlwiLCAvLyBXb3JrYXJvdW5kIGZyb20gc2hvd2luZyBhY3RpdmF0ZWQgdGVtcGxhdGVzIGFtb25nIGNvdXJzZXMgb2YgdGhlIHNjaG9vbFxyXG4gICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuc2Nob29sLFxyXG4gICAgICBpbmNsdWRlOiBcImFjdGl2ZUNvdXJzZXNcIixcclxuICAgICAgZmxhZ3M6IGZ1bGxDb3Vyc2UgPyBbXSA6IFtcImluY2x1ZGVJZHNBbmROYW1lc09ubHlcIl0sXHJcbiAgICAgIGNhY2hlQnVzdDogZW52LmN1cnJlbnRVc2VyLnVzZXJuYW1lXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGFjdGl2ZUNvdXJzZXMgPSBmbGF0dGVuKHNjaG9vbHMubWFwKHNjaG9vbCA9PiBzY2hvb2wuYWN0aXZlQ291cnNlcykpLnNvcnQoY29tcGFyZVByb3AoXCJuYW1lXCIpKVxyXG4gICAgcmV0dXJuIGFjdGl2ZUNvdXJzZXM7XHJcbiAgfVxyXG5cclxuICBsaXN0RURTQ291cnNlcygpOiBQcm9taXNlPEVEU0NvdXJzZVtdIHwgbnVsbD4ge1xyXG4gICAgY29uc3QgcGVyaW9kTmFtZSA9IG5ldyBFRFNQZXJpb2QoZ2V0U2Nob29sTW9tZW50KG1vbWVudCgpKSkucGVyaW9kO1xyXG4gICAgcmV0dXJuIGVudi5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKCdFTVBMT1lFRScpID09PSAtMSA/XHJcbiAgICAgIC8vIFNUVURFTlRzIHNob3VsZCwgYnkgZGVmYXVsdCwgb25seSBzaG93IGNvdXJzZXMgdGhhdCBpcyBsaXN0ZWQgaW4gRURTXHJcbiAgICAgIGVudi5lZHNDbGllbnQuZ2V0QWN0aXZlQ291cnNlcyh7cGVyaW9kTmFtZX0pIDpcclxuICAgICAgLy8gRU1QTE9ZRUVzIHNob3VsZCwgYnkgZGVmYXVsdCwgc2hvdyBhbGwgY291cnNlcyBvbiBzY2hvb2wgLSBubyBuZWVkIHRvIHF1ZXJ5IEVEU1xyXG4gICAgICBudWxsO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgY3JlYXRlQ291cnNlc0xpc3QoXHJcbiAgICBlZHNBY3RpdmVDb3Vyc2VzOiBFRFNDb3Vyc2VbXSB8IG51bGwsXHJcbiAgICB1c2VySGlkZGVuQ291cnNlczogVXNlckhpZGRlbkNvdXJzZVtdLFxyXG4gICAgYWN0aXZlQ291cnNlczogUGFydGlhbDxDb3Vyc2U+W10pIDogUHJvbWlzZTxDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXT5cclxuICB7XHJcbiAgICBjb25zdCBoaWRkZW5Db3Vyc2VzTWFwID0gYXJyYXlUb01hcCh1c2VySGlkZGVuQ291cnNlcy5maWx0ZXIoaGMgPT4gIWhjLnNob3cpLCBoYyA9PiBoYy5uYW1lKTtcclxuICAgIGNvbnN0IHZpc2libGVDb3Vyc2VzTWFwID0gYXJyYXlUb01hcCh1c2VySGlkZGVuQ291cnNlcy5maWx0ZXIoaGMgPT4gaGMuc2hvdyksIGhjID0+IGhjLm5hbWUpO1xyXG5cclxuICAgIGNvbnN0IGlzU3R1ZGVudCA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ1NUVURFTlQnKTtcclxuXHJcbiAgICBjb25zdCBlZHNDb3Vyc2VNYXAgPSBlZHNBY3RpdmVDb3Vyc2VzID9cclxuICAgICAgYXJyYXlUb01hcChlZHNBY3RpdmVDb3Vyc2VzLCBjID0+IGMubmFtZSkgOlxyXG4gICAgICB7fTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLmFsbChhY3RpdmVDb3Vyc2VzLm1hcChhc3luYyAoe2lkLCBuYW1lLCBkZXNjcmlwdGlvbiwgbW9kaWZpZWRCeX0pID0+IHtcclxuXHJcbiAgICAgIGxldCBlZHNDb3Vyc2UgPSBlZHNDb3Vyc2VNYXBbbmFtZV07XHJcblxyXG4gICAgICBsZXQgZGVmYXVsdFZpc2libGUgPSBpc1N0dWRlbnQgP1xyXG4gICAgICAgIGVkc0NvdXJzZSAhPSBudWxsIDogLy8gQ291cnNlIG5hbWUgYWxzbyBsaXN0ZWQgaW4gRURTXHJcbiAgICAgICAgdHJ1ZTsgLy8gVGVhY2hlcnMgbm90IGRlcGVuZGVudCBvbiBFRFMgbGlzdGluZ1xyXG5cclxuICAgICAgbGV0IHZpc2libGUgPSBkZWZhdWx0VmlzaWJsZSA/XHJcbiAgICAgICAgIWhpZGRlbkNvdXJzZXNNYXBbaWRdIDogLy8gVmlzaWJsZSB1bmxlc3MgdXNlciBoYXMgb3ZlcnJpZGRlbiB0aGF0LlxyXG4gICAgICAgICEhdmlzaWJsZUNvdXJzZXNNYXBbaWRdOyAvLyBIaWRkZW4gdW5sZXNzIHVzZXIgaGFzIG92ZXJyaWRkZW4gdGhhdC5cclxuICAgICAgXHJcbiAgICAgIC8vIFJlc29sdmUgZGVzY3JpcHRpb246XHJcbiAgICAgIGlmIChtb2RpZmllZEJ5ICYmIG1vZGlmaWVkQnkubmFtZSAmJiAhZGVzY3JpcHRpb24pIHtcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGAke21vZGlmaWVkQnkubmFtZX1zIHZlcnNpb25gO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGlkLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgdmlzaWJsZSxcclxuICAgICAgICBkZWZhdWx0VmlzaWJsZVxyXG4gICAgICB9O1xyXG4gICAgfSkpO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQuc29ydCgoe25hbWU6IGF9LCB7bmFtZTogYn0pID0+IGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGhpZGVDb3Vyc2UoYzogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XHJcbiAgICBjb25zdCBvdmVycmlkZXMgPSB0aGlzLmtlZFJlcG8ubWVtLml0ZW1zLmZpbHRlcihoYyA9PiBoYy5uYW1lID09PSBjLmlkKTtcclxuICAgIGlmIChjLmRlZmF1bHRWaXNpYmxlKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5pbnNlcnQoW3tcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIG5hbWU6IGMuaWRcclxuICAgICAgfV0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgdGhpcy5rZWRSZXBvLmRlbGV0ZShvdmVycmlkZXMubWFwKG92ID0+IG92LmlkKSk7ICAgICAgXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBzaG93Q291cnNlKGM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xyXG4gICAgY29uc3Qgb3ZlcnJpZGVzID0gdGhpcy5rZWRSZXBvLm1lbS5pdGVtcy5maWx0ZXIoaGMgPT4gaGMubmFtZSA9PT0gYy5pZCk7XHJcbiAgICBpZiAoYy5kZWZhdWx0VmlzaWJsZSkge1xyXG4gICAgICBhd2FpdCB0aGlzLmtlZFJlcG8uZGVsZXRlKG92ZXJyaWRlcy5tYXAob3YgPT4gb3YuaWQpKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5pbnNlcnQoW3tcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIG5hbWU6IGMuaWQsXHJcbiAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICB9XSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBub3RpZnlTdWJzY3JpYmVyID0gKHN1YnNjcmliZXI6IEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyLCBvcHRpb25zOiBTdWJzY3JpYmVyT3B0aW9ucykgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgc3Vic2NyaWJlcihvcHRpb25zLmZ1bGxDb3Vyc2UgPyB0aGlzLnJlc3VsdCA6IHRoaXMucmVzdWx0LmZpbHRlcihjID0+IGMudmlzaWJsZSkpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIHN1YnNjcmliZSAoc3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zKSB7XHJcbiAgICBpZiAoIXRoaXMuZnVsbENvdXJzZSAmJiBvcHRpb25zLmZ1bGxDb3Vyc2UpIHtcclxuICAgICAgLy8gVGhlIHN1YnNjcmliZXIgZGVtYW5kcyBmdWxsIGNvdXJzZXNcclxuICAgICAgLy8gTmVlZCB0byBxdWVyeSB0aGF0IGJlZm9yZSBub3RpZnlpbmdcclxuICAgICAgLy8gQWxzbyBhZmZlY3Qgc3RhdGUgZm9yIGZ1dHVyZSBpbnRlcm5hbCBub3RpZmljYXRpb25cclxuICAgICAgdGhpcy5mdWxsQ291cnNlID0gb3B0aW9ucy5mdWxsQ291cnNlO1xyXG4gICAgICB0aGlzLmtlZENvdXJzZXNQcm9taXNlID0gdGhpcy5saXN0S2VkQ291cnNlcygpOyAvLyBSZWRvIHRoaXMgY2FsbCwgbm93IGxvYWRpbmcgZnVsbCBjb3Vyc2VzXHJcbiAgICAgIC8vIFdhaXQgZm9yIGFsbCBvdXRzdGFuZGluZyBmZXRjaCgpIGNhbGxzIHRvIGNvbXBsZXRlOlxyXG4gICAgICBjb25zdCBbYWN0aXZlQ291cnNlcywgZWRzQWN0aXZlQ291cnNlcywgdXNlckhpZGRlbkNvdXJzZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UsIFxyXG4gICAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2UsXHJcbiAgICAgICAgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2VdKTtcclxuICAgICAgLy8gQXNzZW1ibGUgcmVzdWx0OlxyXG4gICAgICB0aGlzLnJlc3VsdCA9IGF3YWl0IHRoaXMuY3JlYXRlQ291cnNlc0xpc3QoZWRzQWN0aXZlQ291cnNlcywgdXNlckhpZGRlbkNvdXJzZXMsIGFjdGl2ZUNvdXJzZXMpO1xyXG4gICAgfVxyXG4gICAgYXdhaXQgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2U7IC8vIFNvIHdlIGtub3cgdGhhdCB0aGlzLnJlc3VsdCBpcyB0aGVyZS5cclxuICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcihzdWJzY3JpYmVyLCBvcHRpb25zKTtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMucHVzaCh7c3Vic2NyaWJlciwgb3B0aW9uc30pO1xyXG4gIH1cclxuXHJcbiAgdW5zdWJzY3JpYmUgKHN1YnNjcmliZXI6IEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyKSB7XHJcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIocyA9PiBzLnN1YnNjcmliZXIgIT09IHN1YnNjcmliZXIpO1xyXG4gIH1cclxufVxyXG5cclxuaWYgKCFoaWRkZW5Db3Vyc2VzUmVwbykge1xyXG4gIGhpZGRlbkNvdXJzZXNSZXBvID0gZW52LmhpZGRlbkNvdXJzZXNSZXBvID0gbmV3IEhpZGRlbkNvdXJzZXNSZXBvKCk7XHJcbn1cclxuIiwiaW1wb3J0IHsgUmVwbywgUmVwb0NvbW11bmljYXRvcn0gZnJvbSAnLi9yZXBvJztcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCwgTGlzdE9wdGlvbnMsIEJhdGNoUnVubmVyLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBEb2N1bWVudH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBLZWRSZXBvT3B0aW9uczxUIGV4dGVuZHMgRG9jdW1lbnQ+IHtcclxuICBnZXRDbGllbnQ6ICgpPT5LZWRCYWNrZW5kQ2xpZW50O1xyXG4gIGdldFF1ZXJ5T3B0aW9uczogKCk9PlByb21pc2U8TGlzdE9wdGlvbnM+O1xyXG4gIG9wdGltaXN0aWM6IGJvb2xlYW47XHJcbiAgdGFibGU6IHN0cmluZztcclxuICB1c2VyOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBLZWRSZXBvPFQgZXh0ZW5kcyBEb2N1bWVudD4ge1xyXG4gIG1lbTogUmVwbzxUPjtcclxuICBvcHRpb25zOiBLZWRSZXBvT3B0aW9uczxUPjtcclxuICBcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBLZWRSZXBvT3B0aW9uczxUPikge1xyXG4gICAgY29uc3Qge3RhYmxlLCBnZXRDbGllbnQsIGdldFF1ZXJ5T3B0aW9uc30gPSBvcHRpb25zO1xyXG4gICAgdGhpcy5tZW0gPSBuZXcgUmVwbzxUPih7cXVlcnk6IGFzeW5jICgpPT57XHJcbiAgICAgIGNvbnN0IHF1ZXJ5T3B0aW9ucyA9IGF3YWl0IGdldFF1ZXJ5T3B0aW9ucygpO1xyXG4gICAgICByZXR1cm4gYXdhaXQgZ2V0Q2xpZW50KCkubGlzdDxUPih0YWJsZSwge1xyXG4gICAgICAgIC4uLnF1ZXJ5T3B0aW9ucyxcclxuICAgICAgICBjYWNoZUJ1c3Q6IHRoaXMuZ2V0Q2FjaGVCdXN0KCl9KTtcclxuICAgIH19KTtcclxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdldENhY2hlQnVzdCgpIHtcclxuICAgIGNvbnN0IHt0YWJsZSwgdXNlcn0gPSB0aGlzLm9wdGlvbnM7XHJcbiAgICBjb25zdCBjYWNoZUJ1c3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FjaGUtYnVzdC0nICsgdGFibGUgKyAnLScgKyB1c2VyKTtcclxuICAgIHJldHVybiBjYWNoZUJ1c3QgfHwgdGhpcy5yZWdlbmVyYXRlQ2FjaGVCdXN0KCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlZ2VuZXJhdGVDYWNoZUJ1c3QoKSB7XHJcbiAgICBjb25zdCB7dGFibGUsIHVzZXJ9ID0gdGhpcy5vcHRpb25zO1xyXG4gICAgY29uc3QgY2FjaGVCdXN0ID0gY3JlYXRlVVVJRCgpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhY2hlLWJ1c3QtJyArIHRhYmxlICsgJy0nICsgdXNlciwgY2FjaGVCdXN0KTtcclxuICAgIHJldHVybiBjYWNoZUJ1c3Q7XHJcbiAgfVxyXG5cclxuICBhc3luYyB1cHNlcnQoaXRlbTogVCwgdXBkYXRlcjogKGl0ZW06IFQpID0+IHZvaWQpIHtcclxuICAgIGlmICghaXRlbS4kZXRhZykge1xyXG4gICAgICAvLyBJdGVtcyB3aXRob3V0ICRldGFnIGNhbm5vdCBiZSByZXRyaWV2ZWQgZnJvbSBzZXJ2ZXIsIHNvIGl0IHNob3VsZCBiZSBpbnNlcnRlZC5cclxuICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKTtcclxuICAgICAgdXBkYXRlcih1cGRhdGVkSXRlbSk7XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmluc2VydChbdXBkYXRlZEl0ZW1dKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFdlIGhhdmUgYW4gJGV0YWcsIHNvIHdlIGNhbiBleHBlY3QgaXQgdG8gbGl2ZSBvbiB0aGUgc2VydmVyLlxyXG4gICAgICAvLyBIb3dldmVyLCB0YWtlIGNhcmUgb2YgdGhlIHVubGlrZWx5IHNpdHVhdGlvbiB0aGF0IGl0IHdhcyBkZWxldGVkIGZyb20gc2VydmVyLFxyXG4gICAgICAvLyBhbmQgaWYgc28sIGluc2VydCBpdCBhZ2Fpbi5cclxuICAgICAgYXdhaXQgdGhpcy51cGRhdGUoW2l0ZW1dLCB1cGRhdGVyKS5jYXRjaChlID0+IHtcclxuICAgICAgICBpZiAoZS5uYW1lID09PSBcImh0dHA0MDRcIikge1xyXG4gICAgICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKTtcclxuICAgICAgICAgIHVwZGF0ZXIodXBkYXRlZEl0ZW0pO1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuaW5zZXJ0KFt1cGRhdGVkSXRlbV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlKGl0ZW1zOiBUW10sIHVwZGF0ZXI6IChpdGVtOiBUKSA9PiB2b2lkKSB7XHJcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZX0gPSB0aGlzLm9wdGlvbnM7XHJcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcclxuICAgIGNvbnN0IG1vZGlmaWVkSXRlbXM6IFRbXSA9IGl0ZW1zLm1hcChpdGVtID0+IHtcclxuICAgICAgY29uc3QgbWVtUmVwb0l0ZW0gPSB0aGlzLm1lbS5pdGVtcy5maW5kKGl0ID0+IGl0LmlkID09PSBpdGVtLmlkKTtcclxuICAgICAgaXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIG1lbVJlcG9JdGVtIHx8IGl0ZW0pO1xyXG4gICAgICB1cGRhdGVyKGl0ZW0pO1xyXG4gICAgICByZXR1cm4gaXRlbTtcclxuICAgIH0pO1xyXG4gICAgaWYgKG9wdGltaXN0aWMpIGF3YWl0IHRoaXMubWVtLnVwZGF0ZShtb2RpZmllZEl0ZW1zLm1hcCh4ID0+IE9iamVjdC5hc3NpZ24oe30sIHgsIHskbWV0YTogJ3VwZGF0aW5nJ30pKSk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQuZG8gKGJyID0+IG1vZGlmaWVkSXRlbXMuZm9yRWFjaChpdGVtID0+IGJyLnB1dCh0YWJsZSwgaXRlbSkpKVxyXG4gICAgLmNhdGNoKGUgPT4gZS5uYW1lID09PSBcImh0dHA0MDlcIiA/IC8vIGNvbmZsaWN0XHJcbiAgICAgIC8vIEdldCBhIGZyZXNoIHZlcnNpb24gZnJvbSBzZXJ2ZXI6XHJcbiAgICAgIGNsaWVudC5saXN0PFQ+KHRhYmxlLCB7aWRzOiBpdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmlkKX0sIHtjYWNoZTogJ25vLWNhY2hlJ30pLnRoZW4oZnJlc2hJdGVtcyA9PiB7XHJcbiAgICAgICAgLy8gVXBkYXRlIGxvY2FsIHZlcnNpb246XHJcbiAgICAgICAgY29uc3QgbW9kaWZpZWRJdGVtcyA9IGZyZXNoSXRlbXMubWFwKGZyZXNoSXRlbSA9PiB7XHJcbiAgICAgICAgICAvLyBDbG9uZSB0aGUgZnJlc2ggaXRlbVxyXG4gICAgICAgICAgY29uc3QgbW9kaWZpZWQgPSBPYmplY3QuYXNzaWduKHt9LCBmcmVzaEl0ZW0pO1xyXG4gICAgICAgICAgLy8gUmUtcnVuIHRoZSB1cGRhdGVyIG9uIHRoZSBjbG9uZTpcclxuICAgICAgICAgIHVwZGF0ZXIobW9kaWZpZWQpO1xyXG4gICAgICAgICAgcmV0dXJuIG1vZGlmaWVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFJlLWRvIHRoZSB0aGUgcHV0IG9wZXJhdGlvbiB0b3dhcmRzIHRoZSBzZXJ2ZXIuXHJcbiAgICAgICAgcmV0dXJuIGNsaWVudC5kbyhiciA9PiBtb2RpZmllZEl0ZW1zLmZvckVhY2goaXRlbSA9PiBici5wdXQodGFibGUsIGl0ZW0pKSk7XHJcbiAgICAgIH0pIDpcclxuICAgICAgLy8gT3RoZXIgdW5leHBlY3RlZCBlcnJvcjpcclxuICAgICAgUHJvbWlzZS5yZXNvbHZlKG9wdGltaXN0aWMgJiZcclxuICAgICAgICB0aGlzLm1lbS51cGRhdGUoaXRlbXMpKSAvLyBVbmRvIG9wdGltaXN0aWMgdXBkYXRlXHJcbiAgICAgIC50aGVuKCgpPT57XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpOyAvLyBSZWplY3Qgd2l0aCB0aGUgZXJyb3Igbm8gbWF0dGVyLlxyXG4gICAgICB9KSk7XHJcbiAgICB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcclxuICAgIG1vZGlmaWVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgaXRlbS4kZXRhZyA9IHJlcy5uZXdFdGFnc1tpdGVtLmlkXTtcclxuICAgICAgaXRlbS4kbWV0YSA9IHVuZGVmaW5lZDtcclxuICAgIH0pO1xyXG4gICAgYXdhaXQgdGhpcy5tZW0udXBkYXRlKG1vZGlmaWVkSXRlbXMpOyAvLyBFbnN1cmVzIG5ldyBldGFnIGlzIGlzIGFwcGxpZWQgb24gbmV4dCBhY3Rpb24uXHJcbiAgfVxyXG5cclxuICBzdHJpcEdyYXBocyAoaXRlbXM6IFRbXSwgZ3JhcGhzOiBzdHJpbmdbXSkge1xyXG4gICAgcmV0dXJuIGl0ZW1zLm1hcChpdGVtID0+IHtcclxuICAgICAgY29uc3QgY2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKTtcclxuICAgICAgZ3JhcGhzLmZvckVhY2goZ3JhcGggPT4ge1xyXG4gICAgICAgIGlmIChpdGVtW2dyYXBoXSkge1xyXG4gICAgICAgICAgY2xvbmVbZ3JhcGhdID0gKGl0ZW1bZ3JhcGhdIGFzIHtpZDpzdHJpbmd9W10pLm1hcCAoZG9jID0+ICh7aWQ6IGRvYy5pZH0pKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gY2xvbmU7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGluc2VydChpdGVtczogVFtdKSB7XHJcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZSwgZ2V0UXVlcnlPcHRpb25zfSA9IHRoaXMub3B0aW9ucztcclxuICAgIGNvbnN0IGNsaWVudCA9IGdldENsaWVudCgpO1xyXG4gICAgY29uc3QgcXVlcnlPcHRpb25zID0gYXdhaXQgZ2V0UXVlcnlPcHRpb25zKCk7XHJcbiAgICBjb25zdCBncmFwaHMgPSBbXS5jb25jYXQocXVlcnlPcHRpb25zLmluY2x1ZGUpO1xyXG4gICAgLy8gR2l2ZSBJRHMgdG8gZWFjaCBpdGVtOlxyXG4gICAgaXRlbXMgPSBpdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmlkID8gaXRlbSA6IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0sIHtpZDogY3JlYXRlVVVJRCgpfSkpO1xyXG4gICAgY29uc3Qgc3RyaXBwZWQgPSB0aGlzLnN0cmlwR3JhcGhzKGl0ZW1zLCBncmFwaHMpO1xyXG4gICAgaWYgKG9wdGltaXN0aWMpIGF3YWl0IHRoaXMubWVtLmluc2VydChzdHJpcHBlZC5tYXAoeCA9PiBPYmplY3QuYXNzaWduKHt9LCB4LCB7JG1ldGE6ICdhZGRpbmcnfSkpKTtcclxuICAgIGNvbnN0IGJyID0gbmV3IEJhdGNoUnVubmVyKCk7XHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RyaXBwZWQpIHtcclxuICAgICAgLy8gQWxzbyBhZGQgbGlua3MgdG8gYWxsIGZvcmVpZ24gcmVsYXRlZCBpdGVtczpcclxuICAgICAgZm9yIChjb25zdCBncmFwaCBvZiBncmFwaHMpIHtcclxuICAgICAgICBjb25zdCBmb3JlaWduSXRlbXM6IERvY3VtZW50W10gPSBpdGVtW2dyYXBoXTtcclxuICAgICAgICBpZiAoZm9yZWlnbkl0ZW1zKSB7XHJcbiAgICAgICAgICBmb3JlaWduSXRlbXMuZm9yRWFjaChkb2MgPT4ge1xyXG4gICAgICAgICAgICBici5saW5rMih0YWJsZSwgaXRlbS5pZCwgZ3JhcGgsIGRvYy5pZCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgYnIuYWRkKHRhYmxlLCBpdGVtKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNsaWVudC5iYXRjaChici5tdXRhdGlvblJlcXVlc3RzKS5jYXRjaChlID0+IHtcclxuICAgICAgaWYgKG9wdGltaXN0aWMpIHRoaXMubWVtLmRlbGV0ZShpdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmlkKSk7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcclxuICAgIH0pXHJcbiAgICB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcclxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiBpdGVtLiRldGFnID0gcmVzLm5ld0V0YWdzW2l0ZW0uaWRdKTtcclxuICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUoaXRlbXMpOyAvLyBVcGRhdGUgd2l0aCBuZXcgJGV0YWcuXHJcbiAgICBlbHNlXHJcbiAgICAgIGF3YWl0IHRoaXMubWVtLmluc2VydChpdGVtcyk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBkZWxldGUgKGlkczogc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcclxuICAgIGNvbnN0IGNsaWVudCA9IGdldENsaWVudCgpO1xyXG4gICAgaWYgKG9wdGltaXN0aWMpIGF3YWl0IHRoaXMubWVtLnVwZGF0ZShpZHNcclxuICAgICAgLm1hcChpZCA9PiB0aGlzLm1lbS5pdGVtcy5maW5kKHggPT4geC5pZCA9PT0gaWQpKVxyXG4gICAgICAuZmlsdGVyKHggPT4geClcclxuICAgICAgLm1hcCh4ID0+IE9iamVjdC5hc3NpZ24oe30sIHgsIHskbWV0YTogJ2RlbGV0aW5nJ30pKSk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQuZG8gKGJyID0+IGlkcy5mb3JFYWNoKGlkID0+IGJyLmRlbGV0ZSh0YWJsZSwgaWQpKSkuY2F0Y2goYXN5bmMgZSA9PiB7XHJcbiAgICAgIGlmIChvcHRpbWlzdGljKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5tZW0udXBkYXRlKGlkc1xyXG4gICAgICAgICAgLm1hcChpZCA9PiB0aGlzLm1lbS5pdGVtcy5maW5kKHggPT4geC5pZCA9PT0gaWQpKVxyXG4gICAgICAgICAgLmZpbHRlcih4ID0+IHgpXHJcbiAgICAgICAgICAubWFwKHggPT4ge1xyXG4gICAgICAgICAgICB4ID0gT2JqZWN0LmFzc2lnbih7fSwgeCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB4LiRtZXRhO1xyXG4gICAgICAgICAgICByZXR1cm4geDtcclxuICAgICAgICAgIH0pKTtcclxuICAgICAgfVxyXG4gICAgICB0aHJvdyBlO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcclxuICAgIGF3YWl0IHRoaXMubWVtLmRlbGV0ZShpZHMpO1xyXG4gIH1cclxufVxyXG4iLCJcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVwb0NvbW11bmljYXRvcjxUIGV4dGVuZHMge2lkOiBzdHJpbmd9PiB7XHJcbiAgcXVlcnkoKTogUHJvbWlzZTxUW10+O1xyXG59XHJcblxyXG50eXBlIFN1YnNjcmliZXI8VD4gPSAoaXRlbXM6VFtdLCBlcnJvcjogdW5kZWZpbmVkIHwgRXJyb3IpID0+IGFueTtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZXBvPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcclxuICBsaXN0UHJvbWlzZTogUHJvbWlzZTx2b2lkPjtcclxuICBpdGVtczogVFtdO1xyXG4gIGVycm9yPzogRXJyb3I7XHJcbiAgc3Vic2NyaWJlcnM6IFN1YnNjcmliZXI8VD5bXTtcclxuXHJcbiAgY29uc3RydWN0b3IocHVibGljIGNvbW06IFJlcG9Db21tdW5pY2F0b3I8VD4pIHtcclxuICAgIHRoaXMubGlzdFByb21pc2UgPSBudWxsO1xyXG4gICAgdGhpcy5pdGVtcyA9IG51bGw7XHJcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XHJcbiAgfVxyXG5cclxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikge1xyXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcclxuICAgICAgc3Vic2NyaWJlcih0aGlzLml0ZW1zLCB0aGlzLmVycm9yKTtcclxuICAgICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHN1YnNjcmliZXIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1bnN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XHJcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIgKHMgPT4gcyAhPT0gc3Vic2NyaWJlcik7XHJcbiAgfVxyXG5cclxuICBub3RpZnlTdWJzY3JpYmVycygpIHtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMuZm9yRWFjaChzID0+IHModGhpcy5pdGVtcywgdGhpcy5lcnJvcikpO1xyXG4gIH1cclxuXHJcbiAgZW5zdXJlSGFzRGF0YSgpIHtcclxuICAgIGlmICghdGhpcy5saXN0UHJvbWlzZSkgdGhpcy5yZWZyZXNoRnJvbVNlcnZlcigpO1xyXG4gICAgcmV0dXJuIHRoaXMubGlzdFByb21pc2U7XHJcbiAgfVxyXG5cclxuICByZWZyZXNoRnJvbVNlcnZlcigpIHtcclxuICAgIHRoaXMubGlzdFByb21pc2UgPSB0aGlzLmNvbW0ucXVlcnkoKS50aGVuKGl0ZW1zID0+IHtcclxuICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICB0aGlzLmVycm9yID0gbnVsbDtcclxuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICB0aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zIHx8IFtdO1xyXG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0aGlzLmxpc3RQcm9taXNlO1xyXG4gIH1cclxuICBcclxuICBhc3luYyB1cGRhdGUoaXRlbTogVCB8IFRbXSkge1xyXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVIYXNEYXRhKCk7XHJcbiAgICBjb25zdCB1cGRhdGVkSXRlbXMgPSBBcnJheS5pc0FycmF5KGl0ZW0pID8gaXRlbSA6IFtpdGVtXTtcclxuICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLm1hcChpdCA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0gdXBkYXRlZEl0ZW1zLmZpbmQoKHtpZH0pID0+IGl0LmlkID09PSBpZCk7XHJcbiAgICAgIHJldHVybiB1cGRhdGVkSXRlbSA/XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgdXBkYXRlZEl0ZW0pIDpcclxuICAgICAgICBpdDtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gIH1cclxuXHJcbiAgaW5zZXJ0KGl0ZW06IFQgfCBUW10pIHtcclxuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XHJcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLmNvbmNhdChpdGVtKTtcclxuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGUoaWQ6IHN0cmluZyB8IHN0cmluZ1tdKSB7XHJcbiAgICBjb25zdCBpZHMgPSBBcnJheS5pc0FycmF5KGlkKSA/IGlkIDogW2lkXTtcclxuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XHJcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLmZpbHRlcihpdCA9PiAhaWRzLnNvbWUoaWQgPT4gaXQuaWQgPT09IGlkKSk7XHJcbiAgICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge0tlZFJlcG99IGZyb20gJy4va2VkLXJlcG8nO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL3dlZWtwbGFubmVyL3dlZWtwbGFubmVyLXBlcnNpc3RlZC1zdGF0ZVwiO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIERvY3VtZW50QWNjZXNzLCBLZWRCYWNrZW5kQ2xpZW50IH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyBnZXRBZGp1c3RlZFdlZWssIEtFRFdlZWsgfSBmcm9tICcuLi91dGlscy93ZWVrdXRpbCc7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcblxyXG5leHBvcnQgbGV0IHVzZXJUYXNrc1JlcG8gPSBlbnYudXNlclRhc2tzUmVwbyBhcyBVc2VyVGFza3NSZXBvO1xyXG5cclxuZXhwb3J0IGNsYXNzIFVzZXJUYXNrc1JlcG8gZXh0ZW5kcyBLZWRSZXBvPFVzZXJUYXNrPiB7XHJcbiAgcGVyc2lzdGVkU3RhdGU6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUgfCBudWxsO1xyXG4gIGdldEN1cnJlbnRVc2VyOiAoKT0+VXNlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoZ2V0Q2xpZW50OiAoKT0+S2VkQmFja2VuZENsaWVudCwgZ2V0Q3VycmVudFVzZXI6ICgpPT5Vc2VyKSB7ICAgIFxyXG4gICAgc3VwZXIoe1xyXG4gICAgICBnZXRDbGllbnQsXHJcbiAgICAgIG9wdGltaXN0aWM6IHRydWUsXHJcbiAgICAgIHRhYmxlOiBcInVzZXJ0YXNrc1wiLFxyXG4gICAgICB1c2VyOiBnZXRDdXJyZW50VXNlcigpID8gZ2V0Q3VycmVudFVzZXIoKS5tYWlsIDogXCJcIixcclxuICAgICAgZ2V0UXVlcnlPcHRpb25zOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xyXG4gICAgICAgIGNvbnN0IHVzZXJFbWFpbCA9IGN1cnJlbnRVc2VyID8gY3VycmVudFVzZXIubWFpbCA6IFwiXCI7XHJcbiAgICAgICAgaWYgKCF0aGlzLnBlcnNpc3RlZFN0YXRlKVxyXG4gICAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh1c2VyRW1haWwpO1xyXG4gICAgICAgIGNvbnN0IHsgd2Vla0RhdGUgfSA9IHRoaXMucGVyc2lzdGVkU3RhdGU7XHJcbiAgICAgICAgY29uc3Qgd2Vla051bWJlciA9IG1vbWVudCh3ZWVrRGF0ZSkud2VlaygpO1xyXG4gICAgICAgIGNvbnN0IGtlZFdlZWsgPSBLRURXZWVrKG1vbWVudCh3ZWVrRGF0ZSkueWVhcigpLCB3ZWVrTnVtYmVyKTtcclxuICAgICAgICAvKmNvbnN0IFtmcm9tLCB0b10gPSBbbW9tZW50KHdlZWtEYXRlKS5zdGFydE9mKCd3ZWVrJyksIG1vbWVudCh3ZWVrRGF0ZSkuZW5kT2YoJ3dlZWsnKV1cclxuICAgICAgICAgIC5tYXAobSA9PiBtLnRvRGF0ZSgpLmdldFRpbWUoKSk7Ki9cclxuICAgICAgICBcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGZyb206IGtlZFdlZWsubm90QmVmb3JlLFxyXG4gICAgICAgICAgICB0bzoga2VkV2Vlay5ub3RBZnRlcixcclxuICAgICAgICAgICAgcm9sZTogXCJVU0VSXCIsXHJcbiAgICAgICAgICAgIGluY2x1ZGU6IFtcInRhc2tcIiwgXCJjb3Vyc2VcIl0sXHJcbiAgICAgICAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLnBlcnNpc3RlZFN0YXRlID0gbnVsbDtcclxuICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcjtcclxuICB9XHJcblxyXG4gIGFzeW5jIHVwZGF0ZVBlcnNpc3RlZFN0YXRlKHN0YXRlQ2hhbmdlczogUGFydGlhbDxXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlPikge1xyXG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnBlcnNpc3RlZFN0YXRlLCBzdGF0ZUNoYW5nZXMpO1xyXG4gICAgYXdhaXQgdGhpcy5wZXJzaXN0ZWRTdGF0ZS5zYXZlKCk7XHJcbiAgICB0aGlzLm1lbS5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0VGFza0RvbmVTdGF0ZSh1c2VyVGFzazogVXNlclRhc2ssIGRvbmU6IGJvb2xlYW4pIHtcclxuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcclxuICAgIGNvbnN0IGNsaWVudCA9IGdldENsaWVudCgpO1xyXG4gICAgY29uc3QgbW9kaWZpZWRJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgdXNlclRhc2ssIHtkb25lfSk7XHJcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVkSXRlbSwgeyRtZXRhOiAndXBkYXRpbmcnfSkpO1xyXG4gICAgLy8gTm93IG1ha2Ugc3VyZSB0byBjaGFuZ2UgdGhlIHN0YXRlIGZvciBvdGhlciB3ZWVrcyBhcyB3ZWxsOlxyXG4gICAgY29uc3Qgc2ltaWxhclRhc2tzID0gYXdhaXQgY2xpZW50Lmxpc3Q8VXNlclRhc2s+KCd1c2VydGFza3MnLCB7XHJcbiAgICAgIG5hbWU6IHVzZXJUYXNrLm5hbWUsXHJcbiAgICAgIHJvbGU6IFwiVVNFUlwiLFxyXG4gICAgICBpbmNsdWRlOiBbXCJ0YXNrXCIsXCJjb3Vyc2VcIl0sXHJcbiAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcclxuICAgICAgZnJvbTogbW9tZW50KHRoaXMucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUpLmFkZCgtMywgJ3dlZWtzJykudmFsdWVPZigpLFxyXG4gICAgICB0bzogbW9tZW50KHRoaXMucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUpLmFkZCgzLCAnd2Vla3MnKS52YWx1ZU9mKClcclxuICAgIH0sIHtcclxuICAgICAgY2FjaGU6ICduby1jYWNoZSdcclxuICAgIH0pO1xyXG4gICAgY29uc3QgaWRlbnRpY2FsVGFza3MgPSBzaW1pbGFyVGFza3MuZmlsdGVyKHQgPT5cclxuICAgICAgdC5jb3Vyc2VOYW1lID09PSB1c2VyVGFzay5jb3Vyc2VOYW1lICYmXHJcbiAgICAgIHQubGVhcm5pbmdHb2FsID09PSB1c2VyVGFzay5sZWFybmluZ0dvYWwgJiZcclxuICAgICAgKCF1c2VyVGFzay50YXNrIHx8IHQudGFzay5tYXAodD0+dC5pZCkuam9pbignJykgPT09IHVzZXJUYXNrLnRhc2subWFwKHQ9PnQuaWQpLmpvaW4oJycpKSAmJlxyXG4gICAgICAoIXVzZXJUYXNrLmNvdXJzZSB8fCB0LmNvdXJzZS5tYXAoYz0+Yy5pZCkuam9pbignJykgPT09IHVzZXJUYXNrLmNvdXJzZS5tYXAoYz0+Yy5pZCkuam9pbignJykpKTtcclxuICAgIGlmIChpZGVudGljYWxUYXNrcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgaXNzdWUgaW4gU3ViamVjdFBsYW5uZXIgbWlncmF0aW9uICh1c2VydGFza3Mgd2l0aCBsb25nIG5hbWVzIGlzIG5vdCBmb3VuZClcclxuICAgICAgaWRlbnRpY2FsVGFza3MucHVzaCh1c2VyVGFzaylcclxuICAgIH1cclxuICAgIGF3YWl0IHRoaXMudXBkYXRlKGlkZW50aWNhbFRhc2tzLCB0ID0+IHQuZG9uZSA9IGRvbmUpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0U3ViVGFza0RvbmVTdGF0ZSAodXNlclRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrSWQ6IHN0cmluZywgZG9uZTogYm9vbGVhbikge1xyXG4gICAgY29uc3Qge2dldENsaWVudCwgb3B0aW1pc3RpYywgdGFibGV9ID0gdGhpcy5vcHRpb25zO1xyXG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XHJcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZShbdXNlclRhc2tdLFxyXG4gICAgICB0ID0+IHQuc3ViVGFza3MgJiYgdC5zdWJUYXNrcy5maWx0ZXIoc3QgPT4gc3QuaWQgPT09IHN1YlRhc2tJZClcclxuICAgICAgICAuZm9yRWFjaChzdCA9PiBzdC5kb25lID0gZG9uZSkpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2V0V2Vla1BsYW5uZXJCb3hPcGVuKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCBvcGVuQ291cnNlcyA9IHsgLi4udGhpcy5wZXJzaXN0ZWRTdGF0ZS5vcGVuQ291cnNlcyB9O1xyXG4gICAgaWYgKGlzT3BlbilcclxuICAgICAgb3BlbkNvdXJzZXNbY291cnNlTmFtZV0gPSB0cnVlO1xyXG4gICAgZWxzZVxyXG4gICAgICBkZWxldGUgb3BlbkNvdXJzZXNbY291cnNlTmFtZV07XHJcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZVBlcnNpc3RlZFN0YXRlKHtvcGVuQ291cnNlc30pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgY2hhbmdlV2Vlayh3ZWVrRGF0ZTogRGF0ZSwga2VlcEN1cnJlbnREYXRlPzogYm9vbGVhbikge1xyXG4gICAgbGV0IHBlcnNpc3RlZFN0YXRlID0gdGhpcy5wZXJzaXN0ZWRTdGF0ZTtcclxuICAgIGlmICghcGVyc2lzdGVkU3RhdGUpIHtcclxuICAgICAgcGVyc2lzdGVkU3RhdGUgPSBhd2FpdCBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlLmxvYWQodGhpcy5vcHRpb25zLnVzZXIpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbmV3UGVyc2lzdGVkID0gbmV3IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUocGVyc2lzdGVkU3RhdGUpO1xyXG4gICAgbmV3UGVyc2lzdGVkLndlZWtEYXRlID0ga2VlcEN1cnJlbnREYXRlID8gbW9tZW50KHdlZWtEYXRlKS52YWx1ZU9mKCkgOiBtb21lbnQod2Vla0RhdGUpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XHJcbiAgICBuZXdQZXJzaXN0ZWQuc2F2ZSgpO1xyXG4gICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IG5ld1BlcnNpc3RlZDtcclxuICAgIGF3YWl0IHRoaXMubWVtLnJlZnJlc2hGcm9tU2VydmVyKCk7XHJcbiAgfVxyXG5cclxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcjogKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkU3RhdGU6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUsIHdlZWtUZXh0c1VUOiBVc2VyVGFzaykgPT4gdm9pZCkge1xyXG4gICAgY29uc3QgcHJveHlTdWJzY3JpYmVyID0gKHVzZXJUYXNrczogVXNlclRhc2tbXSkgPT4ge1xyXG4gICAgICBzdWJzY3JpYmVyKFxyXG4gICAgICAgIHVzZXJUYXNrcy5maWx0ZXIodXQgPT4gIXV0LndlZWtUZXh0cyksXHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSxcclxuICAgICAgICB1c2VyVGFza3MuZmlsdGVyKHV0ID0+ICEhdXQud2Vla1RleHRzKVswXSB8fCB7XHJcbiAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgICAgZGF0ZVRpbWU6IHRoaXMucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUsXHJcbiAgICAgICAgICB3ZWVrVGV4dHM6IHthc3Nlc3NtZW50OicnLCBzdHJhdGVneTonJ30sXHJcbiAgICAgICAgICBhY2w6IFtcclxuICAgICAgICAgICAgLy8gRGVmYXVsdCBBQ0w6IExldCB1c2VyIHNlbGYgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGl0ZW06XHJcbiAgICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIHRoaXMuZ2V0Q3VycmVudFVzZXIoKS5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgQUNMOiBMZXQgZW1wbG95ZWVzIG9uIHNhbWUgc2Nob29sIGhhdmUgcmVhZCBhY2Nlc3MgdG8gaXQuXHJcbiAgICAgICAgICAgIC8vIFRoaXMgY3VycmVudGx5IG9ubHkgYXBwbGllcyB0byB0YXNrcyB0aGF0IHJlZmVyIHRvIGNvdXJzZSB0YXNrcyAobm90IG93biB0YXNrcyEpXHJcbiAgICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7dGhpcy5nZXRDdXJyZW50VXNlcigpLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICAgIF0ubWFwKGFjID0+IGFjLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcHJveHlTdWJzY3JpYmVyW1wic3Vic2NyaWJlclwiXSA9IHN1YnNjcmliZXI7XHJcbiAgICB0aGlzLm1lbS5zdWJzY3JpYmUocHJveHlTdWJzY3JpYmVyKTtcclxuICB9XHJcblxyXG4gIHVuc3Vic2NyaWJlKHN1YnNjcmliZXI6ICh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZFN0YXRlOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlLCB3ZWVrVGV4dHNVVDogVXNlclRhc2spID0+IHZvaWQpIHtcclxuICAgIHRoaXMubWVtLnN1YnNjcmliZXJzID0gdGhpcy5tZW0uc3Vic2NyaWJlcnMuZmlsdGVyIChzID0+IHNbXCJzdWJzY3JpYmVyXCJdICE9PSBzdWJzY3JpYmVyKTtcclxuICB9XHJcbiAgXHJcbn1cclxuXHJcbmlmICghdXNlclRhc2tzUmVwbykge1xyXG4gIHVzZXJUYXNrc1JlcG8gPSBlbnYudXNlclRhc2tzUmVwbyA9IG5ldyBVc2VyVGFza3NSZXBvKFxyXG4gICAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxyXG4gICAgKCk9PmVudi5jdXJyZW50VXNlcik7XHJcbiAgdXNlclRhc2tzUmVwby5tZW0uZW5zdXJlSGFzRGF0YSgpO1xyXG59XHJcbiIsImltcG9ydCB7VXNlcn0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHVzZXJzIDogVXNlcltdID0gW3tcclxuICAgIGRpc3BsYXlOYW1lOiBcIkFkbWluaXN0cmF0w7ZyXCIsXHJcbiAgICBtYWlsOiBcInZlbWVuZG9Aa2Vkc2Nob29scy5jb21cIixcclxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnXSxcclxuICAgIHNjaG9vbDogJ0tFRCcsXHJcbiAgICB1c2VybmFtZTogXCJhZG1pblwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiRGF2aWRcIixcclxuICAgIG1haWw6IFwiZGF2aWQuZmFobGFuZGVyQHZlbWVuZG8uc2VcIixcclxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnXSxcclxuICAgIHNjaG9vbDogJ0tFRCcsXHJcbiAgICB1c2VybmFtZTogXCJkYXZpZFwiXHJcbn0sXHJcbntcclxuICAgIGRpc3BsYXlOYW1lOiBcIkFuZHJlaVwiLFxyXG4gICAgbWFpbDogXCJhbmRyZWkuc3BhdGFyZWx1QHZlbWVuZG8uc2VcIixcclxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnLCdTVFVERU5UJ10sXHJcbiAgICBzY2hvb2w6ICdLRUQnLFxyXG4gICAgdXNlcm5hbWU6IFwiYW5kcmVpXCJcclxufSx7XHJcbiAgICBkaXNwbGF5TmFtZTogXCJDYXJsIEhvbG1iZXJnXCIsXHJcbiAgICBtYWlsOiBcImNhcmwuaG9sbWJlcmdAa3Vuc2thcHNneW1uYXNpZXQuc2VcIixcclxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnXSxcclxuICAgIHNjaG9vbDogJ05vcnJrw7ZwaW5nJyxcclxuICAgIHVzZXJuYW1lOiBcImNhcmwuaG9sbWJlcmdAa3Vuc2thcHNneW1uYXNpZXQuc2VcIlxyXG59LHsgXHJcbiAgICBkaXNwbGF5TmFtZTogXCJDYXJsXCIsXHJcbiAgICBtYWlsOiBcImNhcmxAa2Vkc2Nob29scy5jb21cIixcclxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnLCdTVFVERU5UJ10sXHJcbiAgICBzY2hvb2w6ICdLRUQnLFxyXG4gICAgdXNlcm5hbWU6IFwiY2FybFwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiZGF2aWQuZmFobGFuZGVyQGtlZHNjaG9vbHMuY29tXCIsXHJcbiAgICBtYWlsOiBcImRhdmlkLmZhaGxhbmRlckBrZWRzY2hvb2xzLmNvbVwiLFxyXG4gICAgcm9sZXM6IFtcIkFETUlOXCIsIFwiRU1QTE9ZRUVcIiwgXCJTVFVERU5UXCJdLFxyXG4gICAgc2Nob29sOiBcIktFRFwiLFxyXG4gICAgdXNlcm5hbWU6IFwiZGF2aWQuZmFobGFuZGVyQGtlZHNjaG9vbHMuY29tXCJcclxufSx7XHJcbiAgICBkaXNwbGF5TmFtZTogXCJUZWFjaGVyIDFcIixcclxuICAgIG1haWw6IFwidGVhY2hlcjEuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tXCIsXHJcbiAgICByb2xlczogWydFTVBMT1lFRSddLFxyXG4gICAgc2Nob29sOiAnS0VEJyxcclxuICAgIHVzZXJuYW1lOiBcInRlYWNoZXIxLmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbVwiXHJcbn0seyBcclxuICAgIGRpc3BsYXlOYW1lOiBcIlRlc3QtTGl2ZS1FbGV2MVwiLFxyXG4gICAgbWFpbDogXCJ1Ync2NzU3QGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxyXG4gICAgcm9sZXM6IFsnU1RVREVOVCddLFxyXG4gICAgc2Nob29sOiAnVXBwc2FsYScsXHJcbiAgICB1c2VybmFtZTogXCJ1Ync2NzU3QGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXYyXCIsXHJcbiAgICBtYWlsOiBcInVtczQzMDJAZWR1Lmt1bnNrYXBzZ3ltbmFzaWV0LnNlXCIsXHJcbiAgICByb2xlczogWydTVFVERU5UJ10sXHJcbiAgICBzY2hvb2w6ICdVcHBzYWxhJyxcclxuICAgIHVzZXJuYW1lOiBcInVtczQzMDJAZWR1Lmt1bnNrYXBzZ3ltbmFzaWV0LnNlXCJcclxufSx7XHJcbiAgICBkaXNwbGF5TmFtZTogXCJUZXN0LUxpdmUtRWxldjNcIixcclxuICAgIG1haWw6IFwidWhoMzQ2MEBlZHUua3Vuc2thcHNneW1uYXNpZXQuc2VcIixcclxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcclxuICAgIHNjaG9vbDogJ1VwcHNhbGEnLFxyXG4gICAgdXNlcm5hbWU6IFwidWhoMzQ2MEBlZHUua3Vuc2thcHNneW1uYXNpZXQuc2VcIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIlRlc3QtTGl2ZS1FbGV2NChmZWwgZ29hbHMgaXNzdWUpXCIsXHJcbiAgICBtYWlsOiBcInVtdDY4MjZAZWR1Lmt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcclxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXHJcbiAgICB1c2VybmFtZTogXCJ1bXQ2ODI2QGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXY1KGZ1dHVyZSBhYmlsaXRpZXMpXCIsXHJcbiAgICBtYWlsOiBcInVqZzM4MzNAZWR1Lmt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcclxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXHJcbiAgICB1c2VybmFtZTogXCJ1amczODMzQGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXY2KGZ1dHVyZSBhYmlsaXRpZXMpXCIsXHJcbiAgICBtYWlsOiBcInVqdDEzNjNAZWR1Lmt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcclxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXHJcbiAgICB1c2VybmFtZTogXCJ1anQxMzYzQGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUzDpHJhcmUxXCIsXHJcbiAgICBtYWlsOiBcInJpY2thcmQuYWxiZXJ0c3NvbkBrdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxyXG4gICAgcm9sZXM6IFsnRU1QTE9ZRUUnXSxcclxuICAgIHNjaG9vbDogJ1VwcHNhbGEnLFxyXG4gICAgdXNlcm5hbWU6IFwicmlja2FyZC5hbGJlcnRzc29uQGt1bnNrYXBzZ3ltbmFzaWV0LnNlXCJcclxufSx7XHJcbiAgICBkaXNwbGF5TmFtZTogXCJFRFNUZXN0VXNlckd5bW5hc2l1bVwiLFxyXG4gICAgbWFpbDogXCJ1aGgzMjAwQGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxyXG4gICAgLy9tYWlsOiBcIlVISDMyMDBARURVLktVTlNLQVBTR1lNTkFTSUVULlNFXCIsXHJcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcclxuICAgIHVzZXJuYW1lOiBcIkVEU1Rlc3RVc2VyMVwiLFxyXG4gICAgc2Nob29sOiBcIktFRFwiLFxyXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcInZlbWVuZG8uZWxldkBrZWRzY2hvb2xzLmNvbVwiLFxyXG4gICAgbWFpbDogXCJ2ZW1lbmRvLmVsZXZAa2Vkc2Nob29scy5jb21cIixcclxuICAgIHJvbGVzOiBbXCJTVFVERU5UXCJdLFxyXG4gICAgdXNlcm5hbWU6IFwidmVtZW5kby5lbGV2QGtlZHNjaG9vbHMuY29tXCIsXHJcbiAgICBzY2hvb2w6IFwiS0VEXCIsXHJcbiAgICBzY2hvb2xUeXBlOiBcIkd5bW5hc2l1bVwiXHJcbn0se1xyXG4gICAgZGlzcGxheU5hbWU6IFwiTWVkYXJiZXRhcmUgTmFja2FcIixcclxuICAgIG1haWw6IFwibWVkYXJiZXRhcmUubmFja2FAa3Vuc2thcHNza29sYW4uc2VcIixcclxuICAgIHJvbGVzOiBbXCJFTVBMT1lFRVwiXSxcclxuICAgIHVzZXJuYW1lOiBcIm1lZGFyYmV0YXJlLm5hY2thL0tTXCIsXHJcbiAgICBzY2hvb2w6IFwiTmFja2FcIixcclxuICAgIHNjaG9vbFR5cGU6IFwiR3J1bmRza29sb3JcIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIk1lZGFyYmV0YXJlIEdsb2JlblwiLFxyXG4gICAgbWFpbDogXCJtZWRhcmJldGFyZS5nbG9iZW5Aa3Vuc2thcHNneW1uYXNpZXQuc2VcIixcclxuICAgIHJvbGVzOiBbXCJFTVBMT1lFRVwiXSxcclxuICAgIHVzZXJuYW1lOiBcIm1lZGFyYmV0YXJlLmdsb2Jlbi9LU1wiLFxyXG4gICAgc2Nob29sOiBcIkdsb2JlblwiLFxyXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIkVsZXYgR2xvYmVuXCIsXHJcbiAgICBtYWlsOiBcImVsZXYuZ2xvYmVuQGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxyXG4gICAgc2Nob29sR3JhZGU6IDIsXHJcbiAgICByb2xlczogWydTVFVERU5UJ10sXHJcbiAgICB1c2VybmFtZTogXCJlbGV2Lmdsb2JlblwiLFxyXG4gICAgc2Nob29sOiBcIkdsb2JlblwiLFxyXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIkVsZXYgQm9yw6VzXCIsXHJcbiAgICBtYWlsOiBcImVsZXYuYm9yYXNAZWR1Lmt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICBzY2hvb2xHcmFkZTogNyxcclxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcclxuICAgIHVzZXJuYW1lOiBcImVsZXYuYm9yYXNcIixcclxuICAgIHNjaG9vbDogXCJCb3LDpXNcIixcclxuICAgIHNjaG9vbFR5cGU6IFwiR3J1bmRza29sb3JcIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIkVsZXYgQm9ybMOkbmdlXCIsXHJcbiAgICBtYWlsOiBcImVsZXYuYm9ybGFuZ2VAZWR1Lmt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICBzY2hvb2xHcmFkZTogOSxcclxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcclxuICAgIHVzZXJuYW1lOiAnZWxldi5ib3JsYW5nZS9LUycsXHJcbiAgICBzY2hvb2w6ICdCb3Jsw6RuZ2UnLFxyXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxyXG59LHtcclxuICAgIGRpc3BsYXlOYW1lOiBcIlJvbGwtbMO2c1wiLFxyXG4gICAgbWFpbDogXCJub25lQGt1bnNrYXBzc2tvbGFuLnNlXCIsXHJcbiAgICB1c2VybmFtZTogXCJub25lXCIsXHJcbiAgICByb2xlczogW11cclxufV07XHJcblxyXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IHVzZXJzIH0gZnJvbSAnLi9kYXRhL3VzZXJzJztcclxuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJy4uL3V0aWxzL3F1ZXJ5LXN0cmluZyc7XHJcblxyXG5jb25zdCB1c2VybmFtZSA9IHBhcnNlUXVlcnlTdHJpbmcgKGxvY2F0aW9uLnNlYXJjaCkudXNlcjtcclxuaWYgKHVzZXJuYW1lKSB7XHJcbiAgY29uc3QgdXNlciA9IHVzZXJzLmZpbmQodSA9PiB1LnVzZXJuYW1lID09PSB1c2VybmFtZSk7XHJcbiAgaWYgKHVzZXIpIHtcclxuICAgIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCB7IHJvbGUsIHNjaG9vbCB9ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xyXG5pZiAoZW52LmN1cnJlbnRVc2VyKSB7XHJcbiAgaWYgKHJvbGUpIHtcclxuICAgIGVudi5jdXJyZW50VXNlci5yb2xlcyA9IHJvbGUuc3BsaXQoJywnKTtcclxuICB9XHJcbiAgaWYgKHNjaG9vbCkge1xyXG4gICAgZW52LmN1cnJlbnRVc2VyLnNjaG9vbCA9IHNjaG9vbDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5cclxuY2ZnLktFRF9MT0NBTEUgPSAnc3YnO1xyXG5jZmcuS0VEX1NDSE9PTF9MT0NBTEUgPSAnc3YnO1xyXG4iLCIvLyA8SW5pdGlhbGl6YXRpb24+XHJcbmltcG9ydCAnLi9zZXQtY3VycmVudC11c2VyJzsgLy8gRW11bGF0ZSBzZXJ2ZXItc2lkZSBzY3JpcHQgdG8gc2V0IGN1cnJlbnQgdXNlclxyXG5pbXBvcnQgJy4uL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwnOyAvLyBDbGllbnQtc2lkZSBpbml0aWFsaXphdGlvblxyXG5pbXBvcnQgJy4vdGVzdC1jb25maWcnO1xyXG4vLyA8L0luaXRpYWxpemF0aW9uPlxyXG5cclxuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IENob29zZVVzZXIgfSBmcm9tICcuL3V0aWxzL2Nob29zZS11c2VyJztcclxuaW1wb3J0IHsgQ291cnNlVmlld2VyIH0gZnJvbSAnLi4vY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyJztcclxuaW1wb3J0IHsgaW5jbHVkZUNTUyB9IGZyb20gJy4vdXRpbHMvaW5jbHVkZS1jc3MnO1xyXG5pbXBvcnQgeyBpbmNsdWRlT3B0aW9uYWxDU1MgfSBmcm9tICcuLi91dGlscy9pbmNsdWRlLW9wdGlvbmFsLWNzcyc7XHJcbmltcG9ydCB7IHNldHVwSW50bCB9IGZyb20gJy4uL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsJztcclxuaW1wb3J0IHsgaW5qZWN0SW50bCwgSW5qZWN0ZWRJbnRsUHJvcHMgfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuXHJcbmluY2x1ZGVPcHRpb25hbENTUyh7XHJcbiAgdjE6IFtcclxuICAgICdjc3MvY291cnNldmlld2VyLmNzcycsXHJcbiAgICAnY3NzL2RpYWxvZy5jc3MnLFxyXG4gICAgJ2Nzcy9ncmlkLWNzcy1wYXRjaC5jc3MnXHJcbiAgXSxcclxuICBpbmNsdWRlQ1NTLFxyXG4gIHZlcnNpb246IDYsXHJcbiAgdmVyc2lvbkZvbGRlcjogJ2Nzcy9kZWx0YS1jc3MvY291cnNldmlld2VyJ1xyXG59KTtcclxuXHJcbiBjbGFzcyBfQXBwIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PEluamVjdGVkSW50bFByb3BzPiB7XHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5wcm9wcztcclxuICAgIHJldHVybiBlbnYuY3VycmVudFVzZXIgP1xyXG4gICAgPExhbmd1YWdlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17e2ludGx9fT5cclxuICAgICAgPENvdXJzZVZpZXdlciBjb3Vyc2VCdWlsZGVyVXJsPVwiY291cnNlYnVpbGRlci5odG1sXCIgLz5cclxuICAgIDwvTGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyPiA6XHJcbiAgICAgIDxDaG9vc2VVc2VyIC8+XHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCBBcHAgPSBzZXR1cEludGwoaW5qZWN0SW50bChfQXBwKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEFwcDtcclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VycyB9IGZyb20gJy4uL2RhdGEvdXNlcnMnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIENob29zZVVzZXIoKSB7XHJcbiAgbGV0IHNlbGVjdDtcclxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXRcIj5cclxuICAgIDxoMj5Ww6RsaiBhbnbDpG5kYXJlPC9oMj5cclxuICAgIDx0YWJsZSBjbGFzc05hbWU9XCJsb2dpbi10YWJsZVwiPjx0aGVhZD48dHI+XHJcbiAgICAgIDx0aD5OYW1uPC90aD5cclxuICAgICAgPHRoPlJvbGxlcjwvdGg+XHJcbiAgICAgIDx0aD5FLXBvc3Q8L3RoPlxyXG4gICAgICA8dGg+U2tvbGE8L3RoPlxyXG4gICAgPC90cj48L3RoZWFkPlxyXG4gICAgICA8dGJvZHk+XHJcbiAgICAgICAge3VzZXJzLm1hcCgoeyB1c2VybmFtZSwgZGlzcGxheU5hbWUsIG1haWwsIHNjaG9vbCwgcm9sZXMgfSkgPT5cclxuICAgICAgICAgIDx0ciBrZXk9e21haWx9IG9uQ2xpY2s9eygpID0+IGxvY2F0aW9uLnNlYXJjaCA9IGA/dXNlcj0ke3VzZXJuYW1lfWB9PlxyXG4gICAgICAgICAgICA8dGQ+e2Rpc3BsYXlOYW1lfTwvdGQ+XHJcbiAgICAgICAgICAgIDx0ZCBzdHlsZT17cm9sZXMubGVuZ3RoID09PSAwID8geyBmb250U3R5bGU6ICdpdGFsaWMnIH0gOiB7fX0+e3JvbGVzLmxlbmd0aCA9PT0gMCA/IFwic2FrbmFyIHJvbGxlclwiIDogcm9sZXMuam9pbignLCAnKX08L3RkPlxyXG4gICAgICAgICAgICA8dGQ+e21haWx9PC90ZD5cclxuICAgICAgICAgICAgPHRkIHN0eWxlPXtzY2hvb2wgPyB7fSA6IHsgZm9udFN0eWxlOiAnaXRhbGljJyB9fT57c2Nob29sIHx8IFwic2FrbmFyIHNrb2xhXCJ9PC90ZD5cclxuICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC90Ym9keT48L3RhYmxlPlxyXG4gIDwvZGl2PlxyXG59O1xyXG4iLCJmdW5jdGlvbiByZXNvbHZlKHVyaTogc3RyaW5nKSB7XHJcbiAgdmFyIGhyZWYgPSBsb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIGxvY2F0aW9uLmhvc3QgKyBsb2NhdGlvbi5wYXRobmFtZTtcclxuICB2YXIgcExhc3RTbGFzaCA9IGhyZWYubGFzdEluZGV4T2YoJy8nKTtcclxuICByZXR1cm4gaHJlZi5zdWJzdHIoMCwgcExhc3RTbGFzaCArIDEpICsgdXJpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5jbHVkZUNTUyhjc3NGaWxlOiBzdHJpbmcpIHtcclxuICBkb2N1bWVudC53cml0ZSgnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCInK3Jlc29sdmUoY3NzRmlsZSkrJ1wiIC8+Jyk7ICBcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7TH0gZnJvbSAnLi91dGlscyc7XHJcbmltcG9ydCB7ZGJ9IGZyb20gJy4uL2dsb2JhbHMvZGInO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcclxuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0nO1xyXG5cclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgZXJyb3JzOiBFcnJvclN0cnVjdFtdO1xyXG4gIGluZm9zOiBzdHJpbmdbXTtcclxuICAvL2RiV3JpdGVyUmV0cnlhYmxlRXJyb3I/OiBFcnJvcjtcclxuICBkYldyaXRlcklzU2F2aW5nPzogYm9vbGVhbjtcclxuICBkYldyaXRlcklzRWRpdGVkPzogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEVycm9yU3RydWN0IHtcclxuICBtZXNzYWdlOiBzdHJpbmc7XHJcbiAgcmV0cnlhYmxlPzogYm9vbGVhbjtcclxuICBkZXRhaWxzPzogRXJyb3I7XHJcbiAgc2hvd0RldGFpbHM/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRXJyb3JTdWNjZXNzRmVlZGJhY2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlPXtcclxuICAgICAgZXJyb3JzOiBbXSxcclxuICAgICAgaW5mb3M6IFtdXHJcbiAgICB9O1xyXG4gICAgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uID0gdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9lcnJvciA9IHRoaXMuX2Vycm9yLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9jdXN0b21FcnJvciA9IHRoaXMuX2N1c3RvbUVycm9yLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9vbkluZm8gPSB0aGlzLl9vbkluZm8uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2RiV3JpdGVyRXJyb3IgPSB0aGlzLl9kYldyaXRlckVycm9yLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZCA9IHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9hZGRFcnJvcihtZXNzYWdlOiBzdHJpbmcsIGRldGFpbHM/OiBFcnJvciwgcmV0cnlhYmxlPzogYm9vbGVhbikge1xyXG4gICAgLy9jb25zb2xlLmVycm9yKG1lc3NhZ2UsIHtyZXRyeWFibGU6ICEhcmV0cnlhYmxlLCBkZXRhaWxzfSk7XHJcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4ge1xyXG4gICAgICBpZiAoZXJyb3JzLnNvbWUoZSA9PiBlLm1lc3NhZ2UgPT09IG1lc3NhZ2UpKSByZXR1cm4ge2Vycm9yc307XHJcbiAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMikgZXJyb3JzID0gZXJyb3JzLnNsaWNlKDEpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVycm9yczogZXJyb3JzLmNvbmNhdChbe21lc3NhZ2UsIGRldGFpbHMsIHJldHJ5YWJsZX1dKVxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICAvLyBSZW1vdmUgbm9uLXJldHJ5YWJsZSBlcnJvcnMgYWZ0ZXIgMzAgc2Vjb25kczpcclxuICAgIGlmICghcmV0cnlhYmxlKSBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiAoe1xyXG4gICAgICAgIGVycm9yczogZXJyb3JzLmZpbHRlcihlID0+IGUubWVzc2FnZSAhPT0gbWVzc2FnZSlcclxuICAgICAgfSkpO1xyXG4gICAgfSwgMzAwMDApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfYWRkSW5mbyhtZXNzYWdlOiBzdHJpbmcpIHtcclxuICAgIGlmIChtZXNzYWdlID09PSBcIlwiKSB7XHJcbiAgICAgIC8vIFR1cm4gb2ZmIGN1cnJlbnQgaW5mbyBtZXNzYWdlc1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtpbmZvczogW119KTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRTdGF0ZSgoe2luZm9zfSkgPT4ge1xyXG4gICAgICBpZiAoaW5mb3Muc29tZShpbmZvID0+IGluZm8gPT09IG1lc3NhZ2UpKSByZXR1cm4ge2luZm9zfTtcclxuICAgICAgaWYgKGluZm9zLmxlbmd0aCA+IDEpIGluZm9zID0gaW5mb3Muc2xpY2UoMSk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5mb3M6IFttZXNzYWdlXSAvLyB3YXM6IGluZm9zLmNvbmNhdChtZXNzYWdlKS4gQnV0IGl0IHN1Y2tzIVxyXG4gICAgICB9O1xyXG4gICAgfSk7XHJcbiAgICAvLyBSZW1vdmUgaW5mbyBtZXNzYWdlIGFmdGVyIDEwIHNlY29uZHM6XHJcbiAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtpbmZvc30pID0+ICh7XHJcbiAgICAgICAgaW5mb3M6IGluZm9zLmZpbHRlcihtc2cgPT4gbXNnICE9PSBtZXNzYWdlKVxyXG4gICAgICB9KSk7XHJcbiAgICB9LCAxMDAwMCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9kYldyaXRlckVycm9yIChlcnJvcjogRXJyb3IsIHJldHJ5YWJsZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy5fYWRkRXJyb3IoYERldCBnw6VyIGludGUgYXR0IHNwYXJhIHRpbGwgc2VydmVybmAsIGVycm9yLCByZXRyeWFibGUpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfZGJXcml0ZXJTdGF0ZUNoYW5nZWQgKHtpc0VkaXRlZCwgaXNTYXZpbmd9OiBLZWRCYWNrZW5kV3JpdGVyKSB7XHJcbiAgICBpZiAoIWlzRWRpdGVkKSB7XHJcbiAgICAgIC8vIElmIGlzRWRpdGVkIGlzIGZhbHNlLCBhIHN1Y2Nlc3NmdWwgd3JpdGUgbXVzdCBoYXZlIGhhcHBlbmVkLCBhbmRcclxuICAgICAgLy8gdGhlcmUgY2Fubm90IGJlIGFueSByZXRyeWFibGUgZXJyb3IgYW55bW9yZVxyXG4gICAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4ge1xyXG4gICAgICAgIGVycm9ycyA9IGVycm9ycy5maWx0ZXIoZSA9PiAhZS5yZXRyeWFibGUpO1xyXG4gICAgICAgIHJldHVybiB7ZXJyb3JzfTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgZGJXcml0ZXJJc0VkaXRlZDogaXNFZGl0ZWQsXHJcbiAgICAgIGRiV3JpdGVySXNTYXZpbmc6IGlzU2F2aW5nXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY3VzdG9tZXJyb3InLCB0aGlzLl9jdXN0b21FcnJvcik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaW5mbycsIHRoaXMuX29uSW5mbyk7XHJcbiAgICBkYi53cml0ZXIub25FcnJvcih0aGlzLl9kYldyaXRlckVycm9yKTtcclxuICAgIGRiLndyaXRlci5vblN0YXRlQ2hhbmdlKHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbik7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignY3VzdG9tZXJyb3InLCB0aGlzLl9jdXN0b21FcnJvcik7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5mbycsIHRoaXMuX29uSW5mbyk7XHJcbiAgICBkYi53cml0ZXIub2ZmKHRoaXMuX2RiV3JpdGVyRXJyb3IpO1xyXG4gICAgZGIud3JpdGVyLm9mZih0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZCk7XHJcbiAgfVxyXG5cclxuICBfdW5oYW5kbGVkUmVqZWN0aW9uIChldjogRXZlbnQgJiB7cmVhc29uOiBFcnJvcn0pIHtcclxuICAgIHRoaXMuX2FkZEVycm9yKGBFdHQgb2vDpG50IGZlbCBpbnRyw6RmZmFkZS4uLmAsIGV2LnJlYXNvbik7XHJcbiAgfVxyXG5cclxuICBfZXJyb3IgKGV2OiBFdmVudCAmIHtlcnJvcjogRXJyb3J9KSB7XHJcbiAgICB0aGlzLl9hZGRFcnJvcihldi5lcnJvciA/IGV2LmVycm9yLm1lc3NhZ2UgOiBgRXR0IG9rw6RudCBmZWwgaW50csOkZmZhZGUuLi5gLCBldi5lcnJvcik7XHJcbiAgfVxyXG5cclxuICBfY3VzdG9tRXJyb3IgKGV2OiBDdXN0b21FdmVudCkge1xyXG4gICAgdGhpcy5fYWRkRXJyb3IoZXYuZGV0YWlsKTtcclxuICB9XHJcblxyXG4gIF9vbkluZm8oZXY6IEN1c3RvbUV2ZW50KSB7XHJcbiAgICB0aGlzLl9hZGRJbmZvKGV2LmRldGFpbCk7XHJcbiAgfSBcclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2Vycm9ycywgaW5mb3MsIGRiV3JpdGVySXNTYXZpbmd9ID0gdGhpcy5zdGF0ZTtcclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImVycm9yLXN1Y2Nlc3MtZmVlZGJhY2tcIiBzdHlsZT17e1xyXG4gICAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxyXG4gICAgICBsZWZ0OiAwLFxyXG4gICAgICB0b3A6IDAsXHJcbiAgICAgIHdpZHRoOiBcIjEwMCVcIixcclxuICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnXHJcbiAgICB9fT5cclxuICAgICAgPGRpdiBzdHlsZT17e2Rpc3BsYXk6ICd0YWJsZScsIG1hcmdpbjogXCIwIGF1dG9cIn19PlxyXG4gICAgICAgIHtlcnJvcnMuZmlsdGVyKGUgPT4gIWUucmV0cnlhYmxlIHx8ICFkYldyaXRlcklzU2F2aW5nKVxyXG4gICAgICAgIC5tYXAoKHttZXNzYWdlLCBkZXRhaWxzLCByZXRyeWFibGUsIHNob3dEZXRhaWxzfSkgPT4gKFxyXG4gICAgICAgICAgPGRpdiBrZXk9e21lc3NhZ2V9IGNsYXNzTmFtZT1cImVycm9yXCI+XHJcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbG9hdDonbGVmdCd9fT57bWVzc2FnZX08L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBzdHlsZT17e3BvaW50ZXJFdmVudHM6ICdhdXRvJ319PlxyXG4gICAgICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9eygpPT50aGlzLnJlbW92ZUVycm9yKG1lc3NhZ2UpfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAge2RldGFpbHMgfHwgcmV0cnlhYmxlID8gPGRpdiBzdHlsZT17e3BvaW50ZXJFdmVudHM6ICdhdXRvJ319PlxyXG4gICAgICAgICAgICAgIHtkZXRhaWxzID8gPD48YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+dGhpcy50b2dnbGVEZXRhaWxzKG1lc3NhZ2UpfT57c2hvd0RldGFpbHMgPyBcIkTDtmxqIGRldGFpbGVyXCIgOiBcIlZpc2EgZGV0YWlsamVyXCJ9PC9hPiZuYnNwOzwvPiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICB7c2hvd0RldGFpbHMgPyA8cD57JycrZGV0YWlsc308L3A+OiA8PiZuYnNwOzwvPn1cclxuICAgICAgICAgICAgICB7cmV0cnlhYmxlID8gPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCk9PnRoaXMucmV0cnlTYXZlKCl9PkbDtnJzw7ZrIHNwYXJhIG51PC9hPiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgPC9kaXY+OiB1bmRlZmluZWR9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApKX1cclxuICAgICAgICB7aW5mb3MubWFwKG1lc3NhZ2UgPT4gXHJcbiAgICAgICAgICA8cCBrZXk9e21lc3NhZ2V9IGNsYXNzTmFtZT1cImluZm9cIj57bWVzc2FnZX08L3A+XHJcbiAgICAgICAgKX1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG4gIHJlbW92ZUVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IGFueSB7XHJcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtcclxuICAgICAgZXJyb3JzOiBlcnJvcnMuZmlsdGVyKGUgPT4gZS5tZXNzYWdlICE9PSBtZXNzYWdlKVxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcmV0cnlTYXZlKCkge1xyXG4gICAgZGIud3JpdGVyLnJldHJ5U2F2ZSgpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlRGV0YWlscyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiAoe2Vycm9yczogZXJyb3JzLm1hcChlcnJvciA9PiBlcnJvci5tZXNzYWdlID09PSBtZXNzYWdlID9cclxuICAgICAge1xyXG4gICAgICAgIC4uLmVycm9yLFxyXG4gICAgICAgIHNob3dEZXRhaWxzOiAhZXJyb3Iuc2hvd0RldGFpbHNcclxuICAgICAgfSA6XHJcbiAgICAgIGVycm9yKVxyXG4gICAgfSkpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gaW5jbHVkZU9wdGlvbmFsQ1NTICh7XHJcbiAgdjEsXHJcbiAgdmVyc2lvbkZvbGRlcixcclxuICB2ZXJzaW9uLFxyXG4gIGluY2x1ZGVDU1MsXHJcbiAgTk9DU1NcclxufToge3YxPzogc3RyaW5nW10sIHZlcnNpb25Gb2xkZXI/OiBzdHJpbmcsIHZlcnNpb246IG51bWJlciwgaW5jbHVkZUNTUzogKGZpbGU6IHN0cmluZykgPT4gdm9pZCwgTk9DU1M/OiBzdHJpbmd9KSB7XHJcbiAgaWYgKCFOT0NTUykge1xyXG4gICAgaWYgKHYxKSB2MS5mb3JFYWNoKGNzc0ZpbGUgPT4gaW5jbHVkZUNTUyhjc3NGaWxlKSk7XHJcbiAgfVxyXG4gIGxldCBjc3NWZXIgPSBwYXJzZUludChOT0NTUyk7XHJcbiAgaWYgKGlzTmFOKGNzc1ZlcikpIGNzc1ZlciA9IDE7XHJcbiAgZm9yIChsZXQgdmVyID0gY3NzVmVyICsgMTsgdmVyIDw9IHZlcnNpb247ICsrdmVyKSB7XHJcbiAgICBpbmNsdWRlQ1NTKGAke3ZlcnNpb25Gb2xkZXJ9L3Yke3Zlcn0uY3NzYCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTiA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzLlxyXG5cclxudHlwZSBQcm9taXNlUmV0dXJuaW5nTWV0aG9kTmFtZXM8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIEFQSV06IEFQSVtNRVRIT0RdIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBQcm9taXNlPGFueT4gPyBNRVRIT0QgOiBuZXZlclxyXG59XHJcblxyXG50eXBlIENvbnZlcnRNZXRob2RUb1N1c3BlbnNlPEY+ID0gRiBleHRlbmRzICguLi5hcmdzOiBpbmZlciBBKSA9PiBQcm9taXNlPGluZmVyIFI+ID9cclxuICAoLi4uYXJnczogQSkgPT4gUiA6XHJcbiAgRjtcclxuXHJcbmV4cG9ydCB0eXBlIFN1c3BlbnNlQmFzZWRBUEk8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIFByb21pc2VSZXR1cm5pbmdNZXRob2ROYW1lczxBUEk+XTogQ29udmVydE1ldGhvZFRvU3VzcGVuc2U8QVBJW01FVEhPRF0+XHJcbn1cclxuXHJcbnR5cGUgT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZD86IChwcm9wOiBzdHJpbmcpPT5ib29sZWFuLFxyXG4gIGNhY2hlRXhwaXJhdGlvbj86IG51bWJlclxyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0T3B0aW9uczogT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZDogZiA9PiB0eXBlb2YgZiA9PT0gJ2Z1bmN0aW9uJyxcclxuICBjYWNoZUV4cGlyYXRpb246IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTlxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VTdXNwZW5zZUFwaTxBUEk+KGFwaTogQVBJLCBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnMpOiBTdXNwZW5zZUJhc2VkQVBJPEFQST5cclxue1xyXG4gIG9wdGlvbnMgPSB7Li4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnN9O1xyXG4gIGNvbnN0IHtpc0FwaU1ldGhvZCwgY2FjaGVFeHBpcmF0aW9ufSA9IG9wdGlvbnM7XHJcblxyXG4gIGNvbnN0IHJ2OiBTdXNwZW5zZUJhc2VkQVBJPEFQST4gPSBPYmplY3QuY3JlYXRlKGFwaSBhcyBhbnkpIGFzIFN1c3BlbnNlQmFzZWRBUEk8QVBJPjtcclxuICBjb25zdCBjYWNoZToge1trZXk6IHN0cmluZ106IHt0aW1lb3V0OiBudW1iZXIsIHZhbHVlPzogYW55LCBlcnJvcj86IGFueSwgcHJvbWlzZT86IFByb21pc2U8YW55Pn19ID0ge307XHJcblxyXG4gIC8vIFdhbGsgdGhlIGluc3RhbmNlICsgcHJvdG90eXBlIGNoYWluIHRvIGdlbmVyYXRlIHN1c3BlbnNlIHZlcnNpb24gb2YgZWFjaCBwcm9taXNlIHJldHVybmluZyBtZXRob2RcclxuICBmb3IgKGxldCBwcm90byA9IGFwaTsgcHJvdG8gJiYgcHJvdG8gIT09IE9iamVjdC5wcm90b3R5cGU7IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSkge1xyXG4gICAgc3VzcGVuZGlmeShwcm90byk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzdXNwZW5kaWZ5KHByb3RvKSB7XHJcbiAgICBPYmplY3Qua2V5cyhwcm90bykuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgaWYgKCFydi5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiBpc0FwaU1ldGhvZChwcm9wKSkge1xyXG4gICAgICAgIHJ2W3Byb3BdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KFtwcm9wLCAuLi5hcmdzXSk7XHJcbiAgICAgICAgICBjb25zdCBjYWNoZWRFbnRyeSA9IGNhY2hlW2tleV07XHJcbiAgICAgICAgICBpZiAoY2FjaGVkRW50cnkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoY2FjaGVkRW50cnkucHJvbWlzZSkgdGhyb3cgY2FjaGVkRW50cnkucHJvbWlzZTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LmVycm9yKSB0aHJvdyBjYWNoZWRFbnRyeS5lcnJvcjtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LnRpbWVvdXQgPiBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZEVudHJ5LnZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlID0gcHJvdG9bcHJvcF0uYXBwbHkoYXBpLCBhcmdzKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCB2YWx1ZTogcmVzdWx0fTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgZXJyb3J9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBwcm9taXNlfTtcclxuICAgICAgICAgICAgdGhyb3cgcHJvbWlzZTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci50aGVuKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBlcnJvcn07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJ2O1xyXG59XHJcbiIsIlxyXG5leHBvcnQgY2xhc3MgUGVuZGluZ0pvYiB7XHJcbiAgcHJpdmF0ZSB0aW1lb3V0SWQgPSBudWxsO1xyXG4gIHByaXZhdGUgY2FuY2VsbGVkID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBwZW5kaW5nID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBpc0pvYkV4ZWN1dGluZyA9IGZhbHNlO1xyXG4gIHByaXZhdGUgam9iQ2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT47XHJcbiAgXHJcbiAgY29uc3RydWN0b3IoY2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT4pIHtcclxuICAgIHRoaXMuam9iQ2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIHRyaWdnZXJDaGFuZ2UodGhyb3R0bGU6IG51bWJlcik6IGFueSB7XHJcbiAgICBpZiAodGhpcy5jYW5jZWxsZWQpIHJldHVybjtcclxuICAgIHRoaXMucGVuZGluZyA9IHRydWU7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRJZCk7XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCk9PnRoaXMubGF1bmNoSm9iKCksIHRocm90dGxlKTtcclxuICB9XHJcblxyXG4gIHN0b3AoKSB7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRJZCk7XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICB0aGlzLmNhbmNlbGxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGxhdW5jaEpvYigpIHtcclxuICAgIGlmICh0aGlzLmNhbmNlbGxlZCkgcmV0dXJuO1xyXG4gICAgaWYgKCF0aGlzLnBlbmRpbmcpIHJldHVybjtcclxuICAgIGlmICh0aGlzLmlzSm9iRXhlY3V0aW5nKSByZXR1cm47XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gdHJ1ZTtcclxuICAgICAgdGhpcy5wZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgIGF3YWl0IHRoaXMuam9iQ2FsbGJhY2soKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHRoaXMuaXNKb2JFeGVjdXRpbmcgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnBlbmRpbmcpXHJcbiAgICAgIGF3YWl0IHRoaXMubGF1bmNoSm9iKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMge1xyXG4gIHRvTG93ZXI/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9IHtcclxuICBjb25zdCB7dG9Mb3dlcn0gPSAob3B0aW9ucyB8fMKge30pIGFzIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zO1xyXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gIGlmIChsb2NhdGlvblNlYXJjaCAmJiBsb2NhdGlvblNlYXJjaC5sZW5ndGggPiAxKVxyXG4gICAgbG9jYXRpb25TZWFyY2guc3Vic3RyKDEpXHJcbiAgICAgIC5zcGxpdCgnJicpXHJcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnNwbGl0KCc9JykubWFwKHMgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMudHJpbSgpKSkpXHJcbiAgICAgIC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHJlc3VsdFt0b0xvd2VyID8ga2V5LnRvTG93ZXJDYXNlKCkgOiBrZXldID0gdmFsdWUpO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuY29kZVBhcmFtcyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5maWx0ZXIoa2V5ID0+IHBhcmFtc1trZXldICE9PSB1bmRlZmluZWQpLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trZXldKX1gKS5qb2luKCcmJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xyXG4gIHJldHVybiBcIj9cIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VIYXNoUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucykge1xyXG4gIHJldHVybiBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uSGFzaCwgb3B0aW9ucyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUhhc2hRdWVyeVN0cmluZyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gXCIjXCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0VXJsQW5kUXVlcnkgKHVybFdpdGhQb3NzaWJsZVF1ZXJ5OiBzdHJpbmcpIHtcclxuICBjb25zdCBwUXVlcnkgPSB1cmxXaXRoUG9zc2libGVRdWVyeS5pbmRleE9mKCc/Jyk7XHJcbiAgcmV0dXJuIHBRdWVyeSA+PSAwID9cclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIoMCwgcFF1ZXJ5KSwgdXJsV2l0aFBvc3NpYmxlUXVlcnkuc3Vic3RyKHBRdWVyeSldIDpcclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeSwgXCJcIl07XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBUZXJtLCBBY2FkZW1pY1llYXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XHJcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XHJcbiAgdGVybTogVGVybTtcclxuICB3ZWVrPzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XHJcbiAgcmV0dXJuIHRlcm0gPT09ICdBVCcgP1xyXG4gICAgWzMyLCA1MV0gOlxyXG4gICAgWzEsIDI1XTtcclxufVxyXG5cclxuLy9Ob3QgdXNlZCBhbnltb3JlXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBnZXRUZXJtU3RhcnRBbmRFbmQobm93OiBtb21lbnQuTW9tZW50KSA6IG1vbWVudC5Nb21lbnRbXSB7XHJcbi8vICAgICByZXR1cm4gbm93Lm1vbnRoKCkgPj0gNiA/IC8vIDYgPSBKdWx5IGluIEpTIERhdGVzIGFuZCBpbiBtb21lbnQgYXMgd2VsbCFcclxuLy8gICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNywgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMTEsIDMxKSldIDogLy8gYXVnMSAtIGRlYzMxXHJcbi8vICAgICBbbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDAsIDEpKSwgbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDYsIDMxKSldOyAvLyBqYW4xIC0ganVseTMxXHJcbi8vIH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRUZXJtU3RhckVuZERhdGUoZGF0ZTogRGF0ZSwgaXNGaXJzdFRlcm06IGJvb2xlYW4pOiBtb21lbnQuTW9tZW50W10ge1xyXG4gIHZhciBhZGRZZWFyID0gZGF0ZS5nZXRNb250aCgpID49IDc7XHJcbiAgdmFyIHRlcm1ZZWFyID0gbnVsbDtcclxuXHJcbiAgaWYgKGFkZFllYXIpIHtcclxuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiBkYXRlLmdldEZ1bGxZZWFyKCkgKyAxO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0ZXJtWWVhciA9IGlzRmlyc3RUZXJtID8gZGF0ZS5nZXRGdWxsWWVhcigpIC0gMSA6IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuICB9XHJcblxyXG4gIHZhciB0ZXJtWWVhck1vbWVudCA9IG1vbWVudCh0ZXJtWWVhci50b1N0cmluZygpLCBcIllZWVlcIik7XHJcblxyXG4gIGlmICh0ZXJtWWVhck1vbWVudC53ZWVrKCkgIT0gMSkge1xyXG4gICAgdGVybVllYXJNb21lbnQgPSB0ZXJtWWVhck1vbWVudC5jbG9uZSgpLmFkZCgxLCAnd2VlaycpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGlzRmlyc3RUZXJtID8gW21vbWVudCh0ZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDMyKS5zdGFydE9mKCd3ZWVrJyksIG1vbWVudCh0ZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDUxKS5lbmRPZignd2VlaycpXSA6XHJcbiAgICBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLCBtb21lbnQodGVybVllYXJNb21lbnQuY2xvbmUoKSkud2VlaygyNSkuZW5kT2YoJ3dlZWsnKV07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xNb21lbnQobTogbW9tZW50Lk1vbWVudCk6IFNjaG9vbE1vbWVudCB7XHJcbiAgY29uc3QgdGhpc1llYXIgPSBtLnllYXIoKTtcclxuICBjb25zdCBpc0F1dHVtbiA9IG0ubW9udGgoKSA+PSA2OyAvLyBkZXRlcm1pbmUgXHJcbiAgY29uc3QgW2F1dHVtblllYXIsIHNwcmluZ1llYXJdID0gaXNBdXR1bW4gP1xyXG4gICAgW3RoaXNZZWFyLCB0aGlzWWVhciArIDFdIDpcclxuICAgIFt0aGlzWWVhciAtIDEsIHRoaXNZZWFyXTtcclxuICBjb25zdCBhY2FkZW1pY1llYXIgPSAnJyArIGF1dHVtblllYXIgKyAnLycgKyBzcHJpbmdZZWFyO1xyXG4gIGNvbnN0IHRlcm0gPSBpc0F1dHVtbiA/ICdBVCcgOiAnU1QnO1xyXG4gIGNvbnN0IHdlZWsgPSBtLndlZWsoKTtcclxuICByZXR1cm4geyBhY2FkZW1pY1llYXIsIHRlcm0sIHdlZWsgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXIoYVllYXI6IEFjYWRlbWljWWVhciwgbnVtWWVhcnNUb0FkZDogbnVtYmVyKTogQWNhZGVtaWNZZWFyIHtcclxuICByZXR1cm4gYVllYXIuc3BsaXQoJy8nKVxyXG4gICAgLm1hcCh5ZWFyU3RyID0+IHBhcnNlSW50KHllYXJTdHIpICsgbnVtWWVhcnNUb0FkZClcclxuICAgIC5tYXAoeWVhciA9PiAnJyArIHllYXIpXHJcbiAgICAuam9pbignLycpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbmV4dEFjYWRlbWljWWVhcihhWWVhcjogQWNhZGVtaWNZZWFyKTogQWNhZGVtaWNZZWFyIHtcclxuICByZXR1cm4gYWRkWWVhcihhWWVhciwgMSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmV2QWNhZGVtaWNZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIpOiBBY2FkZW1pY1llYXIge1xyXG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAtMSk7XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFNjaG9vbE1vbWVudCwgYWRkWWVhciB9IGZyb20gJy4vc2Nob29sLW1vbWVudCc7XHJcbmltcG9ydCB7IEFjYWRlbWljWWVhciwgVGVybSB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuaW1wb3J0IHtJbmplY3RlZEludGx9IGZyb20gJ3JlYWN0LWludGwnO1xyXG5cclxudHlwZSBNb21lbnQgPSBtb21lbnQuTW9tZW50O1xyXG5cclxuZnVuY3Rpb24gaXNTY2hvb2xNb21lbnQob2JqOiBEYXRlIHwgU2Nob29sTW9tZW50KTogb2JqIGlzIFNjaG9vbE1vbWVudCB7XHJcbiAgcmV0dXJuICdhY2FkZW1pY1llYXInIGluIG9iajtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNjaG9vbFRlcm0ge1xyXG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xyXG4gIHRlcm06IFRlcm07XHJcblxyXG4gIGNvbnN0cnVjdG9yKGRhdGVPclNjaG9vbE1vbWVudDogRGF0ZSB8IFNjaG9vbE1vbWVudCkge1xyXG4gICAgY29uc3Qgc2Nob29sTW9tZW50ID0gaXNTY2hvb2xNb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSA/XHJcbiAgICAgIGRhdGVPclNjaG9vbE1vbWVudCA6IGdldFNjaG9vbE1vbWVudChtb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSk7XHJcbiAgICB0aGlzLmFjYWRlbWljWWVhciA9IHNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXI7XHJcbiAgICB0aGlzLnRlcm0gPSBzY2hvb2xNb21lbnQudGVybTtcclxuICB9XHJcblxyXG4gIGdldCB5ZWFyKCkge1xyXG4gICAgcmV0dXJuIHBhcnNlSW50KHRoaXMuYWNhZGVtaWNZZWFyXHJcbiAgICAgICAgLnNwbGl0KCcvJylbdGhpcy50ZXJtID09PSAnQVQnID8gMCA6IDFdKTtcclxuICB9XHJcblxyXG4gIG5leHRUZXJtKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgIHtcclxuICAgICAgICB0ZXJtOiAnU1QnLFxyXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcclxuICAgICAgfSA6XHJcbiAgICAgIHtcclxuICAgICAgICB0ZXJtOiAnQVQnLFxyXG4gICAgICAgIGFjYWRlbWljWWVhcjogYWRkWWVhcih0aGlzLmFjYWRlbWljWWVhciwgMSlcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcmV2VGVybSgpIHtcclxuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xyXG4gICAgICB7XHJcbiAgICAgICAgdGVybTogJ1NUJyxcclxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIC0xKVxyXG4gICAgICB9IDpcclxuICAgICAge1xyXG4gICAgICAgIHRlcm06ICdBVCcsXHJcbiAgICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLmFjYWRlbWljWWVhclxyXG4gICAgICB9KTtcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgdG9Mb2NhbGVTdHJpbmcoaW50bDogSW5qZWN0ZWRJbnRsLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XHJcbiAgICBsZXQgeWVhciA9IHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMF06XHJcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMV07XHJcblxyXG4gICAgaWYgKHNob3J0WWVhcilcclxuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLnRlcm0gPT09ICdBVCcgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5zZWNvbmRUZXJtJywgZGVmYXVsdE1lc3NhZ2U6J0hUIHt5ZWFyfSd9LCB7eWVhcjogeWVhcn0pIDogXHJcbiAgICBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5maXJzdFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonVlQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0IChzdHIpIHtcclxuICAgIGZvciAobGV0IGk9MCwgbD1zdHIubGVuZ3RoOyBpPGw7ICsraSkge1xyXG4gICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChpKSA8IDB4MjAwMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyLnN1YnN0cigwLCBpKSArIHN0cltpXS50b0xvY2FsZVVwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cihpICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0cjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChvYmosIGV4dGVuc2lvbikge1xyXG4gICAgaWYgKHR5cGVvZiBleHRlbnNpb24gIT09ICdvYmplY3QnKSByZXR1cm4gb2JqO1xyXG4gICAgT2JqZWN0LmtleXMoZXh0ZW5zaW9uKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgb2JqW2tleV0gPSBleHRlbnNpb25ba2V5XTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG9iajtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lPFQsRT4gKG9iaiA6IFQsIGV4dGVuc2lvbj86IEUpIHtcclxuICAgIGxldCBjbG9uZSA9IHt9O1xyXG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsb25lLCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpKTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGV4dGVuc2lvbikgZXh0ZW5kKGNsb25lLCBleHRlbnNpb24pO1xyXG4gICAgcmV0dXJuIGNsb25lIGFzIChUICYgRSk7XHJcbn1cclxuXHJcbmNvbnN0IGNvbmNhdCA9IFtdLmNvbmNhdDtcclxuZXhwb3J0IGZ1bmN0aW9uIGZsYXR0ZW48VD4gKGEgOiAoVCB8IFRbXSlbXSkge1xyXG4gICAgcmV0dXJuIGNvbmNhdC5hcHBseShbXSwgYSkgYXMgVFtdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVByb3A8VD4ocHJvcDprZXlvZiBUKSB7XHJcbiAgICByZXR1cm4gKGE6IFQsYjogVCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFQcm9wID0gYVtwcm9wXSwgYlByb3AgPSBiW3Byb3BdO1xyXG4gICAgICAgIHJldHVybiBhUHJvcCA+IGJQcm9wID8gMSA6IGFQcm9wIDwgYlByb3AgPyAtMSA6IDA7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcHMoXHJcbiAgICBwcm9wczogc3RyaW5nIHwgc3RyaW5nW10sXHJcbiAgICBsb2NhbGVzPzogc3RyaW5nIHwgc3RyaW5nW10sXHJcbiAgICBvcHRpb25zPzogSW50bC5Db2xsYXRvck9wdGlvbnMpOiAoYTogYW55LCBiOiBhbnkpID0+IG51bWJlclxyXG57XHJcbiAgICBwcm9wcyA9IEFycmF5LmlzQXJyYXkocHJvcHMpID8gcHJvcHMgOiBbcHJvcHNdO1xyXG5cclxuICAgIGNvbnN0IGxvY2FsZUNvbXBhcmUgPSAoYSxiKSA9PlxyXG4gICAgICAgIHR5cGVvZiBhID09PSAnc3RyaW5nJyA/XHJcbiAgICAgICAgICAgIGEubG9jYWxlQ29tcGFyZShiLCBsb2NhbGVzLCBvcHRpb25zKSA6XHJcbiAgICAgICAgICAgIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNtcFBhcnQgKGEsYixmaXJzdFBhcnQ6IHN0cmluZyxyZXN0OiBzdHJpbmdbXSkge1xyXG4gICAgICAgIGNvbnN0IGZpcnN0QSA9IGFbZmlyc3RQYXJ0XTtcclxuICAgICAgICBjb25zdCBmaXJzdEIgPSBiW2ZpcnN0UGFydF07XHJcbiAgICAgICAgaWYgKGZpcnN0QSA9PT0gZmlyc3RCKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAoZmlyc3RBID09IG51bGwpIHJldHVybiAtMTtcclxuICAgICAgICBpZiAoZmlyc3RCID09IG51bGwpIHJldHVybiAxO1xyXG4gICAgICAgIHJldHVybiByZXN0Lmxlbmd0aCA9PT0gMCA/XHJcbiAgICAgICAgICAgIGxvY2FsZUNvbXBhcmUoZmlyc3RBLCBmaXJzdEIpIDpcclxuICAgICAgICAgICAgY21wUGFydChmaXJzdEEsIGZpcnN0QiwgcmVzdFswXSwgcmVzdC5zbGljZSgxKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHByb3BzXHJcbiAgICAgICAgLm1hcChwcm9wID0+IHByb3Auc3BsaXQoJy4nKSlcclxuICAgICAgICAubWFwKChbZmlyc3RQYXJ0LCAuLi5yZXN0XSkgPT4gKGEsYikgPT4gY21wUGFydChhLGIsIGZpcnN0UGFydCwgcmVzdCkpXHJcbiAgICAgICAgLnJlZHVjZSgoY21wMSwgY21wMikgPT5cclxuICAgICAgICAgICAgKGEsYikgPT4gY21wMShhLGIpIHx8IGNtcDIoYSxiKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBMKHRleHQsIC4uLmFyZ3MpIHtcclxuICAgIGxldCBmaXJzdCA9IHRleHRbMF07XHJcbiAgICByZXR1cm4gYnVpbGRNZXNzYWdlKHRleHQsIGFyZ3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZE1lc3NhZ2UgKHRleHQsIGFyZ3MpIHtcclxuICAgIGxldCBydiA9IHRleHRbMF07XHJcbiAgICBmb3IgKGxldCBpPTEsIGw9dGV4dC5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgcnYgKz0gYXJnc1tpLTFdICsgdGV4dFtpXTtcclxuICAgIH1cclxuICAgIHJldHVybiBydjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRDPFQ+IHtcclxuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlOiBUKSB7XHJcbiAgICAgICAgZXh0ZW5kKHRoaXMsIHRlbXBsYXRlKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVUaW1lUmV2aXZlciAoa2V5LCB2YWx1ZSkge1xyXG4gICAgdmFyIGE7XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGEgPSAvXFwvRGF0ZVxcKChcXGQqKVxcKVxcLy8uZXhlYyh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCthWzFdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbi8vbGV0IGluZm9TZXJpYWwgPSAxO1xyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0luZm8gKG1zZykge1xyXG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdpbmZvJywgeyAnZGV0YWlsJzogbXNnIH0pO1xyXG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yIChlcnJNc2c6IHN0cmluZyB8IEVycm9yKSB7XHJcbiAgICBjb25zdCBtc2cgPSB0eXBlb2YgZXJyTXNnID09PSAnc3RyaW5nJyA/IGVyck1zZyA6IGVyck1zZy5tZXNzYWdlO1xyXG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjdXN0b21lcnJvcicsIHsgJ2RldGFpbCc6IG1zZyB9KTtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyTXNnKTtcclxuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1heExlbmd0aChzdHI6IHN0cmluZywgbWF4TGVuOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBzdHIubGVuZ3RoID4gbWF4TGVuID9cclxuICAgICAgICBzdHIuc3Vic3RyKDAsIG1heExlbiAtIDMpICsgXCIuLi5cIiA6XHJcbiAgICAgICAgc3RyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb0xvb2t1cDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICBjb25zdCByZXN1bHQgOiB7W2tleTogc3RyaW5nXSA6IFRbXX0gPSB7fTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcclxuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcclxuICAgICAgICBsZXQgYXJyYXkgPSByZXN1bHRba2V5XTtcclxuICAgICAgICBpZiAoYXJyYXkpIGFycmF5LnB1c2goaXRlbSk7XHJcbiAgICAgICAgZWxzZSByZXN1bHRba2V5XSA9IFtpdGVtXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcnJheVRvTWFwPFQ+KGE6IFRbXSwga2V5QWNjZXNzb3I6IChpdGVtOiBUKSA9PiBzdHJpbmcgfCBudW1iZXIpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA6IHtba2V5OiBzdHJpbmddIDogVH0gPSB7fTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcclxuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcclxuICAgICAgICByZXN1bHRba2V5XSA9IGl0ZW07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlcnJ5UGlja1Byb3BzPFQ+IChvYmo6IFQsIHByb3BzVG9QaWNrOiBzdHJpbmdbXSk6IFBhcnRpYWw8VD4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0ge307XHJcbiAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHByb3BzVG9QaWNrKSB7XHJcbiAgICAgIGlmIChwYXJhbSBpbiBvYmopIHJlc3VsdFtwYXJhbV0gPSBvYmpbcGFyYW1dO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdCBhcyBQYXJ0aWFsPFQ+O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlzdGluY3Q8VD4gKGE6IFRbXSwga2V5QWNjZXNzb3I/OiAoaXRlbTogVCkgPT4gYW55KSB7XHJcbiAgICBjb25zdCBtYXAgPSBhcnJheVRvTWFwKGEsIGtleUFjY2Vzc29yIHx8ICh4ID0+IHgpKTtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyhtYXApLm1hcChrZXkgPT4gbWFwW2tleV0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hhbGxvd0VxdWFscyhhOiBhbnksIGI6IGFueSkge1xyXG4gICAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKCFhIHx8ICFiKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAodHlwZW9mIGEgIT09ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3Qga2V5c0EgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIGNvbnN0IGtleXNCID0gT2JqZWN0LmtleXMoYik7XHJcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1rZXlzQS5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5c0FbaV07XHJcbiAgICAgICAgaWYgKGtleXNCW2ldICE9PSBrZXkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAoYVtrZXldICE9PSBiW2tleV0pIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbiIsImltcG9ydCBtb21lbnQsIHsgTW9tZW50IH0gZnJvbSBcIm1vbWVudFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEtFRFdlZWsgKHllYXI6IG51bWJlciwgd2VlazogbnVtYmVyKSB7XHJcbiAgY29uc3QgbSA9IG1vbWVudChuZXcgRGF0ZSh5ZWFyLCAxLCAxKSkud2Vlayh3ZWVrKTtcclxuICBjb25zdCByZXMgPSB7XHJcbiAgICB5ZWFyLFxyXG4gICAgd2VlayxcclxuICAgIG5vdEJlZm9yZTogbS5jbG9uZSgpLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoLTIsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgbm90QWZ0ZXI6IG0uY2xvbmUoKS5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpXHJcbiAgfTtcclxuICByZXR1cm4gcmVzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV4dFdlZWtEYXRlKGRhdGU6IE1vbWVudCk6IHsgYWRqdXN0ZWQ6IGJvb2xlYW4sIG5leHREYXRlOiBEYXRlIH17XHJcbiAgdmFyIG5leHREYXRlID0gbW9tZW50KGRhdGUpLmFkZCgxLCAnd2VlaycpO1xyXG4gIC8vU2V0IHRoZSAwMS4wMSBvZiB0aGUgbmV4dCB5ZWFyIGluIGNhc2UgdGhlIG5leHQgd2VlayBpcyBpbiB0aGUgc2FtZSB5ZWFyIFxyXG4gIC8vYW5kIHRoZSBwcmV2aW91cyB3ZWVrIGlzIHRoZSBsYXN0IHdlZWsgb2YgdGhlIHllYXJcclxuICBpZihkYXRlLndlZWsoKSA9PT0gZGF0ZS53ZWVrc0luWWVhcigpICYmIG5leHREYXRlLnllYXIoKSA9PT0gZGF0ZS55ZWFyKCkpe1xyXG4gICAgcmV0dXJuIHthZGp1c3RlZDogdHJ1ZSwgbmV4dERhdGU6IG1vbWVudChgJHtkYXRlLnllYXIoKSArIDF9LTAxLTAxYCkudG9EYXRlKCl9O1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHthZGp1c3RlZDogZmFsc2UsIG5leHREYXRlOiBuZXh0RGF0ZS50b0RhdGUoKX07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmV2V2Vla0RhdGUoZGF0ZTogTW9tZW50KTogeyBhZGp1c3RlZDogYm9vbGVhbiwgbmV4dERhdGU6IERhdGUgfXtcclxuICB2YXIgcHJldkRhdGUgPSBtb21lbnQoZGF0ZSkuYWRkKC0xLCAnd2VlaycpO1xyXG4gIC8vU2V0IHRoZSAwMS4wMSBvZiB0aGUgY3VycmVudCB5ZWFyIGluIGNhc2UgdGhlIHByZXYgd2VlayBpcyBpbiB0aGUgcHJldmlvdXMgeWVhclxyXG4gIGlmKGRhdGUud2VlaygpID09PSAyICYmIHByZXZEYXRlLnllYXIoKSAhPT0gZGF0ZS55ZWFyKCkpe1xyXG4gICAgcmV0dXJuIHthZGp1c3RlZDogdHJ1ZSwgbmV4dERhdGU6IG1vbWVudChgJHtkYXRlLnllYXIoKX0tMDEtMDFgKS50b0RhdGUoKX07XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge2FkanVzdGVkOiBmYWxzZSwgbmV4dERhdGU6IHByZXZEYXRlLnRvRGF0ZSgpfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEFkanVzdGVkV2VlayhtOiBNb21lbnQpIHtcclxuICBjb25zdCBjbG9uZSA9IG0uY2xvbmUoKTtcclxuICByZXR1cm4gbS53ZWVrZGF5KCkgPj0gNSA/IC8vIEzDtnJkYWcgMDA6MDAgLyBTw7ZuZGFnIDAwOjAwP1xyXG4gICAgICBtLndlZWsoKSArIDEgOiAvLyBUaWxsaMO2ciBuw6RzdGEgdmVja2FcclxuICAgICAgbS53ZWVrKCk7XHJcbn1cclxuXHJcbi8qZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtMaW1pdHMgKG06IE1vbWVudCkge1xyXG4gIGNvbnN0IGNsb25lZFN3ZWRpc2ggPSBtLmNsb25lKCkubG9jYWxlKCdzdicpO1xyXG4gIGNvbnN0IGxpbWl0cyA9IHtcclxuICAgIG5vdEJlZm9yZTogY2xvbmVkU3dlZGlzaC5zdGFydE9mKCd3ZWVrJykuYWRkKC0yLCAnZGF5cycpLFxyXG4gICAgbm90QWZ0ZXI6IGNsb25lZFN3ZWRpc2guc3RhcnRPZignd2VlaycpLmFkZCg1LCAnZGF5cycpXHJcbiAgfTtcclxufVxyXG4qL1xyXG4iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCJtb2R1bGUuZXhwb3J0cyA9IGpRdWVyeTsiLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3RET007Il0sInNvdXJjZVJvb3QiOiIifQ==