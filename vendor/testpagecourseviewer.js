var testpagecourseviewer =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"testpagecourseviewer": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/test/testpage-courseviewer.tsx","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "../kedbackend/KED.Backend.API/schema.json":
/*!*************************************************!*\
  !*** ../kedbackend/KED.Backend.API/schema.json ***!
  \*************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "../kedbackend/client.js":
/*!*******************************!*\
  !*** ../kedbackend/client.js ***!
  \*******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "../kedbackend/clientweb.js":
/*!**********************************!*\
  !*** ../kedbackend/clientweb.js ***!
  \**********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "../kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!****************************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \****************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \************************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \****************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "../kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \*********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \*****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \************************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "../kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "../kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \**************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \*****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, { debug: 1 }, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \************************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!***************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \***************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \****************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
function mergeDeltas(delta1, delta2) {
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_2 = metaInstructions; _a < metaInstructions_2.length; _a++) {
                    var mi = metaInstructions_2[_a];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \**********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "../kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \**************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "../kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return options && options.includeDeltaEdges ?
            hef.addFlags("includeDeltaEdges") :
            hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return options && options.includeDeltaEdges ?
            het.addFlags("includeDeltaEdges") :
            het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (id, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                deltaDoc: changes
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedId) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedId ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedId; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedId ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedId; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \********************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");






var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
    }
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!****************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \****************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!**********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \**********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "../kedbackend/js/dist/js/observable/index.js");






var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] }
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \*******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \**************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \**********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \************************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/collection.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/collection.js ***!
  \*********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/emitter.js":
/*!******************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/emitter.js ***!
  \******************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/index.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/index.js ***!
  \****************************************************/
/*! exports provided: Observable, Value, Collection, Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });





//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/map.js":
/*!**************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/map.js ***!
  \**************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/mixin.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/mixin.js ***!
  \****************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/observable.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/observable.js ***!
  \*********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/value.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/value.js ***!
  \****************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");




var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "../kedbackend/repo.js":
/*!*****************************!*\
  !*** ../kedbackend/repo.js ***!
  \*****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) { // check for number or string
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return id;
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = ["user", "role", "school", "debug", "testVersion", "testversion", "schoolType", "schooltype"];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");





var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        this.getActiveCourses = avoidSimultanousCalls(this.getActiveCourses);
        this.getLatestAssessments = avoidSimultanousCalls(this.getLatestAssessments);
        this.getStudentGoals = avoidSimultanousCalls(this.getStudentGoals);
        this.getStudentFutureAbilities = avoidSimultanousCalls(this.getStudentFutureAbilities);
        this.getTeacherTutorStudents = avoidSimultanousCalls(this.getTeacherTutorStudents);
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/components/calendar/course-name-to-css-class.ts":
/*!*************************************************************!*\
  !*** ./src/components/calendar/course-name-to-css-class.ts ***!
  \*************************************************************/
/*! exports provided: courseNameToCssClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "courseNameToCssClass", function() { return courseNameToCssClass; });
function courseNameToCssClass(cssPrefix, courseName) {
    return "" + cssPrefix + courseName.substr(0, 3).toLowerCase();
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/is-employee.ts":
/*!***************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/is-employee.ts ***!
  \***************************************************************/
/*! exports provided: isEmployee */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isEmployee", function() { return isEmployee; });
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");


function isEmployee(atSchool) {
    return atSchool ?
        Object(_access_control__WEBPACK_IMPORTED_MODULE_1__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser, atSchool) || _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.includes("ADMIN") :
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
}


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse, hasMigratedTexts */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasMigratedTexts", function() { return hasMigratedTexts; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: Date.now() },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}
function hasMigratedTexts(task) {
    return task.migratedTexts && Object.keys(task.migratedTexts).some(function (type) {
        return Object.keys(task.migratedTexts[type]).length > 0;
    });
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-banner.tsx":
/*!********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-banner.tsx ***!
  \********************************************************************/
/*! exports provided: CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var CourseBanner = function (props) {
    var title = props.title, backgroundImage = props.backgroundImage, tabs = props.tabs, activeTab = props.activeTab;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pageHeader" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("ul", null, tabs.map(function (_a, idx) {
                                    var name = _a.name, key = _a.key, link = _a.link;
                                    var isActive = activeTab === link;
                                    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("li", { key: key || (typeof name === 'string' ? name : idx), className: isActive ? "activePage" : "" },
                                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: link }, name));
                                })))))))));
};


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-module-page.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-module-page.tsx ***!
  \*************************************************************************/
/*! exports provided: CourseModulePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModulePage", function() { return CourseModulePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/get-included-ids */ "./src/components/course-viewer/utils/get-included-ids.ts");
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../subcomponents/learning-goals-list */ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx");
/* harmony import */ var _subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../subcomponents/task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");










var CourseModulePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModulePage, _super);
    function CourseModulePage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    CourseModulePage.prototype.render = function () {
        var _a = this.props, module = _a.module, course = _a.course;
        var incluedIds = Object(_utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__["default"])(module, course);
        var learningTasks = module.taskIds
            .map(function (id) { return course.tasks.find(function (t) { return t.id === id; }); })
            .filter(function (task) { return !!task; })
            .map(function (task) { return ({
            id: task.id,
            task: Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task),
            course: course,
            name: task.name,
            url: "#" + encodeURIComponent(module.name.trim()) + "/" + task.id,
            courseName: course.name,
            learningGoal: task.learningGoal || module.name,
        }); });
        var assignmentTasks = learningTasks.filter(function (t) { return t.task && t.task.assignment; });
        var nonAssignmentTasks = learningTasks.filter(function (t) { return !t.task || !t.task.assignment; });
        var commonTasks = nonAssignmentTasks.filter(function (t) { return !t.task.learningGoal; });
        var learningGoals = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(nonAssignmentTasks.filter(function (t) { return !!t.task.learningGoal; }), function (t) { return t.learningGoal; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, module.name))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: module.mandatoryContent } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Modulens kunskapskrav, f\u00F6rm\u00E5gor och centrala inneh\u00E5ll"),
                    (!!module.startWeek || !!module.endWeek) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "week-period-div" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Startvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.startWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Slutvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.endWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__["KnowledgeRequirementsTable"], { title: "I den h\u00E4r modulen bed\u00F6ms f\u00F6ljande kunskapskrav", requirements: course.knowledgeRequirements, includedIds: incluedIds }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__["AbilitiesBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande f\u00F6rm\u00E5gor", abilities: course.abilities.filter(function (a) { return incluedIds[a.id]; }) }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__["CentralContentBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande centrala inneh\u00E5ll", centralContent: course.centralContent.filter(function (c) { return incluedIds[c.id]; }) }))),
            module.taskIds.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    assignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__["TaskList"], { learningTasks: assignmentTasks })),
                    nonAssignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__["LearningGoalsList"], { commonTasks: commonTasks, learningGoals: Object.keys(learningGoals).map(function (learningGoal) { return ({
                                name: learningGoal,
                                learningTasks: learningGoals[learningGoal]
                            }); }) })))),
            module.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, module.resources.map(function (r, idx) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                    })))));
    };
    return CourseModulePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/get-customized-task.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/get-customized-task.ts ***!
  \*************************************************************************/
/*! exports provided: getCustomizedTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCustomizedTask", function() { return getCustomizedTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function getCustomizedTask(module, task) {
    return module.taskCustomizations ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, module.taskCustomizations[task.id]) :
        task;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/index.tsx":
/*!************************************************************!*\
  !*** ./src/components/course-viewer/course-page/index.tsx ***!
  \************************************************************/
/*! exports provided: CoursePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CoursePage", function() { return CoursePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _course_module_page__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./course-module-page */ "./src/components/course-viewer/course-page/course-module-page.tsx");
/* harmony import */ var _run_up_page__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./run-up-page */ "./src/components/course-viewer/course-page/run-up-page.tsx");
/* harmony import */ var _utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/manual-scroll-restoration */ "./src/components/course-viewer/utils/manual-scroll-restoration.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../weekplanner */ "./src/components/weekplanner/index.ts");
/* harmony import */ var _task_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./task-page */ "./src/components/course-viewer/course-page/task-page.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");











Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["initManualScrollRestoration"])();
var CoursePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CoursePage, _super);
    function CoursePage(props) {
        var _this = _super.call(this, props) || this;
        _this.onHashChange = _this.onHashChange.bind(_this);
        var _a = _this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        _this.state = {
            module: module,
            task: task
        };
        return _this;
    }
    CoursePage.prototype.getModuleAndTaskFromHash = function () {
        var split = (location.hash.substr(1) || "").split('/');
        if (split.length > 0 && !split[0])
            split = split.slice(1); // Allow leading slash #/module/task
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](split.map(function (part) { return decodeURIComponent(part); }), 2), moduleName = _a[0], taskId = _a[1];
        var module = this.props.course.modules
            .filter(function (m) { return (m.name || "")
            .trim().toLowerCase() === (moduleName || "").trim().toLowerCase(); })[0] || null;
        var task = taskId ?
            this.props.course.tasks.find(function (t) { return t.id === taskId; }) || null :
            null;
        if (task && !module) {
            // Resolve module by finding the module that holds the task:
            module = this.getOrderedModules()
                .filter(function (m) { return m.taskIds
                .some(function (taskId) { return task.id === taskId; }); })[0];
        }
        if (task && module) {
            task = Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task);
        }
        return { module: module, task: task };
    };
    CoursePage.prototype.componentDidMount = function () {
        window.addEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.componentWillUnmount = function () {
        window.removeEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.onHashChange = function () {
        var _a = this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        this.setState({
            module: module,
            task: task
        }, function () {
            var fallbackScrollPosition = undefined;
            if (task) {
                var taskAnchor = document.getElementById('ked-task-anchor');
                if (taskAnchor)
                    fallbackScrollPosition = (window.pageYOffset + taskAnchor.getBoundingClientRect().top);
                else
                    fallbackScrollPosition = 0;
            }
            Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["restoreScrollPosition"])({ fallbackScrollPosition: fallbackScrollPosition });
        });
    };
    CoursePage.prototype.getOrderedModules = function () {
        var course = this.props.course;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        return moduleOrder
            // Map ordered id to module
            .map(function (id) { return course.modules.find(function (m) { return m.id === id; }); })
            // Ignore entries that only exists in moduleOrder but not in modules
            .filter(function (m) { return !!m; })
            // Append modules at end that are not listed in moduleOrder
            .concat(course.modules.filter(function (m) { return !moduleOrder.find(function (id) { return m.id === id; }); }));
    };
    CoursePage.prototype.render = function () {
        var _a = this.props, course = _a.course, courseBuilderUrl = _a.courseBuilderUrl;
        var _b = this.state, module = _b.module, task = _b.task;
        var orderedModules = this.getOrderedModules();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: course.name + " - " + course.points + "p", backgroundImage: (course.images.find(function (img) { return img.id === course.imageId; }) || { url: '' }).url, tabs: [{ name: "Upptakt", link: "#", key: "Upptakt" }]
                    .concat(orderedModules.map(function (_a) {
                    var name = _a.name;
                    return ({ name: name, link: "#" + encodeURIComponent(name), key: name });
                }))
                    .concat(course.workFlowLink ? [{
                        name: "Arbetsgång",
                        key: "workflow",
                        link: course.workFlowLink
                    }] : [])
                    .concat(Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"].currentUser, course) ? [{
                        name: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-pencil", "aria-hidden": "true" }),
                            " Redigera denna kurs"),
                        key: "edit",
                        link: Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(courseBuilderUrl, {}) + "#/courses/" + course.id + "/edit"
                    }] : []), activeTab: module ? "#" + encodeURIComponent(module.name) : "#" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" }, task ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_page__WEBPACK_IMPORTED_MODULE_8__["TaskPage"], { task: task, course: course }) :
                                    module ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module_page__WEBPACK_IMPORTED_MODULE_3__["CourseModulePage"], { course: course, module: module }) :
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_run_up_page__WEBPACK_IMPORTED_MODULE_4__["RunUpPage"], { course: course })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout sv-skip-spacer" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_weekplanner__WEBPACK_IMPORTED_MODULE_7__["WeekPlanner"], { viewCourseUrl: '', env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"] }))))))))));
    };
    return CoursePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/run-up-page.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/run-up-page.tsx ***!
  \******************************************************************/
/*! exports provided: RunUpPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RunUpPage", function() { return RunUpPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/resource-list */ "./src/components/course-viewer/subcomponents/resource-list.tsx");


// Views




var RunUpPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RunUpPage, _super);
    function RunUpPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    RunUpPage.prototype.render = function () {
        var course = this.props.course;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                course.runUpText && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, "Upptakt"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "normal", dangerouslySetInnerHTML: { __html: course.runUpText } })),
                course.responsibleTeachers && course.responsibleTeachers.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "L\u00E4rare"),
                    course.responsibleTeachers.map(function (teacher, i) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: i },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: interpretTeacherUrl(teacher.url) }, teacher.name));
                    })),
                course.workFlowLink && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", href: course.workFlowLink }, "Arbetsg\u00E5ng"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "\u00C4mnets f\u00F6rm\u00E5gor", subTitle: "F\u00F6rm\u00E5gor", abilities: course.abilities, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Kursens centrala inneh\u00E5ll", subTitle: "Centralt inneh\u00E5ll", centralContent: course.centralContent, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsTable"], { title: "Kursens kunskapskrav", requirements: course.knowledgeRequirements, className: "larger" })),
            course.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__["ResourceList"], { resources: course.resources }))));
    };
    return RunUpPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function interpretTeacherUrl(url) {
    if (url.indexOf(':') === -1 && url.indexOf('@') >= 0)
        return "mailto:" + url;
    return url;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/task-assignments.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-assignments.tsx ***!
  \***********************************************************************/
/*! exports provided: TaskAssignments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskAssignments", function() { return TaskAssignments; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! downloadjs */ "./node_modules/downloadjs/download.js");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _urkund_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./urkund-utils */ "./src/components/course-viewer/course-page/urkund-utils.ts");
/* harmony import */ var _course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../course-builder-ks/logic/is-employee */ "./src/components/course-builder-ks/logic/is-employee.ts");











var MAX_URKUND_FILE_SIZE_MB = 50;
var MAX_NONURKUND_FILE_SIZE_MB = 100;
var ALLOWED_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc",
    ".cad",
    ".wav",
    ".mp3",
    ".mpeg4",
    ".mp4",
    ".zip",
    ".png",
    ".jpg",
    ".jpeg",
    ".gif"
];
var URKUND_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc"
];
var TaskAssignments = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskAssignments, _super);
    function TaskAssignments(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            assignments: [],
            loading: true
        };
        return _this;
    }
    TaskAssignments.prototype.setStatePromised = function (cb) {
        var _this = this;
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, cb, resolve); });
    };
    TaskAssignments.prototype.componentDidMount = function () {
        this.load();
    };
    TaskAssignments.prototype.componentWillReceiveProps = function (nextProps) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 4, , 5]);
                        if (!(nextProps.taskId !== this.props.taskId ||
                            nextProps.courseId !== this.props.courseId)) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.setStatePromised(function () { return ({
                                assignments: [],
                                loading: true
                            }); })];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [3 /*break*/, 5];
                    case 4:
                        err_1 = _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err_1);
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.update = function (assignments, assignment) {
        var retval = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([
            assignment
        ], assignments.filter(function (_a) {
            var user = _a.user, filename = _a.filename;
            return user !== assignment.user ||
                filename !== assignment.filename;
        }));
        return retval;
    };
    TaskAssignments.prototype.refreshAssignment = function (assignment) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, user, filename, req, _b, _c, resJson_1, e_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        user = assignment.user, filename = assignment.filename;
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: true }))
                                });
                            })];
                    case 1:
                        _d.sent();
                        _d.label = 2;
                    case 2:
                        _d.trys.push([2, 8, , 10]);
                        return [4 /*yield*/, client.get("assignments/urkund/" + school + "/" + courseId + "/" + taskId + "/" + user + "/" + filename)];
                    case 3:
                        req = _d.sent();
                        if (!(req.status >= 400)) return [3 /*break*/, 5];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, req.status];
                        return [4 /*yield*/, req.text()];
                    case 4: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 5: return [4 /*yield*/, req.text()];
                    case 6:
                        resJson_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment.metadata, { urkundResponse: resJson_1 }) }))
                                });
                            })];
                    case 7:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 8:
                        e_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, refreshError: e_1 }))
                                });
                            })];
                    case 9:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 10: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_2, _a, client, _b, courseId, taskId, school, teacherAtSchool, res, _c, _d, assignments, refreshableAssigments, refreshableAssigments_1, refreshableAssigments_1_1, a, e_2_1, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        _e.trys.push([0, 13, , 14]);
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _b = this.props, courseId = _b.courseId, taskId = _b.taskId, school = _b.school;
                        teacherAtSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
                        return [4 /*yield*/, (teacherAtSchool ?
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId) :
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail))];
                    case 1:
                        res = _e.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _c = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _d = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_c.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _d.concat([_e.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        assignments = _e.sent();
                        this.setState({
                            error: null,
                            loading: false,
                            assignments: assignments
                        });
                        if (!teacherAtSchool) return [3 /*break*/, 12];
                        refreshableAssigments = assignments.filter(function (a) {
                            return a.metadata && // Must have metadata.urkundExternalId Otherwise not possible to refresh
                                !a.metadata.urkundUploadError && ( // Not possible to refresh if upload has failed
                            !a.metadata.urkundLastPoll || // Never checked status yet
                                (['Accepted', 'Submitted'].indexOf(JSON.parse(a.metadata.urkundResponse)[0].Status.State) >= 0 &&
                                    parseInt(a.metadata.urkundLastPoll) < moment__WEBPACK_IMPORTED_MODULE_5___default()().add(-15, "seconds").toDate().getTime()));
                        }
                        // Checked status for a long time ago
                        );
                        _e.label = 5;
                    case 5:
                        _e.trys.push([5, 10, 11, 12]);
                        refreshableAssigments_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](refreshableAssigments), refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        _e.label = 6;
                    case 6:
                        if (!!refreshableAssigments_1_1.done) return [3 /*break*/, 9];
                        a = refreshableAssigments_1_1.value;
                        return [4 /*yield*/, this.refreshAssignment(a)];
                    case 7:
                        _e.sent();
                        _e.label = 8;
                    case 8:
                        refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        return [3 /*break*/, 6];
                    case 9: return [3 /*break*/, 12];
                    case 10:
                        e_2_1 = _e.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 12];
                    case 11:
                        try {
                            if (refreshableAssigments_1_1 && !refreshableAssigments_1_1.done && (_a = refreshableAssigments_1.return)) _a.call(refreshableAssigments_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                        return [7 /*endfinally*/];
                    case 12: return [3 /*break*/, 14];
                    case 13:
                        error_1 = _e.sent();
                        this.setState({
                            loading: false,
                            error: "Kunde inte ladda inl\u00E4mningsuppgifter",
                            assignments: []
                        });
                        console.error(error_1);
                        return [3 /*break*/, 14];
                    case 14: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.onDrag = function (ev) {
        ev.stopPropagation();
        ev.preventDefault();
        ev.dataTransfer.dropEffect = 'copy';
    };
    TaskAssignments.prototype.verifyAndUpload = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 3, , 4]);
                        if (!file)
                            return [2 /*return*/];
                        if (this.state.assignments.some(function (a) {
                            return a.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                a.filename === file.name;
                        })) {
                            if (!confirm("Ers\u00E4tta befintlig fil (" + file.name + ")?")) {
                                return [2 /*return*/];
                            }
                        }
                        if (this.props.school.toLowerCase() !== _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school.toLowerCase()) {
                            if (!confirm("Uppgiften tillh\u00F6r en annan skola (" + this.props.school + ").\n" +
                                "Vill du \u00E4nd\u00E5 l\u00E4mna in ditt arbete h\u00E4r?")) {
                                return [2 /*return*/];
                            }
                        }
                        this.setState({ uploadingFile: file });
                        return [4 /*yield*/, this.upload(file)];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        this.setState({
                            uploadingFile: null
                        });
                        return [3 /*break*/, 4];
                    case 3:
                        error_2 = _a.sent();
                        this.setState({
                            error: "Kunde inte ladda upp filen. " + (error_2.message || error_2),
                            uploadingFile: null
                        });
                        console.error(error_2);
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.upload = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, mail, isUrkundExtension, lowerFilename, body, res, _b, _c;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        mail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail;
                        isUrkundExtension = URKUND_EXTENSIONS
                            .indexOf("." + file.name.split('.').reverse()[0].toLowerCase()) >= 0;
                        if (isUrkundExtension) {
                            if (file.size > MAX_URKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filer av denna typ f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_URKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        else {
                            if (file.size > MAX_NONURKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filen f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_NONURKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        lowerFilename = file.name.toLowerCase();
                        if (!ALLOWED_EXTENSIONS.some(function (ext) { return lowerFilename.endsWith(ext); })) {
                            throw new Error("Filens \u00E4ndelse m\u00E5ste vara " + ALLOWED_EXTENSIONS.join(' / '));
                        }
                        body = new FormData();
                        body.append('files', file);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch("assignments/" + school + "/" + courseId + "/" + taskId + "/" + mail, 'put', {}, {
                                userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName
                            }, {
                                body: body
                            })];
                    case 1:
                        res = _d.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.download = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, blob, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(file.mediaLink, 'get', {})];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.blob()];
                    case 4:
                        blob = _c.sent();
                        downloadjs__WEBPACK_IMPORTED_MODULE_8___default()(blob, file.filename, file.contentType);
                        return [3 /*break*/, 6];
                    case 5:
                        err_2 = _c.sent();
                        this.setState({ error: "Kunde inte ladda ned filen. " + (err_2.message || err_2) });
                        console.error(err_2);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.delete = function (url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, err_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 6, , 7]);
                        return [4 /*yield*/, this.setStatePromised(function (_a) {
                                var assignments = _a.assignments;
                                return ({ assignments: assignments.map(function (a) { return a.mediaLink === url ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a, { metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.metadata, { $meta: 'delete' }) }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a); }) });
                            })];
                    case 1:
                        _c.sent();
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(url, 'delete', {})];
                    case 2:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 4];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 3: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 4: return [4 /*yield*/, this.load()];
                    case 5:
                        _c.sent();
                        return [3 /*break*/, 7];
                    case 6:
                        err_3 = _c.sent();
                        this.setState({ error: "Kunde inte ta bort filen. " + (err_3.message || err_3) });
                        console.error(err_3);
                        return [3 /*break*/, 7];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
        var _b = this.state, loading = _b.loading, assignments = _b.assignments, error = _b.error, uploadingFile = _b.uploadingFile;
        var teacherAtThisSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
        var files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](assignments);
        if (uploadingFile) {
            var virtualFile_1 = {
                school: school,
                courseId: courseId,
                taskId: taskId,
                filename: uploadingFile.name,
                size: uploadingFile.size,
                user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail,
                contentType: uploadingFile.type,
                uploadDate: Date.now(),
                mediaLink: "assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail + "/" + uploadingFile.name,
                metadata: { $meta: 'add', userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName }
            };
            files = files.filter(function (file) { return file.mediaLink !== virtualFile_1.mediaLink; });
            files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](files, [virtualFile_1]);
        }
        files = files.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProps"])([
            "metadata.userDisplayName",
            "filename",
            "uploadDate"
        ], ["sv", "en"], { sensitivity: 'base' }));
        var hasOwnDocs = files.some(function (file) { return file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail; });
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { onDragOver: function (ev) { return _this.onDrag(ev); }, onDrop: function (ev) {
                ev.stopPropagation();
                ev.preventDefault();
                _this.verifyAndUpload(ev.dataTransfer.files[0]);
            } },
            error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "error" }, error)) : undefined,
            loading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                " Laddar inl\u00E4mnade filer...") : files.length === 0 ?
                teacherAtThisSchool ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Ingen elev har l\u00E4mnat in n\u00E5got arbete \u00E4nnu.") :
                    undefined
                : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "task-assignments-table" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                teacherAtThisSchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Elev") : undefined,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Filnamn"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inl\u00E4mnat den"),
                                teacherAtThisSchool && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Rapport"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Niv\u00E5")),
                                hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, files.map(function (file) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: file.mediaLink, style: file.metadata.$meta ? { opacity: 0.5 } : {} },
                            teacherAtThisSchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "mailto:" + file.user }, file.metadata.userDisplayName || file.user)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                            ev.preventDefault();
                                            ev.stopPropagation();
                                            _this.download(file);
                                        } }, file.filename)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm')),
                                file.metadata.$meta === 'add' ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                        " Laddar upp...") :
                                    file.metadata.$meta === 'delete' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Tar bort...") :
                                        (function () {
                                            var metadata = file.metadata;
                                            var urkundResponses = metadata.urkundResponse && JSON.parse(metadata.urkundResponse);
                                            var urkundResponse = urkundResponses && urkundResponses[0];
                                            if (!urkundResponse && file.metadata.urkundUploadError) {
                                                urkundResponse = {
                                                    Status: {
                                                        ErrorCode: -1,
                                                        Message: file.metadata.urkundUploadError,
                                                        State: 'Error'
                                                    },
                                                    ExternalId: file.metadata.urkundExternalId
                                                };
                                            }
                                            if (file.isRefreshing)
                                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                                    " Uppdaterar...");
                                            return urkundResponse ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: urkundResponse.Report && urkundResponse.Report.ReportUrl, onClick: function (ev) {
                                                            if (['Accepted', 'Submitted'].indexOf(urkundResponse.Status.State) === -1)
                                                                return; // Follow HREF instead.
                                                            ev.preventDefault();
                                                            ev.stopPropagation();
                                                            _this.refreshAssignment(file);
                                                        }, target: "_blank", title: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundHoverText"])(urkundResponse) },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundStatusClass"])(urkundResponse) }))),
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundSignificanceClass"])(urkundResponse) }, urkundResponse.Report && typeof urkundResponse.Report.Significance === 'number' ?
                                                        urkundResponse.Report.Significance.toFixed() + "%" : ' '))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 });
                                        })()) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                            ev.preventDefault();
                                            ev.stopPropagation();
                                            _this.download(file);
                                        } }, file.filename)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, file.metadata.$meta === 'add' ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                        " Laddar upp...") :
                                    file.metadata.$meta === 'delete' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Tar bort...") :
                                        moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm'))),
                            hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, !file.metadata.$meta && file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                        ev.stopPropagation();
                                        ev.preventDefault();
                                        if (confirm("Radera inl\u00E4mnad fil " + file.filename + "?"))
                                            _this.delete(file.mediaLink);
                                    } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))); })))),
            Object(_course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__["isEmployee"])() ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone task-assignment-drop-zone" },
                    "Droppa ditt f\u00E4rdiga arbete h\u00E4r.",
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    "Det g\u00E5r ocks\u00E5 bra att anv\u00E4nda bl\u00E4ddra-knappen nedan."),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "file", onChange: function (ev) { return _this.verifyAndUpload(ev.target.files[0]); } }))));
    };
    return TaskAssignments;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/task-page.tsx":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-page.tsx ***!
  \****************************************************************/
/*! exports provided: TaskPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskPage", function() { return TaskPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _task_assignments__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./task-assignments */ "./src/components/course-viewer/course-page/task-assignments.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");












var TaskPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskPage, _super);
    function TaskPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: undefined,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()().week()
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    TaskPage.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.task.id !== this.props.task.id) {
            var userTask = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === nextProps.task.id; }) || null;
            this.setState({
                userTask: userTask,
                weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
            });
        }
    };
    TaskPage.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var userTask = userTasks.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === _this.props.task.id; }) || null;
        this.setState({
            userTask: userTask,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
        });
    };
    TaskPage.prototype.toggleTask = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var weekDate, userTask, _a, course, task, module, latestTimeStamp, userTask_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        weekDate = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate;
                        userTask = this.state.userTask;
                        _a = this.props, course = _a.course, task = _a.task;
                        module = course.modules.find(function (m) { return m.taskIds.some(function (id) { return id === task.id; }); });
                        if (!module)
                            return [2 /*return*/]; // Oh uh!
                        if (userTask === undefined)
                            return [2 /*return*/]; // Not yet loaded.
                        if (!!userTask) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.map(function (t) { return t.dateTime; })));
                        userTask_1 = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["createUUID"])(),
                            courseName: course.name,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: task.learningGoal || module.name,
                            name: task.name,
                            url: task.url,
                            task: [task],
                            course: [course],
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not own tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (task.deadline) {
                            userTask_1.deadline = task.deadline;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(this.props.course.name, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask_1])
                            ])];
                    case 1:
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete([userTask.id])];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskPage.prototype.render = function () {
        var _this = this;
        var _a = this.props, task = _a.task, course = _a.course;
        var _b = this.state, userTask = _b.userTask, weekPlannerWeek = _b.weekPlannerWeek;
        var abilities = task.abilities.map(function (a) { return course.abilities.find(function (ab) { return ab.id === a.id; }); }).filter(function (a) { return !!a; });
        var centralContent = task.centralContent.map(function (c) { return course.centralContent.find(function (cc) { return cc.id == c.id; }); }).filter(function (c) { return !!c; });
        var requirements = task.knowledgeRequirements.map(function (k) { return course.knowledgeRequirements.find(function (kr) { return kr.id === k.id; }); }).filter(function (k) { return !!k; });
        var isWorking = userTask && (userTask.$meta === 'adding' || userTask.$meta === 'deleting');
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_9___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "loggboken" :
            weekPlannerWeek === currentWeek + 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (n\u00E4sta vecka)"], ["vald vecka (n\u00E4sta vecka)"]))) :
                weekPlannerWeek === currentWeek - 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (f\u00F6rra veckan)"], ["vald vecka (f\u00F6rra veckan)"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (v ", ")"], ["vald vecka (v ", ")"])), weekPlannerWeek);
        var deadlineTooLate = task.deadline && moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).endOf('day') < moment__WEBPACK_IMPORTED_MODULE_9___default()();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, task.name))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                task.content && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: task.content } })),
                task.learningGoal && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgiftens l\u00E4randem\u00E5l"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, task.learningGoal)),
                task.url && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: task.url, className: "btn btn-large" }, "G\u00E5 till uppgiften")),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            task.assignment ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgift"),
                Object(_access_control__WEBPACK_IMPORTED_MODULE_11__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser, course.school) ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "H\u00E4r kan du som l\u00E4rare se elevernas inl\u00E4mnade arbeten.") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Det h\u00E4r \u00E4r en inl\u00E4mningsuppgift. L\u00E4mna in ditt arbete som en pdf, doc eller odt fil genom att dra det till f\u00E4ltet under."),
                    task.deadline ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("b", null,
                            "Den h\u00E4r uppgiften ",
                            deadlineTooLate ? 'skulle varit inlämnad ' : 'skall vara inlämnad ',
                            moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).format('YYYY MM DD'))) : undefined),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_assignments__WEBPACK_IMPORTED_MODULE_10__["TaskAssignments"], { courseId: course.id, taskId: task.id, school: course.school }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)) : undefined,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                abilities.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande f\u00F6rm\u00E5gor", className: "larger", headerOpen: false, abilities: abilities }),
                centralContent.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande centrala inneh\u00E5ll", className: "larger", headerOpen: false, centralContent: centralContent }),
                requirements.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsTable"], { title: "I den h\u00E4r uppgiften bed\u00F6ms f\u00F6ljande kunskapskrav", className: "larger", headerOpen: true, requirements: requirements })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            userTask !== undefined && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (userTask && userTask.$meta !== 'deleting' ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && _this.toggleTask(); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, userTask ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort uppgiften fr\u00E5n ", ""], ["Ta bort uppgiften fr\u00E5n ", ""])), forWeekString) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till uppgiften i ", ""], ["L\u00E4gg till uppgiften i ", ""])), forWeekString)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            task.resources && task.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser kopplade till uppgiften"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, task.resources.map(function (r, idx) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
    };
    return TaskPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-viewer/course-page/urkund-utils.ts":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/urkund-utils.ts ***!
  \******************************************************************/
/*! exports provided: getUrkundStatusClass, getUrkundHoverText, getUrkundSignificanceClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundStatusClass", function() { return getUrkundStatusClass; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundHoverText", function() { return getUrkundHoverText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundSignificanceClass", function() { return getUrkundSignificanceClass; });
function getUrkundStatusClass(res) {
    if (!res || !res.Status) {
        return null;
    }
    else
        switch (res.Status.State) {
            case 'Error':
                return "urkund-status urkund-status-error";
            case 'Submitted':
                return "urkund-status urkund-status-submitted";
            case 'Accepted':
                return "urkund-status urkund-status-accepted";
            case 'Analyzed':
                return "urkund-status urkund-status-analyzed";
        }
}
function getUrkundHoverText(res) {
    if (!res || !res.Status)
        return null;
    switch (res.Status.State) {
        case 'Error':
            return res.ExternalId ?
                "Kunde inte tas emot av urkund. Felkod: " + res.Status.ErrorCode + "\n" +
                    ("External ID: " + res.ExternalId + "\nFelmeddelande: " + res.Status.Message)
                :
                    res.Status.Message;
        case 'Submitted':
            return "Filen \u00E4r uppladdad till Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Accepted':
            return "Filen analyseras fortfarande av Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Analyzed':
            return "Rapport skapad. Klicka f\u00F6r att \u00F6ppna rapporten i nytt f\u00F6nster";
    }
}
function getUrkundSignificanceClass(res) {
    if (!res || !res.Status)
        return '';
    switch (res.Status.State) {
        case 'Error': return 'urkund-significance-error';
        case 'Submitted': return 'urkund-significance-submitted';
        case 'Accepted': return 'urkund-significance-accepted';
    }
    var report = res.Report;
    if (!report) {
        return "";
    }
    if (report.Significance < 1)
        //return `${cdn}/images/urkund/0.gif`;
        return "urkund-significance urkund-significance-0";
    if (report.Significance < 10)
        //return `${cdn}/images/urkund/1.gif`;
        return "urkund-significance urkund-significance-1";
    if (report.Significance < 25)
        return "urkund-significance urkund-significance-2";
    //return `${cdn}/images/urkund/2.gif`;
    if (report.Significance < 40)
        return "urkund-significance urkund-significance-3";
    //return `${cdn}/images/urkund/3.gif`;
    if (report.Significance < 55)
        return "urkund-significance urkund-significance-4";
    //return `${cdn}/images/urkund/4.gif`;
    if (report.Significance < 70)
        return "urkund-significance urkund-significance-5";
    //return `${cdn}/images/urkund/5.gif`;
    if (report.Significance < 85)
        return "urkund-significance urkund-significance-6";
    //return `${cdn}/images/urkund/6.gif`;
    if (report.Significance < 99.9)
        return "urkund-significance urkund-significance-7";
    //return `${cdn}/images/urkund/7.gif`;
    if (report.Significance >= 99.9)
        return "urkund-significance urkund-significance-8";
    //return `${cdn}/images/urkund/8.gif`;
    return "";
}


/***/ }),

/***/ "./src/components/course-viewer/index.tsx":
/*!************************************************!*\
  !*** ./src/components/course-viewer/index.tsx ***!
  \************************************************/
/*! exports provided: CourseViewer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseViewer", function() { return CourseViewer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _course_builder_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _course_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./course-page */ "./src/components/course-viewer/course-page/index.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../list-courses/list-courses-page */ "./src/components/list-courses/list-courses-page.tsx");









var CourseViewer = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseViewer, _super);
    function CourseViewer(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            course: null,
            isLoading: true
        };
        return _this;
    }
    CourseViewer.prototype.componentWillMount = function () {
        var _this = this;
        this.load().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showError"])
            .then(function () { return _this.setState({ isLoading: false }); });
    };
    CourseViewer.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var courseId, course, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        courseId = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_7__["parseQueryString"])(location.search)["courseId"];
                        if (!courseId) return [3 /*break*/, 2];
                        return [4 /*yield*/, Object(_course_builder_utils__WEBPACK_IMPORTED_MODULE_4__["loadCourse"])(courseId)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = null;
                        _b.label = 3;
                    case 3:
                        course = _a;
                        this.setState({ course: course });
                        document.title =
                            course ?
                                course.name + " - " + course.points + "p" :
                                "Kurser";
                        return [2 /*return*/];
                }
            });
        });
    };
    CourseViewer.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-viewer" },
            this.state.isLoading ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__["Spinner"], null) :
                this.state.course ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_page__WEBPACK_IMPORTED_MODULE_6__["CoursePage"], { course: this.state.course, courseBuilderUrl: this.props.courseBuilderUrl }) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__["ListCoursesPage"], null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__["ErrorSuccessFeedback"], null));
    };
    return CourseViewer;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/abilities-box.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/abilities-box.tsx ***!
  \**********************************************************************/
/*! exports provided: AbilitiesBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbilitiesBox", function() { return AbilitiesBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var AbilitiesBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AbilitiesBox, _super);
    function AbilitiesBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    AbilitiesBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, abilities = _a.abilities, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    abilities.map(function (a) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: a.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: a.name } })));
                    }))));
    };
    return AbilitiesBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/central-content-box.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/central-content-box.tsx ***!
  \****************************************************************************/
/*! exports provided: CentralContentBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CentralContentBox", function() { return CentralContentBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var CentralContentBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CentralContentBox, _super);
    function CentralContentBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    CentralContentBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, centralContent = _a.centralContent, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    centralContent.map(function (cc) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: cc.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: cc.name } })));
                    }))));
    };
    return CentralContentBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/confirmation.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/confirmation.tsx ***!
  \*********************************************************************/
/*! exports provided: Confirmation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Confirmation", function() { return Confirmation; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

function Confirmation(props) {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "confirmation-box " + props.className + (props.visible ? " visible" : "") },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null, props.text),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onConfirm(); } }, "OK"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onCancel(); } }, "Avbryt"));
}


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx":
/*!*************************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx ***!
  \*************************************************************************************/
/*! exports provided: KnowledgeRequirementsTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeRequirementsTable", function() { return KnowledgeRequirementsTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");



var KnowledgeRequirementsTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KnowledgeRequirementsTable, _super);
    function KnowledgeRequirementsTable(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    KnowledgeRequirementsTable.prototype.render = function () {
        var _a = this.props, title = _a.title, requirements = _a.requirements, className = _a.className, includedIds = _a.includedIds, headerOpen = _a.headerOpen, explainedRequirements = _a.explainedRequirements;
        var columns = ["E", "C", "A"];
        var rows = [];
        var reqs = requirements.slice();
        var row = null;
        while (true) {
            row = columns.map(function (grade) {
                var pNext = reqs.findIndex(function (r) { return r.gradeStep.toUpperCase() === grade; });
                if (pNext < 0)
                    return null;
                var rv = reqs[pNext];
                reqs.splice(pNext, 1);
                return includedIds ?
                    (includedIds[rv.id] ? rv : undefined) :
                    rv;
            });
            if (row.every(function (r) { return r === null; }))
                break;
            if (!row.every(function (r) { return !r; })) {
                rows.push(row);
            }
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: className, headerOpen: headerOpen },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i }, row.map(function (column, j) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: column ? column.name : "" } });
                    })),
                    explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (column, j) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, className: "explained-requirement" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, (column && explainedRequirements[column.id]) || ""));
                    }))); }))));
    };
    return KnowledgeRequirementsTable;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/learning-goals-list.tsx ***!
  \****************************************************************************/
/*! exports provided: LearningGoalsList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LearningGoalsList", function() { return LearningGoalsList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _task_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");



var LearningGoalsList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LearningGoalsList, _super);
    function LearningGoalsList() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LearningGoalsList.prototype.render = function () {
        var _a = this.props, commonTasks = _a.commonTasks, learningGoals = _a.learningGoals;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            learningGoals.map(function (lg) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, lg.name),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: lg.learningTasks })); }),
            commonTasks.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                learningGoals.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "\u00D6vergripande"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: commonTasks })));
    };
    return LearningGoalsList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/resource-list.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/resource-list.tsx ***!
  \**********************************************************************/
/*! exports provided: ResourceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceList", function() { return ResourceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var ResourceList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ResourceList, _super);
    function ResourceList(props) {
        return _super.call(this, props) || this;
    }
    ResourceList.prototype.render = function () {
        var resources = this.props.resources;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, resources.map(function (resource, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: resource.url }, resource.name)));
            })));
    };
    return ResourceList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/task-list.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/task-list.tsx ***!
  \******************************************************************/
/*! exports provided: TaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskList", function() { return TaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _confirmation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./confirmation */ "./src/components/course-viewer/subcomponents/confirmation.tsx");








var TaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskList, _super);
    function TaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            confirmations: []
        };
        _this.onChange = _this.onChange.bind(_this);
        return _this;
    }
    TaskList.prototype.onChange = function (userTasks, persisted) {
        if (persisted.weekDate !== this.state.weekDate) {
            this.setState({
                confirmations: []
            });
        }
        this.setState({
            userTasks: userTasks,
            weekDate: persisted.weekDate
        });
    };
    TaskList.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onChange);
    };
    TaskList.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onChange);
    };
    TaskList.prototype.toggleTask = function (learningTask) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var userTasks, weekDate, latestTimeStamp, userTask;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        userTasks = this.state.userTasks.filter(function (ut) {
                            return learningTask.task ?
                                ut.task && ut.task.some(function (t) { return t.id === learningTask.id; }) :
                                ut.siteVisionPageId === learningTask.id;
                        });
                        weekDate = this.state.weekDate;
                        if (!(userTasks.length === 0)) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        userTask = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                            courseName: learningTask.courseName,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: learningTask.learningGoal,
                            name: learningTask.name,
                            url: learningTask.url,
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not custom tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (learningTask.task && learningTask.task.deadline) {
                            userTask.deadline = learningTask.task.deadline;
                        }
                        if (learningTask.task) {
                            userTask.task = [learningTask.task];
                            if (learningTask.course) {
                                userTask.course = [learningTask.course];
                            }
                            else if (learningTask.courseInfo) {
                                userTask.courseInfo = learningTask.courseInfo;
                            }
                        }
                        else {
                            userTask.siteVisionPageId = learningTask.id;
                        }
                        if (learningTask.step) {
                            userTask.step = learningTask.step;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(learningTask.courseName, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask])
                            ])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Already present in weekplanner. It's time to delete those that matched us.
                    return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete(userTasks.map(function (t) { return t.id; }))];
                    case 3:
                        // Already present in weekplanner. It's time to delete those that matched us.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskList.prototype.render = function () {
        var _this = this;
        var learningTasks = this.props.learningTasks;
        var userTasks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["arrayToMap"])(this.state.userTasks, function (ut) { return ut.task && ut.task.length > 0 ?
            ut.task.map(function (t) { return t.id; })[0] : // course-builder tasks looked up by id
            ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks
                ut.url; });
        var confirmations = this.state.confirmations;
        var weekPlannerWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()(this.state.weekDate).week();
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "" :
            weekPlannerWeek === currentWeek + 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r n\u00E4sta vecka (v", ")"], ["f\u00F6r n\u00E4sta vecka (v", ")"])), weekPlannerWeek) :
                weekPlannerWeek === currentWeek - 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r f\u00F6rra veckan (v", ")"], ["f\u00F6r f\u00F6rra veckan (v", ")"])), weekPlannerWeek) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r vecka ", ""], ["f\u00F6r vecka ", ""])), weekPlannerWeek);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, learningTasks.map(function (learningTask, idx) {
            var taskLookupId = learningTask.id;
            var userTask = userTasks[taskLookupId] || { $meta: 'deleted' }; // No exist = $meta: 'deleted'
            var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';
            var selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';
            var describedAction = selected ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort uppgiften fr\u00E5n egen veckoplanering ", ""], ["Ta bort uppgiften fr\u00E5n egen veckoplanering ", ""])), forWeekString) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till uppgiften i egen veckoplanering ", ""], ["L\u00E4gg till uppgiften i egen veckoplanering ", ""])), forWeekString);
            var confirmationVisible = confirmations.some(function (tid) { return taskLookupId === tid; });
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: learningTask.id },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: taskLookupId, className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (selected ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && weekPlannerWeek === currentWeek ?
                                _this.toggleTask(learningTask) :
                                confirmationVisible ?
                                    _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) }) :
                                    _this.setState({ confirmations: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](confirmations).concat(taskLookupId) }); }, title: describedAction })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: learningTask.url }, learningTask.name))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_confirmation__WEBPACK_IMPORTED_MODULE_7__["Confirmation"], { visible: confirmationVisible, text: describedAction, onConfirm: function () {
                        _this.toggleTask(learningTask);
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    }, onCancel: function () {
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    } }));
        }));
    };
    return TaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-viewer/utils/get-included-ids.ts":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/utils/get-included-ids.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getIncludedIds; });
function getIncludedIds(module, course) {
    var result = {};
    course.tasks.filter(function (t) { return module.taskIds.indexOf(t.id) !== -1; }).forEach(function (task) {
        task.abilities.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.centralContent.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.knowledgeRequirements.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
    });
    return result;
}


/***/ }),

/***/ "./src/components/course-viewer/utils/manual-scroll-restoration.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/utils/manual-scroll-restoration.ts ***!
  \*************************************************************************/
/*! exports provided: initManualScrollRestoration, restoreScrollPosition */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initManualScrollRestoration", function() { return initManualScrollRestoration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "restoreScrollPosition", function() { return restoreScrollPosition; });
var initialized = false;
function initManualScrollRestoration() {
    if (!initialized) {
        initialized = true;
        document.documentElement.addEventListener('click', function (ev) {
            var target = ev.target;
            if (target && target.tagName === 'A') {
                history.replaceState({ pageYOffset: window.pageYOffset }, null, null);
            }
        });
        if (history.scrollRestoration)
            history.scrollRestoration = 'manual';
    }
}
function restoreScrollPosition(_a) {
    var fallbackScrollPosition = _a.fallbackScrollPosition;
    if (history.state && history.state.pageYOffset !== undefined) {
        window.scrollTo(0, history.state.pageYOffset);
    }
    else if (fallbackScrollPosition !== undefined) {
        window.scrollTo(0, fallbackScrollPosition);
    }
}


/***/ }),

/***/ "./src/components/list-courses/list-courses-page.tsx":
/*!***********************************************************!*\
  !*** ./src/components/list-courses/list-courses-page.tsx ***!
  \***********************************************************/
/*! exports provided: ListCoursesPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCoursesPage", function() { return ListCoursesPage; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../course-viewer/course-page/course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _list_courses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./list-courses */ "./src/components/list-courses/list-courses.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");




function ListCoursesPage() {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__["CourseBanner"], { title: _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.school, backgroundImage: "", tabs: [{ name: "Skolans kurser", link: "#" }], activeTab: "#" }),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_list_courses__WEBPACK_IMPORTED_MODULE_2__["ListCourses"], null)))));
}


/***/ }),

/***/ "./src/components/list-courses/list-courses.tsx":
/*!******************************************************!*\
  !*** ./src/components/list-courses/list-courses.tsx ***!
  \******************************************************/
/*! exports provided: ListCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCourses", function() { return ListCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../repos/hidden-courses-repo */ "./src/repos/hidden-courses-repo.ts");







var ListCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ListCourses, _super);
    function ListCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isLoading: true,
            courses: [],
            headerOpen: false
        };
        _this.updateHiddenCourses = _this.updateHiddenCourses.bind(_this);
        return _this;
    }
    ListCourses.prototype.componentWillMount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__["hiddenCoursesRepo"].subscribe(this.updateHiddenCourses, { fullCourse: true });
    };
    ListCourses.prototype.componentWillUnmount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__["hiddenCoursesRepo"].unsubscribe(this.updateHiddenCourses);
    };
    ListCourses.prototype.updateHiddenCourses = function (courses) {
        this.setState({ courses: courses, isLoading: false });
    };
    ListCourses.prototype.hideCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__["hiddenCoursesRepo"].hideCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.showCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_6__["hiddenCoursesRepo"].showCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.render = function () {
        var _this = this;
        if (this.state.isLoading)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__["Spinner"], null);
        var courses = this.state.courses;
        var visibleCourses = courses.filter(function (course) { return course.visible; });
        var hiddenCourses = courses.filter(function (course) { return !course.visible; });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_4__["parseQueryString"])(location.search);
        var viewCourseUrl = this.props.viewCourseUrl || "";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, visibleCourses.map(function (course) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "hideItem", onClick: function () { return _this.hideCourse(course); } })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_access_control_index__WEBPACK_IMPORTED_MODULE_5__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: course.id }) }, course.name))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose" + (this.state.headerOpen ? " open" : "") },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "Dolda kurser")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, hiddenCourses.map(function (course) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "showItem", onClick: function () { return _this.showCourse(course); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_4__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { courseId: course.id })) }, course.name)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
                    })))));
    };
    return ListCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/utility-components/dialogs.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/dialogs.tsx ***!
  \*******************************************************/
/*! exports provided: Dialogs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialogs", function() { return Dialogs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);





var Dialogs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Dialogs, _super);
    function Dialogs(props) {
        return _super.call(this, props) || this;
    }
    Dialogs.prototype.componentDidUpdate = function (prevProps) {
        if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {
            // A dialog was closed. Now focus the last dialog:
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(this.lastDiv)).find(':input').first().focus();
        }
    };
    Dialogs.prototype.render = function () {
        var _this = this;
        this.lastDiv = null;
        var _a = this.props, dialogs = _a.dialogs, popDialog = _a.popDialog;
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').attr('aria-disabled', dialogs.length > 0);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');
        return dialogs.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, dialogs.map(function (dialog, idx) {
            var div;
            function onKeyPress(ev) {
                if (ev.which === 13 && (!ev.target || ev.target.tagName !== 'TEXTAREA')) {
                    jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div)).find('.btn-default').click();
                }
                ev.stopPropagation();
            }
            function onKeyDown(ev) {
                if (ev.which === 27) { // Escape
                    popDialog();
                    ev.stopPropagation();
                    return;
                }
                if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
                    var domNode = Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div);
                    ev.preventDefault();
                    var defaultButton = jquery__WEBPACK_IMPORTED_MODULE_4___default()(domNode).find('.btn-default');
                    defaultButton.click();
                    ev.stopPropagation();
                }
            }
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page", ref: function (elem) {
                            div = elem;
                            if (idx === dialogs.length - 1)
                                _this.lastDiv = elem;
                        }, tabIndex: 0, "aria-disabled": idx < dialogs.length - 1, onKeyPress: onKeyPress, onKeyDown: onKeyDown },
                        dialog,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__["RemoveItem"], { onClick: popDialog }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stopFloats" }))));
        }));
    };
    return Dialogs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-text-input.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/utility-components/form-field-text-input.tsx ***!
  \*********************************************************************/
/*! exports provided: TextInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextInput", function() { return TextInput; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextInput = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextInput, _super);
    function TextInput(props) {
        return _super.call(this, props) || this;
    }
    TextInput.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: this.props.autoFocus, id: this.props.id, size: 35, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder }))));
    };
    return TextInput;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-textarea.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/form-field-textarea.tsx ***!
  \*******************************************************************/
/*! exports provided: TextAreaFormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextAreaFormField", function() { return TextAreaFormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextAreaFormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextAreaFormField, _super);
    function TextAreaFormField(props) {
        return _super.call(this, props) || this;
    }
    TextAreaFormField.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label, id: this.props.id },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: this.props.autoFocus, id: this.props.id, cols: 35, rows: this.props.rows || 5, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder })),
                !!this.props.children && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" }, this.props.children))));
    };
    return TextAreaFormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field.tsx":
/*!**********************************************************!*\
  !*** ./src/components/utility-components/form-field.tsx ***!
  \**********************************************************/
/*! exports provided: FormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormField", function() { return FormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function findId(node) {
    var recucheck = new Set();
    return (function findId(node) {
        if (typeof node === 'string')
            return null;
        if (recucheck.has(node)) {
            return;
        }
        recucheck.add(node);
        if (node.props) {
            if (node.props.id)
                return node.props.id;
            if (node.props.children) {
                return findId(node.props.children);
            }
            return;
        }
        if (node.length) {
            for (var i = 0; i < node.length; ++i) {
                var child = node[i];
                if (child) {
                    var childId = findId(child);
                    if (childId)
                        return childId;
                    //console.log(child);
                }
            }
        }
    })(node);
}
var FormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FormField, _super);
    function FormField(props) {
        return _super.call(this, props) || this;
    }
    FormField.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel", htmlFor: this.props.id || findId(this.props.children) }, this.props.label),
            this.props.children);
    };
    return FormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/


var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } }, title),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-goal.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-goal.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomGoal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomGoal", function() { return AddCustomGoal; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var AddCustomGoal = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomGoal, _super);
    function AddCustomGoal(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            learningGoal: props.learningGoal || ''
        };
        return _this;
    }
    AddCustomGoal.prototype.render = function () {
        var _this = this;
        var learningGoal = this.state.learningGoal;
        var onSave = this.props.onSave;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "L\u00E4gg till eget l\u00E4randem\u00E5l"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "M\u00E5l:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, autoFocus: true, value: learningGoal, onChange: function (e) { return _this.setState({ learningGoal: e.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(learningGoal); } }, "Spara")));
    };
    return AddCustomGoal;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-task.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-task.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomTask", function() { return AddCustomTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");




var AddCustomTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomTask, _super);
    function AddCustomTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            name: '',
            description: '',
            url: ''
        };
        return _this;
    }
    AddCustomTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var _b = this.props, isTask = _b.isTask, onSave = _b.onSave;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "L\u00E4gg till eget arbetsm\u00E5l"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: "Namn", id: "AddCustomTask:name", placeholder: "Ange namn...", value: name, autoFocus: true, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { rows: 7, label: "Beskrivning", id: "AddCustomTask:description", placeholder: "L\u00E4gg till en beskrivning...", value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: "L\u00E4nk", id: "AddCustomTask:url", placeholder: "http://www...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(name, description, url); } }, "Spara")));
    };
    return AddCustomTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-or-edit-sub-task.tsx":
/*!*************************************************************!*\
  !*** ./src/components/weekplanner/add-or-edit-sub-task.tsx ***!
  \*************************************************************/
/*! exports provided: AddOrEditSubTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddOrEditSubTask", function() { return AddOrEditSubTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");





var AddOrEditSubTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddOrEditSubTask, _super);
    function AddOrEditSubTask(props) {
        var _this = _super.call(this, props) || this;
        if (props.mode === 'edit') {
            var subTask = props.subTask;
            _this.state = {
                name: subTask.name || '',
                description: subTask.description || '',
                url: subTask.url || ''
            };
        }
        else {
            _this.state = {
                name: '',
                description: '',
                url: ''
            };
        }
        return _this;
    }
    AddOrEditSubTask.prototype.save = function () {
        // Update repo:
        var props = this.props;
        var userTask = props.userTask, closeDialog = props.closeDialog, userTasksRepo = props.userTasksRepo;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        if (props.mode === 'edit') {
            // Edit existing:
            userTasksRepo.update([userTask], function (ut) {
                var subTasks = ut.subTasks;
                if (subTasks) {
                    ut.subTasks = subTasks.map(function (st) {
                        return st.id === props.subTask.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st, { name: name, description: description, url: url }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st);
                    });
                }
            });
        }
        else {
            // Create new task
            var newSubTask_1 = {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                name: name,
                description: description,
                url: url
            };
            // Update repo:
            userTasksRepo.update([userTask], function (ut) {
                if (!ut.subTasks) {
                    ut.subTasks = [];
                }
                ut.subTasks = ut.subTasks.concat(newSubTask_1);
            });
        }
        // Close dialog
        closeDialog();
    };
    AddOrEditSubTask.prototype.delete = function () {
        // Update repo:
        var props = this.props;
        if (props.mode !== 'edit') {
            throw new Error("Can only delete in edit mode");
        }
        props.userTasksRepo.update([props.userTask], function (ut) {
            if (ut.subTasks) {
                ut.subTasks = ut.subTasks.filter(function (t) { return t.id !== props.subTask.id; });
            }
        });
        // Close dialog:
        props.closeDialog();
    };
    AddOrEditSubTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var props = this.props;
        var isEditMode = props.mode === 'edit';
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isEditMode ? 'Redigera underuppgift' : 'Lägg till underuppgift'),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { autoFocus: true, label: "Underuppgiftens namn", id: "AddUserSubTask:name", placeholder: "", value: this.state.name, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { label: "Beskrivning", id: "AddUserSubTask:description", rows: 7, placeholder: "", value: this.state.description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: "L\u00E4nk", id: "AddUserSubTask:url", placeholder: "", value: this.state.url, onChange: function (url) { return _this.setState({ url: url }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                props.mode === 'edit' && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn btn-warning btn-large pull-right", onClick: function (ev) { return _this.delete(); } }, "Ta bort underuppgift"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } }, "Spara")));
    };
    return AddOrEditSubTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/edit-user-task.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/edit-user-task.tsx ***!
  \*******************************************************/
/*! exports provided: EditUserTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditUserTask", function() { return EditUserTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/form-field */ "./src/components/utility-components/form-field.tsx");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");










var EditUserTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditUserTask, _super);
    function EditUserTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: props.userTask,
            name: props.userTask.name,
            description: props.userTask.description,
            url: props.userTask.url,
            deadline: props.userTask.deadline,
            subTasks: props.userTask.subTasks
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    EditUserTask.prototype.componentDidMount = function () {
        this.props.userTasksRepo.subscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var myUserTask = userTasks.find(function (ut) { return ut.id === _this.props.userTask.id; });
        if (!myUserTask) {
            this.props.closeDialog();
            return;
        }
        this.setState({
            userTask: myUserTask,
            subTasks: myUserTask.subTasks
        });
    };
    EditUserTask.prototype.componentWillUnmount = function () {
        this.props.userTasksRepo.unsubscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.isModified = function () {
        // Don't count subtask changes! They live their own life and is maintained
        // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks
        // to be persisted right away. May click away this dialog.
        // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner
        // when clicking the subtask for example!
        var _a = this.state, deadline = _a.deadline, description = _a.description, name = _a.name, url = _a.url, userTask = _a.userTask;
        return (deadline !== userTask.deadline ||
            description !== userTask.description ||
            name !== userTask.name ||
            url !== userTask.url);
    };
    EditUserTask.prototype.addSubTask = function () {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "add", userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.editSubTask = function (subTask) {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "edit", subTask: subTask, userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url, deadline = _a.deadline, subTasks = _a.subTasks, showCalendar = _a.showCalendar, userTask = _a.userTask;
        var id = userTask.id, courseName = userTask.courseName;
        var _b = this.props, onUpdate = _b.onUpdate, onDelete = _b.onDelete;
        var isModified = this.isModified();
        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_2__["getTaskType"])(userTask);
        var isCustomTask = taskType === 'customTask';
        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline) < moment__WEBPACK_IMPORTED_MODULE_6___default()();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isCustomTask ? "Redigera arbetsm\u00E5l" : "Redigera uppgift"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { autoFocus: true, label: isCustomTask ? "Arbetsmålets namn" : "Uppgiftens namn", id: "EditUserTask:name", placeholder: isCustomTask ? "Vad ska du göra?" : "Ange uppgiftens namn...", value: name, onChange: function (name) { return _this.setState({ name: name }); } }),
            isCustomTask && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__["TextAreaFormField"], { rows: 5, label: "Beskrivning", id: "EditUserTask:description", placeholder: "L\u00E4gg till en beskrivning...", value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { label: "L\u00E4nk", id: "EdutUserTask:url", placeholder: "http(s)://...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: "Ange deadline" }, (deadline || showCalendar) ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_3__["default"], { ref: function (elem) { return _this.datePicker = elem; }, id: "EditUserTask:deadline", selected: deadline && moment__WEBPACK_IMPORTED_MODULE_6___default()(deadline), autoFocus: showCalendar, dateFormat: "YYYY-MM-DD", className: expired ? "expired" : undefined, locale: "sv", popperPlacement: isCustomTask ? "top-start" : "bottom-start", onBlur: function () { return _this.setState({ showCalendar: false }); }, onChange: function (value) {
                                _this.setState({
                                    deadline: value && value.format("YYYY-MM-DD"),
                                    showCalendar: false
                                });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "deleteDate", href: "#", title: "Ta bort deadline", onClick: function (ev) {
                                ev.preventDefault();
                                _this.setState({ deadline: null, showCalendar: false });
                            } }))) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top", ref: function () { _this.datePicker = null; } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function (ev) {
                            if (_this.datePicker) {
                                _this.datePicker.setOpen(true);
                            }
                            _this.setState({
                                showCalendar: true
                            });
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-calendar", "aria-hidden": "true" }),
                        " Ange deadline..."))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: "Underuppgifter" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, subTasks && subTasks.map(function (subTask) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () { return _this.editSubTask(subTask); }, href: "#" }, subTask.name))); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { id: "EditUserTask:addSubTask", className: "btn", onClick: function () { return _this.addSubTask(); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                            " L\u00E4gg till underuppgift")))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "divider large" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-default", onClick: function () {
                            isModified ? onUpdate(function (userTask) {
                                userTask.name = name;
                                userTask.description = description;
                                userTask.url = url;
                                userTask.deadline = deadline;
                            }) : _this.props.closeDialog();
                        } }, " Spara ")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn", onClick: function () {
                            _this.props.closeDialog();
                        } }, " Avbryt ")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "confirm top pull-right" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-warning", onClick: function () {
                            onDelete(id);
                        } }, isCustomTask ?
                        " Ta bort arbetsmål" :
                        " Ta bort den här uppgiften"))));
    };
    return EditUserTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/get-task-type.ts":
/*!*****************************************************!*\
  !*** ./src/components/weekplanner/get-task-type.ts ***!
  \*****************************************************/
/*! exports provided: getTaskType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTaskType", function() { return getTaskType; });
function getTaskType(userTask) {
    return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?
        'courseBuilderTask' :
        userTask.siteVisionPageId ?
            'siteVisionTask' :
            userTask.courseInfo ?
                'subjectPlannerTask' :
                'customTask';
}


/***/ }),

/***/ "./src/components/weekplanner/index.ts":
/*!*********************************************!*\
  !*** ./src/components/weekplanner/index.ts ***!
  \*********************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./weekplanner */ "./src/components/weekplanner/weekplanner.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return _weekplanner__WEBPACK_IMPORTED_MODULE_0__["WeekPlanner"]; });




/***/ }),

/***/ "./src/components/weekplanner/refiner.ts":
/*!***********************************************!*\
  !*** ./src/components/weekplanner/refiner.ts ***!
  \***********************************************/
/*! exports provided: refine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "refine", function() { return refine; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


function refine(tasks) {
    var e_1, _a, e_2, _b;
    var result = [];
    var mapper = {};
    var tasksPerCourse = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(tasks, function (t) { return t.courseName || ''; });
    try {
        for (var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerCourse).sort().filter(function (x) { return x; }).concat(tasksPerCourse[''] ?
            [''] : [])), _d = _c.next(); !_d.done; _d = _c.next()) {
            var courseName = _d.value;
            var courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];
            var tasksPerLearningGoal = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(courseTasks, function (t) { return t.learningGoal; });
            var resultLearningGoals = [];
            try {
                for (var _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerLearningGoal)), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var learningGoal = _f.value;
                    var lgTasks = tasksPerLearningGoal[learningGoal].sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["compareProp"])("dateTime"));
                    var learningGoalTask = lgTasks
                        .filter(function (t) { return t.name == null; }) // If name is undefined or null, this represents a learning goal
                    [0];
                    var url = learningGoalTask && learningGoalTask.url;
                    resultLearningGoals.push({
                        name: learningGoal,
                        allTasks: lgTasks,
                        url: url,
                        step: lgTasks.map(function (t) { return t.step; }).filter(function (step) { return step; })[0],
                        tasks: lgTasks.filter(function (t) { return t.name; })
                    });
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            result.push({
                courseName: courseName,
                learningGoals: resultLearningGoals
            });
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}


/***/ }),

/***/ "./src/components/weekplanner/user-tasks-box.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/user-tasks-box.tsx ***!
  \*******************************************************/
/*! exports provided: UserTasksBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksBox", function() { return UserTasksBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../calendar/course-name-to-css-class */ "./src/components/calendar/course-name-to-css-class.ts");
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");










;
var UserTasksBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksBox, _super);
    function UserTasksBox(props) {
        return _super.call(this, props) || this;
    }
    UserTasksBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseName = _a.courseName, learningGoals = _a.learningGoals;
        var isOpen = !!this.props.openCourses[courseName];
        var features = new _features__WEBPACK_IMPORTED_MODULE_8__["Features"]();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, courseName || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Egna l\u00E4randem\u00E5l"], ["Egna l\u00E4randem\u00E5l"])))), headerOpen: isOpen, className: courseName && Object(_calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_5__["courseNameToCssClass"])('wp-course-', courseName), onOpenClose: function (becameOpen) { return _this.props.setIsOpen(courseName, becameOpen); } }, learningGoals.map(function (lg) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name, className: "learningGoalContainer" },
                lg.step && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stepIndicator" }, lg.step),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalText horizontalItem top" }, lg.name),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        "\u00A0",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "trash", href: "#", title: "Ta bort l\u00E4randem\u00E5let och dess uppgifter", onClick: function (ev) {
                                ev.preventDefault();
                                _this.props.removeLearningGoal(lg);
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, lg.tasks.map(function (userTask) {
                        var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';
                        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_6__["getTaskType"])(userTask);
                        var expired = moment__WEBPACK_IMPORTED_MODULE_7___default()(userTask.deadline).startOf('day') < moment__WEBPACK_IMPORTED_MODULE_7___default()().startOf('day');
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: userTask.id, style: isWorking ? { opacity: 0.5 } : {} },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (userTask.done ? " checked" : ""), onClick: function (ev) { return !isWorking && _this.props.setTaskDone(userTask, !userTask.done); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    taskType === 'courseBuilderTask' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getTaskUrl(userTask, _this.props.viewCourseUrl) }, userTask.name) :
                                        taskType === 'subjectPlannerTask' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getSubjectPlannerTaskUrl(userTask) }, userTask.name) :
                                            taskType === 'siteVisionTask' ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: userTask.url }, userTask.name) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: !userTask.url ? "link-less" : "", href: userTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                        "_self" :
                                                        "_blank" }, userTask.name),
                                    userTask.deadline && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "dateSet" + (expired ? ' expired' : '') },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { title: moment__WEBPACK_IMPORTED_MODULE_7___default()(userTask.deadline).format("YYYY-MM-DD"), className: "fa fa-calendar", "aria-hidden": "true", onClick: function () { } }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editTask(userTask); } }))),
                            userTask.subTasks && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "subtasks" }, userTask.subTasks.map(function (subTask) {
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (subTask.done ? " checked" : ""), onClick: function (ev) {
                                                return !isWorking &&
                                                    _this.props.setSubTaskDone(userTask, subTask, !subTask.done);
                                            } })),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: subTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                "_self" :
                                                "_blank", className: subTask.url ?
                                                undefined :
                                                'link-less' }, subTask.name)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editSubTask(userTask, subTask); } })));
                            })));
                    }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTools" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn addOwnGoal", onClick: function () { return _this.props.addOwnTask(_this.props.courseName, lg.name); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                        " ", Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Eget arbetsm\u00E5l"], ["Eget arbetsm\u00E5l"]))))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
        }));
    };
    return UserTasksBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getTaskUrl(userTask, viewCourseUrl) {
    if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_4__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: userTask.course[0].id });
        return courseUrl + "#/task/" + userTask.task[0].id;
    }
    return userTask.url;
}
function getSubjectPlannerTaskUrl(userTask) {
    if (userTask.courseInfo && userTask.task && userTask.task.length > 0) {
        var _a = userTask.courseInfo, school = _a.school, course = _a.course, tab = _a.tab;
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_4__["preserveImpersonationQuery"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_9__["default"].courseViewerUrlKS, {});
        return courseUrl + "#/" + school + "/courses/" + course + "/tabs/" + tab + "/tasks/" + userTask.task[0].id;
    }
    return userTask.url;
}
var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/weekplanner/weekplanner-persisted-state.ts":
/*!*******************************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-persisted-state.ts ***!
  \*******************************************************************/
/*! exports provided: WeekPlannerPersistedState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerPersistedState", function() { return WeekPlannerPersistedState; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");



var WeekPlannerPersistedState = /** @class */ (function () {
    function WeekPlannerPersistedState(userOrCopy) {
        if (typeof userOrCopy === 'string') {
            this.user = userOrCopy;
            this.lastWrite = Date.now();
            this.weekDate = Object(_globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__["localMoment"])().startOf('week').valueOf();
            this.openCourses = {};
        }
        else {
            Object.assign(this, userOrCopy);
        }
    }
    WeekPlannerPersistedState.load = function (user) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var cookie, storedData, state;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                cookie = localStorage.getItem('WeekPlannerPersistedState2');
                storedData = cookie && JSON.parse(cookie);
                state = new WeekPlannerPersistedState(user);
                if (storedData)
                    Object.assign(state, storedData);
                return [2 /*return*/, state.user === user && !state.isExpired(moment__WEBPACK_IMPORTED_MODULE_1___default()()) ?
                        state : new WeekPlannerPersistedState(user)];
            });
        });
    };
    WeekPlannerPersistedState.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.lastWrite = Date.now();
                json = JSON.stringify(this);
                localStorage.setItem('WeekPlannerPersistedState2', json);
                return [2 /*return*/];
            });
        });
    };
    WeekPlannerPersistedState.prototype.isExpired = function (asOf) {
        return moment__WEBPACK_IMPORTED_MODULE_1___default()(this.lastWrite)
            .isBefore(asOf.add(0 - WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours'));
    };
    WeekPlannerPersistedState.EXPIRATION_HOURS = 12;
    WeekPlannerPersistedState.VERSION = 2;
    return WeekPlannerPersistedState;
}());



/***/ }),

/***/ "./src/components/weekplanner/weekplanner.tsx":
/*!****************************************************!*\
  !*** ./src/components/weekplanner/weekplanner.tsx ***!
  \****************************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return WeekPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _user_tasks_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./user-tasks-box */ "./src/components/weekplanner/user-tasks-box.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _refiner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./refiner */ "./src/components/weekplanner/refiner.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _add_custom_goal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-custom-goal */ "./src/components/weekplanner/add-custom-goal.tsx");
/* harmony import */ var _add_custom_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./add-custom-task */ "./src/components/weekplanner/add-custom-task.tsx");
/* harmony import */ var _edit_user_task__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./edit-user-task */ "./src/components/weekplanner/edit-user-task.tsx");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/pending-job */ "./src/utils/pending-job.ts");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
















var MAX_STRATEGY_LENGTH = 16384;
var MAX_ASSESSMENT_LENGTH = 16384;
var WeekPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekPlanner, _super);
    function WeekPlanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            openCourses: {},
            dialogs: [],
            saving: false,
            weekTextsUT: null,
            isLoading: true,
            isCopyingTasks: false
        };
        _this.onChange = _this.onChange.bind(_this);
        _this.weekTextsSavingJob = new _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__["PendingJob"](function () { return _this.saveWeekTexts(); });
        return _this;
    }
    WeekPlanner.prototype.componentDidMount = function () {
        this.props.env.userTasksRepo.subscribe(this.onChange);
    };
    WeekPlanner.prototype.componentWillUnmount = function () {
        this.props.env.userTasksRepo.unsubscribe(this.onChange);
        this.weekTextsSavingJob.stop();
    };
    WeekPlanner.prototype.onChange = function (userTasks, persisted, weekTextsUT) {
        var newState = {
            userTasks: userTasks,
            weekDate: persisted.weekDate,
            openCourses: persisted.openCourses,
            weekTextsUT: weekTextsUT,
            isLoading: false
        };
        if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {
            // Changing week. Reset to new week's values
            newState.strategy = weekTextsUT.weekTexts.strategy;
            newState.assessment = weekTextsUT.weekTexts.assessment;
        }
        this.setState(newState); // React's use of Pick instead of Partial makes things complex here.
    };
    WeekPlanner.prototype.isWeekTextsEdited = function () {
        var _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
        return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);
    };
    WeekPlanner.prototype.saveWeekTexts = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, strategy, assessment, weekTextsUT;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        console.log("Saving texts...");
                        _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
                        if (!this.isWeekTextsEdited()) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.props.env.userTasksRepo.upsert(weekTextsUT, function (ut) {
                                ut.weekTexts = { strategy: strategy, assessment: assessment };
                            })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.prevWeek = function () {
        //this.saveWeekTexts();
        this.props.env.userTasksRepo.changeWeek(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).add(-1, 'week').toDate());
    };
    WeekPlanner.prototype.nextWeek = function () {
        //this.saveWeekTexts();
        this.props.env.userTasksRepo.changeWeek(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).add(1, 'week').toDate());
    };
    WeekPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    WeekPlanner.prototype.openAddGoalDialog = function () {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_goal__WEBPACK_IMPORTED_MODULE_8__["AddCustomGoal"], { onSave: function (learningGoal) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!learningGoal)
                                throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4randem\u00E5let kan inte vara tomt"], ["L\u00E4randem\u00E5let kan inte vara tomt"]))));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomGoal(learningGoal)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.openAddOwnTaskDialog = function (courseName, learningGoalName) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_task__WEBPACK_IMPORTED_MODULE_9__["AddCustomTask"], { isTask: !courseName, onSave: function (name, description, url) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!name)
                                throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Namnet kan inte vara tomt"], ["Namnet kan inte vara tomt"]))));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomTask(courseName, learningGoalName, name, description, url)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.editTask = function (userTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_user_task__WEBPACK_IMPORTED_MODULE_10__["EditUserTask"], { userTasksRepo: this.props.env.userTasksRepo, userTask: userTask, onUpdate: function (updater) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var test;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            test = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, userTask);
                            updater(test);
                            if (!test.name)
                                throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Namnet f\u00E5r inte vara tomt"], ["Namnet f\u00E5r inte vara tomt"]))));
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.update([userTask], updater)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, onDelete: function (id) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.delete([id])];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, openDialog: function (dialog) { return _this.openDialog(dialog); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.editSubTask = function (userTask, subTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__["AddOrEditSubTask"], { userTasksRepo: this.props.env.userTasksRepo, mode: "edit", userTask: userTask, subTask: subTask, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    WeekPlanner.prototype.addCustomGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    learningGoal: learningGoal,
                                    dateTime: latestTimeStamp + 2000
                                }])];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.props.env.userTasksRepo.setWeekPlannerBoxOpen("", true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.removeLearningGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (learningGoal.tasks.length > 0) {
                            if (!confirm("Ta bort l\u00E4randem\u00E5l samt " + learningGoal.tasks.length + " uppgifter?")) {
                                return [2 /*return*/];
                            }
                        }
                        return [4 /*yield*/, this.props.env.userTasksRepo.delete(learningGoal.allTasks.map(function (t) { return t.id; }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.addCustomTask = function (courseName, learningGoal, name, description, url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    dateTime: latestTimeStamp + 2000,
                                    courseName: courseName,
                                    learningGoal: learningGoal,
                                    name: name,
                                    description: description,
                                    url: url
                                }])];
                    case 1:
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setIsOpen = function (courseName, isOpen) {
        this.props.env.userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);
    };
    WeekPlanner.prototype.setTaskDone = function (task, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setTaskDoneState(task, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setSubTaskDone = function (task, subTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setSubTaskDoneState(task, subTask.id, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.copyFromPreviousWeek = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, userTasks_1, openCourses, weekDate, prevWeekNo, prevKEDWeek, prevTasks, latestTimeStamp_1, copies;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.setState({ isCopyingTasks: true })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, , 5, 6]);
                        _a = this.state, userTasks_1 = _a.userTasks, openCourses = _a.openCourses, weekDate = _a.weekDate;
                        prevWeekNo = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["getAdjustedWeek"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(weekDate).add(-1, 'week'));
                        prevKEDWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(weekDate).year(), prevWeekNo);
                        return [4 /*yield*/, this.props.env.kedBackendClient.list("usertasks", {
                                from: prevKEDWeek.notBefore,
                                to: prevKEDWeek.notAfter,
                                role: "USER",
                                include: ["task", "course", "acl"],
                                flags: ["includeIdsOnly"]
                            })];
                    case 3:
                        prevTasks = _b.sent();
                        prevTasks = prevTasks
                            .filter(function (prevTask) { return !prevTask.done; }) // Don't copy done tasks
                            .filter(function (prevTask) { return !!prevTask.name; }) // Don't copy empty learning goals
                            .filter(function (prevTask) { return !userTasks_1.some(function (taskOfCurrentWeek) {
                            return taskOfCurrentWeek.name === prevTask.name &&
                                taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&
                                taskOfCurrentWeek.courseName === prevTask.courseName;
                        }); }); // Ignore identical tasks (already copied)
                        latestTimeStamp_1 = Math.max.apply(Math.max, [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; })));
                        copies = prevTasks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("dateTime")).map(function (task) {
                            var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, { dateTime: latestTimeStamp_1 += 1000 });
                            copy.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])();
                            if (copy.subTasks) {
                                copy.subTasks = copy.subTasks.filter(function (st) { return !st.done; });
                            }
                            delete copy.$etag;
                            return copy;
                        });
                        // Store it
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert(copies)];
                    case 4:
                        // Store it
                        _b.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        this.setState({ isCopyingTasks: false });
                        return [7 /*endfinally*/];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.render = function () {
        var _this = this;
        var weekNumber = moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).week();
        //console.log("Weekydate: "  + new Date(this.state.weekDate) + " which is week no " + weekNumber);
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_6___default()().week();
        var taskSets = Object(_refiner__WEBPACK_IMPORTED_MODULE_4__["refine"])(this.state.userTasks);
        var _a = this.state, dialogs = _a.dialogs, weekTextsUT = _a.weekTextsUT, strategy = _a.strategy, assessment = _a.assessment, isLoading = _a.isLoading, isCopyingTasks = _a.isCopyingTasks;
        var isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');
        var isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);
        var isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);
        var enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed weekPlanner" + (weekNumber === currentWeek ? " currentWeek" : ""), onKeyDown: function (ev) {
                    if (ev.which === 83 && ev.ctrlKey) {
                        ev.preventDefault();
                        if (!isSaving && _this.isWeekTextsEdited()) {
                            _this.weekTextsSavingJob.triggerChange(0);
                        }
                    }
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "weekSelect" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Vecka ", ""], ["Vecka ", ""])), weekNumber))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.prevWeek(); } },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.nextWeek(); } },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" }))))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Loggbok"], ["Loggbok"])))),
                taskSets.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                taskSets.map(function (props) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_user_tasks_box__WEBPACK_IMPORTED_MODULE_2__["UserTasksBox"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ key: props.courseName }, props, { courseName: props.courseName, learningGoals: props.learningGoals, viewCourseUrl: _this.props.viewCourseUrl, openCourses: _this.state.openCourses, addOwnTask: function (courseName, learningGoalName) { return _this.openAddOwnTaskDialog(courseName, learningGoalName); }, setIsOpen: _this.setIsOpen.bind(_this), setTaskDone: _this.setTaskDone.bind(_this), setSubTaskDone: _this.setSubTaskDone.bind(_this), editTask: function (task) { return _this.editTask(task); }, editSubTask: function (task, subTask) { return _this.editSubTask(task, subTask); }, removeLearningGoal: function (lg) { return _this.removeLearningGoal(lg); } }));
                }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                isLoading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__["Spinner"], null) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", onClick: function (ev) { return _this.openAddGoalDialog(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-list-alt", "aria-hidden": "true" }),
                        " ", Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Eget l\u00E4randem\u00E5l"], ["Eget l\u00E4randem\u00E5l"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", style: isCopyingTasks ? { opacity: 0.5 } : undefined, onClick: function (ev) { return (!isCopyingTasks) && _this.copyFromPreviousWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-clone", "aria-hidden": "true" }),
                        " ", Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kopiera ej klara fr\u00E5n f\u00F6reg\u00E5ende vecka"], ["Kopiera ej klara fr\u00E5n f\u00F6reg\u00E5ende vecka"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Strategi & Utv\u00E4rdering"], ["Strategi & Utv\u00E4rdering"])))), headerOpen: this.state.openCourses["StratUtv"], onOpenClose: function (becameOpen) { return _this.setIsOpen("StratUtv", becameOpen); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Strategi"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Hur jag ska g\u00F6ra f\u00F6r att l\u00E4ra mig."),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", disabled: this.props.env.tutored, value: strategy && strategy.substr(0, MAX_STRATEGY_LENGTH), onChange: function (ev) {
                                _this.setState({ strategy: (ev.target.value || '').substr(0, MAX_STRATEGY_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Utv\u00E4rdering"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Reflektion kring din arbetsinsats och dina valda strategier under veckan. Utv\u00E4rdera i f\u00F6rh\u00E5llande till dina m\u00E5l."),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", value: assessment && assessment.substr(0, MAX_ASSESSMENT_LENGTH), disabled: this.props.env.tutored, onChange: function (ev) {
                                _this.setState({ assessment: (ev.target.value || '').substr(0, MAX_ASSESSMENT_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", tabIndex: 0, style: enableSaveButton ? {} : { opacity: 0.5 }, onClick: function () { return !isSaving && _this.weekTextsSavingJob.triggerChange(0); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-floppy-o", "aria-hidden": "true" }),
                            enableSaveButton ? " Spara" : " Sparad")))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__["Dialogs"], { dialogs: dialogs, popDialog: function () {
                    _this.setState(function (_a) {
                        var dialogs = _a.dialogs;
                        return ({ dialogs: dialogs.slice(0, dialogs.length - 1) });
                    });
                } }));
    };
    return WeekPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8;


/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


var Features = /** @class */ (function () {
    //EditUserTasksViaPenOnly?: boolean;
    //SubTasks?: boolean;
    function Features() {
        var user = _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser;
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_0__["parseQueryString"])(location.search, { toLower: true });
        var features = (query.features || '').split(',')
            .map(function (feature) { return feature.toLowerCase(); }); // Can be used on forwards...
        /*this.EditUserTasksViaPenOnly =
          user.schoolType !== 'Grundskolor' && query.schooltype !== "Grundskolor";*/
        /*this.SubTasks =
          user.schoolType !== 'Grundskolor' && query.schooltype !== "Grundskolor";*/
        //this.AssignmentTasks = !!query.testversion;
    }
    return Features;
}());



/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://kedbackend.azurewebsites.net/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"


/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "../kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ? _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail : ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/moment-sv-locale.ts":
/*!*****************************************!*\
  !*** ./src/globals/moment-sv-locale.ts ***!
  \*****************************************/
/*! exports provided: localMoment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localMoment", function() { return localMoment; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

moment__WEBPACK_IMPORTED_MODULE_0___default.a.updateLocale('sv', {
    months: 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),
    monthsShort: 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),
    weekdays: 'söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag'.split('_'),
    weekdaysShort: 'sön_mån_tis_ons_tor_fre_lör'.split('_'),
    weekdaysMin: 'sö_må_ti_on_to_fr_lö'.split('_'),
    longDateFormat: {
        LT: 'HH:mm',
        LTS: 'HH:mm:ss',
        L: 'YYYY-MM-DD',
        LL: 'D MMMM YYYY',
        LLL: 'D MMMM YYYY [kl.] HH:mm',
        LLLL: 'dddd D MMMM YYYY [kl.] HH:mm',
        lll: 'D MMM YYYY HH:mm',
        llll: 'ddd D MMM YYYY HH:mm'
    },
    calendar: {
        sameDay: '[Idag] LT',
        nextDay: '[Imorgon] LT',
        lastDay: '[Igår] LT',
        nextWeek: '[På] dddd LT',
        lastWeek: '[I] dddd[s] LT',
        sameElse: 'L'
    },
    relativeTime: {
        future: 'om %s',
        past: 'för %s sedan',
        s: 'några sekunder',
        ss: '%d sekunder',
        m: 'en minut',
        mm: '%d minuter',
        h: 'en timme',
        hh: '%d timmar',
        d: 'en dag',
        dd: '%d dagar',
        M: 'en månad',
        MM: '%d månader',
        y: 'ett år',
        yy: '%d år'
    },
    dayOfMonthOrdinalParse: /\d{1,2}(e|a)/,
    ordinal: function (number) {
        var b = number % 10, output = (~~(number % 100 / 10) === 1) ? 'e' :
            (b === 1) ? 'a' :
                (b === 2) ? 'a' :
                    (b === 3) ? 'e' : 'e';
        return number + output;
    },
    week: {
        dow: 1,
        doy: 4 // The week that contains Jan 4th is the first week of the year.
    }
});
var localMoment = function () {
    return moment__WEBPACK_IMPORTED_MODULE_0___default.a.apply(this, arguments).locale('sv');
};


/***/ }),

/***/ "./src/repos/hidden-courses-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/hidden-courses-repo.ts ***!
  \******************************************/
/*! exports provided: hiddenCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hiddenCoursesRepo", function() { return hiddenCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);








var hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo;
var HiddenCoursesRepo = /** @class */ (function () {
    function HiddenCoursesRepo() {
        var _this = this;
        this.result = null;
        this.subscribers = [];
        this.fullCourse = false;
        this.notifySubscriber = function (subscriber, options) {
            try {
                subscriber(options.fullCourse ? _this.result : _this.result.filter(function (c) { return c.visible; }));
            }
            catch (err) {
                console.error(err);
            }
        };
        this.kedRepo = new _ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]({
            getClient: function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; },
            optimistic: true,
            table: "userhiddencourses",
            user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, ({ role: "USER" })];
            }); }); },
        });
        var initPromise = this.init();
        Promise.all([
            initPromise,
            this.kedCoursesPromise,
            this.edsCoursesPromise
        ]).catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    }
    HiddenCoursesRepo.prototype.init = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var bearerPromise, resolveUserHiddenCoursesPromise, userHiddenCoursesResolved;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer() : Promise.resolve({});
                        // In parallell, we request:
                        //  1) KEDBackend: Schools.activeCourses
                        //  2) EDS.getActiveAcourses()
                        //  3) (via subscription): KEDBackend: userHiddenCourses
                        this.kedCoursesPromise = bearerPromise.then(function () { return _this.listKedCourses(); });
                        this.edsCoursesPromise = bearerPromise.then(function () { return _this.listEDSCourses(); });
                        userHiddenCoursesResolved = false;
                        this.userHiddenCoursesPromise = new Promise(function (resolve) { return resolveUserHiddenCoursesPromise = function (x) {
                            if (userHiddenCoursesResolved) {
                                _this.userHiddenCoursesPromise = Promise.resolve(x);
                            }
                            else {
                                userHiddenCoursesResolved = true;
                                resolve(x);
                            }
                        }; });
                        return [4 /*yield*/, bearerPromise];
                    case 1:
                        _a.sent();
                        this.kedRepo.mem.subscribe(function (userHiddenCourses) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a, activeCourses, edsActiveCourses, _b;
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                                switch (_c.label) {
                                    case 0: return [4 /*yield*/, Promise.all([
                                            this.kedCoursesPromise,
                                            this.edsCoursesPromise
                                        ])];
                                    case 1:
                                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 2]), activeCourses = _a[0], edsActiveCourses = _a[1];
                                        // Refine the three results into a single result
                                        _b = this;
                                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                                    case 2:
                                        // Refine the three results into a single result
                                        _b.result = _c.sent();
                                        // Notify our subscribers:
                                        this.subscribers.forEach(function (subscriber) { return _this.notifySubscriber(subscriber.subscriber, subscriber.options); });
                                        resolveUserHiddenCoursesPromise(userHiddenCourses);
                                        return [2 /*return*/];
                                }
                            });
                        }); });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listKedCourses = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var fullCourse, schools, activeCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        fullCourse = this.fullCourse;
                        console.log("FullCourse: " + fullCourse);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list('schools', {
                                role: "USER",
                                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school,
                                include: "activeCourses",
                                flags: fullCourse ? [] : ["includeIdsAndNamesOnly"],
                                cacheBust: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.username
                            })];
                    case 1:
                        schools = _a.sent();
                        activeCourses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.activeCourses; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        return [2 /*return*/, activeCourses];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listEDSCourses = function () {
        var periodName = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__["EDSPeriod"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_7___default()())).period;
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.indexOf('EMPLOYEE') === -1 ?
            // STUDENTs should, by default, only show courses that is listed in EDS
            _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].edsClient.getActiveCourses({ periodName: periodName }) :
            // EMPLOYEEs should, by default, show all courses on school - no need to query EDS
            null;
    };
    HiddenCoursesRepo.prototype.createCoursesList = function (edsActiveCourses, userHiddenCourses, activeCourses) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var hiddenCoursesMap, visibleCoursesMap, isStudent, edsCourseMap, edsCourseMapFullName, result;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        hiddenCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return !hc.show; }), function (hc) { return hc.name; });
                        visibleCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return hc.show; }), function (hc) { return hc.name; });
                        isStudent = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.some(function (role) { return role === 'STUDENT'; });
                        edsCourseMap = edsActiveCourses ?
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(edsActiveCourses, function (c) { return c.name.substr(0, 20); }) :
                            {};
                        edsCourseMapFullName = edsActiveCourses ?
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(edsActiveCourses, function (c) { return c.name.substr(0, 20); }) :
                            {};
                        return [4 /*yield*/, Promise.all(activeCourses.map(function (_a) {
                                var id = _a.id, name = _a.name, description = _a.description, modifiedBy = _a.modifiedBy;
                                return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                                    var edsCourse, defaultVisible, visible, fullCourse;
                                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                        switch (_b.label) {
                                            case 0:
                                                edsCourse = edsCourseMap[name.substr(0, 20)];
                                                defaultVisible = isStudent ?
                                                    edsCourse != null : // Course name also listed in EDS
                                                    true;
                                                visible = defaultVisible ?
                                                    !hiddenCoursesMap[id] : // Visible unless user has overridden that.
                                                    !!visibleCoursesMap[id];
                                                if (!(!this.fullCourse && name.length >= 20)) return [3 /*break*/, 2];
                                                if (!visible) return [3 /*break*/, 2];
                                                return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get("courses", id)];
                                            case 1:
                                                fullCourse = _b.sent();
                                                name = fullCourse.name;
                                                _b.label = 2;
                                            case 2:
                                                // We may in error have set the course as visible due to long name. Now correct that.
                                                edsCourse = edsCourseMapFullName[name]; // Name is now full name
                                                defaultVisible = isStudent ?
                                                    edsCourse != null :
                                                    true;
                                                visible = defaultVisible ?
                                                    !hiddenCoursesMap[id] : // Visible unless user has overridden that.
                                                    !!visibleCoursesMap[id]; // Hidden unless user has overridden that.
                                                // Resolve description:
                                                if (modifiedBy && modifiedBy.name && !description) {
                                                    description = modifiedBy.name + "s version";
                                                }
                                                return [2 /*return*/, {
                                                        id: id,
                                                        name: name,
                                                        description: description,
                                                        visible: visible,
                                                        defaultVisible: defaultVisible
                                                    }];
                                        }
                                    });
                                });
                            }))];
                    case 1:
                        result = _a.sent();
                        return [2 /*return*/, result.sort(function (_a, _b) {
                                var a = _a.name;
                                var b = _b.name;
                                return a < b ? -1 : a > b ? 1 : 0;
                            })];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.hideCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                    name: c.id
                                }])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.showCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.insert([{
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                name: c.id,
                                show: true
                            }])];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.subscribe = function (subscriber, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, activeCourses, edsActiveCourses, userHiddenCourses, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!(!this.fullCourse && options.fullCourse)) return [3 /*break*/, 3];
                        // The subscriber demands full courses
                        // Need to query that before notifying
                        // Also affect state for future internal notification
                        this.fullCourse = options.fullCourse;
                        this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses
                        return [4 /*yield*/, Promise.all([
                                this.kedCoursesPromise,
                                this.edsCoursesPromise,
                                this.userHiddenCoursesPromise
                            ])];
                    case 1:
                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 3]), activeCourses = _a[0], edsActiveCourses = _a[1], userHiddenCourses = _a[2];
                        // Assemble result:
                        _b = this;
                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                    case 2:
                        // Assemble result:
                        _b.result = _c.sent();
                        _c.label = 3;
                    case 3: return [4 /*yield*/, this.userHiddenCoursesPromise];
                    case 4:
                        _c.sent(); // So we know that this.result is there.
                        this.notifySubscriber(subscriber, options);
                        this.subscribers.push({ subscriber: subscriber, options: options });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s.subscriber !== subscriber; });
    };
    return HiddenCoursesRepo;
}());
if (!hiddenCoursesRepo) {
    hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo = new HiddenCoursesRepo();
}


/***/ }),

/***/ "./src/repos/ked-repo.ts":
/*!*******************************!*\
  !*** ./src/repos/ked-repo.ts ***!
  \*******************************/
/*! exports provided: KedRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedRepo", function() { return KedRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");



var KedRepo = /** @class */ (function () {
    function KedRepo(options) {
        var _this = this;
        var table = options.table, getClient = options.getClient, getQueryOptions = options.getQueryOptions;
        this.mem = new _repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]({ query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var queryOptions;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, getQueryOptions()];
                        case 1:
                            queryOptions = _a.sent();
                            return [4 /*yield*/, getClient().list(table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, queryOptions, { cacheBust: this.getCacheBust() }))];
                        case 2: return [2 /*return*/, _a.sent()];
                    }
                });
            }); } });
        this.options = options;
    }
    KedRepo.prototype.getCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);
        return cacheBust || this.regenerateCacheBust();
    };
    KedRepo.prototype.regenerateCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
        localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);
        return cacheBust;
    };
    KedRepo.prototype.upsert = function (item, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItem;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!!item.$etag) return [3 /*break*/, 2];
                        updatedItem = Object.assign({}, item);
                        updater(updatedItem);
                        return [4 /*yield*/, this.insert([updatedItem])];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2: 
                    // We have an $etag, so we can expect it to live on the server.
                    // However, take care of the unlikely situation that it was deleted from server,
                    // and if so, insert it again.
                    return [4 /*yield*/, this.update([item], updater).catch(function (e) {
                            if (e.name === "http404") {
                                var updatedItem = Object.assign({}, item);
                                updater(updatedItem);
                                return _this.insert([updatedItem]);
                            }
                            return Promise.reject(e);
                        })];
                    case 3:
                        // We have an $etag, so we can expect it to live on the server.
                        // However, take care of the unlikely situation that it was deleted from server,
                        // and if so, insert it again.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.update = function (items, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItems, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItems = items.map(function (item) {
                            var memRepoItem = _this.mem.items.find(function (it) { return it.id === item.id; });
                            item = Object.assign({}, memRepoItem || item);
                            updater(item);
                            return item;
                        });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(modifiedItems.map(function (x) { return Object.assign({}, x, { $meta: 'updating' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); })
                            .catch(function (e) { return e.name === "http409" ? // conflict
                            // Get a fresh version from server:
                            client.list(table, { ids: items.map(function (item) { return item.id; }) }, { cache: 'no-cache' }).then(function (freshItems) {
                                // Update local version:
                                var modifiedItems = freshItems.map(function (freshItem) {
                                    // Clone the fresh item
                                    var modified = Object.assign({}, freshItem);
                                    // Re-run the updater on the clone:
                                    updater(modified);
                                    return modified;
                                });
                                // Re-do the the put operation towards the server.
                                return client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); });
                            }) :
                            // Other unexpected error:
                            Promise.resolve(optimistic &&
                                _this.mem.update(items)) // Undo optimistic update
                                .then(function () {
                                return Promise.reject(e); // Reject with the error no matter.
                            }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        modifiedItems.forEach(function (item) {
                            item.$etag = res.newEtags[item.id];
                            item.$meta = undefined;
                        });
                        return [4 /*yield*/, this.mem.update(modifiedItems)];
                    case 4:
                        _b.sent(); // Ensures new etag is is applied on next action.
                        return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.stripGraphs = function (items, graphs) {
        return items.map(function (item) {
            var clone = Object.assign({}, item);
            graphs.forEach(function (graph) {
                if (item[graph]) {
                    clone[graph] = item[graph].map(function (doc) { return ({ id: doc.id }); });
                }
            });
            return clone;
        });
    };
    KedRepo.prototype.insert = function (items) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_1, _a, _b, getClient, optimistic, table, getQueryOptions, client, queryOptions, graphs, stripped, br, _loop_1, stripped_1, stripped_1_1, item, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _b = this.options, getClient = _b.getClient, optimistic = _b.optimistic, table = _b.table, getQueryOptions = _b.getQueryOptions;
                        client = getClient();
                        return [4 /*yield*/, getQueryOptions()];
                    case 1:
                        queryOptions = _c.sent();
                        graphs = [].concat(queryOptions.include);
                        // Give IDs to each item:
                        items = items.map(function (item) { return item.id ? item : Object.assign({}, item, { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])() }); });
                        stripped = this.stripGraphs(items, graphs);
                        if (!optimistic) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.mem.insert(stripped.map(function (x) { return Object.assign({}, x, { $meta: 'adding' }); }))];
                    case 2:
                        _c.sent();
                        _c.label = 3;
                    case 3:
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
                        _loop_1 = function (item) {
                            var e_2, _a;
                            var _loop_2 = function (graph) {
                                var foreignItems = item[graph];
                                if (foreignItems) {
                                    foreignItems.forEach(function (doc) {
                                        br.link2(table, item.id, graph, doc.id);
                                    });
                                }
                            };
                            try {
                                // Also add links to all foreign related items:
                                for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
                                    var graph = graphs_1_1.value;
                                    _loop_2(graph);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                            br.add(table, item);
                        };
                        try {
                            for (stripped_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](stripped), stripped_1_1 = stripped_1.next(); !stripped_1_1.done; stripped_1_1 = stripped_1.next()) {
                                item = stripped_1_1.value;
                                _loop_1(item);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (stripped_1_1 && !stripped_1_1.done && (_a = stripped_1.return)) _a.call(stripped_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        return [4 /*yield*/, client.batch(br.mutationRequests).catch(function (e) {
                                if (optimistic)
                                    _this.mem.delete(items.map(function (item) { return item.id; }));
                                return Promise.reject(e);
                            })];
                    case 4:
                        res = _c.sent();
                        this.regenerateCacheBust();
                        items.forEach(function (item) { return item.$etag = res.newEtags[item.id]; });
                        if (!optimistic) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.mem.update(items)];
                    case 5:
                        _c.sent(); // Update with new $etag.
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.mem.insert(items)];
                    case 7:
                        _c.sent();
                        _c.label = 8;
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.delete = function (ids) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(ids
                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                .filter(function (x) { return x; })
                                .map(function (x) { return Object.assign({}, x, { $meta: 'deleting' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return ids.forEach(function (id) { return br.delete(table, id); }); }).catch(function (e) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        if (!optimistic) return [3 /*break*/, 2];
                                        return [4 /*yield*/, this.mem.update(ids
                                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                                .filter(function (x) { return x; })
                                                .map(function (x) {
                                                x = Object.assign({}, x);
                                                delete x.$meta;
                                                return x;
                                            }))];
                                    case 1:
                                        _a.sent();
                                        _a.label = 2;
                                    case 2: throw e;
                                }
                            });
                        }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        return [4 /*yield*/, this.mem.delete(ids)];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedRepo;
}());



/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/user-tasks-repo.ts":
/*!**************************************!*\
  !*** ./src/repos/user-tasks-repo.ts ***!
  \**************************************/
/*! exports provided: userTasksRepo, UserTasksRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "userTasksRepo", function() { return userTasksRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksRepo", function() { return UserTasksRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/weekplanner/weekplanner-persisted-state */ "./src/components/weekplanner/weekplanner-persisted-state.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/weekutil */ "./src/utils/weekutil.ts");







var userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo;
var UserTasksRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksRepo, _super);
    function UserTasksRepo(getClient, getCurrentUser) {
        var _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "usertasks",
            user: getCurrentUser() ? getCurrentUser().mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var currentUser, userEmail, _a, weekDate, weekNumber, kedWeek;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            currentUser = getCurrentUser();
                            userEmail = currentUser ? currentUser.mail : "";
                            if (!!this.persistedState) return [3 /*break*/, 2];
                            _a = this;
                            return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(userEmail)];
                        case 1:
                            _a.persistedState = _b.sent();
                            _b.label = 2;
                        case 2:
                            weekDate = this.persistedState.weekDate;
                            weekNumber = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).week();
                            kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_6__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).year(), weekNumber);
                            /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]
                              .map(m => m.toDate().getTime());*/
                            return [2 /*return*/, {
                                    from: kedWeek.notBefore,
                                    to: kedWeek.notAfter,
                                    role: "USER",
                                    include: ["task", "course"],
                                    flags: ["includeIdsOnly"],
                                }];
                    }
                });
            }); }
        }) || this;
        _this.persistedState = null;
        _this.getCurrentUser = getCurrentUser;
        return _this;
    }
    UserTasksRepo.prototype.updatePersistedState = function (stateChanges) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object.assign(this.persistedState, stateChanges);
                        return [4 /*yield*/, this.persistedState.save()];
                    case 1:
                        _a.sent();
                        this.mem.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setTaskDoneState = function (userTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItem, similarTasks, identicalTasks;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItem = Object.assign({}, userTask, { done: done });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(Object.assign({}, modifiedItem, { $meta: 'updating' }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.list('usertasks', {
                            name: userTask.name,
                            role: "USER",
                            include: ["task", "course"],
                            flags: ["includeIdsOnly"],
                            from: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),
                            to: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(3, 'weeks').valueOf()
                        }, {
                            cache: 'no-cache'
                        })];
                    case 3:
                        similarTasks = _b.sent();
                        identicalTasks = similarTasks.filter(function (t) {
                            return t.courseName === userTask.courseName &&
                                t.learningGoal === userTask.learningGoal &&
                                (!userTask.task || t.task.map(function (t) { return t.id; }).join('') === userTask.task.map(function (t) { return t.id; }).join('')) &&
                                (!userTask.course || t.course.map(function (c) { return c.id; }).join('') === userTask.course.map(function (c) { return c.id; }).join(''));
                        });
                        if (identicalTasks.length === 0) {
                            // Workaround for issue in SubjectPlanner migration (usertasks with long names is not found)
                            identicalTasks.push(userTask);
                        }
                        return [4 /*yield*/, this.update(identicalTasks, function (t) { return t.done = done; })];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setSubTaskDoneState = function (userTask, subTaskId, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        return [4 /*yield*/, this.update([userTask], function (t) { return t.subTasks && t.subTasks.filter(function (st) { return st.id === subTaskId; })
                                .forEach(function (st) { return st.done = done; }); })];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setWeekPlannerBoxOpen = function (courseName, isOpen) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var openCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        openCourses = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.persistedState.openCourses);
                        if (isOpen)
                            openCourses[courseName] = true;
                        else
                            delete openCourses[courseName];
                        return [4 /*yield*/, this.updatePersistedState({ openCourses: openCourses })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.changeWeek = function (weekDate) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedState, newPersisted;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        persistedState = this.persistedState;
                        if (!!persistedState) return [3 /*break*/, 2];
                        return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(this.options.user)];
                    case 1:
                        persistedState = _a.sent();
                        _a.label = 2;
                    case 2:
                        newPersisted = new _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"](persistedState);
                        newPersisted.weekDate = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).startOf('week').valueOf();
                        newPersisted.save();
                        this.persistedState = newPersisted;
                        return [4 /*yield*/, this.mem.refreshFromServer()];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.subscribe = function (subscriber) {
        var _this = this;
        var proxySubscriber = function (userTasks) {
            subscriber(userTasks.filter(function (ut) { return !ut.weekTexts; }), _this.persistedState, userTasks.filter(function (ut) { return !!ut.weekTexts; })[0] || {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                dateTime: _this.persistedState.weekDate,
                weekTexts: { assessment: '', strategy: '' },
                acl: [
                    // Default ACL: Let user self have full control over this item:
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("email", _this.getCurrentUser().mail, "S"),
                    // Additional ACL: Let employees on same school have read access to it.
                    // This currently only applies to tasks that refer to course tasks (not own tasks!)
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", _this.getCurrentUser().school + "/EMPLOYEE", "R")
                ].map(function (ac) { return ac.toString(); })
            });
        };
        proxySubscriber["subscriber"] = subscriber;
        this.mem.subscribe(proxySubscriber);
    };
    UserTasksRepo.prototype.unsubscribe = function (subscriber) {
        this.mem.subscribers = this.mem.subscribers.filter(function (s) { return s["subscriber"] !== subscriber; });
    };
    return UserTasksRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

if (!userTasksRepo) {
    userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo = new UserTasksRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser; });
    userTasksRepo.mem.ensureHasData();
}


/***/ }),

/***/ "./src/test/data/users.ts":
/*!********************************!*\
  !*** ./src/test/data/users.ts ***!
  \********************************/
/*! exports provided: users */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "users", function() { return users; });
var users = [{
        displayName: "Administratör",
        mail: "vemendo@kedschools.com",
        roles: ['ADMIN', 'EMPLOYEE'],
        school: 'KED',
        username: "admin"
    }, {
        displayName: "David",
        mail: "david.fahlander@vemendo.se",
        roles: ['ADMIN', 'EMPLOYEE'],
        school: 'KED',
        username: "david"
    }, {
        displayName: "Test-Live-Elev1",
        mail: "ubw6757@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "ubw6757@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev2",
        mail: "ums4302@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "ums4302@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev3",
        mail: "uhh3460@edu.kunskapsgymnasiet.se",
        roles: ['STUDENT'],
        school: 'Uppsala',
        username: "uhh3460@edu.kunskapsgymnasiet.se"
    }, {
        displayName: "Test-Live-Elev4(fel goals issue)",
        mail: "umt6826@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "umt6826@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Elev5(future abilities)",
        mail: "ujg3833@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "ujg3833@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Elev6(future abilities)",
        mail: "ujt1363@edu.kunskapsskolan.se",
        roles: ["STUDENT"],
        school: "Uppsala",
        username: "ujt1363@edu.kunskapsskolan.se"
    }, {
        displayName: "Test-Live-Lärare1",
        mail: "rickard.albertsson@kunskapsgymnasiet.se",
        roles: ['EMPLOYEE'],
        school: 'Uppsala',
        username: "rickard.albertsson@kunskapsgymnasiet.se"
    }, {
        displayName: "EDSTestUserGymnasium",
        mail: "uhh3200@edu.kunskapsgymnasiet.se",
        //mail: "UHH3200@EDU.KUNSKAPSGYMNASIET.SE",
        roles: ["STUDENT"],
        username: "EDSTestUser1",
        school: "KED",
        schoolType: "Gymnasium"
    }, {
        displayName: "vemendo.elev@kedschools.com",
        mail: "vemendo.elev@kedschools.com",
        roles: ["STUDENT"],
        username: "vemendo.elev@kedschools.com",
        school: "KED",
        schoolType: "Gymnasium"
    }, {
        displayName: "Medarbetare Nacka",
        mail: "medarbetare.nacka@kunskapsskolan.se",
        roles: ["EMPLOYEE"],
        username: "medarbetare.nacka/KS",
        school: "Nacka",
        schoolType: "Grundskolor"
    }, {
        displayName: "Medarbetare Globen",
        mail: "medarbetare.globen@kunskapsgymnasiet.se",
        roles: ["EMPLOYEE"],
        username: "medarbetare.globen/KS",
        school: "Globen",
        schoolType: "Gymnasium"
    }, {
        displayName: "Elev Globen",
        mail: "elev.globen@edu.kunskapsgymnasiet.se",
        schoolGrade: 2,
        roles: ['STUDENT'],
        username: "elev.globen",
        school: "Globen",
        schoolType: "Gymnasium"
    }, {
        displayName: "Elev Borås",
        mail: "elev.boras@edu.kunskapsskolan.se",
        schoolGrade: 7,
        roles: ['STUDENT'],
        username: "elev.boras",
        school: "Borås",
        schoolType: "Grundskolor"
    }, {
        displayName: "Elev Borlänge",
        mail: "elev.borlange@edu.kunskapsskolan.se",
        schoolGrade: 9,
        roles: ['STUDENT'],
        username: 'elev.borlange/KS',
        school: 'Borlänge',
        schoolType: "Gymnasium"
    }, {
        displayName: "Roll-lös",
        mail: "none@kunskapsskolan.se",
        username: "none",
        roles: []
    }];


/***/ }),

/***/ "./src/test/set-current-user.ts":
/*!**************************************!*\
  !*** ./src/test/set-current-user.ts ***!
  \**************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _data_users__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data/users */ "./src/test/data/users.ts");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");



var username = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_2__["parseQueryString"])(location.search).user;
if (username) {
    var user = _data_users__WEBPACK_IMPORTED_MODULE_1__["users"].find(function (u) { return u.username === username; });
    if (user) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser = user;
    }
}
var _a = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_2__["parseQueryString"])(location.search), role = _a.role, school = _a.school;
if (_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser) {
    if (role) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles = role.split(',');
    }
    if (school) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school = school;
    }
}


/***/ }),

/***/ "./src/test/testpage-courseviewer.tsx":
/*!********************************************!*\
  !*** ./src/test/testpage-courseviewer.tsx ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _set_current_user__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-current-user */ "./src/test/set-current-user.ts");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _utils_choose_user__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils/choose-user */ "./src/test/utils/choose-user.tsx");
/* harmony import */ var _components_course_viewer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/course-viewer */ "./src/components/course-viewer/index.tsx");
/* harmony import */ var _utils_include_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./utils/include-css */ "./src/test/utils/include-css.ts");
/* harmony import */ var _utils_include_optional_css__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utils/include-optional-css */ "./src/utils/include-optional-css.ts");

// <Initialization>
 // Emulate server-side script to set current user
 // Client-side initialization
// </Initialization>






Object(_utils_include_optional_css__WEBPACK_IMPORTED_MODULE_8__["includeOptionalCSS"])({
    v1: [
        'css/courseviewer.css',
        'css/dialog.css',
        'css/grid-css-patch.css'
    ],
    includeCSS: _utils_include_css__WEBPACK_IMPORTED_MODULE_7__["includeCSS"],
    version: 6,
    versionFolder: 'css/delta-css/courseviewer'
});
var App = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](App, _super);
    function App() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    App.prototype.render = function () {
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser ?
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_course_viewer__WEBPACK_IMPORTED_MODULE_6__["CourseViewer"], { courseBuilderUrl: "coursebuilder.html" }) :
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_utils_choose_user__WEBPACK_IMPORTED_MODULE_5__["ChooseUser"], null);
    };
    return App;
}(react__WEBPACK_IMPORTED_MODULE_4__["Component"]));
/* harmony default export */ __webpack_exports__["default"] = (App);


/***/ }),

/***/ "./src/test/utils/choose-user.tsx":
/*!****************************************!*\
  !*** ./src/test/utils/choose-user.tsx ***!
  \****************************************/
/*! exports provided: ChooseUser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChooseUser", function() { return ChooseUser; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _data_users__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data/users */ "./src/test/data/users.ts");


function ChooseUser() {
    var select;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "V\u00E4lj anv\u00E4ndare"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("table", { className: "login-table" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("thead", null,
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", null,
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Namn"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Roller"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "E-post"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("th", null, "Skola"))),
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tbody", null, _data_users__WEBPACK_IMPORTED_MODULE_1__["users"].map(function (_a) {
                var username = _a.username, displayName = _a.displayName, mail = _a.mail, school = _a.school, roles = _a.roles;
                return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", { key: mail, onClick: function () { return location.search = "?user=" + username; } },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, displayName),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", { style: roles.length === 0 ? { fontStyle: 'italic' } : {} }, roles.length === 0 ? "saknar roller" : roles.join(', ')),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, mail),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", { style: school ? {} : { fontStyle: 'italic' } }, school || "saknar skola"));
            }))));
}
;


/***/ }),

/***/ "./src/test/utils/include-css.ts":
/*!***************************************!*\
  !*** ./src/test/utils/include-css.ts ***!
  \***************************************/
/*! exports provided: includeCSS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "includeCSS", function() { return includeCSS; });
function resolve(uri) {
    var href = location.protocol + "//" + location.host + location.pathname;
    var pLastSlash = href.lastIndexOf('/');
    return href.substr(0, pLastSlash + 1) + uri;
}
function includeCSS(cssFile) {
    document.write('<link rel="stylesheet" href="' + resolve(cssFile) + '" />');
}


/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 2)
                infos = infos.slice(1);
            return {
                infos: infos.concat(message)
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/include-optional-css.ts":
/*!*******************************************!*\
  !*** ./src/utils/include-optional-css.ts ***!
  \*******************************************/
/*! exports provided: includeOptionalCSS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "includeOptionalCSS", function() { return includeOptionalCSS; });
function includeOptionalCSS(_a) {
    var v1 = _a.v1, versionFolder = _a.versionFolder, version = _a.version, includeCSS = _a.includeCSS, NOCSS = _a.NOCSS;
    if (!NOCSS) {
        if (v1)
            v1.forEach(function (cssFile) { return includeCSS(cssFile); });
    }
    var cssVer = parseInt(NOCSS);
    if (isNaN(cssVer))
        cssVer = 1;
    for (var ver = cssVer + 1; ver <= version; ++ver) {
        includeCSS(versionFolder + "/v" + ver + ".css");
    }
}


/***/ }),

/***/ "./src/utils/pending-job.ts":
/*!**********************************!*\
  !*** ./src/utils/pending-job.ts ***!
  \**********************************/
/*! exports provided: PendingJob */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PendingJob", function() { return PendingJob; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var PendingJob = /** @class */ (function () {
    function PendingJob(callback) {
        this.timeoutId = null;
        this.cancelled = false;
        this.pending = false;
        this.isJobExecuting = false;
        this.jobCallback = callback;
    }
    PendingJob.prototype.triggerChange = function (throttle) {
        var _this = this;
        if (this.cancelled)
            return;
        this.pending = true;
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = setTimeout(function () { return _this.launchJob(); }, throttle);
    };
    PendingJob.prototype.stop = function () {
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = null;
        this.cancelled = true;
    };
    PendingJob.prototype.launchJob = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.cancelled)
                            return [2 /*return*/];
                        if (!this.pending)
                            return [2 /*return*/];
                        if (this.isJobExecuting)
                            return [2 /*return*/];
                        this.timeoutId = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        this.isJobExecuting = true;
                        this.pending = false;
                        return [4 /*yield*/, this.jobCallback()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.isJobExecuting = false;
                        return [7 /*endfinally*/];
                    case 4:
                        if (!this.pending) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.launchJob()];
                    case 5:
                        _a.sent();
                        _a.label = 6;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    return PendingJob;
}());



/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStartAndEnd, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStartAndEnd", function() { return getTermStartAndEnd; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
function getTermStartAndEnd(now) {
    return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 7, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 11, 31))] : // aug1 - dec31
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 0, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 6, 31))]; // jan1 - july31
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6;
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");



function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_1___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (locales, shortYear) {
        var e_1, _a;
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        try {
            for (var locales_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](locales), locales_1_1 = locales_1.next(); !locales_1_1.done; locales_1_1 = locales_1.next()) {
                var locale = locales_1_1.value;
                switch (locale.split('-')[0].split('_')[0].toLowerCase()) {
                    case 'en':
                        return (this.term === 'AT' ? "AT" : "ST") + " " + year;
                    case 'sv':
                        return (this.term === 'AT' ? "HT" : "VT") + " " + year;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (locales_1_1 && !locales_1_1.done && (_a = locales_1.return)) _a.call(locales_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        if (firstA == null)
            return -1;
        var firstB = b[firstPart];
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/utils/weekutil.ts":
/*!*******************************!*\
  !*** ./src/utils/weekutil.ts ***!
  \*******************************/
/*! exports provided: KEDWeek, getAdjustedWeek */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDWeek", function() { return KEDWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAdjustedWeek", function() { return getAdjustedWeek; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

function KEDWeek(year, week) {
    var m = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(year, 1, 1)).locale('sv').week(week);
    var res = {
        year: year,
        week: week,
        notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),
        notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()
    };
    return res;
}
function getAdjustedWeek(m) {
    var clone = m.clone().locale('sv');
    return m.weekday() >= 5 ? // Lördag 00:00 / Söndag 00:00?
        m.week() + 1 : // Tillhör nästa vecka
        m.week();
}
/*export function getWeekLimits (m: Moment) {
  const clonedSwedish = m.clone().locale('sv');
  const limits = {
    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),
    notAfter: clonedSwedish.startOf('week').add(5, 'days')
  };
}
*/


/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvY2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2NsaWVudHdlYi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2hhc2gtcmVzdG9yZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2h0dHAtZXJyb3IuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC9yZXN0Y2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2tlZGJhY2tlbmQtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1yZXBvLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL211dGF0aW9uLXF1ZXVlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9xdWVyeS1zZXQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtY291cnNlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9jb2xsZWN0aW9uLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9taXhpbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvb2JzZXJ2YWJsZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHN2fGVuIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9nZXQtdXNlci1jbGFpbXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2Vkc2NsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9jb3Vyc2UtbmFtZS10by1jc3MtY2xhc3MudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvaXMtZW1wbG95ZWUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvY291cnNlLWJhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS9jb3Vyc2UtbW9kdWxlLXBhZ2UudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvZ2V0LWN1c3RvbWl6ZWQtdGFzay50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL3J1bi11cC1wYWdlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL3Rhc2stYXNzaWdubWVudHMudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvdGFzay1wYWdlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL3Vya3VuZC11dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvYWJpbGl0aWVzLWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL2NlbnRyYWwtY29udGVudC1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9jb25maXJtYXRpb24udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9rbm93bGVkZ2UtcmVxdWlyZW1lbnRzLXRhYmxlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvbGVhcm5pbmctZ29hbHMtbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL3Jlc291cmNlLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy90YXNrLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvdXRpbHMvZ2V0LWluY2x1ZGVkLWlkcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3V0aWxzL21hbnVhbC1zY3JvbGwtcmVzdG9yYXRpb24udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvbGlzdC1jb3Vyc2VzL2xpc3QtY291cnNlcy1wYWdlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9saXN0LWNvdXJzZXMvbGlzdC1jb3Vyc2VzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZGlhbG9ncy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dGFyZWEudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2FkZC1jdXN0b20tZ29hbC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvYWRkLWN1c3RvbS10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9hZGQtb3ItZWRpdC1zdWItdGFzay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvZWRpdC11c2VyLXRhc2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2dldC10YXNrLXR5cGUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvcmVmaW5lci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci91c2VyLXRhc2tzLWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL3dlZWtwbGFubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZmVhdHVyZXMvZmVhdHVyZXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2ZlYXR1cmVzL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9jb25maWd1cmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1iZWFyZXItcHJvdmlkZXJzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtZWRzLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWtlZC1iYWNrZW5kLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuY2ZnLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC5lbnYudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL2RiLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL2tlZC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy9oaWRkZW4tY291cnNlcy1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy9rZWQtcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3MvcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3MvdXNlci10YXNrcy1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy90ZXN0L2RhdGEvdXNlcnMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3Rlc3Qvc2V0LWN1cnJlbnQtdXNlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdGVzdC90ZXN0cGFnZS1jb3Vyc2V2aWV3ZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy90ZXN0L3V0aWxzL2Nob29zZS11c2VyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdGVzdC91dGlscy9pbmNsdWRlLWNzcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvZXJyb3Itc3VjY2Vzcy1mZWVkYmFjay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2luY2x1ZGUtb3B0aW9uYWwtY3NzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9wZW5kaW5nLWpvYi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcXVlcnktc3RyaW5nLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9zY2hvb2wtbW9tZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9zY2hvb2wtdGVybS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3dlZWt1dGlsLnRzIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcImpRdWVyeVwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0XCIiLCJ3ZWJwYWNrOi8vW25hbWVdL2V4dGVybmFsIFwiUmVhY3RET01cIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0JBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQWlCLDRCQUE0QjtBQUM3QztBQUNBO0FBQ0EsMEJBQWtCLDJCQUEyQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrREFBMEMsZ0NBQWdDO0FBQzFFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0VBQXdELGtCQUFrQjtBQUMxRTtBQUNBLHlEQUFpRCxjQUFjO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBeUMsaUNBQWlDO0FBQzFFLHdIQUFnSCxtQkFBbUIsRUFBRTtBQUNySTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7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RSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLE9BQU8sRUFBRTtLQUN0RSxDQUFDO0lBQ0YsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDO0FBRU0sU0FBUyxlQUFlLENBQUMsQ0FBUztJQUN2QyxJQUFNLEtBQUssR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsK0JBQStCO1FBQ3JELENBQUMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLHNCQUFzQjtRQUNyQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDZixDQUFDO0FBRUQ7Ozs7Ozs7RUFPRTs7Ozs7Ozs7Ozs7O0FDM0JGLHdCOzs7Ozs7Ozs7OztBQ0FBLHVCOzs7Ozs7Ozs7OztBQ0FBLDBCIiwiZmlsZSI6InRlc3RwYWdlY291cnNldmlld2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJ0ZXN0cGFnZWNvdXJzZXZpZXdlclwiOiAwXG4gXHR9O1xuXG4gXHR2YXIgZGVmZXJyZWRNb2R1bGVzID0gW107XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wX25hbWVfXCJdID0gd2luZG93W1wid2VicGFja0pzb25wX25hbWVfXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBhZGQgZW50cnkgbW9kdWxlIHRvIGRlZmVycmVkIGxpc3RcbiBcdGRlZmVycmVkTW9kdWxlcy5wdXNoKFtcIi4vc3JjL3Rlc3QvdGVzdHBhZ2UtY291cnNldmlld2VyLnRzeFwiLFwidmVuZG9yc1wiXSk7XG4gXHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIHJlYWR5XG4gXHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiIsImV4cG9ydCAqIGZyb20gJy4vanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQnOyIsImV4cG9ydCAqIGZyb20gJy4vanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViJzsiLCJ2YXIgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZSgpIHtcbiAgICB9XG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGlkLCB0b2tlbkluZm8pIHtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcImJlYXJlci1cIiArIGlkLCBKU09OLnN0cmluZ2lmeSh0b2tlbkluZm8pKTtcbiAgICB9O1xuICAgIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGpzb24gPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShqc29uID8gSlNPTi5wYXJzZShqc29uKSA6IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2U7XG59KCkpO1xuZXhwb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1iZWFyZXItc3RvcmFnZS1zZXNzaW9uc3RvcmFnZS5qcy5tYXAiLCJ2YXIgcmVkaXJIYXNoID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInJlZGlyLWhhc2hcIik7XG5pZiAocmVkaXJIYXNoKVxuICAgIHRyeSB7XG4gICAgICAgIHZhciBfYSA9IEpTT04ucGFyc2UocmVkaXJIYXNoKSwgdGltZSA9IF9hLnRpbWUsIGhhc2ggPSBfYS5oYXNoO1xuICAgICAgICBpZiAodGltZSAmJiB0aW1lID4gRGF0ZS5ub3coKSAtIDYwMDAwKSB7XG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFwicmVkaXItaGFzaFwiKTtcbiAgICAgICAgICAgIGxvY2F0aW9uLmhhc2ggPSBoYXNoO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChfKSB7IH1cbmV4cG9ydCBmdW5jdGlvbiByZW1lbWJlckhhc2hMb2NhdGlvbigpIHtcbiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwicmVkaXItaGFzaFwiLCBKU09OLnN0cmluZ2lmeSh7IHRpbWU6IERhdGUubm93KCksIGhhc2g6IGxvY2F0aW9uLmhhc2ggfSkpO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aGFzaC1yZXN0b3Jlci5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCwgSHR0cEVycm9yIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZSB9IGZyb20gXCIuL2JlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlXCI7XG5pbXBvcnQgeyBhdm9pZFNpbXVsdGFub3VzQ2FsbHMgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQvdXRpbHMnO1xuaW1wb3J0IHsgS2VkTW9kZWxNaWdyYXRvck1peGluIH0gZnJvbSAnLi4va2VkLW1vZGVsLW1pZ3JhdG9yJztcbmltcG9ydCAnLi9oYXNoLXJlc3RvcmVyJztcbmltcG9ydCB7IHJlbWVtYmVySGFzaExvY2F0aW9uIH0gZnJvbSAnLi9oYXNoLXJlc3RvcmVyJztcbktlZE1vZGVsTWlncmF0b3JNaXhpbihLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZSk7XG5leHBvcnQgdmFyIHN0b3JhZ2UgPSBuZXcgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCk7XG52YXIgdGltZU9mUGFnZUxvYWQgPSBEYXRlLm5vdygpO1xudmFyIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKHRva2VuUGF0aCwgdG9rZW5SZXNwb25zZU1hcHBlciwgdG9rZW5JZCkge1xuICAgICAgICB0aGlzLnRva2VuUGF0aCA9IHRva2VuUGF0aDtcbiAgICAgICAgdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyID0gdG9rZW5SZXNwb25zZU1hcHBlcjtcbiAgICAgICAgdGhpcy50b2tlbklkID0gdG9rZW5JZDtcbiAgICAgICAgdGhpcy50b2tlbkluZm8gPSB7IHRva2VuOiBudWxsLCBleHBpcmVzOiAwIH07XG4gICAgICAgIHRoaXMuZ2V0QmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMuZ2V0QmVhcmVyLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnJlZnJlc2hCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5yZWZyZXNoQmVhcmVyLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlci5wcm90b3R5cGUuZ2V0QmVhcmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy50b2tlbkluZm8udG9rZW4pIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRva2VuSWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgc3RvcmFnZS5sb2FkKHRoaXMudG9rZW5JZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50b2tlbkluZm8gPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMudG9rZW5JbmZvLmV4cGlyZXMgPCBEYXRlLm5vdygpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYiwgX2MsIF9kO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGZldGNoKHRoaXMudG9rZW5QYXRoLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBY2NlcHQ6IFwidGV4dC9wbGFpbjsgYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6ICdtYW51YWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlOiAnbm8tY2FjaGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDMwMiB8fCAoIXJlcy5zdGF0dXMgJiYgcmVzLnR5cGUgPT09IFwib3BhcXVlcmVkaXJlY3RcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2VyIHNlc3Npb24gdGltZWQgb3V0IGFuZCBzZXJ2ZXIgd2FudHMgdG8gcmVkaXJlY3QgZW50aXJlIHBhZ2UgdG8gbG9naW4gcGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRpbWUgdG8gcmVsb2FkIGN1cnJlbnQgcGFnZSB0byBmb3JjZSBhIHJlZGlyZWN0IG9mIHRoZSBlbnRpcmUgcGFnZSBpbnN0ZWFkIGZvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgcmVkaXJlY3RpbmcgdG8gL2FwaS90b2tlbiBvciB3aGF0ZXZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHRpbWVPZlBhZ2VMb2FkID4gNjAwMDApIHsgLy8gcHJvaGliaXQgZW5kbGVzcyBsb29wIG9mIHJlbG9hZGluZyBzZWxmLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhbnRzUmVkaXJlY3QgPSB0cnVlOyAvLyBTbyB0aGF0IGxpc3RlbmVycyB0byBvbmJlZm9yZXVubG9hZCBjb3VsZCBzaG93IGFsdGVybmF0ZSBtZXNzYWdlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlZGlyZWN0IHdhbnRlZC4gUmVsb2FkIHBhZ2UuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1lbWJlckhhc2hMb2NhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSHR0cEVycm9yKDMwMiwgXCJSZWRpcmVjdGVkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFwiSFRUUFwiICsgcmVzLnN0YXR1cyArIFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShFcnJvciwgW3ZvaWQgMCwgX2IgKyAoX2Uuc2VudCgpKV0pKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IHRoaXMudG9rZW5SZXNwb25zZU1hcHBlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50b2tlbkluZm8gPSBfZC5hcHBseSh0aGlzLCBbX2Uuc2VudCgpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlLnNhdmUodGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcjtcbn0oKSk7XG5leHBvcnQgeyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlciB9O1xuZXhwb3J0IHZhciBpc29tb3JwaGljID0geyBmZXRjaDogZmV0Y2guYmluZChzZWxmKSwgYnRvYTogYnRvYS5iaW5kKHNlbGYpIH07XG52YXIgS2VkQmFja2VuZENsaWVudFdlYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhLZWRCYWNrZW5kQ2xpZW50V2ViLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDbGllbnRXZWIoYXBpQmFzZVVybCwgcHJvdmlkZXJPclRva2VuUGF0aCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYmVhcmVyUHJvdmlkZXIgPSB0eXBlb2YgcHJvdmlkZXJPclRva2VuUGF0aCAhPT0gJ3N0cmluZycgP1xuICAgICAgICAgICAgcHJvdmlkZXJPclRva2VuUGF0aCA6XG4gICAgICAgICAgICBuZXcgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIocHJvdmlkZXJPclRva2VuUGF0aCwgKG9wdGlvbnMgJiYgb3B0aW9ucy50b2tlblJlc3BvbnNlTWFwcGVyKSB8fCAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuICh7IHRva2VuOiB4LCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDYwIH0pOyB9KSwgb3B0aW9ucyAmJiBvcHRpb25zLnRva2VuSWQpO1xuICAgICAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGlzb21vcnBoaWMsIGJlYXJlclByb3ZpZGVyLCBhcGlCYXNlVXJsKSB8fCB0aGlzO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBLZWRCYWNrZW5kQ2xpZW50V2ViO1xufShLZWRCYWNrZW5kQ2xpZW50KSk7XG5leHBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJ2YXIgRG9jdW1lbnRBY2Nlc3MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRG9jdW1lbnRBY2Nlc3MoYWNjZXNzQ2xhaW1UeXBlLCBhY2Nlc3NDbGFpbVZhbHVlLCByaWdodCkge1xuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVHlwZSA9IGFjY2Vzc0NsYWltVHlwZTtcbiAgICAgICAgdGhpcy5hY2Nlc3NDbGFpbVZhbHVlID0gYWNjZXNzQ2xhaW1WYWx1ZTtcbiAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0O1xuICAgIH1cbiAgICBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nID0gZnVuY3Rpb24gKGFjKSB7XG4gICAgICAgIGlmICghYWMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIHNwbGl0ID0gYWMuc3BsaXQoJzonKTtcbiAgICAgICAgaWYgKHNwbGl0Lmxlbmd0aCA8IDMpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFjY2VzcyBzdHJpbmc6IFwiICsgYWMpO1xuICAgICAgICB2YXIgY2xhaW1UeXBlID0gRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUoc3BsaXRbMF0pO1xuICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IERvY3VtZW50QWNjZXNzLnVuZXNjYXBlKHNwbGl0WzFdKTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gc3BsaXRbMl07XG4gICAgICAgIGlmIChyaWdodCAhPT0gJ1InICYmIHJpZ2h0ICE9PSAnVycgJiYgcmlnaHQgIT09ICdTJylcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRBY2Nlc3MoY2xhaW1UeXBlLCBjbGFpbVZhbHVlLCByaWdodCk7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlL2csIFwiJTI1XCIpLnJlcGxhY2UoL1xcOi9nLCBcIiUzQVwiKTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLnVuZXNjYXBlID0gZnVuY3Rpb24gKGFjY2Vzc0NvbXBvbmVudCkge1xuICAgICAgICByZXR1cm4gYWNjZXNzQ29tcG9uZW50LnJlcGxhY2UoL1xcJTNBL2csIFwiOlwiKS5yZXBsYWNlKC9cXCUyNS9nLCBcIiVcIik7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVR5cGUpICsgXCI6XCIgK1xuICAgICAgICAgICAgRG9jdW1lbnRBY2Nlc3MuZXNjYXBlKHRoaXMuYWNjZXNzQ2xhaW1WYWx1ZSkgKyBcIjpcIiArXG4gICAgICAgICAgICB0aGlzLnJpZ2h0O1xuICAgIH07XG4gICAgRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xuICAgICAgICByZXR1cm4gYWNsXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChhYykgeyByZXR1cm4gRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZyhhYyk7IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChhYykgeyByZXR1cm4gYWM7IH0pO1xuICAgIH07XG4gICAgRG9jdW1lbnRBY2Nlc3MudG9TdHJpbmdBcnJheSA9IGZ1bmN0aW9uIChhY2wpIHtcbiAgICAgICAgcmV0dXJuIGFjbC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBhYy50b1N0cmluZygpOyB9KTtcbiAgICB9O1xuICAgIHJldHVybiBEb2N1bWVudEFjY2Vzcztcbn0oKSk7XG5leHBvcnQgeyBEb2N1bWVudEFjY2VzcyB9O1xuZXhwb3J0IGZ1bmN0aW9uIGhhc0FjY2VzcyhhY2wsIHVzZXJDbGFpbXMsIHJlcXVlc3RlZFJpZ2h0KSB7XG4gICAgaWYgKHVzZXJDbGFpbXMuc29tZShmdW5jdGlvbiAoY2xhaW0pIHsgcmV0dXJuIGNsYWltLnR5cGUgPT09ICdyb2xlJyAmJiBjbGFpbS52YWx1ZSA9PT0gXCJBRE1JTlwiOyB9KSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIGFjbC5zb21lKGZ1bmN0aW9uIChhKSB7XG4gICAgICAgIHJldHVybiB1c2VyQ2xhaW1zLnNvbWUoZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgICAgIHJldHVybiBhLmFjY2Vzc0NsYWltVHlwZSA9PT0gYy50eXBlICYmXG4gICAgICAgICAgICAgICAgYS5hY2Nlc3NDbGFpbVZhbHVlID09PSBjLnZhbHVlICYmICgoYS5yaWdodCA9PT0gJ1InICYmIHJlcXVlc3RlZFJpZ2h0ID09PSAnUicpIHx8XG4gICAgICAgICAgICAgICAgKGEucmlnaHQgPT09ICdXJyAmJiBbJ1InLCAnVyddLmluZGV4T2YocmVxdWVzdGVkUmlnaHQpID49IDApIHx8XG4gICAgICAgICAgICAgICAgKGEucmlnaHQgPT09ICdTJykpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjY2Vzcy1jb250cm9sLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG52YXIgSHR0cEVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEh0dHBFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBIdHRwRXJyb3IoY29kZSwgbWVzc2FnZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBcIkhUVFBcIiArIGNvZGUgKyBcIiBcIiArIG1lc3NhZ2UpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvZGUgPSBjb2RlO1xuICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbiAgICAgICAgX3RoaXMubmFtZSA9IFwiaHR0cFwiICsgY29kZTtcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gSHR0cEVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0IHsgSHR0cEVycm9yIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1odHRwLWVycm9yLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAnLi9yZXN0Y2xpZW50JztcbmV4cG9ydCAqIGZyb20gJy4vdXRpbHMnO1xuZXhwb3J0IHsgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICcuL2tlZC1iZWFyZXItcHJvdmlkZXInO1xuZXhwb3J0ICogZnJvbSAnLi9hY2Nlc3MtY29udHJvbCc7XG5leHBvcnQgeyBSZXN0Q2xpZW50IH07XG5pbXBvcnQgeyBIdHRwRXJyb3IgfSBmcm9tICcuL2h0dHAtZXJyb3InO1xuZXhwb3J0IHsgSHR0cEVycm9yIH07XG5leHBvcnQgKiBmcm9tICcuL3Jlc3RjbGllbnQnO1xuO1xudmFyIEtlZEJhY2tlbmRDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENsaWVudChpc29tb3JwaGljLCBiZWFyZXJQcm92aWRlciwgYmFzZVVybCkge1xuICAgICAgICB0aGlzLmh0dHAgPSBuZXcgUmVzdENsaWVudChpc29tb3JwaGljLCBiYXNlVXJsLCB7IGJlYXJlclByb3ZpZGVyOiBiZWFyZXJQcm92aWRlciB9KTtcbiAgICB9XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0TXlDbGFpbXMgPSBmdW5jdGlvbiAodGFibGUsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwibWUvY2xhaW1zL1wiICsgKHRhYmxlIHx8IFwiXCIpLCBudWxsLCBmZXRjaE9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KHRhYmxlICsgXCIvXCIgKyBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnksIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5tdXRhdGlvbnNPbkVtcHR5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5Lm11dGF0aW9uc09uRW1wdHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmdldChcIlwiICsgdGFibGUsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmJhdGNoID0gZnVuY3Rpb24gKHJlcXMsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVvcmRlciBvcGVyYXRpb25zIHNvIHRoYXQgJ2FkZCdzIGNvbWUgZmlyc3QgYW5kICdkZWxldGUncyBjb21lIGxhc3Q6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXFzID0gcmVxcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKHJlcTEsIHJlcTIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVxMS5vcCA9PT0gJ2FkZCcgPyAtMSA6IHJlcTIub3AgPT09ICdhZGQnID8gMSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcTEub3AgPT09ICdkZWxldGUnID8gMSA6IHJlcTIub3AgPT09ICdkZWxldGUnID8gLTEgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAucG9zdChcImJhdGNoXCIsIHJlcXMsIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZG8gPSBmdW5jdGlvbiAoc2NvcGVGbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBydW5uZXI7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5lciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGVGbihydW5uZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5iYXRjaChydW5uZXIubXV0YXRpb25SZXF1ZXN0cyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmRlbGV0ZVJlYWxtID0gZnVuY3Rpb24gKHJlYWxtKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5kZWxldGUoXCJyZWFsbXMvXCIgKyByZWFsbSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmFkZCh0YWJsZSwgZG9jKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5wdXQodGFibGUsIGRvYyk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVwZGF0ZSh0YWJsZSwgaWQsIGRlbHRhRG9jLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLm1lcmdlKGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuY2xlYXJCcmFuY2goYnJhbmNoSWQpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuZGVsZXRlKHRhYmxlLCBpZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuc2hhcmUodGFibGUsIGlkLCBhY2wpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubGluayhzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rMihzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rMiA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldElkLCBsYWJlbCwgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5saW5rMihzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpOyB9KTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kQ2xpZW50O1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnQgfTtcbnZhciBCYXRjaFJ1bm5lciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCYXRjaFJ1bm5lcigpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzID0gW107XG4gICAgfVxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2FkZCcsIHRhYmxlOiB0YWJsZSwgZG9jOiBkb2MsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MpIHtcbiAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jKTtcbiAgICAgICAgZGVsZXRlIGRvYy5hY2w7IC8vIEZvcmJpZGRlbiB0byBzZW5kIGFjbCB3aXRoIHB1dCgpIGNhbGxzLlxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAncHV0JywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKSB7XG4gICAgICAgIGRlbHRhRG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZGVsdGFEb2MpO1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndXBkYXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQsIGRlbHRhRG9jOiBkZWx0YURvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnbWVyZ2UnLCBicmFuY2hJZDogYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnY2xlYXItYnJhbmNoJywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2RlbGV0ZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnc2hhcmUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgYWNsOiBhY2wgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3Vuc2hhcmUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgYWNsOiBhY2wgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmxpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnbGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCwgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3VubGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRUYWJsZTogdGFyZ2V0VGFibGUsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgcmV0dXJuIEJhdGNoUnVubmVyO1xufSgpKTtcbmV4cG9ydCB7IEJhdGNoUnVubmVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgUmVzdENsaWVudCB9IGZyb20gJy4vcmVzdGNsaWVudCc7XG5pbXBvcnQgeyBhdm9pZFNpbXVsdGFub3VzQ2FsbHMgfSBmcm9tICcuL3V0aWxzJztcbnZhciBLZWRCZWFyZXJQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCZWFyZXJQcm92aWRlcihpc29tb3JwaGljLCBzdG9yYWdlLCB0b2tlbklkLCBjbGllbnRJZCwgY2xpZW50U2VjcmV0LCB0b2tlblVybCwgdG9rZW5RdWVyeSkge1xuICAgICAgICB0aGlzLmlzb21vcnBoaWMgPSBpc29tb3JwaGljO1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gICAgICAgIHRoaXMuY2xpZW50U2VjcmV0ID0gY2xpZW50U2VjcmV0O1xuICAgICAgICB0aGlzLnRva2VuVXJsID0gdG9rZW5Vcmw7XG4gICAgICAgIHRoaXMudG9rZW5RdWVyeSA9IHRva2VuUXVlcnk7XG4gICAgICAgIHRoaXMudG9rZW5JbmZvID0geyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9O1xuICAgICAgICB0aGlzLmNsaWVudCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIFwiXCIsIHtcbiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldEJlYXJlci5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5yZWZyZXNoQmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMucmVmcmVzaEJlYXJlci5iaW5kKHRoaXMpKTtcbiAgICB9XG4gICAgS2VkQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLmdldEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2EsIHRva2VuLCBleHBpcmVzLCBfYiwgZV8xO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMudG9rZW5JbmZvLCB0b2tlbiA9IF9hLnRva2VuLCBleHBpcmVzID0gX2EuZXhwaXJlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbiAmJiBleHBpcmVzID49IERhdGUubm93KCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFsxLCA0LCAsIDZdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuc3RvcmFnZS5sb2FkKHRoaXMuY2xpZW50SWQgKyBcIi9cIiArIHRoaXMudG9rZW5JZCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50b2tlbkluZm8gPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b2tlbkluZm8udG9rZW4gJiYgdGhpcy50b2tlbkluZm8uZXhwaXJlcyA+PSBEYXRlLm5vdygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLnJlZnJlc2hCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgcmV0cmllcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXRyaWVzID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmV0cmllcyA8IDYpKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmV0cmlldmluZyB0b2tlbiBmb3IgXCIgKyB0aGlzLnRva2VuSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGllbnQuZ2V0KHRoaXMudG9rZW5VcmwsIHRoaXMudG9rZW5RdWVyeSwgeyBjYWNoZTogJ3JlbG9hZCcgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiR290IFwiICsgcmVzLnN0YXR1cyArIFwiIFwiICsgcmVzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50b2tlbkluZm8gPSAoX2IudG9rZW4gPSBfYy5zZW50KCksIF9iLmV4cGlyZXMgPSBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAsIF9iKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IHRva2VuIGZvciBcIiArIHRoaXMudG9rZW5JZCArIFwiOiBcIiArIEpTT04uc3RyaW5naWZ5KHRoaXMudG9rZW5JbmZvKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2F2ZSh0aGlzLmNsaWVudElkICsgXCIvXCIgKyB0aGlzLnRva2VuSWQsIHRoaXMudG9rZW5JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICsrcmV0cmllcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byByZXRyaWV2ZSB0b2tlbiBmb3IgXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuSWQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmVhcmVyUHJvdmlkZXI7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmVhcmVyUHJvdmlkZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZC1iZWFyZXItcHJvdmlkZXIuanMubWFwIiwiLypcbmRlY2xhcmUgdmFyIEJ1ZmZlcjsgLy8gbm9kZSBidWlsdC1pblxuXG5cbmZ1bmN0aW9uIGJhc2ljQXV0aEhlYWRlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gXCJCYXNpYyBcIiArIG5ldyBCdWZmZXIodXNlcm5hbWUgKyBcIjpcIiArIHBhc3N3b3JkKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbn1cbiovXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9lbWl0dGVyJztcbnZhciBSZXN0Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJlc3RDbGllbnQoaXNvbW9ycGhpYywgYmFzZVVybCwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLmlzb21vcnBoaWMgPSBpc29tb3JwaGljO1xuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICB0aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IG5ldyBFbWl0dGVyKHRoaXMpO1xuICAgICAgICB0aGlzLmZldGNoT3B0aW9ucyA9IHsgbW9kZTogJ2NvcnMnIH07XG4gICAgICAgIHRoaXMuYXV0aEhlYWRlciA9IG9wdGlvbnMuYmVhcmVyID9cbiAgICAgICAgICAgIFwiQmVhcmVyIFwiICsgb3B0aW9ucy5iZWFyZXIgOlxuICAgICAgICAgICAgb3B0aW9ucy51c2VybmFtZSA/XG4gICAgICAgICAgICAgICAgXCJCYXNpYyBcIiArIGlzb21vcnBoaWMuYnRvYShvcHRpb25zLnVzZXJuYW1lICsgXCI6XCIgKyAob3B0aW9ucy5wYXNzd29yZCB8fCBcIlwiKSkgOlxuICAgICAgICAgICAgICAgIG51bGw7XG4gICAgICAgIHRoaXMuYmVhcmVyUHJvdmlkZXIgPSBvcHRpb25zLmJlYXJlclByb3ZpZGVyIHx8IG51bGw7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN0Q2xpZW50LnByb3RvdHlwZSwgXCJzdGF0dXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmZldGNoID0gZnVuY3Rpb24gKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICArK3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xuICAgICAgICB0aGlzLl9zdGF0dXMuZGlzcGF0Y2godGhpcyk7XG4gICAgICAgIHJldHVybiB0aGlzLl9mZXRjaChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAtLV90aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMuZGlzcGF0Y2goX3RoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgLS1fdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzLmRpc3BhdGNoKF90aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLl9mZXRjaCA9IGZ1bmN0aW9uIChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHIsIF9hLCBhdXRoSGVhZGVyLCB0b2tlbkluZm8sIGJlYXJlclByb3ZpZGVyLCBfYiwgX2MsIHVybCwgcmVzLCB3d3dhdXRoLCBfZDtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2UubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZldGNoT3B0aW9ucyAmJiBmZXRjaE9wdGlvbnMuY2FjaGUgPT09ICduby1jYWNoZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBiYWNrLWJ1dHRvbiBub3QgcmVzcGVjdGluZyBjYWNoZSBjb250cm9sIGluIENocm9tZS9PcGVyYS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmQgYSBxdWVyeSBwYXJhbWV0ZXIgdG8gZm9yY2UgYSBjYWNoZSBlbnRyeVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgcXVlcnksIHsgbm9jYWNoZTogY3JlYXRlVVVJRCgpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHIgPSBxdWVyeSAmJiBPYmplY3Qua2V5cyhxdWVyeSkuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIHF1ZXJ5W2tleV0gIT09IHVuZGVmaW5lZDsgfSkubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIj1cIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeVtrZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyYnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcywgYXV0aEhlYWRlciA9IF9hLmF1dGhIZWFkZXIsIHRva2VuSW5mbyA9IF9hLnRva2VuSW5mbywgYmVhcmVyUHJvdmlkZXIgPSBfYS5iZWFyZXJQcm92aWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCFhdXRoSGVhZGVyICYmICF0b2tlbkluZm8gJiYgYmVhcmVyUHJvdmlkZXIpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGJlYXJlclByb3ZpZGVyLmdldEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudG9rZW5JbmZvID0gdG9rZW5JbmZvID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRva2VuSW5mbykgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVG9rZW4gZXhwaXJlZC4gUmVmcmVzaCBpdDpcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBiZWFyZXJQcm92aWRlci5yZWZyZXNoQmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50b2tlbkluZm8gPSB0b2tlbkluZm8gPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhIZWFkZXIgPSBcIkJlYXJlciBcIiArIHRva2VuSW5mby50b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gb25lIHdheSBvciBhbm90aGVyLCB3ZSd2ZSBjb25jbHVkZWQgYW4gQXV0aG9yaXphdGlvbiBoZWFkZXIgdG8gdXNlOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dGhIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLkF1dGhvcml6YXRpb24gPSBhdXRoSGVhZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdGhpcy5iYXNlVXJsICsgcGF0aCArIChxdWVyeVN0ciA/IFwiP1wiICsgcXVlcnlTdHIgOiBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaXNvbW9ycGhpYy5mZXRjaCh1cmwsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZmV0Y2hPcHRpb25zLCB7IGhlYWRlcnM6IGhlYWRlcnMsIG1ldGhvZDogbWV0aG9kIH0sIGZldGNoT3B0aW9ucykpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyA9PSA0MDEgJiYgdGhpcy5iZWFyZXJQcm92aWRlcikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3d3YXV0aCA9IHJlcy5oZWFkZXJzLmdldChcInd3dy1hdXRoZW50aWNhdGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBcIiArIHJlcy5zdGF0dXMgKyBcIiBmcm9tIFwiICsgKHRoaXMuYmFzZVVybCArIHBhdGgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHd3d2F1dGggJiYgL0JlYXJlci9pLnRlc3Qod3d3YXV0aCkpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYmVhcmVyUHJvdmlkZXIucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2QudG9rZW5JbmZvID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gXCJCZWFyZXIgXCIgKyB0aGlzLnRva2VuSW5mby50b2tlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaXNvbW9ycGhpYy5mZXRjaCh1cmwsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZmV0Y2hPcHRpb25zLCB7IGhlYWRlcnM6IGhlYWRlcnMsIG1ldGhvZDogbWV0aG9kIH0sIGZldGNoT3B0aW9ucykpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA5O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovLCByZXNdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChwYXRoLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiR0VUXCIsIHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb247IHRleHQvcGxhaW5cIiB9LCBxdWVyeSwgZmV0Y2hPcHRpb25zKTtcbiAgICB9O1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLnBvc3QgPSBmdW5jdGlvbiAocGF0aCwgZGF0YSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiUE9TVFwiLCB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgIH0sIHsgZGVidWc6IDEgfSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpIH0pKTtcbiAgICB9O1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXRoLCBxdWVyeSwgYm9keSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiREVMRVRFXCIsIHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb247IHRleHQvcGxhaW5cIiB9LCBxdWVyeSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IGJvZHkgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFJlc3RDbGllbnQ7XG59KCkpO1xuZXhwb3J0IHsgUmVzdENsaWVudCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzdGNsaWVudC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVVSUQoKSB7XG4gICAgLy8gRGVjZW50IHNvbHV0aW9uIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDUwMzQvaG93LXRvLWNyZWF0ZS1hLWd1aWQtdXVpZC1pbi1qYXZhc2NyaXB0XG4gICAgdmFyIGQgPSBEYXRlLm5vdygpO1xuICAgIHZhciB1dWlkID0gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICB2YXIgciA9IChkICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDtcbiAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTtcbiAgICAgICAgcmV0dXJuIChjID09PSAneCcgPyByIDogKHIgJiAweDcgfCAweDgpKS50b1N0cmluZygxNik7XG4gICAgfSk7XG4gICAgcmV0dXJuIHV1aWQ7XG59XG5leHBvcnQgZnVuY3Rpb24gYXZvaWRTaW11bHRhbm91c0NhbGxzKG1ldGhvZCkge1xuICAgIHZhciBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFvbmdvaW5nUHJvbWlzZSkge1xuICAgICAgICAgICAgb25nb2luZ1Byb21pc2UgPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvbmdvaW5nUHJvbWlzZTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbElkKHJlYWxtKSB7XG4gICAgdmFyIHByZWZpeCA9ICdlYzk2YjNiZS00NWZjLTQxZDMtYjY5ZS0nO1xuICAgIHZhciBwYWQgPSBbJzUwJywgJzA4JywgJ2UxJywgJzQwJywgJ2U0JywgJ2U3J107XG4gICAgaWYgKHJlYWxtLmxlbmd0aCA+IDYpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRvbyBsb25nIHJlYWxtXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhbG0ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGhleCA9IHJlYWxtLmNoYXJDb2RlQXQoaSkudG9TdHJpbmcoMTYpO1xuICAgICAgICBwYWRbaV0gPSBoZXgubGVuZ3RoID09PSAyID9cbiAgICAgICAgICAgIGhleCA6XG4gICAgICAgICAgICAnMCcgKyBoZXg7XG4gICAgfVxuICAgIHJldHVybiBwcmVmaXggKyBwYWQuam9pbignJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVByZWRlc3RpbmF0ZWRJZChpbnB1dCkge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZW5jb2RlciwgZGF0YSwgZGlnZXN0LCBfYSwgaTtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlbmNvZGVyLmVuY29kZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIF9hID0gVWludDhBcnJheS5iaW5kO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGRhdGEpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGRpZ2VzdCA9IG5ldyAoX2EuYXBwbHkoVWludDhBcnJheSwgW3ZvaWQgMCwgX2Iuc2VudCgpXSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuaWJibGUgPSBkaWdlc3RbaSsrXSAlIDE2IHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2FzaGVkTmliYmxlID0gYyA9PT0gJ3gnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlICYgMHg3IHwgMHg4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXNoZWROaWJibGUudG9TdHJpbmcoMTYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbi8qZXhwb3J0IGZ1bmN0aW9uIGJ1ZjJoZXgoYnVmZmVyOiBBcnJheUJ1ZmZlcikge1xuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKFxuICAgIG5ldyBVaW50OEFycmF5KGJ1ZmZlciksXG4gICAgKHg6IG51bWJlcikgPT4gKCcwMCcgKyB4LnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpKS5qb2luKCcnKTtcbn0qL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5KGEsIG1hcHBlcikge1xuICAgIHZhciByZXR2YWwgPSBhO1xuICAgIGZvciAodmFyIGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgdmFyIHQgPSBhW2ldO1xuICAgICAgICB2YXIgbWFwcGVkID0gbWFwcGVyKHQpO1xuICAgICAgICBpZiAobWFwcGVkICE9PSB0KSB7XG4gICAgICAgICAgICBpZiAocmV0dmFsID09PSBhKVxuICAgICAgICAgICAgICAgIHJldHZhbCA9IGEuc2xpY2UoKTtcbiAgICAgICAgICAgIHJldHZhbFtpXSA9IG1hcHBlZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0dmFsO1xufVxuLypcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBcnJheTxUPihhOiBUW10sIG1hcHBlcjogKHQ6IFQpID0+IFQgfCBmYWxzZSk6IFRbXSB7XG4gIGxldCByZXR2YWwgPSBhO1xuICBsZXQgaiA9IDA7XG4gIGZvciAobGV0IGk9MCxsPWEubGVuZ3RoOyBpPGw7ICsraSwgKytqKSB7XG4gICAgY29uc3QgdCA9IGFbaV07XG4gICAgY29uc3QgbWFwcGVkID0gbWFwcGVyKHQpO1xuICAgIGlmIChtYXBwZWQgPT09IGZhbHNlKSB7XG4gICAgICAvLyBNYXBwZXIgd2FudHMgdG8gZGVsZXRlIHRoaXMgZG9jLlxuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgcmV0dmFsLnNwbGljZShqLCAxKTtcbiAgICAgIC0tajsgLy8gY29tcGVuc2F0ZSBmb3IgKytqXG4gICAgfSBlbHNlIGlmIChtYXBwZWQgIT09IHQpIHtcbiAgICAgIGlmIChyZXR2YWwgPT09IGEpIHJldHZhbCA9IGEuc2xpY2UoKTtcbiAgICAgIHJldHZhbFtqXSA9IG1hcHBlZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJldHZhbDtcbn1cbiovIFxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIiwiaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tIFwia2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb25cIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsIH0gZnJvbSBcIi4vdXRpbHNcIjtcbnZhciBDYWNoZUJ1c3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FjaGVCdXN0KCkge1xuICAgIH1cbiAgICBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgdXNlciwgaW5jbHVkZXMpIHtcbiAgICAgICAgdmFyIGludm9sdmVkSXRlbXMgPSBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKTtcbiAgICAgICAgcmV0dXJuIGludm9sdmVkSXRlbXNcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0pOyB9KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICEhdmFsdWU7IH0pXG4gICAgICAgICAgICAuam9pbignLycpIHx8ICdzdGF0aWMnO1xuICAgIH07XG4gICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZSA9IGZ1bmN0aW9uIChyZXFzLCB1c2VyKSB7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBDYWNoZUJ1c3QuZ2V0Q2FjaGVJbnZhbGlkYXRpb25zKHJlcXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBfYVtfaV07XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImNhY2hlLWJ1c3QtXCIgKyB1c2VyICsgXCItXCIgKyBpdGVtLCAnJyArIERhdGUubm93KCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKSB7XG4gICAgICAgIHZhciBoYXNFZGdlc0Zyb20gPSBxdWVyeS5oYXNFZGdlc0Zyb207XG4gICAgICAgIHZhciByZWxhdGVkVGFibGVzID0gaW5jbHVkZXNcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBKc29uU2NoZW1hLnRhYmxlc1t0YWJsZV0ucmVsYXRpb25zaGlwc1tsYWJlbF07IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh0YWJsZSkgeyByZXR1cm4gISF0YWJsZTsgfSk7XG4gICAgICAgIGlmIChoYXNFZGdlc0Zyb20pXG4gICAgICAgICAgICByZWxhdGVkVGFibGVzLnB1c2goXCJoZWZcIiArIHRhYmxlKTtcbiAgICAgICAgcmV0dXJuIFt0YWJsZSwgJ21hc3RlcicsIHF1ZXJ5LmJyYW5jaElkXS5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuICEheDsgfSkuY29uY2F0KHJlbGF0ZWRUYWJsZXMpLnNvcnQoKTtcbiAgICB9O1xuICAgIENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMgPSBmdW5jdGlvbiAocmVxcykge1xuICAgICAgICB2YXIgaW52YWxpZGF0aW9uU2V0ID0ge307XG4gICAgICAgIHJlcXMuZm9yRWFjaChmdW5jdGlvbiAocmVxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHJlcS5vcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAncHV0JzpcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFibGVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGluayc6XG4gICAgICAgICAgICAgICAgY2FzZSAndW5saW5rJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5zb3VyY2VUYWJsZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbXCJoZWYtXCIgKyBnZXRUYWJsZUZyb21MYWJlbChyZXEuc291cmNlVGFibGUsIHJlcS5sYWJlbCldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5icmFuY2hJZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YXJnZXRCcmFuY2hJZCB8fCBcIm1hc3RlclwiXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGludmFsaWRhdGlvblNldCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FjaGVCdXN0O1xufSgpKTtcbmV4cG9ydCB7IENhY2hlQnVzdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2FjaGUtYnVzdC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGVsdGEoZG9jLCBkZWx0YSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEpO1xuICAgIHZhciB0YXJnZXREb2MgPSBkb2M7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XG4gICAgICAgIGlmICh0YXJnZXREb2MgPT09IGRvYylcbiAgICAgICAgICAgIHRhcmdldERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YVtrZXldO1xuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG1pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZCA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkYWRkIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSB0YXJnZXRBcnJheS5zbGljZSgpOyAvLyBPbiBKUyBzaWRlLCB3ZSBtdXN0IGJlIGltbXV0YWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVzVG9BZGRfMSA9IHZhbHVlc1RvQWRkOyBfaSA8IHZhbHVlc1RvQWRkXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ID0gdmFsdWVzVG9BZGRfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0QXJyYXkuaW5jbHVkZXModikpIHsgLy8gYXZvaWQgZHVwc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkucHVzaCh2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMSA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QXJyYXkgPSB0YXJnZXREb2Nba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFyZ2V0QXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvY1trZXldID0gdGFyZ2V0QXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9SZW1vdmVfMS5pbmNsdWRlcyh0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgbWV0YUluc3RydWN0aW9uc18xID0gbWV0YUluc3RydWN0aW9uczsgX2EgPCBtZXRhSW5zdHJ1Y3Rpb25zXzEubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMVtfYV07XG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzEobWkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldERvYztcbn1cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZURlbHRhcyhkZWx0YTEsIGRlbHRhMikge1xuICAgIC8vcmV0dXJuIHsuLi5kZWx0YTEsIC4uLmRlbHRhMn07XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YTIpO1xuICAgIHZhciB0YXJnZXREZWx0YSA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhMSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzOyBfaSA8IGtleXNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMltfaV07XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YTJba2V5XTtcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChtaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGRfMiA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkXzIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRhZGQgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JHJlbW92ZTogWy4uLml0ZW1zXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JGFkZDogWy4uLl19IGFycmF5cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFJlbW92ZUFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvQWRkXzIuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJHJlbW92ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRyZW1vdmUgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRyZW1vdmUgcHJvcC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkYWRkIGFycmF5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBZGRBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRhZGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRBZGRBcnJheSA/IHRhcmdldEFkZEFycmF5LmNvbmNhdCh2YWx1ZXNUb0FkZF8yKSA6IHZhbHVlc1RvQWRkXzIuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID0gdGFyZ2V0QWRkQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzIgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8yKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0RGVsdGFba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldE1ldGFQcm9wID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGFyZ2V0TWV0YVByb3ApIDoge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHRhcmdldE1ldGFQcm9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBqdXN0IGNoZWNrIGlmIHRhcmdldCBtZXRhUHJvcCBoYXMgeyRhZGQ6IFsuLi5pdGVtc119XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHJlbW92ZSBhbnkgZXF1YWwgaXRlbXMgZnJvbSB0aGVyZSBiZWZvcmUgbWVyZ2luZyB0aGUgeyRyZW1vdmU6IFsuLi5dfSBhcnJheXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRBZGRBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJGFkZCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsgcmV0dXJuICF2YWx1ZXNUb1JlbW92ZV8yLmluY2x1ZGVzKHQpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFQcm9wLiRhZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiAkYWRkIGFycmF5IGJlY2FtZSBlbXRweS4gUmVtb3ZlIHRoZSAkYWRkIHByb3AuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0TWV0YVByb3AuJGFkZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3cgaXQncyB0aW1lIHRvIG1lcmdlIG9yIGNyZWF0ZSB0YXJnZXQgJHJlbW92ZSBhcnJheS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5ID0gdGFyZ2V0UmVtb3ZlQXJyYXkgPyB0YXJnZXRSZW1vdmVBcnJheS5jb25jYXQodmFsdWVzVG9SZW1vdmVfMikgOiB2YWx1ZXNUb1JlbW92ZV8yLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJHJlbW92ZSA9IHRhcmdldFJlbW92ZUFycmF5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMiA9IG1ldGFJbnN0cnVjdGlvbnM7IF9hIDwgbWV0YUluc3RydWN0aW9uc18yLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzJbX2FdO1xuICAgICAgICAgICAgICAgICAgICBfbG9vcF8yKG1pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldERlbHRhO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtbWVyZ2UuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLWNvbGxlY3Rpb24nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1yZXBvJztcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1zdWJzY3JpcHRpb24nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXdyaXRlcic7XG5leHBvcnQgKiBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmV4cG9ydCAqIGZyb20gJy4vcXVlcnktc2V0JztcbmV4cG9ydCAqIGZyb20gJy4uL29ic2VydmFibGUvbWl4aW4nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvblwiO1xuaW1wb3J0IHsgQ2FjaGVCdXN0IH0gZnJvbSAnLi9jYWNoZS1idXN0JztcbmltcG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9IGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9jb2xsZWN0aW9uJztcbi8qKlxuICogUmVwcmVzZW50cyBhIFwibGl2ZVwiIHF1ZXJ5IGFnYWluc3QgYSB0YWJsZSBvciBmaWx0ZXJlZCB0YWJsZS5cbiAqL1xudmFyIEtlZEJhY2tlbmRDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDb2xsZWN0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDb2xsZWN0aW9uKHJlcG8sIHRhYmxlLCBxdWVyeSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgS2VkQmFja2VuZFN1YnNjcmlwdGlvbihvYnNlcnZlciwgX3RoaXMpO1xuICAgICAgICAgICAgX3RoaXMucmVwby5xdWVyeVNldC5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJlcG8gPSByZXBvO1xuICAgICAgICBfdGhpcy50YWJsZSA9IHRhYmxlO1xuICAgICAgICBfdGhpcy5xdWVyeSA9IHF1ZXJ5O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwicXVlcnlLZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwiaW5jbHVkZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmNsdWRlcyB8fCAodGhpcy5faW5jbHVkZXMgPSBbXS5jb25jYXQodGhpcy5xdWVyeS5pbmNsdWRlIHx8IFtdKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBuZXcgS2VkQmFja2VuZENvbGxlY3Rpb24odGhpcy5yZXBvLCB0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5LCBxdWVyeSkpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFRvUXVlcnlBcnJheVByb3AgPSBmdW5jdGlvbiAoYXJyYXlQcm9wLCBlbnRyaWVzKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSgoX2EgPSB7fSwgX2FbYXJyYXlQcm9wXSA9ICh0aGlzLnF1ZXJ5W2FycmF5UHJvcF0gfHwgW10pLmNvbmNhdChlbnRyaWVzKSwgX2EpKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRGbGFncyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZsYWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBmbGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJmbGFnc1wiLCBmbGFncyk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBkZWJ1ZzogdHJ1ZSB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc09ubHlcIik7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc0FuZE5hbWVzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzT25seSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpbmNsdWRlSWRzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNBbmROYW1lc09ubHlcIik7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYmV0d2VlbiA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgZnJvbTogZnJvbSwgdG86IHRvIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgcm9sZTogcm9sZSB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5oYXNFZGdlc0Zyb20gPSBmdW5jdGlvbiAoaWRzLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8IGlkcy5zb21lKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gIWlkOyB9KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzRnJvbShcIiArIEpTT04uc3RyaW5naWZ5KGlkcykgKyBcIilcIik7XG4gICAgICAgIHZhciBoZWYgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc0Zyb21cIiwgaWRzKTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlRGVsdGFFZGdlcyA/XG4gICAgICAgICAgICBoZWYuYWRkRmxhZ3MoXCJpbmNsdWRlRGVsdGFFZGdlc1wiKSA6XG4gICAgICAgICAgICBoZWY7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaGFzRWRnZXNUbyA9IGZ1bmN0aW9uIChpZHMsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBpZCBsaXN0IGdpdmVuIHRvIENvbGxlY3Rpb24uaGFzRWRnZXNUbyhcIiArIEpTT04uc3RyaW5naWZ5KGlkcykgKyBcIilcIik7XG4gICAgICAgIHZhciBoZXQgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc1RvXCIsIGlkcyk7XG4gICAgICAgIHJldHVybiBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZURlbHRhRWRnZXMgP1xuICAgICAgICAgICAgaGV0LmFkZEZsYWdzKFwiaW5jbHVkZURlbHRhRWRnZXNcIikgOlxuICAgICAgICAgICAgaGV0O1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcbiAgICAgICAgICAgIG9uWmVybzogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBlbnRpdHkgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXG4gICAgICAgICAgICBvbk1hbnk6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgZW50cmllcyBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzID0gZnVuY3Rpb24gKGlkcykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IHRhZ3M6IHRhZ3MgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JhcGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaW5jbHVkZVwiLCBncmFwaHMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmNhY2hlT3B0aW1pemVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgY2FjaGVCdXN0OiBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMucmVwby5nZXRVc2VyKCksIHRoaXMuaW5jbHVkZXMpIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm11dGF0aW9uc09uRW1wdHkgPSBmdW5jdGlvbiAobXV0YXRpb25GYWN0b3J5KSB7XG4gICAgICAgIHZhciB0eCA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgbXV0YXRpb25zT25FbXB0eTogdHgubXV0YXRpb25SZXF1ZXN0cyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hID0gdGhyb3dlcnMgfHwge30sIG9uWmVybyA9IF9hLm9uWmVybywgb25NYW55ID0gX2Eub25NYW55O1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChvblplcm8pXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpdGVtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcbiAgICAgICAgICAgICAgICAgICAgb25NYW55KCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbMF07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLypjb21iaW5lTGF0ZXN0PFRPdGhlcj4ob3RoZXI6IFF1ZXJ5T2JzZXJ2YWJsZTxUT3RoZXI+KSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcbiAgICB9Ki9cbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGlkLCBjaGFuZ2VzLCBkZWJvdW5jZSkge1xuICAgICAgICBpZiAoZGVib3VuY2UgPT09IHZvaWQgMCkgeyBkZWJvdW5jZSA9IDEwMDA7IH1cbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIGRlbHRhRG9jOiBjaGFuZ2VzXG4gICAgICAgICAgICB9XSwgZGVib3VuY2UpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkRG9jKSB7XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICdhZGQtcmVsYXRlZCcsXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIGdyYXBoUHJvcDogbGFiZWwsXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvYzogcmVsYXRlZERvY1xuICAgICAgICAgICAgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZVJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3JlbW92ZS1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkSWQ6IHJlbGF0ZWRJZFxuICAgICAgICAgICAgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGlkcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoaWRzLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICBvcDogJ2RlbGV0ZScsXG4gICAgICAgICAgICB0YWJsZTogX3RoaXMudGFibGUsXG4gICAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSk7IH0pLCAwKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdGhpcy5yZXBvLnF1ZXJ5U2V0LnVuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZENvbGxlY3Rpb247XG59KENvbGxlY3Rpb24pKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH07XG4vKm1peGluKFxuICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsXG4gIE1hcHBlZENvbGxlY3Rpb24ucHJvdG90eXBlLFxuICBcIm1hcFwiLCBcImZsYXRcIiwgXCJjb25jYXRcIiwgXCJyZW5kZXJcIiwgXCJsb2FkXCIpOyovXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IHVwZGF0ZUFycmF5IH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcbmltcG9ydCB7IGJyYW5jaFNlbnNpdGl2ZSwgZ2V0VGFibGVGcm9tTGFiZWwgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGFwcGx5RGVsdGEgfSBmcm9tICcuL2RlbHRhLW1lcmdlJztcbnZhciBLZWRCYWNrZW5kUXVlcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgdXNlciwgcmVwbywgbXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7XG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5yZXBvID0gcmVwbztcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLmdvdEluaXRpYWxSZXNwb25zZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmludmFsaWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2FkZWRWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xuICAgICAgICB0aGlzLmluY2x1ZGVzID0gcXVlcnkuaW5jbHVkZSA/XG4gICAgICAgICAgICB0eXBlb2YgcXVlcnkuaW5jbHVkZSA9PT0gJ3N0cmluZycgP1xuICAgICAgICAgICAgICAgIFtxdWVyeS5pbmNsdWRlXSA6XG4gICAgICAgICAgICAgICAgcXVlcnkuaW5jbHVkZSA6XG4gICAgICAgICAgICBbXTtcbiAgICB9XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSkge1xuICAgICAgICB2YXIgbXV0YXRpb25zT25FbXB0eSA9IHF1ZXJ5Lm11dGF0aW9uc09uRW1wdHksIGNvbXBhcmFibGVQcm9wcyA9IHRzbGliXzEuX19yZXN0KHF1ZXJ5LCBbXCJtdXRhdGlvbnNPbkVtcHR5XCJdKTtcbiAgICAgICAgcmV0dXJuIHRhYmxlICsgSlNPTi5zdHJpbmdpZnkoY29tcGFyYWJsZVByb3BzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLCBcInF1ZXJ5S2V5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5KHRoaXMudGFibGUsIHRoaXMucXVlcnkpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSwgZGF0YTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlICYmICF0aGlzLmludmFsaWQpKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCksIHRydWUsIHRoaXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5xdWVyeUxvY2FsbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsb2FkUHJvbWlzZTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdvdEluaXRpYWxSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG11dGF0aW9uc09uRW1wdHkgc2hvdWxkIG5ldmVyIGJlIHVzZWQgdHdpY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucXVlcnkubXV0YXRpb25zT25FbXB0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCF2ZXJzaW9uICYmIHRoaXMuX2xvYWRQcm9taXNlKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9sb2FkUHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvYWRpbmcgaXMgb25nb2luZywgYW5kIGNhbGxlciBkb2VzIG5vdCByZXF1aXJlIGEgcmVjZW50IHJlZnJlc2guXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBvbmdvaW5nIGxvYWQgdG8gY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IHRoaXMucmVwby53cml0ZXIucGVyc2lzdGVkVmVyc2lvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRQcm9taXNlID0gdGhpcy5fbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkKHZlcnNpb24pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9hZGVkVmVyc2lvbiA9IE1hdGgubWF4KF90aGlzLmxvYWRlZFZlcnNpb24sIHZlcnNpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbG9hZFByb21pc2UgPT09IGxvYWRQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vb25lIGhhcyByZWZyZXNoZWQgb3VyIGxvYWQuIFRoZSBlcnJvciBpcyB0aGUgZmluYWwgcmVzdWx0LiBTZXQgaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9vbmUgaGFzIHJlZnJlc2hlZCBvdXIgbG9hZC4gV2UncmUgZmluaXNoZWQuIERhdGEgb3IgZXJyb3IgaXMgYWxyZWFkeSBzZXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgZ290SW5pdGlhbFJlc3BvbnNlIHRvIHRydWUgYW5kIG5vdGlmeSBzdWJzY3JpYmVycy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZ290SW5pdGlhbFJlc3BvbnNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubm90aWZ5U3Vic2NyaWJlcnMoX3RoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBIG1vcmUgcmVjZW50IGNhbGwgdG8gbG9hZCgpIGlzIG9uZ29pbmcsIE9SIHdhcyBvbmdvaW5nIGJ1dCByZXNwb25kZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVmb3JlIHVzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbnkgY2FzZSByZXR1cm4gdGhpcy5fbG9hZFByb21pc2UuIElmIGl0J3Mgb25nb2luZyB3ZSdsbCB3YWl0IGZvciBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBmaW5pc2guIElmIGl0J3MgbnVsbCwgd2UnbGwgYmUgcmV0dXJuaW5nIGZpbmFsbHkgaGVyZSB3aXRob3V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFueSBhY3Rpb24sIGJlY2F1c2UgdGhlIGFjdGlvbiB3YXMgdGFrZW4gYnkgdGhlIHJlZnJlc2hlci5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9sb2FkUHJvbWlzZTsgLy8gV2FpdCBmb3IgdGhlIHJlZnJlc2hlZCBsb2FkIHRvIGNvbXBsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBsb2FkUHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLl9sb2FkID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5tdXRhdGlvblF1ZXVlLmFmZmVjdHNRdWVyeSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlci4gT3RoZXJ3aXNlLCB3ZSBtYXkgZ2V0IGluYWNjdXJhdGUgZGF0YSBmcm9tIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVwby53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlci4gT3RoZXJ3aXNlLCB3ZSBtYXkgZ2V0IGluYWNjdXJhdGUgZGF0YSBmcm9tIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2VydmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IHN1YnNjcmlwdGlvbjsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2ksIG11dGF0aW9uc18xLCBtLCBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IG11dGF0aW9uc18xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG11dGF0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdjbGVhci1icmFuY2gnICYmIChtLmJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAnbWVyZ2UnICYmICghbS50YXJnZXRCcmFuY2hJZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRhcmdldEJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAndXBkYXRlJyAmJiAoKG0uZGVsdGFEb2MudGFncyAmJiB0aGlzLnF1ZXJ5LnRhZ3MpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG0uZGVsdGFEb2MubmFtZSAmJiB0aGlzLnF1ZXJ5Lm5hbWUpKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHF1ZXJ5IG11c3QgYmUgcmVmcmVzaGVkIGZyb20gc2VydmVyIGFzIHdlIGNhbm5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHF1ZXJ5IG11c3QgYmUgcmVmcmVzaGVkIGZyb20gc2VydmVyIGFzIHdlIGNhbm5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChtdXRhdGlvbnMsIGZhbHNlLCB0aGlzLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5yZWZyZXNoT3JJbnZhbGlkYXRlID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvYWQodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlcnMgPSBmdW5jdGlvbiAob3B0aW1pc3RpY011dGF0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YV8xID0gdGhpcy5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQob3B0aW1pc3RpY011dGF0aW9ucywgdHJ1ZSwgdGhpcy5kYXRhKTtcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgcy5ub3RpZnlTdWJzY3JpYmVyKGRhdGFfMSwgX3RoaXMuZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXBvLnF1ZXJ5U2V0LnF1ZXJ5TG9jYWxseSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucXVlcnlTZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLmdldENsaWVudCgpLmxpc3QodGhpcy50YWJsZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBkYXRhXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIG9wdGltaXN0aWMsIGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7XG4gICAgICAgICAgICBkYXRhID0gX3RoaXMuYXBwbHlNdXRhdGlvbnNPbkRhdGEoZGF0YSwgbXV0YXRpb24sIG9wdGltaXN0aWMpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zT25EYXRhID0gZnVuY3Rpb24gKGRhdGEsIG0sIG9wdGltaXN0aWMpIHtcbiAgICAgICAgaWYgKGJyYW5jaFNlbnNpdGl2ZShtKSAmJiBtLmJyYW5jaElkICE9IHRoaXMucXVlcnkuYnJhbmNoSWQpXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgdmFyIF9hID0gdGhpcywgdGFibGUgPSBfYS50YWJsZSwgaW5jbHVkZXMgPSBfYS5pbmNsdWRlcywgbGlzdE9wdGlvbnMgPSBfYS5xdWVyeTtcbiAgICAgICAgdmFyIHNvdXJjZUlkcyA9IGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSA/IFtdLmNvbmNhdChsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20gfHwgW10pIDogW107XG4gICAgICAgIHZhciByZXF1ZXN0ZWRUYWdzID0gbGlzdE9wdGlvbnMudGFncyA/IFtdLmNvbmNhdChsaXN0T3B0aW9ucy50YWdzIHx8IFtdKSA6IFtdO1xuICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcbiAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkID09PSBtLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSBkZWx0YSBvbiB1cGRhdGVkIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZERvYyA9IGFwcGx5RGVsdGEoZG9jLCBtLmRlbHRhRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWREb2MuJG1ldGEgPSAndXBkYXRpbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWREb2M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgaWQgZG9lcyBub3QgYXBwbHkgdG8gdGhpcyBkb2MsIHNlYXJjaCBpbiBncmFwaHMgdGhlIGlkIGlzIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgIC8vIGFtb25nIGdyYXBoIGluY2x1ZGVkIGRvY3MsIGFuZCBpZiBzbywgdXBkYXRlIHRoYXQgb25lOlxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkRG9jcyA9IGRvY1tsYWJlbF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRBcnJheSA9IHVwZGF0ZUFycmF5KGluY2x1ZGVkRG9jcywgZnVuY3Rpb24gKHJlbGF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWQuaWQgIT09IG0uaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRSZWxhdGVkID0gYXBwbHlEZWx0YShyZWxhdGVkLCBtLmRlbHRhRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUmVsYXRlZC4kbWV0YSA9ICd1cGRhdGluZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkUmVsYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZEFycmF5ICE9PSBpbmNsdWRlZERvY3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbGFiZWxdID0gdXBkYXRlZEFycmF5LCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdhZGQtcmVsYXRlZCc6XG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzIGBkYi5jb3Vyc2VCbG9ja3MuLi4ud2hhdGV2ZXIuLiAuaW5jbHVkZShcImFiaWxpdGllc1wiKWAsIGRldGVjdDogZGIuY291cnNlQmxvY2tzLmFkZFJlbGF0ZWQoYmxvY2tJZCwgJ2FiaWxpdGllcycsIC4uLilcbiAgICAgICAgICAgICAgICAgICAgLy8gLi4uYmVjYXVzZSB0YWJsZSA9ICdjb3Vyc2VCbG9ja3MnIGFuZCBpbmNsdWRlcyBoYXMgXCJhYmlsaXRpZXNcIi5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgIT09IG0uaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWxhdGVkRG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgbS5yZWxhdGVkRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2MuJG1ldGEgPSAnYWRkaW5nJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVttLmdyYXBoUHJvcF0gPSBkb2NbbS5ncmFwaFByb3BdLmNvbmNhdChbcmVsYXRlZERvY10pLCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlSWRzLmluY2x1ZGVzKG0uaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBgZGIuY291cnNlQmxvY2tzLmhhc0VkZ2VzRnJvbShbY291cnNlSWRdKWAgIChtZWFuaW5nIHRhYmxlPSdjb3Vyc2VCbG9ja3MnIGFuZCBzb3VyY2VJZHMgaW5jbHVkZXMgY291cnNlSWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAsIGRldGVjdDogZGIuY291cnNlSW5zdGFuY2VzLmFkZFJlbGF0ZWQoY291cnNlSWQsICdjb3Vyc2VCbG9ja3MnLCAuLi4uKSAvLyBtLmdyYXBoUHJvcCA9PT0gJ2Jsb2NrcyctLT4gZ2V0VGFibGVGcm9tTGFiZWwgLS0+ICdjb3Vyc2VCbG9ja3MnXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IGdldFRhYmxlRnJvbUxhYmVsKG0udGFibGUsIG0uZ3JhcGhQcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlzdE9wdGlvbnMudGFncylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5yZWxhdGVkRG9jLnRhZ3MgJiYgcmVxdWVzdGVkVGFncy5zb21lKGZ1bmN0aW9uICh0YWcpIHsgcmV0dXJuIG0ucmVsYXRlZERvYy50YWdzLmluY2x1ZGVzKHRhZyk7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvbmNhdCh0aGlzLnNldEdyYXBoUHJvcHMobS5yZWxhdGVkRG9jKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5pZHMgJiYgbGlzdE9wdGlvbnMuaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiBpZCA9PT0gbS5yZWxhdGVkRG9jLmlkOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBIGNlcnRhaW4gSUQgaXMgb2JzZXJ2ZWQuIEEgZG9jIHdpdGggdGhpcyBpZCBpcyBiZWluZyBhZGRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBkb2MgdG8gdGhlIHJlc3VsdC4gRXhhY3RseSB0aGlzIFdJTEwgaGFwcGVuIGluIHRoZSBmb2xsb3dpbmcgdHlwaWNhbCBzY2VuYXJpbzpcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gVXNlciBhZGRzIGEgcmVsYXRlZCBkb2N1bWVudCB0byBhIGxpc3QuXG4gICAgICAgICAgICAgICAgICAgIC8vIDIuIERvY3VtZW50IHJlbWFpbnMgd2l0aGluIHRoZSBNdXRhdGlvblF1ZXVlIHdoaWxlIGJhdGNoLXJlcXVlc3QgaXMgYmVpbmcgcHJvY2Vzc2VkIGJ5IHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gVXNlciBjbGlja3MgdGhlIGFkZGVkIGl0ZW0gdG8gZWRpdCBvciB2aWV3IGl0IChvciBvdXIgY29tcG9uZW50IHJlZGlyZWN0cyB0byBpdHMgZWRpdG9yKVxuICAgICAgICAgICAgICAgICAgICAvLyA0LiBBIG5ldyBxdWVyeSBvZiB0aGF0IHBhcnRpY3VsYXIgSUQgaXMgc3Vic2NyaWJlZCB0byB7aWRzPVt0aGVJZF19XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIEtlZEJhY2tlbmRRdWVyeS5zdWJzY3JpYmUgdGhlbiBkb2VzIHRoaXM6XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMS4gQ2FsbCBxdWVyeUxvY2FsbHkoKSBiZWZvcmUgcXVlcnlpbmcgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMi4gcXVlcnlMb2NhbGx5KCkgaW5zcGVjdHMgbXV0YXRpb25zIGFuZCBmaW5kcyBhIG1hdGNoLCByZXR1cm5pbmcgYW4gZW1wdHkgbGlzdFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIChhc3N1bWVzIGFzIHdlIGFyZSBhZGRpbmcgaXQsIGl0IGNhbid0IGV4aXN0IG9uIHRoZSBzZXJ2ZXIgYW55d2F5KVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDMuIEtlZEJhY2tlbmRRVWVyeSBhcHBsaWVzIG11dGF0aW9ucyBvbnRvIHRoZSBlbXB0eSBsaXN0LCBhbmQgZW5kcyB1cCBoZXJlIHRvIGFkZFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGl0IG9wdGltaXN0aWNhbGx5LlxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDQuIFdoZW4gc2VydmVyIHJlc3BvbmRzIHdpdGggMjAwIE9LLCBjYWxscyB1cyBoZXJlIGFnYWluIHdpdGggb3B0aW1pc3RpYz1mYWxzZVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRvIFwicGVyc2lzdFwiIGl0IGluIHRoZSBxdWVyeSdzIGRhdGEgYXJyYXkuXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNEI6IElmIG5vdCAyMDAgT0ssIG11dGF0aW9uIG1heSBiZSBnb25lIGFuZCB0aGUgc3Vic2NyaWJlciB3aWxsIHNlIGFuIGVycm9yIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBcIkNvdWxkIG5vdCBmaW5kIGVudGl0eSB3aXRoIGlkIFguXCIgYWxvbmcgd2l0aCBhIHJlZCBlcnJvciBtZXNzYWdlIG9uIHRoZSBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBhYm91dCB0aGF0IGl0IGZhaWxlZCB0byBzYXZlIG9uIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkRG9jcyA9IGRvY1ttLmdyYXBoUHJvcF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluY2x1ZGVkRG9jcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IG9wdGltaXN0aWMgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgcmVsYXRlZC1kb2MtdG8tcmVtb3ZlIHdpdGggJG1ldGE6ICdkZWxldGluZydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZERvY3MubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLnJlbGF0ZWRJZCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgOiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkSWQ7IH0pLCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlSWRzLmluY2x1ZGVzKG0uaWQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGltaXN0aWMgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkID09PSBtLnJlbGF0ZWRJZCA/IHRzbGliXzEuX19hc3NpZ24oe30sIGQsIHsgJG1ldGE6ICdkZWxldGluZycgfSkgOiBkOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZElkOyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0uaWQ7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZFRhYmxlcyA9IGluY2x1ZGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gKHsgbGFiZWw6IGxhYmVsLCB0YWJsZTogZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB9KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IF9hLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09PSBtLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsc18xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gX2EubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYiA9IHt9LCBfYltsYWJlbF0gPSBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX2EuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgX2IpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc2V0R3JhcGhQcm9wcyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgdmFyIGNvcHkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xuaW1wb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfSBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbnZhciBLZWRCYWNrZW5kUmVwbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUmVwbyhnZXRDbGllbnQsIGdldFVzZXIsIGRlZmF1bHRRdWVyeU9wdGlvbnMsIG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCB3cml0ZXIsIGNhY2hlT3B0aW1pemVkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xuICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMgPSBkZWZhdWx0UXVlcnlPcHRpb25zO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMud3JpdGVyID0gd3JpdGVyO1xuICAgICAgICB0aGlzLmNhY2hlT3B0aW1pemVkID0gY2FjaGVPcHRpbWl6ZWQ7XG4gICAgICAgIGlmICghbXV0YXRpb25RdWV1ZSlcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IG5ldyBNdXRhdGlvblF1ZXVlKCk7XG4gICAgICAgIGlmICghcXVlcnlTZXQpXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gbmV3IFF1ZXJ5U2V0KHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgIGlmICghd3JpdGVyKVxuICAgICAgICAgICAgdGhpcy53cml0ZXIgPSBuZXcgS2VkQmFja2VuZFdyaXRlcih0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlcik7XG4gICAgICAgIE9iamVjdC5rZXlzKHRhYmxlcykuZm9yRWFjaChmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICBpZiAoY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXNbdGFibGVdID0gY29sbGVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbiAocXVlcnlPcHRpb25zLCBjYWNoZU9wdGltaXplZCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgS2VkQmFja2VuZFJlcG8odGhpcy5nZXRDbGllbnQsIHRoaXMuZ2V0VXNlciwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLCBxdWVyeU9wdGlvbnMpLCB0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIHRoaXMud3JpdGVyLCBjYWNoZU9wdGltaXplZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5jYWNoZU9wdGltaXplZCA6IGNhY2hlT3B0aW1pemVkKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLmJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUucm9sZSA9IGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7IHJvbGU6IHJvbGUgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUub3B0aW1pemVDYWNoZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHt9LCB0cnVlKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgY2xlYXIgbWFzdGVyIGJyYW5jaFwiKTtcbiAgICAgICAgdGhpcy53cml0ZXIubXV0YXRlKFt7IG9wOiAnY2xlYXItYnJhbmNoJywgYnJhbmNoSWQ6IHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZCB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAodGFyZ2V0QnJhbmNoSWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgbWVyZ2UgZnJvbSBtYXN0ZXIgYnJhbmNoXCIpO1xuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdtZXJnZScsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuc2F2ZU5vdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodGhpcy53cml0ZXIuY3VycmVudFZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kUmVwbztcbn0oKSk7XG5leHBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1yZXBvLmpzLm1hcCIsInZhciBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24oc3Vic2NyaWJlciwgY29sbGVjdGlvbikge1xuICAgICAgICB0aGlzLnN1YnNjcmliZXIgPSBzdWJzY3JpYmVyO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVyID0gZnVuY3Rpb24gKGRhdGEsIGVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyKFtdLCBlcnJvciwgdGhpcyk7XG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhICE9PSB0aGlzLmxhc3ROb3RpZmllZERhdGEpIHsgLy8gV2lsbCBpbi1mYWN0IGJlIGVxdWFsIGJ5IHJlZmVyZW5jZSBpZiBkYXRhIGlzIHNhbWUgYXMgbGFzdCBub3RpZmljYXRpb24gKGFzIHdlIHVzZSBhbiBpbW11dGFibGUgYXBwcm9hY2ggb24gZGF0YSlcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZERhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihkYXRhLCBlcnJvciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXgsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4Mikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBub3RpZnlpbmcgS2VkQmFja2VuZFN1YnNjcmliZXI6XCIsIGV4MiwgJ29yaWdpbmFsbHkgbm90aWZpZWQgZXJyb3I6JywgZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnVuc3Vic2NyaWJlKHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRTdWJzY3JpcHRpb247XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmltcG9ydCB7IENhY2hlQnVzdCB9IGZyb20gJy4vY2FjaGUtYnVzdCc7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZSc7XG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kV3JpdGVyKG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcbiAgICAgICAgdGhpcy5xdWVyeVNldCA9IHF1ZXJ5U2V0O1xuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMucGVyc2lzdGVkVmVyc2lvbiA9IG5ldyBFbWl0dGVyKDApO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc1NhdmluZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISF0aGlzLl9pc1NhdmluZ1Byb21pc2U7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc0VkaXRlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLmxlbmd0aCA+IDA7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLnB1c2goY2FsbGJhY2spO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub25TdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gdGhpcy5lcnJvclN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gY2FsbGJhY2s7IH0pO1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMgPSB0aGlzLnN0YXRlU3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBjYWxsYmFjazsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yLCByZXRyeWFibGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCByZXRyeWFibGUsIF90aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfKSB7IH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaFN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm11dGF0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIGRlYm91bmNlKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5hZGQobXV0YXRpb25zKTtcbiAgICAgICAgKyt0aGlzLmN1cnJlbnRWZXJzaW9uO1xuICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgdGhpcy5xdWVyeVNldC5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgICAgICBpZiAoIXRoaXMuX2lzU2F2aW5nUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZClcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHNldFRpbWVvdXQodGhpcy5zYXZlLmJpbmQodGhpcyksIGRlYm91bmNlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBpc1NhdmluZywgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZywgYmVjYXNlIGl0IHdpbGwgcmUtY2hlY2sgaWYgYWRkaXRpb25hbFxuICAgICAgICAvLyBtdXRhdGlvbnMgaGF2ZSBjb21lLCB3aGVuIHNhdmluZyBpcyBkb25lLlxuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUucmV0cnlTYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZlKCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBlcnNpc3RlZFZlcnNpb247XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmxvYWQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlZFZlcnNpb24gPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShwZXJzaXN0ZWRWZXJzaW9uIDwgdmVyc2lvbikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7IC8vIEJlIG1vcmUgZWFnZXIgdG8gc2F2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmZpbHRlcihmdW5jdGlvbiAocGVyc2lzdGVkVmVyc2lvbikgeyByZXR1cm4gcGVyc2lzdGVkVmVyc2lvbiA+PSB2ZXJzaW9uOyB9KS5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzU2F2aW5nUHJvbWlzZSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XG4gICAgICAgIGlmICghdGhpcy5pc0VkaXRlZClcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gdGhpcy5fc2F2ZSgpO1xuICAgICAgICB0aGlzLl9pc1NhdmluZ1Byb21pc2UuY2F0Y2goZnVuY3Rpb24gKCkgeyB9KS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9pc1NhdmluZ1Byb21pc2UgPSBudWxsOyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2F2aW5nUHJvbWlzZTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLl9zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbnMsIHZlcnNpb24sIG11dGF0aW9uUmVxdWVzdHMsIHJlc18xLCBldGFnTXV0YXRpb25zLCBlcnJvcl8xO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB0aGlzLmN1cnJlbnRWZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLm1vdmVUb1NhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvblJlcXVlc3RzID0gdGhpcy5tYXBNdXRhdGlvbnMobXV0YXRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCAxMSwgMTJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZ2V0Q2xpZW50KCkuYmF0Y2gobXV0YXRpb25SZXF1ZXN0cyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV0YWdNdXRhdGlvbnMgPSBPYmplY3Qua2V5cyhyZXNfMS5uZXdFdGFncykubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcDogJ3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhRG9jOiB7ICRldGFnOiByZXNfMS5uZXdFdGFnc1tpZF0gfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW52YWxpZGF0ZSBjYWNoZVxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZShtdXRhdGlvblJlcXVlc3RzLCB0aGlzLmdldFVzZXIoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb21tbWl0IG11dGF0aW9ucyBhbG9uZyB3aXRoIGV0YWdNdXRhdGlvbnMgaW50byBxdWVyaWVzIGNhY2hlZCBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2godmVyc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2V0LmNvbW1pdE11dGF0aW9ucyhNdXRhdGlvblF1ZXVlLm1lcmdlKG11dGF0aW9ucywgZXRhZ011dGF0aW9ucyksIHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT24gc3VjY2VzcywgY2xlYXIgc2F2aW5nIHF1ZXVlIGFzIHRoZSBtdXRhdGlvbnMgd2lsbCBub3cgYmUgY29tbWl0dGVkIHRvIGFsbCBxdWVyeSdzIGRhdGEgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5jbGVhclNhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBub3RpZnkgc3Vic2NyaWJlcnMgc28gdGhhdCB2aWV3cyBnZXQgdXBkYXRlZCB3aXRoIGNvbW1pdHRlZCByZXN1bHRzXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3NhdmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFzIHdlbGwuXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlcnJvcl8xICYmIGVycm9yXzEubmFtZSAmJiBlcnJvcl8xLm5hbWUuc3RhcnRzV2l0aChcImh0dHA0XCIpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBY2Nlc3MgQ29udHJvbCBkZW5pZWQsIGJhZCByZXF1ZXN0IG9yIHNpbWlsYXIuIFRocm93IG11dGF0aW9ucyBhd2F5LlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5jbGVhclNhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG8gaG8hIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFsb25lLiBUSGV5IG1pZ2h0IGJlIG1vcmUgbHVja3kuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zYXZlKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIbyBobyEgQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYWxvbmUuIFRIZXkgbWlnaHQgYmUgbW9yZSBsdWNreS5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gODtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFcnJvcihlcnJvcl8xLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTA7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEyXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm1hcE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdmFyIGJyID0gbmV3IEJhdGNoUnVubmVyKCk7XG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICBici51cGRhdGUobS50YWJsZSwgbS5pZCwgbS5kZWx0YURvYywgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZC1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtLnJlbGF0ZWREb2MuJGV0YWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vICRldGFnIG1lYW5zIHRoaXMgaXMgYSBuZXcgZG9jdW1lbnQuIEFkZCBpdCBiZWZvcmUgbGlua2luZyB0byBpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyLmFkZCh0YWJsZXNbbS50YWJsZV0ucmVsYXRpb25zaGlwc1ttLmdyYXBoUHJvcF0sIG0ucmVsYXRlZERvYywgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnIubGluazIobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZERvYy5pZCwgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgYnIudW5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkSWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICBici5kZWxldGUobS50YWJsZSwgbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGJyLmNsZWFyQnJhbmNoKG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLm1lcmdlKG0uYnJhbmNoSWQsIG0udGFyZ2V0QnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRXcml0ZXI7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC13cml0ZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBtZXJnZURlbHRhcyB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIE11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XG4gICAgfVxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5xdWV1ZSwgbXV0YXRpb25zKTtcbiAgICB9O1xuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLm1vdmVUb1NhdmluZ1F1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gTXV0YXRpb25RdWV1ZS5tZXJnZSh0aGlzLnNhdmluZ1F1ZXVlLCB0aGlzLnF1ZXVlKTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2xlYXJTYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZmZlY3RzUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcbiAgICAgICAgaWYgKG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLm9wID09PSAnbWVyZ2UnIHx8IG0ub3AgPT09ICdjbGVhci1icmFuY2gnOyB9KSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XG4gICAgICAgICAgICAvLyBBIHF1ZXJ5IHdpdGggXCJpZHNcIiBmaWx0ZXIgd2lsbCBiZSBlYXN5IHRvIGRldGVjdCBhIG5vLW1hdGNoIG9uOlxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBnbG9iYWxPcChtKSB8fCAoIWJyYW5jaFNlbnNpdGl2ZShtKSB8fCBtLmJyYW5jaElkID09PSBxdWVyeS5icmFuY2hJZCkgJiZcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXV0YXRpb25zIGFmZmVjdCBzYW1lIGJyYW5jaCBhbmQgdGFibGUuIENvdWxkIGJlIGRvbmUgbW9yZSBmaW5lIGdyYWluZWQsXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgcmV0dXJuIG0ub3AgPT09ICdkZWxldGUnID9cbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XG4gICAgICAgICAgICAgICAgZ2xvYmFsT3AobSkgPyB0cnVlIDpcbiAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PSBxdWVyeS5icmFuY2hJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUxID0gcXVldWUxLnNsaWNlKCk7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUyID0gcXVldWUyLnNsaWNlKCk7XG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XG4gICAgICAgIHZhciBsZW4gPSBxdWV1ZTEubGVuZ3RoO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcbiAgICAgICAgICAgIGlmIChtLm9wID09PSAndXBkYXRlJykge1xuICAgICAgICAgICAgICAgIHZhciBvdmVybGFwcGluZ0lkT3BJZHggPSBtdXRhYmxlUXVldWUyLmZpbmRJbmRleChmdW5jdGlvbiAobmV3TXV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuYnJhbmNoSWQgPT09IG0uYnJhbmNoSWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5pZCA9PT0gbS5pZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3ZlcmxhcHBpbmdJZE9wSWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMVtpXSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0sIHsgZGVsdGFEb2M6IG1lcmdlRGVsdGFzKG0uZGVsdGFEb2MsIG11dGFibGVRdWV1ZTJbb3ZlcmxhcHBpbmdJZE9wSWR4XS5kZWx0YURvYykgfSk7XG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtdXRhYmxlUXVldWUxLmNvbmNhdChtdXRhYmxlUXVldWUyKTtcbiAgICB9O1xuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xufSgpKTtcbmV4cG9ydCB7IE11dGF0aW9uUXVldWUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfSBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG52YXIgUXVlcnlTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUXVlcnlTZXQobXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBbXTtcbiAgICB9XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwodGhpcy5xdWVyaWVzLm1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5jb21taXRNdXRhdGlvbnMobXV0YXRpb25zLCB2ZXJzaW9uKTsgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW52YWxpZFF1ZXJpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuY2xlYW51cEludmFsaWRRdWVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7XG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHEudGltZW91dEhhbmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3B0aW1pc3RpY011dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIHEubm90aWZ5U3Vic2NyaWJlcnMob3B0aW1pc3RpY011dGF0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmZpbmRRdWVyeSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcmllcy5maW5kKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLnF1ZXJ5S2V5ID09PSBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGFibGUsIHF1ZXJ5KTsgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgLy8gRm9yIG5vdywgb25seSBoYW5kbGUgdGhpcyB2ZXJ5IGNvbW1vbiBhbmQgc3BlY2lhbCBjYXNlICh3aGljaFxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgd2FudHMgdG8gZ2V0IGEgc2luZ2xlIGVudGl0eSBieSBpdHMgSUQ6XG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gQW5kIGlmIHNvLCBpZiB3ZSBoYXZlIGFuIG91dGdvaW5nIG11dGF0aW9uIHRvIGNyZWF0ZSB0aGF0IGVudGl0eTpcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ2FkZC1yZWxhdGVkJyAmJiBtLnJlbGF0ZWREb2MuaWQgPT09IHF1ZXJ5Lmlkc1swXTsgfSkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcbiAgICAgICAgICAgICAgICAvLyBidXQgbGV0IHRoZSBvcHRpc3RpYyBmZWF0dXJlIG9mIEtlZEJhY2tlbmRRdWVyeSBhcHBseSB0aGUgbXV0YXRpb24gYmVmb3JlXG4gICAgICAgICAgICAgICAgLy8gbm90aWZ5aW5nIHN1YnNjcmliZXJzICh3ZSBkb24ndCB3YW50IGl0IHRvIGJlIHBlcnNpc3RlbnQgYmVmb3JlIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPSywgYW5vdGhlciBxdWl0ZSBjb21tb24gY2FzZSBpcyB3aGVuIHdlIGFzayBmb3IgYSBjZXJ0YWluIElEIGFuZCB0aGF0IElEIHJlcGxpZXNcbiAgICAgICAgLy8gd2l0aGluIGFub3RoZXIgcXVlcnlcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIE5vdCBwb3NzaWJsZSB0byBoYW5kbGVcbiAgICAgICAgaWYgKCFxdWVyeS5pZHMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIGlmICghcS5nb3RJbml0aWFsUmVzcG9uc2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgIGlmIChxLnF1ZXJ5LmJyYW5jaElkICE9PSBxdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjsgLy8gSXQgd291bGQgYmUgY29tcGxleCB0byBzdXBwb3J0IHZhcmlvdXMgZmxhZ3MuIFF1ZXJ5J3MgZGF0YSBtYXkgaW5jbHVkZSBpZHMgb25seS4gQ2FuJ3QgcmVseSBvbiB0aGUgcXVlcnkuXG4gICAgICAgICAgICB2YXIgcUluY2x1ZGVzID0gcS5pbmNsdWRlcztcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaW5jbHVkZSwgYnV0IHRoaXMgcXVlcnkgZG9lcy4gQ2hlY2sgaWYgd2UgY2FuIGZpbmQgb3VyIHJlc3VsdCB3aXRoaW4gaXQuXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcUluY2x1ZGVzLmZpbmQoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3EudGFibGVdW1wicmVsYXRpb25zaGlwc1wiXVtsXSA9PT0gdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHEuZGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViRGF0YSA9IHF1ZXJ5QXJyYXkocXVlcnksIGVudGl0eVtsYWJlbF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IHJldHVybiByZXNfMVtyLmlkXSA9IHI7IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMSA9IE9iamVjdC5rZXlzKHJlc18xKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXNfMVtpZF07IH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaW5jbHVkZXMuZXZlcnkoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBxSW5jbHVkZXMuaW5jbHVkZXMobGFiZWwpOyB9KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgLy8gTGFzdGx5LCBpZiB0aGUgcXVlcnkgaW5jbHVkZXMgYWxsIGdyYXBocyB0aGF0IHdlIGRvLCBwaWNrIHRoZSBzdWJzZXQgZnJvbSB0aGF0IHF1ZXJ5LlxuICAgICAgICAgICAgLy8gQ29uY3JldGUgZXhhbXBsZTogV2Ugb2JzZXJ2ZSBhIGNlcnRhaW4gVGFzayBieSBJRCBhbmQgd2FudCBpdHMga25vd2xlZGdlUmVxdWlyZW1lbnRzIGFsb25nIHdpdGggaXQsXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxuICAgICAgICAgICAgaWYgKHEudGFibGUgPT09IHRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8yID0gcXVlcnlBcnJheShxdWVyeSwgcS5kYXRhKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5pZHMuZXZlcnkoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXN1bHRfMi5zb21lKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmlkID09PSBpZDsgfSk7IH0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHEgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoIWtiUXVlcnkpIHtcbiAgICAgICAgICAgIGtiUXVlcnkgPSBuZXcgS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgcmVwby5nZXRVc2VyKCksIHJlcG8sIHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoa2JRdWVyeS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGtiUXVlcnkuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoa2JRdWVyeSkge1xuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxuICAgICAgICAgICAga2JRdWVyeS51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgLy8gUmVsZWFzZSB1bm5lc2Nlc3NhcnkgbWVtb3J5IHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgc3Vic2NyaXB0aW9ucyBvZiB0aGlzIHF1ZXJ5LCBieSByZW1vdmluZyB0aGUgcXVlcnkgaXRzZWxmXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxuICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGluIDUgbWludXRlczpcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYga2JRdWVyeSBzdGlsbCBoYXMgbm8gc3Vic2NyaXB0aW9ucyAobm90IGNlcnRhaW4hIEEgbmV3IHN1YnNjcmliZXIgbWF5IGhhdmUgY29tZSBhbG9uZy4uLilcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcmllcyA9IF90aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxICE9PSBrYlF1ZXJ5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XG4gICAgICAgICAgICAgICAgICAgIDUwMCA6IC8vIERvbid0IGhvc3QgdG9vIG1hbnkgcXVlcmllcy4gR2FyYmFnZSBjb2xsZWN0IHRoaXMgd2l0aGluIDUwMCBtc1xuICAgICAgICAgICAgICAgICAgICA1ICogNjAwMDApOyAvLyBBbGxvdyBxdWVyeSBpbiBtZW1vcnkgZm9yIGFub3RoZXIgNSBtaW51dGVzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBRdWVyeVNldDtcbn0oKSk7XG5leHBvcnQgeyBRdWVyeVNldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWJsZUZyb21MYWJlbCh0YWJsZSwgbGFiZWwpIHtcbiAgICByZXR1cm4gdGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUFycmF5KHF1ZXJ5LCBkYXRhKSB7XG4gICAgdmFyIGZpbHRlciA9IGdldEZpbHRlckZyb21RdWVyeShxdWVyeSk7XG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XG59XG5leHBvcnQgZnVuY3Rpb24gQU5EKGZpbHRlcjEsIGZpbHRlcjIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpIHtcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgaWYgKHF1ZXJ5LmZyb20pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA+PSBxdWVyeS5mcm9tOyB9KTtcbiAgICBpZiAocXVlcnkudG8pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA8IHF1ZXJ5LnRvOyB9KTtcbiAgICBpZiAocXVlcnkuaWRzKVxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XG4gICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5uYW1lID09PSBxdWVyeS5uYW1lOyB9KTtcbiAgICBpZiAocXVlcnkudGFncylcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRhZ3MgJiYgW10uY29uY2F0KHF1ZXJ5LnRhZ3MgfHwgW10pLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4geC50YWdzLmluY2x1ZGVzKHRhZyk7IH0pOyB9KTtcbiAgICAvLyBxdWVyeS5oYXNFZGdlc0Zyb20gYW5kIHF1ZXJ5Lmhhc0VkZ2VzVG8gY2Fubm90IGJ5IGZpbHRlcmVkIGhlcmVcbiAgICByZXR1cm4gZmlsdGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJyYW5jaFNlbnNpdGl2ZShtKSB7XG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdsb2JhbE9wKG0pIHtcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSc7XG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcbiAgICBpZiAoY2xpZW50Ll9fbWlncmF0b3JfbWl4ZWRfaW4pXG4gICAgICAgIHJldHVybjtcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XG4gICAgdmFyIGdldCA9IGNsaWVudC5nZXQ7XG4gICAgdmFyIGxpc3QgPSBjbGllbnQubGlzdDtcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGllbnQubGlzdCA9IGZ1bmN0aW9uICh0YWJsZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gbWlncmF0ZShkb2MsIHRhYmxlLCBpbmNsdWRlICYmIGluY2x1ZGUudG9TdHJpbmcoKS5zcGxpdCgnLCcpKTsgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBjbGllbnQ7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVUYXNrIGZyb20gJy4vbWlncmF0ZS10YXNrJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVDb3Vyc2UoY291cnNlLCBncmFwaHMpIHtcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxuICAgICAgICBjb3Vyc2UubW9kdWxlcyA9IFtdO1xuICAgIGNvdXJzZS5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZSkge1xuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIG1vZHVsZS5yZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XG4gICAgICAgICAgICBtb2R1bGUudGFza0lkcyA9IFtdO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykge1xuICAgICAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xuICAgIH1cbiAgICAvLyBFYXJsaWVyIHdyb25nIHNwZWxsaW5nIG9mIHJlc291cmNlc1xuICAgIGlmICgncmVzb3Vyc2VzJyBpbiBjb3Vyc2UgJiYgISgncmVzb3VyY2VzJyBpbiBjb3Vyc2UpKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xuICAgICAgICBkZWxldGUgY291cnNlLnJlc291cnNlcztcbiAgICB9XG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBbXTtcbiAgICB9XG4gICAgaWYgKGdyYXBocykge1xuICAgICAgICBncmFwaHMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XG4gICAgICAgICAgICAgICAgICAgIGNvdXJzZS50YXNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXNrKSB7IHJldHVybiBtaWdyYXRlVGFzayh0YXNrKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLWNvdXJzZS5qcy5tYXAiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlVGFzayh0YXNrKSB7XG4gICAgaWYgKCF0YXNrLnJlc291cmNlcylcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtdGFzay5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZUNvdXJzZSBmcm9tICcuL21pZ3JhdGUtY291cnNlJztcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlKGRvYywgdGFibGUsIGdyYXBocykge1xuICAgIHN3aXRjaCAodGFibGUpIHtcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcbiAgICAgICAgICAgIG1pZ3JhdGVDb3Vyc2UoZG9jLCBncmFwaHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxuICAgICAgICAgICAgbWlncmF0ZVRhc2soZG9jKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xudmFyIENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB0aHJvdyBcIm1peGVkaW5cIjtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgdmFyIGVtaXR0ZXJfMSA9IG5ldyBFbWl0dGVyKHgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBlbWl0dGVyXzEuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYnNlcnZhYmxlQ29sbGVjdGlvbi5mcm9tKCkgY2FuIG9ubHkgdGFrZSBhcnJheXMgb3Igb2JzZXJ2YWJsZXNcIik7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIG1hcHBlcihpdGVtKTsgfSk7IH0pO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgaXRlbXMpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLmZpbHRlcihmaWx0ZXIpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5mcm9tKHRoaXMudG9WYWx1ZSgpLmNvbWJpbmVMYXRlc3Qob3RoZXIpLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IF9hWzBdLCBvdGhlciA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnJheSkgeyByZXR1cm4gYXJyYXkuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYVByb3AgPSBhICYmIGFbcHJvcF07XG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XG4gICAgICAgICAgICByZXR1cm4gYVByb3AgPiBiUHJvcCA/IDEgOiBhUHJvcCA8IGJQcm9wID8gLTEgOiAwO1xuICAgICAgICB9KTsgfSkudG9Db2xsZWN0aW9uKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnRvVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5ncm91cEJ5ID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBydiA9IHt9O1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnIpIHsgcmV0dXJuIGFyclswXTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcbn0oT2JzZXJ2YWJsZSkpO1xuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhFbWl0dGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVtaXR0ZXIoaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzICE9PSBvYnNlcnZlcjtcbiAgICAgICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVycy5wdXNoKFtvYnNlcnZlciwgc3Vic2NyaXB0aW9uXSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMuZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIoX3RoaXMudmFsdWUsIHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaCgpO1xuICAgIH07XG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEVtaXR0ZXI7XG59KFZhbHVlKSk7XG5leHBvcnQgeyBFbWl0dGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vb2JzZXJ2YWJsZSc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcbmV4cG9ydCAqIGZyb20gJy4vY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2VtaXR0ZXInO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIGluaXRNYXBNZXRob2QoY3Rvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgY3RvcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihtYXBwZXIodmFsdWUpLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1hcC5qcy5tYXAiLCJleHBvcnQgZnVuY3Rpb24gbWl4aW4odGFyZ2V0UHJvdG8sIG1peGluUHJvdG8pIHtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBwcm9wc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcHJvcHMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkgeyByZXR1cm4gdGFyZ2V0UHJvdG9bcHJvcF0gPSBtaXhpblByb3RvW3Byb3BdOyB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1peGluLmpzLm1hcCIsInZhciBPYnNlcnZhYmxlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8vc3RhdGljIGdldCBbU3ltYm9sLnNwZWNpZXNdKCkgeyByZXR1cm4gdGhpczsgfVxuICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoX3N1YnNjcmliZSkge1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBfc3Vic2NyaWJlO1xuICAgIH1cbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIoaXRlbXMsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVyciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCB7IHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7IH0gfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZhYmxlO1xufSgpKTtcbmV4cG9ydCB7IE9ic2VydmFibGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSBcIi4vY29sbGVjdGlvblwiO1xudmFyIFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFZhbHVlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZhbHVlKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBWYWx1ZS5mcm9tID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHguc3Vic2NyaWJlKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZS5mcm9tKCkgY2FuIG9ubHkgdGFrZSBvYnNlcnZhYmxlc1wiKTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgc3Vic2NpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGZuKHZhbHVlKSlcbiAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIH0pOyB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAocHJlZml4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJlZml4LCB4KTtcbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS50b0NvbGxlY3Rpb24gPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gX3RoaXMubWFwKG1hcHBlcikuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW251bGwsIG51bGxdO1xuICAgICAgICAgICAgdmFyIG15U3Vic2NyaXB0aW9uLCBvdGhlclN1YnNjcmlwdGlvbjtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24gPSBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSBpdGVtcztcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzWzFdICE9PSBudWxsKVxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZXMsIG51bGwsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG90aGVyU3Vic2NyaXB0aW9uID0gb3RoZXIuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1swXSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5zd2l0Y2hNYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICB2YXIgbWFwcGVkU3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICAgICAgdmFyIHJldHVybmVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGVkU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IHM7XG4gICAgICAgICAgICAgICAgaWYgKG1hcHBlZFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgcmV0dXJuZWRTdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGVPclZhbHVlID0gbWFwcGVyKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmFibGVPclZhbHVlICYmIHR5cGVvZiBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG9ic2VydmFibGVPclZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5lZFN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gVmFsdWU7XG59KE9ic2VydmFibGUpKTtcbmV4cG9ydCB7IFZhbHVlIH07XG5WYWx1ZS5wcm90b3R5cGUubWFwID0gaW5pdE1hcE1ldGhvZChWYWx1ZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWx1ZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwbyc7XG4iLCJ2YXIgbWFwID0ge1xuXHRcIi4vZW4tYXVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWF1LmpzXCIsXG5cdFwiLi9lbi1hdS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWNhXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1jYS5qc1wiLFxuXHRcIi4vZW4tY2EuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1nYlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tZ2IuanNcIixcblx0XCIuL2VuLWdiLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4taWVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWllLmpzXCIsXG5cdFwiLi9lbi1pZS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLW56XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vZW4tbnouanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLW56LmpzXCIsXG5cdFwiLi9zdlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIixcblx0XCIuL3N2LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9zdi5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHR2YXIgaWQgPSBtYXBbcmVxXTtcblx0aWYoIShpZCArIDEpKSB7IC8vIGNoZWNrIGZvciBudW1iZXIgb3Igc3RyaW5nXG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBpZDtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUgc3luYyByZWN1cnNpdmUgc3Z8ZW5cIjsiLCJpbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVzZXJDbGFpbXMgKHVzZXI6IFVzZXIpIHtcbiAgcmV0dXJuIFt7XG4gICAgdHlwZTogXCJlbWFpbFwiLFxuICAgIHZhbHVlOiB1c2VyLm1haWxcbiAgfSx7XG4gICAgdHlwZTogXCJzY2hvb2xcIixcbiAgICB2YWx1ZTogdXNlci5zY2hvb2xcbiAgfV0uY29uY2F0KHVzZXIucm9sZXMubWFwKHJvbGUgPT4gKHtcbiAgICB0eXBlOiBcInJvbGVcIixcbiAgICB2YWx1ZTogcm9sZVxuICB9KSkpLmNvbmNhdCh1c2VyLnJvbGVzLm1hcChyb2xlID0+ICh7XG4gICAgdHlwZTogXCJzY2hvb2xSb2xlXCIsXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sICsgXCIvXCIgKyByb2xlXG4gIH0pKSk7XG59XG4iLCJpbXBvcnQgeyBBY2Nlc3NDbGFpbSwgRG9jdW1lbnRBY2Nlc3MsIGhhc0FjY2VzcyBhcyBfaGFzQWNjZXNzLCBBY2Nlc3NSaWdodCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IERvY3VtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGdldFVzZXJDbGFpbXMgZnJvbSAnLi9nZXQtdXNlci1jbGFpbXMnO1xuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZyB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5leHBvcnQgeyBnZXRVc2VyQ2xhaW1zIH07XG5cbmV4cG9ydCBjb25zdCBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyA9IFtcInVzZXJcIixcInJvbGVcIixcInNjaG9vbFwiLFwiZGVidWdcIixcInRlc3RWZXJzaW9uXCIsXCJ0ZXN0dmVyc2lvblwiLFwic2Nob29sVHlwZVwiLFwic2Nob29sdHlwZVwiXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0FjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50LCByZXF1ZXN0ZWRSaWdodDogQWNjZXNzUmlnaHQpIHtcbiAgdmFyIGNsYWltcyA9IGdldFVzZXJDbGFpbXModXNlcik7XG4gIGlmIChyZXF1ZXN0ZWRSaWdodCAhPT0gJ1InICYmIHVzZXIudHV0b3JGb3IpIHtcbiAgICBjbGFpbXMgPSBjbGFpbXMuZmlsdGVyKGNsYWltID0+IGNsYWltLnR5cGUgIT09ICdlbWFpbCcpO1xuICB9XG4gIHZhciByZXN1bHQgPSBfaGFzQWNjZXNzKERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmdBcnJheShkb2MuYWNsIHx8IFtdKSwgY2xhaW1zLCByZXF1ZXN0ZWRSaWdodCk7XG4gIC8vY29uc29sZS5sb2coYEhhcyAke3JlcXVlc3RlZFJpZ2h0fSBhY2Nlc3MgdG8gJHtkb2MubmFtZX0vJHtkb2MuaWR9OiAke3Jlc3VsdH1gKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1JlYWRBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1InKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1dyaXRlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdXJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNTaGFyZUFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUycpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNUZWFjaGVyQXRTY2hvb2wodXNlcjogVXNlciwgc2Nob29sOiBzdHJpbmcpIHtcbiAgY29uc3QgaXNUZWFjaGVyID0gdXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ0VNUExPWUVFJyB8fCByb2xlID09PSAnQURNSU4nKTtcbiAgY29uc3QgYmVsb25nc1RvU2Nob29sID0gKHNjaG9vbHx8XCJcIikudG9Mb3dlckNhc2UoKSA9PT0gdXNlci5zY2hvb2wudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIChpc1RlYWNoZXIgJiYgYmVsb25nc1RvU2Nob29sKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQWRtaW5PclRlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xuICByZXR1cm4gdXNlci5yb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpIHx8IGlzVGVhY2hlckF0U2Nob29sKHVzZXIsIHNjaG9vbCk7XG59XG5cbmV4cG9ydCBjb25zdCBpbXBlcnNvbmF0aW9uRW52ID0ge1xuICBhY3RBcyAob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcbiAgICBjb25zdCB7cm9sZSwgc2Nob29sLCB1cmx9ID0gb3B0aW9ucztcbiAgICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XG4gICAgY29uc3QgbmV3UXVlcnkgPSB7Li4uY3VycmVudFF1ZXJ5LCByb2xlLCBzY2hvb2x9O1xuICAgIGNvbnN0IG5ld1F1ZXJ5U3RyaW5nID0gZ2VuZXJhdGVRdWVyeVN0cmluZyhuZXdRdWVyeSk7XG4gICAgaWYgKHVybCkge1xuICAgICAgbG9jYXRpb24uaHJlZiA9IGAke3VybH0ke25ld1F1ZXJ5U3RyaW5nfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSBcIiNcIjtcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCA9IG5ld1F1ZXJ5U3RyaW5nO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWN0QXMob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcbiAgaW1wZXJzb25hdGlvbkVudi5hY3RBcyhvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5ICh1cmw6IHN0cmluZywgcXVlcnk6IHtbbmFtZTogc3RyaW5nXSA6IHN0cmluZ30pIHtcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xuICBjb25zdCBwcmVzZXJ2ZWRRdWVyeSA9IHt9O1xuICBmb3IgKGNvbnN0IHBhcmFtIG9mIElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TKSB7XG4gICAgaWYgKGN1cnJlbnRRdWVyeVtwYXJhbV0pIHByZXNlcnZlZFF1ZXJ5W3BhcmFtXSA9IGN1cnJlbnRRdWVyeVtwYXJhbV07XG4gIH1cbiAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHsuLi5wcmVzZXJ2ZWRRdWVyeSwgLi4ucXVlcnl9KTtcbiAgY29uc3QgcEhhc2ggPSB1cmwuaW5kZXhPZignIycpO1xuICByZXR1cm4gcEhhc2ggPj0gMCA/XG4gICAgYCR7dXJsLnN1YnN0cigwLHBIYXNoKX0ke25ld1F1ZXJ5U3RyaW5nfSR7dXJsLnN1YnN0cihwSGFzaCl9YCA6XG4gICAgYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcbn1cbiIsImltcG9ydCB7IEVEU0NvdXJzZSwgRURTQXNzZXNzbWVudCwgRURTU3R1ZHlQbGFuLCBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eSwgRURTU3R1ZGVudCB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgUmVzdENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IElzb21vcnBoaWNFbnYsIEJlYXJlclByb3ZpZGVyLCBIdHRwRXJyb3IgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBTY2hvb2xNb21lbnQgfSBmcm9tICcuLi91dGlscy9zY2hvb2wtbW9tZW50JztcbmltcG9ydCB7IFNjaG9vbFRlcm0gfSBmcm9tICcuLi91dGlscy9zY2hvb2wtdGVybSc7XG5pbXBvcnQgeyBkYXRlVGltZVJldml2ZXIsIEwgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBFZHNDbGllbnQge1xuICBodHRwOiBSZXN0Q2xpZW50O1xuICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmc7XG5cbiAgY29uc3RydWN0b3IgKFxuICAgIGlzb21vcnBoaWM6IElzb21vcnBoaWNFbnYsXG4gICAgYmFzZVVybDogc3RyaW5nLFxuICAgIGJlYXJlclByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcixcbiAgICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmdcbiAgKSB7XG4gICAgdGhpcy5odHRwID0gbmV3IFJlc3RDbGllbnQgKGlzb21vcnBoaWMsIGJhc2VVcmwsIHtiZWFyZXJQcm92aWRlcn0pO1xuICAgIHRoaXMudXNlckVtYWlsR2V0dGVyID0gdXNlckVtYWlsR2V0dGVyO1xuICAgIHRoaXMuZ2V0QWN0aXZlQ291cnNlcyA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldEFjdGl2ZUNvdXJzZXMpO1xuICAgIHRoaXMuZ2V0TGF0ZXN0QXNzZXNzbWVudHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRMYXRlc3RBc3Nlc3NtZW50cyk7XG4gICAgdGhpcy5nZXRTdHVkZW50R29hbHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRTdHVkZW50R29hbHMpO1xuICAgIHRoaXMuZ2V0U3R1ZGVudEZ1dHVyZUFiaWxpdGllcyA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMpO1xuICAgIHRoaXMuZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRUZWFjaGVyVHV0b3JTdHVkZW50cyk7XG4gIH1cblxuICBwcml2YXRlIHByaXZhdGl6aW5nQ2FjaGVCdXN0KCkge1xuICAgIHJldHVybiB7dXNlcjogdGhpcy51c2VyRW1haWxHZXR0ZXIoKX07XG4gIH1cblxuLyoqXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxuICAgKlxuICAgKiBAcGFyYW0gY291cnNlQ29kZSBTaG9ydC1uYW1lIG9mIHRoZSBjb3Vyc2UuIE9wdGlvbmFsLlxuICAgKi9cbiAgYXN5bmMgZ2V0QWN0aXZlQ291cnNlcyhxOiB7Y291cnNlQ29kZT86IHN0cmluZywgcGVyaW9kTmFtZTogc3RyaW5nfSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgICBpZiAocSkge1xuICAgICAgICBpZiAocS5jb3Vyc2VDb2RlKSBxdWVyeS5Db3Vyc2VDb2RlID0gcS5jb3Vyc2VDb2RlO1xuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhY3RpdmVjb3Vyc2VzXCIsIHF1ZXJ5KTtcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgcmV0dXJuIGpzb24uY291cnNlcyBhcyBFRFNDb3Vyc2VbXTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZyb20gRURTOiBcIiArIGV4KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihMYEt1bmRlIHR5dsOkcnIgaW50ZSBsYWRkYSB0ZXJtaW5zbcOlbCBlbGxlciBhdmtsYXJhZGUgc3RlZyBmcsOlbiBFRFMuIEbDtnJzw7ZrIGlnZW4gc2VuYXJlLi4uYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlIGxhdGVzdCBhc3Nlc3NtZW50cyBmb3IgY3VycmVudCBsb2dnZWQgaW4gdXNlci5cbiAgICogXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxuICAgKi9cbiAgYXN5bmMgZ2V0TGF0ZXN0QXNzZXNzbWVudHMobGltaXQ/OiBudW1iZXIpIHtcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgaWYgKCFpc05hTihsaW1pdCkpIHF1ZXJ5LkNvdW50ID0gbGltaXQ7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhc3Nlc3NtZW50c1wiLCBxdWVyeSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLmFzc2Vzc21lbnRzIGFzIEVEU0Fzc2Vzc21lbnRbXTsgICAgXG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxuICAgKi9cbiAgYXN5bmMgZ2V0U3R1ZGVudEdvYWxzKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcbiAgfVxuXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRGdXR1cmVBYmlsaXRpZXNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEZ1dHVyZUFiaWxpdGllcyBhcyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInRlYWNoZXJ0dXRvcnN0dWRlbnRzXCIsIHRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnN0dWRlbnRzIGFzIEVEU1N0dWRlbnRbXTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRURTUGVyaW9kIHtcbiAgcGVyaW9kOiBzdHJpbmc7XG4gIHRlcm06ICdBVCcgfCAnU1QnO1xuICB5ZWFyOiBudW1iZXI7XG4gIGNvbnN0cnVjdG9yIChwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm06IHN0cmluZyB8IFNjaG9vbE1vbWVudCkge1xuICAgIGlmICh0eXBlb2YgcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5wZXJpb2QgPSBwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm07XG4gICAgICB0aGlzLnRlcm0gPSB0aGlzLnBlcmlvZC5zdGFydHNXaXRoKCdIVCcpID8gJ0FUJyA6ICdTVCc7XG4gICAgICB0aGlzLnllYXIgPSBwYXJzZUludCh0aGlzLnBlcmlvZC5zdWJzdHIoMikpO1xuICAgICAgaWYgKGlzTmFOKHRoaXMueWVhcikpIHRocm93IG5ldyBFcnJvciAoYEludmFsaWQgcGVyaW9kOiAke3RoaXMucGVyaW9kfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzY2hvb2xUZXJtID0gbmV3IFNjaG9vbFRlcm0ocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtKTtcbiAgICAgIHRoaXMucGVyaW9kID0gKHNjaG9vbFRlcm0udGVybSA9PT0gJ0FUJyA/IFwiSFRcIiA6IFwiVlRcIikgKyBzY2hvb2xUZXJtLnllYXI7XG4gICAgICB0aGlzLnRlcm0gPSBzY2hvb2xUZXJtLnRlcm07XG4gICAgICB0aGlzLnllYXIgPSBzY2hvb2xUZXJtLnllYXI7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNjaG9vbFRlcm0gKCkgOiBTY2hvb2xUZXJtIHtcbiAgICByZXR1cm4gbmV3IFNjaG9vbFRlcm0oe1xuICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAgICBgJHt0aGlzLnllYXJ9LyR7dGhpcy55ZWFyICsgMX1gIDpcbiAgICAgICAgYCR7dGhpcy55ZWFyLTF9LyR7dGhpcy55ZWFyfWAsXG4gICAgICB0ZXJtOiB0aGlzLnRlcm1cbiAgICB9KTtcbiAgfVxuXG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnBlcmlvZDtcbiAgfVxuXG4gIHZhbHVlT2YoKSB7XG4gICAgcmV0dXJuIHRoaXMueWVhciArIFwiOlwiICsgKHRoaXMudGVybSA9PT0gJ1NUJyA/IFwiMVwiIDogXCIyXCIpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25EYXRlX29sZCAoanNvbkRhdGVTdHI6IHN0cmluZykgOiBEYXRlIHtcbiAgY29uc3QgZGF0ZSA9IGRhdGVUaW1lUmV2aXZlcihcIlwiLCBqc29uRGF0ZVN0cik7XG4gIGlmICghKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBKU09OIGRhdGUgc3RyaW5nOiBcIiArIGpzb25EYXRlU3RyKTtcbiAgcmV0dXJuIGRhdGU7XG59XG5cbmZ1bmN0aW9uIGF2b2lkU2ltdWx0YW5vdXNDYWxsczxULEE+KG1ldGhvZDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPikgOiAoLi4uYXJnczpBW10pPT5Qcm9taXNlPFQ+IHtcbiAgbGV0IG9uZ29pbmdQcm9taXNlczoge1thcmdzSnNvbjogc3RyaW5nXTogUHJvbWlzZTxUPn0gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3NKc29uID0gSlNPTi5zdHJpbmdpZnkoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcbiAgICBpZiAoIW9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0pIHtcbiAgICAgIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0gPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKHJlc3VsdD0+e1xuICAgICAgICBkZWxldGUgb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcbiAgfVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGNvdXJzZU5hbWVUb0Nzc0NsYXNzKGNzc1ByZWZpeDogc3RyaW5nLCBjb3Vyc2VOYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGAke2Nzc1ByZWZpeH0ke2NvdXJzZU5hbWUuc3Vic3RyKDAsMykudG9Mb3dlckNhc2UoKX1gO1xufVxuIiwiaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgaXNUZWFjaGVyQXRTY2hvb2wgfSBmcm9tICcuLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0VtcGxveWVlKGF0U2Nob29sPzogc3RyaW5nKSB7XG4gIHJldHVybiBhdFNjaG9vbCA/XG4gICAgaXNUZWFjaGVyQXRTY2hvb2woZW52LmN1cnJlbnRVc2VyLCBhdFNjaG9vbCkgfHwgZW52LmN1cnJlbnRVc2VyLnJvbGVzLmluY2x1ZGVzKFwiQURNSU5cIikgOlxuICAgIGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ0VNUExPWUVFJyB8fCByb2xlID09PSAnQURNSU4nKTtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgb25DbGljayxcbiAgY2xhc3NOYW1lPyxcbiAgc3R5bGU/LFxuICB0aXRsZT9cbn07XG5cbmV4cG9ydCBjb25zdCBSZW1vdmVJdGVtID0gKHsgb25DbGljaywgY2xhc3NOYW1lLCBzdHlsZSwgdGl0bGUgfTogUHJvcHMpID0+XG5cbiAgPGRpdlxuICAgIHRpdGxlPXt0aXRsZSB8fCBMYFJhZGVyYWB9XG4gICAgY2xhc3NOYW1lPXtcInJlbW92ZUl0ZW0gXCIgKyAoY2xhc3NOYW1lIHx8IFwiXCIpfVxuICAgIG9uQ2xpY2s9e29uQ2xpY2t9IHN0eWxlPXtzdHlsZX0gLz5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuZXhwb3J0IGNvbnN0IFNwaW5uZXIgPSAoKT0+IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4mbmJzcDs8L3NwYW4+O1xuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IERvY3VtZW50LCBSZXNvdXJjZSwgTW9kaWZpY2F0aW9uVHJhY2tlZCwgQ291cnNlLCBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBnZXRGaXJzdEFuZExhc3RXZWVrT2ZUZXJtIH0gZnJvbSAnLi4vLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVEb2N1bWVudEdyYXBocyhvbGREb2MsIG5ld0RvYywgdGFibGU6IHN0cmluZywgZ3JhcGhzOiB7IFtsYWJlbDogc3RyaW5nXTogc3RyaW5nIH0sIGJhdGNoOiBCYXRjaFJ1bm5lcikge1xuICBjb25zdCBkb2NVcGRhdGVzID0ge307XG4gIGNvbnN0IGRvY0lkID0gbmV3RG9jLmlkO1xuICBmb3IgKGxldCBuYXZQcm9wIG9mIE9iamVjdC5rZXlzKGdyYXBocykpIHtcbiAgICBjb25zdCBmb3JlaWduVGFibGUgPSBncmFwaHNbbmF2UHJvcF07XG4gICAgY29uc3Qgb2xkTGlzdDogRG9jdW1lbnRbXSA9IG9sZERvY1tuYXZQcm9wXSB8fCBbXTtcbiAgICBjb25zdCBuZXdMaXN0OiBEb2N1bWVudFtdID0gbmV3RG9jW25hdlByb3BdO1xuICAgIGlmICghbmV3TGlzdCkgY29udGludWU7XG4gICAgY29uc3QgdHVwbGVzID0gbmV3TGlzdFxuICAgICAgLm1hcCgoZG9jLCBpZHgpPT4oe2RvYywgaWR4fSkpOyAvLyBDcmVhdGUgdHVibGVzIG9mIHtkb2MsIGFycmF5LWluZGV4fSBzbyB3ZSBjYW4gdXBkYXRlIHJlc3VsdFxuICAgIGNvbnN0IGFkZGVkID0gdHVwbGVzLmZpbHRlcih0dXBsZSA9PiAhb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkKSk7IC8vIEZpbmQgYWRkZWQgaXRlbXNcblxuICAgIGZvciAobGV0IGEgb2YgYWRkZWQpIHtcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4uYS5kb2N9O1xuICAgICAgY29uc3QgbWV0YSA9IG11dGF0ZWRTdWJEb2MuJG1ldGE7XG4gICAgICBkZWxldGUgbXV0YXRlZFN1YkRvYy4kbWV0YTsgLy8gRGVsZXRlICRtZXRhIHNvIHRoYXQgXCJhZGRcIiBvciBcInVwZGF0ZVwiIGRvZXMgbm90IHBlcnNpc3RlIHRvIG5leHQgc3RhdGUuXG4gICAgICBpZiAobWV0YSA9PT0gJ2FkZCcpIHtcbiAgICAgICAgaWYgKCFtdXRhdGVkU3ViRG9jLmlkKSBtdXRhdGVkU3ViRG9jLmlkID0gY3JlYXRlVVVJRCgpOyAvLyBHZW5lcmF0ZSBJRCBpZiBub3QgZG9uZSB5ZXQuXG4gICAgICAgIC8vIE5vdyBwdXQgYW4gJ2FkZCcgbXV0YXRpb24gaW4gdGhlIGJhdGNoIHF1ZXVlLlxuICAgICAgICBiYXRjaC5hZGQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcbiAgICAgIH0gZWxzZSBpZiAobWV0YSA9PT0gJ3VwZGF0ZScpIHtcbiAgICAgICAgYmF0Y2gucHV0KGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYyk7XG4gICAgICB9XG4gICAgICBiYXRjaC5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jLmlkLCBuYXZQcm9wKTtcblxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0IHN0YXRlIGlzIHJlZmxlY3RlZCBhZnRlciBzdWNjZXNmdWwgUE9TVCB0byBzZXJ2ZXIuXG4gICAgICBpZiAoIWRvY1VwZGF0ZXNbbmF2UHJvcF0pIGRvY1VwZGF0ZXNbbmF2UHJvcF0gPSB7fTtcbiAgICAgIGRvY1VwZGF0ZXNbbmF2UHJvcF1bYS5pZHhdID0geyRzZXQ6IG11dGF0ZWRTdWJEb2N9O1xuICAgIH1cbiAgICBjb25zdCByZW1vdmVkID0gb2xkTGlzdC5maWx0ZXIobyA9PiAhbmV3TGlzdC5zb21lKG4gPT4gbi5pZCA9PT0gby5pZCkpO1xuICAgIGZvciAobGV0IHIgb2YgcmVtb3ZlZCkge1xuICAgICAgYmF0Y2gudW5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCByLmlkLCBuYXZQcm9wKTtcbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZCA9IHR1cGxlcy5maWx0ZXIodHVwbGUgPT4gb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkICYmIHR1cGxlLmRvYy4kbWV0YSA9PT0gJ3VwZGF0ZScpKTtcbiAgICBmb3IgKGxldCB1IG9mIHVwZGF0ZWQpIHtcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4udS5kb2N9O1xuICAgICAgZGVsZXRlIG11dGF0ZWRTdWJEb2MuJG1ldGE7XG4gICAgICBiYXRjaC5wdXQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcblxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0ICRtZXRhIGlzIHJlbW92ZWQgZnJvbSBuYXZpZ2F0aW9uIHByb3AgYWZ0ZXIgc3VjY2Vzc2Z1bCBQT1NUIHRvIHNlcnZlci5cbiAgICAgIGlmICghZG9jVXBkYXRlc1tuYXZQcm9wXSkgZG9jVXBkYXRlc1tuYXZQcm9wXSA9IHt9O1xuICAgICAgZG9jVXBkYXRlc1tuYXZQcm9wXVt1LmlkeF0gPSB7JHNldDogbXV0YXRlZFN1YkRvY307XG4gICAgfVxuICB9XG4gIHJldHVybiB1cGRhdGUobmV3RG9jLCBkb2NVcGRhdGVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGR0Rm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCBISDptbScpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvcnREYXRlRm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvcnRQZXJzb25OYW1lRm9ybWF0KG5hbWU6IHN0cmluZykge1xuICBpZiAoIW5hbWUpIHJldHVybiBcIlwiO1xuICBjb25zdCBuYW1lcyA9IG5hbWUuc3BsaXQoJyAnKS5maWx0ZXIobiA9PiAhIW4pO1xuICBjb25zdCBsYXN0TmFtZSA9IG5hbWVzLnBvcCgpO1xuICByZXR1cm4gbmFtZXMubWFwKG5hbWUgPT4gYCR7bmFtZVswXX0uYCkuY29uY2F0KGxhc3ROYW1lKS5qb2luKCcgJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNb2RpZmljYXRpb25TdGFtcCAobm93OiBudW1iZXIsIG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xuICByZXR1cm4gdXBkYXRlKG9iaiwge1xuICAgIGRhdGVUaW1lOiB7JHNldDogbm93fSwgLy8gRm9yIHF1ZXJpZXMuLi5cbiAgICBtb2RpZmllZERhdGU6IHskc2V0OiBub3d9LFxuICAgIG1vZGlmaWVkQnk6IHtcbiAgICAgICRzZXQ6IHtcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDcmVhdGlvblN0YW1wIChub3c6IG51bWJlciwgb2JqOiBNb2RpZmljYXRpb25UcmFja2VkLCB1c2VyOiBVc2VyKSB7XG4gIHJldHVybiB1cGRhdGUob2JqLCB7XG4gICAgY3JlYXRlZERhdGU6IHskc2V0OiBEYXRlLm5vdygpfSxcbiAgICBjcmVhdGVkQnk6IHtcbiAgICAgICRzZXQ6IHtcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhvYmo6IE1vZGlmaWNhdGlvblRyYWNrZWQsIHVzZXI6IFVzZXIpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgb2JqID0gdXBkYXRlTW9kaWZpY2F0aW9uU3RhbXAobm93LCBvYmosIHVzZXIpO1xuICBpZiAoIW9iai5jcmVhdGVkQnkpIG9iaiA9IHVwZGF0ZUNyZWF0aW9uU3RhbXAobm93LCBvYmosIHVzZXIpO1xuICByZXR1cm4gb2JqO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlFdGFncyhkb2M6IERvY3VtZW50LCBuZXdFdGFnczoge1tpZDogc3RyaW5nXTogc3RyaW5nfSwgZ3JhcGhzOiBzdHJpbmdbXSkge1xuICBjb25zdCByZXMgPSB7Li4uZG9jfTtcbiAgY29uc3QgZXRhZyA9IG5ld0V0YWdzW2RvYy5pZF07XG4gIGlmIChldGFnKVxuICAgIHJlcy4kZXRhZyA9IGV0YWc7XG4gIGZvciAobGV0IGxhYmVsIG9mIGdyYXBocykge1xuICAgIGNvbnN0IG5ld0xpc3QgPSBkb2NbbGFiZWxdLm1hcChkID0+IGFwcGx5RXRhZ3MoZCwgbmV3RXRhZ3MsIFtdKSk7XG4gICAgcmVzW2xhYmVsXSA9IG5ld0xpc3Q7XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iKGJsb2I6IEJsb2IsIG06IChyOkZpbGVSZWFkZXIpPT52b2lkKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICByZWFkZXIub25sb2FkID0gZXYgPT4gcmVzb2x2ZSgoZXYudGFyZ2V0IGFzIGFueSkucmVzdWx0KTtcbiAgICByZWFkZXIub25hYm9ydCA9IGV2ID0+IHJlamVjdChuZXcgRXJyb3IoXCJmaWxlIHJlYWQgYWJvcnRlZFwiKSk7XG4gICAgcmVhZGVyLm9uZXJyb3IgPSBldiA9PiByZWplY3QoKGV2LnRhcmdldCBhcyBhbnkpLmVycm9yKTtcbiAgICBtKHJlYWRlcik7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQgKGJsb2I6IEJsb2IpIHtcbiAgcmV0dXJuIHJlYWRCbG9iKGJsb2IsIHI9PnIucmVhZEFzVGV4dChibG9iKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYkFzRGF0YVVybCAoYmxvYjogQmxvYikge1xuICByZXR1cm4gcmVhZEJsb2IoYmxvYiwgcj0+ci5yZWFkQXNEYXRhVVJMKGJsb2IpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFsbG93Q29weShlOiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5Jztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNvdXJzZUJ1aWxkZXJTdGF0dXMoc3RhdHVzOiAndW5zYXZlZCcgfCAnc2F2ZWQnIHwgJ2Vycm9yJyB8ICcnKSB7XG4gIGNvbnN0IGRpdiA9ICQoJ2Rpdi5jb3Vyc2UtYnVpbGRlcicpWzBdO1xuICBpZiAoZGl2KSBkaXYuY2xhc3NOYW1lID0gXCJjb3Vyc2UtYnVpbGRlclwiICsgKHN0YXR1cyA/IFwiIHN0YXR1cyBcIiArIHN0YXR1cyA6IFwiXCIpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZENvdXJzZShpZDogc3RyaW5nLCBvcHRpb25zPzoge1xuICAgIGluY2x1ZGVUZW1wbGF0ZUNoYWluPzogYm9vbGVhbixcbiAgICBpbmNsdWRlPzogc3RyaW5nW11cbiAgfSk6IFByb21pc2U8Q291cnNlPlxue1xuICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudDtcbiAgY29uc3QgaW5jbHVkZVRlbXBsYXRlQ2hhaW4gPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZVRlbXBsYXRlQ2hhaW47XG4gIGNvbnN0IGluY2x1ZGVUYXNrcyA9ICFvcHRpb25zIHx8ICFvcHRpb25zLmluY2x1ZGUgfHwgb3B0aW9ucy5pbmNsdWRlLmluZGV4T2YoXCJ0YXNrc1wiKSAhPT0gLTE7XG4gIGNvbnN0IFtjb3Vyc2UsIGNvdXJzZVRhc2tzLCB0ZW1wbGF0ZUNoYWluXSA9IChhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgY2xpZW50LmdldChcImNvdXJzZXNcIiwgaWQsIHtcbiAgICAgIGluY2x1ZGU6IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlID8gb3B0aW9ucy5pbmNsdWRlLmZpbHRlcihpID0+IGkgIT09IFwidGFza3NcIikgOiBbXG4gICAgICAgIFwiY2VudHJhbENvbnRlbnRcIixcbiAgICAgICAgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIixcbiAgICAgICAgXCJhYmlsaXRpZXNcIixcbiAgICAgICAgXCJpbWFnZXNcIixcbiAgICAgICAgXCJhY2xcIiAvLyBEb24ndCBpbmNsdWRlIHRhc2tzIGhlcmUuLi5cbiAgICAgIF1cbiAgICB9KSxcbiAgICAvLyAuLi4gYnV0IGluY2x1ZGUgdGFza3MgaGVyZSBpbnN0ZWFkIHNvIHRoYXQgd2UgY2FuIGxvYWQgdGhlIGdyYXBocyBmb3IgdGhlXG4gICAgLy8gdGFza3MgYXMgd2VsbCFcbiAgICBpbmNsdWRlVGFza3MgJiYgY2xpZW50Lmxpc3QoXCJ0YXNrc1wiLCB7XG4gICAgICBoYXNFZGdlc0Zyb206IGlkLFxuICAgICAgaW5jbHVkZTogWydrbm93bGVkZ2VSZXF1aXJlbWVudHMnLCAnY2VudHJhbENvbnRlbnQnLCAnYWJpbGl0aWVzJywgJ2FjbCddLFxuICAgICAgZmxhZ3M6IFsnaW5jbHVkZUlkc09ubHknXSAvLyBEb24ndCBuZWVkIHJlZHVuZGFudCBpbmZvIHRoYXQncyBhbHJlYWR5IG9uIGNvdXJzZVxuICAgIH0pLFxuICAgIGluY2x1ZGVUZW1wbGF0ZUNoYWluICYmIGNsaWVudC5saXN0KFwiY291cnNlc1wiLCB7XG4gICAgICBoYXNFZGdlc0Zyb206IGlkLFxuICAgICAgZmxhZ3M6IFsnaWRzT25seSddXG4gICAgfSlcbiAgXSkpIGFzIFtDb3Vyc2UsIFRhc2tbXSwgQ291cnNlW11dO1xuICBjb3Vyc2UudGFza3MgPSBjb3Vyc2VUYXNrcztcblxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBBYmlsaXRpZXNcbiAgaWYgKGNvdXJzZS5hYmlsaXRpZXMgJiYgY291cnNlLmFiaWxpdGllc09yZGVyKSB7XG4gICAgY291cnNlLmFiaWxpdGllcyA9IGNvdXJzZS5hYmlsaXRpZXNPcmRlci5tYXAoaWQgPT5cbiAgICAgIGNvdXJzZS5hYmlsaXRpZXMuZmluZChhID0+IGEuaWQgPT09IGlkKSk7XG4gIH1cblxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBLbm93bGVkZ2VSZXF1aXJlbWVudHNcbiAgaWYgKGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMgJiYgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyKSB7XG4gICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cyA9IGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlci5tYXAoaWQgPT5cbiAgICAgIGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZChjID0+IGMuaWQgPT09IGlkKSk7XG4gIH1cblxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBDZW50cmFsQ29udGVudFxuICBpZiAoY291cnNlLmNlbnRyYWxDb250ZW50ICYmIGNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyKSB7XG4gICAgY291cnNlLmNlbnRyYWxDb250ZW50ID0gY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIubWFwKGlkID0+XG4gICAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQuZmluZChjYyA9PiBjYy5pZCA9PT0gaWQpKTsvLy5maWx0ZXIoeCA9PiAhIXgpOy8vIERlYnVnZ2luZyBzb210aGluJyAuIE5vcm1hbGx5IHRoZSBsYXN0IC5maWx0ZXIoKS4uLiBwYXJ0IHNob3VsZCBub3QgYmUgbmVzY2Vzc2FyeS4uLlxuICB9XG4gIFxuICAvLyBJbmNsdWRlIHRlbXBsYXRlIGNoYWluIGlmIHJlcXVlc3RlZC5cbiAgaWYgKGluY2x1ZGVUZW1wbGF0ZUNoYWluKSBjb3Vyc2UudGVtcGxhdGVDaGFpbiA9IHRlbXBsYXRlQ2hhaW47XG4gIHJldHVybiBjb3Vyc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNNaWdyYXRlZFRleHRzKHRhc2s6IFRhc2spIHtcbiAgcmV0dXJuIHRhc2subWlncmF0ZWRUZXh0cyAmJiBPYmplY3Qua2V5cyh0YXNrLm1pZ3JhdGVkVGV4dHMpLnNvbWUodHlwZSA9PlxuICAgIE9iamVjdC5rZXlzKHRhc2subWlncmF0ZWRUZXh0c1t0eXBlXSkubGVuZ3RoID4gMCk7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5cbnR5cGUgQ2FsbGJhY2sgPSAoKT0+dm9pZDtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGl0bGU6IHN0cmluZyxcbiAgYmFja2dyb3VuZEltYWdlOiBzdHJpbmcsXG4gIHRhYnM6IHtuYW1lOiBzdHJpbmcgfCBKU1guRWxlbWVudCwga2V5Pzogc3RyaW5nLCBsaW5rOiBzdHJpbmd9W10sXG4gIGFjdGl2ZVRhYjogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBDb3Vyc2VCYW5uZXIgPSAocHJvcHM6IFByb3BzKSA9PiB7XG4gIGNvbnN0IHsgdGl0bGUsIGJhY2tncm91bmRJbWFnZSwgdGFicywgYWN0aXZlVGFiIH0gPSBwcm9wcztcblxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAge2JhY2tncm91bmRJbWFnZSAmJiA8c3R5bGU+e2BcbiAgICAgICAgLnBhZ2VIZWFkZXIge1xuICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHtiYWNrZ3JvdW5kSW1hZ2V9JykgIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgICAgYH08L3N0eWxlPn1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlSGVhZGVyXCI+XG4gICAgICAgICAgPGE+XG4gICAgICAgICAgICA8aDE+e3RpdGxlfTwvaDE+XG4gICAgICAgICAgPC9hPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uc0ZpZWxkXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbnNDb250YWluZXJcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+PC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdob3Jpem9udGFsTWVudSc+XG4gICAgICAgICAgICAgICAgPHVsPlxuICAgICAgICAgICAgICAgICAge3RhYnMubWFwKCh7bmFtZSwga2V5LCBsaW5rfSwgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQWN0aXZlID0gYWN0aXZlVGFiID09PSBsaW5rO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGxpIGtleT17a2V5IHx8ICh0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycgPyBuYW1lIDogaWR4KX0gY2xhc3NOYW1lPXtpc0FjdGl2ZSA/IFwiYWN0aXZlUGFnZVwiIDogXCJcIn0+XG4gICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17bGlua30+e25hbWV9PC9hPlxuICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMLCBhcnJheVRvTG9va3VwIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZSB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2tub3dsZWRnZS1yZXF1aXJlbWVudHMtdGFibGVcIjtcbmltcG9ydCBnZXRJbmNsdWRlZElkcyBmcm9tICcuLi91dGlscy9nZXQtaW5jbHVkZWQtaWRzJztcbmltcG9ydCB7IEFiaWxpdGllc0JveCB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2FiaWxpdGllcy1ib3hcIjtcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveFwiO1xuaW1wb3J0IHsgTGVhcm5pbmdHb2Fsc0xpc3QgfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL2xlYXJuaW5nLWdvYWxzLWxpc3QnO1xuaW1wb3J0IHsgVGFza0xpc3QgfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL3Rhc2stbGlzdCc7XG5pbXBvcnQgeyBnZXRDdXN0b21pemVkVGFzayB9IGZyb20gJy4vZ2V0LWN1c3RvbWl6ZWQtdGFzayc7XG5cbi8vIFZpZXdzXG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGNvdXJzZTogQ291cnNlO1xuICBtb2R1bGU6IENvdXJzZU1vZHVsZTtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbn1cblxuZXhwb3J0IGNsYXNzIENvdXJzZU1vZHVsZVBhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IG1vZHVsZSwgY291cnNlIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGluY2x1ZWRJZHMgPSBnZXRJbmNsdWRlZElkcyhtb2R1bGUsIGNvdXJzZSk7XG4gICAgY29uc3QgbGVhcm5pbmdUYXNrcyA9IG1vZHVsZS50YXNrSWRzXG4gICAgICAubWFwKGlkID0+IGNvdXJzZS50YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gaWQpKVxuICAgICAgLmZpbHRlcih0YXNrID0+ICEhdGFzaylcbiAgICAgIC5tYXAodGFzayA9PiAoe1xuICAgICAgICBpZDogdGFzay5pZCxcbiAgICAgICAgdGFzazogZ2V0Q3VzdG9taXplZFRhc2sobW9kdWxlLCB0YXNrKSxcbiAgICAgICAgY291cnNlLFxuICAgICAgICBuYW1lOiB0YXNrLm5hbWUsXG4gICAgICAgIHVybDogYCMke2VuY29kZVVSSUNvbXBvbmVudChtb2R1bGUubmFtZS50cmltKCkpfS8ke3Rhc2suaWR9YCwgLy8gRsO2cnPDpHR0c2JsYWRldHMgVVJMXG4gICAgICAgIGNvdXJzZU5hbWU6IGNvdXJzZS5uYW1lLFxuICAgICAgICBsZWFybmluZ0dvYWw6IHRhc2subGVhcm5pbmdHb2FsIHx8IG1vZHVsZS5uYW1lLFxuICAgICAgfSkpO1xuICAgIGNvbnN0IGFzc2lnbm1lbnRUYXNrcyA9IGxlYXJuaW5nVGFza3MuZmlsdGVyKHQgPT4gdC50YXNrICYmIHQudGFzay5hc3NpZ25tZW50KTtcbiAgICBjb25zdCBub25Bc3NpZ25tZW50VGFza3MgPSBsZWFybmluZ1Rhc2tzLmZpbHRlcih0ID0+ICF0LnRhc2sgfHwgIXQudGFzay5hc3NpZ25tZW50KTtcbiAgICBjb25zdCBjb21tb25UYXNrcyA9IG5vbkFzc2lnbm1lbnRUYXNrcy5maWx0ZXIodCA9PiAhdC50YXNrLmxlYXJuaW5nR29hbCk7XG4gICAgY29uc3QgbGVhcm5pbmdHb2FscyA9IGFycmF5VG9Mb29rdXAoXG4gICAgICBub25Bc3NpZ25tZW50VGFza3MuZmlsdGVyKHQgPT4gISF0LnRhc2subGVhcm5pbmdHb2FsKSxcbiAgICAgIHQgPT4gdC5sZWFybmluZ0dvYWwpO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQgc3YtdXNlLW1hcmdpbnMgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxuICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJoMVwiPnttb2R1bGUubmFtZX08L2gxPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi12ZXJ0aWNhbCBzdi1sYXlvdXRcIj5cbiAgICAgICAgPGRpdiBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IG1vZHVsZS5tYW5kYXRvcnlDb250ZW50IH19PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XG4gICAgICAgICAgPGgzPk1vZHVsZW5zIGt1bnNrYXBza3JhdiwgZsO2cm3DpWdvciBvY2ggY2VudHJhbGEgaW5uZWjDpWxsPC9oMz5cbiAgICAgICAgICB7KCEhbW9kdWxlLnN0YXJ0V2VlayB8fCAhIW1vZHVsZS5lbmRXZWVrKSAmJiA8ZGl2IGNsYXNzTmFtZT1cIndlZWstcGVyaW9kLWRpdlwiPlxuICAgICAgICAgICAgPGRpdj5TdGFydHZlY2thPC9kaXY+XG4gICAgICAgICAgICA8ZGl2Pnttb2R1bGUuc3RhcnRXZWVrIHx8IFwiLS1cIn08L2Rpdj5cbiAgICAgICAgICAgIDxkaXY+U2x1dHZlY2thPC9kaXY+XG4gICAgICAgICAgICA8ZGl2Pnttb2R1bGUuZW5kV2VlayB8fCBcIi0tXCJ9PC9kaXY+XG4gICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgPGhyIC8+XG5cbiAgICAgICAgICA8S25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGVcbiAgICAgICAgICAgIHRpdGxlPVwiSSBkZW4gaMOkciBtb2R1bGVuIGJlZMO2bXMgZsO2bGphbmRlIGt1bnNrYXBza3JhdlwiXG4gICAgICAgICAgICByZXF1aXJlbWVudHM9e2NvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHN9XG4gICAgICAgICAgICBpbmNsdWRlZElkcz17aW5jbHVlZElkc30gLz5cblxuICAgICAgICAgIDxBYmlsaXRpZXNCb3hcbiAgICAgICAgICAgIHRpdGxlPVwiRGVuIGjDpHIgbW9kdWxlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGbDtnJtw6Vnb3JcIlxuICAgICAgICAgICAgYWJpbGl0aWVzPXtjb3Vyc2UuYWJpbGl0aWVzLmZpbHRlcihhID0+IGluY2x1ZWRJZHNbYS5pZF0pfSAvPlxuXG4gICAgICAgICAgPENlbnRyYWxDb250ZW50Qm94XG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIG1vZHVsZW4gYmVoYW5kbGFyIGbDtmxqYW5kZSBjZW50cmFsYSBpbm5laMOlbGxcIlxuICAgICAgICAgICAgY2VudHJhbENvbnRlbnQ9e2NvdXJzZS5jZW50cmFsQ29udGVudC5maWx0ZXIoYyA9PiBpbmNsdWVkSWRzW2MuaWRdKX0gLz5cblxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7bW9kdWxlLnRhc2tJZHMubGVuZ3RoID4gMCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgICAgICB7YXNzaWdubWVudFRhc2tzLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IDw+XG4gICAgICAgICAgICA8aDI+SW5sw6RtbmluZ3N1cHBnaWZ0ZXI8L2gyPlxuICAgICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgICA8VGFza0xpc3QgbGVhcm5pbmdUYXNrcz17YXNzaWdubWVudFRhc2tzfSAvPlxuICAgICAgICAgIDwvPn1cbiAgICAgICAgICB7bm9uQXNzaWdubWVudFRhc2tzLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IDw+XG4gICAgICAgICAgICA8aDI+VXBwZ2lmdGVyPC9oMj5cbiAgICAgICAgICAgIDxociAvPlxuICAgICAgICAgICAgPExlYXJuaW5nR29hbHNMaXN0XG4gICAgICAgICAgICAgIGNvbW1vblRhc2tzPXtjb21tb25UYXNrc31cbiAgICAgICAgICAgICAgbGVhcm5pbmdHb2Fscz17T2JqZWN0LmtleXMobGVhcm5pbmdHb2FscykubWFwKGxlYXJuaW5nR29hbCA9PiAoe1xuICAgICAgICAgICAgICAgIG5hbWU6IGxlYXJuaW5nR29hbCxcbiAgICAgICAgICAgICAgICBsZWFybmluZ1Rhc2tzOiBsZWFybmluZ0dvYWxzW2xlYXJuaW5nR29hbF1cbiAgICAgICAgICAgICAgfSkpfSAvPlxuICAgICAgICAgICAgPC8+fVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2Pn1cbiAgICAgIHttb2R1bGUucmVzb3VyY2VzLmxlbmd0aCA+IDAgJiYgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiPlxuICAgICAgICAgIDxoMj5SZXN1cnNlcjwvaDI+XG4gICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+e21vZHVsZS5yZXNvdXJjZXMubWFwKChyLCBpZHgpID0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2lkeH0+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgPGEgaHJlZj17ci51cmx9PntyLm5hbWV9PC9hPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+fVxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgeyBDb3Vyc2VNb2R1bGUsIFRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1c3RvbWl6ZWRUYXNrKG1vZHVsZTogQ291cnNlTW9kdWxlLCB0YXNrOiBUYXNrKSB7XG4gIHJldHVybiBtb2R1bGUudGFza0N1c3RvbWl6YXRpb25zID9cbiAgICB7Li4udGFzaywgLi4ubW9kdWxlLnRhc2tDdXN0b21pemF0aW9uc1t0YXNrLmlkXX0gOlxuICAgIHRhc2s7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMLCBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IHBhcnNlSGFzaFF1ZXJ5U3RyaW5nIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xuaW1wb3J0IHsgQ291cnNlTW9kdWxlUGFnZSB9IGZyb20gJy4vY291cnNlLW1vZHVsZS1wYWdlJztcbmltcG9ydCB7IFJ1blVwUGFnZSB9IGZyb20gJy4vcnVuLXVwLXBhZ2UnO1xuaW1wb3J0IHsgaW5pdE1hbnVhbFNjcm9sbFJlc3RvcmF0aW9uLCByZXN0b3JlU2Nyb2xsUG9zaXRpb24gfSBmcm9tICcuLi91dGlscy9tYW51YWwtc2Nyb2xsLXJlc3RvcmF0aW9uJztcbmltcG9ydCB7IGhhc1dyaXRlQWNjZXNzLCBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gJy4uLy4uLy4uL2FjY2Vzcy1jb250cm9sJztcbmltcG9ydCB7IFdlZWtQbGFubmVyIH0gZnJvbSBcIi4uLy4uL3dlZWtwbGFubmVyXCI7XG5pbXBvcnQgeyBUYXNrUGFnZSB9IGZyb20gXCIuL3Rhc2stcGFnZVwiO1xuaW1wb3J0IHsgZ2V0Q3VzdG9taXplZFRhc2sgfSBmcm9tICcuL2dldC1jdXN0b21pemVkLXRhc2snO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjb3Vyc2U6IENvdXJzZTtcbiAgY291cnNlQnVpbGRlclVybDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBtb2R1bGU6IENvdXJzZU1vZHVsZSB8IG51bGw7XG4gIHRhc2s6IFRhc2sgfCBudWxsO1xufVxuXG5cbmluaXRNYW51YWxTY3JvbGxSZXN0b3JhdGlvbigpO1xuXG5leHBvcnQgY2xhc3MgQ291cnNlUGFnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5vbkhhc2hDaGFuZ2UgPSB0aGlzLm9uSGFzaENoYW5nZS5iaW5kKHRoaXMpO1xuICAgIGNvbnN0IHttb2R1bGUsIHRhc2t9ID0gdGhpcy5nZXRNb2R1bGVBbmRUYXNrRnJvbUhhc2goKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgbW9kdWxlLFxuICAgICAgdGFza1xuICAgIH07XG4gIH1cblxuICBnZXRNb2R1bGVBbmRUYXNrRnJvbUhhc2goKSB7XG4gICAgbGV0IHNwbGl0ID0gKGxvY2F0aW9uLmhhc2guc3Vic3RyKDEpIHx8IFwiXCIpLnNwbGl0KCcvJyk7XG4gICAgaWYgKHNwbGl0Lmxlbmd0aCA+IDAgJiYgIXNwbGl0WzBdKSBzcGxpdCA9IHNwbGl0LnNsaWNlKDEpOyAvLyBBbGxvdyBsZWFkaW5nIHNsYXNoICMvbW9kdWxlL3Rhc2tcbiAgICBjb25zdCBbbW9kdWxlTmFtZSwgdGFza0lkXSA9IHNwbGl0Lm1hcChwYXJ0ID0+IGRlY29kZVVSSUNvbXBvbmVudChwYXJ0KSk7XG4gICAgbGV0IG1vZHVsZSA9IHRoaXMucHJvcHMuY291cnNlLm1vZHVsZXNcbiAgICAgIC5maWx0ZXIobSA9PiAobS5uYW1lIHx8IFwiXCIpXG4gICAgICAgIC50cmltKCkudG9Mb3dlckNhc2UoKSA9PT0gKG1vZHVsZU5hbWUgfHwgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCkpWzBdIHx8IG51bGw7XG4gICAgbGV0IHRhc2sgPSB0YXNrSWQgP1xuICAgICAgdGhpcy5wcm9wcy5jb3Vyc2UudGFza3MuZmluZCh0ID0+IHQuaWQgPT09IHRhc2tJZCkgfHwgbnVsbCA6XG4gICAgICBudWxsO1xuICAgIGlmICh0YXNrICYmICFtb2R1bGUpIHtcbiAgICAgIC8vIFJlc29sdmUgbW9kdWxlIGJ5IGZpbmRpbmcgdGhlIG1vZHVsZSB0aGF0IGhvbGRzIHRoZSB0YXNrOlxuICAgICAgbW9kdWxlID0gdGhpcy5nZXRPcmRlcmVkTW9kdWxlcygpXG4gICAgICAgIC5maWx0ZXIobSA9PiBtLnRhc2tJZHNcbiAgICAgICAgICAuc29tZSh0YXNrSWQgPT4gdGFzay5pZCA9PT0gdGFza0lkKSlbMF07XG4gICAgfVxuICAgIGlmICh0YXNrICYmIG1vZHVsZSkge1xuICAgICAgdGFzayA9IGdldEN1c3RvbWl6ZWRUYXNrKG1vZHVsZSwgdGFzayk7XG4gICAgfVxuICAgIHJldHVybiB7bW9kdWxlLCB0YXNrfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy5vbkhhc2hDaGFuZ2UpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLm9uSGFzaENoYW5nZSk7XG4gIH1cblxuICBvbkhhc2hDaGFuZ2UoKSB7XG4gICAgY29uc3Qge21vZHVsZSwgdGFza30gPSB0aGlzLmdldE1vZHVsZUFuZFRhc2tGcm9tSGFzaCgpO1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgbW9kdWxlLFxuICAgICAgdGFza1xuICAgIH0sICgpPT57XG4gICAgICBcbiAgICAgIGxldCBmYWxsYmFja1Njcm9sbFBvc2l0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKHRhc2spIHtcbiAgICAgICAgY29uc3QgdGFza0FuY2hvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZWQtdGFzay1hbmNob3InKTtcbiAgICAgICAgaWYgKHRhc2tBbmNob3IpIGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gPSAod2luZG93LnBhZ2VZT2Zmc2V0ICsgdGFza0FuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3ApO1xuICAgICAgICBlbHNlIGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gPSAwO1xuICAgICAgfVxuICAgICAgcmVzdG9yZVNjcm9sbFBvc2l0aW9uKHtmYWxsYmFja1Njcm9sbFBvc2l0aW9ufSk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRPcmRlcmVkTW9kdWxlcygpIHtcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBtb2R1bGVPcmRlciA9IGNvdXJzZS5tb2R1bGVPcmRlciB8fCBjb3Vyc2UubW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcbiAgICByZXR1cm4gbW9kdWxlT3JkZXJcbiAgICAgIC8vIE1hcCBvcmRlcmVkIGlkIHRvIG1vZHVsZVxuICAgICAgLm1hcChpZCA9PiBjb3Vyc2UubW9kdWxlcy5maW5kKG0gPT4gbS5pZCA9PT0gaWQpKVxuICAgICAgLy8gSWdub3JlIGVudHJpZXMgdGhhdCBvbmx5IGV4aXN0cyBpbiBtb2R1bGVPcmRlciBidXQgbm90IGluIG1vZHVsZXNcbiAgICAgIC5maWx0ZXIobSA9PiAhIW0pXG4gICAgICAvLyBBcHBlbmQgbW9kdWxlcyBhdCBlbmQgdGhhdCBhcmUgbm90IGxpc3RlZCBpbiBtb2R1bGVPcmRlclxuICAgICAgLmNvbmNhdCAoY291cnNlLm1vZHVsZXMuZmlsdGVyKG0gPT4gIW1vZHVsZU9yZGVyLmZpbmQoaWQgPT4gbS5pZCA9PT0gaWQpKSk7XG4gIH0gIFxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7Y291cnNlLCBjb3Vyc2VCdWlsZGVyVXJsfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qge21vZHVsZSwgdGFza30gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IG9yZGVyZWRNb2R1bGVzID0gdGhpcy5nZXRPcmRlcmVkTW9kdWxlcygpO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPENvdXJzZUJhbm5lclxuICAgICAgICB0aXRsZT17Y291cnNlLm5hbWUgKyBcIiAtIFwiICsgY291cnNlLnBvaW50cyArIFwicFwifVxuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U9eyhjb3Vyc2UuaW1hZ2VzLmZpbmQoaW1nID0+IGltZy5pZCA9PT0gY291cnNlLmltYWdlSWQpIHx8IHt1cmw6Jyd9KS51cmx9XG4gICAgICAgIHRhYnM9e1t7bmFtZTogXCJVcHB0YWt0XCIgYXMgc3RyaW5nIHwgSlNYLkVsZW1lbnQsIGxpbms6IFwiI1wiLCBrZXk6IFwiVXBwdGFrdFwifV1cbiAgICAgICAgICAuY29uY2F0KG9yZGVyZWRNb2R1bGVzLm1hcCgoeyBuYW1lIH0pID0+ICh7IG5hbWUsIGxpbms6IFwiI1wiICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBrZXk6IG5hbWUgfSkpKVxuICAgICAgICAgIC5jb25jYXQoY291cnNlLndvcmtGbG93TGluayA/IFt7XG4gICAgICAgICAgICBuYW1lOiBcIkFyYmV0c2fDpW5nXCIsXG4gICAgICAgICAgICBrZXk6IFwid29ya2Zsb3dcIixcbiAgICAgICAgICAgIGxpbms6IGNvdXJzZS53b3JrRmxvd0xpbmtcbiAgICAgICAgICB9XSA6IFtdKVxuICAgICAgICAgIC5jb25jYXQoaGFzV3JpdGVBY2Nlc3MoZW52LmN1cnJlbnRVc2VyLCBjb3Vyc2UpID8gW3tcbiAgICAgICAgICAgIG5hbWU6IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXBlbmNpbFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gUmVkaWdlcmEgZGVubmEga3Vyczwvc3Bhbj4sXG4gICAgICAgICAgICBrZXk6IFwiZWRpdFwiLFxuICAgICAgICAgICAgbGluazogYCR7cHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkoY291cnNlQnVpbGRlclVybCwge30pfSMvY291cnNlcy8ke2NvdXJzZS5pZH0vZWRpdGB9XSA6IFtdKVxuXG4gICAgICAgIH1cbiAgICAgICAgYWN0aXZlVGFiPXttb2R1bGUgPyBcIiNcIitlbmNvZGVVUklDb21wb25lbnQobW9kdWxlLm5hbWUpIDogXCIjXCJ9XG4gICAgICAvPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0XCJcbiAgICAgICAgLy9pZD1cImtlZC10YXNrLWFuY2hvclwiIC8vIEZvciB3aW5kb3cuc2Nyb2xsVG8gdG8gcG9zaXRpb24gaGVyZSEuIFNraXBwaW5nIHRoaXMuIHNjcm9sbCB0byB0b3AgaW5zdGVhZCFcbiAgICAgID5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zcGFjZXItMjBweHZ0IHN2LXZlcnRpY2FsIHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tN1wiPlxuICAgICAgICAgICAgICAgICAge3Rhc2sgP1xuICAgICAgICAgICAgICAgICAgICA8VGFza1BhZ2UgdGFzaz17dGFza30gY291cnNlPXtjb3Vyc2V9IC8+IDpcbiAgICAgICAgICAgICAgICAgICBtb2R1bGUgP1xuICAgICAgICAgICAgICAgICAgICA8Q291cnNlTW9kdWxlUGFnZSBjb3Vyc2U9e2NvdXJzZX0gbW9kdWxlPXttb2R1bGV9IC8+IDpcbiAgICAgICAgICAgICAgICAgICAgPFJ1blVwUGFnZSBjb3Vyc2U9e2NvdXJzZX0gLz59XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3YtY29sdW1uLTVcIj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8V2Vla1BsYW5uZXIgdmlld0NvdXJzZVVybD17Jyd9IGVudj17ZW52fS8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52Jztcbi8vIFZpZXdzXG5pbXBvcnQgeyBBYmlsaXRpZXNCb3ggfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL2FiaWxpdGllcy1ib3gnO1xuaW1wb3J0IHsgQ2VudHJhbENvbnRlbnRCb3ggfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL2NlbnRyYWwtY29udGVudC1ib3gnO1xuaW1wb3J0IHsgS25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGUgfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL2tub3dsZWRnZS1yZXF1aXJlbWVudHMtdGFibGUnO1xuaW1wb3J0IHsgUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy9yZXNvdXJjZS1saXN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY291cnNlOiBDb3Vyc2U7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG59XG5cbmV4cG9ydCBjbGFzcyBSdW5VcFBhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7fVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgIHtjb3Vyc2UucnVuVXBUZXh0ICYmIDxkaXY+XG4gICAgICAgICAgICA8aDE+VXBwdGFrdDwvaDE+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJub3JtYWxcIiBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogY291cnNlLnJ1blVwVGV4dH19IC8+XG4gICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgIHtjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyAmJiBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycy5sZW5ndGggPiAwICYmIDxkaXY+XG4gICAgICAgICAgICA8aDI+TMOkcmFyZTwvaDI+XG4gICAgICAgICAgICB7Y291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMubWFwKCh0ZWFjaGVyLCBpKSA9PlxuICAgICAgICAgICAgICA8cCBrZXk9e2l9PjxhIGhyZWY9e2ludGVycHJldFRlYWNoZXJVcmwodGVhY2hlci51cmwpfT57dGVhY2hlci5uYW1lfTwvYT48L3A+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICB7Y291cnNlLndvcmtGbG93TGluayAmJiA8YSBjbGFzc05hbWU9XCJidG5cIiBocmVmPXtjb3Vyc2Uud29ya0Zsb3dMaW5rfT5BcmJldHNnw6VuZzwvYT59XG4gICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgPEFiaWxpdGllc0JveFxuICAgICAgICAgICAgdGl0bGU9XCLDhG1uZXRzIGbDtnJtw6Vnb3JcIlxuICAgICAgICAgICAgc3ViVGl0bGU9XCJGw7ZybcOlZ29yXCJcbiAgICAgICAgICAgIGFiaWxpdGllcz17Y291cnNlLmFiaWxpdGllc31cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiIC8+XG5cbiAgICAgICAgICA8Q2VudHJhbENvbnRlbnRCb3hcbiAgICAgICAgICAgIHRpdGxlPVwiS3Vyc2VucyBjZW50cmFsYSBpbm5laMOlbGxcIlxuICAgICAgICAgICAgc3ViVGl0bGU9XCJDZW50cmFsdCBpbm5laMOlbGxcIlxuICAgICAgICAgICAgY2VudHJhbENvbnRlbnQ9e2NvdXJzZS5jZW50cmFsQ29udGVudH1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiIC8+XG5cbiAgICAgICAgICA8S25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGVcbiAgICAgICAgICAgIHRpdGxlPVwiS3Vyc2VucyBrdW5za2Fwc2tyYXZcIlxuICAgICAgICAgICAgcmVxdWlyZW1lbnRzPXtjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzfVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibGFyZ2VyXCIgLz5cblxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2NvdXJzZS5yZXNvdXJjZXMubGVuZ3RoID4gMCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgICAgICAgIDxoMj5SZXN1cnNlcjwvaDI+XG4gICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgIDxSZXNvdXJjZUxpc3QgcmVzb3VyY2VzPXtjb3Vyc2UucmVzb3VyY2VzfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj59XG4gICAgICA8L2Rpdj5cbiAgfVxufVxuXG5mdW5jdGlvbiBpbnRlcnByZXRUZWFjaGVyVXJsKHVybDogc3RyaW5nKSB7XG4gIGlmICh1cmwuaW5kZXhPZignOicpID09PSAtMSAmJiB1cmwuaW5kZXhPZignQCcpID49IDApIHJldHVybiBcIm1haWx0bzpcIiArIHVybDtcbiAgcmV0dXJuIHVybDtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEFzc2lnbm1lbnQsIFVya3VuZFJlc3BvbnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgc2hvd0Vycm9yLCBjb21wYXJlUHJvcHMgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBIdHRwRXJyb3IsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBoYXNXcml0ZUFjY2VzcywgaXNUZWFjaGVyQXRTY2hvb2wgfSBmcm9tICcuLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5pbXBvcnQgZG93bmxvYWQgZnJvbSAnZG93bmxvYWRqcyc7XG5pbXBvcnQge1xuICBnZXRVcmt1bmRTaWduaWZpY2FuY2VDbGFzcyxcbiAgZ2V0VXJrdW5kU3RhdHVzQ2xhc3MsXG4gIGdldFVya3VuZEhvdmVyVGV4dH0gZnJvbSAnLi91cmt1bmQtdXRpbHMnO1xuaW1wb3J0IHsgaXNFbXBsb3llZSB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyLWtzL2xvZ2ljL2lzLWVtcGxveWVlJztcblxuY29uc3QgTUFYX1VSS1VORF9GSUxFX1NJWkVfTUIgPSA1MDtcbmNvbnN0IE1BWF9OT05VUktVTkRfRklMRV9TSVpFX01CID0gMTAwO1xuY29uc3QgQUxMT1dFRF9FWFRFTlNJT05TID0gW1xuICBcIi5wZGZcIixcbiAgXCIub2R0XCIsXG4gIFwiLmRvY3hcIixcbiAgXCIuZG9jXCIsXG4gIFwiLmNhZFwiLFxuICBcIi53YXZcIixcbiAgXCIubXAzXCIsXG4gIFwiLm1wZWc0XCIsXG4gIFwiLm1wNFwiLFxuICBcIi56aXBcIixcbiAgXCIucG5nXCIsXG4gIFwiLmpwZ1wiLFxuICBcIi5qcGVnXCIsXG4gIFwiLmdpZlwiXG5dO1xuY29uc3QgVVJLVU5EX0VYVEVOU0lPTlMgPSBbXG4gIFwiLnBkZlwiLFxuICBcIi5vZHRcIixcbiAgXCIuZG9jeFwiLFxuICBcIi5kb2NcIlxuXTtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY291cnNlSWQ6IHN0cmluZztcbiAgdGFza0lkOiBzdHJpbmc7XG4gIHNjaG9vbDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBhc3NpZ25tZW50czogQXNzaWdubWVudFtdO1xuICBsb2FkaW5nOiBib29sZWFuO1xuICB1cGxvYWRpbmdGaWxlPzogRmlsZTtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBUYXNrQXNzaWdubWVudHMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGFzc2lnbm1lbnRzOiBbXSxcbiAgICAgIGxvYWRpbmc6IHRydWVcbiAgICB9O1xuICB9XG5cbiAgc2V0U3RhdGVQcm9taXNlZChjYjogKHByZXZTdGF0ZTogUmVhZG9ubHk8U3RhdGU+LCBwcm9wczogUHJvcHMpID0+IFBhcnRpYWw8U3RhdGU+KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3VwZXIuc2V0U3RhdGUoY2IgYXMgYW55LCByZXNvbHZlKSk7XG4gIH0gIFxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMubG9hZCgpO1xuICB9XG5cbiAgYXN5bmMgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChuZXh0UHJvcHMudGFza0lkICE9PSB0aGlzLnByb3BzLnRhc2tJZCB8fFxuICAgICAgICAgIG5leHRQcm9wcy5jb3Vyc2VJZCAhPT0gdGhpcy5wcm9wcy5jb3Vyc2VJZClcbiAgICAgIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKCgpPT4oe1xuICAgICAgICAgIGFzc2lnbm1lbnRzOiBbXSxcbiAgICAgICAgICBsb2FkaW5nOiB0cnVlXG4gICAgICAgIH0pKTtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBzaG93RXJyb3IoZXJyKTtcbiAgICB9XG4gIH1cblxuICB1cGRhdGUoYXNzaWdubWVudHM6IEFzc2lnbm1lbnRbXSwgYXNzaWdubWVudDogQXNzaWdubWVudCk6IEFzc2lnbm1lbnRbXSB7XG4gICAgY29uc3QgcmV0dmFsID0gW1xuICAgICAgYXNzaWdubWVudCxcbiAgICAgIC4uLmFzc2lnbm1lbnRzLmZpbHRlcigoe3VzZXIsIGZpbGVuYW1lfSkgPT5cbiAgICAgICAgdXNlciAhPT0gYXNzaWdubWVudC51c2VyIHx8XG4gICAgICAgIGZpbGVuYW1lICE9PSBhc3NpZ25tZW50LmZpbGVuYW1lKV07XG4gICAgcmV0dXJuIHJldHZhbDtcbiAgfVxuXG4gIGFzeW5jIHJlZnJlc2hBc3NpZ25tZW50KGFzc2lnbm1lbnQ6IEFzc2lnbm1lbnQpIHtcbiAgICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudC5odHRwO1xuICAgIGNvbnN0IHtjb3Vyc2VJZCwgdGFza0lkLCBzY2hvb2x9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7dXNlciwgZmlsZW5hbWV9ID0gYXNzaWdubWVudDtcbiAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xuICAgICAgYXNzaWdubWVudHM6IHRoaXMudXBkYXRlKGFzc2lnbm1lbnRzLCB7Li4uYXNzaWdubWVudCwgaXNSZWZyZXNoaW5nOiB0cnVlfSlcbiAgICB9KSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcSA9IGF3YWl0IGNsaWVudC5nZXQoYGFzc2lnbm1lbnRzL3Vya3VuZC8ke3NjaG9vbH0vJHtjb3Vyc2VJZH0vJHt0YXNrSWR9LyR7dXNlcn0vJHtmaWxlbmFtZX1gKTtcbiAgICAgIGlmIChyZXEuc3RhdHVzID49IDQwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXEuc3RhdHVzLCBhd2FpdCByZXEudGV4dCgpKTtcbiAgICAgIGNvbnN0IHJlc0pzb24gPSBhd2FpdCByZXEudGV4dCgpO1xuICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSgoe2Fzc2lnbm1lbnRzfSkgPT4gKHtcbiAgICAgICAgYXNzaWdubWVudHM6IHRoaXMudXBkYXRlKGFzc2lnbm1lbnRzLCB7Li4uYXNzaWdubWVudCwgaXNSZWZyZXNoaW5nOiBmYWxzZSwgbWV0YWRhdGE6IHtcbiAgICAgICAgICAuLi5hc3NpZ25tZW50Lm1ldGFkYXRhLFxuICAgICAgICAgIHVya3VuZFJlc3BvbnNlOiByZXNKc29uXG4gICAgICAgIH19KVxuICAgICAgfSkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0U3RhdGUoKHthc3NpZ25tZW50c30pID0+ICh7XG4gICAgICAgIGFzc2lnbm1lbnRzOiB0aGlzLnVwZGF0ZShhc3NpZ25tZW50cywge1xuICAgICAgICAgIC4uLmFzc2lnbm1lbnQsXG4gICAgICAgICAgaXNSZWZyZXNoaW5nOiBmYWxzZSxcbiAgICAgICAgICByZWZyZXNoRXJyb3I6IGVcbiAgICAgICAgfSlcbiAgICAgIH0pKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudC5odHRwO1xuICAgICAgY29uc3Qge2NvdXJzZUlkLCB0YXNrSWQsIHNjaG9vbH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3QgdGVhY2hlckF0U2Nob29sID0gaXNUZWFjaGVyQXRTY2hvb2woZW52LmN1cnJlbnRVc2VyLCBzY2hvb2wpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgKHRlYWNoZXJBdFNjaG9vbCA/XG4gICAgICAgIGNsaWVudC5nZXQoYGFzc2lnbm1lbnRzLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH1gKSA6XG4gICAgICAgIGNsaWVudC5nZXQoYGFzc2lnbm1lbnRzLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH0vJHtlbnYuY3VycmVudFVzZXIubWFpbH1gKSk7XG4gICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFzc2lnbm1lbnRzID0gYXdhaXQgcmVzLmpzb24oKSBhcyBBc3NpZ25tZW50W107XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgICAgICBhc3NpZ25tZW50c1xuICAgICAgfSk7XG4gICAgICBpZiAodGVhY2hlckF0U2Nob29sKSB7XG4gICAgICAgIGNvbnN0IHJlZnJlc2hhYmxlQXNzaWdtZW50cyA9IGFzc2lnbm1lbnRzLmZpbHRlcihhID0+XG4gICAgICAgICAgYS5tZXRhZGF0YSAmJiAvLyBNdXN0IGhhdmUgbWV0YWRhdGEudXJrdW5kRXh0ZXJuYWxJZCBPdGhlcndpc2Ugbm90IHBvc3NpYmxlIHRvIHJlZnJlc2hcbiAgICAgICAgICAhYS5tZXRhZGF0YS51cmt1bmRVcGxvYWRFcnJvciAmJiAoIC8vIE5vdCBwb3NzaWJsZSB0byByZWZyZXNoIGlmIHVwbG9hZCBoYXMgZmFpbGVkXG4gICAgICAgICAgICAhYS5tZXRhZGF0YS51cmt1bmRMYXN0UG9sbCB8fCAvLyBOZXZlciBjaGVja2VkIHN0YXR1cyB5ZXRcbiAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgWydBY2NlcHRlZCcsICdTdWJtaXR0ZWQnXS5pbmRleE9mKChKU09OLnBhcnNlKGEubWV0YWRhdGEudXJrdW5kUmVzcG9uc2UpWzBdIGFzIFVya3VuZFJlc3BvbnNlKS5TdGF0dXMuU3RhdGUpID49IDAgJiZcbiAgICAgICAgICAgICAgcGFyc2VJbnQoYS5tZXRhZGF0YS51cmt1bmRMYXN0UG9sbCkgPCBtb21lbnQoKS5hZGQoLTE1LCBcInNlY29uZHNcIikudG9EYXRlKCkuZ2V0VGltZSgpKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLy8gQ2hlY2tlZCBzdGF0dXMgZm9yIGEgbG9uZyB0aW1lIGFnb1xuICAgICAgICAgICk7XG4gICAgICAgIGZvciAobGV0IGEgb2YgcmVmcmVzaGFibGVBc3NpZ21lbnRzKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoQXNzaWdubWVudChhKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgbG9hZGluZzogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgS3VuZGUgaW50ZSBsYWRkYSBpbmzDpG1uaW5nc3VwcGdpZnRlcmAsXG4gICAgICAgIGFzc2lnbm1lbnRzOiBbXVxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBvbkRyYWcgKGV2OiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XG4gICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICBldi5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5JztcbiAgfVxuICBcbiAgYXN5bmMgdmVyaWZ5QW5kVXBsb2FkKGZpbGU6IEZpbGUpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFmaWxlKSByZXR1cm47XG4gICAgICBpZiAodGhpcy5zdGF0ZS5hc3NpZ25tZW50cy5zb21lKGEgPT5cbiAgICAgICAgYS51c2VyID09PSBlbnYuY3VycmVudFVzZXIubWFpbCAmJlxuICAgICAgICBhLmZpbGVuYW1lID09PSBmaWxlLm5hbWUpKVxuICAgICAge1xuICAgICAgICBpZiAoIWNvbmZpcm0oYEVyc8OkdHRhIGJlZmludGxpZyBmaWwgKCR7ZmlsZS5uYW1lfSk/YCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnByb3BzLnNjaG9vbC50b0xvd2VyQ2FzZSgpICE9PSBlbnYuY3VycmVudFVzZXIuc2Nob29sLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgaWYgKCFjb25maXJtKGBVcHBnaWZ0ZW4gdGlsbGjDtnIgZW4gYW5uYW4gc2tvbGEgKCR7dGhpcy5wcm9wcy5zY2hvb2x9KS5cXG5gK1xuICAgICAgICAgIGBWaWxsIGR1IMOkbmTDpSBsw6RtbmEgaW4gZGl0dCBhcmJldGUgaMOkcj9gKSlcbiAgICAgICAge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBsb2FkaW5nRmlsZTogZmlsZX0pO1xuICAgICAgYXdhaXQgdGhpcy51cGxvYWQoZmlsZSk7XG4gICAgICBhd2FpdCB0aGlzLmxvYWQoKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB1cGxvYWRpbmdGaWxlOiBudWxsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGVycm9yOiBcIkt1bmRlIGludGUgbGFkZGEgdXBwIGZpbGVuLiBcIiArIChlcnJvci5tZXNzYWdlIHx8IGVycm9yKSxcbiAgICAgICAgdXBsb2FkaW5nRmlsZTogbnVsbFxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9XG4gIH1cbiAgXG4gIGFzeW5jIHVwbG9hZChmaWxlOiBGaWxlKSB7XG4gICAgY29uc3QgY2xpZW50ID0gZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cDtcbiAgICBjb25zdCB7Y291cnNlSWQsIHRhc2tJZCwgc2Nob29sfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qge21haWx9ID0gZW52LmN1cnJlbnRVc2VyO1xuICAgIGNvbnN0IGlzVXJrdW5kRXh0ZW5zaW9uID0gVVJLVU5EX0VYVEVOU0lPTlNcbiAgICAgIC5pbmRleE9mKFwiLlwiK2ZpbGUubmFtZS5zcGxpdCgnLicpLnJldmVyc2UoKVswXS50b0xvd2VyQ2FzZSgpKSA+PSAwO1xuICAgIGlmIChpc1Vya3VuZEV4dGVuc2lvbikge1xuICAgICAgaWYgKGZpbGUuc2l6ZSA+IE1BWF9VUktVTkRfRklMRV9TSVpFX01CICogMTAyNCAqIDEwMjQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlciBhdiBkZW5uYSB0eXAgZsOlciBpbnRlIHZhcmEgc3TDtnJyZSDDpG4gJHtNQVhfVVJLVU5EX0ZJTEVfU0laRV9NQn0gTUJgKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGZpbGUuc2l6ZSA+IE1BWF9OT05VUktVTkRfRklMRV9TSVpFX01CICogMTAyNCAqIDEwMjQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlbiBmw6VyIGludGUgdmFyYSBzdMO2cnJlIMOkbiAke01BWF9OT05VUktVTkRfRklMRV9TSVpFX01CfSBNQmApO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBsb3dlckZpbGVuYW1lID0gZmlsZS5uYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKCFBTExPV0VEX0VYVEVOU0lPTlMuc29tZShleHQgPT4gbG93ZXJGaWxlbmFtZS5lbmRzV2l0aChleHQpKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlbnMgw6RuZGVsc2UgbcOlc3RlIHZhcmEgJHtBTExPV0VEX0VYVEVOU0lPTlMuam9pbignIC8gJyl9YCk7XG4gICAgfVxuICAgIGNvbnN0IGJvZHkgPSBuZXcgRm9ybURhdGEoKTtcbiAgICBib2R5LmFwcGVuZCgnZmlsZXMnLCBmaWxlKTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKFxuICAgICAgYGFzc2lnbm1lbnRzLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH0vJHttYWlsfWAsXG4gICAgICAncHV0JyxcbiAgICAgIHt9LFxuICAgICAge1xuICAgICAgICB1c2VyRGlzcGxheU5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgYm9keVxuICAgICAgfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkb3dubG9hZChmaWxlOiBBc3NpZ25tZW50KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHAuZmV0Y2goZmlsZS5tZWRpYUxpbmssICdnZXQnLCB7fSk7XG4gICAgICBpZiAocmVzLnN0YXR1cyA+PSA0MDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXMuYmxvYigpO1xuICAgICAgZG93bmxvYWQoYmxvYiwgZmlsZS5maWxlbmFtZSwgZmlsZS5jb250ZW50VHlwZSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtlcnJvcjogXCJLdW5kZSBpbnRlIGxhZGRhIG5lZCBmaWxlbi4gXCIgKyAoZXJyLm1lc3NhZ2UgfHwgZXJyKX0pO1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0gICAgXG4gIH1cblxuICBhc3luYyBkZWxldGUodXJsOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKCh7YXNzaWdubWVudHN9KSA9PiAoe2Fzc2lnbm1lbnRzOiBhc3NpZ25tZW50cy5tYXAoYSA9PiBhLm1lZGlhTGluayA9PT0gdXJsID9cbiAgICAgICAgey4uLmEsIG1ldGFkYXRhOiB7Li4uYS5tZXRhZGF0YSwgJG1ldGE6ICdkZWxldGUnfX0gOiB7Li4uYX0pfSkpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cC5mZXRjaCh1cmwsICdkZWxldGUnLCB7fSk7XG4gICAgICBpZiAocmVzLnN0YXR1cyA+PSA0MDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IHRoaXMubG9hZCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IFwiS3VuZGUgaW50ZSB0YSBib3J0IGZpbGVuLiBcIiArIChlcnIubWVzc2FnZSB8fCBlcnIpfSk7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtjb3Vyc2VJZCwgdGFza0lkLCBzY2hvb2x9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7bG9hZGluZywgYXNzaWdubWVudHMsIGVycm9yLCB1cGxvYWRpbmdGaWxlfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgdGVhY2hlckF0VGhpc1NjaG9vbCA9IGlzVGVhY2hlckF0U2Nob29sKGVudi5jdXJyZW50VXNlciwgc2Nob29sKTtcbiAgICBsZXQgZmlsZXMgPSBbLi4uYXNzaWdubWVudHNdO1xuICAgIGlmICh1cGxvYWRpbmdGaWxlKSB7XG4gICAgICBjb25zdCB2aXJ0dWFsRmlsZTogQXNzaWdubWVudCA9IHtcbiAgICAgICAgc2Nob29sLFxuICAgICAgICBjb3Vyc2VJZCxcbiAgICAgICAgdGFza0lkLFxuICAgICAgICBmaWxlbmFtZTogdXBsb2FkaW5nRmlsZS5uYW1lLFxuICAgICAgICBzaXplOiB1cGxvYWRpbmdGaWxlLnNpemUsXG4gICAgICAgIHVzZXI6IGVudi5jdXJyZW50VXNlci5tYWlsLFxuICAgICAgICBjb250ZW50VHlwZTogdXBsb2FkaW5nRmlsZS50eXBlLFxuICAgICAgICB1cGxvYWREYXRlOiBEYXRlLm5vdygpLFxuICAgICAgICBtZWRpYUxpbms6IGBhc3NpZ25tZW50cy8ke3NjaG9vbH0vJHtjb3Vyc2VJZH0vJHt0YXNrSWR9LyR7ZW52LmN1cnJlbnRVc2VyLm1haWx9LyR7dXBsb2FkaW5nRmlsZS5uYW1lfWAsXG4gICAgICAgIG1ldGFkYXRhOiB7JG1ldGE6ICdhZGQnLCB1c2VyRGlzcGxheU5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZX0gYXMgQXNzaWdubWVudFtcIm1ldGFkYXRhXCJdXG4gICAgICB9O1xuICAgICAgZmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLm1lZGlhTGluayAhPT0gdmlydHVhbEZpbGUubWVkaWFMaW5rKTtcbiAgICAgIGZpbGVzID0gWy4uLmZpbGVzLCB2aXJ0dWFsRmlsZV07XG4gICAgfVxuICAgIGZpbGVzID0gZmlsZXMuc29ydChjb21wYXJlUHJvcHMoW1xuICAgICAgXCJtZXRhZGF0YS51c2VyRGlzcGxheU5hbWVcIixcbiAgICAgIFwiZmlsZW5hbWVcIixcbiAgICAgIFwidXBsb2FkRGF0ZVwiXG4gICAgICBdLCBbXCJzdlwiLCBcImVuXCJdLCB7c2Vuc2l0aXZpdHk6ICdiYXNlJ30pKTtcbiAgICBjb25zdCBoYXNPd25Eb2NzID0gZmlsZXMuc29tZShmaWxlID0+IGZpbGUudXNlciA9PT0gZW52LmN1cnJlbnRVc2VyLm1haWwpO1xuICAgIFxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IG9uRHJhZ092ZXI9e2V2ID0+IHRoaXMub25EcmFnKGV2KX0gb25Ecm9wPXtldj0+e1xuICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy52ZXJpZnlBbmRVcGxvYWQoZXYuZGF0YVRyYW5zZmVyLmZpbGVzWzBdKTtcbiAgICAgIH19PlxuICAgICAgICB7ZXJyb3IgPyA8PlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImVycm9yXCI+e2Vycm9yfTwvcD5cbiAgICAgICAgPC8+OiB1bmRlZmluZWR9XG4gICAgICAgIHtsb2FkaW5nID8gPD5cbiAgICAgICAgICA8U3Bpbm5lciAvPiBMYWRkYXIgaW5sw6RtbmFkZSBmaWxlci4uLlxuICAgICAgICA8Lz4gOiBmaWxlcy5sZW5ndGggPT09IDAgP1xuICAgICAgICAgIHRlYWNoZXJBdFRoaXNTY2hvb2wgP1xuICAgICAgICAgICAgPHA+SW5nZW4gZWxldiBoYXIgbMOkbW5hdCBpbiBuw6Vnb3QgYXJiZXRlIMOkbm51LjwvcD4gOlxuICAgICAgICAgICAgdW5kZWZpbmVkXG4gICAgICAgIDogPD5cbiAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGFzay1hc3NpZ25tZW50cy10YWJsZVwiPjx0aGVhZD48dHI+XG4gICAgICAgICAgICB7dGVhY2hlckF0VGhpc1NjaG9vbCA/IDx0aD5FbGV2PC90aD4gOiB1bmRlZmluZWR9XG4gICAgICAgICAgICA8dGg+RmlsbmFtbjwvdGg+XG4gICAgICAgICAgICA8dGg+SW5sw6RtbmF0IGRlbjwvdGg+XG4gICAgICAgICAgICB7dGVhY2hlckF0VGhpc1NjaG9vbCAmJiA8PlxuICAgICAgICAgICAgICA8dGg+UmFwcG9ydDwvdGg+XG4gICAgICAgICAgICAgIDx0aD5OaXbDpTwvdGg+XG4gICAgICAgICAgICA8Lz59XG4gICAgICAgICAgICB7aGFzT3duRG9jcyAmJiA8dGggLz59XG4gICAgICAgICAgPC90cj48L3RoZWFkPjx0Ym9keT57XG4gICAgICAgICAgICBmaWxlcy5tYXAoZmlsZSA9PiA8dHJcbiAgICAgICAgICAgICAga2V5PXtmaWxlLm1lZGlhTGlua31cbiAgICAgICAgICAgICAgc3R5bGU9e2ZpbGUubWV0YWRhdGEuJG1ldGEgPyB7b3BhY2l0eTogMC41fToge319XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIHt0ZWFjaGVyQXRUaGlzU2Nob29sID8gPD48dGQ+XG4gICAgICAgICAgICAgICAgICA8YSBocmVmPXtgbWFpbHRvOiR7ZmlsZS51c2VyfWB9PlxuICAgICAgICAgICAgICAgICAgICB7ZmlsZS5tZXRhZGF0YS51c2VyRGlzcGxheU5hbWUgfHwgZmlsZS51c2VyfVxuICAgICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPHRkPjxhIGhyZWY9XCIjXCIgb25DbGljaz17ZXYgPT4ge1xuICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5kb3dubG9hZChmaWxlKTtcbiAgICAgICAgICAgICAgICB9fT57ZmlsZS5maWxlbmFtZX08L2E+PC90ZD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiYXNzaWdubWVudC1kYXRlLWNvbFwiPnttb21lbnQoZmlsZS51cGxvYWREYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW0nKX08L3RkPlxuICAgICAgICAgICAgICAgIHtmaWxlLm1ldGFkYXRhLiRtZXRhID09PSAnYWRkJyA/XG4gICAgICAgICAgICAgICAgICA8dGQgY29sU3Bhbj17Mn0+PFNwaW5uZXIgLz4gTGFkZGFyIHVwcC4uLjwvdGQ+OlxuICAgICAgICAgICAgICAgICAgZmlsZS5tZXRhZGF0YS4kbWV0YSA9PT0gJ2RlbGV0ZScgP1xuICAgICAgICAgICAgICAgICAgPHRkIGNvbFNwYW49ezJ9PjxTcGlubmVyIC8+IFRhciBib3J0Li4uPC90ZD4gOlxuICAgICAgICAgICAgICAgICAgKCgpPT57XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHttZXRhZGF0YX0gPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmt1bmRSZXNwb25zZXM6IFVya3VuZFJlc3BvbnNlW10gPSBtZXRhZGF0YS51cmt1bmRSZXNwb25zZSAmJiBKU09OLnBhcnNlKG1ldGFkYXRhLnVya3VuZFJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVya3VuZFJlc3BvbnNlID0gdXJrdW5kUmVzcG9uc2VzICYmIHVya3VuZFJlc3BvbnNlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF1cmt1bmRSZXNwb25zZSAmJiBmaWxlLm1ldGFkYXRhLnVya3VuZFVwbG9hZEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdXJrdW5kUmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBTdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgRXJyb3JDb2RlOiAtMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZTogZmlsZS5tZXRhZGF0YS51cmt1bmRVcGxvYWRFcnJvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgU3RhdGU6ICdFcnJvcidcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBFeHRlcm5hbElkOiBmaWxlLm1ldGFkYXRhLnVya3VuZEV4dGVybmFsSWRcbiAgICAgICAgICAgICAgICAgICAgICB9IGFzIFVya3VuZFJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlLmlzUmVmcmVzaGluZykgcmV0dXJuIDx0ZCBjb2xTcGFuPXsyfT5cbiAgICAgICAgICAgICAgICAgICAgICA8U3Bpbm5lciAvPiBVcHBkYXRlcmFyLi4uXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXJrdW5kUmVzcG9uc2UgPyA8PlxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ1cmt1bmQtc3RhdHVzLWNvbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZj17dXJrdW5kUmVzcG9uc2UuUmVwb3J0ICYmIHVya3VuZFJlc3BvbnNlLlJlcG9ydC5SZXBvcnRVcmx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2PT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFsnQWNjZXB0ZWQnLCAnU3VibWl0dGVkJ10uaW5kZXhPZih1cmt1bmRSZXNwb25zZS5TdGF0dXMuU3RhdGUpID09PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gRm9sbG93IEhSRUYgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEFzc2lnbm1lbnQoZmlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD1cIl9ibGFua1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtnZXRVcmt1bmRIb3ZlclRleHQodXJrdW5kUmVzcG9uc2UpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2dldFVya3VuZFN0YXR1c0NsYXNzKHVya3VuZFJlc3BvbnNlKX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ1cmt1bmQtc3RhdHVzLWNvbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2dldFVya3VuZFNpZ25pZmljYW5jZUNsYXNzKHVya3VuZFJlc3BvbnNlKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHt1cmt1bmRSZXNwb25zZS5SZXBvcnQgJiYgdHlwZW9mIHVya3VuZFJlc3BvbnNlLlJlcG9ydC5TaWduaWZpY2FuY2UgPT09ICdudW1iZXInID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHt1cmt1bmRSZXNwb25zZS5SZXBvcnQuU2lnbmlmaWNhbmNlLnRvRml4ZWQoKX0lYCA6ICcgJ31cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgICAgIDwvPiA6IDx0ZCBjb2xTcGFuPXsyfS8+XG4gICAgICAgICAgICAgICAgICB9KSgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA8Lz4gOiA8PlxuICAgICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgb25DbGljaz17ZXYgPT4ge1xuICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb3dubG9hZChmaWxlKTtcbiAgICAgICAgICAgICAgICAgIH19PntmaWxlLmZpbGVuYW1lfTwvYT5cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJhc3NpZ25tZW50LWRhdGUtY29sXCI+e2ZpbGUubWV0YWRhdGEuJG1ldGEgPT09ICdhZGQnID9cbiAgICAgICAgICAgICAgICAgIDw+PFNwaW5uZXIgLz4gTGFkZGFyIHVwcC4uLjwvPiA6XG4gICAgICAgICAgICAgICAgICBmaWxlLm1ldGFkYXRhLiRtZXRhID09PSAnZGVsZXRlJyA/XG4gICAgICAgICAgICAgICAgICA8PjxTcGlubmVyIC8+IFRhciBib3J0Li4uPC8+IDpcbiAgICAgICAgICAgICAgICAgIG1vbWVudChmaWxlLnVwbG9hZERhdGUpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbScpfTwvdGQ+XG4gICAgICAgICAgICAgIDwvPn1cbiAgICAgICAgICAgICAge2hhc093bkRvY3MgJiYgPHRkPnshZmlsZS5tZXRhZGF0YS4kbWV0YSAmJiBmaWxlLnVzZXIgPT09IGVudi5jdXJyZW50VXNlci5tYWlsICYmXG4gICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICBpZiAoY29uZmlybShgUmFkZXJhIGlubMOkbW5hZCBmaWwgJHtmaWxlLmZpbGVuYW1lfT9gKSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGUoZmlsZS5tZWRpYUxpbmspO1xuICAgICAgICAgICAgICAgIH19PjxpIGNsYXNzTmFtZT1cImZhIGZhLXRyYXNoXCIvPjwvYT59PC90ZD59XG4gICAgICAgICAgICA8L3RyPilcbiAgICAgICAgICB9PC90Ym9keT48L3RhYmxlPlxuICAgICAgICA8Lz59XG4gICAgICAgIHtpc0VtcGxveWVlKCkgPyB1bmRlZmluZWQgOiA8PjxkaXYgY2xhc3NOYW1lPVwiZHJvcC16b25lIHRhc2stYXNzaWdubWVudC1kcm9wLXpvbmVcIj5cbiAgICAgICAgICAgIERyb3BwYSBkaXR0IGbDpHJkaWdhIGFyYmV0ZSBow6RyLjxici8+RGV0IGfDpXIgb2Nrc8OlIGJyYSBhdHQgYW52w6RuZGEgYmzDpGRkcmEta25hcHBlbiBuZWRhbi5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBvbkNoYW5nZT17ZXYgPT4gdGhpcy52ZXJpZnlBbmRVcGxvYWQoZXYudGFyZ2V0LmZpbGVzWzBdKX0gLz5cbiAgICAgICAgPC8+fVxuICAgICAgPC9kaXY+XG4gICAgKTtcblxuICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVGFzaywgQ291cnNlLCBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IEFiaWxpdGllc0JveCB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2FiaWxpdGllcy1ib3hcIjtcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveFwiO1xuaW1wb3J0IHsgS25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGUgfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9rbm93bGVkZ2UtcmVxdWlyZW1lbnRzLXRhYmxlXCI7XG5pbXBvcnQgeyB1c2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IFRhc2tBc3NpZ25tZW50cyB9IGZyb20gJy4vdGFzay1hc3NpZ25tZW50cyc7XG5pbXBvcnQgeyBpc1RlYWNoZXJBdFNjaG9vbCB9IGZyb20gJy4uLy4uLy4uL2FjY2Vzcy1jb250cm9sJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGFzazogVGFza1xuICBjb3Vyc2U6IENvdXJzZVxufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICB1c2VyVGFzazogVXNlclRhc2sgfCBudWxsIHwgdW5kZWZpbmVkO1xuICB3ZWVrUGxhbm5lcldlZWs6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFRhc2tQYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdXNlclRhc2s6IHVuZGVmaW5lZCxcbiAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KCkud2VlaygpXG4gICAgfTtcbiAgICB0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZCA9IHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkLmJpbmQodGhpcyk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB1c2VyVGFza3NSZXBvLnN1YnNjcmliZSh0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB1c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMudGFzay5pZCAhPT0gdGhpcy5wcm9wcy50YXNrLmlkKSB7XG4gICAgICBjb25zdCB1c2VyVGFzayA9IHVzZXJUYXNrc1JlcG8ubWVtLml0ZW1zLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gbmV4dFByb3BzLnRhc2suaWQpIHx8IG51bGw7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgdXNlclRhc2ssXG4gICAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KHVzZXJUYXNrc1JlcG8ucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUpLndlZWsoKVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25Vc2VyVGFza3NDaGFuZ2VkKHVzZXJUYXNrczogVXNlclRhc2tbXSkge1xuICAgIGNvbnN0IHVzZXJUYXNrID0gdXNlclRhc2tzLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gdGhpcy5wcm9wcy50YXNrLmlkKSB8fCBudWxsO1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdXNlclRhc2ssXG4gICAgICB3ZWVrUGxhbm5lcldlZWs6IG1vbWVudCh1c2VyVGFza3NSZXBvLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlKS53ZWVrKClcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHRvZ2dsZVRhc2sgKCkge1xuICAgIGNvbnN0IHsgd2Vla0RhdGUgfSA9IHVzZXJUYXNrc1JlcG8ucGVyc2lzdGVkU3RhdGU7XG4gICAgY29uc3QgeyB1c2VyVGFzayB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IGNvdXJzZSwgdGFzayB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBtb2R1bGUgPSBjb3Vyc2UubW9kdWxlcy5maW5kKG0gPT4gbS50YXNrSWRzLnNvbWUoaWQgPT4gaWQgPT09IHRhc2suaWQpKTtcbiAgICBpZiAoIW1vZHVsZSkgcmV0dXJuOyAvLyBPaCB1aCFcbiAgICBpZiAodXNlclRhc2sgPT09IHVuZGVmaW5lZCkgcmV0dXJuOyAvLyBOb3QgeWV0IGxvYWRlZC5cbiAgICBpZiAoIXVzZXJUYXNrKSB7XG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXG4gICAgICAgIE1hdGgubWF4LFxuICAgICAgICBbd2Vla0RhdGVdLmNvbmNhdCh1c2VyVGFza3NSZXBvLm1lbS5pdGVtcy5tYXAodCA9PiB0LmRhdGVUaW1lKSkpO1xuXG4gICAgICBjb25zdCB1c2VyVGFzazogVXNlclRhc2sgPSB7XG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIGNvdXJzZU5hbWU6IGNvdXJzZS5uYW1lLFxuICAgICAgICBkYXRlVGltZTogbGF0ZXN0VGltZVN0YW1wICsgMjAwMCxcbiAgICAgICAgbGVhcm5pbmdHb2FsOiB0YXNrLmxlYXJuaW5nR29hbCB8fCBtb2R1bGUubmFtZSxcbiAgICAgICAgbmFtZTogdGFzay5uYW1lLFxuICAgICAgICB1cmw6IHRhc2sudXJsLFxuICAgICAgICB0YXNrOiBbdGFza10sXG4gICAgICAgIGNvdXJzZTogW2NvdXJzZV0sXG4gICAgICAgIGFjbDogW1xuICAgICAgICAgIC8vIERlZmF1bHQgQUNMOiBMZXQgdXNlciBzZWxmIGhhdmUgZnVsbCBjb250cm9sIG92ZXIgdGhpcyBpdGVtOlxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXG4gICAgICAgICAgLy8gQWRkaXRpb25hbCBBQ0w6IExldCBlbXBsb3llZXMgb24gc2FtZSBzY2hvb2wgaGF2ZSByZWFkIGFjY2VzcyB0byBpdC5cbiAgICAgICAgICAvLyBUaGlzIGN1cnJlbnRseSBvbmx5IGFwcGxpZXMgdG8gdGFza3MgdGhhdCByZWZlciB0byBjb3Vyc2UgdGFza3MgKG5vdCBvd24gdGFza3MhKVxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcbiAgICAgICAgXS5tYXAoYWMgPT4gYWMudG9TdHJpbmcoKSlcbiAgICAgIH07XG4gICAgICBpZiAodGFzay5kZWFkbGluZSkge1xuICAgICAgICB1c2VyVGFzay5kZWFkbGluZSA9IHRhc2suZGVhZGxpbmU7XG4gICAgICB9XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHVzZXJUYXNrc1JlcG8uc2V0V2Vla1BsYW5uZXJCb3hPcGVuKHRoaXMucHJvcHMuY291cnNlLm5hbWUsIHRydWUpLFxuICAgICAgICB1c2VyVGFza3NSZXBvLmluc2VydChbdXNlclRhc2tdKV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB1c2VyVGFza3NSZXBvLmRlbGV0ZShbdXNlclRhc2suaWRdKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyB0YXNrLCBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyB1c2VyVGFzaywgd2Vla1BsYW5uZXJXZWVrIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IGFiaWxpdGllcyA9IHRhc2suYWJpbGl0aWVzLm1hcChhID0+IGNvdXJzZS5hYmlsaXRpZXMuZmluZChhYiA9PiBhYi5pZCA9PT0gYS5pZCkpLmZpbHRlcihhID0+ICEhYSk7XG4gICAgY29uc3QgY2VudHJhbENvbnRlbnQgPSB0YXNrLmNlbnRyYWxDb250ZW50Lm1hcChjID0+IGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09IGMuaWQpKS5maWx0ZXIoYyA9PiAhIWMpO1xuICAgIGNvbnN0IHJlcXVpcmVtZW50cyA9IHRhc2sua25vd2xlZGdlUmVxdWlyZW1lbnRzLm1hcChrID0+IGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZChrciA9PiBrci5pZCA9PT0gay5pZCkpLmZpbHRlcihrID0+ICEhayk7XG4gICAgY29uc3QgaXNXb3JraW5nID0gdXNlclRhc2sgJiYgKHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJyk7XG4gICAgY29uc3QgY3VycmVudFdlZWsgPSBtb21lbnQoKS53ZWVrKCk7XG4gICAgY29uc3QgZm9yV2Vla1N0cmluZyA9IHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgPyBcImxvZ2dib2tlblwiIDpcbiAgICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgKyAxID8gTGB2YWxkIHZlY2thIChuw6RzdGEgdmVja2EpYCA6XG4gICAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrIC0gMSA/IExgdmFsZCB2ZWNrYSAoZsO2cnJhIHZlY2thbilgIDpcbiAgICAgIExgdmFsZCB2ZWNrYSAodiAke3dlZWtQbGFubmVyV2Vla30pYDtcbiAgICBjb25zdCBkZWFkbGluZVRvb0xhdGUgPSB0YXNrLmRlYWRsaW5lICYmIG1vbWVudCh0YXNrLmRlYWRsaW5lKS5lbmRPZignZGF5JykgPCBtb21lbnQoKTtcblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQgc3YtdXNlLW1hcmdpbnMgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxuICAgICAgICAgIDxoMSBjbGFzc05hbWU9XCJoMVwiPnt0YXNrLm5hbWV9PC9oMT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAge3Rhc2suY29udGVudCAmJiA8PlxuICAgICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRhc2suY29udGVudH19IC8+XG4gICAgICAgIDwvPn1cbiAgICAgICAge3Rhc2subGVhcm5pbmdHb2FsICYmIDxkaXY+PGgyPlVwcGdpZnRlbnMgbMOkcmFuZGVtw6VsPC9oMj5cbiAgICAgICAgICA8cD57dGFzay5sZWFybmluZ0dvYWx9PC9wPlxuICAgICAgICA8L2Rpdj59XG4gICAgICAgIHt0YXNrLnVybCAmJiA8YSBocmVmPXt0YXNrLnVybH0gY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZVwiPkfDpSB0aWxsIHVwcGdpZnRlbjwvYT59XG4gICAgICA8L2Rpdj5cbiAgICAgIDxici8+XG4gICAgICB7dGFzay5hc3NpZ25tZW50ID8gPD5cbiAgICAgICAgPGgyPklubMOkbW5pbmdzdXBwZ2lmdDwvaDI+XG4gICAgICAgIHtpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIGNvdXJzZS5zY2hvb2wpID9cbiAgICAgICAgICA8cD5Iw6RyIGthbiBkdSBzb20gbMOkcmFyZSBzZSBlbGV2ZXJuYXMgaW5sw6RtbmFkZSBhcmJldGVuLlxuICAgICAgICAgIDwvcD4gOiA8PlxuICAgICAgICAgICAgPHA+RGV0IGjDpHIgw6RyIGVuIGlubMOkbW5pbmdzdXBwZ2lmdC4gTMOkbW5hIGluIGRpdHQgYXJiZXRlIHNvbSBlbiBwZGYsIGRvYyBlbGxlciBvZHQgZmlsXG4gICAgICAgICAgICAgIGdlbm9tIGF0dCBkcmEgZGV0IHRpbGwgZsOkbHRldCB1bmRlci5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgIHt0YXNrLmRlYWRsaW5lID8gPHA+PGI+XG4gICAgICAgICAgICAgIERlbiBow6RyIHVwcGdpZnRlbiB7ZGVhZGxpbmVUb29MYXRlID8gJ3NrdWxsZSB2YXJpdCBpbmzDpG1uYWQgJyA6ICdza2FsbCB2YXJhIGlubMOkbW5hZCAnfVxuICAgICAgICAgICAgICB7bW9tZW50KHRhc2suZGVhZGxpbmUpLmZvcm1hdCgnWVlZWSBNTSBERCcpfVxuICAgICAgICAgICAgPC9iPjwvcD4gOiB1bmRlZmluZWR9XG4gICAgICAgICAgICA8Lz59XG4gICAgICAgICAgPFRhc2tBc3NpZ25tZW50c1xuICAgICAgICAgICAgY291cnNlSWQ9e2NvdXJzZS5pZH1cbiAgICAgICAgICAgIHRhc2tJZD17dGFzay5pZH1cbiAgICAgICAgICAgIHNjaG9vbD17Y291cnNlLnNjaG9vbH1cbiAgICAgICAgICAgLz5cbiAgICAgICAgPGJyLz5cbiAgICAgIDwvPiA6IHVuZGVmaW5lZH1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAge2FiaWxpdGllcy5sZW5ndGggPiAwICYmIDxBYmlsaXRpZXNCb3hcbiAgICAgICAgICAgIHRpdGxlPVwiRGVuIGjDpHIgdXBwZ2lmdGVuIGJlaGFuZGxhciBmw7ZsamFuZGUgZsO2cm3DpWdvclwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIlxuICAgICAgICAgICAgaGVhZGVyT3Blbj17ZmFsc2V9XG4gICAgICAgICAgICBhYmlsaXRpZXM9e2FiaWxpdGllc30gLz59XG5cbiAgICAgICAge2NlbnRyYWxDb250ZW50Lmxlbmd0aCA+IDAgJiYgPENlbnRyYWxDb250ZW50Qm94XG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIHVwcGdpZnRlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGNlbnRyYWxhIGlubmVow6VsbFwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIlxuICAgICAgICAgICAgaGVhZGVyT3Blbj17ZmFsc2V9XG4gICAgICAgICAgICBjZW50cmFsQ29udGVudD17Y2VudHJhbENvbnRlbnR9IC8+fVxuXG4gICAgICAgIHtyZXF1aXJlbWVudHMubGVuZ3RoID4gMCAmJiA8S25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGVcbiAgICAgICAgICB0aXRsZT1cIkkgZGVuIGjDpHIgdXBwZ2lmdGVuIGJlZMO2bXMgZsO2bGphbmRlIGt1bnNrYXBza3JhdlwiXG4gICAgICAgICAgY2xhc3NOYW1lPVwibGFyZ2VyXCJcbiAgICAgICAgICBoZWFkZXJPcGVuPXt0cnVlfVxuICAgICAgICAgIHJlcXVpcmVtZW50cz17cmVxdWlyZW1lbnRzfVxuICAgICAgICAgIC8+fVxuICAgICAgPC9kaXY+ICAgICAgXG4gICAgICA8aHIvPlxuICAgICAge3VzZXJUYXNrICE9PSB1bmRlZmluZWQgJiYgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YHNlbGVjdGVkQm94JHt1c2VyVGFzayAmJiB1c2VyVGFzay4kbWV0YSAhPT0gJ2RlbGV0aW5nJyA/ICcgc2VsZWN0ZWQnIDogJyd9YH1cbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtpc1dvcmtpbmcgPyB7b3BhY2l0eTogMC41fToge319XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+IWlzV29ya2luZyAmJiB0aGlzLnRvZ2dsZVRhc2soKX0+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgIHt1c2VyVGFzayA/XG4gICAgICAgICAgICAgICAgTGBUYSBib3J0IHVwcGdpZnRlbiBmcsOlbiAke2ZvcldlZWtTdHJpbmd9YDpcbiAgICAgICAgICAgICAgICBMYEzDpGdnIHRpbGwgdXBwZ2lmdGVuIGkgJHtmb3JXZWVrU3RyaW5nfWB9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+fVxuICAgICAgPGhyLz5cbiAgICAgIHt0YXNrLnJlc291cmNlcyAmJiB0YXNrLnJlc291cmNlcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAgPGgyPlJlc3Vyc2VyIGtvcHBsYWRlIHRpbGwgdXBwZ2lmdGVuPC9oMj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XG4gICAgICAgICAge3Rhc2sucmVzb3VyY2VzLm1hcCgociwgaWR4KSA9PlxuICAgICAgICAgICAgPGRpdiBrZXk9e2lkeH0gY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3IudXJsfT57ci5uYW1lfTwvYT5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGJyIC8+XG4gICAgICA8L2Rpdj59XG5cbiBcbiAgICAgIDxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQge1Vya3VuZFJlc3BvbnNlfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTdGF0dXNDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xuICBpZiAoIXJlcyB8fCAhcmVzLlN0YXR1cykge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Ugc3dpdGNoIChyZXMuU3RhdHVzLlN0YXRlKSB7XG4gICAgY2FzZSAnRXJyb3InOlxuICAgICAgcmV0dXJuIGB1cmt1bmQtc3RhdHVzIHVya3VuZC1zdGF0dXMtZXJyb3JgO1xuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XG4gICAgICByZXR1cm4gYHVya3VuZC1zdGF0dXMgdXJrdW5kLXN0YXR1cy1zdWJtaXR0ZWRgO1xuICAgIGNhc2UgJ0FjY2VwdGVkJzpcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLWFjY2VwdGVkYDtcbiAgICBjYXNlICdBbmFseXplZCc6XG4gICAgICByZXR1cm4gYHVya3VuZC1zdGF0dXMgdXJrdW5kLXN0YXR1cy1hbmFseXplZGA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFVya3VuZEhvdmVyVGV4dCAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xuICBpZiAoIXJlcyB8fCAhcmVzLlN0YXR1cykgcmV0dXJuIG51bGw7XG4gIHN3aXRjaCAocmVzLlN0YXR1cy5TdGF0ZSkge1xuICAgIGNhc2UgJ0Vycm9yJzpcbiAgICAgIHJldHVybiByZXMuRXh0ZXJuYWxJZCA/XG4gICAgICAgIGBLdW5kZSBpbnRlIHRhcyBlbW90IGF2IHVya3VuZC4gRmVsa29kOiAke3Jlcy5TdGF0dXMuRXJyb3JDb2RlfVxcbmArXG4gICAgICAgIGBFeHRlcm5hbCBJRDogJHtyZXMuRXh0ZXJuYWxJZH1cXG5GZWxtZWRkZWxhbmRlOiAke3Jlcy5TdGF0dXMuTWVzc2FnZX1gXG4gICAgICAgIDpcbiAgICAgICAgcmVzLlN0YXR1cy5NZXNzYWdlO1xuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XG4gICAgICByZXR1cm4gYEZpbGVuIMOkciB1cHBsYWRkYWQgdGlsbCBVcmt1bmQuIEtsaWNrYSBmw7ZyIGF0dCB1cHBkYXRlcmEgc3RhdHVzLmA7XG4gICAgY2FzZSAnQWNjZXB0ZWQnOlxuICAgICAgcmV0dXJuIGBGaWxlbiBhbmFseXNlcmFzIGZvcnRmYXJhbmRlIGF2IFVya3VuZC4gS2xpY2thIGbDtnIgYXR0IHVwcGRhdGVyYSBzdGF0dXMuYDtcbiAgICBjYXNlICdBbmFseXplZCc6XG4gICAgICByZXR1cm4gYFJhcHBvcnQgc2thcGFkLiBLbGlja2EgZsO2ciBhdHQgw7ZwcG5hIHJhcHBvcnRlbiBpIG55dHQgZsO2bnN0ZXJgO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTaWduaWZpY2FuY2VDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xuICBpZiAoIXJlcyB8fCAhcmVzLlN0YXR1cykgcmV0dXJuICcnO1xuXG4gIHN3aXRjaCAocmVzLlN0YXR1cy5TdGF0ZSkge1xuICAgIGNhc2UgJ0Vycm9yJzogcmV0dXJuICd1cmt1bmQtc2lnbmlmaWNhbmNlLWVycm9yJztcbiAgICBjYXNlICdTdWJtaXR0ZWQnOiByZXR1cm4gJ3Vya3VuZC1zaWduaWZpY2FuY2Utc3VibWl0dGVkJztcbiAgICBjYXNlICdBY2NlcHRlZCc6IHJldHVybiAndXJrdW5kLXNpZ25pZmljYW5jZS1hY2NlcHRlZCc7XG4gIH1cbiAgY29uc3QgcmVwb3J0ID0gcmVzLlJlcG9ydDtcbiAgaWYgKCFyZXBvcnQpIHtcbiAgICByZXR1cm4gXCJcIjtcbiAgfVxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEpXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzAuZ2lmYDtcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtMFwiO1xuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEwKVxuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC8xLmdpZmA7XG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTFcIjtcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCAyNSlcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtMlwiO1xuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC8yLmdpZmA7XG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgNDApXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTNcIjtcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvMy5naWZgO1xuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDU1KVxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS00XCI7XG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzQuZ2lmYDtcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCA3MClcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtNVwiO1xuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC81LmdpZmA7XG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgODUpXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTZcIjtcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvNi5naWZgO1xuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDk5LjkpXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTdcIjtcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvNy5naWZgO1xuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA+PSA5OS45KVxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS04XCI7XG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzguZ2lmYDtcbiAgcmV0dXJuIFwiXCI7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMLCBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBFcnJvclN1Y2Nlc3NGZWVkYmFjayB9IGZyb20gJy4uLy4uL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2snO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgbG9hZENvdXJzZSB9IGZyb20gXCIuLi9jb3Vyc2UtYnVpbGRlci91dGlsc1wiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5pbXBvcnQgeyBDb3Vyc2VQYWdlIH0gZnJvbSBcIi4vY291cnNlLXBhZ2VcIjtcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XG5pbXBvcnQgeyBMaXN0Q291cnNlc1BhZ2UgfSBmcm9tICcuLi9saXN0LWNvdXJzZXMvbGlzdC1jb3Vyc2VzLXBhZ2UnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjb3Vyc2VCdWlsZGVyVXJsPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBjb3Vyc2U6IENvdXJzZSB8IG51bGwsXG4gIGlzTG9hZGluZzogYm9vbGVhblxufVxuXG5leHBvcnQgY2xhc3MgQ291cnNlVmlld2VyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgY291cnNlOiBudWxsLFxuICAgICAgaXNMb2FkaW5nOiB0cnVlXG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMubG9hZCgpLmNhdGNoKHNob3dFcnJvcilcbiAgICAgIC50aGVuKCgpPT50aGlzLnNldFN0YXRlKHtpc0xvYWRpbmc6IGZhbHNlfSkpO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICBjb25zdCBjb3Vyc2VJZCA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKVtcImNvdXJzZUlkXCJdO1xuICAgIGNvbnN0IGNvdXJzZSA9IGNvdXJzZUlkID8gYXdhaXQgbG9hZENvdXJzZSAoY291cnNlSWQpIDogbnVsbDtcbiAgICB0aGlzLnNldFN0YXRlKHtjb3Vyc2V9KTtcbiAgICBkb2N1bWVudC50aXRsZSA9XG4gICAgICBjb3Vyc2UgP1xuICAgICAgICBjb3Vyc2UubmFtZSArIFwiIC0gXCIgKyBjb3Vyc2UucG9pbnRzICsgXCJwXCIgOlxuICAgICAgICBcIkt1cnNlclwiO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImNvdXJzZS12aWV3ZXJcIj5cbiAgICAgIHt0aGlzLnN0YXRlLmlzTG9hZGluZyA/XG4gICAgICAgIDxTcGlubmVyIC8+IDpcbiAgICAgICAgdGhpcy5zdGF0ZS5jb3Vyc2UgP1xuICAgICAgICAgIDxDb3Vyc2VQYWdlXG4gICAgICAgICAgICBjb3Vyc2U9e3RoaXMuc3RhdGUuY291cnNlfSBcbiAgICAgICAgICAgIGNvdXJzZUJ1aWxkZXJVcmw9e3RoaXMucHJvcHMuY291cnNlQnVpbGRlclVybH0gLz4gOlxuICAgICAgICAgIDxMaXN0Q291cnNlc1BhZ2UgLz5cbiAgICAgIH1cbiAgICAgIDxFcnJvclN1Y2Nlc3NGZWVkYmFjayAvPlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBBYmlsaXR5IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0aXRsZTogc3RyaW5nO1xuICBzdWJUaXRsZT86IHN0cmluZztcbiAgYWJpbGl0aWVzOiBBYmlsaXR5W107XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaGVhZGVyT3Blbj86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGhlYWRlck9wZW46IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBBYmlsaXRpZXNCb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBoZWFkZXJPcGVuOiBwcm9wcy5oZWFkZXJPcGVuIHx8IGZhbHNlXG4gICAgfTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHRpdGxlLCBzdWJUaXRsZSwgYWJpbGl0aWVzLCBjbGFzc05hbWUgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBoZWFkZXJPcGVuIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXsoY2xhc3NOYW1lfHwnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyXCIgb25DbGljaz17KCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGhlYWRlck9wZW46ICF0aGlzLnN0YXRlLmhlYWRlck9wZW4gfSl9PlxuICAgICAgICA8cD57dGl0bGV9PC9wPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5Db250ZW50XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJpbGl0eUxpc3RcIj5cbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XG4gICAgICAgICAgICA8aDU+e3N1YlRpdGxlfTwvaDU+XG4gICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgIHthYmlsaXRpZXMubWFwKGEgPT5cbiAgICAgICAgICAgIDxkaXYga2V5PXthLmlkfSBjbGFzc05hbWU9XCJjb250ZW50UGFydFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRlbnRUZXh0XCI+XG4gICAgICAgICAgICAgICAgPHAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGEubmFtZX19IC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENlbnRyYWxDb250ZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0aXRsZTogc3RyaW5nO1xuICBzdWJUaXRsZT86IHN0cmluZztcbiAgY2VudHJhbENvbnRlbnQ6IENlbnRyYWxDb250ZW50W107XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaGVhZGVyT3Blbj86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGhlYWRlck9wZW46IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBDZW50cmFsQ29udGVudEJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGhlYWRlck9wZW46IHByb3BzLmhlYWRlck9wZW4gfHwgZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGl0bGUsIHN1YlRpdGxlLCBjZW50cmFsQ29udGVudCwgY2xhc3NOYW1lIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgaGVhZGVyT3BlbiB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZSB8fCAnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyXCIgb25DbGljaz17KCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGhlYWRlck9wZW46ICF0aGlzLnN0YXRlLmhlYWRlck9wZW4gfSl9PlxuICAgICAgICA8cD57dGl0bGV9PC9wPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5Db250ZW50XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWJpbGl0eUxpc3RcIj5cbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XG4gICAgICAgICAgICA8aDU+e3N1YlRpdGxlfTwvaDU+XG4gICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgIHtjZW50cmFsQ29udGVudC5tYXAoY2MgPT5cbiAgICAgICAgICAgIDxkaXYga2V5PXtjYy5pZH0gY2xhc3NOYW1lPVwiY29udGVudFBhcnRcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50VGV4dFwiPlxuICAgICAgICAgICAgICAgIDxwIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjYy5uYW1lfX0gLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PjtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB2aXNpYmxlOiBib29sZWFuO1xuICB0ZXh0OiBzdHJpbmc7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgb25Db25maXJtOiAoKT0+dm9pZDtcbiAgb25DYW5jZWw6ICgpPT52b2lkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gQ29uZmlybWF0aW9uIChwcm9wczogUHJvcHMpIHtcbiAgcmV0dXJuIDxkaXZcbiAgICBjbGFzc05hbWU9e2Bjb25maXJtYXRpb24tYm94ICR7cHJvcHMuY2xhc3NOYW1lfSR7cHJvcHMudmlzaWJsZSA/IFwiIHZpc2libGVcIiA6IFwiXCJ9YH0+XG4gICAgPHA+e3Byb3BzLnRleHR9PC9wPlxuICAgIDxidXR0b24gb25DbGljaz17KCk9PnByb3BzLm9uQ29uZmlybSgpfT5PSzwvYnV0dG9uPlxuICAgIDxidXR0b24gb25DbGljaz17KCk9PnByb3BzLm9uQ2FuY2VsKCl9PkF2YnJ5dDwvYnV0dG9uPlxuICA8L2Rpdj47XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBLbm93bGVkZ2VSZXF1aXJlbWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gXCIuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3hcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGl0bGU6IHN0cmluZztcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICByZXF1aXJlbWVudHM6IEtub3dsZWRnZVJlcXVpcmVtZW50W107XG4gIGV4cGxhaW5lZFJlcXVpcmVtZW50cz86IHtbcmVxdWlyZW1lbnRJZDogc3RyaW5nXTogc3RyaW5nfTtcbiAgaW5jbHVkZWRJZHM/OiB7W2lkOiBzdHJpbmddIDogdHJ1ZX07XG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xufVxuXG5leHBvcnQgY2xhc3MgS25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHRpdGxlLCByZXF1aXJlbWVudHMsIGNsYXNzTmFtZSwgaW5jbHVkZWRJZHMsIGhlYWRlck9wZW4sIGV4cGxhaW5lZFJlcXVpcmVtZW50cyB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IGNvbHVtbnMgPSBbXCJFXCIsIFwiQ1wiLCBcIkFcIl07XG4gICAgY29uc3Qgcm93czogS25vd2xlZGdlUmVxdWlyZW1lbnRbXVtdID0gW107XG4gICAgY29uc3QgcmVxcyA9IHJlcXVpcmVtZW50cy5zbGljZSgpO1xuICAgIGxldCByb3c6IEtub3dsZWRnZVJlcXVpcmVtZW50W10gfCBudWxsID0gbnVsbDtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgcm93ID0gY29sdW1ucy5tYXAoZ3JhZGUgPT4ge1xuICAgICAgICBjb25zdCBwTmV4dCA9IHJlcXMuZmluZEluZGV4KHIgPT4gci5ncmFkZVN0ZXAudG9VcHBlckNhc2UoKSA9PT0gZ3JhZGUpO1xuICAgICAgICBpZiAocE5leHQgPCAwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgcnYgPSByZXFzW3BOZXh0XTtcbiAgICAgICAgcmVxcy5zcGxpY2UocE5leHQsIDEpO1xuICAgICAgICByZXR1cm4gaW5jbHVkZWRJZHMgP1xuICAgICAgICAgIChpbmNsdWRlZElkc1tydi5pZF0gPyBydiA6IHVuZGVmaW5lZCkgOlxuICAgICAgICAgIHJ2O1xuICAgICAgfSk7XG4gICAgICBpZiAocm93LmV2ZXJ5KHIgPT4gciA9PT0gbnVsbCkpXG4gICAgICAgIGJyZWFrO1xuICAgICAgaWYgKCFyb3cuZXZlcnkociA9PiAhcikpIHtcbiAgICAgICAgcm93cy5wdXNoKHJvdyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIDxPcGVuQ2xvc2VCb3ggdGl0bGU9ezxwPnt0aXRsZX08L3A+fSBjbGFzc05hbWU9e2NsYXNzTmFtZX0gaGVhZGVyT3Blbj17aGVhZGVyT3Blbn0+XG4gICAgICA8dGFibGU+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICA8dHI+XG4gICAgICAgICAgICB7Y29sdW1ucy5tYXAoYyA9PiA8dGgga2V5PXtjfT57Y308L3RoPil9XG4gICAgICAgICAgPC90cj5cbiAgICAgICAgPC90aGVhZD5cbiAgICAgICAgPHRib2R5PlxuICAgICAgICAgIHtyb3dzLm1hcCgocm93LGkpID0+IDxSZWFjdC5GcmFnbWVudCBrZXk9e2l9PlxuICAgICAgICAgICAgICA8dHIga2V5PXtpfT5cbiAgICAgICAgICAgICAgICB7cm93Lm1hcCgoY29sdW1uLGopID0+XG4gICAgICAgICAgICAgICAgICA8dGQga2V5PXtqfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogY29sdW1uID8gY29sdW1uLm5hbWUgOiBcIlwifX0gLz5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICB7ZXhwbGFpbmVkUmVxdWlyZW1lbnRzICYmIDx0cj5cbiAgICAgICAgICAgICAgICB7cm93Lm1hcCgoY29sdW1uLGopID0+XG4gICAgICAgICAgICAgICAgICA8dGQga2V5PXtqfSBjbGFzc05hbWU9XCJleHBsYWluZWQtcmVxdWlyZW1lbnRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdj57KGNvbHVtbiAmJiBleHBsYWluZWRSZXF1aXJlbWVudHNbY29sdW1uLmlkXSkgfHwgXCJcIn08L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvdGQ+KX1cbiAgICAgICAgICAgICAgPC90cj59XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvdGJvZHk+XG4gICAgICA8L3RhYmxlPlxuICAgIDwvT3BlbkNsb3NlQm94PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMZWFybmluZ01vZHVsZVRhc2ssIFRhc2tMaXN0IH0gZnJvbSAnLi90YXNrLWxpc3QnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjb21tb25UYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cbiAgbGVhcm5pbmdHb2FsczogTGVhcm5pbmdHb2FsW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ0dvYWwge1xuICBuYW1lOiBzdHJpbmc7XG4gIGxlYXJuaW5nVGFza3M6IExlYXJuaW5nTW9kdWxlVGFza1tdO1xufVxuXG5leHBvcnQgY2xhc3MgTGVhcm5pbmdHb2Fsc0xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtjb21tb25UYXNrcywgbGVhcm5pbmdHb2Fsc30gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiA8ZGl2PntsZWFybmluZ0dvYWxzLm1hcChsZyA9PiA8ZGl2IGtleT17bGcubmFtZX0+XG4gICAgICA8aDU+e2xnLm5hbWV9PC9oNT5cbiAgICAgIDxUYXNrTGlzdCBsZWFybmluZ1Rhc2tzPXtsZy5sZWFybmluZ1Rhc2tzfSAvPlxuICAgIDwvZGl2Pil9XG4gICAge2NvbW1vblRhc2tzLmxlbmd0aCA+IDAgJiYgPGRpdj5cbiAgICAgIHtsZWFybmluZ0dvYWxzLmxlbmd0aCA+IDAgJiYgPGg1PsOWdmVyZ3JpcGFuZGU8L2g1Pn1cbiAgICAgIDxUYXNrTGlzdCBsZWFybmluZ1Rhc2tzPXtjb21tb25UYXNrc30gLz5cbiAgICA8L2Rpdj59XG4gICAgPC9kaXY+O1xuICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtSZXNvdXJjZX0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICByZXNvdXJjZXM6IFJlc291cmNlW107XG59XG5cbmV4cG9ydCBjbGFzcyBSZXNvdXJjZUxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtyZXNvdXJjZXN9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gPGRpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAgICB7cmVzb3VyY2VzLm1hcCgocmVzb3VyY2UsIGlkeCkgPT4gXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCIga2V5PXtpZHh9PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGEgaHJlZj17cmVzb3VyY2UudXJsfT57cmVzb3VyY2UubmFtZX08L2E+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj4pfVxuICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIFRhc2ssIFVzZXJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB9IGZyb20gXCIuLi8uLi93ZWVrcGxhbm5lci93ZWVrcGxhbm5lci1wZXJzaXN0ZWQtc3RhdGVcIjtcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEJhdGNoUnVubmVyLCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IHVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xuaW1wb3J0IHsgYXJyYXlUb01hcCwgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCB7IENvbmZpcm1hdGlvbiB9IGZyb20gJy4vY29uZmlybWF0aW9uJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGVhcm5pbmdUYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgd2Vla0RhdGU6IG51bWJlcjtcbiAgdXNlclRhc2tzOiBVc2VyVGFza1tdO1xuICBjb25maXJtYXRpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ01vZHVsZVRhc2sge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICAvKiogY291cnNlTmFtZVxuICAgKiBGb3IgS0c6IGNvdXJzZU5hbWVcbiAgICogRm9yIEtTOiBTdWJqZWN0IG5hbWVcbiAgICovXG4gIGNvdXJzZU5hbWU6IHN0cmluZztcbiAgLyoqIGxlYXJuaW5nR29hbFxuICAgKiBGb3IgS0c6IG1vZHVsZSBuYW1lIG9yIGxlYXJuaW5nIGdvYWwgb2YgdGhlIHRhc2tcbiAgICogRm9yIEtTL3N0ZXAtY291cnNlOiBjb3Vyc2UgbmFtZVxuICAgKiBGb3IgS1MvdGhlbWUtY291cnNlOiBsZWFybmluZyBnb2FsXG4gICAqL1xuICBsZWFybmluZ0dvYWw6IHN0cmluZztcbiAgLyoqIFN0ZXBcbiAgICogT25seSBwcmVzZW50IGluIEtTL3N0ZXAtY291cnNlXG4gICAqL1xuICBzdGVwPzogbnVtYmVyO1xuICAvKiogdGFza1xuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWx0IGJ5IGNvdXJzZWJ1aWxkZXJcbiAgICovXG4gIHRhc2s/OiBUYXNrO1xuICAvKiogY291cnNlXG4gICAqIE9ubHkgZm9yIGNvdXJzZXMgYnVpbHQgYnkgY291cnNlYnVpbGRlclxuICAgKi9cbiAgY291cnNlPzogQ291cnNlO1xuICAvKiogY291cnNlSW5mb1xuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWxkIGJ5IHN1YmplY3RwbGFubmVyXG4gICAqL1xuICBjb3Vyc2VJbmZvPzoge1xuICAgIHNjaG9vbDogc3RyaW5nIC8vIFNjaG9vbCBuYW1lXG4gICAgY291cnNlOiBzdHJpbmcgLy8gQ291cnNlIEluc3RhbmNlIElEXG4gICAgdGFiOiBzdHJpbmcgICAgLy8gQ291cnNlVGFiIElEXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRhc2tMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdXNlclRhc2tzOiBbXSxcbiAgICAgIHdlZWtEYXRlOiBEYXRlLm5vdygpLFxuICAgICAgY29uZmlybWF0aW9uczogW11cbiAgICB9XG4gICAgdGhpcy5vbkNoYW5nZSA9IHRoaXMub25DaGFuZ2UuYmluZCh0aGlzKTsgICAgXG4gIH1cblxuICBvbkNoYW5nZSAodXNlclRhc2tzOiBVc2VyVGFza1tdLCBwZXJzaXN0ZWQ6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUpIHtcbiAgICBpZiAocGVyc2lzdGVkLndlZWtEYXRlICE9PSB0aGlzLnN0YXRlLndlZWtEYXRlKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgY29uZmlybWF0aW9uczogW11cbiAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdXNlclRhc2tzLFxuICAgICAgd2Vla0RhdGU6IHBlcnNpc3RlZC53ZWVrRGF0ZVxuICAgIH0pO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB1c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xuICB9XG5cbiAgYXN5bmMgdG9nZ2xlVGFzayAobGVhcm5pbmdUYXNrOiBMZWFybmluZ01vZHVsZVRhc2spIHtcbiAgICBjb25zdCB1c2VyVGFza3MgPSB0aGlzLnN0YXRlLnVzZXJUYXNrcy5maWx0ZXIodXQgPT4ge1xuICAgICAgcmV0dXJuIGxlYXJuaW5nVGFzay50YXNrID9cbiAgICAgICAgdXQudGFzayAmJiB1dC50YXNrLnNvbWUodCA9PiB0LmlkID09PSBsZWFybmluZ1Rhc2suaWQpIDpcbiAgICAgICAgdXQuc2l0ZVZpc2lvblBhZ2VJZCA9PT0gbGVhcm5pbmdUYXNrLmlkO1xuICAgIH0pO1xuICAgIGNvbnN0IHt3ZWVrRGF0ZX0gPSB0aGlzLnN0YXRlO1xuICAgIFxuICAgIGlmICh1c2VyVGFza3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyBObyB0YXNrIG1hdGNoZXMgdGhpcyBsZWFybmluZ01vZHVsZVRhc2sgLSBub3QgcHJlc2VudCBpbiB3ZWVrcGxhbm5lci5cbiAgICAgIGxldCBsYXRlc3RUaW1lU3RhbXAgPSBNYXRoLm1heC5hcHBseShcbiAgICAgICAgTWF0aC5tYXgsXG4gICAgICAgIFt3ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICAgIGNvbnN0IHVzZXJUYXNrOiBVc2VyVGFzayA9IHtcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgY291cnNlTmFtZTogbGVhcm5pbmdUYXNrLmNvdXJzZU5hbWUsXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxuICAgICAgICBsZWFybmluZ0dvYWw6IGxlYXJuaW5nVGFzay5sZWFybmluZ0dvYWwsXG4gICAgICAgIG5hbWU6IGxlYXJuaW5nVGFzay5uYW1lLFxuICAgICAgICB1cmw6IGxlYXJuaW5nVGFzay51cmwsXG4gICAgICAgIGFjbDogW1xuICAgICAgICAgIC8vIERlZmF1bHQgQUNMOiBMZXQgdXNlciBzZWxmIGhhdmUgZnVsbCBjb250cm9sIG92ZXIgdGhpcyBpdGVtOlxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXG4gICAgICAgICAgLy8gQWRkaXRpb25hbCBBQ0w6IExldCBlbXBsb3llZXMgb24gc2FtZSBzY2hvb2wgaGF2ZSByZWFkIGFjY2VzcyB0byBpdC5cbiAgICAgICAgICAvLyBUaGlzIGN1cnJlbnRseSBvbmx5IGFwcGxpZXMgdG8gdGFza3MgdGhhdCByZWZlciB0byBjb3Vyc2UgdGFza3MgKG5vdCBjdXN0b20gdGFza3MhKVxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcbiAgICAgICAgXS5tYXAoYWMgPT4gYWMudG9TdHJpbmcoKSlcbiAgICAgIH07XG4gICAgICBpZiAobGVhcm5pbmdUYXNrLnRhc2sgJiYgbGVhcm5pbmdUYXNrLnRhc2suZGVhZGxpbmUpIHtcbiAgICAgICAgdXNlclRhc2suZGVhZGxpbmUgPSBsZWFybmluZ1Rhc2sudGFzay5kZWFkbGluZTtcbiAgICAgIH1cbiAgICAgIGlmIChsZWFybmluZ1Rhc2sudGFzaykge1xuICAgICAgICB1c2VyVGFzay50YXNrID0gW2xlYXJuaW5nVGFzay50YXNrXTtcbiAgICAgICAgaWYgKGxlYXJuaW5nVGFzay5jb3Vyc2UpIHtcbiAgICAgICAgICB1c2VyVGFzay5jb3Vyc2UgPSBbbGVhcm5pbmdUYXNrLmNvdXJzZV07XG4gICAgICAgIH0gZWxzZSBpZiAobGVhcm5pbmdUYXNrLmNvdXJzZUluZm8pIHtcbiAgICAgICAgICB1c2VyVGFzay5jb3Vyc2VJbmZvID0gbGVhcm5pbmdUYXNrLmNvdXJzZUluZm87XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVzZXJUYXNrLnNpdGVWaXNpb25QYWdlSWQgPSBsZWFybmluZ1Rhc2suaWQ7XG4gICAgICB9XG4gICAgICBpZiAobGVhcm5pbmdUYXNrLnN0ZXApIHtcbiAgICAgICAgdXNlclRhc2suc3RlcCA9IGxlYXJuaW5nVGFzay5zdGVwO1xuICAgICAgfVxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB1c2VyVGFza3NSZXBvLnNldFdlZWtQbGFubmVyQm94T3BlbihsZWFybmluZ1Rhc2suY291cnNlTmFtZSwgdHJ1ZSksXG4gICAgICAgIHVzZXJUYXNrc1JlcG8uaW5zZXJ0KFt1c2VyVGFza10pXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEFscmVhZHkgcHJlc2VudCBpbiB3ZWVrcGxhbm5lci4gSXQncyB0aW1lIHRvIGRlbGV0ZSB0aG9zZSB0aGF0IG1hdGNoZWQgdXMuXG4gICAgICBhd2FpdCB1c2VyVGFza3NSZXBvLmRlbGV0ZSh1c2VyVGFza3MubWFwKHQgPT4gdC5pZCkpO1xuICAgIH1cbiAgICBcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7bGVhcm5pbmdUYXNrc30gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHVzZXJUYXNrcyA9IGFycmF5VG9NYXAodGhpcy5zdGF0ZS51c2VyVGFza3MsIHV0ID0+IHV0LnRhc2sgJiYgdXQudGFzay5sZW5ndGggPiAwID9cbiAgICAgIHV0LnRhc2subWFwKHQgPT4gdC5pZClbMF0gOiAvLyBjb3Vyc2UtYnVpbGRlciB0YXNrcyBsb29rZWQgdXAgYnkgaWRcbiAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPyB1dC5zaXRlVmlzaW9uUGFnZUlkIDogLy8gbm9uLWNvdXJzZS1idWlsZGVyIHRhc2tzXG4gICAgICB1dC51cmwpO1xuICAgIGNvbnN0IHtjb25maXJtYXRpb25zfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgd2Vla1BsYW5uZXJXZWVrID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcbiAgICBjb25zdCBjdXJyZW50V2VlayA9IG1vbWVudCgpLndlZWsoKTtcbiAgICBjb25zdCBmb3JXZWVrU3RyaW5nID0gd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/IFwiXCIgOlxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgKyAxID8gTGBmw7ZyIG7DpHN0YSB2ZWNrYSAodiR7d2Vla1BsYW5uZXJXZWVrfSlgIDpcbiAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrIC0gMSA/IExgZsO2ciBmw7ZycmEgdmVja2FuICh2JHt3ZWVrUGxhbm5lcldlZWt9KWAgOlxuICAgIExgZsO2ciB2ZWNrYSAke3dlZWtQbGFubmVyV2Vla31gO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAge2xlYXJuaW5nVGFza3MubWFwKChsZWFybmluZ1Rhc2ssIGlkeCkgPT4ge1xuICAgICAgICBjb25zdCB0YXNrTG9va3VwSWQgPSBsZWFybmluZ1Rhc2suaWQ7XG4gICAgICAgIGNvbnN0IHVzZXJUYXNrID0gdXNlclRhc2tzW3Rhc2tMb29rdXBJZF0gfHwgeyRtZXRhOiAnZGVsZXRlZCd9IGFzIFBhcnRpYWw8VXNlclRhc2s+OyAvLyBObyBleGlzdCA9ICRtZXRhOiAnZGVsZXRlZCdcbiAgICAgICAgY29uc3QgaXNXb3JraW5nID0gdXNlclRhc2suJG1ldGEgPT09ICdhZGRpbmcnIHx8IHVzZXJUYXNrLiRtZXRhID09PSAnZGVsZXRpbmcnO1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHVzZXJUYXNrLiRtZXRhICE9PSAnZGVsZXRlZCcgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZyc7XG4gICAgICAgIGNvbnN0IGRlc2NyaWJlZEFjdGlvbiA9IHNlbGVjdGVkID9cbiAgICAgICAgICAgICAgICAgIExgVGEgYm9ydCB1cHBnaWZ0ZW4gZnLDpW4gZWdlbiB2ZWNrb3BsYW5lcmluZyAke2ZvcldlZWtTdHJpbmd9YCA6XG4gICAgICAgICAgICAgICAgICBMYEzDpGdnIHRpbGwgdXBwZ2lmdGVuIGkgZWdlbiB2ZWNrb3BsYW5lcmluZyAke2ZvcldlZWtTdHJpbmd9YDtcbiAgICAgICAgY29uc3QgY29uZmlybWF0aW9uVmlzaWJsZSA9XG4gICAgICAgICAgY29uZmlybWF0aW9ucy5zb21lKHRpZCA9PiB0YXNrTG9va3VwSWQgPT09IHRpZCk7XG5cbiAgICAgICAgcmV0dXJuIDxkaXYga2V5PXtsZWFybmluZ1Rhc2suaWR9PjxkaXYga2V5PXt0YXNrTG9va3VwSWR9IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgc2VsZWN0ZWRCb3gke3NlbGVjdGVkID8gJyBzZWxlY3RlZCcgOiAnJ31gfVxuICAgICAgICAgICAgICAgIHN0eWxlPXtpc1dvcmtpbmcgPyB7b3BhY2l0eTogMC41fToge319XG4gICAgICAgICAgICAgICAgb25DbGljaz17KCk9PiFpc1dvcmtpbmcgJiYgd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/XG4gICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVRhc2sobGVhcm5pbmdUYXNrKSA6XG4gICAgICAgICAgICAgICAgICBjb25maXJtYXRpb25WaXNpYmxlID8gXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IGNvbmZpcm1hdGlvbnMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IHRhc2tMb29rdXBJZCl9KSA6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IFsuLi5jb25maXJtYXRpb25zXS5jb25jYXQodGFza0xvb2t1cElkKX0pfVxuICAgICAgICAgICAgICAgIHRpdGxlPXtkZXNjcmliZWRBY3Rpb259PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGEgaHJlZj17bGVhcm5pbmdUYXNrLnVybH0+e2xlYXJuaW5nVGFzay5uYW1lfTwvYT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxDb25maXJtYXRpb25cbiAgICAgICAgICAgIHZpc2libGU9e2NvbmZpcm1hdGlvblZpc2libGV9XG4gICAgICAgICAgICB0ZXh0PXtkZXNjcmliZWRBY3Rpb259XG4gICAgICAgICAgICBvbkNvbmZpcm09eygpPT57XG4gICAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFzayhsZWFybmluZ1Rhc2spO1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBjb25maXJtYXRpb25zLmZpbHRlcih0aWQgPT4gdGlkICE9PSB0YXNrTG9va3VwSWQpfSk7XG4gICAgICAgICAgICB9fVxuICAgICAgICAgICAgb25DYW5jZWw9eygpPT57XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IGNvbmZpcm1hdGlvbnMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IHRhc2tMb29rdXBJZCl9KTtcbiAgICAgICAgICAgIH19IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB9XG4gICAgICApfVxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQge0NvdXJzZU1vZHVsZSwgQ291cnNlfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEluY2x1ZGVkSWRzIChtb2R1bGU6IENvdXJzZU1vZHVsZSwgY291cnNlOiBDb3Vyc2UpIHtcbiAgY29uc3QgcmVzdWx0ID0ge307XG4gIGNvdXJzZS50YXNrcy5maWx0ZXIodCA9PiBtb2R1bGUudGFza0lkcy5pbmRleE9mKHQuaWQpICE9PSAtMSkuZm9yRWFjaCh0YXNrID0+IHtcbiAgICB0YXNrLmFiaWxpdGllcy5mb3JFYWNoKCh7aWR9KSA9PiByZXN1bHRbaWRdID0gdHJ1ZSk7XG4gICAgdGFzay5jZW50cmFsQ29udGVudC5mb3JFYWNoKCh7aWR9KSA9PiByZXN1bHRbaWRdID0gdHJ1ZSk7XG4gICAgdGFzay5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZm9yRWFjaCgoe2lkfSkgPT4gcmVzdWx0W2lkXSA9IHRydWUpO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsImxldCBpbml0aWFsaXplZCA9IGZhbHNlO1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdE1hbnVhbFNjcm9sbFJlc3RvcmF0aW9uKCkge1xuICBpZiAoIWluaXRpYWxpemVkKSB7XG4gICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ID0+IHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0LnRhZ05hbWUgPT09ICdBJykge1xuICAgICAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZSh7IHBhZ2VZT2Zmc2V0OiB3aW5kb3cucGFnZVlPZmZzZXQgfSwgbnVsbCwgbnVsbCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24pIGhpc3Rvcnkuc2Nyb2xsUmVzdG9yYXRpb24gPSAnbWFudWFsJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzdG9yZVNjcm9sbFBvc2l0aW9uICh7ZmFsbGJhY2tTY3JvbGxQb3NpdGlvbn0pIHtcbiAgaWYgKGhpc3Rvcnkuc3RhdGUgJiYgaGlzdG9yeS5zdGF0ZS5wYWdlWU9mZnNldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgd2luZG93LnNjcm9sbFRvKDAsIGhpc3Rvcnkuc3RhdGUucGFnZVlPZmZzZXQpO1xuICB9IGVsc2UgaWYgKGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgIHdpbmRvdy5zY3JvbGxUbygwLCBmYWxsYmFja1Njcm9sbFBvc2l0aW9uKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IHsgTGlzdENvdXJzZXMgfSBmcm9tICcuL2xpc3QtY291cnNlcyc7XG5pbXBvcnQgeyBMIH0gZnJvbSBcIi4uLy4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5cbmV4cG9ydCBmdW5jdGlvbiBMaXN0Q291cnNlc1BhZ2UoKSB7XG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgPENvdXJzZUJhbm5lclxuICAgICAgdGl0bGU9e2Vudi5jdXJyZW50VXNlci5zY2hvb2x9XG4gICAgICBiYWNrZ3JvdW5kSW1hZ2U9XCJcIlxuICAgICAgdGFicz17W3sgbmFtZTogXCJTa29sYW5zIGt1cnNlclwiLCBsaW5rOiBcIiNcIiB9XX1cbiAgICAgIGFjdGl2ZVRhYj17XCIjXCJ9XG4gICAgLz5cbiAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNwYWNlci0yMHB4dnQgc3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgICAgPExpc3RDb3Vyc2VzIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENvdXJzZSwgU2Nob29sLCBVc2VySGlkZGVuQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgc2hvd0Vycm9yLCBmbGF0dGVuLCBjb21wYXJlUHJvcCwgc2hvd0luZm8sIEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcsIGdlbmVyYXRlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XG5pbXBvcnQgeyBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gJy4uLy4uL2FjY2Vzcy1jb250cm9sL2luZGV4JztcbmltcG9ydCB7IGhpZGRlbkNvdXJzZXNSZXBvLCBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUgfSBmcm9tICcuLi8uLi9yZXBvcy9oaWRkZW4tY291cnNlcy1yZXBvJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdmlld0NvdXJzZVVybD86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgaXNMb2FkaW5nOiBib29sZWFuXG4gIGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdXG4gIGhlYWRlck9wZW46IGJvb2xlYW5cbn1cblxuZXhwb3J0IGNsYXNzIExpc3RDb3Vyc2VzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgY291cnNlczogW10sXG4gICAgICBoZWFkZXJPcGVuOiBmYWxzZVxuICAgIH07XG4gICAgdGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzID0gdGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzLmJpbmQodGhpcyk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgaGlkZGVuQ291cnNlc1JlcG8uc3Vic2NyaWJlKHRoaXMudXBkYXRlSGlkZGVuQ291cnNlcywge2Z1bGxDb3Vyc2U6IHRydWV9KTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGhpZGRlbkNvdXJzZXNSZXBvLnVuc3Vic2NyaWJlKHRoaXMudXBkYXRlSGlkZGVuQ291cnNlcyk7XG4gIH1cblxuICB1cGRhdGVIaWRkZW5Db3Vyc2VzKGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Y291cnNlcywgaXNMb2FkaW5nOiBmYWxzZX0pO1xuICB9XG5cbiAgYXN5bmMgaGlkZUNvdXJzZShjb3Vyc2U6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xuICAgIHNob3dJbmZvKExgU3BhcmFyLi4uYCk7XG4gICAgYXdhaXQgaGlkZGVuQ291cnNlc1JlcG8uaGlkZUNvdXJzZShjb3Vyc2UpO1xuICAgIHNob3dJbmZvKFwiXCIpO1xuICB9XG5cbiAgYXN5bmMgc2hvd0NvdXJzZShjb3Vyc2U6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xuICAgIHNob3dJbmZvKExgU3BhcmFyLi4uYCk7XG4gICAgYXdhaXQgaGlkZGVuQ291cnNlc1JlcG8uc2hvd0NvdXJzZShjb3Vyc2UpO1xuICAgIHNob3dJbmZvKFwiXCIpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICh0aGlzLnN0YXRlLmlzTG9hZGluZykgcmV0dXJuIDxTcGlubmVyIC8+O1xuICAgIGNvbnN0IHtjb3Vyc2VzfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgdmlzaWJsZUNvdXJzZXMgPSBjb3Vyc2VzLmZpbHRlcihjb3Vyc2UgPT4gY291cnNlLnZpc2libGUpO1xuICAgIGNvbnN0IGhpZGRlbkNvdXJzZXMgPSBjb3Vyc2VzLmZpbHRlcihjb3Vyc2UgPT4gIWNvdXJzZS52aXNpYmxlKTtcbiAgICBjb25zdCBxdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcbiAgICBjb25zdCB2aWV3Q291cnNlVXJsID0gdGhpcy5wcm9wcy52aWV3Q291cnNlVXJsIHx8IFwiXCI7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgIDxoMz5Ta29sYW5zIGt1cnNlcjwvaDM+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXIgb2RkLWV2ZW5cIj5cbiAgICAgICAge3Zpc2libGVDb3Vyc2VzLm1hcChjb3Vyc2UgPT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0dWRlbnRDb3Vyc2VcIiBrZXk9e2NvdXJzZS5pZH0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgcHVsbC1yaWdodFwiPlxuICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImhpZGVJdGVtXCIgb25DbGljaz17KCkgPT4gdGhpcy5oaWRlQ291cnNlKGNvdXJzZSl9IC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3ByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KHZpZXdDb3Vyc2VVcmwsIHtjb3Vyc2VJZDogY291cnNlLmlkfSl9Pntjb3Vyc2UubmFtZX08L2E+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPntjb3Vyc2UuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+KX1cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17XCJvcGVuQ2xvc2VcIiArICh0aGlzLnN0YXRlLmhlYWRlck9wZW4gPyBcIiBvcGVuXCIgOiBcIlwiKX0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkhlYWRlclwiIG9uQ2xpY2s9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBoZWFkZXJPcGVuOiAhdGhpcy5zdGF0ZS5oZWFkZXJPcGVuIH0pfT5cbiAgICAgICAgICA8aDU+RG9sZGEga3Vyc2VyPC9oNT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXIgb2RkLWV2ZW5cIj5cbiAgICAgICAgICAgIHtoaWRkZW5Db3Vyc2VzLm1hcChjb3Vyc2UgPT4gXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0dWRlbnRDb3Vyc2VcIiBrZXk9e2NvdXJzZS5pZH0+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHB1bGwtcmlnaHRcIj5cbiAgICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cInNob3dJdGVtXCIgb25DbGljaz17KCkgPT4gdGhpcy5zaG93Q291cnNlKGNvdXJzZSl9PjwvYT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8YSBocmVmPXtnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHsuLi5xdWVyeSwgY291cnNlSWQ6IGNvdXJzZS5pZH0pfT57Y291cnNlLm5hbWV9PC9hPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPntjb3Vyc2UuZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XG5pbXBvcnQgeyBmaW5kRE9NTm9kZSB9IGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBkaWFsb2dzOiBSZWFjdC5Db21wb25lbnRbXTtcbiAgcG9wRGlhbG9nOiAoKT0+dm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIERpYWxvZ3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgbGFzdERpdjogSFRNTERpdkVsZW1lbnQgfCBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IFByb3BzKSB7XG4gICAgaWYgKHRoaXMubGFzdERpdiAhPT0gbnVsbCAmJiBwcmV2UHJvcHMuZGlhbG9ncy5sZW5ndGggPiB0aGlzLnByb3BzLmRpYWxvZ3MubGVuZ3RoKSB7XG4gICAgICAvLyBBIGRpYWxvZyB3YXMgY2xvc2VkLiBOb3cgZm9jdXMgdGhlIGxhc3QgZGlhbG9nOlxuICAgICAgJChmaW5kRE9NTm9kZSh0aGlzLmxhc3REaXYpKS5maW5kKCc6aW5wdXQnKS5maXJzdCgpLmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICB0aGlzLmxhc3REaXYgPSBudWxsO1xuICAgIGNvbnN0IHtkaWFsb2dzLCBwb3BEaWFsb2d9ID0gdGhpcy5wcm9wcztcbiAgICAkKCdib2R5JykuYXR0cignYXJpYS1kaXNhYmxlZCcsIGRpYWxvZ3MubGVuZ3RoID4gMCk7XG4gICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCBkaWFsb2dzLmxlbmd0aCA+IDAgPyAnaGlkZGVuJyA6ICdhdXRvJyk7XG5cbiAgICByZXR1cm4gZGlhbG9ncy5sZW5ndGggPiAwICYmIDxkaXY+XG4gICAgICB7ZGlhbG9ncy5tYXAoKGRpYWxvZywgaWR4KSA9PiB7XG4gICAgICAgIGxldCBkaXY6IEhUTUxEaXZFbGVtZW50O1xuICAgICAgICBmdW5jdGlvbiBvbktleVByZXNzKGV2OiBSZWFjdC5LZXlib2FyZEV2ZW50PEhUTUxEaXZFbGVtZW50Pikge1xuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gMTMgJiYgKCFldi50YXJnZXQgfHwgKGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudCkudGFnTmFtZSAhPT0gJ1RFWFRBUkVBJykpIHtcbiAgICAgICAgICAgICQoZmluZERPTU5vZGUoZGl2KSkuZmluZCgnLmJ0bi1kZWZhdWx0JykuY2xpY2soKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gb25LZXlEb3duKGV2KSB7XG4gICAgICAgICAgaWYgKGV2LndoaWNoID09PSAyNykgeyAvLyBFc2NhcGVcbiAgICAgICAgICAgIHBvcERpYWxvZygpO1xuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gODMgJiYgKGV2LmN0cmxLZXkgfHwgZXYubWV0YUtleSkpIHsgLy8gQ1RSTC1TXG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlID0gZmluZERPTU5vZGUoZGl2KTtcbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0QnV0dG9uID0gJChkb21Ob2RlKS5maW5kKCcuYnRuLWRlZmF1bHQnKTtcbiAgICAgICAgICAgIGRlZmF1bHRCdXR0b24uY2xpY2soKTtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gPGRpdiBrZXk9e2lkeH0+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImRhcmtlblwiIC8+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXBhZ2Utd3JhcFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXBhZ2VcIiByZWY9e2VsZW0gPT4ge1xuICAgICAgICAgIGRpdiA9IGVsZW07XG4gICAgICAgICAgaWYgKGlkeCA9PT0gZGlhbG9ncy5sZW5ndGggLSAxKSB0aGlzLmxhc3REaXYgPSBlbGVtO1xuICAgICAgICB9fVxuICAgICAgICAgICAgdGFiSW5kZXg9ezB9XG4gICAgICAgICAgICBhcmlhLWRpc2FibGVkPXtpZHggPCBkaWFsb2dzLmxlbmd0aCAtIDF9XG4gICAgICAgICAgICBvbktleVByZXNzPXtvbktleVByZXNzfVxuICAgICAgICAgICAgb25LZXlEb3duPXtvbktleURvd259PlxuICAgICAgICAgIHtkaWFsb2d9XG4gICAgICAgICAgPFJlbW92ZUl0ZW0gb25DbGljaz17cG9wRGlhbG9nfSAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3RvcEZsb2F0c1wiPjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2Pn0pfVxuICA8L2Rpdj47XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4vZm9ybS1maWVsZCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxhYmVsOiBhbnk7XG4gIGlkOiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICBhdXRvRm9jdXM/OiBib29sZWFuO1xuICBvbkNoYW5nZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBUZXh0SW5wdXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17dGhpcy5wcm9wcy5sYWJlbH0+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhdXRvRm9jdXM9e3RoaXMucHJvcHMuYXV0b0ZvY3VzfSBpZD17dGhpcy5wcm9wcy5pZH0gc2l6ZT17MzV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5wcm9wcy5vbkNoYW5nZShldi50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgIDwvRm9ybUZpZWxkPlxuICAgICk7XG4gIH1cbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRm9ybUZpZWxkIH0gZnJvbSAnLi9mb3JtLWZpZWxkJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGFiZWw6IGFueTtcbiAgaWQ6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIGF1dG9Gb2N1cz86IGJvb2xlYW47XG4gIHJvd3M/OiBudW1iZXI7XG4gIGNoaWxkcmVuPztcbiAgb25DaGFuZ2U6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgVGV4dEFyZWFGb3JtRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17dGhpcy5wcm9wcy5sYWJlbH0gaWQ9e3RoaXMucHJvcHMuaWR9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPHRleHRhcmVhIGF1dG9Gb2N1cz17dGhpcy5wcm9wcy5hdXRvRm9jdXN9IGlkPXt0aGlzLnByb3BzLmlkfSBjb2xzPXszNX0gcm93cz17dGhpcy5wcm9wcy5yb3dzIHx8IDV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5wcm9wcy5vbkNoYW5nZShldi50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB7ISF0aGlzLnByb3BzLmNoaWxkcmVuICYmIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L0Zvcm1GaWVsZD5cbiAgICApO1xuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGFiZWw6IGFueTtcbiAgY2hpbGRyZW46IGFueTtcbiAgaWQ/OiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGZpbmRJZChub2RlKSB7XG4gIGNvbnN0IHJlY3VjaGVjayA9IG5ldyBTZXQoKTtcbiAgcmV0dXJuIChmdW5jdGlvbiBmaW5kSWQobm9kZSl7XG4gICAgaWYgKHR5cGVvZiBub2RlID09PSAnc3RyaW5nJykgcmV0dXJuIG51bGw7XG4gICAgaWYgKHJlY3VjaGVjay5oYXMobm9kZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmVjdWNoZWNrLmFkZChub2RlKTtcbiAgICBpZiAobm9kZS5wcm9wcykge1xuICAgICAgaWYgKG5vZGUucHJvcHMuaWQpIHJldHVybiBub2RlLnByb3BzLmlkO1xuICAgICAgaWYgKG5vZGUucHJvcHMuY2hpbGRyZW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbmRJZChub2RlLnByb3BzLmNoaWxkcmVuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG5vZGUubGVuZ3RoKSB7XG4gICAgICBmb3IgKGxldCBpPTA7aTxub2RlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gbm9kZVtpXTtcbiAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgY29uc3QgY2hpbGRJZCA9IGZpbmRJZChjaGlsZCk7XG4gICAgICAgICAgaWYgKGNoaWxkSWQpIHJldHVybiBjaGlsZElkO1xuICAgICAgICAgIC8vY29uc29sZS5sb2coY2hpbGQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KShub2RlKTtcbn1cblxuZXhwb3J0IGNsYXNzIEZvcm1GaWVsZCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiA8PlxuICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwia2NsYWJlbFwiIGh0bWxGb3I9e3RoaXMucHJvcHMuaWQgfHwgZmluZElkKHRoaXMucHJvcHMuY2hpbGRyZW4pfT57dGhpcy5wcm9wcy5sYWJlbH08L2xhYmVsPlxuICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cbiAgICA8Lz5cbiAgfVxufVxuIiwiLyogUkVGQUNUT1I6IE1vdmUgdGhpcyBjb21wb25lbnQgb3V0c2lkZSBjb3Vyc2VidWlsZGVyIVxuICAgVGhpcyBpcyBhIGdlbmVyYWwtcHVycG9zZSBjb21wb25lbnRcbiovXG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGl0bGU6IHN0cmluZyB8IEpTWC5FbGVtZW50O1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIGhlYWRlckNsYXNzTmFtZT86IHN0cmluZztcbiAgY29udGVudENsYXNzTmFtZT86IHN0cmluZztcbiAgaGVhZGVyT3Blbj86IGJvb2xlYW47XG4gIG9uT3BlbkNsb3NlPzogKGJlY2FtZU9wZW46IGJvb2xlYW4pID0+IHZvaWQ7XG4gIGNoaWxkcmVuO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBoZWFkZXJPcGVuOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgT3BlbkNsb3NlQm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIChuZXh0UHJvcHM6IFByb3BzKSB7XG4gICAgaWYgKG5leHRQcm9wcy5oZWFkZXJPcGVuICE9PSB0aGlzLnByb3BzLmhlYWRlck9wZW4pIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2hlYWRlck9wZW46IG5leHRQcm9wcy5oZWFkZXJPcGVufSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGl0bGUsIGNsYXNzTmFtZSwgY2hpbGRyZW4sIGhlYWRlckNsYXNzTmFtZSwgY29udGVudENsYXNzTmFtZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9eyhjbGFzc05hbWV8fCcnKSArIFwiIG9wZW5DbG9zZVwiICsgKGhlYWRlck9wZW4gPyBcIiBvcGVuXCIgOiBcIlwiKX0+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT17XCJvcGVuSGVhZGVyXCIgKyAoaGVhZGVyQ2xhc3NOYW1lID8gXCIgXCIgKyBoZWFkZXJDbGFzc05hbWUgOiBcIlwiKX1cbiAgICAgICAgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLnByb3BzLm9uT3BlbkNsb3NlKSB0aGlzLnByb3BzLm9uT3BlbkNsb3NlKCF0aGlzLnN0YXRlLmhlYWRlck9wZW4pO1xuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBoZWFkZXJPcGVuOiAhdGhpcy5zdGF0ZS5oZWFkZXJPcGVuIH0pO1xuICAgICAgICB9fSA+XG4gICAgICAgIHt0aXRsZX1cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkNvbnRlbnRcIiArIChjb250ZW50Q2xhc3NOYW1lID8gXCIgXCIgKyBjb250ZW50Q2xhc3NOYW1lIDogXCJcIil9PlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGVhcm5pbmdHb2FsPzogc3RyaW5nO1xuICBvblNhdmU6IChsZWFybmluZ0dvYWw6IHN0cmluZykgPT4gdm9pZDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgbGVhcm5pbmdHb2FsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBBZGRDdXN0b21Hb2FsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcylcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgbGVhcm5pbmdHb2FsOiBwcm9wcy5sZWFybmluZ0dvYWwgfHwgJydcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2xlYXJuaW5nR29hbH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtvblNhdmV9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgIDxoMj5Mw6RnZyB0aWxsIGVnZXQgbMOkcmFuZGVtw6VsPC9oMj5cbiAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+TcOlbDo8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIHRhYkluZGV4PXsxfSBzaXplPXs1MH0gYXV0b0ZvY3VzXG4gICAgICAgICAgICAgICAgdmFsdWU9e2xlYXJuaW5nR29hbH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17ZSA9PiB0aGlzLnNldFN0YXRlKHtsZWFybmluZ0dvYWw6IGUudGFyZ2V0LnZhbHVlfSl9IC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHNwYWNlZFwiIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGJyIC8+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcbiAgICAgICAgICBvbkNsaWNrPXsoKT0+b25TYXZlKGxlYXJuaW5nR29hbCl9PlNwYXJhPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfVxufVxuXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBUZXh0SW5wdXQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0LWlucHV0JztcbmltcG9ydCB7IFRleHRBcmVhRm9ybUZpZWxkIH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dGFyZWEnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpc1Rhc2s6IGJvb2xlYW5cbiAgb25TYXZlOiAobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4gdm9pZDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEFkZEN1c3RvbVRhc2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgdXJsOiAnJ1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBpc1Rhc2ssIG9uU2F2ZSB9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICA8aDI+TMOkZ2cgdGlsbCBlZ2V0IGFyYmV0c23DpWw8L2gyPlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPFRleHRJbnB1dFxuICAgICAgICAgIGxhYmVsPVwiTmFtblwiXG4gICAgICAgICAgaWQ9XCJBZGRDdXN0b21UYXNrOm5hbWVcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQW5nZSBuYW1uLi4uXCJcbiAgICAgICAgICB2YWx1ZT17bmFtZX1cbiAgICAgICAgICBhdXRvRm9jdXNcbiAgICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XG5cbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXG4gICAgICAgICAgcm93cz17N31cbiAgICAgICAgICBsYWJlbD1cIkJlc2tyaXZuaW5nXCJcbiAgICAgICAgICBpZD1cIkFkZEN1c3RvbVRhc2s6ZGVzY3JpcHRpb25cIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiTMOkZ2cgdGlsbCBlbiBiZXNrcml2bmluZy4uLlwiXG4gICAgICAgICAgdmFsdWU9e2Rlc2NyaXB0aW9ufVxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbj0+dGhpcy5zZXRTdGF0ZSh7ZGVzY3JpcHRpb259KX0gLz5cblxuICAgICAgICA8VGV4dElucHV0XG4gICAgICAgICAgbGFiZWw9XCJMw6Rua1wiXG4gICAgICAgICAgaWQ9XCJBZGRDdXN0b21UYXNrOnVybFwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJodHRwOi8vd3d3Li4uXCJcbiAgICAgICAgICB2YWx1ZT17dXJsfVxuICAgICAgICAgIG9uQ2hhbmdlPXt1cmwgPT4gdGhpcy5zZXRTdGF0ZSh7dXJsfSl9IC8+XG5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZSBidG4tZGVmYXVsdFwiXG4gICAgICAgICAgb25DbGljaz17KCkgPT4gb25TYXZlKG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwpfT5TcGFyYTwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XG5pbXBvcnQgeyBUZXh0QXJlYUZvcm1GaWVsZCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHRhcmVhJztcbmltcG9ydCB7IFVzZXJUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBVc2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcblxudHlwZSBQcm9wcyA9IHtcbiAgLy8gRWRpdCBNb2RlXG4gIG1vZGU6ICdhZGQnO1xuICB1c2VyVGFzazogVXNlclRhc2s7XG4gIGNsb3NlRGlhbG9nO1xuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXG59IHwge1xuICBtb2RlOiAnZWRpdCc7XG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcbiAgc3ViVGFzazogVXNlclN1YlRhc2s7XG4gIGNsb3NlRGlhbG9nOiAoKT0+dm9pZDtcbiAgdXNlclRhc2tzUmVwbzogVXNlclRhc2tzUmVwb1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQWRkT3JFZGl0U3ViVGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIGlmIChwcm9wcy5tb2RlID09PSAnZWRpdCcpIHtcbiAgICAgIGNvbnN0IHtzdWJUYXNrfSA9IHByb3BzO1xuICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgbmFtZTogc3ViVGFzay5uYW1lIHx8ICcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogc3ViVGFzay5kZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgdXJsOiBzdWJUYXNrLnVybCB8fCAnJ1xuICAgICAgfTtcbiAgICB9IGVsc2UgeyAgXG4gICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICB1cmw6ICcnXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIHNhdmUoKSB7XG4gICAgLy8gVXBkYXRlIHJlcG86XG4gICAgY29uc3Qge3Byb3BzfSA9IHRoaXM7XG4gICAgY29uc3Qge3VzZXJUYXNrLCBjbG9zZURpYWxvZywgdXNlclRhc2tzUmVwb30gPSBwcm9wcztcbiAgICBjb25zdCB7bmFtZSwgZGVzY3JpcHRpb24sIHVybH0gPSB0aGlzLnN0YXRlO1xuICAgIGlmIChwcm9wcy5tb2RlID09PSAnZWRpdCcpIHtcbiAgICAgIC8vIEVkaXQgZXhpc3Rpbmc6XG4gICAgICB1c2VyVGFza3NSZXBvLnVwZGF0ZShbdXNlclRhc2tdLCB1dCA9PiB7XG4gICAgICAgIGNvbnN0IHtzdWJUYXNrc30gPSB1dDtcbiAgICAgICAgaWYgKHN1YlRhc2tzKSB7XG4gICAgICAgICAgdXQuc3ViVGFza3MgPSBzdWJUYXNrcy5tYXAoc3QgPT5cbiAgICAgICAgICAgIHN0LmlkID09PSBwcm9wcy5zdWJUYXNrLmlkID8gey4uLnN0LCBuYW1lLCBkZXNjcmlwdGlvbiwgdXJsfSA6XG4gICAgICAgICAgICB7Li4uc3R9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIENyZWF0ZSBuZXcgdGFza1xuICAgICAgY29uc3QgbmV3U3ViVGFzayA9IHtcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHVybFxuICAgICAgfTtcblxuICAgICAgLy8gVXBkYXRlIHJlcG86XG4gICAgICB1c2VyVGFza3NSZXBvLnVwZGF0ZShbdXNlclRhc2tdLCB1dCA9PiB7XG4gICAgICAgIGlmICghdXQuc3ViVGFza3MpIHtcbiAgICAgICAgICB1dC5zdWJUYXNrcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHV0LnN1YlRhc2tzID0gdXQuc3ViVGFza3MuY29uY2F0KG5ld1N1YlRhc2spO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2xvc2UgZGlhbG9nXG4gICAgY2xvc2VEaWFsb2coKTsgICAgXG4gIH1cblxuICBkZWxldGUoKSB7XG4gICAgLy8gVXBkYXRlIHJlcG86XG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzOyAgXG4gICAgaWYgKHByb3BzLm1vZGUgIT09ICdlZGl0Jykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuIG9ubHkgZGVsZXRlIGluIGVkaXQgbW9kZVwiKTtcbiAgICB9XG4gICAgcHJvcHMudXNlclRhc2tzUmVwby51cGRhdGUoW3Byb3BzLnVzZXJUYXNrXSwgdXQgPT4ge1xuICAgICAgaWYgKHV0LnN1YlRhc2tzKSB7XG4gICAgICAgIHV0LnN1YlRhc2tzID0gdXQuc3ViVGFza3MuZmlsdGVyKHQgPT4gdC5pZCAhPT0gcHJvcHMuc3ViVGFzay5pZCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBDbG9zZSBkaWFsb2c6XG4gICAgcHJvcHMuY2xvc2VEaWFsb2coKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7bmFtZSwgZGVzY3JpcHRpb24sIHVybH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtwcm9wc30gPSB0aGlzO1xuICAgIGNvbnN0IGlzRWRpdE1vZGUgPSBwcm9wcy5tb2RlID09PSAnZWRpdCc7XG4gICAgXG4gICAgcmV0dXJuIDw+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgIDxoMj57aXNFZGl0TW9kZSA/ICdSZWRpZ2VyYSB1bmRlcnVwcGdpZnQnIDogJ0zDpGdnIHRpbGwgdW5kZXJ1cHBnaWZ0J308L2gyPlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPFRleHRJbnB1dFxuICAgICAgICAgIGF1dG9Gb2N1c1xuICAgICAgICAgIGxhYmVsPVwiVW5kZXJ1cHBnaWZ0ZW5zIG5hbW5cIlxuICAgICAgICAgIGlkPVwiQWRkVXNlclN1YlRhc2s6bmFtZVwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLm5hbWV9XG4gICAgICAgICAgb25DaGFuZ2U9e25hbWUgPT4gdGhpcy5zZXRTdGF0ZSh7bmFtZX0pfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXG4gICAgICAgICAgbGFiZWw9XCJCZXNrcml2bmluZ1wiXG4gICAgICAgICAgaWQ9XCJBZGRVc2VyU3ViVGFzazpkZXNjcmlwdGlvblwiXG4gICAgICAgICAgcm93cz17N31cbiAgICAgICAgICBwbGFjZWhvbGRlcj1cIlwiXG4gICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUuZGVzY3JpcHRpb259XG4gICAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uID0+IHRoaXMuc2V0U3RhdGUoe2Rlc2NyaXB0aW9ufSl9XG4gICAgICAgICAgICAvPlxuICAgICAgICA8VGV4dElucHV0XG4gICAgICAgICAgbGFiZWw9XCJMw6Rua1wiXG4gICAgICAgICAgaWQ9XCJBZGRVc2VyU3ViVGFzazp1cmxcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiXCJcbiAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS51cmx9XG4gICAgICAgICAgb25DaGFuZ2U9e3VybCA9PiB0aGlzLnNldFN0YXRlKHt1cmx9KX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgIDxiciAvPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgIHtcbiAgICAgICAgICBwcm9wcy5tb2RlID09PSAnZWRpdCcgJiYgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIlxuICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+IHRoaXMuZGVsZXRlKCl9PlxuICAgICAgICAgIHtcIlRhIGJvcnQgdW5kZXJ1cHBnaWZ0XCJ9PC9idXR0b24+fVxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZSBidG4tZGVmYXVsdFwiXG4gICAgICAgICAgb25DbGljaz17KCk9PnRoaXMuc2F2ZSgpfT5TcGFyYTwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC8+XG4gIH1cbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVXNlclRhc2ssIFVzZXJTdWJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgUmVuYW1lYWJsZVRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvcmVuYW1lYWJsZS10ZXh0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBnZXRUYXNrVHlwZSB9IGZyb20gJy4vZ2V0LXRhc2stdHlwZSc7XG5pbXBvcnQgUmVhY3REYXRlUGlja2VyLCB7IFJlYWN0RGF0ZVBpY2tlclByb3BzIH0gZnJvbSAncmVhY3QtZGF0ZXBpY2tlcic7XG5pbXBvcnQgJy4uLy4uL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZSc7XG5pbXBvcnQge1RleHRJbnB1dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZCc7XG5pbXBvcnQgeyBBZGRPckVkaXRTdWJUYXNrIH0gZnJvbSAnLi9hZGQtb3ItZWRpdC1zdWItdGFzayc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcbmltcG9ydCB7IFVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcbiAgb25VcGRhdGU6ICh1cGRhdGVyOiAodXNlclRhc2s6IFVzZXJUYXNrKSA9PiB2b2lkKSA9PiB2b2lkO1xuICBvbkRlbGV0ZTogKHVzZXJUYXNrSWQ6IHN0cmluZykgPT4gdm9pZDtcbiAgb3BlbkRpYWxvZzogKGRpYWxvZykgPT4gdm9pZDtcbiAgY2xvc2VEaWFsb2c6ICgpPT52b2lkO1xuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgZGVhZGxpbmU/OiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICBzdWJUYXNrcz86IFVzZXJTdWJUYXNrW107XG4gIHNob3dDYWxlbmRhcj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0VXNlclRhc2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgZGF0ZVBpY2tlcjogYW55O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdXNlclRhc2s6IHByb3BzLnVzZXJUYXNrLFxuICAgICAgbmFtZTogcHJvcHMudXNlclRhc2submFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBwcm9wcy51c2VyVGFzay5kZXNjcmlwdGlvbixcbiAgICAgIHVybDogcHJvcHMudXNlclRhc2sudXJsLFxuICAgICAgZGVhZGxpbmU6IHByb3BzLnVzZXJUYXNrLmRlYWRsaW5lLFxuICAgICAgc3ViVGFza3M6IHByb3BzLnVzZXJUYXNrLnN1YlRhc2tzXG4gICAgfVxuICAgIHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkID0gdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucHJvcHMudXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vblVzZXJUYXNrc0NoYW5nZWQpO1xuICB9XG5cbiAgb25Vc2VyVGFza3NDaGFuZ2VkKHVzZXJUYXNrczogVXNlclRhc2tbXSkge1xuICAgIGNvbnN0IG15VXNlclRhc2sgPSB1c2VyVGFza3MuZmluZCh1dCA9PiB1dC5pZCA9PT0gdGhpcy5wcm9wcy51c2VyVGFzay5pZCk7XG4gICAgaWYgKCFteVVzZXJUYXNrKSB7XG4gICAgICB0aGlzLnByb3BzLmNsb3NlRGlhbG9nKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdXNlclRhc2s6IG15VXNlclRhc2ssXG4gICAgICBzdWJUYXNrczogbXlVc2VyVGFzay5zdWJUYXNrc1xuICAgIH0pO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcbiAgfVxuXG4gIGlzTW9kaWZpZWQoKSB7XG4gICAgLy8gRG9uJ3QgY291bnQgc3VidGFzayBjaGFuZ2VzISBUaGV5IGxpdmUgdGhlaXIgb3duIGxpZmUgYW5kIGlzIG1haW50YWluZWRcbiAgICAvLyBpbiBhZGQtb3ItZWRpdC1zdWItdGFzay50c3guIFJlYXNvbjogVXNlciB3b3VsZCBleHBlY3QgYWRkZWQgL2VkaXRlZCBzdWJ0YXNrc1xuICAgIC8vIHRvIGJlIHBlcnNpc3RlZCByaWdodCBhd2F5LiBNYXkgY2xpY2sgYXdheSB0aGlzIGRpYWxvZy5cbiAgICAvLyBBbHNvIHJlYXNvbjogQ2FuIGludm9rZSB0aGF0IGRpYWxvZyBieSBpdHNlbGYgZnJvbSBvdGhlciBjb21wb25lbnRzLiBGcm9tIFdlZWtQbGFubmVyXG4gICAgLy8gd2hlbiBjbGlja2luZyB0aGUgc3VidGFzayBmb3IgZXhhbXBsZSFcblxuICAgIGNvbnN0IHtkZWFkbGluZSwgZGVzY3JpcHRpb24sIG5hbWUsIHVybCwgdXNlclRhc2t9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgZGVhZGxpbmUgIT09IHVzZXJUYXNrLmRlYWRsaW5lIHx8XG4gICAgICBkZXNjcmlwdGlvbiAhPT0gdXNlclRhc2suZGVzY3JpcHRpb24gfHxcbiAgICAgIG5hbWUgIT09IHVzZXJUYXNrLm5hbWUgfHxcbiAgICAgIHVybCAhPT0gdXNlclRhc2sudXJsKTtcbiAgfVxuXG4gIGFkZFN1YlRhc2soKTogYW55IHtcbiAgICB0aGlzLnByb3BzLm9wZW5EaWFsb2coPEFkZE9yRWRpdFN1YlRhc2tcbiAgICAgIG1vZGU9XCJhZGRcIlxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XG4gICAgICBjbG9zZURpYWxvZz17dGhpcy5wcm9wcy5jbG9zZURpYWxvZ31cbiAgICAgIHVzZXJUYXNrc1JlcG89e3RoaXMucHJvcHMudXNlclRhc2tzUmVwb31cbiAgICAvPik7XG4gIH1cblxuICBlZGl0U3ViVGFzayhzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xuICAgIHRoaXMucHJvcHMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xuICAgICAgbW9kZT1cImVkaXRcIlxuICAgICAgc3ViVGFzaz17c3ViVGFza31cbiAgICAgIHVzZXJUYXNrPXt0aGlzLnN0YXRlLnVzZXJUYXNrfVxuICAgICAgY2xvc2VEaWFsb2c9e3RoaXMucHJvcHMuY2xvc2VEaWFsb2d9XG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XG4gICAgLz4pO1xuICB9XG4gIFxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgdXJsLCBkZWFkbGluZSwgc3ViVGFza3MsIHNob3dDYWxlbmRhciwgdXNlclRhc2sgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBpZCwgY291cnNlTmFtZSB9ID0gdXNlclRhc2s7XG4gICAgY29uc3QgeyBvblVwZGF0ZSwgb25EZWxldGUgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgaXNNb2RpZmllZCA9IHRoaXMuaXNNb2RpZmllZCgpO1xuXG4gICAgY29uc3QgdGFza1R5cGUgPSBnZXRUYXNrVHlwZSh1c2VyVGFzayk7XG4gICAgY29uc3QgaXNDdXN0b21UYXNrID0gdGFza1R5cGUgPT09ICdjdXN0b21UYXNrJztcbiAgICBjb25zdCBleHBpcmVkID0gbW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKSA8IG1vbWVudCgpO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZWRpdFRhc2tEaWFsb2cgc3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgIDxoMj57aXNDdXN0b21UYXNrID8gYFJlZGlnZXJhIGFyYmV0c23DpWxgIDogYFJlZGlnZXJhIHVwcGdpZnRgfTwvaDI+XG4gICAgICA8aHIgLz5cbiAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgYXV0b0ZvY3VzXG4gICAgICAgIGxhYmVsPXtpc0N1c3RvbVRhc2sgPyBcIkFyYmV0c23DpWxldHMgbmFtblwiIDogXCJVcHBnaWZ0ZW5zIG5hbW5cIn1cbiAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6bmFtZVwiXG4gICAgICAgIHBsYWNlaG9sZGVyPXtpc0N1c3RvbVRhc2sgPyBcIlZhZCBza2EgZHUgZ8O2cmE/XCIgOiBcIkFuZ2UgdXBwZ2lmdGVucyBuYW1uLi4uXCJ9XG4gICAgICAgIHZhbHVlPXtuYW1lfVxuICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XG4gICAgICBcbiAgICAgIHtpc0N1c3RvbVRhc2sgJiYgPD5cbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXG4gICAgICAgICAgcm93cz17NX1cbiAgICAgICAgICBsYWJlbD1cIkJlc2tyaXZuaW5nXCJcbiAgICAgICAgICBpZD1cIkVkaXRVc2VyVGFzazpkZXNjcmlwdGlvblwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJMw6RnZyB0aWxsIGVuIGJlc2tyaXZuaW5nLi4uXCJcbiAgICAgICAgICB2YWx1ZT17ZGVzY3JpcHRpb259XG4gICAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uPT50aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfSAvPlxuXG4gICAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgICBsYWJlbD1cIkzDpG5rXCJcbiAgICAgICAgICBpZD1cIkVkdXRVc2VyVGFzazp1cmxcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiaHR0cChzKTovLy4uLlwiXG4gICAgICAgICAgdmFsdWU9e3VybH1cbiAgICAgICAgICBvbkNoYW5nZT17dXJsID0+IHRoaXMuc2V0U3RhdGUoe3VybH0pfSA+XG5cbiAgICAgICAgPC9UZXh0SW5wdXQ+PC8+fVxuXG4gICAgICAgIDxGb3JtRmllbGQgbGFiZWw9XCJBbmdlIGRlYWRsaW5lXCI+XG4gICAgICAgICAgeyhkZWFkbGluZSB8fCBzaG93Q2FsZW5kYXIpID9cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIDxSZWFjdERhdGVQaWNrZXIgcmVmPXtlbGVtID0+IHRoaXMuZGF0ZVBpY2tlciA9IGVsZW19XG4gICAgICAgICAgICAgICAgICBpZD1cIkVkaXRVc2VyVGFzazpkZWFkbGluZVwiXG4gICAgICAgICAgICAgICAgICBzZWxlY3RlZD17ZGVhZGxpbmUgJiYgbW9tZW50KGRlYWRsaW5lKX1cbiAgICAgICAgICAgICAgICAgIGF1dG9Gb2N1cz17c2hvd0NhbGVuZGFyfVxuICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdD1cIllZWVktTU0tRERcIlxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtleHBpcmVkID8gXCJleHBpcmVkXCIgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgICBsb2NhbGU9e1wic3ZcIn1cbiAgICAgICAgICAgICAgICAgIHBvcHBlclBsYWNlbWVudD17aXNDdXN0b21UYXNrID8gXCJ0b3Atc3RhcnRcIiA6IFwiYm90dG9tLXN0YXJ0XCJ9XG4gICAgICAgICAgICAgICAgICBvbkJsdXI9eygpPT50aGlzLnNldFN0YXRlKHtzaG93Q2FsZW5kYXI6IGZhbHNlfSl9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dmFsdWU9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgZGVhZGxpbmU6IHZhbHVlICYmIHZhbHVlLmZvcm1hdChcIllZWVktTU0tRERcIiksXG4gICAgICAgICAgICAgICAgICAgICAgc2hvd0NhbGVuZGFyOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZGVsZXRlRGF0ZVwiIGhyZWY9XCIjXCIgdGl0bGU9XCJUYSBib3J0IGRlYWRsaW5lXCIgb25DbGljaz17ZXY9PntcbiAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtkZWFkbGluZTogbnVsbCwgc2hvd0NhbGVuZGFyOiBmYWxzZX0pO1xuICAgICAgICAgICAgICAgIH19PjwvYT5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj4gOlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b3BcIiByZWY9eygpPT57dGhpcy5kYXRlUGlja2VyID0gbnVsbH19PlxuICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2V2ID0+IHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGVQaWNrZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRlUGlja2VyLnNldE9wZW4odHJ1ZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2hvd0NhbGVuZGFyOiB0cnVlXG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9fT5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1jYWxlbmRhclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gQW5nZSBkZWFkbGluZS4uLlxuICAgICAgICAgICAgICA8L2E+ICAgICAgICAgICAgICBcbiAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgPC9Gb3JtRmllbGQ+XG4gICAgICA8Rm9ybUZpZWxkIGxhYmVsPVwiVW5kZXJ1cHBnaWZ0ZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuXG4gICAgICAgICAgICAgIHtzdWJUYXNrcyAmJiBzdWJUYXNrcy5tYXAoc3ViVGFzayA9PiA8ZGl2IGtleT17c3ViVGFzay5pZH0gY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+PGFcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLmVkaXRTdWJUYXNrKHN1YlRhc2spfVxuICAgICAgICAgICAgICAgICAgaHJlZj1cIiNcIj57c3ViVGFzay5uYW1lfTwvYT48L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9wXCI+XG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiRWRpdFVzZXJUYXNrOmFkZFN1YlRhc2tcIiBjbGFzc05hbWU9XCJidG5cIlxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5hZGRTdWJUYXNrKCl9PlxuICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wbHVzXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiBMw6RnZyB0aWxsIHVuZGVydXBwZ2lmdFxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9Gb3JtRmllbGQ+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImRpdmlkZXIgbGFyZ2VcIiAvPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEJ1dHRvbiB0b3BcIj5cbiAgICAgICAgICA8YnV0dG9uIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpPT57XG4gICAgICAgICAgICAgIGlzTW9kaWZpZWQgPyBvblVwZGF0ZSh1c2VyVGFzayA9PiB7XG4gICAgICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgdXNlclRhc2suZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICB1c2VyVGFzay51cmwgPSB1cmw7XG4gICAgICAgICAgICAgICAgdXNlclRhc2suZGVhZGxpbmUgPSBkZWFkbGluZTtcbiAgICAgICAgICAgICAgfSkgOiB0aGlzLnByb3BzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgICAgICB9fT4gU3BhcmEgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxCdXR0b24gdG9wXCI+XG4gICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0blwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xuICAgICAgICAgICAgICB0aGlzLnByb3BzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgICAgICB9fT4gQXZicnl0IDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25maXJtIHRvcCBwdWxsLXJpZ2h0XCI+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmdcIlxuICAgICAgICAgICAgb25DbGljaz17KCk9PntcbiAgICAgICAgICAgICAgb25EZWxldGUoaWQpO1xuICAgICAgICAgICAgfX0+e2lzQ3VzdG9tVGFzayA/XG4gICAgICAgICAgICAgIFwiIFRhIGJvcnQgYXJiZXRzbcOlbFwiIDpcbiAgICAgICAgICAgICAgXCIgVGEgYm9ydCBkZW4gaMOkciB1cHBnaWZ0ZW5cIlxuICAgICAgICAgIH08L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgey8qPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXtldiA9PiBvbkRlbGV0ZShpZCl9PlxuICAgICAgICB7TGBUYSBib3J0IGFyYmV0c23DpWxgfTwvZGl2PlxuICAgICAge2lzTW9kaWZpZWQgJiZcbiAgICAgICAgPGRpdlxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxuICAgICAgICAgIHRhYkluZGV4PXswfVxuICAgICAgICAgIG9uQ2xpY2s9eygpPT5vblVwZGF0ZSh1c2VyVGFzayA9PiB7XG4gICAgICAgICAgICB1c2VyVGFzay5uYW1lID0gbmFtZTtcbiAgICAgICAgICAgIHVzZXJUYXNrLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgICAgICB1c2VyVGFzay51cmwgPSB1cmw7XG4gICAgICAgICAgfSl9PiBTcGFyYTwvZGl2Pn0qL31cbiAgICA8L2Rpdj5cbiAgfVxufVxuXG4iLCJpbXBvcnQgeyBVc2VyVGFzayB9IGZyb20gXCJrZWRiYWNrZW5kL21vZGVsc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFza1R5cGUgKHVzZXJUYXNrOiBVc2VyVGFzaykgOiAnY291cnNlQnVpbGRlclRhc2snIHwgJ3NpdGVWaXNpb25UYXNrJyB8ICdzdWJqZWN0UGxhbm5lclRhc2snIHwgJ2N1c3RvbVRhc2snIHtcbiAgcmV0dXJuIHVzZXJUYXNrLmNvdXJzZSAmJiB1c2VyVGFzay50YXNrICYmIHVzZXJUYXNrLmNvdXJzZS5sZW5ndGggPiAwICYmIHVzZXJUYXNrLnRhc2subGVuZ3RoID4gMCA/XG4gICAgJ2NvdXJzZUJ1aWxkZXJUYXNrJyA6XG4gICAgdXNlclRhc2suc2l0ZVZpc2lvblBhZ2VJZCA/XG4gICAgICAnc2l0ZVZpc2lvblRhc2snIDpcbiAgICAgICAgdXNlclRhc2suY291cnNlSW5mbyA/XG4gICAgICAgICAgJ3N1YmplY3RQbGFubmVyVGFzaycgOlxuICAgICAgICAgICdjdXN0b21UYXNrJztcbn1cbiIsImV4cG9ydCB7V2Vla1BsYW5uZXJ9IGZyb20gJy4vd2Vla3BsYW5uZXInO1xuIiwiaW1wb3J0IHsgVXNlclRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBVc2VyVGFza3NCb3hQcm9wcyB9IGZyb20gJy4vdXNlci10YXNrcy1ib3gnO1xuaW1wb3J0IHsgYXJyYXlUb01hcCwgYXJyYXlUb0xvb2t1cCwgY29tcGFyZVByb3AsIEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBWaXJ0dWFsTGVhcm5pbmdHb2FsIHtcbiAgbmFtZTogc3RyaW5nO1xuICBhbGxUYXNrczogVXNlclRhc2tbXTtcbiAgc3RlcD86IG51bWJlcjtcbiAgdXJsPzogc3RyaW5nO1xuICB0YXNrczogVXNlclRhc2tbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZmluZSh0YXNrczogVXNlclRhc2tbXSkge1xuICBjb25zdCByZXN1bHQgPSBbXSBhcyBQYXJ0aWFsPFVzZXJUYXNrc0JveFByb3BzPltdO1xuICBjb25zdCBtYXBwZXIgPSB7fSBhcyB7IFtuYW1lOiBzdHJpbmddOiBVc2VyVGFza3NCb3hQcm9wcyB9O1xuICBjb25zdCB0YXNrc1BlckNvdXJzZSA9IGFycmF5VG9Mb29rdXAodGFza3MsIHQgPT4gdC5jb3Vyc2VOYW1lIHx8ICcnKTtcbiAgZm9yIChjb25zdCBjb3Vyc2VOYW1lIG9mIE9iamVjdC5rZXlzKHRhc2tzUGVyQ291cnNlKS5zb3J0KCkuZmlsdGVyKHggPT4geCkuY29uY2F0KHRhc2tzUGVyQ291cnNlWycnXSA/XG4gICAgWycnXSA6IFtdKSkge1xuICAgIGNvbnN0IGNvdXJzZVRhc2tzID0gdGFza3NQZXJDb3Vyc2VbY291cnNlTmFtZV0gfHwgdGFza3NQZXJDb3Vyc2VbJyddO1xuICAgIGNvbnN0IHRhc2tzUGVyTGVhcm5pbmdHb2FsID0gYXJyYXlUb0xvb2t1cChjb3Vyc2VUYXNrcywgdCA9PiB0LmxlYXJuaW5nR29hbCk7XG4gICAgY29uc3QgcmVzdWx0TGVhcm5pbmdHb2FsczogVmlydHVhbExlYXJuaW5nR29hbFtdID0gW107XG4gICAgZm9yIChjb25zdCBsZWFybmluZ0dvYWwgb2YgT2JqZWN0LmtleXModGFza3NQZXJMZWFybmluZ0dvYWwpKSB7XG4gICAgICBjb25zdCBsZ1Rhc2tzID0gdGFza3NQZXJMZWFybmluZ0dvYWxbbGVhcm5pbmdHb2FsXS5zb3J0KGNvbXBhcmVQcm9wKFwiZGF0ZVRpbWVcIikpO1xuICAgICAgY29uc3QgbGVhcm5pbmdHb2FsVGFzayA9IGxnVGFza3NcbiAgICAgICAgLmZpbHRlcih0ID0+IHQubmFtZSA9PSBudWxsKSAvLyBJZiBuYW1lIGlzIHVuZGVmaW5lZCBvciBudWxsLCB0aGlzIHJlcHJlc2VudHMgYSBsZWFybmluZyBnb2FsXG4gICAgICAgIFswXTtcbiAgICAgIGNvbnN0IHVybCA9IGxlYXJuaW5nR29hbFRhc2sgJiYgbGVhcm5pbmdHb2FsVGFzay51cmw7XG4gICAgICByZXN1bHRMZWFybmluZ0dvYWxzLnB1c2goe1xuICAgICAgICBuYW1lOiBsZWFybmluZ0dvYWwsXG4gICAgICAgIGFsbFRhc2tzOiBsZ1Rhc2tzLFxuICAgICAgICB1cmwsXG4gICAgICAgIHN0ZXA6IGxnVGFza3MubWFwKHQgPT4gdC5zdGVwKS5maWx0ZXIoc3RlcCA9PiBzdGVwKVswXSxcbiAgICAgICAgdGFza3M6IGxnVGFza3MuZmlsdGVyKHQgPT4gdC5uYW1lKVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKHtcbiAgICAgIGNvdXJzZU5hbWUsXG4gICAgICBsZWFybmluZ0dvYWxzOiByZXN1bHRMZWFybmluZ0dvYWxzXG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFVzZXJUYXNrLCBUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgfSBmcm9tICcuLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5pbXBvcnQgeyBjb3Vyc2VOYW1lVG9Dc3NDbGFzcyB9IGZyb20gJy4uL2NhbGVuZGFyL2NvdXJzZS1uYW1lLXRvLWNzcy1jbGFzcyc7XG5pbXBvcnQgeyBnZXRUYXNrVHlwZSB9IGZyb20gJy4vZ2V0LXRhc2stdHlwZSc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBWaXJ0dWFsTGVhcm5pbmdHb2FsIH0gZnJvbSAnLi9yZWZpbmVyJztcbmltcG9ydCB7IEZlYXR1cmVzIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJUYXNrc0JveFByb3BzIHtcbiAgY291cnNlTmFtZTogc3RyaW5nO1xuICBsZWFybmluZ0dvYWxzOiBWaXJ0dWFsTGVhcm5pbmdHb2FsW10sXG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcbiAgb3BlbkNvdXJzZXM/OiB7IFtwYXRoOiBzdHJpbmddOiBib29sZWFuIH07XG4gIHNldElzT3Blbj86IChjb3Vyc2VOYW1lOiBzdHJpbmcsIGlzT3BlbjogYm9vbGVhbikgPT4gdm9pZDtcbiAgc2V0VGFza0RvbmU/OiAodGFzazogVXNlclRhc2ssIGRvbmU6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHNldFN1YlRhc2tEb25lOiAodGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xuICBhZGRPd25UYXNrPzogKGNvdXJzZU5hbWU6IHN0cmluZywgbGVhcm5pbmdHb2FsTmFtZTogc3RyaW5nKSA9PiB2b2lkO1xuICBlZGl0VGFzazogKHRhc2s6IFVzZXJUYXNrKSA9PiB2b2lkO1xuICBlZGl0U3ViVGFzazogKHRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaykgPT4gdm9pZDtcbiAgcmVtb3ZlTGVhcm5pbmdHb2FsOiAobGc6IFZpcnR1YWxMZWFybmluZ0dvYWwpPT52b2lkO1xufTtcblxuZXhwb3J0IGNsYXNzIFVzZXJUYXNrc0JveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxVc2VyVGFza3NCb3hQcm9wcz4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogVXNlclRhc2tzQm94UHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY291cnNlTmFtZSxcbiAgICAgIGxlYXJuaW5nR29hbHNcbiAgICB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBpc09wZW4gPSAhIXRoaXMucHJvcHMub3BlbkNvdXJzZXNbY291cnNlTmFtZV07XG4gICAgY29uc3QgZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcblxuICAgIHJldHVybiA8T3BlbkNsb3NlQm94XG4gICAgICB0aXRsZT17PGg1Pntjb3Vyc2VOYW1lIHx8IExgRWduYSBsw6RyYW5kZW3DpWxgfTwvaDU+fVxuICAgICAgaGVhZGVyT3Blbj17aXNPcGVufVxuICAgICAgY2xhc3NOYW1lPXtjb3Vyc2VOYW1lICYmIGNvdXJzZU5hbWVUb0Nzc0NsYXNzKCd3cC1jb3Vyc2UtJywgY291cnNlTmFtZSl9XG4gICAgICBvbk9wZW5DbG9zZT17YmVjYW1lT3BlbiA9PiB0aGlzLnByb3BzLnNldElzT3Blbihjb3Vyc2VOYW1lLCBiZWNhbWVPcGVuKX0+XG4gICAgICB7bGVhcm5pbmdHb2Fscy5tYXAobGcgPT5cbiAgICAgICAgPGRpdiBrZXk9e2xnLm5hbWV9IGNsYXNzTmFtZT1cImxlYXJuaW5nR29hbENvbnRhaW5lclwiPlxuICAgICAgICAgIHtsZy5zdGVwICYmIDxkaXYgY2xhc3NOYW1lPVwic3RlcEluZGljYXRvclwiPntsZy5zdGVwfTwvZGl2Pn1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsVGV4dCBob3Jpem9udGFsSXRlbSB0b3BcIj57bGcubmFtZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgICAgJm5ic3A7PGFcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0cmFzaFwiXG4gICAgICAgICAgICAgICAgaHJlZj1cIiNcIlxuICAgICAgICAgICAgICAgIHRpdGxlPVwiVGEgYm9ydCBsw6RyYW5kZW3DpWxldCBvY2ggZGVzcyB1cHBnaWZ0ZXJcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2PT57XG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5yZW1vdmVMZWFybmluZ0dvYWwobGcpO1xuICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS10cmFzaFwiIC8+XG4gICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIHtsZy50YXNrcy5tYXAodXNlclRhc2sgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ3VwZGF0aW5nJztcblxuICAgICAgICAgICAgICAgIGNvbnN0IHRhc2tUeXBlID0gZ2V0VGFza1R5cGUodXNlclRhc2spO1xuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZWQgPSBtb21lbnQodXNlclRhc2suZGVhZGxpbmUpLnN0YXJ0T2YoJ2RheScpIDwgbW9tZW50KCkuc3RhcnRPZignZGF5Jyk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gPGRpdiBrZXk9e3VzZXJUYXNrLmlkfSBzdHlsZT17aXNXb3JraW5nID8geyBvcGFjaXR5OiAwLjUgfSA6IHt9fT5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcImNoZWNrQm94XCIgKyAodXNlclRhc2suZG9uZSA/IFwiIGNoZWNrZWRcIiA6IFwiXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZXYgPT4gIWlzV29ya2luZyAmJiB0aGlzLnByb3BzLnNldFRhc2tEb25lKHVzZXJUYXNrLCAhdXNlclRhc2suZG9uZSl9PlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7dGFza1R5cGUgPT09ICdjb3Vyc2VCdWlsZGVyVGFzaycgP1xuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17Z2V0VGFza1VybCh1c2VyVGFzaywgdGhpcy5wcm9wcy52aWV3Q291cnNlVXJsKX0+e3VzZXJUYXNrLm5hbWV9PC9hPiA6XG4gICAgICAgICAgICAgICAgICAgICAgIHRhc2tUeXBlID09PSAnc3ViamVjdFBsYW5uZXJUYXNrJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtnZXRTdWJqZWN0UGxhbm5lclRhc2tVcmwodXNlclRhc2spfT57dXNlclRhc2submFtZX08L2E+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2tUeXBlID09PSAnc2l0ZVZpc2lvblRhc2snID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17dXNlclRhc2sudXJsfT57dXNlclRhc2submFtZX08L2E+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9eyF1c2VyVGFzay51cmwgPyBcImxpbmstbGVzc1wiOiBcIlwifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e3VzZXJUYXNrLnVybCB8fCB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PXsodXNlclRhc2sudXJsKycnKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobG9jYXRpb24uaG9zdC50b0xvd2VyQ2FzZSgpKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9zZWxmXCIgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPnt1c2VyVGFzay5uYW1lfTwvYT59XG4gICAgICAgICAgICAgICAgICAgICAge3VzZXJUYXNrLmRlYWRsaW5lICYmIDxkaXYgY2xhc3NOYW1lPXtcImRhdGVTZXRcIiArIChleHBpcmVkID8gJyBleHBpcmVkJyA6ICcnKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aSB0aXRsZT17bW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKS5mb3JtYXQoXCJZWVlZLU1NLUREXCIpfSBjbGFzc05hbWU9XCJmYSBmYS1jYWxlbmRhclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT57fX0+PC9pPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCB0YXNrRWRpdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmVkaXRUYXNrKHVzZXJUYXNrKX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4gXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAge3VzZXJUYXNrLnN1YlRhc2tzICYmIDxkaXYgY2xhc3NOYW1lPVwic3VidGFza3NcIj5cbiAgICAgICAgICAgICAgICAgICAge3VzZXJUYXNrLnN1YlRhc2tzLm1hcChzdWJUYXNrID0+XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e3N1YlRhc2suaWR9ID5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArIChzdWJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtldiA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWlzV29ya2luZyAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZXRTdWJUYXNrRG9uZSh1c2VyVGFzaywgc3ViVGFzaywgIXN1YlRhc2suZG9uZSl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmPXtzdWJUYXNrLnVybCB8fCB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PXsodXNlclRhc2sudXJsKycnKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobG9jYXRpb24uaG9zdC50b0xvd2VyQ2FzZSgpKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfc2VsZlwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9ibGFua1wifVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJUYXNrLnVybCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZCA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsaW5rLWxlc3MnXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0+e3N1YlRhc2submFtZX08L2E+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHRhc2tFZGl0XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImVkaXRJdGVtXCIgb25DbGljaz17KCkgPT4gdGhpcy5wcm9wcy5lZGl0U3ViVGFzayh1c2VyVGFzaywgc3ViVGFzayl9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICAgICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUb29sc1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYWRkT3duR29hbFwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMuYWRkT3duVGFzayh0aGlzLnByb3BzLmNvdXJzZU5hbWUsIGxnLm5hbWUpfT5cbiAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtcGx1c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4ge0xgRWdldCBhcmJldHNtw6VsYH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxiciAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9PcGVuQ2xvc2VCb3g+XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0VGFza1VybCh1c2VyVGFzazogVXNlclRhc2ssIHZpZXdDb3Vyc2VVcmw6IHN0cmluZykge1xuICBpZiAodXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLmNvdXJzZS5sZW5ndGggPiAwICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgY291cnNlVXJsID0gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkodmlld0NvdXJzZVVybCwgeyBjb3Vyc2VJZDogdXNlclRhc2suY291cnNlWzBdLmlkIH0pO1xuICAgIHJldHVybiBgJHtjb3Vyc2VVcmx9Iy90YXNrLyR7dXNlclRhc2sudGFza1swXS5pZH1gO1xuICB9XG4gIHJldHVybiB1c2VyVGFzay51cmw7XG59XG5cbmZ1bmN0aW9uIGdldFN1YmplY3RQbGFubmVyVGFza1VybCh1c2VyVGFzazogVXNlclRhc2spIHtcbiAgaWYgKHVzZXJUYXNrLmNvdXJzZUluZm8gJiYgdXNlclRhc2sudGFzayAmJiB1c2VyVGFzay50YXNrLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB7c2Nob29sLCBjb3Vyc2UsIHRhYiB9ID0gdXNlclRhc2suY291cnNlSW5mbztcbiAgICBjb25zdCBjb3Vyc2VVcmwgPSBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeShlbnYuY291cnNlVmlld2VyVXJsS1MsIHt9KTtcbiAgICByZXR1cm4gYCR7Y291cnNlVXJsfSMvJHtzY2hvb2x9L2NvdXJzZXMvJHtjb3Vyc2V9L3RhYnMvJHt0YWJ9L3Rhc2tzLyR7dXNlclRhc2sudGFza1swXS5pZH1gO1xuICB9XG4gIHJldHVybiB1c2VyVGFzay51cmw7XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBsb2NhbE1vbWVudCB9IGZyb20gJy4uLy4uL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZSc7XG5cbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcblxuZXhwb3J0IGNsYXNzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUge1xuICBzdGF0aWMgRVhQSVJBVElPTl9IT1VSUyA9IDEyO1xuICBzdGF0aWMgVkVSU0lPTiA9IDI7XG5cbiAgdXNlcjogc3RyaW5nO1xuICBsYXN0V3JpdGU6IG51bWJlcjtcbiAgd2Vla0RhdGU6IG51bWJlcjtcbiAgb3BlbkNvdXJzZXM6IHsgW3BhdGg6IHN0cmluZ106IGJvb2xlYW4gfVxuXG4gIGNvbnN0cnVjdG9yICh1c2VyT3JDb3B5OiBzdHJpbmcgfCBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKSB7XG4gICAgaWYgKHR5cGVvZiB1c2VyT3JDb3B5ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy51c2VyID0gdXNlck9yQ29weTtcbiAgICAgIHRoaXMubGFzdFdyaXRlID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMud2Vla0RhdGUgPSBsb2NhbE1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XG4gICAgICB0aGlzLm9wZW5Db3Vyc2VzID0ge307XG4gICAgfSBlbHNlIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgdXNlck9yQ29weSk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGxvYWQodXNlcjogc3RyaW5nKSB7XG4gICAgY29uc3QgY29va2llID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1dlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUyJyk7XG4gICAgY29uc3Qgc3RvcmVkRGF0YSA9IGNvb2tpZSAmJiAoSlNPTi5wYXJzZShjb29raWUpIGFzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUpO1xuICAgIGNvbnN0IHN0YXRlID0gbmV3IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUodXNlcik7XG4gICAgaWYgKHN0b3JlZERhdGEpIE9iamVjdC5hc3NpZ24oc3RhdGUsIHN0b3JlZERhdGEpO1xuXG4gICAgcmV0dXJuIHN0YXRlLnVzZXIgPT09IHVzZXIgJiYgIXN0YXRlLmlzRXhwaXJlZChtb21lbnQoKSkgP1xuICAgICAgc3RhdGUgOiBuZXcgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSh1c2VyKTtcbiAgfVxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgdGhpcy5sYXN0V3JpdGUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZTInLCBqc29uKTtcbiAgfVxuXG4gIGlzRXhwaXJlZCAoYXNPZjogTW9tZW50KSB7XG4gICAgICByZXR1cm4gbW9tZW50KHRoaXMubGFzdFdyaXRlKVxuICAgICAgICAuaXNCZWZvcmUoXG4gICAgICAgICAgICBhc09mLmFkZChcbiAgICAgICAgICAgICAgICAwLVdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUuRVhQSVJBVElPTl9IT1VSUywgJ2hvdXJzJylcbiAgICAgICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVXNlclRhc2tzQm94IH0gZnJvbSAnLi91c2VyLXRhc2tzLWJveCc7XG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBIdHRwRXJyb3IgfSBmcm9tIFwia2VkYmFja2VuZC9jbGllbnRcIjtcbmltcG9ydCB7IHJlZmluZSwgVmlydHVhbExlYXJuaW5nR29hbCB9IGZyb20gJy4vcmVmaW5lcic7XG5pbXBvcnQgeyBFbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgTCwgY29tcGFyZVByb3AgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG4vL2ltcG9ydCB7IEN1c3RvbUdvYWwgfSBmcm9tICcuLi8uLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQgeyBUU09OIH0gZnJvbSAnLi4vLi4vdXRpbHMvdHNvbic7XG5pbXBvcnQgeyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIH0gZnJvbSAnLi93ZWVrcGxhbm5lci1wZXJzaXN0ZWQtc3RhdGUnO1xuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcbmltcG9ydCB7IERpYWxvZ3MgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZGlhbG9ncyc7XG5pbXBvcnQgeyBBZGRDdXN0b21Hb2FsIH0gZnJvbSAnLi9hZGQtY3VzdG9tLWdvYWwnO1xuaW1wb3J0IHsgQWRkQ3VzdG9tVGFzayB9IGZyb20gJy4vYWRkLWN1c3RvbS10YXNrJztcbmltcG9ydCB7IEVkaXRVc2VyVGFzayB9IGZyb20gJy4vZWRpdC11c2VyLXRhc2snO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcbmltcG9ydCB7IFBlbmRpbmdKb2IgfSBmcm9tICcuLi8uLi91dGlscy9wZW5kaW5nLWpvYic7XG5pbXBvcnQgeyBBZGRPckVkaXRTdWJUYXNrIH0gZnJvbSAnLi9hZGQtb3ItZWRpdC1zdWItdGFzayc7XG5pbXBvcnQgeyBnZXRBZGp1c3RlZFdlZWssIEtFRFdlZWsgfSBmcm9tICcuLi8uLi91dGlscy93ZWVrdXRpbCc7XG5cbmNvbnN0IE1BWF9TVFJBVEVHWV9MRU5HVEggPSAxNjM4NDtcbmNvbnN0IE1BWF9BU1NFU1NNRU5UX0xFTkdUSCA9IDE2Mzg0O1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XG4gIGVudjogRW52O1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICB3ZWVrRGF0ZTogbnVtYmVyO1xuICBkaWFsb2dzOiBhbnlbXTtcbiAgdXNlclRhc2tzOiBVc2VyVGFza1tdO1xuICBvcGVuQ291cnNlczogeyBbcGF0aDogc3RyaW5nXTogYm9vbGVhbiB9XG4gIHN0cmF0ZWd5Pzogc3RyaW5nO1xuICBhc3Nlc3NtZW50Pzogc3RyaW5nO1xuICB3ZWVrVGV4dHNVVDogVXNlclRhc2sgfCBudWxsO1xuICBzYXZpbmc6IGJvb2xlYW47XG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbiAgaXNDb3B5aW5nVGFza3M6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBXZWVrUGxhbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICB3ZWVrVGV4dHNTYXZpbmdKb2I6IFBlbmRpbmdKb2I7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICB1c2VyVGFza3M6IFtdLFxuICAgICAgd2Vla0RhdGU6IERhdGUubm93KCksXG4gICAgICBvcGVuQ291cnNlczoge30sXG4gICAgICBkaWFsb2dzOiBbXSxcbiAgICAgIHNhdmluZzogZmFsc2UsXG4gICAgICB3ZWVrVGV4dHNVVDogbnVsbCxcbiAgICAgIGlzTG9hZGluZzogdHJ1ZSxcbiAgICAgIGlzQ29weWluZ1Rhc2tzOiBmYWxzZVxuICAgIH1cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iID0gbmV3IFBlbmRpbmdKb2IoKCk9PnRoaXMuc2F2ZVdlZWtUZXh0cygpKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby51bnN1YnNjcmliZSh0aGlzLm9uQ2hhbmdlKTtcbiAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi5zdG9wKCk7XG4gIH1cblxuICBvbkNoYW5nZSh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZDogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSwgd2Vla1RleHRzVVQ6IFVzZXJUYXNrKSB7XG4gICAgY29uc3QgbmV3U3RhdGUgOiBQYXJ0aWFsPFN0YXRlPiA9IHtcbiAgICAgIHVzZXJUYXNrcyxcbiAgICAgIHdlZWtEYXRlOiBwZXJzaXN0ZWQud2Vla0RhdGUsXG4gICAgICBvcGVuQ291cnNlczogcGVyc2lzdGVkLm9wZW5Db3Vyc2VzLFxuICAgICAgd2Vla1RleHRzVVQsXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlXG4gICAgfVxuICAgIGlmICghdGhpcy5zdGF0ZS53ZWVrVGV4dHNVVCB8fCAod2Vla1RleHRzVVQuZGF0ZVRpbWUgIT09IHRoaXMuc3RhdGUud2Vla1RleHRzVVQuZGF0ZVRpbWUpKSB7XG4gICAgICAvLyBDaGFuZ2luZyB3ZWVrLiBSZXNldCB0byBuZXcgd2VlaydzIHZhbHVlc1xuICAgICAgbmV3U3RhdGUuc3RyYXRlZ3kgPSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuc3RyYXRlZ3k7XG4gICAgICBuZXdTdGF0ZS5hc3Nlc3NtZW50ID0gd2Vla1RleHRzVVQud2Vla1RleHRzLmFzc2Vzc21lbnQ7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUgYXMgYW55KTsgLy8gUmVhY3QncyB1c2Ugb2YgUGljayBpbnN0ZWFkIG9mIFBhcnRpYWwgbWFrZXMgdGhpbmdzIGNvbXBsZXggaGVyZS5cbiAgfVxuXG4gIGlzV2Vla1RleHRzRWRpdGVkKCkge1xuICAgIGNvbnN0IHsgc3RyYXRlZ3ksIGFzc2Vzc21lbnQsIHdlZWtUZXh0c1VUIH0gPSB0aGlzLnN0YXRlO1xuICAgIHJldHVybiAhIXdlZWtUZXh0c1VUICYmIChzdHJhdGVneSAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLnN0cmF0ZWd5IHx8IGFzc2Vzc21lbnQgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5hc3Nlc3NtZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVdlZWtUZXh0cygpIHtcbiAgICBjb25zb2xlLmxvZyhcIlNhdmluZyB0ZXh0cy4uLlwiKTtcbiAgICBjb25zdCB7IHN0cmF0ZWd5LCBhc3Nlc3NtZW50LCB3ZWVrVGV4dHNVVCB9ID0gdGhpcy5zdGF0ZTtcbiAgICBpZiAodGhpcy5pc1dlZWtUZXh0c0VkaXRlZCgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnVwc2VydCh3ZWVrVGV4dHNVVCwgdXQgPT4ge1xuICAgICAgICB1dC53ZWVrVGV4dHMgPSB7IHN0cmF0ZWd5LCBhc3Nlc3NtZW50IH07XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcmV2V2VlaygpIHtcbiAgICAvL3RoaXMuc2F2ZVdlZWtUZXh0cygpO1xuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uY2hhbmdlV2Vlayhtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkuYWRkKC0xLCAnd2VlaycpLnRvRGF0ZSgpKTtcbiAgfVxuXG4gIG5leHRXZWVrKCkge1xuICAgIC8vdGhpcy5zYXZlV2Vla1RleHRzKCk7XG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5jaGFuZ2VXZWVrKG1vbWVudCh0aGlzLnN0YXRlLndlZWtEYXRlKS5hZGQoMSwgJ3dlZWsnKS50b0RhdGUoKSk7XG4gIH1cblxuICBvcGVuRGlhbG9nKGRpYWxvZykge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsb2dzOiBbLi4udGhpcy5zdGF0ZS5kaWFsb2dzLCBkaWFsb2ddIH0pO1xuICB9XG5cbiAgb3BlbkFkZEdvYWxEaWFsb2coKSB7XG4gICAgdGhpcy5vcGVuRGlhbG9nKDxBZGRDdXN0b21Hb2FsXG4gICAgICBvblNhdmU9e2FzeW5jIChsZWFybmluZ0dvYWw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAoIWxlYXJuaW5nR29hbCkgdGhyb3cgbmV3IEVycm9yIChMYEzDpHJhbmRlbcOlbGV0IGthbiBpbnRlIHZhcmEgdG9tdGApO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuc2F2aW5nKSB7XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNhdmluZzogdHJ1ZSB9KTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRDdXN0b21Hb2FsKGxlYXJuaW5nR29hbCk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IGZhbHNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH1cbiAgICAgIH19IC8+KTtcbiAgfVxuXG4gIG9wZW5BZGRPd25UYXNrRGlhbG9nKGNvdXJzZU5hbWU6IHN0cmluZywgbGVhcm5pbmdHb2FsTmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5vcGVuRGlhbG9nKDxBZGRDdXN0b21UYXNrXG4gICAgICBpc1Rhc2s9eyFjb3Vyc2VOYW1lfVxuICAgICAgb25TYXZlPXthc3luYyAobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICBpZiAoIW5hbWUpIHRocm93IG5ldyBFcnJvciAoTGBOYW1uZXQga2FuIGludGUgdmFyYSB0b210YCk7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5zYXZpbmcpIHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiB0cnVlIH0pO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFkZEN1c3RvbVRhc2soY291cnNlTmFtZSwgbGVhcm5pbmdHb2FsTmFtZSwgbmFtZSwgZGVzY3JpcHRpb24sIHVybCk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IGZhbHNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH1cbiAgICAgIH19IC8+KTtcbiAgfVxuXG4gIGVkaXRUYXNrKHVzZXJUYXNrOiBVc2VyVGFzaykge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8RWRpdFVzZXJUYXNrXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvfVxuICAgICAgdXNlclRhc2s9e3VzZXJUYXNrfVxuICAgICAgb25VcGRhdGU9e2FzeW5jICh1cGRhdGVyOiAodXQ6IFVzZXJUYXNrKSA9PiB2b2lkKSA9PiB7XG4gICAgICAgIGNvbnN0IHRlc3QgPSB7Li4udXNlclRhc2t9O1xuICAgICAgICB1cGRhdGVyKHRlc3QpO1xuICAgICAgICBpZiAoIXRlc3QubmFtZSkgdGhyb3cgbmV3IEVycm9yIChMYE5hbW5ldCBmw6VyIGludGUgdmFyYSB0b210YCk7XG4gICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXBkYXRlcik7XG4gICAgICB9fVxuICAgICAgb25EZWxldGU9e2FzeW5jIGlkID0+IHtcbiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmRlbGV0ZShbaWRdKTtcbiAgICAgIH19XG4gICAgICBvcGVuRGlhbG9nPXtkaWFsb2c9PnRoaXMub3BlbkRpYWxvZyhkaWFsb2cpfVxuICAgICAgY2xvc2VEaWFsb2c9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9XG4gICAgLz4pO1xuICB9XG5cbiAgZWRpdFN1YlRhc2sodXNlclRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xuICAgICAgdXNlclRhc2tzUmVwbz17dGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwb31cbiAgICAgIG1vZGU9XCJlZGl0XCJcbiAgICAgIHVzZXJUYXNrPXt1c2VyVGFza31cbiAgICAgIHN1YlRhc2s9e3N1YlRhc2t9XG4gICAgICBjbG9zZURpYWxvZz17KCk9PnRoaXMuY2xvc2VEaWFsb2coKX1cbiAgICAvPik7XG4gIH1cblxuICBjbG9zZURpYWxvZygpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGlhbG9nczogdGhpcy5zdGF0ZS5kaWFsb2dzLnNsaWNlKDAsIHRoaXMuc3RhdGUuZGlhbG9ncy5sZW5ndGggLSAxKSB9KTtcbiAgfVxuXG5cblxuICBhc3luYyBhZGRDdXN0b21Hb2FsKGxlYXJuaW5nR29hbDogc3RyaW5nKSB7XG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxuICAgICAgTWF0aC5tYXgsXG4gICAgICBbdGhpcy5zdGF0ZS53ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmluc2VydChbe1xuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgIGxlYXJuaW5nR29hbCxcbiAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwXG4gICAgfV0pO1xuXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4oXCJcIiwgdHJ1ZSk7XG4gIH1cblxuICBhc3luYyByZW1vdmVMZWFybmluZ0dvYWwobGVhcm5pbmdHb2FsOiBWaXJ0dWFsTGVhcm5pbmdHb2FsKSB7XG4gICAgaWYgKGxlYXJuaW5nR29hbC50YXNrcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoIWNvbmZpcm0oYFRhIGJvcnQgbMOkcmFuZGVtw6VsIHNhbXQgJHtsZWFybmluZ0dvYWwudGFza3MubGVuZ3RofSB1cHBnaWZ0ZXI/YCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmRlbGV0ZShsZWFybmluZ0dvYWwuYWxsVGFza3MubWFwKHQgPT4gdC5pZCkpO1xuICB9XG5cbiAgYXN5bmMgYWRkQ3VzdG9tVGFzayhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHVybDogc3RyaW5nKSB7XG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxuICAgICAgTWF0aC5tYXgsXG4gICAgICBbdGhpcy5zdGF0ZS53ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICAvKmNvbnN0IGVtcHR5TGVhcm5pbmdHb2FsUGxhY2Vob2xkZXIgPSB0aGlzLnN0YXRlLnVzZXJUYXNrcy5maW5kKHV0ID0+XG4gICAgICB1dC5uYW1lID09IG51bGwgJiZcbiAgICAgICF1dC5jb3Vyc2VOYW1lICYmXG4gICAgICB1dC5sZWFybmluZ0dvYWwgPT09IGxlYXJuaW5nR29hbCk7XG5cbiAgICBpZiAoZW1wdHlMZWFybmluZ0dvYWxQbGFjZWhvbGRlcikge1xuICAgICAgLy8gSGlqYWNrIGxlYXJuaW5nLWdvYWwgcGxhY2Vob2xkZXIgYW5kIG1ha2UgaXQgdGhlIHJlYWwgdGFzay5cbiAgICAgIC8vIFRoaXMgd2lsbCBtYWtlIHRoZSBsZWFybmluZyBnb2FsIGRpc2FwcGVhciBvbmNlIHRoaXMgdGFza1xuICAgICAgLy8gaXMgZGVsZXRlZC5cbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8udXBkYXRlKFtlbXB0eUxlYXJuaW5nR29hbFBsYWNlaG9sZGVyXSwgdXQgPT4ge1xuICAgICAgICBPYmplY3QuYXNzaWduKHV0LCB7IG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgeyovXG4gICAgICAvLyBBZGQgYW5vdGhlciB0YXNrIHRvIHNhbWUgbGVhcm5pbmctZ29hbFxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5pbnNlcnQoW3tcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgZGF0ZVRpbWU6IGxhdGVzdFRpbWVTdGFtcCArIDIwMDAsXG4gICAgICAgIGNvdXJzZU5hbWUsXG4gICAgICAgIGxlYXJuaW5nR29hbCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHVybFxuICAgICAgfV0pO1xuICAgIC8vfVxuICB9XG5cbiAgc2V0SXNPcGVuKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSB7XG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZSwgaXNPcGVuKTtcbiAgfVxuXG4gIGFzeW5jIHNldFRhc2tEb25lKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSB7XG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRUYXNrRG9uZVN0YXRlKHRhc2ssIGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgc2V0U3ViVGFza0RvbmUodGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrLCBkb25lOiBib29sZWFuKSB7XG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRTdWJUYXNrRG9uZVN0YXRlKHRhc2ssIHN1YlRhc2suaWQsIGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgY29weUZyb21QcmV2aW91c1dlZWsoKSB7XG4gICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSh7aXNDb3B5aW5nVGFza3M6IHRydWV9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB1c2VyVGFza3MsIG9wZW5Db3Vyc2VzLCB3ZWVrRGF0ZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgIGNvbnN0IHByZXZXZWVrTm8gPSBnZXRBZGp1c3RlZFdlZWsgKG1vbWVudCh3ZWVrRGF0ZSkuYWRkKC0xLCAnd2VlaycpKTtcbiAgICAgIGNvbnN0IHByZXZLRURXZWVrID0gS0VEV2Vlayhtb21lbnQod2Vla0RhdGUpLnllYXIoKSwgcHJldldlZWtObyk7XG4gICAgICAvLyBSZWFkIGxhc3Qgd2VlaydzIGdvYWxzIGFuZCB0YXNrc1xuICAgICAgbGV0IHByZXZUYXNrcyA9IGF3YWl0IHRoaXMucHJvcHMuZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxVc2VyVGFzaz4oXCJ1c2VydGFza3NcIiwge1xuICAgICAgICBmcm9tOiBwcmV2S0VEV2Vlay5ub3RCZWZvcmUsXG4gICAgICAgIHRvOiBwcmV2S0VEV2Vlay5ub3RBZnRlcixcbiAgICAgICAgcm9sZTogXCJVU0VSXCIsXG4gICAgICAgIGluY2x1ZGU6IFtcInRhc2tcIiwgXCJjb3Vyc2VcIiwgXCJhY2xcIl0sXG4gICAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXVxuICAgICAgfSk7XG4gICAgICBwcmV2VGFza3MgPSBwcmV2VGFza3NcbiAgICAgICAgLmZpbHRlcihwcmV2VGFzayA9PiAhcHJldlRhc2suZG9uZSkgIC8vIERvbid0IGNvcHkgZG9uZSB0YXNrc1xuICAgICAgICAuZmlsdGVyKHByZXZUYXNrID0+ICEhcHJldlRhc2submFtZSkgLy8gRG9uJ3QgY29weSBlbXB0eSBsZWFybmluZyBnb2Fsc1xuICAgICAgICAuZmlsdGVyKHByZXZUYXNrID0+ICF1c2VyVGFza3Muc29tZSh0YXNrT2ZDdXJyZW50V2VlayA9PlxuICAgICAgICAgIHRhc2tPZkN1cnJlbnRXZWVrLm5hbWUgPT09IHByZXZUYXNrLm5hbWUgJiZcbiAgICAgICAgICB0YXNrT2ZDdXJyZW50V2Vlay5sZWFybmluZ0dvYWwgPT09IHByZXZUYXNrLmxlYXJuaW5nR29hbCAmJlxuICAgICAgICAgIHRhc2tPZkN1cnJlbnRXZWVrLmNvdXJzZU5hbWUgPT09IHByZXZUYXNrLmNvdXJzZU5hbWUpKTsgLy8gSWdub3JlIGlkZW50aWNhbCB0YXNrcyAoYWxyZWFkeSBjb3BpZWQpXG5cbiAgICAgIC8vIE5vdyBjcmVhdGUgY29waWVzIGJ1dCBwbGFjZSB0aGVtIGluIHRoZSBjdXJyZW50IHdlZWsuXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoTWF0aC5tYXgsIFt3ZWVrRGF0ZV0uY29uY2F0KHVzZXJUYXNrcy5tYXAodCA9PiB0LmRhdGVUaW1lKSkpO1xuXG4gICAgICBjb25zdCBjb3BpZXMgPSBwcmV2VGFza3Muc29ydChjb21wYXJlUHJvcChcImRhdGVUaW1lXCIpKS5tYXAodGFzayA9PiB7XG4gICAgICAgIGNvbnN0IGNvcHk6IFVzZXJUYXNrID0geyAuLi50YXNrLCBkYXRlVGltZTogbGF0ZXN0VGltZVN0YW1wICs9IDEwMDAgfTtcbiAgICAgICAgY29weS5pZCA9IGNyZWF0ZVVVSUQoKTtcbiAgICAgICAgaWYgKGNvcHkuc3ViVGFza3MpIHtcbiAgICAgICAgICBjb3B5LnN1YlRhc2tzID0gY29weS5zdWJUYXNrcy5maWx0ZXIoc3QgPT4gIXN0LmRvbmUpO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBjb3B5LiRldGFnO1xuICAgICAgICByZXR1cm4gY29weTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBTdG9yZSBpdFxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5pbnNlcnQoY29waWVzKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNDb3B5aW5nVGFza3M6IGZhbHNlfSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHdlZWtOdW1iZXIgPSBtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkud2VlaygpO1xuICAgIC8vY29uc29sZS5sb2coXCJXZWVreWRhdGU6IFwiICArIG5ldyBEYXRlKHRoaXMuc3RhdGUud2Vla0RhdGUpICsgXCIgd2hpY2ggaXMgd2VlayBubyBcIiArIHdlZWtOdW1iZXIpO1xuICAgIGNvbnN0IGN1cnJlbnRXZWVrID0gbW9tZW50KCkud2VlaygpO1xuICAgIGNvbnN0IHRhc2tTZXRzID0gcmVmaW5lKHRoaXMuc3RhdGUudXNlclRhc2tzKTtcbiAgICBjb25zdCB7IGRpYWxvZ3MsIHdlZWtUZXh0c1VULCBzdHJhdGVneSwgYXNzZXNzbWVudCwgaXNMb2FkaW5nLCBpc0NvcHlpbmdUYXNrcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBpc1NhdmluZyA9IHdlZWtUZXh0c1VUICYmICh3ZWVrVGV4dHNVVC4kbWV0YSA9PT0gJ2FkZGluZycgfHwgd2Vla1RleHRzVVQuJG1ldGEgPT09ICd1cGRhdGluZycpO1xuICAgIGNvbnN0IGlzU3RyYXRlZ3lFZGl0ZWQgPSAhIXdlZWtUZXh0c1VUICYmIChzdHJhdGVneSAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLnN0cmF0ZWd5KTtcbiAgICBjb25zdCBpc0Fzc2Vzc21lbnRFZGl0ZWQgPSAhIXdlZWtUZXh0c1VUICYmIChhc3Nlc3NtZW50ICE9PSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuYXNzZXNzbWVudCk7XG4gICAgY29uc3QgZW5hYmxlU2F2ZUJ1dHRvbiA9ICFpc1NhdmluZyAmJiAoaXNTdHJhdGVneUVkaXRlZCB8fCBpc0Fzc2Vzc21lbnRFZGl0ZWQpO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e2BrZWRfYm94ZWQgd2Vla1BsYW5uZXIke3dlZWtOdW1iZXIgPT09IGN1cnJlbnRXZWVrID8gXCIgY3VycmVudFdlZWtcIiA6IFwiXCJ9YH1cbiAgICAgICAgb25LZXlEb3duPXtldiA9PiB7XG4gICAgICAgICAgaWYgKGV2LndoaWNoID09PSA4MyAmJiBldi5jdHJsS2V5KSB7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaWYgKCFpc1NhdmluZyAmJiB0aGlzLmlzV2Vla1RleHRzRWRpdGVkKCkpIHtcbiAgICAgICAgICAgICAgdGhpcy53ZWVrVGV4dHNTYXZpbmdKb2IudHJpZ2dlckNoYW5nZSgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH19PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHdlZWtTZWxlY3RgfT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XG4gICAgICAgICAgICA8cD57TGBWZWNrYSAke3dlZWtOdW1iZXJ9YH08L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByZXZXZWVrKCl9PlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWFuZ2xlLWxlZnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpID0+IHRoaXMubmV4dFdlZWsoKX0+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYW5nbGUtcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxoND57TGBMb2dnYm9rYH08L2g0PlxuICAgICAgICB7dGFza1NldHMubGVuZ3RoID4gMCAmJiA8aHIgLz59XG5cbiAgICAgICAge3Rhc2tTZXRzLm1hcChwcm9wcyA9PlxuICAgICAgICAgIDxVc2VyVGFza3NCb3hcbiAgICAgICAgICAgIGtleT17cHJvcHMuY291cnNlTmFtZX1cbiAgICAgICAgICAgIHsuLi5wcm9wc31cbiAgICAgICAgICAgIGNvdXJzZU5hbWU9e3Byb3BzLmNvdXJzZU5hbWV9XG4gICAgICAgICAgICBsZWFybmluZ0dvYWxzPXtwcm9wcy5sZWFybmluZ0dvYWxzfVxuICAgICAgICAgICAgdmlld0NvdXJzZVVybD17dGhpcy5wcm9wcy52aWV3Q291cnNlVXJsfVxuICAgICAgICAgICAgb3BlbkNvdXJzZXM9e3RoaXMuc3RhdGUub3BlbkNvdXJzZXN9XG4gICAgICAgICAgICBhZGRPd25UYXNrPXsoY291cnNlTmFtZTogc3RyaW5nLCBsZWFybmluZ0dvYWxOYW1lOiBzdHJpbmcpID0+IHRoaXMub3BlbkFkZE93blRhc2tEaWFsb2coY291cnNlTmFtZSwgbGVhcm5pbmdHb2FsTmFtZSl9XG4gICAgICAgICAgICBzZXRJc09wZW49e3RoaXMuc2V0SXNPcGVuLmJpbmQodGhpcyl9XG4gICAgICAgICAgICBzZXRUYXNrRG9uZT17dGhpcy5zZXRUYXNrRG9uZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgc2V0U3ViVGFza0RvbmU9e3RoaXMuc2V0U3ViVGFza0RvbmUuYmluZCh0aGlzKX1cbiAgICAgICAgICAgIGVkaXRUYXNrPXt0YXNrID0+IHRoaXMuZWRpdFRhc2sodGFzayl9XG4gICAgICAgICAgICBlZGl0U3ViVGFzaz17KHRhc2ssIHN1YlRhc2spID0+IHRoaXMuZWRpdFN1YlRhc2sodGFzaywgc3ViVGFzayl9XG4gICAgICAgICAgICByZW1vdmVMZWFybmluZ0dvYWw9e2xnID0+IHRoaXMucmVtb3ZlTGVhcm5pbmdHb2FsKGxnKX0gLz4pfVxuXG4gICAgICAgIDxociAvPlxuXG4gICAgICAgIHtpc0xvYWRpbmcgPyA8U3Bpbm5lciAvPiA6IDxkaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXtldiA9PiB0aGlzLm9wZW5BZGRHb2FsRGlhbG9nKCl9PlxuICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtbGlzdC1hbHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IHtMYEVnZXQgbMOkcmFuZGVtw6VsYH1cblxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuXCIgc3R5bGU9e2lzQ29weWluZ1Rhc2tzID8ge29wYWNpdHk6IDAuNX0gOiB1bmRlZmluZWR9IG9uQ2xpY2s9e2V2ID0+ICghaXNDb3B5aW5nVGFza3MpICYmIHRoaXMuY29weUZyb21QcmV2aW91c1dlZWsoKX0+XG4gICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1jbG9uZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4ge0xgS29waWVyYSBlaiBrbGFyYSBmcsOlbiBmw7ZyZWfDpWVuZGUgdmVja2FgfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxPcGVuQ2xvc2VCb3hcbiAgICAgICAgICAgIHRpdGxlPXs8aDU+e0xgU3RyYXRlZ2kgJiBVdHbDpHJkZXJpbmdgfTwvaDU+fVxuICAgICAgICAgICAgaGVhZGVyT3Blbj17dGhpcy5zdGF0ZS5vcGVuQ291cnNlc1tcIlN0cmF0VXR2XCJdfVxuICAgICAgICAgICAgb25PcGVuQ2xvc2U9e2JlY2FtZU9wZW4gPT4gdGhpcy5zZXRJc09wZW4oXCJTdHJhdFV0dlwiLCBiZWNhbWVPcGVuKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8aDM+U3RyYXRlZ2k8L2gzPlxuICAgICAgICAgICAgPHA+SHVyIGphZyBza2EgZ8O2cmEgZsO2ciBhdHQgbMOkcmEgbWlnLjwvcD5cbiAgICAgICAgICAgIDxoci8+XG4gICAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2Vla3BsYW5uZXItdGV4dGFyZWFcIlxuICAgICAgICAgICAgICBkaXNhYmxlZD17dGhpcy5wcm9wcy5lbnYudHV0b3JlZH1cbiAgICAgICAgICAgICAgdmFsdWU9e3N0cmF0ZWd5ICYmIHN0cmF0ZWd5LnN1YnN0cigwLCBNQVhfU1RSQVRFR1lfTEVOR1RIKX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtzdHJhdGVneTogKGV2LnRhcmdldC52YWx1ZSB8fCAnJykuc3Vic3RyKDAsIE1BWF9TVFJBVEVHWV9MRU5HVEgpfSk7XG4gICAgICAgICAgICAgICAgdGhpcy53ZWVrVGV4dHNTYXZpbmdKb2IudHJpZ2dlckNoYW5nZSg1MDApO1xuICAgICAgICAgICAgICB9fSAvPlxuXG4gICAgICAgICAgICA8aDM+VXR2w6RyZGVyaW5nPC9oMz5cbiAgICAgICAgICAgIDxwPlJlZmxla3Rpb24ga3JpbmcgZGluIGFyYmV0c2luc2F0cyBvY2ggZGluYSB2YWxkYSBzdHJhdGVnaWVyIHVuZGVyIHZlY2thbi5cbiAgICAgICAgICAgICAgVXR2w6RyZGVyYSBpIGbDtnJow6VsbGFuZGUgdGlsbCBkaW5hIG3DpWwuPC9wPlxuICAgICAgICAgICAgPGhyLz5cbiAgICAgICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3ZWVrcGxhbm5lci10ZXh0YXJlYVwiXG4gICAgICAgICAgICAgIHZhbHVlPXthc3Nlc3NtZW50ICYmIGFzc2Vzc21lbnQuc3Vic3RyKDAsIE1BWF9BU1NFU1NNRU5UX0xFTkdUSCl9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnByb3BzLmVudi50dXRvcmVkfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Fzc2Vzc21lbnQ6IChldi50YXJnZXQudmFsdWUgfHwgJycpLnN1YnN0cigwLCBNQVhfQVNTRVNTTUVOVF9MRU5HVEgpfSlcbiAgICAgICAgICAgICAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDUwMCk7XG4gICAgICAgICAgICAgIH0gfS8+XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0blwiXG4gICAgICAgICAgICAgIHRhYkluZGV4PXswfVxuICAgICAgICAgICAgICBzdHlsZT17ZW5hYmxlU2F2ZUJ1dHRvbiA/IHt9IDoge29wYWNpdHk6IDAuNX19XG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT4haXNTYXZpbmcgJiYgdGhpcy53ZWVrVGV4dHNTYXZpbmdKb2IudHJpZ2dlckNoYW5nZSgwKX0+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtZmxvcHB5LW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIiAvPlxuICAgICAgICAgICAgICAgICAge2VuYWJsZVNhdmVCdXR0b24gPyBcIiBTcGFyYVwiIDogXCIgU3BhcmFkXCJ9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9PcGVuQ2xvc2VCb3g+XG5cbiAgICAgICAgPC9kaXY+fVxuICAgICAgPC9kaXY+XG4gICAgICA8RGlhbG9nc1xuICAgICAgICBkaWFsb2dzPXtkaWFsb2dzfVxuICAgICAgICBwb3BEaWFsb2c9eygpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICAgICAgICAgICh7ZGlhbG9nc30pID0+ICh7IGRpYWxvZ3M6IGRpYWxvZ3Muc2xpY2UoMCwgZGlhbG9ncy5sZW5ndGggLSAxKSB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nIH0gZnJvbSAnLi4vdXRpbHMvcXVlcnktc3RyaW5nJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcblxuZXhwb3J0IGNsYXNzIEZlYXR1cmVzIHtcbiAgLy9FZGl0VXNlclRhc2tzVmlhUGVuT25seT86IGJvb2xlYW47XG4gIC8vU3ViVGFza3M/OiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yICgpIHtcbiAgICBjb25zdCB1c2VyID0gZW52LmN1cnJlbnRVc2VyITtcbiAgICBjb25zdCBxdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoLCB7dG9Mb3dlcjogdHJ1ZX0pO1xuICAgIGNvbnN0IGZlYXR1cmVzID0gKChxdWVyeS5mZWF0dXJlc3x8JycpLnNwbGl0KCcsJykgYXMgc3RyaW5nW10pXG4gICAgICAubWFwKGZlYXR1cmUgPT4gZmVhdHVyZS50b0xvd2VyQ2FzZSgpKTsgLy8gQ2FuIGJlIHVzZWQgb24gZm9yd2FyZHMuLi5cblxuICAgIC8qdGhpcy5FZGl0VXNlclRhc2tzVmlhUGVuT25seSA9XG4gICAgICB1c2VyLnNjaG9vbFR5cGUgIT09ICdHcnVuZHNrb2xvcicgJiYgcXVlcnkuc2Nob29sdHlwZSAhPT0gXCJHcnVuZHNrb2xvclwiOyovXG4gICAgLyp0aGlzLlN1YlRhc2tzID1cbiAgICAgIHVzZXIuc2Nob29sVHlwZSAhPT0gJ0dydW5kc2tvbG9yJyAmJiBxdWVyeS5zY2hvb2x0eXBlICE9PSBcIkdydW5kc2tvbG9yXCI7Ki9cbiAgICAvL3RoaXMuQXNzaWdubWVudFRhc2tzID0gISFxdWVyeS50ZXN0dmVyc2lvbjtcbiAgfVxufVxuIiwiZXhwb3J0ICogZnJvbSAnLi9mZWF0dXJlcyc7XG4iLCJpbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5cbmRlY2xhcmUgdmFyIHByb2Nlc3M6IGFueTtcblxuY2ZnLkVOVklST05NRU5UID0gcHJvY2Vzcy5lbnYuRU5WSVJPTk1FTlQgYXMgXCJwcm9kdWN0aW9uXCIgfCBcImRldmVsb3BtZW50XCIgfCBcInRlc3RcIjtcbmNmZy5LRURfQVBJX1VSTCA9IHByb2Nlc3MuZW52LktFRF9BUElfVVJMOyAvLyBcImh0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXG5jZmcuRURTX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5FRFNfQVBJX1VSTDsgLy8gXCJodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXG5jZmcuS0VEX1RPS0VOX1VSTCA9IHByb2Nlc3MuZW52LktFRF9UT0tFTl9VUkw7IC8vIFwiaHR0cHM6Ly9rZWRhdXRodGVzdC5henVyZXdlYnNpdGVzLm5ldC90b2tlblwiXG5jZmcuS0VEX0NMSUVOVF9JRCA9IHByb2Nlc3MuZW52LktFRF9DTElFTlRfSUQ7IC8vIFwiZGV2Y2xpZW50XCIsIFwidGVzdGNsaWVudFwiLCBcIi4uLlwiXG5jZmcuS0VEX0NMSUVOVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX1NFQ1JFVDtcbmNmZy5LRURfUkVBTE0gPSBwcm9jZXNzLmVudi5LRURfUkVBTE07IC8vIFwiU0UxXCJcbiIsIi8qIFRoZXNlIHNjcmlwdHMgYXNzdW1lIHNvbWUgb2YgdGhlIGdsb2JhbCB2YXJzIGhhdmUgYWxyZWFkeSBiZWVuIHNldDpcbiAgKiBLRUQuY2ZnXG4gICogS0VELmVudi5jdXJyZW50VXNlclxuXG4gIFRoZSByZXN0IHdpbGwgYmUgc2V0IGhlcmUgKGNsaWVudCBzaWRlKVxuKi9cbmltcG9ydCAnLi9jb25maWd1cmUnO1xuaW1wb3J0ICcuL3NldC1iZWFyZXItcHJvdmlkZXJzJztcbmltcG9ydCAnLi9zZXQta2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCAnLi9zZXQtZWRzLWNsaWVudCc7XG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nLCBzcGxpdFVybEFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudFdlYiwgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIsIGlzb21vcnBoaWMsIHN0b3JhZ2UgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XG5pbXBvcnQgeyBCZWFyZXJQcm92aWRlciwgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5pbXBvcnQgeyBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyB9IGZyb20gXCIuLi9hY2Nlc3MtY29udHJvbC9pbmRleFwiO1xuaW1wb3J0IHsgY2hlcnJ5UGlja1Byb3BzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5cbmZ1bmN0aW9uIGdldE1lcmdlZFRva2VuUGF0aCh0b2tlblBhdGg6IHN0cmluZywgbG9jYXRpb25TZWFyY2g6IHN0cmluZywgc2NvcGVzOiBzdHJpbmdbXSkge1xuICAvLyBNZXJnZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtcyBvZiB0b2tlbiBwYXRoIHdpdGggcGFyYW1zIGdpdmVuIHRvIGN1cnJlbnQgcGFnZVxuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uU2VhcmNoKTtcbiAgY29uc3QgaW1wZXJzb25hdGlvblByb3BzID0gY2hlcnJ5UGlja1Byb3BzKGN1cnJlbnRRdWVyeSwgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpO1xuICBjb25zdCBbdG9rZW5QYXRoV2l0aG91dFF1ZXJ5LCB0b2tlblF1ZXJ5U3RyaW5nXSA9IHNwbGl0VXJsQW5kUXVlcnkodG9rZW5QYXRoKTtcbiAgY29uc3QgdG9rZW5QYXRoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKHRva2VuUXVlcnlTdHJpbmcpO1xuICByZXR1cm4gdG9rZW5QYXRoV2l0aG91dFF1ZXJ5ICsgZ2VuZXJhdGVRdWVyeVN0cmluZyh7XG4gICAgLi4udG9rZW5QYXRoUXVlcnksXG4gICAgLi4uaW1wZXJzb25hdGlvblByb3BzLFxuICAgIHNjb3Blczogc2NvcGVzLmpvaW4oJywnKVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcbiAgcmV0dXJuIG1lcmdlZFRva2VuUGF0aCArIFwiL1wiICsgdXNlckVtYWlsO1xufVxuXG5mdW5jdGlvbiBzYXZlVXNlckluZm8odXNlcjogVXNlciwgdG9rZW5JZDogc3RyaW5nKSB7XG4gIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XG4gIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCwgSlNPTi5zdHJpbmdpZnkodXNlcikpO1xufVxuXG5mdW5jdGlvbiBsb2FkVXNlckluZm8odG9rZW5JZDogc3RyaW5nKSB7XG4gIGNvbnN0IHN0b3JlZFNlc3Npb25Vc2VyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInVzZXJJbmZvXCIgKyB0b2tlbklkKTtcbiAgaWYgKHN0b3JlZFNlc3Npb25Vc2VyKSB7XG4gICAgZW52LmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRTZXNzaW9uVXNlcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgaWYgKHJlcy51c2VyKSB7XG4gICAgICBzYXZlVXNlckluZm8ocmVzLnVzZXIsIHRva2VuSWQpO1xuICAgIH1cbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcbiAgfSwgdG9rZW5JZCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUdvb2dsZVRva2VuUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgcmV0dXJuIHsgdG9rZW46IHJlcy50b2tlbiwgZXhwaXJlczogRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwIH07XG4gIH0sIHRva2VuSWQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcih0b2tlblVybDogc3RyaW5nLCB1c2VyOiBVc2VyLCBzY29wZXM6IHN0cmluZ1tdKSB7XG4gIHJldHVybiBuZXcgS2VkQmVhcmVyUHJvdmlkZXIoXG4gICAgaXNvbW9ycGhpYyxcbiAgICBzdG9yYWdlLFxuICAgIHRva2VuVXJsICsgdXNlci5tYWlsICsgbG9jYXRpb24uc2VhcmNoLFxuICAgIGNmZy5LRURfQ0xJRU5UX0lELFxuICAgIGNmZy5LRURfQ0xJRU5UX1NFQ1JFVCxcbiAgICB0b2tlblVybCwge1xuICAgICAgZW1haWw6IHVzZXIubWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgcm9sZXM6IHVzZXIucm9sZXMsXG4gICAgICBzY2hvb2w6IHVzZXIuc2Nob29sLFxuICAgICAgc2Nob29sVHlwZTogdXNlci5zY2hvb2xUeXBlLFxuICAgICAgc2NvcGVzXG4gICAgfSk7XG59XG5cbi8vIGVudi5jdXJyZW50VXNlci5tYWlsIGlzIHNldCBieSBTaXRlVmlzaW9uIHNlcnZlciBpbml0aWFsbHkuXG4vLyBBIHJlc3BvbnNlIGZyb20gL2FwaS90b2tlbiBtYXkgY2hhbmdlIHRoZSBtYWlsIGF0dHJpYnV0ZSBvZiB0aGUgY3VycmVudFxuLy8gdXNlciwgc28gZW52LmN1cnJlbnRVc2VyLm1haWwgbWF5IGJlIGRpZmZlcmVudCBhZnRlciBnZXR0aW5nIGEgcmVzcG9uc2UuXG4vLyBIb3dldmVyLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB2YWx1YWJsZSBhbHdheXMgaW4gb3JkZXIgdG8gZGlzdGluZ3Vpc2ggdGhlIGNhc2Vcbi8vIHdoZW4gb25lIG5vcm1hbCB1c2VyIGxvZ3Mgb3V0IGFuZCBhbm90aGVyIHVzZXIgbG9ncyBpbi5cbmNvbnN0IGluaXRpYWxVc2VyRW1haWwgPSBlbnYuY3VycmVudFVzZXIgJiYgZW52LmN1cnJlbnRVc2VyLm1haWw7IC8vIEluaXRpYWwgdmFsdWUgb2YgbWFpbC4gTWF5IGNoYW5nZS5cbmlmIChpbml0aWFsVXNlckVtYWlsKSB7XG4gIC8vIEtFRFxuICBpZiAoY2ZnLktFRF9UT0tFTl9QQVRIKSB7XG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFByb2R1Y3Rpb24gLyBTaXRlVmlzaW9uIHByb3hpZWQgL2FwaS90b2tlbiB0byByZXF1ZXN0IHRva2VucyBmcm9tOlxuICAgIC8vXG4gICAgLy9cbiAgICBjb25zdCBtZXJnZWRUb2tlblBhdGggPSBnZXRNZXJnZWRUb2tlblBhdGgoXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcbiAgICAgICAgXCJrZWRiYWNrZW5kXCIsXG4gICAgICAgIFwiRURTXCIsXG4gICAgICBdKTtcbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIGluaXRpYWxVc2VyRW1haWwpO1xuICAgIGxvYWRVc2VySW5mbyhnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCkpO1xuXG4gICAgLy8gR29vZ2xlXG4gICAgY29uc3QgZ29vZ2xlTWVyZ2VkUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcbiAgICAgIGNmZy5LRURfVE9LRU5fUEFUSCxcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCwgW1xuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcbiAgICAgIF0pO1xuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlR29vZ2xlVG9rZW5Qcm92aWRlcihnb29nbGVNZXJnZWRQYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcbiAgfSBlbHNlIGlmIChjZmcuS0VEX1RPS0VOX1VSTCAmJiBjZmcuS0VEX0NMSUVOVF9JRCAmJiBjZmcuS0VEX0NMSUVOVF9TRUNSRVQpIHtcbiAgICAvL1xuICAgIC8vXG4gICAgLy8gVGVzdCAtIGdvIGRpcmVjdGx5IHRvIEtFREFVVEggc2VydmVyIHRvIHJldHJpZXZlIHRva2Vuc1xuICAgIC8vXG4gICAgLy9cbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCwgZW52LmN1cnJlbnRVc2VyLCBbXG4gICAgICBcImtlZGJhY2tlbmRcIixcbiAgICAgIFwiRURTXCIsXG4gICAgXSk7XG4gICAgZW52Lmdvb2dsZVRva2VuUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCArIFwiL2dvb2dsZVwiLCBlbnYuY3VycmVudFVzZXIsIFtcbiAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5yZWFkb25seVwiLFxuICAgIF0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBjb25maWd1cmF0aW9uIHBhcmFtZXRlciBLRURfVE9LRU5fUEFUSGApO1xuICB9XG59XG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBpc29tb3JwaGljIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuaW1wb3J0IHsgRWRzQ2xpZW50IH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuXG5lbnYuZWRzQ2xpZW50ID0gbmV3IEVkc0NsaWVudCAoXG4gIGlzb21vcnBoaWMsXG4gIGNmZy5FRFNfQVBJX1VSTCxcbiAgZW52LmJlYXJlclByb3ZpZGVyLFxuICAoKT0+ZW52LmN1cnJlbnRVc2VyLm1haWwpO1xuXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuXG5lbnYua2VkQmFja2VuZENsaWVudCA9IG5ldyBLZWRCYWNrZW5kQ2xpZW50V2ViIChcbiAgY2ZnLktFRF9BUElfVVJMLFxuICBlbnYuYmVhcmVyUHJvdmlkZXIpO1xuXG4iLCJpbXBvcnQgS0VEIGZyb20gJy4vS0VEJztcblxuLyogVGhpcyBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaXMgdXNlZCBhcyBhIGZhbGxiYWNrLlxuTm9ybWFsbHkgYm90aCB0ZXN0IHBhZ2VzIGFuZCBwcm9kdWN0aW9uIHBhZ2VzIHdpbGwgb3ZlcnJpZGUgdGhlc2UgY29uZmlncmF0aW9uc1xuKi9cbi8qY29uc3QgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7XG4gIC8vIEVudmlyb25tZW50XG4gIEVOVklST05NRU5UOiAnZGV2ZWxvcG1lbnQnIGFzICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCcsXG4gIC8vIEF1dGhlbnRpY2F0aW9uIFNlcnZlcjpcbiAgS0VEX1RPS0VOX1VSTDogJ2h0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW4nLFxuICBLRURfVE9LRU5fUEFUSDogJy9hcGkvdG9rZW4uU2tyaXB0LnBvcnRsZXQ/c3YuY29udGVudHR5cGU9YXBwbGljYXRpb24vanNvbicsXG4gIEtFRF9DTElFTlRfSUQ6ICdkZXZjbGllbnQnLFxuICBLRURfQ0xJRU5UX1NFQ1JFVDogJzRmUmRmUXBXdEpxalRXZicsXG4gIC8vIFNlcnZpY2VzOlxuICBLRURfQVBJX1VSTDogJ2h0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLycsICBcbiAgRURTX0FQSV9VUkw6ICdodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLydcbn0qL1xuXG5leHBvcnQgaW50ZXJmYWNlIElLZWRDb25maWd1cmF0aW9uIHtcbiAgRU5WSVJPTk1FTlQ6ICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCc7XG4gIEtFRF9SRUFMTTogc3RyaW5nO1xuICBLRURfVE9LRU5fVVJMOiBzdHJpbmc7XG4gIEtFRF9UT0tFTl9QQVRIOiBzdHJpbmc7XG4gIEtFRF9DTElFTlRfSUQ6IHN0cmluZztcbiAgS0VEX0NMSUVOVF9TRUNSRVQ6IHN0cmluZztcbiAgS0VEX0FQSV9VUkw6IHN0cmluZztcbiAgRURTX0FQSV9VUkw6IHN0cmluZztcbn07XG5cbmlmICghS0VELmNmZykgS0VELmNmZyA9IHt9O1xuXG5leHBvcnQgZGVmYXVsdCBLRUQuY2ZnIGFzIElLZWRDb25maWd1cmF0aW9uO1xuIiwiaW1wb3J0IHtVc2VyLCBMZWFybmluZ01vZHVsZVRhc2tzfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBCZWFyZXJQcm92aWRlciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7VXNlclRhc2t9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi4vcmVwb3Mva2VkLXJlcG8nO1xuaW1wb3J0IHtFZHNDbGllbnR9IGZyb20gJy4uL2FwaXMvZWRzY2xpZW50JztcbmltcG9ydCBLRUQgZnJvbSAnLi9rZWQnO1xuaW1wb3J0IHsgS1NUZXJtUGxhbm5lclJlcG8gfSBmcm9tICcuLi9yZXBvcy9rcy10ZXJtcGxhbm5lci1yZXBvJztcblxuZXhwb3J0IGludGVyZmFjZSBFbnYge1xuICAgIGN1cnJlbnRVc2VyPzogVXNlcjtcbiAgICBsZWFybmluZ01vZHVsZVRhc2tzPzogTGVhcm5pbmdNb2R1bGVUYXNrcztcbiAgICBiZWFyZXJQcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xuICAgIGdvb2dsZVRva2VuUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcbiAgICBrZWRCYWNrZW5kQ2xpZW50PzogS2VkQmFja2VuZENsaWVudDtcbiAgICBlZHNDbGllbnQ/OiBFZHNDbGllbnQ7XG4gICAgdXNlclRhc2tzUmVwbz87XG4gICAgaGlkZGVuQ291cnNlc1JlcG8/O1xuICAgIHdlZWtOb3Rlc1JlcG8/O1xuICAgIGtnVGVybVBsYW5uZXJSZXBvPztcbiAgICBrc1Rlcm1QbGFubmVyUmVwbz86IEtTVGVybVBsYW5uZXJSZXBvXG4gICAgdHV0b3JlZDogYm9vbGVhbjtcbiAgICBlcnJvcj86IEVycm9yO1xuICAgIGNvdXJzZUFkbWluVXJsS1M/OiBzdHJpbmc7XG4gICAgY291cnNlVmlld2VyVXJsS1M/OiBzdHJpbmc7XG4gICAgY291cnNlQnVpbGRlclVybD86IHN0cmluZztcbiAgICBjb3Vyc2VWaWV3ZXJVcmw/OiBzdHJpbmc7XG59XG5cbmlmICghS0VELmVudikgS0VELmVudiA9IHt9O1xuXG5leHBvcnQgZGVmYXVsdCBLRUQuZW52IGFzIEVudjtcbiIsIlxuZXhwb3J0IGNvbnN0IEtFRF9OQU1FU1BBQ0UgPSBcIktFRFwiO1xuXG5kZWNsYXJlIHZhciBLRUQ6IGFueTtcblxudmFyIHJlc3VsdCA9IHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnID8ge30gOiBLRUQ7XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvd1tLRURfTkFNRVNQQUNFXSA9IHJlc3VsdDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcmVzdWx0O1xuIiwiaW1wb3J0IGVudiBmcm9tICcuL0tFRC5lbnYnO1xuaW1wb3J0IHsgS2VkQmFja2VuZFJlcG8gfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xuaW1wb3J0IHsgZ2V0R2xvYmFsSWQsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4vS0VELmNmZyc7XG5pbXBvcnQgeyBTY2hvb2wsIEJyYW5jaCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IFZhbHVlIH0gZnJvbSAna2VkYmFja2VuZC9vYnNlcnZhYmxlJztcblxuZXhwb3J0IGNvbnN0IGRiID0gbmV3IEtlZEJhY2tlbmRSZXBvKCgpPT5lbnYua2VkQmFja2VuZENsaWVudCwgKCk9PmVudi5jdXJyZW50VXNlciA/IGVudi5jdXJyZW50VXNlci5tYWlsIDogXCJcIik7XG5leHBvcnQgY29uc3QgZ2xvYmFsSWQgPSBnZXRHbG9iYWxJZChjZmcuS0VEX1JFQUxNKTtcbmV4cG9ydCBjb25zdCBTY2hvb2xzID0ge1xuICBzdGFuZGFyZFNjaG9vbDogZGIuc2Nob29scy5uYW1lKFwic3RhbmRhcmRcIikuY2FjaGVPcHRpbWl6ZWQoKS5zaW5nbGUoKSxcbiAgZ2V0IG15U2Nob29sICgpIHsgcmV0dXJuIGRiLnNjaG9vbHMubmFtZShlbnYuY3VycmVudFVzZXIuc2Nob29sKS5jYWNoZU9wdGltaXplZCgpLnNpbmdsZSgpOyB9XG59O1xuZXhwb3J0IGNvbnN0IENvdXJzZUluc3RhbmNlcyA9IHtcbiAgZ2V0QnJhbmNoSWQoc2Nob29sOiBWYWx1ZTxTY2hvb2w+LCBjb3Vyc2VJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHNjaG9vbC5zd2l0Y2hNYXAoc2Nob29sID0+XG4gICAgICBkYi5icmFuY2hlc1xuICAgICAgICAuaGFzRWRnZXNGcm9tKFtzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZF0pXG4gICAgICAgIC5uYW1lKFwiZHJhZnRcIilcbiAgICAgICAgLnRhZ3MoY291cnNlSWQpXG4gICAgICAgIC5pZHNPbmx5KClcbiAgICAgICAgLm1hcCgoe2lkfSkgPT4gaWQpXG4gICAgICAgIC50b1ZhbHVlKClcbiAgICAgICAgLm1hcChpZHMgPT4gaWRzLmxlbmd0aCA+IDAgPyBpZHNbMF0gOiB1bmRlZmluZWQpKTtcbiAgfSxcblxuICAvKiogR2V0IGEgRFJBRlQgYnJhbmNoIGZvciBnaXZlbiBjb3Vyc2UgSUQgYW5kIGdpdmVuIHNjaG9vbC5cbiAgICogSWYgdGhlcmUgaXMgbm90IHlldCBzdWNoIGEgYnJhbmNoLCBjcmVhdGUgaXQgdXNpbmcgbXV0YXRpb25zT25FbXB0eSgpIHdoaWNoIHdpbGxcbiAgICogbGVhZCB0byB0aGUgQyMgY29kZSBEb2N1bWVudFJlcG9zaXRvcnkuUmVhZE9yTXV0YXRlKCkgdmlhIERvY3VtZW50Q29udHJvbGxlci5cbiAgICovXG4gIGdldE9yQ3JlYXRlQnJhbmNoSWQoc2Nob29sOiBWYWx1ZTxTY2hvb2w+LCBjb3Vyc2VJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGRiLmNvdXJzZUluc3RhbmNlcy5pZHNPbmx5KCkuaWQoY291cnNlSWQpLnN3aXRjaE1hcCgoKT0+IC8vIFRIaXMgZmlyc3QgbGluZSB2ZXJpZmllcyBjb3Vyc2UgZXhpc3RzLiBJZiBkZWxldGVkLCBkb24ndCB0cnkgdG8gcmVjcmVhdGUgaXRzIGJyYW5jaCFcbiAgICAgIHNjaG9vbC5zd2l0Y2hNYXAoc2Nob29sID0+IFxuICAgICAgZGIuYnJhbmNoZXNcbiAgICAgICAgLmhhc0VkZ2VzRnJvbShbc2Nob29sLm9mZmljaWFsQnJhbmNoSWRdKVxuICAgICAgICAubmFtZShcImRyYWZ0XCIpXG4gICAgICAgIC50YWdzKGNvdXJzZUlkKVxuICAgICAgICAuaWRzT25seSgpXG4gICAgICAgIC5tdXRhdGlvbnNPbkVtcHR5KHR4ID0+IHtcbiAgICAgICAgICAvLyBUaGVzZSAyIG11dGF0aW9ucyB3aWxsIG9jY3VyIHNlcnZlciBzaWRlLCBhdG9taWNhbGx5LlxuICAgICAgICAgIC8vIFdpbGwgYmUgc2VudCBvbiBlYWNoIHJlcXVlc3QgaW4gdGhlIHF1ZXJ5LCBidXQgd2lsbCBvbmx5IGV4ZWN1dGUgaWYgcXVlcnkgcmVzdWx0cyBpbiB6ZXJvIGl0ZW1zLlxuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJTY2hvb2w6XCIsIHNjaG9vbCk7XG4gICAgICAgICAgY29uc3QgaWQgPSBjcmVhdGVVVUlEKCk7XG4gICAgICAgICAgdHguYWRkKFwiYnJhbmNoZXNcIiwge1xuICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICBhY2w6IFtcbiAgICAgICAgICAgICAgXCJyb2xlOlVTRVI6UlwiLFxuICAgICAgICAgICAgICBgc2Nob29sUm9sZToke3NjaG9vbC5uYW1lfS9FTVBMT1lFRTpTYFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIG5hbWU6ICdkcmFmdCcsXG4gICAgICAgICAgICBzY2hvb2xJZDogc2Nob29sLmlkLFxuICAgICAgICAgICAgdHJlZVBhcmVudElkOiBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCxcbiAgICAgICAgICAgIHRhZ3M6IFtjb3Vyc2VJZF1cbiAgICAgICAgICB9IGFzIEJyYW5jaCk7XG4gICAgICAgICAgLy8gQXBwcm92aW5nIHRoZSBicmFuY2ggbWFrZXMgc3VyZSB0aGF0IGl0IHdhcyBjcmVhdGVkIGJ5IGFuIEVNUExPWUVFIG9uIGdpdmVuIHNjaG9vbC5cbiAgICAgICAgICB0eC5saW5rMihcImJyYW5jaGVzXCIsIHNjaG9vbC5vZmZpY2lhbEJyYW5jaElkLCBcImFwcHJvdmVkQ2hpbGRyZW5cIiwgaWQpO1xuICAgICAgICB9KVxuICAgICAgICAuc2luZ2xlKClcbiAgICAgICAgLm1hcCgoe2lkfSkgPT4gaWQpKSk7XG4gIH0sXG5cbiAgZ2V0QWxsRGVzY2VuZGFudElkcyhjb3Vyc2VJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGRiLmNvdXJzZUJsb2Nrcy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkuY29uY2F0KFxuICAgICAgZGIuY291cnNlQ29udGVudHMudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKS5jb25jYXQoXG4gICAgICBkYi5jb3Vyc2VUYWJzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSkuY29uY2F0KFxuICAgICAgZGIudGFza3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKVxuICAgICAgLm1hcCh4ID0+IHguaWQpO1xuICB9XG59XG4iLCJcbmV4cG9ydCBjb25zdCBLRURfTkFNRVNQQUNFID0gXCJLRURcIjtcblxuZGVjbGFyZSB2YXIgS0VEOiBhbnk7XG5cbnZhciByZXN1bHQgPSB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJyA/IHt9IDogS0VEO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3dbS0VEX05BTUVTUEFDRV0gPSByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlc3VsdDtcbiIsImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcblxubW9tZW50LnVwZGF0ZUxvY2FsZSgnc3YnLCB7XG4gICAgbW9udGhzIDogJ2phbnVhcmlfZmVicnVhcmlfbWFyc19hcHJpbF9tYWpfanVuaV9qdWxpX2F1Z3VzdGlfc2VwdGVtYmVyX29rdG9iZXJfbm92ZW1iZXJfZGVjZW1iZXInLnNwbGl0KCdfJyksXG4gICAgbW9udGhzU2hvcnQgOiAnamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMnLnNwbGl0KCdfJyksXG4gICAgd2Vla2RheXMgOiAnc8O2bmRhZ19tw6VuZGFnX3Rpc2RhZ19vbnNkYWdfdG9yc2RhZ19mcmVkYWdfbMO2cmRhZycuc3BsaXQoJ18nKSxcbiAgICB3ZWVrZGF5c1Nob3J0IDogJ3PDtm5fbcOlbl90aXNfb25zX3Rvcl9mcmVfbMO2cicuc3BsaXQoJ18nKSxcbiAgICB3ZWVrZGF5c01pbiA6ICdzw7ZfbcOlX3RpX29uX3RvX2ZyX2zDticuc3BsaXQoJ18nKSxcbiAgICBsb25nRGF0ZUZvcm1hdCA6IHtcbiAgICAgICAgTFQgOiAnSEg6bW0nLFxuICAgICAgICBMVFMgOiAnSEg6bW06c3MnLFxuICAgICAgICBMIDogJ1lZWVktTU0tREQnLFxuICAgICAgICBMTCA6ICdEIE1NTU0gWVlZWScsXG4gICAgICAgIExMTCA6ICdEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXG4gICAgICAgIExMTEwgOiAnZGRkZCBEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXG4gICAgICAgIGxsbCA6ICdEIE1NTSBZWVlZIEhIOm1tJyxcbiAgICAgICAgbGxsbCA6ICdkZGQgRCBNTU0gWVlZWSBISDptbSdcbiAgICB9LFxuICAgIGNhbGVuZGFyIDoge1xuICAgICAgICBzYW1lRGF5OiAnW0lkYWddIExUJyxcbiAgICAgICAgbmV4dERheTogJ1tJbW9yZ29uXSBMVCcsXG4gICAgICAgIGxhc3REYXk6ICdbSWfDpXJdIExUJyxcbiAgICAgICAgbmV4dFdlZWs6ICdbUMOlXSBkZGRkIExUJyxcbiAgICAgICAgbGFzdFdlZWs6ICdbSV0gZGRkZFtzXSBMVCcsXG4gICAgICAgIHNhbWVFbHNlOiAnTCdcbiAgICB9LFxuICAgIHJlbGF0aXZlVGltZSA6IHtcbiAgICAgICAgZnV0dXJlIDogJ29tICVzJyxcbiAgICAgICAgcGFzdCA6ICdmw7ZyICVzIHNlZGFuJyxcbiAgICAgICAgcyA6ICduw6VncmEgc2VrdW5kZXInLFxuICAgICAgICBzcyA6ICclZCBzZWt1bmRlcicsXG4gICAgICAgIG0gOiAnZW4gbWludXQnLFxuICAgICAgICBtbSA6ICclZCBtaW51dGVyJyxcbiAgICAgICAgaCA6ICdlbiB0aW1tZScsXG4gICAgICAgIGhoIDogJyVkIHRpbW1hcicsXG4gICAgICAgIGQgOiAnZW4gZGFnJyxcbiAgICAgICAgZGQgOiAnJWQgZGFnYXInLFxuICAgICAgICBNIDogJ2VuIG3DpW5hZCcsXG4gICAgICAgIE1NIDogJyVkIG3DpW5hZGVyJyxcbiAgICAgICAgeSA6ICdldHQgw6VyJyxcbiAgICAgICAgeXkgOiAnJWQgw6VyJ1xuICAgIH0sXG4gICAgZGF5T2ZNb250aE9yZGluYWxQYXJzZTogL1xcZHsxLDJ9KGV8YSkvLFxuICAgIG9yZGluYWwgOiBmdW5jdGlvbiAobnVtYmVyKSB7XG4gICAgICAgIHZhciBiID0gbnVtYmVyICUgMTAsXG4gICAgICAgICAgICBvdXRwdXQgPSAofn4obnVtYmVyICUgMTAwIC8gMTApID09PSAxKSA/ICdlJyA6XG4gICAgICAgICAgICAoYiA9PT0gMSkgPyAnYScgOlxuICAgICAgICAgICAgKGIgPT09IDIpID8gJ2EnIDpcbiAgICAgICAgICAgIChiID09PSAzKSA/ICdlJyA6ICdlJztcbiAgICAgICAgcmV0dXJuIG51bWJlciArIG91dHB1dDtcbiAgICB9LFxuICAgIHdlZWsgOiB7XG4gICAgICAgIGRvdyA6IDEsIC8vIE1vbmRheSBpcyB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrLlxuICAgICAgICBkb3kgOiA0ICAvLyBUaGUgd2VlayB0aGF0IGNvbnRhaW5zIEphbiA0dGggaXMgdGhlIGZpcnN0IHdlZWsgb2YgdGhlIHllYXIuXG4gICAgfVxufSk7XG5cbmV4cG9ydCBjb25zdCBsb2NhbE1vbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbW9tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykubG9jYWxlKCdzdicpO1xufVxuIiwiaW1wb3J0IHsgS2VkUmVwbyB9IGZyb20gJy4va2VkLXJlcG8nO1xuaW1wb3J0IHsgVXNlckhpZGRlbkNvdXJzZSwgU2Nob29sLCBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBFRFNDb3Vyc2UgfSBmcm9tICcuLi9jb250cmFjdHMvZWRzJztcbmltcG9ydCB7IHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AsIGFycmF5VG9NYXAgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgRURTUGVyaW9kIH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuaW1wb3J0IHsgZ2V0U2Nob29sTW9tZW50IH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5leHBvcnQgbGV0IGhpZGRlbkNvdXJzZXNSZXBvID0gZW52LmhpZGRlbkNvdXJzZXNSZXBvIGFzIEhpZGRlbkNvdXJzZXNSZXBvO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ291cnNlV2l0aEhpZGRlblN0YXRlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgZGVmYXVsdFZpc2libGU6IGJvb2xlYW47XG59XG5cbmV4cG9ydCB0eXBlIEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyID0gKGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdKSA9PiB2b2lkO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmliZXJPcHRpb25zIHtcbiAgZnVsbENvdXJzZTogYm9vbGVhbjtcbn1cblxuY2xhc3MgSGlkZGVuQ291cnNlc1JlcG8ge1xuICByZXN1bHQ6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdIHwgbnVsbCA9IG51bGw7XG4gIHN1YnNjcmliZXJzOiB7c3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zfVtdID0gW107XG4gIGZ1bGxDb3Vyc2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAga2VkQ291cnNlc1Byb21pc2U6IFByb21pc2U8UGFydGlhbDxDb3Vyc2U+W10+O1xuICBlZHNDb3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxFRFNDb3Vyc2VbXT47XG4gIHVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxVc2VySGlkZGVuQ291cnNlW10+O1xuICBrZWRSZXBvOiBLZWRSZXBvPFVzZXJIaWRkZW5Db3Vyc2U+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMua2VkUmVwbyA9IG5ldyBLZWRSZXBvPFVzZXJIaWRkZW5Db3Vyc2U+KHtcbiAgICAgIGdldENsaWVudDogKCkgPT4gZW52LmtlZEJhY2tlbmRDbGllbnQsXG4gICAgICBvcHRpbWlzdGljOiB0cnVlLFxuICAgICAgdGFibGU6IFwidXNlcmhpZGRlbmNvdXJzZXNcIixcbiAgICAgIHVzZXI6IGVudi5jdXJyZW50VXNlciA/IGVudi5jdXJyZW50VXNlci5tYWlsIDogXCJcIixcbiAgICAgIGdldFF1ZXJ5T3B0aW9uczogYXN5bmMgKCkgPT4gKHtyb2xlOiBcIlVTRVJcIn0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgaW5pdFByb21pc2UgPSB0aGlzLmluaXQoKTtcblxuICAgIFByb21pc2UuYWxsKFtcbiAgICAgIGluaXRQcm9taXNlLFxuICAgICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSxcbiAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2VcbiAgICBdKS5jYXRjaChlcnIgPT4gc2hvd0Vycm9yKGVycikpO1xuICB9XG5cbiAgYXN5bmMgaW5pdCgpIHtcbiAgICAvLyBXYWl0IHRpbGwgd2UgaGF2ZSBhIGN1cnJlbnRVc2VyIHRoYXQgaXMgYWNjdXJhdGUgYWxzbyBmb3IgaW1wZXJzb25hdGVkIHVzZXJzLlxuICAgIGNvbnN0IGJlYXJlclByb21pc2UgPSBlbnYuYmVhcmVyUHJvdmlkZXIgPyBlbnYuYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCkgOiBQcm9taXNlLnJlc29sdmUoe30pO1xuXG4gICAgLy8gSW4gcGFyYWxsZWxsLCB3ZSByZXF1ZXN0OlxuICAgIC8vICAxKSBLRURCYWNrZW5kOiBTY2hvb2xzLmFjdGl2ZUNvdXJzZXNcbiAgICAvLyAgMikgRURTLmdldEFjdGl2ZUFjb3Vyc2VzKClcbiAgICAvLyAgMykgKHZpYSBzdWJzY3JpcHRpb24pOiBLRURCYWNrZW5kOiB1c2VySGlkZGVuQ291cnNlc1xuXG4gICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSA9IGJlYXJlclByb21pc2UudGhlbigoKT0+dGhpcy5saXN0S2VkQ291cnNlcygpKTtcbiAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlID0gYmVhcmVyUHJvbWlzZS50aGVuKCgpPT50aGlzLmxpc3RFRFNDb3Vyc2VzKCkpO1xuICAgIGxldCByZXNvbHZlVXNlckhpZGRlbkNvdXJzZXNQcm9taXNlOiAoeDogVXNlckhpZGRlbkNvdXJzZVtdKT0+dm9pZDtcbiAgICBsZXQgdXNlckhpZGRlbkNvdXJzZXNSZXNvbHZlZCA9IGZhbHNlO1xuICAgIHRoaXMudXNlckhpZGRlbkNvdXJzZXNQcm9taXNlID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXNvbHZlVXNlckhpZGRlbkNvdXJzZXNQcm9taXNlID0geCA9PiB7XG4gICAgICBpZiAodXNlckhpZGRlbkNvdXJzZXNSZXNvbHZlZCkge1xuICAgICAgICB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVzZXJIaWRkZW5Db3Vyc2VzUmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlKHgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGF3YWl0IGJlYXJlclByb21pc2U7XG5cbiAgICB0aGlzLmtlZFJlcG8ubWVtLnN1YnNjcmliZShhc3luYyB1c2VySGlkZGVuQ291cnNlcyA9PiB7XG4gICAgICAvLyBDaGFuZ2Ugb3IgaW5pdGlhbCB2YWx1ZSByZWFkeSB0byBiZSBub3RpZmllZCBvdXQuXG4gICAgICAvLyBCdXQgZmlyc3QsIGNoZWNrIHdlIGhhdmUgYWxsIHRoZSByZWxhdGVkIGRhdGEgcmVzcG9uc2VzIHdlIG5lZWQuXG4gICAgICBjb25zdCBbYWN0aXZlQ291cnNlcywgZWRzQWN0aXZlQ291cnNlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UsIFxuICAgICAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlXSk7XG4gICAgICBcbiAgICAgIC8vIFJlZmluZSB0aGUgdGhyZWUgcmVzdWx0cyBpbnRvIGEgc2luZ2xlIHJlc3VsdFxuICAgICAgdGhpcy5yZXN1bHQgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvdXJzZXNMaXN0KGVkc0FjdGl2ZUNvdXJzZXMsIHVzZXJIaWRkZW5Db3Vyc2VzLCBhY3RpdmVDb3Vyc2VzKTtcbiAgICAgIC8vIE5vdGlmeSBvdXIgc3Vic2NyaWJlcnM6XG4gICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goc3Vic2NyaWJlciA9PiB0aGlzLm5vdGlmeVN1YnNjcmliZXIoc3Vic2NyaWJlci5zdWJzY3JpYmVyLCBzdWJzY3JpYmVyLm9wdGlvbnMpKTtcbiAgICAgIHJlc29sdmVVc2VySGlkZGVuQ291cnNlc1Byb21pc2UodXNlckhpZGRlbkNvdXJzZXMpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgbGlzdEtlZENvdXJzZXMoKSB7XG4gICAgY29uc3QgZnVsbENvdXJzZSA9IHRoaXMuZnVsbENvdXJzZTtcbiAgICBjb25zb2xlLmxvZyhcIkZ1bGxDb3Vyc2U6IFwiKyBmdWxsQ291cnNlKTtcbiAgICBjb25zdCBzY2hvb2xzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTY2hvb2w+KCdzY2hvb2xzJywge1xuICAgICAgcm9sZTogXCJVU0VSXCIsIC8vIFdvcmthcm91bmQgZnJvbSBzaG93aW5nIGFjdGl2YXRlZCB0ZW1wbGF0ZXMgYW1vbmcgY291cnNlcyBvZiB0aGUgc2Nob29sXG4gICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuc2Nob29sLFxuICAgICAgaW5jbHVkZTogXCJhY3RpdmVDb3Vyc2VzXCIsXG4gICAgICBmbGFnczogZnVsbENvdXJzZSA/IFtdIDogW1wiaW5jbHVkZUlkc0FuZE5hbWVzT25seVwiXSxcbiAgICAgIGNhY2hlQnVzdDogZW52LmN1cnJlbnRVc2VyLnVzZXJuYW1lXG4gICAgfSk7XG4gICAgY29uc3QgYWN0aXZlQ291cnNlcyA9IGZsYXR0ZW4oc2Nob29scy5tYXAoc2Nob29sID0+IHNjaG9vbC5hY3RpdmVDb3Vyc2VzKSkuc29ydChjb21wYXJlUHJvcChcIm5hbWVcIikpXG4gICAgcmV0dXJuIGFjdGl2ZUNvdXJzZXM7XG4gIH1cblxuICBsaXN0RURTQ291cnNlcygpOiBQcm9taXNlPEVEU0NvdXJzZVtdIHwgbnVsbD4ge1xuICAgIGNvbnN0IHBlcmlvZE5hbWUgPSBuZXcgRURTUGVyaW9kKGdldFNjaG9vbE1vbWVudChtb21lbnQoKSkpLnBlcmlvZDtcbiAgICByZXR1cm4gZW52LmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2YoJ0VNUExPWUVFJykgPT09IC0xID9cbiAgICAgIC8vIFNUVURFTlRzIHNob3VsZCwgYnkgZGVmYXVsdCwgb25seSBzaG93IGNvdXJzZXMgdGhhdCBpcyBsaXN0ZWQgaW4gRURTXG4gICAgICBlbnYuZWRzQ2xpZW50LmdldEFjdGl2ZUNvdXJzZXMoe3BlcmlvZE5hbWV9KSA6XG4gICAgICAvLyBFTVBMT1lFRXMgc2hvdWxkLCBieSBkZWZhdWx0LCBzaG93IGFsbCBjb3Vyc2VzIG9uIHNjaG9vbCAtIG5vIG5lZWQgdG8gcXVlcnkgRURTXG4gICAgICBudWxsO1xuICB9XG5cbiAgYXN5bmMgY3JlYXRlQ291cnNlc0xpc3QoXG4gICAgZWRzQWN0aXZlQ291cnNlczogRURTQ291cnNlW10gfCBudWxsLFxuICAgIHVzZXJIaWRkZW5Db3Vyc2VzOiBVc2VySGlkZGVuQ291cnNlW10sXG4gICAgYWN0aXZlQ291cnNlczogUGFydGlhbDxDb3Vyc2U+W10pIDogUHJvbWlzZTxDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXT5cbiAge1xuICAgIGNvbnN0IGhpZGRlbkNvdXJzZXNNYXAgPSBhcnJheVRvTWFwKHVzZXJIaWRkZW5Db3Vyc2VzLmZpbHRlcihoYyA9PiAhaGMuc2hvdyksIGhjID0+IGhjLm5hbWUpO1xuICAgIGNvbnN0IHZpc2libGVDb3Vyc2VzTWFwID0gYXJyYXlUb01hcCh1c2VySGlkZGVuQ291cnNlcy5maWx0ZXIoaGMgPT4gaGMuc2hvdyksIGhjID0+IGhjLm5hbWUpO1xuXG4gICAgY29uc3QgaXNTdHVkZW50ID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnU1RVREVOVCcpO1xuXG4gICAgY29uc3QgZWRzQ291cnNlTWFwID0gZWRzQWN0aXZlQ291cnNlcyA/XG4gICAgICBhcnJheVRvTWFwKGVkc0FjdGl2ZUNvdXJzZXMsIGMgPT4gYy5uYW1lLnN1YnN0cigwLCAyMCkpIDpcbiAgICAgIHt9O1xuICAgIGNvbnN0IGVkc0NvdXJzZU1hcEZ1bGxOYW1lID0gZWRzQWN0aXZlQ291cnNlcyA/XG4gICAgICBhcnJheVRvTWFwKGVkc0FjdGl2ZUNvdXJzZXMsIGMgPT4gYy5uYW1lLnN1YnN0cigwLCAyMCkpIDpcbiAgICAgIHt9O1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5hbGwoYWN0aXZlQ291cnNlcy5tYXAoYXN5bmMgKHtpZCwgbmFtZSwgZGVzY3JpcHRpb24sIG1vZGlmaWVkQnl9KSA9PiB7XG5cbiAgICAgIGxldCBlZHNDb3Vyc2UgPSBlZHNDb3Vyc2VNYXBbbmFtZS5zdWJzdHIoMCwgMjApXTtcblxuICAgICAgbGV0IGRlZmF1bHRWaXNpYmxlID0gaXNTdHVkZW50ID9cbiAgICAgICAgZWRzQ291cnNlICE9IG51bGwgOiAvLyBDb3Vyc2UgbmFtZSBhbHNvIGxpc3RlZCBpbiBFRFNcbiAgICAgICAgdHJ1ZTsgLy8gVGVhY2hlcnMgbm90IGRlcGVuZGVudCBvbiBFRFMgbGlzdGluZ1xuXG4gICAgICBsZXQgdmlzaWJsZSA9IGRlZmF1bHRWaXNpYmxlID9cbiAgICAgICAgIWhpZGRlbkNvdXJzZXNNYXBbaWRdIDogLy8gVmlzaWJsZSB1bmxlc3MgdXNlciBoYXMgb3ZlcnJpZGRlbiB0aGF0LlxuICAgICAgICAhIXZpc2libGVDb3Vyc2VzTWFwW2lkXTsgLy8gSGlkZGVuIHVubGVzcyB1c2VyIGhhcyBvdmVycmlkZGVuIHRoYXQuXG4gICAgICBcbiAgICAgIGlmICghdGhpcy5mdWxsQ291cnNlICYmIG5hbWUubGVuZ3RoID49IDIwKSB7XG4gICAgICAgIC8vIG5hbWUgY291bGQgYmUgdHJ1bmNhdGVkLiBSZXNvbHZlIHRoZSBmdWxsIG5hbWUuXG4gICAgICAgIGlmICh2aXNpYmxlKSB7XG4gICAgICAgICAgLy8gVW5sZXNzIHdlIHdhbm5hIHByaW50IGNvdXJzZSBuYW1lIGFzIFwiVEhFIFBhcnRpYWwgbmFtZVwiICsgXCIuLi5cIixcbiAgICAgICAgICAvLyB3ZSBtdXN0IHF1ZXJ5IHRoZSBmdWxsIGNvdXJzZSBoZXJlIGZyb20ga2VkYmFja2VuZDpcbiAgICAgICAgICBjb25zdCBmdWxsQ291cnNlID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0KFwiY291cnNlc1wiLCBpZCk7XG4gICAgICAgICAgbmFtZSA9IGZ1bGxDb3Vyc2UubmFtZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXZSBtYXkgaW4gZXJyb3IgaGF2ZSBzZXQgdGhlIGNvdXJzZSBhcyB2aXNpYmxlIGR1ZSB0byBsb25nIG5hbWUuIE5vdyBjb3JyZWN0IHRoYXQuXG4gICAgICBlZHNDb3Vyc2UgPSBlZHNDb3Vyc2VNYXBGdWxsTmFtZVtuYW1lXTsgLy8gTmFtZSBpcyBub3cgZnVsbCBuYW1lXG4gICAgICBkZWZhdWx0VmlzaWJsZSA9IGlzU3R1ZGVudCA/XG4gICAgICAgIGVkc0NvdXJzZSAhPSBudWxsIDpcbiAgICAgICAgdHJ1ZTtcbiAgICAgIHZpc2libGUgPSBkZWZhdWx0VmlzaWJsZSA/XG4gICAgICAgICFoaWRkZW5Db3Vyc2VzTWFwW2lkXSA6IC8vIFZpc2libGUgdW5sZXNzIHVzZXIgaGFzIG92ZXJyaWRkZW4gdGhhdC5cbiAgICAgICAgISF2aXNpYmxlQ291cnNlc01hcFtpZF07IC8vIEhpZGRlbiB1bmxlc3MgdXNlciBoYXMgb3ZlcnJpZGRlbiB0aGF0LlxuXG4gICAgICAvLyBSZXNvbHZlIGRlc2NyaXB0aW9uOlxuICAgICAgaWYgKG1vZGlmaWVkQnkgJiYgbW9kaWZpZWRCeS5uYW1lICYmICFkZXNjcmlwdGlvbikge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IGAke21vZGlmaWVkQnkubmFtZX1zIHZlcnNpb25gO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpZCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHZpc2libGUsXG4gICAgICAgIGRlZmF1bHRWaXNpYmxlXG4gICAgICB9O1xuICAgIH0pKTtcblxuICAgIHJldHVybiByZXN1bHQuc29ydCgoe25hbWU6IGF9LCB7bmFtZTogYn0pID0+IGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwKTtcbiAgfVxuXG4gIGFzeW5jIGhpZGVDb3Vyc2UoYzogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XG4gICAgY29uc3Qgb3ZlcnJpZGVzID0gdGhpcy5rZWRSZXBvLm1lbS5pdGVtcy5maWx0ZXIoaGMgPT4gaGMubmFtZSA9PT0gYy5pZCk7XG4gICAgaWYgKGMuZGVmYXVsdFZpc2libGUpIHtcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5pbnNlcnQoW3tcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgbmFtZTogYy5pZFxuICAgICAgfV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLmtlZFJlcG8uZGVsZXRlKG92ZXJyaWRlcy5tYXAob3YgPT4gb3YuaWQpKTsgICAgICBcbiAgICB9XG4gIH1cblxuICBhc3luYyBzaG93Q291cnNlKGM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZSkge1xuICAgIGNvbnN0IG92ZXJyaWRlcyA9IHRoaXMua2VkUmVwby5tZW0uaXRlbXMuZmlsdGVyKGhjID0+IGhjLm5hbWUgPT09IGMuaWQpO1xuICAgIGlmIChjLmRlZmF1bHRWaXNpYmxlKSB7XG4gICAgICBhd2FpdCB0aGlzLmtlZFJlcG8uZGVsZXRlKG92ZXJyaWRlcy5tYXAob3YgPT4gb3YuaWQpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5rZWRSZXBvLmluc2VydChbe1xuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICBuYW1lOiBjLmlkLFxuICAgICAgICBzaG93OiB0cnVlXG4gICAgICB9XSk7XG4gICAgfVxuICB9XG5cbiAgbm90aWZ5U3Vic2NyaWJlciA9IChzdWJzY3JpYmVyOiBIaWRkZW5Db3Vyc2VzU3Vic2NyaWJlciwgb3B0aW9uczogU3Vic2NyaWJlck9wdGlvbnMpID0+IHtcbiAgICB0cnkge1xuICAgICAgc3Vic2NyaWJlcihvcHRpb25zLmZ1bGxDb3Vyc2UgPyB0aGlzLnJlc3VsdCA6IHRoaXMucmVzdWx0LmZpbHRlcihjID0+IGMudmlzaWJsZSkpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHN1YnNjcmliZSAoc3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zKSB7XG4gICAgaWYgKCF0aGlzLmZ1bGxDb3Vyc2UgJiYgb3B0aW9ucy5mdWxsQ291cnNlKSB7XG4gICAgICAvLyBUaGUgc3Vic2NyaWJlciBkZW1hbmRzIGZ1bGwgY291cnNlc1xuICAgICAgLy8gTmVlZCB0byBxdWVyeSB0aGF0IGJlZm9yZSBub3RpZnlpbmdcbiAgICAgIC8vIEFsc28gYWZmZWN0IHN0YXRlIGZvciBmdXR1cmUgaW50ZXJuYWwgbm90aWZpY2F0aW9uXG4gICAgICB0aGlzLmZ1bGxDb3Vyc2UgPSBvcHRpb25zLmZ1bGxDb3Vyc2U7XG4gICAgICB0aGlzLmtlZENvdXJzZXNQcm9taXNlID0gdGhpcy5saXN0S2VkQ291cnNlcygpOyAvLyBSZWRvIHRoaXMgY2FsbCwgbm93IGxvYWRpbmcgZnVsbCBjb3Vyc2VzXG4gICAgICAvLyBXYWl0IGZvciBhbGwgb3V0c3RhbmRpbmcgZmV0Y2goKSBjYWxscyB0byBjb21wbGV0ZTpcbiAgICAgIGNvbnN0IFthY3RpdmVDb3Vyc2VzLCBlZHNBY3RpdmVDb3Vyc2VzLCB1c2VySGlkZGVuQ291cnNlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UsIFxuICAgICAgICB0aGlzLmVkc0NvdXJzZXNQcm9taXNlLFxuICAgICAgICB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZV0pO1xuICAgICAgLy8gQXNzZW1ibGUgcmVzdWx0OlxuICAgICAgdGhpcy5yZXN1bHQgPSBhd2FpdCB0aGlzLmNyZWF0ZUNvdXJzZXNMaXN0KGVkc0FjdGl2ZUNvdXJzZXMsIHVzZXJIaWRkZW5Db3Vyc2VzLCBhY3RpdmVDb3Vyc2VzKTtcbiAgICB9XG4gICAgYXdhaXQgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2U7IC8vIFNvIHdlIGtub3cgdGhhdCB0aGlzLnJlc3VsdCBpcyB0aGVyZS5cbiAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXIoc3Vic2NyaWJlciwgb3B0aW9ucyk7XG4gICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHtzdWJzY3JpYmVyLCBvcHRpb25zfSk7XG4gIH1cblxuICB1bnN1YnNjcmliZSAoc3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIpIHtcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIocyA9PiBzLnN1YnNjcmliZXIgIT09IHN1YnNjcmliZXIpO1xuICB9XG59XG5cbmlmICghaGlkZGVuQ291cnNlc1JlcG8pIHtcbiAgaGlkZGVuQ291cnNlc1JlcG8gPSBlbnYuaGlkZGVuQ291cnNlc1JlcG8gPSBuZXcgSGlkZGVuQ291cnNlc1JlcG8oKTtcbn1cbiIsImltcG9ydCB7IFJlcG8sIFJlcG9Db21tdW5pY2F0b3J9IGZyb20gJy4vcmVwbyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBMaXN0T3B0aW9ucywgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBEb2N1bWVudH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEtlZFJlcG9PcHRpb25zPFQgZXh0ZW5kcyBEb2N1bWVudD4ge1xuICBnZXRDbGllbnQ6ICgpPT5LZWRCYWNrZW5kQ2xpZW50O1xuICBnZXRRdWVyeU9wdGlvbnM6ICgpPT5Qcm9taXNlPExpc3RPcHRpb25zPjtcbiAgb3B0aW1pc3RpYzogYm9vbGVhbjtcbiAgdGFibGU6IHN0cmluZztcbiAgdXNlcjogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgS2VkUmVwbzxUIGV4dGVuZHMgRG9jdW1lbnQ+IHtcbiAgbWVtOiBSZXBvPFQ+O1xuICBvcHRpb25zOiBLZWRSZXBvT3B0aW9uczxUPjtcbiAgXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEtlZFJlcG9PcHRpb25zPFQ+KSB7XG4gICAgY29uc3Qge3RhYmxlLCBnZXRDbGllbnQsIGdldFF1ZXJ5T3B0aW9uc30gPSBvcHRpb25zO1xuICAgIHRoaXMubWVtID0gbmV3IFJlcG88VD4oe3F1ZXJ5OiBhc3luYyAoKT0+e1xuICAgICAgY29uc3QgcXVlcnlPcHRpb25zID0gYXdhaXQgZ2V0UXVlcnlPcHRpb25zKCk7XG4gICAgICByZXR1cm4gYXdhaXQgZ2V0Q2xpZW50KCkubGlzdDxUPih0YWJsZSwge1xuICAgICAgICAuLi5xdWVyeU9wdGlvbnMsXG4gICAgICAgIGNhY2hlQnVzdDogdGhpcy5nZXRDYWNoZUJ1c3QoKX0pO1xuICAgIH19KTtcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDYWNoZUJ1c3QoKSB7XG4gICAgY29uc3Qge3RhYmxlLCB1c2VyfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjYWNoZUJ1c3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2FjaGUtYnVzdC0nICsgdGFibGUgKyAnLScgKyB1c2VyKTtcbiAgICByZXR1cm4gY2FjaGVCdXN0IHx8IHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWdlbmVyYXRlQ2FjaGVCdXN0KCkge1xuICAgIGNvbnN0IHt0YWJsZSwgdXNlcn0gPSB0aGlzLm9wdGlvbnM7XG4gICAgY29uc3QgY2FjaGVCdXN0ID0gY3JlYXRlVVVJRCgpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYWNoZS1idXN0LScgKyB0YWJsZSArICctJyArIHVzZXIsIGNhY2hlQnVzdCk7XG4gICAgcmV0dXJuIGNhY2hlQnVzdDtcbiAgfVxuXG4gIGFzeW5jIHVwc2VydChpdGVtOiBULCB1cGRhdGVyOiAoaXRlbTogVCkgPT4gdm9pZCkge1xuICAgIGlmICghaXRlbS4kZXRhZykge1xuICAgICAgLy8gSXRlbXMgd2l0aG91dCAkZXRhZyBjYW5ub3QgYmUgcmV0cmlldmVkIGZyb20gc2VydmVyLCBzbyBpdCBzaG91bGQgYmUgaW5zZXJ0ZWQuXG4gICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pO1xuICAgICAgdXBkYXRlcih1cGRhdGVkSXRlbSk7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5pbnNlcnQoW3VwZGF0ZWRJdGVtXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFdlIGhhdmUgYW4gJGV0YWcsIHNvIHdlIGNhbiBleHBlY3QgaXQgdG8gbGl2ZSBvbiB0aGUgc2VydmVyLlxuICAgICAgLy8gSG93ZXZlciwgdGFrZSBjYXJlIG9mIHRoZSB1bmxpa2VseSBzaXR1YXRpb24gdGhhdCBpdCB3YXMgZGVsZXRlZCBmcm9tIHNlcnZlcixcbiAgICAgIC8vIGFuZCBpZiBzbywgaW5zZXJ0IGl0IGFnYWluLlxuICAgICAgYXdhaXQgdGhpcy51cGRhdGUoW2l0ZW1dLCB1cGRhdGVyKS5jYXRjaChlID0+IHtcbiAgICAgICAgaWYgKGUubmFtZSA9PT0gXCJodHRwNDA0XCIpIHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pO1xuICAgICAgICAgIHVwZGF0ZXIodXBkYXRlZEl0ZW0pO1xuICAgICAgICAgIHJldHVybiB0aGlzLmluc2VydChbdXBkYXRlZEl0ZW1dKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyB1cGRhdGUoaXRlbXM6IFRbXSwgdXBkYXRlcjogKGl0ZW06IFQpID0+IHZvaWQpIHtcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZX0gPSB0aGlzLm9wdGlvbnM7XG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XG4gICAgY29uc3QgbW9kaWZpZWRJdGVtczogVFtdID0gaXRlbXMubWFwKGl0ZW0gPT4ge1xuICAgICAgY29uc3QgbWVtUmVwb0l0ZW0gPSB0aGlzLm1lbS5pdGVtcy5maW5kKGl0ID0+IGl0LmlkID09PSBpdGVtLmlkKTtcbiAgICAgIGl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCBtZW1SZXBvSXRlbSB8fCBpdGVtKTtcbiAgICAgIHVwZGF0ZXIoaXRlbSk7XG4gICAgICByZXR1cm4gaXRlbTtcbiAgICB9KTtcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKG1vZGlmaWVkSXRlbXMubWFwKHggPT4gT2JqZWN0LmFzc2lnbih7fSwgeCwgeyRtZXRhOiAndXBkYXRpbmcnfSkpKTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQuZG8gKGJyID0+IG1vZGlmaWVkSXRlbXMuZm9yRWFjaChpdGVtID0+IGJyLnB1dCh0YWJsZSwgaXRlbSkpKVxuICAgIC5jYXRjaChlID0+IGUubmFtZSA9PT0gXCJodHRwNDA5XCIgPyAvLyBjb25mbGljdFxuICAgICAgLy8gR2V0IGEgZnJlc2ggdmVyc2lvbiBmcm9tIHNlcnZlcjpcbiAgICAgIGNsaWVudC5saXN0PFQ+KHRhYmxlLCB7aWRzOiBpdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmlkKX0sIHtjYWNoZTogJ25vLWNhY2hlJ30pLnRoZW4oZnJlc2hJdGVtcyA9PiB7XG4gICAgICAgIC8vIFVwZGF0ZSBsb2NhbCB2ZXJzaW9uOlxuICAgICAgICBjb25zdCBtb2RpZmllZEl0ZW1zID0gZnJlc2hJdGVtcy5tYXAoZnJlc2hJdGVtID0+IHtcbiAgICAgICAgICAvLyBDbG9uZSB0aGUgZnJlc2ggaXRlbVxuICAgICAgICAgIGNvbnN0IG1vZGlmaWVkID0gT2JqZWN0LmFzc2lnbih7fSwgZnJlc2hJdGVtKTtcbiAgICAgICAgICAvLyBSZS1ydW4gdGhlIHVwZGF0ZXIgb24gdGhlIGNsb25lOlxuICAgICAgICAgIHVwZGF0ZXIobW9kaWZpZWQpO1xuICAgICAgICAgIHJldHVybiBtb2RpZmllZDtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJlLWRvIHRoZSB0aGUgcHV0IG9wZXJhdGlvbiB0b3dhcmRzIHRoZSBzZXJ2ZXIuXG4gICAgICAgIHJldHVybiBjbGllbnQuZG8oYnIgPT4gbW9kaWZpZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gYnIucHV0KHRhYmxlLCBpdGVtKSkpO1xuICAgICAgfSkgOlxuICAgICAgLy8gT3RoZXIgdW5leHBlY3RlZCBlcnJvcjpcbiAgICAgIFByb21pc2UucmVzb2x2ZShvcHRpbWlzdGljICYmXG4gICAgICAgIHRoaXMubWVtLnVwZGF0ZShpdGVtcykpIC8vIFVuZG8gb3B0aW1pc3RpYyB1cGRhdGVcbiAgICAgIC50aGVuKCgpPT57XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTsgLy8gUmVqZWN0IHdpdGggdGhlIGVycm9yIG5vIG1hdHRlci5cbiAgICAgIH0pKTtcbiAgICB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcbiAgICBtb2RpZmllZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICBpdGVtLiRldGFnID0gcmVzLm5ld0V0YWdzW2l0ZW0uaWRdO1xuICAgICAgaXRlbS4kbWV0YSA9IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUobW9kaWZpZWRJdGVtcyk7IC8vIEVuc3VyZXMgbmV3IGV0YWcgaXMgaXMgYXBwbGllZCBvbiBuZXh0IGFjdGlvbi5cbiAgfVxuXG4gIHN0cmlwR3JhcGhzIChpdGVtczogVFtdLCBncmFwaHM6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIGl0ZW1zLm1hcChpdGVtID0+IHtcbiAgICAgIGNvbnN0IGNsb25lID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSk7XG4gICAgICBncmFwaHMuZm9yRWFjaChncmFwaCA9PiB7XG4gICAgICAgIGlmIChpdGVtW2dyYXBoXSkge1xuICAgICAgICAgIGNsb25lW2dyYXBoXSA9IChpdGVtW2dyYXBoXSBhcyB7aWQ6c3RyaW5nfVtdKS5tYXAgKGRvYyA9PiAoe2lkOiBkb2MuaWR9KSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaW5zZXJ0KGl0ZW1zOiBUW10pIHtcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZSwgZ2V0UXVlcnlPcHRpb25zfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBjb25zdCBxdWVyeU9wdGlvbnMgPSBhd2FpdCBnZXRRdWVyeU9wdGlvbnMoKTtcbiAgICBjb25zdCBncmFwaHMgPSBbXS5jb25jYXQocXVlcnlPcHRpb25zLmluY2x1ZGUpO1xuICAgIC8vIEdpdmUgSURzIHRvIGVhY2ggaXRlbTpcbiAgICBpdGVtcyA9IGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uaWQgPyBpdGVtIDogT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwge2lkOiBjcmVhdGVVVUlEKCl9KSk7XG4gICAgY29uc3Qgc3RyaXBwZWQgPSB0aGlzLnN0cmlwR3JhcGhzKGl0ZW1zLCBncmFwaHMpO1xuICAgIGlmIChvcHRpbWlzdGljKSBhd2FpdCB0aGlzLm1lbS5pbnNlcnQoc3RyaXBwZWQubWFwKHggPT4gT2JqZWN0LmFzc2lnbih7fSwgeCwgeyRtZXRhOiAnYWRkaW5nJ30pKSk7XG4gICAgY29uc3QgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RyaXBwZWQpIHtcbiAgICAgIC8vIEFsc28gYWRkIGxpbmtzIHRvIGFsbCBmb3JlaWduIHJlbGF0ZWQgaXRlbXM6XG4gICAgICBmb3IgKGNvbnN0IGdyYXBoIG9mIGdyYXBocykge1xuICAgICAgICBjb25zdCBmb3JlaWduSXRlbXM6IERvY3VtZW50W10gPSBpdGVtW2dyYXBoXTtcbiAgICAgICAgaWYgKGZvcmVpZ25JdGVtcykge1xuICAgICAgICAgIGZvcmVpZ25JdGVtcy5mb3JFYWNoKGRvYyA9PiB7XG4gICAgICAgICAgICBici5saW5rMih0YWJsZSwgaXRlbS5pZCwgZ3JhcGgsIGRvYy5pZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyLmFkZCh0YWJsZSwgaXRlbSk7XG4gICAgfVxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNsaWVudC5iYXRjaChici5tdXRhdGlvblJlcXVlc3RzKS5jYXRjaChlID0+IHtcbiAgICAgIGlmIChvcHRpbWlzdGljKSB0aGlzLm1lbS5kZWxldGUoaXRlbXMubWFwKGl0ZW0gPT4gaXRlbS5pZCkpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICAgIH0pXG4gICAgdGhpcy5yZWdlbmVyYXRlQ2FjaGVCdXN0KCk7XG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IGl0ZW0uJGV0YWcgPSByZXMubmV3RXRhZ3NbaXRlbS5pZF0pO1xuICAgIGlmIChvcHRpbWlzdGljKVxuICAgICAgYXdhaXQgdGhpcy5tZW0udXBkYXRlKGl0ZW1zKTsgLy8gVXBkYXRlIHdpdGggbmV3ICRldGFnLlxuICAgIGVsc2VcbiAgICAgIGF3YWl0IHRoaXMubWVtLmluc2VydChpdGVtcyk7XG4gIH1cblxuICBhc3luYyBkZWxldGUgKGlkczogc3RyaW5nW10pIHtcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZX0gPSB0aGlzLm9wdGlvbnM7XG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XG4gICAgaWYgKG9wdGltaXN0aWMpIGF3YWl0IHRoaXMubWVtLnVwZGF0ZShpZHNcbiAgICAgIC5tYXAoaWQgPT4gdGhpcy5tZW0uaXRlbXMuZmluZCh4ID0+IHguaWQgPT09IGlkKSlcbiAgICAgIC5maWx0ZXIoeCA9PiB4KVxuICAgICAgLm1hcCh4ID0+IE9iamVjdC5hc3NpZ24oe30sIHgsIHskbWV0YTogJ2RlbGV0aW5nJ30pKSk7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgY2xpZW50LmRvIChiciA9PiBpZHMuZm9yRWFjaChpZCA9PiBici5kZWxldGUodGFibGUsIGlkKSkpLmNhdGNoKGFzeW5jIGUgPT4ge1xuICAgICAgaWYgKG9wdGltaXN0aWMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5tZW0udXBkYXRlKGlkc1xuICAgICAgICAgIC5tYXAoaWQgPT4gdGhpcy5tZW0uaXRlbXMuZmluZCh4ID0+IHguaWQgPT09IGlkKSlcbiAgICAgICAgICAuZmlsdGVyKHggPT4geClcbiAgICAgICAgICAubWFwKHggPT4ge1xuICAgICAgICAgICAgeCA9IE9iamVjdC5hc3NpZ24oe30sIHgpO1xuICAgICAgICAgICAgZGVsZXRlIHguJG1ldGE7XG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlO1xuICAgIH0pO1xuICAgIHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xuICAgIGF3YWl0IHRoaXMubWVtLmRlbGV0ZShpZHMpO1xuICB9XG59XG4iLCJcblxuZXhwb3J0IGludGVyZmFjZSBSZXBvQ29tbXVuaWNhdG9yPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcbiAgcXVlcnkoKTogUHJvbWlzZTxUW10+O1xufVxuXG50eXBlIFN1YnNjcmliZXI8VD4gPSAoaXRlbXM6VFtdLCBlcnJvcjogdW5kZWZpbmVkIHwgRXJyb3IpID0+IGFueTtcblxuZXhwb3J0IGNsYXNzIFJlcG88VCBleHRlbmRzIHtpZDogc3RyaW5nfT4ge1xuICBsaXN0UHJvbWlzZTogUHJvbWlzZTx2b2lkPjtcbiAgaXRlbXM6IFRbXTtcbiAgZXJyb3I/OiBFcnJvcjtcbiAgc3Vic2NyaWJlcnM6IFN1YnNjcmliZXI8VD5bXTtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgY29tbTogUmVwb0NvbW11bmljYXRvcjxUPikge1xuICAgIHRoaXMubGlzdFByb21pc2UgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBudWxsO1xuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcbiAgfVxuXG4gIHN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcbiAgICAgIHN1YnNjcmliZXIodGhpcy5pdGVtcywgdGhpcy5lcnJvcik7XG4gICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XG4gICAgfSk7XG4gIH1cblxuICB1bnN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycyA9IHRoaXMuc3Vic2NyaWJlcnMuZmlsdGVyIChzID0+IHMgIT09IHN1YnNjcmliZXIpO1xuICB9XG5cbiAgbm90aWZ5U3Vic2NyaWJlcnMoKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHMgPT4gcyh0aGlzLml0ZW1zLCB0aGlzLmVycm9yKSk7XG4gIH1cblxuICBlbnN1cmVIYXNEYXRhKCkge1xuICAgIGlmICghdGhpcy5saXN0UHJvbWlzZSkgdGhpcy5yZWZyZXNoRnJvbVNlcnZlcigpO1xuICAgIHJldHVybiB0aGlzLmxpc3RQcm9taXNlO1xuICB9XG5cbiAgcmVmcmVzaEZyb21TZXJ2ZXIoKSB7XG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IHRoaXMuY29tbS5xdWVyeSgpLnRoZW4oaXRlbXMgPT4ge1xuICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMgfHwgW107XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMubGlzdFByb21pc2U7XG4gIH1cbiAgXG4gIGFzeW5jIHVwZGF0ZShpdGVtOiBUIHwgVFtdKSB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVIYXNEYXRhKCk7XG4gICAgY29uc3QgdXBkYXRlZEl0ZW1zID0gQXJyYXkuaXNBcnJheShpdGVtKSA/IGl0ZW0gOiBbaXRlbV07XG4gICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMubWFwKGl0ID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0gdXBkYXRlZEl0ZW1zLmZpbmQoKHtpZH0pID0+IGl0LmlkID09PSBpZCk7XG4gICAgICByZXR1cm4gdXBkYXRlZEl0ZW0gP1xuICAgICAgICBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkSXRlbSkgOlxuICAgICAgICBpdDtcbiAgICB9KTtcbiAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gIH1cblxuICBpbnNlcnQoaXRlbTogVCB8IFRbXSkge1xuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XG4gICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcy5jb25jYXQoaXRlbSk7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGUoaWQ6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgaWRzID0gQXJyYXkuaXNBcnJheShpZCkgPyBpZCA6IFtpZF07XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLmZpbHRlcihpdCA9PiAhaWRzLnNvbWUoaWQgPT4gaXQuaWQgPT09IGlkKSk7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi9rZWQtcmVwbyc7XG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlXCI7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcywgS2VkQmFja2VuZENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IGdldEFkanVzdGVkV2VlaywgS0VEV2VlayB9IGZyb20gJy4uL3V0aWxzL3dlZWt1dGlsJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5cbmV4cG9ydCBsZXQgdXNlclRhc2tzUmVwbyA9IGVudi51c2VyVGFza3NSZXBvIGFzIFVzZXJUYXNrc1JlcG87XG5cbmV4cG9ydCBjbGFzcyBVc2VyVGFza3NSZXBvIGV4dGVuZHMgS2VkUmVwbzxVc2VyVGFzaz4ge1xuICBwZXJzaXN0ZWRTdGF0ZTogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB8IG51bGw7XG4gIGdldEN1cnJlbnRVc2VyOiAoKT0+VXNlcjtcblxuICBjb25zdHJ1Y3RvcihnZXRDbGllbnQ6ICgpPT5LZWRCYWNrZW5kQ2xpZW50LCBnZXRDdXJyZW50VXNlcjogKCk9PlVzZXIpIHsgICAgXG4gICAgc3VwZXIoe1xuICAgICAgZ2V0Q2xpZW50LFxuICAgICAgb3B0aW1pc3RpYzogdHJ1ZSxcbiAgICAgIHRhYmxlOiBcInVzZXJ0YXNrc1wiLFxuICAgICAgdXNlcjogZ2V0Q3VycmVudFVzZXIoKSA/IGdldEN1cnJlbnRVc2VyKCkubWFpbCA6IFwiXCIsXG4gICAgICBnZXRRdWVyeU9wdGlvbnM6IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xuICAgICAgICBjb25zdCB1c2VyRW1haWwgPSBjdXJyZW50VXNlciA/IGN1cnJlbnRVc2VyLm1haWwgOiBcIlwiO1xuICAgICAgICBpZiAoIXRoaXMucGVyc2lzdGVkU3RhdGUpXG4gICAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh1c2VyRW1haWwpO1xuICAgICAgICBjb25zdCB7IHdlZWtEYXRlIH0gPSB0aGlzLnBlcnNpc3RlZFN0YXRlO1xuICAgICAgICBjb25zdCB3ZWVrTnVtYmVyID0gbW9tZW50KHdlZWtEYXRlKS53ZWVrKCk7XG4gICAgICAgIGNvbnN0IGtlZFdlZWsgPSBLRURXZWVrKG1vbWVudCh3ZWVrRGF0ZSkueWVhcigpLCB3ZWVrTnVtYmVyKTtcbiAgICAgICAgLypjb25zdCBbZnJvbSwgdG9dID0gW21vbWVudCh3ZWVrRGF0ZSkuc3RhcnRPZignd2VlaycpLCBtb21lbnQod2Vla0RhdGUpLmVuZE9mKCd3ZWVrJyldXG4gICAgICAgICAgLm1hcChtID0+IG0udG9EYXRlKCkuZ2V0VGltZSgpKTsqL1xuICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZnJvbToga2VkV2Vlay5ub3RCZWZvcmUsXG4gICAgICAgICAgICB0bzoga2VkV2Vlay5ub3RBZnRlcixcbiAgICAgICAgICAgIHJvbGU6IFwiVVNFUlwiLFxuICAgICAgICAgICAgaW5jbHVkZTogW1widGFza1wiLCBcImNvdXJzZVwiXSxcbiAgICAgICAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IG51bGw7XG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9IGdldEN1cnJlbnRVc2VyO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlUGVyc2lzdGVkU3RhdGUoc3RhdGVDaGFuZ2VzOiBQYXJ0aWFsPFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGU+KSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnBlcnNpc3RlZFN0YXRlLCBzdGF0ZUNoYW5nZXMpO1xuICAgIGF3YWl0IHRoaXMucGVyc2lzdGVkU3RhdGUuc2F2ZSgpO1xuICAgIHRoaXMubWVtLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gIH1cblxuICBhc3luYyBzZXRUYXNrRG9uZVN0YXRlKHVzZXJUYXNrOiBVc2VyVGFzaywgZG9uZTogYm9vbGVhbikge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBjb25zdCBtb2RpZmllZEl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCB1c2VyVGFzaywge2RvbmV9KTtcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVkSXRlbSwgeyRtZXRhOiAndXBkYXRpbmcnfSkpO1xuICAgIC8vIE5vdyBtYWtlIHN1cmUgdG8gY2hhbmdlIHRoZSBzdGF0ZSBmb3Igb3RoZXIgd2Vla3MgYXMgd2VsbDpcbiAgICBjb25zdCBzaW1pbGFyVGFza3MgPSBhd2FpdCBjbGllbnQubGlzdDxVc2VyVGFzaz4oJ3VzZXJ0YXNrcycsIHtcbiAgICAgIG5hbWU6IHVzZXJUYXNrLm5hbWUsXG4gICAgICByb2xlOiBcIlVTRVJcIixcbiAgICAgIGluY2x1ZGU6IFtcInRhc2tcIixcImNvdXJzZVwiXSxcbiAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcbiAgICAgIGZyb206IG1vbWVudCh0aGlzLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlKS5hZGQoLTMsICd3ZWVrcycpLnZhbHVlT2YoKSxcbiAgICAgIHRvOiBtb21lbnQodGhpcy5wZXJzaXN0ZWRTdGF0ZS53ZWVrRGF0ZSkuYWRkKDMsICd3ZWVrcycpLnZhbHVlT2YoKVxuICAgIH0sIHtcbiAgICAgIGNhY2hlOiAnbm8tY2FjaGUnXG4gICAgfSk7XG4gICAgY29uc3QgaWRlbnRpY2FsVGFza3MgPSBzaW1pbGFyVGFza3MuZmlsdGVyKHQgPT5cbiAgICAgIHQuY291cnNlTmFtZSA9PT0gdXNlclRhc2suY291cnNlTmFtZSAmJlxuICAgICAgdC5sZWFybmluZ0dvYWwgPT09IHVzZXJUYXNrLmxlYXJuaW5nR29hbCAmJlxuICAgICAgKCF1c2VyVGFzay50YXNrIHx8IHQudGFzay5tYXAodD0+dC5pZCkuam9pbignJykgPT09IHVzZXJUYXNrLnRhc2subWFwKHQ9PnQuaWQpLmpvaW4oJycpKSAmJlxuICAgICAgKCF1c2VyVGFzay5jb3Vyc2UgfHwgdC5jb3Vyc2UubWFwKGM9PmMuaWQpLmpvaW4oJycpID09PSB1c2VyVGFzay5jb3Vyc2UubWFwKGM9PmMuaWQpLmpvaW4oJycpKSk7XG4gICAgaWYgKGlkZW50aWNhbFRhc2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgaXNzdWUgaW4gU3ViamVjdFBsYW5uZXIgbWlncmF0aW9uICh1c2VydGFza3Mgd2l0aCBsb25nIG5hbWVzIGlzIG5vdCBmb3VuZClcbiAgICAgIGlkZW50aWNhbFRhc2tzLnB1c2godXNlclRhc2spXG4gICAgfVxuICAgIGF3YWl0IHRoaXMudXBkYXRlKGlkZW50aWNhbFRhc2tzLCB0ID0+IHQuZG9uZSA9IGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgc2V0U3ViVGFza0RvbmVTdGF0ZSAodXNlclRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrSWQ6IHN0cmluZywgZG9uZTogYm9vbGVhbikge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZShbdXNlclRhc2tdLFxuICAgICAgdCA9PiB0LnN1YlRhc2tzICYmIHQuc3ViVGFza3MuZmlsdGVyKHN0ID0+IHN0LmlkID09PSBzdWJUYXNrSWQpXG4gICAgICAgIC5mb3JFYWNoKHN0ID0+IHN0LmRvbmUgPSBkb25lKSk7XG4gIH1cblxuICBhc3luYyBzZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZTogc3RyaW5nLCBpc09wZW46IGJvb2xlYW4pIHtcbiAgICBjb25zdCBvcGVuQ291cnNlcyA9IHsgLi4udGhpcy5wZXJzaXN0ZWRTdGF0ZS5vcGVuQ291cnNlcyB9O1xuICAgIGlmIChpc09wZW4pXG4gICAgICBvcGVuQ291cnNlc1tjb3Vyc2VOYW1lXSA9IHRydWU7XG4gICAgZWxzZVxuICAgICAgZGVsZXRlIG9wZW5Db3Vyc2VzW2NvdXJzZU5hbWVdO1xuICAgIGF3YWl0IHRoaXMudXBkYXRlUGVyc2lzdGVkU3RhdGUoe29wZW5Db3Vyc2VzfSk7XG4gIH1cblxuICBhc3luYyBjaGFuZ2VXZWVrKHdlZWtEYXRlOiBEYXRlKSB7XG4gICAgbGV0IHBlcnNpc3RlZFN0YXRlID0gdGhpcy5wZXJzaXN0ZWRTdGF0ZTtcbiAgICBpZiAoIXBlcnNpc3RlZFN0YXRlKSB7XG4gICAgICBwZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh0aGlzLm9wdGlvbnMudXNlcik7XG4gICAgfVxuICAgIGNvbnN0IG5ld1BlcnNpc3RlZCA9IG5ldyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKHBlcnNpc3RlZFN0YXRlKTtcbiAgICBuZXdQZXJzaXN0ZWQud2Vla0RhdGUgPSBtb21lbnQod2Vla0RhdGUpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XG4gICAgbmV3UGVyc2lzdGVkLnNhdmUoKTtcbiAgICB0aGlzLnBlcnNpc3RlZFN0YXRlID0gbmV3UGVyc2lzdGVkO1xuICAgIGF3YWl0IHRoaXMubWVtLnJlZnJlc2hGcm9tU2VydmVyKCk7XG4gIH1cblxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcjogKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkU3RhdGU6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUsIHdlZWtUZXh0c1VUOiBVc2VyVGFzaykgPT4gdm9pZCkge1xuICAgIGNvbnN0IHByb3h5U3Vic2NyaWJlciA9ICh1c2VyVGFza3M6IFVzZXJUYXNrW10pID0+IHtcbiAgICAgIHN1YnNjcmliZXIoXG4gICAgICAgIHVzZXJUYXNrcy5maWx0ZXIodXQgPT4gIXV0LndlZWtUZXh0cyksXG4gICAgICAgIHRoaXMucGVyc2lzdGVkU3RhdGUsXG4gICAgICAgIHVzZXJUYXNrcy5maWx0ZXIodXQgPT4gISF1dC53ZWVrVGV4dHMpWzBdIHx8IHtcbiAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICAgIGRhdGVUaW1lOiB0aGlzLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlLFxuICAgICAgICAgIHdlZWtUZXh0czoge2Fzc2Vzc21lbnQ6JycsIHN0cmF0ZWd5OicnfSxcbiAgICAgICAgICBhY2w6IFtcbiAgICAgICAgICAgIC8vIERlZmF1bHQgQUNMOiBMZXQgdXNlciBzZWxmIGhhdmUgZnVsbCBjb250cm9sIG92ZXIgdGhpcyBpdGVtOlxuICAgICAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwiZW1haWxcIiwgdGhpcy5nZXRDdXJyZW50VXNlcigpLm1haWwsIFwiU1wiKSxcbiAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgQUNMOiBMZXQgZW1wbG95ZWVzIG9uIHNhbWUgc2Nob29sIGhhdmUgcmVhZCBhY2Nlc3MgdG8gaXQuXG4gICAgICAgICAgICAvLyBUaGlzIGN1cnJlbnRseSBvbmx5IGFwcGxpZXMgdG8gdGFza3MgdGhhdCByZWZlciB0byBjb3Vyc2UgdGFza3MgKG5vdCBvd24gdGFza3MhKVxuICAgICAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwic2Nob29sUm9sZVwiLCBgJHt0aGlzLmdldEN1cnJlbnRVc2VyKCkuc2Nob29sfS9FTVBMT1lFRWAsIFwiUlwiKVxuICAgICAgICAgIF0ubWFwKGFjID0+IGFjLnRvU3RyaW5nKCkpXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcHJveHlTdWJzY3JpYmVyW1wic3Vic2NyaWJlclwiXSA9IHN1YnNjcmliZXI7XG4gICAgdGhpcy5tZW0uc3Vic2NyaWJlKHByb3h5U3Vic2NyaWJlcik7XG4gIH1cblxuICB1bnN1YnNjcmliZShzdWJzY3JpYmVyOiAodXNlclRhc2tzOiBVc2VyVGFza1tdLCBwZXJzaXN0ZWRTdGF0ZTogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSwgd2Vla1RleHRzVVQ6IFVzZXJUYXNrKSA9PiB2b2lkKSB7XG4gICAgdGhpcy5tZW0uc3Vic2NyaWJlcnMgPSB0aGlzLm1lbS5zdWJzY3JpYmVycy5maWx0ZXIgKHMgPT4gc1tcInN1YnNjcmliZXJcIl0gIT09IHN1YnNjcmliZXIpO1xuICB9XG4gIFxufVxuXG5pZiAoIXVzZXJUYXNrc1JlcG8pIHtcbiAgdXNlclRhc2tzUmVwbyA9IGVudi51c2VyVGFza3NSZXBvID0gbmV3IFVzZXJUYXNrc1JlcG8oXG4gICAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxuICAgICgpPT5lbnYuY3VycmVudFVzZXIpO1xuICB1c2VyVGFza3NSZXBvLm1lbS5lbnN1cmVIYXNEYXRhKCk7XG59XG4iLCJpbXBvcnQge1VzZXJ9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcblxuZXhwb3J0IGNvbnN0IHVzZXJzIDogVXNlcltdID0gW3tcbiAgICBkaXNwbGF5TmFtZTogXCJBZG1pbmlzdHJhdMO2clwiLFxuICAgIG1haWw6IFwidmVtZW5kb0BrZWRzY2hvb2xzLmNvbVwiLFxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnXSxcbiAgICBzY2hvb2w6ICdLRUQnLFxuICAgIHVzZXJuYW1lOiBcImFkbWluXCJcbn0se1xuICAgIGRpc3BsYXlOYW1lOiBcIkRhdmlkXCIsXG4gICAgbWFpbDogXCJkYXZpZC5mYWhsYW5kZXJAdmVtZW5kby5zZVwiLFxuICAgIHJvbGVzOiBbJ0FETUlOJywnRU1QTE9ZRUUnXSxcbiAgICBzY2hvb2w6ICdLRUQnLFxuICAgIHVzZXJuYW1lOiBcImRhdmlkXCJcbn0se1xuICAgIGRpc3BsYXlOYW1lOiBcIlRlc3QtTGl2ZS1FbGV2MVwiLFxuICAgIG1haWw6IFwidWJ3Njc1N0BlZHUua3Vuc2thcHNneW1uYXNpZXQuc2VcIixcbiAgICByb2xlczogWydTVFVERU5UJ10sXG4gICAgc2Nob29sOiAnVXBwc2FsYScsXG4gICAgdXNlcm5hbWU6IFwidWJ3Njc1N0BlZHUua3Vuc2thcHNneW1uYXNpZXQuc2VcIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXYyXCIsXG4gICAgbWFpbDogXCJ1bXM0MzAyQGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcbiAgICBzY2hvb2w6ICdVcHBzYWxhJyxcbiAgICB1c2VybmFtZTogXCJ1bXM0MzAyQGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiXG59LHtcbiAgICBkaXNwbGF5TmFtZTogXCJUZXN0LUxpdmUtRWxldjNcIixcbiAgICBtYWlsOiBcInVoaDM0NjBAZWR1Lmt1bnNrYXBzZ3ltbmFzaWV0LnNlXCIsXG4gICAgcm9sZXM6IFsnU1RVREVOVCddLFxuICAgIHNjaG9vbDogJ1VwcHNhbGEnLFxuICAgIHVzZXJuYW1lOiBcInVoaDM0NjBAZWR1Lmt1bnNrYXBzZ3ltbmFzaWV0LnNlXCJcbn0se1xuICAgIGRpc3BsYXlOYW1lOiBcIlRlc3QtTGl2ZS1FbGV2NChmZWwgZ29hbHMgaXNzdWUpXCIsXG4gICAgbWFpbDogXCJ1bXQ2ODI2QGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiLFxuICAgIHJvbGVzOiBbXCJTVFVERU5UXCJdLFxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXG4gICAgdXNlcm5hbWU6IFwidW10NjgyNkBlZHUua3Vuc2thcHNza29sYW4uc2VcIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXY1KGZ1dHVyZSBhYmlsaXRpZXMpXCIsXG4gICAgbWFpbDogXCJ1amczODMzQGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiLFxuICAgIHJvbGVzOiBbXCJTVFVERU5UXCJdLFxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXG4gICAgdXNlcm5hbWU6IFwidWpnMzgzM0BlZHUua3Vuc2thcHNza29sYW4uc2VcIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUVsZXY2KGZ1dHVyZSBhYmlsaXRpZXMpXCIsXG4gICAgbWFpbDogXCJ1anQxMzYzQGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiLFxuICAgIHJvbGVzOiBbXCJTVFVERU5UXCJdLFxuICAgIHNjaG9vbDogXCJVcHBzYWxhXCIsXG4gICAgdXNlcm5hbWU6IFwidWp0MTM2M0BlZHUua3Vuc2thcHNza29sYW4uc2VcIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiVGVzdC1MaXZlLUzDpHJhcmUxXCIsXG4gICAgbWFpbDogXCJyaWNrYXJkLmFsYmVydHNzb25Aa3Vuc2thcHNneW1uYXNpZXQuc2VcIixcbiAgICByb2xlczogWydFTVBMT1lFRSddLFxuICAgIHNjaG9vbDogJ1VwcHNhbGEnLFxuICAgIHVzZXJuYW1lOiBcInJpY2thcmQuYWxiZXJ0c3NvbkBrdW5za2Fwc2d5bW5hc2lldC5zZVwiXG59LHtcbiAgICBkaXNwbGF5TmFtZTogXCJFRFNUZXN0VXNlckd5bW5hc2l1bVwiLFxuICAgIG1haWw6IFwidWhoMzIwMEBlZHUua3Vuc2thcHNneW1uYXNpZXQuc2VcIixcbiAgICAvL21haWw6IFwiVUhIMzIwMEBFRFUuS1VOU0tBUFNHWU1OQVNJRVQuU0VcIixcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcbiAgICB1c2VybmFtZTogXCJFRFNUZXN0VXNlcjFcIixcbiAgICBzY2hvb2w6IFwiS0VEXCIsXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwidmVtZW5kby5lbGV2QGtlZHNjaG9vbHMuY29tXCIsXG4gICAgbWFpbDogXCJ2ZW1lbmRvLmVsZXZAa2Vkc2Nob29scy5jb21cIixcbiAgICByb2xlczogW1wiU1RVREVOVFwiXSxcbiAgICB1c2VybmFtZTogXCJ2ZW1lbmRvLmVsZXZAa2Vkc2Nob29scy5jb21cIixcbiAgICBzY2hvb2w6IFwiS0VEXCIsXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiTWVkYXJiZXRhcmUgTmFja2FcIixcbiAgICBtYWlsOiBcIm1lZGFyYmV0YXJlLm5hY2thQGt1bnNrYXBzc2tvbGFuLnNlXCIsXG4gICAgcm9sZXM6IFtcIkVNUExPWUVFXCJdLFxuICAgIHVzZXJuYW1lOiBcIm1lZGFyYmV0YXJlLm5hY2thL0tTXCIsXG4gICAgc2Nob29sOiBcIk5hY2thXCIsXG4gICAgc2Nob29sVHlwZTogXCJHcnVuZHNrb2xvclwiXG59LHtcbiAgICBkaXNwbGF5TmFtZTogXCJNZWRhcmJldGFyZSBHbG9iZW5cIixcbiAgICBtYWlsOiBcIm1lZGFyYmV0YXJlLmdsb2JlbkBrdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxuICAgIHJvbGVzOiBbXCJFTVBMT1lFRVwiXSxcbiAgICB1c2VybmFtZTogXCJtZWRhcmJldGFyZS5nbG9iZW4vS1NcIixcbiAgICBzY2hvb2w6IFwiR2xvYmVuXCIsXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiRWxldiBHbG9iZW5cIixcbiAgICBtYWlsOiBcImVsZXYuZ2xvYmVuQGVkdS5rdW5za2Fwc2d5bW5hc2lldC5zZVwiLFxuICAgIHNjaG9vbEdyYWRlOiAyLFxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcbiAgICB1c2VybmFtZTogXCJlbGV2Lmdsb2JlblwiLFxuICAgIHNjaG9vbDogXCJHbG9iZW5cIixcbiAgICBzY2hvb2xUeXBlOiBcIkd5bW5hc2l1bVwiXG59LHtcbiAgICBkaXNwbGF5TmFtZTogXCJFbGV2IEJvcsOlc1wiLFxuICAgIG1haWw6IFwiZWxldi5ib3Jhc0BlZHUua3Vuc2thcHNza29sYW4uc2VcIixcbiAgICBzY2hvb2xHcmFkZTogNyxcbiAgICByb2xlczogWydTVFVERU5UJ10sXG4gICAgdXNlcm5hbWU6IFwiZWxldi5ib3Jhc1wiLFxuICAgIHNjaG9vbDogXCJCb3LDpXNcIixcbiAgICBzY2hvb2xUeXBlOiBcIkdydW5kc2tvbG9yXCJcbn0se1xuICAgIGRpc3BsYXlOYW1lOiBcIkVsZXYgQm9ybMOkbmdlXCIsXG4gICAgbWFpbDogXCJlbGV2LmJvcmxhbmdlQGVkdS5rdW5za2Fwc3Nrb2xhbi5zZVwiLFxuICAgIHNjaG9vbEdyYWRlOiA5LFxuICAgIHJvbGVzOiBbJ1NUVURFTlQnXSxcbiAgICB1c2VybmFtZTogJ2VsZXYuYm9ybGFuZ2UvS1MnLFxuICAgIHNjaG9vbDogJ0JvcmzDpG5nZScsXG4gICAgc2Nob29sVHlwZTogXCJHeW1uYXNpdW1cIlxufSx7XG4gICAgZGlzcGxheU5hbWU6IFwiUm9sbC1sw7ZzXCIsXG4gICAgbWFpbDogXCJub25lQGt1bnNrYXBzc2tvbGFuLnNlXCIsXG4gICAgdXNlcm5hbWU6IFwibm9uZVwiLFxuICAgIHJvbGVzOiBbXVxufV07XG5cbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IHVzZXJzIH0gZnJvbSAnLi9kYXRhL3VzZXJzJztcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcgfSBmcm9tICcuLi91dGlscy9xdWVyeS1zdHJpbmcnO1xuXG5jb25zdCB1c2VybmFtZSA9IHBhcnNlUXVlcnlTdHJpbmcgKGxvY2F0aW9uLnNlYXJjaCkudXNlcjtcbmlmICh1c2VybmFtZSkge1xuICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCh1ID0+IHUudXNlcm5hbWUgPT09IHVzZXJuYW1lKTtcbiAgaWYgKHVzZXIpIHtcbiAgICBlbnYuY3VycmVudFVzZXIgPSB1c2VyO1xuICB9XG59XG5cbmNvbnN0IHsgcm9sZSwgc2Nob29sIH0gPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XG5pZiAoZW52LmN1cnJlbnRVc2VyKSB7XG4gIGlmIChyb2xlKSB7XG4gICAgZW52LmN1cnJlbnRVc2VyLnJvbGVzID0gcm9sZS5zcGxpdCgnLCcpO1xuICB9XG4gIGlmIChzY2hvb2wpIHtcbiAgICBlbnYuY3VycmVudFVzZXIuc2Nob29sID0gc2Nob29sO1xuICB9XG59XG4iLCIvLyA8SW5pdGlhbGl6YXRpb24+XG5pbXBvcnQgJy4vc2V0LWN1cnJlbnQtdXNlcic7IC8vIEVtdWxhdGUgc2VydmVyLXNpZGUgc2NyaXB0IHRvIHNldCBjdXJyZW50IHVzZXJcbmltcG9ydCAnLi4vZ2xvYmFsLXNldHRlcnMvc2V0LWFsbCc7IC8vIENsaWVudC1zaWRlIGluaXRpYWxpemF0aW9uXG4vLyA8L0luaXRpYWxpemF0aW9uPlxuXG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDaG9vc2VVc2VyIH0gZnJvbSAnLi91dGlscy9jaG9vc2UtdXNlcic7XG5pbXBvcnQgeyBDb3Vyc2VWaWV3ZXIgfSBmcm9tICcuLi9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXInO1xuaW1wb3J0IHsgaW5jbHVkZUNTUyB9IGZyb20gJy4vdXRpbHMvaW5jbHVkZS1jc3MnO1xuaW1wb3J0IHsgaW5jbHVkZU9wdGlvbmFsQ1NTIH0gZnJvbSAnLi4vdXRpbHMvaW5jbHVkZS1vcHRpb25hbC1jc3MnO1xuXG5pbmNsdWRlT3B0aW9uYWxDU1Moe1xuICB2MTogW1xuICAgICdjc3MvY291cnNldmlld2VyLmNzcycsXG4gICAgJ2Nzcy9kaWFsb2cuY3NzJyxcbiAgICAnY3NzL2dyaWQtY3NzLXBhdGNoLmNzcydcbiAgXSxcbiAgaW5jbHVkZUNTUyxcbiAgdmVyc2lvbjogNixcbiAgdmVyc2lvbkZvbGRlcjogJ2Nzcy9kZWx0YS1jc3MvY291cnNldmlld2VyJ1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxhbnk+IHtcbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiBlbnYuY3VycmVudFVzZXIgP1xuICAgICAgPENvdXJzZVZpZXdlciBjb3Vyc2VCdWlsZGVyVXJsPVwiY291cnNlYnVpbGRlci5odG1sXCIgLz4gOlxuICAgICAgPENob29zZVVzZXIgLz5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlcnMgfSBmcm9tICcuLi9kYXRhL3VzZXJzJztcblxuZXhwb3J0IGZ1bmN0aW9uIENob29zZVVzZXIoKSB7XG4gIGxldCBzZWxlY3Q7XG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dFwiPlxuICAgIDxoMj5Ww6RsaiBhbnbDpG5kYXJlPC9oMj5cbiAgICA8dGFibGUgY2xhc3NOYW1lPVwibG9naW4tdGFibGVcIj48dGhlYWQ+PHRyPlxuICAgICAgPHRoPk5hbW48L3RoPlxuICAgICAgPHRoPlJvbGxlcjwvdGg+XG4gICAgICA8dGg+RS1wb3N0PC90aD5cbiAgICAgIDx0aD5Ta29sYTwvdGg+XG4gICAgPC90cj48L3RoZWFkPlxuICAgICAgPHRib2R5PlxuICAgICAgICB7dXNlcnMubWFwKCh7IHVzZXJuYW1lLCBkaXNwbGF5TmFtZSwgbWFpbCwgc2Nob29sLCByb2xlcyB9KSA9PlxuICAgICAgICAgIDx0ciBrZXk9e21haWx9IG9uQ2xpY2s9eygpID0+IGxvY2F0aW9uLnNlYXJjaCA9IGA/dXNlcj0ke3VzZXJuYW1lfWB9PlxuICAgICAgICAgICAgPHRkPntkaXNwbGF5TmFtZX08L3RkPlxuICAgICAgICAgICAgPHRkIHN0eWxlPXtyb2xlcy5sZW5ndGggPT09IDAgPyB7IGZvbnRTdHlsZTogJ2l0YWxpYycgfSA6IHt9fT57cm9sZXMubGVuZ3RoID09PSAwID8gXCJzYWtuYXIgcm9sbGVyXCIgOiByb2xlcy5qb2luKCcsICcpfTwvdGQ+XG4gICAgICAgICAgICA8dGQ+e21haWx9PC90ZD5cbiAgICAgICAgICAgIDx0ZCBzdHlsZT17c2Nob29sID8ge30gOiB7IGZvbnRTdHlsZTogJ2l0YWxpYycgfX0+e3NjaG9vbCB8fCBcInNha25hciBza29sYVwifTwvdGQ+XG4gICAgICAgICAgPC90cj5cbiAgICAgICAgKX1cbiAgICAgIDwvdGJvZHk+PC90YWJsZT5cbiAgPC9kaXY+XG59O1xuIiwiZnVuY3Rpb24gcmVzb2x2ZSh1cmk6IHN0cmluZykge1xuICB2YXIgaHJlZiA9IGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lO1xuICB2YXIgcExhc3RTbGFzaCA9IGhyZWYubGFzdEluZGV4T2YoJy8nKTtcbiAgcmV0dXJuIGhyZWYuc3Vic3RyKDAsIHBMYXN0U2xhc2ggKyAxKSArIHVyaTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluY2x1ZGVDU1MoY3NzRmlsZTogc3RyaW5nKSB7XG4gIGRvY3VtZW50LndyaXRlKCc8bGluayByZWw9XCJzdHlsZXNoZWV0XCIgaHJlZj1cIicrcmVzb2x2ZShjc3NGaWxlKSsnXCIgLz4nKTsgIFxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtMfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7ZGJ9IGZyb20gJy4uL2dsb2JhbHMvZGInO1xuaW1wb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5pbXBvcnQgeyBSZW1vdmVJdGVtIH0gZnJvbSAnLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XG5cblxuaW50ZXJmYWNlIFByb3BzIHtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgZXJyb3JzOiBFcnJvclN0cnVjdFtdO1xuICBpbmZvczogc3RyaW5nW107XG4gIC8vZGJXcml0ZXJSZXRyeWFibGVFcnJvcj86IEVycm9yO1xuICBkYldyaXRlcklzU2F2aW5nPzogYm9vbGVhbjtcbiAgZGJXcml0ZXJJc0VkaXRlZD86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBFcnJvclN0cnVjdCB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgcmV0cnlhYmxlPzogYm9vbGVhbjtcbiAgZGV0YWlscz86IEVycm9yO1xuICBzaG93RGV0YWlscz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFcnJvclN1Y2Nlc3NGZWVkYmFjayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGU9e1xuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIGluZm9zOiBbXVxuICAgIH07XG4gICAgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uID0gdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fZXJyb3IgPSB0aGlzLl9lcnJvci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2N1c3RvbUVycm9yID0gdGhpcy5fY3VzdG9tRXJyb3IuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkluZm8gPSB0aGlzLl9vbkluZm8uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9kYldyaXRlckVycm9yID0gdGhpcy5fZGJXcml0ZXJFcnJvci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkID0gdGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIHByaXZhdGUgX2FkZEVycm9yKG1lc3NhZ2U6IHN0cmluZywgZGV0YWlscz86IEVycm9yLCByZXRyeWFibGU/OiBib29sZWFuKSB7XG4gICAgLy9jb25zb2xlLmVycm9yKG1lc3NhZ2UsIHtyZXRyeWFibGU6ICEhcmV0cnlhYmxlLCBkZXRhaWxzfSk7XG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+IHtcbiAgICAgIGlmIChlcnJvcnMuc29tZShlID0+IGUubWVzc2FnZSA9PT0gbWVzc2FnZSkpIHJldHVybiB7ZXJyb3JzfTtcbiAgICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMikgZXJyb3JzID0gZXJyb3JzLnNsaWNlKDEpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyb3JzOiBlcnJvcnMuY29uY2F0KFt7bWVzc2FnZSwgZGV0YWlscywgcmV0cnlhYmxlfV0pXG4gICAgICB9O1xuICAgIH0pO1xuICAgIC8vIFJlbW92ZSBub24tcmV0cnlhYmxlIGVycm9ycyBhZnRlciAzMCBzZWNvbmRzOlxuICAgIGlmICghcmV0cnlhYmxlKSBzZXRUaW1lb3V0KCgpPT57XG4gICAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtcbiAgICAgICAgZXJyb3JzOiBlcnJvcnMuZmlsdGVyKGUgPT4gZS5tZXNzYWdlICE9PSBtZXNzYWdlKVxuICAgICAgfSkpO1xuICAgIH0sIDMwMDAwKTtcbiAgfVxuXG4gIHByaXZhdGUgX2FkZEluZm8obWVzc2FnZTogc3RyaW5nKSB7XG4gICAgaWYgKG1lc3NhZ2UgPT09IFwiXCIpIHtcbiAgICAgIC8vIFR1cm4gb2ZmIGN1cnJlbnQgaW5mbyBtZXNzYWdlc1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7aW5mb3M6IFtdfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoKHtpbmZvc30pID0+IHtcbiAgICAgIGlmIChpbmZvcy5zb21lKGluZm8gPT4gaW5mbyA9PT0gbWVzc2FnZSkpIHJldHVybiB7aW5mb3N9O1xuICAgICAgaWYgKGluZm9zLmxlbmd0aCA+IDIpIGluZm9zID0gaW5mb3Muc2xpY2UoMSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmZvczogaW5mb3MuY29uY2F0KG1lc3NhZ2UpXG4gICAgICB9O1xuICAgIH0pO1xuICAgIC8vIFJlbW92ZSBpbmZvIG1lc3NhZ2UgYWZ0ZXIgMTAgc2Vjb25kczpcbiAgICBzZXRUaW1lb3V0KCgpPT57XG4gICAgICB0aGlzLnNldFN0YXRlKCh7aW5mb3N9KSA9PiAoe1xuICAgICAgICBpbmZvczogaW5mb3MuZmlsdGVyKG1zZyA9PiBtc2cgIT09IG1lc3NhZ2UpXG4gICAgICB9KSk7XG4gICAgfSwgMTAwMDApO1xuICB9XG5cbiAgcHJpdmF0ZSBfZGJXcml0ZXJFcnJvciAoZXJyb3I6IEVycm9yLCByZXRyeWFibGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9hZGRFcnJvcihgRGV0IGfDpXIgaW50ZSBhdHQgc3BhcmEgdGlsbCBzZXJ2ZXJuYCwgZXJyb3IsIHJldHJ5YWJsZSk7XG4gIH1cblxuICBwcml2YXRlIF9kYldyaXRlclN0YXRlQ2hhbmdlZCAoe2lzRWRpdGVkLCBpc1NhdmluZ306IEtlZEJhY2tlbmRXcml0ZXIpIHtcbiAgICBpZiAoIWlzRWRpdGVkKSB7XG4gICAgICAvLyBJZiBpc0VkaXRlZCBpcyBmYWxzZSwgYSBzdWNjZXNzZnVsIHdyaXRlIG11c3QgaGF2ZSBoYXBwZW5lZCwgYW5kXG4gICAgICAvLyB0aGVyZSBjYW5ub3QgYmUgYW55IHJldHJ5YWJsZSBlcnJvciBhbnltb3JlXG4gICAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4ge1xuICAgICAgICBlcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGUgPT4gIWUucmV0cnlhYmxlKTtcbiAgICAgICAgcmV0dXJuIHtlcnJvcnN9O1xuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgZGJXcml0ZXJJc0VkaXRlZDogaXNFZGl0ZWQsXG4gICAgICBkYldyaXRlcklzU2F2aW5nOiBpc1NhdmluZ1xuICAgIH0pO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fZXJyb3IpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjdXN0b21lcnJvcicsIHRoaXMuX2N1c3RvbUVycm9yKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaW5mbycsIHRoaXMuX29uSW5mbyk7XG4gICAgZGIud3JpdGVyLm9uRXJyb3IodGhpcy5fZGJXcml0ZXJFcnJvcik7XG4gICAgZGIud3JpdGVyLm9uU3RhdGVDaGFuZ2UodGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3VuaGFuZGxlZHJlamVjdGlvbicsIHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbik7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fZXJyb3IpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdjdXN0b21lcnJvcicsIHRoaXMuX2N1c3RvbUVycm9yKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5mbycsIHRoaXMuX29uSW5mbyk7XG4gICAgZGIud3JpdGVyLm9mZih0aGlzLl9kYldyaXRlckVycm9yKTtcbiAgICBkYi53cml0ZXIub2ZmKHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkKTtcbiAgfVxuXG4gIF91bmhhbmRsZWRSZWplY3Rpb24gKGV2OiBFdmVudCAmIHtyZWFzb246IEVycm9yfSkge1xuICAgIHRoaXMuX2FkZEVycm9yKGBFdHQgb2vDpG50IGZlbCBpbnRyw6RmZmFkZS4uLmAsIGV2LnJlYXNvbik7XG4gIH1cblxuICBfZXJyb3IgKGV2OiBFdmVudCAmIHtlcnJvcjogRXJyb3J9KSB7XG4gICAgdGhpcy5fYWRkRXJyb3IoZXYuZXJyb3IgPyBldi5lcnJvci5tZXNzYWdlIDogYEV0dCBva8OkbnQgZmVsIGludHLDpGZmYWRlLi4uYCwgZXYuZXJyb3IpO1xuICB9XG5cbiAgX2N1c3RvbUVycm9yIChldjogQ3VzdG9tRXZlbnQpIHtcbiAgICB0aGlzLl9hZGRFcnJvcihldi5kZXRhaWwpO1xuICB9XG5cbiAgX29uSW5mbyhldjogQ3VzdG9tRXZlbnQpIHtcbiAgICB0aGlzLl9hZGRJbmZvKGV2LmRldGFpbCk7XG4gIH0gXG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtlcnJvcnMsIGluZm9zLCBkYldyaXRlcklzU2F2aW5nfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3Itc3VjY2Vzcy1mZWVkYmFja1wiIHN0eWxlPXt7XG4gICAgICBwb3NpdGlvbjogXCJmaXhlZFwiLFxuICAgICAgbGVmdDogMCxcbiAgICAgIHRvcDogMCxcbiAgICAgIHdpZHRoOiBcIjEwMCVcIixcbiAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJ1xuICAgIH19PlxuICAgICAgPGRpdiBzdHlsZT17e2Rpc3BsYXk6ICd0YWJsZScsIG1hcmdpbjogXCIwIGF1dG9cIn19PlxuICAgICAgICB7ZXJyb3JzLmZpbHRlcihlID0+ICFlLnJldHJ5YWJsZSB8fCAhZGJXcml0ZXJJc1NhdmluZylcbiAgICAgICAgLm1hcCgoe21lc3NhZ2UsIGRldGFpbHMsIHJldHJ5YWJsZSwgc2hvd0RldGFpbHN9KSA9PiAoXG4gICAgICAgICAgPGRpdiBrZXk9e21lc3NhZ2V9IGNsYXNzTmFtZT1cImVycm9yXCI+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6J2xlZnQnfX0+e21lc3NhZ2V9PC9kaXY+XG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7cG9pbnRlckV2ZW50czogJ2F1dG8nfX0+XG4gICAgICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9eygpPT50aGlzLnJlbW92ZUVycm9yKG1lc3NhZ2UpfSAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7ZGV0YWlscyB8fCByZXRyeWFibGUgPyA8ZGl2IHN0eWxlPXt7cG9pbnRlckV2ZW50czogJ2F1dG8nfX0+XG4gICAgICAgICAgICAgIHtkZXRhaWxzID8gPD48YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+dGhpcy50b2dnbGVEZXRhaWxzKG1lc3NhZ2UpfT57c2hvd0RldGFpbHMgPyBcIkTDtmxqIGRldGFpbGVyXCIgOiBcIlZpc2EgZGV0YWlsamVyXCJ9PC9hPiZuYnNwOzwvPiA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAge3Nob3dEZXRhaWxzID8gPHA+eycnK2RldGFpbHN9PC9wPjogPD4mbmJzcDs8Lz59XG4gICAgICAgICAgICAgIHtyZXRyeWFibGUgPyA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+dGhpcy5yZXRyeVNhdmUoKX0+RsO2cnPDtmsgc3BhcmEgbnU8L2E+IDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgPC9kaXY+OiB1bmRlZmluZWR9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkpfVxuICAgICAgICB7aW5mb3MubWFwKG1lc3NhZ2UgPT4gXG4gICAgICAgICAgPHAga2V5PXttZXNzYWdlfSBjbGFzc05hbWU9XCJpbmZvXCI+e21lc3NhZ2V9PC9wPlxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+O1xuICB9XG4gIHJlbW92ZUVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IGFueSB7XG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+ICh7XG4gICAgICBlcnJvcnM6IGVycm9ycy5maWx0ZXIoZSA9PiBlLm1lc3NhZ2UgIT09IG1lc3NhZ2UpXG4gICAgfSkpO1xuICB9XG5cbiAgcmV0cnlTYXZlKCkge1xuICAgIGRiLndyaXRlci5yZXRyeVNhdmUoKTtcbiAgfVxuXG4gIHRvZ2dsZURldGFpbHMobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+ICh7ZXJyb3JzOiBlcnJvcnMubWFwKGVycm9yID0+IGVycm9yLm1lc3NhZ2UgPT09IG1lc3NhZ2UgP1xuICAgICAge1xuICAgICAgICAuLi5lcnJvcixcbiAgICAgICAgc2hvd0RldGFpbHM6ICFlcnJvci5zaG93RGV0YWlsc1xuICAgICAgfSA6XG4gICAgICBlcnJvcilcbiAgICB9KSk7XG4gIH1cbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBpbmNsdWRlT3B0aW9uYWxDU1MgKHtcbiAgdjEsXG4gIHZlcnNpb25Gb2xkZXIsXG4gIHZlcnNpb24sXG4gIGluY2x1ZGVDU1MsXG4gIE5PQ1NTXG59OiB7djE/OiBzdHJpbmdbXSwgdmVyc2lvbkZvbGRlcj86IHN0cmluZywgdmVyc2lvbjogbnVtYmVyLCBpbmNsdWRlQ1NTOiAoZmlsZTogc3RyaW5nKSA9PiB2b2lkLCBOT0NTUz86IHN0cmluZ30pIHtcbiAgaWYgKCFOT0NTUykge1xuICAgIGlmICh2MSkgdjEuZm9yRWFjaChjc3NGaWxlID0+IGluY2x1ZGVDU1MoY3NzRmlsZSkpO1xuICB9XG4gIGxldCBjc3NWZXIgPSBwYXJzZUludChOT0NTUyk7XG4gIGlmIChpc05hTihjc3NWZXIpKSBjc3NWZXIgPSAxO1xuICBmb3IgKGxldCB2ZXIgPSBjc3NWZXIgKyAxOyB2ZXIgPD0gdmVyc2lvbjsgKyt2ZXIpIHtcbiAgICBpbmNsdWRlQ1NTKGAke3ZlcnNpb25Gb2xkZXJ9L3Yke3Zlcn0uY3NzYCk7XG4gIH1cbn1cbiIsIlxuZXhwb3J0IGNsYXNzIFBlbmRpbmdKb2Ige1xuICBwcml2YXRlIHRpbWVvdXRJZCA9IG51bGw7XG4gIHByaXZhdGUgY2FuY2VsbGVkID0gZmFsc2U7XG4gIHByaXZhdGUgcGVuZGluZyA9IGZhbHNlO1xuICBwcml2YXRlIGlzSm9iRXhlY3V0aW5nID0gZmFsc2U7XG4gIHByaXZhdGUgam9iQ2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT47XG4gIFxuICBjb25zdHJ1Y3RvcihjYWxsYmFjazogKCk9PlByb21pc2U8YW55Pikge1xuICAgIHRoaXMuam9iQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIHRyaWdnZXJDaGFuZ2UodGhyb3R0bGU6IG51bWJlcik6IGFueSB7XG4gICAgaWYgKHRoaXMuY2FuY2VsbGVkKSByZXR1cm47XG4gICAgdGhpcy5wZW5kaW5nID0gdHJ1ZTtcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgIHRoaXMudGltZW91dElkID0gc2V0VGltZW91dCgoKT0+dGhpcy5sYXVuY2hKb2IoKSwgdGhyb3R0bGUpO1xuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgIHRoaXMudGltZW91dElkID0gbnVsbDtcbiAgICB0aGlzLmNhbmNlbGxlZCA9IHRydWU7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxhdW5jaEpvYigpIHtcbiAgICBpZiAodGhpcy5jYW5jZWxsZWQpIHJldHVybjtcbiAgICBpZiAoIXRoaXMucGVuZGluZykgcmV0dXJuO1xuICAgIGlmICh0aGlzLmlzSm9iRXhlY3V0aW5nKSByZXR1cm47XG4gICAgdGhpcy50aW1lb3V0SWQgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgICAgYXdhaXQgdGhpcy5qb2JDYWxsYmFjaygpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLnBlbmRpbmcpXG4gICAgICBhd2FpdCB0aGlzLmxhdW5jaEpvYigpO1xuICB9XG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zIHtcbiAgdG9Mb3dlcj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uU2VhcmNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucyk6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0ge1xuICBjb25zdCB7dG9Mb3dlcn0gPSAob3B0aW9ucyB8fMKge30pIGFzIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zO1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgaWYgKGxvY2F0aW9uU2VhcmNoICYmIGxvY2F0aW9uU2VhcmNoLmxlbmd0aCA+IDEpXG4gICAgbG9jYXRpb25TZWFyY2guc3Vic3RyKDEpXG4gICAgICAuc3BsaXQoJyYnKVxuICAgICAgLm1hcChwYXJ0ID0+IHBhcnQuc3BsaXQoJz0nKS5tYXAocyA9PiBkZWNvZGVVUklDb21wb25lbnQocy50cmltKCkpKSlcbiAgICAgIC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHJlc3VsdFt0b0xvd2VyID8ga2V5LnRvTG93ZXJDYXNlKCkgOiBrZXldID0gdmFsdWUpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBlbmNvZGVQYXJhbXMocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhwYXJhbXMpLmZpbHRlcihrZXkgPT4gcGFyYW1zW2tleV0gIT09IHVuZGVmaW5lZCkubWFwKGtleSA9PiBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tleV0pfWApLmpvaW4oJyYnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlUXVlcnlTdHJpbmcocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBcIj9cIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VIYXNoUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucykge1xuICByZXR1cm4gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbkhhc2gsIG9wdGlvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVIYXNoUXVlcnlTdHJpbmcocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBcIiNcIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRVcmxBbmRRdWVyeSAodXJsV2l0aFBvc3NpYmxlUXVlcnk6IHN0cmluZykge1xuICBjb25zdCBwUXVlcnkgPSB1cmxXaXRoUG9zc2libGVRdWVyeS5pbmRleE9mKCc/Jyk7XG4gIHJldHVybiBwUXVlcnkgPj0gMCA/XG4gICAgW3VybFdpdGhQb3NzaWJsZVF1ZXJ5LnN1YnN0cigwLCBwUXVlcnkpLCB1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIocFF1ZXJ5KV0gOlxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeSwgXCJcIl07XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBUZXJtLCBBY2FkZW1pY1llYXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Nob29sTW9tZW50IHtcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XG4gIHRlcm06IFRlcm07XG4gIHdlZWs/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaXJzdEFuZExhc3RXZWVrT2ZUZXJtKHRlcm06IFRlcm0pIHtcbiAgcmV0dXJuIHRlcm0gPT09ICdBVCcgP1xuICAgIFszMiwgNTFdIDpcbiAgICBbMSwgMjVdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVybVN0YXJ0QW5kRW5kKG5vdzogbW9tZW50Lk1vbWVudCkgOiBtb21lbnQuTW9tZW50W10ge1xuICByZXR1cm4gbm93Lm1vbnRoKCkgPj0gNiA/IC8vIDYgPSBKdWx5IGluIEpTIERhdGVzIGFuZCBpbiBtb21lbnQgYXMgd2VsbCFcbiAgICBbbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDcsIDEpKSwgbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDExLCAzMSkpXSA6IC8vIGF1ZzEgLSBkZWMzMVxuICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMCwgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNiwgMzEpKV07IC8vIGphbjEgLSBqdWx5MzFcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjaG9vbE1vbWVudChtOiBtb21lbnQuTW9tZW50KTogU2Nob29sTW9tZW50IHtcbiAgY29uc3QgdGhpc1llYXIgPSBtLnllYXIoKTtcbiAgY29uc3QgaXNBdXR1bW4gPSBtLm1vbnRoKCkgPj0gNjtcbiAgY29uc3QgW2F1dHVtblllYXIsIHNwcmluZ1llYXJdID0gaXNBdXR1bW4gP1xuICAgIFt0aGlzWWVhciwgdGhpc1llYXIgKyAxXSA6XG4gICAgW3RoaXNZZWFyIC0gMSwgdGhpc1llYXJdO1xuICBjb25zdCBhY2FkZW1pY1llYXIgPSAnJyArIGF1dHVtblllYXIgKyAnLycgKyBzcHJpbmdZZWFyO1xuICBjb25zdCB0ZXJtID0gaXNBdXR1bW4gPyAnQVQnIDogJ1NUJztcbiAgY29uc3Qgd2VlayA9IG0ud2VlaygpO1xuICByZXR1cm4geyBhY2FkZW1pY1llYXIsIHRlcm0sIHdlZWsgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXIoYVllYXI6IEFjYWRlbWljWWVhciwgbnVtWWVhcnNUb0FkZDogbnVtYmVyKTogQWNhZGVtaWNZZWFyIHtcbiAgcmV0dXJuIGFZZWFyLnNwbGl0KCcvJylcbiAgICAubWFwKHllYXJTdHIgPT4gcGFyc2VJbnQoeWVhclN0cikgKyBudW1ZZWFyc1RvQWRkKVxuICAgIC5tYXAoeWVhciA9PiAnJyArIHllYXIpXG4gICAgLmpvaW4oJy8nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5leHRBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXZBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAtMSk7XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFNjaG9vbE1vbWVudCwgYWRkWWVhciB9IGZyb20gJy4vc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgeyBBY2FkZW1pY1llYXIsIFRlcm0gfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5cbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcblxuZnVuY3Rpb24gaXNTY2hvb2xNb21lbnQob2JqOiBEYXRlIHwgU2Nob29sTW9tZW50KTogb2JqIGlzIFNjaG9vbE1vbWVudCB7XG4gIHJldHVybiAnYWNhZGVtaWNZZWFyJyBpbiBvYmo7XG59XG5cbmV4cG9ydCBjbGFzcyBTY2hvb2xUZXJtIHtcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XG4gIHRlcm06IFRlcm07XG5cbiAgY29uc3RydWN0b3IoZGF0ZU9yU2Nob29sTW9tZW50OiBEYXRlIHwgU2Nob29sTW9tZW50KSB7XG4gICAgY29uc3Qgc2Nob29sTW9tZW50ID0gaXNTY2hvb2xNb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSA/XG4gICAgICBkYXRlT3JTY2hvb2xNb21lbnQgOiBnZXRTY2hvb2xNb21lbnQobW9tZW50KGRhdGVPclNjaG9vbE1vbWVudCkpO1xuICAgIHRoaXMuYWNhZGVtaWNZZWFyID0gc2Nob29sTW9tZW50LmFjYWRlbWljWWVhcjtcbiAgICB0aGlzLnRlcm0gPSBzY2hvb2xNb21lbnQudGVybTtcbiAgfVxuXG4gIGdldCB5ZWFyKCkge1xuICAgIHJldHVybiBwYXJzZUludCh0aGlzLmFjYWRlbWljWWVhclxuICAgICAgICAuc3BsaXQoJy8nKVt0aGlzLnRlcm0gPT09ICdBVCcgPyAwIDogMV0pO1xuICB9XG5cbiAgbmV4dFRlcm0oKSB7XG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdTVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0gOlxuICAgICAge1xuICAgICAgICB0ZXJtOiAnQVQnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIDEpXG4gICAgICB9KTtcbiAgfVxuXG4gIHByZXZUZXJtKCkge1xuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAge1xuICAgICAgICB0ZXJtOiAnU1QnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIC0xKVxuICAgICAgfSA6XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdBVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0pO1xuICAgIFxuICB9XG5cbiAgdG9Mb2NhbGVTdHJpbmcobG9jYWxlczogc3RyaW5nW10sIHNob3J0WWVhcj86IGJvb2xlYW4pIHtcbiAgICBsZXQgeWVhciA9IHRoaXMudGVybSA9PT0gJ0FUJyA/XG4gICAgICB0aGlzLmFjYWRlbWljWWVhci5zcGxpdCgnLycpWzBdOlxuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVsxXTtcblxuICAgIGlmIChzaG9ydFllYXIpXG4gICAgICB5ZWFyID0geWVhci5zdWJzdHIoMik7XG5cbiAgICBmb3IgKGxldCBsb2NhbGUgb2YgbG9jYWxlcykge1xuICAgICAgc3dpdGNoIChsb2NhbGUuc3BsaXQoJy0nKVswXS5zcGxpdCgnXycpWzBdLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSAnZW4nOlxuICAgICAgICAgIHJldHVybiBgJHt0aGlzLnRlcm0gPT09ICdBVCcgPyBcIkFUXCIgOiBcIlNUXCJ9ICR7eWVhcn1gO1xuICAgICAgICBjYXNlICdzdic6XG4gICAgICAgICAgcmV0dXJuIGAke3RoaXMudGVybSA9PT0gJ0FUJyA/IFwiSFRcIiA6IFwiVlRcIn0gJHt5ZWFyfWA7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCJcbmV4cG9ydCBmdW5jdGlvbiBjYXBpdGFsaXplRmlyc3QgKHN0cikge1xuICAgIGZvciAobGV0IGk9MCwgbD1zdHIubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBpZiAoc3RyLmNoYXJDb2RlQXQoaSkgPCAweDIwMDApIHtcbiAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyKDAsIGkpICsgc3RyW2ldLnRvTG9jYWxlVXBwZXJDYXNlKCkgKyBzdHIuc3Vic3RyKGkgKyAxKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3RyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKG9iaiwgZXh0ZW5zaW9uKSB7XG4gICAgaWYgKHR5cGVvZiBleHRlbnNpb24gIT09ICdvYmplY3QnKSByZXR1cm4gb2JqO1xuICAgIE9iamVjdC5rZXlzKGV4dGVuc2lvbikuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBvYmpba2V5XSA9IGV4dGVuc2lvbltrZXldO1xuICAgIH0pO1xuICAgIHJldHVybiBvYmo7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbG9uZTxULEU+IChvYmogOiBULCBleHRlbnNpb24/OiBFKSB7XG4gICAgbGV0IGNsb25lID0ge307XG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbG9uZSwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iaiwga2V5KSk7XG4gICAgfSk7XG4gICAgaWYgKGV4dGVuc2lvbikgZXh0ZW5kKGNsb25lLCBleHRlbnNpb24pO1xuICAgIHJldHVybiBjbG9uZSBhcyAoVCAmIEUpO1xufVxuXG5jb25zdCBjb25jYXQgPSBbXS5jb25jYXQ7XG5leHBvcnQgZnVuY3Rpb24gZmxhdHRlbjxUPiAoYSA6IChUIHwgVFtdKVtdKSB7XG4gICAgcmV0dXJuIGNvbmNhdC5hcHBseShbXSwgYSkgYXMgVFtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVByb3A8VD4ocHJvcDprZXlvZiBUKSB7XG4gICAgcmV0dXJuIChhOiBULGI6IFQpID0+IHtcbiAgICAgICAgY29uc3QgYVByb3AgPSBhW3Byb3BdLCBiUHJvcCA9IGJbcHJvcF07XG4gICAgICAgIHJldHVybiBhUHJvcCA+IGJQcm9wID8gMSA6IGFQcm9wIDwgYlByb3AgPyAtMSA6IDA7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVByb3BzKFxuICAgIHByb3BzOiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgICBsb2NhbGVzPzogc3RyaW5nIHwgc3RyaW5nW10sXG4gICAgb3B0aW9ucz86IEludGwuQ29sbGF0b3JPcHRpb25zKTogKGE6IGFueSwgYjogYW55KSA9PiBudW1iZXJcbntcbiAgICBwcm9wcyA9IEFycmF5LmlzQXJyYXkocHJvcHMpID8gcHJvcHMgOiBbcHJvcHNdO1xuXG4gICAgY29uc3QgbG9jYWxlQ29tcGFyZSA9IChhLGIpID0+XG4gICAgICAgIHR5cGVvZiBhID09PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICBhLmxvY2FsZUNvbXBhcmUoYiwgbG9jYWxlcywgb3B0aW9ucykgOlxuICAgICAgICAgICAgYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDA7XG5cbiAgICBmdW5jdGlvbiBjbXBQYXJ0IChhLGIsZmlyc3RQYXJ0OiBzdHJpbmcscmVzdDogc3RyaW5nW10pIHtcbiAgICAgICAgY29uc3QgZmlyc3RBID0gYVtmaXJzdFBhcnRdO1xuICAgICAgICBpZiAoZmlyc3RBID09IG51bGwpIHJldHVybiAtMTtcbiAgICAgICAgY29uc3QgZmlyc3RCID0gYltmaXJzdFBhcnRdO1xuICAgICAgICBpZiAoZmlyc3RCID09IG51bGwpIHJldHVybiAxO1xuICAgICAgICByZXR1cm4gcmVzdC5sZW5ndGggPT09IDAgP1xuICAgICAgICAgICAgbG9jYWxlQ29tcGFyZShmaXJzdEEsIGZpcnN0QikgOlxuICAgICAgICAgICAgY21wUGFydChmaXJzdEEsIGZpcnN0QiwgcmVzdFswXSwgcmVzdC5zbGljZSgxKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb3BzXG4gICAgICAgIC5tYXAocHJvcCA9PiBwcm9wLnNwbGl0KCcuJykpXG4gICAgICAgIC5tYXAoKFtmaXJzdFBhcnQsIC4uLnJlc3RdKSA9PiAoYSxiKSA9PiBjbXBQYXJ0KGEsYiwgZmlyc3RQYXJ0LCByZXN0KSlcbiAgICAgICAgLnJlZHVjZSgoY21wMSwgY21wMikgPT5cbiAgICAgICAgICAgIChhLGIpID0+IGNtcDEoYSxiKSB8fCBjbXAyKGEsYikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gTCh0ZXh0LCAuLi5hcmdzKSB7XG4gICAgbGV0IGZpcnN0ID0gdGV4dFswXTtcbiAgICByZXR1cm4gYnVpbGRNZXNzYWdlKHRleHQsIGFyZ3MpO1xufVxuXG5mdW5jdGlvbiBidWlsZE1lc3NhZ2UgKHRleHQsIGFyZ3MpIHtcbiAgICBsZXQgcnYgPSB0ZXh0WzBdO1xuICAgIGZvciAobGV0IGk9MSwgbD10ZXh0Lmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgcnYgKz0gYXJnc1tpLTFdICsgdGV4dFtpXTtcbiAgICB9XG4gICAgcmV0dXJuIHJ2O1xufVxuXG5leHBvcnQgY2xhc3MgVEM8VD4ge1xuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlOiBUKSB7XG4gICAgICAgIGV4dGVuZCh0aGlzLCB0ZW1wbGF0ZSk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0ZVRpbWVSZXZpdmVyIChrZXksIHZhbHVlKSB7XG4gICAgdmFyIGE7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgYSA9IC9cXC9EYXRlXFwoKFxcZCopXFwpXFwvLy5leGVjKHZhbHVlKTtcbiAgICAgICAgaWYgKGEpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgrYVsxXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuXG4vL2xldCBpbmZvU2VyaWFsID0gMTtcbmV4cG9ydCBmdW5jdGlvbiBzaG93SW5mbyAobXNnKSB7XG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdpbmZvJywgeyAnZGV0YWlsJzogbXNnIH0pO1xuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dFcnJvciAoZXJyTXNnOiBzdHJpbmcgfCBFcnJvcikge1xuICAgIGNvbnN0IG1zZyA9IHR5cGVvZiBlcnJNc2cgPT09ICdzdHJpbmcnID8gZXJyTXNnIDogZXJyTXNnLm1lc3NhZ2U7XG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjdXN0b21lcnJvcicsIHsgJ2RldGFpbCc6IG1zZyB9KTtcbiAgICBjb25zb2xlLmVycm9yKGVyck1zZyk7XG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWF4TGVuZ3RoKHN0cjogc3RyaW5nLCBtYXhMZW46IG51bWJlcikge1xuICAgIHJldHVybiBzdHIubGVuZ3RoID4gbWF4TGVuID9cbiAgICAgICAgc3RyLnN1YnN0cigwLCBtYXhMZW4gLSAzKSArIFwiLi4uXCIgOlxuICAgICAgICBzdHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcnJheVRvTG9va3VwPFQ+KGE6IFRbXSwga2V5QWNjZXNzb3I6IChpdGVtOiBUKSA9PiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgICBjb25zdCByZXN1bHQgOiB7W2tleTogc3RyaW5nXSA6IFRbXX0gPSB7fTtcbiAgICBmb3IgKGxldCBpPTAsIGw9YS5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBhW2ldO1xuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcbiAgICAgICAgbGV0IGFycmF5ID0gcmVzdWx0W2tleV07XG4gICAgICAgIGlmIChhcnJheSkgYXJyYXkucHVzaChpdGVtKTtcbiAgICAgICAgZWxzZSByZXN1bHRba2V5XSA9IFtpdGVtXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5VG9NYXA8VD4oYTogVFtdLCBrZXlBY2Nlc3NvcjogKGl0ZW06IFQpID0+IHN0cmluZyB8IG51bWJlcikge1xuICAgIGNvbnN0IHJlc3VsdCA6IHtba2V5OiBzdHJpbmddIDogVH0gPSB7fTtcbiAgICBmb3IgKGxldCBpPTAsIGw9YS5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSBhW2ldO1xuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBpdGVtO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlcnJ5UGlja1Byb3BzPFQ+IChvYmo6IFQsIHByb3BzVG9QaWNrOiBzdHJpbmdbXSk6IFBhcnRpYWw8VD4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgcGFyYW0gb2YgcHJvcHNUb1BpY2spIHtcbiAgICAgIGlmIChwYXJhbSBpbiBvYmopIHJlc3VsdFtwYXJhbV0gPSBvYmpbcGFyYW1dO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0IGFzIFBhcnRpYWw8VD47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXN0aW5jdDxUPiAoYTogVFtdLCBrZXlBY2Nlc3Nvcj86IChpdGVtOiBUKSA9PiBhbnkpIHtcbiAgICBjb25zdCBtYXAgPSBhcnJheVRvTWFwKGEsIGtleUFjY2Vzc29yIHx8ICh4ID0+IHgpKTtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5tYXAoa2V5ID0+IG1hcFtrZXldKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNoYWxsb3dFcXVhbHMoYTogYW55LCBiOiBhbnkpIHtcbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIHRydWU7XG4gICAgaWYgKCFhIHx8ICFiKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHR5cGVvZiBhICE9PSAnb2JqZWN0JyB8fCB0eXBlb2YgYiAhPT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCBrZXlzQSA9IE9iamVjdC5rZXlzKGEpO1xuICAgIGNvbnN0IGtleXNCID0gT2JqZWN0LmtleXMoYik7XG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG4gICAgZm9yIChsZXQgaT0wLCBsPWtleXNBLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5c0FbaV07XG4gICAgICAgIGlmIChrZXlzQltpXSAhPT0ga2V5KSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChhW2tleV0gIT09IGJba2V5XSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbiIsImltcG9ydCBtb21lbnQsIHsgTW9tZW50IH0gZnJvbSBcIm1vbWVudFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gS0VEV2VlayAoeWVhcjogbnVtYmVyLCB3ZWVrOiBudW1iZXIpIHtcbiAgY29uc3QgbSA9IG1vbWVudChuZXcgRGF0ZSh5ZWFyLCAxLCAxKSkubG9jYWxlKCdzdicpLndlZWsod2Vlayk7XG4gIGNvbnN0IHJlcyA9IHtcbiAgICB5ZWFyLFxuICAgIHdlZWssXG4gICAgbm90QmVmb3JlOiBtLmNsb25lKCkuc3RhcnRPZignd2VlaycpLmFkZCgtMiwgJ2RheXMnKS50b0RhdGUoKS5nZXRUaW1lKCksXG4gICAgbm90QWZ0ZXI6IG0uY2xvbmUoKS5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpXG4gIH07XG4gIHJldHVybiByZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZGp1c3RlZFdlZWsobTogTW9tZW50KSB7XG4gIGNvbnN0IGNsb25lID0gbS5jbG9uZSgpLmxvY2FsZSgnc3YnKTtcbiAgcmV0dXJuIG0ud2Vla2RheSgpID49IDUgPyAvLyBMw7ZyZGFnIDAwOjAwIC8gU8O2bmRhZyAwMDowMD9cbiAgICAgIG0ud2VlaygpICsgMSA6IC8vIFRpbGxow7ZyIG7DpHN0YSB2ZWNrYVxuICAgICAgbS53ZWVrKCk7XG59XG5cbi8qZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtMaW1pdHMgKG06IE1vbWVudCkge1xuICBjb25zdCBjbG9uZWRTd2VkaXNoID0gbS5jbG9uZSgpLmxvY2FsZSgnc3YnKTtcbiAgY29uc3QgbGltaXRzID0ge1xuICAgIG5vdEJlZm9yZTogY2xvbmVkU3dlZGlzaC5zdGFydE9mKCd3ZWVrJykuYWRkKC0yLCAnZGF5cycpLFxuICAgIG5vdEFmdGVyOiBjbG9uZWRTd2VkaXNoLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoNSwgJ2RheXMnKVxuICB9O1xufVxuKi9cbiIsIm1vZHVsZS5leHBvcnRzID0galF1ZXJ5OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7IiwibW9kdWxlLmV4cG9ydHMgPSBSZWFjdERPTTsiXSwic291cmNlUm9vdCI6IiJ9