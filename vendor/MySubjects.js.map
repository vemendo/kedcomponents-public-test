{"version":3,"file":"MySubjects.js","sources":["webpack://[name]/./src/components/my-subjects/my-subjects-inner.tsx","webpack://[name]/./src/components/my-subjects/my-subjects.tsx"],"sourcesContent":["import { env } from \"../../globals/KED.env\";\nimport { db, globalId } from \"../../globals/db\";\nimport { preserveImpersonationQuery } from \"../../access-control\";\nimport * as React from \"react\";\nimport { cfg } from \"../../globals/KED.cfg\";\nimport { Emitter } from 'kedbackend/observable';\nimport { withObserve } from '../utility-components/with-observe';\nvar STATIC_COURSES = new Emitter([{\n        id: \"https://ks.kunskapsporten.se/steg/matematik.4.47f6b323168938151ef8161c.html\",\n        name: \"Matematik\",\n        type: \"step-course\",\n        tags: [\"static\"],\n    }]).toCollection(function (x) { return x; });\nexport var MySubjectsInner = withObserve(function (_a) {\n    var user = env.currentUser;\n    var schoolGrade = user.schoolGrade;\n    var isPrimarySchoolStudent = (\"\" + user.schoolType).toLowerCase() !== \"gymnasium\";\n    var subjectPlannerURL = cfg.KED_SUBJECT_PLANNER_URL;\n    var schoolName = user.school;\n    if (!schoolGrade || !isPrimarySchoolStudent) {\n        return (React.createElement(\"li\", { className: \"lvl2 header\" },\n            React.createElement(\"a\", null, \"Listning endast f\\u00F6r grundskolan\")));\n    }\n    var _b = db.courseInstances\n        .hasEdgesFrom([globalId])\n        //.tags(\"active\") // Workaround: Multiple criterias disables the use of useSP\n        .cacheOptimized()\n        .filter(function (c) { return c.tags.includes(\"active\"); })\n        .map(function (_a) {\n        var id = _a.id, name = _a.name, type = _a.type, tags = _a.tags;\n        return ({\n            id: id,\n            name: name,\n            type: type,\n            tags: tags\n        });\n    })\n        .concat(STATIC_COURSES)\n        .orderBy(\"name\")\n        .groupBy(\"type\")\n        .map(function (arraysByType) { return ({\n        themeCourses: arraysByType[\"theme-course\"],\n        stepCourses: arraysByType[\"step-course\"]\n    }); }).read(), themeCourses = _b.themeCourses, stepCourses = _b.stepCourses;\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"li\", { className: \"lvl2 header\" },\n            React.createElement(\"a\", null, \"Stegkurser\")),\n        stepCourses.map(function (course) { return (React.createElement(\"li\", { key: course.id, className: \"lvl2\" },\n            React.createElement(\"a\", { href: preserveImpersonationQuery(course.tags.includes(\"static\") ?\n                    course.id :\n                    subjectPlannerURL + \"#/\" + schoolName + \"/courses/\" + course.id, {}) }, course.name))); }),\n        React.createElement(\"li\", { className: \"lvl2 header\" },\n            React.createElement(\"a\", null, \"Temakurser\")),\n        themeCourses\n            .filter(function (_a) {\n            var tags = _a.tags;\n            return tags.includes(\"grade:\" + schoolGrade);\n        })\n            .map(function (course) { return (React.createElement(\"li\", { key: course.id, className: \"lvl2\" },\n            React.createElement(\"a\", { href: preserveImpersonationQuery(course.tags.includes(\"static\") ?\n                    course.id :\n                    subjectPlannerURL + \"#/\" + schoolName + \"/courses/\" + course.id, {}) }, course.name))); })));\n});\n","import * as React from 'react';\nimport { TimeoutEllipsisLoader } from '../course-builder/sub-components/ellipsis-loader';\nimport { MySubjectsInner } from './my-subjects-inner';\nimport { Suspense } from 'react';\nexport function MySubjects(_a) {\n    var viewCourseUrl = _a.viewCourseUrl;\n    return (React.createElement(Suspense, { fallback: React.createElement(TimeoutEllipsisLoader, null) },\n        React.createElement(MySubjectsInner, { viewCourseUrl: viewCourseUrl })));\n}\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC9DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}