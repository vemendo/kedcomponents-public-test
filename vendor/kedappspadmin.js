var kedappspadmin =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"kedappspadmin": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/elements/KEDAppSubjectPlannerAdmin/webpack-entry.ts","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./kedbackend/KED.Backend.API/schema.json":
/*!************************************************!*\
  !*** ./kedbackend/KED.Backend.API/schema.json ***!
  \************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "./kedbackend/client.js":
/*!******************************!*\
  !*** ./kedbackend/client.js ***!
  \******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "./kedbackend/clientweb.js":
/*!*********************************!*\
  !*** ./kedbackend/clientweb.js ***!
  \*********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "./kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!***************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \***************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!***********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \***********************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \***************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "./kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \***********************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "./kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "./kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
// | 'otherFlag' | 'thirdFlag';...
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.undoLink = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.undoLink(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.undoLink = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'undo-link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \*************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \***********************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!**************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \**************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                case 'undo-link':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js":
/*!**********************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js ***!
  \**********************************************************************************************/
/*! exports provided: applyMutationsOnDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyMutationsOnDeltas", function() { return applyMutationsOnDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");


function applyMutationsOnDeltas(branchId, deltas, mutations, optimistic, userDisplayName, hasAdditionalFilter) {
    var _loop_1 = function (m) {
        switch (m.op) {
            case 'add-related':
                //
                // AddRelated RepoMutation
                //
                if (!hasAdditionalFilter && m.branchId === branchId) {
                    deltas = [{
                            type: 'add',
                            sourceId: m.id,
                            targetId: m.relatedDoc.id,
                            label: m.graphProp,
                            sourceTable: m.table,
                            $meta: optimistic ? 'adding' : 'persisted',
                            dateTime: Date.now(),
                            targetName: m.relatedDoc.name,
                            contributor: userDisplayName
                        }].concat(deltas);
                }
                break;
            case 'clear-branch':
                //
                // ClearBranch RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                break;
            case 'delete':
                //
                // Delete RepoMutation
                //
                // This type of mutation can not be performed onto branches. There's no branchId property on m.
                break;
            case 'merge':
                //
                // Merge RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                else if (m.targetBranchId === branchId) {
                    // This change will append new deltas to our deltas array but we don't know what would come.
                    // Need to refetch from server.
                    if (!optimistic)
                        return { value: null }; // Caller should check for null and re-fetch data from server.
                }
                break;
            case 'remove-related':
                //
                // Remove-Related RepoMutation
                //
                if (hasAdditionalFilter || m.branchId !== branchId)
                    return "continue";
                deltas = [{
                        type: 'remove',
                        sourceId: m.id,
                        targetId: m.relatedDoc.id,
                        targetName: m.relatedDoc.name,
                        label: m.graphProp,
                        sourceTable: m.table,
                        contributor: userDisplayName,
                        dateTime: Date.now(),
                        $meta: optimistic ? 'adding' : 'persisted'
                    }].concat(deltas);
                break;
            case 'undo-link':
                //
                // Undo-Link RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (d) {
                        return (d.type === 'add' || d.type === 'remove' || d.type === 'undo-link') &&
                            d.sourceId === m.id &&
                            d.targetId === m.relatedId;
                    });
                    if (idx < 0)
                        return "continue";
                    // Found an "add" or "remove" delta to change:
                    if (optimistic) {
                        var deltaRelation = deltas[idx];
                        // Mark the existing add/remove delta as currenlty being deleted
                        deltas = deltas.slice(0, idx).concat([
                            tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaRelation, { $meta: optimistic ? 'removing' : 'persisted' })
                        ], deltas.slice(idx + 1));
                    }
                    else {
                        // Persisted. Just remove it:
                        deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                    }
                }
                break;
            case 'update':
                //
                // Update RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (delta) {
                        return delta.type === 'modify' &&
                            delta.targetId === m.id;
                    });
                    if (idx < 0 && !hasAdditionalFilter) {
                        deltas = [{
                                type: 'modify',
                                table: m.table,
                                targetId: m.id,
                                targetName: m.targetName,
                                data: m.deltaDoc,
                                dateTime: Date.now(),
                                contributors: [userDisplayName],
                                $meta: optimistic ? 'adding' : 'persisted',
                            }].concat(deltas);
                    }
                    else {
                        var existingDeltaDoc = deltas[idx];
                        var contributors = existingDeltaDoc.contributors.slice();
                        if (!contributors.includes(userDisplayName)) {
                            contributors.push(userDisplayName);
                        }
                        var newData = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_1__["mergeDeltas"])(existingDeltaDoc.data, m.deltaDoc, { removeUnsetProps: true });
                        if (!optimistic && Object.keys(newData).length === 0) {
                            // Committed mutation that resets a deltaDoc. Remove the deltaDoc entirely:
                            deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                        }
                        else {
                            // 
                            deltas = [
                                {
                                    type: 'modify',
                                    table: m.table,
                                    targetId: m.id,
                                    targetName: m.targetName,
                                    data: newData,
                                    dateTime: Date.now(),
                                    contributors: contributors,
                                    $meta: optimistic ? 'updating' : 'persisted',
                                }
                            ].concat(deltas.slice(0, idx), deltas.slice(idx + 1));
                        }
                    }
                }
                break;
        }
    };
    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {
        var m = mutations_1[_i];
        var state_1 = _loop_1(m);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return deltas;
}
//# sourceMappingURL=apply-mutations-on-deltas.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js":
/*!********************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js ***!
  \********************************************************************************/
/*! exports provided: DeltaCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCache", function() { return DeltaCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./apply-mutations-on-deltas */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js");



var DeltaCache = /** @class */ (function () {
    function DeltaCache(getClient, getUser, getUserDisplayName) {
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.lookup = {};
    }
    DeltaCache.prototype.applyMutations = function (mutations, _a) {
        var optimistic = (_a === void 0 ? { optimistic: false } : _a).optimistic;
        // Apply mutations locally onto the DeltaCache and notify their subscribers
        for (var _i = 0, _b = Object.keys(this.lookup); _i < _b.length; _i++) {
            var queryKey = _b[_i];
            var cacheEntry = this.lookup[queryKey];
            if (cacheEntry.value) {
                // Instead here: Store the mutations on cacheEntry. No matter if it yet has value or not.
                // Then apply mutation whenever subscribing! (Better handling of mutations that arrives before fetch() is done)
                // (See how I handle this in query-set.ts)
                var newValue = Object(_apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__["applyMutationsOnDeltas"])(cacheEntry.query.branchId, cacheEntry.value, mutations, optimistic, this.getUserDisplayName(), !!cacheEntry.query.tags);
                if (newValue === null) {
                    // The mutation requires cacheEntry to be refetched from server
                    if (!optimistic) {
                        // Caller has successfully performed the mutations and got success back from server.
                        // It's ok to refetch the deltas from server now:
                        cacheEntry.fetch();
                        // After fetch completes, it will notify the subscribers.
                    }
                }
                if (newValue !== cacheEntry.value) {
                    cacheEntry.optimisticValue = newValue;
                    if (!optimistic)
                        cacheEntry.value = newValue;
                    cacheEntry.notify(newValue);
                }
            }
        }
    };
    DeltaCache.prototype.subscribe = function (query, observer) {
        var _this = this;
        var cacheEntry = this.lookup[query.branchId + query.tags];
        if (!cacheEntry) {
            cacheEntry = new DeltaCacheEntry(this.getClient(), query);
            this.lookup[query.branchId + query.tags] = cacheEntry;
        }
        if (cacheEntry.cleanupTimer) {
            clearTimeout(cacheEntry.cleanupTimer);
            cacheEntry.cleanupTimer = null;
        }
        var subscription = {
            unsubscribe: function () {
                cacheEntry.subscribers = cacheEntry.subscribers.filter(function (_a) {
                    var o = _a.observer;
                    return o !== observer;
                });
                if (cacheEntry.subscribers.length === 0) {
                    cacheEntry.cleanupTimer = setTimeout(function () {
                        if (cacheEntry.subscribers.length === 0) {
                            delete _this.lookup[query.branchId + query.tags];
                        }
                    }, 100);
                }
            }
        };
        cacheEntry.subscribers.push({ observer: observer, subscription: subscription });
        if (cacheEntry.value) {
            // Value has been successfully retrieved already. Pick from cache.
            observer(cacheEntry.optimisticValue || cacheEntry.value, null, subscription);
        }
        else if (cacheEntry.isFetching) {
            // A value is on its way. Sit back and relax. All registered
            // observers (including this one) will be notified when data arrives
            // or fails.
        }
        else if (cacheEntry.error) {
            observer(null, cacheEntry.error, subscription);
        }
        else {
            cacheEntry.fetch();
        }
        return subscription;
    };
    return DeltaCache;
}());

var DeltaCacheEntry = /** @class */ (function () {
    function DeltaCacheEntry(client, query) {
        this.fetchOperationId = 0; // Makes sure a re-fetch will discard the result from any ongoing fetch.
        this.client = client;
        this.query = query;
        this.value = null;
        this.error = null;
        this.optimisticValue = null;
        this.subscribers = [];
        this.isFetching = false;
        this.cleanupTimer = null;
    }
    DeltaCacheEntry.prototype.fetch = function () {
        var _this = this;
        var fetchOperationId = ++this.fetchOperationId;
        this.isFetching = true;
        this.fetchFromServer().then(function (value) {
            // Success
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                value.sort(function (a, b) { return b.dateTime - a.dateTime; }); // Latest first
                _this.value = value;
                _this.optimisticValue = value;
                _this.notify(value);
            }
        }).catch(function (error) {
            // Fail
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                _this.error = error;
                _this.fail(error);
            }
        });
    };
    DeltaCacheEntry.prototype.fetchFromServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!this.query.branchId)
                            throw new Error('Deltas only available on branches');
                        return [4 /*yield*/, this.client.http.get('deltas', this.query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 300 || res.status < 200)) return [3 /*break*/, 3];
                        _a = _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    DeltaCacheEntry.prototype.notify = function (value) {
        for (var _i = 0, _a = this.subscribers; _i < _a.length; _i++) {
            var _b = _a[_i], observer = _b.observer, subscription = _b.subscription;
            observer(value, null, subscription);
        }
    };
    DeltaCacheEntry.prototype.fail = function (error) {
        var copy = this.subscribers.slice();
        this.subscribers = [];
        for (var _i = 0, copy_1 = copy; _i < copy_1.length; _i++) {
            var _a = copy_1[_i], observer = _a.observer, subscription = _a.subscription;
            observer(null, error, subscription);
        }
    };
    return DeltaCacheEntry;
}());
//# sourceMappingURL=delta-cache.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js":
/*!*************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js ***!
  \*************************************************************************************/
/*! exports provided: DeltaCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCollection", function() { return DeltaCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../observable */ "./kedbackend/js/dist/js/observable/index.js");


var DeltaCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DeltaCollection, _super);
    function DeltaCollection(deltaCache, query) {
        var _this = _super.call(this, function (observer) { return _this.deltaCache.subscribe(query, observer); }) || this;
        _this.deltaCache = deltaCache;
        _this.query = query;
        return _this;
    }
    DeltaCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return new DeltaCollection(this.deltaCache, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, { tags: tags }));
    };
    return DeltaCollection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Collection"]));

//# sourceMappingURL=delta-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \***************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            // Do nothing on target doc!
                            targetDoc.$wasUnset = true; // Just mark it for re-retrieval after successful posting changes.
                            break;
                        }
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
// {name: "Ulla"}, {name: {$unset:0}
// {tags: {$add: "hej"}}, {tags: {$unset:0}"}
function mergeDeltas(delta1, delta2, _a) {
    var removeUnsetProps = (_a === void 0 ? { removeUnsetProps: false } : _a).removeUnsetProps;
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            if (removeUnsetProps) {
                                delete targetDelta[key];
                            }
                            else {
                                // No matter if targetDelta is empty or has value. Set it to {$unset:0}
                                // to make sure the very end result will have {$unset:0}
                                targetDelta[key] = { $unset: 0 };
                            }
                            break;
                        }
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _b = 0, metaInstructions_2 = metaInstructions; _b < metaInstructions_2.length; _b++) {
                    var mi = metaInstructions_2[_b];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \*********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "./kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \*************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "./kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (doc, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: doc.id,
                deltaDoc: changes,
                targetName: doc.name
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.undoLink = function (id, label, relatedId) {
        if (!this.query.branchId)
            throw new Error("undo links can only be performed on branches");
        this.repo.writer.mutate([{
                op: 'undo-link',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedDoc.id ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedDoc.id; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedDoc.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedDoc.id; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!*******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \*******************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony import */ var _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-collection */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js");







var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, getUserDisplayName, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!defaultQueryOptions)
            this.defaultQueryOptions = {};
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser, getUserDisplayName);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
        this.deltas = new _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__["DeltaCollection"](this.writer.deltaCache, {
            branchId: this.defaultQueryOptions.branchId // If branchId is undefined. DeltaCollection will respond with Error on subscribe()
        });
    }
    KedBackendRepo.prototype.table = function (tableName) {
        var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](this, tableName, this.defaultQueryOptions);
        if (this.cacheOptimized)
            collection = collection.cacheOptimized();
        return collection;
    };
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, this.getUserDisplayName, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!***************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \***************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!*********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony import */ var _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-cache */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js");







var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser, getUserDisplayName) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
        this.deltaCache = new _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__["DeltaCache"](getClient, getUser, getUserDisplayName);
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        this.deltaCache.applyMutations(this.mutationQueue.get(), { optimistic: true });
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] },
                            targetName: null // We don't have the target name. But this mutation won't be visible in a DeltaCollection anyway, so it wont be used.
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        this.deltaCache.applyMutations(mutations, { optimistic: false });
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'undo-link':
                    br.undoLink(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \*************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \*********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \***********************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/collection.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/collection.js ***!
  \********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/emitter.js":
/*!*****************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/emitter.js ***!
  \*****************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/fiber-context.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/fiber-context.js ***!
  \***********************************************************/
/*! exports provided: FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return FiberContext; });
var stack = [];
var currentFiber = null;
var providers = [function () { return currentFiber; }];
function pushFiber(fiber) {
    stack.push(currentFiber);
    currentFiber = fiber;
}
function popFiber() {
    currentFiber = stack.pop();
}
var FiberContext = {
    get current() { return currentFiber; },
    /*run: function rerun<R>(fiber: Fiber, fn: ()=>R): R | Promise<R> {
      pushFiber(fiber);
      try {
        return Promise.resolve(fn());
      } catch (p) {
        if (p && typeof p.then === 'function') {
          return p.then(()=>rerun(fiber, fn));
        } else {
          return Promise.reject(p);
        }
      } finally {
        popFiber();
      }
    },*/
    addProvider: function (getCurrentFiber) {
        providers.push(getCurrentFiber);
        setCurrentGetterFromProviders();
    },
    removeProvider: function (getCurrentFiber) {
        providers = providers.filter(function (p) { return p !== getCurrentFiber; });
        setCurrentGetterFromProviders();
    }
};
function setCurrentGetterFromProviders() {
    Object.defineProperty(FiberContext, "current", {
        get: providers.reduce(function (p, c) { return function () { return p() || c(); }; }),
        set: function () { throw new Error("Use FiberContext.push() to change current fiber"); }
    });
}
//# sourceMappingURL=fiber-context.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/index.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/index.js ***!
  \***************************************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });

/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"]; });






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/map.js":
/*!*************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/map.js ***!
  \*************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/mixin.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/mixin.js ***!
  \***************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/observable.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/observable.js ***!
  \********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/value.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/value.js ***!
  \***************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");





var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.read = function () {
        var resolved = false, result, err, notify;
        var subscription = this.subscribe(function (value, error, subsciption) {
            resolved = true;
            result = value;
            err = error;
            if (error && notify)
                notify(null, error, subsciption);
            else if (notify)
                notify(value, null, subsciption);
        });
        if (resolved) {
            var currentFiber = _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"].current;
            if (!currentFiber) {
                subscription.unsubscribe();
                throw new Error("Invalid Fiber Context");
            }
            if (err) {
                subscription.unsubscribe();
                throw err;
            }
            var subscriptions = currentFiber.subscriptions, observer = currentFiber.observer;
            subscriptions.push(subscription);
            notify = observer;
            return result;
        }
        throw new Promise(function (resolve, reject) {
            notify = function (value, error, subscription) {
                subscription.unsubscribe();
                if (error)
                    reject(error);
                else
                    resolve(value);
            };
        });
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "./kedbackend/observable.js":
/*!**********************************!*\
  !*** ./kedbackend/observable.js ***!
  \**********************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Value"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Collection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Emitter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["FiberContext"]; });




/***/ }),

/***/ "./kedbackend/repo.js":
/*!****************************!*\
  !*** ./kedbackend/repo.js ***!
  \****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = [
    "user",
    "role",
    "school",
    "debug",
    "testVersion",
    "testversion",
    "features",
    "schoolType",
    "schooltype"
];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json");
var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json", 1);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/make-suspense-api */ "./src/utils/make-suspense-api.ts");









var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        var _this = this;
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        var isApiMethod = function (m) {
            return typeof _this[m] === 'function' &&
                m !== 'constructor' && // Since makeSuspenseApi() walks prototype chain
                m !== 'privatizingCacheBust' &&
                m !== 'userEmailGetter';
        } // List non-API methods here...
        ;
        Object.keys(EdsClient.prototype).forEach(function (method) {
            if (isApiMethod(method)) {
                _this[method] = avoidSimultanousCalls(_this[method]);
            }
        });
        this.suspense = Object(_utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__["makeSuspenseApi"])(this, { isApiMethod: isApiMethod });
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    /**
     * getSchoolTuitionGroups()
     *
     * Return tuitiongroups for school
     *
     * @param schoolName - name of school
     * @param courseCode - Skolverkets code for course
     */
    EdsClient.prototype.getSchoolTuitionGroups = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTuitionGroups", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTuitionGroups];
                }
            });
        });
    };
    /**
     * getTuitionGroupStudents()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     * @param tuitionGroupName - tuition gruop name in EDS
     */
    EdsClient.prototype.getTuitionGroupStudents = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("TuitionGroupStudents", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.tuitionGroupStudents];
                }
            });
        });
    };
    /**
     * getSchoolTeachers()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     */
    EdsClient.prototype.getSchoolTeachers = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTeachers", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTeachers];
                }
            });
        });
    };
    // we assume that the EDS will return the current academic year dates determined by the current date
    EdsClient.prototype.getAcademicYearTerms = function (schoolLocale, date) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var holidays, firstTermMoment, secondTermMoment, startFirstTermDate, startSecondTermDate, endFirstTermDate, endSecondTermDate, firstTerm, secondTerm;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                // mock data
                switch (schoolLocale) {
                    case 'en_sin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.SouthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'en_nin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.NorthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'sv':
                        {
                            holidays = [];
                            firstTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, true);
                            secondTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, false);
                            startFirstTermDate = firstTermMoment[0];
                            startSecondTermDate = secondTermMoment[0];
                            endFirstTermDate = firstTermMoment[1];
                            endSecondTermDate = secondTermMoment[1];
                            firstTerm = { startDate: new Date(startFirstTermDate.year(), startFirstTermDate.month(), startFirstTermDate.date()).toDateString(), endDate: new Date(startFirstTermDate.year(), endFirstTermDate.month(), endFirstTermDate.date()).toDateString() };
                            secondTerm = { startDate: new Date(startSecondTermDate.year(), startSecondTermDate.month(), startSecondTermDate.date()).toDateString(), endDate: new Date(startSecondTermDate.year(), endSecondTermDate.month(), endSecondTermDate.date()).toDateString() };
                            return [2 /*return*/, { firstTerm: firstTerm, secondTerm: secondTerm, holidays: holidays }];
                        }
                }
                return [2 /*return*/];
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/apis/mock/mock-eds-data.json":
/*!******************************************!*\
  !*** ./src/apis/mock/mock-eds-data.json ***!
  \******************************************/
/*! exports provided: SouthIndia, NorthIndia, default */
/***/ (function(module) {

module.exports = {"SouthIndia":[{"firstTerm":{"startDate":"2015-06-01T00:00:00.000Z","endDate":"2015-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2015-11-01T00:00:00.000Z","endDate":"2016-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-06-23T00:00:00.000Z","endDate":"2016-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2016-11-01T00:00:00.000Z","endDate":"2017-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-06-05T00:00:00.000Z","endDate":"2017-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2017-11-01T00:00:00.000Z","endDate":"2018-03-30T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2018-06-04T00:00:00.000Z","endDate":"2018-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2018-11-01T00:00:00.000Z","endDate":"2019-04-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2019-06-03T00:00:00.000Z","endDate":"2019-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2019-11-01T00:00:00.000Z","endDate":"2020-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-06-01T00:00:00.000Z","endDate":"2020-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2020-11-01T00:00:00.000Z","endDate":"2021-03-26T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-06-06T00:00:00.000Z","endDate":"2021-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2021-11-01T00:00:00.000Z","endDate":"2022-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-06-05T00:00:00.000Z","endDate":"2022-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2022-11-01T00:00:00.000Z","endDate":"2023-03-31T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-06-04T00:00:00.000Z","endDate":"2023-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2023-11-01T00:00:00.000Z","endDate":"2024-03-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2024-06-03T00:00:00.000Z","endDate":"2024-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2024-11-01T00:00:00.000Z","endDate":"2025-03-28T00:00:00.000Z"},"holidays":[]}],"NorthIndia":[{"firstTerm":{"startDate":"2024-04-03T00:00:00.000Z","endDate":"2024-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2024-10-01T00:00:00.000Z","endDate":"2025-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-04-05T00:00:00.000Z","endDate":"2023-10-01T00:00:00.000Z"},"secondTerm":{"startDate":"2023-10-02T00:00:00.000Z","endDate":"2024-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-04-06T00:00:00.000Z","endDate":"2022-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2022-10-04T00:00:00.000Z","endDate":"2023-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-04-01T00:00:00.000Z","endDate":"2021-10-04T00:00:00.000Z"},"secondTerm":{"startDate":"2021-10-05T00:00:00.000Z","endDate":"2022-04-05T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-04-01T00:00:00.000Z","endDate":"2020-09-28T00:00:00.000Z"},"secondTerm":{"startDate":"2020-09-29T00:00:00.000Z","endDate":"2021-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2020-05-17","endDate":"2020-06-28"}]},{"firstTerm":{"startDate":"2019-04-04T00:00:00.000Z","endDate":"2019-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2019-10-01T00:00:00.000Z","endDate":"2020-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2019-05-19","endDate":"2019-06-29"}]},{"firstTerm":{"startDate":"2018-04-04T00:00:00.000Z","endDate":"2018-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2018-10-01T00:00:00.000Z","endDate":"2019-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-04-05T00:00:00.000Z","endDate":"2017-10-02T00:00:00.000Z"},"secondTerm":{"startDate":"2017-10-03T00:00:00.000Z","endDate":"2018-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-04-06T00:00:00.000Z","endDate":"2016-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2016-10-04T00:00:00.000Z","endDate":"2017-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2015-04-01T00:00:00.000Z","endDate":"2015-10-05T00:00:00.000Z"},"secondTerm":{"startDate":"2015-10-06T00:00:00.000Z","endDate":"2016-04-05T00:00:00.000Z"},"holidays":[]}]};

/***/ }),

/***/ "./src/components/charts/goal-progress.tsx":
/*!*************************************************!*\
  !*** ./src/components/charts/goal-progress.tsx ***!
  \*************************************************/
/*! exports provided: GoalProgress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoalProgress", function() { return GoalProgress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var GoalProgress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoalProgress, _super);
    function GoalProgress() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.createProgress = function () {
            var _a = _this.props, numberOfTasks = _a.numberOfTasks, completedNumberOfTasks = _a.completedNumberOfTasks, maximumTasksDisplayed = _a.maximumTasksDisplayed, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
            var progress = [];
            if (numberOfTasks > maximumTasksDisplayed) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progress-overview" },
                    " ",
                    completedNumberOfTasks,
                    " / ",
                    numberOfTasks,
                    " ");
            }
            for (var taskNo = 1; taskNo <= numberOfTasks; taskNo++) {
                progress.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { key: taskNo },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", fill: taskNo > completedNumberOfTasks ? backgroundColor : progressColor, cx: "8", cy: "8", r: "8" })));
            }
            return progress;
        };
        return _this;
    }
    GoalProgress.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "goals-progress" }, this.createProgress());
    };
    GoalProgress.defaultProps = {
        numberofTasks: 0,
        completedNumberOfTasks: 0,
        maximumTasksDisplayed: 10,
        backgroundColor: "lightgrey",
        progressColor: "#3dbca2",
    };
    return GoalProgress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder-ks/admin/courses/create-standard-course.tsx":
/*!***********************************************************************************!*\
  !*** ./src/components/course-builder-ks/admin/courses/create-standard-course.tsx ***!
  \***********************************************************************************/
/*! exports provided: CreateStandardCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateStandardCourse", function() { return CreateStandardCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var react_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-router */ "./node_modules/react-router/es/index.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utility-components/lazy-content */ "./src/components/utility-components/lazy-content.tsx");
/* harmony import */ var _logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../logic/course-instance-tags */ "./src/components/course-builder-ks/logic/course-instance-tags.ts");








var _CreateStandardCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_CreateStandardCourse, _super);
    function _CreateStandardCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            courseName: "",
            courseType: 'theme-course',
            subject: { subjectName: '', subjectCode: '' }
        };
        return _this;
    }
    _CreateStandardCourse.prototype.createCourse = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, type, name, subject, courseId, _b, officialBranchId, schoolId, courseProperties;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.state, type = _a.courseType, name = _a.courseName, subject = _a.subject;
                        courseId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                        return [4 /*yield*/, _globals_db__WEBPACK_IMPORTED_MODULE_3__["Schools"].standardSchool.load()];
                    case 1:
                        _b = _c.sent(), officialBranchId = _b.officialBranchId, schoolId = _b.id;
                        _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].branches.addRelated(officialBranchId, "approvedChildren", {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(),
                            name: 'draft',
                            acl: [
                                "role:USER:R",
                                "schoolRole:standard/EMPLOYEE:S"
                            ],
                            schoolId: schoolId,
                            treeParentId: officialBranchId,
                            tags: [courseId] // Allow following queries:
                            // List all draft for a certain school: {hasEdgesFrom=schoolBranchId&tags=courseId}
                            // Get official draft for a certain school: {hasEdgesFrom=schoolBranchId&name=draft&tags=courseId}
                        });
                        courseProperties = {
                            id: courseId,
                            acl: [
                                'schoolRole:standard/EMPLOYEE:S',
                                'role:USER:R'
                            ],
                            name: name,
                            //description: type === 'step-course' ? "Stegkurs" : "Teamkurs",
                            tags: type === 'step-course' ?
                                Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_7__["computeTagsFromSubjectCodes"])([], [subject.subjectCode]) :
                                []
                        };
                        _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].global.addRelated(_globals_db__WEBPACK_IMPORTED_MODULE_3__["globalId"], "courseInstances", type === 'step-course' ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, courseProperties, { type: type, description: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Stegkurs"], ["Stegkurs"]))), subject: subject }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, courseProperties, { type: type, description: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Temakurs"], ["Temakurs"]))), subjects: [] }));
                        this.setState({
                            courseName: ''
                        });
                        return [4 /*yield*/, _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].saveNow()];
                    case 2:
                        _c.sent();
                        this.props.history.push("/admin/courses/" + courseId + "/settings");
                        return [2 /*return*/];
                }
            });
        });
    };
    _CreateStandardCourse.prototype.isValidState = function (giveMessage) {
        var _a = this.state, courseName = _a.courseName, courseType = _a.courseType, subject = _a.subject;
        var rv = courseName && courseType === 'theme-course' || subject.subjectCode;
        if (!rv && giveMessage) {
            if (!courseName)
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursens namn m\u00E5ste fyllas i"], ["Kursens namn m\u00E5ste fyllas i"])));
            if (!subject.subjectCode)
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mne m\u00E5ste v\u00E4ljas f\u00F6r stegkurser"], ["\u00C4mne m\u00E5ste v\u00E4ljas f\u00F6r stegkurser"])));
        }
        return rv;
    };
    _CreateStandardCourse.prototype.render = function () {
        var _this = this;
        var _a = this.state, courseName = _a.courseName, courseType = _a.courseType, subject = _a.subject;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Skapa ny standardkurs"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                "Namn: ",
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", value: courseName, onChange: function (ev) { return _this.setState({ courseName: ev.target.value }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "radio", name: "course-type", checked: courseType === 'step-course', onChange: function (ev) { return ev.target.checked && _this.setState({ courseType: 'step-course' }); } }),
                " Stegkurs"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "radio", name: "course-type", checked: courseType === 'theme-course', onChange: function (ev) { return ev.target.checked && _this.setState({ courseType: 'theme-course' }); } }),
                " Temakurs"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            courseType === 'step-course' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("form", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mne"], ["\u00C4mne"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_6__["LazyContent"], null, _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].subjects.tags("schoolType:primary").toValue().map(function (subjects) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: subject.subjectCode, onChange: function (ev) { return _this.setState({
                                subject: subjects.filter(function (s) { return s.code === ev.target.value; }).map(function (s) { return ({
                                    subjectCode: s.code,
                                    subjectName: s.name
                                }); })[0]
                            }); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj \u00E4mne"], ["V\u00E4lj \u00E4mne"])))),
                            subjects.map(function (subject) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: subject.code, value: subject.code }, subject.name); }));
                    })))) : null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { disabled: !this.isValidState(), className: ["btn", "btn-large", this.isValidState() ? "" : "disabled"].join(' '), onClick: function () { return _this.isValidState() ?
                        _this.createCourse() : alert(_this.isValidState(true)); } }, "Skapa"))));
    };
    return _CreateStandardCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));
var CreateStandardCourse = Object(react_router__WEBPACK_IMPORTED_MODULE_4__["withRouter"])(_CreateStandardCourse);
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6;


/***/ }),

/***/ "./src/components/course-builder-ks/admin/courses/delete-standard-course.tsx":
/*!***********************************************************************************!*\
  !*** ./src/components/course-builder-ks/admin/courses/delete-standard-course.tsx ***!
  \***********************************************************************************/
/*! exports provided: DeleteStandardCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeleteStandardCourse", function() { return DeleteStandardCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utility-components/live-query-view */ "./src/components/utility-components/live-query-view.tsx");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var react_router__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-router */ "./node_modules/react-router/es/index.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var DeleteStandardCourse = Object(react_router__WEBPACK_IMPORTED_MODULE_4__["withRouter"])(Object(_utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_2__["liveQueryView"])(function (_a) {
    var courseId = _a.courseId, history = _a.history;
    return _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseInstances.ids([courseId]).toValue()
        .combineLatest(_globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].branches.tags(courseId).idsOnly().map(function (_a) {
        var id = _a.id;
        return id;
    }))
        .combineLatest(_globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseBlocks.tags(courseId).idsOnly().map(function (_a) {
        var id = _a.id;
        return id;
    }))
        .combineLatest(_globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseContents.tags(courseId).idsOnly().map(function (_a) {
        var id = _a.id;
        return id;
    }))
        .combineLatest(_globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseTabs.tags(courseId).idsOnly().map(function (_a) {
        var id = _a.id;
        return id;
    }))
        .combineLatest(_globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].tasks.tags(courseId).idsOnly().map(function (_a) {
        var id = _a.id;
        return id;
    }))
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), a = _b[0], b = _b[1];
        return ({
            courses: a[0][0][0][0],
            branchIds: a[0][0][0][1],
            courseBlockIds: a[0][0][1],
            courseContentIds: a[0][1],
            courseTabIds: a[1],
            taskIds: b
        });
    })
        .map(function (_a) {
        var courses = _a.courses, branchIds = _a.branchIds, courseBlockIds = _a.courseBlockIds, courseContentIds = _a.courseContentIds, courseTabIds = _a.courseTabIds, taskIds = _a.taskIds;
        if (courses.length === 0)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursen \u00E4r nu borttagen"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { className: "btn btn-large", to: "/admin" }, "Till adminverktygets startsida"));
        var course = courses[0];
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: ["entitymeta-" + course.$meta].join(' ') },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Bekr\u00E4fta borttagning av standardkursen ",
                course.name,
                " "),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "F\u00F6ljande relaterade objekt kommer ocks\u00E5 att tas bort"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Tempor\u00E4ra utkast: ",
                branchIds.length,
                " st"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Kursblock: ",
                courseBlockIds.length,
                " st"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Inneh\u00E5llsrutor (totalt inklusive skolors egna varianter): ",
                courseContentIds.length,
                " st"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Flikar (totalt inklusive skolors egna varianter): ",
                courseTabIds.length,
                " st"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Uppgifter (totalt inklusive skolors egna varianter): ",
                taskIds.length,
                " st"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn btn-large", onClick: function () { return history.go(-1); } }, "Avbryt"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () {
                    var _a, _b, _c, _d, _e;
                    // Delete all draft ids.
                    (_a = _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].branches).delete.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](branchIds));
                    // Delete all descendant ids:
                    (_b = _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseBlocks).delete.apply(_b, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseBlockIds));
                    (_c = _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseContents).delete.apply(_c, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseContentIds));
                    (_d = _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseTabs).delete.apply(_d, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseTabIds));
                    (_e = _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].tasks).delete.apply(_e, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](taskIds));
                    // Delete the course itself
                    _globals_db__WEBPACK_IMPORTED_MODULE_3__["db"].courseInstances.delete(course.id);
                } }, "Bekr\u00E4fta borttagning av kurs"));
    });
}, {
    spinner: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
        "H\u00E4mtar relaterade objekt... ",
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null))
}));


/***/ }),

/***/ "./src/components/course-builder-ks/admin/courses/edit-course-block-requirements.tsx":
/*!*******************************************************************************************!*\
  !*** ./src/components/course-builder-ks/admin/courses/edit-course-block-requirements.tsx ***!
  \*******************************************************************************************/
/*! exports provided: CourseBlockRequirements */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBlockRequirements", function() { return CourseBlockRequirements; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../course-builder/sub-components/knowledge-matrix */ "./src/components/course-builder/sub-components/knowledge-matrix.tsx");
/* harmony import */ var _utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utility-components/lazy-content */ "./src/components/utility-components/lazy-content.tsx");
/* harmony import */ var _logic_get_course_codes_from_tags__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../logic/get-course-codes-from-tags */ "./src/components/course-builder-ks/logic/get-course-codes-from-tags.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _logic_get_standard_courses_with_ordered_requirements__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../logic/get-standard-courses-with-ordered-requirements */ "./src/components/course-builder-ks/logic/get-standard-courses-with-ordered-requirements.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _course_builder_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../course-builder/sub-components/select-related-docs */ "./src/components/course-builder/sub-components/select-related-docs.tsx");
/* harmony import */ var _utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../utility-components/live-query-view */ "./src/components/utility-components/live-query-view.tsx");
/* harmony import */ var _course_builder_courses_business_logic__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../course-builder/courses/business-logic */ "./src/components/course-builder/courses/business-logic.ts");











var CourseBlockRequirements = Object(_utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_9__["liveQueryView"])(function (_a) {
    var _b;
    var repo = _a.repo, course = _a.course, block = _a.block;
    var courseCodes = Object(_logic_get_course_codes_from_tags__WEBPACK_IMPORTED_MODULE_4__["getCourseCodesFromTags"])(block.tags);
    var courseCodeTags = courseCodes.map(function (code) { return "course:" + code; });
    return Object(_logic_get_standard_courses_with_ordered_requirements__WEBPACK_IMPORTED_MODULE_6__["getStandardCoursesWithOrderedRequirements"])(courseCodes)
        .combineLatest((_b = repo.courseBlocks
        .hasEdgesFrom([course.id])) // Same parent give me sibling blocks!
    .tags.apply(_b, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseCodeTags)).include("abilities", "centralContent", "knowledgeRequirements")
        .includeIdsOnly()) // So we can detect non-covered requirements
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), courseTemplates = _b[0], siblingBlocks = _b[1];
        var uncoveredIds = Object(_course_builder_courses_business_logic__WEBPACK_IMPORTED_MODULE_10__["getIdsNotCoveredByReqReferencingDocs"])(courseTemplates, siblingBlocks);
        if (courseTemplates.length === 0)
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Blocket \u00E4r inte kopplad till n\u00E5gon \u00E5rskurs"], ["Blocket \u00E4r inte kopplad till n\u00E5gon \u00E5rskurs"]))));
        return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", null, courseTemplates.map(function (_a) {
            var id = _a.id, name = _a.name, abilities = _a.abilities, centralContent = _a.centralContent, knowledgeRequirements = _a.knowledgeRequirements;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { key: id },
                courseTemplates.length === 1 ? undefined : react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h1", null, name),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_7__["OpenCloseBox"], { className: "larger", title: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj blockets kunskapskrav"], ["V\u00E4lj blockets kunskapskrav"])))) },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Markera de kunskapskrav som blocket ska t\u00E4cka."], ["Markera de kunskapskrav som blocket ska t\u00E4cka."])))),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_3__["LazyContent"], null, repo["knowledge-requirements"].hasEdgesFrom([block.id]).idsOnly().toValue().map(function (blockKrs) {
                        return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_2__["KnowledgeMatrix"], { knowledgeRequirements: knowledgeRequirements, markedIds: blockKrs.map(function (_a) {
                                var id = _a.id;
                                return id;
                            }), idsToMarkNotOk: uncoveredIds, markMode: true, onMarkChanged: function (markedId, isMarked) {
                                // Remove invalid knowledge requirements (those that are not part of the standard course)
                                // Can happen after changing school year / course or subject.
                                var invalidKrs = blockKrs.filter(function (kr) { return !knowledgeRequirements.some(function (_a) {
                                    var id = _a.id;
                                    return kr.id === id;
                                }); });
                                invalidKrs.forEach(function (invalidKr) {
                                    repo.courseBlocks.removeRelated(block.id, "knowledgeRequirements", invalidKr);
                                });
                                var markedDoc = knowledgeRequirements.filter(function (_a) {
                                    var id = _a.id;
                                    return id === markedId;
                                })[0];
                                if (isMarked) {
                                    repo.courseBlocks.addRelated(block.id, "knowledgeRequirements", markedDoc);
                                }
                                else {
                                    repo.courseBlocks.removeRelated(block.id, "knowledgeRequirements", markedDoc);
                                }
                            } });
                    }))),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_3__["LazyContent"], null, repo.abilities.hasEdgesFrom([block.id]).idsOnly().toValue().map(function (blockAbilities) {
                    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_8__["SelectRelatedDocs"], { options: abilities, title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj blockets f\u00F6rm\u00E5gor"], ["V\u00E4lj blockets f\u00F6rm\u00E5gor"]))), markedIds: blockAbilities.map(function (_a) {
                            var id = _a.id;
                            return id;
                        }), uncoveredIds: uncoveredIds, markMode: true, 
                        //migratedIds={task && task.migratedTexts && task.migratedTexts.abilities}
                        onMarkChanged: function (markedId, isMarked) {
                            // Remove invalid abilities (those that are not part of the standard course)
                            // Can happen after changing school year / course or subject.
                            var invalidAbilities = blockAbilities.filter(function (a) { return !abilities.some(function (_a) {
                                var id = _a.id;
                                return a.id === id;
                            }); });
                            invalidAbilities.forEach(function (invalidAbility) {
                                repo.courseBlocks.removeRelated(block.id, "abilities", invalidAbility);
                            });
                            var markedDoc = abilities.filter(function (_a) {
                                var id = _a.id;
                                return id === markedId;
                            })[0];
                            if (isMarked) {
                                repo.courseBlocks.addRelated(block.id, "abilities", markedDoc);
                            }
                            else {
                                repo.courseBlocks.removeRelated(block.id, "abilities", markedDoc);
                            }
                        } });
                })),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_3__["LazyContent"], null, repo["central-content"].hasEdgesFrom([block.id]).idsOnly().toValue().map(function (blockCCs) {
                    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_8__["SelectRelatedDocs"], { options: centralContent, title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj blockets centrala inneh\u00E5ll"], ["V\u00E4lj blockets centrala inneh\u00E5ll"]))), markedIds: blockCCs.map(function (cc) { return cc.id; }), uncoveredIds: uncoveredIds, markMode: true, 
                        //migratedIds={task && task.migratedTexts && task.migratedTexts.centralContent}
                        onMarkChanged: function (markedId, isMarked) {
                            // Remove invalid central contents (those that are not part of the standard course)
                            // Can happen after changing school year / course or subject.
                            var invalidCentralContents = blockCCs.filter(function (cc) { return !centralContent.some(function (_a) {
                                var id = _a.id;
                                return cc.id === id;
                            }); });
                            invalidCentralContents.forEach(function (invalidCC) {
                                repo.courseBlocks.removeRelated(block.id, "centralContent", invalidCC);
                            });
                            var markedDoc = centralContent.filter(function (_a) {
                                var id = _a.id;
                                return id === markedId;
                            })[0];
                            if (isMarked) {
                                repo.courseBlocks.addRelated(block.id, "centralContent", markedDoc);
                            }
                            else {
                                repo.courseBlocks.removeRelated(block.id, "centralContent", markedDoc);
                            }
                        } });
                })));
        }));
    });
});
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-builder-ks/admin/courses/edit-standard-course-blocks.tsx":
/*!****************************************************************************************!*\
  !*** ./src/components/course-builder-ks/admin/courses/edit-standard-course-blocks.tsx ***!
  \****************************************************************************************/
/*! exports provided: EditStandardCourseBlocks, CourseBlockSettings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditStandardCourseBlocks", function() { return EditStandardCourseBlocks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBlockSettings", function() { return CourseBlockSettings; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../logic/course-instance-tags */ "./src/components/course-builder-ks/logic/course-instance-tags.ts");
/* harmony import */ var _edit_course_block_requirements__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./edit-course-block-requirements */ "./src/components/course-builder-ks/admin/courses/edit-course-block-requirements.tsx");







var EditStandardCourseBlocks = function (_a) {
    var repo = _a.repo, course = _a.course;
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", null,
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursblock"], ["Kursblock"])))),
        course.blocks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("blockNo")).map(function (block, idx) {
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(CourseBlockSettings, { key: block.id, block: block, course: course, repo: repo, isLastBlock: idx === course.blocks.length - 1 });
        }),
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("button", { className: "btn", onClick: function () { return addCourseBlock(repo, course); } },
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("i", { className: "fa fa-plus", "aria-hidden": "true" }),
            " ", Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till block"], ["L\u00E4gg till block"])))),
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("br", null));
};
var CourseBlockSettings = function (_a) {
    var block = _a.block, course = _a.course, repo = _a.repo, isLastBlock = _a.isLastBlock;
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null,
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "ked_boxed", style: { position: "relative" } },
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h4", null,
                "Block ",
                block.blockNo), Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Steg"], ["Steg"]))),
            " ",
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "btn-group" }, block.stepNumbers.map(function (stepNo) {
                return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a", { key: stepNo, className: "btn btn-small step-button" }, stepNo);
            })),
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("form", null,
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs"], ["\u00C5rskurs"])))),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("select", { value: Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_5__["getSchoolYears"])(block.tags)[0] || "", onChange: function (ev) { return repo.courseBlocks.update(block, {
                        tags: Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_5__["computeTagsFromSchoolYears"])(block.tags, [ev.target.value].filter(function (x) { return !!x; }))
                    }); } },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj \u00E5rskurser"], ["V\u00E4lj \u00E5rskurser"])))),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "1-3" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 1-3"], ["\u00C5rskurs 1-3"])))),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "4-6" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 4-6"], ["\u00C5rskurs 4-6"])))),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "7-9" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 7-9"], ["\u00C5rskurs 7-9"])))))),
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("br", null),
            Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_5__["getSchoolYears"])(block.tags).length > 0 ?
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_edit_course_block_requirements__WEBPACK_IMPORTED_MODULE_6__["CourseBlockRequirements"], { block: block, course: course, repo: repo }) :
                undefined,
            isLastBlock ? react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_4__["RemoveItem"], { title: "Ta bort blocket", style: { display: 'inline-block', position: "absolute", top: 0, right: 0 }, onClick: function () { return confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_9 || (templateObject_9 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort blocket?"], ["Ta bort blocket?"])))) &&
                    repo.courseInstances.removeRelated(course.id, "blocks", block); } })
                : null),
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("hr", null));
};
function addCourseBlock(repo, course) {
    var lastBlock = course.blocks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("blockNo")).slice().pop();
    var blockNo = lastBlock ? lastBlock.blockNo + 1 : 1;
    var firstStepNo = lastBlock ?
        lastBlock.stepNumbers[lastBlock.stepNumbers.length - 1] + 1 :
        1;
    var newBlock = {
        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
        acl: [
            'schoolRole:standard/EMPLOYEE:S',
            'role:USER:R'
        ],
        blockNo: blockNo,
        locked: true,
        name: "Block " + blockNo,
        tags: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([course.id], course.tags.filter(function (tag) { return tag.startsWith("course:") || tag.startsWith("sub:"); })),
        stepNumbers: [firstStepNo, firstStepNo + 1, firstStepNo + 2, firstStepNo + 3, firstStepNo + 4]
    };
    repo.courseInstances.addRelated(course.id, "blocks", newBlock);
    newBlock.stepNumbers.forEach(function (stepNo) {
        var introductionTab = {
            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
            type: 'step-course-tab',
            tabClass: 'intro-tab',
            tabTitle: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_10 || (templateObject_10 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Introduktion"], ["Introduktion"]))),
            name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_11 || (templateObject_11 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Introduktion"], ["Introduktion"]))),
            locked: true,
            acl: [
                'schoolRole:standard/EMPLOYEE:S',
                'role:USER:R'
            ],
            stepNo: stepNo,
            order: 0,
            tags: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([course.id], course.tags.filter(function (tag) { return tag.startsWith("course:") || tag.startsWith("sub:"); }))
        };
        repo.courseBlocks.addRelated(newBlock.id, "tabs", introductionTab);
    });
}
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11;


/***/ }),

/***/ "./src/components/course-builder-ks/admin/courses/edit-standard-course.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/course-builder-ks/admin/courses/edit-standard-course.tsx ***!
  \*********************************************************************************/
/*! exports provided: EditStandardCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditStandardCourse", function() { return EditStandardCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var _utility_components_form_field__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utility-components/form-field */ "./src/components/utility-components/form-field.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../utility-components/live-query-view */ "./src/components/utility-components/live-query-view.tsx");
/* harmony import */ var _logic_publish_course__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../logic/publish-course */ "./src/components/course-builder-ks/logic/publish-course.ts");
/* harmony import */ var _utility_components_multiselect__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../utility-components/multiselect */ "./src/components/utility-components/multiselect.tsx");
/* harmony import */ var _utility_components_checklist__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../utility-components/checklist */ "./src/components/utility-components/checklist.tsx");
/* harmony import */ var _logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../logic/course-instance-tags */ "./src/components/course-builder-ks/logic/course-instance-tags.ts");
/* harmony import */ var _edit_standard_course_blocks__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./edit-standard-course-blocks */ "./src/components/course-builder-ks/admin/courses/edit-standard-course-blocks.tsx");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../../access-control */ "./src/access-control/index.ts");
var _this = undefined;
















var EditStandardCourse = Object(react_router_dom__WEBPACK_IMPORTED_MODULE_7__["withRouter"])(Object(_utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_8__["liveQueryView"])(function (_a) {
    var courseId = _a.courseId, history = _a.history;
    return _globals_db__WEBPACK_IMPORTED_MODULE_2__["CourseInstances"].getOrCreateBranchId(_globals_db__WEBPACK_IMPORTED_MODULE_2__["Schools"].standardSchool, courseId)
        .map(function (branchId) { return _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].branch(branchId); })
        .switchMap(function (branch) {
        return branch.courseInstances.include("blocks").id(courseId).map(function (course) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_3__["TextInput"], { autoFocus: true, label: "Namn", id: "CourseInstance:name", placeholder: "", value: course.name, onChange: function (name) { return branch.courseInstances.update(course, { name: name }); } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_4__["TextAreaFormField"], { label: "Beskrivning", id: "CourseInstance:description", rows: 7, placeholder: "", value: course.description, onChange: function (description) {
                    branch.courseInstances.update(course, { description: description });
                } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_5__["FormField"], { label: "Typ", id: "CourseInstance:type" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { disabled: true, type: "radio", name: "course-type", checked: course.type === 'step-course', id: "CourseInstance:type", onChange: function (ev) { return ev.target.checked && branch.courseInstances.update(course, { type: 'step-course' }); } }),
                        " Stegkurs")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { disabled: true, type: "radio", name: "course-type", checked: course.type === 'theme-course', id: "CourseInstance:type", onChange: function (ev) { return ev.target.checked && branch.courseInstances.update(course, { type: 'theme-course' }); } }),
                        " Temakurs"))),
            course.type === 'step-course' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_5__["FormField"], { label: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mne"], ["\u00C4mne"]))), id: "CourseInstance:subject" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { id: "CourseInstance:subject" }, course.subject.subjectName))) : null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("form", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4ndringspolicy"], ["\u00C4ndringspolicy"])))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_checklist__WEBPACK_IMPORTED_MODULE_11__["Checklist"], { available: [
                        { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Till\u00E5t skolor skapa egna flikar"], ["Till\u00E5t skolor skapa egna flikar"]))), key: "allowAddTabs" },
                        { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Till\u00E5t skolor d\u00F6lja standardflikar"], ["Till\u00E5t skolor d\u00F6lja standardflikar"]))), key: "allowRemoveTabs" },
                        { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Till\u00E5t skolor \u00E4ndra ordningen mellan standardflikar"], ["Till\u00E5t skolor \u00E4ndra ordningen mellan standardflikar"]))), key: "allowReorderTabs" },
                    ], selected: [
                        course.allowAddTabs && "allowAddTabs",
                        course.allowRemoveTabs && "allowRemoveTabs",
                        course.allowReorderTabs && "allowReorderTabs"
                    ].filter(function (x) { return !!x; }), onChange: function (selectedPolicy) { return branch.courseInstances.update(course, {
                        allowAddTabs: selectedPolicy.includes("allowAddTabs"),
                        allowRemoveTabs: selectedPolicy.includes("allowRemoveTabs"),
                        allowReorderTabs: selectedPolicy.includes("allowReorderTabs"),
                    }); } })),
            course.type === 'step-course' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_12__["getSubjectCodes"])(course.tags).length > 0 ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_standard_course_blocks__WEBPACK_IMPORTED_MODULE_13__["EditStandardCourseBlocks"], { repo: branch, course: course }) : undefined) : undefined,
            course.type === 'theme-course' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("form", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kopplade \u00E4mnen"], ["Kopplade \u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_multiselect__WEBPACK_IMPORTED_MODULE_10__["Multiselect"], { selected: (course.subjects || []).map(function (_a) {
                            var name = _a.name, code = _a.code;
                            return ({ name: name, key: code });
                        }), getOptions: function () { return _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].subjects.tags('schoolType:primary').map(function (s) { return ({ name: s.name, key: s.code }); }).toValue().load(); }, onChange: function (selectedOptions) { return branch.courseInstances.update(course, {
                            tags: Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_12__["computeTagsFromSubjectCodes"])(course.tags, selectedOptions.map(function (o) { return o.key; })),
                            subjects: selectedOptions.map(function (option) { return ({ name: option.name, code: option.key }); })
                        }); } })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("form", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurser som ska ing\u00E5"], ["\u00C5rskurser som ska ing\u00E5"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_checklist__WEBPACK_IMPORTED_MODULE_11__["Checklist"], { available: [
                            { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 1-3"], ["\u00C5rskurs 1-3"]))), key: "1-3" },
                            { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_9 || (templateObject_9 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 4-6"], ["\u00C5rskurs 4-6"]))), key: "4-6" },
                            { name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_10 || (templateObject_10 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C5rskurs 7-9"], ["\u00C5rskurs 7-9"]))), key: "7-9" }
                        ], selected: Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_12__["getSchoolYears"])(course.tags), onChange: function (selectedSchoolYears) { return branch.courseInstances.update(course, {
                            tags: Object(_logic_course_instance_tags__WEBPACK_IMPORTED_MODULE_12__["computeTagsFromSchoolYears"])(course.tags, selectedSchoolYears)
                        }); } }))) : undefined,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            course.tags.includes('active') ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large pull-right", onClick: function () { return branch.courseInstances.update(course, { tags: { $remove: ["active"] } }); } }, "Inaktivera") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large pull-right", onClick: function () { return branch.courseInstances.update(course, { tags: { $add: ["active"] } }); } }, "Aktivera"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_7__["Link"], { className: "btn btn-warning btn-large pull-right", to: "/admin/courses/" + courseId + "/confirm-delete" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_11 || (templateObject_11 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera ..."], ["Radera ..."])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large btn-warning", onClick: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                Object(_logic_publish_course__WEBPACK_IMPORTED_MODULE_9__["publishCourse"])({ school: "standard", draftRepo: branch, course: course });
                                return [4 /*yield*/, _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].saveNow()];
                            case 1:
                                _a.sent();
                                location.href = Object(_access_control__WEBPACK_IMPORTED_MODULE_15__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_14__["default"].KED_SUBJECT_PLANNER_URL + "#/standard/courses/" + courseId, {});
                                return [2 /*return*/];
                        }
                    });
                }); } }, "Publicera")); });
    });
}));
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11;
/*async function deleteCourse(course: CourseInstance) {
  try {
    // Get course's drafts on all schools
    // Get ids of all related entities (search by entities tags with course id)
    const [
      draftBranchIds,
      courseBlockIds,
      courseContentIds,
      couresTabsIds,
      tasksIds] = await Promise.all([
        db.branches.tags(course.id).load(),
        db.courseBlocks.tags(course.id).load(),
        db.courseContents.tags(course.id).load(),
        db.courseTabs.tags(course.id).load(),
        db.tasks.tags(course.id).load()
      ]);

    // Delete all draft ids.
    db.branches.delete(...draftBranchIds);
    // Delete all descendant ids:
    db.courseBlocks.delete(...courseBlockIds);
    db.courseContents.delete(...courseContentIds);
    db.courseTabs.delete(...couresTabsIds);
    db.tasks.delete(...tasksIds);

    // Delete the course itself
    db.courseInstances.delete(course.id);

  } catch (error) {
    showError(error);
  }
}*/


/***/ }),

/***/ "./src/components/course-builder-ks/admin/index.tsx":
/*!**********************************************************!*\
  !*** ./src/components/course-builder-ks/admin/index.tsx ***!
  \**********************************************************/
/*! exports provided: SubjectPlannerAdminApp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectPlannerAdminApp", function() { return SubjectPlannerAdminApp; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _routes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./routes */ "./src/components/course-builder-ks/admin/routes.tsx");
/* harmony import */ var _common_banner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/banner */ "./src/components/course-builder-ks/common/banner.tsx");
/* harmony import */ var _utility_components_loading_indicator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utility-components/loading-indicator */ "./src/components/utility-components/loading-indicator.tsx");






var SubjectPlannerAdminApp = function () {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_1__["HashRouter"], null,
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
            _routes__WEBPACK_IMPORTED_MODULE_3__["ROUTES"].map(function (_a, index) {
                var exact = _a.exact, path = _a.path, tabId = _a.tabId, title = _a.title, content = _a.content;
                return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_1__["Route"], { key: index, path: path, exact: exact, component: function (routeProps) { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_common_banner__WEBPACK_IMPORTED_MODULE_4__["Banner"], { activeTab: tabId || "$", tabs: _routes__WEBPACK_IMPORTED_MODULE_3__["TABS_ARRAY"], title: title || "", backgroundImage: "https://ks.kunskapsporten.se/images/18.6323bc4d15f4831f9c82dedf/theme.jpg" }),
                        content(routeProps)); } });
            }),
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_2__["ErrorSuccessFeedback"], null),
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_loading_indicator__WEBPACK_IMPORTED_MODULE_5__["LoadingIndicator"], null)));
};


/***/ }),

/***/ "./src/components/course-builder-ks/admin/routes.tsx":
/*!***********************************************************!*\
  !*** ./src/components/course-builder-ks/admin/routes.tsx ***!
  \***********************************************************/
/*! exports provided: TABS, ROUTES, TABS_ARRAY */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TABS", function() { return TABS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ROUTES", function() { return ROUTES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TABS_ARRAY", function() { return TABS_ARRAY; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_create_standard_course__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./courses/create-standard-course */ "./src/components/course-builder-ks/admin/courses/create-standard-course.tsx");
/* harmony import */ var _common_two_columns_page__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/two-columns-page */ "./src/components/course-builder-ks/common/two-columns-page.tsx");
/* harmony import */ var _common_standard_course_instance_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../common/standard-course-instance-list */ "./src/components/course-builder-ks/common/standard-course-instance-list.tsx");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _courses_edit_standard_course__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./courses/edit-standard-course */ "./src/components/course-builder-ks/admin/courses/edit-standard-course.tsx");
/* harmony import */ var _courses_delete_standard_course__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./courses/delete-standard-course */ "./src/components/course-builder-ks/admin/courses/delete-standard-course.tsx");
/* harmony import */ var _course_builder_subjects_subjects_inner__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../course-builder/subjects/subjects-inner */ "./src/components/course-builder/subjects/subjects-inner.tsx");
/* harmony import */ var _course_builder_subjects_show_subject_inner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../course-builder/subjects/show-subject-inner */ "./src/components/course-builder/subjects/show-subject-inner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_schools__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../course-builder/schools */ "./src/components/course-builder/schools/index.tsx");
/* harmony import */ var _course_builder_schools_edit_school__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../course-builder/schools/edit-school */ "./src/components/course-builder/schools/edit-school.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
















var RedirectFromRoot = function () {
    var _a = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser, roles = _a.roles, school = _a.school;
    if (roles.includes("ADMIN") || Object(_access_control__WEBPACK_IMPORTED_MODULE_15__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser, "standard"))
        return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Redirect"], { to: "/admin" });
    location.href = Object(_access_control__WEBPACK_IMPORTED_MODULE_15__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_SUBJECT_PLANNER_URL, {});
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", null);
    /*return roles.includes("ADMIN") ?
      <Redirect to="/admin" /> :
    //roles.includes("EMPLOYEE") ?
    //<Redirect to={`/${school}/courses/edit`} /> :
      <Redirect to={`/admin/courses`} />;*/
};
var TABS = {
    $: ['/admin', react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, "Start")],
    //courses: ['/admin/courses', <>Kurser</>],
    schools: ["/schools", react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, "Skolor")],
    import: ['/admin/import', react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, "Import")],
};
var ROUTES = [
    {
        path: "/",
        exact: true,
        content: function () { return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(RedirectFromRoot, null); }
    },
    {
        path: "/admin",
        exact: true,
        tabId: "$",
        title: "Ämnesplaneraren Admin",
        content: function () { return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Redirect"], { to: "/admin/courses/create" }); }
    },
    {
        path: "/admin/courses/create",
        exact: true,
        tabId: "$",
        title: "Skapa standardkurs",
        content: function () {
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_two_columns_page__WEBPACK_IMPORTED_MODULE_3__["TwoColumnsPage"], { left: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_courses_create_standard_course__WEBPACK_IMPORTED_MODULE_2__["CreateStandardCourse"], null), right: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_standard_course_instance_list__WEBPACK_IMPORTED_MODULE_4__["StandardCourseInstanceList"], null), rightWidth: 5 });
        }
    }, {
        path: "/admin/courses/:courseId/settings",
        exact: true,
        tabId: "$",
        title: "Ämnesplaneraren Admin",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_two_columns_page__WEBPACK_IMPORTED_MODULE_3__["TwoColumnsPage"], { left: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_courses_edit_standard_course__WEBPACK_IMPORTED_MODULE_8__["EditStandardCourse"], { courseId: match.params.courseId }), right: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_standard_course_instance_list__WEBPACK_IMPORTED_MODULE_4__["StandardCourseInstanceList"], null), rightWidth: 5 });
        }
    }, {
        path: "/admin/courses/:courseId/confirm-delete",
        exact: true,
        tabId: "$",
        title: "Bekräfta radering av standardkurs",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_two_columns_page__WEBPACK_IMPORTED_MODULE_3__["TwoColumnsPage"], { left: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_courses_delete_standard_course__WEBPACK_IMPORTED_MODULE_9__["DeleteStandardCourse"], { courseId: match.params.courseId }), right: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_common_standard_course_instance_list__WEBPACK_IMPORTED_MODULE_4__["StandardCourseInstanceList"], null), rightWidth: 5 });
        }
    }, {
        path: "/admin/import",
        exact: true,
        tabId: 'import',
        title: "Import från Skolverket",
        content: function () { return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_subjects_subjects_inner__WEBPACK_IMPORTED_MODULE_10__["SubjectsInner"], { linkPrefix: "/admin/import/" }); }
    }, {
        path: "/admin/import/:subjectId",
        exact: false,
        tabId: "import",
        title: "Import från skolverket",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_subjects_show_subject_inner__WEBPACK_IMPORTED_MODULE_11__["ShowSubjectInner"], { id: match.params.subjectId });
        }
    }, {
        path: "/schools",
        exact: true,
        tabId: "schools",
        title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_12__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolor"], ["Skolor"]))),
        content: function () { return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_schools__WEBPACK_IMPORTED_MODULE_13__["SchoolsWithoutBanner"], { viewCourseUrl: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_SUBJECT_PLANNER_URL }); }
    }, {
        path: "/schools/:schoolId/edit",
        tabId: "schools",
        title: "Skolor",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_schools_edit_school__WEBPACK_IMPORTED_MODULE_14__["EditSchoolNoBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_12__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera skola"], ["Redigera skola"]))), id: match.params.schoolId });
        }
    }, {
        path: "/schools/new/gymnasium",
        tabId: "schools",
        title: "Skolor",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_schools_edit_school__WEBPACK_IMPORTED_MODULE_14__["EditSchoolNoBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_12__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"]))), type: "gymnasium" });
        }
    }, {
        path: "/schools/new/primary",
        tabId: "schools",
        title: "Skolor",
        content: function (_a) {
            var match = _a.match;
            return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_schools_edit_school__WEBPACK_IMPORTED_MODULE_14__["EditSchoolNoBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_12__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"]))), type: "primary" });
        }
    }
];
var TABS_ARRAY = Object.keys(TABS).map(function (key) { return ({
    key: key,
    name: TABS[key][1],
    link: TABS[key][0]
}); });
var templateObject_1, templateObject_2, templateObject_3, templateObject_4;


/***/ }),

/***/ "./src/components/course-builder-ks/common/banner.tsx":
/*!************************************************************!*\
  !*** ./src/components/course-builder-ks/common/banner.tsx ***!
  \************************************************************/
/*! exports provided: LazyBanner, Banner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LazyBanner", function() { return LazyBanner; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Banner", function() { return Banner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var _utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utility-components/lazy-content */ "./src/components/utility-components/lazy-content.tsx");
/* harmony import */ var _course_builder_sub_components_ellipsis_loader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../course-builder/sub-components/ellipsis-loader */ "./src/components/course-builder/sub-components/ellipsis-loader.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");








var LazyBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LazyBanner, _super);
    function LazyBanner() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.dragState = new kedbackend_observable__WEBPACK_IMPORTED_MODULE_3__["Emitter"]({ tabBeingDragged: '', tabBeingHovered: '', insertBefore: false, originClientX: -1 });
        return _this;
    }
    LazyBanner.prototype.render = function () {
        var _this = this;
        var lazyProps = this.props.lazyProps;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer", style: { overflow: "visible" } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__["LazyContent"], { noError: true }, lazyProps.map(function (_a) {
                        var backgroundImage = _a.backgroundImage;
                        return backgroundImage && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("style", null, "\n              .pageHeader {\n                background-image: url('" + backgroundImage + "') !important;\n              }\n            ");
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pageHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__["LazyContent"], { noError: true }, lazyProps.map(function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, props.title); })))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__["LazyContent"], { noError: true }, lazyProps.map(function (_a) {
                            var cornerBox = _a.cornerBox;
                            return cornerBox &&
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pageHeaderCornerBox" }, cornerBox);
                        })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsField" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsContainer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__["LazyContent"], { spinner: react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_ellipsis_loader__WEBPACK_IMPORTED_MODULE_5__["EllipsisLoader"], null) }, lazyProps.map(function (_a) {
                                    var tabs = _a.tabs, buttons = _a.buttons, activeTab = _a.activeTab, blocks = _a.blocks, sortableTabs = _a.sortableTabs, onTabDrop = _a.onTabDrop;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                        blocks ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" }, blocks.map(function (block) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: block.id, className: "horizontalItem top" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-vertical" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, block.name)),
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" }, block.steps.map(function (step) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: step.stepNo },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Link"], { to: step.link, className: "btn btn-small step-button" + (step.isActive ? " activePage" : "") }, step.stepNo),
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null)); }))))); })) : null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: 'horizontalMenu' },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_lazy_content__WEBPACK_IMPORTED_MODULE_4__["LazyContent"], null, _this.dragState.map(function (_a) {
                                                var tabBeingDragged = _a.tabBeingDragged, tabBeingHovered = _a.tabBeingHovered, insertBefore = _a.insertBefore, originClientX = _a.originClientX;
                                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: sortableTabs ? "sortable" : null, onDrop: onTabDrop ? function (ev) {
                                                        if (tabBeingHovered && tabBeingDragged) {
                                                            onTabDrop(tabBeingDragged, tabBeingHovered, insertBefore ?
                                                                'before' : 'after');
                                                        }
                                                        _this.dragState.dispatch(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _this.dragState.value, { tabBeingHovered: '', tabBeingDragged: '' }));
                                                    } : null },
                                                    tabs.map(function (_a, idx) {
                                                        var name = _a.name, key = _a.key, link = _a.link, onClick = _a.onClick, draggable = _a.draggable;
                                                        var isActive = activeTab === key || (activeTab === '$' && idx === 0);
                                                        var dragState = _this.dragState;
                                                        name = name || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["(Namnl\u00F6s flik)"], ["(Namnl\u00F6s flik)"])));
                                                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: key },
                                                            insertBefore && tabBeingHovered === key ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: "drop-target", onDragOver: function (ev) { return ev.preventDefault(); } }, "\u00A0") : null,
                                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: [
                                                                    isActive ? "activePage" : "",
                                                                    key === tabBeingDragged ? "drag-source" : "",
                                                                    sortableTabs && draggable ? "draggable" : ""
                                                                ].filter(function (x) { return x; }).join(' '), draggable: sortableTabs && draggable, onDragStart: sortableTabs && draggable ? function (ev) {
                                                                    ev.dataTransfer.effectAllowed = "move";
                                                                    dragState.dispatch(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState.value, { originClientX: ev.clientX, tabBeingDragged: key }));
                                                                } : null, onDragOver: sortableTabs ? function (ev) {
                                                                    if (tabBeingDragged === key) {
                                                                        dragState.dispatch(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState.value, { tabBeingHovered: '' }));
                                                                        return;
                                                                    }
                                                                    if (!tabBeingDragged)
                                                                        return;
                                                                    ev.preventDefault();
                                                                    ev.dataTransfer.dropEffect = "move";
                                                                    //console.log("onDragOver: " + name + ". idx: " + idx + ". otherIdx: " + otherIdx);
                                                                    dragState.dispatch(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState.value, { tabBeingHovered: key, insertBefore: originClientX > ev.clientX }));
                                                                } : null, onDragEnd: function (ev) {
                                                                    _this.dragState.dispatch(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState.value, { tabBeingHovered: '', tabBeingDragged: '' }));
                                                                } }, link ? link.startsWith(":") ?
                                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(link.substr(1), {}) }, name) :
                                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Link"], { to: link }, name) :
                                                                onClick ?
                                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: onClick }, name) :
                                                                    name),
                                                            !insertBefore && tabBeingHovered === key ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: "drop-target", onDragOver: function (ev) { return ev.preventDefault(); } }, "\u00A0") : null);
                                                    }),
                                                    buttons && buttons.map(function (btn, idx) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: "action-tab", key: "btn" + idx }, btn); }));
                                            }))));
                                })))))))));
    };
    return LazyBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var Banner = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](LazyBanner, { lazyProps: new kedbackend_observable__WEBPACK_IMPORTED_MODULE_3__["Emitter"](props) }); };
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder-ks/common/side-list.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder-ks/common/side-list.tsx ***!
  \***************************************************************/
/*! exports provided: SideList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SideList", function() { return SideList; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");


var SideList = function (_a) {
    var items = _a.items, caption = _a.caption;
    return (react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h3", null, caption),
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "taskContainer odd-even" }, items.map(function (item) { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "schoolCourse", key: item.id },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: ["align-horizontal", item.$meta && "entitymeta-" + item.$meta].join(' ') },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "horizontalItem top pull-right" }, item.editLink.startsWith(':') ?
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: item.editLink.substr(1), className: "editItem" }) :
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_1__["Link"], { to: item.editLink, className: "editItem" })),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "horizontalItem top" }, item.viewLink.startsWith(':') ?
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: item.viewLink.substr(1) }, item.name) :
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_1__["Link"], { to: item.viewLink }, item.name)),
                    item.pills.map(function (pill, idx) {
                        return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { key: idx, className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: ["pill"].concat(pill.className).join(' ') }, pill.name));
                    })),
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null, item.description)),
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", { className: "small" }, item.smallText))); })))));
};


/***/ }),

/***/ "./src/components/course-builder-ks/common/standard-course-instance-list.tsx":
/*!***********************************************************************************!*\
  !*** ./src/components/course-builder-ks/common/standard-course-instance-list.tsx ***!
  \***********************************************************************************/
/*! exports provided: StandardCourseInstanceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StandardCourseInstanceList", function() { return StandardCourseInstanceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _side_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./side-list */ "./src/components/course-builder-ks/common/side-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utility-components/live-query-view */ "./src/components/utility-components/live-query-view.tsx");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _course_builder_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../course-builder/utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _logic_list_course_instances__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../logic/list-course-instances */ "./src/components/course-builder-ks/logic/list-course-instances.ts");









var StandardCourseInstanceList = Object(_utility_components_live_query_view__WEBPACK_IMPORTED_MODULE_4__["liveQueryView"])(function () {
    /*{
      loading: ()=><Spinner />,
      error: error => <p>Ojsan hoppsan fel: {error.message}</p>
    },*/
    return Object(_logic_list_course_instances__WEBPACK_IMPORTED_MODULE_8__["listCourseInstances"])()
        .orderBy("name")
        .map(function (_a) {
        var id = _a.id, $meta = _a.$meta, name = _a.name, description = _a.description, tags = _a.tags, type = _a.type, modifiedBy = _a.modifiedBy, modifiedDate = _a.modifiedDate;
        return ({
            id: id,
            type: type,
            $meta: $meta,
            name: name,
            description: description,
            viewLink: ":" + Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_5__["default"].KED_SUBJECT_PLANNER_URL, {}) + "#/standard/courses/" + id,
            editLink: "/admin/courses/" + id + "/settings",
            pills: tags.filter(function (tag) { return tag === "active"; })
                .map(function (tag) { return ({
                className: "active",
                name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Aktiv"], ["Aktiv"])))
            }); }),
            smallText: modifiedBy && modifiedDate && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Senast redigerad av ", " / ", ""], ["Senast redigerad av ", " / ", ""])), modifiedBy.name, Object(_course_builder_utils__WEBPACK_IMPORTED_MODULE_7__["shortDateFormat"])(modifiedDate))
        });
    })
        .toValue()
        .map(function (courseItems) {
        var stepCourseItems = courseItems.filter(function (course) { return course.type === 'step-course'; });
        var themeCourseItems = courseItems.filter(function (course) { return course.type === 'theme-course'; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_side_list__WEBPACK_IMPORTED_MODULE_2__["SideList"], { caption: "Stegkurser", items: stepCourseItems }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_side_list__WEBPACK_IMPORTED_MODULE_2__["SideList"], { caption: "Temakurser", items: themeCourseItems }));
    });
});
var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/course-builder-ks/common/two-columns-page.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder-ks/common/two-columns-page.tsx ***!
  \**********************************************************************/
/*! exports provided: TwoColumnsPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TwoColumnsPage", function() { return TwoColumnsPage; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var TwoColumnsPage = function (_a) {
    var left = _a.left, right = _a.right, rightWidth = _a.rightWidth;
    return (react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-" + (12 - rightWidth) }, left),
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-column-" + rightWidth }, right)))))));
};


/***/ }),

/***/ "./src/components/course-builder-ks/logic/course-instance-tags.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/course-instance-tags.ts ***!
  \************************************************************************/
/*! exports provided: getSubjectCodes, getSchoolYears, computeCourseInstanceTags, computeTagsFromSchoolYears, computeTagsFromSubjectCodes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSubjectCodes", function() { return getSubjectCodes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolYears", function() { return getSchoolYears; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computeCourseInstanceTags", function() { return computeCourseInstanceTags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computeTagsFromSchoolYears", function() { return computeTagsFromSchoolYears; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computeTagsFromSubjectCodes", function() { return computeTagsFromSubjectCodes; });
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");

function getSubjectCodes(tags) {
    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__["distinct"])((tags || [])
        .filter(function (tag) { return tag.startsWith("sub:"); })
        .map(function (tag) { return tag.substr("sub:".length); }));
    ;
}
function getSchoolYears(tags) {
    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__["distinct"])((tags || [])
        .filter(function (tag) { return tag.startsWith("course:"); })
        .map(function (tag) { return tag.substr(tag.indexOf("|") + 1); }) // School year is concatenated as pipe + schoolyear. Example: "GRGRFYS01|4-6"
    );
}
function computeCourseInstanceTags(tags, subjectCodes, schoolYears) {
    var otherTags = (tags || []).filter(function (tag) { return !tag.startsWith("course:") && !tag.startsWith("sub:"); });
    var subjectTags = subjectCodes.map(function (sub) { return "sub:" + sub; });
    var courseTags = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__["flatten"])(subjectCodes.map(function (sub) {
        return schoolYears.map(function (schoolYear) {
            return "course:" + sub + "|" + schoolYear;
        });
    }));
    return otherTags
        .concat(subjectTags)
        .concat(courseTags);
}
function computeTagsFromSchoolYears(tags, schoolYears) {
    //schoolYears = schoolYears.map(afterColon);
    var subjectCodes = getSubjectCodes(tags);
    return computeCourseInstanceTags(tags, subjectCodes, schoolYears);
}
function computeTagsFromSubjectCodes(tags, subjectCodes) {
    //subjectCodes = subjectCodes.map(afterColon);
    var schoolYears = getSchoolYears(tags);
    return computeCourseInstanceTags(tags, subjectCodes, schoolYears);
}
function afterColon(str) {
    var pColon = str.indexOf(':');
    return pColon >= 0 ?
        str.substr(pColon + 1) :
        str;
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/get-course-codes-from-tags.ts":
/*!******************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/get-course-codes-from-tags.ts ***!
  \******************************************************************************/
/*! exports provided: getCourseCodesFromTags */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCourseCodesFromTags", function() { return getCourseCodesFromTags; });
function getCourseCodesFromTags(tags) {
    return (tags || [])
        .filter(function (tag) { return tag.startsWith("course:"); })
        .map(function (courseTag) { return courseTag.substr("course:".length); });
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/get-standard-courses-with-ordered-requirements.ts":
/*!**************************************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/get-standard-courses-with-ordered-requirements.ts ***!
  \**************************************************************************************************/
/*! exports provided: getStandardCoursesWithOrderedRequirements */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getStandardCoursesWithOrderedRequirements", function() { return getStandardCoursesWithOrderedRequirements; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _ordered_requirements__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ordered-requirements */ "./src/components/course-builder-ks/logic/ordered-requirements.ts");




function getStandardCoursesWithOrderedRequirements(courseCodes) {
    var _a;
    var courseCodeTags = courseCodes.map(function (code) { return code.startsWith('course:') ? code : "course:" + code; });
    if (courseCodeTags.length === 0)
        return new kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["Emitter"]([]);
    return (_a = _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].courses.include("abilities", "centralContent", "knowledgeRequirements")).tags.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseCodeTags)).filter(function (course) { return course.isTemplate; }) // BUGBUG: In KG, we would need this filter, not KS. Need another authorized way of getting the standard course only!
        .map(function (course) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course, { abilities: Object(_ordered_requirements__WEBPACK_IMPORTED_MODULE_3__["getOrderedDocs"])(course.abilities, course.abilitiesOrder), centralContent: Object(_ordered_requirements__WEBPACK_IMPORTED_MODULE_3__["getOrderedDocs"])(course.centralContent, course.centralContentOrder), knowledgeRequirements: Object(_ordered_requirements__WEBPACK_IMPORTED_MODULE_3__["getOrderedDocs"])(course.knowledgeRequirements, course.knowledgeRequirementsOrder) })); }).toValue();
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/list-course-instances.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/list-course-instances.ts ***!
  \*************************************************************************/
/*! exports provided: listCourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "listCourseInstances", function() { return listCourseInstances; });
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");

function listCourseInstances() {
    return _globals_db__WEBPACK_IMPORTED_MODULE_0__["db"].courseInstances.hasEdgesFrom([_globals_db__WEBPACK_IMPORTED_MODULE_0__["globalId"]]);
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/ordered-requirements.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/ordered-requirements.ts ***!
  \************************************************************************/
/*! exports provided: getOrderedDocs, resolveRequirementOrder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getOrderedDocs", function() { return getOrderedDocs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "resolveRequirementOrder", function() { return resolveRequirementOrder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




function getOrderedDocs(docs, order, _a) {
    var appendLeftovers = (_a === void 0 ? { appendLeftovers: false } : _a).appendLeftovers;
    // Mark doc IDs that where present in given 'order' array.
    // Will be used to find left-overs that were not present in the 'order' array.
    var markedDocs = {};
    if (!docs || !order) {
        // Special case: no docs or no order. Don't fail. Just return docs as is.
        return docs;
    }
    // Map given 'order' array to corresponding docs. Also mark in markedDocs.
    var result = (docs && order ?
        order.map(function (id) {
            markedDocs[id] = true;
            return docs.find(function (doc) { return doc.id === id; });
        }).filter(function (doc) { return !!doc; }) :
        docs);
    if (appendLeftovers) {
        // If any leftovers are there, concat them at the end:
        var leftOvers = docs.filter(function (doc) { return !markedDocs[doc.id]; });
        return result.concat(leftOvers);
    }
    else {
        return result;
    }
}
function resolveRequirementOrder(obj, orderDefiner) {
    var _a;
    var orderDefiningDocObservable;
    if (orderDefiner) {
        // User provided the orderDefining doc (use case is when obj is a Course or Subject, which contains its order by itself. User then provides the Course or Subject in both args)
        orderDefiningDocObservable = new kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["Emitter"]([orderDefiner]);
    }
    else {
        var courseCodes = obj.tags.filter(function (tag) { return tag.startsWith("course:"); });
        if (courseCodes.length === 0) {
            return new kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["Emitter"](obj); // No course tags. Not possible to resolve order.
        }
        orderDefiningDocObservable = (_a = _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].courses).tags.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseCodes)).toValue();
    }
    return orderDefiningDocObservable.map(function (orderHolders) {
        var abilitiesOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.abilitiesOrder || []; }));
        var ccOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.centralContentOrder || []; }));
        var krOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.knowledgeRequirementsOrder || []; }));
        var objClone = Object.assign({}, obj);
        if (objClone.abilities)
            objClone.abilities = getOrderedDocs(obj.abilities, abilitiesOrder);
        if (objClone.centralContent)
            objClone.centralContent = getOrderedDocs(obj.centralContent, ccOrder);
        if (objClone.knowledgeRequirements)
            objClone.knowledgeRequirements = getOrderedDocs(obj.knowledgeRequirements, krOrder);
        return objClone;
    });
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/publish-course.ts":
/*!******************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/publish-course.ts ***!
  \******************************************************************/
/*! exports provided: publishCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "publishCourse", function() { return publishCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");



function publishCourse(_a) {
    var school = _a.school, draftRepo = _a.draftRepo, course = _a.course;
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var destinationRepo, schoolBranchId;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    if (!(school === "standard")) return [3 /*break*/, 1];
                    // Editing Standard School should merge to reality.
                    draftRepo.merge();
                    destinationRepo = _globals_db__WEBPACK_IMPORTED_MODULE_1__["db"];
                    return [3 /*break*/, 3];
                case 1: return [4 /*yield*/, _globals_db__WEBPACK_IMPORTED_MODULE_1__["db"].schools.name(school).single().map(function (school) { return school.officialBranchId; }).load()];
                case 2:
                    schoolBranchId = _b.sent();
                    draftRepo.merge(schoolBranchId);
                    destinationRepo = _globals_db__WEBPACK_IMPORTED_MODULE_1__["db"].branch(schoolBranchId);
                    _b.label = 3;
                case 3:
                    destinationRepo.courseInstances.update(course, {
                        modifiedDate: Date.now(),
                        modifiedBy: {
                            name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName,
                            url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail
                        }
                    });
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/courses/business-logic.ts":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/business-logic.ts ***!
  \*****************************************************************/
/*! exports provided: getUncoveredKnowledgeRequirements, getIdsNotCoveredByTasks, getIdsNotCoveredByReqReferencingDocs, sanityCheck, getTasksPerId, getSoftAccessList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUncoveredKnowledgeRequirements", function() { return getUncoveredKnowledgeRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByTasks", function() { return getIdsNotCoveredByTasks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByReqReferencingDocs", function() { return getIdsNotCoveredByReqReferencingDocs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sanityCheck", function() { return sanityCheck; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTasksPerId", function() { return getTasksPerId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSoftAccessList", function() { return getSoftAccessList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");



function getUncoveredKnowledgeRequirements(course) {
    var uncoveredRequirements = course.knowledgeRequirements.reduce(function (result, item) {
        result[item.id] = item;
        return result;
    }, {});
    course.tasks.forEach(function (task) {
        task.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredRequirements[kr.id];
        });
    });
    return Object.keys(uncoveredRequirements).map(function (id) { return uncoveredRequirements[id]; });
}
function getIdsNotCoveredByTasks(course) {
    return getIdsNotCoveredByReqReferencingDocs([course], course.tasks);
}
function getIdsNotCoveredByReqReferencingDocs(templates, docsBeingChecked) {
    var uncoveredIds = {};
    // 1. Mark the ids of all knowledge requirements, abilities and central content for this course:
    templates.forEach(function (course) {
        course.knowledgeRequirements.forEach(function (r) {
            uncoveredIds[r.id] = true;
        });
        course.abilities.forEach(function (a) {
            uncoveredIds[a.id] = true;
        });
        course.centralContent.forEach(function (cc) {
            uncoveredIds[cc.id] = true;
        });
    });
    // 2. List all tasks and unmark all ids that they refer to
    docsBeingChecked.forEach(function (doc) {
        doc.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredIds[kr.id];
        });
        doc.abilities.forEach(function (a) {
            delete uncoveredIds[a.id];
        });
        doc.centralContent.forEach(function (cc) {
            delete uncoveredIds[cc.id];
        });
    });
    return uncoveredIds;
}
function sanityCheck(course) {
    function hasDuplicateTasks(course) {
        var taskIds = {};
        return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])(course.modules.map(function (module) { return module.taskIds.map(function (taskId) {
            if (taskIds[taskId]) {
                var task = course.tasks.find(function (t) { return t.id === taskId; });
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""], ["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""])), task.name);
            }
            taskIds[taskId] = true;
        }).filter(function (x) { return x; }); }));
    }
    function tasksWithSameUrl(course) {
        var taskUrls = {};
        return course.tasks.map(function (task) {
            if (task.url) {
                if (taskUrls[task.url]) {
                    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""], ["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""])), taskUrls[task.url].name, task.name);
                }
                taskUrls[task.url] = task;
            }
        }).filter(function (x) { return x; });
    }
    function hasEmptyModuleNames(course) {
        return course.modules.some(function (module) { return module.name === ""; }) && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Det finns minst en modul utan angivet namn"], ["Det finns minst en modul utan angivet namn"])));
    }
    function hasDuplicateModuleNames(course) {
        var moduleNames = {};
        return course.modules.map(function (module) {
            if (module.name && moduleNames[module.name]) {
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"], ["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"])), module.name);
            }
            if (module.name)
                moduleNames[module.name] = true;
        });
    }
    var checks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])([
        hasDuplicateTasks(course),
        tasksWithSameUrl(course),
        hasEmptyModuleNames(course),
        hasDuplicateModuleNames(course)
    ]);
    return checks.filter(function (result) { return result; });
}
function getTasksPerId(course) {
    var result = {};
    function add(id, task) {
        var list = result[id] || (result[id] = []);
        list.push(task);
    }
    course.tasks.forEach(function (task) {
        task.abilities.forEach(function (a) { return add(a.id, task); });
        task.centralContent.forEach(function (c) { return add(c.id, task); });
        task.futureAbilities.forEach(function (fa) { return add(fa, task); });
    });
    return result;
}
/** Returns an access list for a course in a backward compatible way */
function getSoftAccessList(course) {
    var responsibleTeachers = course.responsibleTeachers;
    var result = responsibleTeachers.map(function (da) { return ({
        name: da.name,
        email: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getEmailFromDocAccess"])(da),
        access: da.access || 'edit'
    }); });
    return result;
}
var templateObject_1, templateObject_2, templateObject_3, templateObject_4;


/***/ }),

/***/ "./src/components/course-builder/courses/course-banner.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/course-banner.tsx ***!
  \*****************************************************************/
/*! exports provided: setCourseImage, CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setCourseImage", function() { return setCourseImage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");







var AdminMenuItems = [
    { name: "schools", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolor"], ["Skolor"]))), route: "/schools" },
    { name: "subjects", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnen"], ["\u00C4mnen"]))), route: "/subjects" },
];
var NonAdminMenuItems = [
    { name: "courseBuilder", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursbyggaren"], ["Kursbyggaren"]))), route: "/courses/new" },
    { name: "studentPage", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Elevsida"], ["Elevsida"]))), route: "" },
    { name: "feedback", text: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-commenting-o", "aria-hidden": "true" }),
            " Feedback"), route: "https://kg.kunskapsporten.se/kursbyggaren/" }
];
function onDropImage(ev, host, course, origCourse) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var files, url, items, file, form, res, _loop_1, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    ev.stopPropagation();
                    ev.preventDefault();
                    files = ev.dataTransfer.files;
                    url = null;
                    items = Array.from(ev.dataTransfer.items);
                    if (!(files.length > 0)) return [3 /*break*/, 3];
                    file = files[0];
                    if (file.size > 2 * 1024 * 1024) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"], ["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"]))));
                        return [2 /*return*/];
                    }
                    form = new FormData();
                    form.append("files", file);
                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.http.fetch('web-upload', 'put', {}, {}, {
                            body: form
                        })];
                case 1:
                    res = _a.sent();
                    if (res.status !== 200) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda upp filen till Google Storage"], ["Kunde inte ladda upp filen till Google Storage"]))));
                        return [2 /*return*/];
                    }
                    return [4 /*yield*/, res.text()];
                case 2:
                    url = _a.sent();
                    return [3 /*break*/, 7];
                case 3:
                    _loop_1 = function (i) {
                        var item;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    item = items[i];
                                    if (!item.type.match('^text/uri-list')) return [3 /*break*/, 2];
                                    return [4 /*yield*/, new Promise(function (resolve) { return item.getAsString(resolve); })];
                                case 1:
                                    // URI
                                    url = _a.sent();
                                    _a.label = 2;
                                case 2: return [2 /*return*/];
                            }
                        });
                    };
                    i = 0;
                    _a.label = 4;
                case 4:
                    if (!(i < items.length)) return [3 /*break*/, 7];
                    return [5 /*yield**/, _loop_1(i)];
                case 5:
                    _a.sent();
                    _a.label = 6;
                case 6:
                    ++i;
                    return [3 /*break*/, 4];
                case 7:
                    if (url == null) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"], ["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"]))));
                        return [2 /*return*/];
                    }
                    setCourseImage(course, origCourse, host, url);
                    return [2 /*return*/];
            }
        });
    });
}
function setCourseImage(course, origCourse, host, url) {
    var imageId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
    host.update({
        imageId: { $set: imageId },
        images: {
            $set: [{
                    id: imageId,
                    url: url,
                    acl: [
                        "role:USER:R",
                        "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school + "/EMPLOYEE:S"
                    ],
                    $meta: 'add'
                }]
        }
    });
}
/* This version had the bug that old images were not replaced.
One course at Uppsala contained 12 images.


export function setCourseImageOld(
  course: Course,
  origCourse: Course,
  host: ICourseEditorHost,
  url: string)
{
  if (!origCourse || !origCourse.imageId) {
    const imageId = createUUID();
    host.update({
      imageId: { $set: imageId },
      images: {
        $push: [{
          id: imageId,
          url,
          acl: course.isTemplate ? ["role:USER:R"] : ["role:USER:R", `schoolRole:${env.currentUser.school}/EMPLOYEE:S`],
          $meta: 'add'
        }]
      }
    });
  } else {
    // Update existing image:
    const imgIdx = course.images.findIndex(img => img.id === course.imageId);
    if (imgIdx >= 0) {
      const imageEntity = course.images[imgIdx];
      if (course.isTemplate) {
        // Templates: Update the template image content:
        host.update({
          images: {
            $splice: [[imgIdx, 1, {
              ...imageEntity,
              url,
              $meta: 'update'
            }]]
          }
        })
      } else {
        // Real courses: Replace with a new image
        const imageId = createUUID();
        host.update({
          imageId: { $set: imageId },
          images: {
            $splice: [[imgIdx, 1, {
              id: imageId,
              url,
              acl: [
                `role:USER:R`,
                `schoolRole:${env.currentUser.school}/EMPLOYEE:S`
              ],
              $meta: 'add'
            }]]
          }
        })
      }
    } else {
      showError(L`Kunde inte uppdatera bilden.`);
    }
  }
}
*/
var CourseBanner = function (props) {
    var title = props.title, isTemplate = props.isTemplate, host = props.host, course = props.course, origCourse = props.origCourse, backgroundImage = props.backgroundImage, activePage = props.activePage;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    var menuItems = NonAdminMenuItems;
    if (isAdmin)
        menuItems = AdminMenuItems.concat(menuItems);
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pageHeader", onDragOver: course && _utils__WEBPACK_IMPORTED_MODULE_3__["allowCopy"], onDrop: course && (function (ev) { return onDropImage(ev, host, course, origCourse); }) },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, menuItems.map(function (item) { return ({
                                    item: item,
                                    isActive: activePage === item.name,
                                    callback: props.callbacks && props.callbacks[item.name],
                                    givenRoute: (props.routes && props.routes[item.name]),
                                    defaultRoute: item.route
                                }); }).filter(function (x) { return x.callback || x.defaultRoute || x.givenRoute; }).map(function (_a) {
                                    var item = _a.item, isActive = _a.isActive, callback = _a.callback, defaultRoute = _a.defaultRoute, givenRoute = _a.givenRoute;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: item.name, className: isActive ? "activePage" : "", onClick: callback }, callback ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text) :
                                        defaultRoute || givenRoute ?
                                            givenRoute || /^http[s]\:\/\//i.test(defaultRoute) ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: givenRoute || defaultRoute }, item.text) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Link"], { to: defaultRoute }, item.text) :
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text));
                                })))))))));
};
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7;


/***/ }),

/***/ "./src/components/course-builder/knowledge-matrix-partial-utils.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-builder/knowledge-matrix-partial-utils.ts ***!
  \*************************************************************************/
/*! exports provided: getRequirmentSentences, getSavedSentences, allRequirementSentecesMarked, getPartialContentDefaultView, isPartialCoveredRequirment, getCoveredSenteces, getSortedRequirments, getMigrationTitle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getRequirmentSentences", function() { return getRequirmentSentences; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSavedSentences", function() { return getSavedSentences; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allRequirementSentecesMarked", function() { return allRequirementSentecesMarked; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPartialContentDefaultView", function() { return getPartialContentDefaultView; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isPartialCoveredRequirment", function() { return isPartialCoveredRequirment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCoveredSenteces", function() { return getCoveredSenteces; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSortedRequirments", function() { return getSortedRequirments; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getMigrationTitle", function() { return getMigrationTitle; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


//get sentences by requirement
function getRequirmentSentences(requirement) {
    return requirement.split(".").filter(function (e) { return e; });
}
//retrieve sentences
function getSavedSentences(partialRequirments) {
    return partialRequirments.map(function (obj) {
        return obj.trim();
    }) || [];
}
//check all requirements are marked
function allRequirementSentecesMarked(requirementName, partialRequirements) {
    var textSentences = getRequirmentSentences(requirementName);
    return partialRequirements && partialRequirements.length === textSentences.length;
    ;
}
//get the partial saved sentences for the default view
function getPartialContentDefaultView(requirement, partialRequirments, alreadyCoveredPartialRequirments, skipNotMarked) {
    var resultedHtml = requirement.name;
    var textSentences = getRequirmentSentences(requirement.name);
    var rowRequirments = partialRequirments && getSavedSentences(partialRequirments);
    var allReqCoveredSentence = alreadyCoveredPartialRequirments && getCoveredSenteces(alreadyCoveredPartialRequirments, requirement.id);
    var allReqSentencesMarked = allRequirementSentecesMarked(requirement.name, rowRequirments);
    textSentences.forEach(function (sentence) {
        //trimm current sentence
        var trimmedSentence = sentence.trim();
        var fullSentence = sentence + ".";
        if (rowRequirments && rowRequirments.includes(trimmedSentence) && !allReqSentencesMarked) {
            resultedHtml = resultedHtml.replace(fullSentence, "<span class=" + "markedGreen" + ">" + fullSentence + "</span>");
        }
        else {
            var coveredSentece = allReqCoveredSentence && allReqCoveredSentence.includes(trimmedSentence);
            if (coveredSentece) {
                resultedHtml = resultedHtml.replace(fullSentence, "<span>" + fullSentence + "</span>");
            }
            else if (!allReqSentencesMarked && allReqCoveredSentence && allReqCoveredSentence.length > 0) {
                resultedHtml = resultedHtml.replace(fullSentence, "<span class=" + "markedRed" + ">" + fullSentence + "</span>");
            }
        }
    });
    return resultedHtml;
}
//check the current requirement is already covered
function isPartialCoveredRequirment(requirement, alreadyCoveredPartialRequirments) {
    var textSentences = getRequirmentSentences(requirement.name);
    var result = false;
    for (var i = 0; i < textSentences.length; i++) {
        var trimmedSentence = textSentences[i].trim();
        var allCoveredSentenceReq = alreadyCoveredPartialRequirments && getCoveredSenteces(alreadyCoveredPartialRequirments, requirement.id);
        var coveredSentece = allCoveredSentenceReq && allCoveredSentenceReq.includes(trimmedSentence);
        if (coveredSentece) {
            result = true;
            break;
        }
    }
    return result;
}
//compute the covered senteces excluding the current requirement
function getCoveredSenteces(allReq, requirementId) {
    var resultArray = [];
    allReq.forEach(function (obj) {
        var assignedReq = Object.assign([], Object.keys(obj).filter(function (reqId) { return reqId == requirementId; }).map(function (k) { return obj[k].map(function (elem) { return elem.trim(); }); }));
        resultArray.push.apply(resultArray, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](assignedReq));
    });
    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])(resultArray);
}
//sort the selected sentences by the order of the appearance in the requirement
function getSortedRequirments(textSentences, partialRequirments) {
    var output = [];
    var indexedSentences = textSentences.map(function (e, i) { return { ind: i, val: e }; });
    output = indexedSentences.filter(function (s) { return partialRequirments.includes(s.val); });
    return output ? output.sort(function (x, y) { return x.ind > y.ind ? 1 : -1; }).map(function (s) { return s.val; }) : [];
}
function getMigrationTitle(isMigrated, markMode) {
    return isMigrated ?
        markMode ?
            "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
            "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
        undefined;
}


/***/ }),

/***/ "./src/components/course-builder/schools/edit-school.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder/schools/edit-school.tsx ***!
  \***************************************************************/
/*! exports provided: EditSchool, EditSchoolNoBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchool", function() { return EditSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchoolNoBanner", function() { return EditSchoolNoBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");







var EditSchool = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", callbacks: { schools: function () { return location.hash = "#/schools"; } }, routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](EditSchoolNoBanner, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props))); };
var EditSchoolNoBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditSchoolNoBanner, _super);
    function EditSchoolNoBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = null;
        return _this;
    }
    EditSchoolNoBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    };
    EditSchoolNoBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var id, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.props.id) return [3 /*break*/, 2];
                        id = this.props.id;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.get("schools", id)];
                    case 1:
                        school = _a.sent();
                        this.origSchool = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school);
                        this.setState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school));
                        return [3 /*break*/, 3];
                    case 2:
                        // No id, create new instead.
                        this.setState({
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            officialBranchId: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            isGymnasium: this.props.type === 'gymnasium',
                            isPrimarySchool: this.props.type === 'primary'
                        });
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var r, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        r = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        school = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state, { tags: (this.state.tags || [])
                                .filter(function (tag) { return ["primary", "gymnasium"].indexOf(tag) < 0; }) });
                        if (school.isPrimarySchool)
                            school.tags.push("primary");
                        if (school.isGymnasium)
                            school.tags.push("gymnasium");
                        if (!(school.isGymnasium || school.isPrimarySchool)) {
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"], ["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"]))));
                        }
                        if (!this.origSchool) {
                            school.acl = ["role:USER:R"];
                            school.acl.push(new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString());
                            r.add("schools", school);
                            this.addSchoolBranch(school, r);
                        }
                        else if (this.origSchool.name !== this.state.name) {
                            throw new Error("Skolans namn får inte ändras. Kontakta Vemendo AB.");
                        }
                        else {
                            if (!school.officialBranchId) {
                                school.officialBranchId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
                                this.addSchoolBranch(school, r);
                            }
                            r.put("schools", school);
                        }
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(r.mutationRequests)];
                    case 1:
                        _a.sent();
                        location.hash = "#/schools";
                        return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.addSchoolBranch = function (school, r) {
        var branch = {
            id: school.officialBranchId,
            name: school.name,
            schoolId: school.id,
            acl: [
                "role:USER:R",
                new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString()
            ]
        };
        r.add("branches", branch);
    };
    EditSchoolNoBanner.prototype.deleteSchool = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schoolBranch, br_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(prompt(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"], ["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"])), this.state.name)) === this.state.name)) return [3 /*break*/, 3];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("branches", {
                                ids: [this.state.officialBranchId],
                                include: "approvedChildren",
                                flags: ["includeIdsOnly"]
                            })];
                    case 1:
                        schoolBranch = _a.sent();
                        br_1 = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        br_1.delete("schools", this.state.id);
                        schoolBranch[0].approvedChildren.forEach(function (_a) {
                            var id = _a.id;
                            br_1.delete("branches", id);
                        });
                        br_1.delete("branches", this.state.officialBranchId);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(br_1.mutationRequests)];
                    case 2:
                        _a.sent();
                        location.hash = "#/schools";
                        return [3 /*break*/, 4];
                    case 3:
                        alert("Skolan togs inte bort eftersom det namn du angav inte stämmer.");
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, id = _a.id;
        var editExisting = !!id;
        var school = this.state;
        var origSchool = this.origSchool;
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Namn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: !school || !school.name, disabled: !isAdmin || editExisting, tabIndex: 1, size: 50, value: school ? school.name : "", onChange: function (ev) { return _this.setState({ name: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Visningsnamn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: school && !school.displayName, disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.displayName : "", onChange: function (ev) { return _this.setState({ displayName: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                school && school.isGymnasium ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "EDS namn (gymnasium):"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.edsSchoolNameGymn : "", onChange: function (ev) { return _this.setState({ edsSchoolNameGymn: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })) : null,
                school && school.isPrimarySchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "EDS namn (grundskola):"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.edsSchoolNamePrim : "", onChange: function (ev) { return _this.setState({ edsSchoolNamePrim: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })) : null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Typ:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypePrimary", disabled: !isAdmin, checked: school && school.isPrimarySchool, tabIndex: 1, value: "primary", onChange: function (ev) { return _this.setState({ isPrimarySchool: ev.target.checked }); } }),
                        "\u00A0Grundskola"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypeGymnasium", disabled: !isAdmin, checked: school && school.isGymnasium, tabIndex: 1, value: "gymnasium", onChange: function (ev) { return _this.setState({ isGymnasium: ev.target.checked }); } }),
                        "\u00A0Gymnasium"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                isAdmin && editExisting && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () {
                        return _this.deleteSchool().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Ta bort skola"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pull-right" }, "\u00A0"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_6__["Link"], { className: "btn btn-warning btn-large pull-right", to: "/schools" }, "Avbryt"),
                isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large", onClick: function () {
                        if (origSchool && origSchool.name !== school.name) {
                            if (!confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."], ["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."]))))) {
                                return;
                            }
                        }
                        _this.save().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Spara")));
    };
    return EditSchoolNoBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/editable-school-list.tsx":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/schools/editable-school-list.tsx ***!
  \************************************************************************/
/*! exports provided: EditableSchoolList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableSchoolList", function() { return EditableSchoolList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var EditableSchoolList = function (props) {
    var schools = props.schools, viewCourseUrl = props.viewCourseUrl;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editable-school-list" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, schools.map(function (school) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { className: "align-horizontal", key: school.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { className: "editItem", to: "/schools/" + school.id + "/edit" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, school.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "EMPLOYEE", school: school.name }); } }, "Agera som l\u00E4rare p\u00E5 denna skola"))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "STUDENT", school: school.name, url: viewCourseUrl }); } }, "Agera som elev p\u00E5 denna skola"))));
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
            "V.g. v\u00E4nta medan skolor laddas")),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
        schools && isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { to: "/schools/new/" + props.type, className: "btn" }, props.type == 'gymnasium' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till gymnasieskola"], ["L\u00E4gg till gymnasieskola"]))) :
            props.type == 'primary' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till grundskola"], ["L\u00E4gg till grundskola"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"])))));
};
var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/index.tsx":
/*!*********************************************************!*\
  !*** ./src/components/course-builder/schools/index.tsx ***!
  \*********************************************************/
/*! exports provided: Schools, SchoolsWithoutBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolsWithoutBanner", function() { return SchoolsWithoutBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _editable_school_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editable-school-list */ "./src/components/course-builder/schools/editable-school-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var Schools = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](SchoolsWithoutBanner, { viewCourseUrl: props.viewCourseUrl })); };
var SchoolsWithoutBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolsWithoutBanner, _super);
    function SchoolsWithoutBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            schools: null
        };
        return _this;
    }
    SchoolsWithoutBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["showError"])(err.message || err); });
    };
    SchoolsWithoutBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schools;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("schools")];
                    case 1:
                        schools = _a.sent();
                        this.setState({ schools: schools });
                        return [2 /*return*/];
                }
            });
        });
    };
    SchoolsWithoutBanner.prototype.render = function () {
        var schools = this.state.schools;
        schools && schools.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("name"));
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" }, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Gymnasieskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isGymnasium; }), viewCourseUrl: this.props.viewCourseUrl, type: "gymnasium" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Grundskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isPrimarySchool; }), viewCourseUrl: this.props.viewCourseUrl, type: "primary" }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null)));
    };
    return SchoolsWithoutBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/ellipsis-loader.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/ellipsis-loader.tsx ***!
  \**************************************************************************/
/*! exports provided: EllipsisLoader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EllipsisLoader", function() { return EllipsisLoader; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var EllipsisLoader = function () {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("img", { style: { border: 0, margin: 0, padding: 0 }, className: "ellipsis-loader" });
};


/***/ }),

/***/ "./src/components/course-builder/sub-components/knowledge-matrix.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/knowledge-matrix.tsx ***!
  \***************************************************************************/
/*! exports provided: KnowledgeMatrix */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeMatrix", function() { return KnowledgeMatrix; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../knowledge-matrix-partial-utils */ "./src/components/course-builder/knowledge-matrix-partial-utils.ts");




var KnowledgeMatrix = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KnowledgeMatrix, _super);
    function KnowledgeMatrix(props) {
        return _super.call(this, props) || this;
    }
    KnowledgeMatrix.prototype.getKnowledgeSentencesContent = function (requirement, partialRequirments, index, markedOk, isMigrated) {
        var _this = this;
        var _a = this.props, coveredPartialRequirments = _a.coveredPartialRequirments, markMode = _a.markMode;
        //split text in senteces
        var textSentences = Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getRequirmentSentences"])(requirement.name);
        //get saved sencenteces for the current requirement
        var rowRequirments = partialRequirments && Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getSavedSentences"])(partialRequirments);
        //get all saved senteces excluding the current ones
        var allCoveredSentenceReq = coveredPartialRequirments && Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getCoveredSenteces"])(coveredPartialRequirments, requirement.id);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: index, title: Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getMigrationTitle"])(isMigrated, markMode) }, textSentences.map(function (sentence, k) {
            var trimmedSentence = sentence.trim();
            var hasValue = rowRequirments && rowRequirments.includes(trimmedSentence) || markedOk && !rowRequirments;
            var sentenceNotMarked = !allCoveredSentenceReq.includes(trimmedSentence);
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", { key: k, dangerouslySetInnerHTML: { __html: sentence ? sentence + "." : "" }, className: "selectable" + (hasValue ? " markedGreen" : (sentenceNotMarked ? " markedRed" : "")), onClick: function () {
                    var updatedRequirments = partialRequirments ? Object.assign([], partialRequirments) : [];
                    var shouldBeRemoved = rowRequirments && rowRequirments.includes(trimmedSentence);
                    //check if no partial data saved, but the requirment is markedOk
                    if (markedOk && (!rowRequirments || rowRequirments.length == 0)) {
                        //save all excepting the one that should be removed
                        updatedRequirments = textSentences.filter(function (x) { return x != sentence; });
                        _this.props.onUpdatePartialKnowledge(requirement.id, Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getSortedRequirments"])(textSentences, updatedRequirments));
                    }
                    else {
                        if (shouldBeRemoved) {
                            updatedRequirments = partialRequirments.filter(function (req) { return req != sentence; });
                        }
                        else {
                            updatedRequirments.push(sentence);
                        }
                        _this.props.onUpdatePartialKnowledge(requirement.id, Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getSortedRequirments"])(textSentences, updatedRequirments));
                    }
                } });
        }));
    };
    KnowledgeMatrix.prototype.onRequirementChanged = function (requirement, value, partialValues, allPartialMarked) {
        if (this.props.onUpdatePartialKnowledge) {
            //remove all saved senteces if the requirement is unchecked
            (value && !partialValues || allPartialMarked) ? this.props.onUpdatePartialKnowledge(requirement.id, []) : this.props.onUpdatePartialKnowledge(requirement.id, Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getRequirmentSentences"])(requirement.name));
        }
        else {
            this.props.onMarkChanged(requirement.id, !value);
        }
    };
    KnowledgeMatrix.prototype.render = function () {
        var _this = this;
        var _a = this.props, knowledgeRequirements = _a.knowledgeRequirements, markedIds = _a.markedIds, migratedIds = _a.migratedIds, explainedRequirements = _a.explainedRequirements, markBySentenceView = _a.markBySentenceView, markPartialFeatureEnabled = _a.markPartialFeatureEnabled;
        var _b = this.props, idsToMarkNotOk = _b.idsToMarkNotOk, markMode = _b.markMode, onExplainedRequirementsChanged = _b.onExplainedRequirementsChanged, partialRequirments = _b.partialRequirments, coveredPartialRequirments = _b.coveredPartialRequirments;
        var columns = ["E", "C", "A"];
        var rows = [];
        var reqs = knowledgeRequirements.slice();
        var row = null;
        while (true) {
            row = columns.map(function (grade) {
                var pNext = reqs.findIndex(function (r) { return r.gradeStep && r.gradeStep.toUpperCase() === grade; });
                if (pNext < 0)
                    return null;
                var rv = reqs[pNext];
                reqs.splice(pNext, 1);
                return rv;
            });
            if (row.every(function (r) { return r === null; }))
                break;
            rows.push(row);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "knowledge-matrix" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                    var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;
                    var isMarkedNotOK = requirement && idsToMarkNotOk && idsToMarkNotOk[requirement.id]; //not used anymore
                    var isMigrated = requirement && migratedIds && !!migratedIds[requirement.id];
                    var rowPartialRequirements = partialRequirments && partialRequirments[requirement.id];
                    var partialValues = rowPartialRequirements && Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getSavedSentences"])(rowPartialRequirements);
                    var allReqSentencesMarked = Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["allRequirementSentecesMarked"])(requirement.name, partialValues);
                    var hasPartialCovered = Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["isPartialCoveredRequirment"])(requirement, coveredPartialRequirments);
                    var markedRed = !(partialValues && partialValues.length > 0 || hasPartialCovered);
                    return markBySentenceView && markPartialFeatureEnabled ? _this.getKnowledgeSentencesContent(requirement, rowPartialRequirements, j, isMarkedOK, isMigrated) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: requirement ? (rowPartialRequirements && rowPartialRequirements.length || hasPartialCovered) ?
                                    Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getPartialContentDefaultView"])(requirement, rowPartialRequirements, coveredPartialRequirments, markedRed) : requirement.name : "" }, className: (markMode ? "selectable" : "") +
                                (isMigrated ? " migrated" : "") +
                                (isMarkedOK && (!rowPartialRequirements || allReqSentencesMarked) ?
                                    " markedGreen" :
                                    markedRed ?
                                        " markedRed" :
                                        ""), onClick: markMode && requirement ?
                                function () { return _this.onRequirementChanged(requirement, isMarkedOK, partialValues, allReqSentencesMarked); } :
                                undefined, title: Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getMigrationTitle"])(isMigrated, markMode) });
                })),
                explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                    var partialSentences = partialRequirments && partialRequirments[requirement.id] && Object(_knowledge_matrix_partial_utils__WEBPACK_IMPORTED_MODULE_3__["getSavedSentences"])(partialRequirments[requirement.id]);
                    var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0 || partialSentences && partialSentences.length > 0;
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j }, isMarkedOK ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { placeholder: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Beskriv kravet"], ["Beskriv kravet"]))), className: "inputTextBox inputTextLarge", style: { width: "100%" }, readOnly: !markMode, value: explainedRequirements[requirement.id] || "", onChange: onExplainedRequirementsChanged && (function (ev) { return onExplainedRequirementsChanged(requirement.id, ev.target.value); }) }) : undefined);
                }))); })));
        { /*return <div>
          <table>
            <thead>
              <tr>
                <th>E</th>
                <th>C</th>
                <th>A</th>
              </tr>
            </thead>
            <tbody>
              {tbody.map((row, i) =>
              <tr key={i}>{row.map((cell, j) => {
                const isMarkedOK = props.markedIds && props.markedIds.indexOf(cell.id) >= 0;
                const isMarkedNotOK = props.idsToMarkNotOk && props.idsToMarkNotOk[cell.id];
                return <td
                  key={j}
                  rowSpan={cell.rowSpan}
                  className={(props.markMode ? "selectable" : "") +
                    (isMarkedOK ?
                      " markedGreen" :
                      (isMarkedNotOK ?
                        " markedRed":
                        ""))}
                  onClick={props.markMode && (()=>props.onMarkChanged(cell.id, !isMarkedOK))}>
                  {cell.html && <div style={{position: 'relative'}}>
                    <p
                      className={cell.type === 'ability' ? 'abilityText' : 'criteriaText'}
                      dangerouslySetInnerHTML={{__html: cell.html}} />
                    {props.editMode && <RemoveItem className="upperRight" onClick={()=>
                      this.setCellIds(
                        cell.type,
                        cell.rowIndex,
                        this.getCellIds(
                          cell.type,
                          cell.rowIndex).filter(id => id != cell.id) )} /> }
                  </div>}
                </td>})}
              </tr>)}
            </tbody>
          </table>
        </div>*/
        }
    };
    return KnowledgeMatrix;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/select-related-docs.tsx":
/*!******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/select-related-docs.tsx ***!
  \******************************************************************************/
/*! exports provided: SelectRelatedDocs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectRelatedDocs", function() { return SelectRelatedDocs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var SelectRelatedDocs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SelectRelatedDocs, _super);
    function SelectRelatedDocs(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    SelectRelatedDocs.prototype.render = function () {
        var _this = this;
        var _a = this.props, options = _a.options, title = _a.title, markedIds = _a.markedIds, markMode = _a.markMode, migratedIds = _a.migratedIds, uncoveredIds = _a.uncoveredIds;
        var groupedOptions = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToLookup"])(options, function (d) { return d.group || "default"; });
        var groups = Object.keys(groupedOptions);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: "larger" }, groups.map(function (group) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: group },
            groups.length === 1 ? null : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, group),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null)),
            groupedOptions[group].map(function (option) {
                var isMarked = markedIds.some(function (x) { return x === option.id; });
                var isMigrated = migratedIds && !!migratedIds[option.id];
                var isUncovered = uncoveredIds && uncoveredIds[option.id];
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: option.id, onClick: function () {
                        return markMode && _this.props.onMarkChanged(option.id, !isMarked);
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" +
                            (markMode ? " selectable" : "") +
                            (isMarked ? " markedGreen" : (isUncovered ?
                                " markedRed" :
                                "")) +
                            (isMigrated ? " migrated" : ""), title: isMigrated ?
                            markMode ?
                                "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
                                "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
                            undefined },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: option.name } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)));
            })); }));
    };
    return SelectRelatedDocs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts":
/*!*******************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/diff-xml-with-database.ts ***!
  \*******************************************************************************/
/*! exports provided: diffXmlWithDatabase */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffXmlWithDatabase", function() { return diffXmlWithDatabase; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _migrate_subject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./migrate-subject */ "./src/components/course-builder/subjects/diff/migrate-subject.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");




function diffXmlWithDatabase(existingSubject, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var expandedCourseTemplates, courseSets;
        var _this = this;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.get('subjects', existingSubject.id, { include: ["courseTemplates", "abilities"] })];
                case 1:
                    // Expand graphs of existing Subject
                    existingSubject = _a.sent();
                    return [4 /*yield*/, Promise.all(existingSubject.courseTemplates.map(function (ct) { return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["loadCourse"])(ct.id, {
                            include: [
                                'centralContent',
                                'knowledgeRequirements'
                            ]
                        }); }))];
                case 2:
                    expandedCourseTemplates = _a.sent();
                    console.log("Subject: " + existingSubject.name + ". Courses: " + expandedCourseTemplates.map(function (_a) {
                        var name = _a.name;
                        return name;
                    }));
                    return [4 /*yield*/, Promise.all(expandedCourseTemplates.map(function (courseTemplate) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                switch (_b.label) {
                                    case 0:
                                        _a = {
                                            template: courseTemplate
                                        };
                                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.list("courses", { name: courseTemplate.name, include: ['abilities'], flags: ['includeIdsOnly'] })];
                                    case 1: return [2 /*return*/, (_a.instances = _b.sent(),
                                            _a)];
                                }
                            });
                        }); }))];
                case 3:
                    courseSets = _a.sent();
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    return [4 /*yield*/, Object(_migrate_subject__WEBPACK_IMPORTED_MODULE_2__["migrateSubject"])(existingSubject, courseSets, subjectToImport, changes)];
                case 4:
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    _a.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/diff/migrate-subject.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/migrate-subject.ts ***!
  \************************************************************************/
/*! exports provided: migrateSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "migrateSubject", function() { return migrateSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");




function diffSubjectGlobalTexts(dbTextMap, xmlTexts) {
    var e_1, _a;
    var removedIds = new Set();
    var newTexts = new Map();
    var idsToAdd = new Set();
    xmlTexts.forEach(function (newText) {
        newText = newText.trim();
        if (!dbTextMap.has(newText)) {
            var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["createUUID"])();
            console.log("New id: " + id + ". Text: " + newText);
            newTexts.set(newText, id);
            idsToAdd.add(id);
        }
        else {
            newTexts.set(newText, dbTextMap.get(newText));
        }
    });
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](dbTextMap.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {
            var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_c.value, 2), oldText = _d[0], oldId = _d[1];
            if (xmlTexts.indexOf(oldText) === -1) {
                removedIds.add(oldId);
            }
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return {
        removedIds: removedIds,
        newTexts: newTexts,
        idsToAdd: idsToAdd
    };
}
var _fictiveOldId = 1;
function fictiveOldId() {
    return "fictiveOldId" + (++_fictiveOldId);
}
var stopWords = new Set(
// From https://github.com/MihaiValentin/lunr-languages/blob/master/lunr.sv.js#L252
('alla allt att av blev bli blir blivit de dem den denna deras dess dessa det detta dig din dina ditt du där då efter ej eller en er era ert ett från för ha hade han hans har henne hennes hon honom hur här i icke ingen inom inte jag ju kan kunde man med mellan men mig min mina mitt mot mycket ni nu när någon något några och om oss på samma sedan sig sin sina sitta själv skulle som så sådan sådana sådant till under upp ut utan vad var vara varför varit varje vars vart vem vi vid vilka vilkas vilken vilket vår våra vårt än är åt över' +
    ' kring') // This line contains additional stop-words missing in lunr.sv.
    .split(' '));
function getLexemes(html) {
    return new Set(removeTags(html).replace(/[^\w\såäö]/gi, '').toLowerCase().split(/\s/)
        .map(function (lexeme) { return lexeme.trim(); })
        .filter(function (lexeme) { return !!lexeme; })
        .filter(function (lexeme) { return !stopWords.has(lexeme); }));
}
function removeTags(html) {
    var div = document.createElement('div');
    div.innerHTML = html;
    return '' + div.innerText;
}
function getIdsToMigrate(dbTexts, xmlTexts, newTexts, textType, course) {
    var idsToMigrate = new Map();
    dbTexts = dbTexts.map(function (entity) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, entity, { name: entity.name.trim() })); }).filter(function (_a) {
        var name = _a.name;
        return !!name;
    });
    var xmlSet = new Map();
    xmlTexts.forEach(function (item) { return xmlSet.set(item.html, item); });
    var dbSet = new Map();
    dbTexts.forEach(function (entity) { return dbSet.set(entity.name, entity); });
    // Remove those who already exists identically
    dbTexts = dbTexts.filter(function (entity) { return !xmlSet.has(entity.name); });
    xmlTexts = xmlTexts.filter(function (item) { return !dbSet.has(item.html); });
    // Now, for the remainder, try the best to map old texts to new texts, and when done, check if there are new texts that never got mapped.
    // Start by putting all dbText into the result, without a paired xml text yet:
    dbTexts.forEach(function (dbText) { return idsToMigrate.set(dbText.id, {
        gradeStep: dbText.gradeStep,
        oldText: dbText.name,
        lexemes: getLexemes(dbText.name),
        matchLevel: 0
    }); });
    // Then try to pair each xmlText to an item in idsToMigrate
    var xmlSpinsters = [];
    while (xmlTexts.length > 0) {
        var xmlText = xmlTexts[0];
        var bestMatch = findBestMatch(xmlText);
        if (!bestMatch) {
            xmlSpinsters.push(xmlText);
        }
        else {
            if (bestMatch.newText) {
                // Throw out existing match
                xmlTexts.push({ html: bestMatch.newText, gradeStep: bestMatch.gradeStep });
            }
            var pair = idsToMigrate.get(bestMatch.id);
            // Pair myself with this match:
            pair.newText = xmlText.html;
            pair.matchLevel = bestMatch.myMatchLevel;
            pair.newId = newTexts.get(xmlText.html);
        }
        xmlTexts.shift();
    }
    // For each spinster (new texts that couldn't find any match in old texts),
    // Add them with an fictive old ID but omit oldText to mark it as a newcomer
    xmlSpinsters.forEach(function (spinster) {
        idsToMigrate.set(fictiveOldId(), {
            newId: newTexts.get(spinster.html),
            newText: spinster.html,
            gradeStep: spinster.gradeStep,
            matchLevel: 0,
            lexemes: new Set()
        });
    });
    // Mark typo-fixes
    idsToMigrate.forEach(function (match) {
        var oldText = match.oldText, newText = match.newText;
        if (oldText && newText) {
            if (tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(oldText)).join(' ') === tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(newText)).join(' ')) {
                match.isTypoFix = true;
            }
        }
    });
    console.log("IdsToMigrate", tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.values()).map(function (_a) {
        var oldText = _a.oldText, lexemes = _a.lexemes;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](lexemes).join(' ') + ": " + oldText;
    }));
    return idsToMigrate;
    function findBestMatch(xmlText) {
        var xmlLexemes = getLexemes(xmlText.html);
        var possiblePartners = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.entries()).filter(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], x = _b[1];
            return x.gradeStep === xmlText.gradeStep;
        })
            .map(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], _c = _b[1], gradeStep = _c.gradeStep, matchLevel = _c.matchLevel, newText = _c.newText, lexemes = _c.lexemes;
            return ({
                id: id,
                gradeStep: gradeStep,
                matchLevel: matchLevel,
                newText: newText,
                myMatchLevel: getMatchLevel(xmlLexemes, lexemes)
            });
        }).filter(function (pp) { return pp.myMatchLevel >= 50 && (!pp.matchLevel || pp.matchLevel < pp.myMatchLevel); });
        return possiblePartners.sort(function (a, b) { return b.myMatchLevel - a.myMatchLevel; })[0]; // highest first.
    }
    function getMatchLevel(lexemes1, lexemes2) {
        if (lexemes1.size === 0 || lexemes2.size === 0)
            return 0;
        var points1 = 0;
        var points2 = 0;
        lexemes1.forEach(function (word) {
            if (lexemes2.has(word))
                ++points1;
        });
        lexemes2.forEach(function (word) {
            if (lexemes1.has(word))
                ++points2;
        });
        return Math.round(100 * Math.max(points1 / lexemes1.size, points2 / lexemes2.size));
    }
    /*if (dbTexts.length !== xmlTexts.length) {
      // We can no longer assume that the changed texts refer to different formulations of the same meaning.
      // We not map old formulations to new ones.
      // In future, we could handle this case by assuming all old texts not occurring in new data, have been removed and all new have been added.
      throw new Error("Number of " + textType + (course ? ` on course ${course}` : "") + " differs. Cannot migrate.");
    }
    dbTexts.forEach(({name: oldText, id: oldId, gradeStep}, i) => {
      const xmlText = xmlTexts[i].trim();
      if (oldText.trim() !== xmlText) {
        idsToMigrate.set(oldId, {newText: xmlText, newId: newTexts.get(xmlText), oldText, gradeStep});
      }
    });
    return idsToMigrate;*/
}
function migrateSubject(existingSubject, courseSets, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        function migrateCourseInstance(course, courseToImport, idsToMigrate) {
            var showChanges = !shownChanges.has(course.name);
            shownChanges.add(course.name);
            abilityIdsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, oldText = _a.oldText;
                // Relink the course instance with abilities. This change does not need to be visible in GUI.
                changes.push({
                    mutations: function (br) {
                        if (oldText)
                            br.unlink2("courses", course.id, "abilities", oldId);
                        if (newId)
                            br.link2("courses", course.id, "abilities", newId);
                    }
                });
            });
            course.abilitiesOrder = subjectToImport.abilities.map(function (html) { return newAbilityTexts.get(html); });
            var ccsToMigrate = idsToMigrate.ccsToMigrate, krsToMigrate = idsToMigrate.krsToMigrate;
            // Central Content
            ccsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Centralt Inneh\u00E5ll" :
                                "Uppdaterat Centralt Inneh\u00E5ll" :
                            "Borttaget Centralt Inneh\u00E5ll" :
                        "Nytt Centralt Inneh\u00E5ll"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && ccsToAdd.has(newId) && !createdIds.has(newId)) {
                            var cc = {
                                id: newId,
                                name: newText,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            br.add("central-content", cc);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "centralContent", oldId);
                        if (newId)
                            br.link2("courses", course.id, "centralContent", newId);
                    }
                });
            });
            course.centralContentOrder = courseToImport.centralContent.map(function (_a) {
                var html = _a.html;
                return newCCTexts.get(html);
            });
            // Knowledge Requirements
            krsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, gradeStep = _a.gradeStep, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Kunskapskrav" :
                                "Uppdaterat Kunskapskrav" :
                            "Borttaget Kunskapskrav" :
                        "Nytt Kunskapskrav"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && krsToAdd.has(newId) && !createdIds.has(newId)) {
                            var kr = {
                                id: newId,
                                name: newText,
                                gradeStep: gradeStep,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            console.log("Adding Knowledge-Requirement " + newId + ": " + newText);
                            br.add("knowledge-requirements", kr);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "knowledgeRequirements", oldId);
                        if (newId)
                            br.link2("courses", course.id, "knowledgeRequirements", newId);
                    }
                });
            });
            course.knowledgeRequirementsOrder =
                courseToImport.knowledgeRequirements.map(function (kr) { return newKRTexts.get(kr.html); });
            // Updates the course properties centralContentOrder and knowledgeRequirementsOrder
            if (abilityIdsToMigrate.size > 0 || ccsToMigrate.size > 0 || krsToMigrate.size > 0) {
                changes.push({
                    change: !course.isTemplate ? "Uppdaterad Kursinstans" : "Uppdaterad Kursmall",
                    content: !course.isTemplate ?
                        course.name + ". Skola: " + (course.school || "ej angiven") + ". Beskrivning: " + (course.description || '') :
                        "" + course.name,
                    mutations: function (br) { return br.put("courses", course); }
                });
            }
        }
        // Tasks:
        // 1. ASYNC OPERATION: Go through all tasks that has edges to any of the old ids.
        // 2. For each found task, do:
        //    A: Iterate tags starting with "course:". Pick the course code.
        //    B: Populate the new property migrationTasks: {
        //         abilities: {[newId: string]: {oldText: string, oldId: string, importDate: number}}, // Be able to create a chain in the GUI !
        //         centralContent: {[newId: string]: {oldText: string, ..."...}},
        //         knowledgeRequirements: {[newId: string]: {oldText: string, ..."...}},
        //       }
        //       OBS1! Mergea abilities, centralCondent och knowledgeRequirements med ev tidigare värden (så man kan importera om och om igen!)
        //       OBS2! oldId kan förekomma på flera newId om task används av flera kurser. 
        //    C: Create sets for unlinks and link operations per type.
        //    D: For all courseCodes that the task is taggen on,
        //         * register ccsToMigrate.keys() in the unlink set of central contents
        //         * register ccsToMigrate.values() in the link set of central contents
        //         * --"-- for knowledgeRequirements
        //    E: unlink and link with regards to abilityIdsToMigrate (keys() and values() respectively).
        //    F: unlink and link according to the created sets of link / unlink operations.
        //    Note: Unlike course instances, there's no order property to take care of here!
        //
        function migrateTasks() {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                function fetchTasksInChunksWithEdgesTo(ids, options) {
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                        var result;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    // This function should make work around the case when given "ids" contains too many items, by
                                    // dividing the requests into several and merge the result using a Map.
                                    if (ids.length === 0)
                                        return [2 /*return*/, []]; // Otherwise we'll request every task in the system.
                                    result = new Map();
                                    console.log("Number of ids: " + ids.length);
                                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("tasks", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options, { hasEdgesTo: ids }))];
                                case 1: 
                                //return result.values();
                                return [2 /*return*/, _a.sent()];
                            }
                        });
                    });
                }
                var oldIds, importDate, tasks, _loop_2, tasks_1, tasks_1_1, task;
                var e_7, _a;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            oldIds = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](abilityIdsToMigrate.keys(), Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(idsToMigratePerCourse.map(function (c) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](c.ccsToMigrate.keys(), c.krsToMigrate.keys()); }))).filter(function (id) { return !id.startsWith('fictiveOldId'); });
                            importDate = Date.now();
                            return [4 /*yield*/, fetchTasksInChunksWithEdgesTo(oldIds, {
                                    include: ["abilities", "knowledgeRequirements", "centralContent"],
                                    flags: ["includeIdsOnly"]
                                })];
                        case 1:
                            tasks = _b.sent();
                            _loop_2 = function (task) {
                                var e_8, _a, e_9, _b, e_10, _c, e_11, _d;
                                var oldMT = task.migratedTexts || {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                task.migratedTexts = {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                var mutations = [];
                                var changeDescriptions = [];
                                var _loop_3 = function (id) {
                                    var migrationInfo = abilityIdsToMigrate.get(id);
                                    if (migrationInfo) {
                                        var newId_1 = migrationInfo.newId, newText = migrationInfo.newText, isTypoFix = migrationInfo.isTypoFix;
                                        var oldText = migrationInfo.oldText;
                                        var oldId = id;
                                        if (oldMT.abilities[id]) {
                                            // If migrating stuff that was never acknowledges by a teacher,
                                            // We should point out the very old id and text instead of the never-acknowledged one.
                                            oldText = oldMT.abilities[id].oldText;
                                            oldId = oldMT.abilities[id].oldId;
                                        }
                                        if (newId_1 && oldText !== newText) {
                                            // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                            if (!isTypoFix) {
                                                // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                task.migratedTexts.abilities[newId_1] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                            }
                                        }
                                        mutations.push(function (br) {
                                            br.unlink2("tasks", task.id, "abilities", id);
                                            if (newId_1)
                                                br.link2("tasks", task.id, "abilities", newId_1);
                                        });
                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                        if (newId_1) {
                                            changeDescriptions.push(newText);
                                        }
                                    }
                                };
                                try {
                                    for (var _e = (e_8 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.abilities)), _f = _e.next(); !_f.done; _f = _e.next()) {
                                        var id = _f.value.id;
                                        _loop_3(id);
                                    }
                                }
                                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                                finally {
                                    try {
                                        if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                                    }
                                    finally { if (e_8) throw e_8.error; }
                                }
                                var taskCourseCodes = new Set(task.tags ?
                                    task.tags.filter(function (t) { return t.startsWith('course:'); }).map(function (t) { return t.substr("course:".length); }) :
                                    []);
                                // We need to keep track of linkedIds (for this particular task) for the following reason:
                                // Let's say the task was referred to by two different courses (possible in old versions),
                                // and in old Central Content, the two courses did have slightly different formulations of central content,
                                // so the task was mapped to both of them. Then, in new XML, the same central content was formulated
                                // in a new way that is identical this time between the two courses. Then both old IDs will be replaced
                                // by a single new ID. It would then be unnescessary to link to the new ID twice.
                                var linkedIds = new Set();
                                try {
                                    for (var idsToMigratePerCourse_1 = (e_9 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](idsToMigratePerCourse)), idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next(); !idsToMigratePerCourse_1_1.done; idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next()) {
                                        var _g = idsToMigratePerCourse_1_1.value, krsToMigrate = _g.krsToMigrate, ccsToMigrate = _g.ccsToMigrate, courseCode = _g.courseCode;
                                        if (taskCourseCodes.size === 0 || taskCourseCodes.has(courseCode)) {
                                            var _loop_4 = function (id) {
                                                var migrationInfo = ccsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_2 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.centralContent[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.centralContent[id].oldText;
                                                        oldId = oldMT.centralContent[id].oldId;
                                                    }
                                                    if (newId_2 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.centralContent[newId_2] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_2 || !linkedIds.has(newId_2)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "centralContent", id);
                                                            if (newId_2)
                                                                br.link2("tasks", task.id, "centralContent", newId_2);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_2) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_2);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _h = (e_10 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.centralContent)), _j = _h.next(); !_j.done; _j = _h.next()) {
                                                    var id = _j.value.id;
                                                    _loop_4(id);
                                                }
                                            }
                                            catch (e_10_1) { e_10 = { error: e_10_1 }; }
                                            finally {
                                                try {
                                                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                                                }
                                                finally { if (e_10) throw e_10.error; }
                                            }
                                            var _loop_5 = function (id) {
                                                var migrationInfo = krsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_3 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.knowledgeRequirements[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.knowledgeRequirements[id].oldText;
                                                        oldId = oldMT.knowledgeRequirements[id].oldId;
                                                    }
                                                    if (newId_3 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.knowledgeRequirements[newId_3] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_3 || !linkedIds.has(newId_3)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "knowledgeRequirements", id);
                                                            if (newId_3)
                                                                br.link2("tasks", task.id, "knowledgeRequirements", newId_3);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_3) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_3);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _k = (e_11 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.knowledgeRequirements)), _l = _k.next(); !_l.done; _l = _k.next()) {
                                                    var id = _l.value.id;
                                                    _loop_5(id);
                                                }
                                            }
                                            catch (e_11_1) { e_11 = { error: e_11_1 }; }
                                            finally {
                                                try {
                                                    if (_l && !_l.done && (_d = _k.return)) _d.call(_k);
                                                }
                                                finally { if (e_11) throw e_11.error; }
                                            }
                                        }
                                    }
                                }
                                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                                finally {
                                    try {
                                        if (idsToMigratePerCourse_1_1 && !idsToMigratePerCourse_1_1.done && (_b = idsToMigratePerCourse_1.return)) _b.call(idsToMigratePerCourse_1);
                                    }
                                    finally { if (e_9) throw e_9.error; }
                                }
                                changes.push({
                                    change: "Migrerad Uppgift",
                                    content: "<h4>" + task.name + " " + (task.school ? "(" + task.school + ") " : '(skola ej angiven)') + "</h4>\n          <p>Kurskod: " + tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](taskCourseCodes).join(',') + "</p>\n          " + changeDescriptions.map(function (txt) { return "<p>" + txt + "</p>"; }).join(''),
                                    mutations: function (br) {
                                        br.put("tasks", task);
                                        mutations.forEach(function (m) { return m(br); });
                                    }
                                });
                            };
                            try {
                                /*const tasks = await env.kedBackendClient.list<Task>("tasks", {
                                  hasEdgesTo: oldIds,
                                  include: ["abilities", "knowledgeRequirements", "centralContent"],
                                  flags: ["includeIdsOnly"]
                                });*/
                                for (tasks_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](tasks), tasks_1_1 = tasks_1.next(); !tasks_1_1.done; tasks_1_1 = tasks_1.next()) {
                                    task = tasks_1_1.value;
                                    _loop_2(task);
                                }
                            }
                            catch (e_7_1) { e_7 = { error: e_7_1 }; }
                            finally {
                                try {
                                    if (tasks_1_1 && !tasks_1_1.done && (_a = tasks_1.return)) _a.call(tasks_1);
                                }
                                finally { if (e_7) throw e_7.error; }
                            }
                            return [2 /*return*/];
                    }
                });
            });
        }
        var dbTextMap, orderedAbilities, orderedAbilities_1, orderedAbilities_1_1, a, courseSets_1, courseSets_1_1, template, _a, _b, cc, _c, _d, kr, _e, newAbilityTexts, abilitiesToAdd, _f, newCCTexts, ccsToAdd, _g, newKRTexts, krsToAdd, abilityIdsToMigrate, idsToMigratePerCourse, createdIds, shownChanges, _loop_1, courseSets_2, courseSets_2_1, _h, template, instances;
        var e_2, _j, e_3, _k, e_4, _l, e_5, _m, e_6, _o;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_p) {
            switch (_p.label) {
                case 0:
                    dbTextMap = new Map();
                    orderedAbilities = existingSubject.abilitiesOrder ?
                        existingSubject.abilitiesOrder.map(function (id) { return existingSubject.abilities.find(function (a) { return a.id === id; }); }) :
                        existingSubject.abilities;
                    try {
                        for (orderedAbilities_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](orderedAbilities), orderedAbilities_1_1 = orderedAbilities_1.next(); !orderedAbilities_1_1.done; orderedAbilities_1_1 = orderedAbilities_1.next()) {
                            a = orderedAbilities_1_1.value;
                            dbTextMap.set(a.name.trim(), a.id);
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (orderedAbilities_1_1 && !orderedAbilities_1_1.done && (_j = orderedAbilities_1.return)) _j.call(orderedAbilities_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    try {
                        for (courseSets_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_1_1 = courseSets_1.next(); !courseSets_1_1.done; courseSets_1_1 = courseSets_1.next()) {
                            template = courseSets_1_1.value.template;
                            try {
                                for (_a = (e_4 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.centralContent)), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    cc = _b.value;
                                    dbTextMap.set(cc.name.trim(), cc.id);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_b && !_b.done && (_l = _a.return)) _l.call(_a);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            try {
                                for (_c = (e_5 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.knowledgeRequirements)), _d = _c.next(); !_d.done; _d = _c.next()) {
                                    kr = _d.value;
                                    dbTextMap.set(kr.name.trim(), kr.id);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (_d && !_d.done && (_m = _c.return)) _m.call(_c);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (courseSets_1_1 && !courseSets_1_1.done && (_k = courseSets_1.return)) _k.call(courseSets_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                    _e = diffSubjectGlobalTexts(dbTextMap, subjectToImport.abilities), newAbilityTexts = _e.newTexts, abilitiesToAdd = _e.idsToAdd;
                    _f = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.centralContent.map(function (cc) { return cc.html; }); }))), newCCTexts = _f.newTexts, ccsToAdd = _f.idsToAdd;
                    _g = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.knowledgeRequirements.map(function (kr) { return kr.html; }); }))), newKRTexts = _g.newTexts, krsToAdd = _g.idsToAdd;
                    console.log("Abilities to add: " + abilitiesToAdd.size);
                    console.log("CCs to add: " + ccsToAdd.size);
                    console.log("KRs to add: " + krsToAdd.size);
                    abilityIdsToMigrate = getIdsToMigrate(orderedAbilities, subjectToImport.abilities.map(function (html) { return ({ html: html }); }), newAbilityTexts, "abilities");
                    idsToMigratePerCourse = courseSets.map(function (_a, i) {
                        var template = _a.template;
                        console.log("Course: " + template.name);
                        var xmlCourse = subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; });
                        return {
                            courseCode: template.code,
                            ccsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.centralContent, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.centralContent.map(function (_a) {
                                    var html = _a.html;
                                    return ({ html: html });
                                }), newCCTexts, "central content", template.name) :
                                new Map(),
                            krsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.knowledgeRequirements, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.knowledgeRequirements, newKRTexts, "knowledge requirements", template.name) :
                                new Map()
                        };
                    });
                    // OK so now we have all info.
                    // Now, we need to:
                    // Subject:
                    // 1. Remove links from subjects to abilities
                    // 2. Add links from subjects to abilities
                    abilityIdsToMigrate.forEach(function (_a, oldId) {
                        var newText = _a.newText, newId = _a.newId, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                        //const oldText = existingSubject.abilities.find(a => a.id === oldId).name;
                        changes.push({
                            change: (oldText ?
                                newText ?
                                    isTypoFix ?
                                        "Tryckfelsr\u00E4ttning F\u00F6rm\u00E5ga" :
                                        "Uppdaterad F\u00F6rm\u00E5ga" :
                                    "Borttagen F\u00F6rm\u00E5ga" :
                                "Ny F\u00F6rm\u00E5ga"),
                            content: "<strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                            mutations: function (br) {
                                if (newId && abilitiesToAdd.has(newId)) {
                                    var a = {
                                        id: newId,
                                        name: newText,
                                        acl: ["role:USER:R"],
                                        dateTime: Date.now()
                                    };
                                    br.add("abilities", a);
                                }
                                if (oldText)
                                    br.unlink2("subjects", existingSubject.id, "abilities", oldId);
                                if (newId)
                                    br.link2("subjects", existingSubject.id, "abilities", newId);
                            }
                        });
                    });
                    // 3. Update abilitiesOrder on Subject based on subjectToImport.abilities (mapped to ids in newTexts)
                    if (!existingSubject.abilitiesOrder || abilityIdsToMigrate.size > 0) {
                        existingSubject.abilitiesOrder = subjectToImport.abilities.map(function (xml) { return newAbilityTexts.get(xml); });
                        changes.push({
                            mutations: function (br) { return br.put("subjects", existingSubject); },
                            change: existingSubject.abilitiesOrder ?
                                null : // Ändringen redan visuell som "Uppdaterad för förmåga", etc, ovan
                                "Inf\u00F6r en ordnad lista p\u00E5 f\u00F6rm\u00E5gor i databasen",
                        });
                    }
                    createdIds = new Set();
                    changes.push({ mutations: function () { return createdIds.clear(); } }); // In case mutations run twice (which it doesn't as of current impl.)
                    shownChanges = new Set();
                    changes.push({ mutations: function () { return shownChanges.clear(); } });
                    _loop_1 = function (template, instances) {
                        var e_12, _a;
                        // Find courseToImport
                        var courseToImport = (subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; }));
                        // Find Central Content and Knowledge Requirements to migrate
                        var _b = idsToMigratePerCourse.find(function (x) { return x.courseCode === template.code; }), ccsToMigrate = _b.ccsToMigrate, krsToMigrate = _b.krsToMigrate;
                        try {
                            // Loop through all course instances (instances also contains templates)
                            // and migrate them. This will include creating missing entities in the DB.
                            for (var instances_1 = (e_12 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](instances)), instances_1_1 = instances_1.next(); !instances_1_1.done; instances_1_1 = instances_1.next()) {
                                var course = instances_1_1.value;
                                migrateCourseInstance(course, courseToImport, { ccsToMigrate: ccsToMigrate, krsToMigrate: krsToMigrate });
                            }
                        }
                        catch (e_12_1) { e_12 = { error: e_12_1 }; }
                        finally {
                            try {
                                if (instances_1_1 && !instances_1_1.done && (_a = instances_1.return)) _a.call(instances_1);
                            }
                            finally { if (e_12) throw e_12.error; }
                        }
                    };
                    try {
                        // Courses:
                        // 1. Go through all course instances and:
                        //      A: Remove links from courses to abilities listed in abilityIdsToMigrate.keys()
                        //      B: Add links from courses to abilities abiltitiesToMigrate.values()
                        //      C: Update abilitiesOrder on course instances based on subjectToImport (mapped to ids in newTexts)
                        // 2, 3: Do the same for central-content and knowledge-requirementes:
                        //    Find ccs and krs to migrate based on courseInstance.code
                        //    For both ccs and krs, do:
                        //      A: Unlink ccsToMigrate.keys()
                        //      B: Link ccsToMigrate.values()
                        //      C: Update centralContentOrder based on subjectToImport.centralContent mapped to newTexts ids
                        //      (same for krsToMigrate, with knowledgeRequirementsOrder instead)
                        for (courseSets_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_2_1 = courseSets_2.next(); !courseSets_2_1.done; courseSets_2_1 = courseSets_2.next()) {
                            _h = courseSets_2_1.value, template = _h.template, instances = _h.instances;
                            _loop_1(template, instances);
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (courseSets_2_1 && !courseSets_2_1.done && (_o = courseSets_2.return)) _o.call(courseSets_2);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                    return [4 /*yield*/, migrateTasks()];
                case 1:
                    _p.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject-inner.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject-inner.tsx ***!
  \***********************************************************************/
/*! exports provided: ShowSubjectInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubjectInner", function() { return ShowSubjectInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");




var ShowSubjectInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubjectInner, _super);
    function ShowSubjectInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubjectInner.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubjectInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubjectInner.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schoolType === 'primary' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Grundskole\u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, code = _a.code, publishable = _a.publishable, points = _a.points, schoolGrade = _a.schoolGrade;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " f\u00F6r \u00E5rskurs ",
                    schoolGrade);
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Kurser f\u00F6r \u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, name = _a.name, code = _a.code, publishable = _a.publishable, points = _a.points;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " - ",
                    points,
                    "p");
            }))));
    };
    return ShowSubjectInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject.tsx ***!
  \*****************************************************************/
/*! exports provided: ShowSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return ShowSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _show_subject_inner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./show-subject-inner */ "./src/components/course-builder/subjects/show-subject-inner.tsx");






var ShowSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubject, _super);
    function ShowSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubject.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubject.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubject.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_3__["CourseBanner"], { title: name, activePage: "subjects", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_show_subject_inner__WEBPACK_IMPORTED_MODULE_5__["ShowSubjectInner"], { id: this.props.id }));
    };
    return ShowSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/skolverket-subject.ts":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/subjects/skolverket-subject.ts ***!
  \**********************************************************************/
/*! exports provided: parseSkolverketYears */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseSkolverketYears", function() { return parseSkolverketYears; });
function parseSkolverketYears(inYear) {
    switch (inYear.trim()) {
        case '3':
        case '1-3':
            return ['1-3'];
        case '6':
        case '4-6':
            return ['4-6'];
        case '7-9':
        case '9':
            return ['7-9'];
        // Specials
        case '1': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1s': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1-6': return ["1-3", "4-6"]; // Förekommer i ämnet "Hem- och konsumentkunskap"
        case '4-9': return ["4-6", "7-9"]; // Förekommer i ämnet "Moderna språk"
        default: {
            throw new Error("Unexpected year in Skolverket XML: " + inYear + ". Expecting 3,6,9 or 1-3, 4-6, 7-9");
        }
    }
}


/***/ }),

/***/ "./src/components/course-builder/subjects/subjects-inner.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/course-builder/subjects/subjects-inner.tsx ***!
  \*******************************************************************/
/*! exports provided: ShowSubject, SubjectsInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectsInner", function() { return SubjectsInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _skolverket_subject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./skolverket-subject */ "./src/components/course-builder/subjects/skolverket-subject.ts");
/* harmony import */ var _uploaded_subject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./uploaded-subject */ "./src/components/course-builder/subjects/uploaded-subject.tsx");
/* harmony import */ var _show_subject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./show-subject */ "./src/components/course-builder/subjects/show-subject.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return _show_subject__WEBPACK_IMPORTED_MODULE_7__["ShowSubject"]; });

/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");











var SubjectsInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SubjectsInner, _super);
    function SubjectsInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isListingSubjects: true,
            gymnasiumSubjects: [],
            primarySchoolSubjects: [],
            uploadedSubject: null
        };
        return _this;
    }
    SubjectsInner.prototype.componentWillMount = function () {
        this.load();
    };
    SubjectsInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subjects, gymnasiumSubjects, primarySchoolSubjects;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        subjects = _a.sent();
                        subjects.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("name"));
                        gymnasiumSubjects = subjects.filter(function (s) { return s.schoolType !== 'primary'; });
                        primarySchoolSubjects = subjects.filter(function (s) { return s.schoolType === 'primary'; });
                        this.setState({ gymnasiumSubjects: gymnasiumSubjects, primarySchoolSubjects: primarySchoolSubjects, isListingSubjects: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.handleFileSelect = function (ev) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var files, xml, doc, typeOfSchooling, schoolType, model, courses, i, course, knownledgeRequirements, centralContents, knowledgeRequirements, centralContentsByStadium_1, knowledgeRequirementsByStadium_1, subjectName_1, subjectCode_1, subjectPurpose, coursesByStadium, model;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        ev.stopPropagation();
                        ev.preventDefault();
                        files = ev.dataTransfer.files;
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_9__["readBlobAsText"])(files[0])];
                    case 1:
                        xml = _a.sent();
                        doc = jquery__WEBPACK_IMPORTED_MODULE_4___default()(jquery__WEBPACK_IMPORTED_MODULE_4___default.a.parseXML(xml));
                        typeOfSchooling = doc.find("subject>originatorTypeOfSchooling").text().trim() ||
                            doc.find("subject>typeOfSchooling").text().trim();
                        schoolType = typeOfSchooling === "COMPULSORY_SCHOOL" ?
                            'primary' :
                            typeOfSchooling === "UPPER_SECONDARY_EDUCATION" ?
                                'gymnasium' :
                                null;
                        if (schoolType === 'gymnasium') {
                            model = {
                                name: doc.find("subject>name").text().trim(),
                                code: doc.find("subject>code").text().trim(),
                                purpose: doc.find("subject>purpose").text().trim(),
                                courses: [],
                                schoolType: 'gymnasium'
                            };
                            courses = doc.find("subject>courses");
                            for (i = 0; i < courses.length; ++i) {
                                course = jquery__WEBPACK_IMPORTED_MODULE_4___default()(courses[i]);
                                knownledgeRequirements = [].slice.call(course.find("knowledgeRequirements"))
                                    .map(function (r) { return ({
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('gradeStep').text().trim(),
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('text').text().trim()
                                }); });
                                model.courses.push({
                                    name: course.find("name").text().trim(),
                                    code: course.find("code").text().trim(),
                                    centralContent: course.find("centralContent").text().trim(),
                                    points: parseInt(course.find("point").text().trim()),
                                    knownledgeRequirements: knownledgeRequirements,
                                });
                            }
                            this.setState({ uploadedSubject: model });
                        }
                        else {
                            centralContents = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>centralContent"))
                                .map(function (cc) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('year').text().trim();
                                var typeOfCentralContent = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('typeOfCentralContent').text().trim();
                                if (typeOfCentralContent) {
                                    // Do not yet support multiple types of central content.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                var stadiums = Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year);
                                var centralContentsForEachStadium = stadiums.map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('text').text().trim()
                                }); });
                                return centralContentsForEachStadium;
                            }));
                            knowledgeRequirements = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>knowledgeRequirement"))
                                .map(function (kr) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('year').text().trim();
                                var typeOfRequirement = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('typeOfRequirement').text().trim();
                                if (typeOfRequirement) {
                                    // Do not yet support multiple types of knowledge requirement.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                return Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year).map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('text').text().trim(),
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('gradeStep').text().trim()
                                }); });
                            }));
                            centralContentsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(centralContents, function (cc) { return cc.year; });
                            knowledgeRequirementsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(knowledgeRequirements, function (kr) { return kr.year; });
                            subjectName_1 = doc.find("subject>name").text().trim();
                            subjectCode_1 = doc.find("subject>code").text().trim();
                            subjectPurpose = doc.find("subject>purpose").text().trim();
                            coursesByStadium = ['1-3', '4-6', '7-9']
                                .map(function (stadium) { return ({
                                name: subjectName_1 + ' ' + stadium,
                                code: subjectCode_1 + '|' + stadium,
                                points: 0,
                                year: stadium,
                                centralContent: (centralContentsByStadium_1[stadium] || []).map(function (cc) { return cc.text; }).join('\n'),
                                knownledgeRequirements: (knowledgeRequirementsByStadium_1[stadium] || []).map(function (_a) {
                                    var gradeStep = _a.gradeStep, text = _a.text;
                                    return ({ gradeStep: gradeStep, text: text });
                                })
                            }); });
                            model = {
                                name: subjectName_1,
                                code: subjectCode_1,
                                purpose: subjectPurpose,
                                schoolType: 'primary',
                                courses: coursesByStadium
                            };
                            this.setState({ uploadedSubject: model });
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.onImportSuccess = function (subject) {
        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Importen av ", " lyckades"], ["Importen av ", " lyckades"])), subject));
        this.setState({ uploadedSubject: null });
        this.load();
    };
    SubjectsInner.prototype.render = function () {
        var _this = this;
        var linkPrefix = this.props.linkPrefix;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, this.state.uploadedSubject ?
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_uploaded_subject__WEBPACK_IMPORTED_MODULE_6__["UploadedSubject"], { onCancel: function () { return _this.setState({ uploadedSubject: null }); }, onImportSuccess: function (subject) { return _this.onImportSuccess(subject); }, subject: this.state.uploadedSubject })
            : this.state.isListingSubjects ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__["Spinner"], null),
                        "Var god v\u00E4nta medan \u00E4mnen h\u00E4mtas...")) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Gymnasie\u00E4mnen"], ["Gymnasie\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.gymnasiumSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Grundskole\u00E4mnen"], ["Grundskole\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.primarySchoolSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone", onDragOver: _utils__WEBPACK_IMPORTED_MODULE_9__["allowCopy"], onDrop: function (ev) { return _this.handleFileSelect(ev); } },
                        "Droppa Subject-fil h\u00E4r fr\u00E5n skolverket (H\u00E4mtas fr\u00E5n ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "http://opendata.skolverket.se", target: "skolverket" }, "opendata.skolverket.se"),
                        ")")));
    };
    return SubjectsInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-builder/subjects/uploaded-subject.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/subjects/uploaded-subject.tsx ***!
  \*********************************************************************/
/*! exports provided: UploadedSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UploadedSubject", function() { return UploadedSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./diff/diff-xml-with-database */ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts");







var UploadedSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UploadedSubject, _super);
    function UploadedSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.coursesElems = {};
        _this.centralContentElems = [];
        _this.knowledgeRequirementElems = [];
        _this.state = {
            showFullText: false,
            changes: [],
            isWorking: true,
            isImporting: false
        };
        return _this;
    }
    UploadedSubject.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, changes, subjectToImport, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.addClassesForCherryPickedElements();
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, 4, 5]);
                        return [4 /*yield*/, this.diffWithExisting()];
                    case 2:
                        _a = _b.sent(), changes = _a.changes, subjectToImport = _a.subjectToImport;
                        this.setState({ changes: changes, subjectToImport: subjectToImport });
                        return [3 /*break*/, 5];
                    case 3:
                        error_1 = _b.sent();
                        this.setState({ error: '' + error_1 });
                        return [3 /*break*/, 5];
                    case 4:
                        this.setState({ isWorking: false });
                        return [7 /*endfinally*/];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.addClassesForCherryPickedElements = function () {
        var abilities = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li');
        abilities.addClass('ability');
        var centralContents = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.centralContentElems).find('li');
        centralContents.addClass('central-content');
        var knowledgeRequirements = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.knowledgeRequirementElems).find('p');
        knowledgeRequirements.addClass('knowledge-requirement');
        var all = jquery__WEBPACK_IMPORTED_MODULE_3___default()([abilities, centralContents, knowledgeRequirements]);
        all.addClass('marked-area');
    };
    UploadedSubject.prototype.cherryPickData = function () {
        var _this = this;
        //
        // Reads elements (tagged by classes in addClassesForCherryPickedElements()) and converts their inner HTML to the corresponding
        // model SubjectToImport. Note that if we need to adjust how to pick the right LI or P elements, we
        // will only need to change the code in addClassesForCherryPickedElements(), not this code.
        //
        var skolSubject = this.props.subject;
        var abilitiesLis = Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li'));
        var abilities = abilitiesLis.map(function (a, i) { return (i + 1 + ". " + jquery__WEBPACK_IMPORTED_MODULE_3___default()(a).html()).trim(); }).filter(function (html) { return !!html; });
        var result = {
            name: skolSubject.name,
            code: skolSubject.code,
            schoolType: skolSubject.schoolType,
            abilities: abilities,
            courses: Object.keys(this.coursesElems)
                .map(function (courseCode) { return _this.coursesElems[courseCode]; })
                .map(function (_a) {
                var course = _a.course, elem = _a.elem;
                return ({
                    name: course.name,
                    year: course.year,
                    code: course.code,
                    points: course.points,
                    centralContent: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.central-content')).map(function (c) { return ({
                        html: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).html().trim(),
                        group: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).parent('ul').prev('h4').text().trim()
                    }); }).filter(function (_a) {
                        var html = _a.html;
                        return !!html;
                    }),
                    knowledgeRequirements: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-none .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: null, html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-E .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "E", html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-C .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "C", html: html }); }))
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-A .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "A", html: html }); })))
                });
            })
        };
        return result;
    };
    UploadedSubject.prototype.diffWithExisting = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            function ct() {
                var rv = createTime;
                createTime += 2;
                return rv;
            }
            var subjectToImport, changes, existingSubjects, existingSubject, centralContent, knowledgeRequirements, createTime, newSubject_1, subjectAbilities, _loop_1, _a, _b, a, _loop_2, _c, _d, c;
            var e_1, _e, e_2, _f;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_g) {
                switch (_g.label) {
                    case 0:
                        subjectToImport = this.cherryPickData();
                        changes = [];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        existingSubjects = _g.sent();
                        existingSubject = existingSubjects.filter(function (s) { return s.code === _this.props.subject.code; })[0];
                        centralContent = [], knowledgeRequirements = [];
                        createTime = Date.now();
                        if (!existingSubject) return [3 /*break*/, 3];
                        // Include abilities and standardCourses with the found Subject:
                        return [4 /*yield*/, Object(_diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__["diffXmlWithDatabase"])(existingSubject, subjectToImport, changes)];
                    case 2:
                        // Include abilities and standardCourses with the found Subject:
                        _g.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        newSubject_1 = existingSubject = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            schoolType: subjectToImport.schoolType,
                            tags: ["schoolType:" + subjectToImport.schoolType],
                            acl: ["role:USER:R"],
                            code: subjectToImport.code,
                            name: subjectToImport.name,
                            abilitiesOrder: [],
                            publishable: false,
                            dateTime: ct()
                        };
                        changes.push({
                            change: "Nytt ämne",
                            content: subjectToImport.name + " (" + subjectToImport.code + ")",
                            mutations: function (r) { return r.add("subjects", newSubject_1); }
                        });
                        subjectAbilities = [];
                        _loop_1 = function (a) {
                            var newAbility = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                name: a,
                                acl: ["role:USER:R"],
                                dateTime: ct()
                            };
                            subjectAbilities.push(newAbility); // To refer from in courses later on!
                            changes.push({
                                change: "Ny förmåga",
                                content: a,
                                mutations: function (r) {
                                    r.add("abilities", newAbility);
                                    r.link("subjects", newSubject_1.id, "abilities", newAbility.id, "abilities");
                                }
                            });
                        };
                        try {
                            for (_a = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.abilities), _b = _a.next(); !_b.done; _b = _a.next()) {
                                a = _b.value;
                                _loop_1(a);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_b && !_b.done && (_e = _a.return)) _e.call(_a);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        // Update now when we have abilities order:
                        newSubject_1.abilitiesOrder = subjectAbilities.map(function (_a) {
                            var id = _a.id;
                            return id;
                        });
                        _loop_2 = function (c) {
                            var e_3, _a, e_4, _b, e_5, _c;
                            var newCourse = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                subjectCode: newSubject_1.code,
                                schoolType: newSubject_1.schoolType,
                                tags: [
                                    "sub:" + newSubject_1.code,
                                    "course:" + c.code,
                                    "schoolType:" + newSubject_1.schoolType
                                ],
                                dateTime: ct(),
                                isTemplate: true,
                                acl: ["role:EMPLOYEE:R"],
                                name: c.name,
                                code: c.code,
                                points: c.points,
                                modules: [],
                                subjectId: newSubject_1.id,
                                resources: [],
                                createdBy: { name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.displayName, url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.mail },
                                createdDate: Date.now(),
                                knowledgeRequirementsOrder: [],
                                centralContentOrder: [],
                                abilitiesOrder: subjectAbilities.map(function (_a) {
                                    var id = _a.id;
                                    return id;
                                })
                            };
                            if (c.year)
                                newCourse.schoolGrade = c.year;
                            changes.push({
                                change: "Ny kurs",
                                content: c.name,
                                mutations: function (r) {
                                    r.add("courses", newCourse);
                                    r.link("subjects", newSubject_1.id, "courses", newCourse.id, "courseTemplates");
                                }
                            });
                            var _loop_3 = function (ccGroup, html) {
                                // Check if there exists an identical central content on previous course first
                                var newCentralContent = centralContent.filter(function (cc) { return cc.name === html; })[0];
                                if (!newCentralContent) {
                                    newCentralContent = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: html,
                                        acl: ["role:USER:R"]
                                    };
                                    if (ccGroup)
                                        newCentralContent.group = ccGroup;
                                    centralContent.push(newCentralContent);
                                    changes.push({
                                        change: "Nytt centralt innehåll",
                                        content: "<h4>" + ccGroup + "</h4>" + html,
                                        mutations: function (r) {
                                            r.add("central-content", newCentralContent);
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                // Register the order in which this central content appeared in the XML:
                                newCourse.centralContentOrder.push(newCentralContent.id);
                            };
                            try {
                                for (var _d = (e_3 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.centralContent)), _e = _d.next(); !_e.done; _e = _d.next()) {
                                    var _f = _e.value, ccGroup = _f.group, html = _f.html;
                                    _loop_3(ccGroup, html);
                                }
                            }
                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                            finally {
                                try {
                                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                                }
                                finally { if (e_3) throw e_3.error; }
                            }
                            var _loop_4 = function (cr) {
                                var newKnowledgeRequirement = knowledgeRequirements.filter(function (kr) { return kr.name === cr.html && kr.gradeStep === cr.gradeStep; })[0];
                                if (!newKnowledgeRequirement) {
                                    newKnowledgeRequirement = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: cr.html,
                                        gradeStep: cr.gradeStep,
                                        acl: ["role:USER:R"]
                                    };
                                    knowledgeRequirements.push(newKnowledgeRequirement);
                                    changes.push({
                                        change: "Nytt kunskapskrav för betyget " + cr.gradeStep,
                                        content: cr.html,
                                        mutations: function (r) {
                                            r.add("knowledge-requirements", newKnowledgeRequirement);
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                // Register the order in which this knowledge requirement appeared in the XML:
                                newCourse.knowledgeRequirementsOrder.push(newKnowledgeRequirement.id);
                            };
                            try {
                                for (var _g = (e_4 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.knowledgeRequirements)), _h = _g.next(); !_h.done; _h = _g.next()) {
                                    var cr = _h.value;
                                    _loop_4(cr);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            var _loop_5 = function (a) {
                                changes.push({
                                    mutations: function (r) {
                                        r.link("courses", newCourse.id, "abilities", a.id, "abilities");
                                    }
                                });
                            };
                            try {
                                // Build knowledge matrix
                                // Link directly from course template to all abilities that the subject has:
                                for (var subjectAbilities_1 = (e_5 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectAbilities)), subjectAbilities_1_1 = subjectAbilities_1.next(); !subjectAbilities_1_1.done; subjectAbilities_1_1 = subjectAbilities_1.next()) {
                                    var a = subjectAbilities_1_1.value;
                                    _loop_5(a);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (subjectAbilities_1_1 && !subjectAbilities_1_1.done && (_c = subjectAbilities_1.return)) _c.call(subjectAbilities_1);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        };
                        try {
                            for (_c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.courses), _d = _c.next(); !_d.done; _d = _c.next()) {
                                c = _d.value;
                                _loop_2(c);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_f = _c.return)) _f.call(_c);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        _g.label = 4;
                    case 4: return [2 /*return*/, { changes: changes, subjectToImport: subjectToImport }];
                }
            });
        });
    };
    UploadedSubject.prototype.cancel = function () {
        this.props.onCancel();
    };
    UploadedSubject.prototype.import = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var allMutations;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ isWorking: true, isImporting: true });
                        allMutations = this.state.changes.map(function (change) { return change.mutations; });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.do(function (r) {
                                allMutations.forEach(function (mut) { return mut(r); });
                            })];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.setState({ isWorking: false, isImporting: false });
                        return [7 /*endfinally*/];
                    case 4:
                        this.props.onImportSuccess(this.props.subject.name);
                        return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.fixL = function (html) {
        return html; //.replace('<l fromat="OL">')
    };
    UploadedSubject.prototype.render = function () {
        var _this = this;
        var subjectToImport = this.state.subjectToImport;
        var subject = this.props.subject;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Uppladdat \u00C4mne ", ""], ["Uppladdat \u00C4mne ", ""])), subjectToImport ? subjectToImport.name : '')),
            this.state.error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Fel: ",
                this.state.error) :
                this.state.isWorking ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Arbetar...") :
                    this.state.isImporting ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Importerar...") :
                        this.state.changes.every(function (c) { return !c.change; }) ? // Inga ändringar att visa (bara pseudo-ändringar)
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kunde inte finna n\u00E5gra f\u00F6r\u00E4ndringar fr\u00E5n befintligt data. Klicka OK f\u00F6r att avbryta och \u00E5terg\u00E5."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); } }, " OK ")) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { border: "1px solid gray", padding: "2px" } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { colSpan: 2 }, "Granskning av \u00E4ndringar i grund-data")),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4ndring"),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inneh\u00E5ll"))),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, this.state.changes.filter(function (change) { return change.change; }).map(function (change, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" } }, change.change),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" }, dangerouslySetInnerHTML: { __html: change.content } })); }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); }, disabled: this.state.isImporting }, "Avbryt"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.import(); }, disabled: this.state.isImporting }, "Importera"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.setState({ showFullText: !_this.state.showFullText }); } }, this.state.showFullText ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["D\u00F6lj nedan"], ["D\u00F6lj nedan"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Visa hela texten fr\u00E5n Skolverket"], ["Visa hela texten fr\u00E5n Skolverket"])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { display: this.state.showFullText ? '' : 'none' } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Namn"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4mneskod"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.code)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Syfte"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.purposeElem = elem; }, dangerouslySetInnerHTML: { __html: this.fixL(subject.purpose) } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurser"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.courses.map(function (course) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { key: course.code, ref: function (elem) { return _this.coursesElems[course.code] = { course: course, elem: elem }; } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kursens namn"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.name)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurskod"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.code)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Po\u00E4ng"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.points)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Centralt inneh\u00E5ll"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.centralContentElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.centralContent) } })),
                                course.knownledgeRequirements.some(function (kr) { return !kr.gradeStep; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav utan betygs\u00E4ttning"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-none", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return !r.gradeStep; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'E'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg E"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-E", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'E'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'C'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg C"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-C", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'C'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'A'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg A"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-A", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'A'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined)); }))))));
    };
    return UploadedSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, getEmailFromDocAccess, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse, hasChanges */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEmailFromDocAccess", function() { return getEmailFromDocAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasChanges", function() { return hasChanges; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added)), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = (e_3 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed)), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = (e_4 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated)), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: now },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function getEmailFromDocAccess(resource) {
    if (resource.email)
        return resource.email;
    return resource.url ?
        resource.url.startsWith('mailto:') ?
            resource.url.substring('mailto:'.length) :
            resource.url :
        resource.url;
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}
// Check differences between two array of type T
function hasChanges(originalValues, currentValues) {
    return originalValues === undefined || currentValues.filter(function (x) { return !originalValues.includes(x); }).length > 0 || originalValues.filter(function (x) { return !currentValues.includes(x); }).length > 0;
}


/***/ }),

/***/ "./src/components/utility-components/LanguageContext.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/LanguageContext.tsx ***!
  \***************************************************************/
/*! exports provided: LanguageContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LanguageContext", function() { return LanguageContext; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var LanguageContext = react__WEBPACK_IMPORTED_MODULE_0__["createContext"]({ intl: null });


/***/ }),

/***/ "./src/components/utility-components/SetupLanguageIntl.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/SetupLanguageIntl.tsx ***!
  \*****************************************************************/
/*! exports provided: setupIntl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupIntl", function() { return setupIntl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl/locale-data/en */ "./node_modules/react-intl/locale-data/en.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl/locale-data/sv */ "./node_modules/react-intl/locale-data/sv.js");
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../translations/sv.json */ "./src/translations/sv.json");
var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/sv.json */ "./src/translations/sv.json", 1);
/* harmony import */ var _translations_en_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../translations/en.json */ "./src/translations/en.json");
var _translations_en_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/en.json */ "./src/translations/en.json", 1);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__);









var setupIntl = function (Component) {
    return /** @class */ (function (_super) {
        tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_SetupLanguageIntl, _super);
        function _SetupLanguageIntl(props) {
            var _this = _super.call(this, props) || this;
            Object(react_intl__WEBPACK_IMPORTED_MODULE_1__["addLocaleData"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default.a, react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default.a));
            _this.messages = {
                'sv': _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__,
                'en': _translations_en_json__WEBPACK_IMPORTED_MODULE_5__
            };
            moment__WEBPACK_IMPORTED_MODULE_8___default()().locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE);
            return _this;
        }
        _SetupLanguageIntl.prototype.render = function () {
            return react__WEBPACK_IMPORTED_MODULE_6__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_1__["IntlProvider"], { locale: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE, messages: this.messages[_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE] },
                react__WEBPACK_IMPORTED_MODULE_6__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.props)));
        };
        return _SetupLanguageIntl;
    }(react__WEBPACK_IMPORTED_MODULE_6__["Component"]));
};


/***/ }),

/***/ "./src/components/utility-components/checklist.tsx":
/*!*********************************************************!*\
  !*** ./src/components/utility-components/checklist.tsx ***!
  \*********************************************************/
/*! exports provided: Checklist */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Checklist", function() { return Checklist; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Checklist = function (_a) {
    var available = _a.available, selected = _a.selected, onChange = _a.onChange;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", { className: "taskContainer" }, available.map(function (_a) {
        var key = _a.key, name = _a.name;
        var checked = selected.includes(key);
        return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", { key: key, className: "align-horizontal" },
            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", { className: "horizontalItem top", onClick: function () {
                    return onChange(checked ?
                        selected.filter(function (k) { return k != key; }) :
                        selected.concat(key), key, checked);
                } },
                react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", { className: "checkBox" + (checked ? " checked" : "") })),
            react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", { className: "horizontalItem top" }, name));
    }));
};


/***/ }),

/***/ "./src/components/utility-components/form-field-text-input.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/utility-components/form-field-text-input.tsx ***!
  \*********************************************************************/
/*! exports provided: TextInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextInput", function() { return TextInput; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextInput = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextInput, _super);
    function TextInput(props) {
        return _super.call(this, props) || this;
    }
    TextInput.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: this.props.autoFocus, id: this.props.id, size: 35, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder }))));
    };
    return TextInput;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-textarea.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/form-field-textarea.tsx ***!
  \*******************************************************************/
/*! exports provided: TextAreaFormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextAreaFormField", function() { return TextAreaFormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextAreaFormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextAreaFormField, _super);
    function TextAreaFormField(props) {
        return _super.call(this, props) || this;
    }
    TextAreaFormField.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label, id: this.props.id },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: this.props.autoFocus, id: this.props.id, cols: 35, rows: this.props.rows || 5, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder })),
                !!this.props.children && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" }, this.props.children))));
    };
    return TextAreaFormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field.tsx":
/*!**********************************************************!*\
  !*** ./src/components/utility-components/form-field.tsx ***!
  \**********************************************************/
/*! exports provided: FormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormField", function() { return FormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function findId(node) {
    var recucheck = new Set();
    return (function findId(node) {
        if (typeof node === 'string')
            return null;
        if (recucheck.has(node)) {
            return;
        }
        recucheck.add(node);
        if (node.props) {
            if (node.props.id)
                return node.props.id;
            if (node.props.children) {
                return findId(node.props.children);
            }
            return;
        }
        if (node.length) {
            for (var i = 0; i < node.length; ++i) {
                var child = node[i];
                if (child) {
                    var childId = findId(child);
                    if (childId)
                        return childId;
                    //console.log(child);
                }
            }
        }
    })(node);
}
var FormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FormField, _super);
    function FormField(props) {
        return _super.call(this, props) || this;
    }
    FormField.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel", htmlFor: this.props.id || findId(this.props.children) }, this.props.label),
            this.props.children);
    };
    return FormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/lazy-content.tsx":
/*!************************************************************!*\
  !*** ./src/components/utility-components/lazy-content.tsx ***!
  \************************************************************/
/*! exports provided: LazyContent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LazyContent", function() { return LazyContent; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _live_query_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./live-query-view */ "./src/components/utility-components/live-query-view.tsx");


function LazyContent(_a) {
    var children = _a.children, spinner = _a.spinner, onError = _a.onError, noError = _a.noError;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_live_query_view__WEBPACK_IMPORTED_MODULE_1__["LiveQueryView"], { props: children, spinner: spinner, noError: noError, onError: onError, fn: function (observable) { return observable; } });
}


/***/ }),

/***/ "./src/components/utility-components/live-query-view.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/live-query-view.tsx ***!
  \***************************************************************/
/*! exports provided: liveQueryView, LiveQueryView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "liveQueryView", function() { return liveQueryView; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LiveQueryView", function() { return LiveQueryView; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");



function liveQueryView(fn, options) {
    return function (props) {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](LiveQueryView, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ props: props, fn: fn }, options));
    };
}
var LiveQueryView = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LiveQueryView, _super);
    function LiveQueryView(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            result: null,
            isLoading: true
        };
        return _this;
    }
    LiveQueryView.prototype.componentDidMount = function () {
        this.subscribe();
    };
    LiveQueryView.prototype.componentWillUnmount = function () {
        this.unsubscribe();
    };
    LiveQueryView.prototype.shouldComponentUpdate = function (nextProps, nextState) {
        return (this.state.error !== nextState.error ||
            this.state.isLoading !== nextState.isLoading ||
            this.state.result !== nextState.result ||
            !Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["shallowEquals"])(nextProps.props, this.props.props));
    };
    LiveQueryView.prototype.componentDidUpdate = function (prevProps) {
        if (!Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["shallowEquals"])(prevProps.props, this.props.props)) {
            this.unsubscribe();
            this.subscribe();
        }
    };
    LiveQueryView.prototype.subscribe = function () {
        var _this = this;
        this.setState({ isLoading: true });
        this.subscription = this.props.fn(this.props.props).subscribe(function (result, error) { return _this.setState({
            result: result,
            error: error,
            isLoading: false
        }); });
    };
    LiveQueryView.prototype.unsubscribe = function () {
        if (this.subscription) {
            this.subscription.unsubscribe();
            this.subscription = null;
        }
    };
    LiveQueryView.prototype.render = function () {
        var _a = this.state, result = _a.result, error = _a.error, isLoading = _a.isLoading;
        var _b = this.props, spinner = _b.spinner, onError = _b.onError, noError = _b.noError;
        //if (!isLoading && !result) debugger;
        return error ?
            noError ? "" : onError ? onError(error) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Error: ",
                error.message) :
            isLoading ?
                spinner ? spinner : "" :
                result === undefined ? "" : result;
    };
    return LiveQueryView;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/loading-indicator.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/loading-indicator.tsx ***!
  \*****************************************************************/
/*! exports provided: LoadingIndicator */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoadingIndicator", function() { return LoadingIndicator; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _live_query_view__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./live-query-view */ "./src/components/utility-components/live-query-view.tsx");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");





var LoadingIndicator = Object(_live_query_view__WEBPACK_IMPORTED_MODULE_2__["liveQueryView"])(function () {
    return _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.http.status.combineLatest(_globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].edsClient.http.status)
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), kedBackendStatus = _b[0], edsStatus = _b[1];
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "loading-indicator" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "indicator" }, kedBackendStatus.numOutstandingOperations > 0 || edsStatus.numOutstandingOperations > 0 ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__["Spinner"], null) : undefined));
    });
});


/***/ }),

/***/ "./src/components/utility-components/multiselect.tsx":
/*!***********************************************************!*\
  !*** ./src/components/utility-components/multiselect.tsx ***!
  \***********************************************************/
/*! exports provided: Multiselect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Multiselect", function() { return Multiselect; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");




var Multiselect = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Multiselect, _super);
    function Multiselect(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            optionsVisible: false
        };
        return _this;
    }
    Multiselect.prototype.render = function () {
        var _this = this;
        var _a = this.props, selected = _a.selected, onChange = _a.onChange, getOptions = _a.getOptions;
        var _b = this.state, optionsVisible = _b.optionsVisible, options = _b.options;
        var filteredOptions = options && options.filter(function (o) { return !selected.some(function (s) { return s.key === o.key; }); });
        return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null,
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "taskContainer" }, selected.map(function (_a) {
                var key = _a.key, name = _a.name;
                //const checked = selected.includes(key);
                return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { key: key, className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("i", { className: "fa fa-remove hoverable", onClick: function () { return onChange(selected.filter(function (option) { return option.key !== key; })); } }),
                        name));
            })),
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("span", { style: { outline: 'none' }, tabIndex: 0, onBlur: function (ev) { return setTimeout(function () { return _this.setState({ optionsVisible: false }); }, 100); } },
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a", { className: "btn", onClick: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                        var options_1, err_1;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    if (optionsVisible)
                                        return [2 /*return*/, this.setState({ optionsVisible: false })];
                                    this.setState({ optionsVisible: true });
                                    if (!!this.state.options) return [3 /*break*/, 4];
                                    _a.label = 1;
                                case 1:
                                    _a.trys.push([1, 3, , 4]);
                                    return [4 /*yield*/, getOptions()];
                                case 2:
                                    options_1 = _a.sent();
                                    this.setState({ options: options_1 });
                                    return [3 /*break*/, 4];
                                case 3:
                                    err_1 = _a.sent();
                                    this.setState({ options: [{ key: null, name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ett fel har intr\u00E4ffat"], ["Ett fel har intr\u00E4ffat"]))) }] });
                                    return [3 /*break*/, 4];
                                case 4: return [2 /*return*/];
                            }
                        });
                    }); } },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("i", { className: "fa fa-plus", "aria-hidden": true }),
                    " ", Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till"], ["L\u00E4gg till"])))),
                optionsVisible ? react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null,
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("br", null),
                    filteredOptions ?
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("select", { size: filteredOptions.length === 1 ? 2 : filteredOptions.length, defaultValue: '', onChange: function (ev) {
                                var selectedKey = ev.target.value;
                                onChange(selected.concat({ key: selectedKey, name: options.filter(function (o) { return o.key === selectedKey; }).map(function (o) { return o.name; })[0] }));
                                _this.setState({ optionsVisible: false });
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { style: { display: 'none' }, disabled: true, key: '', value: '' }),
                            filteredOptions.map(function (_a) {
                                var key = _a.key, name = _a.name;
                                return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { key: key, value: key }, name);
                            })) :
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_2__["Spinner"], null)) :
                    undefined));
    };
    return Multiselect;
}(react__WEBPACK_IMPORTED_MODULE_1___default.a.Component));

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../charts/goal-progress */ "./src/components/charts/goal-progress.tsx");
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/



var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName, displayProgress = _a.displayProgress, progressData = _a.progressData, inactivated = _a.inactivated, inactivatedRender = _a.inactivatedRender;
        var headerOpen = this.state.headerOpen;
        if (inactivated)
            return inactivatedRender === 'titleAndChildren' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children)) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children);
        //var currentProgressData = //progressData();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeaderContainer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, title),
                    displayProgress && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__["GoalProgress"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, progressData)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/elements/KEDAppSubjectPlannerAdmin/app.spadmin.client.tsx":
/*!***********************************************************************!*\
  !*** ./src/elements/KEDAppSubjectPlannerAdmin/app.spadmin.client.tsx ***!
  \***********************************************************************/
/*! exports provided: KEDAppCourseBuilderKS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDAppCourseBuilderKS", function() { return KEDAppCourseBuilderKS; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _components_course_builder_ks_admin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/course-builder-ks/admin */ "./src/components/course-builder-ks/admin/index.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");



var bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer(); // Start getting bearer as soon as possible.







var _KEDAppCourseBuilderKS = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_KEDAppCourseBuilderKS, _super);
    function _KEDAppCourseBuilderKS(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isTokenLoaded: false
        };
        return _this;
    }
    _KEDAppCourseBuilderKS.prototype.componentWillMount = function () {
        var _this = this;
        bearerPromise.then(function () {
            _this.setState({ isTokenLoaded: true });
        }).catch(function (err) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(err);
        });
    };
    _KEDAppCourseBuilderKS.prototype.render = function () {
        var intl = this.props.intl;
        return this.state.isTokenLoaded ?
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__["LanguageContext"].Provider, { value: { intl: intl } },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_components_course_builder_ks_admin__WEBPACK_IMPORTED_MODULE_6__["SubjectPlannerAdminApp"], null)) :
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__["Spinner"], null),
                "V.g. v\u00E4nta... autenticerar...");
    };
    return _KEDAppCourseBuilderKS;
}(react__WEBPACK_IMPORTED_MODULE_3__["Component"]));
var KEDAppCourseBuilderKS = Object(_components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_9__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_7__["injectIntl"])(_KEDAppCourseBuilderKS));


/***/ }),

/***/ "./src/elements/KEDAppSubjectPlannerAdmin/webpack-entry.ts":
/*!*****************************************************************!*\
  !*** ./src/elements/KEDAppSubjectPlannerAdmin/webpack-entry.ts ***!
  \*****************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED */ "./src/globals/KED.ts");
/* harmony import */ var _app_spadmin_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app.spadmin.client */ "./src/elements/KEDAppSubjectPlannerAdmin/app.spadmin.client.tsx");



_globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components, _app_spadmin_client__WEBPACK_IMPORTED_MODULE_2__);


/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://backend.kedschools.com/kedbackend-next/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE || "sv"; // "sv", "en". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE || "sv"; // "sv", "en_sin", "en_nin". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL || process.env.KED_RESOURCES_URL;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive"
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive"
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default, cfg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cfg", function() { return cfg; });
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);
var cfg = _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg;


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default, env */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "env", function() { return env; });
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);
var env = _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env;


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "./kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.displayName || _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/translations/en.json":
/*!**********************************!*\
  !*** ./src/translations/en.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, addeditsubtask.addSubtask, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.ict, termplanner.loadingTermplanner, termplanner.maths, termplanner.modernLanguage, termplanner.noFinalStepAvailable, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, termplanner.yoga, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.deleteSubtask":"Delete subtask","addeditsubtask.editSubtask":"Edit subtask","addeditsubtask.nameLabel":"Name of subtask","addeditsubtask.addSubtask":"Add sub-task","calendar.currentDate":"Week {week}, {year}","calendar.fullDayEventLocation":"Place: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"W{weekNumber}","common.addDescriptionPlhd":"Add description...","common.cancel":"Cancel","common.changesNotSavedErrorOccured":"An error occured while saving data. Your changes were not saved.","common.changesNotSavedUnauthorized":"The changes were not saved due to insufficient authority","common.descriptionLabel":"Description","common.errorSavingData":"An error occured while saving data.","common.linkLabel":"Link","common.loading":"Loading...","common.nameLabel":"Name","common.save":" Save","common.saved":" Saved","common.saving":"Saving","common.remove":"Delete","customTask.addWorkGoalTitle":"Add own working goal","customTask.enterNamePlhd":"Enter Name...","learningGoalsLost.overall":"Overall","task.addSubtask":"Add subtask","task.editTask":"Edit task","task.editWorkGoals":"Edit working goal","task.enterTaskNamePlhd":"Enter the name of task...","task.removeDeadline":"Delete deadline","task.removeThisTask":"Delete this task","task.removeWorkGoals":"Delete working goal","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Set deadline...","task.subTasks":"Subtasks","task.targetNameLabel":"Name of working goal","task.taskNameLabel":"Name of task","task.whatShouldYouDoPlhd":"What should you do?","taskList.nextWeekTask":"for next week (w{week})","taskList.lastWeekTask":"for last week (w{week})","taskList.currentWeekTask":"for week {week}","taskList.removeTaskFromWeeklyPlanning":"Delete task from your weekly planning {week}","taskList.addTaskToWeeklyPlanning":"Add task to your weekly planning {week}","termplanner.comments":"Comments","termplanner.course":"Theme course","termplanner.edsGoalGrades":"Intermediate goals","termplanner.englishLanguage":"Eng","termplanner.finalStep":"Final Step","termplanner.firstTerm":"FT {year}","termplanner.hindiLanguage":"Hindi","termplanner.ict":"ICT","termplanner.loadingTermplanner":"Loading Termplanner","termplanner.maths":"Maths","termplanner.modernLanguage":"MFL","termplanner.noFinalStepAvailable":"No final step available","termplanner.secondTerm":"ST {year}","termplanner.termPlanning":"Term planner","termplanner.weekNumber":"Week","termplanner.chartsBoxTitle":"Progress Charts","termplanner.yoga":"Yoga","tutorNoteDialog.weekComment":"Note for week {weekNumber}","test.chooseComponentLabel":"Component","test.pageDescription":"Test page for the components on the starting page","userTasks.addLearningGoal":"Own working goal","userTasks.deleteLearningGoal":"Delete learning goal and its tasks","userTasks.goals":"Own learning goal","weekNotebook.title":"Notepad","weekplanner.addLearningGoal":"Goal:","weekplanner.addLearningGoalTitle":"Add own learning goal","weekplanner.confirmRemoveLearningObjectives":"Delete learning goal and {learningGoalsNumber} tasks?","weekplanner.copyPreviousWeekTaks":"Copy from previous week","weekplanner.emptyLearningGoalErr":"The learning goal cannot be empty","weekplanner.evaluation":"Evaluation","weekplanner.evaluationDescription":"Reflection on your work effort and your chosen strategies during the week. Evaluate in relation to your goals.","weekplanner.learningGoal":"Own learning goal","weekplanner.logBook":"Logbook","weekplanner.nameCannotBeEmpty":"Name cannot be empty","weekplanner.nameMustNotBeEmpty":"Name must not be empty","weekplanner.strategy":"Strategy","weekplanner.strategyAndEvaluation":"Strategy & Evaluation","weekplanner.strategyDescription":"What I should do to learn","weekplanner.weekNumber":"Week {weekNumber}","wysiwyg.bold":"Bold","wysiwyg.code":"Code","wysiwyg.heading1":"Heading 1","wysiwyg.heading2":"Heading 2","wysiwyg.heading3":"Heading 3","wysiwyg.image":"Insert image","wysiwyg.imagePromptMsg":"Enter the URL of the image","wysiwyg.italic":"Italics","wysiwyg.line":"Horizontal line","wysiwyg.link":"Insert link","wysiwyg.olist":"Ordered list","wysiwyg.paragraph":"Paragraph","wysiwyg.quote":"Quote","wysiwyg.strikethrough":"Strikethrough","wysiwyg.ulist":"Bullet list","wysiwyg.underline":"Underline"};

/***/ }),

/***/ "./src/translations/sv.json":
/*!**********************************!*\
  !*** ./src/translations/sv.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.addSubtask, addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.swedishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.loadingTermplanner, termplanner.modernLanguageFullname, termplanner.mathsFullname, termplanner.noFinalStepAvailable, termplanner.swedishLanguageFullName, termplanner.englishLanguageFullName, termplanner.maths, termplanner.modernLanguage, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.addSubtask":"Lägg till underuppgift","addeditsubtask.deleteSubtask":"Ta bort underuppgift","addeditsubtask.editSubtask":"Redigera underuppgift","addeditsubtask.nameLabel":"Underuppgiftens namn","calendar.currentDate":"Vecka {week}, {year}","calendar.fullDayEventLocation":"Plats: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"V{weekNumber}","common.addDescriptionPlhd":"Lägg till en beskrivning...","common.cancel":"Avbryt","common.changesNotSavedErrorOccured":"För tillfället problem att spara data. Dina ändringar sparades inte.","common.changesNotSavedUnauthorized":"Ändringarna sparades inte p.g.a. otillräcklig behörighet.","common.descriptionLabel":"Beskrivning","common.errorSavingData":"Kunde inte spara.","common.linkLabel":"Länk","common.loading":"Laddar...","common.nameLabel":"Namn","common.save":" Spara","common.saved":" Sparad","common.saving":"Sparar...","common.remove":"Ta bort","customTask.addWorkGoalTitle":"Lägg till eget arbetsmål","customTask.enterNamePlhd":"Ange namn...","learningGoalsLost.overall":"Övergripande","task.addSubtask":"Lägg till underuppgift","task.editTask":"Redigera uppgift","task.editWorkGoals":"Redigera arbetsmål","task.enterTaskNamePlhd":"Ange uppgiftens namn...","task.removeDeadline":"Ta bort deadline","task.removeThisTask":"Ta bort den här uppgiften","task.removeWorkGoals":"Ta bort arbetsmål","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Ange deadline...","task.subTasks":"Underuppgifter","task.targetNameLabel":"Arbetsmålets namn","task.taskNameLabel":"Uppgiftens namn","task.whatShouldYouDoPlhd":"Vad ska du göra?","taskList.nextWeekTask":"för nästa vecka (v{week})","taskList.lastWeekTask":"för förra veckan (v{week})","taskList.currentWeekTask":"för vecka {week}","taskList.removeTaskFromWeeklyPlanning":"Ta bort uppgiften från egen veckoplanering {week}","taskList.addTaskToWeeklyPlanning":"Lägg till uppgiften i egen veckoplanering {week}","termplanner.comments":"Kommentar","termplanner.course":"Kurs","termplanner.edsGoalGrades":"Terminsmål","termplanner.englishLanguage":"Eng","termplanner.swedishLanguage":"Sv/SvA","termplanner.finalStep":"Slutsteg","termplanner.firstTerm":"HT {year}","termplanner.hindiLanguage":"","termplanner.loadingTermplanner":"V.g. vänta medan terminsplaner laddas...","termplanner.modernLanguageFullname":"M.språk","termplanner.mathsFullname":"Matematik","termplanner.noFinalStepAvailable":"Inget slutsteg tillgängligt","termplanner.swedishLanguageFullName":"Svenska","termplanner.englishLanguageFullName":"Engelska","termplanner.maths":"Ma","termplanner.modernLanguage":"M.spr","termplanner.secondTerm":"VT {year}","termplanner.termPlanning":"Terminsplanering","termplanner.weekNumber":"Vecka","termplanner.chartsBoxTitle":"Framsteg diagram","tutorNoteDialog.weekComment":"Kommentar för vecka {weekNumber}","test.chooseComponentLabel":"Komponent","test.pageDescription":"Testsida för komponenter till nya startsidan","userTasks.addLearningGoal":"Eget arbetsmål","userTasks.deleteLearningGoal":"Ta bort lärandemålet och dess uppgifter","userTasks.goals":"Egna lärandemål","weekNotebook.title":"Anteckningar","weekplanner.addLearningGoal":"Mål:","weekplanner.addLearningGoalTitle":"Lägg till eget lärandemål","weekplanner.confirmRemoveLearningObjectives":"Ta bort lärandemål samt {learningGoalsNumber} uppgifter?","weekplanner.copyPreviousWeekTaks":"Kopiera ej klara från föregående vecka","weekplanner.emptyLearningGoalErr":"Lärandemålet kan inte vara tomt","weekplanner.evaluation":"Utvärdering","weekplanner.evaluationDescription":"Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utvärdera i förhållande till dina mål.","weekplanner.learningGoal":"Eget lärandemål","weekplanner.logBook":"Loggbok","weekplanner.nameCannotBeEmpty":"Namnet kan inte vara tomt","weekplanner.nameMustNotBeEmpty":"Namnet får inte vara tomt","weekplanner.strategy":"Strategi","weekplanner.strategyAndEvaluation":"Strategi & Utvärdering","weekplanner.strategyDescription":"Hur jag ska göra för att lära mig.","weekplanner.weekNumber":"Vecka {weekNumber}","wysiwyg.bold":"Fetstil","wysiwyg.code":"Programkod","wysiwyg.heading1":"Rubrik 1","wysiwyg.heading2":"Rubrik 2","wysiwyg.heading3":"Rubrik 3","wysiwyg.image":"Infoga bild","wysiwyg.imagePromptMsg":"Ange bildens URL","wysiwyg.italic":"Kursiv","wysiwyg.line":"Vågrät linje","wysiwyg.link":"Infoga länk","wysiwyg.olist":"Ordnad lista","wysiwyg.paragraph":"Paragraf","wysiwyg.quote":"Citat","wysiwyg.strikethrough":"Struken","wysiwyg.ulist":"Punktlista","wysiwyg.underline":"Understruken"};

/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 1)
                infos = infos.slice(1);
            return {
                infos: [message] // was: infos.concat(message). But it sucks!
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/make-suspense-api.ts":
/*!****************************************!*\
  !*** ./src/utils/make-suspense-api.ts ***!
  \****************************************/
/*! exports provided: makeSuspenseApi */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeSuspenseApi", function() { return makeSuspenseApi; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var DEFAULT_CACHE_EXPIRATION = 30 * 60 * 1000; // 30 minutes.
var defaultOptions = {
    isApiMethod: function (f) { return typeof f === 'function'; },
    cacheExpiration: DEFAULT_CACHE_EXPIRATION
};
function makeSuspenseApi(api, options) {
    if (options === void 0) { options = defaultOptions; }
    options = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultOptions, options);
    var isApiMethod = options.isApiMethod, cacheExpiration = options.cacheExpiration;
    var rv = Object.create(api);
    var cache = {};
    // Walk the instance + prototype chain to generate suspense version of each promise returning method
    for (var proto = api; proto && proto !== Object.prototype; proto = Object.getPrototypeOf(proto)) {
        suspendify(proto);
    }
    function suspendify(proto) {
        Object.keys(proto).forEach(function (prop) {
            if (!rv.hasOwnProperty(prop) && isApiMethod(prop)) {
                rv[prop] = function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    var key = JSON.stringify(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([prop], args));
                    var cachedEntry = cache[key];
                    if (cachedEntry !== undefined) {
                        if (cachedEntry.promise)
                            throw cachedEntry.promise;
                        if (cachedEntry.error)
                            throw cachedEntry.error;
                        if (cachedEntry.timeout > Date.now()) {
                            return cachedEntry.value;
                        }
                    }
                    try {
                        var promise = proto[prop].apply(api, args).then(function (result) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, value: result };
                        }).catch(function (error) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                        });
                        cache[key] = { timeout: Date.now() + cacheExpiration, promise: promise };
                        throw promise;
                    }
                    catch (error) {
                        if (error.then)
                            throw error;
                        cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                    }
                };
            }
        });
    }
    return rv;
}


/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStarEndDate, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStarEndDate", function() { return getTermStarEndDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
//Not used anymore
// export function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {
//     return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
//     [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31
//     [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31
// }
function getTermStarEndDate(date, isFirstTerm) {
    var addYear = date.getMonth() >= 7;
    var termYear = null;
    if (addYear) {
        termYear = isFirstTerm ? date.getFullYear() : date.getFullYear() + 1;
    }
    else {
        termYear = isFirstTerm ? date.getFullYear() - 1 : date.getFullYear();
    }
    var termYearMoment = moment__WEBPACK_IMPORTED_MODULE_1___default()(termYear.toString(), "YYYY");
    if (termYearMoment.week() != 1) {
        termYearMoment = termYearMoment.clone().add(1, 'week');
    }
    return isFirstTerm ? [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(32).startOf('week'), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(51).endOf('week')] :
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(25).endOf('week')];
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6; // determine 
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");


function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        return this.term === 'AT' ? intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'HT {year}' }, { year: year }) :
            intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'VT {year}' }, { year: year });
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        var firstB = b[firstPart];
        if (firstA === firstB)
            return 0;
        if (firstA == null)
            return -1;
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ 0:
/*!*****************************************!*\
  !*** ../locale-data/index.js (ignored) ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 1:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnR3ZWIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvaGFzaC1yZXN0b3Jlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50LXdlYi9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaHR0cC1lcnJvci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3Jlc3RjbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vYXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1jb2xsZWN0aW9uL2RlbHRhLWNhY2hlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXJlcG8uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vbXV0YXRpb24tcXVldWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vcXVlcnktc2V0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtbW9kZWwtbWlncmF0b3IvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLWNvdXJzZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL2ZpYmVyLWNvbnRleHQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL21peGluLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9vYnNlcnZhYmxlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHN2fGVuIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9nZXQtdXNlci1jbGFpbXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2Vkc2NsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvZ29hbC1wcm9ncmVzcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvYWRtaW4vY291cnNlcy9jcmVhdGUtc3RhbmRhcmQtY291cnNlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9hZG1pbi9jb3Vyc2VzL2RlbGV0ZS1zdGFuZGFyZC1jb3Vyc2UudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyLWtzL2FkbWluL2NvdXJzZXMvZWRpdC1jb3Vyc2UtYmxvY2stcmVxdWlyZW1lbnRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9hZG1pbi9jb3Vyc2VzL2VkaXQtc3RhbmRhcmQtY291cnNlLWJsb2Nrcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvYWRtaW4vY291cnNlcy9lZGl0LXN0YW5kYXJkLWNvdXJzZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvYWRtaW4vaW5kZXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyLWtzL2FkbWluL3JvdXRlcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvY29tbW9uL2Jhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvY29tbW9uL3NpZGUtbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvY29tbW9uL3N0YW5kYXJkLWNvdXJzZS1pbnN0YW5jZS1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9jb21tb24vdHdvLWNvbHVtbnMtcGFnZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvY291cnNlLWluc3RhbmNlLXRhZ3MudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvZ2V0LWNvdXJzZS1jb2Rlcy1mcm9tLXRhZ3MudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvZ2V0LXN0YW5kYXJkLWNvdXJzZXMtd2l0aC1vcmRlcmVkLXJlcXVpcmVtZW50cy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9sb2dpYy9saXN0LWNvdXJzZS1pbnN0YW5jZXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvb3JkZXJlZC1yZXF1aXJlbWVudHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvcHVibGlzaC1jb3Vyc2UudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvY291cnNlcy9idXNpbmVzcy1sb2dpYy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2NvdXJzZS1iYW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL2tub3dsZWRnZS1tYXRyaXgtcGFydGlhbC11dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zY2hvb2xzL2VkaXQtc2Nob29sLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zY2hvb2xzL2VkaXRhYmxlLXNjaG9vbC1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zY2hvb2xzL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lbGxpcHNpcy1sb2FkZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL2tub3dsZWRnZS1tYXRyaXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zZWxlY3QtcmVsYXRlZC1kb2NzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9kaWZmL2RpZmYteG1sLXdpdGgtZGF0YWJhc2UudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvZGlmZi9taWdyYXRlLXN1YmplY3QudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvc2hvdy1zdWJqZWN0LWlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9zaG93LXN1YmplY3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL3Nrb2x2ZXJrZXQtc3ViamVjdC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9zdWJqZWN0cy1pbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvdXBsb2FkZWQtc3ViamVjdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvY2hlY2tsaXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0LWlucHV0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9sYXp5LWNvbnRlbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9saXZlLXF1ZXJ5LXZpZXcudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9sb2FkaW5nLWluZGljYXRvci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL211bHRpc2VsZWN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9lbGVtZW50cy9LRURBcHBTdWJqZWN0UGxhbm5lckFkbWluL2FwcC5zcGFkbWluLmNsaWVudC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2VsZW1lbnRzL0tFREFwcFN1YmplY3RQbGFubmVyQWRtaW4vd2VicGFjay1lbnRyeS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvY29uZmlndXJlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtYWxsLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtYmVhcmVyLXByb3ZpZGVycy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWVkcy1jbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1rZWQtYmFja2VuZC1jbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELmNmZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuZW52LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9kYi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9rZWQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9tYWtlLXN1c3BlbnNlLWFwaS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcXVlcnktc3RyaW5nLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9zY2hvb2wtbW9tZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9zY2hvb2wtdGVybS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2xvY2FsZS1kYXRhL2luZGV4LmpzIChpZ25vcmVkKSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9saWIvbG9jYWxlcyAoaWdub3JlZCkiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vbGliL2xvY2FsZXMgKGlnbm9yZWQpPzI5MmEiLCJ3ZWJwYWNrOi8vW25hbWVdL2V4dGVybmFsIFwialF1ZXJ5XCIiLCJ3ZWJwYWNrOi8vW25hbWVdL2V4dGVybmFsIFwiUmVhY3RcIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0JBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQWlCLDRCQUE0QjtBQUM3QztBQUNBO0FBQ0EsMEJBQWtCLDJCQUEyQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0RBQTBDLGdDQUFnQztBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdFQUF3RCxrQkFBa0I7QUFDMUU7QUFDQSx5REFBaUQsY0FBYztBQUMvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQXlDLGlDQUFpQztBQUMxRSx3SEFBZ0gsbUJBQW1CLEVBQUU7QUFDckk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtB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QUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JCLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUc7WUFBRSxPQUFPLEtBQUssQ0FBQztRQUNuQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDO1lBQUUsT0FBTyxLQUFLLENBQUM7S0FDdkM7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDOzs7Ozs7Ozs7Ozs7QUN0S0QsZTs7Ozs7Ozs7Ozs7QUNBQSxlOzs7Ozs7Ozs7OztBQ0FBLGU7Ozs7Ozs7Ozs7O0FDQUEsd0I7Ozs7Ozs7Ozs7O0FDQUEsdUIiLCJmaWxlIjoia2VkYXBwc3BhZG1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuIFx0XHR2YXIgZXhlY3V0ZU1vZHVsZXMgPSBkYXRhWzJdO1xuXG4gXHRcdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuIFx0XHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcbiBcdFx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMCwgcmVzb2x2ZXMgPSBbXTtcbiBcdFx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG4gXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG4gXHRcdFx0XHRyZXNvbHZlcy5wdXNoKGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSk7XG4gXHRcdFx0fVxuIFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG4gXHRcdH1cbiBcdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcbiBcdFx0XHRcdG1vZHVsZXNbbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRpZihwYXJlbnRKc29ucEZ1bmN0aW9uKSBwYXJlbnRKc29ucEZ1bmN0aW9uKGRhdGEpO1xuXG4gXHRcdHdoaWxlKHJlc29sdmVzLmxlbmd0aCkge1xuIFx0XHRcdHJlc29sdmVzLnNoaWZ0KCkoKTtcbiBcdFx0fVxuXG4gXHRcdC8vIGFkZCBlbnRyeSBtb2R1bGVzIGZyb20gbG9hZGVkIGNodW5rIHRvIGRlZmVycmVkIGxpc3RcbiBcdFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyB8fCBbXSk7XG5cbiBcdFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG4gXHRcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIFx0fTtcbiBcdGZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCkge1xuIFx0XHR2YXIgcmVzdWx0O1xuIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWRNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0dmFyIGRlZmVycmVkTW9kdWxlID0gZGVmZXJyZWRNb2R1bGVzW2ldO1xuIFx0XHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuIFx0XHRcdGZvcih2YXIgaiA9IDE7IGogPCBkZWZlcnJlZE1vZHVsZS5sZW5ndGg7IGorKykge1xuIFx0XHRcdFx0dmFyIGRlcElkID0gZGVmZXJyZWRNb2R1bGVbal07XG4gXHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbZGVwSWRdICE9PSAwKSBmdWxmaWxsZWQgPSBmYWxzZTtcbiBcdFx0XHR9XG4gXHRcdFx0aWYoZnVsZmlsbGVkKSB7XG4gXHRcdFx0XHRkZWZlcnJlZE1vZHVsZXMuc3BsaWNlKGktLSwgMSk7XG4gXHRcdFx0XHRyZXN1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IGRlZmVycmVkTW9kdWxlWzBdKTtcbiBcdFx0XHR9XG4gXHRcdH1cblxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJrZWRhcHBzcGFkbWluXCI6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goW1wiLi9zcmMvZWxlbWVudHMvS0VEQXBwU3ViamVjdFBsYW5uZXJBZG1pbi93ZWJwYWNrLWVudHJ5LnRzXCIsXCJ2ZW5kb3JzXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudCc7IiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWInOyIsInZhciBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCkge1xuICAgIH1cbiAgICBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoaWQsIHRva2VuSW5mbykge1xuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQsIEpTT04uc3RyaW5naWZ5KHRva2VuSW5mbykpO1xuICAgIH07XG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIganNvbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJiZWFyZXItXCIgKyBpZCk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlLmpzLm1hcCIsInZhciByZWRpckhhc2ggPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwicmVkaXItaGFzaFwiKTtcbmlmIChyZWRpckhhc2gpXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIF9hID0gSlNPTi5wYXJzZShyZWRpckhhc2gpLCB0aW1lID0gX2EudGltZSwgaGFzaCA9IF9hLmhhc2g7XG4gICAgICAgIGlmICh0aW1lICYmIHRpbWUgPiBEYXRlLm5vdygpIC0gNjAwMDApIHtcbiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oXCJyZWRpci1oYXNoXCIpO1xuICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKF8pIHsgfVxuZXhwb3J0IGZ1bmN0aW9uIHJlbWVtYmVySGFzaExvY2F0aW9uKCkge1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJyZWRpci1oYXNoXCIsIEpTT04uc3RyaW5naWZ5KHsgdGltZTogRGF0ZS5ub3coKSwgaGFzaDogbG9jYXRpb24uaGFzaCB9KSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXNoLXJlc3RvcmVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBIdHRwRXJyb3IgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xuaW1wb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH0gZnJvbSBcIi4vYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2VcIjtcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscyc7XG5pbXBvcnQgeyBLZWRNb2RlbE1pZ3JhdG9yTWl4aW4gfSBmcm9tICcuLi9rZWQtbW9kZWwtbWlncmF0b3InO1xuaW1wb3J0ICcuL2hhc2gtcmVzdG9yZXInO1xuaW1wb3J0IHsgcmVtZW1iZXJIYXNoTG9jYXRpb24gfSBmcm9tICcuL2hhc2gtcmVzdG9yZXInO1xuS2VkTW9kZWxNaWdyYXRvck1peGluKEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlKTtcbmV4cG9ydCB2YXIgc3RvcmFnZSA9IG5ldyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKTtcbnZhciB0aW1lT2ZQYWdlTG9hZCA9IERhdGUubm93KCk7XG52YXIgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIodG9rZW5QYXRoLCB0b2tlblJlc3BvbnNlTWFwcGVyLCB0b2tlbklkKSB7XG4gICAgICAgIHRoaXMudG9rZW5QYXRoID0gdG9rZW5QYXRoO1xuICAgICAgICB0aGlzLnRva2VuUmVzcG9uc2VNYXBwZXIgPSB0b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnRva2VuSW5mby50b2tlbikgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudG9rZW5JZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBzdG9yYWdlLmxvYWQodGhpcy50b2tlbklkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy50b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLnJlZnJlc2hCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2godGhpcy50b2tlblBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IEFjY2VwdDogXCJ0ZXh0L3BsYWluOyBhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6IFwic2FtZS1vcmlnaW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMzAyIHx8ICghcmVzLnN0YXR1cyAmJiByZXMudHlwZSA9PT0gXCJvcGFxdWVyZWRpcmVjdFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgc2Vzc2lvbiB0aW1lZCBvdXQgYW5kIHNlcnZlciB3YW50cyB0byByZWRpcmVjdCBlbnRpcmUgcGFnZSB0byBsb2dpbiBwYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGltZSB0byByZWxvYWQgY3VycmVudCBwYWdlIHRvIGZvcmNlIGEgcmVkaXJlY3Qgb2YgdGhlIGVudGlyZSBwYWdlIGluc3RlYWQgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZWRpcmVjdGluZyB0byAvYXBpL3Rva2VuIG9yIHdoYXRldmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGltZU9mUGFnZUxvYWQgPiA2MDAwMCkgeyAvLyBwcm9oaWJpdCBlbmRsZXNzIGxvb3Agb2YgcmVsb2FkaW5nIHNlbGYuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2FudHNSZWRpcmVjdCA9IHRydWU7IC8vIFNvIHRoYXQgbGlzdGVuZXJzIHRvIG9uYmVmb3JldW5sb2FkIGNvdWxkIHNob3cgYWx0ZXJuYXRlIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVkaXJlY3Qgd2FudGVkLiBSZWxvYWQgcGFnZS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWVtYmVySGFzaExvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoMzAyLCBcIlJlZGlyZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gXCJIVFRQXCIgKyByZXMuc3RhdHVzICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEVycm9yLCBbdm9pZCAwLCBfYiArIChfZS5zZW50KCkpXSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IF9kLmFwcGx5KHRoaXMsIFtfZS5zZW50KCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2Uuc2F2ZSh0aGlzLnRva2VuSWQsIHRoaXMudG9rZW5JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyIH07XG5leHBvcnQgdmFyIGlzb21vcnBoaWMgPSB7IGZldGNoOiBmZXRjaC5iaW5kKHNlbGYpLCBidG9hOiBidG9hLmJpbmQoc2VsZikgfTtcbnZhciBLZWRCYWNrZW5kQ2xpZW50V2ViID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDbGllbnRXZWIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENsaWVudFdlYihhcGlCYXNlVXJsLCBwcm92aWRlck9yVG9rZW5QYXRoLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBiZWFyZXJQcm92aWRlciA9IHR5cGVvZiBwcm92aWRlck9yVG9rZW5QYXRoICE9PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICBwcm92aWRlck9yVG9rZW5QYXRoIDpcbiAgICAgICAgICAgIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihwcm92aWRlck9yVG9rZW5QYXRoLCAob3B0aW9ucyAmJiBvcHRpb25zLnRva2VuUmVzcG9uc2VNYXBwZXIpIHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4gKHsgdG9rZW46IHgsIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogNjAgfSk7IH0pLCBvcHRpb25zICYmIG9wdGlvbnMudG9rZW5JZCk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGFwaUJhc2VVcmwpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnRXZWI7XG59KEtlZEJhY2tlbmRDbGllbnQpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsInZhciBEb2N1bWVudEFjY2VzcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEb2N1bWVudEFjY2VzcyhhY2Nlc3NDbGFpbVR5cGUsIGFjY2Vzc0NsYWltVmFsdWUsIHJpZ2h0KSB7XG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1UeXBlID0gYWNjZXNzQ2xhaW1UeXBlO1xuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVmFsdWUgPSBhY2Nlc3NDbGFpbVZhbHVlO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gICAgfVxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAoYWMpIHtcbiAgICAgICAgaWYgKCFhYylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgc3BsaXQgPSBhYy5zcGxpdCgnOicpO1xuICAgICAgICBpZiAoc3BsaXQubGVuZ3RoIDwgMylcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XG4gICAgICAgIHZhciBjbGFpbVR5cGUgPSBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZShzcGxpdFswXSk7XG4gICAgICAgIHZhciBjbGFpbVZhbHVlID0gRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUoc3BsaXRbMV0pO1xuICAgICAgICB2YXIgcmlnaHQgPSBzcGxpdFsyXTtcbiAgICAgICAgaWYgKHJpZ2h0ICE9PSAnUicgJiYgcmlnaHQgIT09ICdXJyAmJiByaWdodCAhPT0gJ1MnKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhY2Nlc3Mgc3RyaW5nOiBcIiArIGFjKTtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEFjY2VzcyhjbGFpbVR5cGUsIGNsYWltVmFsdWUsIHJpZ2h0KTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLmVzY2FwZSA9IGZ1bmN0aW9uIChhY2Nlc3NDb21wb25lbnQpIHtcbiAgICAgICAgcmV0dXJuIGFjY2Vzc0NvbXBvbmVudC5yZXBsYWNlKC9cXCUvZywgXCIlMjVcIikucmVwbGFjZSgvXFw6L2csIFwiJTNBXCIpO1xuICAgIH07XG4gICAgRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlM0EvZywgXCI6XCIpLnJlcGxhY2UoL1xcJTI1L2csIFwiJVwiKTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVHlwZSkgKyBcIjpcIiArXG4gICAgICAgICAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVZhbHVlKSArIFwiOlwiICtcbiAgICAgICAgICAgIHRoaXMucmlnaHQ7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAoYWNsKSB7XG4gICAgICAgIHJldHVybiBhY2xcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nKGFjKTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBhYzsgfSk7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy50b1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xuICAgICAgICByZXR1cm4gYWNsLm1hcChmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjLnRvU3RyaW5nKCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIERvY3VtZW50QWNjZXNzO1xufSgpKTtcbmV4cG9ydCB7IERvY3VtZW50QWNjZXNzIH07XG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKGFjbCwgdXNlckNsYWltcywgcmVxdWVzdGVkUmlnaHQpIHtcbiAgICBpZiAodXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjbGFpbSkgeyByZXR1cm4gY2xhaW0udHlwZSA9PT0gJ3JvbGUnICYmIGNsYWltLnZhbHVlID09PSBcIkFETUlOXCI7IH0pKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gYWNsLnNvbWUoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJDbGFpbXMuc29tZShmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuIGEuYWNjZXNzQ2xhaW1UeXBlID09PSBjLnR5cGUgJiZcbiAgICAgICAgICAgICAgICBhLmFjY2Vzc0NsYWltVmFsdWUgPT09IGMudmFsdWUgJiYgKChhLnJpZ2h0ID09PSAnUicgJiYgcmVxdWVzdGVkUmlnaHQgPT09ICdSJykgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1cnICYmIFsnUicsICdXJ10uaW5kZXhPZihyZXF1ZXN0ZWRSaWdodCkgPj0gMCkgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1MnKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjZXNzLWNvbnRyb2wuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbnZhciBIdHRwRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSHR0cEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEh0dHBFcnJvcihjb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICBfdGhpcy5uYW1lID0gXCJodHRwXCIgKyBjb2RlO1xuICAgICAgICBfdGhpcy5tZXNzYWdlID0gXCJIVFRQXCIgKyBjb2RlICsgXCIgXCIgKyBtZXNzYWdlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBIdHRwRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAtZXJyb3IuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7XG5leHBvcnQgeyBLZWRCZWFyZXJQcm92aWRlciB9IGZyb20gJy4va2VkLWJlYXJlci1wcm92aWRlcic7XG5leHBvcnQgKiBmcm9tICcuL2FjY2Vzcy1jb250cm9sJztcbmV4cG9ydCB7IFJlc3RDbGllbnQgfTtcbmltcG9ydCB7IEh0dHBFcnJvciB9IGZyb20gJy4vaHR0cC1lcnJvcic7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbmV4cG9ydCAqIGZyb20gJy4vcmVzdGNsaWVudCc7XG47XG4vLyB8ICdvdGhlckZsYWcnIHwgJ3RoaXJkRmxhZyc7Li4uXG52YXIgS2VkQmFja2VuZENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ2xpZW50KGlzb21vcnBoaWMsIGJlYXJlclByb3ZpZGVyLCBiYXNlVXJsKSB7XG4gICAgICAgIHRoaXMuaHR0cCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIHsgYmVhcmVyUHJvdmlkZXI6IGJlYXJlclByb3ZpZGVyIH0pO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5nZXRNeUNsYWltcyA9IGZ1bmN0aW9uICh0YWJsZSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQoXCJtZS9jbGFpbXMvXCIgKyAodGFibGUgfHwgXCJcIiksIG51bGwsIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQodGFibGUgKyBcIi9cIiArIGlkLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpc3QgPSBmdW5jdGlvbiAodGFibGUsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSwgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkubXV0YXRpb25zT25FbXB0eSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubXV0YXRpb25zT25FbXB0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwiXCIgKyB0YWJsZSwgcXVlcnksIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYmF0Y2ggPSBmdW5jdGlvbiAocmVxcywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW9yZGVyIG9wZXJhdGlvbnMgc28gdGhhdCAnYWRkJ3MgY29tZSBmaXJzdCBhbmQgJ2RlbGV0ZSdzIGNvbWUgbGFzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXMgPSByZXFzLnNsaWNlKCkuc29ydChmdW5jdGlvbiAocmVxMSwgcmVxMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXExLm9wID09PSAnYWRkJyA/IC0xIDogcmVxMi5vcCA9PT0gJ2FkZCcgPyAxIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxMS5vcCA9PT0gJ2RlbGV0ZScgPyAxIDogcmVxMi5vcCA9PT0gJ2RlbGV0ZScgPyAtMSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5wb3N0KFwiYmF0Y2hcIiwgcmVxcywgZmV0Y2hPcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kbyA9IGZ1bmN0aW9uIChzY29wZUZuKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJ1bm5lcjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmVyID0gbmV3IEJhdGNoUnVubmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUZuKHJ1bm5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJhdGNoKHJ1bm5lci5tdXRhdGlvblJlcXVlc3RzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlUmVhbG0gPSBmdW5jdGlvbiAocmVhbG0pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmRlbGV0ZShcInJlYWxtcy9cIiArIHJlYWxtKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuYWRkKHRhYmxlLCBkb2MpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnB1dCh0YWJsZSwgZG9jKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudXBkYXRlKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubWVyZ2UoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5jbGVhckJyYW5jaChicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5kZWxldGUodGFibGUsIGlkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bnNoYXJlKHRhYmxlLCBpZCwgYWNsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVuZG9MaW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnQ7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZENsaWVudCB9O1xudmFyIEJhdGNoUnVubmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJhdGNoUnVubmVyKCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMgPSBbXTtcbiAgICB9XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jLCBicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnYWRkJywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xuICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICBkZWxldGUgZG9jLmFjbDsgLy8gRm9yYmlkZGVuIHRvIHNlbmQgYWNsIHdpdGggcHV0KCkgY2FsbHMuXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdwdXQnLCB0YWJsZTogdGFibGUsIGRvYzogZG9jIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgZGVsdGFEb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YURvYyk7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1cGRhdGUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgZGVsdGFEb2M6IGRlbHRhRG9jLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdtZXJnZScsIGJyYW5jaElkOiBicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQ6IHRhcmdldEJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdzaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5zaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2xpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0VGFibGU6IHRhcmdldFRhYmxlLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmRvLWxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIHJldHVybiBCYXRjaFJ1bm5lcjtcbn0oKSk7XG5leHBvcnQgeyBCYXRjaFJ1bm5lciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xuaW1wb3J0IHsgYXZvaWRTaW11bHRhbm91c0NhbGxzIH0gZnJvbSAnLi91dGlscyc7XG52YXIgS2VkQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2VkQmVhcmVyUHJvdmlkZXIoaXNvbW9ycGhpYywgc3RvcmFnZSwgdG9rZW5JZCwgY2xpZW50SWQsIGNsaWVudFNlY3JldCwgdG9rZW5VcmwsIHRva2VuUXVlcnkpIHtcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICAgICAgdGhpcy50b2tlbklkID0gdG9rZW5JZDtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xuICAgICAgICB0aGlzLmNsaWVudFNlY3JldCA9IGNsaWVudFNlY3JldDtcbiAgICAgICAgdGhpcy50b2tlblVybCA9IHRva2VuVXJsO1xuICAgICAgICB0aGlzLnRva2VuUXVlcnkgPSB0b2tlblF1ZXJ5O1xuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcbiAgICAgICAgdGhpcy5jbGllbnQgPSBuZXcgUmVzdENsaWVudChpc29tb3JwaGljLCBcIlwiLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLmNsaWVudFNlY3JldFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hLCB0b2tlbiwgZXhwaXJlcywgX2IsIGVfMTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLnRva2VuSW5mbywgdG9rZW4gPSBfYS50b2tlbiwgZXhwaXJlcyA9IF9hLmV4cGlyZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4gJiYgZXhwaXJlcyA+PSBEYXRlLm5vdygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMSwgNCwgLCA2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN0b3JhZ2UubG9hZCh0aGlzLmNsaWVudElkICsgXCIvXCIgKyB0aGlzLnRva2VuSWQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudG9rZW5JbmZvID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudG9rZW5JbmZvLnRva2VuICYmIHRoaXMudG9rZW5JbmZvLmV4cGlyZXMgPj0gRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIHJldHJpZXMsIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJldHJpZXMgPCA2KSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHJpZXZpbmcgdG9rZW4gZm9yIFwiICsgdGhpcy50b2tlbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50LmdldCh0aGlzLnRva2VuVXJsLCB0aGlzLnRva2VuUXVlcnksIHsgY2FjaGU6ICdyZWxvYWQnIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkdvdCBcIiArIHJlcy5zdGF0dXMgKyBcIiBcIiArIHJlcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudG9rZW5JbmZvID0gKF9iLnRva2VuID0gX2Muc2VudCgpLCBfYi5leHBpcmVzID0gRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwLCBfYik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCB0b2tlbiBmb3IgXCIgKyB0aGlzLnRva2VuSWQgKyBcIjogXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuSW5mbykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNhdmUodGhpcy5jbGllbnRJZCArIFwiL1wiICsgdGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICArK3JldHJpZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgdG9rZW4gZm9yIFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50b2tlbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJlYXJlclByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IEtlZEJlYXJlclByb3ZpZGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWQtYmVhcmVyLXByb3ZpZGVyLmpzLm1hcCIsIi8qXG5kZWNsYXJlIHZhciBCdWZmZXI7IC8vIG5vZGUgYnVpbHQtaW5cblxuXG5mdW5jdGlvbiBiYXNpY0F1dGhIZWFkZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIFwiQmFzaWMgXCIgKyBuZXcgQnVmZmVyKHVzZXJuYW1lICsgXCI6XCIgKyBwYXNzd29yZCkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG59XG4qL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJy4uL29ic2VydmFibGUvZW1pdHRlcic7XG52YXIgUmVzdENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnMgPSAwO1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSBuZXcgRW1pdHRlcih0aGlzKTtcbiAgICAgICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7IG1vZGU6ICdjb3JzJyB9O1xuICAgICAgICB0aGlzLmF1dGhIZWFkZXIgPSBvcHRpb25zLmJlYXJlciA/XG4gICAgICAgICAgICBcIkJlYXJlciBcIiArIG9wdGlvbnMuYmVhcmVyIDpcbiAgICAgICAgICAgIG9wdGlvbnMudXNlcm5hbWUgP1xuICAgICAgICAgICAgICAgIFwiQmFzaWMgXCIgKyBpc29tb3JwaGljLmJ0b2Eob3B0aW9ucy51c2VybmFtZSArIFwiOlwiICsgKG9wdGlvbnMucGFzc3dvcmQgfHwgXCJcIikpIDpcbiAgICAgICAgICAgICAgICBudWxsO1xuICAgICAgICB0aGlzLmJlYXJlclByb3ZpZGVyID0gb3B0aW9ucy5iZWFyZXJQcm92aWRlciB8fCBudWxsO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdENsaWVudC5wcm90b3R5cGUsIFwic3RhdHVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uIChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgKyt0aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcbiAgICAgICAgdGhpcy5fc3RhdHVzLmRpc3BhdGNoKHRoaXMpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZmV0Y2gocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgLS1fdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzLmRpc3BhdGNoKF90aGlzKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIC0tX3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xuICAgICAgICAgICAgX3RoaXMuX3N0YXR1cy5kaXNwYXRjaChfdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5fZmV0Y2ggPSBmdW5jdGlvbiAocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyLCBfYSwgYXV0aEhlYWRlciwgdG9rZW5JbmZvLCBiZWFyZXJQcm92aWRlciwgX2IsIF9jLCB1cmwsIHJlcywgd3d3YXV0aCwgX2Q7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZXRjaE9wdGlvbnMgJiYgZmV0Y2hPcHRpb25zLmNhY2hlID09PSAnbm8tY2FjaGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgYmFjay1idXR0b24gbm90IHJlc3BlY3RpbmcgY2FjaGUgY29udHJvbCBpbiBDaHJvbWUvT3BlcmEuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kIGEgcXVlcnkgcGFyYW1ldGVyIHRvIGZvcmNlIGEgY2FjaGUgZW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHRzbGliXzEuX19hc3NpZ24oe30sIHF1ZXJ5LCB7IG5vY2FjaGU6IGNyZWF0ZVVVSUQoKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyID0gcXVlcnkgJiYgT2JqZWN0LmtleXMocXVlcnkpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBxdWVyeVtrZXldICE9PSB1bmRlZmluZWQ7IH0pLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrZXkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQocXVlcnlba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCcmJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMsIGF1dGhIZWFkZXIgPSBfYS5hdXRoSGVhZGVyLCB0b2tlbkluZm8gPSBfYS50b2tlbkluZm8sIGJlYXJlclByb3ZpZGVyID0gX2EuYmVhcmVyUHJvdmlkZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghYXV0aEhlYWRlciAmJiAhdG9rZW5JbmZvICYmIGJlYXJlclByb3ZpZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBiZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRva2VuSW5mbyA9IHRva2VuSW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b2tlbkluZm8pIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodG9rZW5JbmZvLmV4cGlyZXMgPCBEYXRlLm5vdygpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRva2VuIGV4cGlyZWQuIFJlZnJlc2ggaXQ6XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYmVhcmVyUHJvdmlkZXIucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudG9rZW5JbmZvID0gdG9rZW5JbmZvID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoSGVhZGVyID0gXCJCZWFyZXIgXCIgKyB0b2tlbkluZm8udG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIG9uZSB3YXkgb3IgYW5vdGhlciwgd2UndmUgY29uY2x1ZGVkIGFuIEF1dGhvcml6YXRpb24gaGVhZGVyIHRvIHVzZTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRoSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gYXV0aEhlYWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuYmFzZVVybCArIHBhdGggKyAocXVlcnlTdHIgPyBcIj9cIiArIHF1ZXJ5U3RyIDogXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPT0gNDAxICYmIHRoaXMuYmVhcmVyUHJvdmlkZXIpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHd3d2F1dGggPSByZXMuaGVhZGVycy5nZXQoXCJ3d3ctYXV0aGVudGljYXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgXCIgKyByZXMuc3RhdHVzICsgXCIgZnJvbSBcIiArICh0aGlzLmJhc2VVcmwgKyBwYXRoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh3d3dhdXRoICYmIC9CZWFyZXIvaS50ZXN0KHd3d2F1dGgpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJlYXJlclByb3ZpZGVyLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kLnRva2VuSW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IFwiQmVhcmVyIFwiICsgdGhpcy50b2tlbkluZm8udG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocGF0aCwgcXVlcnksIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIkdFVFwiLCB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uOyB0ZXh0L3BsYWluXCIgfSwgcXVlcnksIGZldGNoT3B0aW9ucyk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5wb3N0ID0gZnVuY3Rpb24gKHBhdGgsIGRhdGEsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIlBPU1RcIiwge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICB9LCBudWxsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSkgfSkpO1xuICAgIH07XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHBhdGgsIHF1ZXJ5LCBib2R5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJERUxFVEVcIiwgeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvbjsgdGV4dC9wbGFpblwiIH0sIHF1ZXJ5LCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogYm9keSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gUmVzdENsaWVudDtcbn0oKSk7XG5leHBvcnQgeyBSZXN0Q2xpZW50IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXN0Y2xpZW50LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVVVJRCgpIHtcbiAgICAvLyBEZWNlbnQgc29sdXRpb24gZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHRcbiAgICB2YXIgZCA9IERhdGUubm93KCk7XG4gICAgdmFyIHV1aWQgPSAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwO1xuICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xuICAgICAgICByZXR1cm4gKGMgPT09ICd4JyA/IHIgOiAociAmIDB4NyB8IDB4OCkpLnRvU3RyaW5nKDE2KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdXVpZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHMobWV0aG9kKSB7XG4gICAgdmFyIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW9uZ29pbmdQcm9taXNlKSB7XG4gICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0R2xvYmFsSWQocmVhbG0pIHtcbiAgICB2YXIgcHJlZml4ID0gJ2VjOTZiM2JlLTQ1ZmMtNDFkMy1iNjllLSc7XG4gICAgdmFyIHBhZCA9IFsnNTAnLCAnMDgnLCAnZTEnLCAnNDAnLCAnZTQnLCAnZTcnXTtcbiAgICBpZiAocmVhbG0ubGVuZ3RoID4gNilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9vIGxvbmcgcmVhbG1cIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZWFsbS5sZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgaGV4ID0gcmVhbG0uY2hhckNvZGVBdChpKS50b1N0cmluZygxNik7XG4gICAgICAgIHBhZFtpXSA9IGhleC5sZW5ndGggPT09IDIgP1xuICAgICAgICAgICAgaGV4IDpcbiAgICAgICAgICAgICcwJyArIGhleDtcbiAgICB9XG4gICAgcmV0dXJuIHByZWZpeCArIHBhZC5qb2luKCcnKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlUHJlZGVzdGluYXRlZElkKGlucHV0KSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbmNvZGVyLCBkYXRhLCBkaWdlc3QsIF9hLCBpO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVuY29kZXIuZW5jb2RlKGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBVaW50OEFycmF5LmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgZGlnZXN0ID0gbmV3IChfYS5hcHBseShVaW50OEFycmF5LCBbdm9pZCAwLCBfYi5zZW50KCldKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5pYmJsZSA9IGRpZ2VzdFtpKytdICUgMTYgfCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3YXNoZWROaWJibGUgPSBjID09PSAneCcgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgJiAweDcgfCAweDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdhc2hlZE5pYmJsZS50b1N0cmluZygxNik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLypleHBvcnQgZnVuY3Rpb24gYnVmMmhleChidWZmZXI6IEFycmF5QnVmZmVyKSB7XG4gIHJldHVybiBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoXG4gICAgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSxcbiAgICAoeDogbnVtYmVyKSA9PiAoJzAwJyArIHgudG9TdHJpbmcoMTYpKS5zbGljZSgtMikpLmpvaW4oJycpO1xufSovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQXJyYXkoYSwgbWFwcGVyKSB7XG4gICAgdmFyIHJldHZhbCA9IGE7XG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgICB2YXIgdCA9IGFbaV07XG4gICAgICAgIHZhciBtYXBwZWQgPSBtYXBwZXIodCk7XG4gICAgICAgIGlmIChtYXBwZWQgIT09IHQpIHtcbiAgICAgICAgICAgIGlmIChyZXR2YWwgPT09IGEpXG4gICAgICAgICAgICAgICAgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgICAgICAgcmV0dmFsW2ldID0gbWFwcGVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR2YWw7XG59XG4vKlxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5PFQ+KGE6IFRbXSwgbWFwcGVyOiAodDogVCkgPT4gVCB8IGZhbHNlKTogVFtdIHtcbiAgbGV0IHJldHZhbCA9IGE7XG4gIGxldCBqID0gMDtcbiAgZm9yIChsZXQgaT0wLGw9YS5sZW5ndGg7IGk8bDsgKytpLCArK2opIHtcbiAgICBjb25zdCB0ID0gYVtpXTtcbiAgICBjb25zdCBtYXBwZWQgPSBtYXBwZXIodCk7XG4gICAgaWYgKG1hcHBlZCA9PT0gZmFsc2UpIHtcbiAgICAgIC8vIE1hcHBlciB3YW50cyB0byBkZWxldGUgdGhpcyBkb2MuXG4gICAgICBpZiAocmV0dmFsID09PSBhKSByZXR2YWwgPSBhLnNsaWNlKCk7XG4gICAgICByZXR2YWwuc3BsaWNlKGosIDEpO1xuICAgICAgLS1qOyAvLyBjb21wZW5zYXRlIGZvciArK2pcbiAgICB9IGVsc2UgaWYgKG1hcHBlZCAhPT0gdCkge1xuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgcmV0dmFsW2pdID0gbWFwcGVkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0dmFsO1xufVxuKi8gXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiLCJpbXBvcnQgKiBhcyBKc29uU2NoZW1hIGZyb20gXCJrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvblwiO1xuaW1wb3J0IHsgZ2V0VGFibGVGcm9tTGFiZWwgfSBmcm9tIFwiLi91dGlsc1wiO1xudmFyIENhY2hlQnVzdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYWNoZUJ1c3QoKSB7XG4gICAgfVxuICAgIENhY2hlQnVzdC5nZXRDYWNoZUJ1c3QgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCB1c2VyLCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgaW52b2x2ZWRJdGVtcyA9IENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpO1xuICAgICAgICByZXR1cm4gaW52b2x2ZWRJdGVtc1xuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjYWNoZS1idXN0LVwiICsgdXNlciArIFwiLVwiICsgaXRlbSk7IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gISF2YWx1ZTsgfSlcbiAgICAgICAgICAgIC5qb2luKCcvJykgfHwgJ3N0YXRpYyc7XG4gICAgfTtcbiAgICBDYWNoZUJ1c3QuaW52YWxpZGF0ZUNhY2hlID0gZnVuY3Rpb24gKHJlcXMsIHVzZXIpIHtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMocmVxcyk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IF9hW19pXTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0sICcnICsgRGF0ZS5ub3coKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgdmFyIGhhc0VkZ2VzRnJvbSA9IHF1ZXJ5Lmhhc0VkZ2VzRnJvbTtcbiAgICAgICAgdmFyIHJlbGF0ZWRUYWJsZXMgPSBpbmNsdWRlc1xuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiAhIXRhYmxlOyB9KTtcbiAgICAgICAgaWYgKGhhc0VkZ2VzRnJvbSlcbiAgICAgICAgICAgIHJlbGF0ZWRUYWJsZXMucHVzaChcImhlZlwiICsgdGFibGUpO1xuICAgICAgICByZXR1cm4gW3RhYmxlLCAnbWFzdGVyJywgcXVlcnkuYnJhbmNoSWRdLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4gISF4OyB9KS5jb25jYXQocmVsYXRlZFRhYmxlcykuc29ydCgpO1xuICAgIH07XG4gICAgQ2FjaGVCdXN0LmdldENhY2hlSW52YWxpZGF0aW9ucyA9IGZ1bmN0aW9uIChyZXFzKSB7XG4gICAgICAgIHZhciBpbnZhbGlkYXRpb25TZXQgPSB7fTtcbiAgICAgICAgcmVxcy5mb3JFYWNoKGZ1bmN0aW9uIChyZXEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocmVxLm9wKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBjYXNlICdwdXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YWJsZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsaW5rJzpcbiAgICAgICAgICAgICAgICBjYXNlICd1bmxpbmsnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuc291cmNlVGFibGVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W1wiaGVmLVwiICsgZ2V0VGFibGVGcm9tTGFiZWwocmVxLnNvdXJjZVRhYmxlLCByZXEubGFiZWwpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbWVyZ2UnOlxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLmJyYW5jaElkXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFyZ2V0QnJhbmNoSWQgfHwgXCJtYXN0ZXJcIl0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhpbnZhbGlkYXRpb25TZXQpO1xuICAgIH07XG4gICAgcmV0dXJuIENhY2hlQnVzdDtcbn0oKSk7XG5leHBvcnQgeyBDYWNoZUJ1c3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNhY2hlLWJ1c3QuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IG1lcmdlRGVsdGFzIH0gZnJvbSAnLi4vZGVsdGEtbWVyZ2UnO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5TXV0YXRpb25zT25EZWx0YXMoYnJhbmNoSWQsIGRlbHRhcywgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB1c2VyRGlzcGxheU5hbWUsIGhhc0FkZGl0aW9uYWxGaWx0ZXIpIHtcbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChtKSB7XG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gQWRkUmVsYXRlZCBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmICghaGFzQWRkaXRpb25hbEZpbHRlciAmJiBtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhZGQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLnJlbGF0ZWREb2MuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG0uZ3JhcGhQcm9wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnJlbGF0ZWREb2MubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcjogdXNlckRpc3BsYXlOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjbGVhci1icmFuY2gnOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXJCcmFuY2ggUmVwb011dGF0aW9uXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgdHlwZSBvZiBtdXRhdGlvbiBjYW4gbm90IGJlIHBlcmZvcm1lZCBvbnRvIGJyYW5jaGVzLiBUaGVyZSdzIG5vIGJyYW5jaElkIHByb3BlcnR5IG9uIG0uXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBNZXJnZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobS50YXJnZXRCcmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBjaGFuZ2Ugd2lsbCBhcHBlbmQgbmV3IGRlbHRhcyB0byBvdXIgZGVsdGFzIGFycmF5IGJ1dCB3ZSBkb24ndCBrbm93IHdoYXQgd291bGQgY29tZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byByZWZldGNoIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbnVsbCB9OyAvLyBDYWxsZXIgc2hvdWxkIGNoZWNrIGZvciBudWxsIGFuZCByZS1mZXRjaCBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZS1SZWxhdGVkIFJlcG9NdXRhdGlvblxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgaWYgKGhhc0FkZGl0aW9uYWxGaWx0ZXIgfHwgbS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZW1vdmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlSWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5yZWxhdGVkRG9jLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS5yZWxhdGVkRG9jLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbS5ncmFwaFByb3AsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUYWJsZTogbS50YWJsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yOiB1c2VyRGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJ1xuICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBVbmRvLUxpbmsgUmVwb011dGF0aW9uXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gZGVsdGFzLmZpbmRJbmRleChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChkLnR5cGUgPT09ICdhZGQnIHx8IGQudHlwZSA9PT0gJ3JlbW92ZScgfHwgZC50eXBlID09PSAndW5kby1saW5rJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnNvdXJjZUlkID09PSBtLmlkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC50YXJnZXRJZCA9PT0gbS5yZWxhdGVkSWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIFwiYWRkXCIgb3IgXCJyZW1vdmVcIiBkZWx0YSB0byBjaGFuZ2U6XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFSZWxhdGlvbiA9IGRlbHRhc1tpZHhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgZXhpc3RpbmcgYWRkL3JlbW92ZSBkZWx0YSBhcyBjdXJyZW5sdHkgYmVpbmcgZGVsZXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gZGVsdGFzLnNsaWNlKDAsIGlkeCkuY29uY2F0KFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YVJlbGF0aW9uLCB7ICRtZXRhOiBvcHRpbWlzdGljID8gJ3JlbW92aW5nJyA6ICdwZXJzaXN0ZWQnIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBdLCBkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGVyc2lzdGVkLiBKdXN0IHJlbW92ZSBpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkICE9PSBicmFuY2hJZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBkZWx0YXMuZmluZEluZGV4KGZ1bmN0aW9uIChkZWx0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbHRhLnR5cGUgPT09ICdtb2RpZnknICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEudGFyZ2V0SWQgPT09IG0uaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMCAmJiAhaGFzQWRkaXRpb25hbEZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21vZGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS50YXJnZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBtLmRlbHRhRG9jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3JzOiBbdXNlckRpc3BsYXlOYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAnYWRkaW5nJyA6ICdwZXJzaXN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLmNvbmNhdChkZWx0YXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRGVsdGFEb2MgPSBkZWx0YXNbaWR4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250cmlidXRvcnMgPSBleGlzdGluZ0RlbHRhRG9jLmNvbnRyaWJ1dG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250cmlidXRvcnMuaW5jbHVkZXModXNlckRpc3BsYXlOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5wdXNoKHVzZXJEaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IG1lcmdlRGVsdGFzKGV4aXN0aW5nRGVsdGFEb2MuZGF0YSwgbS5kZWx0YURvYywgeyByZW1vdmVVbnNldFByb3BzOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljICYmIE9iamVjdC5rZXlzKG5ld0RhdGEpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1pdHRlZCBtdXRhdGlvbiB0aGF0IHJlc2V0cyBhIGRlbHRhRG9jLiBSZW1vdmUgdGhlIGRlbHRhRG9jIGVudGlyZWx5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9kaWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnRhcmdldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBuZXdEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnM6IGNvbnRyaWJ1dG9ycyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ3VwZGF0aW5nJyA6ICdwZXJzaXN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5jb25jYXQoZGVsdGFzLnNsaWNlKDAsIGlkeCksIGRlbHRhcy5zbGljZShpZHggKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGZvciAodmFyIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7IF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBtID0gbXV0YXRpb25zXzFbX2ldO1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEobSk7XG4gICAgICAgIGlmICh0eXBlb2Ygc3RhdGVfMSA9PT0gXCJvYmplY3RcIilcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gZGVsdGFzO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgSHR0cEVycm9yIH0gZnJvbSAnLi4vLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IGFwcGx5TXV0YXRpb25zT25EZWx0YXMgfSBmcm9tICcuL2FwcGx5LW11dGF0aW9ucy1vbi1kZWx0YXMnO1xudmFyIERlbHRhQ2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZShnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcbiAgICAgICAgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUgPSBnZXRVc2VyRGlzcGxheU5hbWU7XG4gICAgICAgIHRoaXMubG9va3VwID0ge307XG4gICAgfVxuICAgIERlbHRhQ2FjaGUucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgX2EpIHtcbiAgICAgICAgdmFyIG9wdGltaXN0aWMgPSAoX2EgPT09IHZvaWQgMCA/IHsgb3B0aW1pc3RpYzogZmFsc2UgfSA6IF9hKS5vcHRpbWlzdGljO1xuICAgICAgICAvLyBBcHBseSBtdXRhdGlvbnMgbG9jYWxseSBvbnRvIHRoZSBEZWx0YUNhY2hlIGFuZCBub3RpZnkgdGhlaXIgc3Vic2NyaWJlcnNcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYiA9IE9iamVjdC5rZXlzKHRoaXMubG9va3VwKTsgX2kgPCBfYi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBxdWVyeUtleSA9IF9iW19pXTtcbiAgICAgICAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5sb29rdXBbcXVlcnlLZXldO1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnN0ZWFkIGhlcmU6IFN0b3JlIHRoZSBtdXRhdGlvbnMgb24gY2FjaGVFbnRyeS4gTm8gbWF0dGVyIGlmIGl0IHlldCBoYXMgdmFsdWUgb3Igbm90LlxuICAgICAgICAgICAgICAgIC8vIFRoZW4gYXBwbHkgbXV0YXRpb24gd2hlbmV2ZXIgc3Vic2NyaWJpbmchIChCZXR0ZXIgaGFuZGxpbmcgb2YgbXV0YXRpb25zIHRoYXQgYXJyaXZlcyBiZWZvcmUgZmV0Y2goKSBpcyBkb25lKVxuICAgICAgICAgICAgICAgIC8vIChTZWUgaG93IEkgaGFuZGxlIHRoaXMgaW4gcXVlcnktc2V0LnRzKVxuICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IGFwcGx5TXV0YXRpb25zT25EZWx0YXMoY2FjaGVFbnRyeS5xdWVyeS5icmFuY2hJZCwgY2FjaGVFbnRyeS52YWx1ZSwgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSgpLCAhIWNhY2hlRW50cnkucXVlcnkudGFncyk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBtdXRhdGlvbiByZXF1aXJlcyBjYWNoZUVudHJ5IHRvIGJlIHJlZmV0Y2hlZCBmcm9tIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGxlciBoYXMgc3VjY2Vzc2Z1bGx5IHBlcmZvcm1lZCB0aGUgbXV0YXRpb25zIGFuZCBnb3Qgc3VjY2VzcyBiYWNrIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBvayB0byByZWZldGNoIHRoZSBkZWx0YXMgZnJvbSBzZXJ2ZXIgbm93OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5mZXRjaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWZ0ZXIgZmV0Y2ggY29tcGxldGVzLCBpdCB3aWxsIG5vdGlmeSB0aGUgc3Vic2NyaWJlcnMuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjYWNoZUVudHJ5LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkub3B0aW1pc3RpY1ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5ub3RpZnkobmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVsdGFDYWNoZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHF1ZXJ5LCBvYnNlcnZlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2FjaGVFbnRyeSA9IHRoaXMubG9va3VwW3F1ZXJ5LmJyYW5jaElkICsgcXVlcnkudGFnc107XG4gICAgICAgIGlmICghY2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgY2FjaGVFbnRyeSA9IG5ldyBEZWx0YUNhY2hlRW50cnkodGhpcy5nZXRDbGllbnQoKSwgcXVlcnkpO1xuICAgICAgICAgICAgdGhpcy5sb29rdXBbcXVlcnkuYnJhbmNoSWQgKyBxdWVyeS50YWdzXSA9IGNhY2hlRW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhY2hlRW50cnkuY2xlYW51cFRpbWVyKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIpO1xuICAgICAgICAgICAgY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNhY2hlRW50cnkuc3Vic2NyaWJlcnMgPSBjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBfYS5vYnNlcnZlcjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG8gIT09IG9ic2VydmVyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LmNsZWFudXBUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzLmxvb2t1cFtxdWVyeS5icmFuY2hJZCArIHF1ZXJ5LnRhZ3NdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5wdXNoKHsgb2JzZXJ2ZXI6IG9ic2VydmVyLCBzdWJzY3JpcHRpb246IHN1YnNjcmlwdGlvbiB9KTtcbiAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcbiAgICAgICAgICAgIC8vIFZhbHVlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgYWxyZWFkeS4gUGljayBmcm9tIGNhY2hlLlxuICAgICAgICAgICAgb2JzZXJ2ZXIoY2FjaGVFbnRyeS5vcHRpbWlzdGljVmFsdWUgfHwgY2FjaGVFbnRyeS52YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYWNoZUVudHJ5LmlzRmV0Y2hpbmcpIHtcbiAgICAgICAgICAgIC8vIEEgdmFsdWUgaXMgb24gaXRzIHdheS4gU2l0IGJhY2sgYW5kIHJlbGF4LiBBbGwgcmVnaXN0ZXJlZFxuICAgICAgICAgICAgLy8gb2JzZXJ2ZXJzIChpbmNsdWRpbmcgdGhpcyBvbmUpIHdpbGwgYmUgbm90aWZpZWQgd2hlbiBkYXRhIGFycml2ZXNcbiAgICAgICAgICAgIC8vIG9yIGZhaWxzLlxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNhY2hlRW50cnkuZXJyb3IpIHtcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGNhY2hlRW50cnkuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjYWNoZUVudHJ5LmZldGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICB9O1xuICAgIHJldHVybiBEZWx0YUNhY2hlO1xufSgpKTtcbmV4cG9ydCB7IERlbHRhQ2FjaGUgfTtcbnZhciBEZWx0YUNhY2hlRW50cnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZUVudHJ5KGNsaWVudCwgcXVlcnkpIHtcbiAgICAgICAgdGhpcy5mZXRjaE9wZXJhdGlvbklkID0gMDsgLy8gTWFrZXMgc3VyZSBhIHJlLWZldGNoIHdpbGwgZGlzY2FyZCB0aGUgcmVzdWx0IGZyb20gYW55IG9uZ29pbmcgZmV0Y2guXG4gICAgICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcHRpbWlzdGljVmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNsZWFudXBUaW1lciA9IG51bGw7XG4gICAgfVxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBmZXRjaE9wZXJhdGlvbklkID0gKyt0aGlzLmZldGNoT3BlcmF0aW9uSWQ7XG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuZmV0Y2hGcm9tU2VydmVyKCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3NcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbHVlLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGIuZGF0ZVRpbWUgLSBhLmRhdGVUaW1lOyB9KTsgLy8gTGF0ZXN0IGZpcnN0XG4gICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5vcHRpbWlzdGljVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnkodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgX3RoaXMuZmFpbChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mZXRjaEZyb21TZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucXVlcnkuYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEZWx0YXMgb25seSBhdmFpbGFibGUgb24gYnJhbmNoZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50Lmh0dHAuZ2V0KCdkZWx0YXMnLCB0aGlzLnF1ZXJ5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPj0gMzAwIHx8IHJlcy5zdGF0dXMgPCAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUubm90aWZ5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnN1YnNjcmliZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBvYnNlcnZlciA9IF9iLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYi5zdWJzY3JpcHRpb247XG4gICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHZhciBjb3B5ID0gdGhpcy5zdWJzY3JpYmVycy5zbGljZSgpO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY29weV8xID0gY29weTsgX2kgPCBjb3B5XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBjb3B5XzFbX2ldLCBvYnNlcnZlciA9IF9hLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYS5zdWJzY3JpcHRpb247XG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIERlbHRhQ2FjaGVFbnRyeTtcbn0oKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1jYWNoZS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gJy4uLy4uL29ic2VydmFibGUnO1xudmFyIERlbHRhQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEZWx0YUNvbGxlY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGVsdGFDb2xsZWN0aW9uKGRlbHRhQ2FjaGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuZGVsdGFDYWNoZS5zdWJzY3JpYmUocXVlcnksIG9ic2VydmVyKTsgfSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZGVsdGFDYWNoZSA9IGRlbHRhQ2FjaGU7XG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgRGVsdGFDb2xsZWN0aW9uLnByb3RvdHlwZS50YWdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRGVsdGFDb2xsZWN0aW9uKHRoaXMuZGVsdGFDYWNoZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSwgeyB0YWdzOiB0YWdzIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBEZWx0YUNvbGxlY3Rpb247XG59KENvbGxlY3Rpb24pKTtcbmV4cG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtY29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGVsdGEoZG9jLCBkZWx0YSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEpO1xuICAgIHZhciB0YXJnZXREb2MgPSBkb2M7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XG4gICAgICAgIGlmICh0YXJnZXREb2MgPT09IGRvYylcbiAgICAgICAgICAgIHRhcmdldERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YVtrZXldO1xuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG1pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiR1bnNldFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZyBvbiB0YXJnZXQgZG9jIVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvYy4kd2FzVW5zZXQgPSB0cnVlOyAvLyBKdXN0IG1hcmsgaXQgZm9yIHJlLXJldHJpZXZhbCBhZnRlciBzdWNjZXNzZnVsIHBvc3RpbmcgY2hhbmdlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGQgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb0FkZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBcnJheSA9IHRhcmdldERvY1trZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0YXJnZXRBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gdGFyZ2V0QXJyYXkuc2xpY2UoKTsgLy8gT24gSlMgc2lkZSwgd2UgbXVzdCBiZSBpbW11dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB0YXJnZXRBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlc1RvQWRkXzEgPSB2YWx1ZXNUb0FkZDsgX2kgPCB2YWx1ZXNUb0FkZF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IHZhbHVlc1RvQWRkXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldEFycmF5LmluY2x1ZGVzKHYpKSB7IC8vIGF2b2lkIGR1cHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5LnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzEgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzEuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMSA9IG1ldGFJbnN0cnVjdGlvbnM7IF9hIDwgbWV0YUluc3RydWN0aW9uc18xLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzFbX2FdO1xuICAgICAgICAgICAgICAgICAgICBfbG9vcF8xKG1pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB2YWw7XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXREb2M7XG59XG4vLyB7bmFtZTogXCJVbGxhXCJ9LCB7bmFtZTogeyR1bnNldDowfVxuLy8ge3RhZ3M6IHskYWRkOiBcImhlalwifX0sIHt0YWdzOiB7JHVuc2V0OjB9XCJ9XG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VEZWx0YXMoZGVsdGExLCBkZWx0YTIsIF9hKSB7XG4gICAgdmFyIHJlbW92ZVVuc2V0UHJvcHMgPSAoX2EgPT09IHZvaWQgMCA/IHsgcmVtb3ZlVW5zZXRQcm9wczogZmFsc2UgfSA6IF9hKS5yZW1vdmVVbnNldFByb3BzO1xuICAgIC8vcmV0dXJuIHsuLi5kZWx0YTEsIC4uLmRlbHRhMn07XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YTIpO1xuICAgIHZhciB0YXJnZXREZWx0YSA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhMSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzOyBfaSA8IGtleXNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMltfaV07XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YTJba2V5XTtcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChtaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkdW5zZXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdmVVbnNldFByb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gbWF0dGVyIGlmIHRhcmdldERlbHRhIGlzIGVtcHR5IG9yIGhhcyB2YWx1ZS4gU2V0IGl0IHRvIHskdW5zZXQ6MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gbWFrZSBzdXJlIHRoZSB2ZXJ5IGVuZCByZXN1bHQgd2lsbCBoYXZlIHskdW5zZXQ6MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHsgJHVuc2V0OiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZF8yID0gbWlWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9BZGRfMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldERlbHRhW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXRNZXRhUHJvcCA/IHRzbGliXzEuX19hc3NpZ24oe30sIHRhcmdldE1ldGFQcm9wKSA6IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB0YXJnZXRNZXRhUHJvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCwganVzdCBjaGVjayBpZiB0YXJnZXQgbWV0YVByb3AgaGFzIHskcmVtb3ZlOiBbLi4uaXRlbXNdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCByZW1vdmUgYW55IGVxdWFsIGl0ZW1zIGZyb20gdGhlcmUgYmVmb3JlIG1lcmdpbmcgdGhlIHskYWRkOiBbLi4uXX0gYXJyYXlzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFyZ2V0UmVtb3ZlQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRyZW1vdmUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9BZGRfMi5pbmNsdWRlcyh0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgJHJlbW92ZSBhcnJheSBiZWNhbWUgZW10cHkuIFJlbW92ZSB0aGUgJHJlbW92ZSBwcm9wLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93IGl0J3MgdGltZSB0byBtZXJnZSBvciBjcmVhdGUgdGFyZ2V0ICRhZGQgYXJyYXkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJGFkZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheSA9IHRhcmdldEFkZEFycmF5ID8gdGFyZ2V0QWRkQXJyYXkuY29uY2F0KHZhbHVlc1RvQWRkXzIpIDogdmFsdWVzVG9BZGRfMi5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRhZGQgPSB0YXJnZXRBZGRBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMiA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JGFkZDogWy4uLml0ZW1zXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JHJlbW92ZTogWy4uLl19IGFycmF5cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldEFkZEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFkZEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzIuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJGFkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRhZGQgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRhZGQgcHJvcC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kYWRkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkcmVtb3ZlIGFycmF5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRSZW1vdmVBcnJheSA/IHRhcmdldFJlbW92ZUFycmF5LmNvbmNhdCh2YWx1ZXNUb1JlbW92ZV8yKSA6IHZhbHVlc1RvUmVtb3ZlXzIuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID0gdGFyZ2V0UmVtb3ZlQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgbWV0YUluc3RydWN0aW9uc18yID0gbWV0YUluc3RydWN0aW9uczsgX2IgPCBtZXRhSW5zdHJ1Y3Rpb25zXzIubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMltfYl07XG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzIobWkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0RGVsdGE7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1tZXJnZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXJlcG8nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbmV4cG9ydCAqIGZyb20gJy4vbXV0YXRpb24tcXVldWUnO1xuZXhwb3J0ICogZnJvbSAnLi9xdWVyeS1zZXQnO1xuZXhwb3J0ICogZnJvbSAnLi4vb2JzZXJ2YWJsZS9taXhpbic7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQmF0Y2hSdW5uZXIgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xuaW1wb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9IGZyb20gXCIuL2tlZGJhY2tlbmQtc3Vic2NyaXB0aW9uXCI7XG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xuaW1wb3J0IHsgS2VkQmFja2VuZFF1ZXJ5IH0gZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tICcuLi9vYnNlcnZhYmxlL2NvbGxlY3Rpb24nO1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgXCJsaXZlXCIgcXVlcnkgYWdhaW5zdCBhIHRhYmxlIG9yIGZpbHRlcmVkIHRhYmxlLlxuICovXG52YXIgS2VkQmFja2VuZENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoS2VkQmFja2VuZENvbGxlY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENvbGxlY3Rpb24ocmVwbywgdGFibGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG5ldyBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uKG9ic2VydmVyLCBfdGhpcyk7XG4gICAgICAgICAgICBfdGhpcy5yZXBvLnF1ZXJ5U2V0LnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucmVwbyA9IHJlcG87XG4gICAgICAgIF90aGlzLnRhYmxlID0gdGFibGU7XG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJxdWVyeUtleVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtlZEJhY2tlbmRRdWVyeS5xdWVyeUtleSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJpbmNsdWRlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luY2x1ZGVzIHx8ICh0aGlzLl9pbmNsdWRlcyA9IFtdLmNvbmNhdCh0aGlzLnF1ZXJ5LmluY2x1ZGUgfHwgW10pKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFwcGx5UXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBLZWRCYWNrZW5kQ29sbGVjdGlvbih0aGlzLnJlcG8sIHRoaXMudGFibGUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMucXVlcnksIHF1ZXJ5KSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkVG9RdWVyeUFycmF5UHJvcCA9IGZ1bmN0aW9uIChhcnJheVByb3AsIGVudHJpZXMpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KChfYSA9IHt9LCBfYVthcnJheVByb3BdID0gKHRoaXMucXVlcnlbYXJyYXlQcm9wXSB8fCBbXSkuY29uY2F0KGVudHJpZXMpLCBfYSkpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZEZsYWdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmxhZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGZsYWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImZsYWdzXCIsIGZsYWdzKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGRlYnVnOiB0cnVlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzQW5kTmFtZXNPbmx5XCIpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNPbmx5XCIpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaW5jbHVkZUlkc0FuZE5hbWVzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5iZXR3ZWVuID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBmcm9tOiBmcm9tLCB0bzogdG8gfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucm9sZSA9IGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyByb2xlOiByb2xlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzRnJvbSA9IGZ1bmN0aW9uIChpZHMpIHtcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBpZCBsaXN0IGdpdmVuIHRvIENvbGxlY3Rpb24uaGFzRWRnZXNGcm9tKFwiICsgSlNPTi5zdHJpbmdpZnkoaWRzKSArIFwiKVwiKTtcbiAgICAgICAgdmFyIGhlZiA9IHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImhhc0VkZ2VzRnJvbVwiLCBpZHMpO1xuICAgICAgICByZXR1cm4gaGVmO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzVG8gPSBmdW5jdGlvbiAoaWRzKSB7XG4gICAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8IGlkcy5zb21lKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gIWlkOyB9KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzVG8oXCIgKyBKU09OLnN0cmluZ2lmeShpZHMpICsgXCIpXCIpO1xuICAgICAgICB2YXIgaGV0ID0gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaGFzRWRnZXNUb1wiLCBpZHMpO1xuICAgICAgICByZXR1cm4gaGV0O1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcbiAgICAgICAgICAgIG9uWmVybzogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBlbnRpdHkgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXG4gICAgICAgICAgICBvbk1hbnk6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgZW50cmllcyBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzID0gZnVuY3Rpb24gKGlkcykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IHRhZ3M6IHRhZ3MgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JhcGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaW5jbHVkZVwiLCBncmFwaHMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmNhY2hlT3B0aW1pemVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgY2FjaGVCdXN0OiBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMucmVwby5nZXRVc2VyKCksIHRoaXMuaW5jbHVkZXMpIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm11dGF0aW9uc09uRW1wdHkgPSBmdW5jdGlvbiAobXV0YXRpb25GYWN0b3J5KSB7XG4gICAgICAgIHZhciB0eCA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgbXV0YXRpb25zT25FbXB0eTogdHgubXV0YXRpb25SZXF1ZXN0cyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hID0gdGhyb3dlcnMgfHwge30sIG9uWmVybyA9IF9hLm9uWmVybywgb25NYW55ID0gX2Eub25NYW55O1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChvblplcm8pXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpdGVtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcbiAgICAgICAgICAgICAgICAgICAgb25NYW55KCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbMF07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLypjb21iaW5lTGF0ZXN0PFRPdGhlcj4ob3RoZXI6IFF1ZXJ5T2JzZXJ2YWJsZTxUT3RoZXI+KSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcbiAgICB9Ki9cbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRvYywgY2hhbmdlcywgZGVib3VuY2UpIHtcbiAgICAgICAgaWYgKGRlYm91bmNlID09PSB2b2lkIDApIHsgZGVib3VuY2UgPSAxMDAwOyB9XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxuICAgICAgICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgICAgICAgZGVsdGFEb2M6IGNoYW5nZXMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogZG9jLm5hbWVcbiAgICAgICAgICAgIH1dLCBkZWJvdW5jZSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkUmVsYXRlZCA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWREb2MpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ2FkZC1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlUmVsYXRlZCA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWREb2MpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3JlbW92ZS1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnF1ZXJ5LmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidW5kbyBsaW5rcyBjYW4gb25seSBiZSBwZXJmb3JtZWQgb24gYnJhbmNoZXNcIik7XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICd1bmRvLWxpbmsnLFxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxuICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICBncmFwaFByb3A6IGxhYmVsLFxuICAgICAgICAgICAgICAgIHJlbGF0ZWRJZDogcmVsYXRlZElkXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaWRzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBpZHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShpZHMubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgIG9wOiAnZGVsZXRlJyxcbiAgICAgICAgICAgIHRhYmxlOiBfdGhpcy50YWJsZSxcbiAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICB9KTsgfSksIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLnJlcG8ucXVlcnlTZXQudW5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kQ29sbGVjdGlvbjtcbn0oQ29sbGVjdGlvbikpO1xuZXhwb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfTtcbi8qbWl4aW4oXG4gIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSxcbiAgTWFwcGVkQ29sbGVjdGlvbi5wcm90b3R5cGUsXG4gIFwibWFwXCIsIFwiZmxhdFwiLCBcImNvbmNhdFwiLCBcInJlbmRlclwiLCBcImxvYWRcIik7Ki9cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtY29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdXBkYXRlQXJyYXkgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQvdXRpbHMnO1xuaW1wb3J0IHsgYnJhbmNoU2Vuc2l0aXZlLCBnZXRUYWJsZUZyb21MYWJlbCB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgYXBwbHlEZWx0YSB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIEtlZEJhY2tlbmRRdWVyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUXVlcnkodGFibGUsIHF1ZXJ5LCB1c2VyLCByZXBvLCBtdXRhdGlvblF1ZXVlKSB7XG4gICAgICAgIHRoaXMudGFibGUgPSB0YWJsZTtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgICAgICB0aGlzLnJlcG8gPSByZXBvO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW52YWxpZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvYWRlZFZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9sb2FkUHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMuaW5jbHVkZXMgPSBxdWVyeS5pbmNsdWRlID9cbiAgICAgICAgICAgIHR5cGVvZiBxdWVyeS5pbmNsdWRlID09PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICAgICAgW3F1ZXJ5LmluY2x1ZGVdIDpcbiAgICAgICAgICAgICAgICBxdWVyeS5pbmNsdWRlIDpcbiAgICAgICAgICAgIFtdO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBtdXRhdGlvbnNPbkVtcHR5ID0gcXVlcnkubXV0YXRpb25zT25FbXB0eSwgY29tcGFyYWJsZVByb3BzID0gdHNsaWJfMS5fX3Jlc3QocXVlcnksIFtcIm11dGF0aW9uc09uRW1wdHlcIl0pO1xuICAgICAgICByZXR1cm4gdGFibGUgKyBKU09OLnN0cmluZ2lmeShjb21wYXJhYmxlUHJvcHMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUsIFwicXVlcnlLZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhLCBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgJiYgIXRoaXMuaW52YWxpZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSwgdHJ1ZSwgdGhpcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLnF1ZXJ5TG9jYWxseSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxvYWRQcm9taXNlO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbXV0YXRpb25zT25FbXB0eSBzaG91bGQgbmV2ZXIgYmUgdXNlZCB0d2ljZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5xdWVyeS5tdXRhdGlvbnNPbkVtcHR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIXZlcnNpb24gJiYgdGhpcy5fbG9hZFByb21pc2UpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2xvYWRQcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiBcbiAgICAgICAgICAgICAgICAgICAgLy8gbG9hZGluZyBpcyBvbmdvaW5nLCBhbmQgY2FsbGVyIGRvZXMgbm90IHJlcXVpcmUgYSByZWNlbnQgcmVmcmVzaC5cbiAgICAgICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgdGhlIG9uZ29pbmcgbG9hZCB0byBjb21wbGV0ZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgdGhpcy5yZXBvLndyaXRlci5wZXJzaXN0ZWRWZXJzaW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkUHJvbWlzZSA9IHRoaXMuX2xvYWQodmVyc2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbG9hZFByb21pc2UgPT09IGxvYWRQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkZWRWZXJzaW9uID0gTWF0aC5tYXgoX3RoaXMubG9hZGVkVmVyc2lvbiwgdmVyc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9vbmUgaGFzIHJlZnJlc2hlZCBvdXIgbG9hZC4gVGhlIGVycm9yIGlzIHRoZSBmaW5hbCByZXN1bHQuIFNldCBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBXZSdyZSBmaW5pc2hlZC4gRGF0YSBvciBlcnJvciBpcyBhbHJlYWR5IHNldC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBnb3RJbml0aWFsUmVzcG9uc2UgdG8gdHJ1ZSBhbmQgbm90aWZ5IHN1YnNjcmliZXJzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnlTdWJzY3JpYmVycyhfdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgbW9yZSByZWNlbnQgY2FsbCB0byBsb2FkKCkgaXMgb25nb2luZywgT1Igd2FzIG9uZ29pbmcgYnV0IHJlc3BvbmRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWZvcmUgdXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIGFueSBjYXNlIHJldHVybiB0aGlzLl9sb2FkUHJvbWlzZS4gSWYgaXQncyBvbmdvaW5nIHdlJ2xsIHdhaXQgZm9yIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIGZpbmlzaC4gSWYgaXQncyBudWxsLCB3ZSdsbCBiZSByZXR1cm5pbmcgZmluYWxseSBoZXJlIHdpdGhvdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW55IGFjdGlvbiwgYmVjYXVzZSB0aGUgYWN0aW9uIHdhcyB0YWtlbiBieSB0aGUgcmVmcmVzaGVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2xvYWRQcm9taXNlOyAvLyBXYWl0IGZvciB0aGUgcmVmcmVzaGVkIGxvYWQgdG8gY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRQcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuX2xvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm11dGF0aW9uUXVldWUuYWZmZWN0c1F1ZXJ5KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMuaW5jbHVkZXMpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBvdXRnb2luZyBtdXRhdGlvbnMgdGhhdCBhZmZlY3RzIHRoaXMgcXVlcnkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLndyaXRlci53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCh2ZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBvdXRnb2luZyBtdXRhdGlvbnMgdGhhdCBhZmZlY3RzIHRoaXMgcXVlcnkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXJ2ZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gdGhpcy5zdWJzY3JpcHRpb25zLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gc3Vic2NyaXB0aW9uOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuY29tbWl0TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgdmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfaSwgbXV0YXRpb25zXzEsIG0sIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICBtID0gbXV0YXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgJiYgKG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdtZXJnZScgJiYgKCFtLnRhcmdldEJyYW5jaElkIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PT0gdGhpcy5xdWVyeS5icmFuY2hJZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0udGFyZ2V0QnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICd1cGRhdGUnICYmICgobS5kZWx0YURvYy50YWdzICYmIHRoaXMucXVlcnkudGFncykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobS5kZWx0YURvYy5uYW1lICYmIHRoaXMucXVlcnkubmFtZSkpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBIHRhZyBtYXkgaGF2ZSBiZWVuIGFkZGVkLCBvciByZW5hbWVkLCBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21taXQgdGhlIG11dGF0aW9ucyBsb2NhbGx5IGFzIHdlIGRvbid0IGhhdmUgYWxsIGluZm8uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBIHRhZyBtYXkgaGF2ZSBiZWVuIGFkZGVkLCBvciByZW5hbWVkLCBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21taXQgdGhlIG11dGF0aW9ucyBsb2NhbGx5IGFzIHdlIGRvbid0IGhhdmUgYWxsIGluZm8uXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKG11dGF0aW9ucywgZmFsc2UsIHRoaXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA5O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnJlZnJlc2hPckludmFsaWRhdGUgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCh2ZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVycyA9IGZ1bmN0aW9uIChvcHRpbWlzdGljTXV0YXRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmRhdGEgJiYgdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBkYXRhXzEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChvcHRpbWlzdGljTXV0YXRpb25zLCB0cnVlLCB0aGlzLmRhdGEpO1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICBzLm5vdGlmeVN1YnNjcmliZXIoZGF0YV8xLCBfdGhpcy5lcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcG8ucXVlcnlTZXQucXVlcnlMb2NhbGx5KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMuaW5jbHVkZXMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeVNlcnZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlcG8uZ2V0Q2xpZW50KCkubGlzdCh0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRhdGFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkID0gZnVuY3Rpb24gKG11dGF0aW9ucywgb3B0aW1pc3RpYywgZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcbiAgICAgICAgICAgIGRhdGEgPSBfdGhpcy5hcHBseU11dGF0aW9uc09uRGF0YShkYXRhLCBtdXRhdGlvbiwgb3B0aW1pc3RpYyk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuYXBwbHlNdXRhdGlvbnNPbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSwgbSwgb3B0aW1pc3RpYykge1xuICAgICAgICBpZiAoYnJhbmNoU2Vuc2l0aXZlKG0pICYmIG0uYnJhbmNoSWQgIT0gdGhpcy5xdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLCB0YWJsZSA9IF9hLnRhYmxlLCBpbmNsdWRlcyA9IF9hLmluY2x1ZGVzLCBsaXN0T3B0aW9ucyA9IF9hLnF1ZXJ5O1xuICAgICAgICB2YXIgc291cmNlSWRzID0gbGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tID8gW10uY29uY2F0KGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSB8fCBbXSkgOiBbXTtcbiAgICAgICAgdmFyIHJlcXVlc3RlZFRhZ3MgPSBsaXN0T3B0aW9ucy50YWdzID8gW10uY29uY2F0KGxpc3RPcHRpb25zLnRhZ3MgfHwgW10pIDogW107XG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzoge1xuICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgPT09IG0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGRlbHRhIG9uIHVwZGF0ZWQgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkRG9jID0gYXBwbHlEZWx0YShkb2MsIG0uZGVsdGFEb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZERvYy4kbWV0YSA9ICd1cGRhdGluZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlZERvYztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBpZCBkb2VzIG5vdCBhcHBseSB0byB0aGlzIGRvYywgc2VhcmNoIGluIGdyYXBocyB0aGUgaWQgaXMgZm91bmRcbiAgICAgICAgICAgICAgICAgICAgLy8gYW1vbmcgZ3JhcGggaW5jbHVkZWQgZG9jcywgYW5kIGlmIHNvLCB1cGRhdGUgdGhhdCBvbmU6XG4gICAgICAgICAgICAgICAgICAgIGluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlZERvY3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZEFycmF5ID0gdXBkYXRlQXJyYXkoaW5jbHVkZWREb2NzLCBmdW5jdGlvbiAocmVsYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRlZC5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWxhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZFJlbGF0ZWQgPSBhcHBseURlbHRhKHJlbGF0ZWQsIG0uZGVsdGFEb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW1pc3RpYylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRSZWxhdGVkLiRtZXRhID0gJ3VwZGF0aW5nJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRSZWxhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkQXJyYXkgIT09IGluY2x1ZGVkRG9jcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVtsYWJlbF0gPSB1cGRhdGVkQXJyYXksIF9hKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ2FkZC1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXMgYGRiLmNvdXJzZUJsb2Nrcy4uLi53aGF0ZXZlci4uIC5pbmNsdWRlKFwiYWJpbGl0aWVzXCIpYCwgZGV0ZWN0OiBkYi5jb3Vyc2VCbG9ja3MuYWRkUmVsYXRlZChibG9ja0lkLCAnYWJpbGl0aWVzJywgLi4uKVxuICAgICAgICAgICAgICAgICAgICAvLyAuLi5iZWNhdXNlIHRhYmxlID0gJ2NvdXJzZUJsb2NrcycgYW5kIGluY2x1ZGVzIGhhcyBcImFiaWxpdGllc1wiLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLnJlbGF0ZWREb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZERvYy4kbWV0YSA9ICdhZGRpbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IGRvY1ttLmdyYXBoUHJvcF0uY29uY2F0KFtyZWxhdGVkRG9jXSksIF9hKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VJZHMuaW5jbHVkZXMobS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGBkYi5jb3Vyc2VCbG9ja3MuaGFzRWRnZXNGcm9tKFtjb3Vyc2VJZF0pYCAgKG1lYW5pbmcgdGFibGU9J2NvdXJzZUJsb2NrcycgYW5kIHNvdXJjZUlkcyBpbmNsdWRlcyBjb3Vyc2VJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICwgZGV0ZWN0OiBkYi5jb3Vyc2VJbnN0YW5jZXMuYWRkUmVsYXRlZChjb3Vyc2VJZCwgJ2NvdXJzZUJsb2NrcycsIC4uLi4pIC8vIG0uZ3JhcGhQcm9wID09PSAnYmxvY2tzJy0tPiBnZXRUYWJsZUZyb21MYWJlbCAtLT4gJ2NvdXJzZUJsb2NrcydcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gZ2V0VGFibGVGcm9tTGFiZWwobS50YWJsZSwgbS5ncmFwaFByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0T3B0aW9ucy50YWdzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtLnJlbGF0ZWREb2MudGFncyAmJiByZXF1ZXN0ZWRUYWdzLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4gbS5yZWxhdGVkRG9jLnRhZ3MuaW5jbHVkZXModGFnKTsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmlkcyAmJiBsaXN0T3B0aW9ucy5pZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIGlkID09PSBtLnJlbGF0ZWREb2MuaWQ7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgY2VydGFpbiBJRCBpcyBvYnNlcnZlZC4gQSBkb2Mgd2l0aCB0aGlzIGlkIGlzIGJlaW5nIGFkZGVkLlxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIGRvYyB0byB0aGUgcmVzdWx0LiBFeGFjdGx5IHRoaXMgV0lMTCBoYXBwZW4gaW4gdGhlIGZvbGxvd2luZyB0eXBpY2FsIHNjZW5hcmlvOlxuICAgICAgICAgICAgICAgICAgICAvLyAxLiBVc2VyIGFkZHMgYSByZWxhdGVkIGRvY3VtZW50IHRvIGEgbGlzdC5cbiAgICAgICAgICAgICAgICAgICAgLy8gMi4gRG9jdW1lbnQgcmVtYWlucyB3aXRoaW4gdGhlIE11dGF0aW9uUXVldWUgd2hpbGUgYmF0Y2gtcmVxdWVzdCBpcyBiZWluZyBwcm9jZXNzZWQgYnkgc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAvLyAzLiBVc2VyIGNsaWNrcyB0aGUgYWRkZWQgaXRlbSB0byBlZGl0IG9yIHZpZXcgaXQgKG9yIG91ciBjb21wb25lbnQgcmVkaXJlY3RzIHRvIGl0cyBlZGl0b3IpXG4gICAgICAgICAgICAgICAgICAgIC8vIDQuIEEgbmV3IHF1ZXJ5IG9mIHRoYXQgcGFydGljdWxhciBJRCBpcyBzdWJzY3JpYmVkIHRvIHtpZHM9W3RoZUlkXX1cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgS2VkQmFja2VuZFF1ZXJ5LnN1YnNjcmliZSB0aGVuIGRvZXMgdGhpczpcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAxLiBDYWxsIHF1ZXJ5TG9jYWxseSgpIGJlZm9yZSBxdWVyeWluZyBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAyLiBxdWVyeUxvY2FsbHkoKSBpbnNwZWN0cyBtdXRhdGlvbnMgYW5kIGZpbmRzIGEgbWF0Y2gsIHJldHVybmluZyBhbiBlbXB0eSBsaXN0XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgKGFzc3VtZXMgYXMgd2UgYXJlIGFkZGluZyBpdCwgaXQgY2FuJ3QgZXhpc3Qgb24gdGhlIHNlcnZlciBhbnl3YXkpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMy4gS2VkQmFja2VuZFFVZXJ5IGFwcGxpZXMgbXV0YXRpb25zIG9udG8gdGhlIGVtcHR5IGxpc3QsIGFuZCBlbmRzIHVwIGhlcmUgdG8gYWRkXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgaXQgb3B0aW1pc3RpY2FsbHkuXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNC4gV2hlbiBzZXJ2ZXIgcmVzcG9uZHMgd2l0aCAyMDAgT0ssIGNhbGxzIHVzIGhlcmUgYWdhaW4gd2l0aCBvcHRpbWlzdGljPWZhbHNlXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgdG8gXCJwZXJzaXN0XCIgaXQgaW4gdGhlIHF1ZXJ5J3MgZGF0YSBhcnJheS5cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICA0QjogSWYgbm90IDIwMCBPSywgbXV0YXRpb24gbWF5IGJlIGdvbmUgYW5kIHRoZSBzdWJzY3JpYmVyIHdpbGwgc2UgYW4gZXJyb3IgcGFnZVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwiQ291bGQgbm90IGZpbmQgZW50aXR5IHdpdGggaWQgWC5cIiBhbG9uZyB3aXRoIGEgcmVkIGVycm9yIG1lc3NhZ2Ugb24gdGhlIHNjcmVlblxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGFib3V0IHRoYXQgaXQgZmFpbGVkIHRvIHNhdmUgb24gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW20uZ3JhcGhQcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5jbHVkZWREb2NzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbS5ncmFwaFByb3BdID0gb3B0aW1pc3RpYyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayByZWxhdGVkLWRvYy10by1yZW1vdmUgd2l0aCAkbWV0YTogJ2RlbGV0aW5nJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZERvYy5pZCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgOiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkOyB9KSwgX2EpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUlkcy5pbmNsdWRlcyhtLmlkKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCA9PT0gbS5yZWxhdGVkRG9jLmlkID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZCwgeyAkbWV0YTogJ2RlbGV0aW5nJyB9KSA6IGQ7IH0pIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkOyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0uaWQ7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZFRhYmxlcyA9IGluY2x1ZGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gKHsgbGFiZWw6IGxhYmVsLCB0YWJsZTogZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB9KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IF9hLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09PSBtLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsc18xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gX2EubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYiA9IHt9LCBfYltsYWJlbF0gPSBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX2EuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgX2IpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc2V0R3JhcGhQcm9wcyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgdmFyIGNvcHkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xuaW1wb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfSBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbmltcG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jb2xsZWN0aW9uJztcbnZhciBLZWRCYWNrZW5kUmVwbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUmVwbyhnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucywgbXV0YXRpb25RdWV1ZSwgcXVlcnlTZXQsIHdyaXRlciwgY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5nZXRDbGllbnQgPSBnZXRDbGllbnQ7XG4gICAgICAgIHRoaXMuZ2V0VXNlciA9IGdldFVzZXI7XG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xuICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMgPSBkZWZhdWx0UXVlcnlPcHRpb25zO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMud3JpdGVyID0gd3JpdGVyO1xuICAgICAgICB0aGlzLmNhY2hlT3B0aW1pemVkID0gY2FjaGVPcHRpbWl6ZWQ7XG4gICAgICAgIGlmICghZGVmYXVsdFF1ZXJ5T3B0aW9ucylcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyA9IHt9O1xuICAgICAgICBpZiAoIW11dGF0aW9uUXVldWUpXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBuZXcgTXV0YXRpb25RdWV1ZSgpO1xuICAgICAgICBpZiAoIXF1ZXJ5U2V0KVxuICAgICAgICAgICAgdGhpcy5xdWVyeVNldCA9IG5ldyBRdWVyeVNldCh0aGlzLm11dGF0aW9uUXVldWUpO1xuICAgICAgICBpZiAoIXdyaXRlcilcbiAgICAgICAgICAgIHRoaXMud3JpdGVyID0gbmV3IEtlZEJhY2tlbmRXcml0ZXIodGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLnF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSk7XG4gICAgICAgIE9iamVjdC5rZXlzKHRhYmxlcykuZm9yRWFjaChmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICBpZiAoY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXNbdGFibGVdID0gY29sbGVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZGVsdGFzID0gbmV3IERlbHRhQ29sbGVjdGlvbih0aGlzLndyaXRlci5kZWx0YUNhY2hlLCB7XG4gICAgICAgICAgICBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkIC8vIElmIGJyYW5jaElkIGlzIHVuZGVmaW5lZC4gRGVsdGFDb2xsZWN0aW9uIHdpbGwgcmVzcG9uZCB3aXRoIEVycm9yIG9uIHN1YnNjcmliZSgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUudGFibGUgPSBmdW5jdGlvbiAodGFibGVOYW1lKSB7XG4gICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKHRoaXMsIHRhYmxlTmFtZSwgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zKTtcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVPcHRpbWl6ZWQpXG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbiAocXVlcnlPcHRpb25zLCBjYWNoZU9wdGltaXplZCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgS2VkQmFja2VuZFJlcG8odGhpcy5nZXRDbGllbnQsIHRoaXMuZ2V0VXNlciwgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucywgcXVlcnlPcHRpb25zKSwgdGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLnF1ZXJ5U2V0LCB0aGlzLndyaXRlciwgY2FjaGVPcHRpbWl6ZWQgPT09IHVuZGVmaW5lZCA/IHRoaXMuY2FjaGVPcHRpbWl6ZWQgOiBjYWNoZU9wdGltaXplZCk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5icmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyByb2xlOiByb2xlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLm9wdGltaXplQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7fSwgdHJ1ZSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNsZWFyIG1hc3RlciBicmFuY2hcIik7XG4gICAgICAgIHRoaXMud3JpdGVyLm11dGF0ZShbeyBvcDogJ2NsZWFyLWJyYW5jaCcsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IG1lcmdlIGZyb20gbWFzdGVyIGJyYW5jaFwiKTtcbiAgICAgICAgdGhpcy53cml0ZXIubXV0YXRlKFt7IG9wOiAnbWVyZ2UnLCBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZDogdGFyZ2V0QnJhbmNoSWQgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnNhdmVOb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMud3JpdGVyLndhaXRGb3JWZXJzaW9uVG9QZXJzaXN0KHRoaXMud3JpdGVyLmN1cnJlbnRWZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFJlcG87XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFJlcG8gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtcmVwby5qcy5tYXAiLCJ2YXIgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uKHN1YnNjcmliZXIsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbiAgICB9XG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlciA9IGZ1bmN0aW9uIChkYXRhLCBlcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXJyb3IsIHRoaXMpO1xuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YSAhPT0gdGhpcy5sYXN0Tm90aWZpZWREYXRhKSB7IC8vIFdpbGwgaW4tZmFjdCBiZSBlcXVhbCBieSByZWZlcmVuY2UgaWYgZGF0YSBpcyBzYW1lIGFzIGxhc3Qgbm90aWZpY2F0aW9uIChhcyB3ZSB1c2UgYW4gaW1tdXRhYmxlIGFwcHJvYWNoIG9uIGRhdGEpXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWREYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoZGF0YSwgZXJyb3IsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoW10sIGV4LCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleDIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igd2hpbGUgbm90aWZ5aW5nIEtlZEJhY2tlbmRTdWJzY3JpYmVyOlwiLCBleDIsICdvcmlnaW5hbGx5IG5vdGlmaWVkIGVycm9yOicsIGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi51bnN1YnNjcmliZSh0aGlzKTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uO1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtc3Vic2NyaXB0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBNdXRhdGlvblF1ZXVlIH0gZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XG5pbXBvcnQgeyBCYXRjaFJ1bm5lciB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudCc7XG5pbXBvcnQgeyB0YWJsZXMgfSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJy4uL29ic2VydmFibGUnO1xuaW1wb3J0IHsgRGVsdGFDYWNoZSB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jYWNoZSc7XG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kV3JpdGVyKG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xuICAgICAgICB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSA9IGdldFVzZXJEaXNwbGF5TmFtZTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMucGVyc2lzdGVkVmVyc2lvbiA9IG5ldyBFbWl0dGVyKDApO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XG4gICAgICAgIHRoaXMuZGVsdGFDYWNoZSA9IG5ldyBEZWx0YUNhY2hlKGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzU2F2aW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAhIXRoaXMuX2lzU2F2aW5nUHJvbWlzZTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzRWRpdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMDsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vblN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSB0aGlzLmVycm9yU3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBjYWxsYmFjazsgfSk7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycyA9IHRoaXMuc3RhdGVTdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IGNhbGxiYWNrOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IsIHJldHJ5YWJsZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJldHJ5YWJsZSwgX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoXykgeyB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubXV0YXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucywgZGVib3VuY2UpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmFkZChtdXRhdGlvbnMpO1xuICAgICAgICArK3RoaXMuY3VycmVudFZlcnNpb247XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgIHRoaXMuZGVsdGFDYWNoZS5hcHBseU11dGF0aW9ucyh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCksIHsgb3B0aW1pc3RpYzogdHJ1ZSB9KTtcbiAgICAgICAgaWYgKCF0aGlzLl9pc1NhdmluZ1Byb21pc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHRoaXMuc2F2ZS5iaW5kKHRoaXMpLCBkZWJvdW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgaXNTYXZpbmcsIHdlIGRvbid0IG5lZWQgdG8gZG8gYW55dGhpbmcsIGJlY2FzZSBpdCB3aWxsIHJlLWNoZWNrIGlmIGFkZGl0aW9uYWxcbiAgICAgICAgLy8gbXV0YXRpb25zIGhhdmUgY29tZSwgd2hlbiBzYXZpbmcgaXMgZG9uZS5cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLnJldHJ5U2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZWRWZXJzaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZWRWZXJzaW9uID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGVyc2lzdGVkVmVyc2lvbiA8IHZlcnNpb24pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpOyAvLyBCZSBtb3JlIGVhZ2VyIHRvIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5maWx0ZXIoZnVuY3Rpb24gKHBlcnNpc3RlZFZlcnNpb24pIHsgcmV0dXJuIHBlcnNpc3RlZFZlcnNpb24gPj0gdmVyc2lvbjsgfSkubG9hZCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5fdGltZW91dElkKVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgIGlmICh0aGlzLl9pc1NhdmluZ1Byb21pc2UpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNTYXZpbmdQcm9taXNlO1xuICAgICAgICBpZiAoIXRoaXMuaXNFZGl0ZWQpXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lzU2F2aW5nUHJvbWlzZSA9IHRoaXMuX3NhdmUoKTtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDsgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5fc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbXV0YXRpb25zLCB2ZXJzaW9uLCBtdXRhdGlvblJlcXVlc3RzLCByZXNfMSwgZXRhZ011dGF0aW9ucywgZXJyb3JfMTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gdGhpcy5jdXJyZW50VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5tb3ZlVG9TYXZpbmdRdWV1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25SZXF1ZXN0cyA9IHRoaXMubWFwTXV0YXRpb25zKG11dGF0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNiwgMTEsIDEyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmdldENsaWVudCgpLmJhdGNoKG11dGF0aW9uUmVxdWVzdHMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBldGFnTXV0YXRpb25zID0gT2JqZWN0LmtleXMocmVzXzEubmV3RXRhZ3MpLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YURvYzogeyAkZXRhZzogcmVzXzEubmV3RXRhZ3NbaWRdIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCAvLyBXZSBkb24ndCBoYXZlIHRoZSB0YXJnZXQgbmFtZS4gQnV0IHRoaXMgbXV0YXRpb24gd29uJ3QgYmUgdmlzaWJsZSBpbiBhIERlbHRhQ29sbGVjdGlvbiBhbnl3YXksIHNvIGl0IHdvbnQgYmUgdXNlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgICAgIENhY2hlQnVzdC5pbnZhbGlkYXRlQ2FjaGUobXV0YXRpb25SZXF1ZXN0cywgdGhpcy5nZXRVc2VyKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29tbW1pdCBtdXRhdGlvbnMgYWxvbmcgd2l0aCBldGFnTXV0YXRpb25zIGludG8gcXVlcmllcyBjYWNoZWQgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoKHZlcnNpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWx0YUNhY2hlLmFwcGx5TXV0YXRpb25zKG11dGF0aW9ucywgeyBvcHRpbWlzdGljOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXQuY29tbWl0TXV0YXRpb25zKE11dGF0aW9uUXVldWUubWVyZ2UobXV0YXRpb25zLCBldGFnTXV0YXRpb25zKSwgdmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbiBzdWNjZXNzLCBjbGVhciBzYXZpbmcgcXVldWUgYXMgdGhlIG11dGF0aW9ucyB3aWxsIG5vdyBiZSBjb21taXR0ZWQgdG8gYWxsIHF1ZXJ5J3MgZGF0YSBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpOyAvLyBpc0VkaXRlZCBtYXkgaGF2ZSB0dXJuZWQgdG8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmFsbHksIG5vdGlmeSBzdWJzY3JpYmVycyBzbyB0aGF0IHZpZXdzIGdldCB1cGRhdGVkIHdpdGggY29tbWl0dGVkIHJlc3VsdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhcyB3ZWxsLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc2F2ZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2hFcnJvcihlcnJvcl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGVycm9yXzEgJiYgZXJyb3JfMS5uYW1lICYmIGVycm9yXzEubmFtZS5zdGFydHNXaXRoKFwiaHR0cDRcIikpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFjY2VzcyBDb250cm9sIGRlbmllZCwgYmFkIHJlcXVlc3Qgb3Igc2ltaWxhci4gVGhyb3cgbXV0YXRpb25zIGF3YXkuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpOyAvLyBpc0VkaXRlZCBtYXkgaGF2ZSB0dXJuZWQgdG8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIbyBobyEgQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYWxvbmUuIFRIZXkgbWlnaHQgYmUgbW9yZSBsdWNreS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3NhdmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvIGhvISBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhbG9uZS4gVEhleSBtaWdodCBiZSBtb3JlIGx1Y2t5LlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubWFwTXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICB2YXIgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLnVwZGF0ZShtLnRhYmxlLCBtLmlkLCBtLmRlbHRhRG9jLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIW0ucmVsYXRlZERvYy4kZXRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gJGV0YWcgbWVhbnMgdGhpcyBpcyBhIG5ldyBkb2N1bWVudC4gQWRkIGl0IGJlZm9yZSBsaW5raW5nIHRvIGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnIuYWRkKHRhYmxlc1ttLnRhYmxlXS5yZWxhdGlvbnNoaXBzW20uZ3JhcGhQcm9wXSwgbS5yZWxhdGVkRG9jLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBici5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkRG9jLmlkLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBici51bmxpbmsyKG0udGFibGUsIG0uaWQsIG0uZ3JhcGhQcm9wLCBtLnJlbGF0ZWREb2MuaWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd1bmRvLWxpbmsnOlxuICAgICAgICAgICAgICAgICAgICBici51bmRvTGluayhtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkSWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICBici5kZWxldGUobS50YWJsZSwgbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGJyLmNsZWFyQnJhbmNoKG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLm1lcmdlKG0uYnJhbmNoSWQsIG0udGFyZ2V0QnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRXcml0ZXI7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC13cml0ZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBtZXJnZURlbHRhcyB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIE11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XG4gICAgfVxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5xdWV1ZSwgbXV0YXRpb25zKTtcbiAgICB9O1xuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLm1vdmVUb1NhdmluZ1F1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gTXV0YXRpb25RdWV1ZS5tZXJnZSh0aGlzLnNhdmluZ1F1ZXVlLCB0aGlzLnF1ZXVlKTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2xlYXJTYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZmZlY3RzUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcbiAgICAgICAgaWYgKG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLm9wID09PSAnbWVyZ2UnIHx8IG0ub3AgPT09ICdjbGVhci1icmFuY2gnOyB9KSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XG4gICAgICAgICAgICAvLyBBIHF1ZXJ5IHdpdGggXCJpZHNcIiBmaWx0ZXIgd2lsbCBiZSBlYXN5IHRvIGRldGVjdCBhIG5vLW1hdGNoIG9uOlxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBnbG9iYWxPcChtKSB8fCAoIWJyYW5jaFNlbnNpdGl2ZShtKSB8fCBtLmJyYW5jaElkID09PSBxdWVyeS5icmFuY2hJZCkgJiZcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXV0YXRpb25zIGFmZmVjdCBzYW1lIGJyYW5jaCBhbmQgdGFibGUuIENvdWxkIGJlIGRvbmUgbW9yZSBmaW5lIGdyYWluZWQsXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgcmV0dXJuIG0ub3AgPT09ICdkZWxldGUnID9cbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XG4gICAgICAgICAgICAgICAgZ2xvYmFsT3AobSkgPyB0cnVlIDpcbiAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PSBxdWVyeS5icmFuY2hJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUxID0gcXVldWUxLnNsaWNlKCk7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUyID0gcXVldWUyLnNsaWNlKCk7XG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XG4gICAgICAgIHZhciBsZW4gPSBxdWV1ZTEubGVuZ3RoO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcbiAgICAgICAgICAgIGlmIChtLm9wID09PSAndXBkYXRlJykge1xuICAgICAgICAgICAgICAgIHZhciBvdmVybGFwcGluZ0lkT3BJZHggPSBtdXRhYmxlUXVldWUyLmZpbmRJbmRleChmdW5jdGlvbiAobmV3TXV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuYnJhbmNoSWQgPT09IG0uYnJhbmNoSWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5pZCA9PT0gbS5pZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3ZlcmxhcHBpbmdJZE9wSWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMVtpXSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0sIHsgZGVsdGFEb2M6IG1lcmdlRGVsdGFzKG0uZGVsdGFEb2MsIG11dGFibGVRdWV1ZTJbb3ZlcmxhcHBpbmdJZE9wSWR4XS5kZWx0YURvYykgfSk7XG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtdXRhYmxlUXVldWUxLmNvbmNhdChtdXRhYmxlUXVldWUyKTtcbiAgICB9O1xuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xufSgpKTtcbmV4cG9ydCB7IE11dGF0aW9uUXVldWUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfSBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG52YXIgUXVlcnlTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUXVlcnlTZXQobXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBbXTtcbiAgICB9XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwodGhpcy5xdWVyaWVzLm1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5jb21taXRNdXRhdGlvbnMobXV0YXRpb25zLCB2ZXJzaW9uKTsgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW52YWxpZFF1ZXJpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuY2xlYW51cEludmFsaWRRdWVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7XG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHEudGltZW91dEhhbmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3B0aW1pc3RpY011dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIHEubm90aWZ5U3Vic2NyaWJlcnMob3B0aW1pc3RpY011dGF0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmZpbmRRdWVyeSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcmllcy5maW5kKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLnF1ZXJ5S2V5ID09PSBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGFibGUsIHF1ZXJ5KTsgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgLy8gRm9yIG5vdywgb25seSBoYW5kbGUgdGhpcyB2ZXJ5IGNvbW1vbiBhbmQgc3BlY2lhbCBjYXNlICh3aGljaFxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgd2FudHMgdG8gZ2V0IGEgc2luZ2xlIGVudGl0eSBieSBpdHMgSUQ6XG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gQW5kIGlmIHNvLCBpZiB3ZSBoYXZlIGFuIG91dGdvaW5nIG11dGF0aW9uIHRvIGNyZWF0ZSB0aGF0IGVudGl0eTpcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ2FkZC1yZWxhdGVkJyAmJiBtLnJlbGF0ZWREb2MuaWQgPT09IHF1ZXJ5Lmlkc1swXTsgfSkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcbiAgICAgICAgICAgICAgICAvLyBidXQgbGV0IHRoZSBvcHRpc3RpYyBmZWF0dXJlIG9mIEtlZEJhY2tlbmRRdWVyeSBhcHBseSB0aGUgbXV0YXRpb24gYmVmb3JlXG4gICAgICAgICAgICAgICAgLy8gbm90aWZ5aW5nIHN1YnNjcmliZXJzICh3ZSBkb24ndCB3YW50IGl0IHRvIGJlIHBlcnNpc3RlbnQgYmVmb3JlIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPSywgYW5vdGhlciBxdWl0ZSBjb21tb24gY2FzZSBpcyB3aGVuIHdlIGFzayBmb3IgYSBjZXJ0YWluIElEIGFuZCB0aGF0IElEIHJlcGxpZXNcbiAgICAgICAgLy8gd2l0aGluIGFub3RoZXIgcXVlcnlcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIE5vdCBwb3NzaWJsZSB0byBoYW5kbGVcbiAgICAgICAgaWYgKCFxdWVyeS5pZHMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIGlmICghcS5nb3RJbml0aWFsUmVzcG9uc2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgIGlmIChxLnF1ZXJ5LmJyYW5jaElkICE9PSBxdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjsgLy8gSXQgd291bGQgYmUgY29tcGxleCB0byBzdXBwb3J0IHZhcmlvdXMgZmxhZ3MuIFF1ZXJ5J3MgZGF0YSBtYXkgaW5jbHVkZSBpZHMgb25seS4gQ2FuJ3QgcmVseSBvbiB0aGUgcXVlcnkuXG4gICAgICAgICAgICB2YXIgcUluY2x1ZGVzID0gcS5pbmNsdWRlcztcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaW5jbHVkZSwgYnV0IHRoaXMgcXVlcnkgZG9lcy4gQ2hlY2sgaWYgd2UgY2FuIGZpbmQgb3VyIHJlc3VsdCB3aXRoaW4gaXQuXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcUluY2x1ZGVzLmZpbmQoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3EudGFibGVdW1wicmVsYXRpb25zaGlwc1wiXVtsXSA9PT0gdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHEuZGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViRGF0YSA9IHF1ZXJ5QXJyYXkocXVlcnksIGVudGl0eVtsYWJlbF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IHJldHVybiByZXNfMVtyLmlkXSA9IHI7IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMSA9IE9iamVjdC5rZXlzKHJlc18xKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXNfMVtpZF07IH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaW5jbHVkZXMuZXZlcnkoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBxSW5jbHVkZXMuaW5jbHVkZXMobGFiZWwpOyB9KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgLy8gTGFzdGx5LCBpZiB0aGUgcXVlcnkgaW5jbHVkZXMgYWxsIGdyYXBocyB0aGF0IHdlIGRvLCBwaWNrIHRoZSBzdWJzZXQgZnJvbSB0aGF0IHF1ZXJ5LlxuICAgICAgICAgICAgLy8gQ29uY3JldGUgZXhhbXBsZTogV2Ugb2JzZXJ2ZSBhIGNlcnRhaW4gVGFzayBieSBJRCBhbmQgd2FudCBpdHMga25vd2xlZGdlUmVxdWlyZW1lbnRzIGFsb25nIHdpdGggaXQsXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxuICAgICAgICAgICAgaWYgKHEudGFibGUgPT09IHRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8yID0gcXVlcnlBcnJheShxdWVyeSwgcS5kYXRhKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5pZHMuZXZlcnkoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXN1bHRfMi5zb21lKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmlkID09PSBpZDsgfSk7IH0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHEgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoIWtiUXVlcnkpIHtcbiAgICAgICAgICAgIGtiUXVlcnkgPSBuZXcgS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgcmVwby5nZXRVc2VyKCksIHJlcG8sIHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoa2JRdWVyeS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGtiUXVlcnkuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoa2JRdWVyeSkge1xuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxuICAgICAgICAgICAga2JRdWVyeS51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgLy8gUmVsZWFzZSB1bm5lc2Nlc3NhcnkgbWVtb3J5IHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgc3Vic2NyaXB0aW9ucyBvZiB0aGlzIHF1ZXJ5LCBieSByZW1vdmluZyB0aGUgcXVlcnkgaXRzZWxmXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxuICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGluIDUgbWludXRlczpcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYga2JRdWVyeSBzdGlsbCBoYXMgbm8gc3Vic2NyaXB0aW9ucyAobm90IGNlcnRhaW4hIEEgbmV3IHN1YnNjcmliZXIgbWF5IGhhdmUgY29tZSBhbG9uZy4uLilcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcmllcyA9IF90aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxICE9PSBrYlF1ZXJ5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XG4gICAgICAgICAgICAgICAgICAgIDUwMCA6IC8vIERvbid0IGhvc3QgdG9vIG1hbnkgcXVlcmllcy4gR2FyYmFnZSBjb2xsZWN0IHRoaXMgd2l0aGluIDUwMCBtc1xuICAgICAgICAgICAgICAgICAgICA1ICogNjAwMDApOyAvLyBBbGxvdyBxdWVyeSBpbiBtZW1vcnkgZm9yIGFub3RoZXIgNSBtaW51dGVzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBRdWVyeVNldDtcbn0oKSk7XG5leHBvcnQgeyBRdWVyeVNldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWJsZUZyb21MYWJlbCh0YWJsZSwgbGFiZWwpIHtcbiAgICByZXR1cm4gdGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUFycmF5KHF1ZXJ5LCBkYXRhKSB7XG4gICAgdmFyIGZpbHRlciA9IGdldEZpbHRlckZyb21RdWVyeShxdWVyeSk7XG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XG59XG5leHBvcnQgZnVuY3Rpb24gQU5EKGZpbHRlcjEsIGZpbHRlcjIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpIHtcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgaWYgKHF1ZXJ5LmZyb20pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA+PSBxdWVyeS5mcm9tOyB9KTtcbiAgICBpZiAocXVlcnkudG8pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA8IHF1ZXJ5LnRvOyB9KTtcbiAgICBpZiAocXVlcnkuaWRzKVxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XG4gICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5uYW1lID09PSBxdWVyeS5uYW1lOyB9KTtcbiAgICBpZiAocXVlcnkudGFncylcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRhZ3MgJiYgW10uY29uY2F0KHF1ZXJ5LnRhZ3MgfHwgW10pLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4geC50YWdzLmluY2x1ZGVzKHRhZyk7IH0pOyB9KTtcbiAgICAvLyBxdWVyeS5oYXNFZGdlc0Zyb20gYW5kIHF1ZXJ5Lmhhc0VkZ2VzVG8gY2Fubm90IGJ5IGZpbHRlcmVkIGhlcmVcbiAgICByZXR1cm4gZmlsdGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJyYW5jaFNlbnNpdGl2ZShtKSB7XG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdsb2JhbE9wKG0pIHtcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSc7XG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcbiAgICBpZiAoY2xpZW50Ll9fbWlncmF0b3JfbWl4ZWRfaW4pXG4gICAgICAgIHJldHVybjtcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XG4gICAgdmFyIGdldCA9IGNsaWVudC5nZXQ7XG4gICAgdmFyIGxpc3QgPSBjbGllbnQubGlzdDtcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGllbnQubGlzdCA9IGZ1bmN0aW9uICh0YWJsZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gbWlncmF0ZShkb2MsIHRhYmxlLCBpbmNsdWRlICYmIGluY2x1ZGUudG9TdHJpbmcoKS5zcGxpdCgnLCcpKTsgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBjbGllbnQ7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVUYXNrIGZyb20gJy4vbWlncmF0ZS10YXNrJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVDb3Vyc2UoY291cnNlLCBncmFwaHMpIHtcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxuICAgICAgICBjb3Vyc2UubW9kdWxlcyA9IFtdO1xuICAgIGNvdXJzZS5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZSkge1xuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIG1vZHVsZS5yZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XG4gICAgICAgICAgICBtb2R1bGUudGFza0lkcyA9IFtdO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykge1xuICAgICAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xuICAgIH1cbiAgICAvLyBFYXJsaWVyIHdyb25nIHNwZWxsaW5nIG9mIHJlc291cmNlc1xuICAgIGlmICgncmVzb3Vyc2VzJyBpbiBjb3Vyc2UgJiYgISgncmVzb3VyY2VzJyBpbiBjb3Vyc2UpKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xuICAgICAgICBkZWxldGUgY291cnNlLnJlc291cnNlcztcbiAgICB9XG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBbXTtcbiAgICB9XG4gICAgaWYgKGdyYXBocykge1xuICAgICAgICBncmFwaHMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XG4gICAgICAgICAgICAgICAgICAgIGNvdXJzZS50YXNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXNrKSB7IHJldHVybiBtaWdyYXRlVGFzayh0YXNrKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLWNvdXJzZS5qcy5tYXAiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlVGFzayh0YXNrKSB7XG4gICAgaWYgKCF0YXNrLnJlc291cmNlcylcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtdGFzay5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZUNvdXJzZSBmcm9tICcuL21pZ3JhdGUtY291cnNlJztcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlKGRvYywgdGFibGUsIGdyYXBocykge1xuICAgIHN3aXRjaCAodGFibGUpIHtcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcbiAgICAgICAgICAgIG1pZ3JhdGVDb3Vyc2UoZG9jLCBncmFwaHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxuICAgICAgICAgICAgbWlncmF0ZVRhc2soZG9jKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xudmFyIENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB0aHJvdyBcIm1peGVkaW5cIjtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgdmFyIGVtaXR0ZXJfMSA9IG5ldyBFbWl0dGVyKHgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBlbWl0dGVyXzEuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYnNlcnZhYmxlQ29sbGVjdGlvbi5mcm9tKCkgY2FuIG9ubHkgdGFrZSBhcnJheXMgb3Igb2JzZXJ2YWJsZXNcIik7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIG1hcHBlcihpdGVtKTsgfSk7IH0pO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgaXRlbXMpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLmZpbHRlcihmaWx0ZXIpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5mcm9tKHRoaXMudG9WYWx1ZSgpLmNvbWJpbmVMYXRlc3Qob3RoZXIpLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IF9hWzBdLCBvdGhlciA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnJheSkgeyByZXR1cm4gYXJyYXkuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYVByb3AgPSBhICYmIGFbcHJvcF07XG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XG4gICAgICAgICAgICByZXR1cm4gYVByb3AgPiBiUHJvcCA/IDEgOiBhUHJvcCA8IGJQcm9wID8gLTEgOiAwO1xuICAgICAgICB9KTsgfSkudG9Db2xsZWN0aW9uKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnRvVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5ncm91cEJ5ID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBydiA9IHt9O1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnIpIHsgcmV0dXJuIGFyclswXTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcbn0oT2JzZXJ2YWJsZSkpO1xuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhFbWl0dGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVtaXR0ZXIoaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzICE9PSBvYnNlcnZlcjtcbiAgICAgICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVycy5wdXNoKFtvYnNlcnZlciwgc3Vic2NyaXB0aW9uXSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMuZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIoX3RoaXMudmFsdWUsIHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaCgpO1xuICAgIH07XG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEVtaXR0ZXI7XG59KFZhbHVlKSk7XG5leHBvcnQgeyBFbWl0dGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsInZhciBzdGFjayA9IFtdO1xudmFyIGN1cnJlbnRGaWJlciA9IG51bGw7XG52YXIgcHJvdmlkZXJzID0gW2Z1bmN0aW9uICgpIHsgcmV0dXJuIGN1cnJlbnRGaWJlcjsgfV07XG5mdW5jdGlvbiBwdXNoRmliZXIoZmliZXIpIHtcbiAgICBzdGFjay5wdXNoKGN1cnJlbnRGaWJlcik7XG4gICAgY3VycmVudEZpYmVyID0gZmliZXI7XG59XG5mdW5jdGlvbiBwb3BGaWJlcigpIHtcbiAgICBjdXJyZW50RmliZXIgPSBzdGFjay5wb3AoKTtcbn1cbmV4cG9ydCB2YXIgRmliZXJDb250ZXh0ID0ge1xuICAgIGdldCBjdXJyZW50KCkgeyByZXR1cm4gY3VycmVudEZpYmVyOyB9LFxuICAgIC8qcnVuOiBmdW5jdGlvbiByZXJ1bjxSPihmaWJlcjogRmliZXIsIGZuOiAoKT0+Uik6IFIgfCBQcm9taXNlPFI+IHtcbiAgICAgIHB1c2hGaWJlcihmaWJlcik7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZuKCkpO1xuICAgICAgfSBjYXRjaCAocCkge1xuICAgICAgICBpZiAocCAmJiB0eXBlb2YgcC50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIHAudGhlbigoKT0+cmVydW4oZmliZXIsIGZuKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHApO1xuICAgICAgICB9XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBwb3BGaWJlcigpO1xuICAgICAgfVxuICAgIH0sKi9cbiAgICBhZGRQcm92aWRlcjogZnVuY3Rpb24gKGdldEN1cnJlbnRGaWJlcikge1xuICAgICAgICBwcm92aWRlcnMucHVzaChnZXRDdXJyZW50RmliZXIpO1xuICAgICAgICBzZXRDdXJyZW50R2V0dGVyRnJvbVByb3ZpZGVycygpO1xuICAgIH0sXG4gICAgcmVtb3ZlUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcbiAgICAgICAgcHJvdmlkZXJzID0gcHJvdmlkZXJzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcCAhPT0gZ2V0Q3VycmVudEZpYmVyOyB9KTtcbiAgICAgICAgc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKTtcbiAgICB9XG59O1xuZnVuY3Rpb24gc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpYmVyQ29udGV4dCwgXCJjdXJyZW50XCIsIHtcbiAgICAgICAgZ2V0OiBwcm92aWRlcnMucmVkdWNlKGZ1bmN0aW9uIChwLCBjKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBwKCkgfHwgYygpOyB9OyB9KSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIlVzZSBGaWJlckNvbnRleHQucHVzaCgpIHRvIGNoYW5nZSBjdXJyZW50IGZpYmVyXCIpOyB9XG4gICAgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWJlci1jb250ZXh0LmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vb2JzZXJ2YWJsZSc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcbmV4cG9ydCAqIGZyb20gJy4vY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2VtaXR0ZXInO1xuZXhwb3J0ICogZnJvbSAnLi9maWJlci1jb250ZXh0Jztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImV4cG9ydCBmdW5jdGlvbiBpbml0TWFwTWV0aG9kKGN0b3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IGN0b3IoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobWFwcGVyKHZhbHVlKSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IH0pO1xuICAgIH07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYXAuanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIG1peGluKHRhcmdldFByb3RvLCBtaXhpblByb3RvKSB7XG4gICAgdmFyIHByb3BzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgcHJvcHNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHByb3BzLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHsgcmV0dXJuIHRhcmdldFByb3RvW3Byb3BdID0gbWl4aW5Qcm90b1twcm9wXTsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taXhpbi5qcy5tYXAiLCJ2YXIgT2JzZXJ2YWJsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvL3N0YXRpYyBnZXQgW1N5bWJvbC5zcGVjaWVzXSgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKF9zdWJzY3JpYmUpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlID0gX3N1YnNjcmliZTtcbiAgICB9XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcywgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgeyB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyB9IH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZTtcbn0oKSk7XG5leHBvcnQgeyBPYnNlcnZhYmxlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcIi4vb2JzZXJ2YWJsZVwiO1xuaW1wb3J0IHsgaW5pdE1hcE1ldGhvZCB9IGZyb20gXCIuL21hcFwiO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gXCIuL2NvbGxlY3Rpb25cIjtcbmltcG9ydCB7IEZpYmVyQ29udGV4dCB9IGZyb20gJy4vZmliZXItY29udGV4dCc7XG52YXIgVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVmFsdWUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmFsdWUoc3Vic2NyaWJlKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBzdWJzY3JpYmUpIHx8IHRoaXM7XG4gICAgfVxuICAgIFZhbHVlLmZyb20gPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoeC5zdWJzY3JpYmUpXG4gICAgICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChzKSB7IHJldHVybiB4LnN1YnNjcmliZShzKTsgfSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlLmZyb20oKSBjYW4gb25seSB0YWtlIG9ic2VydmFibGVzXCIpO1xuICAgIH07XG4gICAgVmFsdWUucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXNvbHZlZCA9IGZhbHNlLCByZXN1bHQsIGVyciwgbm90aWZ5O1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NpcHRpb24pIHtcbiAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgICAgZXJyID0gZXJyb3I7XG4gICAgICAgICAgICBpZiAoZXJyb3IgJiYgbm90aWZ5KVxuICAgICAgICAgICAgICAgIG5vdGlmeShudWxsLCBlcnJvciwgc3Vic2NpcHRpb24pO1xuICAgICAgICAgICAgZWxzZSBpZiAobm90aWZ5KVxuICAgICAgICAgICAgICAgIG5vdGlmeSh2YWx1ZSwgbnVsbCwgc3Vic2NpcHRpb24pO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHJlc29sdmVkKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudEZpYmVyID0gRmliZXJDb250ZXh0LmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWJlcikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgRmliZXIgQ29udGV4dFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9ucyA9IGN1cnJlbnRGaWJlci5zdWJzY3JpcHRpb25zLCBvYnNlcnZlciA9IGN1cnJlbnRGaWJlci5vYnNlcnZlcjtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgbm90aWZ5ID0gb2JzZXJ2ZXI7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIG5vdGlmeSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY2lwdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICAgICAgICAgIHN1YnNjaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlIGlmIChmbih2YWx1ZSkpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKHByZWZpeCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHByZWZpeCwgeCk7XG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUudG9Db2xsZWN0aW9uID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLm1hcChtYXBwZXIpLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgICAgIHZhciBteVN1YnNjcmlwdGlvbiwgb3RoZXJTdWJzY3JpcHRpb247XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG15U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG90aGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG15U3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcywgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gaXRlbXM7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBvdGhlclN1YnNjcmlwdGlvbiA9IG90aGVyLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbMF0gIT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlcywgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHZhciByZXR1cm5lZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcHBlZFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBzO1xuICAgICAgICAgICAgICAgIGlmIChtYXBwZWRTdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlT3JWYWx1ZSA9IG1hcHBlcihpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZhYmxlT3JWYWx1ZSAmJiB0eXBlb2Ygb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihvYnNlcnZhYmxlT3JWYWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuZWRTdWJzY3JpcHRpb247XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFZhbHVlO1xufShPYnNlcnZhYmxlKSk7XG5leHBvcnQgeyBWYWx1ZSB9O1xuVmFsdWUucHJvdG90eXBlLm1hcCA9IGluaXRNYXBNZXRob2QoVmFsdWUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmFsdWUuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL29ic2VydmFibGUnO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8nO1xuIiwidmFyIG1hcCA9IHtcblx0XCIuL2VuLVNHXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1TRy5qc1wiLFxuXHRcIi4vZW4tU0cuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLVNHLmpzXCIsXG5cdFwiLi9lbi1hdVwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWF1LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1hdS5qc1wiLFxuXHRcIi4vZW4tY2FcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1jYS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tY2EuanNcIixcblx0XCIuL2VuLWdiXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4tZ2IuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWdiLmpzXCIsXG5cdFwiLi9lbi1pZVwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLWllLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pZS5qc1wiLFxuXHRcIi4vZW4taWxcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWlsLmpzXCIsXG5cdFwiLi9lbi1pbC5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWwuanNcIixcblx0XCIuL2VuLW56XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vZW4tbnouanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLW56LmpzXCIsXG5cdFwiLi9zdlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIixcblx0XCIuL3N2LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9zdi5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1hcCwgcmVxKSkge1xuXHRcdHZhciBlID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJ1wiKTtcblx0XHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdFx0dGhyb3cgZTtcblx0fVxuXHRyZXR1cm4gbWFwW3JlcV07XG59XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlIHN5bmMgcmVjdXJzaXZlIHN2fGVuXCI7IiwiaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9jb250cmFjdHMva2VkLW1vZGVsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRVc2VyQ2xhaW1zICh1c2VyOiBVc2VyKSB7XG4gIHJldHVybiBbe1xuICAgIHR5cGU6IFwiZW1haWxcIixcbiAgICB2YWx1ZTogdXNlci5tYWlsXG4gIH0se1xuICAgIHR5cGU6IFwic2Nob29sXCIsXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sXG4gIH1dLmNvbmNhdCh1c2VyLnJvbGVzLm1hcChyb2xlID0+ICh7XG4gICAgdHlwZTogXCJyb2xlXCIsXG4gICAgdmFsdWU6IHJvbGVcbiAgfSkpKS5jb25jYXQodXNlci5yb2xlcy5tYXAocm9sZSA9PiAoe1xuICAgIHR5cGU6IFwic2Nob29sUm9sZVwiLFxuICAgIHZhbHVlOiB1c2VyLnNjaG9vbCArIFwiL1wiICsgcm9sZVxuICB9KSkpO1xufVxuIiwiaW1wb3J0IHsgQWNjZXNzQ2xhaW0sIERvY3VtZW50QWNjZXNzLCBoYXNBY2Nlc3MgYXMgX2hhc0FjY2VzcywgQWNjZXNzUmlnaHQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBEb2N1bWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBnZXRVc2VyQ2xhaW1zIGZyb20gJy4vZ2V0LXVzZXItY2xhaW1zJztcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcsIGdlbmVyYXRlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuZXhwb3J0IHsgZ2V0VXNlckNsYWltcyB9O1xuXG5leHBvcnQgY29uc3QgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMgPSBbXG4gIFwidXNlclwiLFxuICBcInJvbGVcIixcbiAgXCJzY2hvb2xcIixcbiAgXCJkZWJ1Z1wiLFxuICBcInRlc3RWZXJzaW9uXCIsXG4gIFwidGVzdHZlcnNpb25cIixcbiAgXCJmZWF0dXJlc1wiLFxuICBcInNjaG9vbFR5cGVcIixcbiAgXCJzY2hvb2x0eXBlXCJdO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQsIHJlcXVlc3RlZFJpZ2h0OiBBY2Nlc3NSaWdodCkge1xuICB2YXIgY2xhaW1zID0gZ2V0VXNlckNsYWltcyh1c2VyKTtcbiAgaWYgKHJlcXVlc3RlZFJpZ2h0ICE9PSAnUicgJiYgdXNlci50dXRvckZvcikge1xuICAgIGNsYWltcyA9IGNsYWltcy5maWx0ZXIoY2xhaW0gPT4gY2xhaW0udHlwZSAhPT0gJ2VtYWlsJyk7XG4gIH1cbiAgdmFyIHJlc3VsdCA9IF9oYXNBY2Nlc3MoRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZ0FycmF5KGRvYy5hY2wgfHwgW10pLCBjbGFpbXMsIHJlcXVlc3RlZFJpZ2h0KTtcbiAgLy9jb25zb2xlLmxvZyhgSGFzICR7cmVxdWVzdGVkUmlnaHR9IGFjY2VzcyB0byAke2RvYy5uYW1lfS8ke2RvYy5pZH06ICR7cmVzdWx0fWApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzUmVhZEFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzV3JpdGVBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1cnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1NoYXJlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdTJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xuICBjb25zdCBpc1RlYWNoZXIgPSB1c2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnRU1QTE9ZRUUnIHx8IHJvbGUgPT09ICdBRE1JTicpO1xuICBjb25zdCBiZWxvbmdzVG9TY2hvb2wgPSAoc2Nob29sfHxcIlwiKS50b0xvd2VyQ2FzZSgpID09PSB1c2VyLnNjaG9vbC50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gKGlzVGVhY2hlciAmJiBiZWxvbmdzVG9TY2hvb2wpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pbk9yVGVhY2hlckF0U2Nob29sKHVzZXI6IFVzZXIsIHNjaG9vbDogc3RyaW5nKSB7XG4gIHJldHVybiB1c2VyLnJvbGVzLmluY2x1ZGVzKFwiQURNSU5cIikgfHwgaXNUZWFjaGVyQXRTY2hvb2wodXNlciwgc2Nob29sKTtcbn1cblxuZXhwb3J0IGNvbnN0IGltcGVyc29uYXRpb25FbnYgPSB7XG4gIGFjdEFzIChvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xuICAgIGNvbnN0IHtyb2xlLCBzY2hvb2wsIHVybH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IGN1cnJlbnRRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcbiAgICBjb25zdCBuZXdRdWVyeSA9IHsuLi5jdXJyZW50UXVlcnksIHJvbGUsIHNjaG9vbH07XG4gICAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKG5ld1F1ZXJ5KTtcbiAgICBpZiAodXJsKSB7XG4gICAgICBsb2NhdGlvbi5ocmVmID0gYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9jYXRpb24uaGFzaCA9IFwiI1wiO1xuICAgICAgbG9jYXRpb24uc2VhcmNoID0gbmV3UXVlcnlTdHJpbmc7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhY3RBcyhvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xuICBpbXBlcnNvbmF0aW9uRW52LmFjdEFzKG9wdGlvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgKHVybDogc3RyaW5nLCBxdWVyeToge1tuYW1lOiBzdHJpbmddIDogc3RyaW5nfSkge1xuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XG4gIGNvbnN0IHByZXNlcnZlZFF1ZXJ5ID0ge307XG4gIGZvciAoY29uc3QgcGFyYW0gb2YgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpIHtcbiAgICBpZiAoY3VycmVudFF1ZXJ5W3BhcmFtXSkgcHJlc2VydmVkUXVlcnlbcGFyYW1dID0gY3VycmVudFF1ZXJ5W3BhcmFtXTtcbiAgfVxuICBjb25zdCBuZXdRdWVyeVN0cmluZyA9IGdlbmVyYXRlUXVlcnlTdHJpbmcoey4uLnByZXNlcnZlZFF1ZXJ5LCAuLi5xdWVyeX0pO1xuICBjb25zdCBwSGFzaCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIHJldHVybiBwSGFzaCA+PSAwID9cbiAgICBgJHt1cmwuc3Vic3RyKDAscEhhc2gpfSR7bmV3UXVlcnlTdHJpbmd9JHt1cmwuc3Vic3RyKHBIYXNoKX1gIDpcbiAgICBgJHt1cmx9JHtuZXdRdWVyeVN0cmluZ31gO1xufVxuIiwiaW1wb3J0IHsgRURTQ291cnNlLCBFRFNBc3Nlc3NtZW50LCBFRFNTdHVkeVBsYW4sIEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5LCBFRFNTdHVkZW50LCBFRFNUdWl0aW9uR3JvdXAsIEVEU1R1aXRpb25TdHVkZW50LCBFRFNUZWFjaGVyLCBNb2NrRURTQWNhZGVtaWNZZWFyLCBNb2NrRURTRGF0ZVJhbmdlIH0gZnJvbSAnLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgSXNvbW9ycGhpY0VudiwgQmVhcmVyUHJvdmlkZXIsIEh0dHBFcnJvciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IFNjaG9vbE1vbWVudCwgZ2V0VGVybVN0YXJFbmREYXRlIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgeyBTY2hvb2xUZXJtIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLXRlcm0nO1xuaW1wb3J0IHsgZGF0ZVRpbWVSZXZpdmVyLCBMIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IG1vY2tKc29uRmlsZSBmcm9tICcuL21vY2svbW9jay1lZHMtZGF0YS5qc29uJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IFN1c3BlbnNlQmFzZWRBUEksIG1ha2VTdXNwZW5zZUFwaSB9IGZyb20gJy4uL3V0aWxzL21ha2Utc3VzcGVuc2UtYXBpJztcblxuZXhwb3J0IGNsYXNzIEVkc0NsaWVudCB7XG4gIGh0dHA6IFJlc3RDbGllbnQ7XG4gIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZztcbiAgc3VzcGVuc2U6IFN1c3BlbnNlQmFzZWRBUEk8RWRzQ2xpZW50PjtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgaXNvbW9ycGhpYzogSXNvbW9ycGhpY0VudixcbiAgICBiYXNlVXJsOiBzdHJpbmcsXG4gICAgYmVhcmVyUHJvdmlkZXI6IEJlYXJlclByb3ZpZGVyLFxuICAgIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZ1xuICApIHtcbiAgICB0aGlzLmh0dHAgPSBuZXcgUmVzdENsaWVudCAoaXNvbW9ycGhpYywgYmFzZVVybCwge2JlYXJlclByb3ZpZGVyfSk7XG4gICAgdGhpcy51c2VyRW1haWxHZXR0ZXIgPSB1c2VyRW1haWxHZXR0ZXI7XG4gICAgY29uc3QgaXNBcGlNZXRob2QgPSBtID0+XG4gICAgICB0eXBlb2YgdGhpc1ttXSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgbSAhPT0gJ2NvbnN0cnVjdG9yJyAmJiAvLyBTaW5jZSBtYWtlU3VzcGVuc2VBcGkoKSB3YWxrcyBwcm90b3R5cGUgY2hhaW5cbiAgICAgIG0gIT09ICdwcml2YXRpemluZ0NhY2hlQnVzdCcgJiZcbiAgICAgIG0gIT09ICd1c2VyRW1haWxHZXR0ZXInIC8vIExpc3Qgbm9uLUFQSSBtZXRob2RzIGhlcmUuLi5cbiAgICAgIDtcblxuICAgIE9iamVjdC5rZXlzKEVkc0NsaWVudC5wcm90b3R5cGUpLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgIGlmIChpc0FwaU1ldGhvZChtZXRob2QpKSB7XG4gICAgICAgIHRoaXNbbWV0aG9kXSA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzW21ldGhvZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc3VzcGVuc2UgPSBtYWtlU3VzcGVuc2VBcGkodGhpcywge2lzQXBpTWV0aG9kfSk7XG4gIH1cblxuICBwcml2YXRlIHByaXZhdGl6aW5nQ2FjaGVCdXN0KCkge1xuICAgIHJldHVybiB7dXNlcjogdGhpcy51c2VyRW1haWxHZXR0ZXIoKX07XG4gIH1cblxuLyoqXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxuICAgKlxuICAgKiBAcGFyYW0gY291cnNlQ29kZSBTaG9ydC1uYW1lIG9mIHRoZSBjb3Vyc2UuIE9wdGlvbmFsLlxuICAgKi9cbiAgYXN5bmMgZ2V0QWN0aXZlQ291cnNlcyhxOiB7Y291cnNlQ29kZT86IHN0cmluZywgcGVyaW9kTmFtZTogc3RyaW5nfSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgICBpZiAocSkge1xuICAgICAgICBpZiAocS5jb3Vyc2VDb2RlKSBxdWVyeS5Db3Vyc2VDb2RlID0gcS5jb3Vyc2VDb2RlO1xuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhY3RpdmVjb3Vyc2VzXCIsIHF1ZXJ5KTtcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgcmV0dXJuIGpzb24uY291cnNlcyBhcyBFRFNDb3Vyc2VbXTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZyb20gRURTOiBcIiArIGV4KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihMYEt1bmRlIHR5dsOkcnIgaW50ZSBsYWRkYSB0ZXJtaW5zbcOlbCBlbGxlciBhdmtsYXJhZGUgc3RlZyBmcsOlbiBFRFMuIEbDtnJzw7ZrIGlnZW4gc2VuYXJlLi4uYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlIGxhdGVzdCBhc3Nlc3NtZW50cyBmb3IgY3VycmVudCBsb2dnZWQgaW4gdXNlci5cbiAgICogXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxuICAgKi9cbiAgYXN5bmMgZ2V0TGF0ZXN0QXNzZXNzbWVudHMobGltaXQ/OiBudW1iZXIpIHtcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgaWYgKCFpc05hTihsaW1pdCkpIHF1ZXJ5LkNvdW50ID0gbGltaXQ7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhc3Nlc3NtZW50c1wiLCBxdWVyeSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLmFzc2Vzc21lbnRzIGFzIEVEU0Fzc2Vzc21lbnRbXTsgICAgXG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxuICAgKi9cbiAgYXN5bmMgZ2V0U3R1ZGVudEdvYWxzKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcbiAgfVxuXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRGdXR1cmVBYmlsaXRpZXNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEZ1dHVyZUFiaWxpdGllcyBhcyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInRlYWNoZXJ0dXRvcnN0dWRlbnRzXCIsIHRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnN0dWRlbnRzIGFzIEVEU1N0dWRlbnRbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRTY2hvb2xUdWl0aW9uR3JvdXBzKClcbiAgICogXG4gICAqIFJldHVybiB0dWl0aW9uZ3JvdXBzIGZvciBzY2hvb2xcbiAgICogXG4gICAqIEBwYXJhbSBzY2hvb2xOYW1lIC0gbmFtZSBvZiBzY2hvb2xcbiAgICogQHBhcmFtIGNvdXJzZUNvZGUgLSBTa29sdmVya2V0cyBjb2RlIGZvciBjb3Vyc2VcbiAgICovXG4gIGFzeW5jIGdldFNjaG9vbFR1aXRpb25Hcm91cHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgY291cnNlQ29kZTogc3RyaW5nfSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJTY2hvb2xUdWl0aW9uR3JvdXBzXCIsIHsuLi50aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCksIC4uLnF9KTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc2Nob29sVHVpdGlvbkdyb3VwcyBhcyBFRFNUdWl0aW9uR3JvdXBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cygpXG4gICAqIFxuICAgKiBSZXR1cm4gbmFtZSBhbmQgbWFpbGFkcmVzc2VzIGZvciB0dXRpdGlvbmdyb3VwcyBpbiBzY2hvb2xzXG4gICAqIFxuICAgKiBAcGFyYW0gc2Nob29sTmFtZSAtIG5hbWUgb2Ygc2Nob29sXG4gICAqIEBwYXJhbSB0dWl0aW9uR3JvdXBOYW1lIC0gdHVpdGlvbiBncnVvcCBuYW1lIGluIEVEU1xuICAgKi9cbiAgYXN5bmMgZ2V0VHVpdGlvbkdyb3VwU3R1ZGVudHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgdHVpdGlvbkdyb3VwTmFtZTogc3RyaW5nfSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJUdWl0aW9uR3JvdXBTdHVkZW50c1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnR1aXRpb25Hcm91cFN0dWRlbnRzIGFzIEVEU1R1aXRpb25TdHVkZW50W107XG4gIH1cblxuICAvKipcbiAgICogZ2V0U2Nob29sVGVhY2hlcnMoKVxuICAgKiBcbiAgICogUmV0dXJuIG5hbWUgYW5kIG1haWxhZHJlc3NlcyBmb3IgdHV0aXRpb25ncm91cHMgaW4gc2Nob29sc1xuICAgKiBcbiAgICogQHBhcmFtIHNjaG9vbE5hbWUgLSBuYW1lIG9mIHNjaG9vbFxuICAgKi9cbiAgYXN5bmMgZ2V0U2Nob29sVGVhY2hlcnMocToge3NjaG9vbE5hbWU6IHN0cmluZ30pIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiU2Nob29sVGVhY2hlcnNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICByZXR1cm4ganNvbi5zY2hvb2xUZWFjaGVycyBhcyBFRFNUZWFjaGVyW107XG4gIH1cbiAgLy8gd2UgYXNzdW1lIHRoYXQgdGhlIEVEUyB3aWxsIHJldHVybiB0aGUgY3VycmVudCBhY2FkZW1pYyB5ZWFyIGRhdGVzIGRldGVybWluZWQgYnkgdGhlIGN1cnJlbnQgZGF0ZVxuICBhc3luYyBnZXRBY2FkZW1pY1llYXJUZXJtcyhzY2hvb2xMb2NhbGU6IHN0cmluZywgZGF0ZTogRGF0ZSkge1xuICAgIC8vIG1vY2sgZGF0YVxuICAgIHN3aXRjaCAoc2Nob29sTG9jYWxlKSB7XG4gICAgICBjYXNlICdlbl9zaW4nOlxuICAgICAgcmV0dXJuIG1vY2tKc29uRmlsZS5Tb3V0aEluZGlhLmZpbHRlcihmID0+IG1vbWVudChkYXRlKS5pc1NhbWVPckFmdGVyKGYuZmlyc3RUZXJtLnN0YXJ0RGF0ZSkgJiYgbW9tZW50KGRhdGUpLmlzU2FtZU9yQmVmb3JlKGYuc2Vjb25kVGVybS5lbmREYXRlKSlbMF0gYXMgTW9ja0VEU0FjYWRlbWljWWVhcjtcbiAgICAgIGNhc2UgJ2VuX25pbic6XG4gICAgICByZXR1cm4gbW9ja0pzb25GaWxlLk5vcnRoSW5kaWEuZmlsdGVyKGYgPT4gbW9tZW50KGRhdGUpLmlzU2FtZU9yQWZ0ZXIoZi5maXJzdFRlcm0uc3RhcnREYXRlKSAmJiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JCZWZvcmUoZi5zZWNvbmRUZXJtLmVuZERhdGUpKVswXSBhcyBNb2NrRURTQWNhZGVtaWNZZWFyO1xuICAgICAgY2FzZSAnc3YnOlxuICAgICAge1xuICAgICAgdmFyIGhvbGlkYXlzID0gW10gYXMgTW9ja0VEU0RhdGVSYW5nZVtdO1xuICAgICAgdmFyIGZpcnN0VGVybU1vbWVudCA9IGdldFRlcm1TdGFyRW5kRGF0ZShkYXRlLCB0cnVlKTtcbiAgICAgIHZhciBzZWNvbmRUZXJtTW9tZW50ID0gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGUsIGZhbHNlKTtcblxuICAgICAgdmFyIHN0YXJ0Rmlyc3RUZXJtRGF0ZSA9IGZpcnN0VGVybU1vbWVudFswXTtcbiAgICAgIHZhciBzdGFydFNlY29uZFRlcm1EYXRlID0gc2Vjb25kVGVybU1vbWVudFswXTtcbiAgICAgIHZhciBlbmRGaXJzdFRlcm1EYXRlID0gZmlyc3RUZXJtTW9tZW50WzFdO1xuICAgICAgdmFyIGVuZFNlY29uZFRlcm1EYXRlID0gc2Vjb25kVGVybU1vbWVudFsxXTtcblxuICAgICAgY29uc3QgZmlyc3RUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoc3RhcnRGaXJzdFRlcm1EYXRlLnllYXIoKSwgc3RhcnRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIHN0YXJ0Rmlyc3RUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShzdGFydEZpcnN0VGVybURhdGUueWVhcigpLCBlbmRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIGVuZEZpcnN0VGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XG4gICAgICBjb25zdCBzZWNvbmRUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoc3RhcnRTZWNvbmRUZXJtRGF0ZS55ZWFyKCksIHN0YXJ0U2Vjb25kVGVybURhdGUubW9udGgoKSwgc3RhcnRTZWNvbmRUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShzdGFydFNlY29uZFRlcm1EYXRlLnllYXIoKSwgZW5kU2Vjb25kVGVybURhdGUubW9udGgoKSwgZW5kU2Vjb25kVGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XG4gICAgICByZXR1cm4ge2ZpcnN0VGVybSwgc2Vjb25kVGVybSwgaG9saWRheXN9O1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5cblxuZXhwb3J0IGNsYXNzIEVEU1BlcmlvZCB7XG4gIHBlcmlvZDogc3RyaW5nO1xuICB0ZXJtOiAnQVQnIHwgJ1NUJztcbiAgeWVhcjogbnVtYmVyO1xuICBjb25zdHJ1Y3RvciAocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtOiBzdHJpbmcgfCBTY2hvb2xNb21lbnQpIHtcbiAgICBpZiAodHlwZW9mIHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMucGVyaW9kID0gcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtO1xuICAgICAgdGhpcy50ZXJtID0gdGhpcy5wZXJpb2Quc3RhcnRzV2l0aCgnSFQnKSA/ICdBVCcgOiAnU1QnO1xuICAgICAgdGhpcy55ZWFyID0gcGFyc2VJbnQodGhpcy5wZXJpb2Quc3Vic3RyKDIpKTtcbiAgICAgIGlmIChpc05hTih0aGlzLnllYXIpKSB0aHJvdyBuZXcgRXJyb3IgKGBJbnZhbGlkIHBlcmlvZDogJHt0aGlzLnBlcmlvZH1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2Nob29sVGVybSA9IG5ldyBTY2hvb2xUZXJtKHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSk7XG4gICAgICB0aGlzLnBlcmlvZCA9IChzY2hvb2xUZXJtLnRlcm0gPT09ICdBVCcgPyBcIkhUXCIgOiBcIlZUXCIpICsgc2Nob29sVGVybS55ZWFyO1xuICAgICAgdGhpcy50ZXJtID0gc2Nob29sVGVybS50ZXJtO1xuICAgICAgdGhpcy55ZWFyID0gc2Nob29sVGVybS55ZWFyO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzY2hvb2xUZXJtICgpIDogU2Nob29sVGVybSB7XG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHtcbiAgICAgIGFjYWRlbWljWWVhcjogdGhpcy50ZXJtID09PSAnQVQnID9cbiAgICAgICAgYCR7dGhpcy55ZWFyfS8ke3RoaXMueWVhciArIDF9YCA6XG4gICAgICAgIGAke3RoaXMueWVhci0xfS8ke3RoaXMueWVhcn1gLFxuICAgICAgdGVybTogdGhpcy50ZXJtXG4gICAgfSk7XG4gIH1cblxuICB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5wZXJpb2Q7XG4gIH1cblxuICB2YWx1ZU9mKCkge1xuICAgIHJldHVybiB0aGlzLnllYXIgKyBcIjpcIiArICh0aGlzLnRlcm0gPT09ICdTVCcgPyBcIjFcIiA6IFwiMlwiKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uRGF0ZV9vbGQgKGpzb25EYXRlU3RyOiBzdHJpbmcpIDogRGF0ZSB7XG4gIGNvbnN0IGRhdGUgPSBkYXRlVGltZVJldml2ZXIoXCJcIiwganNvbkRhdGVTdHIpO1xuICBpZiAoIShkYXRlIGluc3RhbmNlb2YgRGF0ZSkpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgSlNPTiBkYXRlIHN0cmluZzogXCIgKyBqc29uRGF0ZVN0cik7XG4gIHJldHVybiBkYXRlO1xufVxuXG5mdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHM8VCxBPihtZXRob2Q6ICguLi5hcmdzOkFbXSk9PlByb21pc2U8VD4pIDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPiB7XG4gIGxldCBvbmdvaW5nUHJvbWlzZXM6IHtbYXJnc0pzb246IHN0cmluZ106IFByb21pc2U8VD59ID0ge307XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBhcmdzSnNvbiA9IEpTT04uc3RyaW5naWZ5KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG4gICAgaWYgKCFvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dKSB7XG4gICAgICBvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dID0gbWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihyZXN1bHQ9PntcbiAgICAgICAgZGVsZXRlIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgICBudW1iZXJPZlRhc2tzOiBudW1iZXI7XG4gICAgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogbnVtYmVyO1xuICAgIG1heGltdW1UYXNrc0Rpc3BsYXllZD86IG51bWJlcjtcbiAgICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmc7XG4gICAgcHJvZ3Jlc3NDb2xvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEdvYWxQcm9ncmVzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICAgIHB1YmxpYyBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBudW1iZXJvZlRhc2tzOiAwLFxuICAgICAgICBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiAwLFxuICAgICAgICBtYXhpbXVtVGFza3NEaXNwbGF5ZWQ6IDEwLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwibGlnaHRncmV5XCIsXG4gICAgICAgIHByb2dyZXNzQ29sb3I6IFwiIzNkYmNhMlwiLFxuICAgIH07XG5cbiAgICBjcmVhdGVQcm9ncmVzcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyBudW1iZXJPZlRhc2tzLCBjb21wbGV0ZWROdW1iZXJPZlRhc2tzLCBtYXhpbXVtVGFza3NEaXNwbGF5ZWQsIGJhY2tncm91bmRDb2xvciwgcHJvZ3Jlc3NDb2xvciB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgbGV0IHByb2dyZXNzID0gW107XG4gICAgICAgIGlmKG51bWJlck9mVGFza3MgPiBtYXhpbXVtVGFza3NEaXNwbGF5ZWQpe1xuICAgICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJwcm9ncmVzcy1vdmVydmlld1wiPiB7Y29tcGxldGVkTnVtYmVyT2ZUYXNrc30gLyB7bnVtYmVyT2ZUYXNrc30gPC9kaXY+O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgdGFza05vID0gMTsgdGFza05vIDw9IG51bWJlck9mVGFza3M7IHRhc2tObysrKSB7XG4gICAgICAgICAgICBwcm9ncmVzcy5wdXNoKFxuICAgICAgICAgICAgPHN2ZyBrZXk9e3Rhc2tOb30+XG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzc05hbWU9XCJjaXJjbGUtY2hhcnQtYmFja2dyb3VuZFwiIGZpbGw9e3Rhc2tObyA+IGNvbXBsZXRlZE51bWJlck9mVGFza3MgPyBiYWNrZ3JvdW5kQ29sb3IgOiBwcm9ncmVzc0NvbG9yfSBjeD1cIjhcIiBjeT1cIjhcIiByPVwiOFwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2dyZXNzO1xuICAgIH1cblxuICAgIHJlbmRlcigpeyAgXG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImdvYWxzLXByb2dyZXNzXCI+e3RoaXMuY3JlYXRlUHJvZ3Jlc3MoKX08L2Rpdj5cbiAgICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MsIEJhdGNoUnVubmVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgZGIsIGdsb2JhbElkLCBTY2hvb2xzIH0gZnJvbSAnLi4vLi4vLi4vLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyB3aXRoUm91dGVyLCBSb3V0ZVByb3BzLCBSb3V0ZUNvbXBvbmVudFByb3BzIH0gZnJvbSAncmVhY3Qtcm91dGVyJztcbmltcG9ydCB7IEJyYW5jaCwgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IExhenlDb250ZW50IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2xhenktY29udGVudCc7XG5pbXBvcnQgeyBnZXRTdWJqZWN0Q29kZXMsIGNvbXB1dGVUYWdzRnJvbVN1YmplY3RDb2RlcyB9IGZyb20gJy4uLy4uL2xvZ2ljL2NvdXJzZS1pbnN0YW5jZS10YWdzJztcblxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgUm91dGVDb21wb25lbnRQcm9wczxhbnk+e1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBjb3Vyc2VOYW1lOiBzdHJpbmc7XG4gIGNvdXJzZVR5cGU6ICd0aGVtZS1jb3Vyc2UnIHwgJ3N0ZXAtY291cnNlJztcbiAgc3ViamVjdDoge3N1YmplY3ROYW1lOiBzdHJpbmcsIHN1YmplY3RDb2RlOiBzdHJpbmd9O1xufVxuXG5jbGFzcyBfQ3JlYXRlU3RhbmRhcmRDb3Vyc2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjb3Vyc2VOYW1lOiBcIlwiLFxuICAgICAgY291cnNlVHlwZTogJ3RoZW1lLWNvdXJzZScsXG4gICAgICBzdWJqZWN0OiB7c3ViamVjdE5hbWU6ICcnLCBzdWJqZWN0Q29kZTogJyd9XG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUNvdXJzZSgpIHtcbiAgICBjb25zdCB7IGNvdXJzZVR5cGU6IHR5cGUsIGNvdXJzZU5hbWU6IG5hbWUsIHN1YmplY3QgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgY291cnNlSWQgPSBjcmVhdGVVVUlEKCk7XG5cbiAgICBjb25zdCB7b2ZmaWNpYWxCcmFuY2hJZCwgaWQ6IHNjaG9vbElkfSA9IGF3YWl0IFNjaG9vbHMuc3RhbmRhcmRTY2hvb2wubG9hZCgpO1xuXG4gICAgZGIuYnJhbmNoZXMuYWRkUmVsYXRlZChvZmZpY2lhbEJyYW5jaElkLCBcImFwcHJvdmVkQ2hpbGRyZW5cIiwge1xuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgIG5hbWU6ICdkcmFmdCcsXG4gICAgICBhY2w6IFtcbiAgICAgICAgXCJyb2xlOlVTRVI6UlwiLFxuICAgICAgICBcInNjaG9vbFJvbGU6c3RhbmRhcmQvRU1QTE9ZRUU6U1wiXSxcbiAgICAgIHNjaG9vbElkLFxuICAgICAgdHJlZVBhcmVudElkOiBvZmZpY2lhbEJyYW5jaElkLFxuICAgICAgdGFnczogW2NvdXJzZUlkXSAvLyBBbGxvdyBmb2xsb3dpbmcgcXVlcmllczpcbiAgICAgICAgLy8gTGlzdCBhbGwgZHJhZnQgZm9yIGEgY2VydGFpbiBzY2hvb2w6IHtoYXNFZGdlc0Zyb209c2Nob29sQnJhbmNoSWQmdGFncz1jb3Vyc2VJZH1cbiAgICAgICAgLy8gR2V0IG9mZmljaWFsIGRyYWZ0IGZvciBhIGNlcnRhaW4gc2Nob29sOiB7aGFzRWRnZXNGcm9tPXNjaG9vbEJyYW5jaElkJm5hbWU9ZHJhZnQmdGFncz1jb3Vyc2VJZH1cbiAgICB9KTtcblxuICAgIGNvbnN0IGNvdXJzZVByb3BlcnRpZXMgPSB7XG4gICAgICBpZDogY291cnNlSWQsXG4gICAgICBhY2w6IFtcbiAgICAgICAgJ3NjaG9vbFJvbGU6c3RhbmRhcmQvRU1QTE9ZRUU6UycsXG4gICAgICAgICdyb2xlOlVTRVI6UidcbiAgICAgIF0sXG4gICAgICBuYW1lLFxuICAgICAgLy9kZXNjcmlwdGlvbjogdHlwZSA9PT0gJ3N0ZXAtY291cnNlJyA/IFwiU3RlZ2t1cnNcIiA6IFwiVGVhbWt1cnNcIixcbiAgICAgIHRhZ3M6IHR5cGUgPT09ICdzdGVwLWNvdXJzZScgP1xuICAgICAgICBjb21wdXRlVGFnc0Zyb21TdWJqZWN0Q29kZXMgKFtdLCBbc3ViamVjdC5zdWJqZWN0Q29kZV0pIDpcbiAgICAgICAgW10gXG4gICAgfTtcblxuICAgIGRiLmdsb2JhbC5hZGRSZWxhdGVkKGdsb2JhbElkLCBcImNvdXJzZUluc3RhbmNlc1wiLCB0eXBlID09PSAnc3RlcC1jb3Vyc2UnID8ge1xuICAgICAgLi4uY291cnNlUHJvcGVydGllcyxcbiAgICAgIHR5cGUsXG4gICAgICBkZXNjcmlwdGlvbjogTGBTdGVna3Vyc2AsXG4gICAgICBzdWJqZWN0XG4gICAgfSA6IHtcbiAgICAgIC4uLmNvdXJzZVByb3BlcnRpZXMsXG4gICAgICB0eXBlLFxuICAgICAgZGVzY3JpcHRpb246IExgVGVtYWt1cnNgLFxuICAgICAgc3ViamVjdHM6IFtdXG4gICAgfSk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjb3Vyc2VOYW1lOiAnJ1xuICAgIH0pO1xuICAgIGF3YWl0IGRiLnNhdmVOb3coKTtcbiAgICB0aGlzLnByb3BzLmhpc3RvcnkucHVzaChgL2FkbWluL2NvdXJzZXMvJHtjb3Vyc2VJZH0vc2V0dGluZ3NgKTtcbiAgfVxuXG4gIGlzVmFsaWRTdGF0ZShnaXZlTWVzc2FnZT86IGJvb2xlYW4pOiBib29sZWFuIHwgc3RyaW5nIHtcbiAgICBjb25zdCB7Y291cnNlTmFtZSwgY291cnNlVHlwZSwgc3ViamVjdH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHJ2ID0gY291cnNlTmFtZSAmJiBjb3Vyc2VUeXBlID09PSAndGhlbWUtY291cnNlJyB8fCBzdWJqZWN0LnN1YmplY3RDb2RlO1xuICAgIGlmICghcnYgJiYgZ2l2ZU1lc3NhZ2UpIHtcbiAgICAgIGlmICghY291cnNlTmFtZSkgcmV0dXJuIExgS3Vyc2VucyBuYW1uIG3DpXN0ZSBmeWxsYXMgaWA7XG4gICAgICBpZiAoIXN1YmplY3Quc3ViamVjdENvZGUpIHJldHVybiBMYMOEbW5lIG3DpXN0ZSB2w6RsamFzIGbDtnIgc3RlZ2t1cnNlcmA7XG4gICAgfVxuICAgIHJldHVybiBydjtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNvdXJzZU5hbWUsIGNvdXJzZVR5cGUsIHN1YmplY3QgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdj5cbiAgICAgICAgPGgyPlNrYXBhIG55IHN0YW5kYXJka3VyczwvaDI+XG4gICAgICAgIDxociAvPlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIE5hbW46IDxpbnB1dCB0eXBlPVwidGV4dFwiIHZhbHVlPXtjb3Vyc2VOYW1lfSBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IGNvdXJzZU5hbWU6IGV2LnRhcmdldC52YWx1ZSB9KX0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxiciAvPlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiY291cnNlLXR5cGVcIiBjaGVja2VkPXtjb3Vyc2VUeXBlID09PSAnc3RlcC1jb3Vyc2UnfSBvbkNoYW5nZT17ZXYgPT4gZXYudGFyZ2V0LmNoZWNrZWQgJiYgdGhpcy5zZXRTdGF0ZSh7IGNvdXJzZVR5cGU6ICdzdGVwLWNvdXJzZScgfSl9IC8+IFN0ZWdrdXJzXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDxiciAvPlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwicmFkaW9cIiBuYW1lPVwiY291cnNlLXR5cGVcIiBjaGVja2VkPXtjb3Vyc2VUeXBlID09PSAndGhlbWUtY291cnNlJ30gb25DaGFuZ2U9e2V2ID0+IGV2LnRhcmdldC5jaGVja2VkICYmIHRoaXMuc2V0U3RhdGUoeyBjb3Vyc2VUeXBlOiAndGhlbWUtY291cnNlJyB9KX0gLz4gVGVtYWt1cnNcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGJyIC8+XG4gICAgICAgIHtjb3Vyc2VUeXBlID09PSAnc3RlcC1jb3Vyc2UnID8gPD5cbiAgICAgICAgPGJyLz5cbiAgICAgICAgPGZvcm0+XG4gICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImtjbGFiZWxcIj57TGDDhG1uZWB9PC9sYWJlbD5cbiAgICAgICAgICA8TGF6eUNvbnRlbnQ+e2RiLnN1YmplY3RzLnRhZ3MoXCJzY2hvb2xUeXBlOnByaW1hcnlcIikudG9WYWx1ZSgpLm1hcChzdWJqZWN0cyA9PlxuICAgICAgICAgICAgPHNlbGVjdFxuICAgICAgICAgICAgICB2YWx1ZT17c3ViamVjdC5zdWJqZWN0Q29kZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3RzLmZpbHRlcihzID0+IHMuY29kZSA9PT0gZXYudGFyZ2V0LnZhbHVlKS5tYXAocyA9PiAoe1xuICAgICAgICAgICAgICAgICAgc3ViamVjdENvZGU6IHMuY29kZSxcbiAgICAgICAgICAgICAgICAgIHN1YmplY3ROYW1lOiBzLm5hbWVcbiAgICAgICAgICAgICAgICB9KSlbMF19KX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIlwiPntMYFbDpGxqIMOkbW5lYH08L29wdGlvbj5cbiAgICAgICAgICAgICAge3N1YmplY3RzLm1hcChzdWJqZWN0ID0+IDxvcHRpb24ga2V5PXtzdWJqZWN0LmNvZGV9IHZhbHVlPXtzdWJqZWN0LmNvZGV9PntzdWJqZWN0Lm5hbWV9PC9vcHRpb24+KX1cbiAgICAgICAgICAgIDwvc2VsZWN0PilcbiAgICAgICAgICB9PC9MYXp5Q29udGVudD5cbiAgICAgICAgPC9mb3JtPlxuXG4gICAgICAgIDwvPiA6IG51bGx9XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPGJ1dHRvbiBkaXNhYmxlZD17IXRoaXMuaXNWYWxpZFN0YXRlKCl9IGNsYXNzTmFtZT17W1wiYnRuXCIsIFwiYnRuLWxhcmdlXCIsIHRoaXMuaXNWYWxpZFN0YXRlKCkgPyBcIlwiIDogXCJkaXNhYmxlZFwiXS5qb2luKCcgJyl9IG9uQ2xpY2s9eygpID0+IHRoaXMuaXNWYWxpZFN0YXRlKCkgP1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVDb3Vyc2UoKSA6IGFsZXJ0KHRoaXMuaXNWYWxpZFN0YXRlKHRydWUpKX0+U2thcGE8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBDcmVhdGVTdGFuZGFyZENvdXJzZSA9IHdpdGhSb3V0ZXIoX0NyZWF0ZVN0YW5kYXJkQ291cnNlKTtcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGxpdmVRdWVyeVZpZXcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvbGl2ZS1xdWVyeS12aWV3JztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyB3aXRoUm91dGVyLCBSb3V0ZUNvbXBvbmVudFByb3BzIH0gZnJvbSAncmVhY3Qtcm91dGVyJztcbmltcG9ydCB7IENvdXJzZUluc3RhbmNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgTGluayB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uLy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgUm91dGVDb21wb25lbnRQcm9wczxhbnk+e1xuICBjb3Vyc2VJZDogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgRGVsZXRlU3RhbmRhcmRDb3Vyc2UgPSB3aXRoUm91dGVyKGxpdmVRdWVyeVZpZXcoKHtjb3Vyc2VJZCwgaGlzdG9yeX06IFByb3BzKSA9PlxuICBkYi5jb3Vyc2VJbnN0YW5jZXMuaWRzKFtjb3Vyc2VJZF0pLnRvVmFsdWUoKVxuICAgIC5jb21iaW5lTGF0ZXN0KGRiLmJyYW5jaGVzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKS5tYXAoKHtpZH0pPT5pZCkpXG4gICAgLmNvbWJpbmVMYXRlc3QoZGIuY291cnNlQmxvY2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKS5tYXAoKHtpZH0pPT5pZCkpXG4gICAgLmNvbWJpbmVMYXRlc3QoZGIuY291cnNlQ29udGVudHMudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpLm1hcCgoe2lkfSk9PmlkKSlcbiAgICAuY29tYmluZUxhdGVzdChkYi5jb3Vyc2VUYWJzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKS5tYXAoKHtpZH0pPT5pZCkpXG4gICAgLmNvbWJpbmVMYXRlc3QoZGIudGFza3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpLm1hcCgoe2lkfSk9PmlkKSlcbiAgICAubWFwKChbYSwgYl0pID0+ICh7XG4gICAgICBjb3Vyc2VzOiBhWzBdWzBdWzBdWzBdLFxuICAgICAgYnJhbmNoSWRzOiBhWzBdWzBdWzBdWzFdLFxuICAgICAgY291cnNlQmxvY2tJZHM6IGFbMF1bMF1bMV0sXG4gICAgICBjb3Vyc2VDb250ZW50SWRzOiBhWzBdWzFdLFxuICAgICAgY291cnNlVGFiSWRzOiBhWzFdLFxuICAgICAgdGFza0lkczogYn0pKVxuICAgIC5tYXAoKHtjb3Vyc2VzLCBicmFuY2hJZHMsIGNvdXJzZUJsb2NrSWRzLCBjb3Vyc2VDb250ZW50SWRzLCBjb3Vyc2VUYWJJZHMsIHRhc2tJZHN9KSA9PiB7XG4gICAgICBpZiAoY291cnNlcy5sZW5ndGggPT09IDApIHJldHVybiA8ZGl2PlxuICAgICAgICA8cD5LdXJzZW4gw6RyIG51IGJvcnR0YWdlbjwvcD5cbiAgICAgICAgPExpbmsgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZVwiIHRvPVwiL2FkbWluXCI+XG4gICAgICAgICAgVGlsbCBhZG1pbnZlcmt0eWdldHMgc3RhcnRzaWRhXG4gICAgICAgIDwvTGluaz5cbiAgICAgIDwvZGl2PjtcbiAgICAgIGNvbnN0IGNvdXJzZSA9IGNvdXJzZXNbMF07XG4gICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9e1tgZW50aXR5bWV0YS0ke2NvdXJzZS4kbWV0YX1gXS5qb2luKCcgJyl9PlxuICAgICAgICA8aDI+QmVrcsOkZnRhIGJvcnR0YWduaW5nIGF2IHN0YW5kYXJka3Vyc2VuIHtjb3Vyc2UubmFtZX0gPC9oMj5cbiAgICAgICAgPHA+RsO2bGphbmRlIHJlbGF0ZXJhZGUgb2JqZWt0IGtvbW1lciBvY2tzw6UgYXR0IHRhcyBib3J0PC9wPlxuICAgICAgICA8cD5UZW1wb3LDpHJhIHV0a2FzdDoge2JyYW5jaElkcy5sZW5ndGh9IHN0PC9wPlxuICAgICAgICA8cD5LdXJzYmxvY2s6IHtjb3Vyc2VCbG9ja0lkcy5sZW5ndGh9IHN0PC9wPlxuICAgICAgICA8cD5Jbm5laMOlbGxzcnV0b3IgKHRvdGFsdCBpbmtsdXNpdmUgc2tvbG9ycyBlZ25hIHZhcmlhbnRlcik6IHtjb3Vyc2VDb250ZW50SWRzLmxlbmd0aH0gc3Q8L3A+XG4gICAgICAgIDxwPkZsaWthciAodG90YWx0IGlua2x1c2l2ZSBza29sb3JzIGVnbmEgdmFyaWFudGVyKToge2NvdXJzZVRhYklkcy5sZW5ndGh9IHN0PC9wPlxuICAgICAgICA8cD5VcHBnaWZ0ZXIgKHRvdGFsdCBpbmtsdXNpdmUgc2tvbG9ycyBlZ25hIHZhcmlhbnRlcik6IHt0YXNrSWRzLmxlbmd0aH0gc3Q8L3A+XG5cbiAgICAgICAgPGEgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZVwiIG9uQ2xpY2s9eygpPT5oaXN0b3J5LmdvKC0xKX0+XG4gICAgICAgICAgQXZicnl0XG4gICAgICAgIDwvYT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXsoKT0+e1xuICAgICAgICAgIC8vIERlbGV0ZSBhbGwgZHJhZnQgaWRzLlxuICAgICAgICAgIGRiLmJyYW5jaGVzLmRlbGV0ZSguLi5icmFuY2hJZHMpO1xuICAgICAgICAgIC8vIERlbGV0ZSBhbGwgZGVzY2VuZGFudCBpZHM6XG4gICAgICAgICAgZGIuY291cnNlQmxvY2tzLmRlbGV0ZSguLi5jb3Vyc2VCbG9ja0lkcyk7XG4gICAgICAgICAgZGIuY291cnNlQ29udGVudHMuZGVsZXRlKC4uLmNvdXJzZUNvbnRlbnRJZHMpO1xuICAgICAgICAgIGRiLmNvdXJzZVRhYnMuZGVsZXRlKC4uLmNvdXJzZVRhYklkcyk7XG4gICAgICAgICAgZGIudGFza3MuZGVsZXRlKC4uLnRhc2tJZHMpO1xuICAgICAgICAgIC8vIERlbGV0ZSB0aGUgY291cnNlIGl0c2VsZlxuICAgICAgICAgIGRiLmNvdXJzZUluc3RhbmNlcy5kZWxldGUoY291cnNlLmlkKTtcbiAgICAgICAgfX1cbiAgICAgICAgPkJla3LDpGZ0YSBib3J0dGFnbmluZyBhdiBrdXJzPC9kaXY+XG5cbiAgICAgIDwvZGl2PlxuICAgIH0pXG4gICx7XG4gICAgc3Bpbm5lcjogPHA+SMOkbXRhciByZWxhdGVyYWRlIG9iamVrdC4uLiA8U3Bpbm5lciAvPjwvcD5cbiAgfVxuKSk7IiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEtlZEJhY2tlbmRSZXBvLCBXaXRoR3JhcGhzLCBTdHJpcEdyYXBocyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5pbXBvcnQgeyBUYXNrLCBUaGVtZUNvdXJzZVRhYiwgQ291cnNlVGFiLCBDb3Vyc2VCbG9jaywgQ291cnNlSW5zdGFuY2UsIFN0ZXBDb3Vyc2VJbnN0YW5jZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IEtub3dsZWRnZU1hdHJpeCB9IGZyb20gJy4uLy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL2tub3dsZWRnZS1tYXRyaXgnO1xuaW1wb3J0IHsgTGF6eUNvbnRlbnQgfSBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvbGF6eS1jb250ZW50JztcbmltcG9ydCB7IGdldENvdXJzZUNvZGVzRnJvbVRhZ3MgfSBmcm9tICcuLi8uLi9sb2dpYy9nZXQtY291cnNlLWNvZGVzLWZyb20tdGFncyc7XG5pbXBvcnQgeyBMLCBzaG93RXJyb3IsIGZsYXR0ZW4gfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBnZXRTdGFuZGFyZENvdXJzZXNXaXRoT3JkZXJlZFJlcXVpcmVtZW50cyB9IGZyb20gJy4uLy4uL2xvZ2ljL2dldC1zdGFuZGFyZC1jb3Vyc2VzLXdpdGgtb3JkZXJlZC1yZXF1aXJlbWVudHMnO1xuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcbmltcG9ydCB7IFNlbGVjdFJlbGF0ZWREb2NzIH0gZnJvbSAnLi4vLi4vLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc2VsZWN0LXJlbGF0ZWQtZG9jcyc7XG5pbXBvcnQgeyBsaXZlUXVlcnlWaWV3IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2xpdmUtcXVlcnktdmlldyc7XG5pbXBvcnQgeyBnZXRJZHNOb3RDb3ZlcmVkQnlSZXFSZWZlcmVuY2luZ0RvY3MgfSBmcm9tICcuLi8uLi8uLi9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2J1c2luZXNzLWxvZ2ljJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgcmVwbzogS2VkQmFja2VuZFJlcG9cbiAgY291cnNlOiBTdGVwQ291cnNlSW5zdGFuY2VcbiAgYmxvY2s6IFN0cmlwR3JhcGhzPENvdXJzZUJsb2NrPlxufVxuXG5leHBvcnQgY29uc3QgQ291cnNlQmxvY2tSZXF1aXJlbWVudHMgPSBsaXZlUXVlcnlWaWV3KCh7XG4gIHJlcG8sXG4gIGNvdXJzZSxcbiAgYmxvY2tcbn06IFByb3BzKSA9PiB7XG4gIGNvbnN0IGNvdXJzZUNvZGVzID0gZ2V0Q291cnNlQ29kZXNGcm9tVGFncyhibG9jay50YWdzKTtcbiAgY29uc3QgY291cnNlQ29kZVRhZ3MgPSBjb3Vyc2VDb2Rlcy5tYXAoY29kZSA9PiBcImNvdXJzZTpcIiArIGNvZGUpO1xuICByZXR1cm4gZ2V0U3RhbmRhcmRDb3Vyc2VzV2l0aE9yZGVyZWRSZXF1aXJlbWVudHMoY291cnNlQ29kZXMpXG4gICAgLmNvbWJpbmVMYXRlc3QoXG4gICAgICByZXBvLmNvdXJzZUJsb2Nrc1xuICAgICAgICAuaGFzRWRnZXNGcm9tKFtjb3Vyc2UuaWRdKSAvLyBTYW1lIHBhcmVudCBnaXZlIG1lIHNpYmxpbmcgYmxvY2tzIVxuICAgICAgICAudGFncyguLi5jb3Vyc2VDb2RlVGFncykgLy8gLi4udGFnZ2VkIHdpdGggc2FtZSBjb3Vyc2VDb2RlICg9IFwiMS0zXCIsIFwiNC02XCIsIGV0Yy4uLilcbiAgICAgICAgLmluY2x1ZGUoXCJhYmlsaXRpZXNcIiwgXCJjZW50cmFsQ29udGVudFwiLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiKVxuICAgICAgICAuaW5jbHVkZUlkc09ubHkoKSkgLy8gU28gd2UgY2FuIGRldGVjdCBub24tY292ZXJlZCByZXF1aXJlbWVudHNcbiAgICAubWFwKChbY291cnNlVGVtcGxhdGVzLCBzaWJsaW5nQmxvY2tzXSkgPT4ge1xuICAgICAgY29uc3QgdW5jb3ZlcmVkSWRzID0gZ2V0SWRzTm90Q292ZXJlZEJ5UmVxUmVmZXJlbmNpbmdEb2NzKGNvdXJzZVRlbXBsYXRlcywgc2libGluZ0Jsb2Nrcyk7XG4gICAgICBpZiAoY291cnNlVGVtcGxhdGVzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgcmV0dXJuIDxwPntMYEJsb2NrZXQgw6RyIGludGUga29wcGxhZCB0aWxsIG7DpWdvbiDDpXJza3Vyc2B9PC9wPjtcblxuICAgICAgcmV0dXJuIDxkaXY+XG4gICAgICAgIHtjb3Vyc2VUZW1wbGF0ZXMubWFwKCh7aWQsIG5hbWUsIGFiaWxpdGllcywgY2VudHJhbENvbnRlbnQsIGtub3dsZWRnZVJlcXVpcmVtZW50c30pID0+IDxkaXYga2V5PXtpZH0+XG4gICAgICAgICAge2NvdXJzZVRlbXBsYXRlcy5sZW5ndGggPT09IDEgPyB1bmRlZmluZWQgOiA8aDE+e25hbWV9PC9oMT59XG4gICAgICAgICAgICA8T3BlbkNsb3NlQm94IGNsYXNzTmFtZT1cImxhcmdlclwiIHRpdGxlPXs8cD57TGBWw6RsaiBibG9ja2V0cyBrdW5za2Fwc2tyYXZgfTwvcD59PlxuICAgICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICAgIHtMYE1hcmtlcmEgZGUga3Vuc2thcHNrcmF2IHNvbSBibG9ja2V0IHNrYSB0w6Rja2EuYH1cbiAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICA8TGF6eUNvbnRlbnQ+e1xuICAgICAgICAgICAgICAgIHJlcG9bXCJrbm93bGVkZ2UtcmVxdWlyZW1lbnRzXCJdLmhhc0VkZ2VzRnJvbShbYmxvY2suaWRdKS5pZHNPbmx5KCkudG9WYWx1ZSgpLm1hcChibG9ja0tycyA9PiB7ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgcmV0dXJuIDxLbm93bGVkZ2VNYXRyaXhcbiAgICAgICAgICAgICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzPXtrbm93bGVkZ2VSZXF1aXJlbWVudHN9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlZElkcz17YmxvY2tLcnMubWFwKCh7aWR9KSA9PiBpZCl9XG4gICAgICAgICAgICAgICAgICAgIGlkc1RvTWFya05vdE9rPXt1bmNvdmVyZWRJZHN9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtNb2RlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICBvbk1hcmtDaGFuZ2VkPXsobWFya2VkSWQ6IHN0cmluZywgaXNNYXJrZWQ6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgaW52YWxpZCBrbm93bGVkZ2UgcmVxdWlyZW1lbnRzICh0aG9zZSB0aGF0IGFyZSBub3QgcGFydCBvZiB0aGUgc3RhbmRhcmQgY291cnNlKVxuICAgICAgICAgICAgICAgICAgICAgIC8vIENhbiBoYXBwZW4gYWZ0ZXIgY2hhbmdpbmcgc2Nob29sIHllYXIgLyBjb3Vyc2Ugb3Igc3ViamVjdC5cbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnZhbGlkS3JzID0gYmxvY2tLcnMuZmlsdGVyKGtyID0+ICFrbm93bGVkZ2VSZXF1aXJlbWVudHMuc29tZSgoe2lkfSkgPT4ga3IuaWQgPT09IGlkKSk7XG4gICAgICAgICAgICAgICAgICAgICAgaW52YWxpZEtycy5mb3JFYWNoKGludmFsaWRLciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5yZW1vdmVSZWxhdGVkKGJsb2NrLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBpbnZhbGlkS3IpO1xuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hcmtlZERvYyA9IGtub3dsZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIoKHtpZH0pID0+IGlkID09PSBtYXJrZWRJZClbMF07XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTWFya2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5hZGRSZWxhdGVkKGJsb2NrLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBtYXJrZWREb2MpO1xuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5yZW1vdmVSZWxhdGVkKGJsb2NrLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBtYXJrZWREb2MpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgfSl9PC9MYXp5Q29udGVudD5cbiAgICAgICAgICAgIDwvT3BlbkNsb3NlQm94PlxuXG4gICAgICAgICAgICA8TGF6eUNvbnRlbnQ+e1xuICAgICAgICAgICAgICByZXBvLmFiaWxpdGllcy5oYXNFZGdlc0Zyb20oW2Jsb2NrLmlkXSkuaWRzT25seSgpLnRvVmFsdWUoKS5tYXAoYmxvY2tBYmlsaXRpZXMgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiA8U2VsZWN0UmVsYXRlZERvY3NcbiAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e2FiaWxpdGllc31cbiAgICAgICAgICAgICAgICAgIHRpdGxlPXtMYFbDpGxqIGJsb2NrZXRzIGbDtnJtw6Vnb3JgfVxuICAgICAgICAgICAgICAgICAgbWFya2VkSWRzPXtibG9ja0FiaWxpdGllcy5tYXAoKHtpZH0pID0+IGlkKX1cbiAgICAgICAgICAgICAgICAgIHVuY292ZXJlZElkcz17dW5jb3ZlcmVkSWRzfVxuICAgICAgICAgICAgICAgICAgbWFya01vZGU9e3RydWV9XG4gICAgICAgICAgICAgICAgICAvL21pZ3JhdGVkSWRzPXt0YXNrICYmIHRhc2subWlncmF0ZWRUZXh0cyAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMuYWJpbGl0aWVzfVxuICAgICAgICAgICAgICAgICAgb25NYXJrQ2hhbmdlZD17KG1hcmtlZElkLCBpc01hcmtlZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgaW52YWxpZCBhYmlsaXRpZXMgKHRob3NlIHRoYXQgYXJlIG5vdCBwYXJ0IG9mIHRoZSBzdGFuZGFyZCBjb3Vyc2UpXG4gICAgICAgICAgICAgICAgICAgIC8vIENhbiBoYXBwZW4gYWZ0ZXIgY2hhbmdpbmcgc2Nob29sIHllYXIgLyBjb3Vyc2Ugb3Igc3ViamVjdC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW52YWxpZEFiaWxpdGllcyA9IGJsb2NrQWJpbGl0aWVzLmZpbHRlcihhID0+ICFhYmlsaXRpZXMuc29tZSgoe2lkfSkgPT4gYS5pZCA9PT0gaWQpKTtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZEFiaWxpdGllcy5mb3JFYWNoKGludmFsaWRBYmlsaXR5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5yZW1vdmVSZWxhdGVkKGJsb2NrLmlkLCBcImFiaWxpdGllc1wiLCBpbnZhbGlkQWJpbGl0eSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJrZWREb2MgPSBhYmlsaXRpZXMuZmlsdGVyKCh7aWR9KSA9PiBpZCA9PT0gbWFya2VkSWQpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgIGlmIChpc01hcmtlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwby5jb3Vyc2VCbG9ja3MuYWRkUmVsYXRlZChibG9jay5pZCwgXCJhYmlsaXRpZXNcIiwgbWFya2VkRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwby5jb3Vyc2VCbG9ja3MucmVtb3ZlUmVsYXRlZChibG9jay5pZCwgXCJhYmlsaXRpZXNcIiwgbWFya2VkRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICB9KX08L0xhenlDb250ZW50PlxuXG4gICAgICAgICAgICA8TGF6eUNvbnRlbnQ+e1xuICAgICAgICAgICAgICByZXBvW1wiY2VudHJhbC1jb250ZW50XCJdLmhhc0VkZ2VzRnJvbShbYmxvY2suaWRdKS5pZHNPbmx5KCkudG9WYWx1ZSgpLm1hcChibG9ja0NDcyA9PiB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gPFNlbGVjdFJlbGF0ZWREb2NzXG4gICAgICAgICAgICAgICAgICBvcHRpb25zPXtjZW50cmFsQ29udGVudH1cbiAgICAgICAgICAgICAgICAgIHRpdGxlPXtMYFbDpGxqIGJsb2NrZXRzIGNlbnRyYWxhIGlubmVow6VsbGB9XG4gICAgICAgICAgICAgICAgICBtYXJrZWRJZHM9e2Jsb2NrQ0NzLm1hcChjYyA9PiBjYy5pZCl9XG4gICAgICAgICAgICAgICAgICB1bmNvdmVyZWRJZHM9e3VuY292ZXJlZElkc31cbiAgICAgICAgICAgICAgICAgIG1hcmtNb2RlPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgLy9taWdyYXRlZElkcz17dGFzayAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMgJiYgdGFzay5taWdyYXRlZFRleHRzLmNlbnRyYWxDb250ZW50fVxuICAgICAgICAgICAgICAgICAgb25NYXJrQ2hhbmdlZD17KG1hcmtlZElkLCBpc01hcmtlZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgaW52YWxpZCBjZW50cmFsIGNvbnRlbnRzICh0aG9zZSB0aGF0IGFyZSBub3QgcGFydCBvZiB0aGUgc3RhbmRhcmQgY291cnNlKVxuICAgICAgICAgICAgICAgICAgICAvLyBDYW4gaGFwcGVuIGFmdGVyIGNoYW5naW5nIHNjaG9vbCB5ZWFyIC8gY291cnNlIG9yIHN1YmplY3QuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGludmFsaWRDZW50cmFsQ29udGVudHMgPSBibG9ja0NDcy5maWx0ZXIoY2MgPT4gIWNlbnRyYWxDb250ZW50LnNvbWUoKHtpZH0pID0+IGNjLmlkID09PSBpZCkpO1xuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkQ2VudHJhbENvbnRlbnRzLmZvckVhY2goaW52YWxpZENDID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5yZW1vdmVSZWxhdGVkKGJsb2NrLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIGludmFsaWRDQyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJrZWREb2MgPSBjZW50cmFsQ29udGVudC5maWx0ZXIoKHtpZH0pID0+IGlkID09PSBtYXJrZWRJZClbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc01hcmtlZCkge1xuICAgICAgICAgICAgICAgICAgICAgIHJlcG8uY291cnNlQmxvY2tzLmFkZFJlbGF0ZWQoYmxvY2suaWQsIFwiY2VudHJhbENvbnRlbnRcIiwgbWFya2VkRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXBvLmNvdXJzZUJsb2Nrcy5yZW1vdmVSZWxhdGVkKGJsb2NrLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIG1hcmtlZERvYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgLz4gIFxuICAgICAgICAgICAgICB9KX08L0xhenlDb250ZW50PlxuXG4gICAgICAgIDwvZGl2Pil9XG4gICAgICA8L2Rpdj47XG59KX0pXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgV2l0aEdyYXBocywgS2VkQmFja2VuZFJlcG8gfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xuaW1wb3J0IHsgU3RlcENvdXJzZUluc3RhbmNlLCBDb3Vyc2VCbG9jaywgU3RlcENvdXJzZVRhYiB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGNvbXBhcmVQcm9wLCBMIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzIH0gZnJvbSAnLi4vLi4vLi4vY291cnNlLWJ1aWxkZXIvdXRpbHMnO1xuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uLy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcbmltcG9ydCB7IGdldFNjaG9vbFllYXJzLCBjb21wdXRlVGFnc0Zyb21TY2hvb2xZZWFycywgY29tcHV0ZVRhZ3NGcm9tU3ViamVjdENvZGVzLCBnZXRTdWJqZWN0Q29kZXMgfSBmcm9tICcuLi8uLi9sb2dpYy9jb3Vyc2UtaW5zdGFuY2UtdGFncyc7XG5pbXBvcnQgeyBDb3Vyc2VCbG9ja1JlcXVpcmVtZW50cyB9IGZyb20gJy4vZWRpdC1jb3Vyc2UtYmxvY2stcmVxdWlyZW1lbnRzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgcmVwbzogS2VkQmFja2VuZFJlcG9cbiAgY291cnNlOiBXaXRoR3JhcGhzPFN0ZXBDb3Vyc2VJbnN0YW5jZSwgXCJibG9ja3NcIj5cbn1cblxuZXhwb3J0IGNvbnN0IEVkaXRTdGFuZGFyZENvdXJzZUJsb2NrcyA9ICh7cmVwbywgY291cnNlfTogUHJvcHMpID0+IDxkaXY+XG4gIDxsYWJlbCBjbGFzc05hbWU9XCJrY2xhYmVsXCI+e0xgS3Vyc2Jsb2NrYH08L2xhYmVsPlxuICB7Y291cnNlLmJsb2Nrcy5zb3J0KGNvbXBhcmVQcm9wKFwiYmxvY2tOb1wiKSkubWFwKChibG9jaywgaWR4KSA9PlxuICAgIDxDb3Vyc2VCbG9ja1NldHRpbmdzXG4gICAgICBrZXk9e2Jsb2NrLmlkfVxuICAgICAgYmxvY2s9e2Jsb2NrfVxuICAgICAgY291cnNlPXtjb3Vyc2V9XG4gICAgICByZXBvPXtyZXBvfVxuICAgICAgaXNMYXN0QmxvY2s9e2lkeCA9PT0gY291cnNlLmJsb2Nrcy5sZW5ndGggLSAxfVxuICAgIC8+KX1cbiAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIlxuICAgIG9uQ2xpY2s9eygpPT5hZGRDb3Vyc2VCbG9jayhyZXBvLCBjb3Vyc2UpfVxuICA+XG4gICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtcGx1c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIC8+IHtMYEzDpGdnIHRpbGwgYmxvY2tgfVxuICA8L2J1dHRvbj5cbiAgPGJyLz5cbjwvZGl2PlxuXG5leHBvcnQgY29uc3QgQ291cnNlQmxvY2tTZXR0aW5ncyA9ICh7YmxvY2ssIGNvdXJzZSwgcmVwbywgaXNMYXN0QmxvY2t9OiBQcm9wcyAmIHtibG9jazogQ291cnNlQmxvY2ssIGlzTGFzdEJsb2NrOiBib29sZWFufSkgPT4gPD5cbiAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIiBzdHlsZT17e3Bvc2l0aW9uOiBcInJlbGF0aXZlXCJ9fT5cbiAgICA8aDQ+QmxvY2sge2Jsb2NrLmJsb2NrTm99PC9oND5cbiAgICB7TGBTdGVnYH0gPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cbiAgICAgIHtibG9jay5zdGVwTnVtYmVycy5tYXAoc3RlcE5vID0+XG4gICAgICAgIDxhIGtleT17c3RlcE5vfSBjbGFzc05hbWU9XCJidG4gYnRuLXNtYWxsIHN0ZXAtYnV0dG9uXCI+e3N0ZXBOb308L2E+KX1cbiAgICA8L2Rpdj5cbiAgICA8Zm9ybT5cbiAgICAgIDxsYWJlbCBjbGFzc05hbWU9XCJrY2xhYmVsXCI+e0xgw4Vyc2t1cnNgfTwvbGFiZWw+XG4gICAgICA8c2VsZWN0IHZhbHVlPXtnZXRTY2hvb2xZZWFycyhibG9jay50YWdzKVswXSB8fCBcIlwifVxuICAgICAgICBvbkNoYW5nZT17ZXYgPT4gcmVwby5jb3Vyc2VCbG9ja3MudXBkYXRlKGJsb2NrLCB7XG4gICAgICAgICAgdGFnczogY29tcHV0ZVRhZ3NGcm9tU2Nob29sWWVhcnMoYmxvY2sudGFncywgW2V2LnRhcmdldC52YWx1ZV0uZmlsdGVyKHg9PiEheCkpXG4gICAgICAgIH0pfVxuICAgICAgPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiXCI+e0xgVsOkbGogw6Vyc2t1cnNlcmB9PC9vcHRpb24+XG4gICAgICAgIDxvcHRpb24gdmFsdWU9XCIxLTNcIj57TGDDhXJza3VycyAxLTNgfTwvb3B0aW9uPlxuICAgICAgICA8b3B0aW9uIHZhbHVlPVwiNC02XCI+e0xgw4Vyc2t1cnMgNC02YH08L29wdGlvbj5cbiAgICAgICAgPG9wdGlvbiB2YWx1ZT1cIjctOVwiPntMYMOFcnNrdXJzIDctOWB9PC9vcHRpb24+XG4gICAgICA8L3NlbGVjdD5cbiAgICA8L2Zvcm0+XG4gICAgPGJyLz5cbiAgICB7Z2V0U2Nob29sWWVhcnMoYmxvY2sudGFncykubGVuZ3RoID4gMCA/XG4gICAgICA8Q291cnNlQmxvY2tSZXF1aXJlbWVudHNcbiAgICAgICAgYmxvY2s9e2Jsb2NrfVxuICAgICAgICBjb3Vyc2U9e2NvdXJzZX1cbiAgICAgICAgcmVwbz17cmVwb31cbiAgICAgIC8+IDpcbiAgICAgIHVuZGVmaW5lZFxuICAgIH1cbiAgICBcbiAgICB7aXNMYXN0QmxvY2sgPyA8UmVtb3ZlSXRlbVxuICAgICAgICAgIHRpdGxlPVwiVGEgYm9ydCBibG9ja2V0XCJcbiAgICAgICAgICBzdHlsZT17eyBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJywgcG9zaXRpb246IFwiYWJzb2x1dGVcIiwgdG9wOiAwLCByaWdodDogMCB9fVxuICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGNvbmZpcm0oTGBUYSBib3J0IGJsb2NrZXQ/YCkgJiZcbiAgICAgICAgICAgIHJlcG8uY291cnNlSW5zdGFuY2VzLnJlbW92ZVJlbGF0ZWQoY291cnNlLmlkLCBcImJsb2Nrc1wiLCBibG9jayl9IC8+XG4gICAgICAgICAgOiBudWxsfVxuXG4gIDwvZGl2PlxuICA8aHIvPlxuPC8+XG5cbmZ1bmN0aW9uIGFkZENvdXJzZUJsb2NrKHJlcG86IEtlZEJhY2tlbmRSZXBvLCBjb3Vyc2U6IFdpdGhHcmFwaHM8U3RlcENvdXJzZUluc3RhbmNlLCBcImJsb2Nrc1wiPikge1xuICBjb25zdCBsYXN0QmxvY2sgPSBjb3Vyc2UuYmxvY2tzLnNvcnQoY29tcGFyZVByb3AoXCJibG9ja05vXCIpKS5zbGljZSgpLnBvcCgpO1xuICBjb25zdCBibG9ja05vID0gbGFzdEJsb2NrID8gbGFzdEJsb2NrLmJsb2NrTm8gKyAxIDogMTtcbiAgY29uc3QgZmlyc3RTdGVwTm8gPSBsYXN0QmxvY2sgP1xuICAgIGxhc3RCbG9jay5zdGVwTnVtYmVyc1tsYXN0QmxvY2suc3RlcE51bWJlcnMubGVuZ3RoIC0gMV0gKyAxIDpcbiAgICAxO1xuICBjb25zdCBuZXdCbG9jazogQ291cnNlQmxvY2sgPSB7XG4gICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICBhY2w6IFtcbiAgICAgICdzY2hvb2xSb2xlOnN0YW5kYXJkL0VNUExPWUVFOlMnLFxuICAgICAgJ3JvbGU6VVNFUjpSJ1xuICAgIF0sXG4gICAgYmxvY2tObyxcbiAgICBsb2NrZWQ6IHRydWUsXG4gICAgbmFtZTogYEJsb2NrICR7YmxvY2tOb31gLFxuICAgIHRhZ3M6IFtjb3Vyc2UuaWQsIC4uLmNvdXJzZS50YWdzLmZpbHRlcih0YWcgPT4gdGFnLnN0YXJ0c1dpdGgoXCJjb3Vyc2U6XCIpIHx8IHRhZy5zdGFydHNXaXRoKFwic3ViOlwiKSldLFxuICAgIHN0ZXBOdW1iZXJzOiBbZmlyc3RTdGVwTm8sIGZpcnN0U3RlcE5vICsgMSwgZmlyc3RTdGVwTm8gKyAyLCBmaXJzdFN0ZXBObyArIDMsIGZpcnN0U3RlcE5vICsgNF1cbiAgfTtcbiAgcmVwby5jb3Vyc2VJbnN0YW5jZXMuYWRkUmVsYXRlZChjb3Vyc2UuaWQsIFwiYmxvY2tzXCIsIG5ld0Jsb2NrKTtcbiAgbmV3QmxvY2suc3RlcE51bWJlcnMuZm9yRWFjaChzdGVwTm8gPT4ge1xuICAgIGNvbnN0IGludHJvZHVjdGlvblRhYjogU3RlcENvdXJzZVRhYiA9IHtcbiAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICB0eXBlOiAnc3RlcC1jb3Vyc2UtdGFiJyxcbiAgICAgIHRhYkNsYXNzOiAnaW50cm8tdGFiJyxcbiAgICAgIHRhYlRpdGxlOiBMYEludHJvZHVrdGlvbmAsIC8vIERlcHJlY2F0ZWQuIFVzZSBuYW1lIGluc3RlYWQuXG4gICAgICBuYW1lOiBMYEludHJvZHVrdGlvbmAsXG4gICAgICBsb2NrZWQ6IHRydWUsXG4gICAgICBhY2w6IFtcbiAgICAgICAgJ3NjaG9vbFJvbGU6c3RhbmRhcmQvRU1QTE9ZRUU6UycsXG4gICAgICAgICdyb2xlOlVTRVI6UidcbiAgICAgIF0sXG4gICAgICBzdGVwTm8sXG4gICAgICBvcmRlcjogMCxcbiAgICAgIHRhZ3M6IFtjb3Vyc2UuaWQsIC4uLmNvdXJzZS50YWdzLmZpbHRlcih0YWcgPT4gdGFnLnN0YXJ0c1dpdGgoXCJjb3Vyc2U6XCIpIHx8IHRhZy5zdGFydHNXaXRoKFwic3ViOlwiKSldXG4gICAgfTtcbiAgICByZXBvLmNvdXJzZUJsb2Nrcy5hZGRSZWxhdGVkKG5ld0Jsb2NrLmlkLCBcInRhYnNcIiwgaW50cm9kdWN0aW9uVGFiKTtcbiAgfSk7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IGRiLCBnbG9iYWxJZCwgQ291cnNlSW5zdGFuY2VzLCBTY2hvb2xzIH0gZnJvbSAnLi4vLi4vLi4vLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyBDb3Vyc2VJbnN0YW5jZSwgVGhlbWVDb3Vyc2VJbnN0YW5jZSwgU3RlcENvdXJzZUluc3RhbmNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XG5pbXBvcnQgeyBUZXh0QXJlYUZvcm1GaWVsZCB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHRhcmVhJztcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkJztcbmltcG9ydCB7IEwsIHNob3dFcnJvciwgZGlzdGluY3QsIGZsYXR0ZW4gfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBMaW5rLCB3aXRoUm91dGVyLCBSb3V0ZUNvbXBvbmVudFByb3BzIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBsaXZlUXVlcnlWaWV3IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2xpdmUtcXVlcnktdmlldyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUmVwbywgV2l0aEdyYXBocyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5pbXBvcnQgeyBwdWJsaXNoQ291cnNlIH0gZnJvbSAnLi4vLi4vbG9naWMvcHVibGlzaC1jb3Vyc2UnO1xuaW1wb3J0IHsgTXVsdGlzZWxlY3QgfSBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvbXVsdGlzZWxlY3QnO1xuaW1wb3J0IHsgQ2hlY2tsaXN0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2NoZWNrbGlzdCc7XG5pbXBvcnQgeyBnZXRTdWJqZWN0Q29kZXMsIGNvbXB1dGVUYWdzRnJvbVN1YmplY3RDb2RlcywgZ2V0U2Nob29sWWVhcnMsIGNvbXB1dGVUYWdzRnJvbVNjaG9vbFllYXJzIH0gZnJvbSAnLi4vLi4vbG9naWMvY291cnNlLWluc3RhbmNlLXRhZ3MnO1xuaW1wb3J0IHsgRWRpdFN0YW5kYXJkQ291cnNlQmxvY2tzIH0gZnJvbSAnLi9lZGl0LXN0YW5kYXJkLWNvdXJzZS1ibG9ja3MnO1xuaW1wb3J0IGNmZyBmcm9tICcuLi8uLi8uLi8uLi9nbG9iYWxzL0tFRC5jZmcnO1xuaW1wb3J0IHsgcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgfSBmcm9tICcuLi8uLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5cbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIFJvdXRlQ29tcG9uZW50UHJvcHM8YW55PiB7XG4gIGNvdXJzZUlkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBFZGl0U3RhbmRhcmRDb3Vyc2UgPSB3aXRoUm91dGVyKGxpdmVRdWVyeVZpZXcoKHtjb3Vyc2VJZCwgaGlzdG9yeX06IFByb3BzKSA9PlxuICBDb3Vyc2VJbnN0YW5jZXMuZ2V0T3JDcmVhdGVCcmFuY2hJZChTY2hvb2xzLnN0YW5kYXJkU2Nob29sLCBjb3Vyc2VJZClcbiAgLm1hcChicmFuY2hJZCA9PmRiLmJyYW5jaChicmFuY2hJZCkpXG4gIC5zd2l0Y2hNYXAoYnJhbmNoID0+XG4gICAgYnJhbmNoLmNvdXJzZUluc3RhbmNlcy5pbmNsdWRlKFwiYmxvY2tzXCIpLmlkKGNvdXJzZUlkKS5tYXAoY291cnNlID0+IDw+XG4gICAgICA8VGV4dElucHV0XG4gICAgICAgIGF1dG9Gb2N1c1xuICAgICAgICBsYWJlbD1cIk5hbW5cIlxuICAgICAgICBpZD1cIkNvdXJzZUluc3RhbmNlOm5hbWVcIlxuICAgICAgICBwbGFjZWhvbGRlcj1cIlwiXG4gICAgICAgIHZhbHVlPXtjb3Vyc2UubmFtZX1cbiAgICAgICAgb25DaGFuZ2U9e25hbWUgPT4gYnJhbmNoLmNvdXJzZUluc3RhbmNlcy51cGRhdGUoY291cnNlLCB7bmFtZX0pfVxuICAgICAgLz5cbiAgICAgIDxUZXh0QXJlYUZvcm1GaWVsZFxuICAgICAgICBsYWJlbD1cIkJlc2tyaXZuaW5nXCJcbiAgICAgICAgaWQ9XCJDb3Vyc2VJbnN0YW5jZTpkZXNjcmlwdGlvblwiXG4gICAgICAgIHJvd3M9ezd9XG4gICAgICAgIHBsYWNlaG9sZGVyPVwiXCJcbiAgICAgICAgdmFsdWU9e2NvdXJzZS5kZXNjcmlwdGlvbn1cbiAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uID0+IHtcbiAgICAgICAgICBicmFuY2guY291cnNlSW5zdGFuY2VzLnVwZGF0ZShjb3Vyc2UsIHtkZXNjcmlwdGlvbn0pO1xuICAgICAgICB9fVxuICAgICAgICAgIC8+XG4gICAgICA8Rm9ybUZpZWxkIGxhYmVsPVwiVHlwXCIgaWQ9XCJDb3Vyc2VJbnN0YW5jZTp0eXBlXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICA8aW5wdXQgZGlzYWJsZWQgdHlwZT1cInJhZGlvXCIgbmFtZT1cImNvdXJzZS10eXBlXCIgY2hlY2tlZD17Y291cnNlLnR5cGUgPT09ICdzdGVwLWNvdXJzZSd9IGlkPVwiQ291cnNlSW5zdGFuY2U6dHlwZVwiIG9uQ2hhbmdlPXtcbiAgICAgICAgICAgICAgZXYgPT4gZXYudGFyZ2V0LmNoZWNrZWQgJiYgYnJhbmNoLmNvdXJzZUluc3RhbmNlcy51cGRhdGUoY291cnNlLCB7dHlwZTogJ3N0ZXAtY291cnNlJ30pfSAvPiBTdGVna3Vyc1xuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxuICAgICAgICAgICAgPGlucHV0IGRpc2FibGVkIHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJjb3Vyc2UtdHlwZVwiIGNoZWNrZWQ9e2NvdXJzZS50eXBlID09PSAndGhlbWUtY291cnNlJ30gaWQ9XCJDb3Vyc2VJbnN0YW5jZTp0eXBlXCIgb25DaGFuZ2U9e1xuICAgICAgICAgICAgICBldiA9PiBldi50YXJnZXQuY2hlY2tlZCAmJiBicmFuY2guY291cnNlSW5zdGFuY2VzLnVwZGF0ZShjb3Vyc2UsIHt0eXBlOiAndGhlbWUtY291cnNlJ30pfSAvPiBUZW1ha3Vyc1xuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvRm9ybUZpZWxkPlxuXG4gICAgICB7Y291cnNlLnR5cGUgPT09ICdzdGVwLWNvdXJzZScgPyA8PlxuICAgICAgPGJyLz5cbiAgICAgIDxGb3JtRmllbGQgbGFiZWw9e0xgw4RtbmVgfSBpZD1cIkNvdXJzZUluc3RhbmNlOnN1YmplY3RcIj5cbiAgICAgICAgPHAgaWQ9XCJDb3Vyc2VJbnN0YW5jZTpzdWJqZWN0XCI+eyhjb3Vyc2UgYXMgU3RlcENvdXJzZUluc3RhbmNlKS5zdWJqZWN0LnN1YmplY3ROYW1lfTwvcD5cbiAgICAgIDwvRm9ybUZpZWxkPlxuICAgICAgPC8+IDogbnVsbH1cblxuICAgICAgPGJyLz5cbiAgICAgICAgPGZvcm0+XG4gICAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImtjbGFiZWxcIj57TGDDhG5kcmluZ3Nwb2xpY3lgfTwvbGFiZWw+XG4gICAgICAgICAgPENoZWNrbGlzdFxuICAgICAgICAgICAgYXZhaWxhYmxlPXtbXG4gICAgICAgICAgICAgIHtuYW1lOiBMYFRpbGzDpXQgc2tvbG9yIHNrYXBhIGVnbmEgZmxpa2FyYCwga2V5OiBcImFsbG93QWRkVGFic1wifSxcbiAgICAgICAgICAgICAge25hbWU6IExgVGlsbMOldCBza29sb3IgZMO2bGphIHN0YW5kYXJkZmxpa2FyYCwga2V5OiBcImFsbG93UmVtb3ZlVGFic1wifSxcbiAgICAgICAgICAgICAge25hbWU6IExgVGlsbMOldCBza29sb3Igw6RuZHJhIG9yZG5pbmdlbiBtZWxsYW4gc3RhbmRhcmRmbGlrYXJgLCBrZXk6IFwiYWxsb3dSZW9yZGVyVGFic1wifSxcbiAgICAgICAgICAgIF19XG4gICAgICAgICAgICBzZWxlY3RlZD17W1xuICAgICAgICAgICAgICBjb3Vyc2UuYWxsb3dBZGRUYWJzICYmIFwiYWxsb3dBZGRUYWJzXCIsXG4gICAgICAgICAgICAgIGNvdXJzZS5hbGxvd1JlbW92ZVRhYnMgJiYgXCJhbGxvd1JlbW92ZVRhYnNcIixcbiAgICAgICAgICAgICAgY291cnNlLmFsbG93UmVvcmRlclRhYnMgJiYgXCJhbGxvd1Jlb3JkZXJUYWJzXCJdLmZpbHRlcih4ID0+ICEheCl9XG4gICAgICAgICAgICBvbkNoYW5nZT17c2VsZWN0ZWRQb2xpY3kgPT4gYnJhbmNoLmNvdXJzZUluc3RhbmNlcy51cGRhdGUoY291cnNlLCB7XG4gICAgICAgICAgICAgIGFsbG93QWRkVGFiczogc2VsZWN0ZWRQb2xpY3kuaW5jbHVkZXMoXCJhbGxvd0FkZFRhYnNcIiksXG4gICAgICAgICAgICAgIGFsbG93UmVtb3ZlVGFiczogc2VsZWN0ZWRQb2xpY3kuaW5jbHVkZXMoXCJhbGxvd1JlbW92ZVRhYnNcIiksXG4gICAgICAgICAgICAgIGFsbG93UmVvcmRlclRhYnM6IHNlbGVjdGVkUG9saWN5LmluY2x1ZGVzKFwiYWxsb3dSZW9yZGVyVGFic1wiKSxcbiAgICAgICAgICAgIH0pfSAvPlxuICAgICAgICA8L2Zvcm0+XG5cbiAgICAgIHtjb3Vyc2UudHlwZSA9PT0gJ3N0ZXAtY291cnNlJyA/IDw+XG4gICAgICAgIHtnZXRTdWJqZWN0Q29kZXMoY291cnNlLnRhZ3MpLmxlbmd0aCA+IDAgPyA8RWRpdFN0YW5kYXJkQ291cnNlQmxvY2tzXG4gICAgICAgICAgcmVwbz17YnJhbmNofVxuICAgICAgICAgIGNvdXJzZT17Y291cnNlIGFzIFdpdGhHcmFwaHM8U3RlcENvdXJzZUluc3RhbmNlLCBcImJsb2Nrc1wiPn0vPiA6IHVuZGVmaW5lZH1cbiAgICAgICAgPC8+IDogdW5kZWZpbmVkXG4gICAgICB9XG5cbiAgICAgIHtjb3Vyc2UudHlwZSA9PT0gJ3RoZW1lLWNvdXJzZScgPyA8PlxuICAgICAgICA8YnIvPlxuICAgICAgICA8Zm9ybT5cbiAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwia2NsYWJlbFwiPntMYEtvcHBsYWRlIMOkbW5lbmB9PC9sYWJlbD5cbiAgICAgICAgICA8TXVsdGlzZWxlY3RcbiAgICAgICAgICAgIHNlbGVjdGVkPXsoKGNvdXJzZSBhcyBUaGVtZUNvdXJzZUluc3RhbmNlKS5zdWJqZWN0cyB8fCBbXSkubWFwKCh7bmFtZSwgY29kZX0pID0+ICh7bmFtZSwga2V5OiBjb2RlfSkpfVxuICAgICAgICAgICAgZ2V0T3B0aW9ucz17KCk9PmRiLnN1YmplY3RzLnRhZ3MoJ3NjaG9vbFR5cGU6cHJpbWFyeScpLm1hcChzID0+ICh7bmFtZTogcy5uYW1lLCBrZXk6IHMuY29kZX0pKS50b1ZhbHVlKCkubG9hZCgpfVxuICAgICAgICAgICAgb25DaGFuZ2U9e3NlbGVjdGVkT3B0aW9ucyA9PiBicmFuY2guY291cnNlSW5zdGFuY2VzLnVwZGF0ZTxUaGVtZUNvdXJzZUluc3RhbmNlPihjb3Vyc2UsIHtcbiAgICAgICAgICAgICAgdGFnczogY29tcHV0ZVRhZ3NGcm9tU3ViamVjdENvZGVzIChjb3Vyc2UudGFncywgc2VsZWN0ZWRPcHRpb25zLm1hcChvID0+IG8ua2V5KSksXG4gICAgICAgICAgICAgIHN1YmplY3RzOiBzZWxlY3RlZE9wdGlvbnMubWFwKG9wdGlvbiA9PiAoe25hbWU6IG9wdGlvbi5uYW1lLCBjb2RlOiBvcHRpb24ua2V5fSkpXG4gICAgICAgICAgICB9KX0gLz5cbiAgICAgICAgPC9mb3JtPlxuICAgICAgICA8YnIvPlxuICAgICAgICA8Zm9ybT5cbiAgICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwia2NsYWJlbFwiPntMYMOFcnNrdXJzZXIgc29tIHNrYSBpbmfDpWB9PC9sYWJlbD5cbiAgICAgICAgICA8Q2hlY2tsaXN0XG4gICAgICAgICAgICBhdmFpbGFibGU9e1tcbiAgICAgICAgICAgICAge25hbWU6IExgw4Vyc2t1cnMgMS0zYCwga2V5OiBcIjEtM1wifSxcbiAgICAgICAgICAgICAge25hbWU6IExgw4Vyc2t1cnMgNC02YCwga2V5OiBcIjQtNlwifSxcbiAgICAgICAgICAgICAge25hbWU6IExgw4Vyc2t1cnMgNy05YCwga2V5OiBcIjctOVwifVxuICAgICAgICAgICAgXX1cbiAgICAgICAgICAgIHNlbGVjdGVkPXtnZXRTY2hvb2xZZWFycyhjb3Vyc2UudGFncyl9XG4gICAgICAgICAgICBvbkNoYW5nZT17c2VsZWN0ZWRTY2hvb2xZZWFycyA9PiBicmFuY2guY291cnNlSW5zdGFuY2VzLnVwZGF0ZShjb3Vyc2UsIHtcbiAgICAgICAgICAgICAgdGFnczogY29tcHV0ZVRhZ3NGcm9tU2Nob29sWWVhcnMoY291cnNlLnRhZ3MsIHNlbGVjdGVkU2Nob29sWWVhcnMpXG4gICAgICAgICAgICB9KX0gLz5cbiAgICAgICAgPC9mb3JtPlxuICAgICAgPC8+IDogdW5kZWZpbmVkfVxuXG4gICAgICA8YnIvPlxuXG4gICAgICB7Y291cnNlLnRhZ3MuaW5jbHVkZXMoJ2FjdGl2ZScpID9cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXtcbiAgICAgICAgICAoKT0+YnJhbmNoLmNvdXJzZUluc3RhbmNlcy51cGRhdGUoY291cnNlLCB7dGFnczogeyRyZW1vdmU6IFtcImFjdGl2ZVwiXX19KVxuICAgICAgICB9PlxuICAgICAgICAgIEluYWt0aXZlcmFcbiAgICAgICAgPC9kaXY+IDpcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXtcbiAgICAgICAgICAoKT0+YnJhbmNoLmNvdXJzZUluc3RhbmNlcy51cGRhdGUoY291cnNlLCB7dGFnczogeyRhZGQ6IFtcImFjdGl2ZVwiXX19KVxuICAgICAgICB9PlxuICAgICAgICAgIEFrdGl2ZXJhXG4gICAgICAgIDwvZGl2PlxuICAgICAgfVxuICAgICAgPExpbmsgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgdG89e2AvYWRtaW4vY291cnNlcy8ke2NvdXJzZUlkfS9jb25maXJtLWRlbGV0ZWB9PlxuICAgICAgICB7TGBSYWRlcmEgLi4uYH08L0xpbms+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLXdhcm5pbmdcIiBvbkNsaWNrPXthc3luYyAoKSA9PiB7XG4gICAgICAgIHB1Ymxpc2hDb3Vyc2Uoe3NjaG9vbDogXCJzdGFuZGFyZFwiLCBkcmFmdFJlcG86IGJyYW5jaCwgY291cnNlOiBjb3Vyc2UgYXMgQ291cnNlSW5zdGFuY2V9KTtcbiAgICAgICAgYXdhaXQgZGIuc2F2ZU5vdygpO1xuICAgICAgICBsb2NhdGlvbi5ocmVmID0gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgKGAke2NmZy5LRURfU1VCSkVDVF9QTEFOTkVSX1VSTH0jL3N0YW5kYXJkL2NvdXJzZXMvJHtjb3Vyc2VJZH1gLCB7fSk7XG4gICAgICB9fT5cbiAgICAgICAgUHVibGljZXJhXG4gICAgICA8L2Rpdj5cbiAgICA8Lz5cbikpKSk7XG5cblxuLyphc3luYyBmdW5jdGlvbiBkZWxldGVDb3Vyc2UoY291cnNlOiBDb3Vyc2VJbnN0YW5jZSkge1xuICB0cnkge1xuICAgIC8vIEdldCBjb3Vyc2UncyBkcmFmdHMgb24gYWxsIHNjaG9vbHNcbiAgICAvLyBHZXQgaWRzIG9mIGFsbCByZWxhdGVkIGVudGl0aWVzIChzZWFyY2ggYnkgZW50aXRpZXMgdGFncyB3aXRoIGNvdXJzZSBpZClcbiAgICBjb25zdCBbXG4gICAgICBkcmFmdEJyYW5jaElkcyxcbiAgICAgIGNvdXJzZUJsb2NrSWRzLFxuICAgICAgY291cnNlQ29udGVudElkcyxcbiAgICAgIGNvdXJlc1RhYnNJZHMsXG4gICAgICB0YXNrc0lkc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIGRiLmJyYW5jaGVzLnRhZ3MoY291cnNlLmlkKS5sb2FkKCksXG4gICAgICAgIGRiLmNvdXJzZUJsb2Nrcy50YWdzKGNvdXJzZS5pZCkubG9hZCgpLFxuICAgICAgICBkYi5jb3Vyc2VDb250ZW50cy50YWdzKGNvdXJzZS5pZCkubG9hZCgpLFxuICAgICAgICBkYi5jb3Vyc2VUYWJzLnRhZ3MoY291cnNlLmlkKS5sb2FkKCksXG4gICAgICAgIGRiLnRhc2tzLnRhZ3MoY291cnNlLmlkKS5sb2FkKClcbiAgICAgIF0pO1xuXG4gICAgLy8gRGVsZXRlIGFsbCBkcmFmdCBpZHMuXG4gICAgZGIuYnJhbmNoZXMuZGVsZXRlKC4uLmRyYWZ0QnJhbmNoSWRzKTtcbiAgICAvLyBEZWxldGUgYWxsIGRlc2NlbmRhbnQgaWRzOlxuICAgIGRiLmNvdXJzZUJsb2Nrcy5kZWxldGUoLi4uY291cnNlQmxvY2tJZHMpO1xuICAgIGRiLmNvdXJzZUNvbnRlbnRzLmRlbGV0ZSguLi5jb3Vyc2VDb250ZW50SWRzKTtcbiAgICBkYi5jb3Vyc2VUYWJzLmRlbGV0ZSguLi5jb3VyZXNUYWJzSWRzKTtcbiAgICBkYi50YXNrcy5kZWxldGUoLi4udGFza3NJZHMpO1xuXG4gICAgLy8gRGVsZXRlIHRoZSBjb3Vyc2UgaXRzZWxmXG4gICAgZGIuY291cnNlSW5zdGFuY2VzLmRlbGV0ZShjb3Vyc2UuaWQpO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgc2hvd0Vycm9yKGVycm9yKTtcbiAgfVxufSovXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBFcnJvclN1Y2Nlc3NGZWVkYmFjayB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2snO1xuaW1wb3J0IHsgVEFCUywgUk9VVEVTLCBUQUJTX0FSUkFZIH0gZnJvbSAnLi9yb3V0ZXMnO1xuaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnLi4vY29tbW9uL2Jhbm5lcic7XG5pbXBvcnQgeyBMb2FkaW5nSW5kaWNhdG9yIH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2xvYWRpbmctaW5kaWNhdG9yJztcblxuZXhwb3J0IGNvbnN0IFN1YmplY3RQbGFubmVyQWRtaW5BcHAgPSAoKT0+XG4gIDxSb3V0ZXI+XG4gICAgPD5cbiAgICAgIHtST1VURVMubWFwKCh7ZXhhY3QsIHBhdGgsIHRhYklkLCB0aXRsZSwgY29udGVudH0sIGluZGV4KSA9PlxuICAgICAgICA8Um91dGVcbiAgICAgICAgICBrZXk9e2luZGV4fVxuICAgICAgICAgIHBhdGg9e3BhdGh9XG4gICAgICAgICAgZXhhY3Q9e2V4YWN0fVxuICAgICAgY29tcG9uZW50PXtyb3V0ZVByb3BzID0+IDw+XG4gICAgICAgIDxCYW5uZXJcbiAgICAgICAgICBhY3RpdmVUYWI9e3RhYklkIHx8IFwiJFwifSB0YWJzPXtUQUJTX0FSUkFZfSB0aXRsZT17dGl0bGUgfHwgXCJcIn1cbiAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U9XCJodHRwczovL2tzLmt1bnNrYXBzcG9ydGVuLnNlL2ltYWdlcy8xOC42MzIzYmM0ZDE1ZjQ4MzFmOWM4MmRlZGYvdGhlbWUuanBnXCIgIC8+XG4gICAgICAgIHtjb250ZW50KHJvdXRlUHJvcHMpfVxuICAgICAgPC8+fSAvPilcbiAgICAgIH1cbiAgICAgIDxFcnJvclN1Y2Nlc3NGZWVkYmFjayAvPlxuICAgICAgPExvYWRpbmdJbmRpY2F0b3IgLz5cbiAgICA8Lz5cbiAgPC9Sb3V0ZXI+XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ3JlYXRlU3RhbmRhcmRDb3Vyc2UgfSBmcm9tICcuL2NvdXJzZXMvY3JlYXRlLXN0YW5kYXJkLWNvdXJzZSc7XG5pbXBvcnQgeyBUd29Db2x1bW5zUGFnZSB9IGZyb20gJy4uL2NvbW1vbi90d28tY29sdW1ucy1wYWdlJztcbmltcG9ydCB7IFN0YW5kYXJkQ291cnNlSW5zdGFuY2VMaXN0IH0gZnJvbSAnLi4vY29tbW9uL3N0YW5kYXJkLWNvdXJzZS1pbnN0YW5jZS1saXN0JztcbmltcG9ydCB7IFJlZGlyZWN0LCBSb3V0ZVByb3BzLCBSb3V0ZUNvbXBvbmVudFByb3BzIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBFZGl0U3RhbmRhcmRDb3Vyc2UgfSBmcm9tICcuL2NvdXJzZXMvZWRpdC1zdGFuZGFyZC1jb3Vyc2UnO1xuaW1wb3J0IHsgRGVsZXRlU3RhbmRhcmRDb3Vyc2UgfSBmcm9tICcuL2NvdXJzZXMvZGVsZXRlLXN0YW5kYXJkLWNvdXJzZSc7XG5pbXBvcnQgeyBTdWJqZWN0c0lubmVyIH0gZnJvbSAnLi4vLi4vY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvc3ViamVjdHMtaW5uZXInO1xuaW1wb3J0IHsgU2hvd1N1YmplY3RJbm5lciB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL3Nob3ctc3ViamVjdC1pbm5lcic7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgU2Nob29sc1dpdGhvdXRCYW5uZXIgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci9zY2hvb2xzJztcbmltcG9ydCB7IEVkaXRTY2hvb2xOb0Jhbm5lciB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyL3NjaG9vbHMvZWRpdC1zY2hvb2wnO1xuaW1wb3J0IHsgaXNUZWFjaGVyQXRTY2hvb2wsIHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xuXG5jb25zdCBSZWRpcmVjdEZyb21Sb290ID0gKCkgPT4ge1xuICBjb25zdCB7cm9sZXMsIHNjaG9vbH0gPSBlbnYuY3VycmVudFVzZXI7XG4gIGlmIChyb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpIHx8IGlzVGVhY2hlckF0U2Nob29sKGVudi5jdXJyZW50VXNlciwgXCJzdGFuZGFyZFwiKSlcbiAgICByZXR1cm4gPFJlZGlyZWN0IHRvPVwiL2FkbWluXCIgLz47XG4gIGxvY2F0aW9uLmhyZWYgPSBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSAoY2ZnLktFRF9TVUJKRUNUX1BMQU5ORVJfVVJMLCB7fSk7XG4gIHJldHVybiA8ZGl2IC8+O1xuICAvKnJldHVybiByb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpID9cbiAgICA8UmVkaXJlY3QgdG89XCIvYWRtaW5cIiAvPiA6IFxuICAvL3JvbGVzLmluY2x1ZGVzKFwiRU1QTE9ZRUVcIikgP1xuICAvLzxSZWRpcmVjdCB0bz17YC8ke3NjaG9vbH0vY291cnNlcy9lZGl0YH0gLz4gOlxuICAgIDxSZWRpcmVjdCB0bz17YC9hZG1pbi9jb3Vyc2VzYH0gLz47Ki9cbn1cblxuZXhwb3J0IGNvbnN0IFRBQlMgPSB7XG4gICQ6IFsnL2FkbWluJywgPD5TdGFydDwvPl0sXG4gIC8vY291cnNlczogWycvYWRtaW4vY291cnNlcycsIDw+S3Vyc2VyPC8+XSxcbiAgc2Nob29sczogW2Avc2Nob29sc2AsIDw+U2tvbG9yPC8+XSxcbiAgaW1wb3J0OiBbJy9hZG1pbi9pbXBvcnQnLCA8PkltcG9ydDwvPl0sXG59XG5cbmludGVyZmFjZSBSb3V0ZSB7XG4gIHBhdGg6IHN0cmluZztcbiAgZXhhY3Q/OiBib29sZWFuO1xuICB0YWJJZD86IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIGNvbnRlbnQ6IChyb3V0ZVByb3BzOiBSb3V0ZUNvbXBvbmVudFByb3BzPGFueT4pPT5SZWFjdC5SZWFjdE5vZGVcbn1cblxuZXhwb3J0IGNvbnN0IFJPVVRFUzogUm91dGVbXSA9IFtcbiAge1xuICAgIHBhdGg6IFwiL1wiLFxuICAgIGV4YWN0OiB0cnVlLFxuICAgIGNvbnRlbnQ6ICgpPT48UmVkaXJlY3RGcm9tUm9vdCAvPlxuICB9LFxuICB7XG4gICAgcGF0aDogXCIvYWRtaW5cIixcbiAgICBleGFjdDogdHJ1ZSxcbiAgICB0YWJJZDogXCIkXCIsXG4gICAgdGl0bGU6IFwiw4RtbmVzcGxhbmVyYXJlbiBBZG1pblwiLFxuICAgIGNvbnRlbnQ6ICgpPT48UmVkaXJlY3QgdG89XCIvYWRtaW4vY291cnNlcy9jcmVhdGVcIiAvPlxuICB9LFxuICB7XG4gICAgcGF0aDogXCIvYWRtaW4vY291cnNlcy9jcmVhdGVcIixcbiAgICBleGFjdDogdHJ1ZSxcbiAgICB0YWJJZDogXCIkXCIsXG4gICAgdGl0bGU6IFwiU2thcGEgc3RhbmRhcmRrdXJzXCIsXG4gICAgY29udGVudDogKCk9PlxuICAgICAgPFR3b0NvbHVtbnNQYWdlXG4gICAgICAgIGxlZnQ9ezxDcmVhdGVTdGFuZGFyZENvdXJzZSAvPn1cbiAgICAgICAgcmlnaHQ9ezxTdGFuZGFyZENvdXJzZUluc3RhbmNlTGlzdCAvPn1cbiAgICAgICAgcmlnaHRXaWR0aD17NX0gLz5cbiAgfSx7XG4gICAgcGF0aDogXCIvYWRtaW4vY291cnNlcy86Y291cnNlSWQvc2V0dGluZ3NcIixcbiAgICBleGFjdDogdHJ1ZSxcbiAgICB0YWJJZDogXCIkXCIsXG4gICAgdGl0bGU6IFwiw4RtbmVzcGxhbmVyYXJlbiBBZG1pblwiLFxuICAgIGNvbnRlbnQ6ICh7bWF0Y2h9KT0+PFR3b0NvbHVtbnNQYWdlXG4gICAgICBsZWZ0PXs8RWRpdFN0YW5kYXJkQ291cnNlIGNvdXJzZUlkPXttYXRjaC5wYXJhbXMuY291cnNlSWR9Lz59XG4gICAgICByaWdodD17PFN0YW5kYXJkQ291cnNlSW5zdGFuY2VMaXN0IC8+fVxuICAgICAgcmlnaHRXaWR0aD17NX0gLz5cbiAgfSx7XG4gICAgcGF0aDogXCIvYWRtaW4vY291cnNlcy86Y291cnNlSWQvY29uZmlybS1kZWxldGVcIixcbiAgICBleGFjdDogdHJ1ZSxcbiAgICB0YWJJZDogXCIkXCIsXG4gICAgdGl0bGU6IFwiQmVrcsOkZnRhIHJhZGVyaW5nIGF2IHN0YW5kYXJka3Vyc1wiLFxuICAgIGNvbnRlbnQ6ICh7bWF0Y2h9KT0+PFR3b0NvbHVtbnNQYWdlXG4gICAgICBsZWZ0PXs8RGVsZXRlU3RhbmRhcmRDb3Vyc2UgY291cnNlSWQ9e21hdGNoLnBhcmFtcy5jb3Vyc2VJZH0gLz59XG4gICAgICByaWdodD17PFN0YW5kYXJkQ291cnNlSW5zdGFuY2VMaXN0IC8+fVxuICAgICAgcmlnaHRXaWR0aD17NX0gLz5cbiAgfSx7XG4gICAgcGF0aDogXCIvYWRtaW4vaW1wb3J0XCIsXG4gICAgZXhhY3Q6IHRydWUsXG4gICAgdGFiSWQ6ICdpbXBvcnQnLFxuICAgIHRpdGxlOiBcIkltcG9ydCBmcsOlbiBTa29sdmVya2V0XCIsXG4gICAgY29udGVudDogKCk9PjxTdWJqZWN0c0lubmVyIGxpbmtQcmVmaXg9XCIvYWRtaW4vaW1wb3J0L1wiIC8+XG4gIH0se1xuICAgIHBhdGg6IFwiL2FkbWluL2ltcG9ydC86c3ViamVjdElkXCIsXG4gICAgZXhhY3Q6IGZhbHNlLFxuICAgIHRhYklkOiBcImltcG9ydFwiLFxuICAgIHRpdGxlOiBcIkltcG9ydCBmcsOlbiBza29sdmVya2V0XCIsXG4gICAgY29udGVudDogKHttYXRjaH0pPT48U2hvd1N1YmplY3RJbm5lciBpZD17bWF0Y2gucGFyYW1zLnN1YmplY3RJZH0gLz5cbiAgfSx7XG4gICAgcGF0aDogXCIvc2Nob29sc1wiLFxuICAgIGV4YWN0OiB0cnVlLFxuICAgIHRhYklkOiBcInNjaG9vbHNcIixcbiAgICB0aXRsZTogTGBTa29sb3JgLFxuICAgIGNvbnRlbnQ6ICgpPT48U2Nob29sc1dpdGhvdXRCYW5uZXIgdmlld0NvdXJzZVVybD17Y2ZnLktFRF9TVUJKRUNUX1BMQU5ORVJfVVJMfSAvPlxuICB9LHtcbiAgICBwYXRoOiBcIi9zY2hvb2xzLzpzY2hvb2xJZC9lZGl0XCIsXG4gICAgdGFiSWQ6IFwic2Nob29sc1wiLFxuICAgIHRpdGxlOiBcIlNrb2xvclwiLFxuICAgIGNvbnRlbnQ6ICh7bWF0Y2h9KT0+PEVkaXRTY2hvb2xOb0Jhbm5lciB0aXRsZT17TGBSZWRpZ2VyYSBza29sYWB9IGlkPXttYXRjaC5wYXJhbXMuc2Nob29sSWR9IC8+XG4gIH0se1xuICAgIHBhdGg6IFwiL3NjaG9vbHMvbmV3L2d5bW5hc2l1bVwiLFxuICAgIHRhYklkOiBcInNjaG9vbHNcIixcbiAgICB0aXRsZTogXCJTa29sb3JcIixcbiAgICBjb250ZW50OiAoe21hdGNofSk9PjxFZGl0U2Nob29sTm9CYW5uZXIgdGl0bGU9e0xgTMOkZ2cgdGlsbCBza29sYWB9IHR5cGU9XCJneW1uYXNpdW1cIiAvPlxuICB9LHtcbiAgICBwYXRoOiBcIi9zY2hvb2xzL25ldy9wcmltYXJ5XCIsXG4gICAgdGFiSWQ6IFwic2Nob29sc1wiLFxuICAgIHRpdGxlOiBcIlNrb2xvclwiLFxuICAgIGNvbnRlbnQ6ICh7bWF0Y2h9KT0+PEVkaXRTY2hvb2xOb0Jhbm5lciB0aXRsZT17TGBMw6RnZyB0aWxsIHNrb2xhYH0gdHlwZT1cInByaW1hcnlcIiAvPlxuICB9XG5dO1xuXG5leHBvcnQgY29uc3QgVEFCU19BUlJBWSA9IE9iamVjdC5rZXlzKFRBQlMpLm1hcChrZXkgPT4gKHtcbiAga2V5LFxuICBuYW1lOiBUQUJTW2tleV1bMV0sXG4gIGxpbms6IFRBQlNba2V5XVswXVxufSkpO1xuXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBWYWx1ZSwgRW1pdHRlciB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBsaXZlUXVlcnlWaWV3IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2xpdmUtcXVlcnktdmlldyc7XG5pbXBvcnQgeyBMYXp5Q29udGVudCB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9sYXp5LWNvbnRlbnQnO1xuaW1wb3J0IHsgRWxsaXBzaXNMb2FkZXIgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lbGxpcHNpcy1sb2FkZXInO1xuaW1wb3J0IHsgcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgfSBmcm9tICcuLi8uLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJhbm5lclByb3BzIHtcbiAgdGl0bGU6IHN0cmluZyxcbiAgYmFja2dyb3VuZEltYWdlPzogc3RyaW5nLFxuICB0YWJzOiB7IG5hbWU6IHN0cmluZyB8IEpTWC5FbGVtZW50LCBrZXk6IHN0cmluZywgbGluaz86IHN0cmluZywgb25DbGljaz86ICgpID0+IHZvaWQsIGRyYWdnYWJsZT86IGJvb2xlYW4gIH1bXSxcbiAgYnV0dG9ucz86IEpTWC5FbGVtZW50W10sXG4gIGFjdGl2ZVRhYjogc3RyaW5nO1xuICBjb3JuZXJCb3g/OiBzdHJpbmcgfCBKU1guRWxlbWVudDtcbiAgYmxvY2tzPzogQXJyYXk8eyBpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHN0ZXBzOiBBcnJheTx7IGxpbms6IHN0cmluZywgc3RlcE5vOiBudW1iZXIsIGlzQWN0aXZlOiBib29sZWFufT4gfT5cbiAgc29ydGFibGVUYWJzPzogYm9vbGVhbjtcbiAgb25UYWJEcm9wPzogKHNvdXJjZTogc3RyaW5nLCB0YXJnZXQ6IHN0cmluZywgcGxhY2VtZW50OiAnYmVmb3JlJyB8ICdhZnRlcicpID0+IHZvaWRcbn1cblxuaW50ZXJmYWNlIExhenlCYW5uZXJQcm9wcyB7XG4gIGxhenlQcm9wczogVmFsdWU8QmFubmVyUHJvcHM+XG59XG5cbmV4cG9ydCBjbGFzcyBMYXp5QmFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PExhenlCYW5uZXJQcm9wcz4ge1xuICBkcmFnU3RhdGUgPSBuZXcgRW1pdHRlcih7IHRhYkJlaW5nRHJhZ2dlZDogJycsIHRhYkJlaW5nSG92ZXJlZDogJycsIGluc2VydEJlZm9yZTogZmFsc2UsIG9yaWdpbkNsaWVudFg6IC0xIH0pO1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGxhenlQcm9wcyB9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCIgc3R5bGU9e3sgb3ZlcmZsb3c6IFwidmlzaWJsZVwiIH19PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tMTJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgIDxMYXp5Q29udGVudCBub0Vycm9yPlxuICAgICAgICAgICAgICB7bGF6eVByb3BzLm1hcCgoeyBiYWNrZ3JvdW5kSW1hZ2UgfSkgPT4gYmFja2dyb3VuZEltYWdlICYmIDxzdHlsZT57YFxuICAgICAgICAgICAgICAucGFnZUhlYWRlciB7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1pbWFnZTogdXJsKCcke2JhY2tncm91bmRJbWFnZX0nKSAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBgfTwvc3R5bGU+KX1cbiAgICAgICAgICAgIDwvTGF6eUNvbnRlbnQ+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2VIZWFkZXJcIj5cbiAgICAgICAgICAgICAgPGE+XG4gICAgICAgICAgICAgICAgPGgxPjxMYXp5Q29udGVudCBub0Vycm9yPntsYXp5UHJvcHMubWFwKHByb3BzID0+IDw+e3Byb3BzLnRpdGxlfTwvPil9PC9MYXp5Q29udGVudD48L2gxPlxuICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICAgIDxMYXp5Q29udGVudCBub0Vycm9yPntsYXp5UHJvcHMubWFwKCh7IGNvcm5lckJveCB9KSA9PiBjb3JuZXJCb3ggJiZcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2VIZWFkZXJDb3JuZXJCb3hcIj5cbiAgICAgICAgICAgICAgICAgIHtjb3JuZXJCb3h9XG4gICAgICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICAgICAgPC9MYXp5Q29udGVudD5cblxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbnNGaWVsZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uc0NvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAgPExhenlDb250ZW50IHNwaW5uZXI9ezxFbGxpcHNpc0xvYWRlciAvPn0+e2xhenlQcm9wcy5tYXAoKHsgdGFicywgYnV0dG9ucywgYWN0aXZlVGFiLCBibG9ja3MsIHNvcnRhYmxlVGFicywgb25UYWJEcm9wIH0pID0+IDw+XG4gICAgICAgICAgICAgICAgICAgIHtibG9ja3MgPyA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgICAgICAgICAgICB7YmxvY2tzLm1hcChibG9jayA9PiA8ZGl2IGtleT17YmxvY2suaWR9IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi12ZXJ0aWNhbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhPntibG9jay5uYW1lfTwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtibG9jay5zdGVwcy5tYXAoc3RlcCA9PiA8UmVhY3QuRnJhZ21lbnQga2V5PXtzdGVwLnN0ZXBOb30+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89e3N0ZXAubGlua31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiYnRuIGJ0bi1zbWFsbCBzdGVwLWJ1dHRvblwiICsgKHN0ZXAuaXNBY3RpdmUgPyBcIiBhY3RpdmVQYWdlXCIgOiBcIlwiKX0gPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtzdGVwLnN0ZXBOb31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD4pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2Pil9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PiA6IG51bGx9XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdob3Jpem9udGFsTWVudSc+XG4gICAgICAgICAgICAgICAgICAgICAgPExhenlDb250ZW50PntcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhZ1N0YXRlLm1hcCgoeyB0YWJCZWluZ0RyYWdnZWQsIHRhYkJlaW5nSG92ZXJlZCwgaW5zZXJ0QmVmb3JlLCBvcmlnaW5DbGllbnRYIH0pID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDx1bFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17c29ydGFibGVUYWJzID8gXCJzb3J0YWJsZVwiIDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkRyb3A9e29uVGFiRHJvcCA/IGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJCZWluZ0hvdmVyZWQgJiYgdGFiQmVpbmdEcmFnZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uVGFiRHJvcCh0YWJCZWluZ0RyYWdnZWQsIHRhYkJlaW5nSG92ZXJlZCwgaW5zZXJ0QmVmb3JlID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmVmb3JlJyA6ICdhZnRlcicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmFnU3RhdGUuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi50aGlzLmRyYWdTdGF0ZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiQmVpbmdIb3ZlcmVkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiQmVpbmdEcmFnZ2VkOiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IG51bGx9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt0YWJzLm1hcCgoeyBuYW1lLCBrZXksIGxpbmssIG9uQ2xpY2ssIGRyYWdnYWJsZSB9LCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQWN0aXZlID0gYWN0aXZlVGFiID09PSBrZXkgfHwgKGFjdGl2ZVRhYiA9PT0gJyQnICYmIGlkeCA9PT0gMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7ZHJhZ1N0YXRlfSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gbmFtZSB8fCBMYChOYW1ubMO2cyBmbGlrKWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPFJlYWN0LkZyYWdtZW50IGtleT17a2V5fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2luc2VydEJlZm9yZSAmJiB0YWJCZWluZ0hvdmVyZWQgPT09IGtleSA/IDxsaSBjbGFzc05hbWU9XCJkcm9wLXRhcmdldFwiIG9uRHJhZ092ZXI9e2V2ID0+IGV2LnByZXZlbnREZWZhdWx0KCl9PiZuYnNwOzwvbGk+IDogbnVsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17W1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmUgPyBcImFjdGl2ZVBhZ2VcIiA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXkgPT09IHRhYkJlaW5nRHJhZ2dlZCA/IFwiZHJhZy1zb3VyY2VcIiA6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0YWJsZVRhYnMgJiYgZHJhZ2dhYmxlID8gXCJkcmFnZ2FibGVcIiA6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmZpbHRlcih4PT54KS5qb2luKCcgJyl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ2dhYmxlPXtzb3J0YWJsZVRhYnMgJiYgZHJhZ2dhYmxlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRHJhZ1N0YXJ0PXtzb3J0YWJsZVRhYnMgJiYgZHJhZ2dhYmxlID8gZXYgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYuZGF0YVRyYW5zZmVyLmVmZmVjdEFsbG93ZWQgPSBcIm1vdmVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdTdGF0ZS5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRyYWdTdGF0ZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luQ2xpZW50WDogZXYuY2xpZW50WCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiQmVpbmdEcmFnZ2VkOiBrZXlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRHJhZ092ZXI9e3NvcnRhYmxlVGFicyA/IGV2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJCZWluZ0RyYWdnZWQgPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmFnU3RhdGUuZGlzcGF0Y2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRyYWdTdGF0ZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJCZWluZ0hvdmVyZWQ6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhYkJlaW5nRHJhZ2dlZCkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gXCJtb3ZlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwib25EcmFnT3ZlcjogXCIgKyBuYW1lICsgXCIuIGlkeDogXCIgKyBpZHggKyBcIi4gb3RoZXJJZHg6IFwiICsgb3RoZXJJZHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJhZ1N0YXRlLmRpc3BhdGNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZHJhZ1N0YXRlLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJCZWluZ0hvdmVyZWQ6IGtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0QmVmb3JlOiBvcmlnaW5DbGllbnRYID4gZXYuY2xpZW50WH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH06IG51bGx9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25EcmFnRW5kPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRyYWdTdGF0ZS5kaXNwYXRjaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRyYWdTdGF0ZS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiQmVpbmdIb3ZlcmVkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFiQmVpbmdEcmFnZ2VkOiAnJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtsaW5rID8gbGluay5zdGFydHNXaXRoKFwiOlwiKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPXtwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeShsaW5rLnN1YnN0cigxKSwge30pfT57bmFtZX08L2E+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtsaW5rfT57bmFtZX08L0xpbms+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2sgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBvbkNsaWNrPXtvbkNsaWNrfT57bmFtZX08L2E+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyFpbnNlcnRCZWZvcmUgJiYgdGFiQmVpbmdIb3ZlcmVkID09PSBrZXkgPyA8bGkgY2xhc3NOYW1lPVwiZHJvcC10YXJnZXRcIiAgb25EcmFnT3Zlcj17ZXYgPT4gZXYucHJldmVudERlZmF1bHQoKX0+Jm5ic3A7PC9saT4gOiBudWxsfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7YnV0dG9ucyAmJiBidXR0b25zLm1hcCgoYnRuLCBpZHgpID0+IDxsaSBjbGFzc05hbWU9XCJhY3Rpb24tdGFiXCIga2V5PXtgYnRuJHtpZHh9YH0+e2J0bn08L2xpPil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+KX1cbiAgICAgICAgICAgICAgICAgICAgICA8L0xhenlDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvPil9XG4gICAgICAgICAgICAgICAgICA8L0xhenlDb250ZW50PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIClcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgQmFubmVyID0gKHByb3BzOiBCYW5uZXJQcm9wcykgPT4gPExhenlCYW5uZXIgbGF6eVByb3BzPXtuZXcgRW1pdHRlcjxCYW5uZXJQcm9wcz4ocHJvcHMpfSAvPlxuXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBEb2N1bWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY2FwdGlvbjogc3RyaW5nO1xuICBpdGVtczogU2lkZUxpc3RJdGVtW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2lkZUxpc3RJdGVtIHtcbiAgaWQ6IHN0cmluZztcbiAgJG1ldGE/OiBzdHJpbmc7XG4gIHBpbGxzPzogU2lkZUxpc3RQaWxsW107XG4gIHZpZXdMaW5rOiBzdHJpbmc7XG4gIGVkaXRMaW5rOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHNtYWxsVGV4dD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaWRlTGlzdFBpbGwge1xuICBjbGFzc05hbWU6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgU2lkZUxpc3QgPSAoe2l0ZW1zLCBjYXB0aW9ufTogUHJvcHMpID0+IChcbiAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgICAgPGgzPntjYXB0aW9ufTwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lciBvZGQtZXZlblwiPlxuICAgICAgICAgIHtpdGVtcy5tYXAoaXRlbSA9PiA8ZGl2IGNsYXNzTmFtZT1cInNjaG9vbENvdXJzZVwiIGtleT17aXRlbS5pZH0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17W1wiYWxpZ24taG9yaXpvbnRhbFwiLCBpdGVtLiRtZXRhICYmIGBlbnRpdHltZXRhLSR7aXRlbS4kbWV0YX1gXS5qb2luKCcgJyl9PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBwdWxsLXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAge2l0ZW0uZWRpdExpbmsuc3RhcnRzV2l0aCgnOicpID9cbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2l0ZW0uZWRpdExpbmsuc3Vic3RyKDEpfSBjbGFzc05hbWU9XCJlZGl0SXRlbVwiIC8+IDpcbiAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtpdGVtLmVkaXRMaW5rfSBjbGFzc05hbWU9XCJlZGl0SXRlbVwiIC8+XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIHtpdGVtLnZpZXdMaW5rLnN0YXJ0c1dpdGgoJzonKSA/XG4gICAgICAgICAgICAgICAgICA8YSBocmVmPXtpdGVtLnZpZXdMaW5rLnN1YnN0cigxKX0+e2l0ZW0ubmFtZX08L2E+IDpcbiAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtpdGVtLnZpZXdMaW5rfT57aXRlbS5uYW1lfTwvTGluaz5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICB7aXRlbS5waWxscy5tYXAoKHBpbGwsIGlkeCkgPT4gXG4gICAgICAgICAgICAgICAgPGRpdiBrZXk9e2lkeH0gY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17W1wicGlsbFwiXS5jb25jYXQocGlsbC5jbGFzc05hbWUpLmpvaW4oJyAnKX0+e3BpbGwubmFtZX08L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPHA+e2l0ZW0uZGVzY3JpcHRpb259PC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPntpdGVtLnNtYWxsVGV4dH08L3A+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PiBcbiAgICA8L2Rpdj5cbik7XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBTaWRlTGlzdCwgU2lkZUxpc3RQaWxsIH0gZnJvbSAnLi9zaWRlLWxpc3QnO1xuaW1wb3J0IHsgZGIsIGdsb2JhbElkIH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyBjb21wYXJlUHJvcCwgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCB7IGxpdmVRdWVyeVZpZXcgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvbGl2ZS1xdWVyeS12aWV3JztcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xuaW1wb3J0IHsgc2hvcnREYXRlRm9ybWF0IH0gZnJvbSAnLi4vLi4vY291cnNlLWJ1aWxkZXIvdXRpbHMnO1xuaW1wb3J0IHsgbGlzdENvdXJzZUluc3RhbmNlcyB9IGZyb20gJy4uL2xvZ2ljL2xpc3QtY291cnNlLWluc3RhbmNlcyc7XG5cbmV4cG9ydCBjb25zdCBTdGFuZGFyZENvdXJzZUluc3RhbmNlTGlzdCA9IGxpdmVRdWVyeVZpZXcoKCk9PlxuICAvKntcbiAgICBsb2FkaW5nOiAoKT0+PFNwaW5uZXIgLz4sXG4gICAgZXJyb3I6IGVycm9yID0+IDxwPk9qc2FuIGhvcHBzYW4gZmVsOiB7ZXJyb3IubWVzc2FnZX08L3A+XG4gIH0sKi9cbiAgbGlzdENvdXJzZUluc3RhbmNlcygpXG4gICAgLm9yZGVyQnkoXCJuYW1lXCIpXG4gICAgLm1hcCgoe2lkLCAkbWV0YSwgbmFtZSwgZGVzY3JpcHRpb24sIHRhZ3MsIHR5cGUsIG1vZGlmaWVkQnksIG1vZGlmaWVkRGF0ZX0pID0+ICh7XG4gICAgICBpZCxcbiAgICAgIHR5cGUsXG4gICAgICAkbWV0YSxcbiAgICAgIG5hbWUsXG4gICAgICBkZXNjcmlwdGlvbixcbiAgICAgIHZpZXdMaW5rOmA6JHtwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeShjZmcuS0VEX1NVQkpFQ1RfUExBTk5FUl9VUkwsIHt9KX0jL3N0YW5kYXJkL2NvdXJzZXMvJHtpZH1gLFxuICAgICAgZWRpdExpbms6YC9hZG1pbi9jb3Vyc2VzLyR7aWR9L3NldHRpbmdzYCxcbiAgICAgIHBpbGxzOiB0YWdzLmZpbHRlcih0YWcgPT4gdGFnID09PSBcImFjdGl2ZVwiKVxuICAgICAgICAubWFwKHRhZyA9PiAoe1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJhY3RpdmVcIixcbiAgICAgICAgICBuYW1lOiBMYEFrdGl2YFxuICAgICAgICB9KSksXG4gICAgICBzbWFsbFRleHQ6IG1vZGlmaWVkQnkgJiYgbW9kaWZpZWREYXRlICYmIExgU2VuYXN0IHJlZGlnZXJhZCBhdiAke21vZGlmaWVkQnkubmFtZX0gLyAke3Nob3J0RGF0ZUZvcm1hdChtb2RpZmllZERhdGUpfWBcbiAgICB9KSlcbiAgICAudG9WYWx1ZSgpXG4gICAgLm1hcChjb3Vyc2VJdGVtcyA9PiB7XG4gICAgICBjb25zdCBzdGVwQ291cnNlSXRlbXMgPSBjb3Vyc2VJdGVtcy5maWx0ZXIoY291cnNlID0+IGNvdXJzZS50eXBlID09PSAnc3RlcC1jb3Vyc2UnKTtcbiAgICAgIGNvbnN0IHRoZW1lQ291cnNlSXRlbXMgPSBjb3Vyc2VJdGVtcy5maWx0ZXIoY291cnNlID0+IGNvdXJzZS50eXBlID09PSAndGhlbWUtY291cnNlJyk7XG5cbiAgICAgIHJldHVybiA8PlxuICAgICAgICA8U2lkZUxpc3QgY2FwdGlvbj17XCJTdGVna3Vyc2VyXCJ9IGl0ZW1zPXtzdGVwQ291cnNlSXRlbXN9IC8+XG4gICAgICAgIDxTaWRlTGlzdCBjYXB0aW9uPXtcIlRlbWFrdXJzZXJcIn0gaXRlbXM9e3RoZW1lQ291cnNlSXRlbXN9IC8+XG4gICAgICA8Lz5cbiAgICB9KSk7XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxlZnQ6IFJlYWN0LlJlYWN0Tm9kZTtcbiAgcmlnaHQ6IFJlYWN0LlJlYWN0Tm9kZTtcbiAgcmlnaHRXaWR0aDogMSB8IDIgfCAzIHwgNCB8IDUgfCA2IHwgNyB8IDggfMKgOSB8IDEwIHwgMTE7XG59XG5cbmV4cG9ydCBjb25zdCBUd29Db2x1bW5zUGFnZSA9ICh7IGxlZnQsIHJpZ2h0LCByaWdodFdpZHRoIH06IFByb3BzKSA9PiAoXG4gIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dFwiPlxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zcGFjZXItMjBweHZ0IHN2LXZlcnRpY2FsIHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2Vjb250ZW50IHN2LWxheW91dCBzdi1zcGFjZXItMjBweHZ0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tJHsxMi1yaWdodFdpZHRofWB9PlxuICAgICAgICAgICAgICB7bGVmdH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Bzdi1sYXlvdXQgc3YtY29sdW1uLSR7cmlnaHRXaWR0aH1gfT5cbiAgICAgICAgICAgICAge3JpZ2h0fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuKTtcbiIsImltcG9ydCB7IENvdXJzZUluc3RhbmNlIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XG5pbXBvcnQgeyBkaXN0aW5jdCwgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN1YmplY3RDb2RlcyAodGFnczogc3RyaW5nW10pIHtcbiAgcmV0dXJuIGRpc3RpbmN0KCh0YWdzIHx8wqBbXSlcbiAgICAuZmlsdGVyKHRhZyA9PiB0YWcuc3RhcnRzV2l0aChcInN1YjpcIikpXG4gICAgLm1hcCh0YWcgPT4gdGFnLnN1YnN0cihcInN1YjpcIi5sZW5ndGgpKVxuICApOztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjaG9vbFllYXJzKHRhZ3M6IHN0cmluZ1tdKSB7XG4gIHJldHVybiBkaXN0aW5jdCgodGFncyB8fCBbXSlcbiAgICAuZmlsdGVyKHRhZyA9PiB0YWcuc3RhcnRzV2l0aChcImNvdXJzZTpcIikpXG4gICAgLm1hcCh0YWcgPT4gdGFnLnN1YnN0cih0YWcuaW5kZXhPZihcInxcIikgKyAxKSkgLy8gU2Nob29sIHllYXIgaXMgY29uY2F0ZW5hdGVkIGFzIHBpcGUgKyBzY2hvb2x5ZWFyLiBFeGFtcGxlOiBcIkdSR1JGWVMwMXw0LTZcIlxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZUNvdXJzZUluc3RhbmNlVGFncyAodGFnczogc3RyaW5nW10sIHN1YmplY3RDb2Rlczogc3RyaW5nW10sIHNjaG9vbFllYXJzOiBzdHJpbmdbXSkge1xuICBjb25zdCBvdGhlclRhZ3MgPSAodGFncyB8fCBbXSkuZmlsdGVyKHRhZyA9PiAhdGFnLnN0YXJ0c1dpdGgoXCJjb3Vyc2U6XCIpICYmICF0YWcuc3RhcnRzV2l0aChcInN1YjpcIikpO1xuICBjb25zdCBzdWJqZWN0VGFncyA9IHN1YmplY3RDb2Rlcy5tYXAoc3ViID0+IFwic3ViOlwiICsgc3ViKTtcbiAgY29uc3QgY291cnNlVGFncyA9IGZsYXR0ZW4oXG4gICAgICAgIHN1YmplY3RDb2Rlcy5tYXAoc3ViID0+XG4gICAgICAgICAgc2Nob29sWWVhcnMubWFwKHNjaG9vbFllYXIgPT5cbiAgICAgICAgICAgIFwiY291cnNlOlwiICsgc3ViICsgXCJ8XCIgKyBzY2hvb2xZZWFyKSkpO1xuICByZXR1cm4gb3RoZXJUYWdzXG4gICAgLmNvbmNhdChzdWJqZWN0VGFncylcbiAgICAuY29uY2F0KGNvdXJzZVRhZ3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVRhZ3NGcm9tU2Nob29sWWVhcnModGFnczogc3RyaW5nW10sIHNjaG9vbFllYXJzOiBzdHJpbmdbXSkge1xuICAvL3NjaG9vbFllYXJzID0gc2Nob29sWWVhcnMubWFwKGFmdGVyQ29sb24pO1xuICBjb25zdCBzdWJqZWN0Q29kZXMgPSBnZXRTdWJqZWN0Q29kZXModGFncyk7XG4gIHJldHVybiBjb21wdXRlQ291cnNlSW5zdGFuY2VUYWdzKHRhZ3MsIHN1YmplY3RDb2Rlcywgc2Nob29sWWVhcnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVRhZ3NGcm9tU3ViamVjdENvZGVzKHRhZ3M6IHN0cmluZ1tdLCBzdWJqZWN0Q29kZXM6IHN0cmluZ1tdKSB7XG4gIC8vc3ViamVjdENvZGVzID0gc3ViamVjdENvZGVzLm1hcChhZnRlckNvbG9uKTtcbiAgY29uc3Qgc2Nob29sWWVhcnMgPSBnZXRTY2hvb2xZZWFycyh0YWdzKTtcbiAgcmV0dXJuIGNvbXB1dGVDb3Vyc2VJbnN0YW5jZVRhZ3ModGFncywgc3ViamVjdENvZGVzLCBzY2hvb2xZZWFycyk7XG59XG5cbmZ1bmN0aW9uIGFmdGVyQ29sb24gKHN0cjogc3RyaW5nKSB7XG4gIGNvbnN0IHBDb2xvbiA9IHN0ci5pbmRleE9mKCc6Jyk7XG4gIHJldHVybiBwQ29sb24gPj0gMCA/XG4gICAgc3RyLnN1YnN0cihwQ29sb24gKyAxKSA6XG4gICAgc3RyO1xufVxuIiwiXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q291cnNlQ29kZXNGcm9tVGFncyh0YWdzOiBzdHJpbmdbXSkge1xuICByZXR1cm4gKHRhZ3MgfHwgW10pXG4gICAgLmZpbHRlcih0YWcgPT4gdGFnLnN0YXJ0c1dpdGgoXCJjb3Vyc2U6XCIpKVxuICAgIC5tYXAoY291cnNlVGFnID0+IGNvdXJzZVRhZy5zdWJzdHIoXCJjb3Vyc2U6XCIubGVuZ3RoKSk7XG59XG4iLCJpbXBvcnQgeyBBYmlsaXR5LCBDZW50cmFsQ29udGVudCwgS25vd2xlZGdlUmVxdWlyZW1lbnQsIENvdXJzZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IFZhbHVlLCBDb2xsZWN0aW9uLCBFbWl0dGVyIH0gZnJvbSAna2VkYmFja2VuZC9vYnNlcnZhYmxlJztcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyBnZXRPcmRlcmVkRG9jcyB9IGZyb20gJy4vb3JkZXJlZC1yZXF1aXJlbWVudHMnO1xuaW1wb3J0IHsgV2l0aEdyYXBocyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5cblxuZXhwb3J0IHR5cGUgQ291cnNlV2l0aFJlcXVpcmVtZW50cyA9IFdpdGhHcmFwaHM8Q291cnNlLCBcImFiaWxpdGllc1wiIHwgXCJjZW50cmFsQ29udGVudFwiIHwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIj47XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdGFuZGFyZENvdXJzZXNXaXRoT3JkZXJlZFJlcXVpcmVtZW50cyhjb3Vyc2VDb2Rlczogc3RyaW5nW10pOiBWYWx1ZTxDb3Vyc2VXaXRoUmVxdWlyZW1lbnRzW10+IHtcbiAgY29uc3QgY291cnNlQ29kZVRhZ3MgPSBjb3Vyc2VDb2Rlcy5tYXAoY29kZSA9PiBjb2RlLnN0YXJ0c1dpdGgoJ2NvdXJzZTonKSA/IGNvZGUgOiBcImNvdXJzZTpcIiArIGNvZGUpO1xuICBpZiAoY291cnNlQ29kZVRhZ3MubGVuZ3RoID09PSAwKSByZXR1cm4gbmV3IEVtaXR0ZXIoW10pO1xuICByZXR1cm4gZGIuY291cnNlcy5pbmNsdWRlKFwiYWJpbGl0aWVzXCIsIFwiY2VudHJhbENvbnRlbnRcIiwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIilcbiAgICAudGFncyguLi5jb3Vyc2VDb2RlVGFncylcbiAgICAuZmlsdGVyKGNvdXJzZSA9PiBjb3Vyc2UuaXNUZW1wbGF0ZSkgLy8gQlVHQlVHOiBJbiBLRywgd2Ugd291bGQgbmVlZCB0aGlzIGZpbHRlciwgbm90IEtTLiBOZWVkIGFub3RoZXIgYXV0aG9yaXplZCB3YXkgb2YgZ2V0dGluZyB0aGUgc3RhbmRhcmQgY291cnNlIG9ubHkhXG4gICAgLm1hcChjb3Vyc2UgPT4gKHtcbiAgICAgIC4uLmNvdXJzZSxcbiAgICAgIGFiaWxpdGllczogZ2V0T3JkZXJlZERvY3MoY291cnNlLmFiaWxpdGllcywgY291cnNlLmFiaWxpdGllc09yZGVyKSxcbiAgICAgIGNlbnRyYWxDb250ZW50OiBnZXRPcmRlcmVkRG9jcyhjb3Vyc2UuY2VudHJhbENvbnRlbnQsIGNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyKSxcbiAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50czogZ2V0T3JkZXJlZERvY3MoY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cywgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyKVxuICAgIH0pKS50b1ZhbHVlKClcbn1cbiIsImltcG9ydCB7IGRiLCBnbG9iYWxJZCB9IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvZGInO1xuXG5leHBvcnQgZnVuY3Rpb24gbGlzdENvdXJzZUluc3RhbmNlcygpIHtcbiAgcmV0dXJuIGRiLmNvdXJzZUluc3RhbmNlcy5oYXNFZGdlc0Zyb20oW2dsb2JhbElkXSk7XG59XG4iLCJpbXBvcnQgeyBDb2xsZWN0aW9uLCBFbWl0dGVyLCBWYWx1ZSB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL2RiJztcbmltcG9ydCB7IGZsYXR0ZW4sIGRpc3RpbmN0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgV2l0aEdyYXBocyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5cbi8qKiBDb3Vyc2UgKi9cbmludGVyZmFjZSBPcmRlckRlZmluaW5nRG9jIHtcbiAga25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXI/OiBzdHJpbmdbXSAgIC8vIENvdXJzZVxuICBjZW50cmFsQ29udGVudE9yZGVyPzogc3RyaW5nW10gICAgICAgICAgLy8gQ291cnNlXG4gIGFiaWxpdGllc09yZGVyPzogc3RyaW5nW10gICAgICAgICAgICAgICAvLyBDb3Vyc2UgKyBTdWJqZWN0XG59XG5cbi8qKiBDb3Vyc2UsIENvdXJzZUluc3RhbmNlLCBUYXNrLCBMZWFybmluZ0dvYWxzQ29udGVudCBvciBDb3Vyc2VCbG9jayAqL1xuZXhwb3J0IGludGVyZmFjZSBSZXF1aXJlbWVudHNDb250YWluaW5nRG9jIHtcbiAgdGFnczogc3RyaW5nW107ICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvdXJzZSArIENvdXJzZUluc3RhbmNlLCBUYXNrXG4gIGNlbnRyYWxDb250ZW50Pzoge2lkOiBzdHJpbmd9W107ICAgICAgICAvLyBDb3Vyc2UgKyBMZWFybmluZ0dvYWxzQ29udGVudCArIENvdXJzZUJsb2NrICsgVGFza1xuICBrbm93bGVkZ2VSZXF1aXJlbWVudHM/OiB7aWQ6IHN0cmluZ31bXTsgLy8gQ291cnNlICsgTGVhcm5pbmdHb2Fsc0NvbnRlbnQgKyBDb3Vyc2VCbG9jayArIFRhc2tcbiAgYWJpbGl0aWVzPzoge2lkOiBzdHJpbmd9W107IC8vIENvdXJzZSwgTGVhcm5pbmdHb2Fsc0NvbnRlbnQsIENvdXJzZUJsb2NrLCBUYXNrXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPcmRlcmVkRG9jczxUIGV4dGVuZHMge2lkOiBzdHJpbmd9Pihkb2NzPzogVFtdLCBvcmRlcj86IHN0cmluZ1tdLCB7YXBwZW5kTGVmdG92ZXJzfSA9IHthcHBlbmRMZWZ0b3ZlcnM6ZmFsc2V9KSB7XG4gIC8vIE1hcmsgZG9jIElEcyB0aGF0IHdoZXJlIHByZXNlbnQgaW4gZ2l2ZW4gJ29yZGVyJyBhcnJheS5cbiAgLy8gV2lsbCBiZSB1c2VkIHRvIGZpbmQgbGVmdC1vdmVycyB0aGF0IHdlcmUgbm90IHByZXNlbnQgaW4gdGhlICdvcmRlcicgYXJyYXkuXG4gIGNvbnN0IG1hcmtlZERvY3M6IHtbaWQ6IHN0cmluZ106IHRydWV9ID0ge307XG5cbiAgaWYgKCFkb2NzIHx8ICFvcmRlcikge1xuICAgIC8vIFNwZWNpYWwgY2FzZTogbm8gZG9jcyBvciBubyBvcmRlci4gRG9uJ3QgZmFpbC4gSnVzdCByZXR1cm4gZG9jcyBhcyBpcy5cbiAgICByZXR1cm4gZG9jcztcbiAgfVxuXG4gIC8vIE1hcCBnaXZlbiAnb3JkZXInIGFycmF5IHRvIGNvcnJlc3BvbmRpbmcgZG9jcy4gQWxzbyBtYXJrIGluIG1hcmtlZERvY3MuXG4gIGNvbnN0IHJlc3VsdCA9IChkb2NzICYmIG9yZGVyID9cbiAgICBvcmRlci5tYXAoaWQgPT4ge1xuICAgICAgbWFya2VkRG9jc1tpZF0gPSB0cnVlO1xuICAgICAgcmV0dXJuIGRvY3MuZmluZChkb2MgPT4gZG9jLmlkID09PSBpZCk7XG4gICAgfSkuZmlsdGVyKGRvYyA9PiAhIWRvYykgOlxuICAgIGRvY3MpO1xuXG4gIGlmIChhcHBlbmRMZWZ0b3ZlcnMpIHsgICAgICBcbiAgICAvLyBJZiBhbnkgbGVmdG92ZXJzIGFyZSB0aGVyZSwgY29uY2F0IHRoZW0gYXQgdGhlIGVuZDpcbiAgICBjb25zdCBsZWZ0T3ZlcnMgPSBkb2NzLmZpbHRlcihkb2MgPT4gIW1hcmtlZERvY3NbZG9jLmlkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5jb25jYXQobGVmdE92ZXJzKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlUmVxdWlyZW1lbnRPcmRlcjxUIGV4dGVuZHMgUmVxdWlyZW1lbnRzQ29udGFpbmluZ0RvYz4ob2JqOiBULCBvcmRlckRlZmluZXI/OiBPcmRlckRlZmluaW5nRG9jKTogVmFsdWU8VD4ge1xuICBsZXQgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGU6IFZhbHVlPE9yZGVyRGVmaW5pbmdEb2NbXT47XG4gIGlmIChvcmRlckRlZmluZXIpIHtcbiAgICAvLyBVc2VyIHByb3ZpZGVkIHRoZSBvcmRlckRlZmluaW5nIGRvYyAodXNlIGNhc2UgaXMgd2hlbiBvYmogaXMgYSBDb3Vyc2Ugb3IgU3ViamVjdCwgd2hpY2ggY29udGFpbnMgaXRzIG9yZGVyIGJ5IGl0c2VsZi4gVXNlciB0aGVuIHByb3ZpZGVzIHRoZSBDb3Vyc2Ugb3IgU3ViamVjdCBpbiBib3RoIGFyZ3MpXG4gICAgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGUgPSBuZXcgRW1pdHRlcihbb3JkZXJEZWZpbmVyXSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgY291cnNlQ29kZXMgPSBvYmoudGFncy5maWx0ZXIodGFnID0+IHRhZy5zdGFydHNXaXRoKFwiY291cnNlOlwiKSk7XG4gICAgaWYgKGNvdXJzZUNvZGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG5ldyBFbWl0dGVyKG9iaik7IC8vIE5vIGNvdXJzZSB0YWdzLiBOb3QgcG9zc2libGUgdG8gcmVzb2x2ZSBvcmRlci5cbiAgICB9XG4gICAgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGUgPSBkYi5jb3Vyc2VzLnRhZ3MoLi4uY291cnNlQ29kZXMpLnRvVmFsdWUoKTtcbiAgfVxuXG4gIHJldHVybiBvcmRlckRlZmluaW5nRG9jT2JzZXJ2YWJsZS5tYXAob3JkZXJIb2xkZXJzID0+IHtcbiAgICBjb25zdCBhYmlsaXRpZXNPcmRlciA9IGZsYXR0ZW4ob3JkZXJIb2xkZXJzLm1hcChvcmRlckhvbGRlciA9PiBvcmRlckhvbGRlci5hYmlsaXRpZXNPcmRlciB8fCBbXSkpO1xuICAgIGNvbnN0IGNjT3JkZXIgPSBmbGF0dGVuKG9yZGVySG9sZGVycy5tYXAob3JkZXJIb2xkZXIgPT4gb3JkZXJIb2xkZXIuY2VudHJhbENvbnRlbnRPcmRlciB8fCBbXSkpO1xuICAgIGNvbnN0IGtyT3JkZXIgPSBmbGF0dGVuKG9yZGVySG9sZGVycy5tYXAob3JkZXJIb2xkZXIgPT4gb3JkZXJIb2xkZXIua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgfHwgW10pKTtcbiAgICBjb25zdCBvYmpDbG9uZSA9IE9iamVjdC5hc3NpZ24oe30sIG9iaik7XG4gICAgaWYgKG9iakNsb25lLmFiaWxpdGllcykgb2JqQ2xvbmUuYWJpbGl0aWVzID0gZ2V0T3JkZXJlZERvY3Mob2JqLmFiaWxpdGllcywgYWJpbGl0aWVzT3JkZXIpO1xuICAgIGlmIChvYmpDbG9uZS5jZW50cmFsQ29udGVudCkgb2JqQ2xvbmUuY2VudHJhbENvbnRlbnQgPSBnZXRPcmRlcmVkRG9jcyhvYmouY2VudHJhbENvbnRlbnQsIGNjT3JkZXIpO1xuICAgIGlmIChvYmpDbG9uZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMpIG9iakNsb25lLmtub3dsZWRnZVJlcXVpcmVtZW50cyA9IGdldE9yZGVyZWREb2NzKG9iai5rbm93bGVkZ2VSZXF1aXJlbWVudHMsIGtyT3JkZXIpO1xuICAgIHJldHVybiBvYmpDbG9uZTtcbiAgfSk7XG59XG4iLCJpbXBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9IGZyb20gXCJrZWRiYWNrZW5kL3JlcG9cIjtcbmltcG9ydCB7IFJvdXRlQ29tcG9uZW50UHJvcHMgfSBmcm9tICdyZWFjdC1yb3V0ZXInO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL2RiJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IENvdXJzZUluc3RhbmNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFB1Ymxpc2hDb3Vyc2VBcmd1bWVudHMge1xuICBzY2hvb2w6IHN0cmluZztcbiAgZHJhZnRSZXBvOiBLZWRCYWNrZW5kUmVwbztcbiAgY291cnNlOiBDb3Vyc2VJbnN0YW5jZTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHB1Ymxpc2hDb3Vyc2Uoe3NjaG9vbCwgZHJhZnRSZXBvLCBjb3Vyc2V9OiBQdWJsaXNoQ291cnNlQXJndW1lbnRzKSB7XG4gIGxldCBkZXN0aW5hdGlvblJlcG86IEtlZEJhY2tlbmRSZXBvO1xuICBpZiAoc2Nob29sID09PSBcInN0YW5kYXJkXCIpIHtcbiAgICAvLyBFZGl0aW5nIFN0YW5kYXJkIFNjaG9vbCBzaG91bGQgbWVyZ2UgdG8gcmVhbGl0eS5cbiAgICBkcmFmdFJlcG8ubWVyZ2UoKTtcbiAgICBkZXN0aW5hdGlvblJlcG8gPSBkYjtcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBFZGl0aW5nIGNlcnRhaW4gc2Nob29sIHNob3VsZCBtZXJnZSB0byBzY2hvb2wgYnJhbmNoLlxuICAgIGNvbnN0IHNjaG9vbEJyYW5jaElkID0gYXdhaXQgZGIuc2Nob29scy5uYW1lKHNjaG9vbCkuc2luZ2xlKCkubWFwKHNjaG9vbCA9PiBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCkubG9hZCgpO1xuICAgIGRyYWZ0UmVwby5tZXJnZShzY2hvb2xCcmFuY2hJZCk7XG4gICAgZGVzdGluYXRpb25SZXBvID0gZGIuYnJhbmNoKHNjaG9vbEJyYW5jaElkKTtcbiAgfVxuICBkZXN0aW5hdGlvblJlcG8uY291cnNlSW5zdGFuY2VzLnVwZGF0ZShjb3Vyc2UsIHtcbiAgICBtb2RpZmllZERhdGU6IERhdGUubm93KCksXG4gICAgbW9kaWZpZWRCeToge1xuICAgICAgbmFtZTogZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lLFxuICAgICAgdXJsOiBgbWFpbHRvOiR7ZW52LmN1cnJlbnRVc2VyLm1haWx9YFxuICAgIH1cbiAgfSk7XG4gIC8vYXdhaXQgZGIuc2F2ZU5vdygpO1xuICAvL2hpc3RvcnkucHVzaChgLyR7c2Nob29sfS9jb3Vyc2VzLyR7Y291cnNlSWR9L3RhYnMvJHthY3RpdmVUYWIgfHwgJyQnfWApO1xufVxuXG4iLCJpbXBvcnQgeyBEb2N1bWVudCwgQ291cnNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQ291cnNlTW9kdWxlLCBUYXNrLCBTb2Z0RG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBmbGF0dGVuLCBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBXaXRoR3JhcGhzIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcbmltcG9ydCB7IGdldEVtYWlsRnJvbURvY0FjY2VzcyB9IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFVuY292ZXJlZEtub3dsZWRnZVJlcXVpcmVtZW50cyhjb3Vyc2U6IENvdXJzZSkge1xuICBjb25zdCB1bmNvdmVyZWRSZXF1aXJlbWVudHMgPSBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLnJlZHVjZSgocmVzdWx0LCBpdGVtKSA9PiB7XG4gICAgcmVzdWx0W2l0ZW0uaWRdID0gaXRlbTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9LCB7fSBhcyB7IFtpZDogc3RyaW5nXTogS25vd2xlZGdlUmVxdWlyZW1lbnQgfSk7XG5cbiAgY291cnNlLnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgdGFzay5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZm9yRWFjaChrciA9PiB7XG4gICAgICBkZWxldGUgdW5jb3ZlcmVkUmVxdWlyZW1lbnRzW2tyLmlkXTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKHVuY292ZXJlZFJlcXVpcmVtZW50cykubWFwKGlkID0+IHVuY292ZXJlZFJlcXVpcmVtZW50c1tpZF0pO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcXNSZWZlcmVuY2luZ0RvYyB7XG4gIGtub3dsZWRnZVJlcXVpcmVtZW50czogQXJyYXk8e2lkOiBzdHJpbmd9PlxuICBhYmlsaXRpZXM6IEFycmF5PHtpZDogc3RyaW5nfT5cbiAgY2VudHJhbENvbnRlbnQ6IEFycmF5PHtpZDogc3RyaW5nfT5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldElkc05vdENvdmVyZWRCeVRhc2tzKGNvdXJzZTogQ291cnNlKSA6IHtbaWQ6IHN0cmluZ106IHRydWV9IHtcbiAgcmV0dXJuIGdldElkc05vdENvdmVyZWRCeVJlcVJlZmVyZW5jaW5nRG9jcyhcbiAgICBbY291cnNlIGFzIFdpdGhHcmFwaHM8Q291cnNlLCBcImFiaWxpdGllc1wiIHwgXCJjZW50cmFsQ29udGVudFwiIHwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIj5dLFxuICAgIGNvdXJzZS50YXNrcyBhcyBXaXRoR3JhcGhzPFRhc2ssIFwiYWJpbGl0aWVzXCIgfCBcImNlbnRyYWxDb250ZW50XCIgfCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiPltdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldElkc05vdENvdmVyZWRCeVJlcVJlZmVyZW5jaW5nRG9jcyhcbiAgdGVtcGxhdGVzOiBSZXFzUmVmZXJlbmNpbmdEb2NbXSxcbiAgZG9jc0JlaW5nQ2hlY2tlZDogUmVxc1JlZmVyZW5jaW5nRG9jW10pIDoge1tpZDogc3RyaW5nXTogdHJ1ZX1cbntcbiAgY29uc3QgdW5jb3ZlcmVkSWRzID0ge307XG4gIC8vIDEuIE1hcmsgdGhlIGlkcyBvZiBhbGwga25vd2xlZGdlIHJlcXVpcmVtZW50cywgYWJpbGl0aWVzIGFuZCBjZW50cmFsIGNvbnRlbnQgZm9yIHRoaXMgY291cnNlOlxuICB0ZW1wbGF0ZXMuZm9yRWFjaChjb3Vyc2UgPT4ge1xuICAgIGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZm9yRWFjaChyID0+IHtcbiAgICAgIHVuY292ZXJlZElkc1tyLmlkXSA9IHRydWU7XG4gICAgfSk7XG4gICAgY291cnNlLmFiaWxpdGllcy5mb3JFYWNoKGEgPT4ge1xuICAgICAgdW5jb3ZlcmVkSWRzW2EuaWRdID0gdHJ1ZTtcbiAgICB9KTtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQuZm9yRWFjaChjYyA9PiB7XG4gICAgICB1bmNvdmVyZWRJZHNbY2MuaWRdID0gdHJ1ZTtcbiAgICB9KTtcbiAgfSk7XG4gIC8vIDIuIExpc3QgYWxsIHRhc2tzIGFuZCB1bm1hcmsgYWxsIGlkcyB0aGF0IHRoZXkgcmVmZXIgdG9cbiAgZG9jc0JlaW5nQ2hlY2tlZC5mb3JFYWNoKGRvYyA9PiB7XG4gICAgZG9jLmtub3dsZWRnZVJlcXVpcmVtZW50cy5mb3JFYWNoKGtyID0+IHtcbiAgICAgIGRlbGV0ZSB1bmNvdmVyZWRJZHNba3IuaWRdO1xuICAgIH0pO1xuICAgIGRvYy5hYmlsaXRpZXMuZm9yRWFjaChhID0+IHtcbiAgICAgIGRlbGV0ZSB1bmNvdmVyZWRJZHNbYS5pZF07XG4gICAgfSk7XG4gICAgZG9jLmNlbnRyYWxDb250ZW50LmZvckVhY2goY2MgPT4ge1xuICAgICAgZGVsZXRlIHVuY292ZXJlZElkc1tjYy5pZF07XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gdW5jb3ZlcmVkSWRzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2FuaXR5Q2hlY2sgKGNvdXJzZTogQ291cnNlKSB7XG4gIGZ1bmN0aW9uIGhhc0R1cGxpY2F0ZVRhc2tzKGNvdXJzZTogQ291cnNlKSB7XG4gICAgY29uc3QgdGFza0lkczoge1tpZDpzdHJpbmddOiBib29sZWFufSA9IHt9O1xuICAgIHJldHVybiBmbGF0dGVuKGNvdXJzZS5tb2R1bGVzLm1hcChtb2R1bGUgPT4gbW9kdWxlLnRhc2tJZHMubWFwKHRhc2tJZCA9PiB7XG4gICAgICBpZiAodGFza0lkc1t0YXNrSWRdKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBjb3Vyc2UudGFza3MuZmluZCh0ID0+IHQuaWQgPT09IHRhc2tJZCk7XG4gICAgICAgIHJldHVybiBMYFNhbW1hIHVwcGdpZnQgZsO2cmVrb21tZXIgZmxlcmEgZ8OlbmdlcjogXCIke3Rhc2submFtZX1cImA7XG4gICAgICB9XG4gICAgICB0YXNrSWRzW3Rhc2tJZF0gPSB0cnVlO1xuICAgIH0pLmZpbHRlcih4ID0+IHgpKSk7XG4gIH1cblxuICBmdW5jdGlvbiB0YXNrc1dpdGhTYW1lVXJsKGNvdXJzZTogQ291cnNlKSB7XG4gICAgY29uc3QgdGFza1VybHM6IHtbdXJsOnN0cmluZ106IFRhc2t9ID0ge307XG4gICAgcmV0dXJuIGNvdXJzZS50YXNrcy5tYXAodGFzayA9PiB7XG4gICAgICBpZiAodGFzay51cmwpIHtcbiAgICAgICAgaWYgKHRhc2tVcmxzW3Rhc2sudXJsXSkge1xuICAgICAgICAgIHJldHVybiBMYFR2w6UgdXBwZ2lmdGVyIHBla2FyIHDDpSBzYW1tYSBVUkw6IFwiJHt0YXNrVXJsc1t0YXNrLnVybF0ubmFtZX1cIiBzYW10IFwiJHt0YXNrLm5hbWV9XCJgO1xuICAgICAgICB9XG4gICAgICAgIHRhc2tVcmxzW3Rhc2sudXJsXSA9IHRhc2s7XG4gICAgICB9XG4gICAgfSkuZmlsdGVyKHggPT4geCk7ICBcbiAgfVxuXG4gIGZ1bmN0aW9uIGhhc0VtcHR5TW9kdWxlTmFtZXMoY291cnNlOiBDb3Vyc2UpIHtcbiAgICByZXR1cm4gY291cnNlLm1vZHVsZXMuc29tZSAobW9kdWxlID0+IG1vZHVsZS5uYW1lID09PSBcIlwiKSAmJlxuICAgICAgTGBEZXQgZmlubnMgbWluc3QgZW4gbW9kdWwgdXRhbiBhbmdpdmV0IG5hbW5gO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFzRHVwbGljYXRlTW9kdWxlTmFtZXMoY291cnNlOiBDb3Vyc2UpIHtcbiAgICBjb25zdCBtb2R1bGVOYW1lczoge1tuYW1lOiBzdHJpbmddOiB0cnVlfSA9IHt9O1xuICAgIHJldHVybiBjb3Vyc2UubW9kdWxlcy5tYXAobW9kdWxlID0+IHtcbiAgICAgIGlmIChtb2R1bGUubmFtZSAmJiBtb2R1bGVOYW1lc1ttb2R1bGUubmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIExgTW9kdWxlbiBtZWQgbmFtbiAke21vZHVsZS5uYW1lfSBmw7ZyZWtvbW1lciBmbGVyYSBnw6VuZ2VyYDtcbiAgICAgIH1cbiAgICAgIGlmIChtb2R1bGUubmFtZSkgbW9kdWxlTmFtZXNbbW9kdWxlLm5hbWVdID0gdHJ1ZTtcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgY2hlY2tzID0gZmxhdHRlbihbXG4gICAgaGFzRHVwbGljYXRlVGFza3MoY291cnNlKSxcbiAgICB0YXNrc1dpdGhTYW1lVXJsKGNvdXJzZSksXG4gICAgaGFzRW1wdHlNb2R1bGVOYW1lcyhjb3Vyc2UpLFxuICAgIGhhc0R1cGxpY2F0ZU1vZHVsZU5hbWVzKGNvdXJzZSlcbiAgXSk7XG5cbiAgcmV0dXJuIGNoZWNrcy5maWx0ZXIgKHJlc3VsdCA9PiByZXN1bHQpO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYXNrc1BlcklkIChjb3Vyc2U6IENvdXJzZSkge1xuICBjb25zdCByZXN1bHQ6IHtbaWQ6IHN0cmluZ106IFRhc2tbXX0gPSB7fTtcbiAgZnVuY3Rpb24gYWRkKGlkOiBzdHJpbmcsIHRhc2s6IFRhc2spIHtcbiAgICBjb25zdCBsaXN0ID0gcmVzdWx0W2lkXSB8fCAocmVzdWx0W2lkXSA9IFtdKTtcbiAgICBsaXN0LnB1c2godGFzayk7XG4gIH1cbiAgY291cnNlLnRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgdGFzay5hYmlsaXRpZXMuZm9yRWFjaChhID0+IGFkZChhLmlkLCB0YXNrKSk7XG4gICAgdGFzay5jZW50cmFsQ29udGVudC5mb3JFYWNoKGMgPT4gYWRkKGMuaWQsIHRhc2spKTtcbiAgICB0YXNrLmZ1dHVyZUFiaWxpdGllcy5mb3JFYWNoKGZhID0+IGFkZChmYSwgdGFzaykpO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqIFJldHVybnMgYW4gYWNjZXNzIGxpc3QgZm9yIGEgY291cnNlIGluIGEgYmFja3dhcmQgY29tcGF0aWJsZSB3YXkgKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTb2Z0QWNjZXNzTGlzdCAoY291cnNlOiBDb3Vyc2UpOiBTb2Z0RG9jdW1lbnRBY2Nlc3NbXSB7XG4gIGNvbnN0IHtyZXNwb25zaWJsZVRlYWNoZXJzfSA9IGNvdXJzZTtcbiAgY29uc3QgcmVzdWx0ID0gcmVzcG9uc2libGVUZWFjaGVycy5tYXAoZGEgPT4oe1xuICAgIG5hbWU6IGRhLm5hbWUsXG4gICAgZW1haWw6IGdldEVtYWlsRnJvbURvY0FjY2VzcyhkYSksXG4gICAgYWNjZXNzOiBkYS5hY2Nlc3MgfHwgJ2VkaXQnXG4gIH0gYXMgU29mdERvY3VtZW50QWNjZXNzKSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdFwiO1xuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgcmVhZEJsb2JBc1RleHQsIGFsbG93Q29weSwgcmVhZEJsb2JBc0RhdGFVcmwgfSBmcm9tIFwiLi4vdXRpbHNcIjtcbmltcG9ydCB7IHNob3dFcnJvciwgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gXCJrZWRiYWNrZW5kL2NsaWVudFwiO1xuaW1wb3J0IHsgaGFzQWNjZXNzIH0gZnJvbSBcIi4uLy4uLy4uL2FjY2Vzcy1jb250cm9sXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5cbnR5cGUgQ2FsbGJhY2sgPSAoKSA9PiB2b2lkO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0aXRsZTogc3RyaW5nLFxuICBhY3RpdmVQYWdlOiBCYW5uZXJNZW51SXRlbSxcbiAgY2FsbGJhY2tzPzogeyBbbWVudU5hbWU6IHN0cmluZ106IENhbGxiYWNrIH0sXG4gIHJvdXRlczogeyBbbWVudU5hbWU6IHN0cmluZ106IHN0cmluZyB9ICYgeyBmZWVkYmFjazogc3RyaW5nIH0sXG4gIGJhY2tncm91bmRJbWFnZT86IHN0cmluZyxcbiAgaXNUZW1wbGF0ZT8sXG4gIGhvc3Q/OiBJQ291cnNlRWRpdG9ySG9zdCxcbiAgY291cnNlPzogQ291cnNlLFxuICBvcmlnQ291cnNlPzogQ291cnNlXG59XG5cbnR5cGUgQmFubmVyTWVudUl0ZW0gPVxuICBcImNvdXJzZUJ1aWxkZXJcIiB8XG4gIFwic3R1ZGVudFBhZ2VcIiB8XG4gIFwidGVtcGxhdGVCdWlsZGVyXCIgfFxuICBcInN1YmplY3RzXCIgfFxuICBcInNjaG9vbHNcIjtcblxuY29uc3QgQWRtaW5NZW51SXRlbXMgPSBbXG4gIHsgbmFtZTogXCJzY2hvb2xzXCIsIHRleHQ6IExgU2tvbG9yYCwgcm91dGU6IFwiL3NjaG9vbHNcIiB9LFxuICB7IG5hbWU6IFwic3ViamVjdHNcIiwgdGV4dDogTGDDhG1uZW5gLCByb3V0ZTogXCIvc3ViamVjdHNcIiB9LFxuICAvL3tuYW1lOiBcInRlbXBsYXRlQnVpbGRlclwiLCB0ZXh0OiBMYE1hbGxieWdnYXJlbmAsIHJvdXRlOiBcIi9jb3Vyc2UtdGVtcGxhdGVzXCJ9LFxuXVxuXG5jb25zdCBOb25BZG1pbk1lbnVJdGVtcyA9IFtcbiAgeyBuYW1lOiBcImNvdXJzZUJ1aWxkZXJcIiwgdGV4dDogTGBLdXJzYnlnZ2FyZW5gLCByb3V0ZTogXCIvY291cnNlcy9uZXdcIiB9LFxuICB7IG5hbWU6IFwic3R1ZGVudFBhZ2VcIiwgdGV4dDogTGBFbGV2c2lkYWAsIHJvdXRlOiBcIlwiIH0sXG4gIHsgbmFtZTogXCJmZWVkYmFja1wiLCB0ZXh0OiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYSBmYS1jb21tZW50aW5nLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IEZlZWRiYWNrPC9zcGFuPiwgcm91dGU6IFwiaHR0cHM6Ly9rZy5rdW5za2Fwc3BvcnRlbi5zZS9rdXJzYnlnZ2FyZW4vXCIgfVxuXVxuXG5cbmFzeW5jIGZ1bmN0aW9uIG9uRHJvcEltYWdlKGV2OiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+LCBob3N0OiBJQ291cnNlRWRpdG9ySG9zdCwgY291cnNlOiBDb3Vyc2UsIG9yaWdDb3Vyc2U6IENvdXJzZSkge1xuICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgZmlsZXMgPSBldi5kYXRhVHJhbnNmZXIuZmlsZXM7XG4gIGxldCB1cmwgPSBudWxsO1xuICBjb25zdCBpdGVtcyA9IEFycmF5LmZyb20oZXYuZGF0YVRyYW5zZmVyLml0ZW1zKTtcbiAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBmaWxlID0gZmlsZXNbMF07XG4gICAgaWYgKGZpbGUuc2l6ZSA+IDIgKiAxMDI0ICogMTAyNCkge1xuICAgICAgc2hvd0Vycm9yKExgS2FuIGludGUgbGFkZGEgdXBwIGJpbGRlciBzdMO2cnJlIMOkbiAyIE1CYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vdXJsID0gYXdhaXQgcmVhZEJsb2JBc0RhdGFVcmwoZmlsZSk7XG4gICAgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgIGZvcm0uYXBwZW5kKFwiZmlsZXNcIiwgZmlsZSk7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cC5mZXRjaChcbiAgICAgICd3ZWItdXBsb2FkJyxcbiAgICAgICdwdXQnLFxuICAgICAge30sXG4gICAgICB7fSxcbiAgICAgIHtcbiAgICAgICAgYm9keTogZm9ybVxuICAgICAgfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgc2hvd0Vycm9yKExgS3VuZGUgaW50ZSBsYWRkYSB1cHAgZmlsZW4gdGlsbCBHb29nbGUgU3RvcmFnZWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB1cmwgPSBhd2FpdCByZXMudGV4dCgpO1xuICB9IGVsc2Uge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBpdGVtc1tpXTtcbiAgICAgIGlmIChpdGVtLnR5cGUubWF0Y2goJ150ZXh0L3VyaS1saXN0JykpIHtcbiAgICAgICAgLy8gVVJJXG4gICAgICAgIHVybCA9IGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gaXRlbS5nZXRBc1N0cmluZyhyZXNvbHZlKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmICh1cmwgPT0gbnVsbCkge1xuICAgIHNob3dFcnJvcihMYEt1bmRlIGludGUgaGl0dGEgbsOlZ29uIGJpbGQgaSBpbm5laMOlbGxldGApO1xuICAgIHJldHVybjtcbiAgfVxuICBzZXRDb3Vyc2VJbWFnZShjb3Vyc2UsIG9yaWdDb3Vyc2UsIGhvc3QsIHVybCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb3Vyc2VJbWFnZShcbiAgY291cnNlOiBDb3Vyc2UsXG4gIG9yaWdDb3Vyc2U6IENvdXJzZSxcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3QsXG4gIHVybDogc3RyaW5nXG4pIHtcbiAgY29uc3QgaW1hZ2VJZCA9IGNyZWF0ZVVVSUQoKTtcbiAgaG9zdC51cGRhdGUoe1xuICAgIGltYWdlSWQ6IHsgJHNldDogaW1hZ2VJZCB9LFxuICAgIGltYWdlczoge1xuICAgICAgJHNldDogW3tcbiAgICAgICAgaWQ6IGltYWdlSWQsXG4gICAgICAgIHVybCxcbiAgICAgICAgYWNsOiBbXG4gICAgICAgICAgYHJvbGU6VVNFUjpSYCxcbiAgICAgICAgICBgc2Nob29sUm9sZToke2Vudi5jdXJyZW50VXNlci5zY2hvb2x9L0VNUExPWUVFOlNgXG4gICAgICAgIF0sXG4gICAgICAgICRtZXRhOiAnYWRkJ1xuICAgICAgfV1cbiAgICB9XG4gIH0pO1xufVxuXG4vKiBUaGlzIHZlcnNpb24gaGFkIHRoZSBidWcgdGhhdCBvbGQgaW1hZ2VzIHdlcmUgbm90IHJlcGxhY2VkLlxuT25lIGNvdXJzZSBhdCBVcHBzYWxhIGNvbnRhaW5lZCAxMiBpbWFnZXMuXG5cblxuZXhwb3J0IGZ1bmN0aW9uIHNldENvdXJzZUltYWdlT2xkKFxuICBjb3Vyc2U6IENvdXJzZSxcbiAgb3JpZ0NvdXJzZTogQ291cnNlLFxuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdCxcbiAgdXJsOiBzdHJpbmcpXG57XG4gIGlmICghb3JpZ0NvdXJzZSB8fCAhb3JpZ0NvdXJzZS5pbWFnZUlkKSB7XG4gICAgY29uc3QgaW1hZ2VJZCA9IGNyZWF0ZVVVSUQoKTtcbiAgICBob3N0LnVwZGF0ZSh7XG4gICAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcbiAgICAgIGltYWdlczoge1xuICAgICAgICAkcHVzaDogW3tcbiAgICAgICAgICBpZDogaW1hZ2VJZCxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgYWNsOiBjb3Vyc2UuaXNUZW1wbGF0ZSA/IFtcInJvbGU6VVNFUjpSXCJdIDogW1wicm9sZTpVU0VSOlJcIiwgYHNjaG9vbFJvbGU6JHtlbnYuY3VycmVudFVzZXIuc2Nob29sfS9FTVBMT1lFRTpTYF0sXG4gICAgICAgICAgJG1ldGE6ICdhZGQnXG4gICAgICAgIH1dXG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgLy8gVXBkYXRlIGV4aXN0aW5nIGltYWdlOlxuICAgIGNvbnN0IGltZ0lkeCA9IGNvdXJzZS5pbWFnZXMuZmluZEluZGV4KGltZyA9PiBpbWcuaWQgPT09IGNvdXJzZS5pbWFnZUlkKTtcbiAgICBpZiAoaW1nSWR4ID49IDApIHtcbiAgICAgIGNvbnN0IGltYWdlRW50aXR5ID0gY291cnNlLmltYWdlc1tpbWdJZHhdO1xuICAgICAgaWYgKGNvdXJzZS5pc1RlbXBsYXRlKSB7XG4gICAgICAgIC8vIFRlbXBsYXRlczogVXBkYXRlIHRoZSB0ZW1wbGF0ZSBpbWFnZSBjb250ZW50OlxuICAgICAgICBob3N0LnVwZGF0ZSh7XG4gICAgICAgICAgaW1hZ2VzOiB7XG4gICAgICAgICAgICAkc3BsaWNlOiBbW2ltZ0lkeCwgMSwge1xuICAgICAgICAgICAgICAuLi5pbWFnZUVudGl0eSxcbiAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAkbWV0YTogJ3VwZGF0ZSdcbiAgICAgICAgICAgIH1dXVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJlYWwgY291cnNlczogUmVwbGFjZSB3aXRoIGEgbmV3IGltYWdlXG4gICAgICAgIGNvbnN0IGltYWdlSWQgPSBjcmVhdGVVVUlEKCk7XG4gICAgICAgIGhvc3QudXBkYXRlKHtcbiAgICAgICAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcbiAgICAgICAgICBpbWFnZXM6IHtcbiAgICAgICAgICAgICRzcGxpY2U6IFtbaW1nSWR4LCAxLCB7XG4gICAgICAgICAgICAgIGlkOiBpbWFnZUlkLFxuICAgICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICAgIGFjbDogW1xuICAgICAgICAgICAgICAgIGByb2xlOlVTRVI6UmAsXG4gICAgICAgICAgICAgICAgYHNjaG9vbFJvbGU6JHtlbnYuY3VycmVudFVzZXIuc2Nob29sfS9FTVBMT1lFRTpTYFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAkbWV0YTogJ2FkZCdcbiAgICAgICAgICAgIH1dXVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2hvd0Vycm9yKExgS3VuZGUgaW50ZSB1cHBkYXRlcmEgYmlsZGVuLmApO1xuICAgIH1cbiAgfVxufVxuKi9cblxuZXhwb3J0IGNvbnN0IENvdXJzZUJhbm5lciA9IChwcm9wczogUHJvcHMpID0+IHtcbiAgY29uc3QgeyB0aXRsZSwgaXNUZW1wbGF0ZSwgaG9zdCwgY291cnNlLCBvcmlnQ291cnNlLCBiYWNrZ3JvdW5kSW1hZ2UsIGFjdGl2ZVBhZ2UgfSA9IHByb3BzO1xuICBjb25zdCBpc0FkbWluID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSBcIkFETUlOXCIpO1xuICBsZXQgbWVudUl0ZW1zID0gTm9uQWRtaW5NZW51SXRlbXM7XG4gIGlmIChpc0FkbWluKSBtZW51SXRlbXMgPSBBZG1pbk1lbnVJdGVtcy5jb25jYXQobWVudUl0ZW1zKTtcblxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAge2JhY2tncm91bmRJbWFnZSAmJiA8c3R5bGU+e2BcbiAgICAgICAgLnBhZ2VIZWFkZXIge1xuICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHtiYWNrZ3JvdW5kSW1hZ2V9JykgIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgICAgYH08L3N0eWxlPn1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlSGVhZGVyXCJcbiAgICAgICAgICBvbkRyYWdPdmVyPXtjb3Vyc2UgJiYgYWxsb3dDb3B5fVxuICAgICAgICAgIG9uRHJvcD17Y291cnNlICYmIChldiA9PiBvbkRyb3BJbWFnZShldiwgaG9zdCwgY291cnNlLCBvcmlnQ291cnNlKSl9PlxuICAgICAgICAgIDxhPlxuICAgICAgICAgICAgPGgxPnt0aXRsZX08L2gxPlxuICAgICAgICAgIDwvYT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ1dHRvbnNGaWVsZFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zQ29udGFpbmVyXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPjwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0naG9yaXpvbnRhbE1lbnUnPlxuICAgICAgICAgICAgICAgIDx1bD5cbiAgICAgICAgICAgICAgICAgIHttZW51SXRlbXMubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IGFjdGl2ZVBhZ2UgPT09IGl0ZW0ubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6IHByb3BzLmNhbGxiYWNrcyAmJiBwcm9wcy5jYWxsYmFja3NbaXRlbS5uYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgZ2l2ZW5Sb3V0ZTogKHByb3BzLnJvdXRlcyAmJiBwcm9wcy5yb3V0ZXNbaXRlbS5uYW1lXSksXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRSb3V0ZTogaXRlbS5yb3V0ZVxuICAgICAgICAgICAgICAgICAgfSkpLmZpbHRlcih4ID0+IHguY2FsbGJhY2sgfHwgeC5kZWZhdWx0Um91dGUgfHwgeC5naXZlblJvdXRlKS5tYXAoKHsgaXRlbSwgaXNBY3RpdmUsIGNhbGxiYWNrLCBkZWZhdWx0Um91dGUsIGdpdmVuUm91dGUgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gPGxpXG4gICAgICAgICAgICAgICAgICAgICAga2V5PXtpdGVtLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtpc0FjdGl2ZSA/IFwiYWN0aXZlUGFnZVwiIDogXCJcIn1cbiAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtjYWxsYmFja31cbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgIHtjYWxsYmFjayA/XG4gICAgICAgICAgICAgICAgICAgICAgICA8YT57aXRlbS50ZXh0fTwvYT4gOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFJvdXRlIHx8IGdpdmVuUm91dGUgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICBnaXZlblJvdXRlIHx8IC9eaHR0cFtzXVxcOlxcL1xcLy9pLnRlc3QoZGVmYXVsdFJvdXRlKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17Z2l2ZW5Sb3V0ZSB8fCBkZWZhdWx0Um91dGV9PntpdGVtLnRleHR9PC9hPiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmsgdG89e2RlZmF1bHRSb3V0ZX0+e2l0ZW0udGV4dH08L0xpbms+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGE+e2l0ZW0udGV4dH08L2E+fVxuICAgICAgICAgICAgICAgICAgICA8L2xpPjtcbiAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxufVxuIiwiaW1wb3J0IHsgS25vd2xlZGdlUmVxdWlyZW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBmbGF0dGVuIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG4vL2dldCBzZW50ZW5jZXMgYnkgcmVxdWlyZW1lbnRcbmV4cG9ydCBmdW5jdGlvbiBnZXRSZXF1aXJtZW50U2VudGVuY2VzKHJlcXVpcmVtZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gIHJldHVybiByZXF1aXJlbWVudC5zcGxpdChcIi5cIikuZmlsdGVyKGUgPT4geyByZXR1cm4gZSB9KTtcbn1cblxuLy9yZXRyaWV2ZSBzZW50ZW5jZXNcbmV4cG9ydCBmdW5jdGlvbiBnZXRTYXZlZFNlbnRlbmNlcyhwYXJ0aWFsUmVxdWlybWVudHM6IHN0cmluZyBbXSk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIHBhcnRpYWxSZXF1aXJtZW50cy5tYXAoZnVuY3Rpb24gKG9iaikge1xuICAgIHJldHVybiBvYmoudHJpbSgpO1xuICB9KSB8fCBbXTtcbn1cblxuLy9jaGVjayBhbGwgcmVxdWlyZW1lbnRzIGFyZSBtYXJrZWRcbmV4cG9ydCBmdW5jdGlvbiBhbGxSZXF1aXJlbWVudFNlbnRlY2VzTWFya2VkKHJlcXVpcmVtZW50TmFtZTogc3RyaW5nLCBwYXJ0aWFsUmVxdWlyZW1lbnRzOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICB2YXIgdGV4dFNlbnRlbmNlcyA9IGdldFJlcXVpcm1lbnRTZW50ZW5jZXMocmVxdWlyZW1lbnROYW1lKTtcbiAgcmV0dXJuIHBhcnRpYWxSZXF1aXJlbWVudHMgJiYgcGFydGlhbFJlcXVpcmVtZW50cy5sZW5ndGggPT09IHRleHRTZW50ZW5jZXMubGVuZ3RoOztcbn1cblxuLy9nZXQgdGhlIHBhcnRpYWwgc2F2ZWQgc2VudGVuY2VzIGZvciB0aGUgZGVmYXVsdCB2aWV3XG5leHBvcnQgZnVuY3Rpb24gZ2V0UGFydGlhbENvbnRlbnREZWZhdWx0VmlldyhyZXF1aXJlbWVudDogS25vd2xlZGdlUmVxdWlyZW1lbnQsIHBhcnRpYWxSZXF1aXJtZW50czpzdHJpbmcgW10sIGFscmVhZHlDb3ZlcmVkUGFydGlhbFJlcXVpcm1lbnRzOiB7IFtpZDogc3RyaW5nXTogc3RyaW5nIFtdfVtdLCBza2lwTm90TWFya2VkOiBib29sZWFuKTogc3RyaW5nIHtcbiAgdmFyIHJlc3VsdGVkSHRtbCA9IHJlcXVpcmVtZW50Lm5hbWU7XG4gIHZhciB0ZXh0U2VudGVuY2VzID0gZ2V0UmVxdWlybWVudFNlbnRlbmNlcyhyZXF1aXJlbWVudC5uYW1lKTtcbiAgdmFyIHJvd1JlcXVpcm1lbnRzID0gcGFydGlhbFJlcXVpcm1lbnRzICYmIGdldFNhdmVkU2VudGVuY2VzKHBhcnRpYWxSZXF1aXJtZW50cyk7XG4gIHZhciBhbGxSZXFDb3ZlcmVkU2VudGVuY2UgPSBhbHJlYWR5Q292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cyAmJiBnZXRDb3ZlcmVkU2VudGVjZXMoYWxyZWFkeUNvdmVyZWRQYXJ0aWFsUmVxdWlybWVudHMsIHJlcXVpcmVtZW50LmlkKTtcbiAgdmFyIGFsbFJlcVNlbnRlbmNlc01hcmtlZCA9IGFsbFJlcXVpcmVtZW50U2VudGVjZXNNYXJrZWQocmVxdWlyZW1lbnQubmFtZSwgcm93UmVxdWlybWVudHMpO1xuXG4gIHRleHRTZW50ZW5jZXMuZm9yRWFjaChzZW50ZW5jZSA9PiB7XG4gICAgLy90cmltbSBjdXJyZW50IHNlbnRlbmNlXG4gICAgdmFyIHRyaW1tZWRTZW50ZW5jZSA9IHNlbnRlbmNlLnRyaW0oKTtcbiAgICB2YXIgZnVsbFNlbnRlbmNlID0gc2VudGVuY2UgKyBcIi5cIjtcbiAgICBpZiAocm93UmVxdWlybWVudHMgJiYgcm93UmVxdWlybWVudHMuaW5jbHVkZXModHJpbW1lZFNlbnRlbmNlKSAmJiAhYWxsUmVxU2VudGVuY2VzTWFya2VkKSB7XG4gICAgICByZXN1bHRlZEh0bWwgPSByZXN1bHRlZEh0bWwucmVwbGFjZShmdWxsU2VudGVuY2UsIGA8c3BhbiBjbGFzcz0ke1wibWFya2VkR3JlZW5cIn0+JHtmdWxsU2VudGVuY2V9PC9zcGFuPmApO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHZhciBjb3ZlcmVkU2VudGVjZSA9IGFsbFJlcUNvdmVyZWRTZW50ZW5jZSAmJiBhbGxSZXFDb3ZlcmVkU2VudGVuY2UuaW5jbHVkZXModHJpbW1lZFNlbnRlbmNlKTtcbiAgICAgIGlmKGNvdmVyZWRTZW50ZWNlKXtcbiAgICAgICAgcmVzdWx0ZWRIdG1sID0gcmVzdWx0ZWRIdG1sLnJlcGxhY2UoZnVsbFNlbnRlbmNlLCBgPHNwYW4+JHtmdWxsU2VudGVuY2V9PC9zcGFuPmApO1xuICAgICAgfSBlbHNlIGlmICghYWxsUmVxU2VudGVuY2VzTWFya2VkICYmIGFsbFJlcUNvdmVyZWRTZW50ZW5jZSAmJiBhbGxSZXFDb3ZlcmVkU2VudGVuY2UubGVuZ3RoID4gMCkge1xuICAgICAgICByZXN1bHRlZEh0bWwgPSByZXN1bHRlZEh0bWwucmVwbGFjZShmdWxsU2VudGVuY2UsIGA8c3BhbiBjbGFzcz0ke1wibWFya2VkUmVkXCJ9PiR7ZnVsbFNlbnRlbmNlfTwvc3Bhbj5gKTtcbiAgICAgIH0gXG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdGVkSHRtbDtcbn1cblxuLy9jaGVjayB0aGUgY3VycmVudCByZXF1aXJlbWVudCBpcyBhbHJlYWR5IGNvdmVyZWRcbmV4cG9ydCBmdW5jdGlvbiBpc1BhcnRpYWxDb3ZlcmVkUmVxdWlybWVudChyZXF1aXJlbWVudDogS25vd2xlZGdlUmVxdWlyZW1lbnQsIGFscmVhZHlDb3ZlcmVkUGFydGlhbFJlcXVpcm1lbnRzOiB7IFtpZDogc3RyaW5nXTogc3RyaW5nIFtdfVtdKXtcbiAgdmFyIHRleHRTZW50ZW5jZXMgPSBnZXRSZXF1aXJtZW50U2VudGVuY2VzKHJlcXVpcmVtZW50Lm5hbWUpO1xuICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gIGZvcih2YXIgaT0wOyBpIDwgdGV4dFNlbnRlbmNlcy5sZW5ndGg7IGkrKyl7XG4gICAgdmFyIHRyaW1tZWRTZW50ZW5jZSA9IHRleHRTZW50ZW5jZXNbaV0udHJpbSgpO1xuICAgIHZhciBhbGxDb3ZlcmVkU2VudGVuY2VSZXEgPSBhbHJlYWR5Q292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cyAmJiBnZXRDb3ZlcmVkU2VudGVjZXMoYWxyZWFkeUNvdmVyZWRQYXJ0aWFsUmVxdWlybWVudHMsIHJlcXVpcmVtZW50LmlkKTtcbiAgICB2YXIgY292ZXJlZFNlbnRlY2UgPSBhbGxDb3ZlcmVkU2VudGVuY2VSZXEgJiYgYWxsQ292ZXJlZFNlbnRlbmNlUmVxLmluY2x1ZGVzKHRyaW1tZWRTZW50ZW5jZSk7XG4gICAgaWYoY292ZXJlZFNlbnRlY2Upe1xuICAgICAgcmVzdWx0ID0gdHJ1ZTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vL2NvbXB1dGUgdGhlIGNvdmVyZWQgc2VudGVjZXMgZXhjbHVkaW5nIHRoZSBjdXJyZW50IHJlcXVpcmVtZW50XG5leHBvcnQgZnVuY3Rpb24gZ2V0Q292ZXJlZFNlbnRlY2VzKGFsbFJlcTogeyBbaWQ6IHN0cmluZ106IHN0cmluZyBbXX1bXSwgcmVxdWlyZW1lbnRJZDogc3RyaW5nKTogc3RyaW5nW10ge1xuICB2YXIgcmVzdWx0QXJyYXkgPSBbXTtcbiAgYWxsUmVxLmZvckVhY2gob2JqID0+IHtcbiAgICB2YXIgYXNzaWduZWRSZXEgPSBPYmplY3QuYXNzaWduKFtdLCBPYmplY3Qua2V5cyhvYmopLmZpbHRlcihyZXFJZCA9PiByZXFJZCA9PSByZXF1aXJlbWVudElkKS5tYXAoayA9PiBvYmpba10ubWFwKGVsZW0gPT4gZWxlbS50cmltKCkpKSk7XG4gICAgcmVzdWx0QXJyYXkucHVzaCguLi5hc3NpZ25lZFJlcSk7XG4gIH0pO1xuICByZXR1cm4gZmxhdHRlbjxzdHJpbmc+KHJlc3VsdEFycmF5KTtcbn1cblxuLy9zb3J0IHRoZSBzZWxlY3RlZCBzZW50ZW5jZXMgYnkgdGhlIG9yZGVyIG9mIHRoZSBhcHBlYXJhbmNlIGluIHRoZSByZXF1aXJlbWVudFxuZXhwb3J0IGZ1bmN0aW9uIGdldFNvcnRlZFJlcXVpcm1lbnRzKHRleHRTZW50ZW5jZXM6IHN0cmluZ1tdLCBwYXJ0aWFsUmVxdWlybWVudHM6IHN0cmluZ1tdKTogc3RyaW5nW117XG4gIHZhciBvdXRwdXQgPSBbXTtcbiAgdmFyIGluZGV4ZWRTZW50ZW5jZXMgPSB0ZXh0U2VudGVuY2VzLm1hcCgoZSAsaSkgPT4ge3JldHVybiB7aW5kOiBpLCB2YWw6IGV9fSk7XG4gIG91dHB1dCA9IGluZGV4ZWRTZW50ZW5jZXMuZmlsdGVyKHM9PiBwYXJ0aWFsUmVxdWlybWVudHMuaW5jbHVkZXMocy52YWwpKTtcbiAgcmV0dXJuIG91dHB1dCA/IG91dHB1dC5zb3J0KCh4LCB5KSA9PiB4LmluZCA+IHkuaW5kID8gMSA6IC0xKS5tYXAocz0+IHMudmFsKSA6IFtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWlncmF0aW9uVGl0bGUoaXNNaWdyYXRlZCwgbWFya01vZGUpe1xuICByZXR1cm4gaXNNaWdyYXRlZCA/XG4gICAgbWFya01vZGUgP1xuICAgICAgYFNrb2x2ZXJrZXQgaGFyIHVwcGRhdGVyYXQgdGV4dGVucyBmb3JtdWxlcmluZy4gRHUga2FuIGdyYW5za2Egw6RuZHJpbmdlbiBnZW5vbSBhdHQgZsOkbGxhIHV0IHZhcm5pbmdzYm94ZW4gdGlsbCBow7ZnZXIsIG1lZCB0aXRlbCBcIlVwcGRhdGVyYWRlIGZvcm11bGVyaW5nYXIgZnLDpW4gU2tvbHZlcmtldFwiYCA6XG4gICAgICBgU2tvbHZlcmtldCBoYXIgdXBwZGF0ZXJhdCB0ZXh0ZW5zIGZvcm11bGVyaW5nLCBtZW4gZGV0dGEgaGFyIMOkbm51IGludGUgZ3JhbnNrYXRzIGF2IHVwcGdpZnRlbnMgcmVkaWdlcmluZ3NiZWjDtnJpZ2VgIDpcbiAgICB1bmRlZmluZWRcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFNjaG9vbCwgQnJhbmNoLCBDb3Vyc2UgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcbmltcG9ydCB7IHNob3dFcnJvciwgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MsIEJhdGNoUnVubmVyIH0gZnJvbSBcImtlZGJhY2tlbmQvY2xpZW50XCI7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGlkPzogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgdHlwZT86ICdneW1uYXNpdW0nIHwgJ3ByaW1hcnknXG59XG5cbnR5cGUgU3RhdGUgPSBTY2hvb2w7XG5cbmV4cG9ydCBjb25zdCBFZGl0U2Nob29sID0gKHByb3BzOiBQcm9wcyAmIHtmZWVkYmFja1VybDogc3RyaW5nfSkgPT4gPGRpdiBzdHlsZT17eyBvdXRsaW5lOiAwIH19PlxuICA8Q291cnNlQmFubmVyXG4gICAgdGl0bGU9XCJTa29sb3JcIiBhY3RpdmVQYWdlPVwic2Nob29sc1wiIGNhbGxiYWNrcz17e3NjaG9vbHM6ICgpPT5sb2NhdGlvbi5oYXNoPVwiIy9zY2hvb2xzXCJ9fVxuICAgIHJvdXRlcz17e2ZlZWRiYWNrOiBwcm9wcy5mZWVkYmFja1VybH19IC8+XG4gIDxFZGl0U2Nob29sTm9CYW5uZXIgey4uLnByb3BzfSAvPlxuPC9kaXY+O1xuXG5leHBvcnQgY2xhc3MgRWRpdFNjaG9vbE5vQmFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIG9yaWdTY2hvb2w6IFNjaG9vbDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IG51bGw7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChlcnIgPT4gc2hvd0Vycm9yKGVycikpO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICBpZiAodGhpcy5wcm9wcy5pZCkge1xuICAgICAgLy8gSUQgZ2l2ZW4sIGxvYWQgaXQuXG4gICAgICBjb25zdCB7IGlkIH0gPSB0aGlzLnByb3BzO1xuICAgICAgY29uc3Qgc2Nob29sID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0PFNjaG9vbD4oXCJzY2hvb2xzXCIsIGlkKTtcbiAgICAgIHRoaXMub3JpZ1NjaG9vbCA9IHsgLi4uc2Nob29sIH07XG4gICAgICB0aGlzLnNldFN0YXRlKHsgLi4uc2Nob29sIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBObyBpZCwgY3JlYXRlIG5ldyBpbnN0ZWFkLlxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIG9mZmljaWFsQnJhbmNoSWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgaXNHeW1uYXNpdW06IHRoaXMucHJvcHMudHlwZSA9PT0gJ2d5bW5hc2l1bScsXG4gICAgICAgIGlzUHJpbWFyeVNjaG9vbDogdGhpcy5wcm9wcy50eXBlID09PSAncHJpbWFyeSdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgY29uc3QgciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgIGxldCBzY2hvb2wgPSB7IC4uLnRoaXMuc3RhdGUsIHRhZ3M6ICh0aGlzLnN0YXRlLnRhZ3MgfHwgW10pXG4gICAgICAuZmlsdGVyKHRhZyA9PiBbXCJwcmltYXJ5XCIsIFwiZ3ltbmFzaXVtXCJdLmluZGV4T2YodGFnKSA8IDApXG4gICAgfTtcblxuICAgIGlmIChzY2hvb2wuaXNQcmltYXJ5U2Nob29sKSBzY2hvb2wudGFncy5wdXNoKFwicHJpbWFyeVwiKTtcbiAgICBpZiAoc2Nob29sLmlzR3ltbmFzaXVtKSBzY2hvb2wudGFncy5wdXNoKFwiZ3ltbmFzaXVtXCIpO1xuICAgIGlmICghKHNjaG9vbC5pc0d5bW5hc2l1bSB8fCBzY2hvb2wuaXNQcmltYXJ5U2Nob29sKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yIChMYFNrb2xhbiBtw6VzdGUgYW50aW5nZW4gdmFyYSBneW1uYXNpdW0gZWxsZXIgZ3J1bmRza29sYWApO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5vcmlnU2Nob29sKSB7XG4gICAgICBzY2hvb2wuYWNsID0gW1wicm9sZTpVU0VSOlJcIl07XG4gICAgICBzY2hvb2wuYWNsLnB1c2goXG4gICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcbiAgICAgICAgICBcInNjaG9vbFJvbGVcIixcbiAgICAgICAgICBgJHtzY2hvb2wubmFtZX0vRU1QTE9ZRUVgLCBcIldcIikudG9TdHJpbmcoKSk7XG4gICAgICByLmFkZChcInNjaG9vbHNcIiwgc2Nob29sKTtcbiAgICAgIHRoaXMuYWRkU2Nob29sQnJhbmNoKHNjaG9vbCwgcik7XG4gICAgfSBlbHNlIGlmICh0aGlzLm9yaWdTY2hvb2wubmFtZSAhPT0gdGhpcy5zdGF0ZS5uYW1lKSB7XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlNrb2xhbnMgbmFtbiBmw6VyIGludGUgw6RuZHJhcy4gS29udGFrdGEgVmVtZW5kbyBBQi5cIilcblxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIXNjaG9vbC5vZmZpY2lhbEJyYW5jaElkKSB7XG4gICAgICAgIHNjaG9vbC5vZmZpY2lhbEJyYW5jaElkID0gY3JlYXRlVVVJRCgpO1xuICAgICAgICB0aGlzLmFkZFNjaG9vbEJyYW5jaChzY2hvb2wsIHIpO1xuICAgICAgfVxuICAgICAgci5wdXQoXCJzY2hvb2xzXCIsIHNjaG9vbCk7XG4gICAgfVxuXG4gICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goci5tdXRhdGlvblJlcXVlc3RzKTtcblxuICAgIGxvY2F0aW9uLmhhc2ggPSBcIiMvc2Nob29sc1wiO1xuICB9XG5cbiAgcHJpdmF0ZSBhZGRTY2hvb2xCcmFuY2goc2Nob29sOiB7IHRhZ3M6IHN0cmluZ1tdOyBuYW1lOiBzdHJpbmc7IGlzUHJpbWFyeVNjaG9vbD86IGJvb2xlYW47IGlzR3ltbmFzaXVtPzogYm9vbGVhbjsgb2ZmaWNpYWxCcmFuY2hJZDogc3RyaW5nOyBjb3Vyc2VzPzogQ291cnNlW107IGFjdGl2ZUNvdXJzZXM/OiBDb3Vyc2VbXTsgaWQ6IHN0cmluZzsgYWNsPzogc3RyaW5nW107IGRhdGVUaW1lPzogbnVtYmVyOyB0cmVlUGFyZW50SWQ/OiBzdHJpbmc7ICRldGFnPzogc3RyaW5nOyAkbWV0YT86IFwiYWRkXCIgfCBcInJlZlwiIHwgXCJ1cGRhdGVcIiB8IFwiYWRkaW5nXCIgfCBcInVwZGF0aW5nXCIgfCBcImRlbGV0aW5nXCIgfCBcImRlbGV0ZWRcIjsgfSwgcjogQmF0Y2hSdW5uZXIpIHtcbiAgICBjb25zdCBicmFuY2g6IEJyYW5jaCA9IHtcbiAgICAgIGlkOiBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCxcbiAgICAgIG5hbWU6IHNjaG9vbC5uYW1lLFxuICAgICAgc2Nob29sSWQ6IHNjaG9vbC5pZCxcbiAgICAgIGFjbDogW1xuICAgICAgICBcInJvbGU6VVNFUjpSXCIsXG4gICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7c2Nob29sLm5hbWV9L0VNUExPWUVFYCwgXCJXXCIpLnRvU3RyaW5nKClcbiAgICAgIF1cbiAgICB9O1xuICAgIHIuYWRkKFwiYnJhbmNoZXNcIiwgYnJhbmNoKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNjaG9vbCgpIHtcbiAgICBpZiAocHJvbXB0KExgw4RyIGR1IHPDpGtlciBww6UgYXR0IHRhIGJvcnQgc2tvbGFuIFwiJHt0aGlzLnN0YXRlLm5hbWV9XCI/IFNrcml2IHNrb2xhbnMgZXhha3RhIG5hbW4gZsO2ciBhdHQgYmVrcsOkZnRhYCkgPT09IHRoaXMuc3RhdGUubmFtZSApIHtcbiAgICAgIGNvbnN0IHNjaG9vbEJyYW5jaCA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8QnJhbmNoPihcImJyYW5jaGVzXCIsIHtcbiAgICAgICAgaWRzOiBbdGhpcy5zdGF0ZS5vZmZpY2lhbEJyYW5jaElkXSxcbiAgICAgICAgaW5jbHVkZTogXCJhcHByb3ZlZENoaWxkcmVuXCIsXG4gICAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXVxuICAgICAgfSk7XG4gICAgICBjb25zdCBiciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgYnIuZGVsZXRlKFwic2Nob29sc1wiLCB0aGlzLnN0YXRlLmlkKTtcbiAgICAgIHNjaG9vbEJyYW5jaFswXS5hcHByb3ZlZENoaWxkcmVuLmZvckVhY2goKHtpZH0pID0+IHtcbiAgICAgICAgYnIuZGVsZXRlKFwiYnJhbmNoZXNcIiwgaWQpO1xuICAgICAgfSk7XG4gICAgICBici5kZWxldGUoXCJicmFuY2hlc1wiLCB0aGlzLnN0YXRlLm9mZmljaWFsQnJhbmNoSWQpO1xuICAgICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goYnIubXV0YXRpb25SZXF1ZXN0cyk7XG4gICAgICBsb2NhdGlvbi5oYXNoPSBcIiMvc2Nob29sc1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydChcIlNrb2xhbiB0b2dzIGludGUgYm9ydCBlZnRlcnNvbSBkZXQgbmFtbiBkdSBhbmdhdiBpbnRlIHN0w6RtbWVyLlwiKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyB0aXRsZSwgaWQgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgZWRpdEV4aXN0aW5nID0gISFpZDtcbiAgICBjb25zdCBzY2hvb2wgPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IG9yaWdTY2hvb2wgPSB0aGlzLm9yaWdTY2hvb2w7XG4gICAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gXCJBRE1JTlwiKTtcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2Vjb250ZW50IHN2LWxheW91dCBzdi1zcGFjZXItMjBweHZ0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgIDxoMj57dGl0bGV9PC9oMj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+TmFtbjo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzPXshc2Nob29sIHx8ICFzY2hvb2wubmFtZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWluIHx8IGVkaXRFeGlzdGluZ31cbiAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICAgIHNpemU9ezUwfVxuICAgICAgICAgICAgICB2YWx1ZT17c2Nob29sID8gc2Nob29sLm5hbWUgOiBcIlwifVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IG5hbWU6IGV2LnRhcmdldC52YWx1ZSB9KX0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+VmlzbmluZ3NuYW1uOjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhdXRvRm9jdXM9e3NjaG9vbCAmJiAhc2Nob29sLmRpc3BsYXlOYW1lfVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgICBzaXplPXs1MH1cbiAgICAgICAgICAgICAgdmFsdWU9e3NjaG9vbCA/IHNjaG9vbC5kaXNwbGF5TmFtZSA6IFwiXCJ9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgZGlzcGxheU5hbWU6IGV2LnRhcmdldC52YWx1ZSB9KX0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHtzY2hvb2wgJiYgc2Nob29sLmlzR3ltbmFzaXVtID8gPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5FRFMgbmFtbiAoZ3ltbmFzaXVtKTo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWlufVxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgc2l6ZT17NTB9XG4gICAgICAgICAgICAgIHZhbHVlPXtzY2hvb2wgPyBzY2hvb2wuZWRzU2Nob29sTmFtZUd5bW4gOiBcIlwifVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IGVkc1NjaG9vbE5hbWVHeW1uOiBldi50YXJnZXQudmFsdWUgfSl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PiA6IG51bGx9XG4gICAgICAgIHtzY2hvb2wgJiYgc2Nob29sLmlzUHJpbWFyeVNjaG9vbCA/IDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+RURTIG5hbW4gKGdydW5kc2tvbGEpOjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgICBzaXplPXs1MH1cbiAgICAgICAgICAgICAgdmFsdWU9e3NjaG9vbCA/IHNjaG9vbC5lZHNTY2hvb2xOYW1lUHJpbSA6IFwiXCJ9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgZWRzU2Nob29sTmFtZVByaW06IGV2LnRhcmdldC52YWx1ZSB9KX0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+IDogbnVsbH1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5UeXA6PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICBuYW1lPVwic2Nob29sVHlwZVByaW1hcnlcIlxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3NjaG9vbCAmJiBzY2hvb2wuaXNQcmltYXJ5U2Nob29sfVxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgdmFsdWU9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMuc2V0U3RhdGUoeyBpc1ByaW1hcnlTY2hvb2w6IGV2LnRhcmdldC5jaGVja2VkIH0pfSAvPlxuICAgICAgICAgICAgJm5ic3A7R3J1bmRza29sYVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHNwYWNlZFwiPjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj48L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiXG4gICAgICAgICAgICAgIG5hbWU9XCJzY2hvb2xUeXBlR3ltbmFzaXVtXCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWlufVxuICAgICAgICAgICAgICBjaGVja2VkPXtzY2hvb2wgJiYgc2Nob29sLmlzR3ltbmFzaXVtfVxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgdmFsdWU9XCJneW1uYXNpdW1cIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IGlzR3ltbmFzaXVtOiBldi50YXJnZXQuY2hlY2tlZCB9KX0gLz5cbiAgICAgICAgICAgICZuYnNwO0d5bW5hc2l1bVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHNwYWNlZFwiPjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGJyLz5cbiAgICAgICAge2lzQWRtaW4gJiYgZWRpdEV4aXN0aW5nICYmIDxkaXYgdGFiSW5kZXg9ezJ9IGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiIG9uQ2xpY2s9eygpID0+XG4gICAgICAgICAgdGhpcy5kZWxldGVTY2hvb2woKS5jYXRjaChzaG93RXJyb3IpfT5cbiAgICAgICAgICBUYSBib3J0IHNrb2xhXG4gICAgICAgIDwvZGl2Pn1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdWxsLXJpZ2h0XCI+Jm5ic3A7PC9kaXY+XG4gICAgICAgIDxMaW5rIGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiIHRvPVwiL3NjaG9vbHNcIj5cbiAgICAgICAgICBBdmJyeXRcbiAgICAgICAgPC9MaW5rPlxuICAgICAgICBcbiAgICAgICAge2lzQWRtaW4gJiYgPGEgdGFiSW5kZXg9ezF9IGNsYXNzTmFtZT17XCJidG4gYnRuLWxhcmdlXCJ9IG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICBpZiAob3JpZ1NjaG9vbCAmJiBvcmlnU2Nob29sLm5hbWUgIT09IHNjaG9vbC5uYW1lKSB7XG4gICAgICAgICAgICBpZiAoIWNvbmZpcm0oTGDDhHIgZHUgc8Oka2VyIHDDpSBhdHQgZHUgdmlsbCBkw7ZwYSBvbSBza29sYW4/IERldHRhIHDDpXZlcmthciBwb3J0YWxlbnMgZnVua3Rpb24gZsO2ciBsw6RyYXJlIG9jaCBlbGV2ZXIgc29tIHRpbGxow7ZyIHNrb2xhbi4gTmFtbmV0IG3DpXN0ZSBzdMOkbW1hIGV4YWt0IMO2dmVyZW5zIG1lZCBuYW1uZ2l2bmluZ2VuIGF2IHNrb2xhbiBww6UgYW52w6RuZGFyb2JqZWt0ZW4uXG5cbkRldCBzb20gaMOkbmRlciBhbm5hcnMgw6RyIGF0dCBlbGV2ZXIgb2NoIGzDpHJhcmUgcMOlIHNrb2xhbiBpbnRlIGzDpG5ncmUgaGl0dGFyIG7DpWdyYSBrdXJzZXIuXG5cbkJsaXIgZGV0IGZlbCBrYW4gZHUgZG9jayBhbGx0aWQgYmFyYSBkw7ZwYSB0aWxsYmFrYSBza29sYW5zIG5hbW4uYCkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNhdmUoKS5jYXRjaChzaG93RXJyb3IpO1xuICAgICAgICB9fT5TcGFyYTwvYT59XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBTY2hvb2wgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBEaWFsb2dDb250YWluZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3RcIjtcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQgeyBFZGl0U2Nob29sIH0gZnJvbSAnLi9lZGl0LXNjaG9vbCc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBhY3RBcyB9IGZyb20gXCIuLi8uLi8uLi9hY2Nlc3MtY29udHJvbFwiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHNjaG9vbHM/OiBTY2hvb2xbXVxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmdcbiAgdHlwZTogJ2d5bW5hc2l1bScgfCAncHJpbWFyeSdcbn1cblxuZXhwb3J0IGNvbnN0IEVkaXRhYmxlU2Nob29sTGlzdCA9IChwcm9wczogUHJvcHMpID0+IHtcbiAgY29uc3QgeyBzY2hvb2xzLCB2aWV3Q291cnNlVXJsIH0gPSBwcm9wcztcbiAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gXCJBRE1JTlwiKTtcbiAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZWRpdGFibGUtc2Nob29sLWxpc3RcIj5cbiAgICA8ZGl2PlxuICAgICAge3NjaG9vbHMgPyA8dGFibGU+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICB7c2Nob29scy5tYXAoc2Nob29sID0+XG4gICAgICAgICAgICA8dHIgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiIGtleT17c2Nob29sLmlkfT5cbiAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgIDxMaW5rIGNsYXNzTmFtZT1cImVkaXRJdGVtXCIgdG89e2Avc2Nob29scy8ke3NjaG9vbC5pZH0vZWRpdGB9PjwvTGluaz5cbiAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgIDxwPntzY2hvb2wubmFtZX08L3A+XG4gICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgICAgICA8cD48YSBzdHlsZT17e2N1cnNvcjogJ3BvaW50ZXInfX0gb25DbGljaz17KCk9PmFjdEFzKHtyb2xlOiBcIkVNUExPWUVFXCIsIHNjaG9vbDogc2Nob29sLm5hbWV9KX0+QWdlcmEgc29tIGzDpHJhcmUgcMOlIGRlbm5hIHNrb2xhPC9hPjwvcD5cbiAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgIDxwPjxhIHN0eWxlPXt7Y3Vyc29yOiAncG9pbnRlcid9fSBvbkNsaWNrPXsoKT0+YWN0QXMoe3JvbGU6IFwiU1RVREVOVFwiLCBzY2hvb2w6IHNjaG9vbC5uYW1lLCB1cmw6IHZpZXdDb3Vyc2VVcmx9KX0+QWdlcmEgc29tIGVsZXYgcMOlIGRlbm5hIHNrb2xhPC9hPjwvcD5cbiAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+IDogPHA+PFNwaW5uZXIgLz5WLmcuIHbDpG50YSBtZWRhbiBza29sb3IgbGFkZGFzPC9wPn1cbiAgICA8L2Rpdj5cbiAgICA8YnIgLz5cbiAgICB7c2Nob29scyAmJiBpc0FkbWluICYmIDxMaW5rIHRvPXtgL3NjaG9vbHMvbmV3LyR7cHJvcHMudHlwZX1gfSBjbGFzc05hbWU9XCJidG5cIj57XG4gICAgICAgIHByb3BzLnR5cGUgPT0gJ2d5bW5hc2l1bScgPyBMYEzDpGdnIHRpbGwgZ3ltbmFzaWVza29sYWAgOlxuICAgICAgICBwcm9wcy50eXBlID09ICdwcmltYXJ5JyA/IExgTMOkZ2cgdGlsbCBncnVuZHNrb2xhYCA6XG4gICAgICAgIExgTMOkZ2cgdGlsbCBza29sYWB9PC9MaW5rPn1cbiAgPC9kaXYgPlxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgRWRpdGFibGVTY2hvb2xMaXN0IH0gZnJvbSAnLi9lZGl0YWJsZS1zY2hvb2wtbGlzdCc7XG5pbXBvcnQgeyBzaG93RXJyb3IsIGNvbXBhcmVQcm9wIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgc2Nob29sczogU2Nob29sW10gfCBudWxsXG59XG5cbmV4cG9ydCBjb25zdCBTY2hvb2xzID0gKHByb3BzOiBQcm9wcykgPT4gPGRpdiBzdHlsZT17eyBvdXRsaW5lOiAwIH19PlxuICA8Q291cnNlQmFubmVyIHRpdGxlPVwiU2tvbG9yXCIgYWN0aXZlUGFnZT1cInNjaG9vbHNcIiByb3V0ZXM9e3tmZWVkYmFjazogcHJvcHMuZmVlZGJhY2tVcmx9fSAvPlxuICA8U2Nob29sc1dpdGhvdXRCYW5uZXIgdmlld0NvdXJzZVVybD17cHJvcHMudmlld0NvdXJzZVVybH0gLz5cbjwvZGl2PlxuXG5leHBvcnQgY2xhc3MgU2Nob29sc1dpdGhvdXRCYW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UGljazxQcm9wcywgXCJ2aWV3Q291cnNlVXJsXCI+LFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgc2Nob29sczogbnVsbFxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMubG9hZCgpLmNhdGNoKGVyciA9PiBzaG93RXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKSk7XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIGNvbnN0IHNjaG9vbHMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFNjaG9vbD4oXCJzY2hvb2xzXCIpO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzY2hvb2xzIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgc2Nob29scyB9ID0gdGhpcy5zdGF0ZTtcbiAgICBzY2hvb2xzICYmIHNjaG9vbHMuc29ydChjb21wYXJlUHJvcChcIm5hbWVcIikpO1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZWNvbnRlbnQgc3YtbGF5b3V0IHN2LXNwYWNlci0yMHB4dnQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAge3NjaG9vbHMgPyA8PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxoMj5HeW1uYXNpZXNrb2xvcjwvaDI+XG4gICAgICAgICAgPEVkaXRhYmxlU2Nob29sTGlzdFxuICAgICAgICAgICAgc2Nob29scz17c2Nob29scy5maWx0ZXIoc2Nob29sID0+IHNjaG9vbC5pc0d5bW5hc2l1bSl9XG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XG4gICAgICAgICAgICB0eXBlPVwiZ3ltbmFzaXVtXCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPGgyPkdydW5kc2tvbG9yPC9oMj5cbiAgICAgICAgICA8RWRpdGFibGVTY2hvb2xMaXN0XG4gICAgICAgICAgICBzY2hvb2xzPXtzY2hvb2xzLmZpbHRlcihzY2hvb2wgPT4gc2Nob29sLmlzUHJpbWFyeVNjaG9vbCl9XG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XG4gICAgICAgICAgICB0eXBlPVwicHJpbWFyeVwiIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC8+IDogPFNwaW5uZXIgLz59XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgY29uc3QgRWxsaXBzaXNMb2FkZXIgPSAoKSA9PlxuICA8aW1nXG4gICAgc3R5bGU9e3tib3JkZXI6IDAsIG1hcmdpbjogMCwgcGFkZGluZzogMH19XG4gICAgY2xhc3NOYW1lPVwiZWxsaXBzaXMtbG9hZGVyXCIgLz47XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge0tub3dsZWRnZVJlcXVpcmVtZW50fSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgZ2V0UGFydGlhbENvbnRlbnREZWZhdWx0VmlldywgZ2V0UmVxdWlybWVudFNlbnRlbmNlcywgZ2V0Q292ZXJlZFNlbnRlY2VzLCBnZXRTYXZlZFNlbnRlbmNlcywgXG4gIGlzUGFydGlhbENvdmVyZWRSZXF1aXJtZW50LCBnZXRNaWdyYXRpb25UaXRsZSwgZ2V0U29ydGVkUmVxdWlybWVudHMsIGFsbFJlcXVpcmVtZW50U2VudGVjZXNNYXJrZWQgfSBmcm9tICcuLi9rbm93bGVkZ2UtbWF0cml4LXBhcnRpYWwtdXRpbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IEtub3dsZWRnZVJlcXVpcmVtZW50W107XG4gIGlkc1RvTWFya05vdE9rPzoge1tpZDogc3RyaW5nXTogdHJ1ZX07XG4gIGV4cGxhaW5lZFJlcXVpcmVtZW50cz86IHtbcmVxdWlyZW1lbnRJZDogc3RyaW5nXTogc3RyaW5nfVxuICBwYXJ0aWFsUmVxdWlybWVudHM/OiB7W2lkOiBzdHJpbmddOiBzdHJpbmdbXX1cbiAgLy8gUHJvcHMgdXNlZCBpbiBlZGl0IG1vZGUgKGVkaXRpbmcgY291cnNlIHRlbXBsYXRlcylcbiAgLy9jb3ZlcmVkSWRzPzogc3RyaW5nW107XG4gIC8vIFByb3BzIHVzZWQgaW4gbWFyayBtb2RlIChlZGl0aW5nIHRhc2tzKVxuICBtYXJrTW9kZT86IGJvb2xlYW47XG4gIG1hcmtlZElkcz86IHN0cmluZ1tdO1xuICBtaWdyYXRlZElkcz86IHtbaWQ6IHN0cmluZ106IGFueX07XG4gIG9uTWFya0NoYW5nZWQ6IChpZDogc3RyaW5nLCBpc01hcmtlZDogYm9vbGVhbikgPT4gdm9pZDtcbiAgb25FeHBsYWluZWRSZXF1aXJlbWVudHNDaGFuZ2VkPzogKHJlcUlkOiBzdHJpbmcsIHRleHQ6IHN0cmluZykgPT4gdm9pZDtcbiAgb25VcGRhdGVQYXJ0aWFsS25vd2xlZGdlPzogKHJlcUlkOiBzdHJpbmcsIHRleHQ6IHN0cmluZ1tdKSA9PiB2b2lkO1xuICBtYXJrQnlTZW50ZW5jZVZpZXc/OiBib29sZWFuO1xuICBjb3ZlcmVkUGFydGlhbFJlcXVpcm1lbnRzPzoge1tpZDogc3RyaW5nXTogc3RyaW5nW119W107XG4gIG1hcmtQYXJ0aWFsRmVhdHVyZUVuYWJsZWQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgS25vd2xlZGdlTWF0cml4IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCB7fT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICBnZXRLbm93bGVkZ2VTZW50ZW5jZXNDb250ZW50KHJlcXVpcmVtZW50OiBLbm93bGVkZ2VSZXF1aXJlbWVudCwgcGFydGlhbFJlcXVpcm1lbnRzOiBzdHJpbmdbXSwgaW5kZXg6IG51bWJlciwgbWFya2VkT2s6IGJvb2xlYW4sIGlzTWlncmF0ZWQ6IGJvb2xlYW4pIHtcbiAgICBjb25zdCB7Y292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cywgbWFya01vZGV9ID0gdGhpcy5wcm9wcztcbiAgICAvL3NwbGl0IHRleHQgaW4gc2VudGVjZXNcbiAgICB2YXIgdGV4dFNlbnRlbmNlcyA9IGdldFJlcXVpcm1lbnRTZW50ZW5jZXMocmVxdWlyZW1lbnQubmFtZSk7XG5cbiAgICAvL2dldCBzYXZlZCBzZW5jZW50ZWNlcyBmb3IgdGhlIGN1cnJlbnQgcmVxdWlyZW1lbnRcbiAgICB2YXIgcm93UmVxdWlybWVudHMgPSBwYXJ0aWFsUmVxdWlybWVudHMgJiYgZ2V0U2F2ZWRTZW50ZW5jZXMocGFydGlhbFJlcXVpcm1lbnRzKTtcbiAgICAvL2dldCBhbGwgc2F2ZWQgc2VudGVjZXMgZXhjbHVkaW5nIHRoZSBjdXJyZW50IG9uZXNcbiAgICB2YXIgYWxsQ292ZXJlZFNlbnRlbmNlUmVxID0gY292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cyAmJiBnZXRDb3ZlcmVkU2VudGVjZXMoY292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cywgcmVxdWlyZW1lbnQuaWQpO1xuXG4gICAgcmV0dXJuIDx0ZCBrZXk9e2luZGV4fSB0aXRsZT17Z2V0TWlncmF0aW9uVGl0bGUoaXNNaWdyYXRlZCwgbWFya01vZGUpfT57dGV4dFNlbnRlbmNlcy5tYXAoKHNlbnRlbmNlLCBrKSA9PiB7XG4gICAgICB2YXIgdHJpbW1lZFNlbnRlbmNlID0gc2VudGVuY2UudHJpbSgpO1xuICAgICAgdmFyIGhhc1ZhbHVlID0gcm93UmVxdWlybWVudHMgJiYgcm93UmVxdWlybWVudHMuaW5jbHVkZXModHJpbW1lZFNlbnRlbmNlKSB8fCBtYXJrZWRPayAmJiAhcm93UmVxdWlybWVudHM7XG4gICAgICB2YXIgc2VudGVuY2VOb3RNYXJrZWQgPSAhYWxsQ292ZXJlZFNlbnRlbmNlUmVxLmluY2x1ZGVzKHRyaW1tZWRTZW50ZW5jZSk7XG5cbiAgICAgIHJldHVybiA8c3BhbiBrZXk9e2t9IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogc2VudGVuY2UgPyBzZW50ZW5jZSArIFwiLlwiIDogXCJcIiB9fVxuICAgICAgICBjbGFzc05hbWU9e1wic2VsZWN0YWJsZVwiICsgKGhhc1ZhbHVlID8gXCIgbWFya2VkR3JlZW5cIiA6IChzZW50ZW5jZU5vdE1hcmtlZCA/IFwiIG1hcmtlZFJlZFwiIDogXCJcIikpfVxuICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgdmFyIHVwZGF0ZWRSZXF1aXJtZW50cyA9IHBhcnRpYWxSZXF1aXJtZW50cyA/IE9iamVjdC5hc3NpZ24oW10sIHBhcnRpYWxSZXF1aXJtZW50cykgOiBbXTtcbiAgICAgICAgICB2YXIgc2hvdWxkQmVSZW1vdmVkID0gcm93UmVxdWlybWVudHMgJiYgcm93UmVxdWlybWVudHMuaW5jbHVkZXModHJpbW1lZFNlbnRlbmNlKTtcbiAgICAgICAgICAvL2NoZWNrIGlmIG5vIHBhcnRpYWwgZGF0YSBzYXZlZCwgYnV0IHRoZSByZXF1aXJtZW50IGlzIG1hcmtlZE9rXG4gICAgICAgICAgaWYgKG1hcmtlZE9rICYmICghcm93UmVxdWlybWVudHMgfHwgcm93UmVxdWlybWVudHMubGVuZ3RoID09IDApKSB7XG4gICAgICAgICAgICAvL3NhdmUgYWxsIGV4Y2VwdGluZyB0aGUgb25lIHRoYXQgc2hvdWxkIGJlIHJlbW92ZWRcbiAgICAgICAgICAgIHVwZGF0ZWRSZXF1aXJtZW50cyA9IHRleHRTZW50ZW5jZXMuZmlsdGVyKHggPT4geCAhPSBzZW50ZW5jZSk7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uVXBkYXRlUGFydGlhbEtub3dsZWRnZShyZXF1aXJlbWVudC5pZCwgZ2V0U29ydGVkUmVxdWlybWVudHModGV4dFNlbnRlbmNlcywgdXBkYXRlZFJlcXVpcm1lbnRzKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzaG91bGRCZVJlbW92ZWQpIHtcbiAgICAgICAgICAgICAgdXBkYXRlZFJlcXVpcm1lbnRzID0gcGFydGlhbFJlcXVpcm1lbnRzLmZpbHRlcihyZXEgPT4gcmVxICE9IHNlbnRlbmNlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdXBkYXRlZFJlcXVpcm1lbnRzLnB1c2goc2VudGVuY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wcm9wcy5vblVwZGF0ZVBhcnRpYWxLbm93bGVkZ2UocmVxdWlyZW1lbnQuaWQsIGdldFNvcnRlZFJlcXVpcm1lbnRzKHRleHRTZW50ZW5jZXMsIHVwZGF0ZWRSZXF1aXJtZW50cykpXG4gICAgICAgICAgfVxuICAgICAgICB9fT48L3NwYW4+XG4gICAgfSl9PC90ZD5cbiAgfVxuXG4gIG9uUmVxdWlyZW1lbnRDaGFuZ2VkKHJlcXVpcmVtZW50OiBLbm93bGVkZ2VSZXF1aXJlbWVudCwgdmFsdWU6IGJvb2xlYW4sIHBhcnRpYWxWYWx1ZXM6IHN0cmluZ1tdLCBhbGxQYXJ0aWFsTWFya2VkOiBib29sZWFuKSB7XG4gICAgaWYgKHRoaXMucHJvcHMub25VcGRhdGVQYXJ0aWFsS25vd2xlZGdlKSB7XG4gICAgICAvL3JlbW92ZSBhbGwgc2F2ZWQgc2VudGVjZXMgaWYgdGhlIHJlcXVpcmVtZW50IGlzIHVuY2hlY2tlZFxuICAgICAgKHZhbHVlICYmICFwYXJ0aWFsVmFsdWVzIHx8IGFsbFBhcnRpYWxNYXJrZWQpID8gdGhpcy5wcm9wcy5vblVwZGF0ZVBhcnRpYWxLbm93bGVkZ2UocmVxdWlyZW1lbnQuaWQsIFtdKSA6IHRoaXMucHJvcHMub25VcGRhdGVQYXJ0aWFsS25vd2xlZGdlKHJlcXVpcmVtZW50LmlkLCBnZXRSZXF1aXJtZW50U2VudGVuY2VzKHJlcXVpcmVtZW50Lm5hbWUpKVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnByb3BzLm9uTWFya0NoYW5nZWQocmVxdWlyZW1lbnQuaWQsICF2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsga25vd2xlZGdlUmVxdWlyZW1lbnRzLCBtYXJrZWRJZHMsIG1pZ3JhdGVkSWRzLCBleHBsYWluZWRSZXF1aXJlbWVudHMsIG1hcmtCeVNlbnRlbmNlVmlldywgbWFya1BhcnRpYWxGZWF0dXJlRW5hYmxlZH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgaWRzVG9NYXJrTm90T2ssIG1hcmtNb2RlLCBvbkV4cGxhaW5lZFJlcXVpcmVtZW50c0NoYW5nZWQsIHBhcnRpYWxSZXF1aXJtZW50cywgY292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cyB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IGNvbHVtbnMgPSBbXCJFXCIsIFwiQ1wiLCBcIkFcIl07XG4gICAgY29uc3Qgcm93czogS25vd2xlZGdlUmVxdWlyZW1lbnRbXVtdID0gW107XG4gICAgY29uc3QgcmVxcyA9IGtub3dsZWRnZVJlcXVpcmVtZW50cy5zbGljZSgpO1xuICAgIGxldCByb3c6IEtub3dsZWRnZVJlcXVpcmVtZW50W10gfCBudWxsID0gbnVsbDtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgcm93ID0gY29sdW1ucy5tYXAoZ3JhZGUgPT4ge1xuICAgICAgICBjb25zdCBwTmV4dCA9IHJlcXMuZmluZEluZGV4KHIgPT4gci5ncmFkZVN0ZXAgJiYgci5ncmFkZVN0ZXAudG9VcHBlckNhc2UoKSA9PT0gZ3JhZGUpO1xuICAgICAgICBpZiAocE5leHQgPCAwKSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgcnYgPSByZXFzW3BOZXh0XTtcbiAgICAgICAgcmVxcy5zcGxpY2UocE5leHQsIDEpO1xuICAgICAgICByZXR1cm4gcnY7XG4gICAgICB9KTtcbiAgICAgIGlmIChyb3cuZXZlcnkociA9PiByID09PSBudWxsKSlcbiAgICAgICAgYnJlYWs7XG4gICAgICByb3dzLnB1c2gocm93KTtcbiAgICB9XG5cbiAgICByZXR1cm4gPHRhYmxlIGNsYXNzTmFtZT1cImtub3dsZWRnZS1tYXRyaXhcIj5cbiAgICAgICAgPHRoZWFkPlxuICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgIHtjb2x1bW5zLm1hcChjID0+IDx0aCBrZXk9e2N9PntjfTwvdGg+KX1cbiAgICAgICAgICA8L3RyPlxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAge3Jvd3MubWFwKChyb3csaSkgPT4gPFJlYWN0LkZyYWdtZW50IGtleT17aX0+XG4gICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgIHtyb3cubWFwKChyZXF1aXJlbWVudCxqKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNNYXJrZWRPSyA9IHJlcXVpcmVtZW50ICYmIG1hcmtlZElkcyAmJiBtYXJrZWRJZHMuaW5kZXhPZihyZXF1aXJlbWVudC5pZCkgPj0gMDtcbiAgICAgICAgICAgICAgICBjb25zdCBpc01hcmtlZE5vdE9LID0gcmVxdWlyZW1lbnQgJiYgaWRzVG9NYXJrTm90T2sgJiYgaWRzVG9NYXJrTm90T2tbcmVxdWlyZW1lbnQuaWRdOy8vbm90IHVzZWQgYW55bW9yZVxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWlncmF0ZWQgPSByZXF1aXJlbWVudCAmJiBtaWdyYXRlZElkcyAmJiAhIW1pZ3JhdGVkSWRzW3JlcXVpcmVtZW50LmlkXTtcbiAgICAgICAgICAgICAgICB2YXIgcm93UGFydGlhbFJlcXVpcmVtZW50cyA9IHBhcnRpYWxSZXF1aXJtZW50cyAmJiBwYXJ0aWFsUmVxdWlybWVudHNbcmVxdWlyZW1lbnQuaWRdO1xuICAgICAgICAgICAgICAgIHZhciBwYXJ0aWFsVmFsdWVzID0gcm93UGFydGlhbFJlcXVpcmVtZW50cyAmJiBnZXRTYXZlZFNlbnRlbmNlcyhyb3dQYXJ0aWFsUmVxdWlyZW1lbnRzKTtcbiAgICAgICAgICAgICAgICB2YXIgYWxsUmVxU2VudGVuY2VzTWFya2VkID0gYWxsUmVxdWlyZW1lbnRTZW50ZWNlc01hcmtlZChyZXF1aXJlbWVudC5uYW1lLCBwYXJ0aWFsVmFsdWVzKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgaGFzUGFydGlhbENvdmVyZWQgPSBpc1BhcnRpYWxDb3ZlcmVkUmVxdWlybWVudChyZXF1aXJlbWVudCwgY292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cyk7XG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlZFJlZCA9ICEocGFydGlhbFZhbHVlcyAmJiBwYXJ0aWFsVmFsdWVzLmxlbmd0aCA+IDAgfHwgaGFzUGFydGlhbENvdmVyZWQpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hcmtCeVNlbnRlbmNlVmlldyAmJiBtYXJrUGFydGlhbEZlYXR1cmVFbmFibGVkID8gdGhpcy5nZXRLbm93bGVkZ2VTZW50ZW5jZXNDb250ZW50KHJlcXVpcmVtZW50LCByb3dQYXJ0aWFsUmVxdWlyZW1lbnRzLCBqLCBpc01hcmtlZE9LLCBpc01pZ3JhdGVkKSA6XG4gICAgICAgICAgICAgICAgPHRkXG4gICAgICAgICAgICAgICAgICBrZXk9e2p9XG4gICAgICAgICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogcmVxdWlyZW1lbnQgPyAocm93UGFydGlhbFJlcXVpcmVtZW50cyAmJiByb3dQYXJ0aWFsUmVxdWlyZW1lbnRzLmxlbmd0aCB8fCBoYXNQYXJ0aWFsQ292ZXJlZCkgPyBcbiAgICAgICAgICAgICAgICAgICAgZ2V0UGFydGlhbENvbnRlbnREZWZhdWx0VmlldyhyZXF1aXJlbWVudCwgcm93UGFydGlhbFJlcXVpcmVtZW50cywgY292ZXJlZFBhcnRpYWxSZXF1aXJtZW50cywgbWFya2VkUmVkKSA6IHJlcXVpcmVtZW50Lm5hbWUgOiBcIlwifX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17KG1hcmtNb2RlID8gXCJzZWxlY3RhYmxlXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAoaXNNaWdyYXRlZCA/IFwiIG1pZ3JhdGVkXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAoaXNNYXJrZWRPSyAmJiAoIXJvd1BhcnRpYWxSZXF1aXJlbWVudHMgfHwgYWxsUmVxU2VudGVuY2VzTWFya2VkKT9cbiAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkR3JlZW5cIiA6XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlZFJlZCA/XG4gICAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XG4gICAgICAgICAgICAgICAgICAgICAgXCJcIil9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e21hcmtNb2RlICYmIHJlcXVpcmVtZW50ID9cbiAgICAgICAgICAgICAgICAgICAgICAoKT0+dGhpcy5vblJlcXVpcmVtZW50Q2hhbmdlZChyZXF1aXJlbWVudCwgaXNNYXJrZWRPSywgcGFydGlhbFZhbHVlcywgYWxsUmVxU2VudGVuY2VzTWFya2VkKSA6XG4gICAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17Z2V0TWlncmF0aW9uVGl0bGUoaXNNaWdyYXRlZCwgbWFya01vZGUpfSAvPlxuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICB7ZXhwbGFpbmVkUmVxdWlyZW1lbnRzICYmIDx0cj5cbiAgICAgICAgICAgICAge3Jvdy5tYXAoKHJlcXVpcmVtZW50LGopID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgcGFydGlhbFNlbnRlbmNlcyA9IHBhcnRpYWxSZXF1aXJtZW50cyAmJiBwYXJ0aWFsUmVxdWlybWVudHNbcmVxdWlyZW1lbnQuaWRdICYmIGdldFNhdmVkU2VudGVuY2VzKHBhcnRpYWxSZXF1aXJtZW50c1tyZXF1aXJlbWVudC5pZF0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkT0sgPSByZXF1aXJlbWVudCAmJiBtYXJrZWRJZHMgJiYgbWFya2VkSWRzLmluZGV4T2YocmVxdWlyZW1lbnQuaWQpID49IDAgfHwgcGFydGlhbFNlbnRlbmNlcyAmJiBwYXJ0aWFsU2VudGVuY2VzLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDx0ZCBrZXk9e2p9PlxuICAgICAgICAgICAgICAgICAge2lzTWFya2VkT0sgPyA8dGV4dGFyZWFcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e0xgQmVza3JpdiBrcmF2ZXRgfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpbnB1dFRleHRCb3ggaW5wdXRUZXh0TGFyZ2VcIiBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshbWFya01vZGV9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtleHBsYWluZWRSZXF1aXJlbWVudHNbcmVxdWlyZW1lbnQuaWRdIHx8IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkV4cGxhaW5lZFJlcXVpcmVtZW50c0NoYW5nZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIGV2ID0+IG9uRXhwbGFpbmVkUmVxdWlyZW1lbnRzQ2hhbmdlZChyZXF1aXJlbWVudC5pZCwgZXYudGFyZ2V0LnZhbHVlKSl9XG4gICAgICAgICAgICAgICAgICAvPiA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgICAgIDwvdGQ+fSl9XG4gICAgICAgICAgICA8L3RyPn1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG5cbiAgICB7LypyZXR1cm4gPGRpdj5cbiAgICAgIDx0YWJsZT5cbiAgICAgICAgPHRoZWFkPlxuICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgIDx0aD5FPC90aD5cbiAgICAgICAgICAgIDx0aD5DPC90aD5cbiAgICAgICAgICAgIDx0aD5BPC90aD5cbiAgICAgICAgICA8L3RyPlxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAge3Rib2R5Lm1hcCgocm93LCBpKSA9PiBcbiAgICAgICAgICA8dHIga2V5PXtpfT57cm93Lm1hcCgoY2VsbCwgaikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWRPSyA9IHByb3BzLm1hcmtlZElkcyAmJiBwcm9wcy5tYXJrZWRJZHMuaW5kZXhPZihjZWxsLmlkKSA+PSAwO1xuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWROb3RPSyA9IHByb3BzLmlkc1RvTWFya05vdE9rICYmIHByb3BzLmlkc1RvTWFya05vdE9rW2NlbGwuaWRdO1xuICAgICAgICAgICAgcmV0dXJuIDx0ZFxuICAgICAgICAgICAgICBrZXk9e2p9XG4gICAgICAgICAgICAgIHJvd1NwYW49e2NlbGwucm93U3Bhbn1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXsocHJvcHMubWFya01vZGUgPyBcInNlbGVjdGFibGVcIiA6IFwiXCIpICtcbiAgICAgICAgICAgICAgICAoaXNNYXJrZWRPSyA/XG4gICAgICAgICAgICAgICAgICBcIiBtYXJrZWRHcmVlblwiIDpcbiAgICAgICAgICAgICAgICAgIChpc01hcmtlZE5vdE9LID9cbiAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XG4gICAgICAgICAgICAgICAgICAgIFwiXCIpKX1cbiAgICAgICAgICAgICAgb25DbGljaz17cHJvcHMubWFya01vZGUgJiYgKCgpPT5wcm9wcy5vbk1hcmtDaGFuZ2VkKGNlbGwuaWQsICFpc01hcmtlZE9LKSl9PlxuICAgICAgICAgICAgICB7Y2VsbC5odG1sICYmIDxkaXYgc3R5bGU9e3twb3NpdGlvbjogJ3JlbGF0aXZlJ319PlxuICAgICAgICAgICAgICAgIDxwXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NlbGwudHlwZSA9PT0gJ2FiaWxpdHknID8gJ2FiaWxpdHlUZXh0JyA6ICdjcml0ZXJpYVRleHQnfVxuICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGNlbGwuaHRtbH19IC8+XG4gICAgICAgICAgICAgICAge3Byb3BzLmVkaXRNb2RlICYmIDxSZW1vdmVJdGVtIGNsYXNzTmFtZT1cInVwcGVyUmlnaHRcIiBvbkNsaWNrPXsoKT0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENlbGxJZHMoXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5yb3dJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDZWxsSWRzKFxuICAgICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICBjZWxsLnJvd0luZGV4KS5maWx0ZXIoaWQgPT4gaWQgIT0gY2VsbC5pZCkgKX0gLz4gfVxuICAgICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgICA8L3RkPn0pfVxuICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+Ki99XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgb25DbGljayxcbiAgY2xhc3NOYW1lPyxcbiAgc3R5bGU/LFxuICB0aXRsZT9cbn07XG5cbmV4cG9ydCBjb25zdCBSZW1vdmVJdGVtID0gKHsgb25DbGljaywgY2xhc3NOYW1lLCBzdHlsZSwgdGl0bGUgfTogUHJvcHMpID0+XG5cbiAgPGRpdlxuICAgIHRpdGxlPXt0aXRsZSB8fCBMYFJhZGVyYWB9XG4gICAgY2xhc3NOYW1lPXtcInJlbW92ZUl0ZW0gXCIgKyAoY2xhc3NOYW1lIHx8IFwiXCIpfVxuICAgIG9uQ2xpY2s9e29uQ2xpY2t9IHN0eWxlPXtzdHlsZX0gLz5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBUYXNrLCBEb2N1bWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gXCIuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3hcIjtcbmltcG9ydCB7IGFycmF5VG9Mb29rdXAgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMgfSBmcm9tICcuLi9jb3Vyc2VzL2J1c2luZXNzLWxvZ2ljJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgb3B0aW9uczogKERvY3VtZW50ICYge2dyb3VwPzogc3RyaW5nfSlbXTtcbiAgdGl0bGU7XG4gIG1hcmtNb2RlOiBib29sZWFuO1xuICBtYXJrZWRJZHM6IHN0cmluZ1tdO1xuICBtaWdyYXRlZElkcz86IHtbaWQ6IHN0cmluZ106IGFueX07XG4gIHVuY292ZXJlZElkcz86IHtbaWQ6IHN0cmluZ106IHRydWV9O1xuICBvbk1hcmtDaGFuZ2VkOiAoaWQ6IHN0cmluZywgaXNNYXJrZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG59XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3RSZWxhdGVkRG9jcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtvcHRpb25zLCB0aXRsZSwgbWFya2VkSWRzLCBtYXJrTW9kZSwgbWlncmF0ZWRJZHMsIHVuY292ZXJlZElkc30gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGdyb3VwZWRPcHRpb25zID0gYXJyYXlUb0xvb2t1cChvcHRpb25zLCBkID0+IGQuZ3JvdXAgfHwgXCJkZWZhdWx0XCIpO1xuICAgIGNvbnN0IGdyb3VwcyA9IE9iamVjdC5rZXlzKGdyb3VwZWRPcHRpb25zKTtcbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveCB0aXRsZT17PHA+e3RpdGxlfTwvcD59IGNsYXNzTmFtZT1cImxhcmdlclwiPlxuICAgICAgICB7Z3JvdXBzLm1hcChncm91cCA9PiA8UmVhY3QuRnJhZ21lbnQga2V5PXtncm91cH0+XG4gICAgICAgICAge2dyb3Vwcy5sZW5ndGggPT09IDEgPyBudWxsIDogPD48YnIvPjxoNT57Z3JvdXB9PC9oNT48aHIvPjwvPn1cbiAgICAgICAgICB7Z3JvdXBlZE9wdGlvbnNbZ3JvdXBdLm1hcChvcHRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWQgPSBtYXJrZWRJZHMuc29tZSh4ID0+IHggPT09IG9wdGlvbi5pZCk7XG4gICAgICAgICAgICBjb25zdCBpc01pZ3JhdGVkID0gbWlncmF0ZWRJZHMgJiYgISFtaWdyYXRlZElkc1tvcHRpb24uaWRdO1xuICAgICAgICAgICAgY29uc3QgaXNVbmNvdmVyZWQgPSB1bmNvdmVyZWRJZHMgJiYgdW5jb3ZlcmVkSWRzW29wdGlvbi5pZF07XG4gICAgICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCIga2V5PXtvcHRpb24uaWR9IG9uQ2xpY2s9eygpPT5cbiAgICAgICAgICAgICAgbWFya01vZGUgJiYgdGhpcy5wcm9wcy5vbk1hcmtDaGFuZ2VkKG9wdGlvbi5pZCwgIWlzTWFya2VkKX0+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIiArXG4gICAgICAgICAgICAgICAgKG1hcmtNb2RlID8gXCIgc2VsZWN0YWJsZVwiIDogXCJcIikgK1xuICAgICAgICAgICAgICAgIChpc01hcmtlZCA/IFwiIG1hcmtlZEdyZWVuXCIgOiAoaXNVbmNvdmVyZWQgP1xuICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XG4gICAgICAgICAgICAgICAgICBcIlwiKSkgK1xuICAgICAgICAgICAgICAgIChpc01pZ3JhdGVkID8gXCIgbWlncmF0ZWRcIiA6IFwiXCIpfVxuICAgICAgICAgICAgICAgIHRpdGxlPXtpc01pZ3JhdGVkID9cbiAgICAgICAgICAgICAgICAgIG1hcmtNb2RlID9cbiAgICAgICAgICAgICAgICAgICAgYFNrb2x2ZXJrZXQgaGFyIHVwcGRhdGVyYXQgdGV4dGVucyBmb3JtdWxlcmluZy4gRHUga2FuIGdyYW5za2Egw6RuZHJpbmdlbiBnZW5vbSBhdHQgZsOkbGxhIHV0IHZhcm5pbmdzYm94ZW4gdGlsbCBow7ZnZXIsIG1lZCB0aXRlbCBcIlVwcGRhdGVyYWRlIGZvcm11bGVyaW5nYXIgZnLDpW4gU2tvbHZlcmtldFwiYCA6XG4gICAgICAgICAgICAgICAgICAgIGBTa29sdmVya2V0IGhhciB1cHBkYXRlcmF0IHRleHRlbnMgZm9ybXVsZXJpbmcsIG1lbiBkZXR0YSBoYXIgw6RubnUgaW50ZSBncmFuc2thdHMgYXYgdXBwZ2lmdGVucyByZWRpZ2VyaW5nc2JlaMO2cmlnZWAgOlxuICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkfT5cbiAgICAgICAgICAgICAgICA8cCBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogb3B0aW9uLm5hbWV9fSAvPlxuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PjtcbiAgICAgICAgICB9KX1cbiAgICAgICAgPC9SZWFjdC5GcmFnbWVudD4pfVxuICAgIDwvT3BlbkNsb3NlQm94PlxuICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgY29uc3QgU3Bpbm5lciA9ICgpPT4gPHNwYW4+PGkgY2xhc3NOYW1lPVwiZmEgZmEtc3Bpbm5lciBmYS1zcGluXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiZuYnNwOzwvc3Bhbj47XG4iLCJpbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBTdWJqZWN0LCBDb3Vyc2UsIEFiaWxpdHksIEtub3dsZWRnZVJlcXVpcmVtZW50LCBDZW50cmFsQ29udGVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IFN1YmplY3RUb0ltcG9ydCB9IGZyb20gJy4uL3N1YmplY3QtdG8taW1wb3J0JztcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gJy4vY2hhbmdlJztcbmltcG9ydCB7IG1pZ3JhdGVPcmRlckxpc3RzT2ZDb3Vyc2VJbnN0YW5jZXMsIG1pZ3JhdGVBYmlsaXRpZXNPcmRlck9uU3ViamVjdCB9IGZyb20gJy4vbWlncmF0aW9ucyc7XG5pbXBvcnQgeyBtaWdyYXRlU3ViamVjdCB9IGZyb20gJy4vbWlncmF0ZS1zdWJqZWN0JztcbmltcG9ydCB7IGxvYWRDb3Vyc2UgfSBmcm9tICcuLi8uLi91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2VTZXQgfSBmcm9tICcuL2NvdXJzZS1zZXQnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGlmZlhtbFdpdGhEYXRhYmFzZShleGlzdGluZ1N1YmplY3Q6IFN1YmplY3QsIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0LCBjaGFuZ2VzOiBDaGFuZ2VbXSkge1xuICAvLyBFeHBhbmQgZ3JhcGhzIG9mIGV4aXN0aW5nIFN1YmplY3RcbiAgZXhpc3RpbmdTdWJqZWN0ID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0KCdzdWJqZWN0cycsIGV4aXN0aW5nU3ViamVjdC5pZCwgeyBpbmNsdWRlOiBbXCJjb3Vyc2VUZW1wbGF0ZXNcIiwgXCJhYmlsaXRpZXNcIl0gfSk7XG4gIC8vIExhemlseSBsb2FkIGFsbCBjZW50cmFsIGNvbnRlbnRzIGFuZCBrbm93bGVkZ2VSZXF1aXJlbWVudHMgb25cbiAgLy8gZWFjaCBjb3Vyc2UgdGVtcGxhdGVcbiAgY29uc3QgZXhwYW5kZWRDb3Vyc2VUZW1wbGF0ZXMgPSBhd2FpdCBQcm9taXNlLmFsbChleGlzdGluZ1N1YmplY3QuY291cnNlVGVtcGxhdGVzLm1hcChjdCA9PiBsb2FkQ291cnNlKGN0LmlkLCB7XG4gICAgaW5jbHVkZTogW1xuICAgICAgJ2NlbnRyYWxDb250ZW50JyxcbiAgICAgICdrbm93bGVkZ2VSZXF1aXJlbWVudHMnXG4gICAgXVxuICB9KSkpO1xuXG4gIGNvbnNvbGUubG9nKGBTdWJqZWN0OiAke2V4aXN0aW5nU3ViamVjdC5uYW1lfS4gQ291cnNlczogJHtleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5tYXAoKHtuYW1lfSkgPT4gbmFtZSl9YCk7XG5cbiAgY29uc3QgY291cnNlU2V0czogQ291cnNlU2V0W10gPSBhd2FpdCBQcm9taXNlLmFsbChleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5tYXAgKGFzeW5jIGNvdXJzZVRlbXBsYXRlID0+ICh7XG4gICAgdGVtcGxhdGU6IGNvdXJzZVRlbXBsYXRlLFxuICAgIGluc3RhbmNlczogYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxDb3Vyc2U+KFwiY291cnNlc1wiLCB7IG5hbWU6IGNvdXJzZVRlbXBsYXRlLm5hbWUsIGluY2x1ZGU6IFsnYWJpbGl0aWVzJ10sIGZsYWdzOiBbJ2luY2x1ZGVJZHNPbmx5J10gfSlcbiAgfSkpKTtcblxuICAvKmlmIChleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5zb21lIChjb3Vyc2UgPT4gIWNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyIHx8ICFjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgfHwgIWNvdXJzZS5hYmlsaXRpZXNPcmRlcikpIHtcbiAgICBtaWdyYXRlT3JkZXJMaXN0c09mQ291cnNlSW5zdGFuY2VzKGNvdXJzZVNldHMsIHN1YmplY3RUb0ltcG9ydCwgY2hhbmdlcyk7XG4gICAgLy8gSW4gZnV0dXJlLCBhcyBhYmlsaXRpZXMgbWF5IGJlIGFkZGVkIG9yIHJlbW92ZWQsIHdlIHdpbGwgaGF2ZSB0byBtYWludGFpbiB0aGUgb3JkZXIgb2YgYWJpbGl0aWVzIG9uIHRoZSBjb3Vyc2UgaW5zdGFuY2VzLFxuICAgIC8vIHRoZSBzYW1lIHdheSB3ZSBkbyBpdCB3aXRoIGNlbnRyYWwgY29udGVudCBhbmQga25vd2xlZGdlIHJlcXVpcmVtZW50cy4gVE9ETyByZXNwZWN0IGFiaWxpdGllcyBvcmRlciBvbiBldmVyeSBwbGFjZSBhYmlsaXRpZXMgYXJlIGVudW1lcmF0ZWQsXG4gICAgLy8gc3VjaCBhcyBvbiBjb3Vyc2Ugdmlld2VyLCBjb3Vyc2UgYnVpbGRlciwgZXRjLlxuICAgIG1pZ3JhdGVBYmlsaXRpZXNPcmRlck9uU3ViamVjdChleGlzdGluZ1N1YmplY3QsIGNvdXJzZVNldHMsIGNoYW5nZXMpO1xuICB9IGVsc2UgeyovXG4gICAgYXdhaXQgbWlncmF0ZVN1YmplY3QoZXhpc3RpbmdTdWJqZWN0LCBjb3Vyc2VTZXRzLCBzdWJqZWN0VG9JbXBvcnQsIGNoYW5nZXMpO1xuICAvL31cbn1cblxuIiwiaW1wb3J0IHsgU3ViamVjdCwgQ291cnNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQWJpbGl0eSwgQ2VudHJhbENvbnRlbnQsIFRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcbmltcG9ydCB7IFN1YmplY3RUb0ltcG9ydCwgQ291cnNlVG9JbXBvcnQgfSBmcm9tIFwiLi4vc3ViamVjdC10by1pbXBvcnRcIjtcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gXCIuL2NoYW5nZVwiO1xuaW1wb3J0IHsgQ291cnNlU2V0IH0gZnJvbSAnLi9jb3Vyc2Utc2V0JztcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEJhdGNoUnVubmVyLCBNdXRhdGlvblJlcXVlc3QsIExpc3RPcHRpb25zIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgQXV0b1ZhbHVlTWFwIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbHMvYXV0by12YWx1ZS1tYXAnO1xuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxudHlwZSBJRCA9IHN0cmluZztcblxuZnVuY3Rpb24gZGlmZlN1YmplY3RHbG9iYWxUZXh0cyhkYlRleHRNYXA6IE1hcDxzdHJpbmcsIElEPiwgeG1sVGV4dHM6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IHJlbW92ZWRJZHMgPSBuZXcgU2V0PElEPigpO1xuICBjb25zdCBuZXdUZXh0cyA9IG5ldyBNYXA8c3RyaW5nLCBJRD4oKTtcbiAgY29uc3QgaWRzVG9BZGQgPSBuZXcgU2V0PElEPigpO1xuXG4gIHhtbFRleHRzLmZvckVhY2gobmV3VGV4dCA9PiB7XG4gICAgbmV3VGV4dCA9IG5ld1RleHQudHJpbSgpO1xuICAgIGlmICghZGJUZXh0TWFwLmhhcyhuZXdUZXh0KSkge1xuICAgICAgY29uc3QgaWQgPSBjcmVhdGVVVUlEKCk7XG4gICAgICBjb25zb2xlLmxvZyhgTmV3IGlkOiAke2lkfS4gVGV4dDogJHtuZXdUZXh0fWApO1xuICAgICAgbmV3VGV4dHMuc2V0KG5ld1RleHQsIGlkKTtcbiAgICAgIGlkc1RvQWRkLmFkZChpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld1RleHRzLnNldChuZXdUZXh0LCBkYlRleHRNYXAuZ2V0KG5ld1RleHQpKTtcbiAgICB9XG4gIH0pO1xuXG4gIGZvciAoY29uc3QgW29sZFRleHQsIG9sZElkXSBvZiBkYlRleHRNYXAuZW50cmllcygpKSB7XG4gICAgaWYgKHhtbFRleHRzLmluZGV4T2Yob2xkVGV4dCkgPT09IC0xKSB7XG4gICAgICByZW1vdmVkSWRzLmFkZChvbGRJZCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICByZW1vdmVkSWRzLFxuICAgIG5ld1RleHRzLFxuICAgIGlkc1RvQWRkXG4gIH1cbn1cblxubGV0IF9maWN0aXZlT2xkSWQgPSAxO1xuZnVuY3Rpb24gZmljdGl2ZU9sZElkKCkge1xuICByZXR1cm4gXCJmaWN0aXZlT2xkSWRcIiArICgrK19maWN0aXZlT2xkSWQpO1xufVxuXG5jb25zdCBzdG9wV29yZHMgPSBuZXcgU2V0KFxuICAvLyBGcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWhhaVZhbGVudGluL2x1bnItbGFuZ3VhZ2VzL2Jsb2IvbWFzdGVyL2x1bnIuc3YuanMjTDI1MlxuICAoJ2FsbGEgYWxsdCBhdHQgYXYgYmxldiBibGkgYmxpciBibGl2aXQgZGUgZGVtIGRlbiBkZW5uYSBkZXJhcyBkZXNzIGRlc3NhIGRldCBkZXR0YSBkaWcgZGluIGRpbmEgZGl0dCBkdSBkw6RyIGTDpSBlZnRlciBlaiBlbGxlciBlbiBlciBlcmEgZXJ0IGV0dCBmcsOlbiBmw7ZyIGhhIGhhZGUgaGFuIGhhbnMgaGFyIGhlbm5lIGhlbm5lcyBob24gaG9ub20gaHVyIGjDpHIgaSBpY2tlIGluZ2VuIGlub20gaW50ZSBqYWcganUga2FuIGt1bmRlIG1hbiBtZWQgbWVsbGFuIG1lbiBtaWcgbWluIG1pbmEgbWl0dCBtb3QgbXlja2V0IG5pIG51IG7DpHIgbsOlZ29uIG7DpWdvdCBuw6VncmEgb2NoIG9tIG9zcyBww6Ugc2FtbWEgc2VkYW4gc2lnIHNpbiBzaW5hIHNpdHRhIHNqw6RsdiBza3VsbGUgc29tIHPDpSBzw6VkYW4gc8OlZGFuYSBzw6VkYW50IHRpbGwgdW5kZXIgdXBwIHV0IHV0YW4gdmFkIHZhciB2YXJhIHZhcmbDtnIgdmFyaXQgdmFyamUgdmFycyB2YXJ0IHZlbSB2aSB2aWQgdmlsa2Egdmlsa2FzIHZpbGtlbiB2aWxrZXQgdsOlciB2w6VyYSB2w6VydCDDpG4gw6RyIMOldCDDtnZlcicgK1xuICAnIGtyaW5nJykgLy8gVGhpcyBsaW5lIGNvbnRhaW5zIGFkZGl0aW9uYWwgc3RvcC13b3JkcyBtaXNzaW5nIGluIGx1bnIuc3YuXG4gIC5zcGxpdCgnICcpKTtcblxuZnVuY3Rpb24gZ2V0TGV4ZW1lcyhodG1sOiBzdHJpbmcpOiBTZXQ8c3RyaW5nPiB7XG4gIHJldHVybiBuZXcgU2V0KHJlbW92ZVRhZ3MoaHRtbCkucmVwbGFjZSgvW15cXHdcXHPDpcOkw7ZdL2dpLCAnJykudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzLylcbiAgICAubWFwKGxleGVtZSA9PiBsZXhlbWUudHJpbSgpKVxuICAgIC5maWx0ZXIobGV4ZW1lID0+ICEhbGV4ZW1lKVxuICAgIC5maWx0ZXIobGV4ZW1lID0+ICFzdG9wV29yZHMuaGFzKGxleGVtZSkpXG4gICk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVRhZ3MoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi5pbm5lckhUTUwgPSBodG1sO1xuICByZXR1cm4gJycrZGl2LmlubmVyVGV4dDtcbn1cblxuZnVuY3Rpb24gZ2V0SWRzVG9NaWdyYXRlKFxuICBkYlRleHRzOiB7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10sXG4gIHhtbFRleHRzOiB7aHRtbDogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10sXG4gIG5ld1RleHRzOiBNYXA8c3RyaW5nLCBJRD4sXG4gIHRleHRUeXBlOiBzdHJpbmcsXG4gIGNvdXJzZT86IHN0cmluZykgOiBNYXA8SUQsIHtcbiAgICBuZXdUZXh0Pzogc3RyaW5nLFxuICAgIG5ld0lkPzogSUQsXG4gICAgb2xkVGV4dD86IHN0cmluZyxcbiAgICBncmFkZVN0ZXA/OiBzdHJpbmcsXG4gICAgaXNUeXBvRml4PzogYm9vbGVhblxuICB9Plxue1xuICBjb25zdCBpZHNUb01pZ3JhdGUgPSBuZXcgTWFwPElELCB7XG4gICAgbmV3VGV4dD86IHN0cmluZyxcbiAgICBuZXdJZD86IElELFxuICAgIG9sZFRleHQ/OiBzdHJpbmcsXG4gICAgZ3JhZGVTdGVwPzogc3RyaW5nLFxuICAgIGlzVHlwb0ZpeD86IGJvb2xlYW4sXG4gICAgbWF0Y2hMZXZlbDogbnVtYmVyLFxuICAgIGxleGVtZXM6IFNldDxzdHJpbmc+XG4gIH0+KCk7XG4gIGRiVGV4dHMgPSBkYlRleHRzLm1hcChlbnRpdHkgPT4gKHsuLi5lbnRpdHksIG5hbWU6IGVudGl0eS5uYW1lLnRyaW0oKX0pKS5maWx0ZXIoKHtuYW1lfSkgPT4gISFuYW1lKTtcbiAgY29uc3QgeG1sU2V0ID0gbmV3IE1hcDxzdHJpbmcsIHtodG1sOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ30+KCk7XG4gIHhtbFRleHRzLmZvckVhY2goaXRlbSA9PiB4bWxTZXQuc2V0KGl0ZW0uaHRtbCwgaXRlbSkpO1xuICBjb25zdCBkYlNldCA9IG5ldyBNYXA8c3RyaW5nLCB7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9PigpO1xuICBkYlRleHRzLmZvckVhY2goZW50aXR5ID0+IGRiU2V0LnNldChlbnRpdHkubmFtZSwgZW50aXR5KSk7XG4gIC8vIFJlbW92ZSB0aG9zZSB3aG8gYWxyZWFkeSBleGlzdHMgaWRlbnRpY2FsbHlcbiAgZGJUZXh0cyA9IGRiVGV4dHMuZmlsdGVyKGVudGl0eSA9PiAheG1sU2V0LmhhcyhlbnRpdHkubmFtZSkpO1xuICB4bWxUZXh0cyA9IHhtbFRleHRzLmZpbHRlcihpdGVtID0+ICFkYlNldC5oYXMoaXRlbS5odG1sKSk7XG5cbiAgLy8gTm93LCBmb3IgdGhlIHJlbWFpbmRlciwgdHJ5IHRoZSBiZXN0IHRvIG1hcCBvbGQgdGV4dHMgdG8gbmV3IHRleHRzLCBhbmQgd2hlbiBkb25lLCBjaGVjayBpZiB0aGVyZSBhcmUgbmV3IHRleHRzIHRoYXQgbmV2ZXIgZ290IG1hcHBlZC5cblxuICAvLyBTdGFydCBieSBwdXR0aW5nIGFsbCBkYlRleHQgaW50byB0aGUgcmVzdWx0LCB3aXRob3V0IGEgcGFpcmVkIHhtbCB0ZXh0IHlldDpcbiAgZGJUZXh0cy5mb3JFYWNoKGRiVGV4dCA9PiBpZHNUb01pZ3JhdGUuc2V0KGRiVGV4dC5pZCwge1xuICAgIGdyYWRlU3RlcDogZGJUZXh0LmdyYWRlU3RlcCxcbiAgICBvbGRUZXh0OiBkYlRleHQubmFtZSxcbiAgICBsZXhlbWVzOiBnZXRMZXhlbWVzKGRiVGV4dC5uYW1lKSxcbiAgICBtYXRjaExldmVsOiAwXG4gIH0pKTtcbiAgLy8gVGhlbiB0cnkgdG8gcGFpciBlYWNoIHhtbFRleHQgdG8gYW4gaXRlbSBpbiBpZHNUb01pZ3JhdGVcbiAgY29uc3QgeG1sU3BpbnN0ZXJzOiB7aHRtbDogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10gPSBbXTtcbiAgd2hpbGUgKHhtbFRleHRzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB4bWxUZXh0ID0geG1sVGV4dHNbMF07XG4gICAgY29uc3QgYmVzdE1hdGNoID0gZmluZEJlc3RNYXRjaCh4bWxUZXh0KTtcbiAgICBpZiAoIWJlc3RNYXRjaCkge1xuICAgICAgeG1sU3BpbnN0ZXJzLnB1c2goeG1sVGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChiZXN0TWF0Y2gubmV3VGV4dCkge1xuICAgICAgICAvLyBUaHJvdyBvdXQgZXhpc3RpbmcgbWF0Y2hcbiAgICAgICAgeG1sVGV4dHMucHVzaCh7aHRtbDogYmVzdE1hdGNoLm5ld1RleHQsIGdyYWRlU3RlcDogYmVzdE1hdGNoLmdyYWRlU3RlcH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFpciA9IGlkc1RvTWlncmF0ZS5nZXQoYmVzdE1hdGNoLmlkKTtcbiAgICAgIC8vIFBhaXIgbXlzZWxmIHdpdGggdGhpcyBtYXRjaDpcbiAgICAgIHBhaXIubmV3VGV4dCA9IHhtbFRleHQuaHRtbDtcbiAgICAgIHBhaXIubWF0Y2hMZXZlbCA9IGJlc3RNYXRjaC5teU1hdGNoTGV2ZWw7XG4gICAgICBwYWlyLm5ld0lkID0gbmV3VGV4dHMuZ2V0KHhtbFRleHQuaHRtbCk7XG4gICAgfVxuICAgIHhtbFRleHRzLnNoaWZ0KCk7XG4gIH1cbiAgLy8gRm9yIGVhY2ggc3BpbnN0ZXIgKG5ldyB0ZXh0cyB0aGF0IGNvdWxkbid0IGZpbmQgYW55IG1hdGNoIGluIG9sZCB0ZXh0cyksXG4gIC8vIEFkZCB0aGVtIHdpdGggYW4gZmljdGl2ZSBvbGQgSUQgYnV0IG9taXQgb2xkVGV4dCB0byBtYXJrIGl0IGFzIGEgbmV3Y29tZXJcbiAgeG1sU3BpbnN0ZXJzLmZvckVhY2goc3BpbnN0ZXIgPT4ge1xuICAgIGlkc1RvTWlncmF0ZS5zZXQoZmljdGl2ZU9sZElkKCksIHtcbiAgICAgIG5ld0lkOiBuZXdUZXh0cy5nZXQoc3BpbnN0ZXIuaHRtbCksXG4gICAgICBuZXdUZXh0OiBzcGluc3Rlci5odG1sLFxuICAgICAgZ3JhZGVTdGVwOiBzcGluc3Rlci5ncmFkZVN0ZXAsXG4gICAgICBtYXRjaExldmVsOiAwLFxuICAgICAgbGV4ZW1lczogbmV3IFNldDxzdHJpbmc+KCl9KVxuICB9KTtcblxuICAvLyBNYXJrIHR5cG8tZml4ZXNcbiAgaWRzVG9NaWdyYXRlLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgIGNvbnN0IHtvbGRUZXh0LCBuZXdUZXh0fSA9IG1hdGNoO1xuICAgIGlmIChvbGRUZXh0ICYmIG5ld1RleHQpIHtcbiAgICAgIGlmIChbLi4uZ2V0TGV4ZW1lcyhvbGRUZXh0KV0uam9pbignICcpID09PSBbLi4uZ2V0TGV4ZW1lcyhuZXdUZXh0KV0uam9pbignICcpKSB7XG4gICAgICAgIG1hdGNoLmlzVHlwb0ZpeCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBjb25zb2xlLmxvZyhcIklkc1RvTWlncmF0ZVwiLCBbLi4uaWRzVG9NaWdyYXRlLnZhbHVlcygpXS5tYXAoKHtvbGRUZXh0LCBsZXhlbWVzfSkgPT4gYCR7Wy4uLmxleGVtZXNdLmpvaW4oJyAnKX06ICR7b2xkVGV4dH1gKSk7XG5cbiAgcmV0dXJuIGlkc1RvTWlncmF0ZTtcblxuICBmdW5jdGlvbiBmaW5kQmVzdE1hdGNoKHhtbFRleHQ6IHtodG1sOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ30pIHtcbiAgICBjb25zdCB4bWxMZXhlbWVzID0gZ2V0TGV4ZW1lcyh4bWxUZXh0Lmh0bWwpO1xuICAgIGNvbnN0IHBvc3NpYmxlUGFydG5lcnMgPSBbLi4uaWRzVG9NaWdyYXRlLmVudHJpZXMoKV1cbiAgICAgIC5maWx0ZXIoKFtpZCwgeF0pID0+IHguZ3JhZGVTdGVwID09PSB4bWxUZXh0LmdyYWRlU3RlcClcbiAgICAgIC5tYXAoKFtpZCwge2dyYWRlU3RlcCwgbWF0Y2hMZXZlbCwgbmV3VGV4dCwgbGV4ZW1lc31dKSA9PiAoe1xuICAgICAgICBpZCxcbiAgICAgICAgZ3JhZGVTdGVwLFxuICAgICAgICBtYXRjaExldmVsLFxuICAgICAgICBuZXdUZXh0LFxuICAgICAgICBteU1hdGNoTGV2ZWw6IGdldE1hdGNoTGV2ZWwoeG1sTGV4ZW1lcywgbGV4ZW1lcylcbiAgICAgIH0pKS5maWx0ZXIocHAgPT4gcHAubXlNYXRjaExldmVsID49IDUwICYmICghcHAubWF0Y2hMZXZlbCB8fCBwcC5tYXRjaExldmVsIDwgcHAubXlNYXRjaExldmVsKSk7XG4gICAgcmV0dXJuIHBvc3NpYmxlUGFydG5lcnMuc29ydCgoYSwgYikgPT4gYi5teU1hdGNoTGV2ZWwgLSBhLm15TWF0Y2hMZXZlbClbMF07IC8vIGhpZ2hlc3QgZmlyc3QuXG4gIH1cblxuICBmdW5jdGlvbiBnZXRNYXRjaExldmVsKGxleGVtZXMxOiBTZXQ8c3RyaW5nPiwgbGV4ZW1lczI6IFNldDxzdHJpbmc+KSB7XG4gICAgaWYgKGxleGVtZXMxLnNpemUgPT09IDAgfHwgbGV4ZW1lczIuc2l6ZSA9PT0gMCkgcmV0dXJuIDA7XG4gICAgbGV0IHBvaW50czEgPSAwO1xuICAgIGxldCBwb2ludHMyID0gMDtcbiAgICBsZXhlbWVzMS5mb3JFYWNoKHdvcmQgPT4ge1xuICAgICAgaWYgKGxleGVtZXMyLmhhcyh3b3JkKSkgKytwb2ludHMxO1xuICAgIH0pO1xuICAgIGxleGVtZXMyLmZvckVhY2god29yZCA9PiB7XG4gICAgICBpZiAobGV4ZW1lczEuaGFzKHdvcmQpKSArK3BvaW50czI7XG4gICAgfSk7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoMTAwICogTWF0aC5tYXgocG9pbnRzMSAvIGxleGVtZXMxLnNpemUsIHBvaW50czIgLyBsZXhlbWVzMi5zaXplKSk7XG4gIH1cblxuICAvKmlmIChkYlRleHRzLmxlbmd0aCAhPT0geG1sVGV4dHMubGVuZ3RoKSB7XG4gICAgLy8gV2UgY2FuIG5vIGxvbmdlciBhc3N1bWUgdGhhdCB0aGUgY2hhbmdlZCB0ZXh0cyByZWZlciB0byBkaWZmZXJlbnQgZm9ybXVsYXRpb25zIG9mIHRoZSBzYW1lIG1lYW5pbmcuXG4gICAgLy8gV2Ugbm90IG1hcCBvbGQgZm9ybXVsYXRpb25zIHRvIG5ldyBvbmVzLlxuICAgIC8vIEluIGZ1dHVyZSwgd2UgY291bGQgaGFuZGxlIHRoaXMgY2FzZSBieSBhc3N1bWluZyBhbGwgb2xkIHRleHRzIG5vdCBvY2N1cnJpbmcgaW4gbmV3IGRhdGEsIGhhdmUgYmVlbiByZW1vdmVkIGFuZCBhbGwgbmV3IGhhdmUgYmVlbiBhZGRlZC5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJOdW1iZXIgb2YgXCIgKyB0ZXh0VHlwZSArIChjb3Vyc2UgPyBgIG9uIGNvdXJzZSAke2NvdXJzZX1gIDogXCJcIikgKyBcIiBkaWZmZXJzLiBDYW5ub3QgbWlncmF0ZS5cIik7XG4gIH1cbiAgZGJUZXh0cy5mb3JFYWNoKCh7bmFtZTogb2xkVGV4dCwgaWQ6IG9sZElkLCBncmFkZVN0ZXB9LCBpKSA9PiB7XG4gICAgY29uc3QgeG1sVGV4dCA9IHhtbFRleHRzW2ldLnRyaW0oKTtcbiAgICBpZiAob2xkVGV4dC50cmltKCkgIT09IHhtbFRleHQpIHtcbiAgICAgIGlkc1RvTWlncmF0ZS5zZXQob2xkSWQsIHtuZXdUZXh0OiB4bWxUZXh0LCBuZXdJZDogbmV3VGV4dHMuZ2V0KHhtbFRleHQpLCBvbGRUZXh0LCBncmFkZVN0ZXB9KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gaWRzVG9NaWdyYXRlOyovXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWdyYXRlU3ViamVjdChleGlzdGluZ1N1YmplY3Q6IFN1YmplY3QsIGNvdXJzZVNldHM6IENvdXJzZVNldFtdLCBzdWJqZWN0VG9JbXBvcnQ6IFN1YmplY3RUb0ltcG9ydCwgY2hhbmdlczogQ2hhbmdlW10pIHtcbiAgLy8gR2VuZXJhdGUgZGJUZXh0TWFwOlxuICAvLyBkYlRleHRNYXAgY29udGFpbnMgYSBtYXAgZnJvbSBvbGQgdGV4dHMgKEFiaWxpdGllcywgQ2VudHJhbCBDb250ZW50IG9yIEtub3dsZWRnZSBSZXF1aXJlbWVudHMpIHRvIGl0cyBJRCBpbiB0aGUgZGF0YWJhc2UuXG4gIC8vIFRoZSBtYXAgc2hvdWxkIGJlIHVzZWQgdG8gbG9va3VwIElEcywgZ2l2ZW4gdGhlaXIgdHJpbW1lZCB0ZXh0LlxuICBjb25zdCBkYlRleHRNYXAgPSBuZXcgTWFwPHN0cmluZywgSUQ+KCk7XG4gIGNvbnN0IG9yZGVyZWRBYmlsaXRpZXMgPSBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgP1xuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlci5tYXAoaWQgPT4gZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpKSA6XG4gICAgZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllcztcbiAgZm9yIChjb25zdCBhIG9mIG9yZGVyZWRBYmlsaXRpZXMpIHtcbiAgICBkYlRleHRNYXAuc2V0KGEubmFtZS50cmltKCksIGEuaWQpO1xuICB9XG4gIGZvciAoY29uc3Qge3RlbXBsYXRlfSBvZiBjb3Vyc2VTZXRzKSB7XG4gICAgZm9yIChjb25zdCBjYyBvZiB0ZW1wbGF0ZS5jZW50cmFsQ29udGVudCkge1xuICAgICAgZGJUZXh0TWFwLnNldChjYy5uYW1lLnRyaW0oKSwgY2MuaWQpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtyIG9mIHRlbXBsYXRlLmtub3dsZWRnZVJlcXVpcmVtZW50cykge1xuICAgICAgZGJUZXh0TWFwLnNldChrci5uYW1lLnRyaW0oKSwga3IuaWQpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEZpbmQgb3V0IHdoaWNoIG5ldyB0ZXh0cyAoaW4gdG90YWwpIHRoYXQgc2hvdWxkIGJlIGNyZWF0ZWQgaW4gdGhlIERCIG9uIG1pZ3JhdGluZy5cbiAgLy8gTWF5YmUgYWxzbyBmaW5kIG91dCBpZiB0aGVyZSBhcmUgYW55IG9sZCB0ZXh0cyB3aG8ncyBvYmplY3RzIGFyZSBubyBtb3JlIHVzZWQgYW5kIGNvdWxkIGJlIHJlbW92ZWQgZnJvbSB0aGUgREJcbiAgLy8gbmV3VGV4dHM6IEEgbWFwIGJldHdlZW4gYSBuZXcgdGV4dCBhbmQgaXRzIG5ldyBJRCBpbiB0aGUgZGF0YWJhc2UgYWZ0ZXIgY3JlYXRpbmcgaXQuXG4gIC8vIHJlbW92ZWRJZHM6IEEgc2V0IG9mIGV4aXN0aW5nIGlkcyB0aGF0IHdvdWxkIGJlIHNhZmUgdG8gcmVtb3ZlIG9uIG1pZ3JhdGluZyAod2lsbCBpZ25vcmUgdGhvc2UgZm9yIG5vdylcbiAgY29uc3Qge25ld1RleHRzOiBuZXdBYmlsaXR5VGV4dHMsIGlkc1RvQWRkOiBhYmlsaXRpZXNUb0FkZH0gPVxuICAgIGRpZmZTdWJqZWN0R2xvYmFsVGV4dHMoZGJUZXh0TWFwLCBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzKTtcbiAgY29uc3Qge25ld1RleHRzOiBuZXdDQ1RleHRzLCBpZHNUb0FkZDogY2NzVG9BZGR9ID1cbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgZmxhdHRlbihzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5tYXAoYyA9PiBjLmNlbnRyYWxDb250ZW50Lm1hcChjYyA9PiBjYy5odG1sKSkpKTtcbiAgY29uc3Qge25ld1RleHRzOiBuZXdLUlRleHRzLCBpZHNUb0FkZDoga3JzVG9BZGR9ID1cbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgZmxhdHRlbihzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5tYXAoYyA9PiBjLmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoa3IgPT4ga3IuaHRtbCkpKSk7XG4gIFxuICBjb25zb2xlLmxvZyhgQWJpbGl0aWVzIHRvIGFkZDogJHthYmlsaXRpZXNUb0FkZC5zaXplfWApO1xuICBjb25zb2xlLmxvZyhgQ0NzIHRvIGFkZDogJHtjY3NUb0FkZC5zaXplfWApO1xuICBjb25zb2xlLmxvZyhgS1JzIHRvIGFkZDogJHtrcnNUb0FkZC5zaXplfWApO1xuXG4gIC8vIEZpbmQgb3V0IGFsbCBleGlzdGluZyBBYmlsaXR5IGlkcyB0aGF0IHdpbGwgYmUgbWlncmF0ZWQgdG8gbmV3IG9uZXNcbiAgY29uc3QgYWJpbGl0eUlkc1RvTWlncmF0ZSA9IGdldElkc1RvTWlncmF0ZShcbiAgICBvcmRlcmVkQWJpbGl0aWVzLFxuICAgIHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKGh0bWwgPT4gKHtodG1sfSkpLFxuICAgIG5ld0FiaWxpdHlUZXh0cyxcbiAgICBcImFiaWxpdGllc1wiKTtcblxuICAvLyBEbyB0aGUgc2FtZSBmb3IgZWFjaCBDZW50cmFsIENvbnRlbnQgYW5kIEtub3dsZWRnZSBSZXF1aXJlbWVudHMgb24gZWFjaCBjb3Vyc2U6XG4gIGNvbnN0IGlkc1RvTWlncmF0ZVBlckNvdXJzZSA9IGNvdXJzZVNldHMubWFwKCh7dGVtcGxhdGV9LCBpKSA9PiB7XG4gICAgY29uc29sZS5sb2coYENvdXJzZTogJHt0ZW1wbGF0ZS5uYW1lfWApO1xuICAgIGNvbnN0IHhtbENvdXJzZSA9IHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLm5hbWUgPT09IHRlbXBsYXRlLm5hbWUpIHx8XG4gICAgICBzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5maW5kKGMgPT4gYy5jb2RlID09PSB0ZW1wbGF0ZS5jb2RlKTtcbiAgICByZXR1cm4ge1xuICAgICAgY291cnNlQ29kZTogdGVtcGxhdGUuY29kZSxcbiAgICAgIGNjc1RvTWlncmF0ZTogeG1sQ291cnNlID9cbiAgICAgICAgZ2V0SWRzVG9NaWdyYXRlKFxuICAgICAgICAgIHRlbXBsYXRlLmNlbnRyYWxDb250ZW50LCAvLyBIYXMgYWxyZWFkeSBiZWVuIHNvcnRlZCB3aGVuIHJldHJpZXZlZCB2aWEgbG9hZENvdXJzZSgpXG4gICAgICAgICAgeG1sQ291cnNlLmNlbnRyYWxDb250ZW50Lm1hcCgoe2h0bWx9KSA9PiAoe2h0bWx9KSksXG4gICAgICAgICAgbmV3Q0NUZXh0cyxcbiAgICAgICAgICBcImNlbnRyYWwgY29udGVudFwiLFxuICAgICAgICAgIHRlbXBsYXRlLm5hbWUpIDpcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGlzVHlwb0ZpeDogYm9vbGVhbn0+KCksXG4gICAgICBrcnNUb01pZ3JhdGU6IHhtbENvdXJzZSA/XG4gICAgICAgIGdldElkc1RvTWlncmF0ZShcbiAgICAgICAgICB0ZW1wbGF0ZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMsIC8vIEhhcyBhbHJlYWR5IGJlZW4gc29ydGVkIHdoZW4gcmV0cmlldmVkIHZpYSBsb2FkQ291cnNlKClcbiAgICAgICAgICB4bWxDb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLFxuICAgICAgICAgIG5ld0tSVGV4dHMsXG4gICAgICAgICAgXCJrbm93bGVkZ2UgcmVxdWlyZW1lbnRzXCIsXG4gICAgICAgICAgdGVtcGxhdGUubmFtZVxuICAgICAgICApIDpcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGdyYWRlU3RlcDogc3RyaW5nLCBpc1R5cG9GaXg6IGJvb2xlYW59PigpXG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gT0sgc28gbm93IHdlIGhhdmUgYWxsIGluZm8uXG4gIC8vIE5vdywgd2UgbmVlZCB0bzpcbiAgLy8gU3ViamVjdDpcbiAgLy8gMS4gUmVtb3ZlIGxpbmtzIGZyb20gc3ViamVjdHMgdG8gYWJpbGl0aWVzXG4gIC8vIDIuIEFkZCBsaW5rcyBmcm9tIHN1YmplY3RzIHRvIGFiaWxpdGllc1xuICBhYmlsaXR5SWRzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdUZXh0LCBuZXdJZCwgb2xkVGV4dCwgaXNUeXBvRml4fSwgb2xkSWQpID0+IHtcbiAgICAvL2NvbnN0IG9sZFRleHQgPSBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzLmZpbmQoYSA9PiBhLmlkID09PSBvbGRJZCkubmFtZTtcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgY2hhbmdlOiAoXG4gICAgICAgIG9sZFRleHQgP1xuICAgICAgICAgIG5ld1RleHQgP1xuICAgICAgICAgICAgaXNUeXBvRml4ID9cbiAgICAgICAgICAgICAgYFRyeWNrZmVsc3LDpHR0bmluZyBGw7ZybcOlZ2FgIDpcbiAgICAgICAgICAgICAgYFVwcGRhdGVyYWQgRsO2cm3DpWdhYCA6XG4gICAgICAgICAgICBgQm9ydHRhZ2VuIEbDtnJtw6VnYWAgOlxuICAgICAgICAgIGBOeSBGw7ZybcOlZ2FgXG4gICAgICApLFxuICAgICAgY29udGVudDogYDxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXG4gICAgICBtdXRhdGlvbnM6IGJyID0+IHtcbiAgICAgICAgaWYgKG5ld0lkICYmIGFiaWxpdGllc1RvQWRkLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICBjb25zdCBhOiBBYmlsaXR5ID0ge1xuICAgICAgICAgICAgaWQ6IG5ld0lkLFxuICAgICAgICAgICAgbmFtZTogbmV3VGV4dCxcbiAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKVxuICAgICAgICAgIH07XG4gICAgICAgICAgYnIuYWRkKFwiYWJpbGl0aWVzXCIsIGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwic3ViamVjdHNcIiwgZXhpc3RpbmdTdWJqZWN0LmlkLCBcImFiaWxpdGllc1wiLCBvbGRJZCk7XG4gICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJzdWJqZWN0c1wiLCBleGlzdGluZ1N1YmplY3QuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0lkKTtcbiAgICAgIH1cbiAgICB9KVxuICB9KTtcbiAgLy8gMy4gVXBkYXRlIGFiaWxpdGllc09yZGVyIG9uIFN1YmplY3QgYmFzZWQgb24gc3ViamVjdFRvSW1wb3J0LmFiaWxpdGllcyAobWFwcGVkIHRvIGlkcyBpbiBuZXdUZXh0cylcbiAgaWYgKCFleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgfHwgYWJpbGl0eUlkc1RvTWlncmF0ZS5zaXplID4gMCkge1xuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA9IHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKHhtbCA9PiBuZXdBYmlsaXR5VGV4dHMuZ2V0KHhtbCkpO1xuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBtdXRhdGlvbnM6IGJyID0+IGJyLnB1dChcInN1YmplY3RzXCIsIGV4aXN0aW5nU3ViamVjdCksXG4gICAgICBjaGFuZ2U6IGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA/XG4gICAgICAgIG51bGwgOiAvLyDDhG5kcmluZ2VuIHJlZGFuIHZpc3VlbGwgc29tIFwiVXBwZGF0ZXJhZCBmw7ZyIGbDtnJtw6VnYVwiLCBldGMsIG92YW5cbiAgICAgICAgYEluZsO2ciBlbiBvcmRuYWQgbGlzdGEgcMOlIGbDtnJtw6Vnb3IgaSBkYXRhYmFzZW5gLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgY3JlYXRlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XG4gIGNoYW5nZXMucHVzaCh7bXV0YXRpb25zOiAoKT0+Y3JlYXRlZElkcy5jbGVhcigpfSk7IC8vIEluIGNhc2UgbXV0YXRpb25zIHJ1biB0d2ljZSAod2hpY2ggaXQgZG9lc24ndCBhcyBvZiBjdXJyZW50IGltcGwuKVxuICBjb25zdCBzaG93bkNoYW5nZXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gU2V0IG9mIGNvdXJzZU5hbWVcbiAgY2hhbmdlcy5wdXNoKHttdXRhdGlvbnM6ICgpPT5zaG93bkNoYW5nZXMuY2xlYXIoKX0pO1xuICBcbiAgLy8gQ291cnNlczpcbiAgLy8gMS4gR28gdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyBhbmQ6XG4gIC8vICAgICAgQTogUmVtb3ZlIGxpbmtzIGZyb20gY291cnNlcyB0byBhYmlsaXRpZXMgbGlzdGVkIGluIGFiaWxpdHlJZHNUb01pZ3JhdGUua2V5cygpXG4gIC8vICAgICAgQjogQWRkIGxpbmtzIGZyb20gY291cnNlcyB0byBhYmlsaXRpZXMgYWJpbHRpdGllc1RvTWlncmF0ZS52YWx1ZXMoKVxuICAvLyAgICAgIEM6IFVwZGF0ZSBhYmlsaXRpZXNPcmRlciBvbiBjb3Vyc2UgaW5zdGFuY2VzIGJhc2VkIG9uIHN1YmplY3RUb0ltcG9ydCAobWFwcGVkIHRvIGlkcyBpbiBuZXdUZXh0cylcbiAgLy8gMiwgMzogRG8gdGhlIHNhbWUgZm9yIGNlbnRyYWwtY29udGVudCBhbmQga25vd2xlZGdlLXJlcXVpcmVtZW50ZXM6XG4gIC8vICAgIEZpbmQgY2NzIGFuZCBrcnMgdG8gbWlncmF0ZSBiYXNlZCBvbiBjb3Vyc2VJbnN0YW5jZS5jb2RlXG4gIC8vICAgIEZvciBib3RoIGNjcyBhbmQga3JzLCBkbzpcbiAgLy8gICAgICBBOiBVbmxpbmsgY2NzVG9NaWdyYXRlLmtleXMoKVxuICAvLyAgICAgIEI6IExpbmsgY2NzVG9NaWdyYXRlLnZhbHVlcygpXG4gIC8vICAgICAgQzogVXBkYXRlIGNlbnRyYWxDb250ZW50T3JkZXIgYmFzZWQgb24gc3ViamVjdFRvSW1wb3J0LmNlbnRyYWxDb250ZW50IG1hcHBlZCB0byBuZXdUZXh0cyBpZHNcbiAgLy8gICAgICAoc2FtZSBmb3Iga3JzVG9NaWdyYXRlLCB3aXRoIGtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyIGluc3RlYWQpXG4gIGZvciAoY29uc3Qge3RlbXBsYXRlLCBpbnN0YW5jZXN9IG9mIGNvdXJzZVNldHMpIHtcbiAgICAvLyBGaW5kIGNvdXJzZVRvSW1wb3J0XG4gICAgY29uc3QgY291cnNlVG9JbXBvcnQ6IENvdXJzZVRvSW1wb3J0ID0gKFxuICAgICAgc3ViamVjdFRvSW1wb3J0LmNvdXJzZXMuZmluZChjID0+IGMubmFtZSA9PT0gdGVtcGxhdGUubmFtZSkgfHxcbiAgICAgIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLmNvZGUgPT09IHRlbXBsYXRlLmNvZGUpXG4gICAgKTtcblxuICAgIC8vIEZpbmQgQ2VudHJhbCBDb250ZW50IGFuZCBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzIHRvIG1pZ3JhdGVcbiAgICBjb25zdCB7Y2NzVG9NaWdyYXRlLCBrcnNUb01pZ3JhdGV9OiB7XG4gICAgICBjY3NUb01pZ3JhdGU6IE1hcDxJRCwge25ld1RleHQ/OiBzdHJpbmcsIG5ld0lkPzogSUQsIG9sZFRleHQ/OiBzdHJpbmd9PixcbiAgICAgIGtyc1RvTWlncmF0ZTogTWFwPElELCB7bmV3VGV4dD86IHN0cmluZywgbmV3SWQ/OiBJRCwgb2xkVGV4dD86IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfT5cbiAgICB9ID0gaWRzVG9NaWdyYXRlUGVyQ291cnNlLmZpbmQoeCA9PiB4LmNvdXJzZUNvZGUgPT09IHRlbXBsYXRlLmNvZGUpO1xuICAgIFxuICAgIC8vIExvb3AgdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyAoaW5zdGFuY2VzIGFsc28gY29udGFpbnMgdGVtcGxhdGVzKVxuICAgIC8vIGFuZCBtaWdyYXRlIHRoZW0uIFRoaXMgd2lsbCBpbmNsdWRlIGNyZWF0aW5nIG1pc3NpbmcgZW50aXRpZXMgaW4gdGhlIERCLlxuICAgIGZvciAoY29uc3QgY291cnNlIG9mIGluc3RhbmNlcykge1xuICAgICAgbWlncmF0ZUNvdXJzZUluc3RhbmNlKGNvdXJzZSwgY291cnNlVG9JbXBvcnQsIHtjY3NUb01pZ3JhdGUsIGtyc1RvTWlncmF0ZX0pO1xuICAgIH1cbiAgfVxuXG4gIGF3YWl0IG1pZ3JhdGVUYXNrcygpO1xuICByZXR1cm47XG5cbiAgZnVuY3Rpb24gbWlncmF0ZUNvdXJzZUluc3RhbmNlKFxuICAgIGNvdXJzZTogQ291cnNlLFxuICAgIGNvdXJzZVRvSW1wb3J0OiBDb3Vyc2VUb0ltcG9ydCxcbiAgICBpZHNUb01pZ3JhdGU6IHtcbiAgICAgIGNjc1RvTWlncmF0ZTogTWFwPElELCB7bmV3VGV4dD86IHN0cmluZywgbmV3SWQ/OiBJRCwgb2xkVGV4dD86IHN0cmluZywgaXNUeXBvRml4PzogYm9vbGVhbn0+LFxuICAgICAga3JzVG9NaWdyYXRlOiBNYXA8SUQsIHtuZXdUZXh0Pzogc3RyaW5nLCBuZXdJZD86IElELCBvbGRUZXh0Pzogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmcsIGlzVHlwb0ZpeD86IGJvb2xlYW59PlxuICAgIH0pXG4gIHtcbiAgICBjb25zdCBzaG93Q2hhbmdlcyA9ICFzaG93bkNoYW5nZXMuaGFzKGNvdXJzZS5uYW1lKTtcbiAgICBzaG93bkNoYW5nZXMuYWRkKGNvdXJzZS5uYW1lKTtcbiAgICBhYmlsaXR5SWRzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdJZCwgb2xkVGV4dH0sIG9sZElkKSA9PiB7XG4gICAgICAvLyBSZWxpbmsgdGhlIGNvdXJzZSBpbnN0YW5jZSB3aXRoIGFiaWxpdGllcy4gVGhpcyBjaGFuZ2UgZG9lcyBub3QgbmVlZCB0byBiZSB2aXNpYmxlIGluIEdVSS5cbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIG11dGF0aW9uczogYnIgPT4ge1xuICAgICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIG9sZElkKTtcbiAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0lkKTtcbiAgICAgICAgfVxuICAgICAgfSk7ICBcbiAgICB9KTtcbiAgICBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIgPSBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzLm1hcChodG1sID0+IG5ld0FiaWxpdHlUZXh0cy5nZXQoaHRtbCkpO1xuXG4gICAgY29uc3Qge2Njc1RvTWlncmF0ZSwga3JzVG9NaWdyYXRlfSA9IGlkc1RvTWlncmF0ZTtcblxuICAgIC8vIENlbnRyYWwgQ29udGVudFxuICAgIGNjc1RvTWlncmF0ZS5mb3JFYWNoKCh7bmV3SWQsIG5ld1RleHQsIG9sZFRleHQsIGlzVHlwb0ZpeH0sIG9sZElkKSA9PiB7XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBjaGFuZ2U6IHNob3dDaGFuZ2VzICYmIChcbiAgICAgICAgICBvbGRUZXh0ID9cbiAgICAgICAgICAgIG5ld1RleHQgP1xuICAgICAgICAgICAgICBpc1R5cG9GaXggP1xuICAgICAgICAgICAgICAgIGBUcnlja2ZlbHNyw6R0dG5pbmcgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICAgICAgYFVwcGRhdGVyYXQgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICBgTnl0dCBDZW50cmFsdCBJbm5laMOlbGxgKSxcbiAgICAgICAgY29udGVudDogYDxoND4ke2NvdXJzZS5uYW1lfTwvaDQ+PHN0cmlrZT4ke29sZFRleHQgfHwgJyd9PC9zdHJpa2U+PGJyLz4ke25ld1RleHQgfHwgJyd9YCxcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiB7XG4gICAgICAgICAgaWYgKG5ld0lkICYmIGNjc1RvQWRkLmhhcyhuZXdJZCkgJiYgIWNyZWF0ZWRJZHMuaGFzKG5ld0lkKSkge1xuICAgICAgICAgICAgY29uc3QgY2M6IENlbnRyYWxDb250ZW50ID0ge1xuICAgICAgICAgICAgICBpZDogbmV3SWQsXG4gICAgICAgICAgICAgIG5hbWU6IG5ld1RleHQsXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYnIuYWRkKFwiY2VudHJhbC1jb250ZW50XCIsIGNjKTtcbiAgICAgICAgICAgIGNyZWF0ZWRJZHMuYWRkKG5ld0lkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9sZFRleHQpIGJyLnVubGluazIoXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBvbGRJZCk7XG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIG5ld0lkKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KTtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlciA9IGNvdXJzZVRvSW1wb3J0LmNlbnRyYWxDb250ZW50Lm1hcCgoe2h0bWx9KSA9PiBuZXdDQ1RleHRzLmdldChodG1sKSk7XG5cbiAgICAvLyBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzXG4gICAga3JzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdJZCwgbmV3VGV4dCwgZ3JhZGVTdGVwLCBvbGRUZXh0LCBpc1R5cG9GaXh9LCBvbGRJZCkgPT4ge1xuICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgY2hhbmdlOiBzaG93Q2hhbmdlcyAmJiAoXG4gICAgICAgICAgb2xkVGV4dCA/XG4gICAgICAgICAgICBuZXdUZXh0ID9cbiAgICAgICAgICAgICAgaXNUeXBvRml4ID9cbiAgICAgICAgICAgICAgICBgVHJ5Y2tmZWxzcsOkdHRuaW5nIEt1bnNrYXBza3JhdmA6XG4gICAgICAgICAgICAgICAgYFVwcGRhdGVyYXQgS3Vuc2thcHNrcmF2YCA6XG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgS3Vuc2thcHNrcmF2YCA6XG4gICAgICAgICAgICBgTnl0dCBLdW5za2Fwc2tyYXZgXG4gICAgICAgICksXG4gICAgICAgIGNvbnRlbnQ6IGA8aDQ+JHtjb3Vyc2UubmFtZX08L2g0PjxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXG4gICAgICAgIG11dGF0aW9uczogYnIgPT4ge1xuICAgICAgICAgIGlmIChuZXdJZCAmJiBrcnNUb0FkZC5oYXMobmV3SWQpICYmICFjcmVhdGVkSWRzLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGtyOiBLbm93bGVkZ2VSZXF1aXJlbWVudCA9IHtcbiAgICAgICAgICAgICAgaWQ6IG5ld0lkLFxuICAgICAgICAgICAgICBuYW1lOiBuZXdUZXh0LFxuICAgICAgICAgICAgICBncmFkZVN0ZXAsXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEFkZGluZyBLbm93bGVkZ2UtUmVxdWlyZW1lbnQgJHtuZXdJZH06ICR7bmV3VGV4dH1gKTtcbiAgICAgICAgICAgIGJyLmFkZChcImtub3dsZWRnZS1yZXF1aXJlbWVudHNcIiwga3IpO1xuICAgICAgICAgICAgY3JlYXRlZElkcy5hZGQobmV3SWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob2xkVGV4dCkgYnIudW5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBvbGRJZCk7XG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBuZXdJZCk7ICBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyID1cbiAgICAgIGNvdXJzZVRvSW1wb3J0Lmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoa3IgPT4gbmV3S1JUZXh0cy5nZXQoa3IuaHRtbCkpO1xuXG4gICAgLy8gVXBkYXRlcyB0aGUgY291cnNlIHByb3BlcnRpZXMgY2VudHJhbENvbnRlbnRPcmRlciBhbmQga25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXJcbiAgICBpZiAoYWJpbGl0eUlkc1RvTWlncmF0ZS5zaXplID4gMCB8fCBjY3NUb01pZ3JhdGUuc2l6ZSA+IDAgfHwga3JzVG9NaWdyYXRlLnNpemUgPiAwKSB7XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBjaGFuZ2U6ICFjb3Vyc2UuaXNUZW1wbGF0ZSA/IGBVcHBkYXRlcmFkIEt1cnNpbnN0YW5zYCA6IGBVcHBkYXRlcmFkIEt1cnNtYWxsYCxcbiAgICAgICAgY29udGVudDogIWNvdXJzZS5pc1RlbXBsYXRlID9cbiAgICAgICAgICBgJHtjb3Vyc2UubmFtZX0uIFNrb2xhOiAke2NvdXJzZS5zY2hvb2wgfHwgXCJlaiBhbmdpdmVuXCJ9LiBCZXNrcml2bmluZzogJHtjb3Vyc2UuZGVzY3JpcHRpb24gfHwgJyd9YCA6XG4gICAgICAgICAgYCR7Y291cnNlLm5hbWV9YCxcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiBici5wdXQoXCJjb3Vyc2VzXCIsIGNvdXJzZSlcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gVGFza3M6XG4gIC8vIDEuIEFTWU5DIE9QRVJBVElPTjogR28gdGhyb3VnaCBhbGwgdGFza3MgdGhhdCBoYXMgZWRnZXMgdG8gYW55IG9mIHRoZSBvbGQgaWRzLlxuICAvLyAyLiBGb3IgZWFjaCBmb3VuZCB0YXNrLCBkbzpcbiAgLy8gICAgQTogSXRlcmF0ZSB0YWdzIHN0YXJ0aW5nIHdpdGggXCJjb3Vyc2U6XCIuIFBpY2sgdGhlIGNvdXJzZSBjb2RlLlxuICAvLyAgICBCOiBQb3B1bGF0ZSB0aGUgbmV3IHByb3BlcnR5IG1pZ3JhdGlvblRhc2tzOiB7XG4gIC8vICAgICAgICAgYWJpbGl0aWVzOiB7W25ld0lkOiBzdHJpbmddOiB7b2xkVGV4dDogc3RyaW5nLCBvbGRJZDogc3RyaW5nLCBpbXBvcnREYXRlOiBudW1iZXJ9fSwgLy8gQmUgYWJsZSB0byBjcmVhdGUgYSBjaGFpbiBpbiB0aGUgR1VJICFcbiAgLy8gICAgICAgICBjZW50cmFsQ29udGVudDoge1tuZXdJZDogc3RyaW5nXToge29sZFRleHQ6IHN0cmluZywgLi4uXCIuLi59fSxcbiAgLy8gICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHtbbmV3SWQ6IHN0cmluZ106IHtvbGRUZXh0OiBzdHJpbmcsIC4uLlwiLi4ufX0sXG4gIC8vICAgICAgIH1cbiAgLy8gICAgICAgT0JTMSEgTWVyZ2VhIGFiaWxpdGllcywgY2VudHJhbENvbmRlbnQgb2NoIGtub3dsZWRnZVJlcXVpcmVtZW50cyBtZWQgZXYgdGlkaWdhcmUgdsOkcmRlbiAoc8OlIG1hbiBrYW4gaW1wb3J0ZXJhIG9tIG9jaCBvbSBpZ2VuISlcbiAgLy8gICAgICAgT0JTMiEgb2xkSWQga2FuIGbDtnJla29tbWEgcMOlIGZsZXJhIG5ld0lkIG9tIHRhc2sgYW52w6RuZHMgYXYgZmxlcmEga3Vyc2VyLiBcbiAgLy8gICAgQzogQ3JlYXRlIHNldHMgZm9yIHVubGlua3MgYW5kIGxpbmsgb3BlcmF0aW9ucyBwZXIgdHlwZS5cbiAgLy8gICAgRDogRm9yIGFsbCBjb3Vyc2VDb2RlcyB0aGF0IHRoZSB0YXNrIGlzIHRhZ2dlbiBvbixcbiAgLy8gICAgICAgICAqIHJlZ2lzdGVyIGNjc1RvTWlncmF0ZS5rZXlzKCkgaW4gdGhlIHVubGluayBzZXQgb2YgY2VudHJhbCBjb250ZW50c1xuICAvLyAgICAgICAgICogcmVnaXN0ZXIgY2NzVG9NaWdyYXRlLnZhbHVlcygpIGluIHRoZSBsaW5rIHNldCBvZiBjZW50cmFsIGNvbnRlbnRzXG4gIC8vICAgICAgICAgKiAtLVwiLS0gZm9yIGtub3dsZWRnZVJlcXVpcmVtZW50c1xuICAvLyAgICBFOiB1bmxpbmsgYW5kIGxpbmsgd2l0aCByZWdhcmRzIHRvIGFiaWxpdHlJZHNUb01pZ3JhdGUgKGtleXMoKSBhbmQgdmFsdWVzKCkgcmVzcGVjdGl2ZWx5KS5cbiAgLy8gICAgRjogdW5saW5rIGFuZCBsaW5rIGFjY29yZGluZyB0byB0aGUgY3JlYXRlZCBzZXRzIG9mIGxpbmsgLyB1bmxpbmsgb3BlcmF0aW9ucy5cbiAgLy8gICAgTm90ZTogVW5saWtlIGNvdXJzZSBpbnN0YW5jZXMsIHRoZXJlJ3Mgbm8gb3JkZXIgcHJvcGVydHkgdG8gdGFrZSBjYXJlIG9mIGhlcmUhXG4gIC8vXG5cbiAgYXN5bmMgZnVuY3Rpb24gbWlncmF0ZVRhc2tzKCkge1xuICAgIGNvbnN0IG9sZElkcyA9IFtcbiAgICAgIC4uLmFiaWxpdHlJZHNUb01pZ3JhdGUua2V5cygpLFxuICAgICAgLi4uZmxhdHRlbihpZHNUb01pZ3JhdGVQZXJDb3Vyc2UubWFwKGMgPT4gW1xuICAgICAgICAuLi5jLmNjc1RvTWlncmF0ZS5rZXlzKCksXG4gICAgICAgIC4uLmMua3JzVG9NaWdyYXRlLmtleXMoKVxuICAgICAgXSkpXG4gICAgXS5maWx0ZXIoaWQgPT4gIWlkLnN0YXJ0c1dpdGgoJ2ZpY3RpdmVPbGRJZCcpKTtcbiAgICBcbiAgICBjb25zdCBpbXBvcnREYXRlID0gRGF0ZS5ub3coKTtcblxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZmV0Y2hUYXNrc0luQ2h1bmtzV2l0aEVkZ2VzVG8ob2xkSWRzLCB7XG4gICAgICBpbmNsdWRlOiBbXCJhYmlsaXRpZXNcIiwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgXCJjZW50cmFsQ29udGVudFwiXSxcbiAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXVxuICAgIH0pO1xuXG4gICAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hUYXNrc0luQ2h1bmtzV2l0aEVkZ2VzVG8oaWRzOiBzdHJpbmdbXSwgb3B0aW9uczogTGlzdE9wdGlvbnMpOiBQcm9taXNlPFRhc2tbXT4ge1xuICAgICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgbWFrZSB3b3JrIGFyb3VuZCB0aGUgY2FzZSB3aGVuIGdpdmVuIFwiaWRzXCIgY29udGFpbnMgdG9vIG1hbnkgaXRlbXMsIGJ5XG4gICAgICAvLyBkaXZpZGluZyB0aGUgcmVxdWVzdHMgaW50byBzZXZlcmFsIGFuZCBtZXJnZSB0aGUgcmVzdWx0IHVzaW5nIGEgTWFwLlxuICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTsgLy8gT3RoZXJ3aXNlIHdlJ2xsIHJlcXVlc3QgZXZlcnkgdGFzayBpbiB0aGUgc3lzdGVtLlxuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcDxJRCwgVGFzaz4oKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiTnVtYmVyIG9mIGlkczogXCIgKyBpZHMubGVuZ3RoKTtcbiAgICAgIC8vcmV0dXJuIHJlc3VsdC52YWx1ZXMoKTtcbiAgICAgIHJldHVybiBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICBoYXNFZGdlc1RvOiBpZHNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qY29uc3QgdGFza3MgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xuICAgICAgaGFzRWRnZXNUbzogb2xkSWRzLFxuICAgICAgaW5jbHVkZTogW1wiYWJpbGl0aWVzXCIsIFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsIFwiY2VudHJhbENvbnRlbnRcIl0sXG4gICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cbiAgICB9KTsqL1xuXG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzKSB7XG4gICAgICBjb25zdCBvbGRNVCA9IHRhc2subWlncmF0ZWRUZXh0cyB8fCB7XG4gICAgICAgIGFiaWxpdGllczoge30sXG4gICAgICAgIGNlbnRyYWxDb250ZW50OiB7fSxcbiAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiB7fVxuICAgICAgfTtcbiAgICAgIHRhc2subWlncmF0ZWRUZXh0cyA9IHtcbiAgICAgICAgYWJpbGl0aWVzOiB7fSxcbiAgICAgICAgY2VudHJhbENvbnRlbnQ6IHt9LFxuICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHt9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtdXRhdGlvbnM6IEFycmF5PChicjogQmF0Y2hSdW5uZXIpPT52b2lkPiA9IFtdO1xuICAgICAgY29uc3QgY2hhbmdlRGVzY3JpcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgZm9yIChjb25zdCB7aWR9IG9mIHRhc2suYWJpbGl0aWVzKSB7XG4gICAgICAgIGNvbnN0IG1pZ3JhdGlvbkluZm8gPSBhYmlsaXR5SWRzVG9NaWdyYXRlLmdldChpZCk7XG4gICAgICAgIGlmIChtaWdyYXRpb25JbmZvKSB7XG4gICAgICAgICAgY29uc3Qge25ld0lkLCBuZXdUZXh0LCBpc1R5cG9GaXh9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICBsZXQge29sZFRleHR9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICBsZXQgb2xkSWQgPSBpZDtcbiAgICAgICAgICBpZiAob2xkTVQuYWJpbGl0aWVzW2lkXSkge1xuICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAvLyBXZSBzaG91bGQgcG9pbnQgb3V0IHRoZSB2ZXJ5IG9sZCBpZCBhbmQgdGV4dCBpbnN0ZWFkIG9mIHRoZSBuZXZlci1hY2tub3dsZWRnZWQgb25lLlxuICAgICAgICAgICAgb2xkVGV4dCA9IG9sZE1ULmFiaWxpdGllc1tpZF0ub2xkVGV4dDtcbiAgICAgICAgICAgIG9sZElkID0gb2xkTVQuYWJpbGl0aWVzW2lkXS5vbGRJZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5ld0lkICYmIG9sZFRleHQgIT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxuICAgICAgICAgICAgaWYgKCFpc1R5cG9GaXgpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXNuJ3QganVzdCBhIHR5cG8gZml4IChjaGFuZ2VzIGluIHN0b3Agd29yZHMsIGNhc2luZyBvciBzcGVjaWFsIGNoYXJhY3RlcnMpXG4gICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5hYmlsaXRpZXNbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgbXV0YXRpb25zLnB1c2goYnIgPT4ge1xuICAgICAgICAgICAgYnIudW5saW5rMihcInRhc2tzXCIsIHRhc2suaWQsIFwiYWJpbGl0aWVzXCIsIGlkKTtcbiAgICAgICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJ0YXNrc1wiLCB0YXNrLmlkLCBcImFiaWxpdGllc1wiLCBuZXdJZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2goYDxzdHJpa2U+JHtvbGRUZXh0fTwvc3RyaWtlPmApO1xuICAgICAgICAgIGlmIChuZXdJZCkge1xuICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhc2tDb3Vyc2VDb2RlcyA9IG5ldyBTZXQ8c3RyaW5nPih0YXNrLnRhZ3MgPyBcbiAgICAgICAgdGFzay50YWdzLmZpbHRlcih0ID0+IHQuc3RhcnRzV2l0aCgnY291cnNlOicpKS5tYXAodCA9PiB0LnN1YnN0cihcImNvdXJzZTpcIi5sZW5ndGgpKSA6XG4gICAgICAgIFtdKTtcblxuICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGxpbmtlZElkcyAoZm9yIHRoaXMgcGFydGljdWxhciB0YXNrKSBmb3IgdGhlIGZvbGxvd2luZyByZWFzb246XG4gICAgICAvLyBMZXQncyBzYXkgdGhlIHRhc2sgd2FzIHJlZmVycmVkIHRvIGJ5IHR3byBkaWZmZXJlbnQgY291cnNlcyAocG9zc2libGUgaW4gb2xkIHZlcnNpb25zKSxcbiAgICAgIC8vIGFuZCBpbiBvbGQgQ2VudHJhbCBDb250ZW50LCB0aGUgdHdvIGNvdXJzZXMgZGlkIGhhdmUgc2xpZ2h0bHkgZGlmZmVyZW50IGZvcm11bGF0aW9ucyBvZiBjZW50cmFsIGNvbnRlbnQsXG4gICAgICAvLyBzbyB0aGUgdGFzayB3YXMgbWFwcGVkIHRvIGJvdGggb2YgdGhlbS4gVGhlbiwgaW4gbmV3IFhNTCwgdGhlIHNhbWUgY2VudHJhbCBjb250ZW50IHdhcyBmb3JtdWxhdGVkXG4gICAgICAvLyBpbiBhIG5ldyB3YXkgdGhhdCBpcyBpZGVudGljYWwgdGhpcyB0aW1lIGJldHdlZW4gdGhlIHR3byBjb3Vyc2VzLiBUaGVuIGJvdGggb2xkIElEcyB3aWxsIGJlIHJlcGxhY2VkXG4gICAgICAvLyBieSBhIHNpbmdsZSBuZXcgSUQuIEl0IHdvdWxkIHRoZW4gYmUgdW5uZXNjZXNzYXJ5IHRvIGxpbmsgdG8gdGhlIG5ldyBJRCB0d2ljZS5cbiAgICAgIGNvbnN0IGxpbmtlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XG5cbiAgICAgIGZvciAoY29uc3Qge2tyc1RvTWlncmF0ZSwgY2NzVG9NaWdyYXRlLCBjb3Vyc2VDb2RlfSBvZiBpZHNUb01pZ3JhdGVQZXJDb3Vyc2UpIHtcbiAgICAgICAgaWYgKHRhc2tDb3Vyc2VDb2Rlcy5zaXplID09PSAwIHx8IHRhc2tDb3Vyc2VDb2Rlcy5oYXMoY291cnNlQ29kZSkpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHtpZH0gb2YgdGFzay5jZW50cmFsQ29udGVudCkge1xuICAgICAgICAgICAgY29uc3QgbWlncmF0aW9uSW5mbyA9IGNjc1RvTWlncmF0ZS5nZXQoaWQpO1xuICAgICAgICAgICAgaWYgKG1pZ3JhdGlvbkluZm8pIHtcbiAgICAgICAgICAgICAgbGV0IHtuZXdJZCwgbmV3VGV4dCwgb2xkVGV4dCwgaXNUeXBvRml4fSA9IG1pZ3JhdGlvbkluZm87XG4gICAgICAgICAgICAgIGxldCBvbGRJZCA9IGlkO1xuICAgICAgICAgICAgICBpZiAob2xkTVQuY2VudHJhbENvbnRlbnRbaWRdKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHBvaW50IG91dCB0aGUgdmVyeSBvbGQgaWQgYW5kIHRleHQgaW5zdGVhZCBvZiB0aGUgbmV2ZXItYWNrbm93bGVkZ2VkIG9uZS5cbiAgICAgICAgICAgICAgICBvbGRUZXh0ID0gb2xkTVQuY2VudHJhbENvbnRlbnRbaWRdLm9sZFRleHQ7XG4gICAgICAgICAgICAgICAgb2xkSWQgPSBvbGRNVC5jZW50cmFsQ29udGVudFtpZF0ub2xkSWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKG5ld0lkICYmIG9sZFRleHQgIT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2U6IElmIG9sZFRleHQgPT09IG5ld1RleHQsIHRoZW4gdGhpcyBpcyBhIHJlaW1wb3J0IG5ldyBYTUwgdGhhdCByZXZlcnRzIGJhY2sgdG8gb3JpZ2luIHRleHQuIERvbid0IHJlcXVpcmUgYWNrbm93bGVkZ2VtZW50IGZyb20gdGVhY2hlciFcbiAgICAgICAgICAgICAgICBpZiAoIWlzVHlwb0ZpeCkge1xuICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXNuJ3QganVzdCBhIHR5cG8gZml4IChjaGFuZ2VzIGluIHN0b3Agd29yZHMsIGNhc2luZyBvciBzcGVjaWFsIGNoYXJhY3RlcnMpXG4gICAgICAgICAgICAgICAgICB0YXNrLm1pZ3JhdGVkVGV4dHMuY2VudHJhbENvbnRlbnRbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKCFuZXdJZCB8fCAhbGlua2VkSWRzLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICAgICAgICBtdXRhdGlvbnMucHVzaChiciA9PiB7XG4gICAgICAgICAgICAgICAgICBici51bmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBpZCk7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBuZXdJZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2goYDxzdHJpa2U+JHtvbGRUZXh0fTwvc3RyaWtlPmApO1xuICAgICAgICAgICAgICAgIGlmIChuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XG4gICAgICAgICAgICAgICAgICBsaW5rZWRJZHMuYWRkKG5ld0lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChjb25zdCB7aWR9IG9mIHRhc2sua25vd2xlZGdlUmVxdWlyZW1lbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBtaWdyYXRpb25JbmZvID0ga3JzVG9NaWdyYXRlLmdldChpZCk7XG4gICAgICAgICAgICBpZiAobWlncmF0aW9uSW5mbykge1xuICAgICAgICAgICAgICBsZXQge25ld0lkLCBuZXdUZXh0LCBvbGRUZXh0LCBpc1R5cG9GaXh9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICAgICAgbGV0IG9sZElkID0gaWQ7XG4gICAgICAgICAgICAgIGlmIChvbGRNVC5rbm93bGVkZ2VSZXF1aXJlbWVudHNbaWRdKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHBvaW50IG91dCB0aGUgdmVyeSBvbGQgaWQgYW5kIHRleHQgaW5zdGVhZCBvZiB0aGUgbmV2ZXItYWNrbm93bGVkZ2VkIG9uZS5cbiAgICAgICAgICAgICAgICBvbGRUZXh0ID0gb2xkTVQua25vd2xlZGdlUmVxdWlyZW1lbnRzW2lkXS5vbGRUZXh0O1xuICAgICAgICAgICAgICAgIG9sZElkID0gb2xkTVQua25vd2xlZGdlUmVxdWlyZW1lbnRzW2lkXS5vbGRJZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAobmV3SWQgJiYgb2xkVGV4dCAhPT0gbmV3VGV4dCkge1xuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxuICAgICAgICAgICAgICAgIGlmICghaXNUeXBvRml4KSB7XG4gICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIHdhc24ndCBqdXN0IGEgdHlwbyBmaXggKGNoYW5nZXMgaW4gc3RvcCB3b3JkcywgY2FzaW5nIG9yIHNwZWNpYWwgY2hhcmFjdGVycylcbiAgICAgICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5rbm93bGVkZ2VSZXF1aXJlbWVudHNbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIW5ld0lkIHx8ICFsaW5rZWRJZHMuaGFzKG5ld0lkKSkge1xuICAgICAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKGJyID0+IHtcbiAgICAgICAgICAgICAgICAgIGJyLnVubGluazIoXCJ0YXNrc1wiLCB0YXNrLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBpZCk7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgbmV3SWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNoYW5nZURlc2NyaXB0aW9ucy5wdXNoKGA8c3RyaWtlPiR7b2xkVGV4dH08L3N0cmlrZT5gKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgIGNoYW5nZURlc2NyaXB0aW9ucy5wdXNoKG5ld1RleHQpO1xuICAgICAgICAgICAgICAgICAgbGlua2VkSWRzLmFkZChuZXdJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIGNoYW5nZTogYE1pZ3JlcmFkIFVwcGdpZnRgLFxuICAgICAgICBjb250ZW50OiBgPGg0PiR7dGFzay5uYW1lfSAke3Rhc2suc2Nob29sID8gYCgke3Rhc2suc2Nob29sfSkgYCA6ICcoc2tvbGEgZWogYW5naXZlbiknfTwvaDQ+XG4gICAgICAgICAgPHA+S3Vyc2tvZDogJHtbLi4udGFza0NvdXJzZUNvZGVzXS5qb2luKCcsJyl9PC9wPlxuICAgICAgICAgICR7Y2hhbmdlRGVzY3JpcHRpb25zLm1hcCh0eHQgPT4gYDxwPiR7dHh0fTwvcD5gKS5qb2luKCcnKX1gLFxuICAgICAgICBtdXRhdGlvbnM6IGJyID0+IHtcbiAgICAgICAgICBici5wdXQoXCJ0YXNrc1wiLCB0YXNrKTtcbiAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChtID0+IG0oYnIpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gVEhFIFJFU1VMVCBXSUxMIEJFOlxuICAvLyAgRnVuY3Rpb24gcG9wdWxhdGVzIGEgY29tcGxldGUgc2V0IG9mIENoYW5nZXMgdG8gZGlzcGxheSB0byB1c2VyLlxuICAvLyAgSWYgdXNlciBjbGlja3MgXCJpbXBvcnRcIiwgdGhlc2UgY2hhbmdlcyB3aWxsIGJlIHBlcmZvcm1lZC5cblxuICBcbiAgLy8gTmV4dCB0aGluZyB3aWxsIGJlIHRvIG1ha2UgdGhpcyB2aXNpYmxlIGluIEdVSTpcbiAgLy8gIFNob3cgT3BlbkNsb3NlQm94IHdpdGggd2FybmluZyBiZWZvcmUgXCJJbmzDpG1uaW5nc3VwcGdpZnRcIiBpbiBjYXNlIHRoZXJlIGFyZSBtaWdyYXRpb25UYXNrcy5cbiAgLy8gIExpc3Qga25vd2xlZGdlIHJlcXVpcmVtZW50cyBBLCBLUiBDLCBLUiBFLCBjZW50cmFsIGNvbnRlbnRzIGFuZCBhYmlsaXRpZXMgcmVzcGVjdGl2ZWx5IGluIHRvdGFsbHkgbWF4IDUgdGFibGVzLlxuICAvLyAgU2FtZSBHVUkgYXMga25vd2xlZGdlUmVxdWlyZW1lbnQgbWF0cml4IChncmVlbiBoZWFkZXIpIHBlciB0YWJsZS5cbiAgLy8gIEhlYWRlcnM6IFwiVXJzcHJ1bmdsaWcgZm9ybXVsZXJpbmdcIiwgXCJTa29sdmVya2V0cyBueWEgZm9ybXVsZXJpbmdcIiwgXCJUw6Rja2VyIHVwcGdpZnRlbiBkZW4gbnlhIGZvcm11bGVyaW5nZW4/XCJcbiAgLy8gIEZvciBlYWNoIHJvdywgc2hvdyBzdHJpa2UgdGV4dCArIG5ldyB0ZXh0IHdpdGggZ3JlZW4gYmFja2dyb3VuZC4gVGhlbiBJbXBvcnQgRGF0ZS4gVGhlbiBcIkphIC8gTmVqXCIuXG4gIC8vICBUcnlja2VyIG1hbiBKQSBlbGxlciBuZWogc8OlIHRhcyByYWRlbiBib3J0LlxuICAvLyAgVHJ5Y2tlciBtYW4gTmVqIHPDpSB0YXMgw6R2ZW4ga29wcGxpbmdlbiBib3J0IG9jaCBrdXJzZXIgc29tIGFudsOkbmRlciB1cHBnaWZ0ZW4ga2FuIHDDpXZlcmthcy5cbiAgLy9cbiAgLy8gTsOkc3RhIHNhayBhdHQgZ8O2cmE6IFBpbm5hLyB2aXNhIGJlcsO2cmRhIHVwcGdpZnRlciBtZWQgbnkgZsOkcmcgZWxsZXIgaWtvbi5cbiAgLy8gT2Nrc8OlLCBow7Znc3QgdXBwIHDDpSBrdXJzLXNpZGFuIChrdXJzYnlnZyk6IFZpc2Egc2FtbWEgdmFybmluZ3N0cmlhbmdlbCBPcGVuQ2xvc2VCb3ggb2NoIGxpc3RhXG4gIC8vIMOkbmRyYWRlIGZvcm11bGVyaW5nYXIgKyBiZXLDtnJkYSB1cHBnaWZ0ZXIuIE9tIG1hbiBpbnRlIMOkciByZWRpZ2VyaW5nc2JlaMO2cmlnIGF2IGVuIHVwcGdpZnQgYsO2clxuICAvLyBtYW4ga29udGFrdGEgdXBwZ2lmdGVucyDDpGdhcmUgZsO2ciBhdHQgZ3JhbnNrYSBtaWdyZXJpbmdlbi5cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGlkOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgc3ViamVjdDogU3ViamVjdFxufVxuXG5leHBvcnQgY2xhc3MgU2hvd1N1YmplY3RJbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtzdWJqZWN0OiBudWxsfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgY29uc3Qgc3ViamVjdCA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmdldDxTdWJqZWN0Pignc3ViamVjdHMnLCB0aGlzLnByb3BzLmlkLCB7IGluY2x1ZGU6ICdjb3Vyc2VUZW1wbGF0ZXMnIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzdWJqZWN0IH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICghdGhpcy5zdGF0ZS5zdWJqZWN0KSByZXR1cm4gPHA+PFNwaW5uZXIgLz48L3A+O1xuICAgIGNvbnN0IHsgbmFtZSwgY29kZSwgY291cnNlVGVtcGxhdGVzLCBzY2hvb2xUeXBlIH0gPSB0aGlzLnN0YXRlLnN1YmplY3Q7XG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICB7c2Nob29sVHlwZSA9PT0gJ3ByaW1hcnknID8gPD5cbiAgICAgICAgPGgyPkdydW5kc2tvbGXDpG1uZXQge25hbWV9ICh7Y29kZX0pPC9oMj5cbiAgICAgICAgPHVsIGNsYXNzTmFtZT1cImVudGl0eS1saXN0XCI+XG4gICAgICAgICAge2NvdXJzZVRlbXBsYXRlcy5tYXAoKHtpZCwgY29kZSwgcHVibGlzaGFibGUsIHBvaW50cywgc2Nob29sR3JhZGV9KSA9PlxuICAgICAgICAgIDxsaSBrZXk9e2lkfSBjbGFzc05hbWU9XCJjb21wbGV0ZVwiPlxuICAgICAgICAgICAge25hbWV9IGbDtnIgw6Vyc2t1cnMge3NjaG9vbEdyYWRlfVxuICAgICAgICAgIDwvbGk+KX1cbiAgICAgICAgPC91bD5cbiAgICAgIDwvPiAgOiA8PlxuICAgICAgICA8aDI+S3Vyc2VyIGbDtnIgw6RtbmV0IHtuYW1lfSAoe2NvZGV9KTwvaDI+XG4gICAgICAgIDx1bCBjbGFzc05hbWU9XCJlbnRpdHktbGlzdFwiPlxuICAgICAgICAgIHtjb3Vyc2VUZW1wbGF0ZXMubWFwKCh7aWQsIG5hbWUsIGNvZGUsIHB1Ymxpc2hhYmxlLCBwb2ludHN9KSA9PlxuICAgICAgICAgIDxsaSBrZXk9e2lkfSBjbGFzc05hbWU9XCJjb21wbGV0ZVwiPlxuICAgICAgICAgICAge25hbWV9IC0ge3BvaW50c31wXG4gICAgICAgICAgPC9saT4pfVxuICAgICAgICA8L3VsPlxuICAgICAgPC8+fVxuICAgIDwvZGl2PjtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcbmltcG9ydCB7IFNob3dTdWJqZWN0SW5uZXIgfSBmcm9tICcuL3Nob3ctc3ViamVjdC1pbm5lcic7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGlkOiBzdHJpbmdcbiAgZmVlZGJhY2tVcmw6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBzdWJqZWN0OiBTdWJqZWN0XG59XG5cbmV4cG9ydCBjbGFzcyBTaG93U3ViamVjdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtzdWJqZWN0OiBudWxsfTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgY29uc3Qgc3ViamVjdCA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmdldDxTdWJqZWN0Pignc3ViamVjdHMnLCB0aGlzLnByb3BzLmlkLCB7IGluY2x1ZGU6ICdjb3Vyc2VUZW1wbGF0ZXMnIH0pO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBzdWJqZWN0IH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICghdGhpcy5zdGF0ZS5zdWJqZWN0KSByZXR1cm4gPHA+PFNwaW5uZXIgLz48L3A+O1xuICAgIGNvbnN0IHsgbmFtZSwgY29kZSwgY291cnNlVGVtcGxhdGVzLCBzY2hvb2xUeXBlIH0gPSB0aGlzLnN0YXRlLnN1YmplY3Q7XG4gICAgcmV0dXJuIDxkaXY+PENvdXJzZUJhbm5lclxuICAgICAgdGl0bGU9e25hbWV9XG4gICAgICBhY3RpdmVQYWdlPVwic3ViamVjdHNcIlxuICAgICAgcm91dGVzPXt7ZmVlZGJhY2s6IHRoaXMucHJvcHMuZmVlZGJhY2tVcmx9fVxuICAgICAgIC8+XG4gICAgICAgPFNob3dTdWJqZWN0SW5uZXIgaWQ9e3RoaXMucHJvcHMuaWR9IC8+XG4gICAgPC9kaXY+O1xuICB9XG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIFNrb2x2ZXJrZXRTdWJqZWN0IHtcbiAgbmFtZTogc3RyaW5nO1xuICBzY2hvb2xUeXBlOiAnZ3ltbmFzaXVtJyB8ICdwcmltYXJ5JztcbiAgY29kZTogc3RyaW5nO1xuICBwdXJwb3NlOiBzdHJpbmc7XG4gIGNvdXJzZXM6IFNrb2x2ZXJrZXRDb3Vyc2VbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTa29sdmVya2V0Q291cnNlIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY29kZTogc3RyaW5nO1xuICAgIGNlbnRyYWxDb250ZW50OiBzdHJpbmc7XG4gICAgeWVhcj86ICcxLTMnIHwgJzQtNicgfCAnNy05JztcbiAgICAvL2NlbnRyYWxDb250ZW50OiBBcnJheTx7eWVhcj86IHN0cmluZywgdGV4dDogc3RyaW5nfT47XG4gICAgcG9pbnRzOiBudW1iZXI7XG4gICAga25vd25sZWRnZVJlcXVpcmVtZW50czogQXJyYXk8e2dyYWRlU3RlcDogc3RyaW5nLCB0ZXh0OiBzdHJpbmd9PjtcbiAgICAvL2tub3dubGVkZ2VSZXF1aXJlbWVudHM6IEFycmF5PHtncmFkZVN0ZXA6IHN0cmluZywgdGV4dDogc3RyaW5nLCB5ZWFyPzogbnVtYmVyfT47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVNrb2x2ZXJrZXRZZWFycyAoaW5ZZWFyOiBzdHJpbmcpIDogQXJyYXk8JzEtMycgfCAnNC02JyB8ICc3LTknPiB7XG4gIHN3aXRjaChpblllYXIudHJpbSgpKSB7XG4gICAgY2FzZSAnMyc6XG4gICAgY2FzZSAnMS0zJzpcbiAgICAgIHJldHVybiBbJzEtMyddO1xuICAgIGNhc2UgJzYnOlxuICAgIGNhc2UgJzQtNic6XG4gICAgICByZXR1cm4gWyc0LTYnXTtcbiAgICBjYXNlICc3LTknOlxuICAgIGNhc2UgJzknOlxuICAgICAgcmV0dXJuIFsnNy05J107XG4gICAgLy8gU3BlY2lhbHNcbiAgICBjYXNlICcxJzogcmV0dXJuIFtcIjEtM1wiXTsgLy8gRsO2cmVrb21tZXIgaSDDpG1uZW5hIFwiU3ZlbnNrYVwiIG9jaCBcIlN2ZW5za2Egc29tIGFuZHJhc3Byw6VrXCJcbiAgICBjYXNlICcxcyc6IHJldHVybiBbXCIxLTNcIl07IC8vIEbDtnJla29tbWVyIGkgw6RtbmVuYSBcIlN2ZW5za2FcIiBvY2ggXCJTdmVuc2thIHNvbSBhbmRyYXNwcsOla1wiXG4gICAgY2FzZSAnMS02JzogcmV0dXJuIFtcIjEtM1wiLCBcIjQtNlwiXTsgLy8gRsO2cmVrb21tZXIgaSDDpG1uZXQgXCJIZW0tIG9jaCBrb25zdW1lbnRrdW5za2FwXCJcbiAgICBjYXNlICc0LTknOiByZXR1cm4gW1wiNC02XCIsIFwiNy05XCJdOyAvLyBGw7ZyZWtvbW1lciBpIMOkbW5ldCBcIk1vZGVybmEgc3Byw6VrXCJcbiAgICBkZWZhdWx0OiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgeWVhciBpbiBTa29sdmVya2V0IFhNTDogJHtpblllYXJ9LiBFeHBlY3RpbmcgMyw2LDkgb3IgMS0zLCA0LTYsIDctOWApO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTCwgc2hvd0luZm8sIGNvbXBhcmVQcm9wLCBhcnJheVRvTG9va3VwLCBmbGF0dGVuIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgeyBTa29sdmVya2V0U3ViamVjdCwgcGFyc2VTa29sdmVya2V0WWVhcnMsIFNrb2x2ZXJrZXRDb3Vyc2UgfSBmcm9tICcuL3Nrb2x2ZXJrZXQtc3ViamVjdCc7XG5pbXBvcnQgeyBVcGxvYWRlZFN1YmplY3QgfSBmcm9tICcuL3VwbG9hZGVkLXN1YmplY3QnO1xuZXhwb3J0IHsgU2hvd1N1YmplY3QgfSBmcm9tICcuL3Nob3ctc3ViamVjdCc7XG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyByZWFkQmxvYkFzVGV4dCwgYWxsb3dDb3B5IH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGlua1ByZWZpeDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBneW1uYXNpdW1TdWJqZWN0czogU3ViamVjdFtdO1xuICBwcmltYXJ5U2Nob29sU3ViamVjdHM6IFN1YmplY3RbXTtcbiAgaXNMaXN0aW5nU3ViamVjdHM6IGJvb2xlYW47XG4gIHVwbG9hZGVkU3ViamVjdDogU2tvbHZlcmtldFN1YmplY3QgfCBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgU3ViamVjdHNJbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGlzTGlzdGluZ1N1YmplY3RzOiB0cnVlLFxuICAgICAgZ3ltbmFzaXVtU3ViamVjdHM6IFtdLFxuICAgICAgcHJpbWFyeVNjaG9vbFN1YmplY3RzOiBbXSxcbiAgICAgIHVwbG9hZGVkU3ViamVjdDogbnVsbFxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIGNvbnN0IHN1YmplY3RzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTdWJqZWN0PihcInN1YmplY3RzXCIpO1xuICAgIHN1YmplY3RzLnNvcnQoY29tcGFyZVByb3AoXCJuYW1lXCIpKTtcbiAgICBjb25zdCBneW1uYXNpdW1TdWJqZWN0cyA9IHN1YmplY3RzLmZpbHRlcihzID0+IHMuc2Nob29sVHlwZSAhPT0gJ3ByaW1hcnknKTtcbiAgICBjb25zdCBwcmltYXJ5U2Nob29sU3ViamVjdHMgPSBzdWJqZWN0cy5maWx0ZXIocyA9PiBzLnNjaG9vbFR5cGUgPT09ICdwcmltYXJ5Jyk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGd5bW5hc2l1bVN1YmplY3RzLCBwcmltYXJ5U2Nob29sU3ViamVjdHMsIGlzTGlzdGluZ1N1YmplY3RzOiBmYWxzZSB9KTtcbiAgfVxuXG4gIGFzeW5jIGhhbmRsZUZpbGVTZWxlY3QoZXY6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGZpbGVzID0gZXYuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICAgIGNvbnN0IHhtbCA9IGF3YWl0IHJlYWRCbG9iQXNUZXh0KGZpbGVzWzBdKTtcbiAgICBjb25zdCBkb2MgPSAkKCQucGFyc2VYTUwoeG1sKSk7XG4gICAgY29uc3QgdHlwZU9mU2Nob29saW5nID1cbiAgICAgIGRvYy5maW5kKFwic3ViamVjdD5vcmlnaW5hdG9yVHlwZU9mU2Nob29saW5nXCIpLnRleHQoKS50cmltKCkgfHxcbiAgICAgIGRvYy5maW5kKFwic3ViamVjdD50eXBlT2ZTY2hvb2xpbmdcIikudGV4dCgpLnRyaW0oKTtcbiAgICBjb25zdCBzY2hvb2xUeXBlOiAncHJpbWFyeScgfCAnZ3ltbmFzaXVtJyA9IHR5cGVPZlNjaG9vbGluZyA9PT0gXCJDT01QVUxTT1JZX1NDSE9PTFwiID9cbiAgICAgICdwcmltYXJ5JyA6XG4gICAgICB0eXBlT2ZTY2hvb2xpbmcgPT09IFwiVVBQRVJfU0VDT05EQVJZX0VEVUNBVElPTlwiID9cbiAgICAgICAgJ2d5bW5hc2l1bScgOlxuICAgICAgICBudWxsO1xuXG4gICAgaWYgKHNjaG9vbFR5cGUgPT09ICdneW1uYXNpdW0nKSB7XG4gICAgICBjb25zdCBtb2RlbDogU2tvbHZlcmtldFN1YmplY3QgPSB7XG4gICAgICAgIG5hbWU6IGRvYy5maW5kKFwic3ViamVjdD5uYW1lXCIpLnRleHQoKS50cmltKCksXG4gICAgICAgIGNvZGU6IGRvYy5maW5kKFwic3ViamVjdD5jb2RlXCIpLnRleHQoKS50cmltKCksXG4gICAgICAgIHB1cnBvc2U6IGRvYy5maW5kKFwic3ViamVjdD5wdXJwb3NlXCIpLnRleHQoKS50cmltKCksXG4gICAgICAgIGNvdXJzZXM6IFtdLFxuICAgICAgICBzY2hvb2xUeXBlOiAnZ3ltbmFzaXVtJ1xuICAgICAgfTtcbiAgICAgIGNvbnN0IGNvdXJzZXMgPSBkb2MuZmluZChcInN1YmplY3Q+Y291cnNlc1wiKTtcbiAgICAgIGZvciAobGV0IGk9MDsgaTxjb3Vyc2VzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGNvdXJzZSA9ICQoY291cnNlc1tpXSk7XG4gICAgICAgIGNvbnN0IGtub3dubGVkZ2VSZXF1aXJlbWVudHMgPSBbXS5zbGljZS5jYWxsKGNvdXJzZS5maW5kKFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIpKVxuICAgICAgICAgIC5tYXAociA9PiAoe1xuICAgICAgICAgICAgZ3JhZGVTdGVwOiAkKHIpLmZpbmQoJ2dyYWRlU3RlcCcpLnRleHQoKS50cmltKCksXG4gICAgICAgICAgICB0ZXh0OiAkKHIpLmZpbmQoJ3RleHQnKS50ZXh0KCkudHJpbSgpXG4gICAgICAgICAgfSkpO1xuXG4gICAgICAgIG1vZGVsLmNvdXJzZXMucHVzaCh7XG4gICAgICAgICAgbmFtZTogY291cnNlLmZpbmQoXCJuYW1lXCIpLnRleHQoKS50cmltKCksXG4gICAgICAgICAgY29kZTogY291cnNlLmZpbmQoXCJjb2RlXCIpLnRleHQoKS50cmltKCksXG4gICAgICAgICAgY2VudHJhbENvbnRlbnQ6IGNvdXJzZS5maW5kKFwiY2VudHJhbENvbnRlbnRcIikudGV4dCgpLnRyaW0oKSxcbiAgICAgICAgICBwb2ludHM6IHBhcnNlSW50KGNvdXJzZS5maW5kKFwicG9pbnRcIikudGV4dCgpLnRyaW0oKSksXG4gICAgICAgICAga25vd25sZWRnZVJlcXVpcmVtZW50cyxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLnNldFN0YXRlKHt1cGxvYWRlZFN1YmplY3Q6IG1vZGVsfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNlbnRyYWxDb250ZW50cyA9IGZsYXR0ZW4oQXJyYXkuZnJvbShkb2MuZmluZChcInN1YmplY3Q+Y2VudHJhbENvbnRlbnRcIikpXG4gICAgICAgIC5tYXAoY2MgPT4ge1xuICAgICAgICAgIGNvbnN0IHllYXIgPSAkKGNjKS5maW5kKCd5ZWFyJykudGV4dCgpLnRyaW0oKSBhcyBzdHJpbmc7XG4gICAgICAgICAgY29uc3QgdHlwZU9mQ2VudHJhbENvbnRlbnQgPSAkKGNjKS5maW5kKCd0eXBlT2ZDZW50cmFsQ29udGVudCcpLnRleHQoKS50cmltKCkgYXMgc3RyaW5nO1xuXG4gICAgICAgICAgaWYgKHR5cGVPZkNlbnRyYWxDb250ZW50KSB7XG4gICAgICAgICAgICAvLyBEbyBub3QgeWV0IHN1cHBvcnQgbXVsdGlwbGUgdHlwZXMgb2YgY2VudHJhbCBjb250ZW50LlxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yIChMYMOEbW5ldCBpbm5laMOlbGxlciBmbGVyYSBwYXJhbGxlbGxhIHR5cGVyIGF2IGNlbnRyYWx0IGlubmVow6VsbC4gRGV0dGEgc3TDtmRzIMOkbm51IGludGUuYCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3Qgc3RhZGl1bXMgPSBwYXJzZVNrb2x2ZXJrZXRZZWFycyh5ZWFyKTtcbiAgICAgICAgICBjb25zdCBjZW50cmFsQ29udGVudHNGb3JFYWNoU3RhZGl1bSA9IHN0YWRpdW1zLm1hcCggc3RhZGl1bSA9PiAoe1xuICAgICAgICAgICAgeWVhcjogc3RhZGl1bSxcbiAgICAgICAgICAgIHRleHQ6ICQoY2MpLmZpbmQoJ3RleHQnKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZ1xuICAgICAgICAgIH0pKTtcbiAgICAgICAgICByZXR1cm4gY2VudHJhbENvbnRlbnRzRm9yRWFjaFN0YWRpdW07XG4gICAgICAgIH0pKTtcblxuICAgICAgY29uc3Qga25vd2xlZGdlUmVxdWlyZW1lbnRzID0gZmxhdHRlbihBcnJheS5mcm9tKGRvYy5maW5kKFwic3ViamVjdD5rbm93bGVkZ2VSZXF1aXJlbWVudFwiKSlcbiAgICAgICAgLm1hcChrciA9PiB7XG4gICAgICAgICAgY29uc3QgeWVhciA9ICQoa3IpLmZpbmQoJ3llYXInKS50ZXh0KCkudHJpbSgpO1xuXG4gICAgICAgICAgY29uc3QgdHlwZU9mUmVxdWlyZW1lbnQgPSAkKGtyKS5maW5kKCd0eXBlT2ZSZXF1aXJlbWVudCcpLnRleHQoKS50cmltKCkgYXMgc3RyaW5nO1xuICAgICAgICAgIGlmICh0eXBlT2ZSZXF1aXJlbWVudCkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHlldCBzdXBwb3J0IG11bHRpcGxlIHR5cGVzIG9mIGtub3dsZWRnZSByZXF1aXJlbWVudC5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciAoTGDDhG1uZXQgaW5uZWjDpWxsZXIgZmxlcmEgcGFyYWxsZWxsYSB0eXBlciBhdiBrdW5za2Fwc2tyYXYuIERldHRhIHN0w7ZkcyDDpG5udSBpbnRlLmApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiBwYXJzZVNrb2x2ZXJrZXRZZWFycyh5ZWFyKS5tYXAoc3RhZGl1bSA9PiAoe1xuICAgICAgICAgICAgeWVhcjogc3RhZGl1bSxcbiAgICAgICAgICAgIHRleHQ6ICQoa3IpLmZpbmQoJ3RleHQnKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICAgICAgZ3JhZGVTdGVwOiAkKGtyKS5maW5kKCdncmFkZVN0ZXAnKS50ZXh0KCkudHJpbSgpXG4gICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNlbnRyYWxDb250ZW50c0J5U3RhZGl1bSA9IGFycmF5VG9Mb29rdXAoY2VudHJhbENvbnRlbnRzLCBjYyA9PiBjYy55ZWFyKTtcbiAgICAgIGNvbnN0IGtub3dsZWRnZVJlcXVpcmVtZW50c0J5U3RhZGl1bSA9IGFycmF5VG9Mb29rdXAoa25vd2xlZGdlUmVxdWlyZW1lbnRzLCBrciA9PiBrci55ZWFyKTtcblxuICAgICAgY29uc3Qgc3ViamVjdE5hbWUgPSBkb2MuZmluZChcInN1YmplY3Q+bmFtZVwiKS50ZXh0KCkudHJpbSgpO1xuICAgICAgY29uc3Qgc3ViamVjdENvZGUgPSBkb2MuZmluZChcInN1YmplY3Q+Y29kZVwiKS50ZXh0KCkudHJpbSgpO1xuICAgICAgY29uc3Qgc3ViamVjdFB1cnBvc2UgPSBkb2MuZmluZChcInN1YmplY3Q+cHVycG9zZVwiKS50ZXh0KCkudHJpbSgpO1xuICAgICAgLypcblxuICAgICAgICBQcm9ibGVtYXRpYyB3aGVuIHRoZSBmb2xsb3dpbmcgdGFncyBhcmUgcHJlc2VudDpcblxuICAgICAgICA8dHlwZU9mUmVxdWlyZW1lbnQ+XG4gICAgICAgICAgV0lUSElOX1NUVURFTlRfQ0hPSUNFX0NISU5FU0VcbiAgICAgICAgPC90eXBlT2ZSZXF1aXJlbWVudD5cbiAgICAgICAgPHR5cGVPZkNlbnRyYWxDb250ZW50PlxuICAgICAgICAgIFdJVEhJTl9MQU5HVUFHRV9DSE9JQ0VcbiAgICAgICAgPC90eXBlT2ZDZW50cmFsQ29udGVudD5cbiAgICAgICovXG5cbiAgICAgIGNvbnN0IGNvdXJzZXNCeVN0YWRpdW06IFNrb2x2ZXJrZXRDb3Vyc2VbXSA9IChbJzEtMycsJzQtNicsJzctOSddIGFzIEFycmF5PCcxLTMnIHwgJzQtNicgfCAnNy05Jz4pXG4gICAgICAgIC5tYXAoc3RhZGl1bSA9PiAoe1xuICAgICAgICAgIG5hbWU6IHN1YmplY3ROYW1lKycgJytzdGFkaXVtLFxuICAgICAgICAgIGNvZGU6IHN1YmplY3RDb2RlKyd8JytzdGFkaXVtLFxuICAgICAgICAgIHBvaW50czogMCxcbiAgICAgICAgICB5ZWFyOiBzdGFkaXVtLFxuICAgICAgICAgIGNlbnRyYWxDb250ZW50OiAoY2VudHJhbENvbnRlbnRzQnlTdGFkaXVtW3N0YWRpdW1dfHxbXSkubWFwKGNjID0+IGNjLnRleHQpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgIGtub3dubGVkZ2VSZXF1aXJlbWVudHM6IChrbm93bGVkZ2VSZXF1aXJlbWVudHNCeVN0YWRpdW1bc3RhZGl1bV18fFtdKS5tYXAoKHtncmFkZVN0ZXAsIHRleHR9KSA9PiAoe2dyYWRlU3RlcCwgdGV4dH0pKVxuICAgICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IG1vZGVsOiBTa29sdmVya2V0U3ViamVjdCA9IHtcbiAgICAgICAgbmFtZTogc3ViamVjdE5hbWUsXG4gICAgICAgIGNvZGU6IHN1YmplY3RDb2RlLFxuICAgICAgICBwdXJwb3NlOiBzdWJqZWN0UHVycG9zZSxcbiAgICAgICAgc2Nob29sVHlwZTogJ3ByaW1hcnknLFxuICAgICAgICBjb3Vyc2VzOiBjb3Vyc2VzQnlTdGFkaXVtXG4gICAgICB9O1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBsb2FkZWRTdWJqZWN0OiBtb2RlbH0pO1xuICAgIH1cblxuICAgIFxuICB9XG5cbiAgb25JbXBvcnRTdWNjZXNzKHN1YmplY3QpIHtcbiAgICAgc2hvd0luZm8oTGBJbXBvcnRlbiBhdiAke3N1YmplY3R9IGx5Y2thZGVzYCk7XG4gICAgIHRoaXMuc2V0U3RhdGUoe3VwbG9hZGVkU3ViamVjdDogbnVsbH0pO1xuICAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7bGlua1ByZWZpeH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAge3RoaXMuc3RhdGUudXBsb2FkZWRTdWJqZWN0ID9cbiAgICAgIDxVcGxvYWRlZFN1YmplY3RcbiAgICAgICAgb25DYW5jZWw9eygpPT50aGlzLnNldFN0YXRlKHt1cGxvYWRlZFN1YmplY3Q6IG51bGx9KX1cbiAgICAgICAgb25JbXBvcnRTdWNjZXNzPXtzdWJqZWN0ID0+IHRoaXMub25JbXBvcnRTdWNjZXNzKHN1YmplY3QpfVxuICAgICAgICBzdWJqZWN0PXt0aGlzLnN0YXRlLnVwbG9hZGVkU3ViamVjdH0gLz5cbiAgICA6IHRoaXMuc3RhdGUuaXNMaXN0aW5nU3ViamVjdHMgP1xuICAgICAgPGRpdj48cD48U3Bpbm5lci8+VmFyIGdvZCB2w6RudGEgbWVkYW4gw6RtbmVuIGjDpG10YXMuLi48L3A+PC9kaXY+IDpcbiAgICAgIDxkaXY+XG4gICAgICAgIDxoMj57TGBHeW1uYXNpZcOkbW5lbmB9PC9oMj5cbiAgICAgICAgPHVsPnt0aGlzLnN0YXRlLmd5bW5hc2l1bVN1YmplY3RzLm1hcChzID0+XG4gICAgICAgICAgPGxpIGtleT17cy5pZH0gY2xhc3NOYW1lPXtzLnB1Ymxpc2hhYmxlID8gXCJjb21wbGV0ZVwiIDogXCJpbmNvbXBsZXRlXCJ9PlxuICAgICAgICAgICAgPExpbmsgdG89e2xpbmtQcmVmaXggKyBzLmlkfT57cy5uYW1lfTwvTGluaz5cbiAgICAgICAgICA8L2xpPil9XG4gICAgICAgIDwvdWw+XG4gICAgICAgIDxoMj57TGBHcnVuZHNrb2xlw6RtbmVuYH08L2gyPlxuICAgICAgICA8dWw+e3RoaXMuc3RhdGUucHJpbWFyeVNjaG9vbFN1YmplY3RzLm1hcChzID0+XG4gICAgICAgICAgPGxpIGtleT17cy5pZH0gY2xhc3NOYW1lPXtzLnB1Ymxpc2hhYmxlID8gXCJjb21wbGV0ZVwiIDogXCJpbmNvbXBsZXRlXCJ9PlxuICAgICAgICAgICAgPExpbmsgdG89e2xpbmtQcmVmaXggKyBzLmlkfT57cy5uYW1lfTwvTGluaz5cbiAgICAgICAgICA8L2xpPil9XG4gICAgICAgIDwvdWw+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHJvcC16b25lXCIgb25EcmFnT3Zlcj17YWxsb3dDb3B5fSBvbkRyb3A9e2V2PT50aGlzLmhhbmRsZUZpbGVTZWxlY3QoZXYpfT5cbiAgICAgICAgICBEcm9wcGEgU3ViamVjdC1maWwgaMOkciBmcsOlbiBza29sdmVya2V0IChIw6RtdGFzIGZyw6VuIDxhIGhyZWY9XCJodHRwOi8vb3BlbmRhdGEuc2tvbHZlcmtldC5zZVwiIHRhcmdldD1cInNrb2x2ZXJrZXRcIj5vcGVuZGF0YS5za29sdmVya2V0LnNlPC9hPilcbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICB9PC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBTa29sdmVya2V0U3ViamVjdCwgU2tvbHZlcmtldENvdXJzZSB9IGZyb20gJy4vc2tvbHZlcmtldC1zdWJqZWN0JztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBTdWJqZWN0LCBDb3Vyc2UsIEFiaWxpdHksIEtub3dsZWRnZVJlcXVpcmVtZW50LCBDZW50cmFsQ29udGVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IE11dGF0aW9uUmVxdWVzdCwgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBDaGFuZ2UgfSBmcm9tICcuL2RpZmYvY2hhbmdlJztcbmltcG9ydCB7IFN1YmplY3RUb0ltcG9ydCwgQ291cnNlVG9JbXBvcnQgfSBmcm9tICcuL3N1YmplY3QtdG8taW1wb3J0JztcbmltcG9ydCB7IGRpZmZYbWxXaXRoRGF0YWJhc2UgfSBmcm9tICcuL2RpZmYvZGlmZi14bWwtd2l0aC1kYXRhYmFzZSc7XG5pbXBvcnQgeyBsb2FkQ291cnNlIH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBvbkNhbmNlbDogKCkgPT4gdm9pZDtcbiAgb25JbXBvcnRTdWNjZXNzOiAoc3ViamVjdDogc3RyaW5nKSA9PiB2b2lkO1xuICBzdWJqZWN0OiBTa29sdmVya2V0U3ViamVjdDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgc2hvd0Z1bGxUZXh0OiBib29sZWFuO1xuICBjaGFuZ2VzOiBDaGFuZ2VbXTtcbiAgc3ViamVjdFRvSW1wb3J0PzogU3ViamVjdFRvSW1wb3J0O1xuICBpc1dvcmtpbmc6IGJvb2xlYW47XG4gIGlzSW1wb3J0aW5nOiBib29sZWFuO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFVwbG9hZGVkU3ViamVjdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgcHVycG9zZUVsZW06IEhUTUxFbGVtZW50O1xuICBjb3Vyc2VzRWxlbXM6IHsgW2NvdXJzZUNvZGU6IHN0cmluZ106IHsgY291cnNlOiBTa29sdmVya2V0Q291cnNlLCBlbGVtOiBIVE1MRWxlbWVudCB9IH07XG4gIGNlbnRyYWxDb250ZW50RWxlbXM6IEhUTUxFbGVtZW50W107XG4gIGtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXM6IEhUTUxFbGVtZW50W107XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuY291cnNlc0VsZW1zID0ge307XG4gICAgdGhpcy5jZW50cmFsQ29udGVudEVsZW1zID0gW107XG4gICAgdGhpcy5rbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zID0gW107XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNob3dGdWxsVGV4dDogZmFsc2UsXG4gICAgICBjaGFuZ2VzOiBbXSxcbiAgICAgIGlzV29ya2luZzogdHJ1ZSxcbiAgICAgIGlzSW1wb3J0aW5nOiBmYWxzZVxuICAgIH07XG4gIH1cblxuICBhc3luYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLmFkZENsYXNzZXNGb3JDaGVycnlQaWNrZWRFbGVtZW50cygpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7Y2hhbmdlcywgc3ViamVjdFRvSW1wb3J0fSA9IGF3YWl0IHRoaXMuZGlmZldpdGhFeGlzdGluZygpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNoYW5nZXMsIHN1YmplY3RUb0ltcG9ydCB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGVycm9yOiAnJytlcnJvciB9KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzV29ya2luZzogZmFsc2UgfSk7XG4gICAgfVxuICB9XG5cbiAgYWRkQ2xhc3Nlc0ZvckNoZXJyeVBpY2tlZEVsZW1lbnRzKCkge1xuICAgIGNvbnN0IGFiaWxpdGllcyA9ICQodGhpcy5wdXJwb3NlRWxlbSkuZmluZCgnbGknKS5maXJzdCgpLnBhcmVudCgpLmNoaWxkcmVuKCdsaScpO1xuICAgIGFiaWxpdGllcy5hZGRDbGFzcygnYWJpbGl0eScpO1xuICAgIGNvbnN0IGNlbnRyYWxDb250ZW50cyA9ICQodGhpcy5jZW50cmFsQ29udGVudEVsZW1zKS5maW5kKCdsaScpO1xuICAgIGNlbnRyYWxDb250ZW50cy5hZGRDbGFzcygnY2VudHJhbC1jb250ZW50Jyk7XG4gICAgY29uc3Qga25vd2xlZGdlUmVxdWlyZW1lbnRzID0gJCh0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMpLmZpbmQoJ3AnKTtcbiAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHMuYWRkQ2xhc3MoJ2tub3dsZWRnZS1yZXF1aXJlbWVudCcpO1xuICAgIGNvbnN0IGFsbCA9ICQoW2FiaWxpdGllcywgY2VudHJhbENvbnRlbnRzLCBrbm93bGVkZ2VSZXF1aXJlbWVudHNdKTtcbiAgICBhbGwuYWRkQ2xhc3MoJ21hcmtlZC1hcmVhJyk7XG4gIH1cblxuICBjaGVycnlQaWNrRGF0YSgpOiBTdWJqZWN0VG9JbXBvcnQge1xuICAgIC8vXG4gICAgLy8gUmVhZHMgZWxlbWVudHMgKHRhZ2dlZCBieSBjbGFzc2VzIGluIGFkZENsYXNzZXNGb3JDaGVycnlQaWNrZWRFbGVtZW50cygpKSBhbmQgY29udmVydHMgdGhlaXIgaW5uZXIgSFRNTCB0byB0aGUgY29ycmVzcG9uZGluZ1xuICAgIC8vIG1vZGVsIFN1YmplY3RUb0ltcG9ydC4gTm90ZSB0aGF0IGlmIHdlIG5lZWQgdG8gYWRqdXN0IGhvdyB0byBwaWNrIHRoZSByaWdodCBMSSBvciBQIGVsZW1lbnRzLCB3ZVxuICAgIC8vIHdpbGwgb25seSBuZWVkIHRvIGNoYW5nZSB0aGUgY29kZSBpbiBhZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKSwgbm90IHRoaXMgY29kZS5cbiAgICAvL1xuICAgIGNvbnN0IHNrb2xTdWJqZWN0ID0gdGhpcy5wcm9wcy5zdWJqZWN0O1xuICAgIGNvbnN0IGFiaWxpdGllc0xpcyA9IEFycmF5LmZyb20oJCh0aGlzLnB1cnBvc2VFbGVtKS5maW5kKCdsaScpLmZpcnN0KCkucGFyZW50KCkuY2hpbGRyZW4oJ2xpJykpO1xuICAgIGNvbnN0IGFiaWxpdGllcyA9IGFiaWxpdGllc0xpcy5tYXAoKGEsIGkpID0+IGAke2kgKyAxfS4gJHskKGEpLmh0bWwoKX1gLnRyaW0oKSkuZmlsdGVyKGh0bWwgPT4gISFodG1sKTtcblxuICAgIGNvbnN0IHJlc3VsdDogU3ViamVjdFRvSW1wb3J0ID0ge1xuICAgICAgbmFtZTogc2tvbFN1YmplY3QubmFtZSxcbiAgICAgIGNvZGU6IHNrb2xTdWJqZWN0LmNvZGUsXG4gICAgICBzY2hvb2xUeXBlOiBza29sU3ViamVjdC5zY2hvb2xUeXBlLFxuICAgICAgYWJpbGl0aWVzLFxuICAgICAgY291cnNlczogT2JqZWN0LmtleXModGhpcy5jb3Vyc2VzRWxlbXMpXG4gICAgICAgIC5tYXAoY291cnNlQ29kZSA9PiB0aGlzLmNvdXJzZXNFbGVtc1tjb3Vyc2VDb2RlXSlcbiAgICAgICAgLm1hcDxDb3Vyc2VUb0ltcG9ydD4oKHsgY291cnNlLCBlbGVtIH0pID0+ICh7XG4gICAgICAgICAgbmFtZTogY291cnNlLm5hbWUsXG4gICAgICAgICAgeWVhcjogY291cnNlLnllYXIsXG4gICAgICAgICAgY29kZTogY291cnNlLmNvZGUsXG4gICAgICAgICAgcG9pbnRzOiBjb3Vyc2UucG9pbnRzLFxuICAgICAgICAgIGNlbnRyYWxDb250ZW50OiBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmNlbnRyYWwtY29udGVudCcpKS5tYXAoYyA9PiAoe1xuICAgICAgICAgICAgaHRtbDogJChjKS5odG1sKCkudHJpbSgpIGFzIHN0cmluZyxcbiAgICAgICAgICAgIGdyb3VwOiAkKGMpLnBhcmVudCgndWwnKS5wcmV2KCdoNCcpLnRleHQoKS50cmltKClcbiAgICAgICAgICB9KSkuZmlsdGVyKCh7aHRtbH0pID0+ICEhaHRtbCksXG4gICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOlxuICAgICAgICAgICAgQXJyYXkuZnJvbSgkKGVsZW0pLmZpbmQoJy5ncmFkZS1zdGVwLW5vbmUgLmtub3dsZWRnZS1yZXF1aXJlbWVudCcpKS5tYXAociA9PiAkKHIpLmh0bWwoKS50cmltKCkpXG4gICAgICAgICAgICAgIC5maWx0ZXIoaHRtbCA9PiAhIWh0bWwpXG4gICAgICAgICAgICAgIC5tYXAoaHRtbCA9PiAoe2dyYWRlU3RlcDogbnVsbCwgaHRtbCB9KSlcbiAgICAgICAgICAgICAgLmNvbmNhdChcbiAgICAgICAgICAgICAgICBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmdyYWRlLXN0ZXAtRSAua25vd2xlZGdlLXJlcXVpcmVtZW50JykpLm1hcChyID0+ICQocikuaHRtbCgpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaHRtbCA9PiAhIWh0bWwpXG4gICAgICAgICAgICAgICAgICAubWFwKGh0bWwgPT4gKHsgZ3JhZGVTdGVwOiBcIkVcIiwgaHRtbCB9KSlcbiAgICAgICAgICAgICAgICAgIC5jb25jYXQoXG4gICAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20oJChlbGVtKS5maW5kKCcuZ3JhZGUtc3RlcC1DIC5rbm93bGVkZ2UtcmVxdWlyZW1lbnQnKSkubWFwKHIgPT4gJChyKS5odG1sKCkudHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaHRtbCA9PiAhIWh0bWwpXG4gICAgICAgICAgICAgICAgICAgICAgLm1hcChodG1sID0+ICh7IGdyYWRlU3RlcDogXCJDXCIsIGh0bWwgfSkpKVxuICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmdyYWRlLXN0ZXAtQSAua25vd2xlZGdlLXJlcXVpcmVtZW50JykpLm1hcChyID0+ICQocikuaHRtbCgpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihodG1sID0+ICEhaHRtbClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChodG1sID0+ICh7IGdyYWRlU3RlcDogXCJBXCIsIGh0bWwgfSkpKSlcbiAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgfTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgYXN5bmMgZGlmZldpdGhFeGlzdGluZygpOiBQcm9taXNlPHtjaGFuZ2VzOiBDaGFuZ2VbXSwgc3ViamVjdFRvSW1wb3J0OiBTdWJqZWN0VG9JbXBvcnR9PiB7XG4gICAgY29uc3Qgc3ViamVjdFRvSW1wb3J0ID0gdGhpcy5jaGVycnlQaWNrRGF0YSgpO1xuICAgIGxldCBjaGFuZ2VzOiBDaGFuZ2VbXSA9IFtdO1xuICAgIC8vIEZpbmQgZXhpc3RpbmcgU3ViamVjdFxuICAgIGNvbnN0IGV4aXN0aW5nU3ViamVjdHMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFN1YmplY3Q+KFwic3ViamVjdHNcIik7XG4gICAgbGV0IGV4aXN0aW5nU3ViamVjdCA9IGV4aXN0aW5nU3ViamVjdHMuZmlsdGVyKHMgPT4gcy5jb2RlID09PSB0aGlzLnByb3BzLnN1YmplY3QuY29kZSlbMF07XG4gICAgbGV0IGNlbnRyYWxDb250ZW50ID0gW10gYXMgQ2VudHJhbENvbnRlbnRbXSxcbiAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50cyA9IFtdIGFzIEtub3dsZWRnZVJlcXVpcmVtZW50W107XG5cbiAgICBsZXQgY3JlYXRlVGltZSA9IERhdGUubm93KCk7XG4gICAgZnVuY3Rpb24gY3QoKSB7XG4gICAgICBjb25zdCBydiA9IGNyZWF0ZVRpbWU7XG4gICAgICBjcmVhdGVUaW1lICs9IDI7XG4gICAgICByZXR1cm4gcnY7XG4gICAgfVxuXG4gICAgaWYgKGV4aXN0aW5nU3ViamVjdCkge1xuICAgICAgLy8gSW5jbHVkZSBhYmlsaXRpZXMgYW5kIHN0YW5kYXJkQ291cnNlcyB3aXRoIHRoZSBmb3VuZCBTdWJqZWN0OlxuICAgICAgYXdhaXQgZGlmZlhtbFdpdGhEYXRhYmFzZShleGlzdGluZ1N1YmplY3QsIHN1YmplY3RUb0ltcG9ydCwgY2hhbmdlcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFN1YmplY3Qgbm90IGltcG9ydGVkIGJlZm9yZS4gQWRkIGl0IVxuICAgICAgY29uc3QgbmV3U3ViamVjdDogU3ViamVjdCA9IGV4aXN0aW5nU3ViamVjdCA9IHtcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgc2Nob29sVHlwZTogc3ViamVjdFRvSW1wb3J0LnNjaG9vbFR5cGUsXG4gICAgICAgIHRhZ3M6IFtcInNjaG9vbFR5cGU6XCIgKyBzdWJqZWN0VG9JbXBvcnQuc2Nob29sVHlwZV0sXG4gICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgIGNvZGU6IHN1YmplY3RUb0ltcG9ydC5jb2RlLFxuICAgICAgICBuYW1lOiBzdWJqZWN0VG9JbXBvcnQubmFtZSxcbiAgICAgICAgYWJpbGl0aWVzT3JkZXI6IFtdLCAvLyBVcGRhdGUgbGF0ZXIgb24hXG4gICAgICAgIHB1Ymxpc2hhYmxlOiBmYWxzZSxcbiAgICAgICAgZGF0ZVRpbWU6IGN0KClcbiAgICAgIH07XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBjaGFuZ2U6IFwiTnl0dCDDpG1uZVwiLFxuICAgICAgICBjb250ZW50OiBgJHtzdWJqZWN0VG9JbXBvcnQubmFtZX0gKCR7c3ViamVjdFRvSW1wb3J0LmNvZGV9KWAsXG4gICAgICAgIG11dGF0aW9uczogciA9PiByLmFkZChcInN1YmplY3RzXCIsIG5ld1N1YmplY3QpXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc3ViamVjdEFiaWxpdGllcyA9IFtdO1xuXG4gICAgICBmb3IgKGxldCBhIG9mIHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMpIHtcbiAgICAgICAgY29uc3QgbmV3QWJpbGl0eTogQWJpbGl0eSA9IHtcbiAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICAgIG5hbWU6IGEsXG4gICAgICAgICAgYWNsOiBbXCJyb2xlOlVTRVI6UlwiXSxcbiAgICAgICAgICBkYXRlVGltZTogY3QoKVxuICAgICAgICB9O1xuXG4gICAgICAgIHN1YmplY3RBYmlsaXRpZXMucHVzaChuZXdBYmlsaXR5KTsgLy8gVG8gcmVmZXIgZnJvbSBpbiBjb3Vyc2VzIGxhdGVyIG9uIVxuXG4gICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgY2hhbmdlOiBcIk55IGbDtnJtw6VnYVwiLFxuICAgICAgICAgIGNvbnRlbnQ6IGEsXG4gICAgICAgICAgbXV0YXRpb25zOiByID0+IHtcbiAgICAgICAgICAgIHIuYWRkKFwiYWJpbGl0aWVzXCIsIG5ld0FiaWxpdHkpO1xuICAgICAgICAgICAgci5saW5rKFwic3ViamVjdHNcIiwgbmV3U3ViamVjdC5pZCwgXCJhYmlsaXRpZXNcIiwgbmV3QWJpbGl0eS5pZCwgXCJhYmlsaXRpZXNcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIG5vdyB3aGVuIHdlIGhhdmUgYWJpbGl0aWVzIG9yZGVyOlxuICAgICAgbmV3U3ViamVjdC5hYmlsaXRpZXNPcmRlciA9IHN1YmplY3RBYmlsaXRpZXMubWFwKCh7aWR9KSA9PiBpZCk7XG5cbiAgICAgIGZvciAobGV0IGMgb2Ygc3ViamVjdFRvSW1wb3J0LmNvdXJzZXMpIHtcbiAgICAgICAgY29uc3QgbmV3Q291cnNlOiBDb3Vyc2UgPSB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICBzdWJqZWN0Q29kZTogbmV3U3ViamVjdC5jb2RlLFxuICAgICAgICAgIHNjaG9vbFR5cGU6IG5ld1N1YmplY3Quc2Nob29sVHlwZSxcbiAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICBcInN1YjpcIiArIG5ld1N1YmplY3QuY29kZSxcbiAgICAgICAgICAgIFwiY291cnNlOlwiICsgYy5jb2RlLFxuICAgICAgICAgICAgXCJzY2hvb2xUeXBlOlwiICsgbmV3U3ViamVjdC5zY2hvb2xUeXBlXG4gICAgICAgICAgXSxcbiAgICAgICAgICBkYXRlVGltZTogY3QoKSxcbiAgICAgICAgICBpc1RlbXBsYXRlOiB0cnVlLFxuICAgICAgICAgIGFjbDogW1wicm9sZTpFTVBMT1lFRTpSXCJdLCAvLyBTdGFuZGFyZGt1cnNlciBlbmRhc3Qgc3lubGlnYSBmw7ZyIGzDpHJhcmVcbiAgICAgICAgICBuYW1lOiBjLm5hbWUsXG4gICAgICAgICAgY29kZTogYy5jb2RlLFxuICAgICAgICAgIHBvaW50czogYy5wb2ludHMsXG4gICAgICAgICAgbW9kdWxlczogW10sXG4gICAgICAgICAgc3ViamVjdElkOiBuZXdTdWJqZWN0LmlkLFxuICAgICAgICAgIHJlc291cmNlczogW10sXG4gICAgICAgICAgY3JlYXRlZEJ5OiB7IG5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZSwgdXJsOiBcIm1haWx0bzpcIiArIGVudi5jdXJyZW50VXNlci5tYWlsIH0sXG4gICAgICAgICAgY3JlYXRlZERhdGU6IERhdGUubm93KCksXG4gICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXI6IFtdLFxuICAgICAgICAgIGNlbnRyYWxDb250ZW50T3JkZXI6IFtdLFxuICAgICAgICAgIGFiaWxpdGllc09yZGVyOiBzdWJqZWN0QWJpbGl0aWVzLm1hcCgoe2lkfSkgPT4gaWQpXG4gICAgICAgIH07XG4gICAgICAgIGlmIChjLnllYXIpIG5ld0NvdXJzZS5zY2hvb2xHcmFkZSA9IGMueWVhcjtcblxuICAgICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICAgIGNoYW5nZTogXCJOeSBrdXJzXCIsXG4gICAgICAgICAgY29udGVudDogYy5uYW1lLFxuICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICByLmFkZChcImNvdXJzZXNcIiwgbmV3Q291cnNlKTtcbiAgICAgICAgICAgIHIubGluayhcInN1YmplY3RzXCIsIG5ld1N1YmplY3QuaWQsIFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwiY291cnNlVGVtcGxhdGVzXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZm9yIChsZXQge2dyb3VwOiBjY0dyb3VwLCBodG1sfSBvZiBjLmNlbnRyYWxDb250ZW50KSB7XG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgZXhpc3RzIGFuIGlkZW50aWNhbCBjZW50cmFsIGNvbnRlbnQgb24gcHJldmlvdXMgY291cnNlIGZpcnN0XG4gICAgICAgICAgbGV0IG5ld0NlbnRyYWxDb250ZW50ID0gY2VudHJhbENvbnRlbnQuZmlsdGVyKGNjID0+IGNjLm5hbWUgPT09IGh0bWwpWzBdO1xuICAgICAgICAgIGlmICghbmV3Q2VudHJhbENvbnRlbnQpIHtcbiAgICAgICAgICAgIG5ld0NlbnRyYWxDb250ZW50ID0ge1xuICAgICAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICAgICAgICBkYXRlVGltZTogY3QoKSxcbiAgICAgICAgICAgICAgbmFtZTogaHRtbCxcbiAgICAgICAgICAgICAgYWNsOiBbXCJyb2xlOlVTRVI6UlwiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChjY0dyb3VwKSBuZXdDZW50cmFsQ29udGVudC5ncm91cCA9IGNjR3JvdXA7XG4gICAgICAgICAgICBjZW50cmFsQ29udGVudC5wdXNoKG5ld0NlbnRyYWxDb250ZW50KTtcblxuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgY2hhbmdlOiBcIk55dHQgY2VudHJhbHQgaW5uZWjDpWxsXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IGA8aDQ+JHtjY0dyb3VwfTwvaDQ+JHtodG1sfWAsXG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICAgICAgci5hZGQoXCJjZW50cmFsLWNvbnRlbnRcIiwgbmV3Q2VudHJhbENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHIubGluayhcImNvdXJzZXNcIiwgbmV3Q291cnNlLmlkLCBcImNlbnRyYWwtY29udGVudFwiLCBuZXdDZW50cmFsQ29udGVudC5pZCwgXCJjZW50cmFsQ29udGVudFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgICAgICAgbXV0YXRpb25zOiByID0+IHtcbiAgICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJjZW50cmFsLWNvbnRlbnRcIiwgbmV3Q2VudHJhbENvbnRlbnQuaWQsIFwiY2VudHJhbENvbnRlbnRcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBSZWdpc3RlciB0aGUgb3JkZXIgaW4gd2hpY2ggdGhpcyBjZW50cmFsIGNvbnRlbnQgYXBwZWFyZWQgaW4gdGhlIFhNTDpcbiAgICAgICAgICBuZXdDb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlci5wdXNoKG5ld0NlbnRyYWxDb250ZW50LmlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGNyIG9mIGMua25vd2xlZGdlUmVxdWlyZW1lbnRzKSB7XG4gICAgICAgICAgbGV0IG5ld0tub3dsZWRnZVJlcXVpcmVtZW50ID0ga25vd2xlZGdlUmVxdWlyZW1lbnRzLmZpbHRlcihrciA9PiBrci5uYW1lID09PSBjci5odG1sICYmIGtyLmdyYWRlU3RlcCA9PT0gY3IuZ3JhZGVTdGVwKVswXTtcbiAgICAgICAgICBpZiAoIW5ld0tub3dsZWRnZVJlcXVpcmVtZW50KSB7XG4gICAgICAgICAgICBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudCA9IHtcbiAgICAgICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICAgICAgZGF0ZVRpbWU6IGN0KCksXG4gICAgICAgICAgICAgIG5hbWU6IGNyLmh0bWwsXG4gICAgICAgICAgICAgIGdyYWRlU3RlcDogY3IuZ3JhZGVTdGVwLFxuICAgICAgICAgICAgICBhY2w6IFtcInJvbGU6VVNFUjpSXCJdXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHMucHVzaChuZXdLbm93bGVkZ2VSZXF1aXJlbWVudCk7XG5cbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgICAgIGNoYW5nZTogXCJOeXR0IGt1bnNrYXBza3JhdiBmw7ZyIGJldHlnZXQgXCIgKyBjci5ncmFkZVN0ZXAsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IGNyLmh0bWwsXG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICAgICAgci5hZGQoXCJrbm93bGVkZ2UtcmVxdWlyZW1lbnRzXCIsIG5ld0tub3dsZWRnZVJlcXVpcmVtZW50KTtcbiAgICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJrbm93bGVkZ2UtcmVxdWlyZW1lbnRzXCIsIG5ld0tub3dsZWRnZVJlcXVpcmVtZW50LmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICAgICAgci5saW5rKFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwia25vd2xlZGdlLXJlcXVpcmVtZW50c1wiLCBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudC5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBvcmRlciBpbiB3aGljaCB0aGlzIGtub3dsZWRnZSByZXF1aXJlbWVudCBhcHBlYXJlZCBpbiB0aGUgWE1MOlxuICAgICAgICAgIG5ld0NvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlci5wdXNoKG5ld0tub3dsZWRnZVJlcXVpcmVtZW50LmlkKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBCdWlsZCBrbm93bGVkZ2UgbWF0cml4XG5cbiAgICAgICAgLy8gTGluayBkaXJlY3RseSBmcm9tIGNvdXJzZSB0ZW1wbGF0ZSB0byBhbGwgYWJpbGl0aWVzIHRoYXQgdGhlIHN1YmplY3QgaGFzOlxuICAgICAgICBmb3IgKGNvbnN0IGEgb2Ygc3ViamVjdEFiaWxpdGllcykge1xuICAgICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xuICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJhYmlsaXRpZXNcIiwgYS5pZCwgXCJhYmlsaXRpZXNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge2NoYW5nZXMsIHN1YmplY3RUb0ltcG9ydH07XG4gIH1cblxuICBjYW5jZWwoKSB7XG4gICAgdGhpcy5wcm9wcy5vbkNhbmNlbCgpO1xuICB9XG5cbiAgYXN5bmMgaW1wb3J0KCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBpc1dvcmtpbmc6IHRydWUsIGlzSW1wb3J0aW5nOiB0cnVlIH0pO1xuICAgIGNvbnN0IGFsbE11dGF0aW9ucyA9IHRoaXMuc3RhdGUuY2hhbmdlcy5tYXAoY2hhbmdlID0+IGNoYW5nZS5tdXRhdGlvbnMpO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5kbyhyID0+IHtcbiAgICAgICAgYWxsTXV0YXRpb25zLmZvckVhY2gobXV0ID0+IG11dChyKSk7XG4gICAgICB9KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzV29ya2luZzogZmFsc2UsIGlzSW1wb3J0aW5nOiBmYWxzZSB9KTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vbkltcG9ydFN1Y2Nlc3ModGhpcy5wcm9wcy5zdWJqZWN0Lm5hbWUpO1xuICB9XG5cbiAgZml4TChodG1sOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gaHRtbDsvLy5yZXBsYWNlKCc8bCBmcm9tYXQ9XCJPTFwiPicpXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge3N1YmplY3RUb0ltcG9ydH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtzdWJqZWN0fSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIDxkaXY+PGgxPntMYFVwcGxhZGRhdCDDhG1uZSAke3N1YmplY3RUb0ltcG9ydCA/IHN1YmplY3RUb0ltcG9ydC5uYW1lIDogJyd9YH08L2gxPlxuICAgICAge3RoaXMuc3RhdGUuZXJyb3IgPyA8cD5GZWw6IHt0aGlzLnN0YXRlLmVycm9yfTwvcD4gOlxuICAgICAgIHRoaXMuc3RhdGUuaXNXb3JraW5nID8gPHA+QXJiZXRhci4uLjwvcD4gOlxuICAgICAgIHRoaXMuc3RhdGUuaXNJbXBvcnRpbmcgPyA8cD5JbXBvcnRlcmFyLi4uPC9wPiA6XG4gICAgICAgdGhpcy5zdGF0ZS5jaGFuZ2VzLmV2ZXJ5KGMgPT4gIWMuY2hhbmdlKSA/IC8vIEluZ2Egw6RuZHJpbmdhciBhdHQgdmlzYSAoYmFyYSBwc2V1ZG8tw6RuZHJpbmdhcilcbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxwPkt1bmRlIGludGUgZmlubmEgbsOlZ3JhIGbDtnLDpG5kcmluZ2FyIGZyw6VuIGJlZmludGxpZ3QgZGF0YS4gS2xpY2thIE9LIGbDtnIgYXR0IGF2YnJ5dGEgb2NoIMOldGVyZ8OlLjwvcD5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiB0aGlzLmNhbmNlbCgpfT4gT0sgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj4gOlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDx0YWJsZSBzdHlsZT17e2JvcmRlcjogXCIxcHggc29saWQgZ3JheVwiLCBwYWRkaW5nOiBcIjJweFwiIH19Pjx0aGVhZD48dHI+XG4gICAgICAgICAgPHRoIGNvbFNwYW49ezJ9PkdyYW5za25pbmcgYXYgw6RuZHJpbmdhciBpIGdydW5kLWRhdGE8L3RoPlxuICAgICAgICA8L3RyPjx0cj5cbiAgICAgICAgICAgIDx0aD7DhG5kcmluZzwvdGg+XG4gICAgICAgICAgICA8dGg+SW5uZWjDpWxsPC90aD5cbiAgICAgICAgICA8L3RyPjwvdGhlYWQ+PHRib2R5PlxuICAgICAgICAgICAge3RoaXMuc3RhdGUuY2hhbmdlcy5maWx0ZXIoY2hhbmdlID0+IGNoYW5nZS5jaGFuZ2UpLm1hcCgoY2hhbmdlLGkpID0+IDx0ciBrZXk9e2l9PlxuICAgICAgICAgICAgICA8dGQgc3R5bGU9e3twYWRkaW5nOiBcIjJweFwifX0+e2NoYW5nZS5jaGFuZ2V9PC90ZD5cbiAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7cGFkZGluZzogXCIycHhcIn19IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogY2hhbmdlLmNvbnRlbnQgfX0gLz5cbiAgICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgICA8L3Rib2R5PjwvdGFibGU+XG4gICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5jYW5jZWwoKX0gZGlzYWJsZWQ9e3RoaXMuc3RhdGUuaXNJbXBvcnRpbmd9PkF2YnJ5dDwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHRoaXMuaW1wb3J0KCl9IGRpc2FibGVkPXt0aGlzLnN0YXRlLmlzSW1wb3J0aW5nfT5JbXBvcnRlcmE8L2J1dHRvbj5cbiAgICAgICAgPGJyIC8+XG4gICAgICAgIDwvZGl2Pn0gXG4gICAgICA8YnV0dG9uXG4gICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMuc2V0U3RhdGUoeyBzaG93RnVsbFRleHQ6ICF0aGlzLnN0YXRlLnNob3dGdWxsVGV4dCB9KX0+XG4gICAgICAgIHt0aGlzLnN0YXRlLnNob3dGdWxsVGV4dCA/XG4gICAgICAgICAgTGBEw7ZsaiBuZWRhbmAgOlxuICAgICAgICAgIExgVmlzYSBoZWxhIHRleHRlbiBmcsOlbiBTa29sdmVya2V0YH1cbiAgICAgIDwvYnV0dG9uPlxuXG4gICAgICB7LyogVGhlIHRhYmxlIGJlbG93IGlzIE5PVCBqdXN0IGZvciBzaG93IVxuICAgICAgICAgIEZ1bmN0aW9uYWxpdHkgaXMgZGVwZW5kZW50IG9uIGl0cyBleGlzdGVuY2UgZm9yIGltcG9ydGluZyBzdHVmZiB1c2luZyBqUXVlcnkgdG8gY2hlcnJ5LXBpY2sgZGF0YS4gKi99ICAgICAgICAgIFxuICAgICAgPHRhYmxlIHN0eWxlPXt7IGRpc3BsYXk6IHRoaXMuc3RhdGUuc2hvd0Z1bGxUZXh0ID8gJycgOiAnbm9uZScgfX0+PHRib2R5Pjx0cj5cbiAgICAgICAgPHRoPlxuICAgICAgICAgIE5hbW5cbiAgICAgICAgPC90aD5cbiAgICAgICAgPHRkPlxuICAgICAgICAgIHtzdWJqZWN0Lm5hbWV9XG4gICAgICAgIDwvdGQ+XG4gICAgICA8L3RyPjx0cj5cbiAgICAgICAgICA8dGg+XG4gICAgICAgICAgICDDhG1uZXNrb2RcbiAgICAgICAgICA8L3RoPlxuICAgICAgICAgIDx0ZD5cbiAgICAgICAgICAgIHtzdWJqZWN0LmNvZGV9XG4gICAgICAgICAgPC90ZD5cbiAgICAgICAgPC90cj48dHI+XG4gICAgICAgICAgPHRoPlxuICAgICAgICAgICAgU3lmdGVcbiAgICAgICAgICA8L3RoPlxuICAgICAgICAgIDx0ZCByZWY9e2VsZW0gPT4gdGhpcy5wdXJwb3NlRWxlbSA9IGVsZW19IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5maXhMKHN1YmplY3QucHVycG9zZSkgfX0gLz5cbiAgICAgICAgPC90cj48dHI+XG4gICAgICAgICAgPHRoPlxuICAgICAgICAgICAgS3Vyc2VyXG4gICAgICAgICAgPC90aD5cbiAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICB7c3ViamVjdC5jb3Vyc2VzLm1hcChjb3Vyc2UgPT4gPHRhYmxlIGtleT17Y291cnNlLmNvZGV9IHJlZj17ZWxlbSA9PiB0aGlzLmNvdXJzZXNFbGVtc1tjb3Vyc2UuY29kZV0gPSB7IGNvdXJzZSwgZWxlbSB9fT48dGJvZHk+XG4gICAgICAgICAgICAgIDx0cj48dGg+S3Vyc2VucyBuYW1uPC90aD48dGQ+e2NvdXJzZS5uYW1lfTwvdGQ+PC90cj5cbiAgICAgICAgICAgICAgPHRyPjx0aD5LdXJza29kPC90aD48dGQ+e2NvdXJzZS5jb2RlfTwvdGQ+PC90cj5cbiAgICAgICAgICAgICAgPHRyPjx0aD5Qb8Okbmc8L3RoPjx0ZD57Y291cnNlLnBvaW50c308L3RkPjwvdHI+XG4gICAgICAgICAgICAgIDx0cj48dGg+Q2VudHJhbHQgaW5uZWjDpWxsPC90aD48dGQgcmVmPXtlbGVtID0+IHRoaXMuY2VudHJhbENvbnRlbnRFbGVtcy5wdXNoKGVsZW0pfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChjb3Vyc2UuY2VudHJhbENvbnRlbnQpIH19IC8+PC90cj5cbiAgICAgICAgICAgICAge2NvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLnNvbWUoa3IgPT4gIWtyLmdyYWRlU3RlcCkgPyA8dHI+XG4gICAgICAgICAgICAgICAgPHRoPkt1bnNrYXBza3JhdiB1dGFuIGJldHlnc8OkdHRuaW5nPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiZ3JhZGUtc3RlcC1ub25lXCIgcmVmPXtlbGVtID0+IHRoaXMua25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtcy5wdXNoKGVsZW0pfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIociA9PiAhci5ncmFkZVN0ZXApLm1hcChrciA9PiBrci50ZXh0KS5qb2luKCcnKSkgfX0gLz5cbiAgICAgICAgICAgICAgPC90cj4gOiB1bmRlZmluZWR9XG5cbiAgICAgICAgICAgICAge2NvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLnNvbWUoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSdFJykgPyA8dHI+XG4gICAgICAgICAgICAgICAgPHRoPkt1bnNrYXBza3JhdiBCZXR5ZyBFPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiZ3JhZGUtc3RlcC1FXCIgcmVmPXtlbGVtID0+IHRoaXMua25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtcy5wdXNoKGVsZW0pfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIociA9PiByLmdyYWRlU3RlcCA9PT0gJ0UnKS5tYXAoa3IgPT4ga3IudGV4dCkuam9pbignJykpIH19IC8+XG4gICAgICAgICAgICAgIDwvdHI+IDogdW5kZWZpbmVkfVxuXG4gICAgICAgICAgICAgIHtjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5zb21lKGtyID0+IGtyLmdyYWRlU3RlcCA9PT0nQycpID8gPHRyPlxuICAgICAgICAgICAgICAgIDx0aD5LdW5za2Fwc2tyYXYgQmV0eWcgQzwvdGg+XG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImdyYWRlLXN0ZXAtQ1wiIHJlZj17ZWxlbSA9PiB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuZmlsdGVyKHIgPT4gci5ncmFkZVN0ZXAgPT09ICdDJykubWFwKGtyID0+IGtyLnRleHQpLmpvaW4oJycpKSB9fSAvPlxuICAgICAgICAgICAgICA8L3RyPiA6IHVuZGVmaW5lZH1cblxuICAgICAgICAgICAgICB7Y291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuc29tZShrciA9PiBrci5ncmFkZVN0ZXAgPT09J0EnKSA/IDx0cj5cbiAgICAgICAgICAgICAgICA8dGg+S3Vuc2thcHNrcmF2IEJldHlnIEE8L3RoPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJncmFkZS1zdGVwLUFcIiByZWY9e2VsZW0gPT4gdGhpcy5rbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zLnB1c2goZWxlbSl9IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5maXhMKGNvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLmZpbHRlcihyID0+IHIuZ3JhZGVTdGVwID09PSAnQScpLm1hcChrciA9PiBrci50ZXh0KS5qb2luKCcnKSkgfX0gLz5cbiAgICAgICAgICAgICAgPC90cj4gOiB1bmRlZmluZWR9XG5cbiAgICAgICAgICAgIDwvdGJvZHk+PC90YWJsZT4pfVxuICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvdHI+XG4gICAgICA8L3Rib2R5PjwvdGFibGU+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBEb2N1bWVudCwgUmVzb3VyY2UsIE1vZGlmaWNhdGlvblRyYWNrZWQsIENvdXJzZSwgVGFzaywgU29mdERvY3VtZW50QWNjZXNzIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBnZXRGaXJzdEFuZExhc3RXZWVrT2ZUZXJtIH0gZnJvbSAnLi4vLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVEb2N1bWVudEdyYXBocyhvbGREb2MsIG5ld0RvYywgdGFibGU6IHN0cmluZywgZ3JhcGhzOiB7IFtsYWJlbDogc3RyaW5nXTogc3RyaW5nIH0sIGJhdGNoOiBCYXRjaFJ1bm5lcikge1xuICBjb25zdCBkb2NVcGRhdGVzID0ge307XG4gIGNvbnN0IGRvY0lkID0gbmV3RG9jLmlkO1xuICBmb3IgKGxldCBuYXZQcm9wIG9mIE9iamVjdC5rZXlzKGdyYXBocykpIHtcbiAgICBjb25zdCBmb3JlaWduVGFibGUgPSBncmFwaHNbbmF2UHJvcF07XG4gICAgY29uc3Qgb2xkTGlzdDogRG9jdW1lbnRbXSA9IG9sZERvY1tuYXZQcm9wXSB8fCBbXTtcbiAgICBjb25zdCBuZXdMaXN0OiBEb2N1bWVudFtdID0gbmV3RG9jW25hdlByb3BdO1xuICAgIGlmICghbmV3TGlzdCkgY29udGludWU7XG4gICAgY29uc3QgdHVwbGVzID0gbmV3TGlzdFxuICAgICAgLm1hcCgoZG9jLCBpZHgpPT4oe2RvYywgaWR4fSkpOyAvLyBDcmVhdGUgdHVibGVzIG9mIHtkb2MsIGFycmF5LWluZGV4fSBzbyB3ZSBjYW4gdXBkYXRlIHJlc3VsdFxuICAgIGNvbnN0IGFkZGVkID0gdHVwbGVzLmZpbHRlcih0dXBsZSA9PiAhb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkKSk7IC8vIEZpbmQgYWRkZWQgaXRlbXNcblxuICAgIGZvciAobGV0IGEgb2YgYWRkZWQpIHtcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4uYS5kb2N9O1xuICAgICAgY29uc3QgbWV0YSA9IG11dGF0ZWRTdWJEb2MuJG1ldGE7XG4gICAgICBkZWxldGUgbXV0YXRlZFN1YkRvYy4kbWV0YTsgLy8gRGVsZXRlICRtZXRhIHNvIHRoYXQgXCJhZGRcIiBvciBcInVwZGF0ZVwiIGRvZXMgbm90IHBlcnNpc3RlIHRvIG5leHQgc3RhdGUuXG4gICAgICBpZiAobWV0YSA9PT0gJ2FkZCcpIHtcbiAgICAgICAgaWYgKCFtdXRhdGVkU3ViRG9jLmlkKSBtdXRhdGVkU3ViRG9jLmlkID0gY3JlYXRlVVVJRCgpOyAvLyBHZW5lcmF0ZSBJRCBpZiBub3QgZG9uZSB5ZXQuXG4gICAgICAgIC8vIE5vdyBwdXQgYW4gJ2FkZCcgbXV0YXRpb24gaW4gdGhlIGJhdGNoIHF1ZXVlLlxuICAgICAgICBiYXRjaC5hZGQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcbiAgICAgIH0gZWxzZSBpZiAobWV0YSA9PT0gJ3VwZGF0ZScpIHtcbiAgICAgICAgYmF0Y2gucHV0KGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYyk7XG4gICAgICB9XG4gICAgICBiYXRjaC5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jLmlkLCBuYXZQcm9wKTtcblxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0IHN0YXRlIGlzIHJlZmxlY3RlZCBhZnRlciBzdWNjZXNmdWwgUE9TVCB0byBzZXJ2ZXIuXG4gICAgICBpZiAoIWRvY1VwZGF0ZXNbbmF2UHJvcF0pIGRvY1VwZGF0ZXNbbmF2UHJvcF0gPSB7fTtcbiAgICAgIGRvY1VwZGF0ZXNbbmF2UHJvcF1bYS5pZHhdID0geyRzZXQ6IG11dGF0ZWRTdWJEb2N9O1xuICAgIH1cbiAgICBjb25zdCByZW1vdmVkID0gb2xkTGlzdC5maWx0ZXIobyA9PiAhbmV3TGlzdC5zb21lKG4gPT4gbi5pZCA9PT0gby5pZCkpO1xuICAgIGZvciAobGV0IHIgb2YgcmVtb3ZlZCkge1xuICAgICAgYmF0Y2gudW5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCByLmlkLCBuYXZQcm9wKTtcbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZCA9IHR1cGxlcy5maWx0ZXIodHVwbGUgPT4gb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkICYmIHR1cGxlLmRvYy4kbWV0YSA9PT0gJ3VwZGF0ZScpKTtcbiAgICBmb3IgKGxldCB1IG9mIHVwZGF0ZWQpIHtcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4udS5kb2N9O1xuICAgICAgZGVsZXRlIG11dGF0ZWRTdWJEb2MuJG1ldGE7XG4gICAgICBiYXRjaC5wdXQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcblxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0ICRtZXRhIGlzIHJlbW92ZWQgZnJvbSBuYXZpZ2F0aW9uIHByb3AgYWZ0ZXIgc3VjY2Vzc2Z1bCBQT1NUIHRvIHNlcnZlci5cbiAgICAgIGlmICghZG9jVXBkYXRlc1tuYXZQcm9wXSkgZG9jVXBkYXRlc1tuYXZQcm9wXSA9IHt9O1xuICAgICAgZG9jVXBkYXRlc1tuYXZQcm9wXVt1LmlkeF0gPSB7JHNldDogbXV0YXRlZFN1YkRvY307XG4gICAgfVxuICB9XG4gIHJldHVybiB1cGRhdGUobmV3RG9jLCBkb2NVcGRhdGVzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGR0Rm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCBISDptbScpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvcnREYXRlRm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvcnRQZXJzb25OYW1lRm9ybWF0KG5hbWU6IHN0cmluZykge1xuICBpZiAoIW5hbWUpIHJldHVybiBcIlwiO1xuICBjb25zdCBuYW1lcyA9IG5hbWUuc3BsaXQoJyAnKS5maWx0ZXIobiA9PiAhIW4pO1xuICBjb25zdCBsYXN0TmFtZSA9IG5hbWVzLnBvcCgpO1xuICByZXR1cm4gbmFtZXMubWFwKG5hbWUgPT4gYCR7bmFtZVswXX0uYCkuY29uY2F0KGxhc3ROYW1lKS5qb2luKCcgJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNb2RpZmljYXRpb25TdGFtcCAobm93OiBudW1iZXIsIG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xuICByZXR1cm4gdXBkYXRlKG9iaiwge1xuICAgIGRhdGVUaW1lOiB7JHNldDogbm93fSwgLy8gRm9yIHF1ZXJpZXMuLi5cbiAgICBtb2RpZmllZERhdGU6IHskc2V0OiBub3d9LFxuICAgIG1vZGlmaWVkQnk6IHtcbiAgICAgICRzZXQ6IHtcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDcmVhdGlvblN0YW1wPFQgZXh0ZW5kcyBNb2RpZmljYXRpb25UcmFja2VkPiAobm93OiBudW1iZXIsIG9iajogVCwgdXNlcjogVXNlcik6IFQge1xuICByZXR1cm4gdXBkYXRlKG9iaiwge1xuICAgIGNyZWF0ZWREYXRlOiB7JHNldDogbm93fSxcbiAgICBjcmVhdGVkQnk6IHtcbiAgICAgICRzZXQ6IHtcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbWFpbEZyb21Eb2NBY2Nlc3MgKHJlc291cmNlOiBTb2Z0RG9jdW1lbnRBY2Nlc3MpIHtcbiAgaWYgKHJlc291cmNlLmVtYWlsKSByZXR1cm4gcmVzb3VyY2UuZW1haWw7XG4gIHJldHVybiByZXNvdXJjZS51cmwgP1xuICAgIHJlc291cmNlLnVybC5zdGFydHNXaXRoKCdtYWlsdG86JykgP1xuICAgICAgcmVzb3VyY2UudXJsLnN1YnN0cmluZygnbWFpbHRvOicubGVuZ3RoKSA6XG4gICAgICByZXNvdXJjZS51cmwgOlxuICAgIHJlc291cmNlLnVybDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBvYmogPSB1cGRhdGVNb2RpZmljYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XG4gIGlmICghb2JqLmNyZWF0ZWRCeSkgb2JqID0gdXBkYXRlQ3JlYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XG4gIHJldHVybiBvYmo7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseUV0YWdzKGRvYzogRG9jdW1lbnQsIG5ld0V0YWdzOiB7W2lkOiBzdHJpbmddOiBzdHJpbmd9LCBncmFwaHM6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IHJlcyA9IHsuLi5kb2N9O1xuICBjb25zdCBldGFnID0gbmV3RXRhZ3NbZG9jLmlkXTtcbiAgaWYgKGV0YWcpXG4gICAgcmVzLiRldGFnID0gZXRhZztcbiAgZm9yIChsZXQgbGFiZWwgb2YgZ3JhcGhzKSB7XG4gICAgY29uc3QgbmV3TGlzdCA9IGRvY1tsYWJlbF0ubWFwKGQgPT4gYXBwbHlFdGFncyhkLCBuZXdFdGFncywgW10pKTtcbiAgICByZXNbbGFiZWxdID0gbmV3TGlzdDtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2IoYmxvYjogQmxvYiwgbTogKHI6RmlsZVJlYWRlcik9PnZvaWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgIHJlYWRlci5vbmxvYWQgPSBldiA9PiByZXNvbHZlKChldi50YXJnZXQgYXMgYW55KS5yZXN1bHQpO1xuICAgIHJlYWRlci5vbmFib3J0ID0gZXYgPT4gcmVqZWN0KG5ldyBFcnJvcihcImZpbGUgcmVhZCBhYm9ydGVkXCIpKTtcbiAgICByZWFkZXIub25lcnJvciA9IGV2ID0+IHJlamVjdCgoZXYudGFyZ2V0IGFzIGFueSkuZXJyb3IpO1xuICAgIG0ocmVhZGVyKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dCAoYmxvYjogQmxvYikge1xuICByZXR1cm4gcmVhZEJsb2IoYmxvYiwgcj0+ci5yZWFkQXNUZXh0KGJsb2IpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iQXNEYXRhVXJsIChibG9iOiBCbG9iKSB7XG4gIHJldHVybiByZWFkQmxvYihibG9iLCByPT5yLnJlYWRBc0RhdGFVUkwoYmxvYikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsb3dDb3B5KGU6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cyhzdGF0dXM6ICd1bnNhdmVkJyB8ICdzYXZlZCcgfCAnZXJyb3InIHwgJycpIHtcbiAgY29uc3QgZGl2ID0gJCgnZGl2LmNvdXJzZS1idWlsZGVyJylbMF07XG4gIGlmIChkaXYpIGRpdi5jbGFzc05hbWUgPSBcImNvdXJzZS1idWlsZGVyXCIgKyAoc3RhdHVzID8gXCIgc3RhdHVzIFwiICsgc3RhdHVzIDogXCJcIik7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkQ291cnNlKGlkOiBzdHJpbmcsIG9wdGlvbnM/OiB7XG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4/OiBib29sZWFuLFxuICAgIGluY2x1ZGU/OiBzdHJpbmdbXVxuICB9KTogUHJvbWlzZTxDb3Vyc2U+XG57XG4gIGNvbnN0IGNsaWVudCA9IGVudi5rZWRCYWNrZW5kQ2xpZW50O1xuICBjb25zdCBpbmNsdWRlVGVtcGxhdGVDaGFpbiA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlVGVtcGxhdGVDaGFpbjtcbiAgY29uc3QgaW5jbHVkZVRhc2tzID0gIW9wdGlvbnMgfHwgIW9wdGlvbnMuaW5jbHVkZSB8fCBvcHRpb25zLmluY2x1ZGUuaW5kZXhPZihcInRhc2tzXCIpICE9PSAtMTtcbiAgY29uc3QgW2NvdXJzZSwgY291cnNlVGFza3MsIHRlbXBsYXRlQ2hhaW5dID0gKGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBjbGllbnQuZ2V0KFwiY291cnNlc1wiLCBpZCwge1xuICAgICAgaW5jbHVkZTogb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGUgPyBvcHRpb25zLmluY2x1ZGUuZmlsdGVyKGkgPT4gaSAhPT0gXCJ0YXNrc1wiKSA6IFtcbiAgICAgICAgXCJjZW50cmFsQ29udGVudFwiLFxuICAgICAgICBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLFxuICAgICAgICBcImFiaWxpdGllc1wiLFxuICAgICAgICBcImltYWdlc1wiLFxuICAgICAgICBcImFjbFwiIC8vIERvbid0IGluY2x1ZGUgdGFza3MgaGVyZS4uLlxuICAgICAgXVxuICAgIH0pLFxuICAgIC8vIC4uLiBidXQgaW5jbHVkZSB0YXNrcyBoZXJlIGluc3RlYWQgc28gdGhhdCB3ZSBjYW4gbG9hZCB0aGUgZ3JhcGhzIGZvciB0aGVcbiAgICAvLyB0YXNrcyBhcyB3ZWxsIVxuICAgIGluY2x1ZGVUYXNrcyAmJiBjbGllbnQubGlzdChcInRhc2tzXCIsIHtcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXG4gICAgICBpbmNsdWRlOiBbJ2tub3dsZWRnZVJlcXVpcmVtZW50cycsICdjZW50cmFsQ29udGVudCcsICdhYmlsaXRpZXMnLCAnYWNsJ10sXG4gICAgICBmbGFnczogWydpbmNsdWRlSWRzT25seSddIC8vIERvbid0IG5lZWQgcmVkdW5kYW50IGluZm8gdGhhdCdzIGFscmVhZHkgb24gY291cnNlXG4gICAgfSksXG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4gJiYgY2xpZW50Lmxpc3QoXCJjb3Vyc2VzXCIsIHtcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXG4gICAgICBmbGFnczogWydpZHNPbmx5J11cbiAgICB9KVxuICBdKSkgYXMgW0NvdXJzZSwgVGFza1tdLCBDb3Vyc2VbXV07XG4gIGNvdXJzZS50YXNrcyA9IGNvdXJzZVRhc2tzO1xuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEFiaWxpdGllc1xuICBpZiAoY291cnNlLmFiaWxpdGllcyAmJiBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIpIHtcbiAgICBjb3Vyc2UuYWJpbGl0aWVzID0gY291cnNlLmFiaWxpdGllc09yZGVyLm1hcChpZCA9PlxuICAgICAgY291cnNlLmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpKTtcbiAgfVxuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEtub3dsZWRnZVJlcXVpcmVtZW50c1xuICBpZiAoY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cyAmJiBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIpIHtcbiAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzID0gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyLm1hcChpZCA9PlxuICAgICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5maW5kKGMgPT4gYy5pZCA9PT0gaWQpKTtcbiAgfVxuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIENlbnRyYWxDb250ZW50XG4gIGlmIChjb3Vyc2UuY2VudHJhbENvbnRlbnQgJiYgY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIpIHtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQgPSBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlci5tYXAoaWQgPT5cbiAgICAgIGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09PSBpZCkpOy8vLmZpbHRlcih4ID0+ICEheCk7Ly8gRGVidWdnaW5nIHNvbXRoaW4nIC4gTm9ybWFsbHkgdGhlIGxhc3QgLmZpbHRlcigpLi4uIHBhcnQgc2hvdWxkIG5vdCBiZSBuZXNjZXNzYXJ5Li4uXG4gIH1cbiAgXG4gIC8vIEluY2x1ZGUgdGVtcGxhdGUgY2hhaW4gaWYgcmVxdWVzdGVkLlxuICBpZiAoaW5jbHVkZVRlbXBsYXRlQ2hhaW4pIGNvdXJzZS50ZW1wbGF0ZUNoYWluID0gdGVtcGxhdGVDaGFpbjtcbiAgcmV0dXJuIGNvdXJzZTtcbn1cblxuLy8gQ2hlY2sgZGlmZmVyZW5jZXMgYmV0d2VlbiB0d28gYXJyYXkgb2YgdHlwZSBUXG5leHBvcnQgZnVuY3Rpb24gaGFzQ2hhbmdlcyhvcmlnaW5hbFZhbHVlczogQXJyYXk8YW55PiwgY3VycmVudFZhbHVlczogQXJyYXk8YW55Pik6IGJvb2xlYW57XG4gIHJldHVybiBvcmlnaW5hbFZhbHVlcyA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnRWYWx1ZXMuZmlsdGVyKCh4KSA9PiAhb3JpZ2luYWxWYWx1ZXMuaW5jbHVkZXMoeCkpLmxlbmd0aCA+IDAgfHwgb3JpZ2luYWxWYWx1ZXMuZmlsdGVyKCh4KSA9PiAhY3VycmVudFZhbHVlcy5pbmNsdWRlcyh4KSkubGVuZ3RoID4gMDtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmV4cG9ydCBjb25zdCBMYW5ndWFnZUNvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0KHtpbnRsOiBudWxsfSk7IiwiaW1wb3J0IHtJbnRsUHJvdmlkZXIsIGFkZExvY2FsZURhdGF9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IGxvY2FsZV9lbiBmcm9tICdyZWFjdC1pbnRsL2xvY2FsZS1kYXRhL2VuJztcbmltcG9ydCBsb2NhbGVfc3YgZnJvbSAncmVhY3QtaW50bC9sb2NhbGUtZGF0YS9zdic7XG5pbXBvcnQgbWVzc2FnZXNfc3YgZnJvbSBcIi4uLy4uL3RyYW5zbGF0aW9ucy9zdi5qc29uXCI7XG5pbXBvcnQgbWVzc2FnZXNfZW4gZnJvbSBcIi4uLy4uL3RyYW5zbGF0aW9ucy9lbi5qc29uXCI7XG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5cbmV4cG9ydCBjb25zdCBzZXR1cEludGwgPSA8UCBleHRlbmRzIG9iamVjdD4oQ29tcG9uZW50OiBSZWFjdC5Db21wb25lbnRUeXBlPFA+KSA9PlxuICAgIGNsYXNzIF9TZXR1cExhbmd1YWdlSW50bCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQPntcbiAgICAgICAgbWVzc2FnZXMgOiBvYmplY3Q7XG5cbiAgICAgICAgY29uc3RydWN0b3IocHJvcHMpe1xuICAgICAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICAgICAgYWRkTG9jYWxlRGF0YShbLi4ubG9jYWxlX2VuLC4uLmxvY2FsZV9zdl0pO1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IHtcbiAgICAgICAgICAgICdzdic6IG1lc3NhZ2VzX3N2LFxuICAgICAgICAgICAgJ2VuJzogbWVzc2FnZXNfZW5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBtb21lbnQoKS5sb2NhbGUoY2ZnLktFRF9MT0NBTEUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVuZGVyKCl7XG4gICAgICAgICAgICByZXR1cm4gPEludGxQcm92aWRlciBsb2NhbGU9e2NmZy5LRURfTE9DQUxFfSBtZXNzYWdlcz17dGhpcy5tZXNzYWdlc1tjZmcuS0VEX0xPQ0FMRV19PlxuICAgICAgICAgICAgICAgIDxDb21wb25lbnQgey4uLnRoaXMucHJvcHMgYXMgUH0gLz5cbiAgICAgICAgICAgIDwvSW50bFByb3ZpZGVyPlxuICAgICAgICB9XG4gICAgfSIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGF2YWlsYWJsZToge25hbWU6IHN0cmluZywga2V5OiBzdHJpbmd9W11cbiAgc2VsZWN0ZWQ6IHN0cmluZ1tdXG4gIG9uQ2hhbmdlOiAoc2VsZWN0ZWQ6IHN0cmluZ1tdLCBjbGlja2VkS2V5OiBzdHJpbmcsIHdhc0NoZWNrZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjb25zdCBDaGVja2xpc3QgPSAoe2F2YWlsYWJsZSwgc2VsZWN0ZWQsIG9uQ2hhbmdlfTogUHJvcHMpID0+IDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICB7XG4gICAgYXZhaWxhYmxlLm1hcCgoe2tleSwgbmFtZX0pID0+IHtcbiAgICAgIGNvbnN0IGNoZWNrZWQgPSBzZWxlY3RlZC5pbmNsdWRlcyhrZXkpO1xuICAgICAgcmV0dXJuIDxkaXYga2V5PXtrZXl9IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiIG9uQ2xpY2s9eygpPT5cbiAgICAgICAgICAgIG9uQ2hhbmdlKGNoZWNrZWQgP1xuICAgICAgICAgICAgICBzZWxlY3RlZC5maWx0ZXIoayA9PiBrICE9IGtleSkgOlxuICAgICAgICAgICAgICBzZWxlY3RlZC5jb25jYXQoa2V5KSxcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBjaGVja2VkKX0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKGNoZWNrZWQgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX0+PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj57bmFtZX08L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICB9XG4gICAgKVxuICB9XG48L2Rpdj5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4vZm9ybS1maWVsZCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxhYmVsOiBhbnk7XG4gIGlkOiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICBhdXRvRm9jdXM/OiBib29sZWFuO1xuICBvbkNoYW5nZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBUZXh0SW5wdXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17dGhpcy5wcm9wcy5sYWJlbH0+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhdXRvRm9jdXM9e3RoaXMucHJvcHMuYXV0b0ZvY3VzfSBpZD17dGhpcy5wcm9wcy5pZH0gc2l6ZT17MzV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5wcm9wcy5vbkNoYW5nZShldi50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgIDwvRm9ybUZpZWxkPlxuICAgICk7XG4gIH1cbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRm9ybUZpZWxkIH0gZnJvbSAnLi9mb3JtLWZpZWxkJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGFiZWw6IGFueTtcbiAgaWQ6IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XG4gIGF1dG9Gb2N1cz86IGJvb2xlYW47XG4gIHJvd3M/OiBudW1iZXI7XG4gIGNoaWxkcmVuPztcbiAgb25DaGFuZ2U6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgVGV4dEFyZWFGb3JtRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17dGhpcy5wcm9wcy5sYWJlbH0gaWQ9e3RoaXMucHJvcHMuaWR9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPHRleHRhcmVhIGF1dG9Gb2N1cz17dGhpcy5wcm9wcy5hdXRvRm9jdXN9IGlkPXt0aGlzLnByb3BzLmlkfSBjb2xzPXszNX0gcm93cz17dGhpcy5wcm9wcy5yb3dzIHx8IDV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5wcm9wcy5vbkNoYW5nZShldi50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17dGhpcy5wcm9wcy5wbGFjZWhvbGRlcn0gLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB7ISF0aGlzLnByb3BzLmNoaWxkcmVuICYmIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgIHt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L0Zvcm1GaWVsZD5cbiAgICApO1xuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGFiZWw6IGFueTtcbiAgY2hpbGRyZW46IGFueTtcbiAgaWQ/OiBzdHJpbmc7XG59XG5cbmZ1bmN0aW9uIGZpbmRJZChub2RlKSB7XG4gIGNvbnN0IHJlY3VjaGVjayA9IG5ldyBTZXQoKTtcbiAgcmV0dXJuIChmdW5jdGlvbiBmaW5kSWQobm9kZSl7XG4gICAgaWYgKHR5cGVvZiBub2RlID09PSAnc3RyaW5nJykgcmV0dXJuIG51bGw7XG4gICAgaWYgKHJlY3VjaGVjay5oYXMobm9kZSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmVjdWNoZWNrLmFkZChub2RlKTtcbiAgICBpZiAobm9kZS5wcm9wcykge1xuICAgICAgaWYgKG5vZGUucHJvcHMuaWQpIHJldHVybiBub2RlLnByb3BzLmlkO1xuICAgICAgaWYgKG5vZGUucHJvcHMuY2hpbGRyZW4pIHtcbiAgICAgICAgcmV0dXJuIGZpbmRJZChub2RlLnByb3BzLmNoaWxkcmVuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG5vZGUubGVuZ3RoKSB7XG4gICAgICBmb3IgKGxldCBpPTA7aTxub2RlLmxlbmd0aDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gbm9kZVtpXTtcbiAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgY29uc3QgY2hpbGRJZCA9IGZpbmRJZChjaGlsZCk7XG4gICAgICAgICAgaWYgKGNoaWxkSWQpIHJldHVybiBjaGlsZElkO1xuICAgICAgICAgIC8vY29uc29sZS5sb2coY2hpbGQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KShub2RlKTtcbn1cblxuZXhwb3J0IGNsYXNzIEZvcm1GaWVsZCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiA8PlxuICAgICAgICA8bGFiZWwgY2xhc3NOYW1lPVwia2NsYWJlbFwiIGh0bWxGb3I9e3RoaXMucHJvcHMuaWQgfHwgZmluZElkKHRoaXMucHJvcHMuY2hpbGRyZW4pfT57dGhpcy5wcm9wcy5sYWJlbH08L2xhYmVsPlxuICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cbiAgICA8Lz5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBMaXZlUXVlcnlWaWV3IH0gZnJvbSAnLi9saXZlLXF1ZXJ5LXZpZXcnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjaGlsZHJlbjogT2JzZXJ2YWJsZTxKU1guRWxlbWVudD47XG4gIHNwaW5uZXI/OiBKU1guRWxlbWVudDtcbiAgbm9FcnJvcj86IGJvb2xlYW47XG4gIG9uRXJyb3I/OiAoZXJyb3I6IEVycm9yKSA9PiBKU1guRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIExhenlDb250ZW50KHtjaGlsZHJlbiwgc3Bpbm5lciwgb25FcnJvciwgbm9FcnJvcn06IFByb3BzKSB7XG4gIHJldHVybiA8TGl2ZVF1ZXJ5Vmlld1xuICAgIHByb3BzPXtjaGlsZHJlbn1cbiAgICBzcGlubmVyPXtzcGlubmVyfVxuICAgIG5vRXJyb3I9e25vRXJyb3J9XG4gICAgb25FcnJvcj17b25FcnJvcn1cbiAgICBmbj17b2JzZXJ2YWJsZSA9PiBvYnNlcnZhYmxlfSAvPjtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCB7IHNoYWxsb3dFcXVhbHMgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJzY3JpcHRpb24gfSBmcm9tICdrZWRiYWNrZW5kL29ic2VydmFibGUnO1xuXG5pbnRlcmZhY2UgT3B0aW9ucyB7XG4gIHNwaW5uZXI/OiBKU1guRWxlbWVudDtcbiAgb25FcnJvcj86IChlcnJvcjogRXJyb3IpID0+IEpTWC5FbGVtZW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGl2ZVF1ZXJ5VmlldzxUUHJvcHM+KFxuICBmbjogKHByb3BzOiBUUHJvcHMpID0+IE9ic2VydmFibGU8SlNYLkVsZW1lbnQ+LFxuICBvcHRpb25zPzogT3B0aW9ucyk6IChwcm9wczogVFByb3BzKSA9PiBKU1guRWxlbWVudFxue1xuICByZXR1cm4gKHByb3BzOiBUUHJvcHMpPT57XG4gICAgcmV0dXJuIDxMaXZlUXVlcnlWaWV3IHByb3BzPXtwcm9wc30gZm49e2ZufSB7Li4ub3B0aW9uc30gLz47XG4gIH1cbn1cblxuaW50ZXJmYWNlIFByb3BzPFRQcm9wcz4ge1xuICBwcm9wczogVFByb3BzO1xuICBzcGlubmVyPzogSlNYLkVsZW1lbnQ7XG4gIG5vRXJyb3I/OiBib29sZWFuO1xuICBvbkVycm9yPzogKGVycm9yOiBFcnJvcikgPT4gSlNYLkVsZW1lbnQ7XG4gIGZuOiAocHJvcHM6IFRQcm9wcykgPT4gT2JzZXJ2YWJsZTxKU1guRWxlbWVudD47XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHJlc3VsdDogSlNYLkVsZW1lbnQ7XG4gIGVycm9yPzogRXJyb3I7XG4gIGlzTG9hZGluZzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIExpdmVRdWVyeVZpZXc8VFByb3BzPiBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wczxUUHJvcHM+LCBTdGF0ZT4ge1xuICBwcml2YXRlIHN1YnNjcmlwdGlvbj86IFN1YnNjcmlwdGlvbjtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHM8VFByb3BzPikge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgcmVzdWx0OiBudWxsLFxuICAgICAgaXNMb2FkaW5nOiB0cnVlXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzOiBQcm9wczxUUHJvcHM+LCBuZXh0U3RhdGU6IFN0YXRlKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuc3RhdGUuZXJyb3IgIT09IG5leHRTdGF0ZS5lcnJvciB8fFxuICAgICAgdGhpcy5zdGF0ZS5pc0xvYWRpbmcgIT09IG5leHRTdGF0ZS5pc0xvYWRpbmcgfHxcbiAgICAgIHRoaXMuc3RhdGUucmVzdWx0ICE9PSBuZXh0U3RhdGUucmVzdWx0IHx8XG4gICAgICAhc2hhbGxvd0VxdWFscyhuZXh0UHJvcHMucHJvcHMsIHRoaXMucHJvcHMucHJvcHMpXG4gICAgKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IFByb3BzPFRQcm9wcz4pIHtcbiAgICBpZiAoIXNoYWxsb3dFcXVhbHMocHJldlByb3BzLnByb3BzLCB0aGlzLnByb3BzLnByb3BzKSkge1xuICAgICAgdGhpcy51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBzdWJzY3JpYmUoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7aXNMb2FkaW5nOiB0cnVlfSBhcyBhbnkpO1xuICAgIHRoaXMuc3Vic2NyaXB0aW9uID0gdGhpcy5wcm9wcy5mbih0aGlzLnByb3BzLnByb3BzKS5zdWJzY3JpYmUoKHJlc3VsdCwgZXJyb3IpID0+IHRoaXMuc2V0U3RhdGUoe1xuICAgICAgcmVzdWx0LFxuICAgICAgZXJyb3IsXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlXG4gICAgfSkpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoKSB7XG4gICAgaWYgKHRoaXMuc3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLnN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb24gPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIFxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge3Jlc3VsdCwgZXJyb3IsIGlzTG9hZGluZ30gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHtzcGlubmVyLCBvbkVycm9yLCBub0Vycm9yfSA9IHRoaXMucHJvcHM7XG4gICAgLy9pZiAoIWlzTG9hZGluZyAmJiAhcmVzdWx0KSBkZWJ1Z2dlcjtcbiAgICByZXR1cm4gZXJyb3IgP1xuICAgICAgbm9FcnJvciA/IFwiXCIgOiBvbkVycm9yID8gb25FcnJvcihlcnJvcikgOiA8cD5FcnJvcjoge2Vycm9yLm1lc3NhZ2V9PC9wPiA6XG4gICAgICBpc0xvYWRpbmcgP1xuICAgICAgICBzcGlubmVyID8gc3Bpbm5lciA6IFwiXCIgOlxuICAgICAgICByZXN1bHQgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQ7XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBSZXN0Q2xpZW50U3RhdHVzIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgVmFsdWUgfSBmcm9tICdrZWRiYWNrZW5kL29ic2VydmFibGUnO1xuaW1wb3J0IHsgbGl2ZVF1ZXJ5VmlldyB9IGZyb20gJy4vbGl2ZS1xdWVyeS12aWV3JztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEVsbGlwc2lzTG9hZGVyIH0gZnJvbSAnLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvZWxsaXBzaXMtbG9hZGVyJztcblxuZXhwb3J0IGNvbnN0IExvYWRpbmdJbmRpY2F0b3IgPSBsaXZlUXVlcnlWaWV3KCgpID0+XG4gIGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHAuc3RhdHVzLmNvbWJpbmVMYXRlc3QoZW52LmVkc0NsaWVudC5odHRwLnN0YXR1cylcbiAgLm1hcCgoW2tlZEJhY2tlbmRTdGF0dXMsIGVkc1N0YXR1c10pPT48ZGl2IGNsYXNzTmFtZT1cImxvYWRpbmctaW5kaWNhdG9yXCI+PGRpdiBjbGFzc05hbWU9XCJpbmRpY2F0b3JcIj5cbiAgICB7a2VkQmFja2VuZFN0YXR1cy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnMgPiAwIHx8IGVkc1N0YXR1cy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnMgPiAwID9cbiAgICAgIDxTcGlubmVyIC8+IDogdW5kZWZpbmVkfVxuPC9kaXY+PC9kaXY+KSk7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgb3B0aW9ucz86IE9wdGlvbltdO1xuICBvcHRpb25zVmlzaWJsZTogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgc2VsZWN0ZWQ6IE9wdGlvbltdXG4gIGdldE9wdGlvbnM6ICgpPT5Qcm9taXNlPE9wdGlvbltdPjtcbiAgb25DaGFuZ2U6IChzZWxlY3RlZDogT3B0aW9uW10pID0+IHZvaWQ7XG59XG5cbmludGVyZmFjZSBPcHRpb24ge1xuICBuYW1lOiBzdHJpbmc7XG4gIGtleTogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgTXVsdGlzZWxlY3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgb3B0aW9uc1Zpc2libGU6IGZhbHNlXG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtzZWxlY3RlZCwgb25DaGFuZ2UsIGdldE9wdGlvbnN9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7b3B0aW9uc1Zpc2libGUsIG9wdGlvbnN9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBmaWx0ZXJlZE9wdGlvbnMgPSBvcHRpb25zICYmIG9wdGlvbnMuZmlsdGVyKG8gPT4gIXNlbGVjdGVkLnNvbWUocyA9PiBzLmtleSA9PT0gby5rZXkpKTtcbiAgICByZXR1cm4gPD5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAgICB7XG4gICAgICAgICAgc2VsZWN0ZWQubWFwKCh7a2V5LCBuYW1lfSkgPT4ge1xuICAgICAgICAgICAgLy9jb25zdCBjaGVja2VkID0gc2VsZWN0ZWQuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgIHJldHVybiA8ZGl2IGtleT17a2V5fSBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICAgIDxpXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZhIGZhLXJlbW92ZSBob3ZlcmFibGVcIlxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+b25DaGFuZ2Uoc2VsZWN0ZWQuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24ua2V5ICE9PSBrZXkpKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICB7bmFtZX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICA8L2Rpdj5cbiAgICAgIDxzcGFuIHN0eWxlPXt7b3V0bGluZTogJ25vbmUnfX0gdGFiSW5kZXg9ezB9IG9uQmx1cj17ZXYgPT4gc2V0VGltZW91dCgoKT0+dGhpcy5zZXRTdGF0ZSh7b3B0aW9uc1Zpc2libGU6IGZhbHNlfSksIDEwMCl9PlxuICAgICAgICA8YVxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0blwiXG4gICAgICAgICAgb25DbGljaz17YXN5bmMgKCk9PntcbiAgICAgICAgICAgIGlmIChvcHRpb25zVmlzaWJsZSkgcmV0dXJuIHRoaXMuc2V0U3RhdGUoe29wdGlvbnNWaXNpYmxlOiBmYWxzZX0pO1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7b3B0aW9uc1Zpc2libGU6IHRydWV9KTtcbiAgICAgICAgICAgIGlmICghdGhpcy5zdGF0ZS5vcHRpb25zKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGF3YWl0IGdldE9wdGlvbnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtvcHRpb25zfSk7XG4gICAgICAgICAgICAgIH0gY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7b3B0aW9uczogW3trZXk6IG51bGwsIG5hbWU6IExgRXR0IGZlbCBoYXIgaW50csOkZmZhdGB9XX0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIiBhcmlhLWhpZGRlbj17dHJ1ZX0gLz4ge0xgTMOkZ2cgdGlsbGB9XG4gICAgICA8L2E+XG4gICAgICB7XG4gICAgICAgIG9wdGlvbnNWaXNpYmxlID8gPD5cbiAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZmlsdGVyZWRPcHRpb25zID9cbiAgICAgICAgICAgICAgICA8c2VsZWN0XG4gICAgICAgICAgICAgICAgICBzaXplPXtmaWx0ZXJlZE9wdGlvbnMubGVuZ3RoID09PSAxID8gMiA6IGZpbHRlcmVkT3B0aW9ucy5sZW5ndGh9XG4gICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU9JydcbiAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkS2V5ID0gZXYudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZShzZWxlY3RlZC5jb25jYXQoe2tleTogc2VsZWN0ZWRLZXksIG5hbWU6IG9wdGlvbnMuZmlsdGVyKG8gPT4gby5rZXkgPT09IHNlbGVjdGVkS2V5KS5tYXAobyA9PiBvLm5hbWUpWzBdfSkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtvcHRpb25zVmlzaWJsZTogZmFsc2V9KTtcbiAgICAgICAgICAgICAgICAgIH19PlxuICAgICAgICAgICAgICAgICAgPG9wdGlvbiBzdHlsZT17e2Rpc3BsYXk6ICdub25lJ319IGRpc2FibGVkIGtleT0nJyB2YWx1ZT0nJz48L29wdGlvbj5cbiAgICAgICAgICAgICAgICAgIHtmaWx0ZXJlZE9wdGlvbnMubWFwKCh7a2V5LCBuYW1lfSkgPT4gPG9wdGlvbiBrZXk9e2tleX0gdmFsdWU9e2tleX0+e25hbWV9PC9vcHRpb24+KX1cbiAgICAgICAgICAgICAgICA8L3NlbGVjdD4gOlxuICAgICAgICAgICAgICAgIDxTcGlubmVyIC8+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC8+IDpcbiAgICAgICAgICB1bmRlZmluZWRcbiAgICAgIH1cbiAgICAgIDwvc3Bhbj5cbiAgICA8Lz47XG4gIH1cbn0iLCIvKiBSRUZBQ1RPUjogTW92ZSB0aGlzIGNvbXBvbmVudCBvdXRzaWRlIGNvdXJzZWJ1aWxkZXIhXG4gICBUaGlzIGlzIGEgZ2VuZXJhbC1wdXJwb3NlIGNvbXBvbmVudFxuKi9cblxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgR29hbFByb2dyZXNzIH0gZnJvbSAnLi4vY2hhcnRzL2dvYWwtcHJvZ3Jlc3MnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0aXRsZTogc3RyaW5nIHwgSlNYLkVsZW1lbnQ7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaGVhZGVyQ2xhc3NOYW1lPzogc3RyaW5nO1xuICBjb250ZW50Q2xhc3NOYW1lPzogc3RyaW5nO1xuICBoZWFkZXJPcGVuPzogYm9vbGVhbjtcbiAgaW5hY3RpdmF0ZWQ/OiBib29sZWFuO1xuICBpbmFjdGl2YXRlZFJlbmRlcj86ICdjaGlsZHJlbicgfCAndGl0bGVBbmRDaGlsZHJlbic7XG4gIG9uT3BlbkNsb3NlPzogKGJlY2FtZU9wZW46IGJvb2xlYW4pID0+IHZvaWQ7XG4gIGRpc3BsYXlQcm9ncmVzcz86IGJvb2xlYW47XG4gIHByb2dyZXNzRGF0YT86IHtjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXIsIG51bWJlck9mVGFza3M6IG51bWJlcn07XG4gIGNoaWxkcmVuO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBoZWFkZXJPcGVuOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgT3BlbkNsb3NlQm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIChuZXh0UHJvcHM6IFByb3BzKSB7XG4gICAgaWYgKG5leHRQcm9wcy5oZWFkZXJPcGVuICE9PSB0aGlzLnByb3BzLmhlYWRlck9wZW4pIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2hlYWRlck9wZW46IG5leHRQcm9wcy5oZWFkZXJPcGVufSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGl0bGUsIGNsYXNzTmFtZSwgY2hpbGRyZW4sIGhlYWRlckNsYXNzTmFtZSwgY29udGVudENsYXNzTmFtZSwgZGlzcGxheVByb2dyZXNzLCBwcm9ncmVzc0RhdGEsXG4gICAgICBpbmFjdGl2YXRlZCwgaW5hY3RpdmF0ZWRSZW5kZXIgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBoZWFkZXJPcGVuIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgaWYgKGluYWN0aXZhdGVkKSByZXR1cm4gaW5hY3RpdmF0ZWRSZW5kZXIgPT09ICd0aXRsZUFuZENoaWxkcmVuJyA/IDw+XG4gICAgICA8Pnt0aXRsZX08Lz5cbiAgICAgIDw+e2NoaWxkcmVufTwvPlxuICAgIDwvPiA6IDw+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC8+O1xuXG4gICAgLy92YXIgY3VycmVudFByb2dyZXNzRGF0YSA9IC8vcHJvZ3Jlc3NEYXRhKCk7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXsoY2xhc3NOYW1lfHwnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkhlYWRlclwiICsgKGhlYWRlckNsYXNzTmFtZSA/IFwiIFwiICsgaGVhZGVyQ2xhc3NOYW1lIDogXCJcIil9XG4gICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5wcm9wcy5vbk9wZW5DbG9zZSkgdGhpcy5wcm9wcy5vbk9wZW5DbG9zZSghdGhpcy5zdGF0ZS5oZWFkZXJPcGVuKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KTtcbiAgICAgICAgfX0gPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJDb250YWluZXJcIj5cbiAgICAgICAgICA8ZGl2Pnt0aXRsZX08L2Rpdj5cbiAgICAgICAgICB7ZGlzcGxheVByb2dyZXNzICYmIDxHb2FsUHJvZ3Jlc3Mgey4uLnByb2dyZXNzRGF0YX0vPn1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtcIm9wZW5Db250ZW50XCIgKyAoY29udGVudENsYXNzTmFtZSA/IFwiIFwiICsgY29udGVudENsYXNzTmFtZSA6IFwiXCIpfT5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+O1xuICB9XG59XG4iLCJpbXBvcnQgJy4uLy4uL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuY29uc3QgYmVhcmVyUHJvbWlzZSA9IGVudi5iZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKTsgLy8gU3RhcnQgZ2V0dGluZyBiZWFyZXIgYXMgc29vbiBhcyBwb3NzaWJsZS5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHNob3dFcnJvciwgc2hvd0luZm8gfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5pbXBvcnQgeyBTdWJqZWN0UGxhbm5lckFkbWluQXBwIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9hZG1pbic7XG5pbXBvcnQgeyBJbmplY3RlZEludGxQcm9wcywgaW5qZWN0SW50bCB9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7IHNldHVwSW50bCB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsJztcblxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgSW5qZWN0ZWRJbnRsUHJvcHN7XG4gIGZlZWRiYWNrVXJsOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGlzVG9rZW5Mb2FkZWQ6IGJvb2xlYW47XG59XG5cbmNsYXNzIF9LRURBcHBDb3Vyc2VCdWlsZGVyS1MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc1Rva2VuTG9hZGVkOiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICBiZWFyZXJQcm9taXNlLnRoZW4oKCk9PntcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2lzVG9rZW5Mb2FkZWQ6IHRydWV9KTtcbiAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgc2hvd0Vycm9yKGVycik7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pc1Rva2VuTG9hZGVkID9cbiAgICAgIDxMYW5ndWFnZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3sgaW50bCB9fT5cbiAgICAgICAgPFN1YmplY3RQbGFubmVyQWRtaW5BcHAgLz5cbiAgICAgIDwvTGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyPiA6XG4gICAgICA8cD48U3Bpbm5lci8+Vi5nLiB2w6RudGEuLi4gYXV0ZW50aWNlcmFyLi4uPC9wPlxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBLRURBcHBDb3Vyc2VCdWlsZGVyS1MgPSBzZXR1cEludGwoaW5qZWN0SW50bChfS0VEQXBwQ291cnNlQnVpbGRlcktTKSk7XG4iLCJpbXBvcnQgS0VEIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VEJztcbmltcG9ydCAqIGFzIGNvbXBvbmVudHMgZnJvbSAnLi9hcHAuc3BhZG1pbi5jbGllbnQnO1xuS0VELmNvbXBvbmVudHMgPSB7Li4uS0VELmNvbXBvbmVudHMsIC4uLmNvbXBvbmVudHN9O1xuIiwiaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xuXG5kZWNsYXJlIHZhciBwcm9jZXNzOiBhbnk7XG5cbmNmZy5FTlZJUk9OTUVOVCA9IHByb2Nlc3MuZW52LkVOVklST05NRU5UIGFzIFwicHJvZHVjdGlvblwiIHwgXCJkZXZlbG9wbWVudFwiIHwgXCJ0ZXN0XCI7XG5jZmcuS0VEX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5LRURfQVBJX1VSTDsgLy8gXCJodHRwczovL2tlZGJhY2tlbmR0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxuY2ZnLkVEU19BUElfVVJMID0gcHJvY2Vzcy5lbnYuRURTX0FQSV9VUkw7IC8vIFwiaHR0cHM6Ly9lZHNwb3J0YWxvd2luYXBpLmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxuY2ZnLktFRF9UT0tFTl9VUkwgPSBwcm9jZXNzLmVudi5LRURfVE9LRU5fVVJMOyAvLyBcImh0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW5cIlxuY2ZnLktFRF9DTElFTlRfSUQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX0lEOyAvLyBcImRldmNsaWVudFwiLCBcInRlc3RjbGllbnRcIiwgXCIuLi5cIlxuY2ZnLktFRF9DTElFTlRfU0VDUkVUID0gcHJvY2Vzcy5lbnYuS0VEX0NMSUVOVF9TRUNSRVQ7XG5jZmcuS0VEX1JFQUxNID0gcHJvY2Vzcy5lbnYuS0VEX1JFQUxNOyAvLyBcIlNFMVwiXG5jZmcuS0VEX0xPQ0FMRSA9IGNmZy5LRURfTE9DQUxFIHx8IHByb2Nlc3MuZW52LktFRF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlblwiLiBPbmx5IHNldCBmcm9tIHByb2Nlc3MuZW52IGlmIG5vdCBzZXQgZnJvbSBTaXRlVmlzaW9uIGVsZW1lbnQgY29uZmlnLlxuY2ZnLktFRF9TQ0hPT0xfTE9DQUxFID0gY2ZnLktFRF9TQ0hPT0xfTE9DQUxFIHx8IHByb2Nlc3MuZW52LktFRF9TQ0hPT0xfTE9DQUxFOyAvLyBcInN2XCIsIFwiZW5fc2luXCIsIFwiZW5fbmluXCIuIE9ubHkgc2V0IGZyb20gcHJvY2Vzcy5lbnYgaWYgbm90IHNldCBmcm9tIFNpdGVWaXNpb24gZWxlbWVudCBjb25maWcuXG5jZmcuS0VEX1JFU09VUkNFU19VUkwgPSBjZmcuS0VEX1JFU09VUkNFU19VUkwgfHwgcHJvY2Vzcy5lbnYuS0VEX1JFU09VUkNFU19VUkw7XG4iLCIvKiBUaGVzZSBzY3JpcHRzIGFzc3VtZSBzb21lIG9mIHRoZSBnbG9iYWwgdmFycyBoYXZlIGFscmVhZHkgYmVlbiBzZXQ6XG4gICogS0VELmNmZ1xuICAqIEtFRC5lbnYuY3VycmVudFVzZXJcblxuICBUaGUgcmVzdCB3aWxsIGJlIHNldCBoZXJlIChjbGllbnQgc2lkZSlcbiovXG5pbXBvcnQgJy4vY29uZmlndXJlJztcbmltcG9ydCAnLi9zZXQtYmVhcmVyLXByb3ZpZGVycyc7XG5pbXBvcnQgJy4vc2V0LWtlZC1iYWNrZW5kLWNsaWVudCc7XG5pbXBvcnQgJy4vc2V0LWVkcy1jbGllbnQnO1xuIiwiaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZywgc3BsaXRVcmxBbmRRdWVyeSB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIsIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLCBpc29tb3JwaGljLCBzdG9yYWdlIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuaW1wb3J0IHsgQmVhcmVyUHJvdmlkZXIsIEtlZEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9jb250cmFjdHMva2VkLW1vZGVsc1wiO1xuaW1wb3J0IHsgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMgfSBmcm9tIFwiLi4vYWNjZXNzLWNvbnRyb2wvaW5kZXhcIjtcbmltcG9ydCB7IGNoZXJyeVBpY2tQcm9wcyB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuXG5mdW5jdGlvbiBnZXRNZXJnZWRUb2tlblBhdGgodG9rZW5QYXRoOiBzdHJpbmcsIGxvY2F0aW9uU2VhcmNoOiBzdHJpbmcsIHNjb3Blczogc3RyaW5nW10pIHtcbiAgLy8gTWVyZ2UgY29uZmlndXJlZCBxdWVyeSBwYXJhbXMgb2YgdG9rZW4gcGF0aCB3aXRoIHBhcmFtcyBnaXZlbiB0byBjdXJyZW50IHBhZ2VcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaCk7XG4gIGNvbnN0IGltcGVyc29uYXRpb25Qcm9wcyA9IGNoZXJyeVBpY2tQcm9wcyhjdXJyZW50UXVlcnksIElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TKTtcbiAgY29uc3QgW3Rva2VuUGF0aFdpdGhvdXRRdWVyeSwgdG9rZW5RdWVyeVN0cmluZ10gPSBzcGxpdFVybEFuZFF1ZXJ5KHRva2VuUGF0aCk7XG4gIGNvbnN0IHRva2VuUGF0aFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyh0b2tlblF1ZXJ5U3RyaW5nKTtcbiAgcmV0dXJuIHRva2VuUGF0aFdpdGhvdXRRdWVyeSArIGdlbmVyYXRlUXVlcnlTdHJpbmcoe1xuICAgIC4uLnRva2VuUGF0aFF1ZXJ5LFxuICAgIC4uLmltcGVyc29uYXRpb25Qcm9wcyxcbiAgICBzY29wZXM6IHNjb3Blcy5qb2luKCcsJylcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldFRva2VuSWQobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIHJldHVybiBtZXJnZWRUb2tlblBhdGggKyBcIi9cIiArIHVzZXJFbWFpbDtcbn1cblxuZnVuY3Rpb24gc2F2ZVVzZXJJbmZvKHVzZXI6IFVzZXIsIHRva2VuSWQ6IHN0cmluZykge1xuICBlbnYuY3VycmVudFVzZXIgPSB1c2VyO1xuICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwidXNlckluZm9cIiArIHRva2VuSWQsIEpTT04uc3RyaW5naWZ5KHVzZXIpKTtcbn1cblxuZnVuY3Rpb24gbG9hZFVzZXJJbmZvKHRva2VuSWQ6IHN0cmluZykge1xuICBjb25zdCBzdG9yZWRTZXNzaW9uVXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCk7XG4gIGlmIChzdG9yZWRTZXNzaW9uVXNlcikge1xuICAgIGVudi5jdXJyZW50VXNlciA9IEpTT04ucGFyc2Uoc3RvcmVkU2Vzc2lvblVzZXIpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xuICBjb25zdCB0b2tlbklkID0gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIHVzZXJFbWFpbCk7XG4gIHJldHVybiBuZXcgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoLCByZXNwb25zZVRleHQgPT4ge1xuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XG4gICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihyZXMuZXJyb3IpO1xuICAgIGlmIChyZXMudXNlcikge1xuICAgICAgc2F2ZVVzZXJJbmZvKHJlcy51c2VyLCB0b2tlbklkKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgdG9rZW46IHJlcy50b2tlbiwgZXhwaXJlczogRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwIH07XG4gIH0sIHRva2VuSWQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVHb29nbGVUb2tlblByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xuICBjb25zdCB0b2tlbklkID0gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIHVzZXJFbWFpbCk7XG4gIHJldHVybiBuZXcgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoLCByZXNwb25zZVRleHQgPT4ge1xuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XG4gICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihyZXMuZXJyb3IpO1xuICAgIHJldHVybiB7IHRva2VuOiByZXMudG9rZW4sIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogMTAwMCB9O1xuICB9LCB0b2tlbklkKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIodG9rZW5Vcmw6IHN0cmluZywgdXNlcjogVXNlciwgc2NvcGVzOiBzdHJpbmdbXSkge1xuICByZXR1cm4gbmV3IEtlZEJlYXJlclByb3ZpZGVyKFxuICAgIGlzb21vcnBoaWMsXG4gICAgc3RvcmFnZSxcbiAgICB0b2tlblVybCArIHVzZXIubWFpbCArIGxvY2F0aW9uLnNlYXJjaCxcbiAgICBjZmcuS0VEX0NMSUVOVF9JRCxcbiAgICBjZmcuS0VEX0NMSUVOVF9TRUNSRVQsXG4gICAgdG9rZW5VcmwsIHtcbiAgICAgIGVtYWlsOiB1c2VyLm1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgc2Nob29sOiB1c2VyLnNjaG9vbCxcbiAgICAgIHNjaG9vbFR5cGU6IHVzZXIuc2Nob29sVHlwZSxcbiAgICAgIHNjb3Blc1xuICAgIH0pO1xufVxuXG4vLyBlbnYuY3VycmVudFVzZXIubWFpbCBpcyBzZXQgYnkgU2l0ZVZpc2lvbiBzZXJ2ZXIgaW5pdGlhbGx5LlxuLy8gQSByZXNwb25zZSBmcm9tIC9hcGkvdG9rZW4gbWF5IGNoYW5nZSB0aGUgbWFpbCBhdHRyaWJ1dGUgb2YgdGhlIGN1cnJlbnRcbi8vIHVzZXIsIHNvIGVudi5jdXJyZW50VXNlci5tYWlsIG1heSBiZSBkaWZmZXJlbnQgYWZ0ZXIgZ2V0dGluZyBhIHJlc3BvbnNlLlxuLy8gSG93ZXZlciwgdGhlIGluaXRpYWwgdmFsdWUgaXMgdmFsdWFibGUgYWx3YXlzIGluIG9yZGVyIHRvIGRpc3Rpbmd1aXNoIHRoZSBjYXNlXG4vLyB3aGVuIG9uZSBub3JtYWwgdXNlciBsb2dzIG91dCBhbmQgYW5vdGhlciB1c2VyIGxvZ3MgaW4uXG5jb25zdCBpbml0aWFsVXNlckVtYWlsID0gZW52LmN1cnJlbnRVc2VyICYmIGVudi5jdXJyZW50VXNlci5tYWlsOyAvLyBJbml0aWFsIHZhbHVlIG9mIG1haWwuIE1heSBjaGFuZ2UuXG5pZiAoaW5pdGlhbFVzZXJFbWFpbCkge1xuICAvLyBLRURcbiAgaWYgKGNmZy5LRURfVE9LRU5fUEFUSCkge1xuICAgIC8vXG4gICAgLy9cbiAgICAvLyBQcm9kdWN0aW9uIC8gU2l0ZVZpc2lvbiBwcm94aWVkIC9hcGkvdG9rZW4gdG8gcmVxdWVzdCB0b2tlbnMgZnJvbTpcbiAgICAvL1xuICAgIC8vXG4gICAgY29uc3QgbWVyZ2VkVG9rZW5QYXRoID0gZ2V0TWVyZ2VkVG9rZW5QYXRoKFxuICAgICAgY2ZnLktFRF9UT0tFTl9QQVRILFxuICAgICAgbG9jYXRpb24uc2VhcmNoLCBbXG4gICAgICAgIFwia2VkYmFja2VuZFwiLFxuICAgICAgICBcIkVEU1wiLFxuICAgICAgXSk7XG4gICAgZW52LmJlYXJlclByb3ZpZGVyID0gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcbiAgICBsb2FkVXNlckluZm8oZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIGluaXRpYWxVc2VyRW1haWwpKTtcblxuICAgIC8vIEdvb2dsZVxuICAgIGNvbnN0IGdvb2dsZU1lcmdlZFBhdGggPSBnZXRNZXJnZWRUb2tlblBhdGgoXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcbiAgICAgICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLnJlYWRvbmx5XCIsXG4gICAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZVwiXG4gICAgICBdKTtcbiAgICBlbnYuZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGNyZWF0ZUdvb2dsZVRva2VuUHJvdmlkZXIoZ29vZ2xlTWVyZ2VkUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCk7XG4gIH0gZWxzZSBpZiAoY2ZnLktFRF9UT0tFTl9VUkwgJiYgY2ZnLktFRF9DTElFTlRfSUQgJiYgY2ZnLktFRF9DTElFTlRfU0VDUkVUKSB7XG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFRlc3QgLSBnbyBkaXJlY3RseSB0byBLRURBVVRIIHNlcnZlciB0byByZXRyaWV2ZSB0b2tlbnNcbiAgICAvL1xuICAgIC8vXG4gICAgZW52LmJlYXJlclByb3ZpZGVyID0gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIoY2ZnLktFRF9UT0tFTl9VUkwsIGVudi5jdXJyZW50VXNlciwgW1xuICAgICAgXCJrZWRiYWNrZW5kXCIsXG4gICAgICBcIkVEU1wiLFxuICAgIF0pO1xuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIoY2ZnLktFRF9UT0tFTl9VUkwgKyBcIi9nb29nbGVcIiwgZW52LmN1cnJlbnRVc2VyLCBbXG4gICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcbiAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZVwiXG4gICAgXSk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVyIEtFRF9UT0tFTl9QQVRIYCk7XG4gIH1cbn1cbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcbmltcG9ydCB7IGlzb21vcnBoaWMgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XG5pbXBvcnQgeyBFZHNDbGllbnQgfSBmcm9tICcuLi9hcGlzL2Vkc2NsaWVudCc7XG5cbmVudi5lZHNDbGllbnQgPSBuZXcgRWRzQ2xpZW50IChcbiAgaXNvbW9ycGhpYyxcbiAgY2ZnLkVEU19BUElfVVJMLFxuICBlbnYuYmVhcmVyUHJvdmlkZXIsXG4gICgpPT5lbnYuY3VycmVudFVzZXIubWFpbCk7XG5cbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XG5cbmVudi5rZWRCYWNrZW5kQ2xpZW50ID0gbmV3IEtlZEJhY2tlbmRDbGllbnRXZWIgKFxuICBjZmcuS0VEX0FQSV9VUkwsXG4gIGVudi5iZWFyZXJQcm92aWRlcik7XG5cbiIsImltcG9ydCBLRUQgZnJvbSAnLi9LRUQnO1xuXG4vKiBUaGlzIGRlZmF1bHQgY29uZmlndXJhdGlvbiBpcyB1c2VkIGFzIGEgZmFsbGJhY2suXG5Ob3JtYWxseSBib3RoIHRlc3QgcGFnZXMgYW5kIHByb2R1Y3Rpb24gcGFnZXMgd2lsbCBvdmVycmlkZSB0aGVzZSBjb25maWdyYXRpb25zXG4qL1xuLypjb25zdCBkZWZhdWx0Q29uZmlndXJhdGlvbiA9IHtcbiAgLy8gRW52aXJvbm1lbnRcbiAgRU5WSVJPTk1FTlQ6ICdkZXZlbG9wbWVudCcgYXMgJ3Byb2R1Y3Rpb24nIHwgJ2RldmVsb3BtZW50JyB8ICd0ZXN0JyxcbiAgLy8gQXV0aGVudGljYXRpb24gU2VydmVyOlxuICBLRURfVE9LRU5fVVJMOiAnaHR0cHM6Ly9rZWRhdXRodGVzdC5henVyZXdlYnNpdGVzLm5ldC90b2tlbicsXG4gIEtFRF9UT0tFTl9QQVRIOiAnL2FwaS90b2tlbi5Ta3JpcHQucG9ydGxldD9zdi5jb250ZW50dHlwZT1hcHBsaWNhdGlvbi9qc29uJyxcbiAgS0VEX0NMSUVOVF9JRDogJ2RldmNsaWVudCcsXG4gIEtFRF9DTElFTlRfU0VDUkVUOiAnNGZSZGZRcFd0SnFqVFdmJyxcbiAgLy8gU2VydmljZXM6XG4gIEtFRF9BUElfVVJMOiAnaHR0cHM6Ly9rZWRiYWNrZW5kdGVzdC5henVyZXdlYnNpdGVzLm5ldC9hcGkvJywgIFxuICBFRFNfQVBJX1VSTDogJ2h0dHBzOi8vZWRzcG9ydGFsb3dpbmFwaS5henVyZXdlYnNpdGVzLm5ldC9hcGkvJ1xufSovXG5cbmV4cG9ydCBpbnRlcmZhY2UgSUtlZENvbmZpZ3VyYXRpb24ge1xuICBFTlZJUk9OTUVOVDogJ3Byb2R1Y3Rpb24nIHwgJ2RldmVsb3BtZW50JyB8ICd0ZXN0JztcbiAgS0VEX1JFQUxNOiBzdHJpbmc7XG4gIEtFRF9UT0tFTl9VUkw6IHN0cmluZztcbiAgS0VEX1RPS0VOX1BBVEg6IHN0cmluZztcbiAgS0VEX0NMSUVOVF9JRDogc3RyaW5nO1xuICBLRURfQ0xJRU5UX1NFQ1JFVDogc3RyaW5nO1xuICBLRURfQVBJX1VSTDogc3RyaW5nO1xuICBFRFNfQVBJX1VSTDogc3RyaW5nO1xuICBLRURfTE9DQUxFOiBzdHJpbmc7XG4gIEtFRF9TQ0hPT0xfTE9DQUxFOiBzdHJpbmc7XG4gIEtFRF9DT1VSU0VfQlVJTERFUl9VUkw6IHN0cmluZztcbiAgS0VEX0NPVVJTRV9WSUVXRVJfVVJMOiBzdHJpbmc7XG4gIEtFRF9TVUJKRUNUX1BMQU5ORVJfQURNSU5fVVJMOiBzdHJpbmc7XG4gIEtFRF9TVUJKRUNUX1BMQU5ORVJfVVJMOiBzdHJpbmc7XG4gIEtFRF9GRUFUVVJFUzogc3RyaW5nO1xuICBLRURfS0VFUF9BTElWRV9VUkw6IHN0cmluZztcbiAgS0VEX0VOVU1fV09SREJBTktTX1VSTDogc3RyaW5nO1xuICBLRURfV09SREJBTktTX1VSTDogc3RyaW5nO1xuICBLRURfUkVTT1VSQ0VTX1VSTDogc3RyaW5nO1xufTtcblxuaWYgKCFLRUQuY2ZnKSBLRUQuY2ZnID0ge307XG5cbmV4cG9ydCBkZWZhdWx0IEtFRC5jZmcgYXMgSUtlZENvbmZpZ3VyYXRpb247XG5leHBvcnQgY29uc3QgY2ZnOiBJS2VkQ29uZmlndXJhdGlvbiA9IEtFRC5jZmc7XG4iLCJpbXBvcnQge1VzZXIsIExlYXJuaW5nTW9kdWxlVGFza3N9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHtVc2VyVGFza30gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHtLZWRSZXBvfSBmcm9tICcuLi9yZXBvcy9rZWQtcmVwbyc7XG5pbXBvcnQge0Vkc0NsaWVudH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuaW1wb3J0IEtFRCBmcm9tICcuL2tlZCc7XG5pbXBvcnQgeyBLU1Rlcm1QbGFubmVyUmVwbyB9IGZyb20gJy4uL3JlcG9zL2tzLXRlcm1wbGFubmVyLXJlcG8nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEVudiB7XG4gICAgY3VycmVudFVzZXI/OiBVc2VyO1xuICAgIGxlYXJuaW5nTW9kdWxlVGFza3M/OiBMZWFybmluZ01vZHVsZVRhc2tzO1xuICAgIGJlYXJlclByb3ZpZGVyPzogQmVhcmVyUHJvdmlkZXI7XG4gICAgZ29vZ2xlVG9rZW5Qcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xuICAgIGtlZEJhY2tlbmRDbGllbnQ/OiBLZWRCYWNrZW5kQ2xpZW50O1xuICAgIGVkc0NsaWVudD86IEVkc0NsaWVudDtcbiAgICB1c2VyVGFza3NSZXBvPztcbiAgICBoaWRkZW5Db3Vyc2VzUmVwbz87XG4gICAgd2Vla05vdGVzUmVwbz87XG4gICAga2dUZXJtUGxhbm5lclJlcG8/O1xuICAgIGtzVGVybVBsYW5uZXJSZXBvPzogS1NUZXJtUGxhbm5lclJlcG9cbiAgICB0dXRvcmVkOiBib29sZWFuO1xuICAgIGVycm9yPzogRXJyb3I7XG59XG5cbmlmICghS0VELmVudikgS0VELmVudiA9IHt9O1xuXG5leHBvcnQgZGVmYXVsdCBLRUQuZW52IGFzIEVudjtcbmV4cG9ydCBjb25zdCBlbnY6IEVudiA9IEtFRC5lbnY7XG4iLCJcbmV4cG9ydCBjb25zdCBLRURfTkFNRVNQQUNFID0gXCJLRURcIjtcblxuZGVjbGFyZSB2YXIgS0VEOiBhbnk7XG5cbnZhciByZXN1bHQgPSB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJyA/IHt9IDogS0VEO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3dbS0VEX05BTUVTUEFDRV0gPSByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlc3VsdDtcbiIsImltcG9ydCBlbnYgZnJvbSAnLi9LRUQuZW52JztcbmltcG9ydCB7IEtlZEJhY2tlbmRSZXBvIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcbmltcG9ydCB7IGdldEdsb2JhbElkLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IGNmZyBmcm9tICcuL0tFRC5jZmcnO1xuaW1wb3J0IHsgU2Nob29sLCBCcmFuY2ggfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XG5cbmV4cG9ydCBjb25zdCBkYiA9IG5ldyBLZWRCYWNrZW5kUmVwbyhcbiAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxuICAoKT0+ZW52LmN1cnJlbnRVc2VyID9cbiAgICBlbnYuY3VycmVudFVzZXIubWFpbCA6XG4gICAgXCJcIixcbiAgKCk9PmVudi5jdXJyZW50VXNlciA/XG4gICAgZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lIHx8IGVudi5jdXJyZW50VXNlci5tYWlsIDpcbiAgICBcIlwiKTtcblxuZXhwb3J0IGNvbnN0IGdsb2JhbElkID0gZ2V0R2xvYmFsSWQoY2ZnLktFRF9SRUFMTSk7XG5leHBvcnQgY29uc3QgU2Nob29scyA9IHtcbiAgc3RhbmRhcmRTY2hvb2w6IGRiLnNjaG9vbHMubmFtZShcInN0YW5kYXJkXCIpLmNhY2hlT3B0aW1pemVkKCkuc2luZ2xlKCksXG4gIGdldCBteVNjaG9vbCAoKSB7IHJldHVybiBkYi5zY2hvb2xzLm5hbWUoZW52LmN1cnJlbnRVc2VyLnNjaG9vbCkuY2FjaGVPcHRpbWl6ZWQoKS5zaW5nbGUoKTsgfVxufTtcbmV4cG9ydCBjb25zdCBDb3Vyc2VJbnN0YW5jZXMgPSB7XG4gIGdldEJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PlxuICAgICAgZGIuYnJhbmNoZXNcbiAgICAgICAgLmhhc0VkZ2VzRnJvbShbc2Nob29sLm9mZmljaWFsQnJhbmNoSWRdKVxuICAgICAgICAubmFtZShcImRyYWZ0XCIpXG4gICAgICAgIC50YWdzKGNvdXJzZUlkKVxuICAgICAgICAuaWRzT25seSgpXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKVxuICAgICAgICAudG9WYWx1ZSgpXG4gICAgICAgIC5tYXAoaWRzID0+IGlkcy5sZW5ndGggPiAwID8gaWRzWzBdIDogdW5kZWZpbmVkKSk7XG4gIH0sXG5cbiAgLyoqIEdldCBhIERSQUZUIGJyYW5jaCBmb3IgZ2l2ZW4gY291cnNlIElEIGFuZCBnaXZlbiBzY2hvb2wuXG4gICAqIElmIHRoZXJlIGlzIG5vdCB5ZXQgc3VjaCBhIGJyYW5jaCwgY3JlYXRlIGl0IHVzaW5nIG11dGF0aW9uc09uRW1wdHkoKSB3aGljaCB3aWxsXG4gICAqIGxlYWQgdG8gdGhlIEMjIGNvZGUgRG9jdW1lbnRSZXBvc2l0b3J5LlJlYWRPck11dGF0ZSgpIHZpYSBEb2N1bWVudENvbnRyb2xsZXIuXG4gICAqL1xuICBnZXRPckNyZWF0ZUJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBkYi5jb3Vyc2VJbnN0YW5jZXMuaWRzT25seSgpLmlkKGNvdXJzZUlkKS5zd2l0Y2hNYXAoKCk9PiAvLyBUSGlzIGZpcnN0IGxpbmUgdmVyaWZpZXMgY291cnNlIGV4aXN0cy4gSWYgZGVsZXRlZCwgZG9uJ3QgdHJ5IHRvIHJlY3JlYXRlIGl0cyBicmFuY2ghXG4gICAgICBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PiBcbiAgICAgIGRiLmJyYW5jaGVzXG4gICAgICAgIC5oYXNFZGdlc0Zyb20oW3NjaG9vbC5vZmZpY2lhbEJyYW5jaElkXSlcbiAgICAgICAgLm5hbWUoXCJkcmFmdFwiKVxuICAgICAgICAudGFncyhjb3Vyc2VJZClcbiAgICAgICAgLmlkc09ubHkoKVxuICAgICAgICAubXV0YXRpb25zT25FbXB0eSh0eCA9PiB7XG4gICAgICAgICAgLy8gVGhlc2UgMiBtdXRhdGlvbnMgd2lsbCBvY2N1ciBzZXJ2ZXIgc2lkZSwgYXRvbWljYWxseS5cbiAgICAgICAgICAvLyBXaWxsIGJlIHNlbnQgb24gZWFjaCByZXF1ZXN0IGluIHRoZSBxdWVyeSwgYnV0IHdpbGwgb25seSBleGVjdXRlIGlmIHF1ZXJ5IHJlc3VsdHMgaW4gemVybyBpdGVtcy5cbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU2Nob29sOlwiLCBzY2hvb2wpO1xuICAgICAgICAgIGNvbnN0IGlkID0gY3JlYXRlVVVJRCgpO1xuICAgICAgICAgIHR4LmFkZChcImJyYW5jaGVzXCIsIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgYWNsOiBbXG4gICAgICAgICAgICAgIFwicm9sZTpVU0VSOlJcIixcbiAgICAgICAgICAgICAgYHNjaG9vbFJvbGU6JHtzY2hvb2wubmFtZX0vRU1QTE9ZRUU6U2BcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBuYW1lOiAnZHJhZnQnLFxuICAgICAgICAgICAgc2Nob29sSWQ6IHNjaG9vbC5pZCxcbiAgICAgICAgICAgIHRyZWVQYXJlbnRJZDogc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsXG4gICAgICAgICAgICB0YWdzOiBbY291cnNlSWRdXG4gICAgICAgICAgfSBhcyBCcmFuY2gpO1xuICAgICAgICAgIC8vIEFwcHJvdmluZyB0aGUgYnJhbmNoIG1ha2VzIHN1cmUgdGhhdCBpdCB3YXMgY3JlYXRlZCBieSBhbiBFTVBMT1lFRSBvbiBnaXZlbiBzY2hvb2wuXG4gICAgICAgICAgdHgubGluazIoXCJicmFuY2hlc1wiLCBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCwgXCJhcHByb3ZlZENoaWxkcmVuXCIsIGlkKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKSkpO1xuICB9LFxuXG4gIGdldEFsbERlc2NlbmRhbnRJZHMoY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBkYi5jb3Vyc2VCbG9ja3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpLmNvbmNhdChcbiAgICAgIGRiLmNvdXJzZUNvbnRlbnRzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSkuY29uY2F0KFxuICAgICAgZGIuY291cnNlVGFicy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpLmNvbmNhdChcbiAgICAgIGRiLnRhc2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSlcbiAgICAgIC5tYXAoeCA9PiB4LmlkKTtcbiAgfVxufVxuIiwiXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XG5cbmRlY2xhcmUgdmFyIEtFRDogYW55O1xuXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge0x9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtkYn0gZnJvbSAnLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcblxuXG5pbnRlcmZhY2UgUHJvcHMge1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBlcnJvcnM6IEVycm9yU3RydWN0W107XG4gIGluZm9zOiBzdHJpbmdbXTtcbiAgLy9kYldyaXRlclJldHJ5YWJsZUVycm9yPzogRXJyb3I7XG4gIGRiV3JpdGVySXNTYXZpbmc/OiBib29sZWFuO1xuICBkYldyaXRlcklzRWRpdGVkPzogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIEVycm9yU3RydWN0IHtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICByZXRyeWFibGU/OiBib29sZWFuO1xuICBkZXRhaWxzPzogRXJyb3I7XG4gIHNob3dEZXRhaWxzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEVycm9yU3VjY2Vzc0ZlZWRiYWNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZT17XG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaW5mb3M6IFtdXG4gICAgfTtcbiAgICB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24gPSB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9lcnJvciA9IHRoaXMuX2Vycm9yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY3VzdG9tRXJyb3IgPSB0aGlzLl9jdXN0b21FcnJvci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uSW5mbyA9IHRoaXMuX29uSW5mby5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2RiV3JpdGVyRXJyb3IgPSB0aGlzLl9kYldyaXRlckVycm9yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQgPSB0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgcHJpdmF0ZSBfYWRkRXJyb3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogRXJyb3IsIHJldHJ5YWJsZT86IGJvb2xlYW4pIHtcbiAgICAvL2NvbnNvbGUuZXJyb3IobWVzc2FnZSwge3JldHJ5YWJsZTogISFyZXRyeWFibGUsIGRldGFpbHN9KTtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4ge1xuICAgICAgaWYgKGVycm9ycy5zb21lKGUgPT4gZS5tZXNzYWdlID09PSBtZXNzYWdlKSkgcmV0dXJuIHtlcnJvcnN9O1xuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAyKSBlcnJvcnMgPSBlcnJvcnMuc2xpY2UoMSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnJvcnM6IGVycm9ycy5jb25jYXQoW3ttZXNzYWdlLCBkZXRhaWxzLCByZXRyeWFibGV9XSlcbiAgICAgIH07XG4gICAgfSk7XG4gICAgLy8gUmVtb3ZlIG5vbi1yZXRyeWFibGUgZXJyb3JzIGFmdGVyIDMwIHNlY29uZHM6XG4gICAgaWYgKCFyZXRyeWFibGUpIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiAoe1xuICAgICAgICBlcnJvcnM6IGVycm9ycy5maWx0ZXIoZSA9PiBlLm1lc3NhZ2UgIT09IG1lc3NhZ2UpXG4gICAgICB9KSk7XG4gICAgfSwgMzAwMDApO1xuICB9XG5cbiAgcHJpdmF0ZSBfYWRkSW5mbyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBpZiAobWVzc2FnZSA9PT0gXCJcIikge1xuICAgICAgLy8gVHVybiBvZmYgY3VycmVudCBpbmZvIG1lc3NhZ2VzXG4gICAgICB0aGlzLnNldFN0YXRlKHtpbmZvczogW119KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSgoe2luZm9zfSkgPT4ge1xuICAgICAgaWYgKGluZm9zLnNvbWUoaW5mbyA9PiBpbmZvID09PSBtZXNzYWdlKSkgcmV0dXJuIHtpbmZvc307XG4gICAgICBpZiAoaW5mb3MubGVuZ3RoID4gMSkgaW5mb3MgPSBpbmZvcy5zbGljZSgxKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZm9zOiBbbWVzc2FnZV0gLy8gd2FzOiBpbmZvcy5jb25jYXQobWVzc2FnZSkuIEJ1dCBpdCBzdWNrcyFcbiAgICAgIH07XG4gICAgfSk7XG4gICAgLy8gUmVtb3ZlIGluZm8gbWVzc2FnZSBhZnRlciAxMCBzZWNvbmRzOlxuICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtpbmZvc30pID0+ICh7XG4gICAgICAgIGluZm9zOiBpbmZvcy5maWx0ZXIobXNnID0+IG1zZyAhPT0gbWVzc2FnZSlcbiAgICAgIH0pKTtcbiAgICB9LCAxMDAwMCk7XG4gIH1cblxuICBwcml2YXRlIF9kYldyaXRlckVycm9yIChlcnJvcjogRXJyb3IsIHJldHJ5YWJsZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2FkZEVycm9yKGBEZXQgZ8OlciBpbnRlIGF0dCBzcGFyYSB0aWxsIHNlcnZlcm5gLCBlcnJvciwgcmV0cnlhYmxlKTtcbiAgfVxuXG4gIHByaXZhdGUgX2RiV3JpdGVyU3RhdGVDaGFuZ2VkICh7aXNFZGl0ZWQsIGlzU2F2aW5nfTogS2VkQmFja2VuZFdyaXRlcikge1xuICAgIGlmICghaXNFZGl0ZWQpIHtcbiAgICAgIC8vIElmIGlzRWRpdGVkIGlzIGZhbHNlLCBhIHN1Y2Nlc3NmdWwgd3JpdGUgbXVzdCBoYXZlIGhhcHBlbmVkLCBhbmRcbiAgICAgIC8vIHRoZXJlIGNhbm5vdCBiZSBhbnkgcmV0cnlhYmxlIGVycm9yIGFueW1vcmVcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiB7XG4gICAgICAgIGVycm9ycyA9IGVycm9ycy5maWx0ZXIoZSA9PiAhZS5yZXRyeWFibGUpO1xuICAgICAgICByZXR1cm4ge2Vycm9yc307XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBkYldyaXRlcklzRWRpdGVkOiBpc0VkaXRlZCxcbiAgICAgIGRiV3JpdGVySXNTYXZpbmc6IGlzU2F2aW5nXG4gICAgfSk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcbiAgICBkYi53cml0ZXIub25FcnJvcih0aGlzLl9kYldyaXRlckVycm9yKTtcbiAgICBkYi53cml0ZXIub25TdGF0ZUNoYW5nZSh0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcbiAgICBkYi53cml0ZXIub2ZmKHRoaXMuX2RiV3JpdGVyRXJyb3IpO1xuICAgIGRiLndyaXRlci5vZmYodGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQpO1xuICB9XG5cbiAgX3VuaGFuZGxlZFJlamVjdGlvbiAoZXY6IEV2ZW50ICYge3JlYXNvbjogRXJyb3J9KSB7XG4gICAgdGhpcy5fYWRkRXJyb3IoYEV0dCBva8OkbnQgZmVsIGludHLDpGZmYWRlLi4uYCwgZXYucmVhc29uKTtcbiAgfVxuXG4gIF9lcnJvciAoZXY6IEV2ZW50ICYge2Vycm9yOiBFcnJvcn0pIHtcbiAgICB0aGlzLl9hZGRFcnJvcihldi5lcnJvciA/IGV2LmVycm9yLm1lc3NhZ2UgOiBgRXR0IG9rw6RudCBmZWwgaW50csOkZmZhZGUuLi5gLCBldi5lcnJvcik7XG4gIH1cblxuICBfY3VzdG9tRXJyb3IgKGV2OiBDdXN0b21FdmVudCkge1xuICAgIHRoaXMuX2FkZEVycm9yKGV2LmRldGFpbCk7XG4gIH1cblxuICBfb25JbmZvKGV2OiBDdXN0b21FdmVudCkge1xuICAgIHRoaXMuX2FkZEluZm8oZXYuZGV0YWlsKTtcbiAgfSBcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2Vycm9ycywgaW5mb3MsIGRiV3JpdGVySXNTYXZpbmd9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJlcnJvci1zdWNjZXNzLWZlZWRiYWNrXCIgc3R5bGU9e3tcbiAgICAgIHBvc2l0aW9uOiBcImZpeGVkXCIsXG4gICAgICBsZWZ0OiAwLFxuICAgICAgdG9wOiAwLFxuICAgICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnXG4gICAgfX0+XG4gICAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogJ3RhYmxlJywgbWFyZ2luOiBcIjAgYXV0b1wifX0+XG4gICAgICAgIHtlcnJvcnMuZmlsdGVyKGUgPT4gIWUucmV0cnlhYmxlIHx8ICFkYldyaXRlcklzU2F2aW5nKVxuICAgICAgICAubWFwKCh7bWVzc2FnZSwgZGV0YWlscywgcmV0cnlhYmxlLCBzaG93RGV0YWlsc30pID0+IChcbiAgICAgICAgICA8ZGl2IGtleT17bWVzc2FnZX0gY2xhc3NOYW1lPVwiZXJyb3JcIj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbG9hdDonbGVmdCd9fT57bWVzc2FnZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cbiAgICAgICAgICAgICAgPFJlbW92ZUl0ZW0gb25DbGljaz17KCk9PnRoaXMucmVtb3ZlRXJyb3IobWVzc2FnZSl9IC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHtkZXRhaWxzIHx8IHJldHJ5YWJsZSA/IDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cbiAgICAgICAgICAgICAge2RldGFpbHMgPyA8PjxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnRvZ2dsZURldGFpbHMobWVzc2FnZSl9PntzaG93RGV0YWlscyA/IFwiRMO2bGogZGV0YWlsZXJcIiA6IFwiVmlzYSBkZXRhaWxqZXJcIn08L2E+Jm5ic3A7PC8+IDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgICB7c2hvd0RldGFpbHMgPyA8cD57JycrZGV0YWlsc308L3A+OiA8PiZuYnNwOzwvPn1cbiAgICAgICAgICAgICAge3JldHJ5YWJsZSA/IDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnJldHJ5U2F2ZSgpfT5Gw7Zyc8O2ayBzcGFyYSBudTwvYT4gOiB1bmRlZmluZWR9XG4gICAgICAgICAgICA8L2Rpdj46IHVuZGVmaW5lZH1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICAgIHtpbmZvcy5tYXAobWVzc2FnZSA9PiBcbiAgICAgICAgICA8cCBrZXk9e21lc3NhZ2V9IGNsYXNzTmFtZT1cImluZm9cIj57bWVzc2FnZX08L3A+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG4gIH1cbiAgcmVtb3ZlRXJyb3IobWVzc2FnZTogc3RyaW5nKTogYW55IHtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtcbiAgICAgIGVycm9yczogZXJyb3JzLmZpbHRlcihlID0+IGUubWVzc2FnZSAhPT0gbWVzc2FnZSlcbiAgICB9KSk7XG4gIH1cblxuICByZXRyeVNhdmUoKSB7XG4gICAgZGIud3JpdGVyLnJldHJ5U2F2ZSgpO1xuICB9XG5cbiAgdG9nZ2xlRGV0YWlscyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtlcnJvcnM6IGVycm9ycy5tYXAoZXJyb3IgPT4gZXJyb3IubWVzc2FnZSA9PT0gbWVzc2FnZSA/XG4gICAgICB7XG4gICAgICAgIC4uLmVycm9yLFxuICAgICAgICBzaG93RGV0YWlsczogIWVycm9yLnNob3dEZXRhaWxzXG4gICAgICB9IDpcbiAgICAgIGVycm9yKVxuICAgIH0pKTtcbiAgfVxufVxuIiwiY29uc3QgREVGQVVMVF9DQUNIRV9FWFBJUkFUSU9OID0gMzAgKiA2MCAqIDEwMDA7IC8vIDMwIG1pbnV0ZXMuXG5cbnR5cGUgUHJvbWlzZVJldHVybmluZ01ldGhvZE5hbWVzPEFQST4gPSB7XG4gIFtNRVRIT0QgaW4ga2V5b2YgQVBJXTogQVBJW01FVEhPRF0gZXh0ZW5kcyAoLi4uYXJnczogYW55W10pID0+IFByb21pc2U8YW55PiA/IE1FVEhPRCA6IG5ldmVyXG59XG5cbnR5cGUgQ29udmVydE1ldGhvZFRvU3VzcGVuc2U8Rj4gPSBGIGV4dGVuZHMgKC4uLmFyZ3M6IGluZmVyIEEpID0+IFByb21pc2U8aW5mZXIgUj4gP1xuICAoLi4uYXJnczogQSkgPT4gUiA6XG4gIEY7XG5cbmV4cG9ydCB0eXBlIFN1c3BlbnNlQmFzZWRBUEk8QVBJPiA9IHtcbiAgW01FVEhPRCBpbiBrZXlvZiBQcm9taXNlUmV0dXJuaW5nTWV0aG9kTmFtZXM8QVBJPl06IENvbnZlcnRNZXRob2RUb1N1c3BlbnNlPEFQSVtNRVRIT0RdPlxufVxuXG50eXBlIE9wdGlvbnMgPSB7XG4gIGlzQXBpTWV0aG9kPzogKHByb3A6IHN0cmluZyk9PmJvb2xlYW4sXG4gIGNhY2hlRXhwaXJhdGlvbj86IG51bWJlclxufVxuXG5jb25zdCBkZWZhdWx0T3B0aW9uczogT3B0aW9ucyA9IHtcbiAgaXNBcGlNZXRob2Q6IGYgPT4gdHlwZW9mIGYgPT09ICdmdW5jdGlvbicsXG4gIGNhY2hlRXhwaXJhdGlvbjogREVGQVVMVF9DQUNIRV9FWFBJUkFUSU9OXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gbWFrZVN1c3BlbnNlQXBpPEFQST4oYXBpOiBBUEksIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucyk6IFN1c3BlbnNlQmFzZWRBUEk8QVBJPlxue1xuICBvcHRpb25zID0gey4uLmRlZmF1bHRPcHRpb25zLCAuLi5vcHRpb25zfTtcbiAgY29uc3Qge2lzQXBpTWV0aG9kLCBjYWNoZUV4cGlyYXRpb259ID0gb3B0aW9ucztcblxuICBjb25zdCBydjogU3VzcGVuc2VCYXNlZEFQSTxBUEk+ID0gT2JqZWN0LmNyZWF0ZShhcGkgYXMgYW55KSBhcyBTdXNwZW5zZUJhc2VkQVBJPEFQST47XG4gIGNvbnN0IGNhY2hlOiB7W2tleTogc3RyaW5nXToge3RpbWVvdXQ6IG51bWJlciwgdmFsdWU/OiBhbnksIGVycm9yPzogYW55LCBwcm9taXNlPzogUHJvbWlzZTxhbnk+fX0gPSB7fTtcblxuICAvLyBXYWxrIHRoZSBpbnN0YW5jZSArIHByb3RvdHlwZSBjaGFpbiB0byBnZW5lcmF0ZSBzdXNwZW5zZSB2ZXJzaW9uIG9mIGVhY2ggcHJvbWlzZSByZXR1cm5pbmcgbWV0aG9kXG4gIGZvciAobGV0IHByb3RvID0gYXBpOyBwcm90byAmJiBwcm90byAhPT0gT2JqZWN0LnByb3RvdHlwZTsgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG8pKSB7XG4gICAgc3VzcGVuZGlmeShwcm90byk7XG4gIH1cblxuICBmdW5jdGlvbiBzdXNwZW5kaWZ5KHByb3RvKSB7XG4gICAgT2JqZWN0LmtleXMocHJvdG8pLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICBpZiAoIXJ2Lmhhc093blByb3BlcnR5KHByb3ApICYmIGlzQXBpTWV0aG9kKHByb3ApKSB7XG4gICAgICAgIHJ2W3Byb3BdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBKU09OLnN0cmluZ2lmeShbcHJvcCwgLi4uYXJnc10pO1xuICAgICAgICAgIGNvbnN0IGNhY2hlZEVudHJ5ID0gY2FjaGVba2V5XTtcbiAgICAgICAgICBpZiAoY2FjaGVkRW50cnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LnByb21pc2UpIHRocm93IGNhY2hlZEVudHJ5LnByb21pc2U7XG4gICAgICAgICAgICBpZiAoY2FjaGVkRW50cnkuZXJyb3IpIHRocm93IGNhY2hlZEVudHJ5LmVycm9yO1xuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LnRpbWVvdXQgPiBEYXRlLm5vdygpKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjYWNoZWRFbnRyeS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBwcm90b1twcm9wXS5hcHBseShhcGksIGFyZ3MpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCB2YWx1ZTogcmVzdWx0fTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBlcnJvcn07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgcHJvbWlzZX07XG4gICAgICAgICAgICB0aHJvdyBwcm9taXNlO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IudGhlbikgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICBjYWNoZVtrZXldID0ge3RpbWVvdXQ6IERhdGUubm93KCkgKyBjYWNoZUV4cGlyYXRpb24sIGVycm9yfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gYXMgYW55O1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJ2O1xufVxuIiwiZXhwb3J0IGludGVyZmFjZSBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucyB7XG4gIHRvTG93ZXI/OiBib29sZWFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9IHtcbiAgY29uc3Qge3RvTG93ZXJ9ID0gKG9wdGlvbnMgfHzCoHt9KSBhcyBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucztcbiAgY29uc3QgcmVzdWx0ID0ge307XG4gIGlmIChsb2NhdGlvblNlYXJjaCAmJiBsb2NhdGlvblNlYXJjaC5sZW5ndGggPiAxKVxuICAgIGxvY2F0aW9uU2VhcmNoLnN1YnN0cigxKVxuICAgICAgLnNwbGl0KCcmJylcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnNwbGl0KCc9JykubWFwKHMgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMudHJpbSgpKSkpXG4gICAgICAuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiByZXN1bHRbdG9Mb3dlciA/IGtleS50b0xvd2VyQ2FzZSgpIDoga2V5XSA9IHZhbHVlKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZW5jb2RlUGFyYW1zKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5maWx0ZXIoa2V5ID0+IHBhcmFtc1trZXldICE9PSB1bmRlZmluZWQpLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trZXldKX1gKS5qb2luKCcmJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gXCI/XCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSGFzaFF1ZXJ5U3RyaW5nKGxvY2F0aW9uSGFzaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpIHtcbiAgcmV0dXJuIHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlSGFzaFF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gXCIjXCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0VXJsQW5kUXVlcnkgKHVybFdpdGhQb3NzaWJsZVF1ZXJ5OiBzdHJpbmcpIHtcbiAgY29uc3QgcFF1ZXJ5ID0gdXJsV2l0aFBvc3NpYmxlUXVlcnkuaW5kZXhPZignPycpO1xuICByZXR1cm4gcFF1ZXJ5ID49IDAgP1xuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIoMCwgcFF1ZXJ5KSwgdXJsV2l0aFBvc3NpYmxlUXVlcnkuc3Vic3RyKHBRdWVyeSldIDpcbiAgICBbdXJsV2l0aFBvc3NpYmxlUXVlcnksIFwiXCJdO1xufVxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgVGVybSwgQWNhZGVtaWNZZWFyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xuICB0ZXJtOiBUZXJtO1xuICB3ZWVrPzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XG4gIHJldHVybiB0ZXJtID09PSAnQVQnID9cbiAgICBbMzIsIDUxXSA6XG4gICAgWzEsIDI1XTtcbn1cblxuLy9Ob3QgdXNlZCBhbnltb3JlXG4vLyBleHBvcnQgZnVuY3Rpb24gZ2V0VGVybVN0YXJ0QW5kRW5kKG5vdzogbW9tZW50Lk1vbWVudCkgOiBtb21lbnQuTW9tZW50W10ge1xuLy8gICAgIHJldHVybiBub3cubW9udGgoKSA+PSA2ID8gLy8gNiA9IEp1bHkgaW4gSlMgRGF0ZXMgYW5kIGluIG1vbWVudCBhcyB3ZWxsIVxuLy8gICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNywgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMTEsIDMxKSldIDogLy8gYXVnMSAtIGRlYzMxXG4vLyAgICAgW21vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCAwLCAxKSksIG1vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCA2LCAzMSkpXTsgLy8gamFuMSAtIGp1bHkzMVxuLy8gfVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGU6IERhdGUsIGlzRmlyc3RUZXJtOiBib29sZWFuKTogbW9tZW50Lk1vbWVudFtdIHtcbiAgdmFyIGFkZFllYXIgPSBkYXRlLmdldE1vbnRoKCkgPj0gNztcbiAgdmFyIHRlcm1ZZWFyID0gbnVsbDtcblxuICBpZiAoYWRkWWVhcikge1xuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiBkYXRlLmdldEZ1bGxZZWFyKCkgKyAxO1xuICB9IGVsc2Uge1xuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgLSAxIDogZGF0ZS5nZXRGdWxsWWVhcigpO1xuICB9XG5cbiAgdmFyIHRlcm1ZZWFyTW9tZW50ID0gbW9tZW50KHRlcm1ZZWFyLnRvU3RyaW5nKCksIFwiWVlZWVwiKTtcblxuICBpZiAodGVybVllYXJNb21lbnQud2VlaygpICE9IDEpIHtcbiAgICB0ZXJtWWVhck1vbWVudCA9IHRlcm1ZZWFyTW9tZW50LmNsb25lKCkuYWRkKDEsICd3ZWVrJyk7XG4gIH1cblxuICByZXR1cm4gaXNGaXJzdFRlcm0gPyBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLndlZWsoMzIpLnN0YXJ0T2YoJ3dlZWsnKSwgbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLndlZWsoNTEpLmVuZE9mKCd3ZWVrJyldIDpcbiAgICBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLCBtb21lbnQodGVybVllYXJNb21lbnQuY2xvbmUoKSkud2VlaygyNSkuZW5kT2YoJ3dlZWsnKV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xNb21lbnQobTogbW9tZW50Lk1vbWVudCk6IFNjaG9vbE1vbWVudCB7XG4gIGNvbnN0IHRoaXNZZWFyID0gbS55ZWFyKCk7XG4gIGNvbnN0IGlzQXV0dW1uID0gbS5tb250aCgpID49IDY7IC8vIGRldGVybWluZSBcbiAgY29uc3QgW2F1dHVtblllYXIsIHNwcmluZ1llYXJdID0gaXNBdXR1bW4gP1xuICAgIFt0aGlzWWVhciwgdGhpc1llYXIgKyAxXSA6XG4gICAgW3RoaXNZZWFyIC0gMSwgdGhpc1llYXJdO1xuICBjb25zdCBhY2FkZW1pY1llYXIgPSAnJyArIGF1dHVtblllYXIgKyAnLycgKyBzcHJpbmdZZWFyO1xuICBjb25zdCB0ZXJtID0gaXNBdXR1bW4gPyAnQVQnIDogJ1NUJztcbiAgY29uc3Qgd2VlayA9IG0ud2VlaygpO1xuICByZXR1cm4geyBhY2FkZW1pY1llYXIsIHRlcm0sIHdlZWsgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXIoYVllYXI6IEFjYWRlbWljWWVhciwgbnVtWWVhcnNUb0FkZDogbnVtYmVyKTogQWNhZGVtaWNZZWFyIHtcbiAgcmV0dXJuIGFZZWFyLnNwbGl0KCcvJylcbiAgICAubWFwKHllYXJTdHIgPT4gcGFyc2VJbnQoeWVhclN0cikgKyBudW1ZZWFyc1RvQWRkKVxuICAgIC5tYXAoeWVhciA9PiAnJyArIHllYXIpXG4gICAgLmpvaW4oJy8nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5leHRBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXZBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAtMSk7XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFNjaG9vbE1vbWVudCwgYWRkWWVhciB9IGZyb20gJy4vc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgeyBBY2FkZW1pY1llYXIsIFRlcm0gfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQge0luamVjdGVkSW50bH0gZnJvbSAncmVhY3QtaW50bCc7XG5cbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcblxuZnVuY3Rpb24gaXNTY2hvb2xNb21lbnQob2JqOiBEYXRlIHwgU2Nob29sTW9tZW50KTogb2JqIGlzIFNjaG9vbE1vbWVudCB7XG4gIHJldHVybiAnYWNhZGVtaWNZZWFyJyBpbiBvYmo7XG59XG5cbmV4cG9ydCBjbGFzcyBTY2hvb2xUZXJtIHtcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XG4gIHRlcm06IFRlcm07XG5cbiAgY29uc3RydWN0b3IoZGF0ZU9yU2Nob29sTW9tZW50OiBEYXRlIHwgU2Nob29sTW9tZW50KSB7XG4gICAgY29uc3Qgc2Nob29sTW9tZW50ID0gaXNTY2hvb2xNb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSA/XG4gICAgICBkYXRlT3JTY2hvb2xNb21lbnQgOiBnZXRTY2hvb2xNb21lbnQobW9tZW50KGRhdGVPclNjaG9vbE1vbWVudCkpO1xuICAgIHRoaXMuYWNhZGVtaWNZZWFyID0gc2Nob29sTW9tZW50LmFjYWRlbWljWWVhcjtcbiAgICB0aGlzLnRlcm0gPSBzY2hvb2xNb21lbnQudGVybTtcbiAgfVxuXG4gIGdldCB5ZWFyKCkge1xuICAgIHJldHVybiBwYXJzZUludCh0aGlzLmFjYWRlbWljWWVhclxuICAgICAgICAuc3BsaXQoJy8nKVt0aGlzLnRlcm0gPT09ICdBVCcgPyAwIDogMV0pO1xuICB9XG5cbiAgbmV4dFRlcm0oKSB7XG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdTVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0gOlxuICAgICAge1xuICAgICAgICB0ZXJtOiAnQVQnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIDEpXG4gICAgICB9KTtcbiAgfVxuXG4gIHByZXZUZXJtKCkge1xuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAge1xuICAgICAgICB0ZXJtOiAnU1QnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIC0xKVxuICAgICAgfSA6XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdBVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0pO1xuICAgIFxuICB9XG5cbiAgdG9Mb2NhbGVTdHJpbmcoaW50bDogSW5qZWN0ZWRJbnRsLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XG4gICAgbGV0IHllYXIgPSB0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVswXTpcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMV07XG5cbiAgICBpZiAoc2hvcnRZZWFyKVxuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xuXG4gICAgcmV0dXJuIHRoaXMudGVybSA9PT0gJ0FUJyA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3Rlcm1wbGFubmVyLnNlY29uZFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonSFQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSkgOiBcbiAgICBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5maXJzdFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonVlQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSk7XG4gIH1cbn1cbiIsIlxuZXhwb3J0IGZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdCAoc3RyKSB7XG4gICAgZm9yIChsZXQgaT0wLCBsPXN0ci5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChpKSA8IDB4MjAwMCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHIoMCwgaSkgKyBzdHJbaV0udG9Mb2NhbGVVcHBlckNhc2UoKSArIHN0ci5zdWJzdHIoaSArIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRlbmQob2JqLCBleHRlbnNpb24pIHtcbiAgICBpZiAodHlwZW9mIGV4dGVuc2lvbiAhPT0gJ29iamVjdCcpIHJldHVybiBvYmo7XG4gICAgT2JqZWN0LmtleXMoZXh0ZW5zaW9uKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIG9ialtrZXldID0gZXh0ZW5zaW9uW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lPFQsRT4gKG9iaiA6IFQsIGV4dGVuc2lvbj86IEUpIHtcbiAgICBsZXQgY2xvbmUgPSB7fTtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsb25lLCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpKTtcbiAgICB9KTtcbiAgICBpZiAoZXh0ZW5zaW9uKSBleHRlbmQoY2xvbmUsIGV4dGVuc2lvbik7XG4gICAgcmV0dXJuIGNsb25lIGFzIChUICYgRSk7XG59XG5cbmNvbnN0IGNvbmNhdCA9IFtdLmNvbmNhdDtcbmV4cG9ydCBmdW5jdGlvbiBmbGF0dGVuPFQ+IChhIDogKFQgfCBUW10pW10pIHtcbiAgICByZXR1cm4gY29uY2F0LmFwcGx5KFtdLCBhKSBhcyBUW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcDxUPihwcm9wOmtleW9mIFQpIHtcbiAgICByZXR1cm4gKGE6IFQsYjogVCkgPT4ge1xuICAgICAgICBjb25zdCBhUHJvcCA9IGFbcHJvcF0sIGJQcm9wID0gYltwcm9wXTtcbiAgICAgICAgcmV0dXJuIGFQcm9wID4gYlByb3AgPyAxIDogYVByb3AgPCBiUHJvcCA/IC0xIDogMDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcHMoXG4gICAgcHJvcHM6IHN0cmluZyB8IHN0cmluZ1tdLFxuICAgIGxvY2FsZXM/OiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgICBvcHRpb25zPzogSW50bC5Db2xsYXRvck9wdGlvbnMpOiAoYTogYW55LCBiOiBhbnkpID0+IG51bWJlclxue1xuICAgIHByb3BzID0gQXJyYXkuaXNBcnJheShwcm9wcykgPyBwcm9wcyA6IFtwcm9wc107XG5cbiAgICBjb25zdCBsb2NhbGVDb21wYXJlID0gKGEsYikgPT5cbiAgICAgICAgdHlwZW9mIGEgPT09ICdzdHJpbmcnID9cbiAgICAgICAgICAgIGEubG9jYWxlQ29tcGFyZShiLCBsb2NhbGVzLCBvcHRpb25zKSA6XG4gICAgICAgICAgICBhIDwgYiA/IC0xIDogYSA+IGIgPyAxIDogMDtcblxuICAgIGZ1bmN0aW9uIGNtcFBhcnQgKGEsYixmaXJzdFBhcnQ6IHN0cmluZyxyZXN0OiBzdHJpbmdbXSkge1xuICAgICAgICBjb25zdCBmaXJzdEEgPSBhW2ZpcnN0UGFydF07XG4gICAgICAgIGNvbnN0IGZpcnN0QiA9IGJbZmlyc3RQYXJ0XTtcbiAgICAgICAgaWYgKGZpcnN0QSA9PT0gZmlyc3RCKSByZXR1cm4gMDtcbiAgICAgICAgaWYgKGZpcnN0QSA9PSBudWxsKSByZXR1cm4gLTE7XG4gICAgICAgIGlmIChmaXJzdEIgPT0gbnVsbCkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiByZXN0Lmxlbmd0aCA9PT0gMCA/XG4gICAgICAgICAgICBsb2NhbGVDb21wYXJlKGZpcnN0QSwgZmlyc3RCKSA6XG4gICAgICAgICAgICBjbXBQYXJ0KGZpcnN0QSwgZmlyc3RCLCByZXN0WzBdLCByZXN0LnNsaWNlKDEpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvcHNcbiAgICAgICAgLm1hcChwcm9wID0+IHByb3Auc3BsaXQoJy4nKSlcbiAgICAgICAgLm1hcCgoW2ZpcnN0UGFydCwgLi4ucmVzdF0pID0+IChhLGIpID0+IGNtcFBhcnQoYSxiLCBmaXJzdFBhcnQsIHJlc3QpKVxuICAgICAgICAucmVkdWNlKChjbXAxLCBjbXAyKSA9PlxuICAgICAgICAgICAgKGEsYikgPT4gY21wMShhLGIpIHx8IGNtcDIoYSxiKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBMKHRleHQsIC4uLmFyZ3MpIHtcbiAgICBsZXQgZmlyc3QgPSB0ZXh0WzBdO1xuICAgIHJldHVybiBidWlsZE1lc3NhZ2UodGV4dCwgYXJncyk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWVzc2FnZSAodGV4dCwgYXJncykge1xuICAgIGxldCBydiA9IHRleHRbMF07XG4gICAgZm9yIChsZXQgaT0xLCBsPXRleHQubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBydiArPSBhcmdzW2ktMV0gKyB0ZXh0W2ldO1xuICAgIH1cbiAgICByZXR1cm4gcnY7XG59XG5cbmV4cG9ydCBjbGFzcyBUQzxUPiB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGU6IFQpIHtcbiAgICAgICAgZXh0ZW5kKHRoaXMsIHRlbXBsYXRlKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRlVGltZVJldml2ZXIgKGtleSwgdmFsdWUpIHtcbiAgICB2YXIgYTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICBhID0gL1xcL0RhdGVcXCgoXFxkKilcXClcXC8vLmV4ZWModmFsdWUpO1xuICAgICAgICBpZiAoYSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCthWzFdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cbi8vbGV0IGluZm9TZXJpYWwgPSAxO1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dJbmZvIChtc2cpIHtcbiAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2luZm8nLCB7ICdkZXRhaWwnOiBtc2cgfSk7XG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yIChlcnJNc2c6IHN0cmluZyB8IEVycm9yKSB7XG4gICAgY29uc3QgbXNnID0gdHlwZW9mIGVyck1zZyA9PT0gJ3N0cmluZycgPyBlcnJNc2cgOiBlcnJNc2cubWVzc2FnZTtcbiAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2N1c3RvbWVycm9yJywgeyAnZGV0YWlsJzogbXNnIH0pO1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyTXNnKTtcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXhMZW5ndGgoc3RyOiBzdHJpbmcsIG1heExlbjogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHN0ci5sZW5ndGggPiBtYXhMZW4gP1xuICAgICAgICBzdHIuc3Vic3RyKDAsIG1heExlbiAtIDMpICsgXCIuLi5cIiA6XG4gICAgICAgIHN0cjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5VG9Mb29rdXA8VD4oYTogVFtdLCBrZXlBY2Nlc3NvcjogKGl0ZW06IFQpID0+IHN0cmluZyB8IG51bWJlcikge1xuICAgIGNvbnN0IHJlc3VsdCA6IHtba2V5OiBzdHJpbmddIDogVFtdfSA9IHt9O1xuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XG4gICAgICAgIGNvbnN0IGtleSA9IGtleUFjY2Vzc29yKGl0ZW0pO1xuICAgICAgICBsZXQgYXJyYXkgPSByZXN1bHRba2V5XTtcbiAgICAgICAgaWYgKGFycmF5KSBhcnJheS5wdXNoKGl0ZW0pO1xuICAgICAgICBlbHNlIHJlc3VsdFtrZXldID0gW2l0ZW1dO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb01hcDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgY29uc3QgcmVzdWx0IDoge1trZXk6IHN0cmluZ10gOiBUfSA9IHt9O1xuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XG4gICAgICAgIGNvbnN0IGtleSA9IGtleUFjY2Vzc29yKGl0ZW0pO1xuICAgICAgICByZXN1bHRba2V5XSA9IGl0ZW07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVycnlQaWNrUHJvcHM8VD4gKG9iajogVCwgcHJvcHNUb1BpY2s6IHN0cmluZ1tdKTogUGFydGlhbDxUPiB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBwYXJhbSBvZiBwcm9wc1RvUGljaykge1xuICAgICAgaWYgKHBhcmFtIGluIG9iaikgcmVzdWx0W3BhcmFtXSA9IG9ialtwYXJhbV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQgYXMgUGFydGlhbDxUPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RpbmN0PFQ+IChhOiBUW10sIGtleUFjY2Vzc29yPzogKGl0ZW06IFQpID0+IGFueSkge1xuICAgIGNvbnN0IG1hcCA9IGFycmF5VG9NYXAoYSwga2V5QWNjZXNzb3IgfHwgKHggPT4geCkpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhtYXApLm1hcChrZXkgPT4gbWFwW2tleV0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hhbGxvd0VxdWFscyhhOiBhbnksIGI6IGFueSkge1xuICAgIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoIWEgfHwgIWIpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIGEgIT09ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IGtleXNBID0gT2JqZWN0LmtleXMoYSk7XG4gICAgY29uc3Qga2V5c0IgPSBPYmplY3Qua2V5cyhiKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGxldCBpPTAsIGw9a2V5c0EubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBjb25zdCBrZXkgPSBrZXlzQVtpXTtcbiAgICAgICAgaWYgKGtleXNCW2ldICE9PSBrZXkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKGFba2V5XSAhPT0gYltrZXldKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIiwiLyogKGlnbm9yZWQpICovIiwiLyogKGlnbm9yZWQpICovIiwiLyogKGlnbm9yZWQpICovIiwibW9kdWxlLmV4cG9ydHMgPSBqUXVlcnk7IiwibW9kdWxlLmV4cG9ydHMgPSBSZWFjdDsiXSwic291cmNlUm9vdCI6IiJ9