(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[16],{304:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(3),c=a.n(r),l=a(311),s=a(302),o=a(312),i=a(113),u=a(131),d=a(98),b=a(87),m=a(99),p=a(6),f=a(1),g=a(23),h=a(2),j=a(280),k=a(4);function O(){return Object(g.d)(k.a.currentUser,"standard")}var E,v,y,I,N,T,C,w,S,R,L,x,M,D,A,F,_,U,B,V,H,q,P,G,K,z,$,W,Y,X,J,Q,Z,ee,te,ae,ne,re=function(e){function t(t){var a=e.call(this,t)||this;return a.state={editingName:!1,name:""},a}return Object(n.c)(t,e),t.prototype.createTab=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,a,r,c,l,s,o,i,u,d,b;return Object(n.d)(this,(function(m){switch(m.label){case 0:return this.setState({editingName:!1,name:""}),t=this.props,a=t.type,r=t.branch,c=t.draftId,l=t.course,s=t.school,o=t.history,i=t.block,u=t.stepNo,d={id:Object(h.i)(),tabTitle:e,name:e,order:Date.now(),locked:!!O(),acl:["role:USER:R","schoolRole:"+s+"/EMPLOYEE:S"]},"step-course-tab"===(b="theme-course-tab"===a?Object(n.a)({type:"theme-course-tab",tabClass:"content-tab",tags:[this.props.course.id,"tab:"+d.id]},d):Object(n.a)(Object(n.a)({type:"step-course-tab",tabClass:"content-tab",tags:Object(n.h)(i.tags,["blockStep:"+i.id+":"+u])},d),{stepNo:u})).type?r.courseBlocks.addRelated(i,"tabs",b):r.courseInstances.addRelated(l,"tabs",b),[4,r.saveNow()];case 1:return m.sent(),o.push("/"+s+"/courses/"+l.id+"/tabs/"+b.id+"/drafts/"+c+"/edit"),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props,a=(t.school,t.course,t.branch,this.state),c=a.editingName,l=a.name;return r.createElement(r.Fragment,null,r.createElement("a",{onClick:c?null:function(t){return e.setState({editingName:!0,name:""})}},r.createElement("i",{className:"fas fa-plus","aria-hidden":"true"}),c?r.createElement("input",{type:"text",style:{color:"black"},autoFocus:!0,placeholder:Object(p.a)(v||(v=Object(n.e)(["Fliknamn"],["Fliknamn"]))),value:l,size:30,onChange:function(t){return e.setState({name:t.target.value})},onKeyPress:function(t){"Enter"===t.key&&e.createTab(l)},onBlur:function(){return e.setState({editingName:!1})}}):" "+Object(p.a)(E||(E=Object(n.e)(["Ny flik"],["Ny flik"])))))},t}(r.Component),ce=Object(j.a)(re),le=a(109),se=a(106),oe=a(303),ie=Object(d.b)((function(e){return e.resourceListContents.orderBy("order").toValue().map((function(e){var t=Object(p.k)(e.map((function(e){return e.resources.map((function(e,t){return e.order=null==e.order?(new Date).setHours(t):e.order,e}))||[]})));return 0===t.length?c.a.createElement("div",null):c.a.createElement("div",null,c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h2",null,"Resurser"),c.a.createElement("hr",null),c.a.createElement("div",{className:"taskContainer"},t.sort(Object(p.h)("order")).map((function(e){return c.a.createElement("div",{className:"align-horizontal"},c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement("a",{href:e.url,target:"_blank"},e.name)))})))))}))})),ue=a(97),de={"rich-text":Object(p.a)(y||(y=Object(n.e)(["Textruta"],["Textruta"]))),"youtube-movie":Object(p.a)(I||(I=Object(n.e)(["Youtube film"],["Youtube film"]))),"learning-goals":Object(p.a)(N||(N=Object(n.e)(["Lärandemål och uppgifter"],["Lärandemål och uppgifter"]))),"resource-list":Object(p.a)(T||(T=Object(n.e)(["Resurslista"],["Resurslista"]))),"embedded-html":Object(p.a)(C||(C=Object(n.e)(["Inbäddad HTML"],["Inbäddad HTML"]))),"word-bank":Object(p.a)(w||(w=Object(n.e)(["Ordbank"],["Ordbank"])))},be={"rich-text":Object(p.a)(S||(S=Object(n.e)(["Lägg till text"],["Lägg till text"]))),"youtube-movie":Object(p.a)(R||(R=Object(n.e)(["Lägg till youtube film"],["Lägg till youtube film"]))),"learning-goals":Object(p.a)(L||(L=Object(n.e)(["Lägg till lärandemål och uppgifter"],["Lägg till lärandemål och uppgifter"]))),"resource-list":Object(p.a)(x||(x=Object(n.e)(["Lägg till resurslista"],["Lägg till resurslista"]))),"embedded-html":Object(p.a)(M||(M=Object(n.e)(["Lägg till inbäddad HTML"],["Lägg till inbäddad HTML"]))),"word-bank":Object(p.a)(D||(D=Object(n.e)(["Lägg till ordbank"],["Lägg till ordbank"])))},me=function(e){function t(t){var a=e.call(this,t)||this;return a.state={open:!1,contentType:"rich-text"},a}return Object(n.c)(t,e),t.prototype.computeTags=function(){var e=this.props,t=e.course,a=e.tab,n=e.courseBlock;return[t.id,"step-course-tab"===a.type?"blockStep:"+n.id+":"+a.stepNo:"tab:"+a.id]},t.prototype.createContent=function(){var e=this.props,t=e.tab,a=e.branch,n=e.type,r=e.schoolName,c=this.newContent(n||this.state.contentType);c.acl=["role:USER:R","schoolRole:"+r+"/EMPLOYEE:S"],a.courseTabs.addRelated(t,"contents",c),this.setState({open:!1})},t.prototype.newContent=function(e){switch(e){case"rich-text":return this.newRichText();case"learning-goals":return this.newLearningGoal();case"embedded-html":return this.newEmbeddedHTML();case"word-bank":return this.newWordBank();case"resource-list":return this.newResourceList();default:throw new Error("Not implemented")}},t.prototype.newWordBank=function(){return{type:"word-bank",tags:this.computeTags(),id:Object(h.i)(),order:Date.now(),locked:this.props.tab.locked,lockDelete:O(),hidden:!1,selectedWordBank:null}},t.prototype.newRichText=function(){return{type:"rich-text",tags:this.computeTags(),id:Object(h.i)(),order:Date.now(),locked:"theme-course"!==this.props.course.type&&this.props.tab.locked,lockDelete:O(),hidden:!1,html:""}},t.prototype.newEmbeddedHTML=function(){return{type:"embedded-html",tags:this.computeTags(),id:Object(h.i)(),order:Date.now(),locked:this.props.tab.locked,lockDelete:O(),hidden:!1,html:""}},t.prototype.newLearningGoal=function(){return{type:"learning-goals",tags:this.computeTags(),id:Object(h.i)(),locked:"theme-course"!==this.props.course.type&&this.props.tab.locked,lockDelete:O(),hidden:!1,hasCommonLearningGoals:"theme-course"===this.props.course.type,commonLearningGoals:[],order:Date.now(),hiddenTasks:[]}},t.prototype.newResourceList=function(){return{type:"resource-list",tags:this.computeTags(),id:Object(h.i)(),locked:!1,lockDelete:O(),order:Date.now(),hidden:!1,resources:[]}},t.prototype.render=function(){var e=this;return this.state.open?r.createElement("div",null,r.createElement("select",{onChange:function(t){return e.setState({contentType:t.target.value})}},Object.keys(de).map((function(e){return r.createElement("option",{key:e,value:e},de[e])}))),r.createElement("a",{className:"btn pull-right",onClick:function(){return e.setState({open:!1})}},Object(p.a)(A||(A=Object(n.e)(["Avbryt"],["Avbryt"])))),r.createElement("a",{className:"btn btn-default",onClick:function(){return e.createContent()}},Object(p.a)(F||(F=Object(n.e)(["Skapa"],["Skapa"]))))):r.createElement(r.Fragment,null,r.createElement("a",{className:"btn",onClick:function(){e.props.type?e.createContent():e.setState({open:!0})}},r.createElement("i",{className:"fas fa-plus","aria-hidden":"true"}),this.props.type?be[this.props.type]:Object(p.a)(_||(_=Object(n.e)(["Lägg till innehåll"],["Lägg till innehåll"]))))," ")},t}(r.Component),pe=a(95),fe=a(96),ge={"intro-tab":Object(p.a)(U||(U=Object(n.e)(["Introduktionsflik"],["Introduktionsflik"]))),"run-up-tab":Object(p.a)(B||(B=Object(n.e)(["Upptaktsflik"],["Upptaktsflik"]))),"subject-tab":Object(p.a)(V||(V=Object(n.e)(["Ämnesflik"],["Ämnesflik"]))),"mission-tab":Object(p.a)(H||(H=Object(n.e)(["Uppdragsflik"],["Uppdragsflik"]))),"content-tab":Object(p.a)(q||(q=Object(n.e)(["Generell flik"],["Generell flik"]))),"teacher-tab":Object(p.a)(P||(P=Object(n.e)(["Lärarsida"],["Lärarsida"]))),"word-bank-tab":Object(p.a)(G||(G=Object(n.e)(["Ordbank"],["Ordbank"])))},he={"step-course":["content-tab","intro-tab","teacher-tab","word-bank-tab"],"theme-course":["content-tab","run-up-tab","subject-tab","mission-tab","teacher-tab"]},je=a(116),ke=a(101),Oe=function(e){var t=e.tab,a=e.repo,r=e.course,l=t.subject?t.subject:"theme-course"===r.type&&r.subjects&&r.subjects.length>0?{subjectCode:r.subjects[0].code,subjectName:r.subjects[0].name}:{subjectCode:"",subjectName:""},s=l.subjectCode,o=l.subjectName,i=Object(je.e)(r.tags),u=Object(je.e)(t.tags)[0]||i[0]||null;return c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("p",{className:"box-mini-label"},Object(p.a)(K||(K=Object(n.e)(["Inställningar för fliken ",""],["Inställningar för fliken ",""])),t.name||t.tabTitle)),c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("label",{className:"kclabel"},Object(p.a)(z||(z=Object(n.e)(["Flikens typ"],["Flikens typ"]))))),c.a.createElement(fe.a,null,c.a.createElement("select",{value:t.tabClass,onChange:function(e){return a.courseTabs.update(t,"subject-tab"===e.target.value?{tabClass:e.target.value,subject:{subjectCode:s,subjectName:o},tags:Object(je.a)(t.tags,[s],[u])}:{tabClass:e.target.value})}},he[r.type].map((function(e){return c.a.createElement("option",{key:e,value:e},ge[e])}))))),c.a.createElement(ke.a,{label:Object(p.a)($||($=Object(n.e)(["Flikens namn"],["Flikens namn"]))),id:"TabSettings:name",value:t.name||t.tabTitle,onChange:function(e){return a.courseTabs.update(t,{name:e,tabTitle:e})}}))},Ee={"rich-text":Object(p.a)(W||(W=Object(n.e)(["Textruta"],["Textruta"]))),"youtube-movie":Object(p.a)(Y||(Y=Object(n.e)(["Youtube film"],["Youtube film"]))),"learning-goals":Object(p.a)(X||(X=Object(n.e)(["Lärandemål och uppgifter"],["Lärandemål och uppgifter"]))),"resource-list":Object(p.a)(J||(J=Object(n.e)(["Resurslista"],["Resurslista"]))),"embedded-html":Object(p.a)(Q||(Q=Object(n.e)(["Inbäddad HTML"],["Inbäddad HTML"]))),"word-bank":Object(p.a)(Z||(Z=Object(n.e)(["Ordbank"],["Ordbank"])))},ve=a(100),ye=a(102),Ie=a(139),Ne=function(e){var t=e.content,a=e.repo,n=e.editMode,r=e.reportNumChars,l=e.maxChars,s=e.course;return n?c.a.createElement("div",null,c.a.createElement(ve.a,{html:t.html,defaultActions:ye.a,readOnly:!n||t.locked&&!O()&&"theme-course"!==s.type,reportNumChars:r,maxChars:l,actions:["bold","italic","underline","strikethrough","heading2","heading3","olist","ulist","outdent","indent","line","link","image","clear"],onChange:n&&function(e){return a.courseContents.update(t,{html:e})}})):c.a.createElement("div",null,c.a.createElement("div",{className:"rich-text-readonly",dangerouslySetInnerHTML:{__html:Object(Ie.a)(t.html)}}))},Te=function(e){e.tab;var t=e.content,a=e.repo;return c.a.createElement("div",null,c.a.createElement("h2",null,Object(p.a)(ee||(ee=Object(n.e)(["Lärandemål och uppgifter"],["Lärandemål och uppgifter"])))),c.a.createElement("div",null,c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("input",{type:"checkbox",checked:t.hasCommonLearningGoals,onChange:function(e){return a.courseContents.update(t,{hasCommonLearningGoals:!!e.target.checked})}})),c.a.createElement(fe.a,null,c.a.createElement("p",null," ",Object(p.a)(te||(te=Object(n.e)(["Specificera gemensamma lärandemål för samtliga uppgifter"],["Specificera gemensamma lärandemål för samtliga uppgifter"]))))))),c.a.createElement("div",null,c.a.createElement("p",null,t.hasCommonLearningGoals?Object(p.a)(ae||(ae=Object(n.e)(["Ange de gemensamma lärandemålen. Ange ett lärandemål per rad."],["Ange de gemensamma lärandemålen. Ange ett lärandemål per rad."]))):Object(p.a)(ne||(ne=Object(n.e)(["Ange ett lärandemål per rad."],["Ange ett lärandemål per rad."])))),c.a.createElement("textarea",{className:"learning-goal-box",value:t.commonLearningGoals.join("\n"),onChange:function(e){return a.courseContents.update(t,{commonLearningGoals:e.target.value.split("\n")})}})))},Ce=a(138);var we,Se,Re,Le,xe,Me,De,Ae,Fe,_e,Ue,Be,Ve,He=function(e){function t(t){var a=e.call(this,t)||this;return a.state={editingName:!1,name:""},a}return Object(n.c)(t,e),t.prototype.createTask=function(e){return Object(n.b)(this,void 0,void 0,(function(){var t,a,r,c,l,s,o,i,u,d,b,m,f,g;return Object(n.d)(this,(function(j){switch(j.label){case 0:return this.setState({editingName:!1,name:""}),t=this.props,a=t.branch,r=t.draftId,c=t.course,l=t.tab,s=t.school,o=t.content,i=t.history,u=t.block,d=t.learningGoal,b=function(e,t,a){var r=[e.id];if("step-course"===e.type&&a&&"step-course-tab"===t.type?r.push("blockStep:"+a.id+":"+t.stepNo):"theme-course"===e.type&&r.push("tab:"+t.id),"mission-tab"===t.tabClass){var c=e.tabs.filter((function(e){return"subject-tab"===e.tabClass})),l=Object(p.j)(c.map((function(e){return e.subject})),(function(e){return e.subjectCode})),s=Object(p.j)(Object(p.k)(c.map((function(e){return e.tags.filter((function(e){return e.startsWith("course:")}))}))));return r.push.apply(r,Object(n.h)(l.map((function(e){return"sub:"+e.subjectCode})))),r.push.apply(r,Object(n.h)(s)),{tags:r,subject:l.map((function(e){return e.subjectName})).join(", ")}}return r.push.apply(r,Object(n.h)((t||a).tags.filter((function(e){return e.startsWith("course:")})))),"theme-course"===e.type?r.push.apply(r,Object(n.h)(t.tags.filter((function(e){return e.startsWith("sub:")})))):r.push.apply(r,Object(n.h)(a.tags.filter((function(e){return e.startsWith("sub:")})))),{tags:r,subject:"theme-course"===e.type?t.subject.subjectName:e.subject.subjectName}}(c,l,u),m=b.tags,f=b.subject,g={id:Object(h.i)(),tags:m,name:e,acl:["role:USER:R","schoolRole:"+s+"/EMPLOYEE:S"],url:"",taskType:"task",learningGoal:d,futureAbilities:[],resources:[],subject:f},a.courseContents.addRelated(o,"tasks",g),[4,a.saveNow()];case 1:return j.sent(),i.push("/"+s+"/courses/"+c.id+"/tabs/"+l.id+"/contents/"+o.id+"/tasks/"+g.id+"/drafts/"+r+"/edit"),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.state,a=t.editingName,c=t.name;return r.createElement(r.Fragment,null,r.createElement("a",{className:"btn",onClick:a?null:function(t){return e.setState({editingName:!0,name:""})}},r.createElement("i",{className:"fas fa-plus","aria-hidden":"true"}),a?r.createElement("input",{type:"text",autoFocus:!0,placeholder:Object(p.a)(Re||(Re=Object(n.e)(["Uppgiftens namn"],["Uppgiftens namn"]))),value:c,size:50,onChange:function(t){return e.setState({name:t.target.value})},onKeyPress:function(t){"Enter"===t.key&&e.createTask(c)},onBlur:function(){return e.setState({editingName:!1})}}):" "+(O()?Object(p.a)(we||(we=Object(n.e)(["Lägg till uppgift"],["Lägg till uppgift"]))):Object(p.a)(Se||(Se=Object(n.e)(["Lägg till egen uppgift"],["Lägg till egen uppgift"]))))))},t}(r.Component),qe=Object(j.a)(He),Pe=a(161),Ge=a(301),Ke=a(162),ze=function(e){var t=e.school,a=e.repo,n=e.content,r=e.draftId,l=e.editMode,s=e.course,o=e.courseTab,i=e.learningGoals,u=e.block,d=Object(Ke.b)(n),b=Object(p.b)(d,(function(e){return e.subject||""})),m="step-course"===s.type?s.subject:o.subject;return m&&!b[m.subjectName]&&(b[m.subjectName]=[]),c.a.createElement(c.a.Fragment,null,Object.keys(b).map((function(e){var d=b[e].map((function(a){return{id:a.id,name:a.name,url:l?"#/"+t+"/courses/"+s.id+"/tabs/"+o.id+"/contents/"+n.id+"/tasks/"+a.id+"/drafts/"+r+"/edit":r?"#/"+t+"/courses/"+s.id+"/tabs/"+o.id+"/contents/"+n.id+"/tasks/"+a.id+"/drafts/"+r:"#/"+t+"/courses/"+s.id+"/tabs/"+o.id+"/tasks/"+a.id,courseName:s.name,learningGoal:e,step:"step-course-tab"===o.type?o.stepNo:void 0,task:a,courseInfo:{school:t,course:s.id,tab:o.id}}}));function m(e){return"/"+t+"/courses/"+s.id+"/tabs/"+o.id+"/contents/"+n.id+"/tasks/"+e.id+"/drafts/"+r+"/edit"}return c.a.createElement("div",{key:e},c.a.createElement("h5",null,e),c.a.createElement("ul",null,i.map((function(e){return c.a.createElement("li",{key:e},e)}))),l?c.a.createElement(c.a.Fragment,null,c.a.createElement(Pe.a,{taskMetas:d.map((function(e){return{task:e.task,isTaskOwner:!0}})),renderEditLink:function(e){var t=e.task;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ge.a,{to:m(t),className:"editItem"})," ")},renderLink:function(e){var t=e.task;return c.a.createElement(Ge.a,{to:m(t)},t.name)},onSort:function(e,t,r){var c=Object(Ke.a)(n.tasks,n.taskOrder,e,t,r,{appendLeftovers:!0});a.courseContents.update(n,{taskOrder:c})}}),c.a.createElement(qe,{branch:a,content:n,course:s,school:t,draftId:r,tab:o,block:u,learningGoal:""})):c.a.createElement(Ce.a,{learningTasks:d}))})))},$e=function(e){var t=e.school,a=e.repo,r=e.content,l=e.draftId,s=e.editMode,o=e.course,i=e.courseTab,u=e.learningGoals,d=e.block,b=Object(Ke.b)(r),m={},f=u.reduce((function(e,t){return e[t]=b.filter((function(e){if(e.learningGoal&&e.learningGoal.split("\n").map((function(e){return e.trim().toLowerCase()})).includes(t.toLowerCase()))return m[e.id]=!0,!0})),e}),{}),g=b.filter((function(e){return!m[e.id]}));function h(e){return"/"+t+"/courses/"+o.id+"/tabs/"+i.id+"/contents/"+r.id+"/tasks/"+e.id+"/drafts/"+l+"/edit"}return"mission-tab"===i.tabClass||0===b.length?f[""]=g:g.length>0&&(f[Object(p.a)(Le||(Le=Object(n.e)(["Övergripande"],["Övergripande"])))]=g),c.a.createElement(c.a.Fragment,null,Object.keys(f).map((function(e){var u=f[e].map((function(a){return{id:a.id,name:a.name,url:s?"#/"+t+"/courses/"+o.id+"/tabs/"+i.id+"/contents/"+r.id+"/tasks/"+a.id+"/drafts/"+l+"/edit":l?"#/"+t+"/courses/"+o.id+"/tabs/"+i.id+"/contents/"+r.id+"/tasks/"+a.id+"/drafts/"+l:"#/"+t+"/courses/"+o.id+"/tabs/"+i.id+"/tasks/"+a.id,courseName:o.name,learningGoal:"mission-tab"===i.tabClass?Object(p.a)(xe||(xe=Object(n.e)(["Uppdrag"],["Uppdrag"]))):e,step:"step-course-tab"===i.type?i.stepNo:void 0,task:a,courseInfo:{school:t,course:o.id,tab:i.id}}}));return c.a.createElement("div",{key:e},e&&c.a.createElement("h4",null,e),s?c.a.createElement(c.a.Fragment,null,c.a.createElement(Pe.a,{taskMetas:u.map((function(e){return{task:e.task,isTaskOwner:!0}})),renderEditLink:function(e){var t=e.task;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ge.a,{to:h(t),className:"editItem"})," ")},renderLink:function(e){var t=e.task;return c.a.createElement(Ge.a,{to:h(t)},t.name)},onSort:function(e,t,n){var c=Object(Ke.a)(r.tasks,r.taskOrder,e,t,n,{appendLeftovers:!0});a.courseContents.update(r,{taskOrder:c})}}),c.a.createElement(qe,{branch:a,content:r,course:o,school:t,draftId:l,tab:i,block:d,learningGoal:e})):c.a.createElement(Ce.a,{learningTasks:u}))})))},We=function(e){var t=e.content,a=e.editMode,r=e.repo,l=e.course,s=e.school,o=e.draftId,i=e.courseTab,u=e.block,d=t.hasCommonLearningGoals,b=t.commonLearningGoals,m=(t.tasks,b.map((function(e){return e.trim()})).filter((function(e){return!!e}))),f=a&&"mission-tab"!==i.tabClass&&(O()||"theme-course"===l.type);return c.a.createElement("div",{className:"ked_boxed"},f?c.a.createElement(Te,{course:l,content:t,repo:r,tab:i}):"mission-tab"===i.tabClass?c.a.createElement("h2",null,Object(p.a)(Me||(Me=Object(n.e)(["Uppdrag"],["Uppdrag"])))):"theme-course"===l.type?c.a.createElement("h2",null,Object(p.a)(De||(De=Object(n.e)(["Uppgifter"],["Uppgifter"])))):c.a.createElement("h2",null,Object(p.a)(Ae||(Ae=Object(n.e)(["Lärandemål och uppgifter"],["Lärandemål och uppgifter"])))),c.a.createElement("hr",null),d&&"mission-tab"!==i.tabClass?c.a.createElement(ze,Object(n.a)({},{content:t,editMode:a,repo:r,course:l,school:s,draftId:o,courseTab:i,block:u,learningGoals:m})):c.a.createElement($e,Object(n.a)({},{content:t,editMode:a,repo:r,course:l,school:s,draftId:o,courseTab:i,block:u,learningGoals:m})))},Ye=function(e){var t=e.content,a=e.repo,r=e.editMode,l=e.reportNumChars,s=e.maxChars;return!r||t.locked&&!O()?c.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.html}}):c.a.createElement("div",null,c.a.createElement("h4",null,Object(p.a)(Fe||(Fe=Object(n.e)(["Inbäddat material"],["Inbäddat material"])))),c.a.createElement("p",null,Object(p.a)(_e||(_e=Object(n.e)(["Klipp in HTML kod nedan"],["Klipp in HTML kod nedan"])))),c.a.createElement("textarea",{style:{width:"100%",height:"100px"},value:t.html,onChange:function(e){var n=e.target.value;n.length>s||(a.courseContents.update(t,{html:n}),l(n.length))}}))},Xe=a(85),Je=a.n(Xe),Qe=a(141);function Ze(e){var t=e.subjectName,a=e.stepNo,r=e.selectedWordBank,l=e.wordBanksAlreadyAdded,s=e.onChange,o=f.a.KED_ENUM_WORDBANKS_URL+"?sv.contenttype=application/json&subject="+t+"&step="+a,i=Je()(o);return i=i.filter((function(e){var t=e.order;return r&&t===r.key||!l||!l.includes(t)})),c.a.createElement("div",null,c.a.createElement("h3",null,r?r.name:Object(p.a)(Ue||(Ue=Object(n.e)(["Välj ordbank"],["Välj ordbank"])))),c.a.createElement(Qe.a,{isMulti:!1,placeholder:Object(p.a)(Be||(Be=Object(n.e)(["Välj bland ordbanker för ",", steg ",""],["Välj bland ordbanker för ",", steg ",""])),t,a),noOptionsMessage:function(){return Object(p.a)(Ve||(Ve=Object(n.e)(["Kunde inte hitta tillgängliga ordbanker för ",", steg ",""],["Kunde inte hitta tillgängliga ordbanker för ",", steg ",""])),t,a)},options:i.map((function(e){var t=e.name,a=(e.id,e.order);e.url;return{label:t,value:a}})),value:r&&{label:r.name,value:r.key},onChange:function(e){return s({name:e.label,key:e.value})}}))}var et=a(103);function tt(e){var t=e.repo,a=e.content,l=e.siblingWordBanks,s=e.editMode,o=e.course,i=e.courseTab,u=a.selectedWordBank,d=o.subject.subjectName,b=i.stepNo,m=u&&f.a.KED_WORDBANKS_URL+"?preview=true&subject="+d+"&step="+b+"&list="+u.key,p=Object(n.f)(Object(r.useState)(200),2),g=p[0],h=p[1],j=Object(r.useRef)(),k=l.map((function(e){return e.selectedWordBank&&e.selectedWordBank.key})).filter((function(e){return!!e}));return Object(r.useEffect)((function(){return h(200)}),[u&&u.key]),c.a.createElement(c.a.Fragment,null,s&&(!a.locked||O())&&c.a.createElement(c.a.Suspense,{fallback:c.a.createElement(et.a,null)},c.a.createElement(Ze,Object(n.a)({},{subjectName:d,stepNo:b,wordBanksAlreadyAdded:k},{selectedWordBank:u,onChange:function(e){var n=e.name,r=e.key;t.courseContents.update(a,{selectedWordBank:{name:n,key:r}})}}))),u&&c.a.createElement("iframe",{ref:j,scrolling:"no",frameBorder:"0",style:{width:"100%",height:g,padding:0,margin:0},src:m,onLoad:function(){h(j.current.contentWindow.document.body.scrollHeight)}}))}function at(e){var t=e.repo,a=e.content,r=e.siblingContents,l=e.editMode,s=e.course,o=e.draftId,i=e.school,u=e.courseTab,d=e.reportNumChars,b=e.maxChars,m=e.block;switch(a.type){case"rich-text":return c.a.createElement(Ne,Object(n.a)({},{repo:t,content:a,editMode:l,reportNumChars:d,maxChars:b,course:s}));case"learning-goals":return c.a.createElement(We,Object(n.a)({},{repo:t,content:a,editMode:l,course:s,draftId:o,courseTab:u,school:i,block:m}));case"embedded-html":return c.a.createElement(Ye,Object(n.a)({},{repo:t,content:a,editMode:l,reportNumChars:d,maxChars:b}));case"word-bank":return c.a.createElement(tt,Object(n.a)({},{repo:t,editMode:l,content:a,siblingWordBanks:r.filter((function(e){return"word-bank"===e.type&&e.id!==a.id})),course:s,courseTab:u}));default:return c.a.createElement("p",null,"Okänd innehållstyp: ",a.type)}}var nt,rt,ct,lt,st,ot,it,ut,dt,bt,mt,pt,ft,gt,ht,jt,kt,Ot,Et,vt,yt,It,Nt,Tt,Ct,wt,St,Rt,Lt,xt,Mt,Dt,At,Ft,_t,Ut,Bt,Vt,Ht,qt,Pt=a(105),Gt=a(93),Kt=a(129),zt={MAX_CHARS_IN_CONTENTS:4e3,MAX_CHARS_TASK_NAMES:64,MAX_CHARS_TASK_INTRO_TEXT:200},$t=zt.MAX_CHARS_IN_CONTENTS,Wt=function(e){function t(t){var a=e.call(this,t)||this;return a.numCharsObservable=new m.a(0),a.state={},a}return Object(n.c)(t,e),t.prototype.render=function(){var e=this.props,t=e.editMode,a=e.content,r=e.branch,l=e.course,s=e.tab,o=e.school,i=e.draftId,u=e.contentOrderIndex,d=e.contents,b=e.block,m=O(),f=t&&"mission-tab"!==s.tabClass&&"theme-course"===l.type&&("learning-goals"===a.type||"rich-text"===a.type),g="step-course"===l.type&&"learning-goals"===a.type,h=this.numCharsObservable;return!t||a.locked&&!m?c.a.createElement(at,{key:a.id,repo:r,content:a,siblingContents:d,course:l,editMode:t,courseTab:s,school:o,draftId:i,block:b}):c.a.createElement("div",{key:a.id,className:["course-content-box","learning-goals"!==a.type&&"ked_boxed"].filter((function(e){return!!e})).join(" "),style:{position:"relative"}},c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("p",{className:"box-mini-label"},Ee[a.type])),c.a.createElement(fe.a,null,m?c.a.createElement(c.a.Fragment,null," ",c.a.createElement("input",{type:"checkbox",checked:!g&&!a.locked||f,disabled:f||g,onChange:function(e){return r.courseContents.update(a,{locked:!e.target.checked})}}),Object(p.a)(nt||(nt=Object(n.e)(["Tillåt redigering"],["Tillåt redigering"]))),!g&&!a.locked||f?c.a.createElement(c.a.Fragment,null," ",c.a.createElement("input",{type:"checkbox",checked:!a.lockDelete,onChange:function(e){return r.courseContents.update(a,{lockDelete:!e.target.checked})}}),Object(p.a)(rt||(rt=Object(n.e)(["Tillåt dölja rutan"],["Tillåt dölja rutan"])))):null):null)),c.a.createElement(at,{repo:r,content:a,siblingContents:d,course:l,editMode:!0,school:o,draftId:i,courseTab:s,maxChars:$t,reportNumChars:function(e){h.dispatch(e)},block:b}),c.a.createElement("div",{style:{position:"absolute",top:0,right:0}},(m||!a.locked)&&u>0&&c.a.createElement("span",null,c.a.createElement("i",{className:"fas fa-arrow-circle-up selectable","aria-hidden":"true",onClick:function(){var e=Object(Kt.a)(d,a.id,d[u-1].id,"before");e&&r.courseContents.update(a,{order:e})}})," "),(m||!a.locked)&&u<d.length-1&&c.a.createElement("span",null,c.a.createElement("i",{className:"fas fa-arrow-circle-down selectable","aria-hidden":"true",onClick:function(){var e=Object(Kt.a)(d,a.id,d[u+1].id,"after");e&&r.courseContents.update(a,{order:e})}})," "),m||!a.lockDelete?c.a.createElement(Pt.a,{title:"standard"===o?Object(p.a)(ct||(ct=Object(n.e)(["Ta bort innehållsrutan"],["Ta bort innehållsrutan"]))):Object(p.a)(lt||(lt=Object(n.e)(["Dölj innehållsrutan"],["Dölj innehållsrutan"]))),style:{display:"inline-block"},onClick:function(){return confirm(Object(p.a)(st||(st=Object(n.e)(["Ta bort innehåll?"],["Ta bort innehåll?"]))))&&r.courseTabs.removeRelated(s,"contents",a)}}):null),"rich-text"===a.type?c.a.createElement(Gt.a,null,h.map((function(e){return c.a.createElement("div",{className:["char-counter-bottom"].concat(e>=$t?"overflowed":[]).join(" ")},Object(p.a)(ot||(ot=Object(n.e)(["Texten innehåller "," av max "," tillåtna tecken"],["Texten innehåller "," av max "," tillåtna tecken"])),e,$t))}))):void 0)},t}(c.a.Component),Yt=a(142),Xt=a(202),Jt=a(203),Qt=a(90),Zt=a(130),ea=function(e){var t=e.repo,a=e.tab;return c.a.createElement(Gt.a,null,Object(Jt.a)(Object(Xt.a)(a.tags)).map((function(e){return 0===e.length?c.a.createElement("p",null,Object(p.a)(it||(it=Object(n.e)(["Fliken är inte kopplad till något ämne / årskurs"],["Fliken är inte kopplad till något ämne / årskurs"])))):c.a.createElement("div",null,e.map((function(r){var l=r.id,s=r.name,o=r.abilities,i=r.centralContent,u=r.knowledgeRequirements;return c.a.createElement("div",{key:l},1===e.length?void 0:c.a.createElement("h1",null,s),c.a.createElement(Qt.a,{className:"larger",title:c.a.createElement("p",null,Object(p.a)(ut||(ut=Object(n.e)(["Lås flikens kunskapskrav"],["Lås flikens kunskapskrav"]))))},c.a.createElement("p",null,Object(p.a)(dt||(dt=Object(n.e)(["Markera de kunskapskrav som ämnesfliken ska täcka."],["Markera de kunskapskrav som ämnesfliken ska täcka."])))),c.a.createElement(Gt.a,null,t["knowledge-requirements"].hasEdgesFrom([a.id]).idsOnly().toValue().map((function(e){return c.a.createElement(Yt.a,{knowledgeRequirements:u,markedIds:e.map((function(e){return e.id})),markMode:!0,onMarkChanged:function(n,r){e.filter((function(e){return!u.some((function(t){var a=t.id;return e.id===a}))})).forEach((function(e){t.courseTabs.removeRelated(a,"knowledgeRequirements",e)}));var c=u.filter((function(e){return e.id===n}))[0];r?t.courseTabs.addRelated(a,"knowledgeRequirements",c):t.courseTabs.removeRelated(a,"knowledgeRequirements",c)}})})))),c.a.createElement(Gt.a,null,t.abilities.hasEdgesFrom([a.id]).idsOnly().toValue().map((function(e){return c.a.createElement(Zt.a,{options:o,title:Object(p.a)(bt||(bt=Object(n.e)(["Lås flikens förmågor"],["Lås flikens förmågor"]))),markedIds:e.map((function(e){return e.id})),markMode:!0,onMarkChanged:function(n,r){e.filter((function(e){return!o.some((function(t){var a=t.id;return e.id===a}))})).forEach((function(e){t.courseTabs.removeRelated(a,"abilities",e)}));var c=o.filter((function(e){return e.id===n}))[0];r?t.courseTabs.addRelated(a,"abilities",c):t.courseTabs.removeRelated(a,"abilities",c)}})}))),c.a.createElement(Gt.a,null,t["central-content"].hasEdgesFrom([a.id]).idsOnly().toValue().map((function(e){return c.a.createElement(Zt.a,{options:i,title:Object(p.a)(mt||(mt=Object(n.e)(["Lås flikens centrala innehåll"],["Lås flikens centrala innehåll"]))),markedIds:e.map((function(e){return e.id})),markMode:!0,onMarkChanged:function(n,r){e.filter((function(e){return!i.some((function(t){var a=t.id;return e.id===a}))})).forEach((function(e){t.courseTabs.removeRelated(a,"centralContent",e)}));var c=i.filter((function(e){return e.id===n}))[0];r?t.courseTabs.addRelated(a,"centralContent",c):t.courseTabs.removeRelated(a,"centralContent",c)}})}))))})))})))},ta=function(e){var t=e.tab,a=e.repo,r=e.course,l=e.block,s=t.subject?t.subject:"theme-course"===r.type&&r.subjects&&r.subjects.length>0?{subjectCode:r.subjects[0].code,subjectName:r.subjects[0].name}:"step-course"===r.type?{subjectCode:r.subject.subjectCode,subjectName:r.subject.subjectName}:{subjectCode:"",subjectName:""},o=s.subjectCode,i=s.subjectName,u=Object(je.e)(r.tags),d=Object(je.e)(t.tags)[0]||u[0]||null;return c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("p",{className:"box-mini-label"},Object(p.a)(pt||(pt=Object(n.e)(["Administrativa Inställningar för fliken ",""],["Administrativa Inställningar för fliken ",""])),t.name||t.tabTitle)),c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("input",{type:"checkbox",checked:t.locked,onChange:function(e){return a.courseTabs.update(t,{locked:!!e.target.checked})}})),c.a.createElement(fe.a,null,Object(p.a)(ft||(ft=Object(n.e)(["Lås fliken från redigering förutom där det explicit tillåts"],["Lås fliken från redigering förutom där det explicit tillåts"]))))),"step-course"===r.type&&c.a.createElement(c.a.Fragment,null,c.a.createElement("br",null),c.a.createElement(Qt.a,{title:Object(p.a)(gt||(gt=Object(n.e)(["Avancerat..."],["Avancerat..."])))},c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(t){switch(t.label){case 0:return e=Object(je.e)(l.tags)[0],[4,b(r,r.subject.subjectName,r.subject.subjectCode,e)];case 1:return t.sent(),[2]}}))}))}},Object(p.a)(ht||(ht=Object(n.e)(["Gör om kopplingen till ämne och årskursspann"],["Gör om kopplingen till ämne och årskursspann"])))))),"theme-course"===r.type&&"subject-tab"===t.tabClass&&!!o&&c.a.createElement(c.a.Fragment,null,c.a.createElement("br",null),r.subjects.length>1&&c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("label",{className:"kclabel"},Object(p.a)(jt||(jt=Object(n.e)(["Ämne"],["Ämne"]))))),c.a.createElement(fe.a,null,c.a.createElement("select",{value:o,onChange:function(e){return Object(n.b)(void 0,void 0,void 0,(function(){var t,a;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=e.target.value,a=r.subjects.filter((function(e){return e.code===t})).map((function(e){return e.name}))[0]||t,[4,b(r,a,t,d)];case 1:return n.sent(),[2]}}))}))}},r.subjects.map((function(e){var t=e.name,a=e.code;return c.a.createElement("option",{key:a,value:a},t)}))))),u.length>1&&c.a.createElement(c.a.Fragment,null,c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("label",{className:"kclabel"},Object(p.a)(kt||(kt=Object(n.e)(["Välj årskurs"],["Välj årskurs"]))))),c.a.createElement(fe.a,null,c.a.createElement("select",{value:d,onChange:function(e){return Object(n.b)(void 0,void 0,void 0,(function(){var t,a;return Object(n.d)(this,(function(n){switch(n.label){case 0:return t=e.target.value,a=r.subjects.filter((function(e){return e.code===o})).map((function(e){return e.name}))[0]||o,[4,b(r,a,o,t)];case 1:return n.sent(),[2]}}))}))}},u.map((function(e){return c.a.createElement("option",{key:e,value:e},Object(p.a)(Ot||(Ot=Object(n.e)(["Årskurs ",""],["Årskurs ",""])),e))}))))),c.a.createElement("div",null,c.a.createElement(ea,{repo:a,tab:t})),c.a.createElement("br",null),c.a.createElement(Qt.a,{title:Object(p.a)(Et||(Et=Object(n.e)(["Avancerat..."],["Avancerat..."])))},c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return[4,b(r,i,o,d)];case 1:return e.sent(),[2]}}))}))}},Object(p.a)(vt||(vt=Object(n.e)(["Gör om kopplingen till ämne och årskursspann"],["Gör om kopplingen till ämne och årskursspann"]))))))));function b(e,r,c,l){return Object(n.b)(this,void 0,void 0,(function(){var s,o,i,u,d,b,m,f,g;return Object(n.d)(this,(function(h){switch(h.label){case 0:return s=Object(je.a)(t.tags,[c],[l]),a.courseTabs.update(t,{subject:{subjectCode:c,subjectName:r},tags:s}),[4,a.courseContents.hasEdgesFrom([t.id]).include("tasks").includeIdsAndNamesOnly().toValue().load()];case 1:o=h.sent(),i=Object(p.k)(o.map((function(e){return e.tasks})));try{for(u=Object(n.j)(i),d=u.next();!d.done;d=u.next())b=d.value,m=Object(je.a)([e.id],[c],[l]),a.tasks.update(b,{tags:m,subject:r})}catch(e){f={error:e}}finally{try{d&&!d.done&&(g=u.return)&&g.call(u)}finally{if(f)throw f.error}}return[2]}}))}))}},aa=a(124),na=a(190),ra=a(160),ca=function(e){var t=e.contents,a=e.schoolName,l=e.courseId,s=e.tab,o=e.repo,i=e.block;var u=Object(p.k)(t.filter((function(e){return"resource-list"===e.type})).map((function(e){return e})).map((function(e){var t=e.resources;return t.map((function(a,n){return{resource:a,id:t.length>1?n.toString():e.id,resourceListContent:e,name:a.name,order:a.order||(new Date).setHours(n)}}))}))).sort(Object(p.h)("order"));var d=Object(r.useContext)(aa.a);return c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h4",null,Object(p.a)(yt||(yt=Object(n.e)(["Resurser"],["Resurser"])))),c.a.createElement("div",null,u&&Object(ra.a)({objectList:u,renderEditLink:function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{className:"editItem",onClick:function(){return function(e){var t=e.resourceListContent;d.openDialog(c.a.createElement(na.a,{title:"Edit resource",resource:e.resource,onSave:function(e){var a=Object(n.h)(t.resources);a[0]=e,o.courseContents.update(t,{resources:a}),d.closeDialog()},onDelete:function(){1===t.resources.length?o.courseTabs.removeRelated(s,"contents",t):o.courseContents.update(t,{resources:t.resources.filter((function(t,a){return a.toString()!==e.id}))}),d.closeDialog()}}))}(e)}})," ")},renderLink:function(e){return c.a.createElement("a",{target:"_blank",href:e.resource.url},e.resource.name)},onSort:function(e,t,a){return function(e,t,a){var n=Object(Kt.a)(u,e.id,t,a);if(n){var r=e.resourceListContent.resources;(r.length>1?r.find((function(t,a){return a.toString()===e.id})):r[0]).order=n,o.courseContents.update(e.resourceListContent,{resources:r})}}(e,t.id,a)}}),c.a.createElement("a",{className:"btn",onClick:function(){return d.openDialog(c.a.createElement(na.a,{title:"Resurs",onSave:function(e){e.order=Date.now(),o.courseTabs.addRelated(s,"contents",{type:"resource-list",id:Object(h.i)(),resources:[e],order:Date.now(),locked:!1,lockDelete:!1,hidden:!1,tags:[l,i&&"step-course-tab"===s.type?"blockStep:"+i.id+":"+s.stepNo:"tab:"+s.id],acl:["role:USER:R","schoolRole:"+a+"/EMPLOYEE:S"]}),d.closeDialog()}}))}},c.a.createElement("i",{className:"fas fa-plus","aria-hidden":"true"}),Object(p.a)(It||(It=Object(n.e)(["Lägg till resurs"],["Lägg till resurs"]))))))},la=a(136),sa=function(e){var t=e.course,a=e.branch,c=e.block,l=e.tab,s=e.editMode,o=e.contents,i=e.school,u=e.draftId;return l?(o=o.slice().sort(Object(p.g)("order")),r.createElement("div",null,s?r.createElement(r.Fragment,null,O()||!l.locked?r.createElement(Oe,{course:t,tab:l,repo:a}):null,O()?r.createElement(ta,{course:t,tab:l,repo:a,block:c}):null):r.createElement(la.a,null),o.filter((function(e){return"resource-list"!==e.type})).map((function(e,n){return r.createElement(Wt,{key:e.id,content:e,branch:a,contentOrderIndex:n,contents:o,course:t,draftId:u,editMode:s,school:i,block:c,tab:l})})),!!s&&r.createElement(ca,{schoolName:i,courseId:t.id,tab:l,repo:a,contents:o,block:c}),!!s&&(O()||!l.locked)&&r.createElement(r.Fragment,null,"word-bank-tab"===l.tabClass&&r.createElement(me,{type:"word-bank",tab:l,branch:a,course:t,schoolName:i,courseBlock:c}),"word-bank-tab"!==l.tabClass&&("mission-tab"===l.tabClass||"subject-tab"===l.tabClass||"step-course"===t.type)&&!o.some((function(e){return"learning-goals"===e.type}))&&r.createElement(me,{type:"learning-goals",tab:l,branch:a,course:t,schoolName:i,courseBlock:c}),r.createElement(me,{type:"rich-text",tab:l,branch:a,course:t,schoolName:i,courseBlock:c}),"intro-tab"===l.tabClass||"run-up-tab"===l.tabClass&&r.createElement(me,{type:"embedded-html",tab:l,branch:a,course:t,schoolName:i,courseBlock:c})))):s?r.createElement("p",null,Object(p.a)(Nt||(Nt=Object(n.e)(["Denna kurs saknar innehåll. Skapa ny flik genom knappen ovan"],["Denna kurs saknar innehåll. Skapa ny flik genom knappen ovan"])))):O()?r.createElement("p",null,Object(p.a)(Tt||(Tt=Object(n.e)(["Denna kurs saknar innehåll. Välj Redigera knappen för att lägga till flikar."],["Denna kurs saknar innehåll. Välj Redigera knappen för att lägga till flikar."])))):r.createElement("p",null,Object(p.a)(Ct||(Ct=Object(n.e)(["Denna kurs saknar innehåll."],["Denna kurs saknar innehåll."]))))},oa=a(164),ia=a(92),ua=function(e){var t=e.repo,a=void 0===t?null:t,r=e.tab,l=void 0===r?null:r;return c.a.createElement("div",{className:"btn pull-right",onClick:function(e){return a.courseTabs.update(l,{hidden:!l.hidden})}},l.hidden?Object(p.a)(wt||(wt=Object(n.e)(["Visa fliken"],["Visa fliken"]))):Object(p.a)(St||(St=Object(n.e)(["Dölj fliken"],["Dölj fliken"]))))},da=Object(j.a)((function(e){var t=e.school,a=e.course,r=e.tab,l=e.activeTab,s=e.draftId,o=e.history,i=e.courseType,u=e.block;return c.a.createElement(c.a.Fragment,null,r&&(O()||!r.locked||a.allowRemoveTabs)&&("standard"!==t?c.a.createElement(ua,{repo:b.c.branch(s),tab:r}):c.a.createElement("div",{className:"btn btn-warning pull-right",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){var e,r;return Object(n.d)(this,(function(n){switch(n.label){case 0:return[4,(e=b.c.branch(s)).courseTabs.include("contents").includeIdsOnly().id(l).load()];case 1:return r=n.sent(),[4,e.courseContents.include("tasks").includeIdsOnly().ids(r.contents.map((function(e){return e.id}))).toValue().load()];case 2:return n.sent().forEach((function(t){t.tasks.forEach((function(a){e.courseContents.removeRelated(t,"tasks",a)}))})),r.contents.forEach((function(t){e.courseTabs.removeRelated(r,"contents",t)})),"theme-course"===i?e.courseInstances.removeRelated(a,"tabs",r):u&&e.courseBlocks.removeRelated(u,"tabs",r),[4,b.c.saveNow()];case 3:return n.sent(),o.push("/"+t+"/courses/"+a.id+"/tabs/$/drafts/"+s+"/edit"),[2]}}))}))}},c.a.createElement("i",{className:"fas fa-trash-alt","aria-hidden":!0})," ",Object(p.a)(Rt||(Rt=Object(n.e)(["Ta bort fliken"],["Ta bort fliken"]))))),c.a.createElement("div",null,c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){return o.push("/"+t+"/courses/"+a.id+"/tabs/"+(l||"$")+"/drafts/"+s),[2]}))}))}},c.a.createElement("i",{className:"fas fa-eye","aria-hidden":!0})," ",Object(p.a)(Lt||(Lt=Object(n.e)(["Förhandsgranska"],["Förhandsgranska"]))))),c.a.createElement(fe.a,null," ",c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){return o.push("/"+t+"/courses/"+a.id+"/history"),[2]}))}))}},c.a.createElement("i",{className:"fas fa-history","aria-hidden":!0})," ",Object(p.a)(xt||(xt=Object(n.e)(["Versionshistorik"],["Versionshistorik"]))))),c.a.createElement(fe.a,null," ",c.a.createElement("button",{className:"btn btn-warning",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return ia.b.KDT592?[4,Object(oa.a)({school:t,course:a,tab:r,draftRepo:b.c.branch(s)})]:[3,3];case 1:return e.sent(),[4,b.c.saveNow()];case 2:return e.sent(),Object(p.o)(Object(p.a)(Mt||(Mt=Object(n.e)(["Ändringarna publicerades."],["Ändringarna publicerades."])))),[3,6];case 3:return[4,Object(oa.b)({school:t,course:a,draftRepo:b.c.branch(s)})];case 4:return e.sent(),[4,b.c.saveNow()];case 5:e.sent(),o.push("/"+t+"/courses/"+a.id+"/tabs/"+(l||"$")),e.label=6;case 6:return[2]}}))}))}},c.a.createElement("i",{className:"fas fa-play","aria-hidden":!0})," ",Object(p.a)(Dt||(Dt=Object(n.e)(["Publicera"],["Publicera"]))))))),c.a.createElement("br",null),c.a.createElement("button",{className:"btn",onClick:function(){return o.push("/"+t+"/courses/"+a.id+"/tabs/"+(l||"$"))}},c.a.createElement("i",{className:"fas fa-arrow-left","aria-hidden":!0})," ",Object(p.a)(At||(At=Object(n.e)(["Avsluta redigering"],["Avsluta redigering"])))))})),ba=Object(j.a)(Object(ue.a)((function(e){var t=e.editMode,a=e.school,c=e.course,l=e.courseId,s=e.branch,o=e.tab,i=e.draftId,u=e.block,d=e.activeTab,m=e.history,f=o?s.courseContents.include("tasks").hasEdgesFrom([o.id]).toValue().read():[];return r.createElement(r.Fragment,null,r.createElement(sa,{school:a,course:c,branch:s,tab:o,editMode:t,draftId:i,block:u,contents:f}),t?r.createElement(r.Fragment,null,r.createElement("br",null),r.createElement("hr",null),r.createElement(da,{school:a,course:c,tab:o,activeTab:d,draftId:i,courseType:c.type,block:u})):k.b.currentUser.roles.includes("ADMIN")||Object(g.e)(k.b.currentUser,a)?r.createElement(r.Fragment,null,r.createElement("br",null),r.createElement("hr",null),r.createElement(pe.a,null,i&&r.createElement(fe.a,null,r.createElement("button",{className:"btn btn-large btn-warning",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return ia.b.KDT592?[4,Object(oa.a)({school:a,tab:o,course:c,draftRepo:b.c.branch(i)})]:[3,3];case 1:return e.sent(),[4,b.c.saveNow()];case 2:return e.sent(),m.push("/"+a+"/courses/"+l+"/tabs/"+(o?o.id:"$")),[3,6];case 3:return[4,Object(oa.b)({school:a,course:c,draftRepo:b.c.branch(i)})];case 4:return e.sent(),[4,b.c.saveNow()];case 5:e.sent(),m.push("/"+a+"/courses/"+c.id+"/tabs/"+(d||"$")),e.label=6;case 6:return[2]}}))}))}},r.createElement("i",{className:"fas fa-lg fa-play","aria-hidden":!0})," ",Object(p.a)(Ft||(Ft=Object(n.e)(["Publicera"],["Publicera"]))))),r.createElement(Gt.a,null,b.a.getBranchId(b.c.schools.cacheOptimized().name(a).single(),l).map((function(e){return r.createElement(r.Fragment,null,r.createElement(fe.a,null,r.createElement("button",{className:"btn btn-large",onClick:e?function(){return m.push("/"+a+"/courses/"+l+"/tabs/"+(o?o.id:"$")+"/drafts/"+e+"/edit")}:function(){return Object(n.b)(void 0,void 0,void 0,(function(){var e,t,r,c;return Object(n.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,b.c.schools.name(a).single().load()];case 1:return e=n.sent(),[4,Object(h.h)(e.officialBranchId+l+"draft")];case 2:return t=n.sent(),r={id:t,acl:["role:USER:R","schoolRole:"+e.name+"/EMPLOYEE:S"],name:"draft",schoolId:e.id,treeParentId:e.officialBranchId,tags:[l]},b.c.branches.addRelated({id:e.officialBranchId},"approvedChildren",r),[4,b.c.saveNow()];case 3:return n.sent(),m.push("/"+a+"/courses/"+l+"/tabs/"+(o?o.id:"$")+"/drafts/"+t+"/edit"),[3,5];case 4:return c=n.sent(),Object(p.n)(c),[3,5];case 5:return[2]}}))}))}},e?r.createElement(r.Fragment,null,r.createElement("i",{className:"fas fa-lg fa-pencil-alt"})," ",i?Object(p.a)(_t||(_t=Object(n.e)(["Fortsätt redigera"],["Fortsätt redigera"]))):Object(p.a)(Ut||(Ut=Object(n.e)(["Redigera"],["Redigera"])))):r.createElement(r.Fragment,null,r.createElement("i",{className:"fas fa-lg fa-plus"})," ",Object(p.a)(Bt||(Bt=Object(n.e)(["Skapa skolans version av kursen"],["Skapa skolans version av kursen"])))))),i||!e?void 0:r.createElement(fe.a,null,r.createElement("button",{className:"btn btn-large",onClick:function(){return m.push("/"+a+"/courses/"+l+"/tabs/"+(o?o.id:"$")+"/drafts/"+e)}},r.createElement("i",{className:"fas fa-eye"})," ",Object(p.a)(Vt||(Vt=Object(n.e)(["Visa redigerad version"],["Visa redigerad version"]))))))}))),i&&r.createElement(fe.a,null,r.createElement("button",{className:"btn btn-large",onClick:function(){m.push("/"+a+"/courses/"+l+"/tabs/"+(o?o.id:"$"))}},r.createElement("i",{className:"fas fa-lg fa-arrow-left"})," ",t?Object(p.a)(Ht||(Ht=Object(n.e)(["Avsluta redigering"],["Avsluta redigering"]))):Object(p.a)(qt||(qt=Object(n.e)(["Avsluta förhandsgranskning"],["Avsluta förhandsgranskning"]))))))):void 0)})));function ma(e,t){var a,r;try{for(var c=Object(n.j)(e),l=c.next();!l.done;l=c.next()){var s=l.value;"modify"===s.type?fa(s,t):pa(s,t)}}catch(e){a={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(a)throw a.error}}}function pa(e,t){b.c.branch(t).table(e.sourceTable).undoLink(e.sourceId,e.label,e.targetId)}function fa(e,t){var a={};Object.keys(e.data).forEach((function(e){a[e]={$unset:0}})),b.c.branch(t).table(e.table).update({id:e.targetId,name:e.targetName,tags:e.targetTags},a)}function ga(e){var t=this,a=e.deltas,r=e.label,l=e.confirmMsg,s=e.branchId;return c.a.createElement("button",{className:"btn btn-large btn-warning",onClick:function(){return Object(n.b)(t,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return l&&!confirm(l)?[3,2]:(ma(a,s),[4,b.c.saveNow()]);case 1:e.sent(),location.reload(),e.label=2;case 2:return[2]}}))}))}},r)}var ha,ja,ka,Oa,Ea,va,ya,Ia,Na,Ta,Ca,wa,Sa,Ra,La,xa,Ma,Da,Aa,Fa,_a,Ua,Ba,Va,Ha,qa,Pa,Ga,Ka,za,$a,Wa,Ya,Xa,Ja,Qa,Za,en,tn,an,nn,rn,cn,ln,sn,on,un,dn,bn,mn,pn,fn,gn,hn,jn,kn,On,En,vn,yn,In,Nn,Tn,Cn,wn,Sn,Rn,Ln,xn,Mn,Dn,An,Fn,_n,Un,Bn,Vn,Hn,qn,Pn,Gn,Kn,zn,$n,Wn,Yn,Xn,Jn,Qn=Symbol("TypeText"),Zn=Symbol("TypeCheckbox"),er=Symbol("TypeObsure"),tr=Symbol("TypeHiddenChange"),ar=Symbol("TypeHtml"),nr={Text:Qn,Html:ar,Checkbox:Zn,Obscure:er,HiddenChange:tr},rr={entityTypes:{courseBlocks:Object(p.a)(ha||(ha=Object(n.e)(["kursblock"],["kursblock"]))),courseContents:Object(p.a)(ja||(ja=Object(n.e)(["innehållsruta"],["innehållsruta"]))),courseInstances:Object(p.a)(ka||(ka=Object(n.e)(["kurs"],["kurs"]))),courseTabs:Object(p.a)(Oa||(Oa=Object(n.e)(["flik"],["flik"]))),schools:Object(p.a)(Ea||(Ea=Object(n.e)(["skola"],["skola"]))),tasks:Object(p.a)(va||(va=Object(n.e)(["uppgift"],["uppgift"])))},modifiedLinks:{tabs:[Object(p.a)(ya||(ya=Object(n.e)(["Tillagd flik"],["Tillagd flik"]))),Object(p.a)(Ia||(Ia=Object(n.e)(["Borttagen flik"],["Borttagen flik"]))),Object(p.a)(Na||(Na=Object(n.e)(["Dold flik"],["Dold flik"])))],blocks:[Object(p.a)(Ta||(Ta=Object(n.e)(["Tillagt block"],["Tillagt block"]))),Object(p.a)(Ca||(Ca=Object(n.e)(["Borttaget block"],["Borttaget block"]))),Object(p.a)(wa||(wa=Object(n.e)(["Dold block"],["Dold block"])))],abilities:[Object(p.a)(Sa||(Sa=Object(n.e)(["Tillagd förmåga"],["Tillagd förmåga"]))),Object(p.a)(Ra||(Ra=Object(n.e)(["Borttagen förmåga"],["Borttagen förmåga"]))),Object(p.a)(La||(La=Object(n.e)(["Dold förmåga"],["Dold förmåga"])))],centralContent:[Object(p.a)(xa||(xa=Object(n.e)(["Tillagt centralt innehåll"],["Tillagt centralt innehåll"]))),Object(p.a)(Ma||(Ma=Object(n.e)(["Borttaget centralt innehåll"],["Borttaget centralt innehåll"]))),Object(p.a)(Da||(Da=Object(n.e)(["Dold centralt innehåll"],["Dold centralt innehåll"])))],knowledgeRequirements:[Object(p.a)(Aa||(Aa=Object(n.e)(["Tillagt kunskapskrav"],["Tillagt kunskapskrav"]))),Object(p.a)(Fa||(Fa=Object(n.e)(["Borttaget kunskapskrav"],["Borttaget kunskapskrav"]))),Object(p.a)(_a||(_a=Object(n.e)(["Dold kunskapskrav"],["Dold kunskapskrav"])))],tasks:[Object(p.a)(Ua||(Ua=Object(n.e)(["Tillagd uppgift"],["Tillagd uppgift"]))),Object(p.a)(Ba||(Ba=Object(n.e)(["Borttagen uppgift"],["Borttagen uppgift"]))),Object(p.a)(Va||(Va=Object(n.e)(["Dold uppgift"],["Dold uppgift"])))],contents:[Object(p.a)(Ha||(Ha=Object(n.e)(["Tillagd innehållsruta"],["Tillagd innehållsruta"]))),Object(p.a)(qa||(qa=Object(n.e)(["Borttagen innehållsruta"],["Borttagen innehållsruta"]))),Object(p.a)(Pa||(Pa=Object(n.e)(["Dold innehållsruta"],["Dold innehållsruta"])))]},propertyNames:{allowAddTabs:[Zn,Object(p.a)(Ga||(Ga=Object(n.e)(["Ändrat om tillägg av flik ska vara tillåtet"],["Ändrat om tillägg av flik ska vara tillåtet"])))],allowRemoveTabs:[Zn,Object(p.a)(Ka||(Ka=Object(n.e)(["Ändrat om borttagning av flik ska vara tillåtet"],["Ändrat om borttagning av flik ska vara tillåtet"])))],allowReorderTabs:[Zn,Object(p.a)(za||(za=Object(n.e)(["Ändrat om det ska va tillåtet att ändra ordning på flik"],["Ändrat om det ska va tillåtet att ändra ordning på flik"])))],assignment:[Zn,Object(p.a)($a||($a=Object(n.e)(["Ändrad flagga för inlämningsuppgift"],["Ändrad flagga för inlämningsuppgift"])))],commonLearningGoals:[Qn,Object(p.a)(Wa||(Wa=Object(n.e)(["Ändrade gemensamma lärandemål"],["Ändrade gemensamma lärandemål"])))],content:[ar,Object(p.a)(Ya||(Ya=Object(n.e)(["Ändrad innehållstext"],["Ändrad innehållstext"])))],createdBy:[tr,Object(p.a)(Xa||(Xa=Object(n.e)(["Skapad av"],["Skapad av"])))],createdDate:[tr,Object(p.a)(Ja||(Ja=Object(n.e)(["Skapad datum"],["Skapad datum"])))],dateTime:[er,Object(p.a)(Qa||(Qa=Object(n.e)(["Ändat datum / tid"],["Ändat datum / tid"])))],deadline:[Qn,Object(p.a)(Za||(Za=Object(n.e)(["Ändrat inlämningsdatum"],["Ändrat inlämningsdatum"])))],description:[ar,Object(p.a)(en||(en=Object(n.e)(["Ändrad beskrivning"],["Ändrad beskrivning"])))],embeddedHtml:[er,Object(p.a)(tn||(tn=Object(n.e)(["Lagt till inbäddad HTML"],["Lagt till inbäddad HTML"])))],explainedRequirements:[er,Object(p.a)(an||(an=Object(n.e)(["Lagt till egna förklaringar av kunskapskrav"],["Lagt till egna förklaringar av kunskapskrav"])))],futureAbilities:[Qn,Object(p.a)(nn||(nn=Object(n.e)(["Ändrade framtidsförmågor"],["Ändrade framtidsförmågor"])))],hasCommonLearningGoals:[Zn,Object(p.a)(rn||(rn=Object(n.e)(["Ändrad inställning för gemensamma lärandemål"],["Ändrad inställning för gemensamma lärandemål"])))],hidden:[Zn,Object(p.a)(cn||(cn=Object(n.e)(['Ändrad flagga "gömd"'],['Ändrad flagga "gömd"'])))],hiddenTasks:[er,Object(p.a)(ln||(ln=Object(n.e)(["Ändrat listan på gömda uppgifter"],["Ändrat listan på gömda uppgifter"])))],html:[er,Object(p.a)(sn||(sn=Object(n.e)(["Ändrat innehåll"],["Ändrat innehåll"])))],learningGoal:[Qn,Object(p.a)(on||(on=Object(n.e)(["Lärandemål"],["Lärandemål"])))],lockDelete:[Zn,Object(p.a)(un||(un=Object(n.e)(['Ändrat flagga: "lås från borttagning"'],['Ändrat flagga: "lås från borttagning"'])))],locked:[Zn,Object(p.a)(dn||(dn=Object(n.e)(['Ändrad flagga: "förbjud ändring av flikar"'],['Ändrad flagga: "förbjud ändring av flikar"'])))],migratedTexts:[er,Object(p.a)(bn||(bn=Object(n.e)(["Ändringar i migrerade texter från skolverket"],["Ändringar i migrerade texter från skolverket"])))],modifiedBy:[tr,Object(p.a)(mn||(mn=Object(n.e)(["Ändrad av"],["Ändrad av"])))],modifiedDate:[tr,Object(p.a)(pn||(pn=Object(n.e)(["Ändringsdatum"],["Ändringsdatum"])))],taskOrder:[er,Object(p.a)(fn||(fn=Object(n.e)(["Ändrad ordning på uppgifter"],["Ändrad ordning på uppgifter"])))],name:[Qn,Object(p.a)(gn||(gn=Object(n.e)(["Ändrat namn"],["Ändrat namn"])))],order:[er,Object(p.a)(hn||(hn=Object(n.e)(["Ändrad ordning"],["Ändrad ordning"])))],resources:[er,Object(p.a)(jn||(jn=Object(n.e)(["Ändrade i resurser"],["Ändrade i resurser"])))],school:[Qn,Object(p.a)(kn||(kn=Object(n.e)(["Skola"],["Skola"])))],stepNo:[Qn,Object(p.a)(On||(On=Object(n.e)(["Stegnummer"],["Stegnummer"])))],stepNumbers:[Qn,Object(p.a)(En||(En=Object(n.e)(["Stegnummer"],["Stegnummer"])))],subject:[Qn,Object(p.a)(vn||(vn=Object(n.e)(["Ämne"],["Ämne"])))],subjects:[er,Object(p.a)(yn||(yn=Object(n.e)(["Ämnen"],["Ämnen"])))],tabClass:[Qn,Object(p.a)(In||(In=Object(n.e)(["Typ av flik"],["Typ av flik"])))],tabTitle:[tr,Object(p.a)(Nn||(Nn=Object(n.e)(["Fliknamn"],["Fliknamn"])))],taskType:[Qn,Object(p.a)(Tn||(Tn=Object(n.e)(["Uppgiftstyp"],["Uppgiftstyp"])))],url:[Qn,Object(p.a)(Cn||(Cn=Object(n.e)(["Url"],["Url"])))],workingProcedure:[ar,Object(p.a)(wn||(wn=Object(n.e)(["Arbetsprocess"],["Arbetsprocess"])))],youtubeId:[er,Object(p.a)(Sn||(Sn=Object(n.e)(["Youtube ID"],["Youtube ID"])))]},getModifiedLinkHeading:function(e,t){var a=rr.modifiedLinks[e.label];return a?"add"===e.type?a[0]:"remove"===e.type?t?a[2]:a[1]:Object(p.a)(Mn||(Mn=Object(n.e)(["Ångrad länkning"],["Ångrad länkning"]))):"add"===e.type?Object(p.a)(Rn||(Rn=Object(n.e)(["Tillagt objekt"],["Tillagt objekt"]))):"remove"===e.type?Object(p.a)(Ln||(Ln=Object(n.e)(["Borttaget objekt"],["Borttaget objekt"]))):Object(p.a)(xn||(xn=Object(n.e)(["Ångrad länkning"],["Ångrad länkning"])))},getPropVal:function(e,t,a){switch(e){case!0:return Object(p.a)(Dn||(Dn=Object(n.e)(["Påslaget"],["Påslaget"])));case!1:return Object(p.a)(An||(An=Object(n.e)(["Avslaget"],["Avslaget"])));case"primary":return Object(p.a)(Fn||(Fn=Object(n.e)(["Grundskola"],["Grundskola"])));case"gymnasium":return Object(p.a)(_n||(_n=Object(n.e)(["Gymnasieskola"],["Gymnasieskola"])));case"exercise":return Object(p.a)(Un||(Un=Object(n.e)(["Övningsuppgift"],["Övningsuppgift"])));case"task":return Object(p.a)(Bn||(Bn=Object(n.e)(["Uppgift"],["Uppgift"])));case"assignment":return Object(p.a)(Vn||(Vn=Object(n.e)(["Inlämningsuppgift"],["Inlämningsuppgift"])));case"theme-course":return Object(p.a)(Hn||(Hn=Object(n.e)(["Temakurs"],["Temakurs"])));case"step-course":return Object(p.a)(qn||(qn=Object(n.e)(["Stegkurs"],["Stegkurs"])));case"intro-tab":return Object(p.a)(Pn||(Pn=Object(n.e)(["Introduktionsflik"],["Introduktionsflik"])));case"run-up-tab":return Object(p.a)(Gn||(Gn=Object(n.e)(["Upptakt"],["Upptakt"])));case"subject-tab":return Object(p.a)(Kn||(Kn=Object(n.e)(["Ämnesflik"],["Ämnesflik"])));case"mission-tab":return Object(p.a)(zn||(zn=Object(n.e)(["Uppdragsflik"],["Uppdragsflik"])));case"content-tab":return Object(p.a)($n||($n=Object(n.e)(["Innehållsflik"],["Innehållsflik"])));case"teacher-tab":return Object(p.a)(Wn||(Wn=Object(n.e)(["Lärarsida"],["Lärarsida"])));case"word-bank-tab":return Object(p.a)(Yn||(Yn=Object(n.e)(["Ordbank"],["Ordbank"])));default:return null==e?Object(p.a)(Xn||(Xn=Object(n.e)(["Nollställt"],["Nollställt"]))):""===e?Object(p.a)(Jn||(Jn=Object(n.e)(["(tomt)"],["(tomt)"]))):t===ar?Object(p.l)(cr(e),300):"string"==typeof e?e:e.subjectName?e.subjectName:JSON.stringify(e,null,2)}}};function cr(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}var lr,sr=a(91);function or(e){var t=e.delta,a=e.editable,r=e.onDelete,l=t.targetName&&Object(p.l)(t.targetName,80),s=["schoolCourse"];t.$meta&&s.push("entitymeta-"+t.$meta);var o=Object(p.d)(rr.entityTypes[t.table]||t.table),i=Object.keys(t.data).map((function(e){return{propSpec:rr.propertyNames[e],prop:e}})),u=i.some((function(e){return!e.propSpec}));return c.a.createElement("div",{className:s.join(" ")},c.a.createElement("div",{className:"align-horizontal"},a?c.a.createElement("div",{className:"horizontalItem top pull-right"},c.a.createElement("a",{className:"undo",onClick:r},c.a.createElement("i",{className:"fas fa-undo"}))):null,c.a.createElement("div",{className:"horizontalItem top"},l?c.a.createElement("a",null,o,' "',l,'"'):c.a.createElement("a",null,o))),i.filter((function(e){return e.propSpec})).map((function(e){var a=Object(n.f)(e.propSpec,2),r=a[0],l=a[1],s=e.prop;return c.a.createElement("div",{key:s},r===nr.Obscure?c.a.createElement("p",null,l):r===nr.HiddenChange?null:c.a.createElement("p",null,l,": ",rr.getPropVal(t.data[s],r,s)))})),u?c.a.createElement("div",null,c.a.createElement("p",{title:JSON.stringify(t.data,null,4)},Object(p.a)(lr||(lr=Object(n.e)(["Ändringar i interna egenskaper"],["Ändringar i interna egenskaper"]))))):null,c.a.createElement("div",null,c.a.createElement("p",{className:"small"},Object(sr.h)(t.dateTime)," ",t.contributors.join(", "))))}function ir(e){var t=e.delta,a=e.editable,n=e.onDelete,r=t.targetName&&Object(p.l)(cr(t.targetName),80),l=["schoolCourse"];t.$meta&&l.push("entitymeta-"+t.$meta);var s=rr.getModifiedLinkHeading(t,a);return c.a.createElement("div",{className:l.join(" ")},c.a.createElement("div",{className:"align-horizontal"},a?c.a.createElement("div",{className:"horizontalItem top pull-right"},c.a.createElement("a",{className:"undo",onClick:n},c.a.createElement("i",{className:"fas fa-undo"}))):null,c.a.createElement("div",{className:"horizontalItem top"},r?c.a.createElement("a",null,s,' "',r,'"'):c.a.createElement("a",null,s))),c.a.createElement("div",null,c.a.createElement("p",{className:"small"},Object(sr.h)(t.dateTime)," ",t.contributor)))}function ur(e){var t=this,a=e.deltas,r=e.editable,l=e.branchId;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"taskContainer odd-even"},a.map((function(e){var a=function(e){return"modify"===e.type?e.targetId:e.sourceId+e.label+e.targetId}(e);return"modify"===e.type?c.a.createElement(or,{delta:e,editable:r,key:a,onDelete:function(){return Object(n.b)(t,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:return fa(e,l),[4,b.c.saveNow()];case 1:return t.sent(),location.reload(),[2]}}))}))}}):c.a.createElement(ir,{delta:e,editable:r,key:a,onDelete:function(){return Object(n.b)(t,void 0,void 0,(function(){return Object(n.d)(this,(function(t){switch(t.label){case 0:return pa(e,l),[4,b.c.saveNow()];case 1:return t.sent(),location.reload(),[2]}}))}))}})}))))}var dr,br,mr,pr,fr,gr=Object(ue.a)((function(e){var t=e.branchId,a=e.allowCherryPick,r=e.partTagPrefix,l=e.partTag,s=e.partLabel,o=b.c.branch(t).deltas.toValue().read();if(!ia.b.KDT592)return c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h3",null,"Opublicerade ändringar"),0===o.length?c.a.createElement("div",null,c.a.createElement("p",{style:{opacity:.5,fontStyle:"italic"}},"Det finns inga ändringar att publicera.")):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"taskContainer odd-even"},c.a.createElement(ur,{branchId:t,deltas:o,editable:a})),c.a.createElement(ga,{label:"Radera alla opublicerade ändringar",confirmMsg:"Åtgärden raderar samtliga ändringar som ännu inte är publicerade.\n\nVill du fortsätta?",branchId:t,deltas:o})));var i=o.filter((function(e){return hr(e).includes(l)})),u=o.filter((function(e){return!hr(e).some((function(e){return e.startsWith(r)}))}));return c.a.createElement(c.a.Fragment,null,u.length>0&&c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h3",null,Object(p.a)(dr||(dr=Object(n.e)(["Opublicerade kursövergripande ändringar"],["Opublicerade kursövergripande ändringar"])))),c.a.createElement(ur,{branchId:t,deltas:u,editable:a}),c.a.createElement(ga,{branchId:t,deltas:u,label:Object(p.a)(br||(br=Object(n.e)(["Ångra kursövergripande inställningar"],["Ångra kursövergripande inställningar"])))})),c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h3",null,Object(p.a)(mr||(mr=Object(n.e)(["Opublicerade ändringar i ",""],["Opublicerade ändringar i ",""])),s)),i.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement(ur,{branchId:t,deltas:i,editable:a}),c.a.createElement(ga,{branchId:t,deltas:i,label:Object(p.a)(pr||(pr=Object(n.e)(["Ångra ändringarna i ",""],["Ångra ändringarna i ",""])),s)})):c.a.createElement("div",null,c.a.createElement("p",{style:{opacity:.5,fontStyle:"italic"}},Object(p.a)(fr||(fr=Object(n.e)(["Det finns inga ändringar att publicera."],["Det finns inga ändringar att publicera."])))))))}));function hr(e){return(e.targetTags?e.targetTags:[]).concat("sourceTags"in e&&e.sourceTags?e.sourceTags:[])}var jr,kr,Or,Er,vr,yr,Ir,Nr,Tr,Cr,wr,Sr,Rr,Lr,xr,Mr,Dr,Ar,Fr,_r,Ur=Object(oe.a)((function(e){var t=e.school,a=e.courseId,c=e.draftId,l=e.course,s=e.branch,o=e.tabs,i=e.activeTab,u=e.editMode,d=(e.history,e.block),b=o.filter((function(e){return e.id===i}))[0]||o[0],m=b&&s.courseContents.hasEdgesFrom([b.id]).filter((function(e){return"resource-list"===e.type}));return r.createElement(le.a,{right:u&&c?r.createElement("div",null,b&&r.createElement(r.Suspense,{fallback:r.createElement(et.a,null)},r.createElement(gr,{allowCherryPick:"standard"!==t,branchId:c,partTagPrefix:"step-course"===l.type?"blockStep:":"tab:",partTag:"step-course"===l.type?"blockStep:"+d.id+":"+b.stepNo:"tab:"+b.id,partLabel:"step-course"===l.type?Object(p.a)(jr||(jr=Object(n.e)(["steg ",""],["steg ",""])),b.stepNo):b.name}))):r.createElement(r.Fragment,null,r.createElement(se.a,{env:k.a,viewCourseUrl:f.b.KED_COURSE_VIEWER_URL}),m&&r.createElement(ie,{resourceListContents:m})),rightWidth:5,left:r.createElement(r.Suspense,{fallback:r.createElement(et.a,null)},r.createElement(ba,{courseId:a,editMode:u,school:t,course:l,branch:s,tab:b,draftId:c,block:d,activeTab:i}))})})),Br=a(193),Vr=a(145),Hr=a(5),qr=a.n(Hr),Pr=a(165),Gr=function(e){var t=e.task,a=e.writeAccess,r=e.repo,l=e.contentId,s=e.tab,o=s?s.tabClass:null;return c.a.createElement("div",null,c.a.createElement("div",{className:"align-horizontal spaced"},c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement("p",null,"mission-tab"===o?Object(p.a)(kr||(kr=Object(n.e)(["Uppdragets namn:"],["Uppdragets namn:"]))):Object(p.a)(Or||(Or=Object(n.e)(["Uppgiftens namn:"],["Uppgiftens namn:"]))))),c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement("input",{autoFocus:!0,type:"text",size:35,value:t.name,disabled:!a,readOnly:!a,onChange:function(e){r.tasks.update(t,{name:e.target.value.substr(0,zt.MAX_CHARS_TASK_NAMES)})}}))),t.migratedTexts&&a&&c.a.createElement(Br.a,{task:t,course:null,updateLink:function(e,t){throw new Error("Not implemented yet")}}),"mission-tab"!==o&&c.a.createElement("div",{className:"align-horizontal spaced"},c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement("p",null,Object(p.a)(Er||(Er=Object(n.e)(["Lärandemål:"],["Lärandemål:"]))))),c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement(Gt.a,null,r.courseContents.id(l).map((function(e){if("learning-goals"!==e.type)return c.a.createElement("p",null,Object(p.a)(vr||(vr=Object(n.e)(["Ej valbart"],["Ej valbart"]))));var a=e.hasCommonLearningGoals,l=e.commonLearningGoals.map((function(e){return e.trim()})).filter((function(e){return e})).map((function(e){return{name:e,key:e}}));return c.a.createElement(Pr.a,{available:l,selected:t.learningGoal.length>0?t.learningGoal.split("\n"):[],onChange:function(e,n){a?r.tasks.update(t,{learningGoal:e.join("\n")}):r.tasks.update(t,{learningGoal:n})}})}))))),c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,"mission-tab"===o?Object(p.a)(yr||(yr=Object(n.e)(["Uppdragstyp"],["Uppdragstyp"]))):Object(p.a)(Ir||(Ir=Object(n.e)(["Uppgiftstyp"],["Uppgiftstyp"])))),c.a.createElement(Pr.a,{available:["mission-tab"!==o&&{name:Object(p.a)(Nr||(Nr=Object(n.e)(["Övningsuppgift"],["Övningsuppgift"]))),key:"exercise"},{name:Object(p.a)(Tr||(Tr=Object(n.e)(["Uppgift"],["Uppgift"]))),key:"task"},{name:Object(p.a)(Cr||(Cr=Object(n.e)(["Inlämningsuppgift"],["Inlämningsuppgift"]))),key:"assignment"}].filter((function(e){return e})),selected:[t.taskType],onChange:function(e,a){return r.tasks.update(t,{taskType:a})}}),"assignment"===t.taskType&&c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,"Inlämningsdatum"),c.a.createElement("div",{className:"align-horizontal"},c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement(Vr.a,{nextMonthButtonLabel:"",showWeekNumbers:!0,previousMonthButtonLabel:"",selected:t.deadline&&qr()(t.deadline).toDate(),dateFormat:"yyyy-MM-dd",locale:"sv",popperPlacement:"bottom-start",onChange:function(e){r.tasks.update(t,{deadline:qr()(e).format("YYYY-MM-DD")})}})),c.a.createElement("div",{className:"horizontalItem top"},t.deadline&&c.a.createElement("a",{className:"deleteDate",href:"#",title:"Ta bort inlämningsdatum",onClick:function(e){e.preventDefault(),r.tasks.update(t,{deadline:null})}}))),c.a.createElement("div",{className:"taskContainer"},c.a.createElement("div",{className:"align-horizontal"},c.a.createElement("div",{className:"horizontalItem top",onClick:function(){return r.tasks.update(t,{sendToUrkund:null!=t.sendToUrkund&&!t.sendToUrkund})}},c.a.createElement("div",{className:"checkBox"+(null==t.sendToUrkund||t.sendToUrkund?" checked":"")})),c.a.createElement("div",{className:"horizontalItem top"},"Verify assignments with Urkund"))))))},Kr=Object(j.a)((function(e){var t=e.school,a=e.courseId,r=e.tabId,l=e.contentId,s=e.draftId,o=e.task,i=e.repo,u=e.history;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("div",{className:"btn btn-warning pull-right",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return i.courseContents.removeRelated({id:l},"tasks",o),[4,b.c.saveNow()];case 1:return e.sent(),u.push("/"+t+"/courses/"+a+"/tabs/"+r+"/drafts/"+s+"/edit"),[2]}}))}))}},c.a.createElement("i",{className:"fas fa-trash-alt","aria-hidden":!0})," ","standard"===t?Object(p.a)(wr||(wr=Object(n.e)(["Ta bort uppgiften"],["Ta bort uppgiften"]))):"Dölj uppgiften"),c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return[4,i.saveNow()];case 1:return e.sent(),u.push("/"+t+"/courses/"+a+"/tabs/"+(r||"$")+"/contents/"+l+"/tasks/"+o.id+"/drafts/"+s),[2]}}))}))}},c.a.createElement("i",{className:"fas fa-eye","aria-hidden":!0})," ",Object(p.a)(Sr||(Sr=Object(n.e)(["Förhandsgranska"],["Förhandsgranska"]))))),c.a.createElement(fe.a,null,c.a.createElement("button",{className:"btn",onClick:function(){return Object(n.b)(void 0,void 0,void 0,(function(){return Object(n.d)(this,(function(e){return u.push("/"+t+"/courses/"+a+"/tabs/"+(r||"$")+"/drafts/"+s+"/edit"),[2]}))}))}},c.a.createElement("i",{className:"fas fa-arrow-left","aria-hidden":!0})," ",Object(p.a)(Rr||(Rr=Object(n.e)(["Återgå till fliken"],["Återgå till fliken"]))))))),c.a.createElement("br",null))})),zr=function(e){var t=e.repo,a=e.task,r=e.writeAccess;return c.a.createElement(c.a.Fragment,null,c.a.createElement("h4",null,Object(p.a)(Lr||(Lr=Object(n.e)(["Introtext"],["Introtext"])))),c.a.createElement("p",{className:"subHeader"},"(Skriv en introduktion till uppgiften)"),c.a.createElement(ve.a,{actions:["bold","italic","underline","link","image","clear"],defaultActions:ye.a,readOnly:!r,html:a.content||"",onChange:function(e){return t.tasks.update(a,{content:e})}}))},$r={exercise:Object(p.a)(xr||(xr=Object(n.e)(["Övningsuppgift"],["Övningsuppgift"]))),task:Object(p.a)(Mr||(Mr=Object(n.e)(["Uppgift"],["Uppgift"]))),assignment:Object(p.a)(Dr||(Dr=Object(n.e)(["Inlämningsuppgift"],["Inlämningsuppgift"])))};function Wr(e){var t=e.writeAccess,a=e.task,c=e.repo,l=Object(n.f)(Object(r.useState)(0),2),s=l[0],o=l[1];return r.createElement(r.Fragment,null,r.createElement("h4",null,$r[a.taskType]||Object(p.a)(Ar||(Ar=Object(n.e)(["Uppgift"],["Uppgift"])))),r.createElement("p",{className:"subHeader"},Object(p.a)(Fr||(Fr=Object(n.e)(["(Skriv in en kort förklaring, max "," tecken, vad uppgiften går ut på.)"],["(Skriv in en kort förklaring, max "," tecken, vad uppgiften går ut på.)"])),zt.MAX_CHARS_TASK_INTRO_TEXT)),r.createElement(ve.a,{actions:["bold","clear"],defaultActions:ye.a,readOnly:!t,html:a.description||"",maxChars:zt.MAX_CHARS_TASK_INTRO_TEXT,reportNumChars:function(e){return o(e)},onChange:function(e){c.tasks.update(a,{description:e})}}),r.createElement("div",{style:{textAlign:"right",opacity:.7,fontSize:"8pt"}},Object(p.a)(_r||(_r=Object(n.e)([""," av ",""],[""," av ",""])),s,zt.MAX_CHARS_TASK_INTRO_TEXT)))}var Yr,Xr,Jr=function(e){var t=e.subject,a=e.step,n=e.onSelect;return c.a.createElement("div",{style:{minHeight:400}},c.a.createElement(r.Suspense,{fallback:c.a.createElement(et.a,null)},c.a.createElement(Ze,{subjectName:t,stepNo:a,onChange:function(e){var r=e.name,c=e.key,l=f.a.KED_WORDBANKS_URL+"?subject="+t+"&step="+a+"&list="+c;n({name:r,url:l})}})))},Qr=a(157);function Zr(e){var t=e.writeAccess,a=e.task,c=e.repo,l=e.step,s=Object(r.useContext)(aa.a),o=["bold","italic","underline","olist","outdent","indent","link","image","clear"];return t&&(l&&o.push({name:"listWordBank",icon:'<i class="fas fa-book" aria-hidden="true"></i>',title:Object(p.a)(Yr||(Yr=Object(n.e)(["Länka till ordbank"],["Länka till ordbank"]))),result:function(e,t){var n=Object(Qr.b)();s.openDialog(r.createElement(Jr,{subject:a.subject,step:l,onSelect:function(e){var t=e.name,a=e.url;s.closeDialog(),Object(Qr.a)(n);var r=document.createElement("a");r.href=a,r.target="_blank",r.appendChild(document.createTextNode(t)),document.execCommand("insertHTML",!1,r.outerHTML)}}))}}),O()&&o.push({icon:'<i class="fas fa-link" style="color:var(--col-accent)" aria-hidden="true"></i>',title:"Resurs länk",result:function(){var e=window.prompt("Ange länkens URL för resursen");if(e){var t=new URL("",e);if(t.host!==window.location.host)return void Object(p.n)("Ogiltig resursadress");var a=new RegExp("([^.|/]+).([^.]+)(?=.html)").exec(t.pathname);if(!f.a.KED_RESOURCES_URL)return void Object(p.n)("Resurser URL är inte konfigurerad");var n=f.a.KED_RESOURCES_URL.replace("{value}",a[0]),r=document.createElement("a"),c=window.getSelection().toString();r.href=n,r.target="_blank",r.appendChild(document.createTextNode(c)),n&&c&&document.execCommand("insertHTML",!1,r.outerHTML)}}})),r.createElement(r.Fragment,null,r.createElement("h4",null,Object(p.a)(Xr||(Xr=Object(n.e)(["Arbetsprocess"],["Arbetsprocess"])))),r.createElement(ve.a,{actions:o,defaultActions:ye.a,readOnly:!t,html:a.workingProcedure||"",onChange:function(e){c.tasks.update(a,{workingProcedure:e})}}))}var ec,tc,ac,nc,rc,cc,lc,sc,oc=function(e){var t=e.task,a=e.repo;return O()?t.embeddedHtml?c.a.createElement("div",null,c.a.createElement("h4",null,Object(p.a)(ec||(ec=Object(n.e)(["Inbäddat material"],["Inbäddat material"])))),c.a.createElement("p",null,Object(p.a)(tc||(tc=Object(n.e)(["Klipp in HTML kod nedan"],["Klipp in HTML kod nedan"])))),c.a.createElement("textarea",{style:{width:"100%",height:"100px"},value:t.embeddedHtml,onChange:function(e){return a.tasks.update(t,{embeddedHtml:e.target.value})}})):c.a.createElement("div",null,c.a.createElement("button",{className:"btn",onClick:function(){return a.tasks.update(t,{embeddedHtml:" "})}},c.a.createElement("i",{className:"fas fa-code","aria-hidden":!0})," ",Object(p.a)(ac||(ac=Object(n.e)(["Lägg till inbäddat material"],["Lägg till inbäddat material"])))),c.a.createElement("br",null),c.a.createElement("br",null)):c.a.createElement("div",null)},ic=function(e){var t=e.repo,a=e.course,n=e.draftId,r=e.tabId,l=e.tab,s=e.contentId,o=e.writeAccess,i=e.task,u=e.school;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Gr,{repo:t,task:i,writeAccess:o,contentId:s,tab:l}),c.a.createElement(zr,{repo:t,task:i,writeAccess:o}),c.a.createElement(Wr,{writeAccess:o,task:i,repo:t}),c.a.createElement(Zr,{writeAccess:o,task:i,repo:t,step:l&&"step-course-tab"===l.type&&l.stepNo}),c.a.createElement(oc,{writeAccess:o,task:i,repo:t}),c.a.createElement(Kr,{repo:t,task:i,courseId:a.id,draftId:n,tabId:r,contentId:s,school:u}))},uc=a(108),dc=a(198),bc=function(e){var t=e.repo,a=e.task,r=e.tabIds,l=e.blockId,s=e.themeCoveredSentences,o=e.tabContentIds;return c.a.createElement(Gt.a,null,l?t.courseBlocks.include("tabs","abilities","centralContent","knowledgeRequirements").id(l).combineLatest(t.tasks.hasEdgesFrom(o).include("knowledgeRequirements").includeIdsOnly()).switchMap((function(e){var r=Object(n.f)(e,2),l=r[0],s=r[1],o=s&&Object(p.k)(s.filter((function(e){return null!=e.partialRequirments})).map((function(e){return e.partialRequirments})));return c.a.createElement("div",null,c.a.createElement(mc,Object(n.a)({},{repo:t,task:a,tabOrBlock:l,allCoveredSentences:o})))})):t.courseTabs.include("abilities","centralContent","knowledgeRequirements").ids(r).toValue().map((function(e){return c.a.createElement("div",null,1===e.length?c.a.createElement(mc,Object(n.a)({},{repo:t,task:a,tabOrBlock:e[0],allCoveredSentences:s})):e.map((function(e){return c.a.createElement(Qt.a,{key:e.id,title:c.a.createElement("h4",null,e.name||e.tabTitle,e.subject&&e.subject.subjectName&&e.subject.subjectName!==(e.name||e.tabTitle)?" ("+e.subject.subjectName+")":"")},c.a.createElement(mc,Object(n.a)({},{repo:t,task:a,tabOrBlock:e,hasMultipleSubjects:!0,allCoveredSentences:s})))})))})))},mc=function(e){var t=e.tabOrBlock,a=e.repo,l=e.task,s=e.hasMultipleSubjects,o=e.allCoveredSentences,i=Object(n.f)(Object(r.useState)(!1),2),u=i[0],d=i[1],b=ia.b.markPartialKRs;return c.a.createElement(Gt.a,null,Object(uc.b)(t).map((function(e){var t="type"in e&&e.subject&&e.subject.subjectName;return c.a.createElement(c.a.Fragment,null,"exercise"!==l.taskType&&c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h3",null,Object(p.a)(nc||(nc=Object(n.e)(["Välj kunskapskrav"],["Välj kunskapskrav"])))),c.a.createElement("div",{className:"matrix-knowledge-title"},c.a.createElement("p",null,Object(p.a)(rc||(rc=Object(n.e)(["Markera de kunskapskrav som din uppgift täcker."],["Markera de kunskapskrav som din uppgift täcker."])))),b&&c.a.createElement("p",null,c.a.createElement("i",{className:"fab fa-creative-commons-nd "+(u?"activePartialView":""),onClick:function(){return d(!u)}}))),c.a.createElement(Yt.a,{knowledgeRequirements:e.knowledgeRequirements,markedIds:l.knowledgeRequirements.map((function(e){return e.id})),explainedRequirements:l.explainedRequirements||{},markMode:!0,markBySentenceView:u,migratedIds:l&&l.migratedTexts&&l.migratedTexts.knowledgeRequirements,partialRequirments:l.partialRequirments||{},coveredPartialRequirments:o,markPartialFeatureEnabled:b,onExplainedRequirementsChanged:function(e,t){var r;return a.tasks.update(l,{explainedRequirements:Object(n.a)(Object(n.a)({},l.explainedRequirements),(r={},r[e]=t,r))})},onUpdatePartialKnowledge:function(t,r){var c;a.tasks.update(l,{partialRequirments:Object(n.a)(Object(n.a)({},l.partialRequirments),(c={},c[t]=Object(n.h)(r),c))});var s=e.knowledgeRequirements.filter((function(e){return e.id===t}))[0];0===r.length?a.tasks.removeRelated(l,"knowledgeRequirements",s):l.partialRequirments&&l.partialRequirments[t]&&0!==l.partialRequirments[t].length||a.tasks.addRelated(l,"knowledgeRequirements",s)},onMarkChanged:function(r,c){var o,i,u=e.knowledgeRequirements.filter((function(e){return e.id===r}))[0];c?(s?a.tasks.update(l,{idsToSubjectMap:Object(n.a)(Object(n.a)({},l.idsToSubjectMap),(o={},o[r]=t,o))}):a.tasks.update(l,{idsToSubjectMap:void 0}),a.tasks.addRelated(l,"knowledgeRequirements",u)):(s?a.tasks.update(l,{idsToSubjectMap:Object(n.a)(Object(n.a)({},l.idsToSubjectMap),(i={},i[r]=void 0,i))}):a.tasks.update(l,{idsToSubjectMap:void 0}),a.tasks.removeRelated(l,"knowledgeRequirements",u))}})),c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},c.a.createElement(Zt.a,{title:Object(p.a)(cc||(cc=Object(n.e)(["Välj förmågor"],["Välj förmågor"]))),options:e.abilities,markedIds:l.abilities.map((function(e){return e.id})),markMode:!0,migratedIds:l&&l.migratedTexts&&l.migratedTexts.abilities,onMarkChanged:function(t,n){var r=e.abilities.filter((function(e){return e.id===t}))[0];n?a.tasks.addRelated(l,"abilities",r):a.tasks.removeRelated(l,"abilities",r)}})),c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},c.a.createElement(Zt.a,{title:Object(p.a)(lc||(lc=Object(n.e)(["Välj centralt innehåll"],["Välj centralt innehåll"]))),options:e.centralContent,markedIds:l.centralContent.map((function(e){return e.id})),markMode:!0,migratedIds:l&&l.migratedTexts&&l.migratedTexts.centralContent,onMarkChanged:function(t,n){var r=e.centralContent.filter((function(e){return e.id===t}))[0];n?a.tasks.addRelated(l,"centralContent",r):a.tasks.removeRelated(l,"centralContent",r)}})),c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},c.a.createElement(Qt.a,{className:"larger",title:c.a.createElement("p",null,Object(p.a)(sc||(sc=Object(n.e)(["Välj framtidsförmågor"],["Välj framtidsförmågor"]))))},c.a.createElement("br",null),c.a.createElement(Pr.a,{available:dc.a.map((function(e){return{name:e,key:e}})),selected:l.futureAbilities,onChange:function(e){return a.tasks.update(l,{futureAbilities:e})}}))))})))},pc=a(135),fc=a(115),gc=Object(d.b)((function(e){var t=e.school,a=e.course,r=e.activeTab,l=e.draftId,s=e.branch,o=e.contentId,i=e.taskId,u=e.blockId,d=e.tabs,b=a.tabs.find((function(e){return e.id===r})),m=b&&"mission-tab"===b.tabClass?a.tabs.filter((function(e){return"subject-tab"===e.tabClass})).map((function(e){return e.id})):b?[r]:d.map((function(e){return e.id}));return s.tasks.include("abilities","centralContent","knowledgeRequirements").includeIdsOnly().hasEdgesFrom([o]).toValue().combineLatest(s.courseTabs.include("abilities","contents","centralContent","knowledgeRequirements").ids(m)).switchMap((function(e){var d=Object(n.f)(e,2),f=d[0],g=d[1],h=b&&"mission-tab"===b.tabClass?g:g.filter((function(e){return e.id===r})),j=b?[o]:Object(p.k)(g.map((function(e){return e.contents.filter((function(e){return"learning-goals"===e.type})).map((function(e){return e.id}))}))),k=f.filter((function(e){return e.id===i}))[0],O=(Object(fc.a)(h,f),b&&f&&Object(p.k)(f.filter((function(e){return null!=e.partialRequirments})).map((function(e){return e.partialRequirments}))));return Object(uc.b)(k).map((function(e){return c.a.createElement(le.a,{left:c.a.createElement(bc,{repo:s,task:e,tabIds:m,blockId:u,tabContentIds:j,themeCoveredSentences:O}),right:c.a.createElement(ic,{repo:s,school:t,course:a,draftId:l,tabId:r,tab:null,contentId:o,writeAccess:Object(pc.a)(t),task:e}),rightWidth:6})}))}))})),hc=a(20);function jc(e,t){return b.c.schools.name(e).cacheOptimized().single().switchMap((function(e){return b.c.branches.hasEdgesFrom([e.officialBranchId]).name("draft").tags(t).idsOnly().map((function(e){return e.id})).first()}))}var kc,Oc,Ec,vc,yc,Ic,Nc=function(e){function t(t){var a=e.call(this,t)||this;return a.state={open:!1},a}return Object(n.c)(t,e),t.prototype.open=function(){return Object(n.b)(this,void 0,void 0,(function(){var e;return Object(n.d)(this,(function(t){switch(t.label){case 0:return this.setState({open:!0}),this.state.schools?[3,2]:[4,b.c.schools.tags("primary").map((function(e){var t=e.id,a=e.name;return{id:t,name:a,displayName:e.displayName||a||"<namnlös>"}})).toValue().load()];case 1:e=t.sent(),this.setState({schools:e}),t.label=2;case 2:return[2]}}))}))},t.prototype.close=function(){this.setState({open:!1})},t.prototype.selectSchool=function(e){return Object(n.b)(this,void 0,void 0,(function(){function t(){return Object(n.b)(this,void 0,void 0,(function(){var t,a;return Object(n.d)(this,(function(n){switch(n.label){case 0:return(a=i)?[4,jc(e,s).load()]:[3,2];case 1:a=n.sent(),n.label=2;case 2:return t=a,d&&u&&t&&(Object(g.d)(k.a.currentUser,e)||b)?[2,"/"+e+"/courses/"+s+"/tabs/"+(o||"$")+"/contents/"+u+"/tasks/"+d+"/drafts/"+t+"/edit"]:d?[2,"/"+e+"/courses/"+s+"/tabs/"+(o||"$")+"/tasks/"+d]:t&&(Object(g.d)(k.a.currentUser,e)||b)?[2,"/"+e+"/courses/"+s+"/tabs/"+(o||"$")+"/drafts/"+t+"/edit"]:[2,"/"+e+"/courses/"+s+"/tabs/"+(o||"$")]}}))}))}var a,r,c,l,s,o,i,u,d,b,m,p;return Object(n.d)(this,(function(n){switch(n.label){case 0:return a=this.props,r=a.match,c=a.history,l=r.params,s=l.courseId,o=l.tabId,i=l.draftId,u=l.contentId,d=l.taskId,b=k.a.currentUser.roles.includes("ADMIN")||location.search.includes("role="),e===this.props.school?[3,2]:[4,t()];case 1:m=n.sent(),b?(p=Object(g.f)(location.pathname,"standard"===e?{role:void 0,school:e}:{role:"EMPLOYEE",school:e}),location.href=p+"#"+m):c.push(m),n.label=2;case 2:return this.close(),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props,a=t.school,r=t.draftId,l=t.displayName,s=this.state,o=s.open,i=s.schools;return c.a.createElement("div",{tabIndex:1,style:{outline:0},onBlur:function(){return e.close()}},o?i?c.a.createElement(c.a.Fragment,null,c.a.createElement("h5",{onClick:function(){return e.close()}},Object(p.a)(Ec||(Ec=Object(n.e)(["Växla skola"],["Växla skola"])))),c.a.createElement("ul",null,c.a.createElement("li",{onClick:function(){return e.selectSchool("standard")}},Object(p.a)(vc||(vc=Object(n.e)(["Standard"],["Standard"])))),i.filter((function(e){return"standard"!==e.name})).sort((function(e,t){return e.displayName.localeCompare(t.displayName,["sv","en"])})).map((function(t){var a=t.id,n=t.name,r=t.displayName;return c.a.createElement("li",{key:a,onClick:function(){return e.selectSchool(n)}},r)})))):c.a.createElement(hc.b,null):c.a.createElement(c.a.Fragment,null,c.a.createElement("h5",{onClick:function(){return e.open()}},"standard"!==a?l||a:Object(p.a)(kc||(kc=Object(n.e)(["Standard"],["Standard"])))),r&&c.a.createElement("p",{className:"pageSideText"},Object(p.a)(Oc||(Oc=Object(n.e)(["Arbetsversion"],["Arbetsversion"]))))))},t}(c.a.Component),Tc=Object(j.a)(Nc),Cc=a(213),wc=a(133),Sc=a(134),Rc=a(132),Lc=function(e){var t=e.title,a=e.selectedFAs;return c.a.createElement(Qt.a,{title:c.a.createElement("p",null,t),className:"larger"},c.a.createElement("div",{className:"abilityList"},a.map((function(e){return c.a.createElement("div",{key:e,className:"contentPart"},c.a.createElement("div",{className:"contentText"},c.a.createElement("p",null,e)))}))))},xc=Object(p.a)(yc||(yc=Object(n.e)(["Kunskapsskolan i Sverige"],["Kunskapsskolan i Sverige"]))),Mc=Object(p.a)(Ic||(Ic=Object(n.e)(["Okänd skola"],["Okänd skola"])));function Dc(e,t){return e?b.c.branches.ids([e]).toValue().switchMap((function(e){var a=Object(n.f)(e,1)[0];return a?a.schoolId?b.c.schools.ids([a.schoolId]).toValue().map((function(e){var a=Object(n.f)(e,1)[0];return a?"standard"===a.name?xc:t?a.edsSchoolNameGymn||a.edsSchoolNamePrim||a.displayName||a.name:a.edsSchoolNamePrim||a.edsSchoolNameGymn||a.displayName||a.name:Mc})):new m.a(xc):new m.a(Mc)})):new m.a(xc)}var Ac,Fc,_c,Uc,Bc,Vc,Hc,qc,Pc,Gc=function(e){var t=e.school,a=e.task,r=e.courseId,l=e.abilities,s=e.centralContent,o=e.requirements,i=e.futureAbilities,u=(e.contentId,e.lazyRepo,e.courseType,a.deadline&&qr()(a.deadline).endOf("day")<qr()());return c.a.createElement("div",null,c.a.createElement("div",{className:"sv-text-portlet sv-use-margins sv-skip-spacer"},c.a.createElement(la.a,null),c.a.createElement("div",{className:"sv-text-portlet-content"},c.a.createElement("h1",{className:"h1"},a.name))),c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},a.content&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(Ie.a)(a.content)}}))),a.description&&c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},c.a.createElement("div",{className:["ked_boxed","taskBox",a.taskType].join(" "),style:{clear:"both"}},c.a.createElement("h2",null,$r[a.taskType]||Object(p.a)(Ac||(Ac=Object(n.e)(["Uppgift"],["Uppgift"])))),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:Object(Ie.a)(a.description)}}))),a.workingProcedure&&c.a.createElement("div",null,c.a.createElement("h3",{className:"h3"},Object(p.a)(Fc||(Fc=Object(n.e)(["Arbetsprocess"],["Arbetsprocess"])))),c.a.createElement("div",{className:"rich-text-readonly",dangerouslySetInnerHTML:{__html:Object(Ie.a)(a.workingProcedure)}})),!1,c.a.createElement("br",null),a.embeddedHtml&&c.a.createElement("div",{dangerouslySetInnerHTML:{__html:a.embeddedHtml}}),c.a.createElement("br",null),"assignment"===a.taskType?c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,"Inlämningsuppgift"),Object(pc.a)(t)?c.a.createElement("p",null,"Här kan du som lärare se elevernas inlämnade arbeten."):Object(pc.a)()?c.a.createElement("p",null,Object(p.a)(_c||(_c=Object(n.e)(["Detta är en inlämningsuppgift med inlämningsdatum ",""],["Detta är en inlämningsuppgift med inlämningsdatum ",""])),qr()(a.deadline).format("YYYY-MM-DD"))):c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null,Object(p.a)(Uc||(Uc=Object(n.e)(["Lämna in ditt arbete som en pdf, doc eller odt fil genom att dra det till fältet under."],["Lämna in ditt arbete som en pdf, doc eller odt fil genom att dra det till fältet under."])))),a.deadline?c.a.createElement("p",null,c.a.createElement("b",null,"Den här uppgiften ",u?"skulle varit inlämnad ":"skall vara inlämnad ",qr()(a.deadline).format("YYYY-MM-DD"))):void 0),c.a.createElement(Cc.a,{courseId:r,taskId:a.id,school:t,sendToUrkund:a.sendToUrkund}),c.a.createElement("br",null)):void 0,i.length>0?c.a.createElement(Lc,{title:Object(p.a)(Bc||(Bc=Object(n.e)(["I den här uppgiften behandlas följande framtidsförmågor"],["I den här uppgiften behandlas följande framtidsförmågor"]))),selectedFAs:i}):null,o.length>0&&"exercise"!==a.taskType?c.a.createElement(Rc.a,{title:"I den här uppgiften bedöms följande kunskapskrav",className:"larger",headerOpen:!1,requirements:o,idsToSubjectMap:a.idsToSubjectMap,explainedRequirements:a.explainedRequirements,partialRequirments:a.partialRequirments}):null,c.a.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},l.length>0?c.a.createElement(wc.a,{title:"Den här uppgiften behandlar följande förmågor",className:"larger",headerOpen:!1,abilities:l}):null,s.length>0?c.a.createElement(Sc.a,{title:"Den här uppgiften behandlar följande centrala innehåll",className:"larger",headerOpen:!1,centralContent:s}):null),c.a.createElement("hr",null),c.a.createElement("hr",null),a.resources&&a.resources.length>0&&c.a.createElement("div",{className:"sv-html-portlet sv-portlet"},c.a.createElement("h2",null,"Resurser kopplade till uppgiften"),c.a.createElement("div",{className:"taskContainer"},a.resources.map((function(e,t){return c.a.createElement("div",{key:t,className:"align-horizontal"},c.a.createElement("div",{className:"horizontalItem top"},c.a.createElement("a",{href:e.url},e.name)))}))),c.a.createElement("br",null)),c.a.createElement("br",null),c.a.createElement(Gt.a,null,Dc(a.$ownerBranch).map((function(e){return c.a.createElement("p",null,Object(p.a)(Vc||(Vc=Object(n.e)(["Skapad av ",""],["Skapad av ",""])),e))}))),a.$editBranch&&c.a.createElement(Gt.a,null,Dc(a.$editBranch).map((function(e){return c.a.createElement("p",null,Object(p.a)(Hc||(Hc=Object(n.e)(["Redigerad av ",""],["Redigerad av ",""])),e))}))))},Kc=Object(d.b)((function(e){return e.lazyRepo.map((function(t){return c.a.createElement(zc,Object(n.a)({},Object(n.a)(Object(n.a)({},e),{repo:t})))}))})),zc=Object(j.a)(Object(d.b)((function(e){var t=e.school,a=e.courseId,r=e.activeTab,l=e.repo,s=e.taskId,o=e.draftId,i=e.contentId,u=e.history;return l.tasks.include("abilities","centralContent","knowledgeRequirements").id(s).combineLatest(l.courseInstances.id(a)).map((function(e){var d=Object(n.f)(e,2),b=d[0],m=d[1];return c.a.createElement(le.a,{left:c.a.createElement(Gt.a,null,Object(uc.b)(b).map((function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement(Gc,{school:t,task:e,courseType:m.type,courseId:m.id,abilities:e.abilities,centralContent:e.centralContent,requirements:e.knowledgeRequirements,futureAbilities:e.futureAbilities,contentId:i,lazyRepo:l}),o&&i&&c.a.createElement(c.a.Fragment,null,c.a.createElement("hr",null),c.a.createElement("button",{className:"btn",onClick:function(){return u.push("/"+t+"/courses/"+a+"/tabs/"+r+"/contents/"+i+"/tasks/"+s+"/drafts/"+o+"/edit")}},c.a.createElement("i",{className:"fas fa-lg fa-pencil-alt"})," ",Object(p.a)(qc||(qc=Object(n.e)(["Fortsätt redigera"],["Fortsätt redigera"]))))))}))),right:c.a.createElement(se.a,{env:k.a,viewCourseUrl:f.b.KED_COURSE_VIEWER_URL}),rightWidth:5})}))}))),$c=Object(j.a)((function(e){var t=e.school,a=e.courseId,c=e.activeTab,l=e.draftId,s=e.editMode,o=(e.history,e.contentId),i=e.taskId;Object(r.useEffect)((function(){a&&(localStorage.setItem("subjectPlannerLastCourse",a),c&&"$"!==c&&"undefined"!==c?localStorage.setItem("subjectPlannerLastTab:"+a,c):localStorage.removeItem("subjectPlannerLastTab:"+a))}),[a,c,o,i]);var d=s?b.c:b.c.optimizeCache(),h=d.schools.name(t).single(),j=l?new m.a(d.branch(l)):h.map((function(e){return d.branch(e.officialBranchId)})),k=j.switchMap((function(e){return e.courseInstances.include("blocks","tabs").id(a)})).combineLatest(h).switchMap((function(e){var t=Object(n.f)(e,2),a=t[0],r=t[1],o=l?d.branch(l):d.branch(r.officialBranchId),i=s&&ia.b.KDT592?o.deltas.toValue().map((function(e){var t=Object(p.k)(e.map((function(e){return"modify"===e.type?e.targetTags||[]:(e.sourceTags||[]).concat(e.targetTags||[])})));return Object(p.c)(t,(function(e){return e}))})):new m.a({});if("theme-course"===a.type){var u={course:a,tabs:a.tabs,branch:o,block:null,schoolEntity:r};return i.map((function(e){return Object(n.a)(Object(n.a)({},u),{modifiedItems:e})}))}return c&&"$"!==c?o.courseBlocks.hasEdgesTo([c]).include("tabs").toValue().combineLatest(i).map((function(e){var t=Object(n.f)(e,2),c=Object(n.f)(t[0],1)[0],l=t[1];return{course:a,tabs:c?c.tabs:[],branch:o,block:c||a.blocks[0],schoolEntity:r,modifiedItems:l}})):a.blocks.length>0?o.courseBlocks.include("tabs").id(a.blocks[0].id).combineLatest(i).map((function(e){var t=Object(n.f)(e,2),c=t[0],l=t[1];return{course:a,tabs:c.tabs,branch:o,block:c,schoolEntity:r,modifiedItems:l}})):new m.a({course:a,tabs:[],branch:o,block:null,schoolEntity:r})})).map((function(e){return Object(n.a)(Object(n.a)({},e),{tabs:e.tabs&&e.tabs.sort(Object(p.h)(["stepNo","order"]))})})),E=k.map((function(e){var a=e.course,o=e.tabs,i=e.branch,u=e.block,d=e.schoolEntity,b=e.modifiedItems;return function(e,t,a,c,l,s,o,i,u,d){var b=this,m=O(),h=s.id,j=e.filter((function(e){return e.id===i}))[0]||e[0];"step-course"===s.type&&j&&"step-course-tab"===j.type&&(e=e.filter((function(e){return"step-course-tab"===e.type&&e.stepNo===j.stepNo})));var k=(t?e:Object(pc.a)()?e.filter((function(e){return!e.hidden})):e.filter((function(e){return!e.hidden&&"teacher-tab"!==e.tabClass}))).map((function(e){return{key:e.id,hidden:e.hidden,name:e.tabTitle,draggable:!0,link:t?"/"+a+"/courses/"+h+"/tabs/"+e.id+(l?"/drafts/"+l:"")+"/edit":"/"+a+"/courses/"+h+"/tabs/"+e.id+(l?"/drafts/"+l:"")}})),E=[];if(t&&(m||s.allowAddTabs))if("theme-course"===s.type)E.push(r.createElement(ce,{type:"theme-course-tab",key:"$addTab",school:a,course:s,branch:o,draftId:l}));else{var v=j?j.stepNo:u.stepNumbers[0]||1;E.push(r.createElement(ce,{type:"step-course-tab",key:"$addTab",school:a,course:s,branch:o,draftId:l,block:u,stepNo:v}))}m&&E.push(r.createElement("a",{href:Object(g.f)(f.b.KED_SUBJECT_PLANNER_ADMIN_URL,{role:void 0})+"#/admin/courses/"+h+"/settings",key:"$settings",title:Object(p.a)(Pc||(Pc=Object(n.e)(["Inställningar"],["Inställningar"])))},r.createElement("i",{className:"fas fa-cog","aria-hidden":!0})," "));return{title:s.name,backgroundImage:null,tabs:k,cornerBox:r.createElement(Tc,{school:a,draftId:l,displayName:c.displayName||a}),buttons:E,activeTab:i||k[0]&&k[0].key,blocks:s.blocks&&s.blocks.sort(Object(p.g)("blockNo")).map((function(e){var n=e.id,r=e.name,c=e.stepNumbers;return{id:n,name:r,steps:c.map((function(e){return{isActive:j&&e===j.stepNo,stepNo:e,link:"/"+a+"/courses/"+h+"/blocks/"+n+"/steps/"+e+(l?"/drafts/"+l:"")+(t?"/edit":"")}}))}})),sortableTabs:t&&(m||s.allowReorderTabs),modifiedItems:d,onTabDrop:function(t,a,r){return Object(n.b)(b,void 0,void 0,(function(){var c,l;return Object(n.d)(this,(function(n){return(c=Object(Kt.a)(e,t,a,r))&&(l=e.find((function(e){return e.id===t})))&&o.courseTabs.update(l,{order:c}),[2]}))}))}}}(o,s,t,d,l,a,i,c,u,b)}));return r.createElement(r.Fragment,null,r.createElement(u.b,{lazyProps:E}),i?s?r.createElement(Gt.a,null,k.map((function(e){var a=e.branch,n=e.block,s=e.course,u=e.tabs;return r.createElement(gc,{school:t,course:s,draftId:l,branch:a,activeTab:c,contentId:o,taskId:i,blockId:n&&n.id,tabs:u})}))):r.createElement(Kc,{school:t,courseId:a,lazyRepo:j,activeTab:c,taskId:i,contentId:o,draftId:l}):r.createElement(Gt.a,null,k.map((function(e){var n=e.branch,o=e.block,i=e.course,u=e.tabs;return r.createElement(Ur,{school:t,courseId:a,draftId:l,course:i,branch:n,tabs:u,activeTab:c,editMode:s,block:o})}))))}));var Wc,Yc,Xc,Jc,Qc,Zc,el=a(201),tl=function(e){var t=e.title,a=e.courses;return c.a.createElement("div",{className:"ked_boxed"},c.a.createElement("h3",null,t),c.a.createElement("div",{className:"taskContainer odd-even"},a.map((function(e){var t=e.id,a=e.name,n=e.description,r=e.tags;return c.a.createElement(pe.a,null,c.a.createElement(fe.a,null,c.a.createElement("div",{className:"studentCourse"},c.a.createElement(Ge.a,{to:"/courses/"+t},a),c.a.createElement("p",{className:"small"},n))),r.includes("active")?void 0:c.a.createElement(fe.a,null,c.a.createElement("div",{className:"pill incomplete"},"Inaktiv")))}))))},al=Object(d.b)((function(e){return(e.showInactive?Object(el.a)():Object(el.a)().tags("active")).orderBy("name").map((function(e){var t=e.id,a=e.name,n=e.type,r=e.description;return{id:t,name:a,type:n,tags:e.tags,description:r,url:"/courses/"+t}})).groupBy("type").map((function(e){return{themeCourses:e["theme-course"],stepCourses:e["step-course"]}})).map((function(e){var t=e.themeCourses,a=e.stepCourses;return c.a.createElement(c.a.Fragment,null,t&&c.a.createElement(tl,{title:Object(p.a)(Wc||(Wc=Object(n.e)(["Temakurser"],["Temakurser"]))),courses:t}),a&&c.a.createElement(tl,{title:Object(p.a)(Yc||(Yc=Object(n.e)(["Stegkurser"],["Stegkurser"]))),courses:a}))}))})),nl=function(e){var t=e.school,a=e.courseId,n=e.blockId,r=e.draftId,l=e.editMode,s=e.stepNo;return c.a.createElement(Gt.a,null,b.c.optimizeCache().schools.name(t).single().map((function(e){return b.c.branch(e.officialBranchId)})).switchMap((function(e){return e.courseBlocks.include("tabs").id(n).map((function(e){var n=e.tabs.filter((function(e){return""+e.stepNo==""+s})).sort(Object(p.g)("order"))[0];return n?c.a.createElement(o.a,{to:"/"+t+"/courses/"+a+"/tabs/"+n.id+(r?"/drafts/"+r:"")+(r&&l?"/edit":"")}):c.a.createElement(o.a,{to:"/"+t+"/courses/"+a})}))})))};function rl(e){var t=this,a=e.courseId,r=e.branchId;return c.a.createElement("button",{className:"btn btn-large btn-warning",onClick:function(){return Object(n.b)(t,void 0,void 0,(function(){return Object(n.d)(this,(function(e){switch(e.label){case 0:return confirm(Object(p.a)(Xc||(Xc=Object(n.e)(["Åtgärden återstället kursen till standard.\n\nVill du fortsätta?"],["Åtgärden återstället kursen till standard.\\n\\nVill du fortsätta?"]))))?(Object(p.o)(Object(p.a)(Jc||(Jc=Object(n.e)(["Återställer kursen till orginal..."],["Återställer kursen till orginal..."])))),[4,b.c.branch(r).deltas.tag(a).toValue().load()]):[3,3];case 1:return ma(e.sent(),r),[4,b.c.saveNow()];case 2:e.sent(),Object(p.o)(Object(p.a)(Qc||(Qc=Object(n.e)(["Kursen är återställd. Sidan laddas nu om..."],["Kursen är återställd. Sidan laddas nu om..."])))),location.reload(),e.label=3;case 3:return[2]}}))}))}},Object(p.a)(Zc||(Zc=Object(n.e)(["Återställ till orginalet"],["Återställ till orginalet"]))))}var cl,ll,sl,ol,il=Object(ue.a)((function(e){var t=e.courseId,a=e.branchId,r=e.allowCherryPick,l=b.c.branch(a).deltas.tag(t).toValue().read();return 0===l.length?c.a.createElement("div",null,c.a.createElement("p",{style:{opacity:.5,fontStyle:"italic"}},Object(p.a)(cl||(cl=Object(n.e)(["Skolans version är identisk med orginalet"],["Skolans version är identisk med orginalet"]))))):c.a.createElement("div",null,c.a.createElement("h2",null,Object(p.a)(ll||(ll=Object(n.e)(["Skolans ändringar"],["Skolans ändringar"])))),c.a.createElement(ur,{branchId:a,deltas:l,editable:r}),c.a.createElement(rl,{courseId:t,branchId:a}))})),ul=function(e){return c.a.createElement(r.Suspense,{fallback:c.a.createElement(et.a,null)},c.a.createElement(dl,Object(n.a)({},e)))},dl=Object(ue.a)((function(e){var t=e.school,a=e.courseId,r=b.c.schools.cacheOptimized().name(t).single().read(),l=b.a.getBranchIdSuspense(r,a),s={title:b.c.branch(l).courseInstances.id(a).read().name,activeTab:"versionhistory",tabs:[{name:Object(p.a)(sl||(sl=Object(n.e)(["Versionshistorik"],["Versionshistorik"]))),key:"versionhistory"}],buttons:[c.a.createElement(Ge.a,{to:"/"+t+"/courses/"+a,key:"$settings",title:Object(p.a)(ol||(ol=Object(n.e)(["Visa kursen"],["Visa kursen"])))},c.a.createElement("i",{className:"fas fa-eye","aria-hidden":!0})," ")]};return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,Object(n.a)({},s)),c.a.createElement(il,{allowCherryPick:!0,branchId:r.officialBranchId,courseId:a}))})),bl=a(199),ml=a(118);a.d(t,"SubjectPlannerViewerApp",(function(){return hl})),Object(bl.a)();var pl,fl,gl=Object(d.b)((function(e){var t=e.render,a=e.courseIdOrName;return 36===a.length&&"-"===a[8]&&"-"===a[13]&&"-"===a[18]&&"-"===a[23]?b.b.mySchool.map((function(e){return t(e,a)})):b.c.courseInstances.name(a.replace("+"," ")).idsOnly().single().combineLatest(b.b.mySchool).map((function(e){var a=Object(n.f)(e,2),r=a[0],c=a[1];return t(c,r.id)}))})),hl=(pl=function(){return r.createElement("div",{onKeyDown:function(e){83===e.which&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),b.c.saveNow().then((function(){})))}},r.createElement(l.a,null,r.createElement(r.Fragment,null,r.createElement(s.a,{path:"/",exact:!0,render:function(){var e=localStorage.getItem("subjectPlannerLastCourse");return e?r.createElement(Gt.a,null,b.c.courseInstances.ids([e]).idsOnly().toValue().map((function(t){return Object(n.f)(t,1)[0]?r.createElement(o.a,{to:"/courses/"+e}):r.createElement(o.a,{to:"/courses"})}))):r.createElement(o.a,{to:"/courses"})}}),r.createElement(s.a,{path:"/courses",exact:!0,render:function(){return r.createElement(r.Fragment,null,r.createElement(u.a,{title:Object(p.a)(fl||(fl=Object(n.e)(["Kurser"],["Kurser"]))),tabs:[],activeTab:"$"}),r.createElement(le.a,{left:r.createElement(al,{showInactive:!0}),right:r.createElement(se.a,{env:k.a,viewCourseUrl:f.b.KED_COURSE_VIEWER_URL}),rightWidth:5}))}}),r.createElement(s.a,{path:"/courses/:courseIdOrName",exact:!1,render:function(e){var t=e.match;return r.createElement(gl,{courseIdOrName:t.params.courseIdOrName,render:function(e,t){return r.createElement(o.a,{to:"/"+e.name+"/courses/"+t})}})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=localStorage.getItem("subjectPlannerLastTab:"+n);return c?r.createElement(o.a,{to:"/"+a+"/courses/"+n+"/tabs/"+c}):r.createElement($c,{school:a,courseId:n})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId?",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId;return r.createElement($c,{school:a,courseId:n,activeTab:c})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/settings/:draftId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.draftId;return r.createElement($c,{school:a,courseId:n,activeTab:"$settings",draftId:c})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId/drafts/:draftId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId,l=t.draftId;return r.createElement($c,{school:a,courseId:n,activeTab:c,draftId:l})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId/drafts/:draftId/edit",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId,l=t.draftId;return r.createElement($c,{school:a,courseId:n,activeTab:c,draftId:l,editMode:!0})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId/tasks/:taskId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId,l=t.taskId;return r.createElement($c,{school:a,courseId:n,activeTab:c,taskId:l,editMode:!1})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId/contents/:contentId/tasks/:taskId/drafts/:draftId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId,l=t.taskId,s=t.draftId,o=t.contentId;return r.createElement($c,{school:a,courseId:n,activeTab:c,taskId:l,contentId:o,draftId:s,editMode:!1})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/tabs/:tabId/contents/:contentId/tasks/:taskId/drafts/:draftId/edit",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.tabId,l=t.contentId,s=t.taskId,o=t.draftId;return r.createElement($c,{school:a,courseId:n,activeTab:c,contentId:l,taskId:s,draftId:o,editMode:!0})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/blocks/:blockId/steps/:stepNo",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.blockId,l=t.stepNo;return r.createElement(nl,{school:a,courseId:n,blockId:c,stepNo:l,draftId:null,editMode:!1})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/blocks/:blockId/steps/:stepNo/drafts/:draftId/edit",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.blockId,l=t.stepNo,s=t.draftId;return r.createElement(nl,{school:a,courseId:n,blockId:c,stepNo:l,draftId:s,editMode:!0})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/blocks/:blockId/steps/:stepNo/drafts/:draftId",render:function(e){var t=e.match.params,a=t.school,n=t.courseId,c=t.blockId,l=t.stepNo,s=t.draftId;return r.createElement(nl,{school:a,courseId:n,blockId:c,stepNo:l,draftId:s,editMode:!1})}}),r.createElement(s.a,{exact:!0,path:"/:school/courses/:courseId/history",render:function(e){var t=e.match.params,a=t.school,n=t.courseId;return t.blockId,t.stepNo,r.createElement(ul,{school:a,courseId:n})}}),r.createElement(i.a,null))))},function(e){function t(t){var a=e.call(this,t)||this;return a.state={dialogs:[]},a.openDialog=a.openDialog.bind(a),a.closeDialog=a.closeDialog.bind(a),a}return Object(n.c)(t,e),t.prototype.openDialog=function(e){this.setState({dialogs:Object(n.h)(this.state.dialogs,[e])})},t.prototype.closeDialog=function(){this.setState({dialogs:this.state.dialogs.slice(0,this.state.dialogs.length-1)})},t.prototype.render=function(){var e=this.state.dialogs;return c.a.createElement(aa.a.Provider,{value:{openDialog:this.openDialog,closeDialog:this.closeDialog}},c.a.createElement(pl,Object(n.a)({},this.props)),c.a.createElement(ml.a,{dialogs:e,popDialog:this.closeDialog}))},t}(c.a.Component))}}]);
//# sourceMappingURL=SubjectPlannerViewerApp.min.js.map