(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[18],{314:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(4),s=n(3),a=n.n(s),u=n(6),c=n(20),i=n(169),l=n(1),d=n(2),f=n(24),h=n(7),p=n(184),m=n(185),v=n(137);function b(e,t){return Object(r.b)(this,void 0,void 0,(function(){function n(t,n,o){var s=null;return{getBearer:function(){return s||this.refreshBearer()},refreshBearer:function(){return s=function(){return Object(r.b)(this,void 0,void 0,(function(){var s,a,u,c;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,t.get(n,o)];case 1:return 200!==(s=r.sent()).status?[3,3]:[4,s.json()];case 2:return[2,r.sent()];case 3:return a=d.c.bind,u=[void 0,s.status],c="Could not retrieve tutor token for "+e+". Error Message: ",[4,s.text()];case 4:throw new(a.apply(d.c,u.concat([c+r.sent()])))}}))}))}()}}}var s,a,u,c,i,b;return Object(r.d)(this,(function(r){switch(r.label){case 0:return s={mail:e,displayName:t,roles:["USER"],school:o.a.currentUser.school,tutorFor:e},a=n(o.a.kedBackendClient.http,"tutor/token",{userEmail:e}),u=new d.d(h.c,a,l.b.KED_API_URL),c=n(u.http,"tutor/convert-token/google"),i=new f.b(h.c,l.b.EDS_API_URL,a,(function(){return e})),(b={currentUser:s,bearerProvider:a,edsClient:i,googleTokenProvider:c,kedBackendClient:u,tutored:!0}).ksTermPlannerRepo=new p.a((function(){return u}),(function(){return s})),b.kgTermPlannerRepo=new m.a((function(){return u}),(function(){return s})),b.userTasksRepo=new v.a((function(){return u}),(function(){return s})),[4,a.getBearer().catch((function(e){console.error(e)}))];case 1:return r.sent(),[2,b]}}))}))}n.d(t,"TutorsSelect",(function(){return g}));var g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isLoading:!0,students:[]},n}return Object(r.c)(t,e),t.prototype.componentDidMount=function(){this.load()},t.prototype.load=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n;return Object(r.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,5,6]),[4,o.a.edsClient.getTeacherTutorStudents()];case 1:return(e=r.sent()).sort(Object(u.h)(["lastName","firstName"])),t=e.length>0?e.map((function(e){return{mail:e.email,displayName:e.firstName+" "+e.lastName}})):[o.a.currentUser],[4,this.setState({students:t})];case 2:return r.sent(),[3,6];case 3:return n=r.sent(),console.error("Could not list tutor students",n),[4,this.setState({students:[o.a.currentUser]})];case 4:return r.sent(),[3,6];case 5:return this.setState({isLoading:!1}),[7];case 6:return[2]}}))}))},t.prototype.onSelectUser=function(e){var t=this.state.students.filter((function(t){return t.mail===e}))[0],n=Object(r.a)(Object(r.a)({},t),{roles:["USER"]});i.a.setNewEnv(n,(function(){return b(e,e)}))},t.prototype.render=function(){var e=this,t=this.state,n=t.isLoading,r=t.students;return n?a.a.createElement(c.b,null):a.a.createElement("div",{className:"tutors-select"},a.a.createElement("select",{onChange:function(t){return t.target.value&&e.onSelectUser(t.target.value)}},a.a.createElement("option",{value:""},"VÃ¤lj elev"),r.map((function(e){return a.a.createElement("option",{key:e.mail,value:e.mail},e.displayName," (",e.mail,")")}))))},t}(a.a.Component)}}]);
//# sourceMappingURL=TutorsSelect.min.js.map