var kedcomponents =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"kedcomponents": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/elements/KEDComponents/webpack-entry.ts","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./kedbackend/KED.Backend.API/schema.json":
/*!************************************************!*\
  !*** ./kedbackend/KED.Backend.API/schema.json ***!
  \************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"accessClaimDefinitions\":{\"email\":\"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}\",\"role\":\"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}\",\"school\":\"{school}\",\"schoolRole\":\"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}\",\"tutorFor\":\"{tutorFor}\"},\"realmClaim\":\"realm\",\"specialRoles\":{\"userRole\":\"USER\",\"adminRole\":\"ADMIN\"},\"defaultAccessClaimTypes\":[\"role\"],\"defaultAcl\":[\"role:USER:R\"],\"tables\":{\"branches\":{\"accessClaimTypes\":[\"role\",\"schoolRole\",\"email\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"*\"],\"schoolRole\":[\"*\"],\"role\":[\"*\"]}},\"relationships\":{\"parents\":\"branches\",\"approvedChildren\":\"branches\"},\"isPublic\":true},\"global\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"relationships\":{\"courseInstances\":\"courseInstances\"},\"isPublic\":true},\"courseInstances\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"USER\":{\"schoolRole\":[\"*\"],\"role\":[\"*\"]}},\"defaultAcl\":[\"role:USER:R\",\"schoolRole:{school}/EMPLOYEE:S\"],\"relationships\":{\"abilities\":\"abilities\",\"centralContent\":\"central-content\",\"knowledgeRequirements\":\"knowledge-requirements\",\"blocks\":\"courseBlocks\",\"tabs\":\"courseTabs\"},\"isPublic\":true},\"courseBlocks\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"USER\":{\"schoolRole\":[\"*\"],\"role\":[\"*\"]}},\"defaultAcl\":[\"role:USER:R\",\"schoolRole:{school}/EMPLOYEE:S\"],\"relationships\":{\"abilities\":\"abilities\",\"centralContent\":\"central-content\",\"knowledgeRequirements\":\"knowledge-requirements\",\"tabs\":\"courseTabs\",\"tasks\":\"tasks\"},\"isPublic\":true},\"courseTabs\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"USER\":{\"schoolRole\":[\"*\"],\"role\":[\"*\"]}},\"defaultAcl\":[\"role:USER:R\",\"schoolRole:{school}/EMPLOYEE:S\"],\"relationships\":{\"abilities\":\"abilities\",\"centralContent\":\"central-content\",\"knowledgeRequirements\":\"knowledge-requirements\",\"contents\":\"courseContents\"},\"isPublic\":true},\"courseContents\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"USER\":{\"schoolRole\":[\"*\"],\"role\":[\"*\"]}},\"defaultAcl\":[\"role:USER:R\",\"schoolRole:{school}/EMPLOYEE:S\"],\"relationships\":{\"tasks\":\"tasks\"},\"isPublic\":true},\"weekplans\":{\"accessClaimTypes\":[\"email\",\"tutorFor\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\",\"{tutorFor}:*\"],\"tutorFor\":[\"{tutorFor}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"isPublic\":false},\"weekplans-ks\":{\"accessClaimTypes\":[\"email\",\"tutorFor\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\",\"{tutorFor}:*\"],\"tutorFor\":[\"{tutorFor}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"isPublic\":false},\"usertasks\":{\"accessClaimTypes\":[\"email\",\"schoolRole\",\"tutorFor\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\",\"{tutorFor}:*\"],\"schoolRole\":[\"{school}/EMPLOYEE:*\"],\"tutorFor\":[\"{tutorFor}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"relationships\":{\"task\":\"tasks\",\"course\":\"courses\"},\"isPublic\":false},\"userhiddencourses\":{\"accessClaimTypes\":[\"email\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"relationships\":{},\"isPublic\":false},\"usercalendarvisibility\":{\"accessClaimTypes\":[\"email\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"relationships\":{},\"isPublic\":false},\"subjects\":{\"relationships\":{\"courseTemplates\":\"courses\",\"abilities\":\"abilities\"},\"isPublic\":true},\"schools\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"relationships\":{\"courses\":\"courses\",\"activeCourses\":\"courses\"},\"isPublic\":true},\"courses\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"EMPLOYEE\":{\"schoolRole\":[\"{school}/EMPLOYEE:*\"],\"role\":[\"USER:R\"]}},\"defaultAcl\":[\"schoolRole:{school}/EMPLOYEE:*\"],\"relationships\":{\"templateChain\":\"courses\",\"centralContent\":\"central-content\",\"knowledgeRequirements\":\"knowledge-requirements\",\"abilities\":\"abilities\",\"images\":\"images\",\"tasks\":\"tasks\"},\"isPublic\":true},\"tasks\":{\"accessClaimTypes\":[\"role\",\"schoolRole\"],\"sharingAccessPerRole\":{\"EMPLOYEE\":{\"schoolRole\":[\"{school}/EMPLOYEE:*\"],\"role\":[\"USER:R\"]}},\"defaultAcl\":[\"schoolRole:{school}/EMPLOYEE:S\",\"role:USER:R\"],\"relationships\":{\"knowledgeRequirements\":\"knowledge-requirements\",\"centralContent\":\"central-content\",\"abilities\":\"abilities\"},\"isPublic\":true},\"images\":{\"accessClaimTypes\":[\"role\",\"schoolRole\",\"email\"],\"sharingAccessPerRole\":{\"EMPLOYEE\":{\"schoolRole\":[\"{school}/EMPLOYEE:*\"],\"role\":[\"USER:R\"]},\"USER\":{\"email\":[\"{email}:*\"]}},\"isPublic\":true},\"central-content\":{\"accessClaimTypes\":[\"role\"],\"defaultAcl\":[\"role:USER:R\"]},\"knowledge-requirements\":{\"accessClaimTypes\":[\"role\"],\"defaultAcl\":[\"role:USER:R\"],\"isPublic\":true},\"abilities\":{\"accessClaimTypes\":[\"role\"],\"defaultAcl\":[\"role:USER:R\"],\"isPublic\":true},\"notes\":{\"accessClaimTypes\":[\"email\"],\"sharingAccessPerRole\":{\"USER\":{\"email\":[\"{email}:*\"]}},\"defaultAcl\":[\"email:{email}:S\"],\"relationships\":{},\"isPublic\":false}}}");

/***/ }),

/***/ "./kedbackend/client.js":
/*!******************************!*\
  !*** ./kedbackend/client.js ***!
  \******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "./kedbackend/clientweb.js":
/*!*********************************!*\
  !*** ./kedbackend/clientweb.js ***!
  \*********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "./kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!***************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \***************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!***********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \***********************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \***************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "./kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \***********************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "./kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "./kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
// | 'otherFlag' | 'thirdFlag';...
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.undoLink = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.undoLink(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.undoLink = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'undo-link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \*************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \***********************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!**************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \**************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                case 'undo-link':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js":
/*!**********************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js ***!
  \**********************************************************************************************/
/*! exports provided: applyMutationsOnDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyMutationsOnDeltas", function() { return applyMutationsOnDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");


function applyMutationsOnDeltas(branchId, deltas, mutations, optimistic, userDisplayName, hasAdditionalFilter) {
    var _loop_1 = function (m) {
        switch (m.op) {
            case 'add-related':
                //
                // AddRelated RepoMutation
                //
                if (!hasAdditionalFilter && m.branchId === branchId) {
                    deltas = [{
                            type: 'add',
                            sourceId: m.id,
                            targetId: m.relatedDoc.id,
                            label: m.graphProp,
                            sourceTable: m.table,
                            $meta: optimistic ? 'adding' : 'persisted',
                            dateTime: Date.now(),
                            targetName: m.relatedDoc.name,
                            contributor: userDisplayName
                        }].concat(deltas);
                }
                break;
            case 'clear-branch':
                //
                // ClearBranch RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                break;
            case 'delete':
                //
                // Delete RepoMutation
                //
                // This type of mutation can not be performed onto branches. There's no branchId property on m.
                break;
            case 'merge':
                //
                // Merge RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                else if (m.targetBranchId === branchId) {
                    // This change will append new deltas to our deltas array but we don't know what would come.
                    // Need to refetch from server.
                    if (!optimistic)
                        return { value: null }; // Caller should check for null and re-fetch data from server.
                }
                break;
            case 'remove-related':
                //
                // Remove-Related RepoMutation
                //
                if (hasAdditionalFilter || m.branchId !== branchId)
                    return "continue";
                deltas = [{
                        type: 'remove',
                        sourceId: m.id,
                        targetId: m.relatedDoc.id,
                        targetName: m.relatedDoc.name,
                        label: m.graphProp,
                        sourceTable: m.table,
                        contributor: userDisplayName,
                        dateTime: Date.now(),
                        $meta: optimistic ? 'adding' : 'persisted'
                    }].concat(deltas);
                break;
            case 'undo-link':
                //
                // Undo-Link RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (d) {
                        return (d.type === 'add' || d.type === 'remove' || d.type === 'undo-link') &&
                            d.sourceId === m.id &&
                            d.targetId === m.relatedId;
                    });
                    if (idx < 0)
                        return "continue";
                    // Found an "add" or "remove" delta to change:
                    if (optimistic) {
                        var deltaRelation = deltas[idx];
                        // Mark the existing add/remove delta as currenlty being deleted
                        deltas = deltas.slice(0, idx).concat([
                            tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaRelation, { $meta: optimistic ? 'removing' : 'persisted' })
                        ], deltas.slice(idx + 1));
                    }
                    else {
                        // Persisted. Just remove it:
                        deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                    }
                }
                break;
            case 'update':
                //
                // Update RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (delta) {
                        return delta.type === 'modify' &&
                            delta.targetId === m.id;
                    });
                    if (idx < 0 && !hasAdditionalFilter) {
                        deltas = [{
                                type: 'modify',
                                table: m.table,
                                targetId: m.id,
                                targetName: m.targetName,
                                data: m.deltaDoc,
                                dateTime: Date.now(),
                                contributors: [userDisplayName],
                                $meta: optimistic ? 'adding' : 'persisted',
                            }].concat(deltas);
                    }
                    else {
                        var existingDeltaDoc = deltas[idx];
                        var contributors = existingDeltaDoc.contributors.slice();
                        if (!contributors.includes(userDisplayName)) {
                            contributors.push(userDisplayName);
                        }
                        var newData = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_1__["mergeDeltas"])(existingDeltaDoc.data, m.deltaDoc, { removeUnsetProps: true });
                        if (!optimistic && Object.keys(newData).length === 0) {
                            // Committed mutation that resets a deltaDoc. Remove the deltaDoc entirely:
                            deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                        }
                        else {
                            // 
                            deltas = [
                                {
                                    type: 'modify',
                                    table: m.table,
                                    targetId: m.id,
                                    targetName: m.targetName,
                                    data: newData,
                                    dateTime: Date.now(),
                                    contributors: contributors,
                                    $meta: optimistic ? 'updating' : 'persisted',
                                }
                            ].concat(deltas.slice(0, idx), deltas.slice(idx + 1));
                        }
                    }
                }
                break;
        }
    };
    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {
        var m = mutations_1[_i];
        var state_1 = _loop_1(m);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return deltas;
}
//# sourceMappingURL=apply-mutations-on-deltas.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js":
/*!********************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js ***!
  \********************************************************************************/
/*! exports provided: DeltaCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCache", function() { return DeltaCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./apply-mutations-on-deltas */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js");



var DeltaCache = /** @class */ (function () {
    function DeltaCache(getClient, getUser, getUserDisplayName) {
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.lookup = {};
    }
    DeltaCache.prototype.applyMutations = function (mutations, _a) {
        var optimistic = (_a === void 0 ? { optimistic: false } : _a).optimistic;
        // Apply mutations locally onto the DeltaCache and notify their subscribers
        for (var _i = 0, _b = Object.keys(this.lookup); _i < _b.length; _i++) {
            var queryKey = _b[_i];
            var cacheEntry = this.lookup[queryKey];
            if (cacheEntry.value) {
                // Instead here: Store the mutations on cacheEntry. No matter if it yet has value or not.
                // Then apply mutation whenever subscribing! (Better handling of mutations that arrives before fetch() is done)
                // (See how I handle this in query-set.ts)
                var newValue = Object(_apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__["applyMutationsOnDeltas"])(cacheEntry.query.branchId, cacheEntry.value, mutations, optimistic, this.getUserDisplayName(), !!cacheEntry.query.tags);
                if (newValue === null) {
                    // The mutation requires cacheEntry to be refetched from server
                    if (!optimistic) {
                        // Caller has successfully performed the mutations and got success back from server.
                        // It's ok to refetch the deltas from server now:
                        cacheEntry.fetch();
                        // After fetch completes, it will notify the subscribers.
                    }
                }
                if (newValue !== cacheEntry.value) {
                    cacheEntry.optimisticValue = newValue;
                    if (!optimistic)
                        cacheEntry.value = newValue;
                    cacheEntry.notify(newValue);
                }
            }
        }
    };
    DeltaCache.prototype.subscribe = function (query, observer) {
        var _this = this;
        var cacheEntry = this.lookup[query.branchId + query.tags];
        if (!cacheEntry) {
            cacheEntry = new DeltaCacheEntry(this.getClient(), query);
            this.lookup[query.branchId + query.tags] = cacheEntry;
        }
        if (cacheEntry.cleanupTimer) {
            clearTimeout(cacheEntry.cleanupTimer);
            cacheEntry.cleanupTimer = null;
        }
        var subscription = {
            unsubscribe: function () {
                cacheEntry.subscribers = cacheEntry.subscribers.filter(function (_a) {
                    var o = _a.observer;
                    return o !== observer;
                });
                if (cacheEntry.subscribers.length === 0) {
                    cacheEntry.cleanupTimer = setTimeout(function () {
                        if (cacheEntry.subscribers.length === 0) {
                            delete _this.lookup[query.branchId + query.tags];
                        }
                    }, 100);
                }
            }
        };
        cacheEntry.subscribers.push({ observer: observer, subscription: subscription });
        if (cacheEntry.value) {
            // Value has been successfully retrieved already. Pick from cache.
            observer(cacheEntry.optimisticValue || cacheEntry.value, null, subscription);
        }
        else if (cacheEntry.isFetching) {
            // A value is on its way. Sit back and relax. All registered
            // observers (including this one) will be notified when data arrives
            // or fails.
        }
        else if (cacheEntry.error) {
            observer(null, cacheEntry.error, subscription);
        }
        else {
            cacheEntry.fetch();
        }
        return subscription;
    };
    return DeltaCache;
}());

var DeltaCacheEntry = /** @class */ (function () {
    function DeltaCacheEntry(client, query) {
        this.fetchOperationId = 0; // Makes sure a re-fetch will discard the result from any ongoing fetch.
        this.client = client;
        this.query = query;
        this.value = null;
        this.error = null;
        this.optimisticValue = null;
        this.subscribers = [];
        this.isFetching = false;
        this.cleanupTimer = null;
    }
    DeltaCacheEntry.prototype.fetch = function () {
        var _this = this;
        var fetchOperationId = ++this.fetchOperationId;
        this.isFetching = true;
        this.fetchFromServer().then(function (value) {
            // Success
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                value.sort(function (a, b) { return b.dateTime - a.dateTime; }); // Latest first
                _this.value = value;
                _this.optimisticValue = value;
                _this.notify(value);
            }
        }).catch(function (error) {
            // Fail
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                _this.error = error;
                _this.fail(error);
            }
        });
    };
    DeltaCacheEntry.prototype.fetchFromServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!this.query.branchId)
                            throw new Error('Deltas only available on branches');
                        return [4 /*yield*/, this.client.http.get('deltas', this.query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 300 || res.status < 200)) return [3 /*break*/, 3];
                        _a = _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    DeltaCacheEntry.prototype.notify = function (value) {
        for (var _i = 0, _a = this.subscribers; _i < _a.length; _i++) {
            var _b = _a[_i], observer = _b.observer, subscription = _b.subscription;
            observer(value, null, subscription);
        }
    };
    DeltaCacheEntry.prototype.fail = function (error) {
        var copy = this.subscribers.slice();
        this.subscribers = [];
        for (var _i = 0, copy_1 = copy; _i < copy_1.length; _i++) {
            var _a = copy_1[_i], observer = _a.observer, subscription = _a.subscription;
            observer(null, error, subscription);
        }
    };
    return DeltaCacheEntry;
}());
//# sourceMappingURL=delta-cache.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js":
/*!*************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js ***!
  \*************************************************************************************/
/*! exports provided: DeltaCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCollection", function() { return DeltaCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../observable */ "./kedbackend/js/dist/js/observable/index.js");


var DeltaCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DeltaCollection, _super);
    function DeltaCollection(deltaCache, query) {
        var _this = _super.call(this, function (observer) { return _this.deltaCache.subscribe(query, observer); }) || this;
        _this.deltaCache = deltaCache;
        _this.query = query;
        return _this;
    }
    DeltaCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return new DeltaCollection(this.deltaCache, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, { tags: tags }));
    };
    return DeltaCollection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Collection"]));

//# sourceMappingURL=delta-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \***************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            // Do nothing on target doc!
                            targetDoc.$wasUnset = true; // Just mark it for re-retrieval after successful posting changes.
                            break;
                        }
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
// {name: "Ulla"}, {name: {$unset:0}
// {tags: {$add: "hej"}}, {tags: {$unset:0}"}
function mergeDeltas(delta1, delta2, _a) {
    var removeUnsetProps = (_a === void 0 ? { removeUnsetProps: false } : _a).removeUnsetProps;
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            if (removeUnsetProps) {
                                delete targetDelta[key];
                            }
                            else {
                                // No matter if targetDelta is empty or has value. Set it to {$unset:0}
                                // to make sure the very end result will have {$unset:0}
                                targetDelta[key] = { $unset: 0 };
                            }
                            break;
                        }
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _b = 0, metaInstructions_2 = metaInstructions; _b < metaInstructions_2.length; _b++) {
                    var mi = metaInstructions_2[_b];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \*********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "./kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \*************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "./kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (doc, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: doc.id,
                deltaDoc: changes,
                targetName: doc.name
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.undoLink = function (id, label, relatedId) {
        if (!this.query.branchId)
            throw new Error("undo links can only be performed on branches");
        this.repo.writer.mutate([{
                op: 'undo-link',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedDoc.id ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedDoc.id; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedDoc.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedDoc.id; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!*******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \*******************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony import */ var _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-collection */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js");







var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, getUserDisplayName, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!defaultQueryOptions)
            this.defaultQueryOptions = {};
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser, getUserDisplayName);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
        this.deltas = new _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__["DeltaCollection"](this.writer.deltaCache, {
            branchId: this.defaultQueryOptions.branchId // If branchId is undefined. DeltaCollection will respond with Error on subscribe()
        });
    }
    KedBackendRepo.prototype.table = function (tableName) {
        var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](this, tableName, this.defaultQueryOptions);
        if (this.cacheOptimized)
            collection = collection.cacheOptimized();
        return collection;
    };
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, this.getUserDisplayName, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!***************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \***************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!*********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony import */ var _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-cache */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js");







var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser, getUserDisplayName) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
        this.deltaCache = new _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__["DeltaCache"](getClient, getUser, getUserDisplayName);
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        this.deltaCache.applyMutations(this.mutationQueue.get(), { optimistic: true });
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] },
                            targetName: null // We don't have the target name. But this mutation won't be visible in a DeltaCollection anyway, so it wont be used.
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        this.deltaCache.applyMutations(mutations, { optimistic: false });
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'undo-link':
                    br.undoLink(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \*************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \*********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \***********************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/collection.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/collection.js ***!
  \********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/emitter.js":
/*!*****************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/emitter.js ***!
  \*****************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/fiber-context.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/fiber-context.js ***!
  \***********************************************************/
/*! exports provided: FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return FiberContext; });
var stack = [];
var currentFiber = null;
var providers = [function () { return currentFiber; }];
function pushFiber(fiber) {
    stack.push(currentFiber);
    currentFiber = fiber;
}
function popFiber() {
    currentFiber = stack.pop();
}
var FiberContext = {
    get current() { return currentFiber; },
    /*run: function rerun<R>(fiber: Fiber, fn: ()=>R): R | Promise<R> {
      pushFiber(fiber);
      try {
        return Promise.resolve(fn());
      } catch (p) {
        if (p && typeof p.then === 'function') {
          return p.then(()=>rerun(fiber, fn));
        } else {
          return Promise.reject(p);
        }
      } finally {
        popFiber();
      }
    },*/
    addProvider: function (getCurrentFiber) {
        providers.push(getCurrentFiber);
        setCurrentGetterFromProviders();
    },
    removeProvider: function (getCurrentFiber) {
        providers = providers.filter(function (p) { return p !== getCurrentFiber; });
        setCurrentGetterFromProviders();
    }
};
function setCurrentGetterFromProviders() {
    Object.defineProperty(FiberContext, "current", {
        get: providers.reduce(function (p, c) { return function () { return p() || c(); }; }),
        set: function () { throw new Error("Use FiberContext.push() to change current fiber"); }
    });
}
//# sourceMappingURL=fiber-context.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/index.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/index.js ***!
  \***************************************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });

/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"]; });






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/map.js":
/*!*************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/map.js ***!
  \*************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/mixin.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/mixin.js ***!
  \***************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/observable.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/observable.js ***!
  \********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/value.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/value.js ***!
  \***************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");





var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.read = function () {
        var resolved = false, result, err, notify;
        var subscription = this.subscribe(function (value, error, subsciption) {
            resolved = true;
            result = value;
            err = error;
            if (error && notify)
                notify(null, error, subsciption);
            else if (notify)
                notify(value, null, subsciption);
        });
        if (resolved) {
            var currentFiber = _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"].current;
            if (!currentFiber) {
                subscription.unsubscribe();
                throw new Error("Invalid Fiber Context");
            }
            if (err) {
                subscription.unsubscribe();
                throw err;
            }
            var subscriptions = currentFiber.subscriptions, observer = currentFiber.observer;
            subscriptions.push(subscription);
            notify = observer;
            return result;
        }
        throw new Promise(function (resolve, reject) {
            notify = function (value, error, subscription) {
                subscription.unsubscribe();
                if (error)
                    reject(error);
                else
                    resolve(value);
            };
        });
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "./kedbackend/observable.js":
/*!**********************************!*\
  !*** ./kedbackend/observable.js ***!
  \**********************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Value"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Collection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Emitter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["FiberContext"]; });




/***/ }),

/***/ "./kedbackend/repo.js":
/*!****************************!*\
  !*** ./kedbackend/repo.js ***!
  \****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = [
    "user",
    "role",
    "school",
    "debug",
    "testVersion",
    "testversion",
    "features",
    "schoolType",
    "schooltype"
];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json");
var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json", 1);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/make-suspense-api */ "./src/utils/make-suspense-api.ts");









var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        var _this = this;
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        var isApiMethod = function (m) {
            return typeof _this[m] === 'function' &&
                m !== 'constructor' && // Since makeSuspenseApi() walks prototype chain
                m !== 'privatizingCacheBust' &&
                m !== 'userEmailGetter';
        } // List non-API methods here...
        ;
        Object.keys(EdsClient.prototype).forEach(function (method) {
            if (isApiMethod(method)) {
                _this[method] = avoidSimultanousCalls(_this[method]);
            }
        });
        this.suspense = Object(_utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__["makeSuspenseApi"])(this, { isApiMethod: isApiMethod });
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    /**
     * getSchoolTuitionGroups()
     *
     * Return tuitiongroups for school
     *
     * @param schoolName - name of school
     * @param courseCode - Skolverkets code for course
     */
    EdsClient.prototype.getSchoolTuitionGroups = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTuitionGroups", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTuitionGroups];
                }
            });
        });
    };
    /**
     * getTuitionGroupStudents()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     * @param tuitionGroupName - tuition gruop name in EDS
     */
    EdsClient.prototype.getTuitionGroupStudents = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("TuitionGroupStudents", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.tuitionGroupStudents];
                }
            });
        });
    };
    /**
     * getSchoolTeachers()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     */
    EdsClient.prototype.getSchoolTeachers = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTeachers", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTeachers];
                }
            });
        });
    };
    // we assume that the EDS will return the current academic year dates determined by the current date
    EdsClient.prototype.getAcademicYearTerms = function (schoolLocale, date) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var holidays, firstTermMoment, secondTermMoment, startFirstTermDate, startSecondTermDate, endFirstTermDate, endSecondTermDate, firstTerm, secondTerm;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                // mock data
                switch (schoolLocale) {
                    case 'en_sin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.SouthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'en_nin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.NorthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'sv':
                        {
                            holidays = [];
                            firstTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, true);
                            secondTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, false);
                            startFirstTermDate = firstTermMoment[0];
                            startSecondTermDate = secondTermMoment[0];
                            endFirstTermDate = firstTermMoment[1];
                            endSecondTermDate = secondTermMoment[1];
                            firstTerm = { startDate: new Date(startFirstTermDate.year(), startFirstTermDate.month(), startFirstTermDate.date()).toDateString(), endDate: new Date(startFirstTermDate.year(), endFirstTermDate.month(), endFirstTermDate.date()).toDateString() };
                            secondTerm = { startDate: new Date(startSecondTermDate.year(), startSecondTermDate.month(), startSecondTermDate.date()).toDateString(), endDate: new Date(startSecondTermDate.year(), endSecondTermDate.month(), endSecondTermDate.date()).toDateString() };
                            return [2 /*return*/, { firstTerm: firstTerm, secondTerm: secondTerm, holidays: holidays }];
                        }
                }
                return [2 /*return*/];
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/apis/google-calendar.ts":
/*!*************************************!*\
  !*** ./src/apis/google-calendar.ts ***!
  \*************************************/
/*! exports provided: GoogleCalendar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleCalendar", function() { return GoogleCalendar; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _google_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-client */ "./src/apis/google-client.ts");


var GoogleCalendar = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoogleCalendar, _super);
    function GoogleCalendar(googleTokenProvider) {
        var _this = _super.call(this, { discoveryDocs: 'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest' }) || this;
        _this.setBearerProvider(googleTokenProvider);
        return _this;
    }
    GoogleCalendar.prototype.listCalendars = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        _a.trys.push([2, 4, , 5]);
                        return [4 /*yield*/, gapi.client.calendar.calendarList.list({})];
                    case 3:
                        res = _a.sent();
                        // TODO: What is the normal res.status? 200? Throw if not 200?
                        return [2 /*return*/, res.result.items];
                    case 4:
                        err_1 = _a.sent();
                        // TODO: Parse out error from err (which is an object!)
                        throw err_1.error; // Is this correct? Test!
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    GoogleCalendar.prototype.batchEvents = function (_a) {
        var calendarList = _a.calendarList, timeMin = _a.timeMin, timeMax = _a.timeMax;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var batch_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _b.sent();
                        try {
                            batch_1 = gapi.client.newBatch();
                            calendarList.forEach(function (cal) {
                                batch_1.add(gapi.client.calendar.events.list({
                                    'calendarId': cal.id || 'primary',
                                    'timeMin': timeMin && (new Date(timeMin)).toISOString(),
                                    'timeMax': timeMax && (new Date(timeMax)).toISOString(),
                                    'showDeleted': false,
                                    'singleEvents': true,
                                    'fields': 'items/id,items/start,items/end,items/summary,items/location,items/htmlLink,items/description',
                                    'maxResults': 2500,
                                    'orderBy': 'startTime'
                                }), { 'id': cal.id });
                            });
                            return [2 /*return*/, batch_1.then(function (resp) {
                                    var newCals = {};
                                    for (var i in calendarList) {
                                        var calId = calendarList[i].id;
                                        var events = resp.result[calId].result.items;
                                        newCals[calId] = { calendar: calendarList[i], events: events };
                                    }
                                    return newCals;
                                })];
                        }
                        catch (err) {
                            throw err.error;
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    return GoogleCalendar;
}(_google_client__WEBPACK_IMPORTED_MODULE_1__["GoogleClient"]));



/***/ }),

/***/ "./src/apis/google-client.ts":
/*!***********************************!*\
  !*** ./src/apis/google-client.ts ***!
  \***********************************/
/*! exports provided: GoogleClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleClient", function() { return GoogleClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


var GoogleClient = /** @class */ (function () {
    function GoogleClient(_a) {
        var discoveryDocs = _a.discoveryDocs;
        this.googleTokenProvider = _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["env"].googleTokenProvider;
        this.discoveryDocs = [];
        this.discoveryDocs.push(discoveryDocs);
    }
    GoogleClient.prototype.setBearerProvider = function (googleTokenProvider) {
        this.googleTokenProvider = googleTokenProvider;
    };
    GoogleClient.prototype.ensureInited = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var tokenResult;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(typeof gapi === 'undefined')) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadGapi()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        if (!(!this.tokenExpiration || this.tokenExpiration < new Date())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.googleTokenProvider.getBearer()];
                    case 3:
                        tokenResult = _a.sent();
                        this.tokenExpiration = new Date(tokenResult.expires);
                        this.token = tokenResult.token;
                        gapi.client.setToken({
                            access_token: tokenResult.token
                        });
                        _a.label = 4;
                    case 4: 
                    // Load all discovyerDocs
                    return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: this.discoveryDocs
                        })];
                    case 5:
                        // Load all discovyerDocs
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    GoogleClient.prototype.loadGapi = function () {
        return new Promise(function (resolve) {
            if (typeof gapi !== 'undefined')
                return resolve();
            var script = document.createElement('script');
            script.src = "https://apis.google.com/js/client.js?onload=gaapi_loaded";
            document.getElementsByTagName("head")[0].appendChild(script);
            window.gaapi_loaded = resolve;
        });
    };
    return GoogleClient;
}());



/***/ }),

/***/ "./src/apis/ked-learninggoals.ts":
/*!***************************************!*\
  !*** ./src/apis/ked-learninggoals.ts ***!
  \***************************************/
/*! exports provided: getLearningGoalsAndTasks */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getLearningGoalsAndTasks", function() { return getLearningGoalsAndTasks; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function getLearningGoalsAndTasks(apiPath, pageId) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var res, data;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, fetch(apiPath + "?nodeID=" + pageId, { credentials: "same-origin" })];
                case 1:
                    res = _a.sent();
                    return [4 /*yield*/, res.json()];
                case 2:
                    data = _a.sent();
                    return [2 /*return*/, data];
            }
        });
    });
}


/***/ }),

/***/ "./src/apis/mock/mock-eds-data.json":
/*!******************************************!*\
  !*** ./src/apis/mock/mock-eds-data.json ***!
  \******************************************/
/*! exports provided: SouthIndia, NorthIndia, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"SouthIndia\":[{\"firstTerm\":{\"startDate\":\"2015-06-01T00:00:00.000Z\",\"endDate\":\"2015-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2015-11-01T00:00:00.000Z\",\"endDate\":\"2016-03-27T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2016-06-23T00:00:00.000Z\",\"endDate\":\"2016-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2016-11-01T00:00:00.000Z\",\"endDate\":\"2017-03-25T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2017-06-05T00:00:00.000Z\",\"endDate\":\"2017-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2017-11-01T00:00:00.000Z\",\"endDate\":\"2018-03-30T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2018-06-04T00:00:00.000Z\",\"endDate\":\"2018-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2018-11-01T00:00:00.000Z\",\"endDate\":\"2019-04-29T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2019-06-03T00:00:00.000Z\",\"endDate\":\"2019-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2019-11-01T00:00:00.000Z\",\"endDate\":\"2020-03-27T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2020-06-01T00:00:00.000Z\",\"endDate\":\"2020-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2020-11-01T00:00:00.000Z\",\"endDate\":\"2021-03-26T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2021-06-06T00:00:00.000Z\",\"endDate\":\"2021-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2021-11-01T00:00:00.000Z\",\"endDate\":\"2022-03-25T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2022-06-05T00:00:00.000Z\",\"endDate\":\"2022-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2022-11-01T00:00:00.000Z\",\"endDate\":\"2023-03-31T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2023-06-04T00:00:00.000Z\",\"endDate\":\"2023-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2023-11-01T00:00:00.000Z\",\"endDate\":\"2024-03-29T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2024-06-03T00:00:00.000Z\",\"endDate\":\"2024-10-31T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2024-11-01T00:00:00.000Z\",\"endDate\":\"2025-03-28T00:00:00.000Z\"},\"holidays\":[]}],\"NorthIndia\":[{\"firstTerm\":{\"startDate\":\"2024-04-03T00:00:00.000Z\",\"endDate\":\"2024-09-30T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2024-10-01T00:00:00.000Z\",\"endDate\":\"2025-04-02T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2023-04-05T00:00:00.000Z\",\"endDate\":\"2023-10-01T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2023-10-02T00:00:00.000Z\",\"endDate\":\"2024-04-02T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2022-04-06T00:00:00.000Z\",\"endDate\":\"2022-10-03T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2022-10-04T00:00:00.000Z\",\"endDate\":\"2023-04-04T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2021-04-01T00:00:00.000Z\",\"endDate\":\"2021-10-04T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2021-10-05T00:00:00.000Z\",\"endDate\":\"2022-04-05T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2020-04-01T00:00:00.000Z\",\"endDate\":\"2020-09-28T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2020-09-29T00:00:00.000Z\",\"endDate\":\"2021-03-31T00:00:00.000Z\"},\"holidays\":[{\"startDate\":\"2020-05-17\",\"endDate\":\"2020-06-28\"}]},{\"firstTerm\":{\"startDate\":\"2019-04-04T00:00:00.000Z\",\"endDate\":\"2019-09-30T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2019-10-01T00:00:00.000Z\",\"endDate\":\"2020-03-31T00:00:00.000Z\"},\"holidays\":[{\"startDate\":\"2019-05-19\",\"endDate\":\"2019-06-29\"}]},{\"firstTerm\":{\"startDate\":\"2018-04-04T00:00:00.000Z\",\"endDate\":\"2018-09-30T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2018-10-01T00:00:00.000Z\",\"endDate\":\"2019-04-03T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2017-04-05T00:00:00.000Z\",\"endDate\":\"2017-10-02T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2017-10-03T00:00:00.000Z\",\"endDate\":\"2018-04-03T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2016-04-06T00:00:00.000Z\",\"endDate\":\"2016-10-03T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2016-10-04T00:00:00.000Z\",\"endDate\":\"2017-04-04T00:00:00.000Z\"},\"holidays\":[]},{\"firstTerm\":{\"startDate\":\"2015-04-01T00:00:00.000Z\",\"endDate\":\"2015-10-05T00:00:00.000Z\"},\"secondTerm\":{\"startDate\":\"2015-10-06T00:00:00.000Z\",\"endDate\":\"2016-04-05T00:00:00.000Z\"},\"holidays\":[]}]}");

/***/ }),

/***/ "./src/components/calendar/calendar-self.tsx":
/*!***************************************************!*\
  !*** ./src/components/calendar/calendar-self.tsx ***!
  \***************************************************/
/*! exports provided: CalendarSelf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CalendarSelf", function() { return CalendarSelf; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index */ "./src/components/calendar/index.tsx");





function CalendarSelf(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_index__WEBPACK_IMPORTED_MODULE_4__["Calendar"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props, { env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"] }))));
}


/***/ }),

/***/ "./src/components/calendar/calendar-tutored.tsx":
/*!******************************************************!*\
  !*** ./src/components/calendar/calendar-tutored.tsx ***!
  \******************************************************/
/*! exports provided: CalendarTutored */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CalendarTutored", function() { return CalendarTutored; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index */ "./src/components/calendar/index.tsx");
/* harmony import */ var _utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/tutorable-component */ "./src/components/utility-components/tutorable-component.tsx");





function CalendarTutored(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_2__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_4__["TutorableComponent"], { tutored: true, createComponent: function (env) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_index__WEBPACK_IMPORTED_MODULE_3__["Calendar"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ key: env.currentUser.mail }, props, { env: env }));
            } }));
}


/***/ }),

/***/ "./src/components/calendar/course-name-to-css-class.ts":
/*!*************************************************************!*\
  !*** ./src/components/calendar/course-name-to-css-class.ts ***!
  \*************************************************************/
/*! exports provided: courseNameToCssClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "courseNameToCssClass", function() { return courseNameToCssClass; });
function courseNameToCssClass(cssPrefix, courseName) {
    return "" + cssPrefix + courseName.substr(0, 3).toLowerCase();
}


/***/ }),

/***/ "./src/components/calendar/crunch-colliding-events.ts":
/*!************************************************************!*\
  !*** ./src/components/calendar/crunch-colliding-events.ts ***!
  \************************************************************/
/*! exports provided: crunchCollidingEvents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "crunchCollidingEvents", function() { return crunchCollidingEvents; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


function crunchCollidingEvents(events, isLastCall) {
    var result = [];
    events.forEach(function (event, eventIndex) {
        var overlaps = result.filter(function (x) { return x.startMoment && x.endMoment &&
            (x.startMoment <= event.startMoment) &&
            (x.endMoment > event.startMoment); });
        var allOverlaps = overlaps.concat(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])(overlaps.map(function (o) { return o.prevOverlaps; })));
        allOverlaps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["distinct"])(allOverlaps, function (o) { return o.index; });
        allOverlaps.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["compareProp"])("startMoment"));
        var width; // = Math.round(100 / Math.max((allOverlaps.length + 1), 1));
        var pos = 0;
        allOverlaps.forEach(function (overlap, i) {
            if (i % 4 === 0) {
                width = Math.max(25, Math.round(100 / Math.max(allOverlaps.length - i + 1, 1)));
                pos = 0;
            }
            overlap.width = width;
            overlap.className = (overlap.className || "").split(' ')
                .filter(function (cn) { return cn !== 'splitted'; })
                .concat("splitted")
                .join(' '),
                overlap.pos = pos;
            pos += width;
        });
        result.push(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, event, { index: eventIndex, pos: pos, width: width, className: width < 100 ?
                (event.className ? event.className + " splitted" : "splitted") :
                event.className, prevOverlaps: allOverlaps }));
        /*if (isLastCall && moment(event.start).day() === 1) {
          if (/Sve2/.test(event.text)) {
            debugger;
          }
          if (/Franska/.test(event.text)) {
            debugger;
          }
          if (/Tyska/.test(event.text)) {
            debugger;
          }
          if (/spansk/.test(event.text)) debugger;
          if (/Eng6/.test(event.text)) debugger;
        }*/
    });
    return result;
}


/***/ }),

/***/ "./src/components/calendar/day-view-event.tsx":
/*!****************************************************!*\
  !*** ./src/components/calendar/day-view-event.tsx ***!
  \****************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return DayViewEvent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/constants */ "./src/utils/constants.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");





function DayViewEvent(_a) {
    var id = _a.id, dayStart = _a.dayStart, startMoment = _a.startMoment, endMoment = _a.endMoment, text = _a.text, location = _a.location, description = _a.description, width = _a.width, pos = _a.pos, locale = _a.locale, zoom = _a.zoom, htmlLink = _a.htmlLink, className = _a.className;
    var top = (moment__WEBPACK_IMPORTED_MODULE_2___default()(startMoment).diff(dayStart) / _utils_constants__WEBPACK_IMPORTED_MODULE_3__["MINUTE"]) * zoom;
    var height = (moment__WEBPACK_IMPORTED_MODULE_2___default()(endMoment).diff(startMoment) / _utils_constants__WEBPACK_IMPORTED_MODULE_3__["MINUTE"]) * zoom;
    var localeTimeOptions = { hour: 'numeric', minute: '2-digit' };
    var localeStartTime = startMoment.toDate().toLocaleTimeString(locale, localeTimeOptions);
    var localeEndTime = endMoment.toDate().toLocaleTimeString(locale, localeTimeOptions);
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "dayviewevent " + className, style: {
            position: 'absolute',
            boxSizing: 'border-box',
            top: top,
            left: (pos || 0) + "%",
            width: (width || 100) + '%',
            height: height,
            maxHeight: height,
            overflow: 'hidden'
        }, title: localeStartTime + " - " + localeEndTime + " " + text +
            (location ?
                "\n" + Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Plats: ", ""], ["Plats: ", ""])), location) :
                "") +
            (description ?
                "\n" + description :
                "") },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "event-title", href: htmlLink, target: "calendar-event" }, text),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "event-period" },
            localeStartTime,
            " - ",
            localeEndTime),
        location &&
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "event-location" }, location),
        description &&
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "event-description" }, description));
}
var templateObject_1;


/***/ }),

/***/ "./src/components/calendar/day-view.tsx":
/*!**********************************************!*\
  !*** ./src/components/calendar/day-view.tsx ***!
  \**********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return DayView; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _day_view_event__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./day-view-event */ "./src/components/calendar/day-view-event.tsx");
/* harmony import */ var _time_lines__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./time-lines */ "./src/components/calendar/time-lines.tsx");
/* harmony import */ var _utils_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/constants */ "./src/utils/constants.js");
/* harmony import */ var _crunch_colliding_events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./crunch-colliding-events */ "./src/components/calendar/crunch-colliding-events.ts");






function DayView(_a) {
    var dayStart = _a.dayStart, // Milliseconds at start of the day (for example 08:00 the day)
    dayEnd = _a.dayEnd, // Milliseconds at end of the day (for example 17:00 the day)
    events = _a.events, // Events to show
    locale = _a.locale, zoom = _a.zoom, isLastCall = _a.isLastCall;
    var height = (moment__WEBPACK_IMPORTED_MODULE_1___default()(dayEnd).diff(dayStart) / _utils_constants__WEBPACK_IMPORTED_MODULE_4__["MINUTE"]) * zoom;
    var crunchedEvents = Object(_crunch_colliding_events__WEBPACK_IMPORTED_MODULE_5__["crunchCollidingEvents"])(events, isLastCall);
    return (react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "dayview", style: {
            top: 0,
            height: height,
            maxHeight: height,
            position: 'relative',
            overflow: 'hidden'
        } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_time_lines__WEBPACK_IMPORTED_MODULE_3__["default"], { dayStart: dayStart, dayEnd: dayEnd, zoom: zoom }),
        crunchedEvents.map(function (ev) { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_day_view_event__WEBPACK_IMPORTED_MODULE_2__["default"], { key: ev.id, id: ev.id, className: ev.className, dayStart: dayStart, startMoment: ev.startMoment, endMoment: ev.endMoment, text: ev.text, location: ev.location, description: ev.description, width: ev.width, pos: ev.pos, locale: locale, zoom: zoom, htmlLink: ev.htmlLink }); })));
}


/***/ }),

/***/ "./src/components/calendar/hour-marker.tsx":
/*!*************************************************!*\
  !*** ./src/components/calendar/hour-marker.tsx ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return HourMarker; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function HourMarker(_a) {
    var startHour = _a.startHour, endHour = _a.endHour, locale = _a.locale, zoom = _a.zoom;
    var hourPixels = 60 * zoom;
    var hours = [];
    for (var hour = startHour; hour <= endHour; ++hour) {
        hours.push(hour);
    }
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "hourmarker", style: {
            position: 'relative',
            left: 0,
            top: 0,
            overflow: 'visible',
            height: (endHour - startHour) * hourPixels
        } }, hours.map(function (hour, i) {
        var ypos = i * hourPixels;
        return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", { key: hour },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { style: {
                    position: 'absolute',
                    left: 0,
                    top: ypos,
                    marginTop: '-4px',
                    padding: 0
                } }, moment__WEBPACK_IMPORTED_MODULE_1___default()().hour(hour).minute(0).toDate().toLocaleString(locale, { hour: "2-digit", minute: "2-digit" })));
    }));
}


/***/ }),

/***/ "./src/components/calendar/index.tsx":
/*!*******************************************!*\
  !*** ./src/components/calendar/index.tsx ***!
  \*******************************************/
/*! exports provided: Calendar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Calendar", function() { return Calendar; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _week_view__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./week-view */ "./src/components/calendar/week-view.tsx");
/* harmony import */ var _apis_google_calendar__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../apis/google-calendar */ "./src/apis/google-calendar.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_name_to_css_class__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./course-name-to-css-class */ "./src/components/calendar/course-name-to-css-class.ts");
/* harmony import */ var _should_include_calendar__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./should-include-calendar */ "./src/components/calendar/should-include-calendar.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");










var Calendar = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Calendar, _super);
    function Calendar(props) {
        var _this = _super.call(this, props) || this;
        // Props
        var firstDay = props.firstDay;
        if (typeof firstDay === 'string' || typeof firstDay === 'number') {
            firstDay = moment__WEBPACK_IMPORTED_MODULE_4___default()().startOf('week').weekday(firstDay);
        }
        var _a = _this.props, initialStartHour = _a.initialStartHour, initialEndHour = _a.initialEndHour, initialZoom = _a.initialZoom;
        // State
        _this.state = {
            firstDay: firstDay,
            startHour: initialStartHour,
            endHour: initialEndHour,
            zoom: initialZoom,
            calendars: {},
            calendarsBeingLoaded: [],
            status: 'Loading calendars... (authenticating...)',
            error: null
        };
        var googleTokenProvider = (props.env || _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"]).googleTokenProvider;
        _this.gcal = new _apis_google_calendar__WEBPACK_IMPORTED_MODULE_3__["GoogleCalendar"](googleTokenProvider);
        // Start calling on Google API right away. Store promise in property.
        _this.gcal.ensureInited().then(function () {
            return _this.loadData(firstDay);
        }).catch(function (error) {
            _this.handleError(error);
        });
        return _this;
    }
    Calendar.prototype.handleError = function (error) {
        if (!error)
            error = "Unknown error";
        this.setState({ error: error });
        console.error(error.stack || error); // Keep!
    };
    Calendar.prototype.loadData = function (firstDay) {
        var _this = this;
        // Props
        var numDays = this.props.numDays;
        var intl = this.context.intl;
        this.setState({
            firstDay: firstDay,
            calendars: {},
            calendarsBeingLoaded: [],
            error: null,
            status: intl.formatMessage({ id: "calendar.loadingCalendar", defaultMessage: "Loading calendars... (listing...)" })
        });
        // Important to return the Promise so that caller will catch any error.
        return this.gcal.listCalendars().then(function (calendars) {
            // Ignore the "week numbers" calendar as we already include week numbers in our view
            calendars = calendars.filter(function (cal) { return Object(_should_include_calendar__WEBPACK_IMPORTED_MODULE_7__["shouldIncludeCalendar"])(cal); });
            //!/Week Numbers/ig.test(c.summary)
            //console.log(calendars.map(c => ({bgColor: c.backgroundColor, primary: c.primary, summary: c.summary, x: c})));
            // Calendars Successfully listed.
            _this.setState({
                status: intl.formatMessage({ id: "calendar.loadCalendarEvents", defaultMessage: "Load calendar events..." })
            });
            _this.gcal.batchEvents({
                calendarList: calendars,
                timeMin: moment__WEBPACK_IMPORTED_MODULE_4___default()(firstDay).startOf('day'),
                timeMax: moment__WEBPACK_IMPORTED_MODULE_4___default()(firstDay).add(numDays, 'days').endOf('day')
            }).then(function (result) {
                _this.setState({ calendars: result, status: '' });
            });
        });
    };
    Calendar.prototype.navigateToPreviousWeek = function () {
        var _this = this;
        this.loadData(moment__WEBPACK_IMPORTED_MODULE_4___default()(this.state.firstDay).add(-1, "week")).catch(function (error) {
            _this.handleError(error);
        });
    };
    Calendar.prototype.navigateToNextWeek = function () {
        var _this = this;
        this.loadData(moment__WEBPACK_IMPORTED_MODULE_4___default()(this.state.firstDay).add(1, "week")).catch(function (error) {
            _this.handleError(error);
        });
    };
    Calendar.prototype.render = function () {
        var _this = this;
        // Props
        var numDays = this.props.numDays;
        var intl = this.context.intl;
        // State
        var _a = this.state, firstDay = _a.firstDay, startHour = _a.startHour, endHour = _a.endHour, zoom = _a.zoom, calendars = _a.calendars, status = _a.status, error = _a.error;
        var eventSets = Object.keys(calendars)
            .map(function (calendarId) { return calendars[calendarId]; })
            .map(function (_a) {
            var calendar = _a.calendar, events = _a.events;
            var isSchedule = calendar.summary === 'Skolschema' && calendar.description === "Synchronized";
            var isHoliday = /holiday/.test(calendar.id);
            var isClassRoom = /classroom/.test(calendar.id);
            var classNames = [];
            if (calendar.colorId)
                classNames.push("gcal-palette-" + calendar.colorId);
            if (isSchedule)
                classNames.push("course-event");
            if (isHoliday)
                classNames.push("holiday-event");
            // Map Google Calendar events to our own format:
            return events.map(function (event) { return ({
                id: event.id,
                start: event.start,
                end: event.end,
                text: event.summary,
                location: event.location,
                description: event.description,
                //bgColor: calendar.backgroundColor,
                //fgColor: calendar.foregroundColor,
                htmlLink: event.htmlLink,
                className: (isSchedule && event.summary ?
                    classNames.concat(Object(_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_6__["courseNameToCssClass"])('course-event-', event.summary)) :
                    classNames).join(" ")
            }); });
        });
        var events = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["flatten"])(eventSets);
        // Else, render the WeekView now. Any error should be displayed as red status
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { position: 'relative', top: 0, left: 0 } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-toolbar week-navigation" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.navigateToPreviousWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.navigateToNextWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" }, intl.formatMessage({ id: "calendar.currentDate", defaultMessage: "Vecka {week}, {year}" }, { week: moment__WEBPACK_IMPORTED_MODULE_4___default()(firstDay).week(), year: moment__WEBPACK_IMPORTED_MODULE_4___default()(firstDay).year() }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_week_view__WEBPACK_IMPORTED_MODULE_2__["default"], { locale: intl.locale, firstDay: firstDay, startHour: startHour, endHour: endHour, numDays: numDays, zoom: zoom, events: events, status: status, error: error }));
    };
    Calendar.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_9__["LanguageContext"];
    return Calendar;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/calendar/should-include-calendar.ts":
/*!************************************************************!*\
  !*** ./src/components/calendar/should-include-calendar.ts ***!
  \************************************************************/
/*! exports provided: shouldIncludeCalendar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shouldIncludeCalendar", function() { return shouldIncludeCalendar; });
/* Calendars to show:

    summary: "Matsedel",
    summary: "Skolschema",
    primary: true
    id.includes('classroom')
    id.includes('holiday')
*/
function shouldIncludeCalendar(cal) {
    var summary = cal.summary || "";
    var isOwner = /owner/ig.test(cal.accessRole);
    var isPrimary = !!cal.primary;
    var isClassroomCalendar = /classroom/ig.test(cal.id);
    var isHolidayCalendar = /holiday/ig.test(cal.id);
    return (isPrimary ||
        isClassroomCalendar ||
        isHolidayCalendar ||
        ///matsedel/ig.test(summary) ||
        (/schema/ig.test(summary) && isOwner));
}


/***/ }),

/***/ "./src/components/calendar/status-bar.tsx":
/*!************************************************!*\
  !*** ./src/components/calendar/status-bar.tsx ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return StatusBar; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

function StatusBar(_a) {
    var status = _a.status, error = _a.error;
    if (!status && !error)
        return null;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "statusbar" }, error ?
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", { className: "error" }, '' + error) :
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", { className: "status" }, status));
}


/***/ }),

/***/ "./src/components/calendar/time-lines.tsx":
/*!************************************************!*\
  !*** ./src/components/calendar/time-lines.tsx ***!
  \************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return TimeLines; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function TimeLines(_a) {
    var dayStart = _a.dayStart, dayEnd = _a.dayEnd, zoom = _a.zoom;
    var hourPixels = 60 * zoom;
    var startHour = moment__WEBPACK_IMPORTED_MODULE_1___default()(dayStart).hour();
    var endHour = moment__WEBPACK_IMPORTED_MODULE_1___default()(dayEnd).hour();
    var hours = [];
    for (var hour = startHour; hour <= endHour; ++hour) {
        hours.push(hour);
    }
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", null, hours.map(function (hour) {
        return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { key: hour, className: "timeline", style: {
                width: '100%',
                boxSizing: 'border-box',
                margin: hourPixels / 2 + "px 0 0 0",
                height: hourPixels / 2
            } });
    }));
}


/***/ }),

/***/ "./src/components/calendar/week-view.tsx":
/*!***********************************************!*\
  !*** ./src/components/calendar/week-view.tsx ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _day_view__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./day-view */ "./src/components/calendar/day-view.tsx");
/* harmony import */ var _hour_marker__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./hour-marker */ "./src/components/calendar/hour-marker.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _status_bar__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./status-bar */ "./src/components/calendar/status-bar.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");








var WeekView = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekView, _super);
    function WeekView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WeekView.prototype.render = function () {
        // Props:
        var _a = this.props, firstDay = _a.firstDay, // {moment} The day to start with (normally a monday)
        startHour = _a.startHour, // {number} The hour to start on
        endHour = _a.endHour, // {number} The hour to end rendering per day
        numDays = _a.numDays, // {number} Number of days, normally 5.
        events = _a.events, // Array of events to display in the week.
        locale = _a.locale, // Locale to use for showing week days and hour marks.
        zoom = _a.zoom, // {number} Zoom where 1 means that 1 minute = 1 pixel.  
        status = _a.status, error = _a.error;
        var intl = this.context.intl;
        // Prepare DayView datas 
        var dayDatas = [];
        var day = moment__WEBPACK_IMPORTED_MODULE_2___default()(firstDay);
        var _loop_1 = function (i) {
            var dayStart = moment__WEBPACK_IMPORTED_MODULE_2___default()(day).hour(startHour);
            var dayEnd = moment__WEBPACK_IMPORTED_MODULE_2___default()(day).hour(endHour);
            var dayDate = moment__WEBPACK_IMPORTED_MODULE_2___default()(day).format('yyyy-MM-DD');
            var isToday = moment__WEBPACK_IMPORTED_MODULE_2___default()(dayStart).startOf("day").valueOf() === moment__WEBPACK_IMPORTED_MODULE_2___default()().startOf("day").valueOf();
            dayDatas.push({
                name: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["capitalizeFirst"])(dayStart.toDate().toLocaleString(locale, {
                    weekday: 'long',
                    day: 'numeric',
                    month: 'short'
                })),
                dayStart: dayStart,
                dayEnd: dayEnd,
                isToday: isToday,
                events: events.filter(function (event) {
                    return event.start && event.end && event.start.dateTime && event.end.dateTime &&
                        (moment__WEBPACK_IMPORTED_MODULE_2___default()(event.start.dateTime).isBetween(dayStart, dayEnd) ||
                            moment__WEBPACK_IMPORTED_MODULE_2___default()(event.end.dateTime).isBetween(dayStart, dayEnd));
                })
                    // Change start / end to directly point to the dateTime
                    .map(function (event) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["clone"])(event, { startMoment: moment__WEBPACK_IMPORTED_MODULE_2___default()(event.start.dateTime), endMoment: moment__WEBPACK_IMPORTED_MODULE_2___default()(event.end.dateTime) }); })
                    .sort(function (a, b) { return a.startMoment.valueOf > b.startMoment.valueOf ? 1 : a.startMoment < b.startMoment ? -1 : 0; }),
                fullDayEvents: events.filter(function (event) {
                    // Verify that it is a full-day-event
                    return event.start && event.end && event.start.date && event.end.date &&
                        // Verify it applies to current day
                        (event.start.date <= dayDate && event.end.date > dayDate);
                })
                    // Change start / end to directly point to the date object
                    .map(function (event) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["clone"])(event, {
                    startDate: event.start.date,
                    endDate: event.end.date
                }); })
            });
            day = moment__WEBPACK_IMPORTED_MODULE_2___default()(day) // clone it
                .add(1, 'days'); // Add another day
        };
        for (var i = 0; i < numDays; ++i) {
            _loop_1(i);
        }
        // Render
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "vemendo-weekview" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { border: 0 } }),
                        dayDatas.map(function (d) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: d.dayStart.toISOString(), className: d.isToday ? "today" : null },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "dayname" }, d.name)); })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { border: 0 } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "week-number" }, intl.formatMessage({ id: "calendar.weekNumber", defaultMessage: "V{weekNumber}" }, { weekNumber: moment__WEBPACK_IMPORTED_MODULE_2___default()(firstDay).week() }))),
                        dayDatas.map(function (day) {
                            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: day.dayStart.toISOString(), className: day.isToday ? "today" : null }, day.fullDayEvents.map(function (_a) {
                                var id = _a.id, text = _a.text, location = _a.location, description = _a.description, htmlLink = _a.htmlLink, className = _a.className;
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: id, className: "dayviewevent full-day " + className, title: "" + text + (location ?
                                        "\n" + intl.formatMessage({ id: "calendar.fullDayEventLocation", defaultMessage: "Plats: {location}" }, { location: location }) :
                                        "") +
                                        (description ?
                                            "\n" + description :
                                            "") },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "event-title", href: htmlLink, target: "calendar-event" }, text),
                                    location &&
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "event-location" }, location),
                                    description &&
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "event-description" }, description));
                            }));
                        })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { border: 0 } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_hour_marker__WEBPACK_IMPORTED_MODULE_4__["default"], { startHour: startHour, endHour: endHour, locale: locale, zoom: zoom })),
                        dayDatas.map(function (day) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: day.dayStart.toISOString(), className: day.isToday ? "today" : null },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_day_view__WEBPACK_IMPORTED_MODULE_3__["default"], { key: day.dayStart.toISOString(), dayStart: day.dayStart, dayEnd: day.dayEnd, events: day.events, locale: locale, zoom: zoom, isLastCall: status == '' }),
                            " "); })),
                    (status || error) && (!error || error.name !== "UnauthorizedError") &&
                        //
                        // Show status / error
                        //
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { border: 0 } }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { border: 0 }, colSpan: numDays },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_status_bar__WEBPACK_IMPORTED_MODULE_6__["default"], { status: status, error: error }))))));
    };
    WeekView.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_7__["LanguageContext"];
    return WeekView;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));
/* harmony default export */ __webpack_exports__["default"] = (WeekView);


/***/ }),

/***/ "./src/components/charts/charts-utils.ts":
/*!***********************************************!*\
  !*** ./src/components/charts/charts-utils.ts ***!
  \***********************************************/
/*! exports provided: getWeekplannerProgressData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getWeekplannerProgressData", function() { return getWeekplannerProgressData; });
function getWeekplannerProgressData(taskSets) {
    var chartTasks = { completedTasks: 0, totalNumberOfTasks: 0, subjectData: {} };
    taskSets.forEach(function (elem) { return elem.learningGoals.forEach(function (x) {
        var subjectCompletedTasks = x.tasks.filter(function (t) { return t.done; }).length;
        var courseSubjectData = chartTasks.subjectData[elem.courseName];
        if (!courseSubjectData) {
            courseSubjectData = chartTasks.subjectData[elem.courseName] = {
                completedNumberOfTasks: 0,
                numberOfTasks: 0
            };
        }
        courseSubjectData.completedNumberOfTasks += subjectCompletedTasks;
        courseSubjectData.numberOfTasks += x.tasks.length;
        chartTasks.completedTasks += subjectCompletedTasks;
        chartTasks.totalNumberOfTasks += x.tasks.length;
    }); });
    return chartTasks;
}


/***/ }),

/***/ "./src/components/charts/doughnut.tsx":
/*!********************************************!*\
  !*** ./src/components/charts/doughnut.tsx ***!
  \********************************************/
/*! exports provided: Doughnut */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Doughnut", function() { return Doughnut; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var Doughnut = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Doughnut, _super);
    function Doughnut() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Doughnut.prototype.render = function () {
        var _a = this.props, percentage = _a.percentage, errorMessage = _a.errorMessage, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
        //default values
        var stroke = 2;
        //equals with he circumference/2II
        var radius = 100 / (2 * 3.14);
        //take into account the stroke
        var center = radius + stroke;
        var viewboxW = center * 2;
        var viewvboxH = center * 2;
        var roundedPercentage = Math.round(percentage);
        var startErrorText = 10;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { className: "doughnut-chart", viewBox: "0 0 " + viewboxW + " " + viewvboxH, width: "100%", height: "100%" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", stroke: backgroundColor, strokeWidth: stroke + 1, fill: "none", cx: center, cy: center, r: radius }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-circle", stroke: progressColor, ref: "progressCircle", strokeWidth: stroke, style: { strokeDasharray: roundedPercentage + ", 100" }, strokeLinecap: "round", fill: "none", cx: center, cy: center, r: radius }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("g", { className: "circle-chart-info" }, !errorMessage ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("text", { className: "circle-chart-percent", x: center, y: center, alignmentBaseline: "central", textAnchor: "middle" }, roundedPercentage + "%") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("text", { className: "circle-chart-percent-error", x: center, y: center, alignmentBaseline: "central", fontSize: "5", textAnchor: "middle" }, errorMessage.split(' ').map(function (element) {
                    var tspan = react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tspan", { key: element, x: center, y: startErrorText }, element);
                    startErrorText += 5;
                    return tspan;
                })))));
    };
    Doughnut.defaultProps = {
        backgroundColor: "#efefef",
        progressColor: "#3dbca2",
        errorMessage: null
    };
    return Doughnut;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/charts/goal-progress.tsx":
/*!*************************************************!*\
  !*** ./src/components/charts/goal-progress.tsx ***!
  \*************************************************/
/*! exports provided: GoalProgress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoalProgress", function() { return GoalProgress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var GoalProgress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoalProgress, _super);
    function GoalProgress() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.createProgress = function () {
            var _a = _this.props, numberOfTasks = _a.numberOfTasks, completedNumberOfTasks = _a.completedNumberOfTasks, maximumTasksDisplayed = _a.maximumTasksDisplayed, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
            var progress = [];
            if (numberOfTasks > maximumTasksDisplayed) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progress-overview" },
                    " ",
                    completedNumberOfTasks,
                    " / ",
                    numberOfTasks,
                    " ");
            }
            for (var taskNo = 1; taskNo <= numberOfTasks; taskNo++) {
                progress.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { key: taskNo },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", fill: taskNo > completedNumberOfTasks ? backgroundColor : progressColor, cx: "8", cy: "8", r: "8" })));
            }
            return progress;
        };
        return _this;
    }
    GoalProgress.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "goals-progress" }, this.createProgress());
    };
    GoalProgress.defaultProps = {
        numberofTasks: 0,
        completedNumberOfTasks: 0,
        maximumTasksDisplayed: 10,
        backgroundColor: "lightgrey",
        progressColor: "#3dbca2",
    };
    return GoalProgress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/charts/progress.tsx":
/*!********************************************!*\
  !*** ./src/components/charts/progress.tsx ***!
  \********************************************/
/*! exports provided: Progress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Progress", function() { return Progress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var Progress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.render = function () {
        var _a = this.props, percentage = _a.percentage, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
        var roundedPercentage = Math.round(percentage);
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { className: "progress-chart", width: "100%", height: "25" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { fill: backgroundColor, width: "100%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { className: "fill", fill: progressColor, width: roundedPercentage + "%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("text", { className: "filled-text", textAnchor: "middle", x: "50%", y: "50%", dy: ".3em" }, roundedPercentage + "%")));
    };
    Progress.defaultProps = {
        percentage: 0,
        backgroundColor: "#F1F5F4",
        progressColor: "#3dbca2",
    };
    return Progress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/ellipsis-loader.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/ellipsis-loader.tsx ***!
  \**************************************************************************/
/*! exports provided: EllipsisLoader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EllipsisLoader", function() { return EllipsisLoader; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var EllipsisLoader = function () {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("img", { style: { border: 0, margin: 0, padding: 0 }, className: "ellipsis-loader" });
};


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function (_a) {
    var _b = _a.label, label = _b === void 0 ? "" : _b;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
        "\u00A0",
        label);
};


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/confirmation.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/confirmation.tsx ***!
  \*********************************************************************/
/*! exports provided: Confirmation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Confirmation", function() { return Confirmation; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

function Confirmation(props) {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "confirmation-box " + props.className + (props.visible ? " visible" : "") },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null, props.text),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onConfirm(); } }, "OK"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onCancel(); } }, "Avbryt"));
}


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/learning-goals-list.tsx ***!
  \****************************************************************************/
/*! exports provided: LearningGoalsList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LearningGoalsList", function() { return LearningGoalsList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _task_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");




var LearningGoalsList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LearningGoalsList, _super);
    function LearningGoalsList() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LearningGoalsList.prototype.render = function () {
        var _a = this.props, commonTasks = _a.commonTasks, learningGoals = _a.learningGoals;
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            learningGoals.map(function (lg) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, lg.name),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: lg.learningTasks })); }),
            commonTasks.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                learningGoals.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, intl.formatMessage({ id: "learningGoalsLost.overall", defaultMessage: "vergripande" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: commonTasks })));
    };
    LearningGoalsList.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"];
    return LearningGoalsList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/task-list.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/task-list.tsx ***!
  \******************************************************************/
/*! exports provided: TaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskList", function() { return TaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _confirmation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./confirmation */ "./src/components/course-viewer/subcomponents/confirmation.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _utility_components_checkbox__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utility-components/checkbox */ "./src/components/utility-components/checkbox.tsx");










var TaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskList, _super);
    function TaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            confirmations: []
        };
        _this.onChange = _this.onChange.bind(_this);
        return _this;
    }
    TaskList.prototype.onChange = function (userTasks, persisted) {
        if (persisted.weekDate !== this.state.weekDate) {
            this.setState({
                confirmations: []
            });
        }
        this.setState({
            userTasks: userTasks,
            weekDate: persisted.weekDate
        });
    };
    TaskList.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onChange);
    };
    TaskList.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onChange);
    };
    TaskList.prototype.toggleTask = function (learningTask) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var userTasks, weekDate, latestTimeStamp, userTask;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        userTasks = this.state.userTasks.filter(function (ut) {
                            return learningTask.task ?
                                ut.task && ut.task.some(function (t) { return t.id === learningTask.id; }) :
                                ut.siteVisionPageId === learningTask.id;
                        });
                        weekDate = this.state.weekDate;
                        if (!(userTasks.length === 0)) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        userTask = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                            courseName: learningTask.courseName,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: learningTask.learningGoal,
                            name: learningTask.name,
                            url: learningTask.url,
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not custom tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (learningTask.task && learningTask.task.deadline) {
                            userTask.deadline = learningTask.task.deadline;
                        }
                        if (learningTask.task) {
                            userTask.task = [learningTask.task];
                            if (learningTask.course) {
                                userTask.course = [learningTask.course];
                            }
                            else if (learningTask.courseInfo) {
                                userTask.courseInfo = learningTask.courseInfo;
                            }
                        }
                        else {
                            userTask.siteVisionPageId = learningTask.id;
                        }
                        if (learningTask.step) {
                            userTask.step = learningTask.step;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(learningTask.courseName, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask])
                            ])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Already present in weekplanner. It's time to delete those that matched us.
                    return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete(userTasks.map(function (t) { return t.id; }))];
                    case 3:
                        // Already present in weekplanner. It's time to delete those that matched us.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskList.prototype.render = function () {
        var _this = this;
        var intl = this.context.intl;
        var learningTasks = this.props.learningTasks;
        var userTasks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["arrayToMap"])(this.state.userTasks, function (ut) { return ut.task && ut.task.length > 0 ?
            ut.task.map(function (t) { return t.id; })[0] : // course-builder tasks looked up by id
            ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks
                ut.url; });
        var confirmations = this.state.confirmations;
        var weekPlannerWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()(this.state.weekDate).week();
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "" :
            weekPlannerWeek === currentWeek + 1 ? intl.formatMessage({ id: "taskList.nextWeekTask", defaultMessage: "fr nsta vecka (v{week})" }, { week: weekPlannerWeek }) :
                weekPlannerWeek === currentWeek - 1 ? intl.formatMessage({ id: "taskList.lastWeekTask", defaultMessage: "fr frra veckan (v{week})" }, { week: weekPlannerWeek }) :
                    intl.formatMessage({ id: "taskList.currentWeekTask", defaultMessage: "fr vecka {week}" }, { week: weekPlannerWeek });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, learningTasks.map(function (learningTask, idx) {
            var taskLookupId = learningTask.id;
            var userTask = userTasks[taskLookupId] || { $meta: 'deleted' }; // No exist = $meta: 'deleted'
            var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';
            var selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';
            var describedAction = selected ?
                intl.formatMessage({ id: "taskList.removeTaskFromWeeklyPlanning", defaultMessage: "Ta bort uppgiften frn egen veckoplanering {week}" }, { week: forWeekString }) :
                intl.formatMessage({ id: "taskList.addTaskToWeeklyPlanning", defaultMessage: "Lgg till uppgiften i egen veckoplanering {week}" }, { week: forWeekString });
            var confirmationVisible = confirmations.some(function (tid) { return taskLookupId === tid; });
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_checkbox__WEBPACK_IMPORTED_MODULE_9__["UIAddbox"], { state: selected ? 'checked' : '', onClick: function () { return !isWorking && weekPlannerWeek === currentWeek ?
                        _this.toggleTask(learningTask) :
                        confirmationVisible ?
                            _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) }) :
                            _this.setState({ confirmations: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](confirmations).concat(taskLookupId) }); }, label: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { title: describedAction, href: learningTask.url }, learningTask.name) }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_confirmation__WEBPACK_IMPORTED_MODULE_7__["Confirmation"], { visible: confirmationVisible, text: describedAction, onConfirm: function () {
                        _this.toggleTask(learningTask);
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    }, onCancel: function () {
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    } }));
        }));
    };
    TaskList.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__["LanguageContext"];
    return TaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/kg-termplanner/kg-termplanner-self.tsx":
/*!***************************************************************!*\
  !*** ./src/components/kg-termplanner/kg-termplanner-self.tsx ***!
  \***************************************************************/
/*! exports provided: KGTermPlannerSelf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KGTermPlannerSelf", function() { return KGTermPlannerSelf; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _kg_termplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kg-termplanner */ "./src/components/kg-termplanner/kg-termplanner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");



function KGTermPlannerSelf() {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_kg_termplanner__WEBPACK_IMPORTED_MODULE_1__["KGTermPlanner"], { env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"], tutored: false });
}


/***/ }),

/***/ "./src/components/kg-termplanner/kg-termplanner-tutored.tsx":
/*!******************************************************************!*\
  !*** ./src/components/kg-termplanner/kg-termplanner-tutored.tsx ***!
  \******************************************************************/
/*! exports provided: KGTermPlannerTutored */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KGTermPlannerTutored", function() { return KGTermPlannerTutored; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _kg_termplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kg-termplanner */ "./src/components/kg-termplanner/kg-termplanner.tsx");
/* harmony import */ var _utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/tutorable-component */ "./src/components/utility-components/tutorable-component.tsx");



function KGTermPlannerTutored() {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__["TutorableComponent"], { tutored: true, createComponent: function (env) {
            return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_kg_termplanner__WEBPACK_IMPORTED_MODULE_1__["KGTermPlanner"], { key: env.currentUser.mail, env: env, tutored: true });
        } });
}


/***/ }),

/***/ "./src/components/kg-termplanner/kg-termplanner.tsx":
/*!**********************************************************!*\
  !*** ./src/components/kg-termplanner/kg-termplanner.tsx ***!
  \**********************************************************/
/*! exports provided: KGTermPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KGTermPlanner", function() { return KGTermPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _week_note_dialog__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./week-note-dialog */ "./src/components/kg-termplanner/week-note-dialog.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _ks_termplanner_tutor_dialog__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ks-termplanner/tutor-dialog */ "./src/components/ks-termplanner/tutor-dialog.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");













var KGTermPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KGTermPlanner, _super);
    function KGTermPlanner(props) {
        var _this = _super.call(this, props) || this;
        var now = new Date();
        _this.state = {
            now: now,
            courses: [],
            weekPlans: [],
            isLoadingCourses: true,
            isLoadingWeekPlans: true,
            dialogs: []
            //goals: []
        };
        _this.updateWeekPlans = _this.updateWeekPlans.bind(_this);
        return _this;
    }
    KGTermPlanner.prototype.componentDidMount = function () {
        this.loadEDSCourses();
        this.props.env.kgTermPlannerRepo.mem.subscribe(this.updateWeekPlans);
    };
    KGTermPlanner.prototype.componentWillUnmount = function () {
        this.props.env.kgTermPlannerRepo.mem.unsubscribe(this.updateWeekPlans);
    };
    KGTermPlanner.prototype.updateWeekPlans = function (weekPlans) {
        this.setState({ weekPlans: weekPlans, isLoadingWeekPlans: false });
    };
    KGTermPlanner.prototype.loadEDSCourses = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schoolMoment, periodName, courses, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _b.trys.push([0, , 2, 3]);
                        schoolMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_3__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(this.state.now));
                        periodName = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_2__["EDSPeriod"](schoolMoment).period;
                        _a = _utils_utils__WEBPACK_IMPORTED_MODULE_8__["distinct"];
                        return [4 /*yield*/, this.props.env.edsClient.getActiveCourses({ periodName: periodName })];
                    case 1:
                        courses = _a.apply(void 0, [_b.sent(), function (course) { return course.name; }]);
                        //console.log("courses:" + JSON.stringify(courses, null, 2));
                        this.setState({ courses: courses });
                        return [3 /*break*/, 3];
                    case 2:
                        this.setState({ isLoadingCourses: false });
                        return [7 /*endfinally*/];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KGTermPlanner.prototype.onNoteClick = function (weekNumber, weekDate, courseName, weekPlan, note) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_week_note_dialog__WEBPACK_IMPORTED_MODULE_7__["WeekNoteDialog"], { weekNumber: weekNumber, weekDate: weekDate, courseName: courseName, weekPlan: weekPlan, note: note, env: this.props.env, closeDialog: function () { return _this.closeDialog(); } }));
    };
    /**
   *
   * @param weekNumber
   * @param comment
   *
   * Add a comment from tutor
   */
    KGTermPlanner.prototype.onTutorClick = function (tutorNote, weekNumber) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_ks_termplanner_tutor_dialog__WEBPACK_IMPORTED_MODULE_11__["TutorDialog"], { weekNumber: weekNumber, comment: tutorNote.value, updateData: function (newValue) { return _this.updateTutorNoteField(tutorNote, newValue); }, deleteNoteData: function () { return _this.deleteTutorNoteField(tutorNote.id); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    KGTermPlanner.prototype.deleteTutorNoteField = function (noteId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var showError_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.props.env.kgTermPlannerRepo.delete([noteId])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        showError_1 = _a.sent();
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KGTermPlanner.prototype.updateTutorNoteField = function (tutorNote, newValue) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var oldValue, showError_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        oldValue = (tutorNote && tutorNote.value) || "";
                        if (oldValue === newValue)
                            return [2 /*return*/];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        tutorNote.value = newValue;
                        //set document ACL
                        tutorNote.acl = [
                            new kedbackend_client__WEBPACK_IMPORTED_MODULE_10__["DocumentAccess"]("tutorFor", this.props.env.currentUser.mail, "S").toString(),
                            new kedbackend_client__WEBPACK_IMPORTED_MODULE_10__["DocumentAccess"]("email", this.props.env.currentUser.mail, "R").toString(),
                        ];
                        return [4 /*yield*/, this.props.env.kgTermPlannerRepo.upsert(tutorNote, function (note) { return note.value = newValue; })];
                    case 2: return [2 /*return*/, _a.sent()];
                    case 3:
                        showError_2 = _a.sent();
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KGTermPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    KGTermPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    KGTermPlanner.prototype.render = function () {
        var _this = this;
        var _a = this.state, courses = _a.courses, now = _a.now, isLoadingCourses = _a.isLoadingCourses, isLoadingWeekPlans = _a.isLoadingWeekPlans, weekPlans = _a.weekPlans, dialogs = _a.dialogs;
        var isLoading = isLoadingCourses || isLoadingWeekPlans;
        var weeks = [];
        var tutorNotes = [];
        var schoolMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_3__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(now));
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_3__["getTermStarEndDate"])(now, schoolMoment.term === 'AT'), 2), termStart = _b[0], termEnd = _b[1];
        var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_3__["getFirstAndLastWeekOfTerm"])(schoolMoment.term), 2), firstWeek = _c[0], lastWeek = _c[1];
        var showKgTutorCommentField = _features__WEBPACK_IMPORTED_MODULE_12__["features"].kgTutorComment;
        var currentWeekPlans = weekPlans.filter(function (x) { return !x.type; });
        var currentTutorNotes = weekPlans.filter(function (x) { return x.type === 'tutor-note'; });
        var _loop_1 = function (weekMoment) {
            var weekNumber = weekMoment.week();
            var weekYear = weekMoment.year();
            var kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_9__["KEDWeek"])(weekYear, weekNumber);
            if (weekNumber >= firstWeek && weekNumber <= lastWeek) {
                var weekPlan = currentWeekPlans.filter(function (wp) {
                    return wp.dateTime >= kedWeek.notBefore &&
                        wp.dateTime <= kedWeek.notAfter;
                })[0];
                var tutorNote = currentTutorNotes.filter(function (wp) {
                    return wp.dateTime >= kedWeek.notBefore &&
                        wp.dateTime <= kedWeek.notAfter;
                })[0];
                var startOfWeek = weekMoment.clone().startOf('week').valueOf();
                weeks.push({
                    weekNumber: weekNumber,
                    weekDate: startOfWeek,
                    weekPlan: weekPlan
                });
                tutorNotes.push({
                    weekNumber: weekNumber,
                    tutorValue: tutorNote || { value: '', dateTime: startOfWeek, id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_10__["createUUID"])(), type: 'tutor-note' }
                });
            }
        };
        for (var weekMoment = termStart.clone(); weekMoment.valueOf() < termEnd.valueOf(); weekMoment = weekMoment.clone().add(1, 'week').startOf('week')) {
            _loop_1(weekMoment);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Terminsplanering"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            isLoading ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__["Spinner"], null) : courses.length === 0 ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Terminsplaneraren aktiveras n\u00E4r du skrivits in p\u00E5 dina kurser") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "termplanner-table zebra" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Vecka"),
                            courses.map(function (c, idx) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: idx, className: "kgCourseHeader" }, c.name); }),
                            showKgTutorCommentField && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { className: "tutorHeader" }))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, weeks.map(function (w, idx) {
                        var isCurrentWeek = w.weekNumber === moment__WEBPACK_IMPORTED_MODULE_4___default()().week();
                        var noteValue = tutorNotes && tutorNotes.find(function (tn) { return tn.weekNumber === w.weekNumber; });
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: idx, className: isCurrentWeek ? "currentWeek" : "" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, w.weekNumber),
                            courses.map(function (c, idx) {
                                var note = w.weekPlan && w.weekPlan.plans[c.name];
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: idx, className: note ? "courseNote note-color-" + note.color : "courseNote", "data-tooltip": note && note.description, title: note && note.description, onClick: function () { return _this.onNoteClick(w.weekNumber, w.weekDate, c.name, w.weekPlan, note); } }, note ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fas fa-align-center" }) : '');
                            }),
                            showKgTutorCommentField && (_this.props.tutored ?
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: idx, onClick: function () { return _this.onTutorClick(noteValue.tutorValue, w.weekNumber); }, className: "tutorCell" }, noteValue.tutorValue.value ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx, "data-tooltip": noteValue.tutorValue.value },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fas fa-comment-dots" })) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fas fa-comment-medical" })))
                                :
                                    noteValue.tutorValue.value ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "tutorCell" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { "data-tooltip": noteValue.tutorValue.value },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "far fa-comment-dots" }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null)));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tfoot", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: "points" }, "Po\u00E4ng"),
                            courses.map(function (c, idx) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: idx, className: "stepCell" }, c.credits); })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Betygsm\u00E5l"),
                            courses.map(function (c, idx) {
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: idx, className: "stepCell" }, c.periodGoalGrade);
                            })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_6__["Dialogs"], { dialogs: dialogs, popDialog: function () { return _this.setState({ dialogs: dialogs.slice(0, dialogs.length - 1) }); } }));
    };
    return KGTermPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/kg-termplanner/week-note-dialog.tsx":
/*!************************************************************!*\
  !*** ./src/components/kg-termplanner/week-note-dialog.tsx ***!
  \************************************************************/
/*! exports provided: WeekNoteDialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekNoteDialog", function() { return WeekNoteDialog; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");



var WeekNoteDialog = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekNoteDialog, _super);
    function WeekNoteDialog(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            description: props.note ? props.note.description : '',
            color: props.note ? props.note.color : 'yellow'
        };
        return _this;
    }
    WeekNoteDialog.prototype.delete = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, weekNumber, weekDate, courseName, weekPlan, note, closeDialog, env, _b, description, color;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.props, weekNumber = _a.weekNumber, weekDate = _a.weekDate, courseName = _a.courseName, weekPlan = _a.weekPlan, note = _a.note, closeDialog = _a.closeDialog, env = _a.env;
                        _b = this.state, description = _b.description, color = _b.color;
                        closeDialog();
                        if (!(Object.keys(weekPlan.plans).length === 1)) return [3 /*break*/, 2];
                        return [4 /*yield*/, env.kgTermPlannerRepo.delete([weekPlan.id])];
                    case 1:
                        _c.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, env.kgTermPlannerRepo.update([weekPlan], function (wp) {
                            delete wp.plans[courseName];
                        })];
                    case 3:
                        _c.sent();
                        _c.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    WeekNoteDialog.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, weekNumber, weekDate, courseName, weekPlan, note, closeDialog, env, _b, description, color, plans;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.props, weekNumber = _a.weekNumber, weekDate = _a.weekDate, courseName = _a.courseName, weekPlan = _a.weekPlan, note = _a.note, closeDialog = _a.closeDialog, env = _a.env;
                        _b = this.state, description = _b.description, color = _b.color;
                        closeDialog();
                        if (description.length == 0) {
                            return [2 /*return*/];
                        }
                        if (!weekPlan) return [3 /*break*/, 2];
                        return [4 /*yield*/, env.kgTermPlannerRepo.update([weekPlan], function (wp) { return wp.plans[courseName] = { description: description, color: color }; })];
                    case 1:
                        _c.sent();
                        return [3 /*break*/, 4];
                    case 2:
                        plans = {};
                        plans[courseName] = { description: description, color: color };
                        return [4 /*yield*/, env.kgTermPlannerRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(),
                                    dateTime: weekDate,
                                    plans: plans
                                }])];
                    case 3:
                        _c.sent();
                        _c.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    WeekNoteDialog.prototype.render = function () {
        var _this = this;
        var _a = this.props, weekNumber = _a.weekNumber, courseName = _a.courseName, weekPlan = _a.weekPlan, note = _a.note, env = _a.env;
        var _b = this.state, description = _b.description, color = _b.color;
        var readOnly = env.tutored;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                    "H\u00E4ndelse f\u00F6r vecka ",
                    weekNumber,
                    " och ",
                    courseName),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-table" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Beskrivning:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "fullWidth" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: true, value: description, disabled: readOnly, onChange: function (ev) { return _this.setState({ description: ev.target.value }); } }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-table" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "F\u00E4rg:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: color, disabled: readOnly, onChange: function (ev) { return _this.setState({ color: ev.target.value }); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "yellow" }, "Gul"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "yellowLight" }, "Ljusgul"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "cyan" }, "Gr\u00F6n"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "cyanLight" }, "Ljusgr\u00F6n"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "purple" }, "Lila"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "purpleLight" }, "Ljuslila"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "red" }, "R\u00F6d"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { value: "redLight" }, "Rosa"))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, readOnly ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.props.closeDialog(); } }, "Avbryt") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } }, "Spara"),
                    note && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-warning btn-large pull-right", onClick: function () { return _this.delete(); } }, "Ta bort"))));
    };
    return WeekNoteDialog;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/ks-goals/future-abilities-table.tsx":
/*!************************************************************!*\
  !*** ./src/components/ks-goals/future-abilities-table.tsx ***!
  \************************************************************/
/*! exports provided: FutureAbilitiesTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FutureAbilitiesTable", function() { return FutureAbilitiesTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _future_abilities_viewmodel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./future-abilities-viewmodel */ "./src/components/ks-goals/future-abilities-viewmodel.ts");




var FutureAbilitiesTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FutureAbilitiesTable, _super);
    function FutureAbilitiesTable(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            loading: false,
            data: [],
            error: null
        };
        return _this;
    }
    FutureAbilitiesTable.prototype.componentWillMount = function () {
        this.load();
    };
    FutureAbilitiesTable.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ loading: true });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].edsClient.getStudentFutureAbilities()];
                    case 2:
                        data = _a.sent();
                        this.setState({ data: data });
                        return [3 /*break*/, 4];
                    case 3:
                        error_1 = _a.sent();
                        this.setState({ error: error_1 });
                        return [3 /*break*/, 4];
                    case 4:
                        this.setState({ loading: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    FutureAbilitiesTable.prototype.render = function () {
        var viewModel = new _future_abilities_viewmodel__WEBPACK_IMPORTED_MODULE_3__["FutureAbilitiesViewModel"](this.state.data);
        var columnHeaders = viewModel.columnHeaders, vtHts = viewModel.vtHts, capabRows = viewModel.capabRows;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "Framtidsf\u00F6rm\u00E5gor"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "partialEditStudyPlanViewMode" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { width: '100%' }, className: "smallFont" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columnHeaders.map(function (_a, i) {
                            var name = _a.name, type = _a.type;
                            return type === 'header' ?
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: i, rowSpan: 2 }, name) :
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: i, colSpan: 2 }, name);
                        })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { className: "header" }, vtHts.map(function (vtHt, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: i }, vtHt); }))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, capabRows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i, className: (Math.floor(i / 3) % 2) && 'tableOdd' }, row.map(function (col, i) { return col.type === 'ability' ?
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: i, rowSpan: 3, className: "goalsSubject" }, col.name) :
                        col.type === 'capability' ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: i, className: "goalsSubject" }, col.name) :
                            col.selected ?
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: i, className: "edsSelected" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "markedItem" })) :
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: i }); })); })))));
    };
    return FutureAbilitiesTable;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/ks-goals/future-abilities-viewmodel.ts":
/*!***************************************************************!*\
  !*** ./src/components/ks-goals/future-abilities-viewmodel.ts ***!
  \***************************************************************/
/*! exports provided: FutureAbilitiesViewModel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FutureAbilitiesViewModel", function() { return FutureAbilitiesViewModel; });
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");

var FutureAbilitiesViewModel = /** @class */ (function () {
    function FutureAbilitiesViewModel(data) {
        // Will build the total years
        var formNames = {};
        data.forEach(function (a) { return a.capabilities.forEach(function (c) { return formNames[c.formName] = true; }); });
        var years = Object.keys(formNames);
        // columnHeaders
        this.columnHeaders = [{
                name: "Framtidsfrmga",
                type: "header"
            }, {
                name: "Omrde",
                type: "header"
            }].concat(years.map(function (year) { return ({
            name: year,
            type: 'year'
        }); }));
        // vtHts
        this.vtHts = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__["flatten"])(years.map(function (year) { return ["HT", "VT"]; }));
        // cababRows
        var rows = [];
        data.forEach(function (a) {
            var row = [{ type: 'ability', name: a.abilityName }];
            var addedCapabs = {};
            a.capabilities.forEach(function (c) {
                var cells = [
                    { type: 'term', selected: c.htHasValue !== false },
                    { type: 'term', selected: c.vtHasValue !== false }
                ];
                //if (c.htHasValue || c.vtHasValue) debugger;
                if (!addedCapabs[c.capabilityName]) {
                    //if (!isFirstCapability) rows.push(row);
                    if (row.length > 1) {
                        rows.push(row);
                        row = [];
                    }
                    addedCapabs[c.capabilityName] = true;
                    row.push({ type: 'capability', name: c.capabilityName });
                    cells.forEach(function (cell) { return row.push(cell); });
                }
                else if (row) {
                    //addedCapabs[c.capabilityName].concat(cells);
                    cells.forEach(function (cell) { return row.push(cell); });
                }
            });
            if (row)
                rows.push(row);
        });
        this.capabRows = rows;
    }
    return FutureAbilitiesViewModel;
}());



/***/ }),

/***/ "./src/components/ks-goals/goals-viewmodel.ts":
/*!****************************************************!*\
  !*** ./src/components/ks-goals/goals-viewmodel.ts ***!
  \****************************************************/
/*! exports provided: ViewModel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ViewModel", function() { return ViewModel; });
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../apis/edsclient */ "./src/apis/edsclient.ts");

var ViewModel = /** @class */ (function () {
    function ViewModel(studyPlans) {
        this.subjects = studyPlans.map(function (sp) {
            var periodGoals = sp.periodGoals
                .map(function (g) { return ({ period: new _apis_edsclient__WEBPACK_IMPORTED_MODULE_0__["EDSPeriod"](g.periodName), goal: g.gradeName }); });
            return {
                name: sp.courseUnitName,
                atGoal: periodGoals.filter(function (_a) {
                    var period = _a.period;
                    return period.term === 'AT';
                }).map(function (_a) {
                    var goal = _a.goal;
                    return goal;
                })[0],
                stGoal: periodGoals.filter(function (_a) {
                    var period = _a.period;
                    return period.term === 'ST';
                }).map(function (_a) {
                    var goal = _a.goal;
                    return goal;
                })[0],
                finalGoal: sp.finalGoalGrade,
                strategies: sp.strategyText
            };
        });
    }
    return ViewModel;
}());



/***/ }),

/***/ "./src/components/ks-goals/goals.tsx":
/*!*******************************************!*\
  !*** ./src/components/ks-goals/goals.tsx ***!
  \*******************************************/
/*! exports provided: KSGoals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KSGoals", function() { return KSGoals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _goals_viewmodel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./goals-viewmodel */ "./src/components/ks-goals/goals-viewmodel.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _future_abilities_table__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./future-abilities-table */ "./src/components/ks-goals/future-abilities-table.tsx");






var KSGoals = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KSGoals, _super);
    function KSGoals(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            loadingStudyPlans: false,
            studyPlans: [],
            error: null
        };
        return _this;
    }
    KSGoals.prototype.componentWillMount = function () {
        this.load();
    };
    KSGoals.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var studyPlans, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ loadingStudyPlans: true });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].edsClient.getStudentGoals()];
                    case 2:
                        studyPlans = _a.sent();
                        this.setState({ studyPlans: studyPlans });
                        return [3 /*break*/, 4];
                    case 3:
                        error_1 = _a.sent();
                        this.setState({ error: error_1 });
                        return [3 /*break*/, 4];
                    case 4:
                        this.setState({ loadingStudyPlans: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    KSGoals.prototype.render = function () {
        var viewModel = new _goals_viewmodel__WEBPACK_IMPORTED_MODULE_3__["ViewModel"](this.state.studyPlans);
        var showTermGoals = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.schoolType).toLowerCase() !== "gymnasium";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["M\u00E5l"], ["M\u00E5l"])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "smallFont" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mne"], ["\u00C4mne"])))),
                        showTermGoals && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["HT"], ["HT"])))),
                        showTermGoals && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["VT"], ["VT"])))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Slutm\u00E5l"], ["Slutm\u00E5l"])))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Strategier"], ["Strategier"])))))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, viewModel.subjects.map(function (s, i) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: s.name, className: i % 2 && "tableOdd" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "goalsSubject" }, s.name),
                        showTermGoals && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "goalsTerm" }, s.atGoal),
                        showTermGoals && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "goalsTerm" }, s.stGoal),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "goalsEnd" }, s.finalGoal),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, s.strategies));
                }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "divider" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_future_abilities_table__WEBPACK_IMPORTED_MODULE_5__["FutureAbilitiesTable"], null));
    };
    return KSGoals;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6;


/***/ }),

/***/ "./src/components/ks-termplanner/ks-termplanner-self.tsx":
/*!***************************************************************!*\
  !*** ./src/components/ks-termplanner/ks-termplanner-self.tsx ***!
  \***************************************************************/
/*! exports provided: KSTermPlannerSelf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KSTermPlannerSelf", function() { return KSTermPlannerSelf; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _termplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./termplanner */ "./src/components/ks-termplanner/termplanner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");




function KSTermPlannerSelf(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_termplanner__WEBPACK_IMPORTED_MODULE_1__["KSTermPlanner"], { env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"], tutored: false, initialDate: new Date() }));
}


/***/ }),

/***/ "./src/components/ks-termplanner/ks-termplanner-tutored.tsx":
/*!******************************************************************!*\
  !*** ./src/components/ks-termplanner/ks-termplanner-tutored.tsx ***!
  \******************************************************************/
/*! exports provided: KSTermPlannerTutored */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KSTermPlannerTutored", function() { return KSTermPlannerTutored; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _termplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./termplanner */ "./src/components/ks-termplanner/termplanner.tsx");
/* harmony import */ var _utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/tutorable-component */ "./src/components/utility-components/tutorable-component.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");




function KSTermPlannerTutored(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__["TutorableComponent"], { tutored: true, createComponent: function (env) {
                return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_termplanner__WEBPACK_IMPORTED_MODULE_1__["KSTermPlanner"], { key: env.currentUser.mail, env: env, tutored: true, initialDate: new Date() });
            } }));
}


/***/ }),

/***/ "./src/components/ks-termplanner/termplanner-utils.ts":
/*!************************************************************!*\
  !*** ./src/components/ks-termplanner/termplanner-utils.ts ***!
  \************************************************************/
/*! exports provided: getFirstAndLastWeek, LAST_STEP_SPRING, LAST_STEP_AUTUMN, findCourseFromColumnHeader, getColumnsHeader, getColumnHeaderFromCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeek", function() { return getFirstAndLastWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LAST_STEP_SPRING", function() { return LAST_STEP_SPRING; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LAST_STEP_AUTUMN", function() { return LAST_STEP_AUTUMN; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "findCourseFromColumnHeader", function() { return findCourseFromColumnHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getColumnsHeader", function() { return getColumnsHeader; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getColumnHeaderFromCourse", function() { return getColumnHeaderFromCourse; });
function getFirstAndLastWeek(term) {
    return term === 'AT' ?
        [33, 50] : // This is a guess! Need data! Should be possible to get from skola24?
        [2, 23]; // This is a guess! Need data!
}
var LAST_STEP_SPRING = 28; // Week 28 is in summer. Use it as placeholder for "last step"
var LAST_STEP_AUTUMN = 52; // Week must be valid. Use it as placeholder for "last step"
/**
 * Note that this function is tightly coupled to the swedish school.
 */
function findCourseFromColumnHeader(courses, columnHeader) {
    switch (columnHeader) {
        case 'M.spr': return courses
            .filter(function (course) { return course.shortName !== 'MA' && course.shortName.startsWith('M'); })[0] || null;
        case 'Ma': return courses.filter(function (c) { return c.shortName === "MA"; })[0] || null;
        case 'Sv/SvA': return courses.filter(function (c) { return c.shortName.startsWith("SV"); })[0] || null;
        case 'Eng': return courses.filter(function (c) { return c.shortName === "EN"; })[0] || null;
    }
    return null;
}
function getColumnsHeader(locale) {
    switch (locale) {
        case 'sv':
            return ['M.spr', 'Ma', 'Sv/SvA', 'Eng'];
        case 'en_sin':
            return ['MFL', 'Ma', 'Hi', 'Eng', 'Yoga', 'ICT'];
        case 'en_nin':
            return ['MFL', 'Ma', 'Hi', 'Eng', 'Yoga', 'ICT'];
    }
}
/**
 * Note that this function is tightly coupled to the swedish school.
 */
function getColumnHeaderFromCourse(course) {
    var shortName = course.shortName;
    if (shortName === "MA")
        return 'Ma';
    if (shortName === "EN")
        return 'Eng';
    if (shortName.startsWith("SV"))
        return 'Sv/SvA';
    if (shortName.startsWith("M2"))
        return 'M.spr';
    return null;
}


/***/ }),

/***/ "./src/components/ks-termplanner/termplanner.tsx":
/*!*******************************************************!*\
  !*** ./src/components/ks-termplanner/termplanner.tsx ***!
  \*******************************************************/
/*! exports provided: KSTermPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KSTermPlanner", function() { return KSTermPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_generic_school_term__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/generic-school-term */ "./src/utils/generic-school-term.ts");
/* harmony import */ var _viewmodel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./viewmodel */ "./src/components/ks-termplanner/viewmodel.ts");
/* harmony import */ var _utility_components_content_editable_field__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/content-editable-field */ "./src/components/utility-components/content-editable-field.tsx");
/* harmony import */ var _repos_ks_termplanner_repo_instance__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../repos/ks-termplanner-repo-instance */ "./src/repos/ks-termplanner-repo-instance.ts");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _charts_doughnut__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../charts/doughnut */ "./src/components/charts/doughnut.tsx");
/* harmony import */ var _utils_generic_school_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../utils/generic-school-utils */ "./src/utils/generic-school-utils.ts");
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _tutor_dialog__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./tutor-dialog */ "./src/components/ks-termplanner/tutor-dialog.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");

















var KSTermPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KSTermPlanner, _super);
    function KSTermPlanner(props) {
        var _this = _super.call(this, props) || this;
        _this.unmounted = false;
        _this.state = {
            schoolTerm: new _utils_generic_school_term__WEBPACK_IMPORTED_MODULE_2__["GenericSchoolTerm"](props.initialDate),
            activeCourses: [],
            weekPlans: [],
            error: null,
            loadingActiveCourses: false,
            loadingWeekPlans: false,
            initialLoad: true,
            dialogs: []
        };
        _this.flowId = 1;
        _this.updateWeekPlans = _this.updateWeekPlans.bind(_this);
        return _this;
    }
    KSTermPlanner.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.load(this.state.schoolTerm)];
                    case 1:
                        _a.sent();
                        if (!this.unmounted)
                            this.props.env.ksTermPlannerRepo.mem.subscribe(this.updateWeekPlans);
                        return [2 /*return*/];
                }
            });
        });
    };
    KSTermPlanner.prototype.componentWillUnmount = function () {
        this.unmounted = true;
        this.props.env.ksTermPlannerRepo.mem.unsubscribe(this.updateWeekPlans);
    };
    KSTermPlanner.prototype.updateWeekPlans = function (weekPlansOrTutorComm, error) {
        this.setState({ weekPlans: weekPlansOrTutorComm, loadingWeekPlans: false, error: error || null });
    };
    KSTermPlanner.prototype.load = function (schoolTerm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var flowId, ksTermPlannerRepo, term, currentSchoolTerm, activeCourses, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        flowId = ++this.flowId;
                        this.fields = [];
                        this.setState({
                            //loadingWeekPlans: true,
                            loadingActiveCourses: true
                        });
                        ksTermPlannerRepo = this.props.env.ksTermPlannerRepo;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 4, , 5]);
                        return [4 /*yield*/, this.loadAcademicYearDates(schoolTerm, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__["default"].KED_SCHOOL_LOCALE)];
                    case 2:
                        term = _a.sent();
                        if (this.flowId !== flowId)
                            return [2 /*return*/];
                        currentSchoolTerm = new _utils_generic_school_term__WEBPACK_IMPORTED_MODULE_2__["GenericSchoolTerm"](schoolTerm.selectedDate, this.context.intl.locale, term);
                        //refresh saved data
                        ksTermPlannerRepo.refreshData(currentSchoolTerm.getTermStartAndEnd(true));
                        return [4 /*yield*/, this.loadActiveCourses(currentSchoolTerm)];
                    case 3:
                        activeCourses = _a.sent();
                        if (this.flowId !== flowId)
                            return [2 /*return*/];
                        this.setState({ schoolTerm: currentSchoolTerm, initialLoad: false, activeCourses: activeCourses, loadingActiveCourses: false });
                        return [3 /*break*/, 5];
                    case 4:
                        error_1 = _a.sent();
                        if (this.flowId !== flowId)
                            return [2 /*return*/];
                        this.setState({ schoolTerm: currentSchoolTerm, loadingActiveCourses: false, error: error_1 });
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    KSTermPlanner.prototype.loadAcademicYearDates = function (schoolTerm, schoolLocale) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var termDates;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.edsClient.getAcademicYearTerms(schoolLocale, schoolTerm.selectedDate)];
                    case 1:
                        termDates = _a.sent();
                        return [2 /*return*/, termDates];
                }
            });
        });
    };
    KSTermPlanner.prototype.loadActiveCourses = function (schoolTerm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var periodName, activeCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        periodName = schoolTerm.getEdsPeriodName();
                        return [4 /*yield*/, this.props.env.edsClient.getActiveCourses({ periodName: periodName })];
                    case 1:
                        activeCourses = _a.sent();
                        return [2 /*return*/, activeCourses];
                }
            });
        });
    };
    KSTermPlanner.prototype.updateCell = function (weekPlan, columnName, newValue) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var oldValue, error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        oldValue = (weekPlan && weekPlan.cellValues[columnName]) || "";
                        if (oldValue === newValue)
                            return [2 /*return*/];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        weekPlan.cellValues[columnName] = newValue;
                        return [4 /*yield*/, this.props.env.ksTermPlannerRepo.upsert(weekPlan, function (wp) { return wp.cellValues[columnName] = newValue; })];
                    case 2: return [2 /*return*/, _a.sent()];
                    case 3:
                        error_2 = _a.sent();
                        console.error(error_2.stack || error_2);
                        if (error_2.name === "http403") {
                            this.setState({ error: this.context.intl({ id: "common.changesNotSavedUnauthorized", defaultMessage: "ndringarna sparades inte p.g.a. otillrcklig behrighet." }) });
                        }
                        else {
                            this.setState({ error: this.context.intl({ id: "common.changesNotSavedErrorOccured", defaultMessage: "Fr tillfllet problem att spara data. Dina ndringar sparades inte." }) });
                        }
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     *
     * @param tutorNote
     * @param newValue
     *
     * Update tutor field value
     */
    KSTermPlanner.prototype.updateTutorNoteField = function (tutorNote, newValue) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var oldValue, showError_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        oldValue = (tutorNote && tutorNote.content) || "";
                        if (oldValue === newValue)
                            return [2 /*return*/];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        tutorNote.content = newValue;
                        //set document ACL
                        tutorNote.acl = [
                            new kedbackend_client__WEBPACK_IMPORTED_MODULE_14__["DocumentAccess"]("tutorFor", this.props.env.currentUser.mail, "S").toString(),
                            new kedbackend_client__WEBPACK_IMPORTED_MODULE_14__["DocumentAccess"]("email", this.props.env.currentUser.mail, "R").toString(),
                        ];
                        return [4 /*yield*/, this.props.env.ksTermPlannerRepo.upsert(tutorNote, function (note) { return note.content = newValue; })];
                    case 2: return [2 /*return*/, _a.sent()];
                    case 3:
                        showError_1 = _a.sent();
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Delete tutor comment by Id
     * @param noteId
     */
    KSTermPlanner.prototype.deleteTutorNoteField = function (noteId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var showError_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.props.env.ksTermPlannerRepo.delete([noteId])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        showError_2 = _a.sent();
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Add a comment from tutor
     * @param weekNumber
     * @param comment
     *
     */
    KSTermPlanner.prototype.onTutorClick = function (note) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_tutor_dialog__WEBPACK_IMPORTED_MODULE_13__["TutorDialog"], { weekNumber: note.weekNumber, comment: note.content, intl: this.context.intl, updateData: function (val) { return _this.updateTutorNoteField(note, val); }, deleteNoteData: function () { return _this.deleteTutorNoteField(note.id); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    KSTermPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    KSTermPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    /**
     * Navigate to adjacent field depending on direction
     * @param pos current position in field-matrix
     * @param direction direction to take
     */
    KSTermPlanner.prototype.navigate = function (pos, direction) {
        var newpos = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, pos);
        var maxRows = this.fields.length;
        var maxCols = Math.max.apply(Math, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.fields.map(function (row) { return row.length; })));
        switch (direction) {
            case 'up':
                newpos.row = Math.max(pos.row - 1, 0);
                break;
            case 'down':
                newpos.row = Math.min(pos.row + 1, maxRows);
                break;
            case 'left':
                newpos.col = Math.max(pos.col - 1, 0);
                break;
            case 'right':
                newpos.col = Math.min(pos.col + 1, maxCols);
                break;
        }
        if (this.fields[newpos.row] && this.fields[newpos.row][newpos.col])
            this.fields[newpos.row][newpos.col].myself.current.focus();
    };
    /**
     * Adds field to field-matrix to enable navigation in thee table
     * @param field current field
     * @param pos position of field in field-matrix
     */
    KSTermPlanner.prototype.addField = function (field, pos) {
        if (this.fields[pos.row] === undefined) {
            this.fields[pos.row] = [];
        }
        this.fields[pos.row][pos.col] = field;
    };
    /**
     * Creates the cell in the termplanner table
     * @param rowIndex index of row in table
     * @param colIndex index of column in table
     * @param subjectName name field
     * @param model --unused?
     * @param weekPlan current row from weekPlan
     * @param readOnlyCells if cells are readonly
     */
    KSTermPlanner.prototype.getTableCell = function (rowIndex, colIndex, subjectName, model, weekPlan, readOnlyCells, colType) {
        var _this = this;
        var completedSteps = model.completedSteps;
        var pos = { row: rowIndex, col: colIndex };
        if (colType === 'Tutor') {
            var tutoredWeekPlan = weekPlan;
            var content = tutoredWeekPlan.content;
            if (this.props.tutored) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: "tutornote" + colIndex, onClick: function () { return _this.onTutorClick(tutoredWeekPlan); }, className: "tutorCell" }, content ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: colIndex, "data-tooltip": content },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { key: colIndex, className: "fas fa-comment-dots" })) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: colIndex },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { key: colIndex, className: "fas fa-comment-medical" })));
            }
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: "tutornote" + colIndex, className: "tutorCell" }, content && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: colIndex, "data-tooltip": content },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { key: colIndex, className: "far fa-comment-dots" })));
        }
        else {
            var currentWeekPlan = weekPlan;
            var cellValues = currentWeekPlan.cellValues;
            // an outer td cell and inner div is used to regulate the height and allow for ellipses on text-overflow
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: this.getCellClassName(completedSteps, cellValues, subjectName) },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_content_editable_field__WEBPACK_IMPORTED_MODULE_4__["ContentEditableField"], { key: colIndex, ref: function (field) { return _this.addField(field, pos); }, text: cellValues[subjectName], tag: 'div', validateValue: colType == 'Step' ? /^\d*$/ : undefined, maxChars: colType == 'Comment' ? 100 : (colType == 'Course' ? 30 : 3), onChange: this.updateCell.bind(this, weekPlan, subjectName), readOnly: readOnlyCells || colType == 'Tutor', allowNavigation: true, onNavigate: this.navigate.bind(this, pos) }));
        }
    };
    /**
     * Get classname for cell
     * @param completedSteps
     * @param cellValues
     * @param subjectName
     */
    KSTermPlanner.prototype.getCellClassName = function (completedSteps, cellValues, subjectName) {
        var colType = this.getColumnType(subjectName);
        if (colType == 'Step' && completedSteps[subjectName + cellValues[subjectName]]) {
            return 'stepCell completedStep';
        }
        return colType.toLowerCase() + 'Cell';
    };
    /**
     * Creates the cell in the termplanner tables footer
     * @param rowIndex index of row in table
     * @param colIndex index of column in table
     * @param subjectName name field
     * @param model
     * @param readOnlyCells if cells are readonly
     */
    KSTermPlanner.prototype.getFooterCell = function (rowIndex, colIndex, subjectName, model, readOnlyCells) {
        var _this = this;
        var pos = { row: rowIndex, col: colIndex };
        var colType = this.getColumnType(subjectName);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { className: colType + "Footer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_content_editable_field__WEBPACK_IMPORTED_MODULE_4__["ContentEditableField"], { key: "stepFooterCell" + colIndex, ref: function (field) { return _this.addField(field, pos); }, tag: 'div', text: model.lastSteps.cellValues[subjectName], onChange: this.updateCell.bind(this, model.lastSteps, subjectName), readOnly: readOnlyCells, maxChars: 10, allowNavigation: true, onNavigate: this.navigate.bind(this, pos) }));
    };
    KSTermPlanner.prototype.getStepHeaderColumn = function (index, translatedColumnHeader, colType) {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: "stepHeaderCell_" + index, className: colType.toLowerCase() + "Header" }, colType != 'Tutor' ? translatedColumnHeader : '');
    };
    KSTermPlanner.prototype.getColumnType = function (name) {
        var colTypes = { 'Kommentar': 'Comment', 'Kurs': 'Course', 'TutorComment': 'Tutor' };
        return colTypes.hasOwnProperty(name) ? colTypes[name] : 'Step';
    };
    KSTermPlanner.prototype.openCloseProgressCharts = function (value) {
        localStorage.setItem('TermplannerBoxCharts', value);
    };
    KSTermPlanner.prototype.getStepCharts = function (columns, subjectProgress) {
        var _this = this;
        var chartsBoxState = JSON.parse(localStorage.getItem('TermplannerBoxCharts'));
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_16__["OpenCloseBox"], { headerOpen: chartsBoxState, onOpenClose: this.openCloseProgressCharts, title: this.context.intl.formatMessage({ id: "termplanner.chartsBoxTitle", defaultMessage: "Min progression" }) },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "charts-container" }, columns.map(function (element) {
                if (!element.isFixed) {
                    var percentage = subjectProgress[element.name] ? subjectProgress[element.name].value : 0;
                    var errorMessage = subjectProgress[element.name].finalStepCompleted ? null :
                        _this.context.intl.formatMessage({ id: "termplanner.noFinalStepAvailable", defaultMessage: "Inget slutsteg tillgngligt" });
                    var translatedColumns = Object(_utils_generic_school_utils__WEBPACK_IMPORTED_MODULE_11__["getSchoolTranslatedSubjectFullname"])(_this.context.intl);
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: element.name, className: "chart-box" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, translatedColumns[element.name]),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: element.name, className: "inner-chart-box" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_doughnut__WEBPACK_IMPORTED_MODULE_10__["Doughnut"], { key: element.name, percentage: percentage, errorMessage: errorMessage })));
                }
            })));
    };
    KSTermPlanner.prototype.getWeekTutorNote = function (weekPlansOrTutorNote, weekNumber) {
        return weekPlansOrTutorNote.find(function (x) { return x.type === "tutor-note" && x.weekNumber === weekNumber; });
    };
    KSTermPlanner.prototype.render = function () {
        var _this = this;
        var intl = this.context.intl;
        var showTutorCommentField = _features__WEBPACK_IMPORTED_MODULE_15__["features"].ksTutorComment;
        var showDoughnutCharts = _features__WEBPACK_IMPORTED_MODULE_15__["features"].termplannerCharts;
        var model = new _viewmodel__WEBPACK_IMPORTED_MODULE_3__["ViewModel"](this.state.weekPlans, this.state.activeCourses, this.state.schoolTerm, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__["default"].KED_SCHOOL_LOCALE, intl, showTutorCommentField);
        var termGoals = model.termGoals, columns = model.columns;
        var tutored = this.props.tutored;
        var _a = this.state, loadingWeekPlans = _a.loadingWeekPlans, error = _a.error, dbWeekPlans = _a.weekPlans, dialogs = _a.dialogs;
        var failedInitialLoad = dbWeekPlans.length === 0 && !!error;
        var readOnlyCells = failedInitialLoad || tutored || loadingWeekPlans;
        var rowOffset = 0;
        var filteredWeekplans = model.weekPlansOrTutorNote.filter(function (x) { return !x.type; });
        return this.state.initialLoad ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_9__["Spinner"], null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_7__["FormattedMessage"], { id: "termplanner.loadingTermplanner", defaultMessage: "V.g. v\u00E4nta medan terminsplaner laddas..." })) :
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "termplanner" +
                    (this.state.loadingWeekPlans ? " loading-weekplans" : "") +
                    (this.state.loadingActiveCourses ? " loading-courses" : "") },
                showDoughnutCharts && this.state.activeCourses.length > 0 && this.getStepCharts(columns, model.subjectProgress),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "weekSelect" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, this.state.schoolTerm.toLocaleString(intl, true))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () {
                                        var term = _this.state.schoolTerm.prevTerm();
                                        _this.load(term);
                                    } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () {
                                        var term = _this.state.schoolTerm.nextTerm();
                                        _this.load(term);
                                    } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" }))))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_7__["FormattedMessage"], { id: "termplanner.termPlanning", defaultMessage: "Terminsplanering", tagName: "h4" }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "termplanner-table zebra" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { className: "weekColumn" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_7__["FormattedMessage"], { id: "termplanner.weekNumber", defaultMessage: "Vecka" })),
                                columns.map(function (elem, index) {
                                    var colType = _this.getColumnType(elem.name);
                                    return _this.getStepHeaderColumn(index, elem.translatedName, colType);
                                }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, filteredWeekplans.filter(function (wk) { return wk.cellValues; }).map(function (weekPlan, rowIndex) {
                            rowOffset = rowIndex;
                            var weekNumber = weekPlan.weekNumber, academicWeekNumber = weekPlan.academicWeekNumber;
                            var week = weekNumber;
                            var isCurrentWeek = _this.state.schoolTerm.isCurrentWeek(weekPlan.dateTime);
                            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: model.year + ':' + week, className: isCurrentWeek ? "currentWeek" : "" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, intl.locale === "sv" ? week : academicWeekNumber),
                                columns.map(function (elem, colIndex) {
                                    var colType = _this.getColumnType(elem.name);
                                    var tutorValue = _this.getWeekTutorNote(model.weekPlansOrTutorNote, weekNumber);
                                    return colType === "Tutor" ?
                                        tutorValue && showTutorCommentField && _this.getTableCell(rowIndex, colIndex, elem.name, model, tutorValue, readOnlyCells, colType) :
                                        _this.getTableCell(rowIndex, colIndex, elem.name, model, weekPlan, readOnlyCells, colType);
                                }));
                        })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tfoot", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_7__["FormattedMessage"], { id: "termplanner.finalStep", defaultMessage: "Slutsteg" })),
                                columns.filter(function (c) { return !c.isFixed; }).map(function (elem, index) {
                                    return _this.getFooterCell(rowOffset + 1, index, elem.name, model, readOnlyCells);
                                }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "-"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null),
                                showTutorCommentField && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_7__["FormattedMessage"], { id: "termplanner.edsGoalGrades", defaultMessage: "Terminsm\u00E5l" })),
                                columns.filter(function (c) { return !c.isFixed; }).map(function (elem, index) {
                                    var colType = _this.getColumnType(elem.name).toLowerCase();
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: "grades_" + index, className: colType + "Footer" }, termGoals[elem.name]);
                                }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "-"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, this.state.error && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "error" }, '' + this.state.error)),
                                showTutorCommentField && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null))))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_12__["Dialogs"], { dialogs: dialogs, popDialog: function () { return _this.setState({ dialogs: dialogs.slice(0, dialogs.length - 1) }); } }));
    };
    KSTermPlanner.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__["LanguageContext"];
    return KSTermPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/ks-termplanner/tutor-dialog.tsx":
/*!********************************************************!*\
  !*** ./src/components/ks-termplanner/tutor-dialog.tsx ***!
  \********************************************************/
/*! exports provided: TutorDialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TutorDialog", function() { return TutorDialog; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var TutorDialog = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TutorDialog, _super);
    function TutorDialog(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            comment: props.comment ? props.comment : ''
        };
        return _this;
    }
    TutorDialog.prototype.delete = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var closeDialog;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                closeDialog = this.props.closeDialog;
                closeDialog();
                this.props.deleteNoteData();
                return [2 /*return*/];
            });
        });
    };
    TutorDialog.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var closeDialog, comment;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                closeDialog = this.props.closeDialog;
                comment = this.state.comment;
                closeDialog();
                this.props.updateData(comment);
                return [2 /*return*/];
            });
        });
    };
    TutorDialog.prototype.render = function () {
        var _this = this;
        var _a = this.props, weekNumber = _a.weekNumber, intl = _a.intl;
        var comment = this.state.comment;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, intl ? intl.formatMessage({ id: "tutorNoteDialog.weekComment", defaultMessage: "Kommentar fr vecka {weekNumber}" }, { weekNumber: weekNumber }) : "Kommentar f\u00F6r vecka " + weekNumber),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-table" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "fullWidth" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: true, value: comment, onChange: function (ev) { return _this.setState({ comment: ev.target.value }); } })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } },
                    intl ? intl.formatMessage({ id: "common.save", defaultMessage: "Spara" }) : 'Spara',
                    " "),
                comment && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-warning btn-large pull-right", onClick: function () { return _this.delete(); } }, intl ? intl.formatMessage({ id: "common.remove", defaultMessage: "Ta bort" }) : "Ta bort"))));
    };
    return TutorDialog;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/ks-termplanner/viewmodel.ts":
/*!****************************************************!*\
  !*** ./src/components/ks-termplanner/viewmodel.ts ***!
  \****************************************************/
/*! exports provided: ViewModel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ViewModel", function() { return ViewModel; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _termplanner_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./termplanner-utils */ "./src/components/ks-termplanner/termplanner-utils.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
/* harmony import */ var _utils_generic_school_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/generic-school-utils */ "./src/utils/generic-school-utils.ts");






var ViewModel = /** @class */ (function () {
    function ViewModel(dbWeekPlans, 
    //dbTutorNotes: TermPlannerTutorNote[],
    courses, currentSchoolTerm, currentSchoolLocale, intl, showTutorCommentField) {
        var _a, e_1, _b, e_2, _c;
        var _this = this;
        this.subjectProgress = {};
        this.columns = [];
        this.weekPlansOrTutorNote = [];
        if (currentSchoolTerm.schoolMoment) {
            var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](currentSchoolTerm.getTermStartAndEnd(), 2), termStart = _d[0], termEnd = _d[1];
            this.year = termStart.year();
            //init columns
            var columnHeaders = Object(_termplanner_utils__WEBPACK_IMPORTED_MODULE_1__["getColumnsHeader"])(currentSchoolLocale);
            columnHeaders.forEach(function (c) { return _this.columns.push({ name: c }); });
            //define fixed columns - we keep these separated, in case that the other columns will be dynamically retrieved
            var fixedColumns_1 = [{ name: "Kurs", isFixed: true }, { name: "Kommentar", isFixed: true }];
            if (showTutorCommentField) {
                fixedColumns_1.push({ name: "TutorComment", isFixed: true });
            }
            //Add fixed columns names
            (_a = this.columns).push.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](fixedColumns_1));
            //populate translations
            var translatedColumns = Object(_utils_generic_school_utils__WEBPACK_IMPORTED_MODULE_5__["getSchoolTranslatedSubjects"])(currentSchoolLocale, intl);
            this.columns.forEach(function (element) {
                element.translatedName = translatedColumns[element.name];
            });
            var currentTermHolidays = currentSchoolTerm.schoolMoment.academicYearStructure.holidays;
            var currentTerm_1 = currentSchoolTerm.schoolMoment.term;
            //
            // weekPlans
            //
            var weekplanValues = dbWeekPlans.filter(function (x) { return !x.type; });
            var tutorValues = dbWeekPlans.filter(function (w) { return w.type === 'tutor-note'; });
            var startAcademicYearNumber = currentSchoolTerm.schoolMoment.academicYearStructure.academicStartWeek;
            var _loop_1 = function (weekMoment) {
                holidayPeriod = currentTermHolidays.filter(function (h) { return weekMoment.week() >= moment__WEBPACK_IMPORTED_MODULE_2___default()(h.startDate).startOf("week").week() &&
                    weekMoment.week() <= moment__WEBPACK_IMPORTED_MODULE_2___default()(h.endDate).endOf('week').week(); });
                //if the current week is a holiday week, skip it
                if (holidayPeriod.length > 0) {
                    return "continue";
                }
                var weekNumber = weekMoment.week();
                var kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_4__["KEDWeek"])(weekMoment.year(), weekNumber);
                //A term can end and start on the same week for India
                //in this case we should filter them by the term
                //This is not the case for sv locale and we want to skip this check 
                //because data is already saved in the database
                var weekPlan = weekplanValues.filter(function (wp) {
                    return wp.dateTime >= kedWeek.notBefore &&
                        wp.dateTime <= kedWeek.notAfter &&
                        (!wp.isFinalStep &&
                            wp.term === currentTerm_1 || intl.locale === "sv");
                })[0];
                var tutorNote = tutorValues.filter(function (wp) {
                    return wp.dateTime >= kedWeek.notBefore &&
                        wp.dateTime <= kedWeek.notAfter &&
                        (wp.term === currentTerm_1 || intl.locale === "sv");
                })[0];
                this_1.weekPlansOrTutorNote.push(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, weekPlan || {}, { id: weekPlan ? weekPlan.id : Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(), dateTime: weekPlan ? weekPlan.dateTime : weekMoment.valueOf(), cellValues: weekPlan ? weekPlan.cellValues : {}, weekNumber: weekNumber, academicWeekNumber: startAcademicYearNumber++, term: currentTerm_1 }));
                this_1.weekPlansOrTutorNote.push(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tutorNote || {}, { id: tutorNote ? tutorNote.id : Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(), type: 'tutor-note', dateTime: tutorNote ? tutorNote.dateTime : weekMoment.valueOf(), content: tutorNote ? tutorNote.content : '', weekNumber: weekNumber, term: currentTerm_1 }));
            };
            var this_1 = this, holidayPeriod;
            for (var weekMoment = termStart.clone(); weekMoment.valueOf() < termEnd.valueOf(); weekMoment = weekMoment.clone().add(1, 'week').startOf('week')) {
                _loop_1(weekMoment);
            }
            //
            // lastSteps
            //
            var lastStepWeek = currentSchoolTerm.getLastStepWeek(intl.locale);
            var lastStepKedWeek_1 = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_4__["KEDWeek"])(termEnd.year(), lastStepWeek);
            this.lastSteps = weekplanValues.filter(function (wp) {
                return wp.dateTime >= lastStepKedWeek_1.notBefore &&
                    wp.dateTime <= lastStepKedWeek_1.notAfter &&
                    (wp.isFinalStep &&
                        wp.term === currentTerm_1 || intl.locale === "sv");
            })[0] || {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                dateTime: moment__WEBPACK_IMPORTED_MODULE_2___default()(termEnd).clone().week(lastStepWeek).startOf('week').valueOf(),
                cellValues: {},
                weekNumber: lastStepWeek,
                term: currentTerm_1,
                isFinalStep: true
            };
            this.completedSteps = {};
            this.termGoals = {};
            var maxSubjectStep = {};
            try {
                for (var courses_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courses), courses_1_1 = courses_1.next(); !courses_1_1.done; courses_1_1 = courses_1.next()) {
                    var course = courses_1_1.value;
                    var columnHeader = Object(_termplanner_utils__WEBPACK_IMPORTED_MODULE_1__["getColumnHeaderFromCourse"])(course);
                    try {
                        //
                        // completedSteps
                        //
                        for (var _e = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](course.courseSteps)), _f = _e.next(); !_f.done; _f = _e.next()) {
                            var step = _f.value;
                            if (step.isCompleted) {
                                this.completedSteps[columnHeader + step.shortName] = true;
                                //set the maximum value of the completed step for each subject
                                var currentStepValue = parseInt(step.shortName);
                                if (!isNaN(currentStepValue) && currentStepValue > (maxSubjectStep[columnHeader] ? maxSubjectStep[columnHeader] : 0)) {
                                    maxSubjectStep[columnHeader] = currentStepValue;
                                }
                                /*const weekPlans = findWeekPlansByStep(this.weekPlans, step.ShortName);
                                weekPlans.forEach(weekPlan => {
                                    this.completedSteps[weekPlan.week + columnHeader] = true;
                                })*/
                            }
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (_f && !_f.done && (_c = _e.return)) _c.call(_e);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    //
                    // termGoals
                    //
                    this.termGoals[columnHeader] = course.periodGoalGrade;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (courses_1_1 && !courses_1_1.done && (_b = courses_1.return)) _b.call(courses_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            if (courses) {
                //init
                columnHeaders.forEach(function (elem) {
                    _this.subjectProgress[elem] = { finalStepCompleted: false, value: 0 };
                });
                //compute charts by computing  completed goal (saved data from kedbackend is not taken into account)/lastStepValue
                Object.keys(this.lastSteps.cellValues).forEach(function (val) {
                    //exclude the fixed columns. Charts should not be displayed for those
                    if (!fixedColumns_1[val]) {
                        var hasNoFinalStepValue = isNaN(parseInt(_this.lastSteps.cellValues[val])) || !_this.lastSteps.cellValues[val];
                        var finalStepValue = hasNoFinalStepValue ? 0 : parseInt(_this.lastSteps.cellValues[val]);
                        var percenValue = finalStepValue > 0 ? maxSubjectStep[val] * 100 / finalStepValue : 0;
                        _this.subjectProgress[val] = { finalStepCompleted: !hasNoFinalStepValue, value: percenValue };
                    }
                });
            }
        }
    }
    return ViewModel;
}());

function findWeekPlansByStep(weekPlans, step) {
    return weekPlans.filter(function (wp) { return Object.keys(wp.cellValues).map(function (column) { return wp.cellValues[column] === step; }); });
}


/***/ }),

/***/ "./src/components/latest-assessments/latest-assessments.tsx":
/*!******************************************************************!*\
  !*** ./src/components/latest-assessments/latest-assessments.tsx ***!
  \******************************************************************/
/*! exports provided: LatestAssessments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LatestAssessments", function() { return LatestAssessments; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");




var LatestAssessments = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LatestAssessments, _super);
    function LatestAssessments(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            assessments: [],
            error: null,
            loading: false
        };
        return _this;
    }
    LatestAssessments.prototype.componentWillMount = function () {
        this.load();
    };
    LatestAssessments.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var assessments, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ loading: true });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].edsClient.getLatestAssessments(this.props.limit)];
                    case 2:
                        assessments = _a.sent();
                        this.setState({ assessments: assessments });
                        return [3 /*break*/, 4];
                    case 3:
                        error_1 = _a.sent();
                        this.setState({ error: error_1 });
                        return [3 /*break*/, 4];
                    case 4:
                        this.setState({ loading: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    LatestAssessments.prototype.render = function () {
        var hasGrades = this.state.assessments.some(function (a) { return !!a.gradeName; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Senaste bed\u00F6mningar"], ["Senaste bed\u00F6mningar"])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "latest-assesments zebra" }, this.state.assessments.map(function (a, i) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: i },
                    (hasGrades && a.gradeName != "") && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", { className: "grade pill pull-right" }, a.gradeName),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", { className: "date pill pull-left" }, a.publishDateTime.substr(0, 10)),
                    a.courseName == a.courseUnitName ?
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, a.courseName)) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, a.courseName),
                        " / ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("em", null, a.courseUnitName)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, a.text));
            })));
    };
    return LatestAssessments;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/learning-tasks/index.tsx":
/*!*************************************************!*\
  !*** ./src/components/learning-tasks/index.tsx ***!
  \*************************************************/
/*! exports provided: LearningTasks */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LearningTasks", function() { return LearningTasks; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _apis_ked_learninggoals__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../apis/ked-learninggoals */ "./src/apis/ked-learninggoals.ts");
/* harmony import */ var _course_viewer_subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../course-viewer/subcomponents/learning-goals-list */ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx");
/* harmony import */ var _utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");







var _LearningTasks = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_LearningTasks, _super);
    function _LearningTasks(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            data: null
        };
        return _this;
    }
    _LearningTasks.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Object(_apis_ked_learninggoals__WEBPACK_IMPORTED_MODULE_2__["getLearningGoalsAndTasks"])(this.props.apiPath, this.props.pageId)];
                    case 1:
                        data = _a.sent();
                        this.setState({ data: data });
                        return [2 /*return*/];
                }
            });
        });
    };
    _LearningTasks.prototype.render = function () {
        if (!this.state.data)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null);
        var _a = this.state.data, moduleName = _a.moduleName, subject = _a.subject, commonTasks = _a.commonTasks, learningGoals = _a.learningGoals, step = _a.step;
        var intl = this.props.intl;
        //const step = undefined; // moduleName.toLowerCase().startsWith("steg ") && parseInt(moduleName.substr(5));
        var commonTasksList = commonTasks.map(function (task) { return ({
            id: task.id,
            name: task.name,
            url: task.url,
            courseName: subject.name,
            learningGoal: step && learningGoals.length > 0 ? moduleName + " - \u00F6vergripande" : moduleName
        }); });
        var learningGoalsList = learningGoals.map(function (learningGoal) { return ({
            name: learningGoal.name,
            learningTasks: learningGoal.tasks.map(function (task) { return ({
                id: task.id,
                name: task.name,
                url: task.url,
                courseName: subject.name,
                learningGoal: learningGoal.name
            }); })
        }); });
        if (step) {
            commonTasksList.forEach(function (task) { return task.step = step; });
            learningGoalsList.forEach(function (lg) { return lg.learningTasks.forEach(function (task) { return task.step = step; }); });
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__["LanguageContext"].Provider, { value: { intl: intl } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_viewer_subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_3__["LearningGoalsList"], { commonTasks: commonTasksList, learningGoals: learningGoalsList }));
    };
    return _LearningTasks;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));
var LearningTasks = Object(_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_4__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_5__["injectIntl"])(_LearningTasks));


/***/ }),

/***/ "./src/components/list-courses/list-courses.tsx":
/*!******************************************************!*\
  !*** ./src/components/list-courses/list-courses.tsx ***!
  \******************************************************/
/*! exports provided: ListCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCourses", function() { return ListCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../repos/hidden-courses-repo */ "./src/repos/hidden-courses-repo.ts");








var ListCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ListCourses, _super);
    function ListCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isLoading: true,
            courses: [],
            headerOpen: false
        };
        _this.updateHiddenCourses = _this.updateHiddenCourses.bind(_this);
        return _this;
    }
    ListCourses.prototype.componentWillMount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].subscribe(this.updateHiddenCourses, { fullCourse: true });
    };
    ListCourses.prototype.componentWillUnmount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].unsubscribe(this.updateHiddenCourses);
    };
    ListCourses.prototype.updateHiddenCourses = function (courses) {
        this.setState({ courses: courses, isLoading: false });
    };
    ListCourses.prototype.hideCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].hideCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.showCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].showCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.render = function () {
        var _this = this;
        if (this.state.isLoading)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null);
        var courses = this.state.courses;
        var visibleCourses = courses.filter(function (course) { return course.visible; });
        var hiddenCourses = courses.filter(function (course) { return !course.visible; });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["parseQueryString"])(location.search);
        var viewCourseUrl = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["default"].KED_COURSE_VIEWER_URL;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, visibleCourses.map(function (course) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "hideItem", onClick: function () { return _this.hideCourse(course); } })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_access_control_index__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: course.id }) }, course.name))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose" + (this.state.headerOpen ? " open" : "") },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "Dolda kurser")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, hiddenCourses.map(function (course) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "showItem", onClick: function () { return _this.showCourse(course); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { courseId: course.id })) }, course.name)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
                    })))));
    };
    return ListCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/my-courses/my-courses.tsx":
/*!**************************************************!*\
  !*** ./src/components/my-courses/my-courses.tsx ***!
  \**************************************************/
/*! exports provided: MyCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MyCourses", function() { return MyCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../repos/hidden-courses-repo */ "./src/repos/hidden-courses-repo.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");




var MyCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](MyCourses, _super);
    function MyCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            courses: [],
            isLoading: true
        };
        _this.updateHiddenCoursesState = _this.updateHiddenCoursesState.bind(_this);
        return _this;
    }
    MyCourses.prototype.componentDidMount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_2__["hiddenCoursesRepo"].subscribe(this.updateHiddenCoursesState, { fullCourse: false });
    };
    MyCourses.prototype.updateHiddenCoursesState = function (courses) {
        this.setState({ courses: courses, isLoading: false });
    };
    MyCourses.prototype.componentWillUnmount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_2__["hiddenCoursesRepo"].unsubscribe(this.updateHiddenCoursesState);
    };
    MyCourses.prototype.getCourseUrl = function (courseId) {
        return Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(this.props.viewCourseUrl, { courseId: courseId });
    };
    MyCourses.prototype.render = function () {
        var _this = this;
        var viewCourseUrl = this.props.viewCourseUrl;
        var _a = this.state, isLoading = _a.isLoading, error = _a.error, courses = _a.courses;
        var visibleCourses = this.state.courses.filter(function (c) { return c.visible; });
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, isLoading ? (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: "lvl2 header" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, "Laddar..."))) : error ? (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { className: "lv12" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, "Kunde inte ladda kurser."))) : (visibleCourses.map(function (_a) {
            var name = _a.name, id = _a.id;
            return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "lvl2" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: _this.getCourseUrl(id) }, name)));
        }))));
    };
    return MyCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/my-subjects/my-subjects-inner.tsx":
/*!**********************************************************!*\
  !*** ./src/components/my-subjects/my-subjects-inner.tsx ***!
  \**********************************************************/
/*! exports provided: MySubjectsInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MySubjectsInner", function() { return MySubjectsInner; });
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);




function MySubjectsInner(_a) {
    var viewCourseUrl = _a.viewCourseUrl;
    var schoolGrade = _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["env"].currentUser.schoolGrade;
    var isPrimarySchoolStudent = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["env"].currentUser.schoolType).toLowerCase() !== "gymnasium";
    var targetCourses = schoolGrade && isPrimarySchoolStudent && _globals_db__WEBPACK_IMPORTED_MODULE_1__["db"].courses.tags("grade:" + schoolGrade).idsAndNamesOnly().toValue().read();
    return react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null, react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null, !targetCourses || targetCourses.length === 0 ?
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("li", { className: "lvl2 header" },
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("a", null, "Kunde inte ladda kurser.")) :
        targetCourses.map(function (course) {
            return react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("li", { key: course.id, className: "lvl2" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("a", { href: Object(_access_control__WEBPACK_IMPORTED_MODULE_2__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: course.id }) }, course.name));
        })));
}


/***/ }),

/***/ "./src/components/my-subjects/my-subjects.tsx":
/*!****************************************************!*\
  !*** ./src/components/my-subjects/my-subjects.tsx ***!
  \****************************************************/
/*! exports provided: MySubjects */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MySubjects", function() { return MySubjects; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _course_builder_sub_components_ellipsis_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../course-builder/sub-components/ellipsis-loader */ "./src/components/course-builder/sub-components/ellipsis-loader.tsx");
/* harmony import */ var _utility_components_observe__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/observe */ "./src/components/utility-components/observe.tsx");
/* harmony import */ var _my_subjects_inner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./my-subjects-inner */ "./src/components/my-subjects/my-subjects-inner.tsx");




function MySubjects(_a) {
    var viewCourseUrl = _a.viewCourseUrl;
    return (react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_observe__WEBPACK_IMPORTED_MODULE_2__["Observe"], { fallback: react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_course_builder_sub_components_ellipsis_loader__WEBPACK_IMPORTED_MODULE_1__["EllipsisLoader"], null) },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_my_subjects_inner__WEBPACK_IMPORTED_MODULE_3__["MySubjectsInner"], { viewCourseUrl: viewCourseUrl })));
}


/***/ }),

/***/ "./src/components/tutors-select/tutors-select.tsx":
/*!********************************************************!*\
  !*** ./src/components/tutors-select/tutors-select.tsx ***!
  \********************************************************/
/*! exports provided: TutorsSelect */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TutorsSelect", function() { return TutorsSelect; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _globals_KED_tutorEnv__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.tutorEnv */ "./src/globals/KED.tutorEnv.ts");
/* harmony import */ var _utils_request_tutored_tokens__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/request-tutored-tokens */ "./src/utils/request-tutored-tokens.ts");







var TutorsSelect = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TutorsSelect, _super);
    function TutorsSelect(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isLoading: true,
            students: []
        };
        return _this;
    }
    TutorsSelect.prototype.componentDidMount = function () {
        this.load();
    };
    TutorsSelect.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var edsStudents, students, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 3, 5, 6]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].edsClient.getTeacherTutorStudents()];
                    case 1:
                        edsStudents = _a.sent();
                        edsStudents.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProps"])(["lastName", "firstName"]));
                        students = edsStudents.length > 0 ?
                            edsStudents.map(function (_a) {
                                var email = _a.email, firstName = _a.firstName, lastName = _a.lastName;
                                return ({
                                    mail: email,
                                    displayName: firstName + " " + lastName
                                });
                            }) :
                            [_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser];
                        return [4 /*yield*/, this.setState({ students: students })];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 6];
                    case 3:
                        error_1 = _a.sent();
                        console.error("Could not list tutor students", error_1);
                        return [4 /*yield*/, this.setState({ students: [_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser] })];
                    case 4:
                        _a.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        this.setState({ isLoading: false });
                        return [7 /*endfinally*/];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    TutorsSelect.prototype.onSelectUser = function (email) {
        var choosenStudent = this.state.students.filter(function (s) { return s.mail === email; })[0];
        var user = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, choosenStudent, { roles: ["USER"] });
        _globals_KED_tutorEnv__WEBPACK_IMPORTED_MODULE_5__["default"].setNewEnv(user, function () { return Object(_utils_request_tutored_tokens__WEBPACK_IMPORTED_MODULE_6__["requestTutoredTokens"])(email, email); });
    };
    TutorsSelect.prototype.render = function () {
        var _this = this;
        var _a = this.state, isLoading = _a.isLoading, students = _a.students;
        if (isLoading)
            return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null);
        return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("div", { className: "tutors-select" },
            react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("select", { onChange: function (ev) { return ev.target.value && _this.onSelectUser(ev.target.value); } },
                react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("option", { value: "" }, "V\u00E4lj elev"),
                students.map(function (student) {
                    return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("option", { key: student.mail, value: student.mail },
                        student.displayName,
                        " (",
                        student.mail,
                        ")");
                })));
    };
    return TutorsSelect;
}(react__WEBPACK_IMPORTED_MODULE_2___default.a.Component));



/***/ }),

/***/ "./src/components/utility-components/LanguageContext.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/LanguageContext.tsx ***!
  \***************************************************************/
/*! exports provided: LanguageContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LanguageContext", function() { return LanguageContext; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var LanguageContext = react__WEBPACK_IMPORTED_MODULE_0__["createContext"]({ intl: null });


/***/ }),

/***/ "./src/components/utility-components/SetupLanguageIntl.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/SetupLanguageIntl.tsx ***!
  \*****************************************************************/
/*! exports provided: setupIntl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupIntl", function() { return setupIntl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl/locale-data/en */ "./node_modules/react-intl/locale-data/en.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl/locale-data/sv */ "./node_modules/react-intl/locale-data/sv.js");
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../translations/sv.json */ "./src/translations/sv.json");
var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/sv.json */ "./src/translations/sv.json", 1);
/* harmony import */ var _translations_en_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../translations/en.json */ "./src/translations/en.json");
var _translations_en_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/en.json */ "./src/translations/en.json", 1);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__);









var setupIntl = function (Component) {
    return /** @class */ (function (_super) {
        tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_SetupLanguageIntl, _super);
        function _SetupLanguageIntl(props) {
            var _this = _super.call(this, props) || this;
            Object(react_intl__WEBPACK_IMPORTED_MODULE_1__["addLocaleData"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default.a, react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default.a));
            _this.messages = {
                'sv': _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__,
                'en': _translations_en_json__WEBPACK_IMPORTED_MODULE_5__
            };
            moment__WEBPACK_IMPORTED_MODULE_8___default()().locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE);
            return _this;
        }
        _SetupLanguageIntl.prototype.render = function () {
            return react__WEBPACK_IMPORTED_MODULE_6__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_1__["IntlProvider"], { locale: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE, messages: this.messages[_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE] },
                react__WEBPACK_IMPORTED_MODULE_6__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.props)));
        };
        return _SetupLanguageIntl;
    }(react__WEBPACK_IMPORTED_MODULE_6__["Component"]));
};


/***/ }),

/***/ "./src/components/utility-components/checkbox.tsx":
/*!********************************************************!*\
  !*** ./src/components/utility-components/checkbox.tsx ***!
  \********************************************************/
/*! exports provided: UICheckbox, UIAddbox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UICheckbox", function() { return UICheckbox; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UIAddbox", function() { return UIAddbox; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var UICheckbox = function (_a) {
    var state = _a.state, onClick = _a.onClick, label = _a.label, onChange = _a.onChange;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("label", { className: 'ui-checkbox' },
        label,
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("input", { type: "checkbox", checked: state == "checked", onClick: onClick }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span", { className: "custom-element" }));
};
var UIAddbox = function (_a) {
    var state = _a.state, _b = _a.onClick, onClick = _b === void 0 ? function () { return null; } : _b, label = _a.label, _c = _a.onChange, onChange = _c === void 0 ? function () { return null; } : _c;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("label", { className: 'ui-addbox' },
        label,
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("input", { type: "checkbox", checked: state == "checked", onClick: onClick, onChange: onChange }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("span", { className: "custom-element" }));
};


/***/ }),

/***/ "./src/components/utility-components/content-editable-field.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/utility-components/content-editable-field.tsx ***!
  \**********************************************************************/
/*! exports provided: ContentEditableField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContentEditableField", function() { return ContentEditableField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var ContentEditableField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ContentEditableField, _super);
    function ContentEditableField(props) {
        var _this = _super.call(this, props) || this;
        _this.myself = react__WEBPACK_IMPORTED_MODULE_1__["createRef"]();
        _this.state = {
            text: props.text || ''
        };
        return _this;
    }
    ContentEditableField.prototype.render = function () {
        var _a = this.props, tag = _a.tag, text = _a.text, readOnly = _a.readOnly;
        var TagType = tag;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](TagType, { contentEditable: !readOnly, "data-placeholder": this.props.placeholder, ref: this.myself, className: this.props.className, onChange: this.onChange.bind(this), onKeyDown: this.onKeyDown.bind(this), onKeyUp: this.onKeyUp.bind(this), onBlur: this.onBlur.bind(this), onPaste: this.onPaste.bind(this), dangerouslySetInnerHTML: { __html: text } });
    };
    ContentEditableField.prototype.onChange = function (e) {
        this.setState({ text: this.myself.current.innerText });
    };
    /**
     * Take action depending on key-event
     * @param e event from field
     *
     * If allowNavigation then listen to arrow-keys
     * Limits to maxChars
     */
    ContentEditableField.prototype.onKeyDown = function (e) {
        var text = this.myself.current.innerText;
        if (e.key === 'Escape') {
            this.myself.current.innerText = this.props.text || "";
            this.myself.current.blur();
            e.stopPropagation();
        }
        else if (e.key === 'Enter') {
            e.preventDefault();
            this.navigate(text, 'down');
        }
        else if (e.key === 'Tab') {
            this.propagateOnChange(text);
        }
        else if (text.length >= this.props.maxChars && (/^[\d\w\s]$/.test(e.key) && !(e.metaKey || e.ctrlKey))) {
            e.preventDefault();
        }
        if (this.props.allowNavigation === true) {
            var navDir = e.key.startsWith('Arrow') ? e.key.replace('Arrow', '').toLowerCase() : false;
            var caret = document.getSelection().getRangeAt(0).endOffset; // only works for plaintext
            if (navDir && text.length == 0) {
                this.navigate(text, navDir);
            }
            else if (navDir && (navDir == 'up' || navDir == 'down')) {
                this.navigate(text, navDir);
            }
            else if (navDir && ((navDir == 'left' && caret == 0) ||
                (navDir == 'right' && caret == text.length))) {
                this.navigate(text, navDir);
            }
        }
    };
    /**
     *
     * @param e event from field
     * Solely used to hande validations-issues
     */
    ContentEditableField.prototype.onKeyUp = function (e) {
        var text = this.myself.current.innerText;
        if (this.props.validateValue !== undefined && !this.props.validateValue.test(text)) {
            this.myself.current.innerText = this.props.text || "";
            this.myself.current.blur();
            e.preventDefault();
        }
    };
    /**
     * Update value and pass to parents navigate-funciton
     * @param text
     * @param direction
     */
    ContentEditableField.prototype.navigate = function (text, direction) {
        // first update cell
        this.propagateOnChange(text);
        this.setState({ text: text });
        // then navigate away
        this.props.onNavigate(direction);
    };
    /**
     * Make sure pasted text is pure text
     * @param e the paset event
     */
    ContentEditableField.prototype.onPaste = function (e) {
        e.preventDefault();
        var text = (e.clipboardData && e.clipboardData.getData) ? e.clipboardData.getData("text/plain") : '';
        document.execCommand("insertHTML", false, text);
    };
    /**
     * Update value on exit from field
     * @param e
     */
    ContentEditableField.prototype.onBlur = function (e) {
        var text = this.myself.current.innerText;
        this.propagateOnChange(text);
        this.setState({ text: text });
    };
    /**
     * Only update value if it has changed
     * @param newValue
     */
    ContentEditableField.prototype.propagateOnChange = function (newValue) {
        if (this.propagatedOnChange != newValue) {
            this.propagatedOnChange = newValue;
            this.props.onChange(newValue);
        }
    };
    return ContentEditableField;
}(react__WEBPACK_IMPORTED_MODULE_1__["PureComponent"]));



/***/ }),

/***/ "./src/components/utility-components/dialogs.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/dialogs.tsx ***!
  \*******************************************************/
/*! exports provided: Dialogs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialogs", function() { return Dialogs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);





var Dialogs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Dialogs, _super);
    function Dialogs(props) {
        return _super.call(this, props) || this;
    }
    Dialogs.prototype.componentDidUpdate = function (prevProps) {
        if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {
            // A dialog was closed. Now focus the last dialog:
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(this.lastDiv)).find(':input').first().focus();
        }
    };
    Dialogs.prototype.render = function () {
        var _this = this;
        this.lastDiv = null;
        var _a = this.props, dialogs = _a.dialogs, popDialog = _a.popDialog;
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').attr('aria-disabled', dialogs.length > 0);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');
        return dialogs.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, dialogs.map(function (dialog, idx) {
            var div;
            function onKeyPress(ev) {
                if (ev.which === 13 && (!ev.target || ev.target.tagName !== 'TEXTAREA')) {
                    jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div)).find('.btn-default').click();
                }
                ev.stopPropagation();
            }
            function onKeyDown(ev) {
                if (ev.which === 27) { // Escape
                    popDialog();
                    ev.stopPropagation();
                    return;
                }
                if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
                    var domNode = Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div);
                    ev.preventDefault();
                    var defaultButton = jquery__WEBPACK_IMPORTED_MODULE_4___default()(domNode).find('.btn-default');
                    defaultButton.click();
                    ev.stopPropagation();
                }
            }
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page", ref: function (elem) {
                            div = elem;
                            if (idx === dialogs.length - 1)
                                _this.lastDiv = elem;
                        }, tabIndex: 0, "aria-disabled": idx < dialogs.length - 1, onKeyPress: onKeyPress, onKeyDown: onKeyDown },
                        dialog,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__["RemoveItem"], { onClick: popDialog }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stopFloats" }))));
        }));
    };
    return Dialogs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-text-input.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/utility-components/form-field-text-input.tsx ***!
  \*********************************************************************/
/*! exports provided: TextInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextInput", function() { return TextInput; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextInput = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextInput, _super);
    function TextInput(props) {
        return _super.call(this, props) || this;
    }
    TextInput.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: this.props.autoFocus, id: this.props.id, size: 35, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder }))));
    };
    return TextInput;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-textarea.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/form-field-textarea.tsx ***!
  \*******************************************************************/
/*! exports provided: TextAreaFormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextAreaFormField", function() { return TextAreaFormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextAreaFormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextAreaFormField, _super);
    function TextAreaFormField(props) {
        return _super.call(this, props) || this;
    }
    TextAreaFormField.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label, id: this.props.id },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: this.props.autoFocus, id: this.props.id, cols: 35, rows: this.props.rows || 5, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder })),
                !!this.props.children && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" }, this.props.children))));
    };
    return TextAreaFormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field.tsx":
/*!**********************************************************!*\
  !*** ./src/components/utility-components/form-field.tsx ***!
  \**********************************************************/
/*! exports provided: FormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormField", function() { return FormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function findId(node) {
    var recucheck = new Set();
    return (function findId(node) {
        if (typeof node === 'string')
            return null;
        if (recucheck.has(node)) {
            return;
        }
        recucheck.add(node);
        if (node.props) {
            if (node.props.id)
                return node.props.id;
            if (node.props.children) {
                return findId(node.props.children);
            }
            return;
        }
        if (node.length) {
            for (var i = 0; i < node.length; ++i) {
                var child = node[i];
                if (child) {
                    var childId = findId(child);
                    if (childId)
                        return childId;
                    //console.log(child);
                }
            }
        }
    })(node);
}
var FormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FormField, _super);
    function FormField(props) {
        return _super.call(this, props) || this;
    }
    FormField.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel", htmlFor: this.props.id || findId(this.props.children) }, this.props.label),
            this.props.children);
    };
    return FormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/observe.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/observe.tsx ***!
  \*******************************************************/
/*! exports provided: Observe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observe", function() { return Observe; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");




var FiberContextReact = react__WEBPACK_IMPORTED_MODULE_2___default.a.createContext(null);
kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["FiberContext"].addProvider(function () {
    // Here we actuall do useHook(FiberContext) but without logging to internal debug logs
    // Normally, react hooks are sensitive in which order they are called (useState(), etc)
    // but useContext() is not sensitive about that at all.
    // Still, the debug version of react will log calls to useHook() and throw if a render
    // doesn't use the same number of hooks every time. This check should not apply
    // to useHook() since it is not sensitive to the order in which it was called.
    // And we need to be able to call it from within contitional expressions / statements,
    // so we must bypass this debug logging here by accessing the _currentValue directly.
    return FiberContextReact._currentValue;
});
var Observe = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Observe, _super);
    function Observe(props) {
        var _this = _super.call(this, props) || this;
        _this.subscriptions = [];
        _this.outerSubscription = {
            unsubscribe: function () {
                _this.subscriptions.forEach(function (s) { return s.unsubscribe(); });
                _this.subscriptions = [];
            }
        };
        _this.observer = function (value, error, subscription) {
            if (error) {
                _this.setState({ error: error });
            }
            else {
                _this.setState(function (_a) {
                    var counter = _a.counter;
                    return ({ counter: counter + 1, error: error });
                });
            }
        };
        _this.state = {
            counter: 0,
            error: null
        };
        return _this;
    }
    Observe.prototype.componentDidCatch = function (error, info) {
        if (!error || !error.name)
            error = new Error('' + error);
        this.setState({ error: error, info: info });
        console.log(error, info);
    };
    Observe.prototype.componentWillMount = function () {
        this.outerSubscription.unsubscribe();
    };
    Observe.prototype.render = function () {
        if (this.state.error) {
            return this.props.errorFallback || react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda inneh\u00E5llet"], ["Kunde inte ladda inneh\u00E5llet"]))));
        }
        this.outerSubscription.unsubscribe();
        return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2__["Suspense"], { fallback: this.props.fallback || null },
            react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(FiberContextReact.Provider, { value: this }, this.props.children));
    };
    return Observe;
}(react__WEBPACK_IMPORTED_MODULE_2___default.a.Component));

var templateObject_1;


/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../charts/goal-progress */ "./src/components/charts/goal-progress.tsx");
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/



var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName, displayProgress = _a.displayProgress, progressData = _a.progressData, inactivated = _a.inactivated, inactivatedRender = _a.inactivatedRender;
        var headerOpen = this.state.headerOpen;
        if (inactivated)
            return inactivatedRender === 'titleAndChildren' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children)) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children);
        //var currentProgressData = //progressData();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeaderContainer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, title),
                    displayProgress && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__["GoalProgress"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, progressData)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/tutorable-component.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/tutorable-component.tsx ***!
  \*******************************************************************/
/*! exports provided: TutorableComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TutorableComponent", function() { return TutorableComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_tutorEnv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.tutorEnv */ "./src/globals/KED.tutorEnv.ts");




var TutorableComponent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TutorableComponent, _super);
    function TutorableComponent(props) {
        var _this = _super.call(this, props) || this;
        _this.onEnvUpdated = _this.onEnvUpdated.bind(_this);
        _this.state = {
            env: props.tutored ? null : _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"]
        };
        return _this;
    }
    TutorableComponent.prototype.componentDidMount = function () {
        if (this.props.tutored) {
            _globals_KED_tutorEnv__WEBPACK_IMPORTED_MODULE_3__["default"].subscribe(this.onEnvUpdated);
        }
    };
    TutorableComponent.prototype.componentWillUnmount = function () {
        if (this.props.tutored) {
            _globals_KED_tutorEnv__WEBPACK_IMPORTED_MODULE_3__["default"].unsubscribe(this.onEnvUpdated);
        }
    };
    TutorableComponent.prototype.onEnvUpdated = function (env) {
        this.setState({ env: env });
    };
    TutorableComponent.prototype.render = function () {
        var env = this.state.env;
        if (!env)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null);
        if (!env.kedBackendClient) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Laddar...");
        }
        //const {currentUser, edsClient, kedBackendClient, kgTermPlannerRepo} = env;
        //const {tutored} = this.props;
        return this.props.createComponent(env);
    };
    return TutorableComponent;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions-sv.ts":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions-sv.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>F</b>',
        title: 'Fetstil',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>K</i>',
        title: 'Kursiv',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Understruken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Struken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Rubrik 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Rubrik 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Rubrik 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraf',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Citat',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '<i class="fa fa-list-ol" aria-hidden="true"></i>',
        title: 'Ordnad lista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '<i class="fa fa-list" aria-hidden="true"></i>',
        title: 'Punktlista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    outdent: {
        icon: '<i class="fa fa-outdent" aria-hidden="true"></i>',
        title: 'Minska indrag',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])("outdent"); }
    },
    indent: {
        icon: '<i class="fa fa-indent" aria-hidden="true"></i>',
        title: 'ka indrag',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])("indent"); },
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Programkod',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Vgrt linje',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '<i class="fa fa-link" aria-hidden="true"></i>',
        title: 'Infoga lnk',
        result: function () {
            var url = window.prompt('Ange lnkens URL');
            if (url) {
                var selected = document.getSelection();
                var elem = document.createElement('a');
                elem.href = url;
                elem.target = "_blank";
                elem.appendChild(document.createTextNode(selected.toString()));
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHTML', elem.outerHTML);
            }
        }
    },
    image: {
        icon: '<i class="fa fa-picture-o" aria-hidden="true"></i>',
        title: 'Infoga bild',
        promptMsg: 'Ange bildens URL',
        result: function (ev, component) {
            var url = window.prompt(this.promptMsg);
            if (url) {
                //exec('insertImage', url);
                var img = document.createElement("img");
                img.src = url;
                img.tabIndex = 1;
                insertElement(img);
                img.onfocus = component.onFocus;
                img.onblur = component.onBlur;
                component.props.onChange(component.contentDiv.innerHTML);
            }
        }
    }
});
function insertElement(element) {
    var sel, range;
    if (window.getSelection && (sel = window.getSelection()).rangeCount) {
        range = sel.getRangeAt(0);
        range.collapse(true);
        range.insertNode(element);
        // Move the caret immediately after the inserted span
        range.setStartAfter(element);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
    }
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions.ts":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>B</b>',
        title: 'Bold',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>I</i>',
        title: 'Italic',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Underline',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Strike-through',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Heading 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Heading 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Heading 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraph',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Quote',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '&#35;',
        title: 'Ordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '&#8226;',
        title: 'Unordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    outdent: {
        icon: '<i class="fa fa-outdent" aria-hidden="true"></i>',
        title: 'Outdent',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])("outdent"); }
    },
    indent: {
        icon: '<i class="fa fa-indent" aria-hidden="true"></i>',
        title: 'Indent',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])("indent"); },
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Code',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Horizontal Line',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '&#128279;',
        title: 'Link',
        result: function () {
            var url = window.prompt('Enter the link URL');
            if (url) {
                var selected = document.getSelection();
                var elem = document.createElement('a');
                elem.href = url;
                elem.target = "_blank";
                elem.appendChild(document.createTextNode(selected.toString()));
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHTML', elem.outerHTML);
            }
        }
    },
    image: {
        icon: '&#128247;',
        title: 'Image',
        promptMsg: 'Enter the URL of the image',
        result: function () {
            var url = window.prompt(this.promptMsg);
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertImage', url);
        }
    }
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/exec.ts":
/*!***********************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/exec.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (command, value) {
    if (value === void 0) { value = null; }
    document.execCommand(command, false, value);
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/image-edit-actions.ts":
/*!*************************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/image-edit-actions.ts ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return imageEditActions; });
function imageEditActions(cb) {
    return [{
            name: 'float-left',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-right\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; left:-4px;top:0; transform: scale(0.5); transform-origin: left top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Lt bilden flyta vnster om text',
            result: function () { return cb('float-left'); }
        }, {
            name: 'float-right',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-left\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; right:-4px;top:0; transform: scale(0.5); transform-origin: right top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Lt bilden flyta hger om text',
            result: function () { return cb('float-right'); }
        }, {
            name: 'unfloat',
            icon: "<div style=\"position:relative;\" aria-hidden=\"true\">\n      <div style=\"position:absolute;top:0;left:0\">&#8254;</div>\n      <div style=\"position:absolute;top:0:left:0;transform: scale(0.5); transform-origin: left bottom\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n      <div style=\"position:absolute;top:0;left:0\">_</div>\n    </div>",
            title: 'Placera bilden p egen rad',
            result: function () { return cb('unfloat'); }
        }];
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/index.tsx":
/*!*************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/index.tsx ***!
  \*************************************************************/
/*! exports provided: Wysiwyg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Wysiwyg", function() { return Wysiwyg; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");
/* harmony import */ var _wash_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./wash-html */ "./src/components/utility-components/wysiwyg/wash-html.ts");
/* harmony import */ var _image_edit_actions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./image-edit-actions */ "./src/components/utility-components/wysiwyg/image-edit-actions.ts");
/* harmony import */ var _actions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./actions */ "./src/components/utility-components/wysiwyg/actions.ts");






var classes = {
    actionbar: 'wysiwyg-actionbar',
    button: 'wysiwyg-button',
    content: 'wysiwyg-content',
    focusrect: 'wysiwyg-focusrect',
    focuspoint: 'wysiwyg-focuspoint',
    readonlyContent: 'wysiwyg-content readonly'
};
var Wysiwyg = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Wysiwyg, _super);
    function Wysiwyg(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { focusRect: null };
        _this.onFocus = _this.onFocus.bind(_this);
        _this.onBlur = _this.onBlur.bind(_this);
        _this.onMouseDown = _this.onMouseDown.bind(_this);
        _this.onMouseMove = _this.onMouseMove.bind(_this);
        _this.onMouseUp = _this.onMouseUp.bind(_this);
        return _this;
    }
    Wysiwyg.prototype.componentDidMount = function () {
        var _this = this;
        if (!this.props.readOnly) {
            Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
                .forEach(function (elem) {
                elem.tabIndex = 1;
                elem.onfocus = _this.onFocus;
                elem.onblur = _this.onBlur;
            });
            document.querySelector(".wysiwyg-content").addEventListener('mousedown', this.onMouseDown);
            document.querySelector(".wysiwyg-content").addEventListener('mousemove', this.onMouseMove);
            document.querySelector(".wysiwyg-content").addEventListener('mouseup', this.onMouseUp);
        }
        if (this.props.reportNumChars) {
            this.props.reportNumChars((this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length) || 0);
        }
    };
    Wysiwyg.prototype.componentDidUpdate = function () {
        var _this = this;
        Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
            .forEach(function (elem) {
            elem.tabIndex = 1;
            elem.onfocus = _this.onFocus;
            elem.onblur = _this.onBlur;
        });
        if (this.props.reportNumChars) {
            this.props.reportNumChars((this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length) || 0);
        }
    };
    Wysiwyg.prototype.componentWillUnmount = function () {
        document.querySelector(".wysiwyg-content").removeEventListener('mousedown', this.onMouseDown);
        document.querySelector(".wysiwyg-content").removeEventListener('mousemove', this.onMouseMove);
        document.querySelector(".wysiwyg-content").removeEventListener('mouseup', this.onMouseUp);
    };
    Wysiwyg.prototype.shouldComponentUpdate = function (nextProps, nextState) {
        //this.contentDiv.onfocus = this.onFocus;
        //this.contentDiv.onblur = this.onBlur;
        return !this.contentDiv ||
            nextState != this.state ||
            nextProps.readOnly !== this.props.readOnly ||
            Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(nextProps.html) !== Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.contentDiv.innerHTML);
    };
    Wysiwyg.prototype.triggerOnChange = function (html) {
        this.props.onChange && this.props.onChange(Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(html));
    };
    Wysiwyg.prototype.onFocus = function (ev) {
        var elem = ev.target;
        if (!elem || !elem.tagName)
            return;
        if (elem.tagName !== 'IMG' && elem.tagName !== 'A')
            return;
        var contentParent = this.contentDiv.parentElement;
        var newState = {
            focusRect: getRelatativeClientRect(contentParent, elem),
        };
        switch (elem.tagName) {
            case 'A':
            case 'IMG':
            default: break;
        }
        this.setState(newState);
        this.focusElem = elem;
    };
    Wysiwyg.prototype.onBlur = function (ev) {
        /*if (ev.relatedTarget) {
          const relatedTarget = ev.relatedTarget as HTMLElement;
          if (relatedTarget.className && relatedTarget.className.split(' ').indexOf(classes.button) >= 0) {
            // A image action button was pressed
            set
            return;
          }
        }*/
        if ((ev.target === this.focusElem && ev.relatedTarget !== this.focusRectDiv) ||
            ev.target === this.focusRectDiv) {
            this.setState({ focusRect: null });
        }
    };
    Wysiwyg.prototype.makeClickable = function (elem) {
        elem.tabIndex = 1;
    };
    Wysiwyg.prototype.onMouseDown = function (ev) {
        if ((ev.target.className || "").split(' ').indexOf(classes.focuspoint) >= 0) {
            var corner = this.getRectCorner(ev);
            this.corner = corner;
            this.resizeStartX = ev.clientX;
        }
    };
    Wysiwyg.prototype.onMouseMove = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            ev.preventDefault();
            // TODO: Rkna ut baserat p this.corner hur bildens storlek borde ndras.
            // Leta upp bilden per ID frn this.contentDiv
            // Stt DIV:ens style attribut width till ny width.
            // Om DIV:en redan hade height, stt ny height med samma aspect ratio som innan,
            // annars, stt inte height alls (eller mjligtvis till auto))
            var focusRect = this.focusRectDiv.getBoundingClientRect();
            if (focusRect.width < 32)
                return;
            //const currentWidth = focusRect.width;
            //const currentHeight = focusRect.height;
            //const hasHeightStyle = !this.focusElem.style.height || this.focusElem.style.height === "auto";
            var newWidth = Math.max(32, this.corner.endsWith('l') ?
                focusRect.width + (this.resizeStartX - ev.clientX) :
                //focusRect.right - ev.clientX :
                focusRect.width - (this.resizeStartX - ev.clientX));
            this.resizeStartX = ev.clientX;
            //ev.clientX - focusRect.left;
            var factor = newWidth / focusRect.width;
            var newHeight = focusRect.height * factor;
            this.focusElem.style.width = newWidth + "px";
            this.focusElem.style.height = newHeight + "px";
            this.setState({
                focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem),
            });
        }
    };
    Wysiwyg.prototype.onMouseUp = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            this.corner = null;
            this.triggerOnChange(this.contentDiv.innerHTML);
        }
    };
    Wysiwyg.prototype.getRectCorner = function (ev) {
        var e_1, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"]((ev.target.className || '').split(' ')), _c = _b.next(); !_c.done; _c = _b.next()) {
                var className = _c.value;
                switch (className) {
                    case 'fpul':
                        return 'ul';
                    case 'fpur':
                        return 'fpur';
                    case 'fplr':
                        return 'lr';
                    case 'fpll':
                        return 'll';
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return null;
    };
    Wysiwyg.prototype.execImageEditAction = function (cmd) {
        //console.log(cmd);
        if (!this.focusElem)
            return;
        //console.log("doing it");
        switch (cmd) {
            case 'float-left':
                this.focusElem.style.cssFloat = 'left';
                break;
            case 'float-right':
                this.focusElem.style.cssFloat = 'right';
                break;
            case 'unfloat':
                this.focusElem.style.cssFloat = '';
                break;
        }
        this.triggerOnChange(this.contentDiv.innerHTML);
        this.setState({ focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem) });
    };
    Wysiwyg.prototype.render = function () {
        var _this = this;
        var defaultActions = this.props.defaultActions || _actions__WEBPACK_IMPORTED_MODULE_5__["default"];
        var actionsToUse = this.props.actions ? this.props.actions.map(function (action) {
            return typeof action === 'string' ?
                defaultActions[action] :
                defaultActions[action.name] ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultActions[action.name], action) :
                    action;
        })
            : Object.keys(defaultActions).map(function (action) { return defaultActions[action]; });
        if (this.state.focusRect) {
            actionsToUse = actionsToUse.concat(Object(_image_edit_actions__WEBPACK_IMPORTED_MODULE_4__["default"])(function (cmd) { return _this.execImageEditAction(cmd); }));
        }
        var focusRect = this.state.focusRect;
        var _a = this.props, readOnly = _a.readOnly, reportNumChars = _a.reportNumChars, maxChars = _a.maxChars;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: this.props.className },
            !readOnly && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.actionbar }, actionsToUse.map(function (action, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { key: idx, className: classes.button, dangerouslySetInnerHTML: { __html: action.icon }, title: action.title, onMouseDown: function (ev) { action.result(ev, _this); }, onMouseUp: function (ev) { return setTimeout(function () { return _this.contentDiv.focus(); }, 10); } });
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: readOnly ? classes.readonlyContent : classes.content, style: { position: 'relative', top: 0, left: 0 } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editor", ref: function (div) { return _this.contentDiv = div; }, dangerouslySetInnerHTML: { __html: Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.props.html) }, contentEditable: !readOnly, onPaste: function (ev) {
                        if (!isNaN(maxChars)) {
                            var target = ev.target, currentTarget = ev.currentTarget;
                            //const textBeingOverwritten = (target as any).innerText || "";
                            var editorText = (currentTarget && currentTarget.innerText) || "";
                            var textBeingPasted = ev.clipboardData.getData("text/plain") || "";
                            if (editorText.length + textBeingPasted.length > maxChars) {
                                ev.preventDefault();
                            }
                        }
                    }, onKeyUp: reportNumChars ? function (ev) {
                        var innerText = ev.target.innerText;
                        reportNumChars(innerText ? innerText.length : 0);
                    } : null, onKeyPress: !isNaN(maxChars) ? function (ev) {
                        var innerText = ev.target.innerText;
                        if (innerText && innerText.length >= maxChars) {
                            ev.preventDefault();
                        }
                    } : null, onInput: function (ev) { return _this.triggerOnChange(ev.target.innerHTML); }, onKeyDown: function (ev) {
                        if (readOnly)
                            return;
                        if (reportNumChars && ev.currentTarget) {
                            reportNumChars((ev.currentTarget.innerText || "").length);
                        }
                        //console.log("Key: " + ev.which);
                        if (ev.which >= 35 && ev.which <= 40) { // home/end/up/down/left/right
                            ev.stopPropagation(); // Prevent entire page from scrolling??
                        }
                        if (ev.which === 9) {
                            ev.preventDefault(); // TAB
                            if (ev.shiftKey) {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("outdent");
                            }
                            else {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("indent");
                            }
                        }
                        if ((ev.keyCode === 8 || ev.keyCode === 46) && // Delete or Back buttons
                            _this.focusElem && _this.state.focusRect) {
                            if (_this.focusElem && _this.focusElem.parentElement) {
                                _this.focusElem.parentElement.removeChild(_this.focusElem); // Remove marked image
                            }
                            _this.focusElem = null;
                            _this.setState({ focusRect: null });
                            _this.triggerOnChange(_this.contentDiv.innerHTML);
                        }
                    } }),
                focusRect && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { ref: function (div) { return _this.focusRectDiv = div; }, className: classes.focusrect, onBlur: this.onBlur, tabIndex: 1, style: {
                        outline: 0,
                        position: 'absolute',
                        top: this.state.focusRect.top,
                        left: this.state.focusRect.left,
                        width: this.state.focusRect.width,
                        height: this.state.focusRect.height
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpul", style: { position: 'absolute', top: 0, left: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpur", style: { position: 'absolute', top: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fplr", style: { position: 'absolute', bottom: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpll", style: { position: 'absolute', bottom: 0, left: 0 } }))));
    };
    return Wysiwyg;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getRelatativeClientRect(parent, child) {
    var parentRect = parent.getBoundingClientRect();
    var childRect = child.getBoundingClientRect();
    return {
        top: childRect.top - parentRect.top + parent.scrollTop,
        left: childRect.left - parentRect.left + parent.scrollLeft,
        bottom: childRect.bottom - parentRect.top + parent.scrollTop,
        right: childRect.right - parentRect.left + parent.scrollLeft,
        width: childRect.width,
        height: childRect.height
    };
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/wash-html.ts":
/*!****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/wash-html.ts ***!
  \****************************************************************/
/*! exports provided: washHtml */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "washHtml", function() { return washHtml; });
var parser = new DOMParser();
/** Tags / Attributes Whitelist
 *
 */
var HTML_WASH_POLICY = {
    b: {},
    i: {},
    p: {},
    u: {},
    strike: {},
    pre: {},
    h1: {},
    h2: {},
    h3: {},
    h4: {},
    h5: {},
    img: { src: true, class: true, style: true, tabindex: true },
    a: { href: true, target: true, tabindex: true },
    ul: {},
    ol: {},
    li: {},
    hr: {},
    br: {},
    div: {},
    span: {},
    // table tags:
    table: { border: true },
    tbody: {},
    thead: {},
    tfoot: {},
    tr: {},
    td: { headers: true, colspan: true, rowspan: true },
    th: { abbr: true, headers: true, scope: true, sorted: true, colspan: true, rowspan: true }
};
function washHtml(html) {
    var doc = parser.parseFromString(html, "text/html");
    var childNodes = doc.body.childNodes;
    var modified = false;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified ?
        doc.body.innerHTML :
        html; // By returning the original HTML string, we spare the user from refreshing the edit area,
    // which would otherwise put the cursor at the top, losing the position where user where.
}
function washNode(node) {
    var modified = false;
    if (isElement(node)) {
        if (washElement(node)) {
            modified = true;
        }
    }
    if (washChildNodes(node)) {
        modified = true;
    }
    return modified;
}
function washChildNodes(node) {
    var modified = false;
    var childNodes = node.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified;
}
/** Replace an element with its child nodes.
 *
 */
function removeMiddleElement(element) {
    var childNodes = element.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        element.parentNode.insertBefore(childNodes.item(i), element);
    }
    element.remove();
}
function washElement(element) {
    var policy = element.tagName && HTML_WASH_POLICY[element.tagName.toLowerCase()];
    if (!policy) {
        console.warn("Wysiwyg: not allowed tag", element.tagName);
        washChildNodes(element);
        removeMiddleElement(element);
        return true;
    }
    var modified = false;
    for (var i = 0; i < element.attributes.length; ++i) {
        var attr = element.attributes.item(i);
        var allowed = attr.name && !!policy[attr.name.toLowerCase()];
        if (!allowed) {
            modified = true;
            console.warn("Wysiwyg: not allowed attribute", attr.name, "Tag: ", element.tagName);
            element.removeAttribute(attr.name);
        }
    }
    return modified;
}
function isElement(node) {
    return !!node.tagName;
}


/***/ }),

/***/ "./src/components/week-notebook/index.ts":
/*!***********************************************!*\
  !*** ./src/components/week-notebook/index.ts ***!
  \***********************************************/
/*! exports provided: WeekNotebook, RootWeekNotebook */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _week_notebook__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./week-notebook */ "./src/components/week-notebook/week-notebook.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekNotebook", function() { return _week_notebook__WEBPACK_IMPORTED_MODULE_0__["WeekNotebook"]; });

/* harmony import */ var _root_week_notebook__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./root-week-notebook */ "./src/components/week-notebook/root-week-notebook.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RootWeekNotebook", function() { return _root_week_notebook__WEBPACK_IMPORTED_MODULE_1__["RootWeekNotebook"]; });





/***/ }),

/***/ "./src/components/week-notebook/root-week-notebook.tsx":
/*!*************************************************************!*\
  !*** ./src/components/week-notebook/root-week-notebook.tsx ***!
  \*************************************************************/
/*! exports provided: RootWeekNotebook */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RootWeekNotebook", function() { return RootWeekNotebook; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! . */ "./src/components/week-notebook/index.ts");



function RootWeekNotebook(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_1__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](___WEBPACK_IMPORTED_MODULE_2__["WeekNotebook"], null));
}


/***/ }),

/***/ "./src/components/week-notebook/week-notebook.tsx":
/*!********************************************************!*\
  !*** ./src/components/week-notebook/week-notebook.tsx ***!
  \********************************************************/
/*! exports provided: WeekNotebook */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekNotebook", function() { return WeekNotebook; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _repos_week_notes_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../repos/week-notes-repo */ "./src/repos/week-notes-repo.ts");
/* harmony import */ var _utils_pending_job__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/pending-job */ "./src/utils/pending-job.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/wysiwyg */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");
/* harmony import */ var _utility_components_wysiwyg_actions__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utility-components/wysiwyg/actions */ "./src/components/utility-components/wysiwyg/actions.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_if_takes_time__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../utils/if-takes-time */ "./src/utils/if-takes-time.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");













var MAX_NOTE_LENGTH = 16384;
var WeekNotebook = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekNotebook, _super);
    function WeekNotebook(props) {
        var _this = _super.call(this, props) || this;
        _this.onChange = _this.onChange.bind(_this);
        _this.autoSaver = new _utils_pending_job__WEBPACK_IMPORTED_MODULE_3__["PendingJob"](function () { return _this.save(); });
        _this.state = {
            isLoading: true,
            showLoadingProgress: false,
            showSavingProgress: false,
            everEdited: false,
            notes: "",
        };
        return _this;
    }
    WeekNotebook.prototype.componentDidMount = function () {
        this.showProgressIfLoadingTakesTime();
        _repos_week_notes_repo__WEBPACK_IMPORTED_MODULE_2__["weekNotesRepo"].mem.subscribe(this.onChange);
    };
    WeekNotebook.prototype.showProgressIfLoadingTakesTime = function () {
        var _this = this;
        this.timeoutHandle = setTimeout(function () { return _this.state.isLoading && _this.setState({ showLoadingProgress: true }); }, 300);
    };
    WeekNotebook.prototype.componentWillUnmount = function () {
        _repos_week_notes_repo__WEBPACK_IMPORTED_MODULE_2__["weekNotesRepo"].mem.unsubscribe(this.onChange);
        this.autoSaver.stop();
        clearTimeout(this.timeoutHandle);
    };
    WeekNotebook.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var maxIterations;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        maxIterations = 3;
                        _a.label = 1;
                    case 1:
                        if (!(this.isNotesEdited() && maxIterations)) return [3 /*break*/, 4];
                        return [4 /*yield*/, _repos_week_notes_repo__WEBPACK_IMPORTED_MODULE_2__["weekNotesRepo"].upsert(this.state.weekNote, function (wn) {
                                wn.content = _this.state.notes;
                            })];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3:
                        --maxIterations;
                        return [3 /*break*/, 1];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    WeekNotebook.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(!this.state.showSavingProgress && !this.state.isLoading && this.isNotesEdited())) return [3 /*break*/, 8];
                        return [4 /*yield*/, this.setState({ error: undefined })];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        _a.trys.push([2, 4, 6, 8]);
                        return [4 /*yield*/, Object(_utils_if_takes_time__WEBPACK_IMPORTED_MODULE_10__["ifTakesTime"])(300, function () { return _this._save(); }, function () { return _this.setState({ showSavingProgress: true }); })];
                    case 3:
                        _a.sent();
                        return [3 /*break*/, 8];
                    case 4:
                        err_1 = _a.sent();
                        console.error(err_1);
                        return [4 /*yield*/, this.setState({ error: this.context.intl.formatMessage({ id: "common.errorSavingData", defaultMessage: "Kunde inte spara." }) })];
                    case 5:
                        _a.sent();
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.setState({ showSavingProgress: false })];
                    case 7:
                        _a.sent();
                        return [7 /*endfinally*/];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    WeekNotebook.prototype.isNotesEdited = function () {
        var _a = this.state, weekNote = _a.weekNote, notes = _a.notes;
        return !!weekNote && (notes !== weekNote.content);
    };
    //If the notebook should be used in multiple modules, move this functions into an utility file
    WeekNotebook.prototype.getTranslatedActions = function (intl) {
        //actions might have different icons for each language
        //we keep the same structure of the actions, but we replace the texts with the ones from the translated files
        var localeActions = Object.assign({}, intl.locale === "sv" ? _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_7__["default"] : _utility_components_wysiwyg_actions__WEBPACK_IMPORTED_MODULE_8__["default"]);
        Object.keys(localeActions).forEach(function (elem) {
            var currentTitle = _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_7__["default"][elem].title;
            localeActions[elem].title = intl.formatMessage({ id: "wysiwyg." + elem, defaultMessage: currentTitle });
            //because the image action needs a custom translation, we treat this separately
            if (elem === "image") {
                localeActions[elem].promptMsg = intl.formatMessage({ id: "wysiwyg.imagePromptMsg", defaultMessage: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_7__["default"][elem].promptMsg });
            }
        });
        return localeActions;
    };
    WeekNotebook.prototype.onChange = function (weekNotes) {
        var weekNote = weekNotes.length > 0 ?
            weekNotes[weekNotes.length - 1] :
            {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                dateTime: Date.now(),
                //dateTime: weekNotesRepo.getCurrentWeek().toDate().getTime(),
                content: "",
                acl: [
                    // Default ACL: Let user self have full control over this item:
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail, "S")
                ].map(function (ac) { return ac.toString(); })
            };
        var newState = {
            weekNote: weekNote,
            //week: weekNotesRepo.getCurrentWeek().week(),
            isLoading: false,
            showLoadingProgress: false
        };
        if (!this.state.weekNote || this.state.weekNote.id !== weekNote.id || weekNotes.length === 0) {
            newState.notes = weekNote.content;
        }
        this.setState(newState);
    };
    /*async changeWeek(direction: number) {
      try {
        await this.setState({
          isLoading: true,
          everEdited: false,
          weekNote: null,
          error: undefined
        });
        this.showProgressIfLoadingTakesTime();
        await weekNotesRepo.changeWeek(direction);
      } catch (err) {
        console.error(err);
        await this.setState({error: "Kunde inte ladda data"});
      }
    }
  
    prevWeek() {
      this.changeWeek(-1);
    }
  
    nextWeek() {
      this.changeWeek(1);
    }*/
    WeekNotebook.prototype.render = function () {
        var _this = this;
        var _a = this.state, notes = _a.notes, showLoadingProgress = _a.showLoadingProgress, isLoading = _a.isLoading, showSavingProgress = _a.showSavingProgress, error = _a.error, everEdited = _a.everEdited;
        var intl = this.context.intl;
        return (react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", null,
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "ked_boxed kedNotepad" },
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h3", null,
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_intl__WEBPACK_IMPORTED_MODULE_11__["FormattedMessage"], { id: "weekNotebook.title", defaultMessage: "Anteckningar" })),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_6__["Wysiwyg"], { actions: [
                        "bold",
                        "italic",
                        "underline",
                        "strikethrough",
                        "olist",
                        "ulist",
                        "outdent",
                        "indent",
                        "line"
                    ], defaultActions: this.getTranslatedActions(intl), html: isLoading ? "<div></div>" : notes.substr(0, MAX_NOTE_LENGTH), onChange: !isLoading && (function (html) {
                        _this.setState({
                            notes: html.substr(0, MAX_NOTE_LENGTH),
                            everEdited: true
                        });
                        _this.autoSaver.triggerChange(500);
                    }) }),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("hr", null),
                error ?
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("p", { className: "error" }, error) :
                    showLoadingProgress ?
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("span", null,
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_intl__WEBPACK_IMPORTED_MODULE_11__["FormattedMessage"], { id: "common.loading", defaultMessage: "Laddar..." }),
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_9__["Spinner"], null)) :
                        showSavingProgress ? react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null,
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("span", null,
                                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_intl__WEBPACK_IMPORTED_MODULE_11__["FormattedMessage"], { id: "common.saving", defaultMessage: "Sparar..." }),
                                " \u00A0 "),
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_9__["Spinner"], null)) :
                            this.isNotesEdited() ?
                                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, "\u00A0") :
                                everEdited ?
                                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_intl__WEBPACK_IMPORTED_MODULE_11__["FormattedMessage"], { id: "common.saved", defaultMessage: "Sparad" }) :
                                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, "\u00A0"))));
    };
    WeekNotebook.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_12__["LanguageContext"];
    return WeekNotebook;
}(react__WEBPACK_IMPORTED_MODULE_1___default.a.Component));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-goal.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-goal.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomGoal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomGoal", function() { return AddCustomGoal; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");




var AddCustomGoal = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomGoal, _super);
    function AddCustomGoal(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            learningGoal: props.learningGoal || ''
        };
        return _this;
    }
    AddCustomGoal.prototype.render = function () {
        var _this = this;
        var learningGoal = this.state.learningGoal;
        var onSave = this.props.onSave;
        var isGymnasiumStudent = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].currentUser.schoolType).toLowerCase() === "gymnasium";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isGymnasiumStudent ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalGymnasiumSchoolTitle", defaultMessage: "L\u00E4gg till rubrik" }) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalPrimarySchoolTitle", defaultMessage: "L\u00E4gg till eget l\u00E4randem\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, isGymnasiumStudent ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalGymnasiumSchool", defaultMessage: "Rubrik" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalPrimarySchool", defaultMessage: "M\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, autoFocus: true, value: learningGoal, onChange: function (e) { return _this.setState({ learningGoal: e.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(learningGoal); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "common.save", defaultMessage: "save" }))));
    };
    return AddCustomGoal;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-task.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-task.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomTask", function() { return AddCustomTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");







var AddCustomTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomTask, _super);
    function AddCustomTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            name: '',
            description: '',
            url: ''
        };
        return _this;
    }
    AddCustomTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var _b = this.props, isTask = _b.isTask, onSave = _b.onSave;
        var intl = this.context.intl;
        var isGymnasiumStudent = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["env"].currentUser.schoolType).toLowerCase() === "gymnasium";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isGymnasiumStudent ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "customTask.addWorkGoalGymnasiumSchoolTitle", defaultMessage: "L\u00E4gg till uppgift" }) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "customTask.addWorkGoalPrimarySchoolTitle", defaultMessage: "L\u00E4gg till eget arbetsm\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.nameLabel', defaultMessage: 'Namn' }), id: "AddCustomTask:name", placeholder: intl.formatMessage({ id: 'customTask.enterNamePlhd', defaultMessage: 'Ange namn...' }), value: name, autoFocus: true, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { rows: 7, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddCustomTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: "Lgg till en beskrivning..." }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Lnk' }), id: "AddCustomTask:url", placeholder: "http://www...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(name, description, url); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddCustomTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__["LanguageContext"];
    return AddCustomTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-or-edit-sub-task.tsx":
/*!*************************************************************!*\
  !*** ./src/components/weekplanner/add-or-edit-sub-task.tsx ***!
  \*************************************************************/
/*! exports provided: AddOrEditSubTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddOrEditSubTask", function() { return AddOrEditSubTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");







var AddOrEditSubTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddOrEditSubTask, _super);
    function AddOrEditSubTask(props) {
        var _this = _super.call(this, props) || this;
        if (props.mode === 'edit') {
            var subTask = props.subTask;
            _this.state = {
                name: subTask.name || '',
                description: subTask.description || '',
                url: subTask.url || ''
            };
        }
        else {
            _this.state = {
                name: '',
                description: '',
                url: ''
            };
        }
        return _this;
    }
    AddOrEditSubTask.prototype.save = function () {
        // Update repo:
        var props = this.props;
        var userTask = props.userTask, closeDialog = props.closeDialog, userTasksRepo = props.userTasksRepo;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        if (props.mode === 'edit') {
            // Edit existing:
            userTasksRepo.update([userTask], function (ut) {
                var subTasks = ut.subTasks;
                if (subTasks) {
                    ut.subTasks = subTasks.map(function (st) {
                        return st.id === props.subTask.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st, { name: name, description: description, url: url }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st);
                    });
                }
            });
        }
        else {
            // Create new task
            var newSubTask_1 = {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                name: name,
                description: description,
                url: url
            };
            // Update repo:
            userTasksRepo.update([userTask], function (ut) {
                if (!ut.subTasks) {
                    ut.subTasks = [];
                }
                ut.subTasks = ut.subTasks.concat(newSubTask_1);
            });
        }
        // Close dialog
        closeDialog();
    };
    AddOrEditSubTask.prototype.delete = function () {
        // Update repo:
        var props = this.props;
        if (props.mode !== 'edit') {
            throw new Error("Can only delete in edit mode");
        }
        props.userTasksRepo.update([props.userTask], function (ut) {
            if (ut.subTasks) {
                ut.subTasks = ut.subTasks.filter(function (t) { return t.id !== props.subTask.id; });
            }
        });
        // Close dialog:
        props.closeDialog();
    };
    AddOrEditSubTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var props = this.props;
        var isEditMode = props.mode === 'edit';
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isEditMode ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.editSubtask", defaultMessage: 'Redigera underuppgift' }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.addSubtask", defaultMessage: 'L\u00E4gg till underuppgift' })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { autoFocus: true, label: intl.formatMessage({ id: 'addeditsubtask.nameLabel', defaultMessage: 'Underuppgiftens namn' }), id: "AddUserSubTask:name", placeholder: "", value: this.state.name, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddUserSubTask:description", rows: 7, placeholder: "", value: this.state.description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Lnk' }), id: "AddUserSubTask:url", placeholder: "", value: this.state.url, onChange: function (url) { return _this.setState({ url: url }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                props.mode === 'edit' && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn btn-warning btn-large pull-right", onClick: function (ev) { return _this.delete(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.deleteSubtask", defaultMessage: "Ta bort underuppgift" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddOrEditSubTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__["LanguageContext"];
    return AddOrEditSubTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/edit-user-task.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/edit-user-task.tsx ***!
  \*******************************************************/
/*! exports provided: EditUserTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditUserTask", function() { return EditUserTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/form-field */ "./src/components/utility-components/form-field.tsx");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");












var EditUserTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditUserTask, _super);
    function EditUserTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: props.userTask,
            name: props.userTask.name,
            description: props.userTask.description,
            url: props.userTask.url,
            deadline: props.userTask.deadline,
            subTasks: props.userTask.subTasks
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    EditUserTask.prototype.componentDidMount = function () {
        this.props.userTasksRepo.subscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var myUserTask = userTasks.find(function (ut) { return ut.id === _this.props.userTask.id; });
        if (!myUserTask) {
            this.props.closeDialog();
            return;
        }
        this.setState({
            userTask: myUserTask,
            subTasks: myUserTask.subTasks
        });
    };
    EditUserTask.prototype.componentWillUnmount = function () {
        this.props.userTasksRepo.unsubscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.isModified = function () {
        // Don't count subtask changes! They live their own life and is maintained
        // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks
        // to be persisted right away. May click away this dialog.
        // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner
        // when clicking the subtask for example!
        var _a = this.state, deadline = _a.deadline, description = _a.description, name = _a.name, url = _a.url, userTask = _a.userTask;
        return (deadline !== userTask.deadline ||
            description !== userTask.description ||
            name !== userTask.name ||
            url !== userTask.url);
    };
    EditUserTask.prototype.addSubTask = function () {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "add", userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.editSubTask = function (subTask) {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "edit", subTask: subTask, userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url, deadline = _a.deadline, subTasks = _a.subTasks, showCalendar = _a.showCalendar, userTask = _a.userTask;
        var id = userTask.id, courseName = userTask.courseName;
        var _b = this.props, onUpdate = _b.onUpdate, onDelete = _b.onDelete;
        var isModified = this.isModified();
        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_2__["getTaskType"])(userTask);
        var isCustomTask = taskType === 'customTask';
        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline) < moment__WEBPACK_IMPORTED_MODULE_6___default()();
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isCustomTask ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editWorkGoals", defaultMessage: 'Redigera arbetsm\u00E5l' }) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editTask", defaultMessage: 'Redigera uppgift' })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { autoFocus: true, label: isCustomTask ? intl.formatMessage({ id: 'task.targetNameLabel', defaultMessage: 'Arbetsmlets namn' }) : intl.formatMessage({ id: 'task.taskNameLabel', defaultMessage: 'Uppgiftens namn' }), id: "EditUserTask:name", placeholder: isCustomTask ? intl.formatMessage({ id: 'task.whatShouldYouDoPlhd', defaultMessage: 'Vad ska du gra?' }) : intl.formatMessage({ id: 'task.enterTaskNamePlhd', defaultMessage: 'Ange uppgiftens namn...' }), value: name, onChange: function (name) { return _this.setState({ name: name }); } }),
            isCustomTask && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__["TextAreaFormField"], { rows: 5, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "EditUserTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: 'Lgg till en beskrivning...' }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: "Lnk" }), id: "EdutUserTask:url", placeholder: "http(s)://...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.setDeadline', defaultMessage: 'Ange deadline' }) }, (deadline || showCalendar) ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_3__["default"], { ref: function (elem) { return _this.datePicker = elem; }, id: "EditUserTask:deadline", nextMonthButtonLabel: "", previousMonthButtonLabel: "", showWeekNumbers: true, selected: deadline && moment__WEBPACK_IMPORTED_MODULE_6___default()(deadline).toDate(), autoFocus: showCalendar, dateFormat: "yyyy-MM-dd", className: expired ? "expired" : undefined, locale: intl.locale, popperPlacement: isCustomTask ? "top-start" : "bottom-start", onBlur: function () { return _this.setState({ showCalendar: false }); }, onChange: function (value) {
                                _this.setState({
                                    deadline: value && moment__WEBPACK_IMPORTED_MODULE_6___default()(value).format("YYYY-MM-DD"),
                                    showCalendar: false
                                });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "deleteDate", href: "#", title: intl.formatMessage({ id: 'task.removeDeadline', defaultMessage: 'Ta bort deadline' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.setState({ deadline: null, showCalendar: false });
                            } }))) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top", ref: function () { _this.datePicker = null; } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function (ev) {
                            if (_this.datePicker) {
                                _this.datePicker.setOpen(true);
                            }
                            _this.setState({
                                showCalendar: true
                            });
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-calendar", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.setDeadlineLabel", defaultMessage: "Ange deadline..." })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.subTasks', defaultMessage: 'Underuppgifter' }) },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, subTasks && subTasks.map(function (subTask) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () { return _this.editSubTask(subTask); }, href: "#" }, subTask.name))); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { id: "EditUserTask:addSubTask", className: "btn", onClick: function () { return _this.addSubTask(); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                            " ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.addSubtask", defaultMessage: "L\u00E4gg till underuppgift" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "divider large" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-default", onClick: function () {
                            isModified ? onUpdate(function (userTask) {
                                userTask.name = name;
                                userTask.description = description;
                                userTask.url = url;
                                userTask.deadline = deadline;
                            }) : _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn", onClick: function () {
                            _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.cancel", defaultMessage: "Avbryt" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "confirm top pull-right" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-warning", onClick: function () {
                            onDelete(id);
                        } }, isCustomTask ?
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeWorkGoals", defaultMessage: "Ta bort arbetsm\u00E5l" }) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeThisTask", defaultMessage: "Ta bort den h\u00E4r uppgiften" })))));
    };
    EditUserTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__["LanguageContext"];
    return EditUserTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/get-task-type.ts":
/*!*****************************************************!*\
  !*** ./src/components/weekplanner/get-task-type.ts ***!
  \*****************************************************/
/*! exports provided: getTaskType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTaskType", function() { return getTaskType; });
function getTaskType(userTask) {
    return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?
        'courseBuilderTask' :
        userTask.siteVisionPageId ?
            'siteVisionTask' :
            userTask.courseInfo ?
                'subjectPlannerTask' :
                'customTask';
}


/***/ }),

/***/ "./src/components/weekplanner/refiner.ts":
/*!***********************************************!*\
  !*** ./src/components/weekplanner/refiner.ts ***!
  \***********************************************/
/*! exports provided: refine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "refine", function() { return refine; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


function refine(tasks) {
    var e_1, _a, e_2, _b;
    var result = [];
    var mapper = {};
    var tasksPerCourse = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(tasks, function (t) { return t.courseName || ''; });
    try {
        for (var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerCourse).sort().filter(function (x) { return x; }).concat(tasksPerCourse[''] ?
            [''] : [])), _d = _c.next(); !_d.done; _d = _c.next()) {
            var courseName = _d.value;
            var courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];
            var tasksPerLearningGoal = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(courseTasks, function (t) { return t.learningGoal; });
            var resultLearningGoals = [];
            try {
                for (var _e = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerLearningGoal))), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var learningGoal = _f.value;
                    var lgTasks = tasksPerLearningGoal[learningGoal].sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["compareProp"])("dateTime"));
                    var learningGoalTask = lgTasks
                        .filter(function (t) { return t.name == null; }) // If name is undefined or null, this represents a learning goal
                    [0];
                    var url = learningGoalTask && learningGoalTask.url;
                    resultLearningGoals.push({
                        name: learningGoal,
                        allTasks: lgTasks,
                        url: url,
                        step: lgTasks.map(function (t) { return t.step; }).filter(function (step) { return step; })[0],
                        tasks: lgTasks.filter(function (t) { return t.name; })
                    });
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            result.push({
                courseName: courseName,
                learningGoals: resultLearningGoals
            });
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}


/***/ }),

/***/ "./src/components/weekplanner/user-tasks-box.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/user-tasks-box.tsx ***!
  \*******************************************************/
/*! exports provided: UserTasksBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksBox", function() { return UserTasksBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../calendar/course-name-to-css-class */ "./src/components/calendar/course-name-to-css-class.ts");
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");












;
var UserTasksBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksBox, _super);
    function UserTasksBox(props) {
        return _super.call(this, props) || this;
    }
    UserTasksBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseName = _a.courseName, learningGoals = _a.learningGoals, progressData = _a.progressData, displayProgress = _a.displayProgress;
        var isOpen = !!this.props.openCourses[courseName];
        var features = new _features__WEBPACK_IMPORTED_MODULE_7__["Features"]();
        var intl = this.context.intl;
        var isGymnasiumStudent = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["env"].currentUser.schoolType).toLowerCase() === "gymnasium";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, courseName || (isGymnasiumStudent ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: "userTasks.gymnasiumSchoolGoals", defaultMessage: "\u00D6vriga uppgifter" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: "userTasks.primarySchoolGoals", defaultMessage: "Egna l\u00E4randem\u00E5l" }))), headerOpen: isOpen, className: courseName && Object(_calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__["courseNameToCssClass"])('wp-course-', courseName), onOpenClose: function (becameOpen) { return _this.props.setIsOpen(courseName, becameOpen); }, displayProgress: displayProgress, progressData: progressData }, learningGoals.map(function (lg) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name, className: "learningGoalContainer" },
                lg.step && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stepIndicator" }, lg.step),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalText horizontalItem top" }, lg.name),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        "\u00A0",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "trash", href: "#", title: intl.formatMessage({ id: 'userTasks.deleteLearningGoal', defaultMessage: 'Ta bort lrandemlet och dess uppgifter' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.props.removeLearningGoal(lg);
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, lg.tasks.map(function (userTask) {
                        var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';
                        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_5__["getTaskType"])(userTask);
                        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).startOf('day') < moment__WEBPACK_IMPORTED_MODULE_6___default()().startOf('day');
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: userTask.id, style: isWorking ? { opacity: 0.5 } : {} },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (userTask.done ? " checked" : ""), onClick: function (ev) { return !isWorking && _this.props.setTaskDone(userTask, !userTask.done); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    taskType === 'courseBuilderTask' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getTaskUrl(userTask, _this.props.viewCourseUrl) }, userTask.name) :
                                        taskType === 'subjectPlannerTask' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getSubjectPlannerTaskUrl(userTask) }, userTask.name) :
                                            taskType === 'siteVisionTask' ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: userTask.url }, userTask.name) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: !userTask.url ? "link-less" : "", href: userTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                        "_self" :
                                                        "_blank" }, userTask.name),
                                    userTask.deadline && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "dateSet" + (expired ? ' expired' : '') },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { title: moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).format("YYYY-MM-DD"), className: "fa fa-calendar", "aria-hidden": "true", onClick: function () { } }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editTask(userTask); } }))),
                            userTask.subTasks && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "subtasks" }, userTask.subTasks.map(function (subTask) {
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (subTask.done ? " checked" : ""), onClick: function (ev) {
                                                return !isWorking &&
                                                    _this.props.setSubTaskDone(userTask, subTask, !subTask.done);
                                            } })),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: subTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                "_self" :
                                                "_blank", className: subTask.url ?
                                                undefined :
                                                'link-less' }, subTask.name)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editSubTask(userTask, subTask); } })));
                            })));
                    }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTools" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn addOwnGoal", onClick: function () { return _this.props.addOwnTask(_this.props.courseName, lg.name); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                        " ",
                        isGymnasiumStudent ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: "weekplanner.learningGoalGymnasium", defaultMessage: "Uppgift" }) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: 'userTasks.addLearningGoal', defaultMessage: 'Eget arbetsm\u00E5l' }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
        }));
    };
    UserTasksBox.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__["LanguageContext"];
    return UserTasksBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getTaskUrl(userTask, viewCourseUrl) {
    if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: userTask.course[0].id });
        return courseUrl + "#/task/" + userTask.task[0].id;
    }
    return userTask.url;
}
function getSubjectPlannerTaskUrl(userTask) {
    if (userTask.courseInfo && userTask.task && userTask.task.length > 0) {
        var _a = userTask.courseInfo, school = _a.school, course = _a.course, tab = _a.tab;
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__["default"].KED_SUBJECT_PLANNER_URL, {});
        return courseUrl + "#/" + school + "/courses/" + course + "/tabs/" + tab + "/tasks/" + userTask.task[0].id;
    }
    return userTask.url;
}


/***/ }),

/***/ "./src/components/weekplanner/weekplanner-persisted-state.ts":
/*!*******************************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-persisted-state.ts ***!
  \*******************************************************************/
/*! exports provided: WeekPlannerPersistedState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerPersistedState", function() { return WeekPlannerPersistedState; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");



var WeekPlannerPersistedState = /** @class */ (function () {
    function WeekPlannerPersistedState(userOrCopy) {
        if (typeof userOrCopy === 'string') {
            this.user = userOrCopy;
            this.lastWrite = Date.now();
            this.weekDate = Object(_globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__["localMoment"])().startOf('week').valueOf();
            this.openCourses = {};
        }
        else {
            Object.assign(this, userOrCopy);
        }
    }
    WeekPlannerPersistedState.load = function (user) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var cookie, storedData, state;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                cookie = localStorage.getItem('WeekPlannerPersistedState2');
                storedData = cookie && JSON.parse(cookie);
                state = new WeekPlannerPersistedState(user);
                if (storedData)
                    Object.assign(state, storedData);
                return [2 /*return*/, state.user === user && !state.isExpired(moment__WEBPACK_IMPORTED_MODULE_1___default()()) ?
                        state : new WeekPlannerPersistedState(user)];
            });
        });
    };
    WeekPlannerPersistedState.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.lastWrite = Date.now();
                json = JSON.stringify(this);
                localStorage.setItem('WeekPlannerPersistedState2', json);
                return [2 /*return*/];
            });
        });
    };
    WeekPlannerPersistedState.prototype.isExpired = function (asOf) {
        return moment__WEBPACK_IMPORTED_MODULE_1___default()(this.lastWrite)
            .isBefore(asOf.add(0 - WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours'));
    };
    WeekPlannerPersistedState.EXPIRATION_HOURS = 12;
    WeekPlannerPersistedState.VERSION = 2;
    return WeekPlannerPersistedState;
}());



/***/ }),

/***/ "./src/components/weekplanner/weekplanner-self.tsx":
/*!*********************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-self.tsx ***!
  \*********************************************************/
/*! exports provided: WeekPlannerSelf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerSelf", function() { return WeekPlannerSelf; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./weekplanner */ "./src/components/weekplanner/weekplanner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");






function WeekPlannerSelf(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_5__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_weekplanner__WEBPACK_IMPORTED_MODULE_1__["WeekPlanner"], { env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"], viewCourseUrl: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_COURSE_VIEWER_URL }));
}


/***/ }),

/***/ "./src/components/weekplanner/weekplanner-tutored.tsx":
/*!************************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-tutored.tsx ***!
  \************************************************************/
/*! exports provided: WeekPlannerTutored */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerTutored", function() { return WeekPlannerTutored; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./weekplanner */ "./src/components/weekplanner/weekplanner.tsx");
/* harmony import */ var _utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/tutorable-component */ "./src/components/utility-components/tutorable-component.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");





function WeekPlannerTutored(props) {
    var intl = props.intl;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_3__["LanguageContext"].Provider, { value: { intl: intl } },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_utility_components_tutorable_component__WEBPACK_IMPORTED_MODULE_2__["TutorableComponent"], { tutored: true, createComponent: function (env) {
                return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_weekplanner__WEBPACK_IMPORTED_MODULE_1__["WeekPlanner"], { key: env.currentUser.mail, env: env, viewCourseUrl: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_COURSE_VIEWER_URL });
            } }));
}


/***/ }),

/***/ "./src/components/weekplanner/weekplanner.tsx":
/*!****************************************************!*\
  !*** ./src/components/weekplanner/weekplanner.tsx ***!
  \****************************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return WeekPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _user_tasks_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./user-tasks-box */ "./src/components/weekplanner/user-tasks-box.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _refiner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./refiner */ "./src/components/weekplanner/refiner.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _add_custom_goal__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./add-custom-goal */ "./src/components/weekplanner/add-custom-goal.tsx");
/* harmony import */ var _add_custom_task__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./add-custom-task */ "./src/components/weekplanner/add-custom-task.tsx");
/* harmony import */ var _edit_user_task__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./edit-user-task */ "./src/components/weekplanner/edit-user-task.tsx");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_pending_job__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../utils/pending-job */ "./src/utils/pending-job.ts");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _charts_progress__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../charts/progress */ "./src/components/charts/progress.tsx");
/* harmony import */ var _charts_charts_utils__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../charts/charts-utils */ "./src/components/charts/charts-utils.ts");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");






















var MAX_STRATEGY_LENGTH = 16384;
var MAX_ASSESSMENT_LENGTH = 16384;
var WeekPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekPlanner, _super);
    function WeekPlanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            openCourses: {},
            dialogs: [],
            saving: false,
            weekTextsUT: null,
            isLoading: true,
            isCopyingTasks: false
        };
        _this.onChange = _this.onChange.bind(_this);
        _this.weekTextsSavingJob = new _utils_pending_job__WEBPACK_IMPORTED_MODULE_14__["PendingJob"](function () { return _this.saveWeekTexts(); });
        return _this;
    }
    WeekPlanner.prototype.componentDidMount = function () {
        this.props.env.userTasksRepo.subscribe(this.onChange);
    };
    WeekPlanner.prototype.componentWillUnmount = function () {
        this.props.env.userTasksRepo.unsubscribe(this.onChange);
        this.weekTextsSavingJob.stop();
    };
    WeekPlanner.prototype.onChange = function (userTasks, persisted, weekTextsUT) {
        var newState = {
            userTasks: userTasks,
            weekDate: persisted.weekDate,
            openCourses: persisted.openCourses,
            weekTextsUT: weekTextsUT,
            isLoading: false
        };
        if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {
            // Changing week. Reset to new week's values
            newState.strategy = weekTextsUT.weekTexts.strategy;
            newState.assessment = weekTextsUT.weekTexts.assessment;
        }
        this.setState(newState); // React's use of Pick instead of Partial makes things complex here.
    };
    WeekPlanner.prototype.isWeekTextsEdited = function () {
        var _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
        return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);
    };
    WeekPlanner.prototype.saveWeekTexts = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, strategy, assessment, weekTextsUT;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        console.log("Saving texts...");
                        _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
                        if (!this.isWeekTextsEdited()) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.props.env.userTasksRepo.upsert(weekTextsUT, function (ut) {
                                ut.weekTexts = { strategy: strategy, assessment: assessment };
                            })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.prevWeek = function () {
        //this.saveWeekTexts(); 
        var prevWeekObj = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_16__["getPrevWeekDate"])(moment__WEBPACK_IMPORTED_MODULE_7___default()(this.state.weekDate));
        this.props.env.userTasksRepo.changeWeek(prevWeekObj.nextDate, prevWeekObj.adjusted);
    };
    WeekPlanner.prototype.nextWeek = function () {
        //this.saveWeekTexts();
        var nextWeekObj = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_16__["getNextWeekDate"])(moment__WEBPACK_IMPORTED_MODULE_7___default()(this.state.weekDate));
        this.props.env.userTasksRepo.changeWeek(nextWeekObj.nextDate, nextWeekObj.adjusted);
    };
    WeekPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    WeekPlanner.prototype.openAddGoalDialog = function () {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_goal__WEBPACK_IMPORTED_MODULE_9__["AddCustomGoal"], { onSave: function (learningGoal) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!learningGoal)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.emptyLearningGoalErr', defaultMessage: 'Lrandemlet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomGoal(learningGoal)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.openAddOwnTaskDialog = function (courseName, learningGoalName) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_task__WEBPACK_IMPORTED_MODULE_10__["AddCustomTask"], { isTask: !courseName, onSave: function (name, description, url) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameCannotBeEmpty', defaultMessage: 'Namnet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomTask(courseName, learningGoalName, name, description, url)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.editTask = function (userTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_user_task__WEBPACK_IMPORTED_MODULE_11__["EditUserTask"], { userTasksRepo: this.props.env.userTasksRepo, userTask: userTask, onUpdate: function (updater) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var test;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            test = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, userTask);
                            updater(test);
                            if (!test.name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameMustNotBeEmpty', defaultMessage: 'Namnet fr inte vara tomt' }));
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.update([userTask], updater)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, onDelete: function (id) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.delete([id])];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, openDialog: function (dialog) { return _this.openDialog(dialog); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.editSubTask = function (userTask, subTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_15__["AddOrEditSubTask"], { userTasksRepo: this.props.env.userTasksRepo, mode: "edit", userTask: userTask, subTask: subTask, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    WeekPlanner.prototype.addCustomGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    learningGoal: learningGoal,
                                    dateTime: latestTimeStamp + 2000
                                }])];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.props.env.userTasksRepo.setWeekPlannerBoxOpen("", true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.removeLearningGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (learningGoal.tasks.length > 0) {
                            if (!confirm(this.context.intl.formatMessage({ id: 'weekplanner.confirmRemoveLearningObjectives', defaultMessage: 'Ta bort lrandeml samt {learningGoalsNumber} uppgifter?' }, { learningGoalsNumber: learningGoal.tasks.length }))) {
                                return [2 /*return*/];
                            }
                        }
                        return [4 /*yield*/, this.props.env.userTasksRepo.delete(learningGoal.allTasks.map(function (t) { return t.id; }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.addCustomTask = function (courseName, learningGoal, name, description, url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    dateTime: latestTimeStamp + 2000,
                                    courseName: courseName,
                                    learningGoal: learningGoal,
                                    name: name,
                                    description: description,
                                    url: url
                                }])];
                    case 1:
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setIsOpen = function (courseName, isOpen) {
        this.props.env.userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);
    };
    WeekPlanner.prototype.setTaskDone = function (task, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setTaskDoneState(task, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setSubTaskDone = function (task, subTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setSubTaskDoneState(task, subTask.id, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.copyFromPreviousWeek = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, userTasks_1, openCourses, weekDate, prevWeek, prevWeekNo, prevKEDWeek, prevTasks, test, latestTimeStamp_1, copies;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.setState({ isCopyingTasks: true })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, , 5, 6]);
                        _a = this.state, userTasks_1 = _a.userTasks, openCourses = _a.openCourses, weekDate = _a.weekDate;
                        prevWeek = moment__WEBPACK_IMPORTED_MODULE_7___default()(weekDate).add(-1, 'week');
                        prevWeekNo = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_16__["getAdjustedWeek"])(prevWeek);
                        prevKEDWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_16__["KEDWeek"])(prevWeek.year(), prevWeekNo);
                        return [4 /*yield*/, this.props.env.kedBackendClient.list("usertasks", {
                                from: prevKEDWeek.notBefore,
                                to: prevKEDWeek.notAfter,
                                role: "USER",
                                include: ["task", "course", "acl"],
                                flags: ["includeIdsOnly"]
                            })];
                    case 3:
                        prevTasks = _b.sent();
                        prevTasks = prevTasks
                            .filter(function (prevTask) { return !prevTask.done; }) // Don't copy done tasks
                            .filter(function (prevTask) { return !!prevTask.name; }) // Don't copy empty learning goals
                            .filter(function (prevTask) { return !userTasks_1.some(function (taskOfCurrentWeek) {
                            return taskOfCurrentWeek.name === prevTask.name &&
                                taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&
                                taskOfCurrentWeek.courseName === prevTask.courseName;
                        }); }); // Ignore identical tasks (already copied)
                        test = [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; }));
                        latestTimeStamp_1 = Math.max.apply(Math.max, [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; })));
                        copies = prevTasks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["compareProp"])("dateTime")).map(function (task) {
                            var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, { dateTime: latestTimeStamp_1 += 1000 });
                            copy.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])();
                            if (copy.subTasks) {
                                copy.subTasks = copy.subTasks.filter(function (st) { return !st.done; });
                            }
                            delete copy.$etag;
                            return copy;
                        });
                        // Store it
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert(copies)];
                    case 4:
                        // Store it
                        _b.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        this.setState({ isCopyingTasks: false });
                        return [7 /*endfinally*/];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.getHeaderTitle = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.logBook", defaultMessage: "Loggbok" }));
    };
    WeekPlanner.prototype.render = function () {
        var _this = this;
        var weekNumber = moment__WEBPACK_IMPORTED_MODULE_7___default()(this.state.weekDate).week();
        var showProgressCharts = _features__WEBPACK_IMPORTED_MODULE_21__["features"].weekplannerCharts;
        //console.log("Weekydate: "  + new Date(this.state.weekDate) + " which is week no " + weekNumber);
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_7___default()().week();
        var taskSets = Object(_refiner__WEBPACK_IMPORTED_MODULE_4__["refine"])(this.state.userTasks);
        var _a = this.state, dialogs = _a.dialogs, weekTextsUT = _a.weekTextsUT, strategy = _a.strategy, assessment = _a.assessment, isLoading = _a.isLoading, isCopyingTasks = _a.isCopyingTasks;
        var isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');
        var isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);
        var isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);
        var enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);
        var isGymnasiumStudent = ('' + _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["env"].currentUser.schoolType).toLowerCase() === "gymnasium";
        var chartTasks = Object(_charts_charts_utils__WEBPACK_IMPORTED_MODULE_20__["getWeekplannerProgressData"])(taskSets);
        var percentage = chartTasks.totalNumberOfTasks > 0 ? chartTasks.completedTasks / chartTasks.totalNumberOfTasks * 100 : 0;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed weekPlanner" + (weekNumber === currentWeek ? " currentWeek" : ""), onKeyDown: function (ev) {
                    if (ev.which === 83 && ev.ctrlKey) {
                        ev.preventDefault();
                        if (!isSaving && _this.isWeekTextsEdited()) {
                            _this.weekTextsSavingJob.triggerChange(0);
                        }
                    }
                } },
                showProgressCharts && chartTasks.totalNumberOfTasks > 0 && this.getHeaderTitle(),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "widgets" },
                    showProgressCharts && chartTasks.totalNumberOfTasks > 0 ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progressBar" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_progress__WEBPACK_IMPORTED_MODULE_19__["Progress"], { percentage: percentage })) : this.getHeaderTitle(),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "weekSelect" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.weekNumber", values: { weekNumber: weekNumber }, defaultMessage: "Vecka {weekNumber}" }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.prevWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.nextWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" })))))),
                taskSets.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                taskSets.map(function (props) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_user_tasks_box__WEBPACK_IMPORTED_MODULE_2__["UserTasksBox"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ key: props.courseName }, props, { courseName: props.courseName, learningGoals: props.learningGoals, viewCourseUrl: _this.props.viewCourseUrl, openCourses: _this.state.openCourses, addOwnTask: function (courseName, learningGoalName) { return _this.openAddOwnTaskDialog(courseName, learningGoalName); }, setIsOpen: _this.setIsOpen.bind(_this), setTaskDone: _this.setTaskDone.bind(_this), setSubTaskDone: _this.setSubTaskDone.bind(_this), editTask: function (task) { return _this.editTask(task); }, editSubTask: function (task, subTask) { return _this.editSubTask(task, subTask); }, removeLearningGoal: function (lg) { return _this.removeLearningGoal(lg); }, displayProgress: showProgressCharts, progressData: chartTasks.subjectData[props.courseName] }));
                }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                isLoading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__["Spinner"], null) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", onClick: function (ev) { return _this.openAddGoalDialog(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-list-alt", "aria-hidden": "true" }),
                        isGymnasiumStudent ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.learningGoalGymnasium", defaultMessage: "Uppgift" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.learningGoalPrimary", defaultMessage: "Eget l\u00E4randem\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", style: isCopyingTasks ? { opacity: 0.5 } : undefined, onClick: function (ev) { return (!isCopyingTasks) && _this.copyFromPreviousWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-clone", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.copyPreviousWeekTaks", defaultMessage: "Kopiera ej klara fr\u00E5n f\u00F6reg\u00E5ende vecka" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_13__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.strategyAndEvaluation", defaultMessage: "Strategi & Utv\u00E4rdering" })), headerOpen: this.state.openCourses["StratUtv"], onOpenClose: function (becameOpen) { return _this.setIsOpen("StratUtv", becameOpen); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.strategy", defaultMessage: "Strategi" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.strategyDescription", defaultMessage: "Hur jag ska g\u00F6ra f\u00F6r att l\u00E4ra mig." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", disabled: this.props.env.tutored, value: strategy && strategy.substr(0, MAX_STRATEGY_LENGTH), onChange: function (ev) {
                                _this.setState({ strategy: (ev.target.value || '').substr(0, MAX_STRATEGY_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.evaluation", defaultMessage: "Utv\u00E4rdering" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "weekplanner.evaluationDescription", defaultMessage: "Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utv\u00E4rdera i f\u00F6rh\u00E5llande till dina m\u00E5l." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", value: assessment && assessment.substr(0, MAX_ASSESSMENT_LENGTH), disabled: this.props.env.tutored, onChange: function (ev) {
                                _this.setState({ assessment: (ev.target.value || '').substr(0, MAX_ASSESSMENT_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", tabIndex: 0, style: enableSaveButton ? {} : { opacity: 0.5 }, onClick: function () { return !isSaving && _this.weekTextsSavingJob.triggerChange(0); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-floppy-o", "aria-hidden": "true" }),
                            enableSaveButton ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "common.save", defaultMessage: " Spara" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_17__["FormattedMessage"], { id: "common.saved", defaultMessage: " Sparad" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_8__["Dialogs"], { dialogs: dialogs, popDialog: function () {
                    _this.setState(function (_a) {
                        var dialogs = _a.dialogs;
                        return ({ dialogs: dialogs.slice(0, dialogs.length - 1) });
                    });
                } }));
    };
    WeekPlanner.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_18__["LanguageContext"];
    return WeekPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/elements/KEDComponents/kedcomponents.client.ts":
/*!************************************************************!*\
  !*** ./src/elements/KEDComponents/kedcomponents.client.ts ***!
  \************************************************************/
/*! exports provided: components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedcomponents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedcomponents */ "./src/elements/KEDComponents/kedcomponents.ts");
/* harmony import */ var _components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");




// <TEMPORARY FIX>
// Need as current production has the old SubjectPlanner URLs,
// while the newest version has new pages for them!
// REMOVE AFTER GOING TO PRODUCTION AND HAVING THE VALUE CONFIGURED IN ELEMENTS!

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["cfg"].KED_SUBJECT_PLANNER_URL = '/ap/amnesplaneraren';
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["cfg"].KED_SUBJECT_PLANNER_ADMIN_URL = '/ap/amnesplanerarenadmin';
// </TEMPORARY FIX>
var intlComponents = {};
Object.keys(_kedcomponents__WEBPACK_IMPORTED_MODULE_1__).forEach(function (k) {
    intlComponents[k] = Object(_components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_2__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_3__["injectIntl"])(_kedcomponents__WEBPACK_IMPORTED_MODULE_1__[k]));
});
var components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, intlComponents);


/***/ }),

/***/ "./src/elements/KEDComponents/kedcomponents.ts":
/*!*****************************************************!*\
  !*** ./src/elements/KEDComponents/kedcomponents.ts ***!
  \*****************************************************/
/*! exports provided: Calendar, CalendarTutored, WeekPlanner, WeekPlannerTutored, LatestAssessments, LearningTasks, WeekNotebook, TutorsSelect, KGTermPlanner, KGTermPlannerTutored, ListCourses, KSTermPlanner, KSTermPlannerTutored, KSGoals, MyCourses, MySubjects */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _components_calendar_calendar_self__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../components/calendar/calendar-self */ "./src/components/calendar/calendar-self.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Calendar", function() { return _components_calendar_calendar_self__WEBPACK_IMPORTED_MODULE_2__["CalendarSelf"]; });

/* harmony import */ var _components_calendar_calendar_tutored__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/calendar/calendar-tutored */ "./src/components/calendar/calendar-tutored.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CalendarTutored", function() { return _components_calendar_calendar_tutored__WEBPACK_IMPORTED_MODULE_3__["CalendarTutored"]; });

/* harmony import */ var _components_weekplanner_weekplanner_self__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/weekplanner/weekplanner-self */ "./src/components/weekplanner/weekplanner-self.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return _components_weekplanner_weekplanner_self__WEBPACK_IMPORTED_MODULE_4__["WeekPlannerSelf"]; });

/* harmony import */ var _components_weekplanner_weekplanner_tutored__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/weekplanner/weekplanner-tutored */ "./src/components/weekplanner/weekplanner-tutored.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerTutored", function() { return _components_weekplanner_weekplanner_tutored__WEBPACK_IMPORTED_MODULE_5__["WeekPlannerTutored"]; });

/* harmony import */ var _components_latest_assessments_latest_assessments__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/latest-assessments/latest-assessments */ "./src/components/latest-assessments/latest-assessments.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LatestAssessments", function() { return _components_latest_assessments_latest_assessments__WEBPACK_IMPORTED_MODULE_6__["LatestAssessments"]; });

/* harmony import */ var _components_learning_tasks__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/learning-tasks */ "./src/components/learning-tasks/index.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "LearningTasks", function() { return _components_learning_tasks__WEBPACK_IMPORTED_MODULE_7__["LearningTasks"]; });

/* harmony import */ var _components_week_notebook__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/week-notebook */ "./src/components/week-notebook/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekNotebook", function() { return _components_week_notebook__WEBPACK_IMPORTED_MODULE_8__["RootWeekNotebook"]; });

/* harmony import */ var _components_tutors_select_tutors_select__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../components/tutors-select/tutors-select */ "./src/components/tutors-select/tutors-select.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TutorsSelect", function() { return _components_tutors_select_tutors_select__WEBPACK_IMPORTED_MODULE_9__["TutorsSelect"]; });

/* harmony import */ var _components_kg_termplanner_kg_termplanner_self__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/kg-termplanner/kg-termplanner-self */ "./src/components/kg-termplanner/kg-termplanner-self.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KGTermPlanner", function() { return _components_kg_termplanner_kg_termplanner_self__WEBPACK_IMPORTED_MODULE_10__["KGTermPlannerSelf"]; });

/* harmony import */ var _components_kg_termplanner_kg_termplanner_tutored__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../components/kg-termplanner/kg-termplanner-tutored */ "./src/components/kg-termplanner/kg-termplanner-tutored.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KGTermPlannerTutored", function() { return _components_kg_termplanner_kg_termplanner_tutored__WEBPACK_IMPORTED_MODULE_11__["KGTermPlannerTutored"]; });

/* harmony import */ var _components_list_courses_list_courses__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../components/list-courses/list-courses */ "./src/components/list-courses/list-courses.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ListCourses", function() { return _components_list_courses_list_courses__WEBPACK_IMPORTED_MODULE_12__["ListCourses"]; });

/* harmony import */ var _components_ks_termplanner_ks_termplanner_self__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../components/ks-termplanner/ks-termplanner-self */ "./src/components/ks-termplanner/ks-termplanner-self.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KSTermPlanner", function() { return _components_ks_termplanner_ks_termplanner_self__WEBPACK_IMPORTED_MODULE_13__["KSTermPlannerSelf"]; });

/* harmony import */ var _components_ks_termplanner_ks_termplanner_tutored__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../components/ks-termplanner/ks-termplanner-tutored */ "./src/components/ks-termplanner/ks-termplanner-tutored.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KSTermPlannerTutored", function() { return _components_ks_termplanner_ks_termplanner_tutored__WEBPACK_IMPORTED_MODULE_14__["KSTermPlannerTutored"]; });

/* harmony import */ var _components_ks_goals_goals__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../components/ks-goals/goals */ "./src/components/ks-goals/goals.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KSGoals", function() { return _components_ks_goals_goals__WEBPACK_IMPORTED_MODULE_15__["KSGoals"]; });

/* harmony import */ var _components_my_courses_my_courses__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../components/my-courses/my-courses */ "./src/components/my-courses/my-courses.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MyCourses", function() { return _components_my_courses_my_courses__WEBPACK_IMPORTED_MODULE_16__["MyCourses"]; });

/* harmony import */ var _components_my_subjects_my_subjects__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../components/my-subjects/my-subjects */ "./src/components/my-subjects/my-subjects.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MySubjects", function() { return _components_my_subjects_my_subjects__WEBPACK_IMPORTED_MODULE_17__["MySubjects"]; });



_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].bearerProvider.getBearer(); // Start getting bearer as soon as possible.
_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].googleTokenProvider.getBearer(); // Start getting google bearer as soon as possible.
// Common components








// KG only



// KS only







/***/ }),

/***/ "./src/elements/KEDComponents/webpack-entry.ts":
/*!*****************************************************!*\
  !*** ./src/elements/KEDComponents/webpack-entry.ts ***!
  \*****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED */ "./src/globals/KED.ts");
/* harmony import */ var _kedcomponents_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedcomponents.client */ "./src/elements/KEDComponents/kedcomponents.client.ts");



_globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components, _kedcomponents_client__WEBPACK_IMPORTED_MODULE_2__["components"]);


/***/ }),

/***/ "./src/features/feature-flags.json":
/*!*****************************************!*\
  !*** ./src/features/feature-flags.json ***!
  \*****************************************/
/*! exports provided: picker, ksTutorComment, kgTutorComment, termplannerCharts, weekplannerCharts, teacherRights, studyGroups, cbCollapseBoxes, ksAssignments, markPartialKRs, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"picker\":\"Integrate coursebuilder and subjectplanner with Google Picker\",\"ksTutorComment\":\"Integrate KSTermplanner with tutor comments\",\"kgTutorComment\":\"Integrate KSTermplanner  with tutor comments\",\"termplannerCharts\":\"Integrate KSTermplanner with progress charts\",\"weekplannerCharts\":\"Integrate Weekplanner with progress charts\",\"teacherRights\":\"Activate course builder teacher rights\",\"studyGroups\":\"Add study groups and google classroom functionality\",\"cbCollapseBoxes\":\"Course Builder: Collapse modules by default\",\"ksAssignments\":\"KS show hand-in assignments\",\"markPartialKRs\":\"Activate mark partial knowledge requirments functionality\"}");

/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "features", function() { return features; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./feature-flags.json */ "./src/features/feature-flags.json");
var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./feature-flags.json */ "./src/features/feature-flags.json", 1);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");




var Features = /** @class */ (function () {
    function Features() {
        var e_1, _a;
        this._initialized = false;
        var _loop_1 = function (featureName) {
            Object.defineProperty(this_1, featureName, {
                get: function () {
                    if (!this._initialized)
                        this.init();
                    return this._features[featureName];
                },
                set: function (value) {
                    throw new Error('Feature flags cannot be set here');
                }
            });
        };
        var this_1 = this;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                _loop_1(featureName);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    Features.prototype.init = function () {
        var e_2, _a;
        if (this._initialized)
            return;
        var turnedOnFeatures = (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["cfg"].KED_FEATURES || "").split(',').map(function (name) { return name.trim().toLowerCase(); });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(location.search, { toLower: true });
        if (query.testversion) {
            turnedOnFeatures = ["*"];
        }
        if (query.features) {
            turnedOnFeatures = query.features
                .split(',')
                .map(function (feature) { return feature.trim().toLowerCase(); });
        }
        var turnOnAll = turnedOnFeatures.includes('*');
        this._features = {};
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                this._features[featureName] = turnOnAll ||
                    turnedOnFeatures.includes(featureName.toLowerCase());
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._initialized = true;
    };
    return Features;
}());

var features = new Features();


/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(process) {/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://backend.kedschools.com/kedbackend-next/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE || "sv"; // "sv", "en". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE || "sv"; // "sv", "en_sin", "en_nin". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_RESOURCES_URL || process.env.KED_RESOURCES_URL;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/process/browser.js */ "./node_modules/process/browser.js")))

/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive",
            'https://www.googleapis.com/auth/classroom.courses',
            'https://www.googleapis.com/auth/classroom.profile.emails',
            'https://www.googleapis.com/auth/classroom.profile.photos',
            'https://www.googleapis.com/auth/classroom.rosters.readonly',
            'https://www.googleapis.com/auth/classroom.rosters',
            'https://www.googleapis.com/auth/classroom.coursework.students'
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
            "https://www.googleapis.com/auth/drive",
            'https://www.googleapis.com/auth/classroom.courses',
            'https://www.googleapis.com/auth/classroom.profile.emails',
            'https://www.googleapis.com/auth/classroom.profile.photos',
            'https://www.googleapis.com/auth/classroom.rosters.readonly',
            'https://www.googleapis.com/auth/classroom.rosters',
            'https://www.googleapis.com/auth/classroom.coursework.students'
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default, cfg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cfg", function() { return cfg; });
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);
var cfg = _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg;


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default, env */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "env", function() { return env; });
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);
var env = _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env;


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/KED.tutorEnv.ts":
/*!*************************************!*\
  !*** ./src/globals/KED.tutorEnv.ts ***!
  \*************************************/
/*! exports provided: TutorEnv, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TutorEnv", function() { return TutorEnv; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");


var TutorEnv = /** @class */ (function () {
    function TutorEnv() {
        this.subscribers = [];
        this.env = null;
        this.version = 1;
    }
    //promise: Promise<Env | null> = Promise.resolve(null);
    TutorEnv.prototype.subscribe = function (subscriber) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.subscribers.push(subscriber);
                subscriber(this.env);
                return [2 /*return*/];
            });
        });
    };
    TutorEnv.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    TutorEnv.prototype.notifySubscribers = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.subscribers.forEach(function (s) { return s(_this.env); });
                return [2 /*return*/];
            });
        });
    };
    TutorEnv.prototype.setNewEnv = function (user, envGetter) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var version, env;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        version = ++this.version;
                        this.env = { currentUser: user, tutored: true };
                        this.notifySubscribers(); // Make subscriber display "Loading... user name"
                        return [4 /*yield*/, envGetter().catch(function (err) { return ({
                                currentUser: user,
                                tutored: true,
                                error: err
                            }); })];
                    case 1:
                        env = _a.sent();
                        if (version === this.version) {
                            // No one else has called setEnv during this call.
                            ++this.version;
                            this.env = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, env, { tutored: true });
                            this.notifySubscribers(); // Make subscribers display the data.
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    return TutorEnv;
}());

if (!_ked__WEBPACK_IMPORTED_MODULE_1__["default"].tutorEnv)
    _ked__WEBPACK_IMPORTED_MODULE_1__["default"].tutorEnv = new TutorEnv();
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_1__["default"].tutorEnv);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "./kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.displayName || _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/moment-sv-locale.ts":
/*!*****************************************!*\
  !*** ./src/globals/moment-sv-locale.ts ***!
  \*****************************************/
/*! exports provided: localMoment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localMoment", function() { return localMoment; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");


if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE === "sv") {
    moment__WEBPACK_IMPORTED_MODULE_0___default.a.updateLocale('sv', {
        months: 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),
        monthsShort: 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),
        weekdays: 'sndag_mndag_tisdag_onsdag_torsdag_fredag_lrdag'.split('_'),
        weekdaysShort: 'sn_mn_tis_ons_tor_fre_lr'.split('_'),
        weekdaysMin: 's_m_ti_on_to_fr_l'.split('_'),
        longDateFormat: {
            LT: 'HH:mm',
            LTS: 'HH:mm:ss',
            L: 'YYYY-MM-DD',
            LL: 'D MMMM YYYY',
            LLL: 'D MMMM YYYY [kl.] HH:mm',
            LLLL: 'dddd D MMMM YYYY [kl.] HH:mm',
            lll: 'D MMM YYYY HH:mm',
            llll: 'ddd D MMM YYYY HH:mm'
        },
        calendar: {
            sameDay: '[Idag] LT',
            nextDay: '[Imorgon] LT',
            lastDay: '[Igr] LT',
            nextWeek: '[P] dddd LT',
            lastWeek: '[I] dddd[s] LT',
            sameElse: 'L'
        },
        relativeTime: {
            future: 'om %s',
            past: 'fr %s sedan',
            s: 'ngra sekunder',
            ss: '%d sekunder',
            m: 'en minut',
            mm: '%d minuter',
            h: 'en timme',
            hh: '%d timmar',
            d: 'en dag',
            dd: '%d dagar',
            M: 'en mnad',
            MM: '%d mnader',
            y: 'ett r',
            yy: '%d r'
        },
        dayOfMonthOrdinalParse: /\d{1,2}(e|a)/,
        ordinal: function (number) {
            var b = number % 10, output = (~~(number % 100 / 10) === 1) ? 'e' :
                (b === 1) ? 'a' :
                    (b === 2) ? 'a' :
                        (b === 3) ? 'e' : 'e';
            return number + output;
        },
        week: {
            dow: 1,
            doy: 4 // The week that contains Jan 4th is the first week of the year.
        }
    });
}
var localMoment = function () {
    return moment__WEBPACK_IMPORTED_MODULE_0___default.a.apply(this, arguments).locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE);
};


/***/ }),

/***/ "./src/repos/hidden-courses-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/hidden-courses-repo.ts ***!
  \******************************************/
/*! exports provided: hiddenCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hiddenCoursesRepo", function() { return hiddenCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);








var hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo;
var HiddenCoursesRepo = /** @class */ (function () {
    function HiddenCoursesRepo() {
        var _this = this;
        this.result = null;
        this.subscribers = [];
        this.fullCourse = false;
        this.notifySubscriber = function (subscriber, options) {
            try {
                subscriber(options.fullCourse ? _this.result : _this.result.filter(function (c) { return c.visible; }));
            }
            catch (err) {
                console.error(err);
            }
        };
        this.kedRepo = new _ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]({
            getClient: function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; },
            optimistic: true,
            table: "userhiddencourses",
            user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, ({ role: "USER" })];
            }); }); },
        });
        var initPromise = this.init();
        Promise.all([
            initPromise,
            this.kedCoursesPromise,
            this.edsCoursesPromise
        ]).catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    }
    HiddenCoursesRepo.prototype.init = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var bearerPromise, resolveUserHiddenCoursesPromise, userHiddenCoursesResolved;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer() : Promise.resolve({});
                        // In parallell, we request:
                        //  1) KEDBackend: Schools.activeCourses
                        //  2) EDS.getActiveAcourses()
                        //  3) (via subscription): KEDBackend: userHiddenCourses
                        this.kedCoursesPromise = bearerPromise.then(function () { return _this.listKedCourses(); });
                        this.edsCoursesPromise = bearerPromise.then(function () { return _this.listEDSCourses(); });
                        userHiddenCoursesResolved = false;
                        this.userHiddenCoursesPromise = new Promise(function (resolve) { return resolveUserHiddenCoursesPromise = function (x) {
                            if (userHiddenCoursesResolved) {
                                _this.userHiddenCoursesPromise = Promise.resolve(x);
                            }
                            else {
                                userHiddenCoursesResolved = true;
                                resolve(x);
                            }
                        }; });
                        return [4 /*yield*/, bearerPromise];
                    case 1:
                        _a.sent();
                        this.kedRepo.mem.subscribe(function (userHiddenCourses) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a, activeCourses, edsActiveCourses, _b;
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                                switch (_c.label) {
                                    case 0: return [4 /*yield*/, Promise.all([
                                            this.kedCoursesPromise,
                                            this.edsCoursesPromise
                                        ])];
                                    case 1:
                                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 2]), activeCourses = _a[0], edsActiveCourses = _a[1];
                                        // Refine the three results into a single result
                                        _b = this;
                                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                                    case 2:
                                        // Refine the three results into a single result
                                        _b.result = _c.sent();
                                        // Notify our subscribers:
                                        this.subscribers.forEach(function (subscriber) { return _this.notifySubscriber(subscriber.subscriber, subscriber.options); });
                                        resolveUserHiddenCoursesPromise(userHiddenCourses);
                                        return [2 /*return*/];
                                }
                            });
                        }); });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listKedCourses = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var fullCourse, schools, activeCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        fullCourse = this.fullCourse;
                        console.log("FullCourse: " + fullCourse);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list('schools', {
                                role: "USER",
                                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school,
                                include: "activeCourses",
                                flags: fullCourse ? [] : ["includeIdsAndNamesOnly"],
                                cacheBust: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.username
                            })];
                    case 1:
                        schools = _a.sent();
                        activeCourses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.activeCourses; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        return [2 /*return*/, activeCourses];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listEDSCourses = function () {
        var periodName = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__["EDSPeriod"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_7___default()())).period;
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.indexOf('EMPLOYEE') === -1 ?
            // STUDENTs should, by default, only show courses that is listed in EDS
            _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].edsClient.getActiveCourses({ periodName: periodName }) :
            // EMPLOYEEs should, by default, show all courses on school - no need to query EDS
            null;
    };
    HiddenCoursesRepo.prototype.createCoursesList = function (edsActiveCourses, userHiddenCourses, activeCourses) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var hiddenCoursesMap, visibleCoursesMap, isStudent, edsCourseMap, result;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        hiddenCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return !hc.show; }), function (hc) { return hc.name; });
                        visibleCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return hc.show; }), function (hc) { return hc.name; });
                        isStudent = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.some(function (role) { return role === 'STUDENT'; });
                        edsCourseMap = edsActiveCourses ?
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(edsActiveCourses, function (c) { return c.name; }) :
                            {};
                        return [4 /*yield*/, Promise.all(activeCourses.map(function (_a) {
                                var id = _a.id, name = _a.name, description = _a.description, modifiedBy = _a.modifiedBy;
                                return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                                    var edsCourse, defaultVisible, visible;
                                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                        edsCourse = edsCourseMap[name];
                                        defaultVisible = isStudent ?
                                            edsCourse != null : // Course name also listed in EDS
                                            true;
                                        visible = defaultVisible ?
                                            !hiddenCoursesMap[id] : // Visible unless user has overridden that.
                                            !!visibleCoursesMap[id];
                                        // Resolve description:
                                        if (modifiedBy && modifiedBy.name && !description) {
                                            description = modifiedBy.name + "s version";
                                        }
                                        return [2 /*return*/, {
                                                id: id,
                                                name: name,
                                                description: description,
                                                visible: visible,
                                                defaultVisible: defaultVisible
                                            }];
                                    });
                                });
                            }))];
                    case 1:
                        result = _a.sent();
                        return [2 /*return*/, result.sort(function (_a, _b) {
                                var a = _a.name;
                                var b = _b.name;
                                return a < b ? -1 : a > b ? 1 : 0;
                            })];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.hideCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                    name: c.id
                                }])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.showCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.insert([{
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                name: c.id,
                                show: true
                            }])];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.subscribe = function (subscriber, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, activeCourses, edsActiveCourses, userHiddenCourses, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!(!this.fullCourse && options.fullCourse)) return [3 /*break*/, 3];
                        // The subscriber demands full courses
                        // Need to query that before notifying
                        // Also affect state for future internal notification
                        this.fullCourse = options.fullCourse;
                        this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses
                        return [4 /*yield*/, Promise.all([
                                this.kedCoursesPromise,
                                this.edsCoursesPromise,
                                this.userHiddenCoursesPromise
                            ])];
                    case 1:
                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 3]), activeCourses = _a[0], edsActiveCourses = _a[1], userHiddenCourses = _a[2];
                        // Assemble result:
                        _b = this;
                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                    case 2:
                        // Assemble result:
                        _b.result = _c.sent();
                        _c.label = 3;
                    case 3: return [4 /*yield*/, this.userHiddenCoursesPromise];
                    case 4:
                        _c.sent(); // So we know that this.result is there.
                        this.notifySubscriber(subscriber, options);
                        this.subscribers.push({ subscriber: subscriber, options: options });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s.subscriber !== subscriber; });
    };
    return HiddenCoursesRepo;
}());
if (!hiddenCoursesRepo) {
    hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo = new HiddenCoursesRepo();
}


/***/ }),

/***/ "./src/repos/ked-repo.ts":
/*!*******************************!*\
  !*** ./src/repos/ked-repo.ts ***!
  \*******************************/
/*! exports provided: KedRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedRepo", function() { return KedRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");



var KedRepo = /** @class */ (function () {
    function KedRepo(options) {
        var _this = this;
        var table = options.table, getClient = options.getClient, getQueryOptions = options.getQueryOptions;
        this.mem = new _repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]({ query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var queryOptions;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, getQueryOptions()];
                        case 1:
                            queryOptions = _a.sent();
                            return [4 /*yield*/, getClient().list(table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, queryOptions, { cacheBust: this.getCacheBust() }))];
                        case 2: return [2 /*return*/, _a.sent()];
                    }
                });
            }); } });
        this.options = options;
    }
    KedRepo.prototype.getCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);
        return cacheBust || this.regenerateCacheBust();
    };
    KedRepo.prototype.regenerateCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
        localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);
        return cacheBust;
    };
    KedRepo.prototype.upsert = function (item, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItem;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!!item.$etag) return [3 /*break*/, 2];
                        updatedItem = Object.assign({}, item);
                        updater(updatedItem);
                        return [4 /*yield*/, this.insert([updatedItem])];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2: 
                    // We have an $etag, so we can expect it to live on the server.
                    // However, take care of the unlikely situation that it was deleted from server,
                    // and if so, insert it again.
                    return [4 /*yield*/, this.update([item], updater).catch(function (e) {
                            if (e.name === "http404") {
                                var updatedItem = Object.assign({}, item);
                                updater(updatedItem);
                                return _this.insert([updatedItem]);
                            }
                            return Promise.reject(e);
                        })];
                    case 3:
                        // We have an $etag, so we can expect it to live on the server.
                        // However, take care of the unlikely situation that it was deleted from server,
                        // and if so, insert it again.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.update = function (items, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItems, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItems = items.map(function (item) {
                            var memRepoItem = _this.mem.items.find(function (it) { return it.id === item.id; });
                            item = Object.assign({}, memRepoItem || item);
                            updater(item);
                            return item;
                        });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(modifiedItems.map(function (x) { return Object.assign({}, x, { $meta: 'updating' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); })
                            .catch(function (e) { return e.name === "http409" ? // conflict
                            // Get a fresh version from server:
                            client.list(table, { ids: items.map(function (item) { return item.id; }) }, { cache: 'no-cache' }).then(function (freshItems) {
                                // Update local version:
                                var modifiedItems = freshItems.map(function (freshItem) {
                                    // Clone the fresh item
                                    var modified = Object.assign({}, freshItem);
                                    // Re-run the updater on the clone:
                                    updater(modified);
                                    return modified;
                                });
                                // Re-do the the put operation towards the server.
                                return client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); });
                            }) :
                            // Other unexpected error:
                            Promise.resolve(optimistic &&
                                _this.mem.update(items)) // Undo optimistic update
                                .then(function () {
                                return Promise.reject(e); // Reject with the error no matter.
                            }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        modifiedItems.forEach(function (item) {
                            item.$etag = res.newEtags[item.id];
                            item.$meta = undefined;
                        });
                        return [4 /*yield*/, this.mem.update(modifiedItems)];
                    case 4:
                        _b.sent(); // Ensures new etag is is applied on next action.
                        return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.stripGraphs = function (items, graphs) {
        return items.map(function (item) {
            var clone = Object.assign({}, item);
            graphs.forEach(function (graph) {
                if (item[graph]) {
                    clone[graph] = item[graph].map(function (doc) { return ({ id: doc.id }); });
                }
            });
            return clone;
        });
    };
    KedRepo.prototype.insert = function (items) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, getQueryOptions, client, queryOptions, graphs, stripped, br, _loop_1, stripped_1, stripped_1_1, item, res;
            var e_1, _b;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table, getQueryOptions = _a.getQueryOptions;
                        client = getClient();
                        return [4 /*yield*/, getQueryOptions()];
                    case 1:
                        queryOptions = _c.sent();
                        graphs = [].concat(queryOptions.include);
                        // Give IDs to each item:
                        items = items.map(function (item) { return item.id ? item : Object.assign({}, item, { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])() }); });
                        stripped = this.stripGraphs(items, graphs);
                        if (!optimistic) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.mem.insert(stripped.map(function (x) { return Object.assign({}, x, { $meta: 'adding' }); }))];
                    case 2:
                        _c.sent();
                        _c.label = 3;
                    case 3:
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
                        _loop_1 = function (item) {
                            var e_2, _a;
                            var _loop_2 = function (graph) {
                                var foreignItems = item[graph];
                                if (foreignItems) {
                                    foreignItems.forEach(function (doc) {
                                        br.link2(table, item.id, graph, doc.id);
                                    });
                                }
                            };
                            try {
                                // Also add links to all foreign related items:
                                for (var graphs_1 = (e_2 = void 0, tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs)), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
                                    var graph = graphs_1_1.value;
                                    _loop_2(graph);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                            br.add(table, item);
                        };
                        try {
                            for (stripped_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](stripped), stripped_1_1 = stripped_1.next(); !stripped_1_1.done; stripped_1_1 = stripped_1.next()) {
                                item = stripped_1_1.value;
                                _loop_1(item);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (stripped_1_1 && !stripped_1_1.done && (_b = stripped_1.return)) _b.call(stripped_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        return [4 /*yield*/, client.batch(br.mutationRequests).catch(function (e) {
                                if (optimistic)
                                    _this.mem.delete(items.map(function (item) { return item.id; }));
                                return Promise.reject(e);
                            })];
                    case 4:
                        res = _c.sent();
                        this.regenerateCacheBust();
                        items.forEach(function (item) { return item.$etag = res.newEtags[item.id]; });
                        if (!optimistic) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.mem.update(items)];
                    case 5:
                        _c.sent(); // Update with new $etag.
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.mem.insert(items)];
                    case 7:
                        _c.sent();
                        _c.label = 8;
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.delete = function (ids) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(ids
                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                .filter(function (x) { return x; })
                                .map(function (x) { return Object.assign({}, x, { $meta: 'deleting' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return ids.forEach(function (id) { return br.delete(table, id); }); }).catch(function (e) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        if (!optimistic) return [3 /*break*/, 2];
                                        return [4 /*yield*/, this.mem.update(ids
                                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                                .filter(function (x) { return x; })
                                                .map(function (x) {
                                                x = Object.assign({}, x);
                                                delete x.$meta;
                                                return x;
                                            }))];
                                    case 1:
                                        _a.sent();
                                        _a.label = 2;
                                    case 2: throw e;
                                }
                            });
                        }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        return [4 /*yield*/, this.mem.delete(ids)];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedRepo;
}());



/***/ }),

/***/ "./src/repos/kg-termplanner-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/kg-termplanner-repo.ts ***!
  \******************************************/
/*! exports provided: KGTermPlannerRepo, termPlannerRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KGTermPlannerRepo", function() { return KGTermPlannerRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "termPlannerRepo", function() { return termPlannerRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");




var KGTermPlannerRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KGTermPlannerRepo, _super);
    function KGTermPlannerRepo(getClient, getCurrentUser) {
        var _this = this;
        var currentUser = getCurrentUser();
        var now = new Date();
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_3__["getTermStarEndDate"])(now, now.getMonth() >= 7), 2), termStart = _a[0], termEnd = _a[1];
        _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "weekplans",
            user: currentUser ? currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    return [2 /*return*/, {
                            from: termStart.startOf('week').add(-2, 'days').toDate().valueOf(),
                            to: termEnd.startOf('week').add(5, 'days').toDate().valueOf(),
                            role: "USER"
                        }];
                });
            }); }
        }) || this;
        return _this;
    }
    return KGTermPlannerRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

var termPlannerRepo = new KGTermPlannerRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser; });
_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kgTermPlannerRepo = termPlannerRepo;


/***/ }),

/***/ "./src/repos/ks-termplanner-repo-instance.ts":
/*!***************************************************!*\
  !*** ./src/repos/ks-termplanner-repo-instance.ts ***!
  \***************************************************/
/*! exports provided: termPlannerRepoKS */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "termPlannerRepoKS", function() { return termPlannerRepoKS; });
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _ks_termplanner_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ks-termplanner-repo */ "./src/repos/ks-termplanner-repo.ts");


var termPlannerRepoKS = new _ks_termplanner_repo__WEBPACK_IMPORTED_MODULE_1__["KSTermPlannerRepo"](function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser; });
_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].ksTermPlannerRepo = termPlannerRepoKS;


/***/ }),

/***/ "./src/repos/ks-termplanner-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/ks-termplanner-repo.ts ***!
  \******************************************/
/*! exports provided: KSTermPlannerRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KSTermPlannerRepo", function() { return KSTermPlannerRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);



var KSTermPlannerRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KSTermPlannerRepo, _super);
    function KSTermPlannerRepo(getClient, getCurrentUser) {
        var _this = this;
        var currentUser = getCurrentUser();
        _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "weekplans-ks",
            user: currentUser ? currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var startDateValue, endDateValue;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    startDateValue = (this.startDate && this.startDate.valueOf()) || moment__WEBPACK_IMPORTED_MODULE_2___default()().valueOf();
                    endDateValue = (this.endDate && this.endDate.valueOf()) || moment__WEBPACK_IMPORTED_MODULE_2___default()().valueOf();
                    return [2 /*return*/, {
                            from: startDateValue,
                            to: endDateValue,
                            role: "USER"
                        }];
                });
            }); }
        }) || this;
        return _this;
    }
    KSTermPlannerRepo.prototype.refreshData = function (dateInterval) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](dateInterval, 2), this.startDate = _a[0], this.endDate = _a[1];
                        return [4 /*yield*/, this.mem.refreshFromServer()];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KSTermPlannerRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));



/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/user-tasks-repo.ts":
/*!**************************************!*\
  !*** ./src/repos/user-tasks-repo.ts ***!
  \**************************************/
/*! exports provided: userTasksRepo, UserTasksRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "userTasksRepo", function() { return userTasksRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksRepo", function() { return UserTasksRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/weekplanner/weekplanner-persisted-state */ "./src/components/weekplanner/weekplanner-persisted-state.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/weekutil */ "./src/utils/weekutil.ts");







var userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo;
var UserTasksRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksRepo, _super);
    function UserTasksRepo(getClient, getCurrentUser) {
        var _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "usertasks",
            user: getCurrentUser() ? getCurrentUser().mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var currentUser, userEmail, _a, weekDate, weekNumber, kedWeek;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            currentUser = getCurrentUser();
                            userEmail = currentUser ? currentUser.mail : "";
                            if (!!this.persistedState) return [3 /*break*/, 2];
                            _a = this;
                            return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(userEmail)];
                        case 1:
                            _a.persistedState = _b.sent();
                            _b.label = 2;
                        case 2:
                            weekDate = this.persistedState.weekDate;
                            weekNumber = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).week();
                            kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_6__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).year(), weekNumber);
                            /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]
                              .map(m => m.toDate().getTime());*/
                            return [2 /*return*/, {
                                    from: kedWeek.notBefore,
                                    to: kedWeek.notAfter,
                                    role: "USER",
                                    include: ["task", "course"],
                                    flags: ["includeIdsOnly"],
                                }];
                    }
                });
            }); }
        }) || this;
        _this.persistedState = null;
        _this.getCurrentUser = getCurrentUser;
        return _this;
    }
    UserTasksRepo.prototype.updatePersistedState = function (stateChanges) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object.assign(this.persistedState, stateChanges);
                        return [4 /*yield*/, this.persistedState.save()];
                    case 1:
                        _a.sent();
                        this.mem.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setTaskDoneState = function (userTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItem, similarTasks, identicalTasks;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItem = Object.assign({}, userTask, { done: done });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(Object.assign({}, modifiedItem, { $meta: 'updating' }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.list('usertasks', {
                            name: userTask.name,
                            role: "USER",
                            include: ["task", "course"],
                            flags: ["includeIdsOnly"],
                            from: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),
                            to: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(3, 'weeks').valueOf()
                        }, {
                            cache: 'no-cache'
                        })];
                    case 3:
                        similarTasks = _b.sent();
                        identicalTasks = similarTasks.filter(function (t) {
                            return t.courseName === userTask.courseName &&
                                t.learningGoal === userTask.learningGoal &&
                                (!userTask.task || t.task.map(function (t) { return t.id; }).join('') === userTask.task.map(function (t) { return t.id; }).join('')) &&
                                (!userTask.course || t.course.map(function (c) { return c.id; }).join('') === userTask.course.map(function (c) { return c.id; }).join(''));
                        });
                        if (identicalTasks.length === 0) {
                            // Workaround for issue in SubjectPlanner migration (usertasks with long names is not found)
                            identicalTasks.push(userTask);
                        }
                        return [4 /*yield*/, this.update(identicalTasks, function (t) { return t.done = done; })];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setSubTaskDoneState = function (userTask, subTaskId, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        return [4 /*yield*/, this.update([userTask], function (t) { return t.subTasks && t.subTasks.filter(function (st) { return st.id === subTaskId; })
                                .forEach(function (st) { return st.done = done; }); })];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setWeekPlannerBoxOpen = function (courseName, isOpen) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var openCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        openCourses = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.persistedState.openCourses);
                        if (isOpen)
                            openCourses[courseName] = true;
                        else
                            delete openCourses[courseName];
                        return [4 /*yield*/, this.updatePersistedState({ openCourses: openCourses })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.changeWeek = function (weekDate, keepCurrentDate) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedState, newPersisted;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        persistedState = this.persistedState;
                        if (!!persistedState) return [3 /*break*/, 2];
                        return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(this.options.user)];
                    case 1:
                        persistedState = _a.sent();
                        _a.label = 2;
                    case 2:
                        newPersisted = new _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"](persistedState);
                        newPersisted.weekDate = keepCurrentDate ? moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).valueOf() : moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).startOf('week').valueOf();
                        newPersisted.save();
                        this.persistedState = newPersisted;
                        return [4 /*yield*/, this.mem.refreshFromServer()];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.subscribe = function (subscriber) {
        var _this = this;
        var proxySubscriber = function (userTasks) {
            subscriber(userTasks.filter(function (ut) { return !ut.weekTexts; }), _this.persistedState, userTasks.filter(function (ut) { return !!ut.weekTexts; })[0] || {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                dateTime: _this.persistedState.weekDate,
                weekTexts: { assessment: '', strategy: '' },
                acl: [
                    // Default ACL: Let user self have full control over this item:
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("email", _this.getCurrentUser().mail, "S"),
                    // Additional ACL: Let employees on same school have read access to it.
                    // This currently only applies to tasks that refer to course tasks (not own tasks!)
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", _this.getCurrentUser().school + "/EMPLOYEE", "R")
                ].map(function (ac) { return ac.toString(); })
            });
        };
        proxySubscriber["subscriber"] = subscriber;
        this.mem.subscribe(proxySubscriber);
    };
    UserTasksRepo.prototype.unsubscribe = function (subscriber) {
        this.mem.subscribers = this.mem.subscribers.filter(function (s) { return s["subscriber"] !== subscriber; });
    };
    return UserTasksRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

if (!userTasksRepo) {
    userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo = new UserTasksRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser; });
    userTasksRepo.mem.ensureHasData();
}


/***/ }),

/***/ "./src/repos/week-notes-repo.ts":
/*!**************************************!*\
  !*** ./src/repos/week-notes-repo.ts ***!
  \**************************************/
/*! exports provided: weekNotesRepo, WeekNotesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "weekNotesRepo", function() { return weekNotesRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekNotesRepo", function() { return WeekNotesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");



var weekNotesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].weekNotesRepo;
var WeekNotesRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekNotesRepo, _super);
    /*private currentWeek: moment.Moment;
  
    getCurrentWeek() {
      if (!this.currentWeek) {
        const {weekMillis, expire} = JSON.parse(sessionStorage.getItem("week-notes-week") || "{}") as {weekMillis?: number, expire?: number};
        this.currentWeek = weekMillis && expire && expire > Date.now() ?
          moment(new Date(weekMillis)) :
          moment().startOf('week').add(1, 'days');
      }
      return this.currentWeek.clone();
    }
  
    setCurrentWeek(newWeekMoment: moment.Moment) {
      this.currentWeek = newWeekMoment;
      sessionStorage.setItem("week-notes-week", JSON.stringify({
        weekMillis: newWeekMoment.toDate().getTime(),
        expire: moment().add(8, "hours").toDate().getTime()
      }))
    }*/
    function WeekNotesRepo() {
        var _this = _super.call(this, {
            getClient: function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; },
            optimistic: false,
            table: "notes",
            user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    //const userEmail = env.currentUser ? env.currentUser.mail : "";
                    //const currentWeek = this.getCurrentWeek();
                    //const weekNumber = currentWeek.week();
                    //const kedWeek = KEDWeek(currentWeek.year(), weekNumber);
                    return [2 /*return*/, {
                            //from: kedWeek.notBefore,
                            //to: kedWeek.notAfter,
                            role: "USER"
                        }];
                });
            }); }
        }) || this;
        return _this;
        //this.currentWeek = null;
    }
    return WeekNotesRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

if (!weekNotesRepo) {
    weekNotesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].weekNotesRepo = new WeekNotesRepo();
}


/***/ }),

/***/ "./src/translations/en.json":
/*!**********************************!*\
  !*** ./src/translations/en.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, addeditsubtask.addSubtask, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalPrimarySchoolTitle, customTask.addWorkGoalGymnasiumSchoolTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.ict, termplanner.loadingTermplanner, termplanner.maths, termplanner.modernLanguage, termplanner.noFinalStepAvailable, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, termplanner.yoga, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.primarySchoolGoals, userTasks.gymnasiumSchoolGoals, weekNotebook.title, weekplanner.addLearningGoalGymnasiumSchool, weekplanner.addLearningGoalPrimarySchool, weekplanner.addLearningGoalPrimarySchoolTitle, weekplanner.addLearningGoalGymnasiumSchoolTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoalPrimary, weekplanner.learningGoalGymnasium, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"addeditsubtask.deleteSubtask\":\"Delete subtask\",\"addeditsubtask.editSubtask\":\"Edit subtask\",\"addeditsubtask.nameLabel\":\"Name of subtask\",\"addeditsubtask.addSubtask\":\"Add sub-task\",\"calendar.currentDate\":\"Week {week}, {year}\",\"calendar.fullDayEventLocation\":\"Place: {location}\",\"calendar.loadCalendarEvents\":\"Load calendar events...\",\"calendar.loadingCalendar\":\"Loading calendars... (listing...)\",\"calendar.weekNumber\":\"W{weekNumber}\",\"common.addDescriptionPlhd\":\"Add description...\",\"common.cancel\":\"Cancel\",\"common.changesNotSavedErrorOccured\":\"An error occured while saving data. Your changes were not saved.\",\"common.changesNotSavedUnauthorized\":\"The changes were not saved due to insufficient authority\",\"common.descriptionLabel\":\"Description\",\"common.errorSavingData\":\"An error occured while saving data.\",\"common.linkLabel\":\"Link\",\"common.loading\":\"Loading...\",\"common.nameLabel\":\"Name\",\"common.save\":\" Save\",\"common.saved\":\" Saved\",\"common.saving\":\"Saving\",\"common.remove\":\"Delete\",\"customTask.addWorkGoalPrimarySchoolTitle\":\"Add own working goal\",\"customTask.addWorkGoalGymnasiumSchoolTitle\":\"Add own working goal\",\"customTask.enterNamePlhd\":\"Enter Name...\",\"learningGoalsLost.overall\":\"Overall\",\"task.addSubtask\":\"Add subtask\",\"task.editTask\":\"Edit task\",\"task.editWorkGoals\":\"Edit working goal\",\"task.enterTaskNamePlhd\":\"Enter the name of task...\",\"task.removeDeadline\":\"Delete deadline\",\"task.removeThisTask\":\"Delete this task\",\"task.removeWorkGoals\":\"Delete working goal\",\"task.setDeadline\":\"Set deadline\",\"task.setDeadlineLabel\":\"Set deadline...\",\"task.subTasks\":\"Subtasks\",\"task.targetNameLabel\":\"Name of working goal\",\"task.taskNameLabel\":\"Name of task\",\"task.whatShouldYouDoPlhd\":\"What should you do?\",\"taskList.nextWeekTask\":\"for next week (w{week})\",\"taskList.lastWeekTask\":\"for last week (w{week})\",\"taskList.currentWeekTask\":\"for week {week}\",\"taskList.removeTaskFromWeeklyPlanning\":\"Delete task from your weekly planning {week}\",\"taskList.addTaskToWeeklyPlanning\":\"Add task to your weekly planning {week}\",\"termplanner.comments\":\"Comments\",\"termplanner.course\":\"Theme course\",\"termplanner.edsGoalGrades\":\"Intermediate goals\",\"termplanner.englishLanguage\":\"Eng\",\"termplanner.finalStep\":\"Final Step\",\"termplanner.firstTerm\":\"FT {year}\",\"termplanner.hindiLanguage\":\"Hindi\",\"termplanner.ict\":\"ICT\",\"termplanner.loadingTermplanner\":\"Loading Termplanner\",\"termplanner.maths\":\"Maths\",\"termplanner.modernLanguage\":\"MFL\",\"termplanner.noFinalStepAvailable\":\"No final step available\",\"termplanner.secondTerm\":\"ST {year}\",\"termplanner.termPlanning\":\"Term planner\",\"termplanner.weekNumber\":\"Week\",\"termplanner.chartsBoxTitle\":\"Progress Charts\",\"termplanner.yoga\":\"Yoga\",\"tutorNoteDialog.weekComment\":\"Note for week {weekNumber}\",\"test.chooseComponentLabel\":\"Component\",\"test.pageDescription\":\"Test page for the components on the starting page\",\"userTasks.addLearningGoal\":\"Own working goal\",\"userTasks.deleteLearningGoal\":\"Delete learning goal and its tasks\",\"userTasks.primarySchoolGoals\":\"Own learning goal\",\"userTasks.gymnasiumSchoolGoals\":\"Own learning goal\",\"weekNotebook.title\":\"Notepad\",\"weekplanner.addLearningGoalGymnasiumSchool\":\"Goal:\",\"weekplanner.addLearningGoalPrimarySchool\":\"Goal:\",\"weekplanner.addLearningGoalPrimarySchoolTitle\":\"Add own learning goal\",\"weekplanner.addLearningGoalGymnasiumSchoolTitle\":\"Add own learning goal\",\"weekplanner.confirmRemoveLearningObjectives\":\"Delete learning goal and {learningGoalsNumber} tasks?\",\"weekplanner.copyPreviousWeekTaks\":\"Copy from previous week\",\"weekplanner.emptyLearningGoalErr\":\"The learning goal cannot be empty\",\"weekplanner.evaluation\":\"Evaluation\",\"weekplanner.evaluationDescription\":\"Reflection on your work effort and your chosen strategies during the week. Evaluate in relation to your goals.\",\"weekplanner.learningGoalPrimary\":\"Own learning goal\",\"weekplanner.learningGoalGymnasium\":\"Own learning goal\",\"weekplanner.logBook\":\"Logbook\",\"weekplanner.nameCannotBeEmpty\":\"Name cannot be empty\",\"weekplanner.nameMustNotBeEmpty\":\"Name must not be empty\",\"weekplanner.strategy\":\"Strategy\",\"weekplanner.strategyAndEvaluation\":\"Strategy & Evaluation\",\"weekplanner.strategyDescription\":\"What I should do to learn\",\"weekplanner.weekNumber\":\"Week {weekNumber}\",\"wysiwyg.bold\":\"Bold\",\"wysiwyg.code\":\"Code\",\"wysiwyg.heading1\":\"Heading 1\",\"wysiwyg.heading2\":\"Heading 2\",\"wysiwyg.heading3\":\"Heading 3\",\"wysiwyg.image\":\"Insert image\",\"wysiwyg.imagePromptMsg\":\"Enter the URL of the image\",\"wysiwyg.italic\":\"Italics\",\"wysiwyg.line\":\"Horizontal line\",\"wysiwyg.link\":\"Insert link\",\"wysiwyg.olist\":\"Ordered list\",\"wysiwyg.paragraph\":\"Paragraph\",\"wysiwyg.quote\":\"Quote\",\"wysiwyg.strikethrough\":\"Strikethrough\",\"wysiwyg.ulist\":\"Bullet list\",\"wysiwyg.underline\":\"Underline\"}");

/***/ }),

/***/ "./src/translations/sv.json":
/*!**********************************!*\
  !*** ./src/translations/sv.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.addSubtask, addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalPrimarySchoolTitle, customTask.addWorkGoalGymnasiumSchoolTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.swedishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.loadingTermplanner, termplanner.modernLanguageFullname, termplanner.mathsFullname, termplanner.noFinalStepAvailable, termplanner.swedishLanguageFullName, termplanner.englishLanguageFullName, termplanner.maths, termplanner.modernLanguage, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.chartsBoxTitle, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.primarySchoolGoals, userTasks.gymnasiumSchoolGoals, weekNotebook.title, weekplanner.addLearningGoalGymnasiumSchool, weekplanner.addLearningGoalPrimarySchool, weekplanner.addLearningGoalPrimarySchoolTitle, weekplanner.addLearningGoalGymnasiumSchoolTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoalPrimary, weekplanner.learningGoalGymnasium, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = JSON.parse("{\"addeditsubtask.addSubtask\":\"Lgg till underuppgift\",\"addeditsubtask.deleteSubtask\":\"Ta bort underuppgift\",\"addeditsubtask.editSubtask\":\"Redigera underuppgift\",\"addeditsubtask.nameLabel\":\"Underuppgiftens namn\",\"calendar.currentDate\":\"Vecka {week}, {year}\",\"calendar.fullDayEventLocation\":\"Plats: {location}\",\"calendar.loadCalendarEvents\":\"Load calendar events...\",\"calendar.loadingCalendar\":\"Loading calendars... (listing...)\",\"calendar.weekNumber\":\"V{weekNumber}\",\"common.addDescriptionPlhd\":\"Lgg till en beskrivning...\",\"common.cancel\":\"Avbryt\",\"common.changesNotSavedErrorOccured\":\"Fr tillfllet problem att spara data. Dina ndringar sparades inte.\",\"common.changesNotSavedUnauthorized\":\"ndringarna sparades inte p.g.a. otillrcklig behrighet.\",\"common.descriptionLabel\":\"Beskrivning\",\"common.errorSavingData\":\"Kunde inte spara.\",\"common.linkLabel\":\"Lnk\",\"common.loading\":\"Laddar...\",\"common.nameLabel\":\"Namn\",\"common.save\":\" Spara\",\"common.saved\":\" Sparad\",\"common.saving\":\"Sparar...\",\"common.remove\":\"Ta bort\",\"customTask.addWorkGoalPrimarySchoolTitle\":\"Lgg till eget arbetsml\",\"customTask.addWorkGoalGymnasiumSchoolTitle\":\"Lgg till uppgift\",\"customTask.enterNamePlhd\":\"Ange namn...\",\"learningGoalsLost.overall\":\"vergripande\",\"task.addSubtask\":\"Lgg till underuppgift\",\"task.editTask\":\"Redigera uppgift\",\"task.editWorkGoals\":\"Redigera arbetsml\",\"task.enterTaskNamePlhd\":\"Ange uppgiftens namn...\",\"task.removeDeadline\":\"Ta bort deadline\",\"task.removeThisTask\":\"Ta bort den hr uppgiften\",\"task.removeWorkGoals\":\"Ta bort arbetsml\",\"task.setDeadline\":\"Set deadline\",\"task.setDeadlineLabel\":\"Ange deadline...\",\"task.subTasks\":\"Underuppgifter\",\"task.targetNameLabel\":\"Arbetsmlets namn\",\"task.taskNameLabel\":\"Uppgiftens namn\",\"task.whatShouldYouDoPlhd\":\"Vad ska du gra?\",\"taskList.nextWeekTask\":\"fr nsta vecka (v{week})\",\"taskList.lastWeekTask\":\"fr frra veckan (v{week})\",\"taskList.currentWeekTask\":\"fr vecka {week}\",\"taskList.removeTaskFromWeeklyPlanning\":\"Ta bort uppgiften frn egen veckoplanering {week}\",\"taskList.addTaskToWeeklyPlanning\":\"Lgg till uppgiften i egen veckoplanering {week}\",\"termplanner.comments\":\"Kommentar\",\"termplanner.course\":\"Kurs\",\"termplanner.edsGoalGrades\":\"Terminsml\",\"termplanner.englishLanguage\":\"Eng\",\"termplanner.swedishLanguage\":\"Sv/SvA\",\"termplanner.finalStep\":\"Slutsteg\",\"termplanner.firstTerm\":\"HT {year}\",\"termplanner.hindiLanguage\":\"\",\"termplanner.loadingTermplanner\":\"V.g. vnta medan terminsplaner laddas...\",\"termplanner.modernLanguageFullname\":\"M.sprk\",\"termplanner.mathsFullname\":\"Matematik\",\"termplanner.noFinalStepAvailable\":\"Inget slutsteg tillgngligt\",\"termplanner.swedishLanguageFullName\":\"Svenska\",\"termplanner.englishLanguageFullName\":\"Engelska\",\"termplanner.maths\":\"Ma\",\"termplanner.modernLanguage\":\"M.spr\",\"termplanner.secondTerm\":\"VT {year}\",\"termplanner.termPlanning\":\"Terminsplanering\",\"termplanner.weekNumber\":\"Vecka\",\"termplanner.chartsBoxTitle\":\"Min progression\",\"tutorNoteDialog.weekComment\":\"Kommentar fr vecka {weekNumber}\",\"test.chooseComponentLabel\":\"Komponent\",\"test.pageDescription\":\"Testsida fr komponenter till nya startsidan\",\"userTasks.addLearningGoal\":\"Eget arbetsml\",\"userTasks.deleteLearningGoal\":\"Ta bort lrandemlet och dess uppgifter\",\"userTasks.primarySchoolGoals\":\"Egna lrandeml\",\"userTasks.gymnasiumSchoolGoals\":\"vriga uppgifter\",\"weekNotebook.title\":\"Anteckningar\",\"weekplanner.addLearningGoalGymnasiumSchool\":\"Rubrik:\",\"weekplanner.addLearningGoalPrimarySchool\":\"Ml:\",\"weekplanner.addLearningGoalPrimarySchoolTitle\":\"Lgg till eget lrandeml\",\"weekplanner.addLearningGoalGymnasiumSchoolTitle\":\"Lgg till rubrik\",\"weekplanner.confirmRemoveLearningObjectives\":\"Ta bort lrandeml samt {learningGoalsNumber} uppgifter?\",\"weekplanner.copyPreviousWeekTaks\":\"Kopiera ej klara frn fregende vecka\",\"weekplanner.emptyLearningGoalErr\":\"Lrandemlet kan inte vara tomt\",\"weekplanner.evaluation\":\"Utvrdering\",\"weekplanner.evaluationDescription\":\"Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utvrdera i frhllande till dina ml.\",\"weekplanner.learningGoalPrimary\":\"Eget lrandeml\",\"weekplanner.learningGoalGymnasium\":\"Uppgift\",\"weekplanner.logBook\":\"Loggbok\",\"weekplanner.nameCannotBeEmpty\":\"Namnet kan inte vara tomt\",\"weekplanner.nameMustNotBeEmpty\":\"Namnet fr inte vara tomt\",\"weekplanner.strategy\":\"Strategi\",\"weekplanner.strategyAndEvaluation\":\"Strategi & Utvrdering\",\"weekplanner.strategyDescription\":\"Hur jag ska gra fr att lra mig.\",\"weekplanner.weekNumber\":\"Vecka {weekNumber}\",\"wysiwyg.bold\":\"Fetstil\",\"wysiwyg.code\":\"Programkod\",\"wysiwyg.heading1\":\"Rubrik 1\",\"wysiwyg.heading2\":\"Rubrik 2\",\"wysiwyg.heading3\":\"Rubrik 3\",\"wysiwyg.image\":\"Infoga bild\",\"wysiwyg.imagePromptMsg\":\"Ange bildens URL\",\"wysiwyg.italic\":\"Kursiv\",\"wysiwyg.line\":\"Vgrt linje\",\"wysiwyg.link\":\"Infoga lnk\",\"wysiwyg.olist\":\"Ordnad lista\",\"wysiwyg.paragraph\":\"Paragraf\",\"wysiwyg.quote\":\"Citat\",\"wysiwyg.strikethrough\":\"Struken\",\"wysiwyg.ulist\":\"Punktlista\",\"wysiwyg.underline\":\"Understruken\"}");

/***/ }),

/***/ "./src/utils/constants.js":
/*!********************************!*\
  !*** ./src/utils/constants.js ***!
  \********************************/
/*! exports provided: SECOND, MINUTE, HOUR */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SECOND", function() { return SECOND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MINUTE", function() { return MINUTE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HOUR", function() { return HOUR; });

const SECOND = 1000;
const MINUTE = SECOND * 60;
const HOUR = MINUTE * 60;



/***/ }),

/***/ "./src/utils/generic-school-term.ts":
/*!******************************************!*\
  !*** ./src/utils/generic-school-term.ts ***!
  \******************************************/
/*! exports provided: GenericSchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GenericSchoolTerm", function() { return GenericSchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _generic_school_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./generic-school-utils */ "./src/utils/generic-school-utils.ts");
/* harmony import */ var _components_ks_termplanner_termplanner_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/ks-termplanner/termplanner-utils */ "./src/components/ks-termplanner/termplanner-utils.ts");



var GenericSchoolTerm = /** @class */ (function () {
    function GenericSchoolTerm(currentDate, currentLocale, academicYearStructure) {
        this.locale = currentLocale || "sv";
        this.selectedDate = currentDate;
        this.schoolMoment = academicYearStructure ? Object(_generic_school_utils__WEBPACK_IMPORTED_MODULE_1__["getCurrentAcademicYear"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(currentDate), academicYearStructure) : null;
    }
    GenericSchoolTerm.prototype.getTermStartAndEnd = function (includeExtraWeek) {
        //In case that the week start date is a date from the previous year
        //Consider the start of the week ( start date) as the day of the 01.01.year
        var startOfTermWeek = this.schoolMoment.academicYearStructure.startDate.clone().startOf('week');
        if (startOfTermWeek.year() < this.schoolMoment.academicYearStructure.startDate.year()) {
            startOfTermWeek = this.schoolMoment.academicYearStructure.startDate;
        }
        var endOfTermWeek = this.schoolMoment.academicYearStructure.endDate;
        if (this.locale === "sv" && includeExtraWeek && this.schoolMoment.term === "ST") {
            endOfTermWeek = endOfTermWeek.clone().add(3, 'weeks').endOf('week');
        }
        else if (includeExtraWeek) {
            if (this.locale != "sv") {
                // for india the end date can be in the middle of the week
                endOfTermWeek = this.schoolMoment.academicYearStructure.endDate.clone();
            }
            endOfTermWeek = this.schoolMoment.academicYearStructure.endDate.clone().add(1, 'week').endOf('week');
        }
        return [startOfTermWeek, endOfTermWeek];
    };
    GenericSchoolTerm.prototype.getFirstAndLastWeekOfTerm = function () {
        return [this.schoolMoment.academicYearStructure.startDate.week(), this.schoolMoment.academicYearStructure.endDate.week()];
    };
    GenericSchoolTerm.prototype.isCurrentWeek = function (dateTime) {
        var termDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(dateTime);
        return termDate.year() === moment__WEBPACK_IMPORTED_MODULE_0___default()().year() && termDate.week() === moment__WEBPACK_IMPORTED_MODULE_0___default()().week();
    };
    GenericSchoolTerm.prototype.getLastStepWeek = function (locale) {
        //TODO: this should be refactored. The generic method should be used
        if (locale === "sv") {
            return this.schoolMoment.term === "ST" ? _components_ks_termplanner_termplanner_utils__WEBPACK_IMPORTED_MODULE_2__["LAST_STEP_SPRING"] : _components_ks_termplanner_termplanner_utils__WEBPACK_IMPORTED_MODULE_2__["LAST_STEP_AUTUMN"];
        }
        return this.schoolMoment.academicYearStructure.endDate.clone().add(1, "week").week();
    };
    GenericSchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        if (this.schoolMoment) {
            var year = this.schoolMoment.academicYearStructure.endDate.year().toString();
            var academicYear = this.schoolMoment.academicYearStructure.academicYear;
            if (shortYear && intl.locale === 'sv') {
                year = year.substr(2);
            }
            else {
                year = academicYear;
            }
            return this.schoolMoment.term === 'AT' ? intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'HT {year}' }, { year: year }) :
                intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'VT {year}' }, { year: year });
        }
        return null;
    };
    GenericSchoolTerm.prototype.nextTerm = function () {
        //switch to next semester, we set the current date as adding 3 months to the end of the current semester
        var endDate = this.schoolMoment ? this.schoolMoment.academicYearStructure.endDate.clone() : moment__WEBPACK_IMPORTED_MODULE_0___default()();
        var nextDate = endDate.add(3, 'months');
        return new GenericSchoolTerm(nextDate.toDate(), this.locale);
    };
    GenericSchoolTerm.prototype.prevTerm = function () {
        //to switch to next semester, we set the current date as subtracting 3 months from the start of the current semester
        var startDate = this.schoolMoment ? this.schoolMoment.academicYearStructure.startDate.clone() : moment__WEBPACK_IMPORTED_MODULE_0___default()();
        var prevDate = startDate.subtract(3, 'months');
        return new GenericSchoolTerm(prevDate.toDate(), this.locale);
    };
    GenericSchoolTerm.prototype.getEdsPeriodName = function () {
        return this.schoolMoment.term === 'AT' ? "HT" : "VT" + this.schoolMoment.academicYearStructure.endDate.year();
    };
    return GenericSchoolTerm;
}());



/***/ }),

/***/ "./src/utils/generic-school-utils.ts":
/*!*******************************************!*\
  !*** ./src/utils/generic-school-utils.ts ***!
  \*******************************************/
/*! exports provided: getCurrentAcademicYear, getSchoolTranslatedSubjects, getSchoolTranslatedSubjectFullname */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCurrentAcademicYear", function() { return getCurrentAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolTranslatedSubjects", function() { return getSchoolTranslatedSubjects; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolTranslatedSubjectFullname", function() { return getSchoolTranslatedSubjectFullname; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

function getCurrentAcademicYear(currentDate, academicYear) {
    var firstTermStartDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(academicYear.firstTerm.startDate));
    var firstTermEndDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(academicYear.firstTerm.endDate));
    var secondTermStartDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(academicYear.secondTerm.startDate));
    var secondTermEndDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(academicYear.secondTerm.endDate));
    var academicPeriod = firstTermStartDate.year().toString().substr(2) + "/" + secondTermEndDate.year().toString().substr(2);
    var holidays = _getTermHolidays(academicYear.holidays, firstTermStartDate, firstTermEndDate);
    if (currentDate < firstTermEndDate) {
        //compute academic week numbers
        var academicStartWeek = 1;
        var academicEndWeek = firstTermEndDate.week() - firstTermStartDate.week();
        //get current term holidays
        return { term: 'AT', academicYearStructure: { academicYear: academicPeriod, startDate: firstTermStartDate, endDate: firstTermEndDate, academicStartWeek: academicStartWeek, academicEndWeek: academicEndWeek, holidays: holidays } };
    }
    //compute the number of first term holidays week numbers
    var numberOfHolidayWeeks = _getHolidayWeeksNumber(holidays);
    //compute academic week numbers
    var academicStartWeek = secondTermStartDate.clone().add(1, 'week').week() - firstTermStartDate.week() - numberOfHolidayWeeks;
    var academicEndWeek = secondTermEndDate.clone().add().add(1, 'week').week() - firstTermStartDate.week() - numberOfHolidayWeeks;
    //get current term holidays
    var holidays = _getTermHolidays(academicYear.holidays, secondTermStartDate, secondTermEndDate);
    return { term: 'ST', academicYearStructure: { academicYear: academicPeriod, startDate: secondTermStartDate, endDate: secondTermEndDate, academicStartWeek: academicStartWeek, academicEndWeek: academicEndWeek, holidays: holidays } };
}
function getSchoolTranslatedSubjects(schoolLocale, intl) {
    var translatedColumns = {};
    //these are fixed for all school locales
    translatedColumns["Kurs"] = intl.formatMessage({ id: "termplanner.course", defaultMessage: "Kurs" });
    translatedColumns["Kommentar"] = intl.formatMessage({ id: "termplanner.comments", defaultMessage: "Kommentar" });
    if (schoolLocale === 'sv') {
        translatedColumns["M.spr"] = intl.formatMessage({ id: "termplanner.modernLanguage", defaultMessage: "M.spr" });
        translatedColumns["Ma"] = intl.formatMessage({ id: "termplanner.maths", defaultMessage: "Ma" });
        translatedColumns["Sv/SvA"] = intl.formatMessage({ id: "termplanner.swedishLanguage", defaultMessage: "Sv/SvA" });
        translatedColumns["Eng"] = intl.formatMessage({ id: "termplanner.englishLanguage", defaultMessage: "Eng" });
    }
    else {
        translatedColumns["MFL"] = intl.formatMessage({ id: "termplanner.modernLanguage", defaultMessage: "MFL" });
        translatedColumns["Ma"] = intl.formatMessage({ id: "termplanner.maths", defaultMessage: "Maths" });
        translatedColumns["Hi"] = intl.formatMessage({ id: "termplanner.hindiLanguage", defaultMessage: "Hindi" });
        translatedColumns["Eng"] = intl.formatMessage({ id: "termplanner.englishLanguage", defaultMessage: "English" });
        translatedColumns["Yoga"] = intl.formatMessage({ id: "termplanner.yoga", defaultMessage: "Yoga" });
        translatedColumns["ICT"] = intl.formatMessage({ id: "termplanner.ict", defaultMessage: "ICT" });
    }
    return translatedColumns;
}
//this is related to charts. It is used only for sv locale
function getSchoolTranslatedSubjectFullname(intl) {
    var translatedColumns = {};
    translatedColumns["M.spr"] = intl.formatMessage({ id: "termplanner.modernLanguageFullname", defaultMessage: "M.sprk" });
    translatedColumns["Ma"] = intl.formatMessage({ id: "termplanner.mathsFullname", defaultMessage: "Matematik" });
    translatedColumns["Sv/SvA"] = intl.formatMessage({ id: "termplanner.swedishLanguageFullName", defaultMessage: "Svenska" });
    translatedColumns["Eng"] = intl.formatMessage({ id: "termplanner.englishLanguageFullName", defaultMessage: "Engelska" });
    return translatedColumns;
}
function _getTermHolidays(holidays, termStartDate, termEndDate) {
    return holidays.filter(function (elem) {
        return moment__WEBPACK_IMPORTED_MODULE_0___default()(elem.startDate).isBetween(termStartDate, termEndDate);
    });
}
function _getHolidayWeeksNumber(holidays) {
    var numberOfWeeks = 0;
    holidays.forEach(function (elem) {
        //the number of weeks is the difference + 1
        numberOfWeeks += moment__WEBPACK_IMPORTED_MODULE_0___default()(elem.endDate).add(1, 'week').week() - moment__WEBPACK_IMPORTED_MODULE_0___default()(elem.startDate).week();
    });
    return numberOfWeeks;
}


/***/ }),

/***/ "./src/utils/if-takes-time.ts":
/*!************************************!*\
  !*** ./src/utils/if-takes-time.ts ***!
  \************************************/
/*! exports provided: ifTakesTime */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ifTakesTime", function() { return ifTakesTime; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function ifTakesTime(ms, task, action) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var timeoutReached, th, rv;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    timeoutReached = false;
                    th = setTimeout(function () {
                        timeoutReached = true;
                        action();
                    }, ms);
                    return [4 /*yield*/, task()];
                case 1:
                    rv = _a.sent();
                    if (!timeoutReached)
                        clearTimeout(th);
                    return [2 /*return*/, rv];
            }
        });
    });
}


/***/ }),

/***/ "./src/utils/make-suspense-api.ts":
/*!****************************************!*\
  !*** ./src/utils/make-suspense-api.ts ***!
  \****************************************/
/*! exports provided: makeSuspenseApi */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeSuspenseApi", function() { return makeSuspenseApi; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var DEFAULT_CACHE_EXPIRATION = 30 * 60 * 1000; // 30 minutes.
var defaultOptions = {
    isApiMethod: function (f) { return typeof f === 'function'; },
    cacheExpiration: DEFAULT_CACHE_EXPIRATION
};
function makeSuspenseApi(api, options) {
    if (options === void 0) { options = defaultOptions; }
    options = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultOptions, options);
    var isApiMethod = options.isApiMethod, cacheExpiration = options.cacheExpiration;
    var rv = Object.create(api);
    var cache = {};
    // Walk the instance + prototype chain to generate suspense version of each promise returning method
    for (var proto = api; proto && proto !== Object.prototype; proto = Object.getPrototypeOf(proto)) {
        suspendify(proto);
    }
    function suspendify(proto) {
        Object.keys(proto).forEach(function (prop) {
            if (!rv.hasOwnProperty(prop) && isApiMethod(prop)) {
                rv[prop] = function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    var key = JSON.stringify(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([prop], args));
                    var cachedEntry = cache[key];
                    if (cachedEntry !== undefined) {
                        if (cachedEntry.promise)
                            throw cachedEntry.promise;
                        if (cachedEntry.error)
                            throw cachedEntry.error;
                        if (cachedEntry.timeout > Date.now()) {
                            return cachedEntry.value;
                        }
                    }
                    try {
                        var promise = proto[prop].apply(api, args).then(function (result) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, value: result };
                        }).catch(function (error) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                        });
                        cache[key] = { timeout: Date.now() + cacheExpiration, promise: promise };
                        throw promise;
                    }
                    catch (error) {
                        if (error.then)
                            throw error;
                        cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                    }
                };
            }
        });
    }
    return rv;
}


/***/ }),

/***/ "./src/utils/pending-job.ts":
/*!**********************************!*\
  !*** ./src/utils/pending-job.ts ***!
  \**********************************/
/*! exports provided: PendingJob */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PendingJob", function() { return PendingJob; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var PendingJob = /** @class */ (function () {
    function PendingJob(callback) {
        this.timeoutId = null;
        this.cancelled = false;
        this.pending = false;
        this.isJobExecuting = false;
        this.jobCallback = callback;
    }
    PendingJob.prototype.triggerChange = function (throttle) {
        var _this = this;
        if (this.cancelled)
            return;
        this.pending = true;
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = setTimeout(function () { return _this.launchJob(); }, throttle);
    };
    PendingJob.prototype.stop = function () {
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = null;
        this.cancelled = true;
    };
    PendingJob.prototype.launchJob = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.cancelled)
                            return [2 /*return*/];
                        if (!this.pending)
                            return [2 /*return*/];
                        if (this.isJobExecuting)
                            return [2 /*return*/];
                        this.timeoutId = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        this.isJobExecuting = true;
                        this.pending = false;
                        return [4 /*yield*/, this.jobCallback()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.isJobExecuting = false;
                        return [7 /*endfinally*/];
                    case 4:
                        if (!this.pending) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.launchJob()];
                    case 5:
                        _a.sent();
                        _a.label = 6;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    return PendingJob;
}());



/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/request-tutored-tokens.ts":
/*!*********************************************!*\
  !*** ./src/utils/request-tutored-tokens.ts ***!
  \*********************************************/
/*! exports provided: requestTutoredTokens */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "requestTutoredTokens", function() { return requestTutoredTokens; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var _repos_ks_termplanner_repo__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../repos/ks-termplanner-repo */ "./src/repos/ks-termplanner-repo.ts");
/* harmony import */ var _repos_kg_termplanner_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../repos/kg-termplanner-repo */ "./src/repos/kg-termplanner-repo.ts");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");









function requestTutoredTokens(userEmail, displayName) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        function createBearerProvider(client, tokenUrl, query) {
            var bearerPromise = null;
            return {
                getBearer: function () {
                    return bearerPromise || this.refreshBearer();
                },
                refreshBearer: function () {
                    return (bearerPromise = retrieveToken());
                },
            };
            function retrieveToken() {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                    var res, _a, _b, _c;
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                        switch (_d.label) {
                            case 0: return [4 /*yield*/, client.get(tokenUrl, query)];
                            case 1:
                                res = _d.sent();
                                if (!(res.status === 200)) return [3 /*break*/, 3];
                                return [4 /*yield*/, res.json()];
                            case 2: return [2 /*return*/, (_d.sent())];
                            case 3:
                                _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["HttpError"].bind;
                                _b = [void 0, res.status];
                                _c = "Could not retrieve tutor token for " +
                                    userEmail +
                                    ". Error Message: ";
                                return [4 /*yield*/, res.text()];
                            case 4: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["HttpError"], _b.concat([_c + (_d.sent())])))();
                        }
                    });
                });
            }
        }
        var currentUser, bearerProvider, tutoredKedBackendClient, googleTokenProvider, edsClient, tutorEnv;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    currentUser = {
                        mail: userEmail,
                        displayName: displayName,
                        roles: ["USER"],
                        school: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.school,
                        tutorFor: userEmail
                    };
                    bearerProvider = createBearerProvider(_globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.http, "tutor/token", { userEmail: userEmail });
                    tutoredKedBackendClient = new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBackendClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_5__["isomorphic"], bearerProvider, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["default"].KED_API_URL);
                    googleTokenProvider = createBearerProvider(tutoredKedBackendClient.http, "tutor/convert-token/google");
                    edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_4__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_5__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["default"].EDS_API_URL, bearerProvider, function () { return userEmail; });
                    tutorEnv = {
                        currentUser: currentUser,
                        bearerProvider: bearerProvider,
                        edsClient: edsClient,
                        googleTokenProvider: googleTokenProvider,
                        kedBackendClient: tutoredKedBackendClient,
                        tutored: true
                    };
                    tutorEnv.ksTermPlannerRepo = new _repos_ks_termplanner_repo__WEBPACK_IMPORTED_MODULE_6__["KSTermPlannerRepo"](function () { return tutoredKedBackendClient; }, function () { return currentUser; });
                    tutorEnv.kgTermPlannerRepo = new _repos_kg_termplanner_repo__WEBPACK_IMPORTED_MODULE_7__["KGTermPlannerRepo"](function () { return tutoredKedBackendClient; }, function () { return currentUser; });
                    tutorEnv.userTasksRepo = new _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_8__["UserTasksRepo"](function () { return tutoredKedBackendClient; }, function () { return currentUser; });
                    return [4 /*yield*/, bearerProvider.getBearer().catch(function (error) {
                            console.error(error);
                        })];
                case 1:
                    _a.sent();
                    return [2 /*return*/, tutorEnv];
            }
        });
    });
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStarEndDate, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStarEndDate", function() { return getTermStarEndDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
//Not used anymore
// export function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {
//     return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
//     [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31
//     [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31
// }
function getTermStarEndDate(date, isFirstTerm) {
    var addYear = date.getMonth() >= 7;
    var termYear = null;
    if (addYear) {
        termYear = isFirstTerm ? date.getFullYear() : date.getFullYear() + 1;
    }
    else {
        termYear = isFirstTerm ? date.getFullYear() - 1 : date.getFullYear();
    }
    var termYearMoment = moment__WEBPACK_IMPORTED_MODULE_1___default()(termYear.toString(), "YYYY");
    if (termYearMoment.week() != 1) {
        termYearMoment = termYearMoment.clone().add(1, 'week');
    }
    return isFirstTerm ? [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(32).startOf('week'), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(51).endOf('week')] :
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(25).endOf('week')];
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6; // determine 
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");


function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        return this.term === 'AT' ? intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'HT {year}' }, { year: year }) :
            intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'VT {year}' }, { year: year });
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        var firstB = b[firstPart];
        if (firstA === firstB)
            return 0;
        if (firstA == null)
            return -1;
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/utils/weekutil.ts":
/*!*******************************!*\
  !*** ./src/utils/weekutil.ts ***!
  \*******************************/
/*! exports provided: KEDWeek, getNextWeekDate, getPrevWeekDate, getAdjustedWeek */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDWeek", function() { return KEDWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getNextWeekDate", function() { return getNextWeekDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getPrevWeekDate", function() { return getPrevWeekDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAdjustedWeek", function() { return getAdjustedWeek; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

function KEDWeek(year, week) {
    var m = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(year, 1, 1)).week(week);
    var res = {
        year: year,
        week: week,
        notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),
        notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()
    };
    return res;
}
function getNextWeekDate(date) {
    var nextDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(date).add(1, 'week');
    //Set the 01.01 of the next year in case the next week is in the same year 
    //and the previous week is the last week of the year
    if (date.week() === date.weeksInYear() && nextDate.year() === date.year()) {
        return { adjusted: true, nextDate: moment__WEBPACK_IMPORTED_MODULE_0___default()(date.year() + 1 + "-01-01").toDate() };
    }
    return { adjusted: false, nextDate: nextDate.toDate() };
}
function getPrevWeekDate(date) {
    var prevDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(date).add(-1, 'week');
    //Set the 01.01 of the current year in case the prev week is in the previous year
    if (date.week() === 2 && prevDate.year() !== date.year()) {
        return { adjusted: true, nextDate: moment__WEBPACK_IMPORTED_MODULE_0___default()(date.year() + "-01-01").toDate() };
    }
    return { adjusted: false, nextDate: prevDate.toDate() };
}
function getAdjustedWeek(m) {
    var clone = m.clone();
    return m.weekday() >= 5 ? // Lrdag 00:00 / Sndag 00:00?
        m.week() + 1 : // Tillhr nsta vecka
        m.week();
}
/*export function getWeekLimits (m: Moment) {
  const clonedSwedish = m.clone().locale('sv');
  const limits = {
    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),
    notAfter: clonedSwedish.startOf('week').add(5, 'days')
  };
}
*/


/***/ }),

/***/ 0:
/*!*****************************************!*\
  !*** ../locale-data/index.js (ignored) ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 1:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnR3ZWIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvaGFzaC1yZXN0b3Jlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50LXdlYi9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaHR0cC1lcnJvci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3Jlc3RjbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vYXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1jb2xsZWN0aW9uL2RlbHRhLWNhY2hlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXJlcG8uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vbXV0YXRpb24tcXVldWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vcXVlcnktc2V0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtbW9kZWwtbWlncmF0b3IvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLWNvdXJzZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL2ZpYmVyLWNvbnRleHQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL21peGluLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9vYnNlcnZhYmxlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHN2fGVuIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9nZXQtdXNlci1jbGFpbXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2Vkc2NsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9nb29nbGUtY2FsZW5kYXIudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvZ29vZ2xlLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9rZWQtbGVhcm5pbmdnb2Fscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9jYWxlbmRhci1zZWxmLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9jYWxlbmRhci10dXRvcmVkLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9jb3Vyc2UtbmFtZS10by1jc3MtY2xhc3MudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2FsZW5kYXIvY3J1bmNoLWNvbGxpZGluZy1ldmVudHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2FsZW5kYXIvZGF5LXZpZXctZXZlbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL2RheS12aWV3LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9ob3VyLW1hcmtlci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2FsZW5kYXIvaW5kZXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL3Nob3VsZC1pbmNsdWRlLWNhbGVuZGFyLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL3N0YXR1cy1iYXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL3RpbWUtbGluZXMudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NhbGVuZGFyL3dlZWstdmlldy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2hhcnRzL2NoYXJ0cy11dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvZG91Z2hudXQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NoYXJ0cy9nb2FsLXByb2dyZXNzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvcHJvZ3Jlc3MudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL2VsbGlwc2lzLWxvYWRlci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9jb25maXJtYXRpb24udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9sZWFybmluZy1nb2Fscy1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvdGFzay1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rZy10ZXJtcGxhbm5lci9rZy10ZXJtcGxhbm5lci1zZWxmLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rZy10ZXJtcGxhbm5lci9rZy10ZXJtcGxhbm5lci10dXRvcmVkLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rZy10ZXJtcGxhbm5lci9rZy10ZXJtcGxhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMva2ctdGVybXBsYW5uZXIvd2Vlay1ub3RlLWRpYWxvZy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMva3MtZ29hbHMvZnV0dXJlLWFiaWxpdGllcy10YWJsZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMva3MtZ29hbHMvZnV0dXJlLWFiaWxpdGllcy12aWV3bW9kZWwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMva3MtZ29hbHMvZ29hbHMtdmlld21vZGVsLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2tzLWdvYWxzL2dvYWxzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci9rcy10ZXJtcGxhbm5lci1zZWxmLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci9rcy10ZXJtcGxhbm5lci10dXRvcmVkLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci90ZXJtcGxhbm5lci11dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci90ZXJtcGxhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMva3MtdGVybXBsYW5uZXIvdHV0b3ItZGlhbG9nLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci92aWV3bW9kZWwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvbGF0ZXN0LWFzc2Vzc21lbnRzL2xhdGVzdC1hc3Nlc3NtZW50cy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvbGVhcm5pbmctdGFza3MvaW5kZXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2xpc3QtY291cnNlcy9saXN0LWNvdXJzZXMudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL215LWNvdXJzZXMvbXktY291cnNlcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvbXktc3ViamVjdHMvbXktc3ViamVjdHMtaW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL215LXN1YmplY3RzL215LXN1YmplY3RzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy90dXRvcnMtc2VsZWN0L3R1dG9ycy1zZWxlY3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9TZXR1cExhbmd1YWdlSW50bC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2NoZWNrYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvY29udGVudC1lZGl0YWJsZS1maWVsZC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2RpYWxvZ3MudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHRhcmVhLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL29ic2VydmUudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3R1dG9yYWJsZS1jb21wb25lbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2FjdGlvbnMtc3YudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9leGVjLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2ltYWdlLWVkaXQtYWN0aW9ucy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvd2FzaC1odG1sLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWstbm90ZWJvb2svaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vlay1ub3RlYm9vay9yb290LXdlZWstbm90ZWJvb2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWstbm90ZWJvb2svd2Vlay1ub3RlYm9vay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvYWRkLWN1c3RvbS1nb2FsLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9hZGQtY3VzdG9tLXRhc2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2FkZC1vci1lZGl0LXN1Yi10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9lZGl0LXVzZXItdGFzay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvZ2V0LXRhc2stdHlwZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9yZWZpbmVyLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL3VzZXItdGFza3MtYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci93ZWVrcGxhbm5lci1wZXJzaXN0ZWQtc3RhdGUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItc2VsZi50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItdHV0b3JlZC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9lbGVtZW50cy9LRURDb21wb25lbnRzL2tlZGNvbXBvbmVudHMuY2xpZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9lbGVtZW50cy9LRURDb21wb25lbnRzL2tlZGNvbXBvbmVudHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2VsZW1lbnRzL0tFRENvbXBvbmVudHMvd2VicGFjay1lbnRyeS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZmVhdHVyZXMvZmVhdHVyZXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2ZlYXR1cmVzL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9jb25maWd1cmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1iZWFyZXItcHJvdmlkZXJzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtZWRzLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWtlZC1iYWNrZW5kLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuY2ZnLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC5lbnYudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC50dXRvckVudi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9kYi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9rZWQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3MvaGlkZGVuLWNvdXJzZXMtcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3Mva2VkLXJlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL2tnLXRlcm1wbGFubmVyLXJlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL2tzLXRlcm1wbGFubmVyLXJlcG8taW5zdGFuY2UudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL2tzLXRlcm1wbGFubmVyLXJlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3JlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3VzZXItdGFza3MtcmVwby50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvcmVwb3Mvd2Vlay1ub3Rlcy1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2dlbmVyaWMtc2Nob29sLXRlcm0udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2dlbmVyaWMtc2Nob29sLXV0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9pZi10YWtlcy10aW1lLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9tYWtlLXN1c3BlbnNlLWFwaS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcGVuZGluZy1qb2IudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3F1ZXJ5LXN0cmluZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcmVxdWVzdC10dXRvcmVkLXRva2Vucy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLW1vbWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLXRlcm0udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy93ZWVrdXRpbC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4vbG9jYWxlLWRhdGEvaW5kZXguanMgKGlnbm9yZWQpIiwid2VicGFjazovL1tuYW1lXS8uL2xpYi9sb2NhbGVzIChpZ25vcmVkKSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9saWIvbG9jYWxlcyAoaWdub3JlZCk/ZDE5YiIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJqUXVlcnlcIiIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJSZWFjdFwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0RE9NXCIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFRLG9CQUFvQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUFpQiw0QkFB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Q0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNmLENBQUM7QUFFRDs7Ozs7OztFQU9FOzs7Ozs7Ozs7Ozs7QUNoREYsZTs7Ozs7Ozs7Ozs7QUNBQSxlOzs7Ozs7Ozs7OztBQ0FBLGU7Ozs7Ozs7Ozs7O0FDQUEsd0I7Ozs7Ozs7Ozs7O0FDQUEsdUI7Ozs7Ozs7Ozs7O0FDQUEsMEIiLCJmaWxlIjoia2VkY29tcG9uZW50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuIFx0XHR2YXIgZXhlY3V0ZU1vZHVsZXMgPSBkYXRhWzJdO1xuXG4gXHRcdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuIFx0XHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcbiBcdFx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMCwgcmVzb2x2ZXMgPSBbXTtcbiBcdFx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG4gXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG4gXHRcdFx0XHRyZXNvbHZlcy5wdXNoKGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSk7XG4gXHRcdFx0fVxuIFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG4gXHRcdH1cbiBcdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcbiBcdFx0XHRcdG1vZHVsZXNbbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRpZihwYXJlbnRKc29ucEZ1bmN0aW9uKSBwYXJlbnRKc29ucEZ1bmN0aW9uKGRhdGEpO1xuXG4gXHRcdHdoaWxlKHJlc29sdmVzLmxlbmd0aCkge1xuIFx0XHRcdHJlc29sdmVzLnNoaWZ0KCkoKTtcbiBcdFx0fVxuXG4gXHRcdC8vIGFkZCBlbnRyeSBtb2R1bGVzIGZyb20gbG9hZGVkIGNodW5rIHRvIGRlZmVycmVkIGxpc3RcbiBcdFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyB8fCBbXSk7XG5cbiBcdFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG4gXHRcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIFx0fTtcbiBcdGZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCkge1xuIFx0XHR2YXIgcmVzdWx0O1xuIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWRNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0dmFyIGRlZmVycmVkTW9kdWxlID0gZGVmZXJyZWRNb2R1bGVzW2ldO1xuIFx0XHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuIFx0XHRcdGZvcih2YXIgaiA9IDE7IGogPCBkZWZlcnJlZE1vZHVsZS5sZW5ndGg7IGorKykge1xuIFx0XHRcdFx0dmFyIGRlcElkID0gZGVmZXJyZWRNb2R1bGVbal07XG4gXHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbZGVwSWRdICE9PSAwKSBmdWxmaWxsZWQgPSBmYWxzZTtcbiBcdFx0XHR9XG4gXHRcdFx0aWYoZnVsZmlsbGVkKSB7XG4gXHRcdFx0XHRkZWZlcnJlZE1vZHVsZXMuc3BsaWNlKGktLSwgMSk7XG4gXHRcdFx0XHRyZXN1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IGRlZmVycmVkTW9kdWxlWzBdKTtcbiBcdFx0XHR9XG4gXHRcdH1cblxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJrZWRjb21wb25lbnRzXCI6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goW1wiLi9zcmMvZWxlbWVudHMvS0VEQ29tcG9uZW50cy93ZWJwYWNrLWVudHJ5LnRzXCIsXCJ2ZW5kb3JzXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudCc7IiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWInOyIsInZhciBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCkge1xuICAgIH1cbiAgICBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoaWQsIHRva2VuSW5mbykge1xuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQsIEpTT04uc3RyaW5naWZ5KHRva2VuSW5mbykpO1xuICAgIH07XG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIganNvbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJiZWFyZXItXCIgKyBpZCk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlLmpzLm1hcCIsInZhciByZWRpckhhc2ggPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwicmVkaXItaGFzaFwiKTtcbmlmIChyZWRpckhhc2gpXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIF9hID0gSlNPTi5wYXJzZShyZWRpckhhc2gpLCB0aW1lID0gX2EudGltZSwgaGFzaCA9IF9hLmhhc2g7XG4gICAgICAgIGlmICh0aW1lICYmIHRpbWUgPiBEYXRlLm5vdygpIC0gNjAwMDApIHtcbiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oXCJyZWRpci1oYXNoXCIpO1xuICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKF8pIHsgfVxuZXhwb3J0IGZ1bmN0aW9uIHJlbWVtYmVySGFzaExvY2F0aW9uKCkge1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJyZWRpci1oYXNoXCIsIEpTT04uc3RyaW5naWZ5KHsgdGltZTogRGF0ZS5ub3coKSwgaGFzaDogbG9jYXRpb24uaGFzaCB9KSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXNoLXJlc3RvcmVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBIdHRwRXJyb3IgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xuaW1wb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH0gZnJvbSBcIi4vYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2VcIjtcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscyc7XG5pbXBvcnQgeyBLZWRNb2RlbE1pZ3JhdG9yTWl4aW4gfSBmcm9tICcuLi9rZWQtbW9kZWwtbWlncmF0b3InO1xuaW1wb3J0ICcuL2hhc2gtcmVzdG9yZXInO1xuaW1wb3J0IHsgcmVtZW1iZXJIYXNoTG9jYXRpb24gfSBmcm9tICcuL2hhc2gtcmVzdG9yZXInO1xuS2VkTW9kZWxNaWdyYXRvck1peGluKEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlKTtcbmV4cG9ydCB2YXIgc3RvcmFnZSA9IG5ldyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKTtcbnZhciB0aW1lT2ZQYWdlTG9hZCA9IERhdGUubm93KCk7XG52YXIgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIodG9rZW5QYXRoLCB0b2tlblJlc3BvbnNlTWFwcGVyLCB0b2tlbklkKSB7XG4gICAgICAgIHRoaXMudG9rZW5QYXRoID0gdG9rZW5QYXRoO1xuICAgICAgICB0aGlzLnRva2VuUmVzcG9uc2VNYXBwZXIgPSB0b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnRva2VuSW5mby50b2tlbikgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudG9rZW5JZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBzdG9yYWdlLmxvYWQodGhpcy50b2tlbklkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy50b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLnJlZnJlc2hCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2godGhpcy50b2tlblBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IEFjY2VwdDogXCJ0ZXh0L3BsYWluOyBhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6IFwic2FtZS1vcmlnaW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMzAyIHx8ICghcmVzLnN0YXR1cyAmJiByZXMudHlwZSA9PT0gXCJvcGFxdWVyZWRpcmVjdFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgc2Vzc2lvbiB0aW1lZCBvdXQgYW5kIHNlcnZlciB3YW50cyB0byByZWRpcmVjdCBlbnRpcmUgcGFnZSB0byBsb2dpbiBwYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGltZSB0byByZWxvYWQgY3VycmVudCBwYWdlIHRvIGZvcmNlIGEgcmVkaXJlY3Qgb2YgdGhlIGVudGlyZSBwYWdlIGluc3RlYWQgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZWRpcmVjdGluZyB0byAvYXBpL3Rva2VuIG9yIHdoYXRldmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGltZU9mUGFnZUxvYWQgPiA2MDAwMCkgeyAvLyBwcm9oaWJpdCBlbmRsZXNzIGxvb3Agb2YgcmVsb2FkaW5nIHNlbGYuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2FudHNSZWRpcmVjdCA9IHRydWU7IC8vIFNvIHRoYXQgbGlzdGVuZXJzIHRvIG9uYmVmb3JldW5sb2FkIGNvdWxkIHNob3cgYWx0ZXJuYXRlIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVkaXJlY3Qgd2FudGVkLiBSZWxvYWQgcGFnZS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWVtYmVySGFzaExvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoMzAyLCBcIlJlZGlyZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gXCJIVFRQXCIgKyByZXMuc3RhdHVzICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEVycm9yLCBbdm9pZCAwLCBfYiArIChfZS5zZW50KCkpXSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IF9kLmFwcGx5KHRoaXMsIFtfZS5zZW50KCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2Uuc2F2ZSh0aGlzLnRva2VuSWQsIHRoaXMudG9rZW5JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyIH07XG5leHBvcnQgdmFyIGlzb21vcnBoaWMgPSB7IGZldGNoOiBmZXRjaC5iaW5kKHNlbGYpLCBidG9hOiBidG9hLmJpbmQoc2VsZikgfTtcbnZhciBLZWRCYWNrZW5kQ2xpZW50V2ViID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDbGllbnRXZWIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENsaWVudFdlYihhcGlCYXNlVXJsLCBwcm92aWRlck9yVG9rZW5QYXRoLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBiZWFyZXJQcm92aWRlciA9IHR5cGVvZiBwcm92aWRlck9yVG9rZW5QYXRoICE9PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICBwcm92aWRlck9yVG9rZW5QYXRoIDpcbiAgICAgICAgICAgIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihwcm92aWRlck9yVG9rZW5QYXRoLCAob3B0aW9ucyAmJiBvcHRpb25zLnRva2VuUmVzcG9uc2VNYXBwZXIpIHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4gKHsgdG9rZW46IHgsIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogNjAgfSk7IH0pLCBvcHRpb25zICYmIG9wdGlvbnMudG9rZW5JZCk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGFwaUJhc2VVcmwpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnRXZWI7XG59KEtlZEJhY2tlbmRDbGllbnQpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsInZhciBEb2N1bWVudEFjY2VzcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEb2N1bWVudEFjY2VzcyhhY2Nlc3NDbGFpbVR5cGUsIGFjY2Vzc0NsYWltVmFsdWUsIHJpZ2h0KSB7XG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1UeXBlID0gYWNjZXNzQ2xhaW1UeXBlO1xuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVmFsdWUgPSBhY2Nlc3NDbGFpbVZhbHVlO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gICAgfVxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAoYWMpIHtcbiAgICAgICAgaWYgKCFhYylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgc3BsaXQgPSBhYy5zcGxpdCgnOicpO1xuICAgICAgICBpZiAoc3BsaXQubGVuZ3RoIDwgMylcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XG4gICAgICAgIHZhciBjbGFpbVR5cGUgPSBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZShzcGxpdFswXSk7XG4gICAgICAgIHZhciBjbGFpbVZhbHVlID0gRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUoc3BsaXRbMV0pO1xuICAgICAgICB2YXIgcmlnaHQgPSBzcGxpdFsyXTtcbiAgICAgICAgaWYgKHJpZ2h0ICE9PSAnUicgJiYgcmlnaHQgIT09ICdXJyAmJiByaWdodCAhPT0gJ1MnKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhY2Nlc3Mgc3RyaW5nOiBcIiArIGFjKTtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEFjY2VzcyhjbGFpbVR5cGUsIGNsYWltVmFsdWUsIHJpZ2h0KTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLmVzY2FwZSA9IGZ1bmN0aW9uIChhY2Nlc3NDb21wb25lbnQpIHtcbiAgICAgICAgcmV0dXJuIGFjY2Vzc0NvbXBvbmVudC5yZXBsYWNlKC9cXCUvZywgXCIlMjVcIikucmVwbGFjZSgvXFw6L2csIFwiJTNBXCIpO1xuICAgIH07XG4gICAgRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlM0EvZywgXCI6XCIpLnJlcGxhY2UoL1xcJTI1L2csIFwiJVwiKTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVHlwZSkgKyBcIjpcIiArXG4gICAgICAgICAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVZhbHVlKSArIFwiOlwiICtcbiAgICAgICAgICAgIHRoaXMucmlnaHQ7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAoYWNsKSB7XG4gICAgICAgIHJldHVybiBhY2xcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nKGFjKTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBhYzsgfSk7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy50b1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xuICAgICAgICByZXR1cm4gYWNsLm1hcChmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjLnRvU3RyaW5nKCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIERvY3VtZW50QWNjZXNzO1xufSgpKTtcbmV4cG9ydCB7IERvY3VtZW50QWNjZXNzIH07XG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKGFjbCwgdXNlckNsYWltcywgcmVxdWVzdGVkUmlnaHQpIHtcbiAgICBpZiAodXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjbGFpbSkgeyByZXR1cm4gY2xhaW0udHlwZSA9PT0gJ3JvbGUnICYmIGNsYWltLnZhbHVlID09PSBcIkFETUlOXCI7IH0pKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gYWNsLnNvbWUoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJDbGFpbXMuc29tZShmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuIGEuYWNjZXNzQ2xhaW1UeXBlID09PSBjLnR5cGUgJiZcbiAgICAgICAgICAgICAgICBhLmFjY2Vzc0NsYWltVmFsdWUgPT09IGMudmFsdWUgJiYgKChhLnJpZ2h0ID09PSAnUicgJiYgcmVxdWVzdGVkUmlnaHQgPT09ICdSJykgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1cnICYmIFsnUicsICdXJ10uaW5kZXhPZihyZXF1ZXN0ZWRSaWdodCkgPj0gMCkgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1MnKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjZXNzLWNvbnRyb2wuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbnZhciBIdHRwRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSHR0cEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEh0dHBFcnJvcihjb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICBfdGhpcy5uYW1lID0gXCJodHRwXCIgKyBjb2RlO1xuICAgICAgICBfdGhpcy5tZXNzYWdlID0gXCJIVFRQXCIgKyBjb2RlICsgXCIgXCIgKyBtZXNzYWdlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBIdHRwRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAtZXJyb3IuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7XG5leHBvcnQgeyBLZWRCZWFyZXJQcm92aWRlciB9IGZyb20gJy4va2VkLWJlYXJlci1wcm92aWRlcic7XG5leHBvcnQgKiBmcm9tICcuL2FjY2Vzcy1jb250cm9sJztcbmV4cG9ydCB7IFJlc3RDbGllbnQgfTtcbmltcG9ydCB7IEh0dHBFcnJvciB9IGZyb20gJy4vaHR0cC1lcnJvcic7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbmV4cG9ydCAqIGZyb20gJy4vcmVzdGNsaWVudCc7XG47XG4vLyB8ICdvdGhlckZsYWcnIHwgJ3RoaXJkRmxhZyc7Li4uXG52YXIgS2VkQmFja2VuZENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ2xpZW50KGlzb21vcnBoaWMsIGJlYXJlclByb3ZpZGVyLCBiYXNlVXJsKSB7XG4gICAgICAgIHRoaXMuaHR0cCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIHsgYmVhcmVyUHJvdmlkZXI6IGJlYXJlclByb3ZpZGVyIH0pO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5nZXRNeUNsYWltcyA9IGZ1bmN0aW9uICh0YWJsZSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQoXCJtZS9jbGFpbXMvXCIgKyAodGFibGUgfHwgXCJcIiksIG51bGwsIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQodGFibGUgKyBcIi9cIiArIGlkLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpc3QgPSBmdW5jdGlvbiAodGFibGUsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSwgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkubXV0YXRpb25zT25FbXB0eSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubXV0YXRpb25zT25FbXB0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwiXCIgKyB0YWJsZSwgcXVlcnksIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYmF0Y2ggPSBmdW5jdGlvbiAocmVxcywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW9yZGVyIG9wZXJhdGlvbnMgc28gdGhhdCAnYWRkJ3MgY29tZSBmaXJzdCBhbmQgJ2RlbGV0ZSdzIGNvbWUgbGFzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXMgPSByZXFzLnNsaWNlKCkuc29ydChmdW5jdGlvbiAocmVxMSwgcmVxMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXExLm9wID09PSAnYWRkJyA/IC0xIDogcmVxMi5vcCA9PT0gJ2FkZCcgPyAxIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxMS5vcCA9PT0gJ2RlbGV0ZScgPyAxIDogcmVxMi5vcCA9PT0gJ2RlbGV0ZScgPyAtMSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5wb3N0KFwiYmF0Y2hcIiwgcmVxcywgZmV0Y2hPcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kbyA9IGZ1bmN0aW9uIChzY29wZUZuKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJ1bm5lcjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmVyID0gbmV3IEJhdGNoUnVubmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUZuKHJ1bm5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJhdGNoKHJ1bm5lci5tdXRhdGlvblJlcXVlc3RzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlUmVhbG0gPSBmdW5jdGlvbiAocmVhbG0pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmRlbGV0ZShcInJlYWxtcy9cIiArIHJlYWxtKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuYWRkKHRhYmxlLCBkb2MpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnB1dCh0YWJsZSwgZG9jKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudXBkYXRlKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubWVyZ2UoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5jbGVhckJyYW5jaChicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5kZWxldGUodGFibGUsIGlkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bnNoYXJlKHRhYmxlLCBpZCwgYWNsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVuZG9MaW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnQ7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZENsaWVudCB9O1xudmFyIEJhdGNoUnVubmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJhdGNoUnVubmVyKCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMgPSBbXTtcbiAgICB9XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jLCBicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnYWRkJywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xuICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICBkZWxldGUgZG9jLmFjbDsgLy8gRm9yYmlkZGVuIHRvIHNlbmQgYWNsIHdpdGggcHV0KCkgY2FsbHMuXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdwdXQnLCB0YWJsZTogdGFibGUsIGRvYzogZG9jIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgZGVsdGFEb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YURvYyk7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1cGRhdGUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgZGVsdGFEb2M6IGRlbHRhRG9jLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdtZXJnZScsIGJyYW5jaElkOiBicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQ6IHRhcmdldEJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdzaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5zaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2xpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0VGFibGU6IHRhcmdldFRhYmxlLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmRvLWxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIHJldHVybiBCYXRjaFJ1bm5lcjtcbn0oKSk7XG5leHBvcnQgeyBCYXRjaFJ1bm5lciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xuaW1wb3J0IHsgYXZvaWRTaW11bHRhbm91c0NhbGxzIH0gZnJvbSAnLi91dGlscyc7XG52YXIgS2VkQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2VkQmVhcmVyUHJvdmlkZXIoaXNvbW9ycGhpYywgc3RvcmFnZSwgdG9rZW5JZCwgY2xpZW50SWQsIGNsaWVudFNlY3JldCwgdG9rZW5VcmwsIHRva2VuUXVlcnkpIHtcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICAgICAgdGhpcy50b2tlbklkID0gdG9rZW5JZDtcbiAgICAgICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xuICAgICAgICB0aGlzLmNsaWVudFNlY3JldCA9IGNsaWVudFNlY3JldDtcbiAgICAgICAgdGhpcy50b2tlblVybCA9IHRva2VuVXJsO1xuICAgICAgICB0aGlzLnRva2VuUXVlcnkgPSB0b2tlblF1ZXJ5O1xuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcbiAgICAgICAgdGhpcy5jbGllbnQgPSBuZXcgUmVzdENsaWVudChpc29tb3JwaGljLCBcIlwiLCB7XG4gICAgICAgICAgICB1c2VybmFtZTogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLmNsaWVudFNlY3JldFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hLCB0b2tlbiwgZXhwaXJlcywgX2IsIGVfMTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLnRva2VuSW5mbywgdG9rZW4gPSBfYS50b2tlbiwgZXhwaXJlcyA9IF9hLmV4cGlyZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4gJiYgZXhwaXJlcyA+PSBEYXRlLm5vdygpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMSwgNCwgLCA2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN0b3JhZ2UubG9hZCh0aGlzLmNsaWVudElkICsgXCIvXCIgKyB0aGlzLnRva2VuSWQpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudG9rZW5JbmZvID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudG9rZW5JbmZvLnRva2VuICYmIHRoaXMudG9rZW5JbmZvLmV4cGlyZXMgPj0gRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXMsIHJldHJpZXMsIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cmllcyA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJldHJpZXMgPCA2KSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHJpZXZpbmcgdG9rZW4gZm9yIFwiICsgdGhpcy50b2tlbklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50LmdldCh0aGlzLnRva2VuVXJsLCB0aGlzLnRva2VuUXVlcnksIHsgY2FjaGU6ICdyZWxvYWQnIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkdvdCBcIiArIHJlcy5zdGF0dXMgKyBcIiBcIiArIHJlcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudG9rZW5JbmZvID0gKF9iLnRva2VuID0gX2Muc2VudCgpLCBfYi5leHBpcmVzID0gRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwLCBfYik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCB0b2tlbiBmb3IgXCIgKyB0aGlzLnRva2VuSWQgKyBcIjogXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuSW5mbykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9yYWdlLnNhdmUodGhpcy5jbGllbnRJZCArIFwiL1wiICsgdGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICArK3JldHJpZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgdG9rZW4gZm9yIFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50b2tlbklkKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJlYXJlclByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IEtlZEJlYXJlclByb3ZpZGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWQtYmVhcmVyLXByb3ZpZGVyLmpzLm1hcCIsIi8qXG5kZWNsYXJlIHZhciBCdWZmZXI7IC8vIG5vZGUgYnVpbHQtaW5cblxuXG5mdW5jdGlvbiBiYXNpY0F1dGhIZWFkZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIFwiQmFzaWMgXCIgKyBuZXcgQnVmZmVyKHVzZXJuYW1lICsgXCI6XCIgKyBwYXNzd29yZCkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG59XG4qL1xuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJy4uL29ic2VydmFibGUvZW1pdHRlcic7XG52YXIgUmVzdENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcbiAgICAgICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnMgPSAwO1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSBuZXcgRW1pdHRlcih0aGlzKTtcbiAgICAgICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7IG1vZGU6ICdjb3JzJyB9O1xuICAgICAgICB0aGlzLmF1dGhIZWFkZXIgPSBvcHRpb25zLmJlYXJlciA/XG4gICAgICAgICAgICBcIkJlYXJlciBcIiArIG9wdGlvbnMuYmVhcmVyIDpcbiAgICAgICAgICAgIG9wdGlvbnMudXNlcm5hbWUgP1xuICAgICAgICAgICAgICAgIFwiQmFzaWMgXCIgKyBpc29tb3JwaGljLmJ0b2Eob3B0aW9ucy51c2VybmFtZSArIFwiOlwiICsgKG9wdGlvbnMucGFzc3dvcmQgfHwgXCJcIikpIDpcbiAgICAgICAgICAgICAgICBudWxsO1xuICAgICAgICB0aGlzLmJlYXJlclByb3ZpZGVyID0gb3B0aW9ucy5iZWFyZXJQcm92aWRlciB8fCBudWxsO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdENsaWVudC5wcm90b3R5cGUsIFwic3RhdHVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uIChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgKyt0aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcbiAgICAgICAgdGhpcy5fc3RhdHVzLmRpc3BhdGNoKHRoaXMpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZmV0Y2gocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgLS1fdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzLmRpc3BhdGNoKF90aGlzKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIC0tX3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xuICAgICAgICAgICAgX3RoaXMuX3N0YXR1cy5kaXNwYXRjaChfdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5fZmV0Y2ggPSBmdW5jdGlvbiAocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5U3RyLCBfYSwgYXV0aEhlYWRlciwgdG9rZW5JbmZvLCBiZWFyZXJQcm92aWRlciwgX2IsIF9jLCB1cmwsIHJlcywgd3d3YXV0aCwgX2Q7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZXRjaE9wdGlvbnMgJiYgZmV0Y2hPcHRpb25zLmNhY2hlID09PSAnbm8tY2FjaGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgYmFjay1idXR0b24gbm90IHJlc3BlY3RpbmcgY2FjaGUgY29udHJvbCBpbiBDaHJvbWUvT3BlcmEuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwZW5kIGEgcXVlcnkgcGFyYW1ldGVyIHRvIGZvcmNlIGEgY2FjaGUgZW50cnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHRzbGliXzEuX19hc3NpZ24oe30sIHF1ZXJ5LCB7IG5vY2FjaGU6IGNyZWF0ZVVVSUQoKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyID0gcXVlcnkgJiYgT2JqZWN0LmtleXMocXVlcnkpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBxdWVyeVtrZXldICE9PSB1bmRlZmluZWQ7IH0pLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrZXkpICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI9XCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQocXVlcnlba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCcmJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMsIGF1dGhIZWFkZXIgPSBfYS5hdXRoSGVhZGVyLCB0b2tlbkluZm8gPSBfYS50b2tlbkluZm8sIGJlYXJlclByb3ZpZGVyID0gX2EuYmVhcmVyUHJvdmlkZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghYXV0aEhlYWRlciAmJiAhdG9rZW5JbmZvICYmIGJlYXJlclByb3ZpZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBiZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRva2VuSW5mbyA9IHRva2VuSW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b2tlbkluZm8pIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodG9rZW5JbmZvLmV4cGlyZXMgPCBEYXRlLm5vdygpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRva2VuIGV4cGlyZWQuIFJlZnJlc2ggaXQ6XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYmVhcmVyUHJvdmlkZXIucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudG9rZW5JbmZvID0gdG9rZW5JbmZvID0gX2Uuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoSGVhZGVyID0gXCJCZWFyZXIgXCIgKyB0b2tlbkluZm8udG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIG9uZSB3YXkgb3IgYW5vdGhlciwgd2UndmUgY29uY2x1ZGVkIGFuIEF1dGhvcml6YXRpb24gaGVhZGVyIHRvIHVzZTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdXRoSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gYXV0aEhlYWRlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuYmFzZVVybCArIHBhdGggKyAocXVlcnlTdHIgPyBcIj9cIiArIHF1ZXJ5U3RyIDogXCJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPT0gNDAxICYmIHRoaXMuYmVhcmVyUHJvdmlkZXIpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHd3d2F1dGggPSByZXMuaGVhZGVycy5nZXQoXCJ3d3ctYXV0aGVudGljYXRlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgXCIgKyByZXMuc3RhdHVzICsgXCIgZnJvbSBcIiArICh0aGlzLmJhc2VVcmwgKyBwYXRoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh3d3dhdXRoICYmIC9CZWFyZXIvaS50ZXN0KHd3d2F1dGgpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJlYXJlclByb3ZpZGVyLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kLnRva2VuSW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IFwiQmVhcmVyIFwiICsgdGhpcy50b2tlbkluZm8udG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocGF0aCwgcXVlcnksIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIkdFVFwiLCB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uOyB0ZXh0L3BsYWluXCIgfSwgcXVlcnksIGZldGNoT3B0aW9ucyk7XG4gICAgfTtcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5wb3N0ID0gZnVuY3Rpb24gKHBhdGgsIGRhdGEsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIlBPU1RcIiwge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICB9LCBudWxsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSkgfSkpO1xuICAgIH07XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHBhdGgsIHF1ZXJ5LCBib2R5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJERUxFVEVcIiwgeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvbjsgdGV4dC9wbGFpblwiIH0sIHF1ZXJ5LCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogYm9keSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gUmVzdENsaWVudDtcbn0oKSk7XG5leHBvcnQgeyBSZXN0Q2xpZW50IH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXN0Y2xpZW50LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVVVJRCgpIHtcbiAgICAvLyBEZWNlbnQgc29sdXRpb24gZnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHRcbiAgICB2YXIgZCA9IERhdGUubm93KCk7XG4gICAgdmFyIHV1aWQgPSAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgIHZhciByID0gKGQgKyBNYXRoLnJhbmRvbSgpICogMTYpICUgMTYgfCAwO1xuICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xuICAgICAgICByZXR1cm4gKGMgPT09ICd4JyA/IHIgOiAociAmIDB4NyB8IDB4OCkpLnRvU3RyaW5nKDE2KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdXVpZDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHMobWV0aG9kKSB7XG4gICAgdmFyIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW9uZ29pbmdQcm9taXNlKSB7XG4gICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlO1xuICAgIH07XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0R2xvYmFsSWQocmVhbG0pIHtcbiAgICB2YXIgcHJlZml4ID0gJ2VjOTZiM2JlLTQ1ZmMtNDFkMy1iNjllLSc7XG4gICAgdmFyIHBhZCA9IFsnNTAnLCAnMDgnLCAnZTEnLCAnNDAnLCAnZTQnLCAnZTcnXTtcbiAgICBpZiAocmVhbG0ubGVuZ3RoID4gNilcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9vIGxvbmcgcmVhbG1cIik7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZWFsbS5sZW5ndGg7ICsraSkge1xuICAgICAgICB2YXIgaGV4ID0gcmVhbG0uY2hhckNvZGVBdChpKS50b1N0cmluZygxNik7XG4gICAgICAgIHBhZFtpXSA9IGhleC5sZW5ndGggPT09IDIgP1xuICAgICAgICAgICAgaGV4IDpcbiAgICAgICAgICAgICcwJyArIGhleDtcbiAgICB9XG4gICAgcmV0dXJuIHByZWZpeCArIHBhZC5qb2luKCcnKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlUHJlZGVzdGluYXRlZElkKGlucHV0KSB7XG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbmNvZGVyLCBkYXRhLCBkaWdlc3QsIF9hLCBpO1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVuY29kZXIuZW5jb2RlKGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgX2EgPSBVaW50OEFycmF5LmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSldO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgZGlnZXN0ID0gbmV3IChfYS5hcHBseShVaW50OEFycmF5LCBbdm9pZCAwLCBfYi5zZW50KCldKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5pYmJsZSA9IGRpZ2VzdFtpKytdICUgMTYgfCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3YXNoZWROaWJibGUgPSBjID09PSAneCcgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgJiAweDcgfCAweDg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdhc2hlZE5pYmJsZS50b1N0cmluZygxNik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLypleHBvcnQgZnVuY3Rpb24gYnVmMmhleChidWZmZXI6IEFycmF5QnVmZmVyKSB7XG4gIHJldHVybiBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoXG4gICAgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKSxcbiAgICAoeDogbnVtYmVyKSA9PiAoJzAwJyArIHgudG9TdHJpbmcoMTYpKS5zbGljZSgtMikpLmpvaW4oJycpO1xufSovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQXJyYXkoYSwgbWFwcGVyKSB7XG4gICAgdmFyIHJldHZhbCA9IGE7XG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgICB2YXIgdCA9IGFbaV07XG4gICAgICAgIHZhciBtYXBwZWQgPSBtYXBwZXIodCk7XG4gICAgICAgIGlmIChtYXBwZWQgIT09IHQpIHtcbiAgICAgICAgICAgIGlmIChyZXR2YWwgPT09IGEpXG4gICAgICAgICAgICAgICAgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgICAgICAgcmV0dmFsW2ldID0gbWFwcGVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXR2YWw7XG59XG4vKlxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5PFQ+KGE6IFRbXSwgbWFwcGVyOiAodDogVCkgPT4gVCB8IGZhbHNlKTogVFtdIHtcbiAgbGV0IHJldHZhbCA9IGE7XG4gIGxldCBqID0gMDtcbiAgZm9yIChsZXQgaT0wLGw9YS5sZW5ndGg7IGk8bDsgKytpLCArK2opIHtcbiAgICBjb25zdCB0ID0gYVtpXTtcbiAgICBjb25zdCBtYXBwZWQgPSBtYXBwZXIodCk7XG4gICAgaWYgKG1hcHBlZCA9PT0gZmFsc2UpIHtcbiAgICAgIC8vIE1hcHBlciB3YW50cyB0byBkZWxldGUgdGhpcyBkb2MuXG4gICAgICBpZiAocmV0dmFsID09PSBhKSByZXR2YWwgPSBhLnNsaWNlKCk7XG4gICAgICByZXR2YWwuc3BsaWNlKGosIDEpO1xuICAgICAgLS1qOyAvLyBjb21wZW5zYXRlIGZvciArK2pcbiAgICB9IGVsc2UgaWYgKG1hcHBlZCAhPT0gdCkge1xuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgcmV0dmFsW2pdID0gbWFwcGVkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0dmFsO1xufVxuKi8gXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiLCJpbXBvcnQgKiBhcyBKc29uU2NoZW1hIGZyb20gXCJrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvblwiO1xuaW1wb3J0IHsgZ2V0VGFibGVGcm9tTGFiZWwgfSBmcm9tIFwiLi91dGlsc1wiO1xudmFyIENhY2hlQnVzdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYWNoZUJ1c3QoKSB7XG4gICAgfVxuICAgIENhY2hlQnVzdC5nZXRDYWNoZUJ1c3QgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCB1c2VyLCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgaW52b2x2ZWRJdGVtcyA9IENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpO1xuICAgICAgICByZXR1cm4gaW52b2x2ZWRJdGVtc1xuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjYWNoZS1idXN0LVwiICsgdXNlciArIFwiLVwiICsgaXRlbSk7IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gISF2YWx1ZTsgfSlcbiAgICAgICAgICAgIC5qb2luKCcvJykgfHwgJ3N0YXRpYyc7XG4gICAgfTtcbiAgICBDYWNoZUJ1c3QuaW52YWxpZGF0ZUNhY2hlID0gZnVuY3Rpb24gKHJlcXMsIHVzZXIpIHtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMocmVxcyk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IF9hW19pXTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0sICcnICsgRGF0ZS5ub3coKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENhY2hlQnVzdC5nZXRJbnZvbHZlZEl0ZW1zID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgdmFyIGhhc0VkZ2VzRnJvbSA9IHF1ZXJ5Lmhhc0VkZ2VzRnJvbTtcbiAgICAgICAgdmFyIHJlbGF0ZWRUYWJsZXMgPSBpbmNsdWRlc1xuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiAhIXRhYmxlOyB9KTtcbiAgICAgICAgaWYgKGhhc0VkZ2VzRnJvbSlcbiAgICAgICAgICAgIHJlbGF0ZWRUYWJsZXMucHVzaChcImhlZlwiICsgdGFibGUpO1xuICAgICAgICByZXR1cm4gW3RhYmxlLCAnbWFzdGVyJywgcXVlcnkuYnJhbmNoSWRdLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4gISF4OyB9KS5jb25jYXQocmVsYXRlZFRhYmxlcykuc29ydCgpO1xuICAgIH07XG4gICAgQ2FjaGVCdXN0LmdldENhY2hlSW52YWxpZGF0aW9ucyA9IGZ1bmN0aW9uIChyZXFzKSB7XG4gICAgICAgIHZhciBpbnZhbGlkYXRpb25TZXQgPSB7fTtcbiAgICAgICAgcmVxcy5mb3JFYWNoKGZ1bmN0aW9uIChyZXEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocmVxLm9wKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcbiAgICAgICAgICAgICAgICBjYXNlICdwdXQnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XG4gICAgICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YWJsZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsaW5rJzpcbiAgICAgICAgICAgICAgICBjYXNlICd1bmxpbmsnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuc291cmNlVGFibGVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W1wiaGVmLVwiICsgZ2V0VGFibGVGcm9tTGFiZWwocmVxLnNvdXJjZVRhYmxlLCByZXEubGFiZWwpXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbWVyZ2UnOlxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLmJyYW5jaElkXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFyZ2V0QnJhbmNoSWQgfHwgXCJtYXN0ZXJcIl0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhpbnZhbGlkYXRpb25TZXQpO1xuICAgIH07XG4gICAgcmV0dXJuIENhY2hlQnVzdDtcbn0oKSk7XG5leHBvcnQgeyBDYWNoZUJ1c3QgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNhY2hlLWJ1c3QuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IG1lcmdlRGVsdGFzIH0gZnJvbSAnLi4vZGVsdGEtbWVyZ2UnO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5TXV0YXRpb25zT25EZWx0YXMoYnJhbmNoSWQsIGRlbHRhcywgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB1c2VyRGlzcGxheU5hbWUsIGhhc0FkZGl0aW9uYWxGaWx0ZXIpIHtcbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChtKSB7XG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gQWRkUmVsYXRlZCBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmICghaGFzQWRkaXRpb25hbEZpbHRlciAmJiBtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhZGQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUlkOiBtLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLnJlbGF0ZWREb2MuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG0uZ3JhcGhQcm9wLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnJlbGF0ZWREb2MubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcjogdXNlckRpc3BsYXlOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdjbGVhci1icmFuY2gnOlxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXJCcmFuY2ggUmVwb011dGF0aW9uXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIERlbGV0ZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFRoaXMgdHlwZSBvZiBtdXRhdGlvbiBjYW4gbm90IGJlIHBlcmZvcm1lZCBvbnRvIGJyYW5jaGVzLiBUaGVyZSdzIG5vIGJyYW5jaElkIHByb3BlcnR5IG9uIG0uXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBNZXJnZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobS50YXJnZXRCcmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBjaGFuZ2Ugd2lsbCBhcHBlbmQgbmV3IGRlbHRhcyB0byBvdXIgZGVsdGFzIGFycmF5IGJ1dCB3ZSBkb24ndCBrbm93IHdoYXQgd291bGQgY29tZS5cbiAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byByZWZldGNoIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbnVsbCB9OyAvLyBDYWxsZXIgc2hvdWxkIGNoZWNrIGZvciBudWxsIGFuZCByZS1mZXRjaCBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZS1SZWxhdGVkIFJlcG9NdXRhdGlvblxuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgaWYgKGhhc0FkZGl0aW9uYWxGaWx0ZXIgfHwgbS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZW1vdmUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlSWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5yZWxhdGVkRG9jLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS5yZWxhdGVkRG9jLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbS5ncmFwaFByb3AsXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUYWJsZTogbS50YWJsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yOiB1c2VyRGlzcGxheU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJ1xuICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyBVbmRvLUxpbmsgUmVwb011dGF0aW9uXG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gZGVsdGFzLmZpbmRJbmRleChmdW5jdGlvbiAoZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChkLnR5cGUgPT09ICdhZGQnIHx8IGQudHlwZSA9PT0gJ3JlbW92ZScgfHwgZC50eXBlID09PSAndW5kby1saW5rJykgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLnNvdXJjZUlkID09PSBtLmlkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC50YXJnZXRJZCA9PT0gbS5yZWxhdGVkSWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIFwiYWRkXCIgb3IgXCJyZW1vdmVcIiBkZWx0YSB0byBjaGFuZ2U6XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFSZWxhdGlvbiA9IGRlbHRhc1tpZHhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgZXhpc3RpbmcgYWRkL3JlbW92ZSBkZWx0YSBhcyBjdXJyZW5sdHkgYmVpbmcgZGVsZXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gZGVsdGFzLnNsaWNlKDAsIGlkeCkuY29uY2F0KFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YVJlbGF0aW9uLCB7ICRtZXRhOiBvcHRpbWlzdGljID8gJ3JlbW92aW5nJyA6ICdwZXJzaXN0ZWQnIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICBdLCBkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGVyc2lzdGVkLiBKdXN0IHJlbW92ZSBpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBSZXBvTXV0YXRpb25cbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkICE9PSBicmFuY2hJZClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBkZWx0YXMuZmluZEluZGV4KGZ1bmN0aW9uIChkZWx0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRlbHRhLnR5cGUgPT09ICdtb2RpZnknICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEudGFyZ2V0SWQgPT09IG0uaWQ7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWR4IDwgMCAmJiAhaGFzQWRkaXRpb25hbEZpbHRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21vZGlmeScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS50YXJnZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBtLmRlbHRhRG9jLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3JzOiBbdXNlckRpc3BsYXlOYW1lXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAnYWRkaW5nJyA6ICdwZXJzaXN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLmNvbmNhdChkZWx0YXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRGVsdGFEb2MgPSBkZWx0YXNbaWR4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250cmlidXRvcnMgPSBleGlzdGluZ0RlbHRhRG9jLmNvbnRyaWJ1dG9ycy5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjb250cmlidXRvcnMuaW5jbHVkZXModXNlckRpc3BsYXlOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5wdXNoKHVzZXJEaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3RGF0YSA9IG1lcmdlRGVsdGFzKGV4aXN0aW5nRGVsdGFEb2MuZGF0YSwgbS5kZWx0YURvYywgeyByZW1vdmVVbnNldFByb3BzOiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljICYmIE9iamVjdC5rZXlzKG5ld0RhdGEpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1pdHRlZCBtdXRhdGlvbiB0aGF0IHJlc2V0cyBhIGRlbHRhRG9jLiBSZW1vdmUgdGhlIGRlbHRhRG9jIGVudGlyZWx5OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9kaWZ5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnRhcmdldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBuZXdEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnM6IGNvbnRyaWJ1dG9ycyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ3VwZGF0aW5nJyA6ICdwZXJzaXN0ZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXS5jb25jYXQoZGVsdGFzLnNsaWNlKDAsIGlkeCksIGRlbHRhcy5zbGljZShpZHggKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGZvciAodmFyIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7IF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBtID0gbXV0YXRpb25zXzFbX2ldO1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEobSk7XG4gICAgICAgIGlmICh0eXBlb2Ygc3RhdGVfMSA9PT0gXCJvYmplY3RcIilcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gZGVsdGFzO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgSHR0cEVycm9yIH0gZnJvbSAnLi4vLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IGFwcGx5TXV0YXRpb25zT25EZWx0YXMgfSBmcm9tICcuL2FwcGx5LW11dGF0aW9ucy1vbi1kZWx0YXMnO1xudmFyIERlbHRhQ2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZShnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcbiAgICAgICAgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUgPSBnZXRVc2VyRGlzcGxheU5hbWU7XG4gICAgICAgIHRoaXMubG9va3VwID0ge307XG4gICAgfVxuICAgIERlbHRhQ2FjaGUucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgX2EpIHtcbiAgICAgICAgdmFyIG9wdGltaXN0aWMgPSAoX2EgPT09IHZvaWQgMCA/IHsgb3B0aW1pc3RpYzogZmFsc2UgfSA6IF9hKS5vcHRpbWlzdGljO1xuICAgICAgICAvLyBBcHBseSBtdXRhdGlvbnMgbG9jYWxseSBvbnRvIHRoZSBEZWx0YUNhY2hlIGFuZCBub3RpZnkgdGhlaXIgc3Vic2NyaWJlcnNcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYiA9IE9iamVjdC5rZXlzKHRoaXMubG9va3VwKTsgX2kgPCBfYi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBxdWVyeUtleSA9IF9iW19pXTtcbiAgICAgICAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5sb29rdXBbcXVlcnlLZXldO1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnN0ZWFkIGhlcmU6IFN0b3JlIHRoZSBtdXRhdGlvbnMgb24gY2FjaGVFbnRyeS4gTm8gbWF0dGVyIGlmIGl0IHlldCBoYXMgdmFsdWUgb3Igbm90LlxuICAgICAgICAgICAgICAgIC8vIFRoZW4gYXBwbHkgbXV0YXRpb24gd2hlbmV2ZXIgc3Vic2NyaWJpbmchIChCZXR0ZXIgaGFuZGxpbmcgb2YgbXV0YXRpb25zIHRoYXQgYXJyaXZlcyBiZWZvcmUgZmV0Y2goKSBpcyBkb25lKVxuICAgICAgICAgICAgICAgIC8vIChTZWUgaG93IEkgaGFuZGxlIHRoaXMgaW4gcXVlcnktc2V0LnRzKVxuICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IGFwcGx5TXV0YXRpb25zT25EZWx0YXMoY2FjaGVFbnRyeS5xdWVyeS5icmFuY2hJZCwgY2FjaGVFbnRyeS52YWx1ZSwgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSgpLCAhIWNhY2hlRW50cnkucXVlcnkudGFncyk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBtdXRhdGlvbiByZXF1aXJlcyBjYWNoZUVudHJ5IHRvIGJlIHJlZmV0Y2hlZCBmcm9tIHNlcnZlclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbGxlciBoYXMgc3VjY2Vzc2Z1bGx5IHBlcmZvcm1lZCB0aGUgbXV0YXRpb25zIGFuZCBnb3Qgc3VjY2VzcyBiYWNrIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBvayB0byByZWZldGNoIHRoZSBkZWx0YXMgZnJvbSBzZXJ2ZXIgbm93OlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5mZXRjaCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWZ0ZXIgZmV0Y2ggY29tcGxldGVzLCBpdCB3aWxsIG5vdGlmeSB0aGUgc3Vic2NyaWJlcnMuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbHVlICE9PSBjYWNoZUVudHJ5LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkub3B0aW1pc3RpY1ZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYylcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkudmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5ub3RpZnkobmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVsdGFDYWNoZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHF1ZXJ5LCBvYnNlcnZlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2FjaGVFbnRyeSA9IHRoaXMubG9va3VwW3F1ZXJ5LmJyYW5jaElkICsgcXVlcnkudGFnc107XG4gICAgICAgIGlmICghY2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgY2FjaGVFbnRyeSA9IG5ldyBEZWx0YUNhY2hlRW50cnkodGhpcy5nZXRDbGllbnQoKSwgcXVlcnkpO1xuICAgICAgICAgICAgdGhpcy5sb29rdXBbcXVlcnkuYnJhbmNoSWQgKyBxdWVyeS50YWdzXSA9IGNhY2hlRW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhY2hlRW50cnkuY2xlYW51cFRpbWVyKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIpO1xuICAgICAgICAgICAgY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNhY2hlRW50cnkuc3Vic2NyaWJlcnMgPSBjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBfYS5vYnNlcnZlcjtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG8gIT09IG9ic2VydmVyO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LmNsZWFudXBUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzLmxvb2t1cFtxdWVyeS5icmFuY2hJZCArIHF1ZXJ5LnRhZ3NdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5wdXNoKHsgb2JzZXJ2ZXI6IG9ic2VydmVyLCBzdWJzY3JpcHRpb246IHN1YnNjcmlwdGlvbiB9KTtcbiAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcbiAgICAgICAgICAgIC8vIFZhbHVlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgYWxyZWFkeS4gUGljayBmcm9tIGNhY2hlLlxuICAgICAgICAgICAgb2JzZXJ2ZXIoY2FjaGVFbnRyeS5vcHRpbWlzdGljVmFsdWUgfHwgY2FjaGVFbnRyeS52YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjYWNoZUVudHJ5LmlzRmV0Y2hpbmcpIHtcbiAgICAgICAgICAgIC8vIEEgdmFsdWUgaXMgb24gaXRzIHdheS4gU2l0IGJhY2sgYW5kIHJlbGF4LiBBbGwgcmVnaXN0ZXJlZFxuICAgICAgICAgICAgLy8gb2JzZXJ2ZXJzIChpbmNsdWRpbmcgdGhpcyBvbmUpIHdpbGwgYmUgbm90aWZpZWQgd2hlbiBkYXRhIGFycml2ZXNcbiAgICAgICAgICAgIC8vIG9yIGZhaWxzLlxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNhY2hlRW50cnkuZXJyb3IpIHtcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGNhY2hlRW50cnkuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjYWNoZUVudHJ5LmZldGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICB9O1xuICAgIHJldHVybiBEZWx0YUNhY2hlO1xufSgpKTtcbmV4cG9ydCB7IERlbHRhQ2FjaGUgfTtcbnZhciBEZWx0YUNhY2hlRW50cnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZUVudHJ5KGNsaWVudCwgcXVlcnkpIHtcbiAgICAgICAgdGhpcy5mZXRjaE9wZXJhdGlvbklkID0gMDsgLy8gTWFrZXMgc3VyZSBhIHJlLWZldGNoIHdpbGwgZGlzY2FyZCB0aGUgcmVzdWx0IGZyb20gYW55IG9uZ29pbmcgZmV0Y2guXG4gICAgICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xuICAgICAgICB0aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5vcHRpbWlzdGljVmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmNsZWFudXBUaW1lciA9IG51bGw7XG4gICAgfVxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBmZXRjaE9wZXJhdGlvbklkID0gKyt0aGlzLmZldGNoT3BlcmF0aW9uSWQ7XG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuZmV0Y2hGcm9tU2VydmVyKCkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3NcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhbHVlLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGIuZGF0ZVRpbWUgLSBhLmRhdGVUaW1lOyB9KTsgLy8gTGF0ZXN0IGZpcnN0XG4gICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5vcHRpbWlzdGljVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnkodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIC8vIEZhaWxcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgX3RoaXMuZmFpbChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mZXRjaEZyb21TZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucXVlcnkuYnJhbmNoSWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEZWx0YXMgb25seSBhdmFpbGFibGUgb24gYnJhbmNoZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50Lmh0dHAuZ2V0KCdkZWx0YXMnLCB0aGlzLnF1ZXJ5KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPj0gMzAwIHx8IHJlcy5zdGF0dXMgPCAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUubm90aWZ5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnN1YnNjcmliZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBvYnNlcnZlciA9IF9iLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYi5zdWJzY3JpcHRpb247XG4gICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHZhciBjb3B5ID0gdGhpcy5zdWJzY3JpYmVycy5zbGljZSgpO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY29weV8xID0gY29weTsgX2kgPCBjb3B5XzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBjb3B5XzFbX2ldLCBvYnNlcnZlciA9IF9hLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYS5zdWJzY3JpcHRpb247XG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIERlbHRhQ2FjaGVFbnRyeTtcbn0oKSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1jYWNoZS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gJy4uLy4uL29ic2VydmFibGUnO1xudmFyIERlbHRhQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEZWx0YUNvbGxlY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRGVsdGFDb2xsZWN0aW9uKGRlbHRhQ2FjaGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuZGVsdGFDYWNoZS5zdWJzY3JpYmUocXVlcnksIG9ic2VydmVyKTsgfSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZGVsdGFDYWNoZSA9IGRlbHRhQ2FjaGU7XG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgRGVsdGFDb2xsZWN0aW9uLnByb3RvdHlwZS50YWdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRGVsdGFDb2xsZWN0aW9uKHRoaXMuZGVsdGFDYWNoZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSwgeyB0YWdzOiB0YWdzIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBEZWx0YUNvbGxlY3Rpb247XG59KENvbGxlY3Rpb24pKTtcbmV4cG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtY29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGVsdGEoZG9jLCBkZWx0YSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEpO1xuICAgIHZhciB0YXJnZXREb2MgPSBkb2M7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XG4gICAgICAgIGlmICh0YXJnZXREb2MgPT09IGRvYylcbiAgICAgICAgICAgIHRhcmdldERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YVtrZXldO1xuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG1pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiR1bnNldFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZyBvbiB0YXJnZXQgZG9jIVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvYy4kd2FzVW5zZXQgPSB0cnVlOyAvLyBKdXN0IG1hcmsgaXQgZm9yIHJlLXJldHJpZXZhbCBhZnRlciBzdWNjZXNzZnVsIHBvc3RpbmcgY2hhbmdlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGQgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb0FkZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBcnJheSA9IHRhcmdldERvY1trZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0YXJnZXRBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gdGFyZ2V0QXJyYXkuc2xpY2UoKTsgLy8gT24gSlMgc2lkZSwgd2UgbXVzdCBiZSBpbW11dGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB0YXJnZXRBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlc1RvQWRkXzEgPSB2YWx1ZXNUb0FkZDsgX2kgPCB2YWx1ZXNUb0FkZF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IHZhbHVlc1RvQWRkXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldEFycmF5LmluY2x1ZGVzKHYpKSB7IC8vIGF2b2lkIGR1cHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5LnB1c2godik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzEgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzEuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMSA9IG1ldGFJbnN0cnVjdGlvbnM7IF9hIDwgbWV0YUluc3RydWN0aW9uc18xLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzFbX2FdO1xuICAgICAgICAgICAgICAgICAgICBfbG9vcF8xKG1pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB2YWw7XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXREb2M7XG59XG4vLyB7bmFtZTogXCJVbGxhXCJ9LCB7bmFtZTogeyR1bnNldDowfVxuLy8ge3RhZ3M6IHskYWRkOiBcImhlalwifX0sIHt0YWdzOiB7JHVuc2V0OjB9XCJ9XG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VEZWx0YXMoZGVsdGExLCBkZWx0YTIsIF9hKSB7XG4gICAgdmFyIHJlbW92ZVVuc2V0UHJvcHMgPSAoX2EgPT09IHZvaWQgMCA/IHsgcmVtb3ZlVW5zZXRQcm9wczogZmFsc2UgfSA6IF9hKS5yZW1vdmVVbnNldFByb3BzO1xuICAgIC8vcmV0dXJuIHsuLi5kZWx0YTEsIC4uLmRlbHRhMn07XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YTIpO1xuICAgIHZhciB0YXJnZXREZWx0YSA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhMSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzOyBfaSA8IGtleXNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMltfaV07XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YTJba2V5XTtcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChtaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkdW5zZXRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdmVVbnNldFByb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gbWF0dGVyIGlmIHRhcmdldERlbHRhIGlzIGVtcHR5IG9yIGhhcyB2YWx1ZS4gU2V0IGl0IHRvIHskdW5zZXQ6MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gbWFrZSBzdXJlIHRoZSB2ZXJ5IGVuZCByZXN1bHQgd2lsbCBoYXZlIHskdW5zZXQ6MH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHsgJHVuc2V0OiAwIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZF8yID0gbWlWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9BZGRfMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldERlbHRhW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXRNZXRhUHJvcCA/IHRzbGliXzEuX19hc3NpZ24oe30sIHRhcmdldE1ldGFQcm9wKSA6IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB0YXJnZXRNZXRhUHJvcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCwganVzdCBjaGVjayBpZiB0YXJnZXQgbWV0YVByb3AgaGFzIHskcmVtb3ZlOiBbLi4uaXRlbXNdfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHNvLCByZW1vdmUgYW55IGVxdWFsIGl0ZW1zIGZyb20gdGhlcmUgYmVmb3JlIG1lcmdpbmcgdGhlIHskYWRkOiBbLi4uXX0gYXJyYXlzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFyZ2V0UmVtb3ZlQXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRyZW1vdmUgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9BZGRfMi5pbmNsdWRlcyh0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgJHJlbW92ZSBhcnJheSBiZWNhbWUgZW10cHkuIFJlbW92ZSB0aGUgJHJlbW92ZSBwcm9wLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93IGl0J3MgdGltZSB0byBtZXJnZSBvciBjcmVhdGUgdGFyZ2V0ICRhZGQgYXJyYXkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJGFkZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheSA9IHRhcmdldEFkZEFycmF5ID8gdGFyZ2V0QWRkQXJyYXkuY29uY2F0KHZhbHVlc1RvQWRkXzIpIDogdmFsdWVzVG9BZGRfMi5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRhZGQgPSB0YXJnZXRBZGRBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMiA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JGFkZDogWy4uLml0ZW1zXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JHJlbW92ZTogWy4uLl19IGFycmF5cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldEFkZEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFkZEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzIuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJGFkZC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRhZGQgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRhZGQgcHJvcC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kYWRkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkcmVtb3ZlIGFycmF5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRSZW1vdmVBcnJheSA/IHRhcmdldFJlbW92ZUFycmF5LmNvbmNhdCh2YWx1ZXNUb1JlbW92ZV8yKSA6IHZhbHVlc1RvUmVtb3ZlXzIuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID0gdGFyZ2V0UmVtb3ZlQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgbWV0YUluc3RydWN0aW9uc18yID0gbWV0YUluc3RydWN0aW9uczsgX2IgPCBtZXRhSW5zdHJ1Y3Rpb25zXzIubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMltfYl07XG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzIobWkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdmFsO1xuICAgIH1cbiAgICByZXR1cm4gdGFyZ2V0RGVsdGE7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1tZXJnZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXJlcG8nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbmV4cG9ydCAqIGZyb20gJy4vbXV0YXRpb24tcXVldWUnO1xuZXhwb3J0ICogZnJvbSAnLi9xdWVyeS1zZXQnO1xuZXhwb3J0ICogZnJvbSAnLi4vb2JzZXJ2YWJsZS9taXhpbic7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgQmF0Y2hSdW5uZXIgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xuaW1wb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9IGZyb20gXCIuL2tlZGJhY2tlbmQtc3Vic2NyaXB0aW9uXCI7XG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xuaW1wb3J0IHsgS2VkQmFja2VuZFF1ZXJ5IH0gZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tICcuLi9vYnNlcnZhYmxlL2NvbGxlY3Rpb24nO1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgXCJsaXZlXCIgcXVlcnkgYWdhaW5zdCBhIHRhYmxlIG9yIGZpbHRlcmVkIHRhYmxlLlxuICovXG52YXIgS2VkQmFja2VuZENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoS2VkQmFja2VuZENvbGxlY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENvbGxlY3Rpb24ocmVwbywgdGFibGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG5ldyBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uKG9ic2VydmVyLCBfdGhpcyk7XG4gICAgICAgICAgICBfdGhpcy5yZXBvLnF1ZXJ5U2V0LnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucmVwbyA9IHJlcG87XG4gICAgICAgIF90aGlzLnRhYmxlID0gdGFibGU7XG4gICAgICAgIF90aGlzLnF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJxdWVyeUtleVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEtlZEJhY2tlbmRRdWVyeS5xdWVyeUtleSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJpbmNsdWRlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luY2x1ZGVzIHx8ICh0aGlzLl9pbmNsdWRlcyA9IFtdLmNvbmNhdCh0aGlzLnF1ZXJ5LmluY2x1ZGUgfHwgW10pKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFwcGx5UXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBLZWRCYWNrZW5kQ29sbGVjdGlvbih0aGlzLnJlcG8sIHRoaXMudGFibGUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMucXVlcnksIHF1ZXJ5KSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkVG9RdWVyeUFycmF5UHJvcCA9IGZ1bmN0aW9uIChhcnJheVByb3AsIGVudHJpZXMpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KChfYSA9IHt9LCBfYVthcnJheVByb3BdID0gKHRoaXMucXVlcnlbYXJyYXlQcm9wXSB8fCBbXSkuY29uY2F0KGVudHJpZXMpLCBfYSkpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZEZsYWdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmxhZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGZsYWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImZsYWdzXCIsIGZsYWdzKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGRlYnVnOiB0cnVlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzQW5kTmFtZXNPbmx5XCIpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNPbmx5XCIpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaW5jbHVkZUlkc0FuZE5hbWVzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5iZXR3ZWVuID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBmcm9tOiBmcm9tLCB0bzogdG8gfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucm9sZSA9IGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyByb2xlOiByb2xlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzRnJvbSA9IGZ1bmN0aW9uIChpZHMpIHtcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBpZCBsaXN0IGdpdmVuIHRvIENvbGxlY3Rpb24uaGFzRWRnZXNGcm9tKFwiICsgSlNPTi5zdHJpbmdpZnkoaWRzKSArIFwiKVwiKTtcbiAgICAgICAgdmFyIGhlZiA9IHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImhhc0VkZ2VzRnJvbVwiLCBpZHMpO1xuICAgICAgICByZXR1cm4gaGVmO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzVG8gPSBmdW5jdGlvbiAoaWRzKSB7XG4gICAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8IGlkcy5zb21lKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gIWlkOyB9KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzVG8oXCIgKyBKU09OLnN0cmluZ2lmeShpZHMpICsgXCIpXCIpO1xuICAgICAgICB2YXIgaGV0ID0gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaGFzRWRnZXNUb1wiLCBpZHMpO1xuICAgICAgICByZXR1cm4gaGV0O1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcbiAgICAgICAgICAgIG9uWmVybzogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBlbnRpdHkgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXG4gICAgICAgICAgICBvbk1hbnk6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgZW50cmllcyBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzID0gZnVuY3Rpb24gKGlkcykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IHRhZ3M6IHRhZ3MgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JhcGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaW5jbHVkZVwiLCBncmFwaHMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmNhY2hlT3B0aW1pemVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgY2FjaGVCdXN0OiBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMucmVwby5nZXRVc2VyKCksIHRoaXMuaW5jbHVkZXMpIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm11dGF0aW9uc09uRW1wdHkgPSBmdW5jdGlvbiAobXV0YXRpb25GYWN0b3J5KSB7XG4gICAgICAgIHZhciB0eCA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgbXV0YXRpb25zT25FbXB0eTogdHgubXV0YXRpb25SZXF1ZXN0cyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hID0gdGhyb3dlcnMgfHwge30sIG9uWmVybyA9IF9hLm9uWmVybywgb25NYW55ID0gX2Eub25NYW55O1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChvblplcm8pXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpdGVtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcbiAgICAgICAgICAgICAgICAgICAgb25NYW55KCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbMF07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLypjb21iaW5lTGF0ZXN0PFRPdGhlcj4ob3RoZXI6IFF1ZXJ5T2JzZXJ2YWJsZTxUT3RoZXI+KSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcbiAgICB9Ki9cbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRvYywgY2hhbmdlcywgZGVib3VuY2UpIHtcbiAgICAgICAgaWYgKGRlYm91bmNlID09PSB2b2lkIDApIHsgZGVib3VuY2UgPSAxMDAwOyB9XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxuICAgICAgICAgICAgICAgIGlkOiBkb2MuaWQsXG4gICAgICAgICAgICAgICAgZGVsdGFEb2M6IGNoYW5nZXMsXG4gICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogZG9jLm5hbWVcbiAgICAgICAgICAgIH1dLCBkZWJvdW5jZSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkUmVsYXRlZCA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWREb2MpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ2FkZC1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlUmVsYXRlZCA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWREb2MpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3JlbW92ZS1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLnF1ZXJ5LmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidW5kbyBsaW5rcyBjYW4gb25seSBiZSBwZXJmb3JtZWQgb24gYnJhbmNoZXNcIik7XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICd1bmRvLWxpbmsnLFxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxuICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICBncmFwaFByb3A6IGxhYmVsLFxuICAgICAgICAgICAgICAgIHJlbGF0ZWRJZDogcmVsYXRlZElkXG4gICAgICAgICAgICB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaWRzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBpZHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShpZHMubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgIG9wOiAnZGVsZXRlJyxcbiAgICAgICAgICAgIHRhYmxlOiBfdGhpcy50YWJsZSxcbiAgICAgICAgICAgIGlkOiBpZFxuICAgICAgICB9KTsgfSksIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLnJlcG8ucXVlcnlTZXQudW5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kQ29sbGVjdGlvbjtcbn0oQ29sbGVjdGlvbikpO1xuZXhwb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfTtcbi8qbWl4aW4oXG4gIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSxcbiAgTWFwcGVkQ29sbGVjdGlvbi5wcm90b3R5cGUsXG4gIFwibWFwXCIsIFwiZmxhdFwiLCBcImNvbmNhdFwiLCBcInJlbmRlclwiLCBcImxvYWRcIik7Ki9cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtY29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdXBkYXRlQXJyYXkgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQvdXRpbHMnO1xuaW1wb3J0IHsgYnJhbmNoU2Vuc2l0aXZlLCBnZXRUYWJsZUZyb21MYWJlbCB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgYXBwbHlEZWx0YSB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIEtlZEJhY2tlbmRRdWVyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUXVlcnkodGFibGUsIHF1ZXJ5LCB1c2VyLCByZXBvLCBtdXRhdGlvblF1ZXVlKSB7XG4gICAgICAgIHRoaXMudGFibGUgPSB0YWJsZTtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xuICAgICAgICB0aGlzLnJlcG8gPSByZXBvO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5kYXRhID0gW107XG4gICAgICAgIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW52YWxpZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvYWRlZFZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9sb2FkUHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMuaW5jbHVkZXMgPSBxdWVyeS5pbmNsdWRlID9cbiAgICAgICAgICAgIHR5cGVvZiBxdWVyeS5pbmNsdWRlID09PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICAgICAgW3F1ZXJ5LmluY2x1ZGVdIDpcbiAgICAgICAgICAgICAgICBxdWVyeS5pbmNsdWRlIDpcbiAgICAgICAgICAgIFtdO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5KSB7XG4gICAgICAgIHZhciBtdXRhdGlvbnNPbkVtcHR5ID0gcXVlcnkubXV0YXRpb25zT25FbXB0eSwgY29tcGFyYWJsZVByb3BzID0gdHNsaWJfMS5fX3Jlc3QocXVlcnksIFtcIm11dGF0aW9uc09uRW1wdHlcIl0pO1xuICAgICAgICByZXR1cm4gdGFibGUgKyBKU09OLnN0cmluZ2lmeShjb21wYXJhYmxlUHJvcHMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUsIFwicXVlcnlLZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhLCBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgJiYgIXRoaXMuaW52YWxpZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSwgdHJ1ZSwgdGhpcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLnF1ZXJ5TG9jYWxseSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxvYWRQcm9taXNlO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbXV0YXRpb25zT25FbXB0eSBzaG91bGQgbmV2ZXIgYmUgdXNlZCB0d2ljZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5xdWVyeS5tdXRhdGlvbnNPbkVtcHR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIXZlcnNpb24gJiYgdGhpcy5fbG9hZFByb21pc2UpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2xvYWRQcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiBcbiAgICAgICAgICAgICAgICAgICAgLy8gbG9hZGluZyBpcyBvbmdvaW5nLCBhbmQgY2FsbGVyIGRvZXMgbm90IHJlcXVpcmUgYSByZWNlbnQgcmVmcmVzaC5cbiAgICAgICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgdGhlIG9uZ29pbmcgbG9hZCB0byBjb21wbGV0ZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgdGhpcy5yZXBvLndyaXRlci5wZXJzaXN0ZWRWZXJzaW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkUHJvbWlzZSA9IHRoaXMuX2xvYWQodmVyc2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbG9hZFByb21pc2UgPT09IGxvYWRQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkZWRWZXJzaW9uID0gTWF0aC5tYXgoX3RoaXMubG9hZGVkVmVyc2lvbiwgdmVyc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9vbmUgaGFzIHJlZnJlc2hlZCBvdXIgbG9hZC4gVGhlIGVycm9yIGlzIHRoZSBmaW5hbCByZXN1bHQuIFNldCBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBXZSdyZSBmaW5pc2hlZC4gRGF0YSBvciBlcnJvciBpcyBhbHJlYWR5IHNldC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBnb3RJbml0aWFsUmVzcG9uc2UgdG8gdHJ1ZSBhbmQgbm90aWZ5IHN1YnNjcmliZXJzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnlTdWJzY3JpYmVycyhfdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgbW9yZSByZWNlbnQgY2FsbCB0byBsb2FkKCkgaXMgb25nb2luZywgT1Igd2FzIG9uZ29pbmcgYnV0IHJlc3BvbmRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWZvcmUgdXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIGFueSBjYXNlIHJldHVybiB0aGlzLl9sb2FkUHJvbWlzZS4gSWYgaXQncyBvbmdvaW5nIHdlJ2xsIHdhaXQgZm9yIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIGZpbmlzaC4gSWYgaXQncyBudWxsLCB3ZSdsbCBiZSByZXR1cm5pbmcgZmluYWxseSBoZXJlIHdpdGhvdXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW55IGFjdGlvbiwgYmVjYXVzZSB0aGUgYWN0aW9uIHdhcyB0YWtlbiBieSB0aGUgcmVmcmVzaGVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2xvYWRQcm9taXNlOyAvLyBXYWl0IGZvciB0aGUgcmVmcmVzaGVkIGxvYWQgdG8gY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRQcm9taXNlXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuX2xvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm11dGF0aW9uUXVldWUuYWZmZWN0c1F1ZXJ5KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMuaW5jbHVkZXMpKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBvdXRnb2luZyBtdXRhdGlvbnMgdGhhdCBhZmZlY3RzIHRoaXMgcXVlcnkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLndyaXRlci53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCh2ZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBvdXRnb2luZyBtdXRhdGlvbnMgdGhhdCBhZmZlY3RzIHRoaXMgcXVlcnkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXJ2ZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gdGhpcy5zdWJzY3JpcHRpb25zLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gc3Vic2NyaXB0aW9uOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuY29tbWl0TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgdmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfaSwgbXV0YXRpb25zXzEsIG0sIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICBtID0gbXV0YXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgJiYgKG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdtZXJnZScgJiYgKCFtLnRhcmdldEJyYW5jaElkIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PT0gdGhpcy5xdWVyeS5icmFuY2hJZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0udGFyZ2V0QnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICd1cGRhdGUnICYmICgobS5kZWx0YURvYy50YWdzICYmIHRoaXMucXVlcnkudGFncykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobS5kZWx0YURvYy5uYW1lICYmIHRoaXMucXVlcnkubmFtZSkpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBIHRhZyBtYXkgaGF2ZSBiZWVuIGFkZGVkLCBvciByZW5hbWVkLCBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21taXQgdGhlIG11dGF0aW9ucyBsb2NhbGx5IGFzIHdlIGRvbid0IGhhdmUgYWxsIGluZm8uXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBIHRhZyBtYXkgaGF2ZSBiZWVuIGFkZGVkLCBvciByZW5hbWVkLCBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21taXQgdGhlIG11dGF0aW9ucyBsb2NhbGx5IGFzIHdlIGRvbid0IGhhdmUgYWxsIGluZm8uXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKG11dGF0aW9ucywgZmFsc2UsIHRoaXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA5O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnJlZnJlc2hPckludmFsaWRhdGUgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCh2ZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVycyA9IGZ1bmN0aW9uIChvcHRpbWlzdGljTXV0YXRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmRhdGEgJiYgdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHZhciBkYXRhXzEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChvcHRpbWlzdGljTXV0YXRpb25zLCB0cnVlLCB0aGlzLmRhdGEpO1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICBzLm5vdGlmeVN1YnNjcmliZXIoZGF0YV8xLCBfdGhpcy5lcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlcG8ucXVlcnlTZXQucXVlcnlMb2NhbGx5KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMuaW5jbHVkZXMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeVNlcnZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlcG8uZ2V0Q2xpZW50KCkubGlzdCh0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5KSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRhdGFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkID0gZnVuY3Rpb24gKG11dGF0aW9ucywgb3B0aW1pc3RpYywgZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcbiAgICAgICAgICAgIGRhdGEgPSBfdGhpcy5hcHBseU11dGF0aW9uc09uRGF0YShkYXRhLCBtdXRhdGlvbiwgb3B0aW1pc3RpYyk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuYXBwbHlNdXRhdGlvbnNPbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSwgbSwgb3B0aW1pc3RpYykge1xuICAgICAgICBpZiAoYnJhbmNoU2Vuc2l0aXZlKG0pICYmIG0uYnJhbmNoSWQgIT0gdGhpcy5xdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB2YXIgX2EgPSB0aGlzLCB0YWJsZSA9IF9hLnRhYmxlLCBpbmNsdWRlcyA9IF9hLmluY2x1ZGVzLCBsaXN0T3B0aW9ucyA9IF9hLnF1ZXJ5O1xuICAgICAgICB2YXIgc291cmNlSWRzID0gbGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tID8gW10uY29uY2F0KGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSB8fCBbXSkgOiBbXTtcbiAgICAgICAgdmFyIHJlcXVlc3RlZFRhZ3MgPSBsaXN0T3B0aW9ucy50YWdzID8gW10uY29uY2F0KGxpc3RPcHRpb25zLnRhZ3MgfHwgW10pIDogW107XG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzoge1xuICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgPT09IG0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGRlbHRhIG9uIHVwZGF0ZWQgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkRG9jID0gYXBwbHlEZWx0YShkb2MsIG0uZGVsdGFEb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZERvYy4kbWV0YSA9ICd1cGRhdGluZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlZERvYztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBpZCBkb2VzIG5vdCBhcHBseSB0byB0aGlzIGRvYywgc2VhcmNoIGluIGdyYXBocyB0aGUgaWQgaXMgZm91bmRcbiAgICAgICAgICAgICAgICAgICAgLy8gYW1vbmcgZ3JhcGggaW5jbHVkZWQgZG9jcywgYW5kIGlmIHNvLCB1cGRhdGUgdGhhdCBvbmU6XG4gICAgICAgICAgICAgICAgICAgIGluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlZERvY3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZEFycmF5ID0gdXBkYXRlQXJyYXkoaW5jbHVkZWREb2NzLCBmdW5jdGlvbiAocmVsYXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRlZC5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWxhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZFJlbGF0ZWQgPSBhcHBseURlbHRhKHJlbGF0ZWQsIG0uZGVsdGFEb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW1pc3RpYylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRSZWxhdGVkLiRtZXRhID0gJ3VwZGF0aW5nJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRSZWxhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkQXJyYXkgIT09IGluY2x1ZGVkRG9jcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVtsYWJlbF0gPSB1cGRhdGVkQXJyYXksIF9hKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ2FkZC1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXMgYGRiLmNvdXJzZUJsb2Nrcy4uLi53aGF0ZXZlci4uIC5pbmNsdWRlKFwiYWJpbGl0aWVzXCIpYCwgZGV0ZWN0OiBkYi5jb3Vyc2VCbG9ja3MuYWRkUmVsYXRlZChibG9ja0lkLCAnYWJpbGl0aWVzJywgLi4uKVxuICAgICAgICAgICAgICAgICAgICAvLyAuLi5iZWNhdXNlIHRhYmxlID0gJ2NvdXJzZUJsb2NrcycgYW5kIGluY2x1ZGVzIGhhcyBcImFiaWxpdGllc1wiLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLnJlbGF0ZWREb2MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZERvYy4kbWV0YSA9ICdhZGRpbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IGRvY1ttLmdyYXBoUHJvcF0uY29uY2F0KFtyZWxhdGVkRG9jXSksIF9hKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VJZHMuaW5jbHVkZXMobS5pZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGBkYi5jb3Vyc2VCbG9ja3MuaGFzRWRnZXNGcm9tKFtjb3Vyc2VJZF0pYCAgKG1lYW5pbmcgdGFibGU9J2NvdXJzZUJsb2NrcycgYW5kIHNvdXJjZUlkcyBpbmNsdWRlcyBjb3Vyc2VJZClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICwgZGV0ZWN0OiBkYi5jb3Vyc2VJbnN0YW5jZXMuYWRkUmVsYXRlZChjb3Vyc2VJZCwgJ2NvdXJzZUJsb2NrcycsIC4uLi4pIC8vIG0uZ3JhcGhQcm9wID09PSAnYmxvY2tzJy0tPiBnZXRUYWJsZUZyb21MYWJlbCAtLT4gJ2NvdXJzZUJsb2NrcydcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gZ2V0VGFibGVGcm9tTGFiZWwobS50YWJsZSwgbS5ncmFwaFByb3ApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0T3B0aW9ucy50YWdzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtLnJlbGF0ZWREb2MudGFncyAmJiByZXF1ZXN0ZWRUYWdzLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4gbS5yZWxhdGVkRG9jLnRhZ3MuaW5jbHVkZXModGFnKTsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmlkcyAmJiBsaXN0T3B0aW9ucy5pZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIGlkID09PSBtLnJlbGF0ZWREb2MuaWQ7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEEgY2VydGFpbiBJRCBpcyBvYnNlcnZlZC4gQSBkb2Mgd2l0aCB0aGlzIGlkIGlzIGJlaW5nIGFkZGVkLlxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIGRvYyB0byB0aGUgcmVzdWx0LiBFeGFjdGx5IHRoaXMgV0lMTCBoYXBwZW4gaW4gdGhlIGZvbGxvd2luZyB0eXBpY2FsIHNjZW5hcmlvOlxuICAgICAgICAgICAgICAgICAgICAvLyAxLiBVc2VyIGFkZHMgYSByZWxhdGVkIGRvY3VtZW50IHRvIGEgbGlzdC5cbiAgICAgICAgICAgICAgICAgICAgLy8gMi4gRG9jdW1lbnQgcmVtYWlucyB3aXRoaW4gdGhlIE11dGF0aW9uUXVldWUgd2hpbGUgYmF0Y2gtcmVxdWVzdCBpcyBiZWluZyBwcm9jZXNzZWQgYnkgc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICAvLyAzLiBVc2VyIGNsaWNrcyB0aGUgYWRkZWQgaXRlbSB0byBlZGl0IG9yIHZpZXcgaXQgKG9yIG91ciBjb21wb25lbnQgcmVkaXJlY3RzIHRvIGl0cyBlZGl0b3IpXG4gICAgICAgICAgICAgICAgICAgIC8vIDQuIEEgbmV3IHF1ZXJ5IG9mIHRoYXQgcGFydGljdWxhciBJRCBpcyBzdWJzY3JpYmVkIHRvIHtpZHM9W3RoZUlkXX1cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgS2VkQmFja2VuZFF1ZXJ5LnN1YnNjcmliZSB0aGVuIGRvZXMgdGhpczpcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAxLiBDYWxsIHF1ZXJ5TG9jYWxseSgpIGJlZm9yZSBxdWVyeWluZyBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAyLiBxdWVyeUxvY2FsbHkoKSBpbnNwZWN0cyBtdXRhdGlvbnMgYW5kIGZpbmRzIGEgbWF0Y2gsIHJldHVybmluZyBhbiBlbXB0eSBsaXN0XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgKGFzc3VtZXMgYXMgd2UgYXJlIGFkZGluZyBpdCwgaXQgY2FuJ3QgZXhpc3Qgb24gdGhlIHNlcnZlciBhbnl3YXkpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMy4gS2VkQmFja2VuZFFVZXJ5IGFwcGxpZXMgbXV0YXRpb25zIG9udG8gdGhlIGVtcHR5IGxpc3QsIGFuZCBlbmRzIHVwIGhlcmUgdG8gYWRkXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgaXQgb3B0aW1pc3RpY2FsbHkuXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNC4gV2hlbiBzZXJ2ZXIgcmVzcG9uZHMgd2l0aCAyMDAgT0ssIGNhbGxzIHVzIGhlcmUgYWdhaW4gd2l0aCBvcHRpbWlzdGljPWZhbHNlXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgdG8gXCJwZXJzaXN0XCIgaXQgaW4gdGhlIHF1ZXJ5J3MgZGF0YSBhcnJheS5cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICA0QjogSWYgbm90IDIwMCBPSywgbXV0YXRpb24gbWF5IGJlIGdvbmUgYW5kIHRoZSBzdWJzY3JpYmVyIHdpbGwgc2UgYW4gZXJyb3IgcGFnZVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwiQ291bGQgbm90IGZpbmQgZW50aXR5IHdpdGggaWQgWC5cIiBhbG9uZyB3aXRoIGEgcmVkIGVycm9yIG1lc3NhZ2Ugb24gdGhlIHNjcmVlblxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGFib3V0IHRoYXQgaXQgZmFpbGVkIHRvIHNhdmUgb24gc2VydmVyLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW20uZ3JhcGhQcm9wXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5jbHVkZWREb2NzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbS5ncmFwaFByb3BdID0gb3B0aW1pc3RpYyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayByZWxhdGVkLWRvYy10by1yZW1vdmUgd2l0aCAkbWV0YTogJ2RlbGV0aW5nJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZERvYy5pZCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgOiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkOyB9KSwgX2EpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUlkcy5pbmNsdWRlcyhtLmlkKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCA9PT0gbS5yZWxhdGVkRG9jLmlkID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZCwgeyAkbWV0YTogJ2RlbGV0aW5nJyB9KSA6IGQ7IH0pIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkOyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0uaWQ7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZFRhYmxlcyA9IGluY2x1ZGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gKHsgbGFiZWw6IGxhYmVsLCB0YWJsZTogZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB9KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IF9hLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09PSBtLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsc18xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gX2EubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYiA9IHt9LCBfYltsYWJlbF0gPSBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX2EuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgX2IpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc2V0R3JhcGhQcm9wcyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgdmFyIGNvcHkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xuaW1wb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfSBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbmltcG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jb2xsZWN0aW9uJztcbnZhciBLZWRCYWNrZW5kUmVwbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUmVwbyhnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucywgbXV0YXRpb25RdWV1ZSwgcXVlcnlTZXQsIHdyaXRlciwgY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5nZXRDbGllbnQgPSBnZXRDbGllbnQ7XG4gICAgICAgIHRoaXMuZ2V0VXNlciA9IGdldFVzZXI7XG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xuICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMgPSBkZWZhdWx0UXVlcnlPcHRpb25zO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMud3JpdGVyID0gd3JpdGVyO1xuICAgICAgICB0aGlzLmNhY2hlT3B0aW1pemVkID0gY2FjaGVPcHRpbWl6ZWQ7XG4gICAgICAgIGlmICghZGVmYXVsdFF1ZXJ5T3B0aW9ucylcbiAgICAgICAgICAgIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyA9IHt9O1xuICAgICAgICBpZiAoIW11dGF0aW9uUXVldWUpXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBuZXcgTXV0YXRpb25RdWV1ZSgpO1xuICAgICAgICBpZiAoIXF1ZXJ5U2V0KVxuICAgICAgICAgICAgdGhpcy5xdWVyeVNldCA9IG5ldyBRdWVyeVNldCh0aGlzLm11dGF0aW9uUXVldWUpO1xuICAgICAgICBpZiAoIXdyaXRlcilcbiAgICAgICAgICAgIHRoaXMud3JpdGVyID0gbmV3IEtlZEJhY2tlbmRXcml0ZXIodGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLnF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSk7XG4gICAgICAgIE9iamVjdC5rZXlzKHRhYmxlcykuZm9yRWFjaChmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICBpZiAoY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXNbdGFibGVdID0gY29sbGVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZGVsdGFzID0gbmV3IERlbHRhQ29sbGVjdGlvbih0aGlzLndyaXRlci5kZWx0YUNhY2hlLCB7XG4gICAgICAgICAgICBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkIC8vIElmIGJyYW5jaElkIGlzIHVuZGVmaW5lZC4gRGVsdGFDb2xsZWN0aW9uIHdpbGwgcmVzcG9uZCB3aXRoIEVycm9yIG9uIHN1YnNjcmliZSgpXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUudGFibGUgPSBmdW5jdGlvbiAodGFibGVOYW1lKSB7XG4gICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKHRoaXMsIHRhYmxlTmFtZSwgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zKTtcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVPcHRpbWl6ZWQpXG4gICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbiAocXVlcnlPcHRpb25zLCBjYWNoZU9wdGltaXplZCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgS2VkQmFja2VuZFJlcG8odGhpcy5nZXRDbGllbnQsIHRoaXMuZ2V0VXNlciwgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucywgcXVlcnlPcHRpb25zKSwgdGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLnF1ZXJ5U2V0LCB0aGlzLndyaXRlciwgY2FjaGVPcHRpbWl6ZWQgPT09IHVuZGVmaW5lZCA/IHRoaXMuY2FjaGVPcHRpbWl6ZWQgOiBjYWNoZU9wdGltaXplZCk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5icmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyByb2xlOiByb2xlIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLm9wdGltaXplQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7fSwgdHJ1ZSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGNsZWFyIG1hc3RlciBicmFuY2hcIik7XG4gICAgICAgIHRoaXMud3JpdGVyLm11dGF0ZShbeyBvcDogJ2NsZWFyLWJyYW5jaCcsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IG1lcmdlIGZyb20gbWFzdGVyIGJyYW5jaFwiKTtcbiAgICAgICAgdGhpcy53cml0ZXIubXV0YXRlKFt7IG9wOiAnbWVyZ2UnLCBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZDogdGFyZ2V0QnJhbmNoSWQgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnNhdmVOb3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMud3JpdGVyLndhaXRGb3JWZXJzaW9uVG9QZXJzaXN0KHRoaXMud3JpdGVyLmN1cnJlbnRWZXJzaW9uKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFJlcG87XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFJlcG8gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtcmVwby5qcy5tYXAiLCJ2YXIgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uKHN1YnNjcmliZXIsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcbiAgICB9XG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlciA9IGZ1bmN0aW9uIChkYXRhLCBlcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXJyb3IsIHRoaXMpO1xuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YSAhPT0gdGhpcy5sYXN0Tm90aWZpZWREYXRhKSB7IC8vIFdpbGwgaW4tZmFjdCBiZSBlcXVhbCBieSByZWZlcmVuY2UgaWYgZGF0YSBpcyBzYW1lIGFzIGxhc3Qgbm90aWZpY2F0aW9uIChhcyB3ZSB1c2UgYW4gaW1tdXRhYmxlIGFwcHJvYWNoIG9uIGRhdGEpXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0Tm90aWZpZWREYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoZGF0YSwgZXJyb3IsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoW10sIGV4LCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleDIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igd2hpbGUgbm90aWZ5aW5nIEtlZEJhY2tlbmRTdWJzY3JpYmVyOlwiLCBleDIsICdvcmlnaW5hbGx5IG5vdGlmaWVkIGVycm9yOicsIGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi51bnN1YnNjcmliZSh0aGlzKTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uO1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24gfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtc3Vic2NyaXB0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBNdXRhdGlvblF1ZXVlIH0gZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XG5pbXBvcnQgeyBCYXRjaFJ1bm5lciB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudCc7XG5pbXBvcnQgeyB0YWJsZXMgfSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJy4uL29ic2VydmFibGUnO1xuaW1wb3J0IHsgRGVsdGFDYWNoZSB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jYWNoZSc7XG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kV3JpdGVyKG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xuICAgICAgICB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSA9IGdldFVzZXJEaXNwbGF5TmFtZTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMucGVyc2lzdGVkVmVyc2lvbiA9IG5ldyBFbWl0dGVyKDApO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XG4gICAgICAgIHRoaXMuZGVsdGFDYWNoZSA9IG5ldyBEZWx0YUNhY2hlKGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzU2F2aW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiAhIXRoaXMuX2lzU2F2aW5nUHJvbWlzZTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzRWRpdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMDsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vblN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycy5wdXNoKGNhbGxiYWNrKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9mZiA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSB0aGlzLmVycm9yU3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBjYWxsYmFjazsgfSk7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycyA9IHRoaXMuc3RhdGVTdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IGNhbGxiYWNrOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IsIHJldHJ5YWJsZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJldHJ5YWJsZSwgX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhfdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoXykgeyB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubXV0YXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucywgZGVib3VuY2UpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmFkZChtdXRhdGlvbnMpO1xuICAgICAgICArK3RoaXMuY3VycmVudFZlcnNpb247XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgIHRoaXMuZGVsdGFDYWNoZS5hcHBseU11dGF0aW9ucyh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCksIHsgb3B0aW1pc3RpYzogdHJ1ZSB9KTtcbiAgICAgICAgaWYgKCF0aGlzLl9pc1NhdmluZ1Byb21pc2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHRoaXMuc2F2ZS5iaW5kKHRoaXMpLCBkZWJvdW5jZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgaXNTYXZpbmcsIHdlIGRvbid0IG5lZWQgdG8gZG8gYW55dGhpbmcsIGJlY2FzZSBpdCB3aWxsIHJlLWNoZWNrIGlmIGFkZGl0aW9uYWxcbiAgICAgICAgLy8gbXV0YXRpb25zIGhhdmUgY29tZSwgd2hlbiBzYXZpbmcgaXMgZG9uZS5cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLnJldHJ5U2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZWRWZXJzaW9uO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZWRWZXJzaW9uID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGVyc2lzdGVkVmVyc2lvbiA8IHZlcnNpb24pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZSgpOyAvLyBCZSBtb3JlIGVhZ2VyIHRvIHNhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5maWx0ZXIoZnVuY3Rpb24gKHBlcnNpc3RlZFZlcnNpb24pIHsgcmV0dXJuIHBlcnNpc3RlZFZlcnNpb24gPj0gdmVyc2lvbjsgfSkubG9hZCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5fdGltZW91dElkKVxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXRJZCk7XG4gICAgICAgIGlmICh0aGlzLl9pc1NhdmluZ1Byb21pc2UpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNTYXZpbmdQcm9taXNlO1xuICAgICAgICBpZiAoIXRoaXMuaXNFZGl0ZWQpXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lzU2F2aW5nUHJvbWlzZSA9IHRoaXMuX3NhdmUoKTtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDsgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5fc2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbXV0YXRpb25zLCB2ZXJzaW9uLCBtdXRhdGlvblJlcXVlc3RzLCByZXNfMSwgZXRhZ011dGF0aW9ucywgZXJyb3JfMTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gdGhpcy5jdXJyZW50VmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5tb3ZlVG9TYXZpbmdRdWV1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25SZXF1ZXN0cyA9IHRoaXMubWFwTXV0YXRpb25zKG11dGF0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgNiwgMTEsIDEyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmdldENsaWVudCgpLmJhdGNoKG11dGF0aW9uUmVxdWVzdHMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBldGFnTXV0YXRpb25zID0gT2JqZWN0LmtleXMocmVzXzEubmV3RXRhZ3MpLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YURvYzogeyAkZXRhZzogcmVzXzEubmV3RXRhZ3NbaWRdIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbnVsbCAvLyBXZSBkb24ndCBoYXZlIHRoZSB0YXJnZXQgbmFtZS4gQnV0IHRoaXMgbXV0YXRpb24gd29uJ3QgYmUgdmlzaWJsZSBpbiBhIERlbHRhQ29sbGVjdGlvbiBhbnl3YXksIHNvIGl0IHdvbnQgYmUgdXNlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY2FjaGVcbiAgICAgICAgICAgICAgICAgICAgICAgIENhY2hlQnVzdC5pbnZhbGlkYXRlQ2FjaGUobXV0YXRpb25SZXF1ZXN0cywgdGhpcy5nZXRVc2VyKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29tbW1pdCBtdXRhdGlvbnMgYWxvbmcgd2l0aCBldGFnTXV0YXRpb25zIGludG8gcXVlcmllcyBjYWNoZWQgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoKHZlcnNpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWx0YUNhY2hlLmFwcGx5TXV0YXRpb25zKG11dGF0aW9ucywgeyBvcHRpbWlzdGljOiBmYWxzZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXQuY29tbWl0TXV0YXRpb25zKE11dGF0aW9uUXVldWUubWVyZ2UobXV0YXRpb25zLCBldGFnTXV0YXRpb25zKSwgdmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbiBzdWNjZXNzLCBjbGVhciBzYXZpbmcgcXVldWUgYXMgdGhlIG11dGF0aW9ucyB3aWxsIG5vdyBiZSBjb21taXR0ZWQgdG8gYWxsIHF1ZXJ5J3MgZGF0YSBpbnN0ZWFkLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpOyAvLyBpc0VkaXRlZCBtYXkgaGF2ZSB0dXJuZWQgdG8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmFsbHksIG5vdGlmeSBzdWJzY3JpYmVycyBzbyB0aGF0IHZpZXdzIGdldCB1cGRhdGVkIHdpdGggY29tbWl0dGVkIHJlc3VsdHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhcyB3ZWxsLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc2F2ZSgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCAxMl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2hFcnJvcihlcnJvcl8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGVycm9yXzEgJiYgZXJyb3JfMS5uYW1lICYmIGVycm9yXzEubmFtZS5zdGFydHNXaXRoKFwiaHR0cDRcIikpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFjY2VzcyBDb250cm9sIGRlbmllZCwgYmFkIHJlcXVlc3Qgb3Igc2ltaWxhci4gVGhyb3cgbXV0YXRpb25zIGF3YXkuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpOyAvLyBpc0VkaXRlZCBtYXkgaGF2ZSB0dXJuZWQgdG8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIbyBobyEgQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYWxvbmUuIFRIZXkgbWlnaHQgYmUgbW9yZSBsdWNreS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3NhdmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvIGhvISBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhbG9uZS4gVEhleSBtaWdodCBiZSBtb3JlIGx1Y2t5LlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxMDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubWFwTXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgICB2YXIgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG0pIHtcbiAgICAgICAgICAgIHN3aXRjaCAobS5vcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLnVwZGF0ZShtLnRhYmxlLCBtLmlkLCBtLmRlbHRhRG9jLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIW0ucmVsYXRlZERvYy4kZXRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gJGV0YWcgbWVhbnMgdGhpcyBpcyBhIG5ldyBkb2N1bWVudC4gQWRkIGl0IGJlZm9yZSBsaW5raW5nIHRvIGl0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnIuYWRkKHRhYmxlc1ttLnRhYmxlXS5yZWxhdGlvbnNoaXBzW20uZ3JhcGhQcm9wXSwgbS5yZWxhdGVkRG9jLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBici5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkRG9jLmlkLCBtLmJyYW5jaElkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAncmVtb3ZlLXJlbGF0ZWQnOlxuICAgICAgICAgICAgICAgICAgICBici51bmxpbmsyKG0udGFibGUsIG0uaWQsIG0uZ3JhcGhQcm9wLCBtLnJlbGF0ZWREb2MuaWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd1bmRvLWxpbmsnOlxuICAgICAgICAgICAgICAgICAgICBici51bmRvTGluayhtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkSWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICBici5kZWxldGUobS50YWJsZSwgbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGJyLmNsZWFyQnJhbmNoKG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLm1lcmdlKG0uYnJhbmNoSWQsIG0udGFyZ2V0QnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRXcml0ZXI7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC13cml0ZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBtZXJnZURlbHRhcyB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIE11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XG4gICAgfVxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5xdWV1ZSwgbXV0YXRpb25zKTtcbiAgICB9O1xuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLm1vdmVUb1NhdmluZ1F1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gTXV0YXRpb25RdWV1ZS5tZXJnZSh0aGlzLnNhdmluZ1F1ZXVlLCB0aGlzLnF1ZXVlKTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2xlYXJTYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZmZlY3RzUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcbiAgICAgICAgaWYgKG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLm9wID09PSAnbWVyZ2UnIHx8IG0ub3AgPT09ICdjbGVhci1icmFuY2gnOyB9KSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XG4gICAgICAgICAgICAvLyBBIHF1ZXJ5IHdpdGggXCJpZHNcIiBmaWx0ZXIgd2lsbCBiZSBlYXN5IHRvIGRldGVjdCBhIG5vLW1hdGNoIG9uOlxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBnbG9iYWxPcChtKSB8fCAoIWJyYW5jaFNlbnNpdGl2ZShtKSB8fCBtLmJyYW5jaElkID09PSBxdWVyeS5icmFuY2hJZCkgJiZcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXV0YXRpb25zIGFmZmVjdCBzYW1lIGJyYW5jaCBhbmQgdGFibGUuIENvdWxkIGJlIGRvbmUgbW9yZSBmaW5lIGdyYWluZWQsXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgcmV0dXJuIG0ub3AgPT09ICdkZWxldGUnID9cbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XG4gICAgICAgICAgICAgICAgZ2xvYmFsT3AobSkgPyB0cnVlIDpcbiAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PSBxdWVyeS5icmFuY2hJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUxID0gcXVldWUxLnNsaWNlKCk7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUyID0gcXVldWUyLnNsaWNlKCk7XG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XG4gICAgICAgIHZhciBsZW4gPSBxdWV1ZTEubGVuZ3RoO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcbiAgICAgICAgICAgIGlmIChtLm9wID09PSAndXBkYXRlJykge1xuICAgICAgICAgICAgICAgIHZhciBvdmVybGFwcGluZ0lkT3BJZHggPSBtdXRhYmxlUXVldWUyLmZpbmRJbmRleChmdW5jdGlvbiAobmV3TXV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuYnJhbmNoSWQgPT09IG0uYnJhbmNoSWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5pZCA9PT0gbS5pZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3ZlcmxhcHBpbmdJZE9wSWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMVtpXSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0sIHsgZGVsdGFEb2M6IG1lcmdlRGVsdGFzKG0uZGVsdGFEb2MsIG11dGFibGVRdWV1ZTJbb3ZlcmxhcHBpbmdJZE9wSWR4XS5kZWx0YURvYykgfSk7XG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtdXRhYmxlUXVldWUxLmNvbmNhdChtdXRhYmxlUXVldWUyKTtcbiAgICB9O1xuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xufSgpKTtcbmV4cG9ydCB7IE11dGF0aW9uUXVldWUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfSBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG52YXIgUXVlcnlTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUXVlcnlTZXQobXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBbXTtcbiAgICB9XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwodGhpcy5xdWVyaWVzLm1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5jb21taXRNdXRhdGlvbnMobXV0YXRpb25zLCB2ZXJzaW9uKTsgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW52YWxpZFF1ZXJpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuY2xlYW51cEludmFsaWRRdWVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7XG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHEudGltZW91dEhhbmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3B0aW1pc3RpY011dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIHEubm90aWZ5U3Vic2NyaWJlcnMob3B0aW1pc3RpY011dGF0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmZpbmRRdWVyeSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcmllcy5maW5kKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLnF1ZXJ5S2V5ID09PSBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGFibGUsIHF1ZXJ5KTsgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgLy8gRm9yIG5vdywgb25seSBoYW5kbGUgdGhpcyB2ZXJ5IGNvbW1vbiBhbmQgc3BlY2lhbCBjYXNlICh3aGljaFxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgd2FudHMgdG8gZ2V0IGEgc2luZ2xlIGVudGl0eSBieSBpdHMgSUQ6XG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gQW5kIGlmIHNvLCBpZiB3ZSBoYXZlIGFuIG91dGdvaW5nIG11dGF0aW9uIHRvIGNyZWF0ZSB0aGF0IGVudGl0eTpcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ2FkZC1yZWxhdGVkJyAmJiBtLnJlbGF0ZWREb2MuaWQgPT09IHF1ZXJ5Lmlkc1swXTsgfSkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcbiAgICAgICAgICAgICAgICAvLyBidXQgbGV0IHRoZSBvcHRpc3RpYyBmZWF0dXJlIG9mIEtlZEJhY2tlbmRRdWVyeSBhcHBseSB0aGUgbXV0YXRpb24gYmVmb3JlXG4gICAgICAgICAgICAgICAgLy8gbm90aWZ5aW5nIHN1YnNjcmliZXJzICh3ZSBkb24ndCB3YW50IGl0IHRvIGJlIHBlcnNpc3RlbnQgYmVmb3JlIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPSywgYW5vdGhlciBxdWl0ZSBjb21tb24gY2FzZSBpcyB3aGVuIHdlIGFzayBmb3IgYSBjZXJ0YWluIElEIGFuZCB0aGF0IElEIHJlcGxpZXNcbiAgICAgICAgLy8gd2l0aGluIGFub3RoZXIgcXVlcnlcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIE5vdCBwb3NzaWJsZSB0byBoYW5kbGVcbiAgICAgICAgaWYgKCFxdWVyeS5pZHMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIGlmICghcS5nb3RJbml0aWFsUmVzcG9uc2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgIGlmIChxLnF1ZXJ5LmJyYW5jaElkICE9PSBxdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjsgLy8gSXQgd291bGQgYmUgY29tcGxleCB0byBzdXBwb3J0IHZhcmlvdXMgZmxhZ3MuIFF1ZXJ5J3MgZGF0YSBtYXkgaW5jbHVkZSBpZHMgb25seS4gQ2FuJ3QgcmVseSBvbiB0aGUgcXVlcnkuXG4gICAgICAgICAgICB2YXIgcUluY2x1ZGVzID0gcS5pbmNsdWRlcztcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaW5jbHVkZSwgYnV0IHRoaXMgcXVlcnkgZG9lcy4gQ2hlY2sgaWYgd2UgY2FuIGZpbmQgb3VyIHJlc3VsdCB3aXRoaW4gaXQuXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcUluY2x1ZGVzLmZpbmQoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3EudGFibGVdW1wicmVsYXRpb25zaGlwc1wiXVtsXSA9PT0gdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHEuZGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViRGF0YSA9IHF1ZXJ5QXJyYXkocXVlcnksIGVudGl0eVtsYWJlbF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IHJldHVybiByZXNfMVtyLmlkXSA9IHI7IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMSA9IE9iamVjdC5rZXlzKHJlc18xKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXNfMVtpZF07IH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaW5jbHVkZXMuZXZlcnkoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBxSW5jbHVkZXMuaW5jbHVkZXMobGFiZWwpOyB9KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgLy8gTGFzdGx5LCBpZiB0aGUgcXVlcnkgaW5jbHVkZXMgYWxsIGdyYXBocyB0aGF0IHdlIGRvLCBwaWNrIHRoZSBzdWJzZXQgZnJvbSB0aGF0IHF1ZXJ5LlxuICAgICAgICAgICAgLy8gQ29uY3JldGUgZXhhbXBsZTogV2Ugb2JzZXJ2ZSBhIGNlcnRhaW4gVGFzayBieSBJRCBhbmQgd2FudCBpdHMga25vd2xlZGdlUmVxdWlyZW1lbnRzIGFsb25nIHdpdGggaXQsXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxuICAgICAgICAgICAgaWYgKHEudGFibGUgPT09IHRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8yID0gcXVlcnlBcnJheShxdWVyeSwgcS5kYXRhKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5pZHMuZXZlcnkoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXN1bHRfMi5zb21lKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmlkID09PSBpZDsgfSk7IH0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHEgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoIWtiUXVlcnkpIHtcbiAgICAgICAgICAgIGtiUXVlcnkgPSBuZXcgS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgcmVwby5nZXRVc2VyKCksIHJlcG8sIHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoa2JRdWVyeS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGtiUXVlcnkuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoa2JRdWVyeSkge1xuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxuICAgICAgICAgICAga2JRdWVyeS51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgLy8gUmVsZWFzZSB1bm5lc2Nlc3NhcnkgbWVtb3J5IHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgc3Vic2NyaXB0aW9ucyBvZiB0aGlzIHF1ZXJ5LCBieSByZW1vdmluZyB0aGUgcXVlcnkgaXRzZWxmXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxuICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGluIDUgbWludXRlczpcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYga2JRdWVyeSBzdGlsbCBoYXMgbm8gc3Vic2NyaXB0aW9ucyAobm90IGNlcnRhaW4hIEEgbmV3IHN1YnNjcmliZXIgbWF5IGhhdmUgY29tZSBhbG9uZy4uLilcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcmllcyA9IF90aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxICE9PSBrYlF1ZXJ5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XG4gICAgICAgICAgICAgICAgICAgIDUwMCA6IC8vIERvbid0IGhvc3QgdG9vIG1hbnkgcXVlcmllcy4gR2FyYmFnZSBjb2xsZWN0IHRoaXMgd2l0aGluIDUwMCBtc1xuICAgICAgICAgICAgICAgICAgICA1ICogNjAwMDApOyAvLyBBbGxvdyBxdWVyeSBpbiBtZW1vcnkgZm9yIGFub3RoZXIgNSBtaW51dGVzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBRdWVyeVNldDtcbn0oKSk7XG5leHBvcnQgeyBRdWVyeVNldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWJsZUZyb21MYWJlbCh0YWJsZSwgbGFiZWwpIHtcbiAgICByZXR1cm4gdGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUFycmF5KHF1ZXJ5LCBkYXRhKSB7XG4gICAgdmFyIGZpbHRlciA9IGdldEZpbHRlckZyb21RdWVyeShxdWVyeSk7XG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XG59XG5leHBvcnQgZnVuY3Rpb24gQU5EKGZpbHRlcjEsIGZpbHRlcjIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpIHtcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgaWYgKHF1ZXJ5LmZyb20pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA+PSBxdWVyeS5mcm9tOyB9KTtcbiAgICBpZiAocXVlcnkudG8pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA8IHF1ZXJ5LnRvOyB9KTtcbiAgICBpZiAocXVlcnkuaWRzKVxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XG4gICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5uYW1lID09PSBxdWVyeS5uYW1lOyB9KTtcbiAgICBpZiAocXVlcnkudGFncylcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRhZ3MgJiYgW10uY29uY2F0KHF1ZXJ5LnRhZ3MgfHwgW10pLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4geC50YWdzLmluY2x1ZGVzKHRhZyk7IH0pOyB9KTtcbiAgICAvLyBxdWVyeS5oYXNFZGdlc0Zyb20gYW5kIHF1ZXJ5Lmhhc0VkZ2VzVG8gY2Fubm90IGJ5IGZpbHRlcmVkIGhlcmVcbiAgICByZXR1cm4gZmlsdGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJyYW5jaFNlbnNpdGl2ZShtKSB7XG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdsb2JhbE9wKG0pIHtcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSc7XG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcbiAgICBpZiAoY2xpZW50Ll9fbWlncmF0b3JfbWl4ZWRfaW4pXG4gICAgICAgIHJldHVybjtcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XG4gICAgdmFyIGdldCA9IGNsaWVudC5nZXQ7XG4gICAgdmFyIGxpc3QgPSBjbGllbnQubGlzdDtcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGllbnQubGlzdCA9IGZ1bmN0aW9uICh0YWJsZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gbWlncmF0ZShkb2MsIHRhYmxlLCBpbmNsdWRlICYmIGluY2x1ZGUudG9TdHJpbmcoKS5zcGxpdCgnLCcpKTsgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBjbGllbnQ7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVUYXNrIGZyb20gJy4vbWlncmF0ZS10YXNrJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVDb3Vyc2UoY291cnNlLCBncmFwaHMpIHtcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxuICAgICAgICBjb3Vyc2UubW9kdWxlcyA9IFtdO1xuICAgIGNvdXJzZS5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZSkge1xuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIG1vZHVsZS5yZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XG4gICAgICAgICAgICBtb2R1bGUudGFza0lkcyA9IFtdO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykge1xuICAgICAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xuICAgIH1cbiAgICAvLyBFYXJsaWVyIHdyb25nIHNwZWxsaW5nIG9mIHJlc291cmNlc1xuICAgIGlmICgncmVzb3Vyc2VzJyBpbiBjb3Vyc2UgJiYgISgncmVzb3VyY2VzJyBpbiBjb3Vyc2UpKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xuICAgICAgICBkZWxldGUgY291cnNlLnJlc291cnNlcztcbiAgICB9XG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBbXTtcbiAgICB9XG4gICAgaWYgKGdyYXBocykge1xuICAgICAgICBncmFwaHMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XG4gICAgICAgICAgICAgICAgICAgIGNvdXJzZS50YXNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXNrKSB7IHJldHVybiBtaWdyYXRlVGFzayh0YXNrKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLWNvdXJzZS5qcy5tYXAiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlVGFzayh0YXNrKSB7XG4gICAgaWYgKCF0YXNrLnJlc291cmNlcylcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtdGFzay5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZUNvdXJzZSBmcm9tICcuL21pZ3JhdGUtY291cnNlJztcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlKGRvYywgdGFibGUsIGdyYXBocykge1xuICAgIHN3aXRjaCAodGFibGUpIHtcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcbiAgICAgICAgICAgIG1pZ3JhdGVDb3Vyc2UoZG9jLCBncmFwaHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxuICAgICAgICAgICAgbWlncmF0ZVRhc2soZG9jKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xudmFyIENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB0aHJvdyBcIm1peGVkaW5cIjtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgdmFyIGVtaXR0ZXJfMSA9IG5ldyBFbWl0dGVyKHgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBlbWl0dGVyXzEuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYnNlcnZhYmxlQ29sbGVjdGlvbi5mcm9tKCkgY2FuIG9ubHkgdGFrZSBhcnJheXMgb3Igb2JzZXJ2YWJsZXNcIik7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIG1hcHBlcihpdGVtKTsgfSk7IH0pO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgaXRlbXMpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLmZpbHRlcihmaWx0ZXIpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5mcm9tKHRoaXMudG9WYWx1ZSgpLmNvbWJpbmVMYXRlc3Qob3RoZXIpLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IF9hWzBdLCBvdGhlciA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnJheSkgeyByZXR1cm4gYXJyYXkuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYVByb3AgPSBhICYmIGFbcHJvcF07XG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XG4gICAgICAgICAgICByZXR1cm4gYVByb3AgPiBiUHJvcCA/IDEgOiBhUHJvcCA8IGJQcm9wID8gLTEgOiAwO1xuICAgICAgICB9KTsgfSkudG9Db2xsZWN0aW9uKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnRvVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5ncm91cEJ5ID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBydiA9IHt9O1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnIpIHsgcmV0dXJuIGFyclswXTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcbn0oT2JzZXJ2YWJsZSkpO1xuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhFbWl0dGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVtaXR0ZXIoaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzICE9PSBvYnNlcnZlcjtcbiAgICAgICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVycy5wdXNoKFtvYnNlcnZlciwgc3Vic2NyaXB0aW9uXSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMuZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIoX3RoaXMudmFsdWUsIHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaCgpO1xuICAgIH07XG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEVtaXR0ZXI7XG59KFZhbHVlKSk7XG5leHBvcnQgeyBFbWl0dGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsInZhciBzdGFjayA9IFtdO1xudmFyIGN1cnJlbnRGaWJlciA9IG51bGw7XG52YXIgcHJvdmlkZXJzID0gW2Z1bmN0aW9uICgpIHsgcmV0dXJuIGN1cnJlbnRGaWJlcjsgfV07XG5mdW5jdGlvbiBwdXNoRmliZXIoZmliZXIpIHtcbiAgICBzdGFjay5wdXNoKGN1cnJlbnRGaWJlcik7XG4gICAgY3VycmVudEZpYmVyID0gZmliZXI7XG59XG5mdW5jdGlvbiBwb3BGaWJlcigpIHtcbiAgICBjdXJyZW50RmliZXIgPSBzdGFjay5wb3AoKTtcbn1cbmV4cG9ydCB2YXIgRmliZXJDb250ZXh0ID0ge1xuICAgIGdldCBjdXJyZW50KCkgeyByZXR1cm4gY3VycmVudEZpYmVyOyB9LFxuICAgIC8qcnVuOiBmdW5jdGlvbiByZXJ1bjxSPihmaWJlcjogRmliZXIsIGZuOiAoKT0+Uik6IFIgfCBQcm9taXNlPFI+IHtcbiAgICAgIHB1c2hGaWJlcihmaWJlcik7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZuKCkpO1xuICAgICAgfSBjYXRjaCAocCkge1xuICAgICAgICBpZiAocCAmJiB0eXBlb2YgcC50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgcmV0dXJuIHAudGhlbigoKT0+cmVydW4oZmliZXIsIGZuKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHApO1xuICAgICAgICB9XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBwb3BGaWJlcigpO1xuICAgICAgfVxuICAgIH0sKi9cbiAgICBhZGRQcm92aWRlcjogZnVuY3Rpb24gKGdldEN1cnJlbnRGaWJlcikge1xuICAgICAgICBwcm92aWRlcnMucHVzaChnZXRDdXJyZW50RmliZXIpO1xuICAgICAgICBzZXRDdXJyZW50R2V0dGVyRnJvbVByb3ZpZGVycygpO1xuICAgIH0sXG4gICAgcmVtb3ZlUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcbiAgICAgICAgcHJvdmlkZXJzID0gcHJvdmlkZXJzLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gcCAhPT0gZ2V0Q3VycmVudEZpYmVyOyB9KTtcbiAgICAgICAgc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKTtcbiAgICB9XG59O1xuZnVuY3Rpb24gc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpYmVyQ29udGV4dCwgXCJjdXJyZW50XCIsIHtcbiAgICAgICAgZ2V0OiBwcm92aWRlcnMucmVkdWNlKGZ1bmN0aW9uIChwLCBjKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IHJldHVybiBwKCkgfHwgYygpOyB9OyB9KSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIlVzZSBGaWJlckNvbnRleHQucHVzaCgpIHRvIGNoYW5nZSBjdXJyZW50IGZpYmVyXCIpOyB9XG4gICAgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWJlci1jb250ZXh0LmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vb2JzZXJ2YWJsZSc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcbmV4cG9ydCAqIGZyb20gJy4vY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2VtaXR0ZXInO1xuZXhwb3J0ICogZnJvbSAnLi9maWJlci1jb250ZXh0Jztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImV4cG9ydCBmdW5jdGlvbiBpbml0TWFwTWV0aG9kKGN0b3IpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IGN0b3IoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobWFwcGVyKHZhbHVlKSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IH0pO1xuICAgIH07XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYXAuanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIG1peGluKHRhcmdldFByb3RvLCBtaXhpblByb3RvKSB7XG4gICAgdmFyIHByb3BzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgcHJvcHNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHByb3BzLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHsgcmV0dXJuIHRhcmdldFByb3RvW3Byb3BdID0gbWl4aW5Qcm90b1twcm9wXTsgfSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taXhpbi5qcy5tYXAiLCJ2YXIgT2JzZXJ2YWJsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvL3N0YXRpYyBnZXQgW1N5bWJvbC5zcGVjaWVzXSgpIHsgcmV0dXJuIHRoaXM7IH1cbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKF9zdWJzY3JpYmUpIHtcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlID0gX3N1YnNjcmliZTtcbiAgICB9XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcywgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgeyB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyB9IH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gT2JzZXJ2YWJsZTtcbn0oKSk7XG5leHBvcnQgeyBPYnNlcnZhYmxlIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcIi4vb2JzZXJ2YWJsZVwiO1xuaW1wb3J0IHsgaW5pdE1hcE1ldGhvZCB9IGZyb20gXCIuL21hcFwiO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gXCIuL2NvbGxlY3Rpb25cIjtcbmltcG9ydCB7IEZpYmVyQ29udGV4dCB9IGZyb20gJy4vZmliZXItY29udGV4dCc7XG52YXIgVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVmFsdWUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVmFsdWUoc3Vic2NyaWJlKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBzdWJzY3JpYmUpIHx8IHRoaXM7XG4gICAgfVxuICAgIFZhbHVlLmZyb20gPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoeC5zdWJzY3JpYmUpXG4gICAgICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChzKSB7IHJldHVybiB4LnN1YnNjcmliZShzKTsgfSk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlLmZyb20oKSBjYW4gb25seSB0YWtlIG9ic2VydmFibGVzXCIpO1xuICAgIH07XG4gICAgVmFsdWUucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXNvbHZlZCA9IGZhbHNlLCByZXN1bHQsIGVyciwgbm90aWZ5O1xuICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NpcHRpb24pIHtcbiAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICAgICAgZXJyID0gZXJyb3I7XG4gICAgICAgICAgICBpZiAoZXJyb3IgJiYgbm90aWZ5KVxuICAgICAgICAgICAgICAgIG5vdGlmeShudWxsLCBlcnJvciwgc3Vic2NpcHRpb24pO1xuICAgICAgICAgICAgZWxzZSBpZiAobm90aWZ5KVxuICAgICAgICAgICAgICAgIG5vdGlmeSh2YWx1ZSwgbnVsbCwgc3Vic2NpcHRpb24pO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHJlc29sdmVkKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudEZpYmVyID0gRmliZXJDb250ZXh0LmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWJlcikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgRmliZXIgQ29udGV4dFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9ucyA9IGN1cnJlbnRGaWJlci5zdWJzY3JpcHRpb25zLCBvYnNlcnZlciA9IGN1cnJlbnRGaWJlci5vYnNlcnZlcjtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgbm90aWZ5ID0gb2JzZXJ2ZXI7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIG5vdGlmeSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY2lwdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICAgICAgICAgIHN1YnNjaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlIGlmIChmbih2YWx1ZSkpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKHByZWZpeCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHByZWZpeCwgeCk7XG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUudG9Db2xsZWN0aW9uID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLm1hcChtYXBwZXIpLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgICAgIHZhciBteVN1YnNjcmlwdGlvbiwgb3RoZXJTdWJzY3JpcHRpb247XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG15U3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG90aGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG15U3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcywgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWVzWzBdID0gaXRlbXM7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBvdGhlclN1YnNjcmlwdGlvbiA9IG90aGVyLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHMudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhbHVlc1sxXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbMF0gIT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlcywgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWYWx1ZS5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHZhciByZXR1cm5lZFN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcHBlZFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBzO1xuICAgICAgICAgICAgICAgIGlmIChtYXBwZWRTdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlT3JWYWx1ZSA9IG1hcHBlcihpdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZhYmxlT3JWYWx1ZSAmJiB0eXBlb2Ygb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihvYnNlcnZhYmxlT3JWYWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuZWRTdWJzY3JpcHRpb247XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFZhbHVlO1xufShPYnNlcnZhYmxlKSk7XG5leHBvcnQgeyBWYWx1ZSB9O1xuVmFsdWUucHJvdG90eXBlLm1hcCA9IGluaXRNYXBNZXRob2QoVmFsdWUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmFsdWUuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL29ic2VydmFibGUnO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8nO1xuIiwidmFyIG1hcCA9IHtcblx0XCIuL2VuLVNHXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1TRy5qc1wiLFxuXHRcIi4vZW4tU0cuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLVNHLmpzXCIsXG5cdFwiLi9lbi1hdVwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWF1LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1hdS5qc1wiLFxuXHRcIi4vZW4tY2FcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1jYS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tY2EuanNcIixcblx0XCIuL2VuLWdiXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4tZ2IuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWdiLmpzXCIsXG5cdFwiLi9lbi1pZVwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLWllLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pZS5qc1wiLFxuXHRcIi4vZW4taWxcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWlsLmpzXCIsXG5cdFwiLi9lbi1pbC5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWwuanNcIixcblx0XCIuL2VuLW56XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vZW4tbnouanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLW56LmpzXCIsXG5cdFwiLi9zdlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIixcblx0XCIuL3N2LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9zdi5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1hcCwgcmVxKSkge1xuXHRcdHZhciBlID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIHJlcSArIFwiJ1wiKTtcblx0XHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdFx0dGhyb3cgZTtcblx0fVxuXHRyZXR1cm4gbWFwW3JlcV07XG59XG53ZWJwYWNrQ29udGV4dC5rZXlzID0gZnVuY3Rpb24gd2VicGFja0NvbnRleHRLZXlzKCkge1xuXHRyZXR1cm4gT2JqZWN0LmtleXMobWFwKTtcbn07XG53ZWJwYWNrQ29udGV4dC5yZXNvbHZlID0gd2VicGFja0NvbnRleHRSZXNvbHZlO1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrQ29udGV4dDtcbndlYnBhY2tDb250ZXh0LmlkID0gXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlIHN5bmMgcmVjdXJzaXZlIHN2fGVuXCI7IiwiaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9jb250cmFjdHMva2VkLW1vZGVsc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRVc2VyQ2xhaW1zICh1c2VyOiBVc2VyKSB7XG4gIHJldHVybiBbe1xuICAgIHR5cGU6IFwiZW1haWxcIixcbiAgICB2YWx1ZTogdXNlci5tYWlsXG4gIH0se1xuICAgIHR5cGU6IFwic2Nob29sXCIsXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sXG4gIH1dLmNvbmNhdCh1c2VyLnJvbGVzLm1hcChyb2xlID0+ICh7XG4gICAgdHlwZTogXCJyb2xlXCIsXG4gICAgdmFsdWU6IHJvbGVcbiAgfSkpKS5jb25jYXQodXNlci5yb2xlcy5tYXAocm9sZSA9PiAoe1xuICAgIHR5cGU6IFwic2Nob29sUm9sZVwiLFxuICAgIHZhbHVlOiB1c2VyLnNjaG9vbCArIFwiL1wiICsgcm9sZVxuICB9KSkpO1xufVxuIiwiaW1wb3J0IHsgQWNjZXNzQ2xhaW0sIERvY3VtZW50QWNjZXNzLCBoYXNBY2Nlc3MgYXMgX2hhc0FjY2VzcywgQWNjZXNzUmlnaHQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBEb2N1bWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBnZXRVc2VyQ2xhaW1zIGZyb20gJy4vZ2V0LXVzZXItY2xhaW1zJztcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcsIGdlbmVyYXRlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuZXhwb3J0IHsgZ2V0VXNlckNsYWltcyB9O1xuXG5leHBvcnQgY29uc3QgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMgPSBbXG4gIFwidXNlclwiLFxuICBcInJvbGVcIixcbiAgXCJzY2hvb2xcIixcbiAgXCJkZWJ1Z1wiLFxuICBcInRlc3RWZXJzaW9uXCIsXG4gIFwidGVzdHZlcnNpb25cIixcbiAgXCJmZWF0dXJlc1wiLFxuICBcInNjaG9vbFR5cGVcIixcbiAgXCJzY2hvb2x0eXBlXCJdO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQsIHJlcXVlc3RlZFJpZ2h0OiBBY2Nlc3NSaWdodCkge1xuICB2YXIgY2xhaW1zID0gZ2V0VXNlckNsYWltcyh1c2VyKTtcbiAgaWYgKHJlcXVlc3RlZFJpZ2h0ICE9PSAnUicgJiYgdXNlci50dXRvckZvcikge1xuICAgIGNsYWltcyA9IGNsYWltcy5maWx0ZXIoY2xhaW0gPT4gY2xhaW0udHlwZSAhPT0gJ2VtYWlsJyk7XG4gIH1cbiAgdmFyIHJlc3VsdCA9IF9oYXNBY2Nlc3MoRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZ0FycmF5KGRvYy5hY2wgfHwgW10pLCBjbGFpbXMsIHJlcXVlc3RlZFJpZ2h0KTtcbiAgLy9jb25zb2xlLmxvZyhgSGFzICR7cmVxdWVzdGVkUmlnaHR9IGFjY2VzcyB0byAke2RvYy5uYW1lfS8ke2RvYy5pZH06ICR7cmVzdWx0fWApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzUmVhZEFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzV3JpdGVBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1cnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1NoYXJlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdTJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1RlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xuICBjb25zdCBpc1RlYWNoZXIgPSB1c2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnRU1QTE9ZRUUnIHx8IHJvbGUgPT09ICdBRE1JTicpO1xuICBjb25zdCBiZWxvbmdzVG9TY2hvb2wgPSAoc2Nob29sfHxcIlwiKS50b0xvd2VyQ2FzZSgpID09PSB1c2VyLnNjaG9vbC50b0xvd2VyQ2FzZSgpO1xuICByZXR1cm4gKGlzVGVhY2hlciAmJiBiZWxvbmdzVG9TY2hvb2wpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pbk9yVGVhY2hlckF0U2Nob29sKHVzZXI6IFVzZXIsIHNjaG9vbDogc3RyaW5nKSB7XG4gIHJldHVybiB1c2VyLnJvbGVzLmluY2x1ZGVzKFwiQURNSU5cIikgfHwgaXNUZWFjaGVyQXRTY2hvb2wodXNlciwgc2Nob29sKTtcbn1cblxuZXhwb3J0IGNvbnN0IGltcGVyc29uYXRpb25FbnYgPSB7XG4gIGFjdEFzIChvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xuICAgIGNvbnN0IHtyb2xlLCBzY2hvb2wsIHVybH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IGN1cnJlbnRRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcbiAgICBjb25zdCBuZXdRdWVyeSA9IHsuLi5jdXJyZW50UXVlcnksIHJvbGUsIHNjaG9vbH07XG4gICAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKG5ld1F1ZXJ5KTtcbiAgICBpZiAodXJsKSB7XG4gICAgICBsb2NhdGlvbi5ocmVmID0gYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9jYXRpb24uaGFzaCA9IFwiI1wiO1xuICAgICAgbG9jYXRpb24uc2VhcmNoID0gbmV3UXVlcnlTdHJpbmc7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhY3RBcyhvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xuICBpbXBlcnNvbmF0aW9uRW52LmFjdEFzKG9wdGlvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgKHVybDogc3RyaW5nLCBxdWVyeToge1tuYW1lOiBzdHJpbmddIDogc3RyaW5nfSkge1xuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XG4gIGNvbnN0IHByZXNlcnZlZFF1ZXJ5ID0ge307XG4gIGZvciAoY29uc3QgcGFyYW0gb2YgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpIHtcbiAgICBpZiAoY3VycmVudFF1ZXJ5W3BhcmFtXSkgcHJlc2VydmVkUXVlcnlbcGFyYW1dID0gY3VycmVudFF1ZXJ5W3BhcmFtXTtcbiAgfVxuICBjb25zdCBuZXdRdWVyeVN0cmluZyA9IGdlbmVyYXRlUXVlcnlTdHJpbmcoey4uLnByZXNlcnZlZFF1ZXJ5LCAuLi5xdWVyeX0pO1xuICBjb25zdCBwSGFzaCA9IHVybC5pbmRleE9mKCcjJyk7XG4gIHJldHVybiBwSGFzaCA+PSAwID9cbiAgICBgJHt1cmwuc3Vic3RyKDAscEhhc2gpfSR7bmV3UXVlcnlTdHJpbmd9JHt1cmwuc3Vic3RyKHBIYXNoKX1gIDpcbiAgICBgJHt1cmx9JHtuZXdRdWVyeVN0cmluZ31gO1xufVxuIiwiaW1wb3J0IHsgRURTQ291cnNlLCBFRFNBc3Nlc3NtZW50LCBFRFNTdHVkeVBsYW4sIEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5LCBFRFNTdHVkZW50LCBFRFNUdWl0aW9uR3JvdXAsIEVEU1R1aXRpb25TdHVkZW50LCBFRFNUZWFjaGVyLCBNb2NrRURTQWNhZGVtaWNZZWFyLCBNb2NrRURTRGF0ZVJhbmdlIH0gZnJvbSAnLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgSXNvbW9ycGhpY0VudiwgQmVhcmVyUHJvdmlkZXIsIEh0dHBFcnJvciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IFNjaG9vbE1vbWVudCwgZ2V0VGVybVN0YXJFbmREYXRlIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgeyBTY2hvb2xUZXJtIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLXRlcm0nO1xuaW1wb3J0IHsgZGF0ZVRpbWVSZXZpdmVyLCBMIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IG1vY2tKc29uRmlsZSBmcm9tICcuL21vY2svbW9jay1lZHMtZGF0YS5qc29uJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IFN1c3BlbnNlQmFzZWRBUEksIG1ha2VTdXNwZW5zZUFwaSB9IGZyb20gJy4uL3V0aWxzL21ha2Utc3VzcGVuc2UtYXBpJztcblxuZXhwb3J0IGNsYXNzIEVkc0NsaWVudCB7XG4gIGh0dHA6IFJlc3RDbGllbnQ7XG4gIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZztcbiAgc3VzcGVuc2U6IFN1c3BlbnNlQmFzZWRBUEk8RWRzQ2xpZW50PjtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgaXNvbW9ycGhpYzogSXNvbW9ycGhpY0VudixcbiAgICBiYXNlVXJsOiBzdHJpbmcsXG4gICAgYmVhcmVyUHJvdmlkZXI6IEJlYXJlclByb3ZpZGVyLFxuICAgIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZ1xuICApIHtcbiAgICB0aGlzLmh0dHAgPSBuZXcgUmVzdENsaWVudCAoaXNvbW9ycGhpYywgYmFzZVVybCwge2JlYXJlclByb3ZpZGVyfSk7XG4gICAgdGhpcy51c2VyRW1haWxHZXR0ZXIgPSB1c2VyRW1haWxHZXR0ZXI7XG4gICAgY29uc3QgaXNBcGlNZXRob2QgPSBtID0+XG4gICAgICB0eXBlb2YgdGhpc1ttXSA9PT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgbSAhPT0gJ2NvbnN0cnVjdG9yJyAmJiAvLyBTaW5jZSBtYWtlU3VzcGVuc2VBcGkoKSB3YWxrcyBwcm90b3R5cGUgY2hhaW5cbiAgICAgIG0gIT09ICdwcml2YXRpemluZ0NhY2hlQnVzdCcgJiZcbiAgICAgIG0gIT09ICd1c2VyRW1haWxHZXR0ZXInIC8vIExpc3Qgbm9uLUFQSSBtZXRob2RzIGhlcmUuLi5cbiAgICAgIDtcblxuICAgIE9iamVjdC5rZXlzKEVkc0NsaWVudC5wcm90b3R5cGUpLmZvckVhY2gobWV0aG9kID0+IHtcbiAgICAgIGlmIChpc0FwaU1ldGhvZChtZXRob2QpKSB7XG4gICAgICAgIHRoaXNbbWV0aG9kXSA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzW21ldGhvZF0pO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuc3VzcGVuc2UgPSBtYWtlU3VzcGVuc2VBcGkodGhpcywge2lzQXBpTWV0aG9kfSk7XG4gIH1cblxuICBwcml2YXRlIHByaXZhdGl6aW5nQ2FjaGVCdXN0KCkge1xuICAgIHJldHVybiB7dXNlcjogdGhpcy51c2VyRW1haWxHZXR0ZXIoKX07XG4gIH1cblxuLyoqXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxuICAgKlxuICAgKiBAcGFyYW0gY291cnNlQ29kZSBTaG9ydC1uYW1lIG9mIHRoZSBjb3Vyc2UuIE9wdGlvbmFsLlxuICAgKi9cbiAgYXN5bmMgZ2V0QWN0aXZlQ291cnNlcyhxOiB7Y291cnNlQ29kZT86IHN0cmluZywgcGVyaW9kTmFtZTogc3RyaW5nfSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgICBpZiAocSkge1xuICAgICAgICBpZiAocS5jb3Vyc2VDb2RlKSBxdWVyeS5Db3Vyc2VDb2RlID0gcS5jb3Vyc2VDb2RlO1xuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhY3RpdmVjb3Vyc2VzXCIsIHF1ZXJ5KTtcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgcmV0dXJuIGpzb24uY291cnNlcyBhcyBFRFNDb3Vyc2VbXTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZyb20gRURTOiBcIiArIGV4KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihMYEt1bmRlIHR5dsOkcnIgaW50ZSBsYWRkYSB0ZXJtaW5zbcOlbCBlbGxlciBhdmtsYXJhZGUgc3RlZyBmcsOlbiBFRFMuIEbDtnJzw7ZrIGlnZW4gc2VuYXJlLi4uYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlIGxhdGVzdCBhc3Nlc3NtZW50cyBmb3IgY3VycmVudCBsb2dnZWQgaW4gdXNlci5cbiAgICogXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxuICAgKi9cbiAgYXN5bmMgZ2V0TGF0ZXN0QXNzZXNzbWVudHMobGltaXQ/OiBudW1iZXIpIHtcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgaWYgKCFpc05hTihsaW1pdCkpIHF1ZXJ5LkNvdW50ID0gbGltaXQ7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhc3Nlc3NtZW50c1wiLCBxdWVyeSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLmFzc2Vzc21lbnRzIGFzIEVEU0Fzc2Vzc21lbnRbXTsgICAgXG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxuICAgKi9cbiAgYXN5bmMgZ2V0U3R1ZGVudEdvYWxzKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcbiAgfVxuXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRGdXR1cmVBYmlsaXRpZXNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEZ1dHVyZUFiaWxpdGllcyBhcyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInRlYWNoZXJ0dXRvcnN0dWRlbnRzXCIsIHRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnN0dWRlbnRzIGFzIEVEU1N0dWRlbnRbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRTY2hvb2xUdWl0aW9uR3JvdXBzKClcbiAgICogXG4gICAqIFJldHVybiB0dWl0aW9uZ3JvdXBzIGZvciBzY2hvb2xcbiAgICogXG4gICAqIEBwYXJhbSBzY2hvb2xOYW1lIC0gbmFtZSBvZiBzY2hvb2xcbiAgICogQHBhcmFtIGNvdXJzZUNvZGUgLSBTa29sdmVya2V0cyBjb2RlIGZvciBjb3Vyc2VcbiAgICovXG4gIGFzeW5jIGdldFNjaG9vbFR1aXRpb25Hcm91cHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgY291cnNlQ29kZTogc3RyaW5nfSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJTY2hvb2xUdWl0aW9uR3JvdXBzXCIsIHsuLi50aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCksIC4uLnF9KTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc2Nob29sVHVpdGlvbkdyb3VwcyBhcyBFRFNUdWl0aW9uR3JvdXBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cygpXG4gICAqIFxuICAgKiBSZXR1cm4gbmFtZSBhbmQgbWFpbGFkcmVzc2VzIGZvciB0dXRpdGlvbmdyb3VwcyBpbiBzY2hvb2xzXG4gICAqIFxuICAgKiBAcGFyYW0gc2Nob29sTmFtZSAtIG5hbWUgb2Ygc2Nob29sXG4gICAqIEBwYXJhbSB0dWl0aW9uR3JvdXBOYW1lIC0gdHVpdGlvbiBncnVvcCBuYW1lIGluIEVEU1xuICAgKi9cbiAgYXN5bmMgZ2V0VHVpdGlvbkdyb3VwU3R1ZGVudHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgdHVpdGlvbkdyb3VwTmFtZTogc3RyaW5nfSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJUdWl0aW9uR3JvdXBTdHVkZW50c1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnR1aXRpb25Hcm91cFN0dWRlbnRzIGFzIEVEU1R1aXRpb25TdHVkZW50W107XG4gIH1cblxuICAvKipcbiAgICogZ2V0U2Nob29sVGVhY2hlcnMoKVxuICAgKiBcbiAgICogUmV0dXJuIG5hbWUgYW5kIG1haWxhZHJlc3NlcyBmb3IgdHV0aXRpb25ncm91cHMgaW4gc2Nob29sc1xuICAgKiBcbiAgICogQHBhcmFtIHNjaG9vbE5hbWUgLSBuYW1lIG9mIHNjaG9vbFxuICAgKi9cbiAgYXN5bmMgZ2V0U2Nob29sVGVhY2hlcnMocToge3NjaG9vbE5hbWU6IHN0cmluZ30pIHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiU2Nob29sVGVhY2hlcnNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICByZXR1cm4ganNvbi5zY2hvb2xUZWFjaGVycyBhcyBFRFNUZWFjaGVyW107XG4gIH1cbiAgLy8gd2UgYXNzdW1lIHRoYXQgdGhlIEVEUyB3aWxsIHJldHVybiB0aGUgY3VycmVudCBhY2FkZW1pYyB5ZWFyIGRhdGVzIGRldGVybWluZWQgYnkgdGhlIGN1cnJlbnQgZGF0ZVxuICBhc3luYyBnZXRBY2FkZW1pY1llYXJUZXJtcyhzY2hvb2xMb2NhbGU6IHN0cmluZywgZGF0ZTogRGF0ZSkge1xuICAgIC8vIG1vY2sgZGF0YVxuICAgIHN3aXRjaCAoc2Nob29sTG9jYWxlKSB7XG4gICAgICBjYXNlICdlbl9zaW4nOlxuICAgICAgcmV0dXJuIG1vY2tKc29uRmlsZS5Tb3V0aEluZGlhLmZpbHRlcihmID0+IG1vbWVudChkYXRlKS5pc1NhbWVPckFmdGVyKGYuZmlyc3RUZXJtLnN0YXJ0RGF0ZSkgJiYgbW9tZW50KGRhdGUpLmlzU2FtZU9yQmVmb3JlKGYuc2Vjb25kVGVybS5lbmREYXRlKSlbMF0gYXMgTW9ja0VEU0FjYWRlbWljWWVhcjtcbiAgICAgIGNhc2UgJ2VuX25pbic6XG4gICAgICByZXR1cm4gbW9ja0pzb25GaWxlLk5vcnRoSW5kaWEuZmlsdGVyKGYgPT4gbW9tZW50KGRhdGUpLmlzU2FtZU9yQWZ0ZXIoZi5maXJzdFRlcm0uc3RhcnREYXRlKSAmJiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JCZWZvcmUoZi5zZWNvbmRUZXJtLmVuZERhdGUpKVswXSBhcyBNb2NrRURTQWNhZGVtaWNZZWFyO1xuICAgICAgY2FzZSAnc3YnOlxuICAgICAge1xuICAgICAgdmFyIGhvbGlkYXlzID0gW10gYXMgTW9ja0VEU0RhdGVSYW5nZVtdO1xuICAgICAgdmFyIGZpcnN0VGVybU1vbWVudCA9IGdldFRlcm1TdGFyRW5kRGF0ZShkYXRlLCB0cnVlKTtcbiAgICAgIHZhciBzZWNvbmRUZXJtTW9tZW50ID0gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGUsIGZhbHNlKTtcblxuICAgICAgdmFyIHN0YXJ0Rmlyc3RUZXJtRGF0ZSA9IGZpcnN0VGVybU1vbWVudFswXTtcbiAgICAgIHZhciBzdGFydFNlY29uZFRlcm1EYXRlID0gc2Vjb25kVGVybU1vbWVudFswXTtcbiAgICAgIHZhciBlbmRGaXJzdFRlcm1EYXRlID0gZmlyc3RUZXJtTW9tZW50WzFdO1xuICAgICAgdmFyIGVuZFNlY29uZFRlcm1EYXRlID0gc2Vjb25kVGVybU1vbWVudFsxXTtcblxuICAgICAgY29uc3QgZmlyc3RUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoc3RhcnRGaXJzdFRlcm1EYXRlLnllYXIoKSwgc3RhcnRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIHN0YXJ0Rmlyc3RUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShzdGFydEZpcnN0VGVybURhdGUueWVhcigpLCBlbmRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIGVuZEZpcnN0VGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XG4gICAgICBjb25zdCBzZWNvbmRUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoc3RhcnRTZWNvbmRUZXJtRGF0ZS55ZWFyKCksIHN0YXJ0U2Vjb25kVGVybURhdGUubW9udGgoKSwgc3RhcnRTZWNvbmRUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShzdGFydFNlY29uZFRlcm1EYXRlLnllYXIoKSwgZW5kU2Vjb25kVGVybURhdGUubW9udGgoKSwgZW5kU2Vjb25kVGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XG4gICAgICByZXR1cm4ge2ZpcnN0VGVybSwgc2Vjb25kVGVybSwgaG9saWRheXN9O1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5cblxuZXhwb3J0IGNsYXNzIEVEU1BlcmlvZCB7XG4gIHBlcmlvZDogc3RyaW5nO1xuICB0ZXJtOiAnQVQnIHwgJ1NUJztcbiAgeWVhcjogbnVtYmVyO1xuICBjb25zdHJ1Y3RvciAocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtOiBzdHJpbmcgfCBTY2hvb2xNb21lbnQpIHtcbiAgICBpZiAodHlwZW9mIHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMucGVyaW9kID0gcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtO1xuICAgICAgdGhpcy50ZXJtID0gdGhpcy5wZXJpb2Quc3RhcnRzV2l0aCgnSFQnKSA/ICdBVCcgOiAnU1QnO1xuICAgICAgdGhpcy55ZWFyID0gcGFyc2VJbnQodGhpcy5wZXJpb2Quc3Vic3RyKDIpKTtcbiAgICAgIGlmIChpc05hTih0aGlzLnllYXIpKSB0aHJvdyBuZXcgRXJyb3IgKGBJbnZhbGlkIHBlcmlvZDogJHt0aGlzLnBlcmlvZH1gKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2Nob29sVGVybSA9IG5ldyBTY2hvb2xUZXJtKHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSk7XG4gICAgICB0aGlzLnBlcmlvZCA9IChzY2hvb2xUZXJtLnRlcm0gPT09ICdBVCcgPyBcIkhUXCIgOiBcIlZUXCIpICsgc2Nob29sVGVybS55ZWFyO1xuICAgICAgdGhpcy50ZXJtID0gc2Nob29sVGVybS50ZXJtO1xuICAgICAgdGhpcy55ZWFyID0gc2Nob29sVGVybS55ZWFyO1xuICAgIH1cbiAgfVxuXG4gIGdldCBzY2hvb2xUZXJtICgpIDogU2Nob29sVGVybSB7XG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHtcbiAgICAgIGFjYWRlbWljWWVhcjogdGhpcy50ZXJtID09PSAnQVQnID9cbiAgICAgICAgYCR7dGhpcy55ZWFyfS8ke3RoaXMueWVhciArIDF9YCA6XG4gICAgICAgIGAke3RoaXMueWVhci0xfS8ke3RoaXMueWVhcn1gLFxuICAgICAgdGVybTogdGhpcy50ZXJtXG4gICAgfSk7XG4gIH1cblxuICB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5wZXJpb2Q7XG4gIH1cblxuICB2YWx1ZU9mKCkge1xuICAgIHJldHVybiB0aGlzLnllYXIgKyBcIjpcIiArICh0aGlzLnRlcm0gPT09ICdTVCcgPyBcIjFcIiA6IFwiMlwiKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uRGF0ZV9vbGQgKGpzb25EYXRlU3RyOiBzdHJpbmcpIDogRGF0ZSB7XG4gIGNvbnN0IGRhdGUgPSBkYXRlVGltZVJldml2ZXIoXCJcIiwganNvbkRhdGVTdHIpO1xuICBpZiAoIShkYXRlIGluc3RhbmNlb2YgRGF0ZSkpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgSlNPTiBkYXRlIHN0cmluZzogXCIgKyBqc29uRGF0ZVN0cik7XG4gIHJldHVybiBkYXRlO1xufVxuXG5mdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHM8VCxBPihtZXRob2Q6ICguLi5hcmdzOkFbXSk9PlByb21pc2U8VD4pIDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPiB7XG4gIGxldCBvbmdvaW5nUHJvbWlzZXM6IHtbYXJnc0pzb246IHN0cmluZ106IFByb21pc2U8VD59ID0ge307XG4gIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBhcmdzSnNvbiA9IEpTT04uc3RyaW5naWZ5KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XG4gICAgaWYgKCFvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dKSB7XG4gICAgICBvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dID0gbWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihyZXN1bHQ9PntcbiAgICAgICAgZGVsZXRlIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XG4gIH1cbn1cbiIsImltcG9ydCB7IEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgR29vZ2xlQ2xpZW50IH0gZnJvbSAnLi9nb29nbGUtY2xpZW50JztcblxuZXhwb3J0IGNsYXNzIEdvb2dsZUNhbGVuZGFyIGV4dGVuZHMgR29vZ2xlQ2xpZW50IHtcblxuICBjb25zdHJ1Y3Rvcihnb29nbGVUb2tlblByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcikge1xuICAgIHN1cGVyKHtkaXNjb3ZlcnlEb2NzOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vZGlzY292ZXJ5L3YxL2FwaXMvY2FsZW5kYXIvdjMvcmVzdCd9KTtcbiAgICB0aGlzLnNldEJlYXJlclByb3ZpZGVyKGdvb2dsZVRva2VuUHJvdmlkZXIpO1xuICB9XG5cbiAgYXN5bmMgbGlzdENhbGVuZGFycygpIHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRlZCgpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBnYXBpLmNsaWVudC5jYWxlbmRhci5jYWxlbmRhckxpc3QubGlzdCh7fSk7XG4gICAgICAvLyBUT0RPOiBXaGF0IGlzIHRoZSBub3JtYWwgcmVzLnN0YXR1cz8gMjAwPyBUaHJvdyBpZiBub3QgMjAwP1xuICAgICAgcmV0dXJuIHJlcy5yZXN1bHQuaXRlbXM7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBUT0RPOiBQYXJzZSBvdXQgZXJyb3IgZnJvbSBlcnIgKHdoaWNoIGlzIGFuIG9iamVjdCEpXG4gICAgICB0aHJvdyBlcnIuZXJyb3I7IC8vIElzIHRoaXMgY29ycmVjdD8gVGVzdCFcbiAgICB9XG4gIH1cblxuICBhc3luYyBiYXRjaEV2ZW50cyh7IGNhbGVuZGFyTGlzdCwgdGltZU1pbiwgdGltZU1heCB9KSB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0ZWQoKTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYmF0Y2ggPSBnYXBpLmNsaWVudC5uZXdCYXRjaCgpO1xuICAgICAgY2FsZW5kYXJMaXN0LmZvckVhY2goKGNhbCkgPT4ge1xuICAgICAgICBiYXRjaC5hZGQoZ2FwaS5jbGllbnQuY2FsZW5kYXIuZXZlbnRzLmxpc3Qoe1xuICAgICAgICAgICdjYWxlbmRhcklkJzogY2FsLmlkIHx8ICdwcmltYXJ5JyxcbiAgICAgICAgICAndGltZU1pbic6IHRpbWVNaW4gJiYgKG5ldyBEYXRlKHRpbWVNaW4pKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICd0aW1lTWF4JzogdGltZU1heCAmJiAobmV3IERhdGUodGltZU1heCkpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgJ3Nob3dEZWxldGVkJzogZmFsc2UsXG4gICAgICAgICAgJ3NpbmdsZUV2ZW50cyc6IHRydWUsXG4gICAgICAgICAgJ2ZpZWxkcyc6ICdpdGVtcy9pZCxpdGVtcy9zdGFydCxpdGVtcy9lbmQsaXRlbXMvc3VtbWFyeSxpdGVtcy9sb2NhdGlvbixpdGVtcy9odG1sTGluayxpdGVtcy9kZXNjcmlwdGlvbicsXG4gICAgICAgICAgJ21heFJlc3VsdHMnOiAyNTAwLFxuICAgICAgICAgICdvcmRlckJ5JzogJ3N0YXJ0VGltZSdcbiAgICAgICAgfSksIDxhbnk+eydpZCc6IGNhbC5pZH0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gYmF0Y2gudGhlbihyZXNwID0+IHtcbiAgICAgICAgbGV0IG5ld0NhbHMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSBpbiBjYWxlbmRhckxpc3QpIHtcbiAgICAgICAgICBjb25zdCBjYWxJZCA9IGNhbGVuZGFyTGlzdFtpXS5pZDtcbiAgICAgICAgICBjb25zdCBldmVudHMgPSAocmVzcC5yZXN1bHRbY2FsSWRdLnJlc3VsdCAgYXMgZ2FwaS5jbGllbnQuY2FsZW5kYXIuRXZlbnRzKS5pdGVtcztcbiAgICAgICAgICBuZXdDYWxzW2NhbElkXSA9IHtjYWxlbmRhcjogY2FsZW5kYXJMaXN0W2ldLCBldmVudHN9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdDYWxzO1xuICAgICAgfSk7XG4gICAgfSBjYXRjaChlcnIpIHtcbiAgICAgIHRocm93IGVyci5lcnJvcjtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgZW52IH0gZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcblxuZXhwb3J0IGNsYXNzIEdvb2dsZUNsaWVudCB7XG4gIHRva2VuRXhwaXJhdGlvbjogRGF0ZTtcbiAgZ29vZ2xlVG9rZW5Qcm92aWRlcjogQmVhcmVyUHJvdmlkZXI7XG4gIGRpc2NvdmVyeURvY3M6IHN0cmluZ1tdO1xuICB0b2tlbjogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHtkaXNjb3ZlcnlEb2NzfTp7ZGlzY292ZXJ5RG9jczpzdHJpbmd9KSB7XG4gICAgdGhpcy5nb29nbGVUb2tlblByb3ZpZGVyID0gZW52Lmdvb2dsZVRva2VuUHJvdmlkZXI7XG4gICAgdGhpcy5kaXNjb3ZlcnlEb2NzID0gW107XG4gICAgdGhpcy5kaXNjb3ZlcnlEb2NzLnB1c2goZGlzY292ZXJ5RG9jcyk7XG4gIH1cblxuICBzZXRCZWFyZXJQcm92aWRlcihnb29nbGVUb2tlblByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcikge1xuICAgIHRoaXMuZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGdvb2dsZVRva2VuUHJvdmlkZXI7XG4gIH1cblxuICBhc3luYyBlbnN1cmVJbml0ZWQoKSB7XG4gICAgLy8gTG9hZCBHQVBJXG4gICAgaWYgKHR5cGVvZiBnYXBpID09PSAndW5kZWZpbmVkJykgYXdhaXQgdGhpcy5sb2FkR2FwaSgpO1xuXG4gICAgLy8gU2V0IHRva2VuXG4gICAgaWYgKCF0aGlzLnRva2VuRXhwaXJhdGlvbiB8fCB0aGlzLnRva2VuRXhwaXJhdGlvbiA8IG5ldyBEYXRlKCkpIHtcbiAgICAgIGNvbnN0IHRva2VuUmVzdWx0ID0gYXdhaXQgdGhpcy5nb29nbGVUb2tlblByb3ZpZGVyLmdldEJlYXJlcigpO1xuICAgICAgdGhpcy50b2tlbkV4cGlyYXRpb24gPSBuZXcgRGF0ZSh0b2tlblJlc3VsdC5leHBpcmVzKTtcbiAgICAgIHRoaXMudG9rZW4gPSB0b2tlblJlc3VsdC50b2tlbjtcbiAgICAgIGdhcGkuY2xpZW50LnNldFRva2VuKHtcbiAgICAgICAgYWNjZXNzX3Rva2VuOiB0b2tlblJlc3VsdC50b2tlblxuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIExvYWQgYWxsIGRpc2NvdnllckRvY3NcbiAgICBhd2FpdCBnYXBpLmNsaWVudC5pbml0KHtcbiAgICAgIGRpc2NvdmVyeURvY3M6IHRoaXMuZGlzY292ZXJ5RG9jc1xuICAgIH0pO1xuICB9XG5cbiAgbG9hZEdhcGkoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBpZiAodHlwZW9mIGdhcGkgIT09ICd1bmRlZmluZWQnKSByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICBzY3JpcHQuc3JjID0gXCJodHRwczovL2FwaXMuZ29vZ2xlLmNvbS9qcy9jbGllbnQuanM/b25sb2FkPWdhYXBpX2xvYWRlZFwiO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKHNjcmlwdCk7XG4gICAgICAod2luZG93IGFzIGFueSkuZ2FhcGlfbG9hZGVkID0gcmVzb2x2ZTtcbiAgICB9KTtcbiAgfVxufVxuIiwiXG5leHBvcnQgaW50ZXJmYWNlIEtlZExlYXJuaW5nR29hbHNEYXRhIHtcbiAgbW9kdWxlTmFtZTogc3RyaW5nXG4gIHN1YmplY3Q6IHtcbiAgICBuYW1lOiBzdHJpbmdcbiAgICBjb3Vyc2U6IHtcbiAgICAgIG5hbWU6IHN0cmluZ1xuICAgICAgdXJsOiBzdHJpbmdcbiAgICB9XG4gIH1cbiAgc3RlcD86IG51bWJlclxuICBjb21tb25UYXNrczogS2VkTGVhcm5pbmdUYXNrW11cbiAgbGVhcm5pbmdHb2FsczogS2VkTGVhcm5pbmdHb2FsW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBLZWRMZWFybmluZ1Rhc2sge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEtlZExlYXJuaW5nR29hbCB7XG4gIG5hbWU6IHN0cmluZztcbiAgdGFza3M6IEtlZExlYXJuaW5nVGFza1tdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TGVhcm5pbmdHb2Fsc0FuZFRhc2tzKGFwaVBhdGg6IHN0cmluZywgcGFnZUlkOiBzdHJpbmcpIHtcbiAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2ggKGAke2FwaVBhdGh9P25vZGVJRD0ke3BhZ2VJZH1gLCB7Y3JlZGVudGlhbHM6IFwic2FtZS1vcmlnaW5cIn0pO1xuICBjb25zdCBkYXRhID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgcmV0dXJuIGRhdGEgYXMgS2VkTGVhcm5pbmdHb2Fsc0RhdGE7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7SW5qZWN0ZWRJbnRsUHJvcHN9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgQ2FsZW5kYXIgfSBmcm9tICcuL2luZGV4JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcblxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgSW5qZWN0ZWRJbnRsUHJvcHMge1xuICBmaXJzdERheTogbW9tZW50Lk1vbWVudCB8IHN0cmluZyB8IG51bWJlcjsgLy8gQ2hhbmdlZCBFbGVtZW50IEhUTUwgdGVtcGxhdGUgZG8gbm90IHVzZSBtb21lbnQoKSBhbmQgaW5zdGVhZCBhIG51bWVyaWMgc3RyaW5nIGNvbmZpZyBwYXJhbVxuICBudW1EYXlzOiBudW1iZXI7XG4gIGluaXRpYWxTdGFydEhvdXI6IG51bWJlcjtcbiAgaW5pdGlhbEVuZEhvdXI6IG51bWJlcjtcbiAgaW5pdGlhbFpvb206IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIENhbGVuZGFyU2VsZiAocHJvcHMgOiBQcm9wcykge1xuICBjb25zdCB7aW50bH0gPSBwcm9wcztcbiAgcmV0dXJuIDxMYW5ndWFnZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3tpbnRsfX0+XG4gICAgICAgICAgICA8Q2FsZW5kYXIgey4uLnsuLi5wcm9wcywgZW52fX0vPlxuICAgICAgICAgPC9MYW5ndWFnZUNvbnRleHQuUHJvdmlkZXI+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XG5pbXBvcnQge0luamVjdGVkSW50bFByb3BzfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCB7IENhbGVuZGFyIH0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgeyBUdXRvcmFibGVDb21wb25lbnQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvdHV0b3JhYmxlLWNvbXBvbmVudCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5cbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIEluamVjdGVkSW50bFByb3BzIHtcbiAgICBmaXJzdERheTogbW9tZW50Lk1vbWVudCB8IHN0cmluZyB8IG51bWJlcjsgLy8gQ2hhbmdlZCBFbGVtZW50IEhUTUwgdGVtcGxhdGUgZG8gbm90IHVzZSBtb21lbnQoKSBhbmQgaW5zdGVhZCBhIG51bWVyaWMgc3RyaW5nIGNvbmZpZyBwYXJhbVxuICAgIG51bURheXM6IG51bWJlcjtcbiAgICBpbml0aWFsU3RhcnRIb3VyOiBudW1iZXI7XG4gICAgaW5pdGlhbEVuZEhvdXI6IG51bWJlcjtcbiAgICBpbml0aWFsWm9vbTogbnVtYmVyO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIENhbGVuZGFyVHV0b3JlZChwcm9wczogUHJvcHMpIHtcbiAgICBjb25zdCB7aW50bH0gPSBwcm9wcztcbiAgICByZXR1cm4gPExhbmd1YWdlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17e2ludGx9fT5cbiAgICA8VHV0b3JhYmxlQ29tcG9uZW50XG4gICAgICB0dXRvcmVkPXt0cnVlfVxuICAgICAgY3JlYXRlQ29tcG9uZW50PXtlbnYgPT5cbiAgICAgICAgPENhbGVuZGFyXG4gICAgICAgICAga2V5PXtlbnYuY3VycmVudFVzZXIubWFpbH1cbiAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgICAgZW52PXtlbnZ9IC8+XG4gICAgICB9XG4gICAgLz48L0xhbmd1YWdlQ29udGV4dC5Qcm92aWRlcj47XG59IiwiZXhwb3J0IGZ1bmN0aW9uIGNvdXJzZU5hbWVUb0Nzc0NsYXNzKGNzc1ByZWZpeDogc3RyaW5nLCBjb3Vyc2VOYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGAke2Nzc1ByZWZpeH0ke2NvdXJzZU5hbWUuc3Vic3RyKDAsMykudG9Mb3dlckNhc2UoKX1gO1xufVxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgZmxhdHRlbiwgZGlzdGluY3QsIGNvbXBhcmVQcm9wIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgU3R1ZGVudENhbGVuZGFyRXZlbnQgfSBmcm9tICcuL21vZGVscyc7XG5cbmludGVyZmFjZSBFdmVudE1ldGEge1xuICBpbmRleD86IG51bWJlcixcbiAgcHJldk92ZXJsYXBzPzogU3R1ZGVudENhbGVuZGFyRXZlbnRbXSAgXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcnVuY2hDb2xsaWRpbmdFdmVudHMgKFxuICBldmVudHM6IFN0dWRlbnRDYWxlbmRhckV2ZW50W10sXG4gIGlzTGFzdENhbGw/OiBib29sZWFuKVxuOiBTdHVkZW50Q2FsZW5kYXJFdmVudFtdXG57XG4gIGNvbnN0IHJlc3VsdDogKFN0dWRlbnRDYWxlbmRhckV2ZW50ICYgRXZlbnRNZXRhKVtdID0gW107XG4gIGV2ZW50cy5mb3JFYWNoKChldmVudCwgZXZlbnRJbmRleCkgPT4ge1xuICAgICAgY29uc3Qgb3ZlcmxhcHMgPSByZXN1bHQuZmlsdGVyKHggPT4geC5zdGFydE1vbWVudCAmJiB4LmVuZE1vbWVudCAmJlxuICAgICAgICAgICh4LnN0YXJ0TW9tZW50IDw9IGV2ZW50LnN0YXJ0TW9tZW50KSAmJlxuICAgICAgICAgICh4LmVuZE1vbWVudCA+IGV2ZW50LnN0YXJ0TW9tZW50KSk7XG4gICAgICBsZXQgYWxsT3ZlcmxhcHMgPSBvdmVybGFwcy5jb25jYXQoZmxhdHRlbiAob3ZlcmxhcHMubWFwKG8gPT4gby5wcmV2T3ZlcmxhcHMpKSk7XG4gICAgICBhbGxPdmVybGFwcyA9IGRpc3RpbmN0KGFsbE92ZXJsYXBzLCBvID0+IG8uaW5kZXgpO1xuICAgICAgYWxsT3ZlcmxhcHMuc29ydChjb21wYXJlUHJvcChcInN0YXJ0TW9tZW50XCIpKTtcbiAgICAgIGxldCB3aWR0aDsvLyA9IE1hdGgucm91bmQoMTAwIC8gTWF0aC5tYXgoKGFsbE92ZXJsYXBzLmxlbmd0aCArIDEpLCAxKSk7XG4gICAgICBsZXQgcG9zID0gMDtcbiAgICAgIGFsbE92ZXJsYXBzLmZvckVhY2goKG92ZXJsYXAsIGkpID0+IHtcbiAgICAgICAgaWYgKGkgJSA0ID09PSAwKSB7XG4gICAgICAgICAgd2lkdGggPSBNYXRoLm1heCgyNSwgTWF0aC5yb3VuZCgxMDAgLyBNYXRoLm1heChhbGxPdmVybGFwcy5sZW5ndGggLSBpICsgMSwgMSkpKTtcbiAgICAgICAgICBwb3MgPSAwO1xuICAgICAgICB9XG4gICAgICAgIG92ZXJsYXAud2lkdGggPSB3aWR0aDtcbiAgICAgICAgb3ZlcmxhcC5jbGFzc05hbWUgPSAob3ZlcmxhcC5jbGFzc05hbWUgfHwgXCJcIikuc3BsaXQoJyAnKVxuICAgICAgICAgIC5maWx0ZXIoY24gPT4gY24gIT09ICdzcGxpdHRlZCcpXG4gICAgICAgICAgLmNvbmNhdChcInNwbGl0dGVkXCIpXG4gICAgICAgICAgLmpvaW4oJyAnKSxcbiAgICAgICAgb3ZlcmxhcC5wb3MgPSBwb3M7XG4gICAgICAgIHBvcyArPSB3aWR0aDtcbiAgICAgIH0pO1xuICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAuLi5ldmVudCxcbiAgICAgICAgaW5kZXg6IGV2ZW50SW5kZXgsXG4gICAgICAgIHBvczogcG9zLFxuICAgICAgICB3aWR0aCxcbiAgICAgICAgY2xhc3NOYW1lOiB3aWR0aCA8IDEwMCA/XG4gICAgICAgICAgKGV2ZW50LmNsYXNzTmFtZSA/IGV2ZW50LmNsYXNzTmFtZSArIFwiIHNwbGl0dGVkXCIgOiBcInNwbGl0dGVkXCIpIDpcbiAgICAgICAgICBldmVudC5jbGFzc05hbWUsXG4gICAgICAgIHByZXZPdmVybGFwczogYWxsT3ZlcmxhcHNcbiAgICAgIH0pO1xuICAgICAgLyppZiAoaXNMYXN0Q2FsbCAmJiBtb21lbnQoZXZlbnQuc3RhcnQpLmRheSgpID09PSAxKSB7XG4gICAgICAgIGlmICgvU3ZlMi8udGVzdChldmVudC50ZXh0KSkge1xuICAgICAgICAgIGRlYnVnZ2VyO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvRnJhbnNrYS8udGVzdChldmVudC50ZXh0KSkge1xuICAgICAgICAgIGRlYnVnZ2VyO1xuICAgICAgICB9XG4gICAgICAgIGlmICgvVHlza2EvLnRlc3QoZXZlbnQudGV4dCkpIHtcbiAgICAgICAgICBkZWJ1Z2dlcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoL3NwYW5zay8udGVzdChldmVudC50ZXh0KSkgZGVidWdnZXI7XG4gICAgICAgIGlmICgvRW5nNi8udGVzdChldmVudC50ZXh0KSkgZGVidWdnZXI7XG4gICAgICB9Ki9cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQge01JTlVURX0gZnJvbSAnLi4vLi4vdXRpbHMvY29uc3RhbnRzJztcbmltcG9ydCB7TH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICAgIGlkOiBzdHJpbmcsXG4gICAgZGF5U3RhcnQsXG4gICAgc3RhcnRNb21lbnQ6IG1vbWVudC5Nb21lbnQsXG4gICAgZW5kTW9tZW50OiBtb21lbnQuTW9tZW50LFxuICAgIHRleHQ6IHN0cmluZyxcbiAgICBsb2NhdGlvbjogc3RyaW5nLFxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXG4gICAgd2lkdGg6IG51bWJlcixcbiAgICBwb3M6IG51bWJlcixcbiAgICBsb2NhbGU6IHN0cmluZyxcbiAgICB6b29tOiBudW1iZXIsXG4gICAgaHRtbExpbms6IHN0cmluZyxcbiAgICBjbGFzc05hbWU6IHN0cmluZ1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEYXlWaWV3RXZlbnQgKHtcbiAgICBpZCxcbiAgICBkYXlTdGFydCxcbiAgICBzdGFydE1vbWVudCxcbiAgICBlbmRNb21lbnQsXG4gICAgdGV4dCxcbiAgICBsb2NhdGlvbixcbiAgICBkZXNjcmlwdGlvbixcbiAgICB3aWR0aCxcbiAgICBwb3MsXG4gICAgbG9jYWxlLFxuICAgIHpvb20sXG4gICAgaHRtbExpbmssXG4gICAgY2xhc3NOYW1lXG59OiBQcm9wcykge1xuICAgIGNvbnN0IHRvcCA9IChtb21lbnQoc3RhcnRNb21lbnQpLmRpZmYoZGF5U3RhcnQpIC8gTUlOVVRFKSAqIHpvb207XG4gICAgY29uc3QgaGVpZ2h0ID0gKG1vbWVudChlbmRNb21lbnQpLmRpZmYoc3RhcnRNb21lbnQpIC8gTUlOVVRFKSAqIHpvb207XG4gICAgY29uc3QgbG9jYWxlVGltZU9wdGlvbnMgPSB7aG91cjogJ251bWVyaWMnLCBtaW51dGU6ICcyLWRpZ2l0J307XG4gICAgY29uc3QgbG9jYWxlU3RhcnRUaW1lID0gc3RhcnRNb21lbnQudG9EYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKGxvY2FsZSwgbG9jYWxlVGltZU9wdGlvbnMpO1xuICAgIGNvbnN0IGxvY2FsZUVuZFRpbWUgPSBlbmRNb21lbnQudG9EYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKGxvY2FsZSwgbG9jYWxlVGltZU9wdGlvbnMpO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtcImRheXZpZXdldmVudCBcIiArIGNsYXNzTmFtZX0gc3R5bGU9e3tcbiAgICAgICAgcG9zaXRpb246J2Fic29sdXRlJyxcbiAgICAgICAgYm94U2l6aW5nOiAnYm9yZGVyLWJveCcsXG4gICAgICAgIHRvcCxcbiAgICAgICAgbGVmdDogKHBvcyB8fCAwKSArIFwiJVwiLFxuICAgICAgICB3aWR0aDogKHdpZHRoIHx8IDEwMCkgKyAnJScsXG4gICAgICAgIGhlaWdodCxcbiAgICAgICAgbWF4SGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgIG92ZXJmbG93OiAnaGlkZGVuJ319XG5cbiAgICAgICAgdGl0bGU9e2Ake2xvY2FsZVN0YXJ0VGltZX0gLSAke2xvY2FsZUVuZFRpbWV9ICR7dGV4dH1gICtcbiAgICAgICAgICAgIChsb2NhdGlvbiA/XG4gICAgICAgICAgICAgICAgXCJcXG5cIiArIExgUGxhdHM6ICR7bG9jYXRpb259YCA6XG4gICAgICAgICAgICAgICAgXCJcIiApICtcbiAgICAgICAgICAgIChkZXNjcmlwdGlvbiA/XG4gICAgICAgICAgICAgICAgXCJcXG5cIiArIGRlc2NyaXB0aW9uIDpcbiAgICAgICAgICAgICAgICBcIlwiIClcbiAgICAgICAgfVxuICAgICAgICA+XG4gICAgICAgIDxhIGNsYXNzTmFtZT1cImV2ZW50LXRpdGxlXCIgaHJlZj17aHRtbExpbmt9IHRhcmdldD1cImNhbGVuZGFyLWV2ZW50XCI+XG4gICAgICAgICAgICB7dGV4dH1cbiAgICAgICAgPC9hPlxuICAgICAgICA8cCBjbGFzc05hbWU9XCJldmVudC1wZXJpb2RcIj5cbiAgICAgICAgICAgIHtsb2NhbGVTdGFydFRpbWV9IC0ge2xvY2FsZUVuZFRpbWV9XG4gICAgICAgIDwvcD5cbiAgICAgICAge2xvY2F0aW9uICYmXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJldmVudC1sb2NhdGlvblwiPlxuICAgICAgICAgICAgICAgIHtsb2NhdGlvbn1cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgfVxuICAgICAgICB7ZGVzY3JpcHRpb24gJiZcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImV2ZW50LWRlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICAgICAge2Rlc2NyaXB0aW9ufVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICB9XG4gICAgPC9kaXY+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IERheVZpZXdFdmVudCBmcm9tICcuL2RheS12aWV3LWV2ZW50JztcbmltcG9ydCBUaW1lTGluZXMgZnJvbSAnLi90aW1lLWxpbmVzJztcbmltcG9ydCB7TUlOVVRFfSBmcm9tICcuLi8uLi91dGlscy9jb25zdGFudHMnO1xuaW1wb3J0IHtjcnVuY2hDb2xsaWRpbmdFdmVudHN9IGZyb20gJy4vY3J1bmNoLWNvbGxpZGluZy1ldmVudHMnO1xuaW1wb3J0IHsgU3R1ZGVudENhbGVuZGFyRXZlbnQgfSBmcm9tICcuL21vZGVscyc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gICAgZGF5U3RhcnQ6IG1vbWVudC5Nb21lbnQ7ICAgLy8gTWlsbGlzZWNvbmRzIGF0IHN0YXJ0IG9mIHRoZSBkYXkgKGZvciBleGFtcGxlIDA4OjAwIHRoZSBkYXkpXG4gICAgZGF5RW5kOiBtb21lbnQuTW9tZW50OyAgICAgLy8gTWlsbGlzZWNvbmRzIGF0IGVuZCBvZiB0aGUgZGF5IChmb3IgZXhhbXBsZSAxNzowMCB0aGUgZGF5KVxuICAgIGV2ZW50czogU3R1ZGVudENhbGVuZGFyRXZlbnRbXSwgICAgIC8vIEV2ZW50cyB0byBzaG93XG4gICAgbG9jYWxlOiBzdHJpbmcsXG4gICAgem9vbTogbnVtYmVyLFxuICAgIGlzTGFzdENhbGw6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRGF5VmlldyAoe1xuICAgIGRheVN0YXJ0LCAgIC8vIE1pbGxpc2Vjb25kcyBhdCBzdGFydCBvZiB0aGUgZGF5IChmb3IgZXhhbXBsZSAwODowMCB0aGUgZGF5KVxuICAgIGRheUVuZCwgICAgIC8vIE1pbGxpc2Vjb25kcyBhdCBlbmQgb2YgdGhlIGRheSAoZm9yIGV4YW1wbGUgMTc6MDAgdGhlIGRheSlcbiAgICBldmVudHMsICAgICAvLyBFdmVudHMgdG8gc2hvd1xuICAgIGxvY2FsZSxcbiAgICB6b29tLFxuICAgIGlzTGFzdENhbGxcbn06IFByb3BzKSB7XG4gICAgY29uc3QgaGVpZ2h0ID0gKG1vbWVudChkYXlFbmQpLmRpZmYoZGF5U3RhcnQpIC8gTUlOVVRFKSAqIHpvb207XG5cbiAgICBjb25zdCBjcnVuY2hlZEV2ZW50cyA9IGNydW5jaENvbGxpZGluZ0V2ZW50cyhldmVudHMsIGlzTGFzdENhbGwpO1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkYXl2aWV3XCIgc3R5bGU9e3tcbiAgICAgICAgICAgIHRvcDogMCxcbiAgICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICAgIG1heEhlaWdodDogaGVpZ2h0LFxuICAgICAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbidcbiAgICAgICAgfX0+XG5cbiAgICAgICAgICAgIDxUaW1lTGluZXMgZGF5U3RhcnQ9e2RheVN0YXJ0fSBkYXlFbmQ9e2RheUVuZH0gem9vbT17em9vbX0gLz5cblxuICAgICAgICAgICAge2NydW5jaGVkRXZlbnRzLm1hcCAoZXYgPT4gPERheVZpZXdFdmVudFxuICAgICAgICAgICAgICAgIGtleT17ZXYuaWR9XG4gICAgICAgICAgICAgICAgaWQ9e2V2LmlkfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17ZXYuY2xhc3NOYW1lfVxuICAgICAgICAgICAgICAgIGRheVN0YXJ0PXtkYXlTdGFydH1cbiAgICAgICAgICAgICAgICBzdGFydE1vbWVudD17ZXYuc3RhcnRNb21lbnR9XG4gICAgICAgICAgICAgICAgZW5kTW9tZW50PXtldi5lbmRNb21lbnR9XG4gICAgICAgICAgICAgICAgdGV4dD17ZXYudGV4dH1cbiAgICAgICAgICAgICAgICBsb2NhdGlvbj17ZXYubG9jYXRpb259XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb249e2V2LmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICAgIHdpZHRoPXtldi53aWR0aH1cbiAgICAgICAgICAgICAgICBwb3M9e2V2LnBvc31cbiAgICAgICAgICAgICAgICBsb2NhbGU9e2xvY2FsZX1cbiAgICAgICAgICAgICAgICB6b29tPXt6b29tfVxuICAgICAgICAgICAgICAgIGh0bWxMaW5rPXtldi5odG1sTGlua31cbiAgICAgICAgICAgIC8+KX1cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBIb3VyTWFya2VyICh7c3RhcnRIb3VyLCBlbmRIb3VyLCBsb2NhbGUsIHpvb219KSB7XG4gICAgY29uc3QgaG91clBpeGVscyA9IDYwICogem9vbTtcblxuICAgIGNvbnN0IGhvdXJzID0gW107XG4gICAgZm9yIChsZXQgaG91ciA9IHN0YXJ0SG91cjsgaG91ciA8PSBlbmRIb3VyOyArK2hvdXIpIHtcbiAgICAgICAgaG91cnMucHVzaChob3VyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJob3VybWFya2VyXCIgc3R5bGU9e3tcbiAgICAgICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgICAgIGxlZnQ6IDAsXG4gICAgICAgIHRvcDogMCxcbiAgICAgICAgb3ZlcmZsb3c6ICd2aXNpYmxlJyxcbiAgICAgICAgaGVpZ2h0OiAoZW5kSG91ciAtIHN0YXJ0SG91cikgKiBob3VyUGl4ZWxzXG4gICAgfX0+XG4gICAgICB7aG91cnMubWFwKChob3VyLCBpKSA9PiB7XG4gICAgICAgIGNvbnN0IHlwb3MgPSBpICogaG91clBpeGVscztcbiAgICAgICAgcmV0dXJuIDxzcGFuIGtleT17aG91cn0+PGRpdiBzdHlsZT17e1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgIGxlZnQ6IDAsXG4gICAgICAgICAgICAgICAgdG9wOiB5cG9zLFxuICAgICAgICAgICAgICAgIG1hcmdpblRvcDogJy00cHgnLCAvLyBDU1MhXG4gICAgICAgICAgICAgICAgcGFkZGluZzogMFxuICAgICAgICAgICAgfX0+XG4gICAgICAgICAgICAgICAge21vbWVudCgpLmhvdXIoaG91cikubWludXRlKDApLnRvRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwge2hvdXI6IFwiMi1kaWdpdFwiLCBtaW51dGU6IFwiMi1kaWdpdFwifSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHsvKjxkaXYgY2xhc3NOYW1lPVwiaG91cmxpbmVcIlxuICAgICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNlZWVlRjInLCAvLyBDU1MhXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnMjRweCcsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiAnNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAwLFxuICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAwLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6ICcxcHgnLFxuICAgICAgICAgICAgICAgICAgICB0b3A6IHlwb3NcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHtob3VyIDwgZW5kSG91ciAmJiA8ZGl2IGNsYXNzTmFtZT1cImhhbHZob3VybGluZVwiXG4gICAgICAgICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2VlZWVGMicsIC8vIENTUyFcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICAgICAgICAgIGxlZnQ6ICcyNnB4JyxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICc0cHgnLFxuICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogJzFweCcsXG4gICAgICAgICAgICAgICAgICAgIHRvcDogeXBvcyArIChob3VyUGl4ZWxzIC8gMikgKyAxXG4gICAgICAgICAgICB9fSAvPiB9ICovfVxuICAgICAgICA8L3NwYW4+O1xuICAgIH0pfTwvZGl2Pjtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBXZWVrVmlldyBmcm9tICcuL3dlZWstdmlldyc7XG5pbXBvcnQge0dvb2dsZUNhbGVuZGFyfSBmcm9tICcuLi8uLi9hcGlzL2dvb2dsZS1jYWxlbmRhcic7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQge2Nsb25lLCBmbGF0dGVuLCBMfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgU3RhdHVzQmFyIGZyb20gJy4vc3RhdHVzLWJhcic7XG5pbXBvcnQge2NvdXJzZU5hbWVUb0Nzc0NsYXNzfSBmcm9tICcuL2NvdXJzZS1uYW1lLXRvLWNzcy1jbGFzcyc7XG5pbXBvcnQge3Nob3VsZEluY2x1ZGVDYWxlbmRhcn0gZnJvbSAnLi9zaG91bGQtaW5jbHVkZS1jYWxlbmRhcic7XG5pbXBvcnQgeyBsb2NhbE1vbWVudCB9IGZyb20gJy4uLy4uL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZSc7XG5pbXBvcnQgZW52LCB7IEVudiB9IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgICBmaXJzdERheTogbW9tZW50Lk1vbWVudCB8IHN0cmluZyB8IG51bWJlcjtcbiAgICBudW1EYXlzOiBudW1iZXI7XG4gICAgaW5pdGlhbFN0YXJ0SG91cjogbnVtYmVyO1xuICAgIGluaXRpYWxFbmRIb3VyOiBudW1iZXI7XG4gICAgaW5pdGlhbFpvb206IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgICBmaXJzdERheTogbW9tZW50Lk1vbWVudCxcbiAgICBzdGFydEhvdXI6IG51bWJlcixcbiAgICBlbmRIb3VyOiBudW1iZXIsXG4gICAgem9vbTogbnVtYmVyLFxuICAgIGNhbGVuZGFyczoge1tjYWxlbmRhcklkOiBzdHJpbmddOiB7XG4gICAgICAgIGNhbGVuZGFyOiBnYXBpLmNsaWVudC5jYWxlbmRhci5DYWxlbmRhckxpc3RFbnRyeSxcbiAgICAgICAgZXZlbnRzOiBnYXBpLmNsaWVudC5jYWxlbmRhci5FdmVudFtdIH19LFxuICAgIGNhbGVuZGFyc0JlaW5nTG9hZGVkOiBzdHJpbmdbXSxcbiAgICBzdGF0dXM6IHN0cmluZyxcbiAgICBlcnJvcjogRXJyb3IgfCBudWxsIFxufVxuICBcbmV4cG9ydCBjbGFzcyBDYWxlbmRhciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyAmIHtlbnY6IEVudn0sIFN0YXRlPiB7XG4gICAgZ2NhbDogR29vZ2xlQ2FsZW5kYXI7XG4gICAgc3RhdGljIGNvbnRleHRUeXBlID0gTGFuZ3VhZ2VDb250ZXh0O1xuXG4gICAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcyAmIHtlbnY6IEVudn0pIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICAvLyBQcm9wc1xuICAgICAgICBsZXQge2ZpcnN0RGF5fSA9IHByb3BzO1xuICAgICAgICBpZiAodHlwZW9mIGZpcnN0RGF5ID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgZmlyc3REYXkgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICBmaXJzdERheSA9IG1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS53ZWVrZGF5KGZpcnN0RGF5IGFzIG51bWJlcik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgaW5pdGlhbFN0YXJ0SG91cixcbiAgICAgICAgICAgIGluaXRpYWxFbmRIb3VyLFxuICAgICAgICAgICAgaW5pdGlhbFpvb21cbiAgICAgICAgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIFxuICAgICAgICAvLyBTdGF0ZVxuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgICAgZmlyc3REYXksXG4gICAgICAgICAgICBzdGFydEhvdXI6IGluaXRpYWxTdGFydEhvdXIsXG4gICAgICAgICAgICBlbmRIb3VyOiBpbml0aWFsRW5kSG91cixcbiAgICAgICAgICAgIHpvb206IGluaXRpYWxab29tLFxuICAgICAgICAgICAgY2FsZW5kYXJzOiB7fSxcbiAgICAgICAgICAgIGNhbGVuZGFyc0JlaW5nTG9hZGVkOiBbXSxcbiAgICAgICAgICAgIHN0YXR1czogJ0xvYWRpbmcgY2FsZW5kYXJzLi4uIChhdXRoZW50aWNhdGluZy4uLiknLFxuICAgICAgICAgICAgZXJyb3I6IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qge2dvb2dsZVRva2VuUHJvdmlkZXJ9ID0gcHJvcHMuZW52IHx8IGVudjtcbiAgICAgICAgdGhpcy5nY2FsID0gbmV3IEdvb2dsZUNhbGVuZGFyKGdvb2dsZVRva2VuUHJvdmlkZXIpO1xuXG4gICAgICAgIC8vIFN0YXJ0IGNhbGxpbmcgb24gR29vZ2xlIEFQSSByaWdodCBhd2F5LiBTdG9yZSBwcm9taXNlIGluIHByb3BlcnR5LlxuICAgICAgICB0aGlzLmdjYWwuZW5zdXJlSW5pdGVkKCkudGhlbigoKT0+e1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZERhdGEoZmlyc3REYXkpO1xuICAgICAgICB9KS5jYXRjaCAoZXJyb3IgPT4ge1xuICAgICAgICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhbmRsZUVycm9yKGVycm9yKSB7XG4gICAgICAgIGlmICghZXJyb3IpIGVycm9yID0gXCJVbmtub3duIGVycm9yXCI7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yfSk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IgKGVycm9yLnN0YWNrIHx8IGVycm9yKTsgLy8gS2VlcCFcbiAgICB9XG5cbiAgICBsb2FkRGF0YShmaXJzdERheSkge1xuICAgICAgICAvLyBQcm9wc1xuICAgICAgICBjb25zdCB7bnVtRGF5c30gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZmlyc3REYXksXG4gICAgICAgICAgICBjYWxlbmRhcnM6IHt9LFxuICAgICAgICAgICAgY2FsZW5kYXJzQmVpbmdMb2FkZWQ6IFtdLFxuICAgICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgICBzdGF0dXM6IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJjYWxlbmRhci5sb2FkaW5nQ2FsZW5kYXJcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiTG9hZGluZyBjYWxlbmRhcnMuLi4gKGxpc3RpbmcuLi4pXCJ9KVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBJbXBvcnRhbnQgdG8gcmV0dXJuIHRoZSBQcm9taXNlIHNvIHRoYXQgY2FsbGVyIHdpbGwgY2F0Y2ggYW55IGVycm9yLlxuICAgICAgICByZXR1cm4gdGhpcy5nY2FsLmxpc3RDYWxlbmRhcnMoKS50aGVuKGNhbGVuZGFycyA9PiB7XG4gICAgICAgICAgICAvLyBJZ25vcmUgdGhlIFwid2VlayBudW1iZXJzXCIgY2FsZW5kYXIgYXMgd2UgYWxyZWFkeSBpbmNsdWRlIHdlZWsgbnVtYmVycyBpbiBvdXIgdmlld1xuICAgICAgICAgICAgY2FsZW5kYXJzID0gY2FsZW5kYXJzLmZpbHRlcihjYWwgPT4gc2hvdWxkSW5jbHVkZUNhbGVuZGFyKGNhbCkpO1xuICAgICAgICAgICAgLy8hL1dlZWsgTnVtYmVycy9pZy50ZXN0KGMuc3VtbWFyeSlcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY2FsZW5kYXJzLm1hcChjID0+ICh7YmdDb2xvcjogYy5iYWNrZ3JvdW5kQ29sb3IsIHByaW1hcnk6IGMucHJpbWFyeSwgc3VtbWFyeTogYy5zdW1tYXJ5LCB4OiBjfSkpKTtcbiAgICAgICAgICAgIC8vIENhbGVuZGFycyBTdWNjZXNzZnVsbHkgbGlzdGVkLlxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOlwiY2FsZW5kYXIubG9hZENhbGVuZGFyRXZlbnRzXCIsIGRlZmF1bHRNZXNzYWdlOiBcIkxvYWQgY2FsZW5kYXIgZXZlbnRzLi4uXCJ9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmdjYWwuYmF0Y2hFdmVudHMoe1xuICAgICAgICAgICAgICAgIGNhbGVuZGFyTGlzdDogY2FsZW5kYXJzLFxuICAgICAgICAgICAgICAgIHRpbWVNaW46IG1vbWVudChmaXJzdERheSkuc3RhcnRPZignZGF5JyksXG4gICAgICAgICAgICAgICAgdGltZU1heDogbW9tZW50KGZpcnN0RGF5KS5hZGQobnVtRGF5cywgJ2RheXMnKS5lbmRPZignZGF5JylcbiAgICAgICAgICAgIH0pLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjYWxlbmRhcnM6IHJlc3VsdCwgc3RhdHVzOiAnJ30pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG5hdmlnYXRlVG9QcmV2aW91c1dlZWsoKSB7XG4gICAgICAgIHRoaXMubG9hZERhdGEobW9tZW50KHRoaXMuc3RhdGUuZmlyc3REYXkpLmFkZCgtMSwgXCJ3ZWVrXCIpKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgbmF2aWdhdGVUb05leHRXZWVrKCkge1xuICAgICAgICB0aGlzLmxvYWREYXRhKG1vbWVudCh0aGlzLnN0YXRlLmZpcnN0RGF5KS5hZGQoMSwgXCJ3ZWVrXCIpKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVuZGVyICgpIHtcbiAgICAgICAgLy8gUHJvcHNcbiAgICAgICAgY29uc3QgeyBudW1EYXlzIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgIFxuICAgICAgICAvLyBTdGF0ZVxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBmaXJzdERheSxcbiAgICAgICAgICAgIHN0YXJ0SG91cixcbiAgICAgICAgICAgIGVuZEhvdXIsXG4gICAgICAgICAgICB6b29tLFxuICAgICAgICAgICAgY2FsZW5kYXJzLFxuICAgICAgICAgICAgc3RhdHVzLFxuICAgICAgICAgICAgZXJyb3JcbiAgICAgICAgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAgICAgY29uc3QgZXZlbnRTZXRzID0gT2JqZWN0LmtleXMoY2FsZW5kYXJzKVxuICAgICAgICAgICAgLm1hcChjYWxlbmRhcklkID0+IGNhbGVuZGFyc1tjYWxlbmRhcklkXSlcbiAgICAgICAgICAgIC5tYXAoKHtjYWxlbmRhciwgZXZlbnRzfSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzU2NoZWR1bGUgPSBjYWxlbmRhci5zdW1tYXJ5ID09PSAnU2tvbHNjaGVtYScgJiYgY2FsZW5kYXIuZGVzY3JpcHRpb24gPT09IFwiU3luY2hyb25pemVkXCI7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNIb2xpZGF5ID0gL2hvbGlkYXkvLnRlc3QoY2FsZW5kYXIuaWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2xhc3NSb29tID0gL2NsYXNzcm9vbS8udGVzdChjYWxlbmRhci5pZCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjbGFzc05hbWVzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKGNhbGVuZGFyLmNvbG9ySWQpIGNsYXNzTmFtZXMucHVzaChcImdjYWwtcGFsZXR0ZS1cIiArIGNhbGVuZGFyLmNvbG9ySWQpO1xuICAgICAgICAgICAgICAgIGlmIChpc1NjaGVkdWxlKSBjbGFzc05hbWVzLnB1c2goXCJjb3Vyc2UtZXZlbnRcIik7XG4gICAgICAgICAgICAgICAgaWYgKGlzSG9saWRheSkgY2xhc3NOYW1lcy5wdXNoKFwiaG9saWRheS1ldmVudFwiKTtcbiAgICAgICAgICAgICAgICAvLyBNYXAgR29vZ2xlIENhbGVuZGFyIGV2ZW50cyB0byBvdXIgb3duIGZvcm1hdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnRzLm1hcChldmVudCA9PiAoe1xuICAgICAgICAgICAgICAgICAgICBpZDogZXZlbnQuaWQsXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0OiBldmVudC5zdGFydCxcbiAgICAgICAgICAgICAgICAgICAgZW5kOiBldmVudC5lbmQsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGV2ZW50LnN1bW1hcnksXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uOiBldmVudC5sb2NhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGV2ZW50LmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAvL2JnQ29sb3I6IGNhbGVuZGFyLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgLy9mZ0NvbG9yOiBjYWxlbmRhci5mb3JlZ3JvdW5kQ29sb3IsXG4gICAgICAgICAgICAgICAgICAgIGh0bWxMaW5rOiBldmVudC5odG1sTGluayxcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAoaXNTY2hlZHVsZSAmJiBldmVudC5zdW1tYXJ5ID9cbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMuY29uY2F0KGNvdXJzZU5hbWVUb0Nzc0NsYXNzKCdjb3Vyc2UtZXZlbnQtJywgZXZlbnQuc3VtbWFyeSkpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZXMpLmpvaW4oXCIgXCIpXG4gICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgY29uc3QgZXZlbnRzID0gZmxhdHRlbihldmVudFNldHMpO1xuXG4gICAgICAgIC8vIEVsc2UsIHJlbmRlciB0aGUgV2Vla1ZpZXcgbm93LiBBbnkgZXJyb3Igc2hvdWxkIGJlIGRpc3BsYXllZCBhcyByZWQgc3RhdHVzXG4gICAgICAgIHJldHVybiA8ZGl2IHN0eWxlPXt7cG9zaXRpb246ICdyZWxhdGl2ZScsIHRvcDogMCwgbGVmdDogMH19PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tdG9vbGJhciB3ZWVrLW5hdmlnYXRpb25cIiA+XG4gICAgICAgICAgICAgICAgey8qPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtMYElkYWdgfVxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj4qL31cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bi1ncm91cFwiPlxuICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLm5hdmlnYXRlVG9QcmV2aW91c1dlZWsoKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1sZWZ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+dGhpcy5uYXZpZ2F0ZVRvTmV4dFdlZWsoKX0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1yaWdodFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj4gIFxuICAgICAgICAgICAgICAgICAgICB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcImNhbGVuZGFyLmN1cnJlbnREYXRlXCIsIGRlZmF1bHRNZXNzYWdlOiBcIlZlY2thIHt3ZWVrfSwge3llYXJ9XCJ9LCB7d2VlazogbW9tZW50KGZpcnN0RGF5KS53ZWVrKCksIHllYXI6bW9tZW50KGZpcnN0RGF5KS55ZWFyKCl9KX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPFdlZWtWaWV3XG4gICAgICAgICAgICAgICAgbG9jYWxlPXtpbnRsLmxvY2FsZX1cbiAgICAgICAgICAgICAgICBmaXJzdERheT17Zmlyc3REYXl9XG4gICAgICAgICAgICAgICAgc3RhcnRIb3VyPXtzdGFydEhvdXJ9XG4gICAgICAgICAgICAgICAgZW5kSG91cj17ZW5kSG91cn1cbiAgICAgICAgICAgICAgICBudW1EYXlzPXtudW1EYXlzfVxuICAgICAgICAgICAgICAgIHpvb209e3pvb219XG4gICAgICAgICAgICAgICAgZXZlbnRzPXtldmVudHN9XG4gICAgICAgICAgICAgICAgc3RhdHVzPXtzdGF0dXN9XG4gICAgICAgICAgICAgICAgZXJyb3I9e2Vycm9yfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgfVxufVxuIiwiLyogQ2FsZW5kYXJzIHRvIHNob3c6XG5cbiAgICBzdW1tYXJ5OiBcIk1hdHNlZGVsXCIsXG4gICAgc3VtbWFyeTogXCJTa29sc2NoZW1hXCIsXG4gICAgcHJpbWFyeTogdHJ1ZVxuICAgIGlkLmluY2x1ZGVzKCdjbGFzc3Jvb20nKVxuICAgIGlkLmluY2x1ZGVzKCdob2xpZGF5JylcbiovXG5cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3VsZEluY2x1ZGVDYWxlbmRhciAoY2FsOiBnYXBpLmNsaWVudC5jYWxlbmRhci5DYWxlbmRhckxpc3RFbnRyeSkge1xuICBjb25zdCBzdW1tYXJ5ID0gY2FsLnN1bW1hcnkgfHwgXCJcIjtcbiAgY29uc3QgaXNPd25lciA9IC9vd25lci9pZy50ZXN0KGNhbC5hY2Nlc3NSb2xlKTtcbiAgY29uc3QgaXNQcmltYXJ5ID0gISFjYWwucHJpbWFyeTtcbiAgY29uc3QgaXNDbGFzc3Jvb21DYWxlbmRhciA9IC9jbGFzc3Jvb20vaWcudGVzdChjYWwuaWQpO1xuICBjb25zdCBpc0hvbGlkYXlDYWxlbmRhciA9IC9ob2xpZGF5L2lnLnRlc3QoY2FsLmlkKTtcblxuICByZXR1cm4gKFxuICAgIGlzUHJpbWFyeSB8fFxuICAgIGlzQ2xhc3Nyb29tQ2FsZW5kYXIgfHxcbiAgICBpc0hvbGlkYXlDYWxlbmRhciB8fFxuICAgIC8vL21hdHNlZGVsL2lnLnRlc3Qoc3VtbWFyeSkgfHxcbiAgICAoL3NjaGVtYS9pZy50ZXN0KHN1bW1hcnkpICYmIGlzT3duZXIpXG4gICk7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFN0YXR1c0JhciAoe3N0YXR1cywgZXJyb3J9KSB7XG4gICAgaWYgKCFzdGF0dXMgJiYgIWVycm9yKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdGF0dXNiYXJcIj5cbiAgICAgICAge2Vycm9yID9cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImVycm9yXCI+eycnK2Vycm9yfTwvcD4gOlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic3RhdHVzXCI+e3N0YXR1c308L3A+fVxuICAgIDwvZGl2PlxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBUaW1lTGluZXMgKHtkYXlTdGFydCwgZGF5RW5kLCB6b29tfSkge1xuICAgIGNvbnN0IGhvdXJQaXhlbHMgPSA2MCAqIHpvb207XG4gICAgY29uc3Qgc3RhcnRIb3VyID0gbW9tZW50KGRheVN0YXJ0KS5ob3VyKCk7XG4gICAgY29uc3QgZW5kSG91ciA9IG1vbWVudChkYXlFbmQpLmhvdXIoKTtcblxuICAgIGNvbnN0IGhvdXJzID0gW107XG4gICAgZm9yIChsZXQgaG91ciA9IHN0YXJ0SG91cjsgaG91ciA8PSBlbmRIb3VyOyArK2hvdXIpIHtcbiAgICAgICAgaG91cnMucHVzaChob3VyKTtcbiAgICB9XG5cbiAgICByZXR1cm4gPGRpdj5cbiAgICAgICAge2hvdXJzLm1hcChob3VyID0+IFxuICAgICAgICAgICAgPGRpdiBrZXk9e2hvdXJ9IGNsYXNzTmFtZT1cInRpbWVsaW5lXCIgc3R5bGU9e3tcbiAgICAgICAgICAgICAgICB3aWR0aDogJzEwMCUnLFxuICAgICAgICAgICAgICAgIGJveFNpemluZzogJ2JvcmRlci1ib3gnLFxuICAgICAgICAgICAgICAgIG1hcmdpbjogYCR7aG91clBpeGVscyAvIDJ9cHggMCAwIDBgLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaG91clBpeGVscyAvIDJcbiAgICAgICAgfX0gLz4gKX1cbiAgICA8L2Rpdj47XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgRGF5VmlldyBmcm9tICcuL2RheS12aWV3JztcbmltcG9ydCBIb3VyTWFya2VyIGZyb20gJy4vaG91ci1tYXJrZXInO1xuaW1wb3J0IHtjYXBpdGFsaXplRmlyc3QsIGNsb25lLCBMfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgU3RhdHVzQmFyIGZyb20gJy4vc3RhdHVzLWJhcic7XG5pbXBvcnQgeyBTdHVkZW50Q2FsZW5kYXJFdmVudCwgRGF5RGF0YSB9IGZyb20gJy4vbW9kZWxzJztcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICAgIGZpcnN0RGF5OiBtb21lbnQuTW9tZW50LCAgLy8ge21vbWVudH0gVGhlIGRheSB0byBzdGFydCB3aXRoIChub3JtYWxseSBhIG1vbmRheSlcbiAgICBzdGFydEhvdXI6IG51bWJlciwgLy8ge251bWJlcn0gVGhlIGhvdXIgdG8gc3RhcnQgb25cbiAgICBlbmRIb3VyOiBudW1iZXIsICAgLy8ge251bWJlcn0gVGhlIGhvdXIgdG8gZW5kIHJlbmRlcmluZyBwZXIgZGF5XG4gICAgbnVtRGF5czogbnVtYmVyLCAgIC8vIHtudW1iZXJ9IE51bWJlciBvZiBkYXlzLCBub3JtYWxseSA1LlxuICAgIGV2ZW50czogU3R1ZGVudENhbGVuZGFyRXZlbnRbXSwgICAgLy8gQXJyYXkgb2YgZXZlbnRzIHRvIGRpc3BsYXkgaW4gdGhlIHdlZWsuXG4gICAgbG9jYWxlOiBzdHJpbmcsICAgIC8vIExvY2FsZSB0byB1c2UgZm9yIHNob3dpbmcgd2VlayBkYXlzIGFuZCBob3VyIG1hcmtzLlxuICAgIHpvb206IG51bWJlciwgICAgICAvLyB7bnVtYmVyfSBab29tIHdoZXJlIDEgbWVhbnMgdGhhdCAxIG1pbnV0ZSA9IDEgcGl4ZWwuICBcbiAgICBzdGF0dXM/OiBzdHJpbmcsXG4gICAgZXJyb3I/OiBFcnJvclxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBXZWVrVmlldyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICAgIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcbiAgICByZW5kZXIgKCkge1xuICAgICAgICAvLyBQcm9wczpcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZmlyc3REYXksICAvLyB7bW9tZW50fSBUaGUgZGF5IHRvIHN0YXJ0IHdpdGggKG5vcm1hbGx5IGEgbW9uZGF5KVxuICAgICAgICAgICAgc3RhcnRIb3VyLCAvLyB7bnVtYmVyfSBUaGUgaG91ciB0byBzdGFydCBvblxuICAgICAgICAgICAgZW5kSG91ciwgICAvLyB7bnVtYmVyfSBUaGUgaG91ciB0byBlbmQgcmVuZGVyaW5nIHBlciBkYXlcbiAgICAgICAgICAgIG51bURheXMsICAgLy8ge251bWJlcn0gTnVtYmVyIG9mIGRheXMsIG5vcm1hbGx5IDUuXG4gICAgICAgICAgICBldmVudHMsICAgIC8vIEFycmF5IG9mIGV2ZW50cyB0byBkaXNwbGF5IGluIHRoZSB3ZWVrLlxuICAgICAgICAgICAgbG9jYWxlLCAgICAvLyBMb2NhbGUgdG8gdXNlIGZvciBzaG93aW5nIHdlZWsgZGF5cyBhbmQgaG91ciBtYXJrcy5cbiAgICAgICAgICAgIHpvb20sICAgICAgLy8ge251bWJlcn0gWm9vbSB3aGVyZSAxIG1lYW5zIHRoYXQgMSBtaW51dGUgPSAxIHBpeGVsLiAgXG4gICAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgICBlcnJvclxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XG5cbiAgICAgICAgLy8gUHJlcGFyZSBEYXlWaWV3IGRhdGFzIFxuICAgICAgICBjb25zdCBkYXlEYXRhczogRGF5RGF0YVtdID0gW107XG4gICAgICAgIGxldCBkYXkgPSBtb21lbnQoZmlyc3REYXkpO1xuICAgICAgICBmb3IgKGxldCBpPTA7aTxudW1EYXlzOyArK2kpIHtcbiAgICAgICAgICAgIGNvbnN0IGRheVN0YXJ0ID0gbW9tZW50KGRheSkuaG91cihzdGFydEhvdXIpO1xuICAgICAgICAgICAgY29uc3QgZGF5RW5kID0gbW9tZW50KGRheSkuaG91cihlbmRIb3VyKTtcbiAgICAgICAgICAgIGNvbnN0IGRheURhdGUgPSBtb21lbnQoZGF5KS5mb3JtYXQoJ3l5eXktTU0tREQnKTtcbiAgICAgICAgICAgIGNvbnN0IGlzVG9kYXkgPSBtb21lbnQoZGF5U3RhcnQpLnN0YXJ0T2YoXCJkYXlcIikudmFsdWVPZigpID09PSBtb21lbnQoKS5zdGFydE9mKFwiZGF5XCIpLnZhbHVlT2YoKTtcbiAgICAgICAgICAgIGRheURhdGFzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IGNhcGl0YWxpemVGaXJzdChkYXlTdGFydC50b0RhdGUoKS50b0xvY2FsZVN0cmluZyhsb2NhbGUsIHtcbiAgICAgICAgICAgICAgICAgICAgd2Vla2RheTogJ2xvbmcnLFxuICAgICAgICAgICAgICAgICAgICBkYXk6J251bWVyaWMnLFxuICAgICAgICAgICAgICAgICAgICBtb250aDogJ3Nob3J0J30pKSxcbiAgICAgICAgICAgICAgICBkYXlTdGFydCxcbiAgICAgICAgICAgICAgICBkYXlFbmQsXG4gICAgICAgICAgICAgICAgaXNUb2RheSxcbiAgICAgICAgICAgICAgICBldmVudHM6IGV2ZW50cy5maWx0ZXIoZXZlbnQgPT5cbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RhcnQgJiYgZXZlbnQuZW5kICYmIGV2ZW50LnN0YXJ0LmRhdGVUaW1lICYmIGV2ZW50LmVuZC5kYXRlVGltZSAmJlxuICAgICAgICAgICAgICAgICAgICAobW9tZW50KGV2ZW50LnN0YXJ0LmRhdGVUaW1lKS5pc0JldHdlZW4oZGF5U3RhcnQsIGRheUVuZCkgfHxcbiAgICAgICAgICAgICAgICAgICAgIG1vbWVudChldmVudC5lbmQuZGF0ZVRpbWUpLmlzQmV0d2VlbihkYXlTdGFydCwgZGF5RW5kKSkpXG4gICAgICAgICAgICAgICAgICAgICAvLyBDaGFuZ2Ugc3RhcnQgLyBlbmQgdG8gZGlyZWN0bHkgcG9pbnQgdG8gdGhlIGRhdGVUaW1lXG4gICAgICAgICAgICAgICAgICAgICAubWFwKGV2ZW50ID0+IGNsb25lKGV2ZW50LCB7c3RhcnRNb21lbnQ6IG1vbWVudChldmVudC5zdGFydC5kYXRlVGltZSksIGVuZE1vbWVudDogbW9tZW50KGV2ZW50LmVuZC5kYXRlVGltZSl9KSlcbiAgICAgICAgICAgICAgICAgICAgIC5zb3J0KChhLGIpID0+IGEuc3RhcnRNb21lbnQudmFsdWVPZiA+IGIuc3RhcnRNb21lbnQudmFsdWVPZiA/IDEgOiBhLnN0YXJ0TW9tZW50IDwgYi5zdGFydE1vbWVudCA/IC0xIDogMCksXG4gICAgICAgICAgICAgICAgZnVsbERheUV2ZW50czogZXZlbnRzLmZpbHRlcihldmVudCA9PlxuICAgICAgICAgICAgICAgICAgICAvLyBWZXJpZnkgdGhhdCBpdCBpcyBhIGZ1bGwtZGF5LWV2ZW50XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0YXJ0ICYmIGV2ZW50LmVuZCAmJiBldmVudC5zdGFydC5kYXRlICYmIGV2ZW50LmVuZC5kYXRlICYmXG4gICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmeSBpdCBhcHBsaWVzIHRvIGN1cnJlbnQgZGF5XG4gICAgICAgICAgICAgICAgICAgIChldmVudC5zdGFydC5kYXRlIDw9IGRheURhdGUgJiYgZXZlbnQuZW5kLmRhdGUgPiBkYXlEYXRlKSkgXG4gICAgICAgICAgICAgICAgICAgICAvLyBDaGFuZ2Ugc3RhcnQgLyBlbmQgdG8gZGlyZWN0bHkgcG9pbnQgdG8gdGhlIGRhdGUgb2JqZWN0XG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZXZlbnQgPT4gY2xvbmUoZXZlbnQsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogZXZlbnQuc3RhcnQuZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGU6IGV2ZW50LmVuZC5kYXRlfSkpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRheSA9IG1vbWVudChkYXkpIC8vIGNsb25lIGl0XG4gICAgICAgICAgICAgICAgLmFkZCgxLCAnZGF5cycpOyAvLyBBZGQgYW5vdGhlciBkYXlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJlbmRlclxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ2ZW1lbmRvLXdlZWt2aWV3XCI+XG4gICAgICAgICAgPHRhYmxlPjx0Ym9keT5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IDB9fT48L3RkPlxuICAgICAgICAgICAgICAgIHtkYXlEYXRhcy5tYXAoZCA9PiA8dGQga2V5PXtkLmRheVN0YXJ0LnRvSVNPU3RyaW5nKCl9IGNsYXNzTmFtZT17ZC5pc1RvZGF5ID8gXCJ0b2RheVwiIDogbnVsbH0+XG4gICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImRheW5hbWVcIj57ZC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgICA8L3RkPil9XG4gICAgICAgICAgICA8L3RyPjx0cj5cbiAgICAgICAgICAgICAgICA8dGQgc3R5bGU9e3tib3JkZXI6IDB9fT48cCBjbGFzc05hbWU9XCJ3ZWVrLW51bWJlclwiPntpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOlwiY2FsZW5kYXIud2Vla051bWJlclwiLCBkZWZhdWx0TWVzc2FnZTpcIlZ7d2Vla051bWJlcn1cIn0sIHt3ZWVrTnVtYmVyOm1vbWVudChmaXJzdERheSkud2VlaygpfSl9PC9wPjwvdGQ+XG4gICAgICAgICAgICAgICAge2RheURhdGFzLm1hcChkYXkgPT5cbiAgICAgICAgICAgICAgICAgICAgPHRkIGtleT17ZGF5LmRheVN0YXJ0LnRvSVNPU3RyaW5nKCl9IGNsYXNzTmFtZT17ZGF5LmlzVG9kYXkgPyBcInRvZGF5XCIgOiBudWxsfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtkYXkuZnVsbERheUV2ZW50cy5tYXAoKHtpZCwgdGV4dCwgbG9jYXRpb24sIGRlc2NyaXB0aW9uLCBodG1sTGluaywgY2xhc3NOYW1lfSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGtleT17aWR9IGNsYXNzTmFtZT17XCJkYXl2aWV3ZXZlbnQgZnVsbC1kYXkgXCIgKyBjbGFzc05hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtgJHt0ZXh0fWAgKyAobG9jYXRpb24gP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcXG5cIiArIGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJjYWxlbmRhci5mdWxsRGF5RXZlbnRMb2NhdGlvblwiLCBkZWZhdWx0TWVzc2FnZTpcIlBsYXRzOiB7bG9jYXRpb259XCJ9LCB7bG9jYXRpb246bG9jYXRpb259KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVzY3JpcHRpb24gP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXFxuXCIgKyBkZXNjcmlwdGlvbiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJldmVudC10aXRsZVwiIGhyZWY9e2h0bWxMaW5rfSB0YXJnZXQ9XCJjYWxlbmRhci1ldmVudFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3RleHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2xvY2F0aW9uICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJldmVudC1sb2NhdGlvblwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtsb2NhdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7ZGVzY3JpcHRpb24gJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImV2ZW50LWRlc2NyaXB0aW9uXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2Rlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9wPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvdHI+PHRyPlxuICAgICAgICAgICAgPHRkIHN0eWxlPXt7Ym9yZGVyOiAwfX0+XG4gICAgICAgICAgICAgICAgPEhvdXJNYXJrZXJcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRIb3VyPXtzdGFydEhvdXJ9XG4gICAgICAgICAgICAgICAgICAgIGVuZEhvdXI9e2VuZEhvdXJ9XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsZT17bG9jYWxlfVxuICAgICAgICAgICAgICAgICAgICB6b29tPXt6b29tfSAvPlxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgICB7ZGF5RGF0YXMubWFwKGRheSA9PiA8dGQga2V5PXtkYXkuZGF5U3RhcnQudG9JU09TdHJpbmcoKX0gY2xhc3NOYW1lPXtkYXkuaXNUb2RheSA/IFwidG9kYXlcIiA6IG51bGx9PjxEYXlWaWV3XG4gICAgICAgICAgICAgICAgICAgIGtleT17ZGF5LmRheVN0YXJ0LnRvSVNPU3RyaW5nKCl9XG4gICAgICAgICAgICAgICAgICAgIGRheVN0YXJ0PXtkYXkuZGF5U3RhcnR9XG4gICAgICAgICAgICAgICAgICAgIGRheUVuZD17ZGF5LmRheUVuZH1cbiAgICAgICAgICAgICAgICAgICAgZXZlbnRzPXtkYXkuZXZlbnRzfVxuICAgICAgICAgICAgICAgICAgICBsb2NhbGU9e2xvY2FsZX1cbiAgICAgICAgICAgICAgICAgICAgem9vbT17em9vbX1cbiAgICAgICAgICAgICAgICAgICAgaXNMYXN0Q2FsbD17c3RhdHVzID09ICcnfSAvPiA8L3RkPil9XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIChzdGF0dXMgfHwgZXJyb3IpICYmICghZXJyb3IgfHwgZXJyb3IubmFtZSAhPT0gXCJVbmF1dGhvcml6ZWRFcnJvclwiKSAmJlxuICAgICAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgICAgICAgICAvLyBTaG93IHN0YXR1cyAvIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIDx0cj48dGQgc3R5bGU9e3tib3JkZXI6IDB9fT48L3RkPjx0ZCBzdHlsZT17e2JvcmRlcjogMH19IGNvbFNwYW49e251bURheXN9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFN0YXR1c0JhciBzdGF0dXM9e3N0YXR1c30gZXJyb3I9e2Vycm9yfSAvPlxuICAgICAgICAgICAgICAgICAgICA8L3RkPjwvdHI+XG4gICAgICAgICAgICB9XG4gICAgICAgICAgPC90Ym9keT48L3RhYmxlPlxuICAgICAgICA8L2Rpdj5cbiAgICB9XG59IiwiaW1wb3J0IHsgVXNlclRhc2tzQm94UHJvcHMgfSBmcm9tIFwiLi4vd2Vla3BsYW5uZXIvdXNlci10YXNrcy1ib3hcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhKHRhc2tTZXRzOiBQYXJ0aWFsPFVzZXJUYXNrc0JveFByb3BzPltdKSB7XG4gICAgdmFyIGNoYXJ0VGFza3M6IHtcbiAgICAgICAgY29tcGxldGVkVGFza3M6IG51bWJlciwgXG4gICAgICAgIHRvdGFsTnVtYmVyT2ZUYXNrczogbnVtYmVyLFxuICAgICAgICBzdWJqZWN0RGF0YToge1xuICAgICAgICAgICAgW2NvbHVtbkhlYWRlcjogc3RyaW5nXTogeyBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXIsIG51bWJlck9mVGFza3M6IG51bWJlciB9XG4gICAgICAgIH1cbiAgICB9ID0ge2NvbXBsZXRlZFRhc2tzOiAwLCB0b3RhbE51bWJlck9mVGFza3M6IDAgLCBzdWJqZWN0RGF0YToge319O1xuXG4gICAgdGFza1NldHMuZm9yRWFjaChlbGVtID0+IGVsZW0ubGVhcm5pbmdHb2Fscy5mb3JFYWNoKHggPT4ge1xuICAgICAgICB2YXIgc3ViamVjdENvbXBsZXRlZFRhc2tzID0geC50YXNrcy5maWx0ZXIodCA9PiB0LmRvbmUpLmxlbmd0aDtcbiAgICAgICAgbGV0IGNvdXJzZVN1YmplY3REYXRhID0gY2hhcnRUYXNrcy5zdWJqZWN0RGF0YVtlbGVtLmNvdXJzZU5hbWVdO1xuICAgICAgICBpZiAoIWNvdXJzZVN1YmplY3REYXRhKSB7XG4gICAgICAgICAgICBjb3Vyc2VTdWJqZWN0RGF0YSA9IGNoYXJ0VGFza3Muc3ViamVjdERhdGFbZWxlbS5jb3Vyc2VOYW1lXSA9IHtcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiAwLFxuICAgICAgICAgICAgICAgIG51bWJlck9mVGFza3M6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY291cnNlU3ViamVjdERhdGEuY29tcGxldGVkTnVtYmVyT2ZUYXNrcyArPSBzdWJqZWN0Q29tcGxldGVkVGFza3M7XG4gICAgICAgIGNvdXJzZVN1YmplY3REYXRhLm51bWJlck9mVGFza3MgKz0geC50YXNrcy5sZW5ndGg7XG5cbiAgICAgICAgY2hhcnRUYXNrcy5jb21wbGV0ZWRUYXNrcyArPSBzdWJqZWN0Q29tcGxldGVkVGFza3M7XG4gICAgICAgIGNoYXJ0VGFza3MudG90YWxOdW1iZXJPZlRhc2tzICs9IHgudGFza3MubGVuZ3RoO1xuICAgIH0pKTtcbiAgICByZXR1cm4gY2hhcnRUYXNrcztcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gICAgcGVyY2VudGFnZTogbnVtYmVyO1xuICAgIGJhY2tncm91bmRDb2xvcj86IHN0cmluZztcbiAgICBwcm9ncmVzc0NvbG9yPzogc3RyaW5nO1xuICAgIGVycm9yTWVzc2FnZT86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIERvdWdobnV0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gICAgcHVibGljIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjZWZlZmVmXCIsXG4gICAgICAgIHByb2dyZXNzQ29sb3I6IFwiIzNkYmNhMlwiLFxuICAgICAgICBlcnJvck1lc3NhZ2U6IG51bGxcbiAgICB9O1xuXG4gICAgcmVuZGVyKCl7XG4gICAgICAgIGNvbnN0IHtwZXJjZW50YWdlLCBlcnJvck1lc3NhZ2UsIGJhY2tncm91bmRDb2xvciwgcHJvZ3Jlc3NDb2xvcn0gPSB0aGlzLnByb3BzO1xuICAgICAgICAvL2RlZmF1bHQgdmFsdWVzXG4gICAgICAgIHZhciBzdHJva2UgPSAyO1xuICAgICAgICAvL2VxdWFscyB3aXRoIGhlIGNpcmN1bWZlcmVuY2UvMklJXG4gICAgICAgIHZhciByYWRpdXMgPSAxMDAgLyAoMiAqIDMuMTQpO1xuICAgICAgICAvL3Rha2UgaW50byBhY2NvdW50IHRoZSBzdHJva2VcbiAgICAgICAgdmFyIGNlbnRlciA9IHJhZGl1cyArIHN0cm9rZTsgXG4gICAgICAgIHZhciB2aWV3Ym94VyA9IGNlbnRlciAqIDI7XG4gICAgICAgIHZhciB2aWV3dmJveEggPSBjZW50ZXIgKiAyO1xuICAgICAgICBjb25zdCByb3VuZGVkUGVyY2VudGFnZSA9IE1hdGgucm91bmQocGVyY2VudGFnZSk7XG4gICAgICAgIHZhciBzdGFydEVycm9yVGV4dCA9IDEwO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxzdmcgY2xhc3NOYW1lPVwiZG91Z2hudXQtY2hhcnRcIiB2aWV3Qm94PXtgMCAwICR7dmlld2JveFd9ICR7dmlld3Zib3hIfWB9IHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIj5cbiAgICAgICAgICAgICAgICA8Y2lyY2xlIGNsYXNzTmFtZT1cImNpcmNsZS1jaGFydC1iYWNrZ3JvdW5kXCIgc3Ryb2tlPXtiYWNrZ3JvdW5kQ29sb3J9IHN0cm9rZVdpZHRoPXtzdHJva2UgKyAxfSBmaWxsPVwibm9uZVwiIGN4PXtjZW50ZXJ9IGN5PXtjZW50ZXJ9IHI9e3JhZGl1c30gLz5cbiAgICAgICAgICAgICAgICA8Y2lyY2xlIGNsYXNzTmFtZT1cImNpcmNsZS1jaGFydC1jaXJjbGVcIiBzdHJva2U9e3Byb2dyZXNzQ29sb3J9IHJlZj1cInByb2dyZXNzQ2lyY2xlXCIgc3Ryb2tlV2lkdGg9e3N0cm9rZX0gc3R5bGU9e3sgc3Ryb2tlRGFzaGFycmF5OiBgJHtyb3VuZGVkUGVyY2VudGFnZX0sIDEwMGAgfX0gc3Ryb2tlTGluZWNhcD1cInJvdW5kXCIgZmlsbD1cIm5vbmVcIiBjeD17Y2VudGVyfSBjeT17Y2VudGVyfSByPXtyYWRpdXN9IC8+XG4gICAgICAgICAgICAgICAgPGcgY2xhc3NOYW1lPVwiY2lyY2xlLWNoYXJ0LWluZm9cIj5cbiAgICAgICAgICAgICAgICAgICAgeyFlcnJvck1lc3NhZ2UgPyA8dGV4dCBjbGFzc05hbWU9XCJjaXJjbGUtY2hhcnQtcGVyY2VudFwiIHg9e2NlbnRlcn0geT17Y2VudGVyfSBhbGlnbm1lbnRCYXNlbGluZT1cImNlbnRyYWxcIiB0ZXh0QW5jaG9yPVwibWlkZGxlXCI+e2Ake3JvdW5kZWRQZXJjZW50YWdlfSVgfTwvdGV4dD4gOlxuICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgY2xhc3NOYW1lPVwiY2lyY2xlLWNoYXJ0LXBlcmNlbnQtZXJyb3JcIiB4PXtjZW50ZXJ9IHk9e2NlbnRlcn0gYWxpZ25tZW50QmFzZWxpbmU9XCJjZW50cmFsXCIgZm9udFNpemU9XCI1XCIgdGV4dEFuY2hvcj1cIm1pZGRsZVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnNwbGl0KCcgJykubWFwKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRzcGFuID0gPHRzcGFuIGtleT17ZWxlbWVudH0geD17Y2VudGVyfSB5PXtzdGFydEVycm9yVGV4dH0+e2VsZW1lbnR9PC90c3Bhbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RXJyb3JUZXh0ICs9IDU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNwYW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC90ZXh0Pn1cbiAgICAgICAgICAgICAgICA8L2c+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgKVxuICAgIH1cbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gICAgbnVtYmVyT2ZUYXNrczogbnVtYmVyO1xuICAgIGNvbXBsZXRlZE51bWJlck9mVGFza3M6IG51bWJlcjtcbiAgICBtYXhpbXVtVGFza3NEaXNwbGF5ZWQ/OiBudW1iZXI7XG4gICAgYmFja2dyb3VuZENvbG9yPzogc3RyaW5nO1xuICAgIHByb2dyZXNzQ29sb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBHb2FsUHJvZ3Jlc3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgICBwdWJsaWMgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgbnVtYmVyb2ZUYXNrczogMCxcbiAgICAgICAgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogMCxcbiAgICAgICAgbWF4aW11bVRhc2tzRGlzcGxheWVkOiAxMCxcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcImxpZ2h0Z3JleVwiLFxuICAgICAgICBwcm9ncmVzc0NvbG9yOiBcIiMzZGJjYTJcIixcbiAgICB9O1xuXG4gICAgY3JlYXRlUHJvZ3Jlc3MgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgbnVtYmVyT2ZUYXNrcywgY29tcGxldGVkTnVtYmVyT2ZUYXNrcywgbWF4aW11bVRhc2tzRGlzcGxheWVkLCBiYWNrZ3JvdW5kQ29sb3IsIHByb2dyZXNzQ29sb3IgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGxldCBwcm9ncmVzcyA9IFtdO1xuICAgICAgICBpZihudW1iZXJPZlRhc2tzID4gbWF4aW11bVRhc2tzRGlzcGxheWVkKXtcbiAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwicHJvZ3Jlc3Mtb3ZlcnZpZXdcIj4ge2NvbXBsZXRlZE51bWJlck9mVGFza3N9IC8ge251bWJlck9mVGFza3N9IDwvZGl2PjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IHRhc2tObyA9IDE7IHRhc2tObyA8PSBudW1iZXJPZlRhc2tzOyB0YXNrTm8rKykge1xuICAgICAgICAgICAgcHJvZ3Jlc3MucHVzaChcbiAgICAgICAgICAgIDxzdmcga2V5PXt0YXNrTm99PlxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3NOYW1lPVwiY2lyY2xlLWNoYXJ0LWJhY2tncm91bmRcIiBmaWxsPXt0YXNrTm8gPiBjb21wbGV0ZWROdW1iZXJPZlRhc2tzID8gYmFja2dyb3VuZENvbG9yIDogcHJvZ3Jlc3NDb2xvcn0gY3g9XCI4XCIgY3k9XCI4XCIgcj1cIjhcIiAvPlxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9ncmVzcztcbiAgICB9XG5cbiAgICByZW5kZXIoKXsgIFxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJnb2Fscy1wcm9ncmVzc1wiPnt0aGlzLmNyZWF0ZVByb2dyZXNzKCl9PC9kaXY+XG4gICAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgICBwZXJjZW50YWdlOiBudW1iZXI7XG4gICAgYmFja2dyb3VuZENvbG9yPzogc3RyaW5nO1xuICAgIHByb2dyZXNzQ29sb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBQcm9ncmVzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICAgIHB1YmxpYyBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBwZXJjZW50YWdlOiAwLFxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiI0YxRjVGNFwiLFxuICAgICAgICBwcm9ncmVzc0NvbG9yOiBcIiMzZGJjYTJcIixcbiAgICB9O1xuXG4gICAgcmVuZGVyKCl7XG4gICAgICAgIGNvbnN0IHtwZXJjZW50YWdlLCBiYWNrZ3JvdW5kQ29sb3IsIHByb2dyZXNzQ29sb3J9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qgcm91bmRlZFBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKHBlcmNlbnRhZ2UpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPHN2ZyBjbGFzc05hbWU9XCJwcm9ncmVzcy1jaGFydFwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjI1XCI+XG4gICAgICAgICAgICA8cmVjdCBmaWxsPXtiYWNrZ3JvdW5kQ29sb3J9ICB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgcng9XCI0XCIvPlxuICAgICAgICAgICAgPHJlY3QgY2xhc3NOYW1lPVwiZmlsbFwiIGZpbGw9e3Byb2dyZXNzQ29sb3J9IHdpZHRoPXtgJHtyb3VuZGVkUGVyY2VudGFnZX0lYH0gaGVpZ2h0PVwiMTAwJVwiIHJ4PVwiNFwiLz5cbiAgICAgICAgICAgIDx0ZXh0IGNsYXNzTmFtZT1cImZpbGxlZC10ZXh0XCIgdGV4dEFuY2hvcj1cIm1pZGRsZVwiIHg9XCI1MCVcIiB5PVwiNTAlXCIgZHk9XCIuM2VtXCI+e2Ake3JvdW5kZWRQZXJjZW50YWdlfSVgfTwvdGV4dD5cdFxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgIClcbiAgICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgY29uc3QgRWxsaXBzaXNMb2FkZXIgPSAoKSA9PlxuICA8aW1nXG4gICAgc3R5bGU9e3tib3JkZXI6IDAsIG1hcmdpbjogMCwgcGFkZGluZzogMH19XG4gICAgY2xhc3NOYW1lPVwiZWxsaXBzaXMtbG9hZGVyXCIgLz47XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIG9uQ2xpY2ssXG4gIGNsYXNzTmFtZT8sXG4gIHN0eWxlPyxcbiAgdGl0bGU/XG59O1xuXG5leHBvcnQgY29uc3QgUmVtb3ZlSXRlbSA9ICh7IG9uQ2xpY2ssIGNsYXNzTmFtZSwgc3R5bGUsIHRpdGxlIH06IFByb3BzKSA9PlxuXG4gIDxkaXZcbiAgICB0aXRsZT17dGl0bGUgfHwgTGBSYWRlcmFgfVxuICAgIGNsYXNzTmFtZT17XCJyZW1vdmVJdGVtIFwiICsgKGNsYXNzTmFtZSB8fCBcIlwiKX1cbiAgICBvbkNsaWNrPXtvbkNsaWNrfSBzdHlsZT17c3R5bGV9IC8+XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmV4cG9ydCBjb25zdCBTcGlubmVyID0gKHtsYWJlbD1cIlwifTp7bGFiZWw/OnN0cmluZ30pID0+IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4mbmJzcDt7bGFiZWx9PC9zcGFuPjtcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgdGV4dDogc3RyaW5nO1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIG9uQ29uZmlybTogKCk9PnZvaWQ7XG4gIG9uQ2FuY2VsOiAoKT0+dm9pZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIENvbmZpcm1hdGlvbiAocHJvcHM6IFByb3BzKSB7XG4gIHJldHVybiA8ZGl2XG4gICAgY2xhc3NOYW1lPXtgY29uZmlybWF0aW9uLWJveCAke3Byb3BzLmNsYXNzTmFtZX0ke3Byb3BzLnZpc2libGUgPyBcIiB2aXNpYmxlXCIgOiBcIlwifWB9PlxuICAgIDxwPntwcm9wcy50ZXh0fTwvcD5cbiAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT5wcm9wcy5vbkNvbmZpcm0oKX0+T0s8L2J1dHRvbj5cbiAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT5wcm9wcy5vbkNhbmNlbCgpfT5BdmJyeXQ8L2J1dHRvbj5cbiAgPC9kaXY+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTGVhcm5pbmdNb2R1bGVUYXNrLCBUYXNrTGlzdCB9IGZyb20gJy4vdGFzay1saXN0JztcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjb21tb25UYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cbiAgbGVhcm5pbmdHb2FsczogTGVhcm5pbmdHb2FsW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ0dvYWwge1xuICBuYW1lOiBzdHJpbmc7XG4gIGxlYXJuaW5nVGFza3M6IExlYXJuaW5nTW9kdWxlVGFza1tdO1xufVxuXG5leHBvcnQgY2xhc3MgTGVhcm5pbmdHb2Fsc0xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgc3RhdGljIGNvbnRleHRUeXBlID0gTGFuZ3VhZ2VDb250ZXh0O1xuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2NvbW1vblRhc2tzLCBsZWFybmluZ0dvYWxzfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5jb250ZXh0O1xuICAgIHJldHVybiA8ZGl2PntsZWFybmluZ0dvYWxzLm1hcChsZyA9PiA8ZGl2IGtleT17bGcubmFtZX0+XG4gICAgICA8aDU+e2xnLm5hbWV9PC9oNT5cbiAgICAgIDxUYXNrTGlzdCBsZWFybmluZ1Rhc2tzPXtsZy5sZWFybmluZ1Rhc2tzfSAvPlxuICAgIDwvZGl2Pil9XG4gICAge2NvbW1vblRhc2tzLmxlbmd0aCA+IDAgJiYgPGRpdj5cbiAgICAgIHtsZWFybmluZ0dvYWxzLmxlbmd0aCA+IDAgJiYgPGg1PntpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOlwibGVhcm5pbmdHb2Fsc0xvc3Qub3ZlcmFsbFwiLCBkZWZhdWx0TWVzc2FnZTpcIsOWdmVyZ3JpcGFuZGVcIn0pIH08L2g1Pn0gXG4gICAgICA8VGFza0xpc3QgbGVhcm5pbmdUYXNrcz17Y29tbW9uVGFza3N9IC8+XG4gICAgPC9kaXY+fVxuICAgIDwvZGl2PjtcbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBUYXNrLCBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUgfSBmcm9tIFwiLi4vLi4vd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlXCI7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBCYXRjaFJ1bm5lciwgRG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyB1c2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcbmltcG9ydCB7IGFycmF5VG9NYXAsIEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBDb25maXJtYXRpb24gfSBmcm9tICcuL2NvbmZpcm1hdGlvbic7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7IFVJQWRkYm94IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2NoZWNrYm94JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgbGVhcm5pbmdUYXNrczogTGVhcm5pbmdNb2R1bGVUYXNrW11cbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgd2Vla0RhdGU6IG51bWJlcjtcbiAgdXNlclRhc2tzOiBVc2VyVGFza1tdO1xuICBjb25maXJtYXRpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ01vZHVsZVRhc2sge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHVybDogc3RyaW5nO1xuICAvKiogY291cnNlTmFtZVxuICAgKiBGb3IgS0c6IGNvdXJzZU5hbWVcbiAgICogRm9yIEtTOiBTdWJqZWN0IG5hbWVcbiAgICovXG4gIGNvdXJzZU5hbWU6IHN0cmluZztcbiAgLyoqIGxlYXJuaW5nR29hbFxuICAgKiBGb3IgS0c6IG1vZHVsZSBuYW1lIG9yIGxlYXJuaW5nIGdvYWwgb2YgdGhlIHRhc2tcbiAgICogRm9yIEtTL3N0ZXAtY291cnNlOiBjb3Vyc2UgbmFtZVxuICAgKiBGb3IgS1MvdGhlbWUtY291cnNlOiBsZWFybmluZyBnb2FsXG4gICAqL1xuICBsZWFybmluZ0dvYWw6IHN0cmluZztcbiAgLyoqIFN0ZXBcbiAgICogT25seSBwcmVzZW50IGluIEtTL3N0ZXAtY291cnNlXG4gICAqL1xuICBzdGVwPzogbnVtYmVyO1xuICAvKiogdGFza1xuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWx0IGJ5IGNvdXJzZWJ1aWxkZXJcbiAgICovXG4gIHRhc2s/OiBUYXNrO1xuICAvKiogY291cnNlXG4gICAqIE9ubHkgZm9yIGNvdXJzZXMgYnVpbHQgYnkgY291cnNlYnVpbGRlclxuICAgKi9cbiAgY291cnNlPzogQ291cnNlO1xuICAvKiogY291cnNlSW5mb1xuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWxkIGJ5IHN1YmplY3RwbGFubmVyXG4gICAqL1xuICBjb3Vyc2VJbmZvPzoge1xuICAgIHNjaG9vbDogc3RyaW5nIC8vIFNjaG9vbCBuYW1lXG4gICAgY291cnNlOiBzdHJpbmcgLy8gQ291cnNlIEluc3RhbmNlIElEXG4gICAgdGFiOiBzdHJpbmcgICAgLy8gQ291cnNlVGFiIElEXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRhc2tMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICB1c2VyVGFza3M6IFtdLFxuICAgICAgd2Vla0RhdGU6IERhdGUubm93KCksXG4gICAgICBjb25maXJtYXRpb25zOiBbXVxuICAgIH1cbiAgICB0aGlzLm9uQ2hhbmdlID0gdGhpcy5vbkNoYW5nZS5iaW5kKHRoaXMpOyAgICBcbiAgfVxuXG4gIG9uQ2hhbmdlICh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZDogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSkge1xuICAgIGlmIChwZXJzaXN0ZWQud2Vla0RhdGUgIT09IHRoaXMuc3RhdGUud2Vla0RhdGUpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBjb25maXJtYXRpb25zOiBbXVxuICAgICAgfSlcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICB1c2VyVGFza3MsXG4gICAgICB3ZWVrRGF0ZTogcGVyc2lzdGVkLndlZWtEYXRlXG4gICAgfSk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB1c2VyVGFza3NSZXBvLnN1YnNjcmliZSh0aGlzLm9uQ2hhbmdlKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICBhc3luYyB0b2dnbGVUYXNrIChsZWFybmluZ1Rhc2s6IExlYXJuaW5nTW9kdWxlVGFzaykge1xuICAgIGNvbnN0IHVzZXJUYXNrcyA9IHRoaXMuc3RhdGUudXNlclRhc2tzLmZpbHRlcih1dCA9PiB7XG4gICAgICByZXR1cm4gbGVhcm5pbmdUYXNrLnRhc2sgP1xuICAgICAgICB1dC50YXNrICYmIHV0LnRhc2suc29tZSh0ID0+IHQuaWQgPT09IGxlYXJuaW5nVGFzay5pZCkgOlxuICAgICAgICB1dC5zaXRlVmlzaW9uUGFnZUlkID09PSBsZWFybmluZ1Rhc2suaWQ7XG4gICAgfSk7XG4gICAgY29uc3Qge3dlZWtEYXRlfSA9IHRoaXMuc3RhdGU7XG4gICAgXG4gICAgaWYgKHVzZXJUYXNrcy5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIE5vIHRhc2sgbWF0Y2hlcyB0aGlzIGxlYXJuaW5nTW9kdWxlVGFzayAtIG5vdCBwcmVzZW50IGluIHdlZWtwbGFubmVyLlxuICAgICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxuICAgICAgICBNYXRoLm1heCxcbiAgICAgICAgW3dlZWtEYXRlXS5jb25jYXQodGhpcy5zdGF0ZS51c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcblxuICAgICAgY29uc3QgdXNlclRhc2s6IFVzZXJUYXNrID0ge1xuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICBjb3Vyc2VOYW1lOiBsZWFybmluZ1Rhc2suY291cnNlTmFtZSxcbiAgICAgICAgZGF0ZVRpbWU6IGxhdGVzdFRpbWVTdGFtcCArIDIwMDAsXG4gICAgICAgIGxlYXJuaW5nR29hbDogbGVhcm5pbmdUYXNrLmxlYXJuaW5nR29hbCxcbiAgICAgICAgbmFtZTogbGVhcm5pbmdUYXNrLm5hbWUsXG4gICAgICAgIHVybDogbGVhcm5pbmdUYXNrLnVybCxcbiAgICAgICAgYWNsOiBbXG4gICAgICAgICAgLy8gRGVmYXVsdCBBQ0w6IExldCB1c2VyIHNlbGYgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGl0ZW06XG4gICAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwiZW1haWxcIiwgZW52LmN1cnJlbnRVc2VyLm1haWwsIFwiU1wiKSxcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIEFDTDogTGV0IGVtcGxveWVlcyBvbiBzYW1lIHNjaG9vbCBoYXZlIHJlYWQgYWNjZXNzIHRvIGl0LlxuICAgICAgICAgIC8vIFRoaXMgY3VycmVudGx5IG9ubHkgYXBwbGllcyB0byB0YXNrcyB0aGF0IHJlZmVyIHRvIGNvdXJzZSB0YXNrcyAobm90IGN1c3RvbSB0YXNrcyEpXG4gICAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwic2Nob29sUm9sZVwiLCBgJHtlbnYuY3VycmVudFVzZXIuc2Nob29sfS9FTVBMT1lFRWAsIFwiUlwiKVxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxuICAgICAgfTtcbiAgICAgIGlmIChsZWFybmluZ1Rhc2sudGFzayAmJiBsZWFybmluZ1Rhc2sudGFzay5kZWFkbGluZSkge1xuICAgICAgICB1c2VyVGFzay5kZWFkbGluZSA9IGxlYXJuaW5nVGFzay50YXNrLmRlYWRsaW5lO1xuICAgICAgfVxuICAgICAgaWYgKGxlYXJuaW5nVGFzay50YXNrKSB7XG4gICAgICAgIHVzZXJUYXNrLnRhc2sgPSBbbGVhcm5pbmdUYXNrLnRhc2tdO1xuICAgICAgICBpZiAobGVhcm5pbmdUYXNrLmNvdXJzZSkge1xuICAgICAgICAgIHVzZXJUYXNrLmNvdXJzZSA9IFtsZWFybmluZ1Rhc2suY291cnNlXTtcbiAgICAgICAgfSBlbHNlIGlmIChsZWFybmluZ1Rhc2suY291cnNlSW5mbykge1xuICAgICAgICAgIHVzZXJUYXNrLmNvdXJzZUluZm8gPSBsZWFybmluZ1Rhc2suY291cnNlSW5mbztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXNlclRhc2suc2l0ZVZpc2lvblBhZ2VJZCA9IGxlYXJuaW5nVGFzay5pZDtcbiAgICAgIH1cbiAgICAgIGlmIChsZWFybmluZ1Rhc2suc3RlcCkge1xuICAgICAgICB1c2VyVGFzay5zdGVwID0gbGVhcm5pbmdUYXNrLnN0ZXA7XG4gICAgICB9XG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHVzZXJUYXNrc1JlcG8uc2V0V2Vla1BsYW5uZXJCb3hPcGVuKGxlYXJuaW5nVGFzay5jb3Vyc2VOYW1lLCB0cnVlKSxcbiAgICAgICAgdXNlclRhc2tzUmVwby5pbnNlcnQoW3VzZXJUYXNrXSldKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQWxyZWFkeSBwcmVzZW50IGluIHdlZWtwbGFubmVyLiBJdCdzIHRpbWUgdG8gZGVsZXRlIHRob3NlIHRoYXQgbWF0Y2hlZCB1cy5cbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8uZGVsZXRlKHVzZXJUYXNrcy5tYXAodCA9PiB0LmlkKSk7XG4gICAgfVxuICAgIFxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcbiAgICBjb25zdCB7bGVhcm5pbmdUYXNrc30gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHVzZXJUYXNrcyA9IGFycmF5VG9NYXAodGhpcy5zdGF0ZS51c2VyVGFza3MsIHV0ID0+IHV0LnRhc2sgJiYgdXQudGFzay5sZW5ndGggPiAwID9cbiAgICAgIHV0LnRhc2subWFwKHQgPT4gdC5pZClbMF0gOiAvLyBjb3Vyc2UtYnVpbGRlciB0YXNrcyBsb29rZWQgdXAgYnkgaWRcbiAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPyB1dC5zaXRlVmlzaW9uUGFnZUlkIDogLy8gbm9uLWNvdXJzZS1idWlsZGVyIHRhc2tzXG4gICAgICB1dC51cmwpO1xuICAgIGNvbnN0IHtjb25maXJtYXRpb25zfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qgd2Vla1BsYW5uZXJXZWVrID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcbiAgICBjb25zdCBjdXJyZW50V2VlayA9IG1vbWVudCgpLndlZWsoKTtcbiAgICBjb25zdCBmb3JXZWVrU3RyaW5nID0gd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/IFwiXCIgOlxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgKyAxID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0Lm5leHRXZWVrVGFza1wiLCBkZWZhdWx0TWVzc2FnZTpcImbDtnIgbsOkc3RhIHZlY2thICh2e3dlZWt9KVwifSwge3dlZWs6IHdlZWtQbGFubmVyV2Vla30pIDpcbiAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrIC0gMSA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJ0YXNrTGlzdC5sYXN0V2Vla1Rhc2tcIiwgZGVmYXVsdE1lc3NhZ2U6XCJmw7ZyIGbDtnJyYSB2ZWNrYW4gKHZ7d2Vla30pXCJ9LCB7d2Vlazogd2Vla1BsYW5uZXJXZWVrfSkgOlxuICAgIGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJ0YXNrTGlzdC5jdXJyZW50V2Vla1Rhc2tcIiwgZGVmYXVsdE1lc3NhZ2U6XCJmw7ZyIHZlY2thIHt3ZWVrfVwifSwge3dlZWs6IHdlZWtQbGFubmVyV2Vla30pO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAge2xlYXJuaW5nVGFza3MubWFwKChsZWFybmluZ1Rhc2ssIGlkeCkgPT4ge1xuICAgICAgICBjb25zdCB0YXNrTG9va3VwSWQgPSBsZWFybmluZ1Rhc2suaWQ7XG4gICAgICAgIGNvbnN0IHVzZXJUYXNrID0gdXNlclRhc2tzW3Rhc2tMb29rdXBJZF0gfHwgeyRtZXRhOiAnZGVsZXRlZCd9IGFzIFBhcnRpYWw8VXNlclRhc2s+OyAvLyBObyBleGlzdCA9ICRtZXRhOiAnZGVsZXRlZCdcbiAgICAgICAgY29uc3QgaXNXb3JraW5nID0gdXNlclRhc2suJG1ldGEgPT09ICdhZGRpbmcnIHx8IHVzZXJUYXNrLiRtZXRhID09PSAnZGVsZXRpbmcnO1xuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHVzZXJUYXNrLiRtZXRhICE9PSAnZGVsZXRlZCcgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZyc7XG4gICAgICAgIGNvbnN0IGRlc2NyaWJlZEFjdGlvbiA9IHNlbGVjdGVkID9cbiAgICAgICAgaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0LnJlbW92ZVRhc2tGcm9tV2Vla2x5UGxhbm5pbmdcIiwgZGVmYXVsdE1lc3NhZ2U6XCJUYSBib3J0IHVwcGdpZnRlbiBmcsOlbiBlZ2VuIHZlY2tvcGxhbmVyaW5nIHt3ZWVrfVwifSwge3dlZWs6IGZvcldlZWtTdHJpbmd9KTpcbiAgICAgICAgaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcInRhc2tMaXN0LmFkZFRhc2tUb1dlZWtseVBsYW5uaW5nXCIsIGRlZmF1bHRNZXNzYWdlOlwiTMOkZ2cgdGlsbCB1cHBnaWZ0ZW4gaSBlZ2VuIHZlY2tvcGxhbmVyaW5nIHt3ZWVrfVwifSwge3dlZWs6IGZvcldlZWtTdHJpbmd9KVxuICAgICAgICBjb25zdCBjb25maXJtYXRpb25WaXNpYmxlID1cbiAgICAgICAgICBjb25maXJtYXRpb25zLnNvbWUodGlkID0+IHRhc2tMb29rdXBJZCA9PT0gdGlkKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiA8ZGl2IGtleT17aWR4fT5cbiAgICAgICAgICA8VUlBZGRib3ggc3RhdGU9e3NlbGVjdGVkID8gJ2NoZWNrZWQnIDogJyd9IG9uQ2xpY2s9eygpPT4haXNXb3JraW5nICYmIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgP1xuICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVUYXNrKGxlYXJuaW5nVGFzaykgOlxuICAgICAgICAgICAgICAgICAgY29uZmlybWF0aW9uVmlzaWJsZSA/IFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBjb25maXJtYXRpb25zLmZpbHRlcih0aWQgPT4gdGlkICE9PSB0YXNrTG9va3VwSWQpfSkgOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBbLi4uY29uZmlybWF0aW9uc10uY29uY2F0KHRhc2tMb29rdXBJZCl9KX1cbiAgICAgICAgICAgICAgICBsYWJlbD17PGEgdGl0bGU9e2Rlc2NyaWJlZEFjdGlvbn0gaHJlZj17bGVhcm5pbmdUYXNrLnVybH0+e2xlYXJuaW5nVGFzay5uYW1lfTwvYT59Lz5cbiAgICAgICAgPENvbmZpcm1hdGlvblxuICAgICAgICAgICAgdmlzaWJsZT17Y29uZmlybWF0aW9uVmlzaWJsZX1cbiAgICAgICAgICAgIHRleHQ9e2Rlc2NyaWJlZEFjdGlvbn1cbiAgICAgICAgICAgIG9uQ29uZmlybT17KCk9PntcbiAgICAgICAgICAgICAgdGhpcy50b2dnbGVUYXNrKGxlYXJuaW5nVGFzayk7XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IGNvbmZpcm1hdGlvbnMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IHRhc2tMb29rdXBJZCl9KTtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgICBvbkNhbmNlbD17KCk9PntcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y29uZmlybWF0aW9uczogY29uZmlybWF0aW9ucy5maWx0ZXIodGlkID0+IHRpZCAhPT0gdGFza0xvb2t1cElkKX0pO1xuICAgICAgICAgICAgfX0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIH1cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7S0dUZXJtUGxhbm5lcn0gZnJvbSAnLi9rZy10ZXJtcGxhbm5lcic7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5cbmV4cG9ydCBmdW5jdGlvbiBLR1Rlcm1QbGFubmVyU2VsZiAoKSB7XG4gIHJldHVybiA8S0dUZXJtUGxhbm5lciBlbnY9e2Vudn0gdHV0b3JlZD17ZmFsc2V9IC8+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtLR1Rlcm1QbGFubmVyfSBmcm9tICcuL2tnLXRlcm1wbGFubmVyJztcbmltcG9ydCB7IFR1dG9yYWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy90dXRvcmFibGUtY29tcG9uZW50JztcblxuZXhwb3J0IGZ1bmN0aW9uIEtHVGVybVBsYW5uZXJUdXRvcmVkICgpIHtcbiAgcmV0dXJuIDxUdXRvcmFibGVDb21wb25lbnRcbiAgICB0dXRvcmVkPXt0cnVlfVxuICAgIGNyZWF0ZUNvbXBvbmVudD17ZW52ID0+XG4gICAgICA8S0dUZXJtUGxhbm5lclxuICAgICAgICBrZXk9e2Vudi5jdXJyZW50VXNlci5tYWlsfVxuICAgICAgICBlbnY9e2Vudn1cbiAgICAgICAgdHV0b3JlZD17dHJ1ZX0gLz5cbiAgICB9XG4gIC8+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuLy9pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBFRFNDb3Vyc2UsIEVEU1N0dWR5UGxhbiB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgRURTUGVyaW9kIH0gZnJvbSAnLi4vLi4vYXBpcy9lZHNjbGllbnQnO1xuaW1wb3J0IHsgZ2V0U2Nob29sTW9tZW50LCBnZXRGaXJzdEFuZExhc3RXZWVrT2ZUZXJtLCBnZXRUZXJtU3RhckVuZERhdGUgfSBmcm9tICcuLi8uLi91dGlscy9zY2hvb2wtbW9tZW50JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCB7IEtHVGVybVBsYW5uZXJXZWVrUGxhbiwgS0dUZXJtUGxhbm5lcldlZWtQbGFuRW50cnksIEtHVGVybVBsYW5uZXJUdXRvck5vdGUsIEtHVGVybVBsYW5uZXJXZWVrUGxhbk9yVHV0b3JOb3RlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgRGlhbG9ncyB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9kaWFsb2dzJztcbmltcG9ydCB7IFdlZWtOb3RlRGlhbG9nIH0gZnJvbSAnLi93ZWVrLW5vdGUtZGlhbG9nJztcbmltcG9ydCB7IEtHVGVybVBsYW5uZXJSZXBvIH0gZnJvbSAnLi4vLi4vcmVwb3Mva2ctdGVybXBsYW5uZXItcmVwbyc7XG5pbXBvcnQgeyBkaXN0aW5jdCwgc2hvd0Vycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgS0VEV2VlayB9IGZyb20gJy4uLy4uL3V0aWxzL3dlZWt1dGlsJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIERvY3VtZW50QWNjZXNzLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCB7IEVudiB9IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBUdXRvckRpYWxvZyB9IGZyb20gJy4uL2tzLXRlcm1wbGFubmVyL3R1dG9yLWRpYWxvZyc7XG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uL2ZlYXR1cmVzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgZW52OiBFbnY7XG4gIHR1dG9yZWQ6IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIG5vdzogRGF0ZSxcbiAgY291cnNlczogRURTQ291cnNlW107XG4gIHdlZWtQbGFuczogS0dUZXJtUGxhbm5lcldlZWtQbGFuT3JUdXRvck5vdGVbXTtcbiAgaXNMb2FkaW5nQ291cnNlczogYm9vbGVhbjtcbiAgaXNMb2FkaW5nV2Vla1BsYW5zOiBib29sZWFuO1xuICBkaWFsb2dzOiBhbnlbXTtcbiAgLy9nb2FsczogRURTU3R1ZHlQbGFuW107XG59XG5cbmV4cG9ydCBjbGFzcyBLR1Rlcm1QbGFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgbm93LFxuICAgICAgY291cnNlczogW10sXG4gICAgICB3ZWVrUGxhbnM6IFtdLFxuICAgICAgaXNMb2FkaW5nQ291cnNlczogdHJ1ZSxcbiAgICAgIGlzTG9hZGluZ1dlZWtQbGFuczogdHJ1ZSxcbiAgICAgIGRpYWxvZ3M6IFtdXG4gICAgICAvL2dvYWxzOiBbXVxuICAgIH1cbiAgICB0aGlzLnVwZGF0ZVdlZWtQbGFucyA9IHRoaXMudXBkYXRlV2Vla1BsYW5zLmJpbmQodGhpcyk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLmxvYWRFRFNDb3Vyc2VzKCk7XG4gICAgdGhpcy5wcm9wcy5lbnYua2dUZXJtUGxhbm5lclJlcG8ubWVtLnN1YnNjcmliZSh0aGlzLnVwZGF0ZVdlZWtQbGFucyk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnByb3BzLmVudi5rZ1Rlcm1QbGFubmVyUmVwby5tZW0udW5zdWJzY3JpYmUodGhpcy51cGRhdGVXZWVrUGxhbnMpO1xuICB9XG5cbiAgdXBkYXRlV2Vla1BsYW5zKHdlZWtQbGFuczogS0dUZXJtUGxhbm5lcldlZWtQbGFuW10pIHtcbiAgICB0aGlzLnNldFN0YXRlKHt3ZWVrUGxhbnMsIGlzTG9hZGluZ1dlZWtQbGFuczogZmFsc2V9KTtcbiAgfVxuXG4gIGFzeW5jIGxvYWRFRFNDb3Vyc2VzKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzY2hvb2xNb21lbnQgPSBnZXRTY2hvb2xNb21lbnQobW9tZW50KHRoaXMuc3RhdGUubm93KSk7XG4gICAgICBjb25zdCBwZXJpb2ROYW1lID0gbmV3IEVEU1BlcmlvZChzY2hvb2xNb21lbnQpLnBlcmlvZDtcbiAgICAgIGNvbnN0IGNvdXJzZXMgPSBkaXN0aW5jdChhd2FpdCB0aGlzLnByb3BzLmVudi5lZHNDbGllbnQuZ2V0QWN0aXZlQ291cnNlcyh7cGVyaW9kTmFtZX0pLCBjb3Vyc2UgPT4gY291cnNlLm5hbWUpO1xuICAgICAgLy9jb25zb2xlLmxvZyhcImNvdXJzZXM6XCIgKyBKU09OLnN0cmluZ2lmeShjb3Vyc2VzLCBudWxsLCAyKSk7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgY291cnNlcyB9KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzTG9hZGluZ0NvdXJzZXM6IGZhbHNlIH0pO1xuICAgIH1cbiAgfVxuXG4gIG9uTm90ZUNsaWNrKHdlZWtOdW1iZXI6IG51bWJlciwgd2Vla0RhdGU6IG51bWJlciwgY291cnNlTmFtZTogc3RyaW5nLCB3ZWVrUGxhbj86IEtHVGVybVBsYW5uZXJXZWVrUGxhbiwgbm90ZT86IEtHVGVybVBsYW5uZXJXZWVrUGxhbkVudHJ5KSB7XG4gICAgdGhpcy5vcGVuRGlhbG9nKDxXZWVrTm90ZURpYWxvZ1xuICAgICAgd2Vla051bWJlcj17d2Vla051bWJlcn1cbiAgICAgIHdlZWtEYXRlPXt3ZWVrRGF0ZX1cbiAgICAgIGNvdXJzZU5hbWU9e2NvdXJzZU5hbWV9XG4gICAgICB3ZWVrUGxhbj17d2Vla1BsYW59XG4gICAgICBub3RlPXtub3RlfVxuICAgICAgZW52PXt0aGlzLnByb3BzLmVudn1cbiAgICAgIGNsb3NlRGlhbG9nPXsoKT0+dGhpcy5jbG9zZURpYWxvZygpfSAvPik7XG4gIH1cblxuICAgIC8qKlxuICAgKiBcbiAgICogQHBhcmFtIHdlZWtOdW1iZXIgXG4gICAqIEBwYXJhbSBjb21tZW50IFxuICAgKiBcbiAgICogQWRkIGEgY29tbWVudCBmcm9tIHR1dG9yXG4gICAqL1xuICBvblR1dG9yQ2xpY2sodHV0b3JOb3RlOiBLR1Rlcm1QbGFubmVyVHV0b3JOb3RlLCB3ZWVrTnVtYmVyOiBudW1iZXIpIHtcbiAgICB0aGlzLm9wZW5EaWFsb2coPFR1dG9yRGlhbG9nXG4gICAgICB3ZWVrTnVtYmVyPXt3ZWVrTnVtYmVyfVxuICAgICAgY29tbWVudD17dHV0b3JOb3RlLnZhbHVlfVxuICAgICAgdXBkYXRlRGF0YSA9IHtuZXdWYWx1ZSA9PiB0aGlzLnVwZGF0ZVR1dG9yTm90ZUZpZWxkKHR1dG9yTm90ZSwgbmV3VmFsdWUpfVxuICAgICAgZGVsZXRlTm90ZURhdGEgPSB7KCkgPT4gdGhpcy5kZWxldGVUdXRvck5vdGVGaWVsZCh0dXRvck5vdGUuaWQpfVxuICAgICAgY2xvc2VEaWFsb2c9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9IC8+KTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVR1dG9yTm90ZUZpZWxkKG5vdGVJZDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LmtnVGVybVBsYW5uZXJSZXBvLmRlbGV0ZShbbm90ZUlkXSk7XG4gICAgfSBjYXRjaCAoc2hvd0Vycm9yKXt9XG4gIH1cblxuICBhc3luYyB1cGRhdGVUdXRvck5vdGVGaWVsZCh0dXRvck5vdGU6IEtHVGVybVBsYW5uZXJUdXRvck5vdGUsIG5ld1ZhbHVlOiBzdHJpbmcpe1xuICAgIGNvbnN0IG9sZFZhbHVlID0gKHR1dG9yTm90ZSAmJiB0dXRvck5vdGUudmFsdWUpIHx8IFwiXCI7XG4gICAgaWYgKG9sZFZhbHVlID09PSBuZXdWYWx1ZSkgcmV0dXJuO1xuXG4gICAgdHJ5IHtcbiAgICAgIHR1dG9yTm90ZS52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgLy9zZXQgZG9jdW1lbnQgQUNMXG4gICAgICB0dXRvck5vdGUuYWNsID0gW1xuICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJ0dXRvckZvclwiLCB0aGlzLnByb3BzLmVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIikudG9TdHJpbmcoKSxcbiAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwiZW1haWxcIiwgdGhpcy5wcm9wcy5lbnYuY3VycmVudFVzZXIubWFpbCwgXCJSXCIpLnRvU3RyaW5nKCksXG4gICAgICBdO1xuXG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcm9wcy5lbnYua2dUZXJtUGxhbm5lclJlcG8udXBzZXJ0KHR1dG9yTm90ZSwgXG4gICAgICAgIChub3RlIDogS0dUZXJtUGxhbm5lclR1dG9yTm90ZSkgPT4gbm90ZS52YWx1ZSA9IG5ld1ZhbHVlKTtcbiAgICAgIH0gY2F0Y2ggKHNob3dFcnJvcil7fVxuICB9XG5cbiAgXG4gIG9wZW5EaWFsb2coZGlhbG9nKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRpYWxvZ3M6IFsuLi50aGlzLnN0YXRlLmRpYWxvZ3MsIGRpYWxvZ10gfSk7XG4gIH1cblxuICBjbG9zZURpYWxvZygpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGlhbG9nczogdGhpcy5zdGF0ZS5kaWFsb2dzLnNsaWNlKDAsIHRoaXMuc3RhdGUuZGlhbG9ncy5sZW5ndGggLSAxKSB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNvdXJzZXMsIG5vdywgaXNMb2FkaW5nQ291cnNlcywgaXNMb2FkaW5nV2Vla1BsYW5zLCB3ZWVrUGxhbnMsIGRpYWxvZ3MgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgaXNMb2FkaW5nID0gaXNMb2FkaW5nQ291cnNlcyB8fCBpc0xvYWRpbmdXZWVrUGxhbnM7XG4gICAgY29uc3Qgd2Vla3M6IHsgd2Vla051bWJlcjogbnVtYmVyLCB3ZWVrRGF0ZTogbnVtYmVyLCB3ZWVrUGxhbjogS0dUZXJtUGxhbm5lcldlZWtQbGFuIH1bXSA9IFtdO1xuICAgIGNvbnN0IHR1dG9yTm90ZXM6IHsgd2Vla051bWJlcjogbnVtYmVyLCB0dXRvclZhbHVlOiBLR1Rlcm1QbGFubmVyVHV0b3JOb3RlIH1bXSA9IFtdO1xuICAgIGNvbnN0IHNjaG9vbE1vbWVudCA9IGdldFNjaG9vbE1vbWVudChtb21lbnQobm93KSk7XG4gICAgY29uc3QgW3Rlcm1TdGFydCwgdGVybUVuZF0gPSBnZXRUZXJtU3RhckVuZERhdGUobm93LCBzY2hvb2xNb21lbnQudGVybSA9PT0gJ0FUJyk7XG4gICAgY29uc3QgW2ZpcnN0V2VlaywgbGFzdFdlZWtdID0gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybShzY2hvb2xNb21lbnQudGVybSk7XG4gICAgY29uc3Qgc2hvd0tnVHV0b3JDb21tZW50RmllbGQgPSBmZWF0dXJlcy5rZ1R1dG9yQ29tbWVudDtcblxuICAgIGxldCBjdXJyZW50V2Vla1BsYW5zIDogS0dUZXJtUGxhbm5lcldlZWtQbGFuW10gPSB3ZWVrUGxhbnMuZmlsdGVyKCh4IDogS0dUZXJtUGxhbm5lcldlZWtQbGFuKSA9PiAheC50eXBlKSBhcyBLR1Rlcm1QbGFubmVyV2Vla1BsYW5bXTtcbiAgICBsZXQgY3VycmVudFR1dG9yTm90ZXMgOiBLR1Rlcm1QbGFubmVyVHV0b3JOb3RlW10gPSB3ZWVrUGxhbnMuZmlsdGVyKCh4IDogS0dUZXJtUGxhbm5lclR1dG9yTm90ZSkgPT4geC50eXBlID09PSAndHV0b3Itbm90ZScpIGFzIEtHVGVybVBsYW5uZXJUdXRvck5vdGVbXTtcblxuICAgIGZvciAobGV0IHdlZWtNb21lbnQgPSB0ZXJtU3RhcnQuY2xvbmUoKTtcbiAgICAgIHdlZWtNb21lbnQudmFsdWVPZigpIDwgdGVybUVuZC52YWx1ZU9mKCk7XG4gICAgICB3ZWVrTW9tZW50ID0gd2Vla01vbWVudC5jbG9uZSgpLmFkZCgxLCAnd2VlaycpLnN0YXJ0T2YoJ3dlZWsnKSlcbiAgICB7XG4gICAgICBjb25zdCB3ZWVrTnVtYmVyID0gd2Vla01vbWVudC53ZWVrKCk7XG4gICAgICBjb25zdCB3ZWVrWWVhciA9IHdlZWtNb21lbnQueWVhcigpO1xuICAgICAgXG4gICAgICBjb25zdCBrZWRXZWVrID0gS0VEV2Vlayh3ZWVrWWVhciwgd2Vla051bWJlcik7XG4gICAgICBpZiAod2Vla051bWJlciA+PSBmaXJzdFdlZWsgJiYgd2Vla051bWJlciA8PSBsYXN0V2Vlaykge1xuICAgICAgICBjb25zdCB3ZWVrUGxhbiA9IGN1cnJlbnRXZWVrUGxhbnMuZmlsdGVyKHdwID0+XG4gICAgICAgICAgd3AuZGF0ZVRpbWUgPj0ga2VkV2Vlay5ub3RCZWZvcmUgJiZcbiAgICAgICAgICB3cC5kYXRlVGltZSA8PSBrZWRXZWVrLm5vdEFmdGVyKVswXTtcblxuICAgICAgICBjb25zdCB0dXRvck5vdGUgPSBjdXJyZW50VHV0b3JOb3Rlcy5maWx0ZXIod3AgPT5cbiAgICAgICAgICB3cC5kYXRlVGltZSA+PSBrZWRXZWVrLm5vdEJlZm9yZSAmJlxuICAgICAgICAgIHdwLmRhdGVUaW1lIDw9IGtlZFdlZWsubm90QWZ0ZXIpWzBdO1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0T2ZXZWVrID0gd2Vla01vbWVudC5jbG9uZSgpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XG4gICAgICAgIHdlZWtzLnB1c2goe1xuICAgICAgICAgIHdlZWtOdW1iZXIsXG4gICAgICAgICAgd2Vla0RhdGU6IHN0YXJ0T2ZXZWVrLFxuICAgICAgICAgIHdlZWtQbGFuXG4gICAgICAgIH0pO1xuICAgICAgICB0dXRvck5vdGVzLnB1c2goe1xuICAgICAgICAgIHdlZWtOdW1iZXIsXG4gICAgICAgICAgdHV0b3JWYWx1ZTogdHV0b3JOb3RlIHx8IHt2YWx1ZTogJycsIGRhdGVUaW1lOiBzdGFydE9mV2VlaywgaWQ6IGNyZWF0ZVVVSUQoKSwgdHlwZTogJ3R1dG9yLW5vdGUnfVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgXG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgIDxoND5cbiAgICAgICAgVGVybWluc3BsYW5lcmluZ1xuICAgICAgIDwvaDQ+XG4gICAgICA8aHIgLz5cbiAgICAgIHtpc0xvYWRpbmcgP1xuICAgICAgICA8U3Bpbm5lciAvPiA6IGNvdXJzZXMubGVuZ3RoID09PSAwID8gPGRpdj5cbiAgICAgICAgICBUZXJtaW5zcGxhbmVyYXJlbiBha3RpdmVyYXMgbsOkciBkdSBza3Jpdml0cyBpbiBww6UgZGluYSBrdXJzZXJcbiAgICAgICAgICA8L2Rpdj4gOiBcbiAgICAgICAgICA8dGFibGUgY2xhc3NOYW1lPVwidGVybXBsYW5uZXItdGFibGUgemVicmFcIj5cbiAgICAgICAgICAgIDx0aGVhZD5cbiAgICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgIDx0aD5WZWNrYTwvdGg+XG4gICAgICAgICAgICAgICAgey8qZ29hbHMubWFwKCh7Y291cnNlVW5pdElkLCBjb3Vyc2VVbml0TmFtZX0pID0+XG4gICAgICAgICAgICAgICAgICA8dGgga2V5PXtjb3Vyc2VVbml0SWR9IGNsYXNzTmFtZT1cInRlcm1Db3Vyc2VIZWFkZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXJtQ291cnNlVGV4dFwiPntjb3Vyc2VVbml0TmFtZX08L2Rpdj48L3RoPikqL31cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBjb3Vyc2VzLm1hcCgoYywgaWR4KSA9PiA8dGgga2V5PXtpZHh9IGNsYXNzTmFtZT1cImtnQ291cnNlSGVhZGVyXCI+e2MubmFtZX08L3RoPilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge3Nob3dLZ1R1dG9yQ29tbWVudEZpZWxkICYmIDx0aCBjbGFzc05hbWU9XCJ0dXRvckhlYWRlclwiPjwvdGg+fVxuICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgPC90aGVhZD5cbiAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAge3dlZWtzLm1hcCgodywgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXNDdXJyZW50V2VlayA9IHcud2Vla051bWJlciA9PT0gbW9tZW50KCkud2VlaygpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVWYWx1ZSA9IHR1dG9yTm90ZXMgJiYgdHV0b3JOb3Rlcy5maW5kKHRuID0+IHRuLndlZWtOdW1iZXIgPT09IHcud2Vla051bWJlcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gPHRyIGtleT17aWR4fSBjbGFzc05hbWU9e2lzQ3VycmVudFdlZWsgPyBcImN1cnJlbnRXZWVrXCIgOiBcIlwifT5cbiAgICAgICAgICAgICAgICAgIDx0ZD57dy53ZWVrTnVtYmVyfTwvdGQ+XG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGNvdXJzZXMubWFwKChjLGlkeCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlID0gdy53ZWVrUGxhbiAmJiB3LndlZWtQbGFuLnBsYW5zW2MubmFtZV07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8dGRcbiAgICAgICAgICAgICAgICAgICAgICBrZXk9e2lkeH1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e25vdGU/IGBjb3Vyc2VOb3RlIG5vdGUtY29sb3ItJHtub3RlLmNvbG9yfWAgOiBcImNvdXJzZU5vdGVcIn1cbiAgICAgICAgICAgICAgICAgICAgICBkYXRhLXRvb2x0aXA9e25vdGUgJiYgbm90ZS5kZXNjcmlwdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17bm90ZSAmJiBub3RlLmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLm9uTm90ZUNsaWNrKHcud2Vla051bWJlciwgdy53ZWVrRGF0ZSwgYy5uYW1lLCB3LndlZWtQbGFuLCBub3RlKX0+XG4gICAgICAgICAgICAgICAgICAgICAge25vdGU/IDxpIGNsYXNzTmFtZT1cImZhcyBmYS1hbGlnbi1jZW50ZXJcIi8+IDogJyd9XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+fVxuICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBzaG93S2dUdXRvckNvbW1lbnRGaWVsZCAmJiAodGhpcy5wcm9wcy50dXRvcmVkID9cbiAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpZHh9IG9uQ2xpY2s9eygpID0+IHRoaXMub25UdXRvckNsaWNrKG5vdGVWYWx1ZS50dXRvclZhbHVlLCB3LndlZWtOdW1iZXIpfSBjbGFzc05hbWU9XCJ0dXRvckNlbGxcIj5cbiAgICAgICAgICAgICAgICAgICAge25vdGVWYWx1ZS50dXRvclZhbHVlLnZhbHVlID8gPGRpdiBrZXk9e2lkeH0gZGF0YS10b29sdGlwPXtub3RlVmFsdWUudHV0b3JWYWx1ZS52YWx1ZX0+PGkgY2xhc3NOYW1lPVwiZmFzIGZhLWNvbW1lbnQtZG90c1wiPjwvaT48L2Rpdj46IDxkaXYga2V5PXtpZHh9PjxpIGNsYXNzTmFtZT1cImZhcyBmYS1jb21tZW50LW1lZGljYWxcIj48L2k+PC9kaXY+fVxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICA6XG4gICAgICAgICAgICAgICAgICAgIG5vdGVWYWx1ZS50dXRvclZhbHVlLnZhbHVlID8gPHRkIGNsYXNzTmFtZT1cInR1dG9yQ2VsbFwiPjxkaXYgZGF0YS10b29sdGlwPXtub3RlVmFsdWUudHV0b3JWYWx1ZS52YWx1ZX0+PGkgY2xhc3NOYW1lPVwiZmFyIGZhLWNvbW1lbnQtZG90c1wiPjwvaT48L2Rpdj48L3RkPiA6IDx0ZD48L3RkPlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICA8dGZvb3Q+XG4gICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICA8dGgga2V5PVwicG9pbnRzXCI+UG/DpG5nPC90aD5cbiAgICAgICAgICAgICAgICB7Y291cnNlcy5tYXAoKGMsIGlkeCkgPT4gPHRoIGtleT17aWR4fSBjbGFzc05hbWU9XCJzdGVwQ2VsbFwiPntjLmNyZWRpdHN9PC90aD4pfVxuICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgPHRoPkJldHlnc23DpWw8L3RoPlxuICAgICAgICAgICAgICAgIHsvKmdvYWxzLm1hcChnID0+XG4gICAgICAgICAgICAgICAgPHRoIGNsYXNzTmFtZT1cInN0ZXBDZWxsXCI+e2cucGVyaW9kR29hbHMuZmlsdGVyKHBnID0+IHBnLnBlcmlvZE5hbWUgPT09ICBwZXJpb2QucGVyaW9kKVxuICAgICAgICAgICAgICAgICAgLm1hcChwZz0+cGcuZ3JhZGVOYW1lKVswXSB8fCBnLmZpbmFsR29hbEdyYWRlfTwvdGg+KSovfVxuICAgICAgICAgICAgICAgIHtjb3Vyc2VzLm1hcCgoYywgaWR4KSA9PlxuICAgICAgICAgICAgICAgICAgPHRoIGtleT17aWR4fSBjbGFzc05hbWU9XCJzdGVwQ2VsbFwiPntjLnBlcmlvZEdvYWxHcmFkZX08L3RoPil9XG4gICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8L3Rmb290PlxuICAgICAgICAgIDwvdGFibGU+fVxuICAgICAgICAgIDxEaWFsb2dzXG4gICAgICAgIGRpYWxvZ3M9e2RpYWxvZ3N9XG4gICAgICAgIHBvcERpYWxvZz17KCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGRpYWxvZ3M6IGRpYWxvZ3Muc2xpY2UoMCwgZGlhbG9ncy5sZW5ndGggLSAxKSB9KX0gLz5cbiAgICAgICAgICBcbiAgICA8L2Rpdj5cbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEtHVGVybVBsYW5uZXJXZWVrUGxhbiwgS0dUZXJtUGxhbm5lcldlZWtQbGFuRW50cnkgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgRW52IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgd2Vla051bWJlcjogbnVtYmVyO1xuICB3ZWVrRGF0ZTogbnVtYmVyO1xuICBjb3Vyc2VOYW1lOiBzdHJpbmc7XG4gIHdlZWtQbGFuPzogS0dUZXJtUGxhbm5lcldlZWtQbGFuO1xuICBub3RlPzogS0dUZXJtUGxhbm5lcldlZWtQbGFuRW50cnk7XG4gIGNsb3NlRGlhbG9nOiAoKT0+dm9pZDtcbiAgZW52OiBFbnY7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGNvbG9yOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBXZWVrTm90ZURpYWxvZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBkZXNjcmlwdGlvbjogcHJvcHMubm90ZSA/IHByb3BzLm5vdGUuZGVzY3JpcHRpb24gOiAnJyxcbiAgICAgIGNvbG9yOiBwcm9wcy5ub3RlID8gcHJvcHMubm90ZS5jb2xvciA6ICd5ZWxsb3cnXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZGVsZXRlKCkge1xuICAgIGNvbnN0IHsgd2Vla051bWJlciwgd2Vla0RhdGUsIGNvdXJzZU5hbWUsIHdlZWtQbGFuLCBub3RlLCBjbG9zZURpYWxvZywgZW52IH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgZGVzY3JpcHRpb24sIGNvbG9yfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBjbG9zZURpYWxvZygpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKHdlZWtQbGFuLnBsYW5zKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGF3YWl0IGVudi5rZ1Rlcm1QbGFubmVyUmVwby5kZWxldGUoW3dlZWtQbGFuLmlkXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IGVudi5rZ1Rlcm1QbGFubmVyUmVwby51cGRhdGUoW3dlZWtQbGFuXSwgd3AgPT4ge1xuICAgICAgICBkZWxldGUgd3AucGxhbnNbY291cnNlTmFtZV1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgY29uc3QgeyB3ZWVrTnVtYmVyLCB3ZWVrRGF0ZSwgY291cnNlTmFtZSwgd2Vla1BsYW4sIG5vdGUsIGNsb3NlRGlhbG9nLCBlbnYgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBkZXNjcmlwdGlvbiwgY29sb3J9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGNsb3NlRGlhbG9nKCk7XG5cbiAgICBpZiAoZGVzY3JpcHRpb24ubGVuZ3RoID09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHdlZWtQbGFuKSB7XG4gICAgICBhd2FpdCBlbnYua2dUZXJtUGxhbm5lclJlcG8udXBkYXRlKFt3ZWVrUGxhbl0sIHdwID0+IHdwLnBsYW5zW2NvdXJzZU5hbWVdID0ge2Rlc2NyaXB0aW9uLCBjb2xvcn0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBwbGFucyA9IHt9O1xuICAgICAgcGxhbnNbY291cnNlTmFtZV0gPSB7ZGVzY3JpcHRpb24sIGNvbG9yfTtcbiAgICAgIGF3YWl0IGVudi5rZ1Rlcm1QbGFubmVyUmVwby5pbnNlcnQoW3tcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgZGF0ZVRpbWU6IHdlZWtEYXRlLFxuICAgICAgICBwbGFuc1xuICAgICAgfV0pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHdlZWtOdW1iZXIsIGNvdXJzZU5hbWUsIHdlZWtQbGFuLCBub3RlLCBlbnYgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBkZXNjcmlwdGlvbiwgY29sb3IgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgcmVhZE9ubHkgPSBlbnYudHV0b3JlZDtcblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAgPGgyPkjDpG5kZWxzZSBmw7ZyIHZlY2thIHt3ZWVrTnVtYmVyfSBvY2gge2NvdXJzZU5hbWV9PC9oMj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24tdGFibGVcIj5cbiAgICAgICAgICA8ZGl2PkJlc2tyaXZuaW5nOjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZnVsbFdpZHRoXCI+XG4gICAgICAgICAgICA8dGV4dGFyZWEgYXV0b0ZvY3VzIHZhbHVlPXtkZXNjcmlwdGlvbn0gZGlzYWJsZWQ9e3JlYWRPbmx5fSBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7ZGVzY3JpcHRpb246IGV2LnRhcmdldC52YWx1ZX0pfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi10YWJsZVwiPlxuICAgICAgICAgIDxkaXY+RsOkcmc6PC9kaXY+XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e2NvbG9yfSBkaXNhYmxlZD17cmVhZE9ubHl9IG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHtjb2xvcjogZXYudGFyZ2V0LnZhbHVlfSl9PlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwieWVsbG93XCI+R3VsPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJ5ZWxsb3dMaWdodFwiPkxqdXNndWw8L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT1cImN5YW5cIj5HcsO2bjwvb3B0aW9uPlxuICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiY3lhbkxpZ2h0XCI+TGp1c2dyw7ZuPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJwdXJwbGVcIj5MaWxhPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJwdXJwbGVMaWdodFwiPkxqdXNsaWxhPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJyZWRcIj5Sw7ZkPC9vcHRpb24+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJyZWRMaWdodFwiPlJvc2E8L29wdGlvbj5cbiAgICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdj5cbiAgICAgICAge3JlYWRPbmx5ID9cbiAgICAgICAgICA8YnV0dG9uIHRhYkluZGV4PXsxfSBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCIgb25DbGljaz17KCk9PnRoaXMucHJvcHMuY2xvc2VEaWFsb2coKX0+QXZicnl0PC9idXR0b24+IDpcbiAgICAgICAgICA8PlxuICAgICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX0gY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZSBidG4tZGVmYXVsdFwiIG9uQ2xpY2s9eygpPT50aGlzLnNhdmUoKX0+U3BhcmE8L2J1dHRvbj5cbiAgICAgICAgICAgIHtub3RlICYmIDxhIHRhYkluZGV4PXsxfSBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXsoKT0+dGhpcy5kZWxldGUoKX0+VGEgYm9ydDwvYT59XG4gICAgICAgICAgPC8+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eSB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IEZ1dHVyZUFiaWxpdGllc1ZpZXdNb2RlbCB9IGZyb20gJy4vZnV0dXJlLWFiaWxpdGllcy12aWV3bW9kZWwnO1xuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBsb2FkaW5nOiBib29sZWFuLFxuICBkYXRhOiBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdLFxuICBlcnJvcjogc3RyaW5nIHwgbnVsbFxufVxuXG5leHBvcnQgY2xhc3MgRnV0dXJlQWJpbGl0aWVzVGFibGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8e30sIFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBsb2FkaW5nOiBmYWxzZSxcbiAgICAgIGRhdGE6IFtdLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMubG9hZCgpO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgbG9hZGluZzogdHJ1ZSB9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGVudi5lZHNDbGllbnQuZ2V0U3R1ZGVudEZ1dHVyZUFiaWxpdGllcygpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGEgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvciB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGxvYWRpbmc6IGZhbHNlIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHZpZXdNb2RlbCA9IG5ldyBGdXR1cmVBYmlsaXRpZXNWaWV3TW9kZWwgKHRoaXMuc3RhdGUuZGF0YSk7XG4gICAgY29uc3Qge2NvbHVtbkhlYWRlcnMsIHZ0SHRzLCBjYXBhYlJvd3N9ID0gdmlld01vZGVsO1xuXG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICA8aDU+RnJhbXRpZHNmw7ZybcOlZ29yPC9oNT5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFydGlhbEVkaXRTdHVkeVBsYW5WaWV3TW9kZVwiPlxuICAgICAgICA8dGFibGUgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJyB9fSBjbGFzc05hbWU9XCJzbWFsbEZvbnRcIj5cbiAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICA8dHI+e2NvbHVtbkhlYWRlcnMubWFwKCh7IG5hbWUsIHR5cGUgfSwgaSkgPT5cbiAgICAgICAgICAgICAgdHlwZSA9PT0gJ2hlYWRlcicgP1xuICAgICAgICAgICAgICAgIDx0aCBrZXk9e2l9IHJvd1NwYW49ezJ9PntuYW1lfTwvdGg+IDpcbiAgICAgICAgICAgICAgICA8dGgga2V5PXtpfSBjb2xTcGFuPXsyfT57bmFtZX08L3RoPil9PC90cj5cbiAgICAgICAgICAgIDx0ciBjbGFzc05hbWU9XCJoZWFkZXJcIj5cbiAgICAgICAgICAgICAge3Z0SHRzLm1hcCgodnRIdCwgaSkgPT4gPHRoIGtleT17aX0+e3Z0SHR9PC90aD4pfVxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgIHtjYXBhYlJvd3MubWFwKChyb3csIGkpID0+IDx0ciBrZXk9e2l9IGNsYXNzTmFtZT17KE1hdGguZmxvb3IoaS8zKSAlIDIpICYmICd0YWJsZU9kZCd9PlxuICAgICAgICAgICAgICB7cm93Lm1hcCgoY29sLCBpKSA9PiBjb2wudHlwZSA9PT0gJ2FiaWxpdHknID9cbiAgICAgICAgICAgICAgICA8dGQga2V5PXtpfSByb3dTcGFuPXszfSBjbGFzc05hbWU9XCJnb2Fsc1N1YmplY3RcIj57Y29sLm5hbWV9PC90ZD4gOlxuICAgICAgICAgICAgICAgIGNvbC50eXBlID09PSAnY2FwYWJpbGl0eScgP1xuICAgICAgICAgICAgICAgICAgPHRkIGtleT17aX0gY2xhc3NOYW1lPVwiZ29hbHNTdWJqZWN0XCI+e2NvbC5uYW1lfTwvdGQ+IDpcbiAgICAgICAgICAgICAgICAgIGNvbC5zZWxlY3RlZCA/XG4gICAgICAgICAgICAgICAgICAgIDx0ZCBrZXk9e2l9IGNsYXNzTmFtZT1cImVkc1NlbGVjdGVkXCI+PGRpdiBjbGFzc05hbWU9XCJtYXJrZWRJdGVtXCI+PC9kaXY+PC90ZD4gOlxuICAgICAgICAgICAgICAgICAgICA8dGQga2V5PXtpfSAvPil9XG4gICAgICAgICAgICA8L3RyPil9XG4gICAgICAgICAgPC90Ym9keT5cbiAgICAgICAgPC90YWJsZT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PjtcbiAgfVxufSIsImltcG9ydCB7IEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5IH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQgeyBmbGF0dGVuIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG50eXBlIEFiaWxpdHlDZWxsID0geyB0eXBlOiAnYWJpbGl0eScsIG5hbWU6IHN0cmluZyB9O1xudHlwZSBDYXBhYkNlbGwgPSB7IHR5cGU6ICdjYXBhYmlsaXR5JywgbmFtZTogc3RyaW5nIH07XG50eXBlIFRlcm1DZWxsID0geyB0eXBlOiAndGVybScsIHNlbGVjdGVkOiBib29sZWFuIH07XG50eXBlIENlbGwgPSBBYmlsaXR5Q2VsbCB8IENhcGFiQ2VsbCB8IFRlcm1DZWxsO1xuXG5leHBvcnQgY2xhc3MgRnV0dXJlQWJpbGl0aWVzVmlld01vZGVsIHtcbiAgY29sdW1uSGVhZGVyczoge25hbWU6IHN0cmluZywgdHlwZTogc3RyaW5nfVtdO1xuICB2dEh0czogc3RyaW5nW107XG4gIGNhcGFiUm93czogQ2VsbFtdW107XG5cbiAgY29uc3RydWN0b3IoZGF0YTogRURTU3R1ZGVudEZ1dHVyZUFiaWxpdHlbXSkge1xuICAgIC8vIFdpbGwgYnVpbGQgdGhlIHRvdGFsIHllYXJzXG4gICAgY29uc3QgZm9ybU5hbWVzOiB7W25hbWU6IHN0cmluZ106IHRydWV9ID0ge307XG4gICAgZGF0YS5mb3JFYWNoKGEgPT4gYS5jYXBhYmlsaXRpZXMuZm9yRWFjaChjID0+IGZvcm1OYW1lc1tjLmZvcm1OYW1lXSA9IHRydWUpKTtcbiAgICBjb25zdCB5ZWFycyA9IE9iamVjdC5rZXlzKGZvcm1OYW1lcyk7XG4gICAgXG4gICAgLy8gY29sdW1uSGVhZGVyc1xuICAgIHRoaXMuY29sdW1uSGVhZGVycyA9IFt7XG4gICAgICBuYW1lOiBcIkZyYW10aWRzZsO2cm3DpWdhXCIsXG4gICAgICB0eXBlOiBcImhlYWRlclwiXG4gICAgfSwge1xuICAgICAgbmFtZTogXCJPbXLDpWRlXCIsXG4gICAgICB0eXBlOiBcImhlYWRlclwiXG4gICAgfV0uY29uY2F0KHllYXJzLm1hcCh5ZWFyID0+ICh7XG4gICAgICBuYW1lOiB5ZWFyLFxuICAgICAgdHlwZTogJ3llYXInXG4gICAgfSkpKTtcblxuICAgIC8vIHZ0SHRzXG4gICAgdGhpcy52dEh0cyA9IGZsYXR0ZW4oeWVhcnMubWFwKHllYXIgPT4gW1wiSFRcIiwgXCJWVFwiXSkpO1xuXG4gICAgLy8gY2FiYWJSb3dzXG4gICAgY29uc3Qgcm93czogQ2VsbFtdW10gPSBbXTtcbiAgICBkYXRhLmZvckVhY2goYSA9PiB7XG4gICAgICBsZXQgcm93OiBDZWxsW10gPSBbe3R5cGU6ICdhYmlsaXR5JywgbmFtZTogYS5hYmlsaXR5TmFtZX1dO1xuICAgICAgY29uc3QgYWRkZWRDYXBhYnMgOiB7W25hbWU6IHN0cmluZ106IHRydWV9ID0ge307XG4gICAgICBhLmNhcGFiaWxpdGllcy5mb3JFYWNoKGMgPT4ge1xuICAgICAgICBjb25zdCBjZWxsczogVGVybUNlbGxbXSA9IFtcbiAgICAgICAgICB7dHlwZTogJ3Rlcm0nLCBzZWxlY3RlZDogYy5odEhhc1ZhbHVlICE9PSBmYWxzZX0sXG4gICAgICAgICAge3R5cGU6ICd0ZXJtJywgc2VsZWN0ZWQ6IGMudnRIYXNWYWx1ZSAhPT0gZmFsc2V9XG4gICAgICAgIF07XG4gICAgICAgIC8vaWYgKGMuaHRIYXNWYWx1ZSB8fCBjLnZ0SGFzVmFsdWUpIGRlYnVnZ2VyO1xuXG4gICAgICAgIGlmICghYWRkZWRDYXBhYnNbYy5jYXBhYmlsaXR5TmFtZV0pIHtcbiAgICAgICAgICAvL2lmICghaXNGaXJzdENhcGFiaWxpdHkpIHJvd3MucHVzaChyb3cpO1xuICAgICAgICAgIGlmIChyb3cubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgcm93cy5wdXNoKHJvdyk7XG4gICAgICAgICAgICByb3cgPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWRkZWRDYXBhYnNbYy5jYXBhYmlsaXR5TmFtZV0gPSB0cnVlO1xuICAgICAgICAgIHJvdy5wdXNoKHt0eXBlOiAnY2FwYWJpbGl0eScsIG5hbWU6IGMuY2FwYWJpbGl0eU5hbWV9KTtcbiAgICAgICAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4gcm93LnB1c2goY2VsbCkpO1xuICAgICAgICB9IGVsc2UgaWYgKHJvdykge1xuICAgICAgICAgIC8vYWRkZWRDYXBhYnNbYy5jYXBhYmlsaXR5TmFtZV0uY29uY2F0KGNlbGxzKTtcbiAgICAgICAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4gcm93LnB1c2goY2VsbCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChyb3cpIHJvd3MucHVzaChyb3cpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5jYXBhYlJvd3MgPSByb3dzO1xuICB9XG59IiwiaW1wb3J0IHtFRFNTdHVkeVBsYW59IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgRURTUGVyaW9kIH0gZnJvbSAnLi4vLi4vYXBpcy9lZHNjbGllbnQnO1xuXG5leHBvcnQgY2xhc3MgVmlld01vZGVsIHtcbiAgICBzdWJqZWN0czogQXJyYXk8e1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgICAgIGF0R29hbDogc3RyaW5nO1xuICAgICAgICBzdEdvYWw6IHN0cmluZztcbiAgICAgICAgZmluYWxHb2FsOiBzdHJpbmc7XG4gICAgICAgIHN0cmF0ZWdpZXM6IHN0cmluZztcbiAgICB9PjtcblxuICAgIGNvbnN0cnVjdG9yIChzdHVkeVBsYW5zOiBFRFNTdHVkeVBsYW5bXSkge1xuICAgICAgICB0aGlzLnN1YmplY3RzID0gc3R1ZHlQbGFucy5tYXAoc3AgPT4ge1xuICAgICAgICAgICAgY29uc3QgcGVyaW9kR29hbHMgPSBzcC5wZXJpb2RHb2Fsc1xuICAgICAgICAgICAgICAgIC5tYXAoZyA9PiAoe3BlcmlvZDogbmV3IEVEU1BlcmlvZChnLnBlcmlvZE5hbWUpLCBnb2FsOiBnLmdyYWRlTmFtZX0pKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogc3AuY291cnNlVW5pdE5hbWUsXG4gICAgICAgICAgICAgICAgYXRHb2FsOiBwZXJpb2RHb2Fscy5maWx0ZXIgKCh7cGVyaW9kfSk9PiBwZXJpb2QudGVybSA9PT0gJ0FUJykubWFwKCh7Z29hbH0pID0+IGdvYWwpWzBdLFxuICAgICAgICAgICAgICAgIHN0R29hbDogcGVyaW9kR29hbHMuZmlsdGVyICgoe3BlcmlvZH0pPT4gcGVyaW9kLnRlcm0gPT09ICdTVCcpLm1hcCgoe2dvYWx9KSA9PiBnb2FsKVswXSxcbiAgICAgICAgICAgICAgICBmaW5hbEdvYWw6IHNwLmZpbmFsR29hbEdyYWRlLFxuICAgICAgICAgICAgICAgIHN0cmF0ZWdpZXM6IHNwLnN0cmF0ZWd5VGV4dFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IFZpZXdNb2RlbCB9IGZyb20gJy4vZ29hbHMtdmlld21vZGVsJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEVEU1N0dWR5UGxhbiB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgRnV0dXJlQWJpbGl0aWVzVGFibGUgfSBmcm9tICcuL2Z1dHVyZS1hYmlsaXRpZXMtdGFibGUnO1xuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBsb2FkaW5nU3R1ZHlQbGFuczogYm9vbGVhbixcbiAgc3R1ZHlQbGFuczogRURTU3R1ZHlQbGFuW10sXG4gIGVycm9yOiBzdHJpbmcgfCBudWxsXG59XG5cbmV4cG9ydCBjbGFzcyBLU0dvYWxzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PHt9LCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgbG9hZGluZ1N0dWR5UGxhbnM6IGZhbHNlLFxuICAgICAgc3R1ZHlQbGFuczogW10sXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7bG9hZGluZ1N0dWR5UGxhbnM6IHRydWV9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3R1ZHlQbGFucyA9IGF3YWl0IGVudi5lZHNDbGllbnQuZ2V0U3R1ZGVudEdvYWxzKCk7XG4gICAgICB0aGlzLnNldFN0YXRlKHtzdHVkeVBsYW5zfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yfSk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe2xvYWRpbmdTdHVkeVBsYW5zOiBmYWxzZX0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHZpZXdNb2RlbCA9IG5ldyBWaWV3TW9kZWwodGhpcy5zdGF0ZS5zdHVkeVBsYW5zKTtcbiAgICBjb25zdCBzaG93VGVybUdvYWxzID1cbiAgICAgICAoJycrZW52LmN1cnJlbnRVc2VyLnNjaG9vbFR5cGUpLnRvTG93ZXJDYXNlKCkgIT09IFwiZ3ltbmFzaXVtXCI7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgIDxoND5cbiAgICAgICAge0xgTcOlbGB9XG4gICAgICA8L2g0PlxuICAgICAgPGhyIC8+XG4gICAgICA8dGFibGUgY2xhc3NOYW1lPVwic21hbGxGb250XCI+XG4gICAgICAgIDx0aGVhZD5cbiAgICAgICAgICA8dHI+XG4gICAgICAgICAgICA8dGg+e0xgw4RtbmVgfTwvdGg+XG4gICAgICAgICAgICB7c2hvd1Rlcm1Hb2FscyAmJiA8dGg+e0xgSFRgfTwvdGg+fVxuICAgICAgICAgICAge3Nob3dUZXJtR29hbHMgJiYgPHRoPntMYFZUYH08L3RoPn1cbiAgICAgICAgICAgIDx0aD57TGBTbHV0bcOlbGB9PC90aD5cbiAgICAgICAgICAgIDx0aD57TGBTdHJhdGVnaWVyYH08L3RoPlxuICAgICAgICAgIDwvdHI+XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICB7dmlld01vZGVsLnN1YmplY3RzLm1hcCgocywgaSkgPT5cbiAgICAgICAgICA8dHIga2V5PXtzLm5hbWV9IGNsYXNzTmFtZT17aSAlIDIgJiYgXCJ0YWJsZU9kZFwifT5cbiAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJnb2Fsc1N1YmplY3RcIj57cy5uYW1lfTwvdGQ+XG4gICAgICAgICAgICB7c2hvd1Rlcm1Hb2FscyAmJiA8dGQgY2xhc3NOYW1lPVwiZ29hbHNUZXJtXCI+e3MuYXRHb2FsfTwvdGQ+fVxuICAgICAgICAgICAge3Nob3dUZXJtR29hbHMgJiYgPHRkIGNsYXNzTmFtZT1cImdvYWxzVGVybVwiPntzLnN0R29hbH08L3RkPn1cbiAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJnb2Fsc0VuZFwiPntzLmZpbmFsR29hbH08L3RkPlxuICAgICAgICAgICAgPHRkPntzLnN0cmF0ZWdpZXN9PC90ZD5cbiAgICAgICAgICA8L3RyPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvdGJvZHk+PC90YWJsZT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZpZGVyXCIgLz5cbiAgICAgICAgPEZ1dHVyZUFiaWxpdGllc1RhYmxlIC8+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7S1NUZXJtUGxhbm5lcn0gZnJvbSAnLi90ZXJtcGxhbm5lcic7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7SW5qZWN0ZWRJbnRsUHJvcHN9IGZyb20gJ3JlYWN0LWludGwnO1xuXG5leHBvcnQgZnVuY3Rpb24gS1NUZXJtUGxhbm5lclNlbGYgKHByb3BzIDogSW5qZWN0ZWRJbnRsUHJvcHMpIHtcbiAgY29uc3Qge2ludGx9ID0gcHJvcHM7XG4gIHJldHVybiA8TGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt7aW50bH19PlxuICAgICAgICAgICAgPEtTVGVybVBsYW5uZXIgZW52PXtlbnZ9IHR1dG9yZWQ9e2ZhbHNlfSBpbml0aWFsRGF0ZT17bmV3IERhdGUoKX0vPlxuICAgICAgICAgPC9MYW5ndWFnZUNvbnRleHQuUHJvdmlkZXI+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtLU1Rlcm1QbGFubmVyfSBmcm9tICcuL3Rlcm1wbGFubmVyJztcbmltcG9ydCB7IFR1dG9yYWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy90dXRvcmFibGUtY29tcG9uZW50JztcbmltcG9ydCB7IEluamVjdGVkSW50bFByb3BzIH0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcblxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgSW5qZWN0ZWRJbnRsUHJvcHN7XG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEtTVGVybVBsYW5uZXJUdXRvcmVkIChwcm9wczogUHJvcHMpIHtcbiAgY29uc3Qge2ludGx9ID0gcHJvcHM7XG4gIHJldHVybiA8TGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt7aW50bH19PlxuICA8VHV0b3JhYmxlQ29tcG9uZW50XG4gICAgdHV0b3JlZD17dHJ1ZX1cbiAgICBjcmVhdGVDb21wb25lbnQ9e2VudiA9PlxuICAgICAgPEtTVGVybVBsYW5uZXJcbiAgICAgICAga2V5PXtlbnYuY3VycmVudFVzZXIubWFpbH1cbiAgICAgICAgZW52PXtlbnZ9XG4gICAgICAgIHR1dG9yZWQ9e3RydWV9IFxuICAgICAgICBpbml0aWFsRGF0ZT17bmV3IERhdGUoKX0vPlxuICAgIH1cbiAgLz48L0xhbmd1YWdlQ29udGV4dC5Qcm92aWRlcj47XG59XG4iLCJpbXBvcnQge1Rlcm19IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCB7RURTQ291cnNlfSBmcm9tICcuLi8uLi9jb250cmFjdHMvZWRzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcnN0QW5kTGFzdFdlZWsodGVybTogVGVybSkge1xuICByZXR1cm4gdGVybSA9PT0gJ0FUJyA/XG4gICAgWzMzLCA1MF0gOiAgLy8gVGhpcyBpcyBhIGd1ZXNzISBOZWVkIGRhdGEhIFNob3VsZCBiZSBwb3NzaWJsZSB0byBnZXQgZnJvbSBza29sYTI0P1xuICAgIFsyLCAyM107ICAgIC8vIFRoaXMgaXMgYSBndWVzcyEgTmVlZCBkYXRhIVxufVxuXG5leHBvcnQgY29uc3QgTEFTVF9TVEVQX1NQUklORyA9IDI4OyAvLyBXZWVrIDI4IGlzIGluIHN1bW1lci4gVXNlIGl0IGFzIHBsYWNlaG9sZGVyIGZvciBcImxhc3Qgc3RlcFwiXG5leHBvcnQgY29uc3QgTEFTVF9TVEVQX0FVVFVNTiA9IDUyOyAvLyBXZWVrIG11c3QgYmUgdmFsaWQuIFVzZSBpdCBhcyBwbGFjZWhvbGRlciBmb3IgXCJsYXN0IHN0ZXBcIlxuXG4vKipcbiAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzIHRpZ2h0bHkgY291cGxlZCB0byB0aGUgc3dlZGlzaCBzY2hvb2wuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaW5kQ291cnNlRnJvbUNvbHVtbkhlYWRlcihcbiAgY291cnNlczogRURTQ291cnNlW10sXG4gIGNvbHVtbkhlYWRlcjogc3RyaW5nKSA6IEVEU0NvdXJzZSB8IG51bGxcbntcbiAgc3dpdGNoIChjb2x1bW5IZWFkZXIpIHtcbiAgICBjYXNlICdNLnNwcic6IHJldHVybiBjb3Vyc2VzXG4gICAgICAuZmlsdGVyKGNvdXJzZSA9PiBjb3Vyc2Uuc2hvcnROYW1lICE9PSAnTUEnICYmIGNvdXJzZS5zaG9ydE5hbWUuc3RhcnRzV2l0aCgnTScpKVswXSB8fCBudWxsO1xuICAgIGNhc2UgJ01hJzogcmV0dXJuIGNvdXJzZXMuZmlsdGVyKGMgPT4gYy5zaG9ydE5hbWUgPT09IFwiTUFcIilbMF0gfHwgbnVsbDtcbiAgICBjYXNlICdTdi9TdkEnOiByZXR1cm4gY291cnNlcy5maWx0ZXIoYyA9PiBjLnNob3J0TmFtZS5zdGFydHNXaXRoKFwiU1ZcIikpWzBdIHx8IG51bGw7XG4gICAgY2FzZSAnRW5nJzogcmV0dXJuIGNvdXJzZXMuZmlsdGVyKGMgPT4gYy5zaG9ydE5hbWUgPT09IFwiRU5cIilbMF0gfHwgbnVsbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbHVtbnNIZWFkZXIobG9jYWxlOiBzdHJpbmcpOiBzdHJpbmdbXVxue1xuICBzd2l0Y2gobG9jYWxlKVxuICB7XG4gICAgY2FzZSAnc3YnOlxuICAgIHJldHVybiBbJ00uc3ByJywnTWEnLCAnU3YvU3ZBJywgJ0VuZyddO1xuICAgIGNhc2UgJ2VuX3Npbic6XG4gICAgcmV0dXJuIFsnTUZMJywnTWEnLCAnSGknLCAnRW5nJywgJ1lvZ2EnLCAnSUNUJ107XG4gICAgY2FzZSAnZW5fbmluJzpcbiAgICByZXR1cm4gWydNRkwnLCdNYScsICdIaScsICdFbmcnLCAnWW9nYScsICdJQ1QnXTtcbiAgfVxufVxuXG4vKipcbiAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzIHRpZ2h0bHkgY291cGxlZCB0byB0aGUgc3dlZGlzaCBzY2hvb2wuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2x1bW5IZWFkZXJGcm9tQ291cnNlKGNvdXJzZTogRURTQ291cnNlKSA6IHN0cmluZ1xue1xuICBjb25zdCBzaG9ydE5hbWUgPSBjb3Vyc2Uuc2hvcnROYW1lO1xuICBpZiAoc2hvcnROYW1lID09PSBcIk1BXCIpIHJldHVybiAnTWEnO1xuICBpZiAoc2hvcnROYW1lID09PSBcIkVOXCIpIHJldHVybiAnRW5nJztcbiAgaWYgKHNob3J0TmFtZS5zdGFydHNXaXRoKFwiU1ZcIikpIHJldHVybiAnU3YvU3ZBJztcbiAgaWYgKHNob3J0TmFtZS5zdGFydHNXaXRoKFwiTTJcIikpIHJldHVybiAnTS5zcHInO1xuICByZXR1cm4gbnVsbDtcbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEdlbmVyaWNTY2hvb2xUZXJtIH0gZnJvbSAnLi4vLi4vdXRpbHMvZ2VuZXJpYy1zY2hvb2wtdGVybSc7XG5pbXBvcnQge0VEU0NvdXJzZX0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQge1ZpZXdNb2RlbH0gZnJvbSAnLi92aWV3bW9kZWwnO1xuaW1wb3J0IHsgQ29udGVudEVkaXRhYmxlRmllbGR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9jb250ZW50LWVkaXRhYmxlLWZpZWxkJztcbmltcG9ydCAgeyBFbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgS1NUZXJtUGxhbm5lcldlZWtQbGFuLCBUZXJtUGxhbm5lclR1dG9yTm90ZSwgVGVybXBsYW5uZXJXZWVrT3JUdXRvciB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCAnLi4vLi4vcmVwb3Mva3MtdGVybXBsYW5uZXItcmVwby1pbnN0YW5jZSc7XG5pbXBvcnQge0xhbmd1YWdlQ29udGV4dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IGNmZyBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5jZmcnO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xuaW1wb3J0IHsgRG91Z2hudXQgfSBmcm9tICcuLi9jaGFydHMvZG91Z2hudXQnO1xuaW1wb3J0IHsgZ2V0U2Nob29sVHJhbnNsYXRlZFN1YmplY3RGdWxsbmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL2dlbmVyaWMtc2Nob29sLXV0aWxzJztcbmltcG9ydCB7IERpYWxvZ3MgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZGlhbG9ncyc7XG5pbXBvcnQgeyBUdXRvckRpYWxvZyB9IGZyb20gJy4vdHV0b3ItZGlhbG9nJztcbmltcG9ydCB7IERvY3VtZW50QWNjZXNzIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgZmVhdHVyZXMgfSBmcm9tICcuLi8uLi9mZWF0dXJlcyc7XG5pbXBvcnQgeyBPcGVuQ2xvc2VCb3ggfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpbml0aWFsRGF0ZTogRGF0ZTtcbiAgdHV0b3JlZDogYm9vbGVhbjtcbiAgZW52OiBFbnY7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHNjaG9vbFRlcm06IEdlbmVyaWNTY2hvb2xUZXJtO1xuICB3ZWVrUGxhbnM6IFRlcm1wbGFubmVyV2Vla09yVHV0b3JbXTtcbiAgYWN0aXZlQ291cnNlczogRURTQ291cnNlW107XG4gIGxvYWRpbmdXZWVrUGxhbnM6IGJvb2xlYW47XG4gIGxvYWRpbmdBY3RpdmVDb3Vyc2VzOiBib29sZWFuO1xuICBlcnJvcjogRXJyb3IgfCBzdHJpbmcgfCBudWxsO1xuICBpbml0aWFsTG9hZDogYm9vbGVhbjtcbiAgZGlhbG9nczogYW55W107XG59XG5cblxuZXhwb3J0IGNsYXNzIEtTVGVybVBsYW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgdGFibGU6IEhUTUxUYWJsZUVsZW1lbnQ7XG4gIGZsb3dJZDogbnVtYmVyO1xuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XG4gIGZpZWxkczogQ29udGVudEVkaXRhYmxlRmllbGRbXVtdO1xuICB1bm1vdW50ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNjaG9vbFRlcm06IG5ldyBHZW5lcmljU2Nob29sVGVybShwcm9wcy5pbml0aWFsRGF0ZSksXG4gICAgICBhY3RpdmVDb3Vyc2VzOiBbXSxcbiAgICAgIHdlZWtQbGFuczogW10sXG4gICAgICBlcnJvcjogbnVsbCxcbiAgICAgIGxvYWRpbmdBY3RpdmVDb3Vyc2VzOiBmYWxzZSxcbiAgICAgIGxvYWRpbmdXZWVrUGxhbnM6IGZhbHNlLFxuICAgICAgaW5pdGlhbExvYWQ6IHRydWUsXG4gICAgICBkaWFsb2dzOiBbXVxuICAgIH1cbiAgICB0aGlzLmZsb3dJZCA9IDE7XG4gICAgdGhpcy51cGRhdGVXZWVrUGxhbnMgPSB0aGlzLnVwZGF0ZVdlZWtQbGFucy5iaW5kKHRoaXMpO1xuICB9XG5cbiAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgYXdhaXQgdGhpcy5sb2FkKHRoaXMuc3RhdGUuc2Nob29sVGVybSk7XG4gICAgaWYgKCF0aGlzLnVubW91bnRlZCkgdGhpcy5wcm9wcy5lbnYua3NUZXJtUGxhbm5lclJlcG8ubWVtLnN1YnNjcmliZSh0aGlzLnVwZGF0ZVdlZWtQbGFucyk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnVubW91bnRlZCA9IHRydWU7XG4gICAgdGhpcy5wcm9wcy5lbnYua3NUZXJtUGxhbm5lclJlcG8ubWVtLnVuc3Vic2NyaWJlKHRoaXMudXBkYXRlV2Vla1BsYW5zKTtcbiAgfSAgXG5cbiAgdXBkYXRlV2Vla1BsYW5zKHdlZWtQbGFuc09yVHV0b3JDb21tOiBUZXJtcGxhbm5lcldlZWtPclR1dG9yW10sIGVycm9yPzogRXJyb3IpIHtcbiAgICB0aGlzLnNldFN0YXRlKHt3ZWVrUGxhbnM6IHdlZWtQbGFuc09yVHV0b3JDb21tLCBsb2FkaW5nV2Vla1BsYW5zOiBmYWxzZSwgZXJyb3I6IGVycm9yIHx8IG51bGx9KTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoc2Nob29sVGVybTogR2VuZXJpY1NjaG9vbFRlcm0pIHtcbiAgICBjb25zdCBmbG93SWQgPSArK3RoaXMuZmxvd0lkO1xuICAgIHRoaXMuZmllbGRzID0gW107XG5cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIC8vbG9hZGluZ1dlZWtQbGFuczogdHJ1ZSxcbiAgICAgIGxvYWRpbmdBY3RpdmVDb3Vyc2VzOiB0cnVlXG4gICAgfSk7XG4gICAgY29uc3Qge2tzVGVybVBsYW5uZXJSZXBvfSA9IHRoaXMucHJvcHMuZW52O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlcm0gPSBhd2FpdCB0aGlzLmxvYWRBY2FkZW1pY1llYXJEYXRlcyhzY2hvb2xUZXJtLCBjZmcuS0VEX1NDSE9PTF9MT0NBTEUpO1xuICAgICAgaWYgKHRoaXMuZmxvd0lkICE9PSBmbG93SWQpIHJldHVybjtcbiAgICAgIHZhciBjdXJyZW50U2Nob29sVGVybSA9IG5ldyBHZW5lcmljU2Nob29sVGVybShzY2hvb2xUZXJtLnNlbGVjdGVkRGF0ZSwgdGhpcy5jb250ZXh0LmludGwubG9jYWxlLCB0ZXJtKTtcbiAgICAgIC8vcmVmcmVzaCBzYXZlZCBkYXRhXG4gICAgICBrc1Rlcm1QbGFubmVyUmVwby5yZWZyZXNoRGF0YShjdXJyZW50U2Nob29sVGVybS5nZXRUZXJtU3RhcnRBbmRFbmQodHJ1ZSkpO1xuXG4gICAgICAvL3JlbG9hZCBjb3Vyc2VzIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRhdGVcbiAgICAgIGNvbnN0IGFjdGl2ZUNvdXJzZXMgPSBhd2FpdCB0aGlzLmxvYWRBY3RpdmVDb3Vyc2VzKGN1cnJlbnRTY2hvb2xUZXJtKTtcbiAgICAgIGlmICh0aGlzLmZsb3dJZCAhPT0gZmxvd0lkKSByZXR1cm47XG4gICAgICB0aGlzLnNldFN0YXRlKHtzY2hvb2xUZXJtOiBjdXJyZW50U2Nob29sVGVybSwgaW5pdGlhbExvYWQ6IGZhbHNlLCBhY3RpdmVDb3Vyc2VzLCBsb2FkaW5nQWN0aXZlQ291cnNlczogZmFsc2V9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKHRoaXMuZmxvd0lkICE9PSBmbG93SWQpIHJldHVybjtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe3NjaG9vbFRlcm06IGN1cnJlbnRTY2hvb2xUZXJtLCBsb2FkaW5nQWN0aXZlQ291cnNlczogZmFsc2UsIGVycm9yfSk7ICBcbiAgICB9XG4gIH1cblxuICBhc3luYyBsb2FkQWNhZGVtaWNZZWFyRGF0ZXMoc2Nob29sVGVybTogR2VuZXJpY1NjaG9vbFRlcm0sIHNjaG9vbExvY2FsZTpzdHJpbmcpe1xuICAgIGNvbnN0IHRlcm1EYXRlcyA9IGF3YWl0IHRoaXMucHJvcHMuZW52LmVkc0NsaWVudC5nZXRBY2FkZW1pY1llYXJUZXJtcyhzY2hvb2xMb2NhbGUsIHNjaG9vbFRlcm0uc2VsZWN0ZWREYXRlKTtcbiAgICByZXR1cm4gdGVybURhdGVzO1xuICB9XG5cbiAgYXN5bmMgbG9hZEFjdGl2ZUNvdXJzZXMoc2Nob29sVGVybTogR2VuZXJpY1NjaG9vbFRlcm0pIHtcbiAgICAvL0N1c3RvbSBmb3Igbm93IGluIG9yZGVyIHRvIGNoYW5nZSBFRFNQZXJpb2RcbiAgICAvL2NvbnN0IHBlcmlvZE5hbWUgPSBuZXcgRURTUGVyaW9kKHNjaG9vbFRlcm0pLnBlcmlvZDsgXG4gICAgY29uc3QgcGVyaW9kTmFtZSA9IHNjaG9vbFRlcm0uZ2V0RWRzUGVyaW9kTmFtZSgpOyAvL3RlbXBvcmFyeSBmaXggXG4gICAgY29uc3QgYWN0aXZlQ291cnNlcyA9IGF3YWl0IHRoaXMucHJvcHMuZW52LmVkc0NsaWVudC5nZXRBY3RpdmVDb3Vyc2VzKHtwZXJpb2ROYW1lfSk7XG4gICAgcmV0dXJuIGFjdGl2ZUNvdXJzZXM7XG4gIH1cblxuICBhc3luYyB1cGRhdGVDZWxsKHdlZWtQbGFuOiBLU1Rlcm1QbGFubmVyV2Vla1BsYW4sIGNvbHVtbk5hbWU6IHN0cmluZywgbmV3VmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IG9sZFZhbHVlID0gKHdlZWtQbGFuICYmIHdlZWtQbGFuLmNlbGxWYWx1ZXNbY29sdW1uTmFtZV0pIHx8IFwiXCI7XG4gICAgaWYgKG9sZFZhbHVlID09PSBuZXdWYWx1ZSkgcmV0dXJuO1xuICAgIHRyeSB7XG4gICAgICB3ZWVrUGxhbi5jZWxsVmFsdWVzW2NvbHVtbk5hbWVdID0gbmV3VmFsdWU7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcm9wcy5lbnYua3NUZXJtUGxhbm5lclJlcG8udXBzZXJ0IChcbiAgICAgICAgd2Vla1BsYW4sXG4gICAgICAgICh3cCA6IEtTVGVybVBsYW5uZXJXZWVrUGxhbikgPT4gIHdwLmNlbGxWYWx1ZXNbY29sdW1uTmFtZV0gPSBuZXdWYWx1ZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2sgfHwgZXJyb3IpO1xuICAgICAgaWYgKGVycm9yLm5hbWUgPT09IFwiaHR0cDQwM1wiKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yOiAgdGhpcy5jb250ZXh0LmludGwoe2lkOlwiY29tbW9uLmNoYW5nZXNOb3RTYXZlZFVuYXV0aG9yaXplZFwiLCBkZWZhdWx0TWVzc2FnZTpcIsOEbmRyaW5nYXJuYSBzcGFyYWRlcyBpbnRlIHAuZy5hLiBvdGlsbHLDpGNrbGlnIGJlaMO2cmlnaGV0LlwifSl9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yOiB0aGlzLmNvbnRleHQuaW50bCh7aWQ6XCJjb21tb24uY2hhbmdlc05vdFNhdmVkRXJyb3JPY2N1cmVkXCIsIGRlZmF1bHRNZXNzYWdlOlwiRsO2ciB0aWxsZsOkbGxldCBwcm9ibGVtIGF0dCBzcGFyYSBkYXRhLiBEaW5hIMOkbmRyaW5nYXIgc3BhcmFkZXMgaW50ZS5cIn0pfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFxuICAgKiBAcGFyYW0gdHV0b3JOb3RlIFxuICAgKiBAcGFyYW0gbmV3VmFsdWUgXG4gICAqIFxuICAgKiBVcGRhdGUgdHV0b3IgZmllbGQgdmFsdWVcbiAgICovXG4gIGFzeW5jIHVwZGF0ZVR1dG9yTm90ZUZpZWxkKHR1dG9yTm90ZTogVGVybVBsYW5uZXJUdXRvck5vdGUsIG5ld1ZhbHVlOiBzdHJpbmcpe1xuICAgIGNvbnN0IG9sZFZhbHVlID0gKHR1dG9yTm90ZSAmJiB0dXRvck5vdGUuY29udGVudCkgfHwgXCJcIjtcbiAgICBpZiAob2xkVmFsdWUgPT09IG5ld1ZhbHVlKSByZXR1cm47XG4gICAgdHJ5IHtcbiAgICAgIHR1dG9yTm90ZS5jb250ZW50ID0gbmV3VmFsdWU7XG4gICAgICAvL3NldCBkb2N1bWVudCBBQ0xcbiAgICAgIHR1dG9yTm90ZS5hY2wgPSBbXG4gICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInR1dG9yRm9yXCIsIHRoaXMucHJvcHMuZW52LmN1cnJlbnRVc2VyLm1haWwsIFwiU1wiKS50b1N0cmluZygpLFxuICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJlbWFpbFwiLCB0aGlzLnByb3BzLmVudi5jdXJyZW50VXNlci5tYWlsLCBcIlJcIikudG9TdHJpbmcoKSxcbiAgICAgIF07XG5cbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByb3BzLmVudi5rc1Rlcm1QbGFubmVyUmVwby51cHNlcnQodHV0b3JOb3RlLCBcbiAgICAgICAgKG5vdGUgOiBUZXJtUGxhbm5lclR1dG9yTm90ZSkgPT4gbm90ZS5jb250ZW50ID0gbmV3VmFsdWUpO1xuICAgICAgfSBjYXRjaCAoc2hvd0Vycm9yKXt9XG4gIH1cblxuICAvKipcbiAgICogRGVsZXRlIHR1dG9yIGNvbW1lbnQgYnkgSWRcbiAgICogQHBhcmFtIG5vdGVJZFxuICAgKi9cbiAgYXN5bmMgZGVsZXRlVHV0b3JOb3RlRmllbGQobm90ZUlkOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYua3NUZXJtUGxhbm5lclJlcG8uZGVsZXRlKFtub3RlSWRdKTtcbiAgICB9IGNhdGNoIChzaG93RXJyb3Ipe31cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSBjb21tZW50IGZyb20gdHV0b3JcbiAgICogQHBhcmFtIHdlZWtOdW1iZXIgXG4gICAqIEBwYXJhbSBjb21tZW50IFxuICAgKiBcbiAgICovXG4gIG9uVHV0b3JDbGljayhub3RlOiBUZXJtUGxhbm5lclR1dG9yTm90ZSkge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8VHV0b3JEaWFsb2dcbiAgICAgIHdlZWtOdW1iZXI9e25vdGUud2Vla051bWJlcn1cbiAgICAgIGNvbW1lbnQ9e25vdGUuY29udGVudH1cbiAgICAgIGludGw9e3RoaXMuY29udGV4dC5pbnRsfVxuICAgICAgdXBkYXRlRGF0YSA9IHt2YWwgPT4gdGhpcy51cGRhdGVUdXRvck5vdGVGaWVsZChub3RlLCB2YWwpfVxuICAgICAgZGVsZXRlTm90ZURhdGEgPSB7KCkgPT4gdGhpcy5kZWxldGVUdXRvck5vdGVGaWVsZChub3RlLmlkKX1cbiAgICAgIGNsb3NlRGlhbG9nPXsoKT0+dGhpcy5jbG9zZURpYWxvZygpfSAvPik7XG4gIH1cblxuICBvcGVuRGlhbG9nKGRpYWxvZykge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsb2dzOiBbLi4udGhpcy5zdGF0ZS5kaWFsb2dzLCBkaWFsb2ddIH0pO1xuICB9XG5cbiAgY2xvc2VEaWFsb2coKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRpYWxvZ3M6IHRoaXMuc3RhdGUuZGlhbG9ncy5zbGljZSgwLCB0aGlzLnN0YXRlLmRpYWxvZ3MubGVuZ3RoIC0gMSkgfSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBOYXZpZ2F0ZSB0byBhZGphY2VudCBmaWVsZCBkZXBlbmRpbmcgb24gZGlyZWN0aW9uXG4gICAqIEBwYXJhbSBwb3MgY3VycmVudCBwb3NpdGlvbiBpbiBmaWVsZC1tYXRyaXhcbiAgICogQHBhcmFtIGRpcmVjdGlvbiBkaXJlY3Rpb24gdG8gdGFrZVxuICAgKi9cbiAgbmF2aWdhdGUocG9zOiB7cm93Om51bWJlciwgY29sOm51bWJlcn0sIGRpcmVjdGlvbjpzdHJpbmcpIHtcbiAgICBsZXQgbmV3cG9zID0gey4uLnBvc307XG4gICAgbGV0IG1heFJvd3MgPSB0aGlzLmZpZWxkcy5sZW5ndGg7XG4gICAgbGV0IG1heENvbHMgPSBNYXRoLm1heCguLi4gdGhpcy5maWVsZHMubWFwKHJvdyA9PiByb3cubGVuZ3RoKSk7XG5cbiAgICBzd2l0Y2goZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlICd1cCc6XG4gICAgICAgIG5ld3Bvcy5yb3cgPSBNYXRoLm1heChwb3Mucm93IC0gMSwgMCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZG93bic6XG4gICAgICAgIG5ld3Bvcy5yb3cgPSBNYXRoLm1pbihwb3Mucm93ICsgMSwgbWF4Um93cyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnbGVmdCc6XG4gICAgICAgIG5ld3Bvcy5jb2wgPSBNYXRoLm1heChwb3MuY29sIC0gMSwgMClcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdyaWdodCc6XG4gICAgICAgIG5ld3Bvcy5jb2wgPSBNYXRoLm1pbihwb3MuY29sICsgMSwgbWF4Q29scylcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmICh0aGlzLmZpZWxkc1tuZXdwb3Mucm93XSAmJiB0aGlzLmZpZWxkc1tuZXdwb3Mucm93XVtuZXdwb3MuY29sXSlcbiAgICAgIHRoaXMuZmllbGRzW25ld3Bvcy5yb3ddW25ld3Bvcy5jb2xdLm15c2VsZi5jdXJyZW50LmZvY3VzKCk7XG4gIH1cblxuICBcbiAgLyoqXG4gICAqIEFkZHMgZmllbGQgdG8gZmllbGQtbWF0cml4IHRvIGVuYWJsZSBuYXZpZ2F0aW9uIGluIHRoZWUgdGFibGVcbiAgICogQHBhcmFtIGZpZWxkIGN1cnJlbnQgZmllbGRcbiAgICogQHBhcmFtIHBvcyBwb3NpdGlvbiBvZiBmaWVsZCBpbiBmaWVsZC1tYXRyaXhcbiAgICovXG4gIGFkZEZpZWxkKGZpZWxkOkNvbnRlbnRFZGl0YWJsZUZpZWxkLCBwb3M6e3JvdzpudW1iZXIsIGNvbDpudW1iZXJ9KSB7XG4gICAgaWYgKHRoaXMuZmllbGRzW3Bvcy5yb3ddID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuZmllbGRzW3Bvcy5yb3ddID0gW107XG4gICAgfVxuICAgIHRoaXMuZmllbGRzW3Bvcy5yb3ddW3Bvcy5jb2xdID0gZmllbGQ7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIHRoZSBjZWxsIGluIHRoZSB0ZXJtcGxhbm5lciB0YWJsZVxuICAgKiBAcGFyYW0gcm93SW5kZXggaW5kZXggb2Ygcm93IGluIHRhYmxlXG4gICAqIEBwYXJhbSBjb2xJbmRleCBpbmRleCBvZiBjb2x1bW4gaW4gdGFibGVcbiAgICogQHBhcmFtIHN1YmplY3ROYW1lIG5hbWUgZmllbGRcbiAgICogQHBhcmFtIG1vZGVsIC0tdW51c2VkP1xuICAgKiBAcGFyYW0gd2Vla1BsYW4gY3VycmVudCByb3cgZnJvbSB3ZWVrUGxhblxuICAgKiBAcGFyYW0gcmVhZE9ubHlDZWxscyBpZiBjZWxscyBhcmUgcmVhZG9ubHlcbiAgICovXG4gIGdldFRhYmxlQ2VsbChyb3dJbmRleDogbnVtYmVyLCBjb2xJbmRleDogbnVtYmVyLCBzdWJqZWN0TmFtZTogc3RyaW5nLCBtb2RlbDogVmlld01vZGVsLCBcbiAgICB3ZWVrUGxhbjogVGVybXBsYW5uZXJXZWVrT3JUdXRvciwgcmVhZE9ubHlDZWxsczogYm9vbGVhbiwgY29sVHlwZTogc3RyaW5nKSB7XG4gICAgY29uc3QgeyBjb21wbGV0ZWRTdGVwcyB9ID0gbW9kZWw7XG4gICAgY29uc3QgcG9zID0ge3Jvdzogcm93SW5kZXgsIGNvbDogY29sSW5kZXh9O1xuICAgIFxuICAgIGlmIChjb2xUeXBlID09PSAnVHV0b3InKSB7XG4gICAgICB2YXIgdHV0b3JlZFdlZWtQbGFuID0gd2Vla1BsYW4gYXMgVGVybVBsYW5uZXJUdXRvck5vdGU7XG4gICAgICBjb25zdCB7Y29udGVudH0gPSB0dXRvcmVkV2Vla1BsYW47XG4gICAgICBpZiAodGhpcy5wcm9wcy50dXRvcmVkKSB7XG4gICAgICAgIHJldHVybiA8dGQga2V5PXtcInR1dG9ybm90ZVwiICsgY29sSW5kZXh9IG9uQ2xpY2s9eygpID0+IHRoaXMub25UdXRvckNsaWNrKHR1dG9yZWRXZWVrUGxhbil9IGNsYXNzTmFtZT1cInR1dG9yQ2VsbFwiPlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPyA8ZGl2IGtleT17Y29sSW5kZXh9IGRhdGEtdG9vbHRpcD17Y29udGVudH0+PGkga2V5PXtjb2xJbmRleH0gY2xhc3NOYW1lPVwiZmFzIGZhLWNvbW1lbnQtZG90c1wiPjwvaT48L2Rpdj4gOiBcbiAgICAgICAgICAgIDxkaXYga2V5PXtjb2xJbmRleH0+PGkga2V5PXtjb2xJbmRleH0gY2xhc3NOYW1lPVwiZmFzIGZhLWNvbW1lbnQtbWVkaWNhbFwiPjwvaT48L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIDwvdGQ+XG4gICAgICB9XG5cbiAgICByZXR1cm4gPHRkIGtleT17XCJ0dXRvcm5vdGVcIiArIGNvbEluZGV4fSBjbGFzc05hbWU9XCJ0dXRvckNlbGxcIj57Y29udGVudCAmJiA8ZGl2IGtleT17Y29sSW5kZXh9IGRhdGEtdG9vbHRpcD17Y29udGVudH0+PGkga2V5PXtjb2xJbmRleH0gY2xhc3NOYW1lPVwiZmFyIGZhLWNvbW1lbnQtZG90c1wiPjwvaT48L2Rpdj59PC90ZD5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgdmFyIGN1cnJlbnRXZWVrUGxhbiA9IHdlZWtQbGFuIGFzIEtTVGVybVBsYW5uZXJXZWVrUGxhbjtcbiAgICBjb25zdCB7Y2VsbFZhbHVlc30gPSBjdXJyZW50V2Vla1BsYW47XG4gICAgLy8gYW4gb3V0ZXIgdGQgY2VsbCBhbmQgaW5uZXIgZGl2IGlzIHVzZWQgdG8gcmVndWxhdGUgdGhlIGhlaWdodCBhbmQgYWxsb3cgZm9yIGVsbGlwc2VzIG9uIHRleHQtb3ZlcmZsb3dcbiAgICByZXR1cm4gPHRkIGNsYXNzTmFtZT17dGhpcy5nZXRDZWxsQ2xhc3NOYW1lKGNvbXBsZXRlZFN0ZXBzLCBjZWxsVmFsdWVzLCBzdWJqZWN0TmFtZSl9PlxuICAgICAgPENvbnRlbnRFZGl0YWJsZUZpZWxkXG4gICAgICAgIGtleT17Y29sSW5kZXh9XG4gICAgICAgIHJlZj17ZmllbGQgPT4gdGhpcy5hZGRGaWVsZChmaWVsZCwgcG9zKX1cbiAgICAgICAgdGV4dD17Y2VsbFZhbHVlc1tzdWJqZWN0TmFtZV19XG4gICAgICAgIHRhZz0nZGl2J1xuICAgICAgICB2YWxpZGF0ZVZhbHVlPXtjb2xUeXBlID09ICdTdGVwJyA/IC9eXFxkKiQvIDogdW5kZWZpbmVkfVxuICAgICAgICBtYXhDaGFycz17Y29sVHlwZSA9PSAnQ29tbWVudCc/IDEwMDogKGNvbFR5cGUgPT0gJ0NvdXJzZScgPyAzMCA6IDMpfVxuICAgICAgICBvbkNoYW5nZT17dGhpcy51cGRhdGVDZWxsLmJpbmQodGhpcywgd2Vla1BsYW4sIHN1YmplY3ROYW1lKX1cbiAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5Q2VsbHMgfHwgY29sVHlwZSA9PSAnVHV0b3InfVxuICAgICAgICBhbGxvd05hdmlnYXRpb249e3RydWV9XG4gICAgICAgIG9uTmF2aWdhdGU9e3RoaXMubmF2aWdhdGUuYmluZCh0aGlzLCBwb3MpfVxuICAgICAgLz5cbiAgICA8L3RkPlxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY2xhc3NuYW1lIGZvciBjZWxsXG4gICAqIEBwYXJhbSBjb21wbGV0ZWRTdGVwcyBcbiAgICogQHBhcmFtIGNlbGxWYWx1ZXMgXG4gICAqIEBwYXJhbSBzdWJqZWN0TmFtZSBcbiAgICovXG4gIGdldENlbGxDbGFzc05hbWUoY29tcGxldGVkU3RlcHMsIGNlbGxWYWx1ZXMsIHN1YmplY3ROYW1lKXtcbiAgICBjb25zdCBjb2xUeXBlID0gdGhpcy5nZXRDb2x1bW5UeXBlKHN1YmplY3ROYW1lKTtcbiAgICBpZiAoY29sVHlwZSA9PSAnU3RlcCcgJiYgY29tcGxldGVkU3RlcHNbc3ViamVjdE5hbWUgKyBjZWxsVmFsdWVzW3N1YmplY3ROYW1lXV0pIHtcbiAgICAgIHJldHVybiAnc3RlcENlbGwgY29tcGxldGVkU3RlcCc7XG4gICAgfVxuICAgIHJldHVybiBjb2xUeXBlLnRvTG93ZXJDYXNlKCkgKyAnQ2VsbCc7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyB0aGUgY2VsbCBpbiB0aGUgdGVybXBsYW5uZXIgdGFibGVzIGZvb3RlclxuICAgKiBAcGFyYW0gcm93SW5kZXggaW5kZXggb2Ygcm93IGluIHRhYmxlXG4gICAqIEBwYXJhbSBjb2xJbmRleCBpbmRleCBvZiBjb2x1bW4gaW4gdGFibGVcbiAgICogQHBhcmFtIHN1YmplY3ROYW1lIG5hbWUgZmllbGRcbiAgICogQHBhcmFtIG1vZGVsXG4gICAqIEBwYXJhbSByZWFkT25seUNlbGxzIGlmIGNlbGxzIGFyZSByZWFkb25seVxuICAgKi9cbiAgZ2V0Rm9vdGVyQ2VsbChyb3dJbmRleDogbnVtYmVyLCBjb2xJbmRleDogbnVtYmVyLCBzdWJqZWN0TmFtZTogc3RyaW5nLCBtb2RlbDogVmlld01vZGVsLCByZWFkT25seUNlbGxzOiBib29sZWFuKXtcbiAgICBjb25zdCBwb3MgPSB7cm93OiByb3dJbmRleCwgY29sOiBjb2xJbmRleH07XG4gICAgY29uc3QgY29sVHlwZSA9IHRoaXMuZ2V0Q29sdW1uVHlwZShzdWJqZWN0TmFtZSk7XG4gICAgcmV0dXJuIDx0aCBjbGFzc05hbWU9e2Ake2NvbFR5cGV9Rm9vdGVyYH1cbiAgICA+PENvbnRlbnRFZGl0YWJsZUZpZWxkXG4gICAgICBrZXk9e1wic3RlcEZvb3RlckNlbGxcIiArIGNvbEluZGV4fVxuICAgICAgcmVmPXtmaWVsZCA9PiB0aGlzLmFkZEZpZWxkKGZpZWxkLCBwb3MpfVxuICAgICAgdGFnPSdkaXYnXG4gICAgICB0ZXh0PXttb2RlbC5sYXN0U3RlcHMuY2VsbFZhbHVlc1tzdWJqZWN0TmFtZV19XG4gICAgICBvbkNoYW5nZT17dGhpcy51cGRhdGVDZWxsLmJpbmQodGhpcywgbW9kZWwubGFzdFN0ZXBzLCBzdWJqZWN0TmFtZSl9XG4gICAgICByZWFkT25seT17cmVhZE9ubHlDZWxsc31cbiAgICAgIG1heENoYXJzPXsxMH1cbiAgICAgIGFsbG93TmF2aWdhdGlvbj17dHJ1ZX1cbiAgICAgIG9uTmF2aWdhdGU9e3RoaXMubmF2aWdhdGUuYmluZCh0aGlzLCBwb3MpfVxuICAgIC8+PC90aD5cbiAgfVxuXG4gIGdldFN0ZXBIZWFkZXJDb2x1bW4oaW5kZXg6IG51bWJlciwgdHJhbnNsYXRlZENvbHVtbkhlYWRlcjogc3RyaW5nLCBjb2xUeXBlOiBzdHJpbmcpe1xuICAgIHJldHVybiA8dGgga2V5PXtgc3RlcEhlYWRlckNlbGxfJHtpbmRleH1gfSBjbGFzc05hbWU9e2Ake2NvbFR5cGUudG9Mb3dlckNhc2UoKX1IZWFkZXJgfT57Y29sVHlwZSAhPSAnVHV0b3InID8gdHJhbnNsYXRlZENvbHVtbkhlYWRlcjogJyd9PC90aD5cbiAgfVxuXG4gIGdldENvbHVtblR5cGUobmFtZSkge1xuICAgIGNvbnN0IGNvbFR5cGVzID0geydLb21tZW50YXInOiAnQ29tbWVudCcsICdLdXJzJzogJ0NvdXJzZScsICdUdXRvckNvbW1lbnQnOiAnVHV0b3InIH07XG4gICAgcmV0dXJuIGNvbFR5cGVzLmhhc093blByb3BlcnR5KG5hbWUpPyBjb2xUeXBlc1tuYW1lXSA6ICdTdGVwJztcbiAgfVxuXG4gIG9wZW5DbG9zZVByb2dyZXNzQ2hhcnRzKHZhbHVlKXsgICBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnVGVybXBsYW5uZXJCb3hDaGFydHMnLCB2YWx1ZSk7XG4gIH1cblxuICBnZXRTdGVwQ2hhcnRzKGNvbHVtbnM6IHsgbmFtZTogc3RyaW5nLCB0cmFuc2xhdGVkTmFtZT86IHN0cmluZywgaXNGaXhlZD86IGJvb2xlYW4gfVtdLCBzdWJqZWN0UHJvZ3Jlc3M6IHtbY29sdW1uSGVhZGVyOiBzdHJpbmddOiB7ZmluYWxTdGVwQ29tcGxldGVkOiBib29sZWFuLCB2YWx1ZTogbnVtYmVyfX0pIHtcbiAgICB2YXIgY2hhcnRzQm94U3RhdGUgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdUZXJtcGxhbm5lckJveENoYXJ0cycpKSBhcyBib29sZWFuO1xuICAgIHJldHVybiA8T3BlbkNsb3NlQm94IGhlYWRlck9wZW49e2NoYXJ0c0JveFN0YXRlfSBvbk9wZW5DbG9zZT17dGhpcy5vcGVuQ2xvc2VQcm9ncmVzc0NoYXJ0c30gdGl0bGU9e3RoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOlwidGVybXBsYW5uZXIuY2hhcnRzQm94VGl0bGVcIiwgZGVmYXVsdE1lc3NhZ2U6XCJNaW4gcHJvZ3Jlc3Npb25cIn0pfT48ZGl2IGNsYXNzTmFtZT1cImNoYXJ0cy1jb250YWluZXJcIj5cbiAgICAgIHtcbiAgICAgICAgY29sdW1ucy5tYXAoZWxlbWVudCA9PiB7XG4gICAgICAgICAgaWYgKCFlbGVtZW50LmlzRml4ZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBlcmNlbnRhZ2UgPSBzdWJqZWN0UHJvZ3Jlc3NbZWxlbWVudC5uYW1lXSA/IHN1YmplY3RQcm9ncmVzc1tlbGVtZW50Lm5hbWVdLnZhbHVlIDogMDtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHN1YmplY3RQcm9ncmVzc1tlbGVtZW50Lm5hbWVdLmZpbmFsU3RlcENvbXBsZXRlZCA/IG51bGwgOiBcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLm5vRmluYWxTdGVwQXZhaWxhYmxlXCIsIGRlZmF1bHRNZXNzYWdlOlwiSW5nZXQgc2x1dHN0ZWcgdGlsbGfDpG5nbGlndFwifSk7XG5cbiAgICAgICAgICAgIHZhciB0cmFuc2xhdGVkQ29sdW1ucyA9IGdldFNjaG9vbFRyYW5zbGF0ZWRTdWJqZWN0RnVsbG5hbWUodGhpcy5jb250ZXh0LmludGwpO1xuICAgICAgICAgICAgcmV0dXJuIDxkaXYga2V5PXtlbGVtZW50Lm5hbWV9IGNsYXNzTmFtZT1cImNoYXJ0LWJveFwiPlxuICAgICAgICAgICAgICA8aDQ+e3RyYW5zbGF0ZWRDb2x1bW5zW2VsZW1lbnQubmFtZV19PC9oND5cbiAgICAgICAgICAgICAgPGRpdiBrZXk9e2VsZW1lbnQubmFtZX0gY2xhc3NOYW1lPVwiaW5uZXItY2hhcnQtYm94XCI+XG4gICAgICAgICAgICAgICAgPERvdWdobnV0IGtleT17ZWxlbWVudC5uYW1lfSBwZXJjZW50YWdlPXtwZXJjZW50YWdlfSBlcnJvck1lc3NhZ2U9e2Vycm9yTWVzc2FnZX0gLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgPC9kaXY+XG4gICAgPC9PcGVuQ2xvc2VCb3g+XG59XG5cbiAgZ2V0V2Vla1R1dG9yTm90ZSh3ZWVrUGxhbnNPclR1dG9yTm90ZTogVGVybXBsYW5uZXJXZWVrT3JUdXRvcltdLCB3ZWVrTnVtYmVyOiBudW1iZXIpe1xuICAgIHJldHVybiB3ZWVrUGxhbnNPclR1dG9yTm90ZS5maW5kKCh4OiBUZXJtUGxhbm5lclR1dG9yTm90ZSkgPT4geC50eXBlID09PSBcInR1dG9yLW5vdGVcIiAmJiB4LndlZWtOdW1iZXIgPT09IHdlZWtOdW1iZXIpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcbiAgICBjb25zdCBzaG93VHV0b3JDb21tZW50RmllbGQgPSBmZWF0dXJlcy5rc1R1dG9yQ29tbWVudDtcbiAgICBjb25zdCBzaG93RG91Z2hudXRDaGFydHMgPSBmZWF0dXJlcy50ZXJtcGxhbm5lckNoYXJ0cztcbiAgICBjb25zdCBtb2RlbCA9IG5ldyBWaWV3TW9kZWwoXG4gICAgICB0aGlzLnN0YXRlLndlZWtQbGFucyxcbiAgICAgIHRoaXMuc3RhdGUuYWN0aXZlQ291cnNlcyxcbiAgICAgIHRoaXMuc3RhdGUuc2Nob29sVGVybSxcbiAgICAgIGNmZy5LRURfU0NIT09MX0xPQ0FMRSxcbiAgICAgIGludGwsXG4gICAgICBzaG93VHV0b3JDb21tZW50RmllbGQpO1xuXG4gICAgY29uc3Qge3Rlcm1Hb2FscywgY29sdW1uc30gPSBtb2RlbDtcbiAgICBjb25zdCB7dHV0b3JlZH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtsb2FkaW5nV2Vla1BsYW5zLCBlcnJvciwgd2Vla1BsYW5zOiBkYldlZWtQbGFucywgZGlhbG9nc30gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IGZhaWxlZEluaXRpYWxMb2FkID0gZGJXZWVrUGxhbnMubGVuZ3RoID09PSAwICYmICEhZXJyb3I7XG4gICAgY29uc3QgcmVhZE9ubHlDZWxscyA9IGZhaWxlZEluaXRpYWxMb2FkIHx8IHR1dG9yZWQgfHwgbG9hZGluZ1dlZWtQbGFucztcbiAgICBsZXQgcm93T2Zmc2V0ID0gMDtcbiAgICB2YXIgZmlsdGVyZWRXZWVrcGxhbnMgPSAgbW9kZWwud2Vla1BsYW5zT3JUdXRvck5vdGUuZmlsdGVyKCh4OiBLU1Rlcm1QbGFubmVyV2Vla1BsYW4pPT4gIXgudHlwZSkgYXMgS1NUZXJtUGxhbm5lcldlZWtQbGFuW107XG5cbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pbml0aWFsTG9hZCA/IDxwPjxTcGlubmVyLz48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInRlcm1wbGFubmVyLmxvYWRpbmdUZXJtcGxhbm5lclwiIGRlZmF1bHRNZXNzYWdlPVwiVi5nLiB2w6RudGEgbWVkYW4gdGVybWluc3BsYW5lciBsYWRkYXMuLi5cIi8+PC9wPiA6XG4gICAgIDxkaXYgY2xhc3NOYW1lPXtcbiAgICAgICAgXCJ0ZXJtcGxhbm5lclwiICsgXG4gICAgICAgICh0aGlzLnN0YXRlLmxvYWRpbmdXZWVrUGxhbnMgPyBcIiBsb2FkaW5nLXdlZWtwbGFuc1wiIDogXCJcIikgK1xuICAgICAgICAodGhpcy5zdGF0ZS5sb2FkaW5nQWN0aXZlQ291cnNlcyA/IFwiIGxvYWRpbmctY291cnNlc1wiIDogXCJcIilcbiAgICAgIH0+XG4gICAgICB7c2hvd0RvdWdobnV0Q2hhcnRzICYmIHRoaXMuc3RhdGUuYWN0aXZlQ291cnNlcy5sZW5ndGggPiAwICAmJiB0aGlzLmdldFN0ZXBDaGFydHMoY29sdW1ucywgbW9kZWwuc3ViamVjdFByb2dyZXNzKX1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2Vla1NlbGVjdFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgIDxwPnt0aGlzLnN0YXRlLnNjaG9vbFRlcm0udG9Mb2NhbGVTdHJpbmcoaW50bCwgdHJ1ZSl9PC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuLWdyb3VwXCI+XG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciB0ZXJtID0gdGhpcy5zdGF0ZS5zY2hvb2xUZXJtLnByZXZUZXJtKCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmxvYWQodGVybSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfT5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1sZWZ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHRlcm0gPSB0aGlzLnN0YXRlLnNjaG9vbFRlcm0ubmV4dFRlcm0oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQodGVybSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfT5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1yaWdodFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGVybXBsYW5uZXIudGVybVBsYW5uaW5nXCIgZGVmYXVsdE1lc3NhZ2U9XCJUZXJtaW5zcGxhbmVyaW5nXCIgdGFnTmFtZT1cImg0XCIvPlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cInRlcm1wbGFubmVyLXRhYmxlIHplYnJhXCI+XG4gICAgICAgICAgPHRoZWFkPlxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICAgIDx0aCBjbGFzc05hbWU9XCJ3ZWVrQ29sdW1uXCI+XG4gICAgICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInRlcm1wbGFubmVyLndlZWtOdW1iZXJcIiBkZWZhdWx0TWVzc2FnZT1cIlZlY2thXCIgLz5cbiAgICAgICAgICAgICAgICA8L3RoPlxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1ucy5tYXAoIChlbGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc3QgY29sVHlwZSA9IHRoaXMuZ2V0Q29sdW1uVHlwZShlbGVtLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RlcEhlYWRlckNvbHVtbihpbmRleCwgZWxlbS50cmFuc2xhdGVkTmFtZSwgY29sVHlwZSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgIHtmaWx0ZXJlZFdlZWtwbGFucy5maWx0ZXIod2sgPT4gd2suY2VsbFZhbHVlcykubWFwKCh3ZWVrUGxhbiwgcm93SW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgcm93T2Zmc2V0ID0gcm93SW5kZXg7XG4gICAgICAgICAgICAgIGNvbnN0IHt3ZWVrTnVtYmVyLCBhY2FkZW1pY1dlZWtOdW1iZXJ9ID0gd2Vla1BsYW47XG4gICAgICAgICAgICAgIGNvbnN0IHdlZWsgPSB3ZWVrTnVtYmVyO1xuICAgICAgICAgICAgICBjb25zdCBpc0N1cnJlbnRXZWVrID0gdGhpcy5zdGF0ZS5zY2hvb2xUZXJtLmlzQ3VycmVudFdlZWsod2Vla1BsYW4uZGF0ZVRpbWUpO1xuICAgICAgICAgICAgICByZXR1cm4gPHRyIGtleT17bW9kZWwueWVhciArICc6JyArIHdlZWt9IGNsYXNzTmFtZT17aXNDdXJyZW50V2VlayA/IFwiY3VycmVudFdlZWtcIiA6IFwiXCJ9PlxuICAgICAgICAgICAgICA8dGQ+e2ludGwubG9jYWxlID09PSBcInN2XCIgPyB3ZWVrIDogYWNhZGVtaWNXZWVrTnVtYmVyfTwvdGQ+XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLm1hcCgoZWxlbSwgY29sSW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbFR5cGUgPSB0aGlzLmdldENvbHVtblR5cGUoZWxlbS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgIHZhciB0dXRvclZhbHVlID0gdGhpcy5nZXRXZWVrVHV0b3JOb3RlKG1vZGVsLndlZWtQbGFuc09yVHV0b3JOb3RlLCB3ZWVrTnVtYmVyKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBjb2xUeXBlID09PSBcIlR1dG9yXCIgPyBcbiAgICAgICAgICAgICAgICAgIHR1dG9yVmFsdWUgJiYgc2hvd1R1dG9yQ29tbWVudEZpZWxkICYmIHRoaXMuZ2V0VGFibGVDZWxsKHJvd0luZGV4LCBjb2xJbmRleCwgZWxlbS5uYW1lLCBtb2RlbCwgdHV0b3JWYWx1ZSwgcmVhZE9ubHlDZWxscywgY29sVHlwZSkgOiAgICAgICBcbiAgICAgICAgICAgICAgICAgICB0aGlzLmdldFRhYmxlQ2VsbChyb3dJbmRleCwgY29sSW5kZXgsIGVsZW0ubmFtZSwgbW9kZWwsIHdlZWtQbGFuLCByZWFkT25seUNlbGxzLCBjb2xUeXBlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDwvdHI+IFxuICAgICAgICAgICAgfSl9XG5cbiAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICAgIDx0Zm9vdD5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgPHRoPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGVybXBsYW5uZXIuZmluYWxTdGVwXCIgZGVmYXVsdE1lc3NhZ2U9XCJTbHV0c3RlZ1wiLz48L3RoPlxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29sdW1ucy5maWx0ZXIoYyA9PiAhYy5pc0ZpeGVkKS5tYXAoKGVsZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGb290ZXJDZWxsKHJvd09mZnNldCArIDEsIGluZGV4LCBlbGVtLm5hbWUsIG1vZGVsLCByZWFkT25seUNlbGxzKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIDx0aD4tPC90aD5cbiAgICAgICAgICAgICAgPHRoPjwvdGg+XG4gICAgICAgICAgICAgIHtzaG93VHV0b3JDb21tZW50RmllbGQgJiYgPHRoPjwvdGg+fSAgICAgICAgICBcbiAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgIDx0aD48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInRlcm1wbGFubmVyLmVkc0dvYWxHcmFkZXNcIiBkZWZhdWx0TWVzc2FnZT1cIlRlcm1pbnNtw6VsXCIvPjwvdGg+XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLmZpbHRlcihjID0+ICFjLmlzRml4ZWQpLm1hcCgoZWxlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbFR5cGUgPSB0aGlzLmdldENvbHVtblR5cGUoZWxlbS5uYW1lKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIDx0aCBrZXk9e2BncmFkZXNfJHtpbmRleH1gfSBjbGFzc05hbWU9e2Ake2NvbFR5cGV9Rm9vdGVyYH0+e3Rlcm1Hb2Fsc1tlbGVtLm5hbWVdfTwvdGg+O1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgPHRoPi08L3RoPlxuICAgICAgICAgICAgICA8dGg+e3RoaXMuc3RhdGUuZXJyb3IgJiYgPHAgY2xhc3NOYW1lPVwiZXJyb3JcIj57JycrdGhpcy5zdGF0ZS5lcnJvcn08L3A+fTwvdGg+XG4gICAgICAgICAgICAgIHtzaG93VHV0b3JDb21tZW50RmllbGQgJiYgPHRoPjwvdGg+fSAgICAgXG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGZvb3Q+XG4gICAgICAgICAgPC90YWJsZT5cbiAgICAgIDwvZGl2PlxuICAgICAgPERpYWxvZ3NcbiAgICAgICAgZGlhbG9ncz17ZGlhbG9nc31cbiAgICAgICAgcG9wRGlhbG9nPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgZGlhbG9nczogZGlhbG9ncy5zbGljZSgwLCBkaWFsb2dzLmxlbmd0aCAtIDEpIH0pfSAvPiAgICBcbiAgICA8L2Rpdj5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRm9ybWF0dGVkTWVzc2FnZSwgSW5qZWN0ZWRJbnRsIH0gZnJvbSAncmVhY3QtaW50bCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHdlZWtOdW1iZXI6IG51bWJlcjtcbiAgY29tbWVudDogc3RyaW5nO1xuICBjbG9zZURpYWxvZzogKCk9PiB2b2lkO1xuICB1cGRhdGVEYXRhOiAodmFsdWU6IHN0cmluZyk9PiB2b2lkO1xuICBkZWxldGVOb3RlRGF0YTogKCkgPT4gdm9pZDtcbiAgaW50bD86IEluamVjdGVkSW50bFxufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBjb21tZW50OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBUdXRvckRpYWxvZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgY29tbWVudDogcHJvcHMuY29tbWVudCA/IHByb3BzLmNvbW1lbnQgOiAnJ1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZSgpIHtcbiAgICBjb25zdCB7IGNsb3NlRGlhbG9nfSA9IHRoaXMucHJvcHM7XG4gICAgY2xvc2VEaWFsb2coKTtcbiAgICB0aGlzLnByb3BzLmRlbGV0ZU5vdGVEYXRhKCk7XG4gIH1cblxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgY29uc3QgeyBjbG9zZURpYWxvZ30gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgY29tbWVudCB9ID0gdGhpcy5zdGF0ZTsgIFxuICAgIGNsb3NlRGlhbG9nKCk7XG4gICAgdGhpcy5wcm9wcy51cGRhdGVEYXRhKGNvbW1lbnQpO1xuXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyB3ZWVrTnVtYmVyLCBpbnRsfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBjb21tZW50IH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICA8aDI+e2ludGw/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJ0dXRvck5vdGVEaWFsb2cud2Vla0NvbW1lbnRcIiwgZGVmYXVsdE1lc3NhZ2U6XCJLb21tZW50YXIgZsO2ciB2ZWNrYSB7d2Vla051bWJlcn1cIn0sIHt3ZWVrTnVtYmVyfSk6IGBLb21tZW50YXIgZsO2ciB2ZWNrYSAke3dlZWtOdW1iZXJ9YH08L2gyPlxuICAgICAgICA8aHIgLz5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi10YWJsZVwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZnVsbFdpZHRoXCI+XG4gICAgICAgICAgICA8dGV4dGFyZWEgYXV0b0ZvY3VzIHZhbHVlPXtjb21tZW50fSBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7Y29tbWVudDogZXYudGFyZ2V0LnZhbHVlfSl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2PlxuICAgICAgICB7XG4gICAgICAgICAgPD5cbiAgICAgICAgICAgIDxidXR0b24gdGFiSW5kZXg9ezF9IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIiBvbkNsaWNrPXsoKT0+dGhpcy5zYXZlKCl9PntpbnRsID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcImNvbW1vbi5zYXZlXCIsIGRlZmF1bHRNZXNzYWdlOlwiU3BhcmFcIn0pIDogJ1NwYXJhJ30gPC9idXR0b24+XG4gICAgICAgICAgICB7Y29tbWVudCAmJiA8YSB0YWJJbmRleD17MX0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCk9PnRoaXMuZGVsZXRlKCl9PntpbnRsID8gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcImNvbW1vbi5yZW1vdmVcIiwgZGVmYXVsdE1lc3NhZ2U6XCJUYSBib3J0XCJ9KTogXCJUYSBib3J0XCIgfTwvYT59XG4gICAgICAgICAgPC8+XG4gICAgICAgIH1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgeyBLU1Rlcm1QbGFubmVyV2Vla1BsYW4sIFRlcm1QbGFubmVyVHV0b3JOb3RlLCBUZXJtcGxhbm5lcldlZWtPclR1dG9yIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgRURTQ291cnNlIH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQge1xuICBnZXRDb2x1bW5zSGVhZGVyLFxuICBnZXRDb2x1bW5IZWFkZXJGcm9tQ291cnNlLFxufSBmcm9tICcuL3Rlcm1wbGFubmVyLXV0aWxzJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBLRURXZWVrIH0gZnJvbSAnLi4vLi4vdXRpbHMvd2Vla3V0aWwnO1xuaW1wb3J0IHtJbmplY3RlZEludGx9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgR2VuZXJpY1NjaG9vbFRlcm0gfSBmcm9tICcuLi8uLi91dGlscy9nZW5lcmljLXNjaG9vbC10ZXJtJztcbmltcG9ydCB7IGdldFNjaG9vbFRyYW5zbGF0ZWRTdWJqZWN0cyB9IGZyb20gJy4uLy4uL3V0aWxzL2dlbmVyaWMtc2Nob29sLXV0aWxzJztcblxuaW50ZXJmYWNlIENvbHVtbiB7XG4gIG5hbWU6IHN0cmluZztcbiAgdHJhbnNsYXRlZE5hbWU/OiBzdHJpbmc7XG4gIGlzRml4ZWQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgVmlld01vZGVsIHtcbiAgd2Vla1BsYW5zT3JUdXRvck5vdGU6IFRlcm1wbGFubmVyV2Vla09yVHV0b3JbXTtcbiAgLy93ZWVrVHV0b3JOb3RlczogVGVybVBsYW5uZXJUdXRvck5vdGVbXTtcbiAgbGFzdFN0ZXBzOiBLU1Rlcm1QbGFubmVyV2Vla1BsYW47XG4gIGNvbXBsZXRlZFN0ZXBzOiB7IFtjb2x1bW5IZWFkZXJBbmRzdGVwOiBzdHJpbmddOiB0cnVlIH07XG4gIHRlcm1Hb2FsczogeyBbY29sdW1uSGVhZGVyOiBzdHJpbmddOiBzdHJpbmcgfTtcbiAgeWVhcjogbnVtYmVyO1xuICBzdWJqZWN0UHJvZ3Jlc3M6IHtbY29sdW1uSGVhZGVyOiBzdHJpbmddOiB7ZmluYWxTdGVwQ29tcGxldGVkOiBib29sZWFuLCB2YWx1ZTogbnVtYmVyfX0gPSB7fTtcbiAgY29sdW1uczogQ29sdW1uW10gPSBbXTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBkYldlZWtQbGFuczogVGVybXBsYW5uZXJXZWVrT3JUdXRvcltdLFxuICAgIC8vZGJUdXRvck5vdGVzOiBUZXJtUGxhbm5lclR1dG9yTm90ZVtdLFxuICAgIGNvdXJzZXM6IEVEU0NvdXJzZVtdLFxuICAgIGN1cnJlbnRTY2hvb2xUZXJtOiBHZW5lcmljU2Nob29sVGVybSxcbiAgICBjdXJyZW50U2Nob29sTG9jYWxlOiBzdHJpbmcsXG4gICAgaW50bDogSW5qZWN0ZWRJbnRsLFxuICAgIHNob3dUdXRvckNvbW1lbnRGaWVsZDogYm9vbGVhblxuICApIHtcbiAgICB0aGlzLndlZWtQbGFuc09yVHV0b3JOb3RlID0gW107XG4gICAgaWYgKGN1cnJlbnRTY2hvb2xUZXJtLnNjaG9vbE1vbWVudCkge1xuICAgICAgY29uc3QgW3Rlcm1TdGFydCwgdGVybUVuZF0gPSBjdXJyZW50U2Nob29sVGVybS5nZXRUZXJtU3RhcnRBbmRFbmQoKTtcbiAgICAgIHRoaXMueWVhciA9IHRlcm1TdGFydC55ZWFyKCk7XG4gICAgICAvL2luaXQgY29sdW1uc1xuICAgICAgdmFyIGNvbHVtbkhlYWRlcnMgPSBnZXRDb2x1bW5zSGVhZGVyKGN1cnJlbnRTY2hvb2xMb2NhbGUpO1xuICAgICAgY29sdW1uSGVhZGVycy5mb3JFYWNoKGMgPT4gdGhpcy5jb2x1bW5zLnB1c2goeyBuYW1lOiBjIH0pKTtcbiAgICAgIC8vZGVmaW5lIGZpeGVkIGNvbHVtbnMgLSB3ZSBrZWVwIHRoZXNlIHNlcGFyYXRlZCwgaW4gY2FzZSB0aGF0IHRoZSBvdGhlciBjb2x1bW5zIHdpbGwgYmUgZHluYW1pY2FsbHkgcmV0cmlldmVkXG4gICAgICBjb25zdCBmaXhlZENvbHVtbnMgPSBbeyBuYW1lOiBcIkt1cnNcIiwgaXNGaXhlZDogdHJ1ZSB9LCB7IG5hbWU6IFwiS29tbWVudGFyXCIsIGlzRml4ZWQ6IHRydWUgfV07XG4gICAgICBpZihzaG93VHV0b3JDb21tZW50RmllbGQpe1xuICAgICAgICBmaXhlZENvbHVtbnMucHVzaCggeyBuYW1lOiBcIlR1dG9yQ29tbWVudFwiLCBpc0ZpeGVkOiB0cnVlfSk7XG4gICAgICB9XG4gICAgICAvL0FkZCBmaXhlZCBjb2x1bW5zIG5hbWVzXG4gICAgICB0aGlzLmNvbHVtbnMucHVzaCguLi5maXhlZENvbHVtbnMpO1xuICAgICAgLy9wb3B1bGF0ZSB0cmFuc2xhdGlvbnNcbiAgICAgIHZhciB0cmFuc2xhdGVkQ29sdW1ucyA9IGdldFNjaG9vbFRyYW5zbGF0ZWRTdWJqZWN0cyhjdXJyZW50U2Nob29sTG9jYWxlLCBpbnRsKTtcbiAgICAgIHRoaXMuY29sdW1ucy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICBlbGVtZW50LnRyYW5zbGF0ZWROYW1lID0gdHJhbnNsYXRlZENvbHVtbnNbZWxlbWVudC5uYW1lXTtcbiAgICAgIH0pO1xuXG4gICAgICB2YXIgY3VycmVudFRlcm1Ib2xpZGF5cyA9IGN1cnJlbnRTY2hvb2xUZXJtLnNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXJTdHJ1Y3R1cmUuaG9saWRheXM7XG4gICAgICBjb25zdCBjdXJyZW50VGVybSA9IGN1cnJlbnRTY2hvb2xUZXJtLnNjaG9vbE1vbWVudC50ZXJtO1xuICAgICAgLy9cbiAgICAgIC8vIHdlZWtQbGFuc1xuICAgICAgLy9cbiAgICAgbGV0IHdlZWtwbGFuVmFsdWVzOiBLU1Rlcm1QbGFubmVyV2Vla1BsYW5bXSA9IGRiV2Vla1BsYW5zLmZpbHRlcigoeDogS1NUZXJtUGxhbm5lcldlZWtQbGFuKSA9PiAheC50eXBlKSBhcyBLU1Rlcm1QbGFubmVyV2Vla1BsYW5bXTtcbiAgICAgbGV0IHR1dG9yVmFsdWVzIDogVGVybVBsYW5uZXJUdXRvck5vdGVbXSA9IGRiV2Vla1BsYW5zLmZpbHRlcigodzogVGVybVBsYW5uZXJUdXRvck5vdGUpID0+IHcudHlwZSA9PT0gJ3R1dG9yLW5vdGUnKSBhcyBUZXJtUGxhbm5lclR1dG9yTm90ZVtdO1xuXG4gICAgICB2YXIgc3RhcnRBY2FkZW1pY1llYXJOdW1iZXIgPSBjdXJyZW50U2Nob29sVGVybS5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmFjYWRlbWljU3RhcnRXZWVrO1xuICAgICAgZm9yIChsZXQgd2Vla01vbWVudCA9IHRlcm1TdGFydC5jbG9uZSgpO1xuICAgICAgICB3ZWVrTW9tZW50LnZhbHVlT2YoKSA8IHRlcm1FbmQudmFsdWVPZigpO1xuICAgICAgICB3ZWVrTW9tZW50ID0gd2Vla01vbWVudC5jbG9uZSgpLmFkZCgxLCAnd2VlaycpLnN0YXJ0T2YoJ3dlZWsnKSkge1xuXG4gICAgICAgIHZhciBob2xpZGF5UGVyaW9kID0gY3VycmVudFRlcm1Ib2xpZGF5cy5maWx0ZXIoaD0+IHdlZWtNb21lbnQud2VlaygpID49IG1vbWVudChoLnN0YXJ0RGF0ZSkuc3RhcnRPZihcIndlZWtcIikud2VlaygpICYmIFxuICAgICAgICB3ZWVrTW9tZW50LndlZWsoKSA8PSBtb21lbnQoaC5lbmREYXRlKS5lbmRPZignd2VlaycpLndlZWsoKSk7XG4gICAgICAgIC8vaWYgdGhlIGN1cnJlbnQgd2VlayBpcyBhIGhvbGlkYXkgd2Vlaywgc2tpcCBpdFxuICAgICAgICBpZihob2xpZGF5UGVyaW9kLmxlbmd0aCA+IDApe1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHdlZWtOdW1iZXIgPSB3ZWVrTW9tZW50LndlZWsoKTtcbiAgICAgICAgY29uc3Qga2VkV2VlayA9IEtFRFdlZWsod2Vla01vbWVudC55ZWFyKCksIHdlZWtOdW1iZXIpO1xuICAgICAgICAvL0EgdGVybSBjYW4gZW5kIGFuZCBzdGFydCBvbiB0aGUgc2FtZSB3ZWVrIGZvciBJbmRpYVxuICAgICAgICAvL2luIHRoaXMgY2FzZSB3ZSBzaG91bGQgZmlsdGVyIHRoZW0gYnkgdGhlIHRlcm1cbiAgICAgICAgLy9UaGlzIGlzIG5vdCB0aGUgY2FzZSBmb3Igc3YgbG9jYWxlIGFuZCB3ZSB3YW50IHRvIHNraXAgdGhpcyBjaGVjayBcbiAgICAgICAgLy9iZWNhdXNlIGRhdGEgaXMgYWxyZWFkeSBzYXZlZCBpbiB0aGUgZGF0YWJhc2VcbiAgICAgICAgY29uc3Qgd2Vla1BsYW4gPSB3ZWVrcGxhblZhbHVlcy5maWx0ZXIod3AgPT5cbiAgICAgICAgICB3cC5kYXRlVGltZSA+PSBrZWRXZWVrLm5vdEJlZm9yZSAmJlxuICAgICAgICAgIHdwLmRhdGVUaW1lIDw9IGtlZFdlZWsubm90QWZ0ZXIgJiZcbiAgICAgICAgICAoIXdwLmlzRmluYWxTdGVwICYmXG4gICAgICAgICAgd3AudGVybSA9PT0gY3VycmVudFRlcm0gfHwgaW50bC5sb2NhbGUgPT09IFwic3ZcIikpWzBdO1xuXG4gICAgICAgIGNvbnN0IHR1dG9yTm90ZSA9IHR1dG9yVmFsdWVzLmZpbHRlcih3cCA9PiBcbiAgICAgICAgICB3cC5kYXRlVGltZSA+PSBrZWRXZWVrLm5vdEJlZm9yZSAmJlxuICAgICAgICAgIHdwLmRhdGVUaW1lIDw9IGtlZFdlZWsubm90QWZ0ZXIgJiZcbiAgICAgICAgICAod3AudGVybSA9PT0gY3VycmVudFRlcm0gfHwgaW50bC5sb2NhbGUgPT09IFwic3ZcIikpWzBdO1xuXG4gICAgICAgIHRoaXMud2Vla1BsYW5zT3JUdXRvck5vdGUucHVzaCh7XG4gICAgICAgICAgLi4ud2Vla1BsYW4gfHwge30sXG4gICAgICAgICAgaWQ6IHdlZWtQbGFuID8gd2Vla1BsYW4uaWQgOiBjcmVhdGVVVUlEKCksXG4gICAgICAgICAgZGF0ZVRpbWU6IHdlZWtQbGFuID8gd2Vla1BsYW4uZGF0ZVRpbWUgOiB3ZWVrTW9tZW50LnZhbHVlT2YoKSxcbiAgICAgICAgICBjZWxsVmFsdWVzOiB3ZWVrUGxhbiA/IHdlZWtQbGFuLmNlbGxWYWx1ZXMgOiB7fSxcbiAgICAgICAgICB3ZWVrTnVtYmVyLFxuICAgICAgICAgIGFjYWRlbWljV2Vla051bWJlcjogc3RhcnRBY2FkZW1pY1llYXJOdW1iZXIrKyxcbiAgICAgICAgICB0ZXJtOiBjdXJyZW50VGVybVxuICAgICAgICB9IGFzIEtTVGVybVBsYW5uZXJXZWVrUGxhbik7XG5cbiAgICAgICAgdGhpcy53ZWVrUGxhbnNPclR1dG9yTm90ZS5wdXNoKHtcbiAgICAgICAgICAuLi50dXRvck5vdGUgfHwge30sXG4gICAgICAgICAgaWQ6IHR1dG9yTm90ZSA/IHR1dG9yTm90ZS5pZCA6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICB0eXBlOiAndHV0b3Itbm90ZScsXG4gICAgICAgICAgZGF0ZVRpbWU6IHR1dG9yTm90ZSA/IHR1dG9yTm90ZS5kYXRlVGltZSA6IHdlZWtNb21lbnQudmFsdWVPZigpLFxuICAgICAgICAgIGNvbnRlbnQ6IHR1dG9yTm90ZSA/IHR1dG9yTm90ZS5jb250ZW50IDogJycsXG4gICAgICAgICAgd2Vla051bWJlcixcbiAgICAgICAgICB0ZXJtOiBjdXJyZW50VGVybSAgXG4gICAgICAgIH0gYXMgVGVybVBsYW5uZXJUdXRvck5vdGUpO1xuICAgICAgfVxuXG4gICAgICAvL1xuICAgICAgLy8gbGFzdFN0ZXBzXG4gICAgICAvL1xuICAgICAgY29uc3QgbGFzdFN0ZXBXZWVrID0gY3VycmVudFNjaG9vbFRlcm0uZ2V0TGFzdFN0ZXBXZWVrKGludGwubG9jYWxlKTtcbiAgICAgIGNvbnN0IGxhc3RTdGVwS2VkV2VlayA9IEtFRFdlZWsodGVybUVuZC55ZWFyKCksIGxhc3RTdGVwV2Vlayk7XG4gICAgICB0aGlzLmxhc3RTdGVwcyA9IHdlZWtwbGFuVmFsdWVzLmZpbHRlcih3cCA9PlxuICAgICAgICB3cC5kYXRlVGltZSA+PSBsYXN0U3RlcEtlZFdlZWsubm90QmVmb3JlICYmXG4gICAgICAgIHdwLmRhdGVUaW1lIDw9IGxhc3RTdGVwS2VkV2Vlay5ub3RBZnRlciAmJiBcbiAgICAgICAgKHdwLmlzRmluYWxTdGVwICYmXG4gICAgICAgIHdwLnRlcm0gPT09IGN1cnJlbnRUZXJtIHx8IGludGwubG9jYWxlID09PSBcInN2XCIpKVswXSB8fCB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICBkYXRlVGltZTogbW9tZW50KHRlcm1FbmQpLmNsb25lKCkud2VlayhsYXN0U3RlcFdlZWspLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCksXG4gICAgICAgICAgY2VsbFZhbHVlczoge30sXG4gICAgICAgICAgd2Vla051bWJlcjogbGFzdFN0ZXBXZWVrLFxuICAgICAgICAgIHRlcm06IGN1cnJlbnRUZXJtLFxuICAgICAgICAgIGlzRmluYWxTdGVwOiB0cnVlXG4gICAgICAgIH07XG5cblxuICAgICAgdGhpcy5jb21wbGV0ZWRTdGVwcyA9IHt9O1xuICAgICAgdGhpcy50ZXJtR29hbHMgPSB7fTtcbiAgICAgIHZhciBtYXhTdWJqZWN0U3RlcCA9IHt9O1xuICAgICAgZm9yIChjb25zdCBjb3Vyc2Ugb2YgY291cnNlcykge1xuICAgICAgICBjb25zdCBjb2x1bW5IZWFkZXIgPSBnZXRDb2x1bW5IZWFkZXJGcm9tQ291cnNlKGNvdXJzZSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIGNvbXBsZXRlZFN0ZXBzXG4gICAgICAgIC8vXG4gICAgICAgIGZvciAoY29uc3Qgc3RlcCBvZiBjb3Vyc2UuY291cnNlU3RlcHMpIHtcbiAgICAgICAgICBpZiAoc3RlcC5pc0NvbXBsZXRlZCkge1xuICAgICAgICAgICAgdGhpcy5jb21wbGV0ZWRTdGVwc1tjb2x1bW5IZWFkZXIgKyBzdGVwLnNob3J0TmFtZV0gPSB0cnVlO1xuXG4gICAgICAgICAgICAvL3NldCB0aGUgbWF4aW11bSB2YWx1ZSBvZiB0aGUgY29tcGxldGVkIHN0ZXAgZm9yIGVhY2ggc3ViamVjdFxuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGVwVmFsdWUgPSBwYXJzZUludChzdGVwLnNob3J0TmFtZSk7XG4gICAgICAgICAgICBpZiAoIWlzTmFOKGN1cnJlbnRTdGVwVmFsdWUpICYmIGN1cnJlbnRTdGVwVmFsdWUgPiAobWF4U3ViamVjdFN0ZXBbY29sdW1uSGVhZGVyXSA/IG1heFN1YmplY3RTdGVwW2NvbHVtbkhlYWRlcl0gOiAwKSkge1xuICAgICAgICAgICAgICBtYXhTdWJqZWN0U3RlcFtjb2x1bW5IZWFkZXJdID0gY3VycmVudFN0ZXBWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLypjb25zdCB3ZWVrUGxhbnMgPSBmaW5kV2Vla1BsYW5zQnlTdGVwKHRoaXMud2Vla1BsYW5zLCBzdGVwLlNob3J0TmFtZSk7XG4gICAgICAgICAgICB3ZWVrUGxhbnMuZm9yRWFjaCh3ZWVrUGxhbiA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZWRTdGVwc1t3ZWVrUGxhbi53ZWVrICsgY29sdW1uSGVhZGVyXSA9IHRydWU7XG4gICAgICAgICAgICB9KSovXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vXG4gICAgICAgIC8vIHRlcm1Hb2Fsc1xuICAgICAgICAvL1xuICAgICAgICB0aGlzLnRlcm1Hb2Fsc1tjb2x1bW5IZWFkZXJdID0gY291cnNlLnBlcmlvZEdvYWxHcmFkZTtcbiAgICAgIH1cblxuICAgICAgaWYoY291cnNlcykge1xuICAgICAgICAvL2luaXRcbiAgICAgICAgY29sdW1uSGVhZGVycy5mb3JFYWNoKGVsZW0gPT4ge1xuICAgICAgICAgIHRoaXMuc3ViamVjdFByb2dyZXNzW2VsZW1dID0ge2ZpbmFsU3RlcENvbXBsZXRlZDpmYWxzZSwgdmFsdWU6IDB9O1xuICAgICAgICB9KVxuICAgICAgICAvL2NvbXB1dGUgY2hhcnRzIGJ5IGNvbXB1dGluZyAgY29tcGxldGVkIGdvYWwgKHNhdmVkIGRhdGEgZnJvbSBrZWRiYWNrZW5kIGlzIG5vdCB0YWtlbiBpbnRvIGFjY291bnQpL2xhc3RTdGVwVmFsdWVcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5sYXN0U3RlcHMuY2VsbFZhbHVlcykuZm9yRWFjaCgodmFsKSA9PiB7XG4gICAgICAgICAgLy9leGNsdWRlIHRoZSBmaXhlZCBjb2x1bW5zLiBDaGFydHMgc2hvdWxkIG5vdCBiZSBkaXNwbGF5ZWQgZm9yIHRob3NlXG4gICAgICAgICAgaWYgKCFmaXhlZENvbHVtbnNbdmFsXSkge1xuICAgICAgICAgIHZhciBoYXNOb0ZpbmFsU3RlcFZhbHVlID0gaXNOYU4ocGFyc2VJbnQodGhpcy5sYXN0U3RlcHMuY2VsbFZhbHVlc1t2YWxdKSkgfHwgIXRoaXMubGFzdFN0ZXBzLmNlbGxWYWx1ZXNbdmFsXTtcbiAgICAgICAgICB2YXIgZmluYWxTdGVwVmFsdWUgPSBoYXNOb0ZpbmFsU3RlcFZhbHVlID8gMCA6IHBhcnNlSW50KHRoaXMubGFzdFN0ZXBzLmNlbGxWYWx1ZXNbdmFsXSk7XG4gICAgICAgICAgdmFyIHBlcmNlblZhbHVlID0gZmluYWxTdGVwVmFsdWUgPiAwID8gbWF4U3ViamVjdFN0ZXBbdmFsXSAqIDEwMCAvIGZpbmFsU3RlcFZhbHVlIDogMDtcbiAgICAgICAgICB0aGlzLnN1YmplY3RQcm9ncmVzc1t2YWxdID0ge2ZpbmFsU3RlcENvbXBsZXRlZDogIWhhc05vRmluYWxTdGVwVmFsdWUsIHZhbHVlOiBwZXJjZW5WYWx1ZX07XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZFdlZWtQbGFuc0J5U3RlcCh3ZWVrUGxhbnM6IEtTVGVybVBsYW5uZXJXZWVrUGxhbltdLCBzdGVwOiBzdHJpbmcpOiBLU1Rlcm1QbGFubmVyV2Vla1BsYW5bXSB7XG4gIHJldHVybiB3ZWVrUGxhbnMuZmlsdGVyKHdwID0+IE9iamVjdC5rZXlzKHdwLmNlbGxWYWx1ZXMpLm1hcChjb2x1bW4gPT4gd3AuY2VsbFZhbHVlc1tjb2x1bW5dID09PSBzdGVwKSk7XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgRURTQXNzZXNzbWVudCB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBsaW1pdD86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgbG9hZGluZzogYm9vbGVhbixcbiAgYXNzZXNzbWVudHM6IEVEU0Fzc2Vzc21lbnRbXSxcbiAgZXJyb3I6IHN0cmluZyB8IG51bGxcbn1cblxuZXhwb3J0IGNsYXNzIExhdGVzdEFzc2Vzc21lbnRzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGFzc2Vzc21lbnRzOiBbXSxcbiAgICAgIGVycm9yOiBudWxsLFxuICAgICAgbG9hZGluZzogZmFsc2VcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe2xvYWRpbmc6IHRydWV9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYXNzZXNzbWVudHMgPSBhd2FpdCBlbnYuZWRzQ2xpZW50LmdldExhdGVzdEFzc2Vzc21lbnRzKHRoaXMucHJvcHMubGltaXQpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7YXNzZXNzbWVudHN9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3J9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7bG9hZGluZzogZmFsc2V9KTsgICAgXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgaGFzR3JhZGVzID0gdGhpcy5zdGF0ZS5hc3Nlc3NtZW50cy5zb21lKGEgPT4gISFhLmdyYWRlTmFtZSk7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XG4gICAgICA8aDQ+e0xgU2VuYXN0ZSBiZWTDtm1uaW5nYXJgfTwvaDQ+XG4gICAgICA8aHIgLz5cbiAgICAgIDx1bCBjbGFzc05hbWU9XCJsYXRlc3QtYXNzZXNtZW50cyB6ZWJyYVwiPlxuICAgICAge3RoaXMuc3RhdGUuYXNzZXNzbWVudHMubWFwKChhLCBpKSA9PiBcbiAgICAgICAgICAgIDxsaSBrZXk9e2l9PlxuICAgICAgICAgICAgICB7KGhhc0dyYWRlcyAmJiAgYS5ncmFkZU5hbWUgIT0gXCJcIikgJiYgPHNwYW4gY2xhc3NOYW1lPVwiZ3JhZGUgcGlsbCBwdWxsLXJpZ2h0XCI+e2EuZ3JhZGVOYW1lfTwvc3Bhbj59XG4gICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImRhdGUgcGlsbCBwdWxsLWxlZnRcIj57YS5wdWJsaXNoRGF0ZVRpbWUuc3Vic3RyKDAsIDEwKX08L3NwYW4+XG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhLmNvdXJzZU5hbWUgPT0gYS5jb3Vyc2VVbml0TmFtZSA/IFxuICAgICAgICAgICAgICAgICAgPGg1PjxzdHJvbmc+e2EuY291cnNlTmFtZX08L3N0cm9uZz48L2g1PiA6IDxoNT48c3Ryb25nPnthLmNvdXJzZU5hbWV9PC9zdHJvbmc+IC8gPGVtPnthLmNvdXJzZVVuaXROYW1lfTwvZW0+PC9oNT5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgPHA+e2EudGV4dH08L3A+XG4gICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICl9XG4gICAgICA8L3VsPlxuICAgIDwvZGl2PjtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZ2V0TGVhcm5pbmdHb2Fsc0FuZFRhc2tzLCBLZWRMZWFybmluZ0dvYWxzRGF0YSB9IGZyb20gJy4uLy4uL2FwaXMva2VkLWxlYXJuaW5nZ29hbHMnO1xuaW1wb3J0IHsgTGVhcm5pbmdNb2R1bGVUYXNrLCBUYXNrTGlzdCB9IGZyb20gJy4uL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy90YXNrLWxpc3QnO1xuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IExlYXJuaW5nR29hbCwgTGVhcm5pbmdHb2Fsc0xpc3QgfSBmcm9tICcuLi9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvbGVhcm5pbmctZ29hbHMtbGlzdCc7XG5pbXBvcnQgeyBzZXR1cEludGwgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvU2V0dXBMYW5ndWFnZUludGwnO1xuaW1wb3J0IHsgaW5qZWN0SW50bCwgSW5qZWN0ZWRJbnRsUHJvcHMgfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuXG5pbnRlcmZhY2UgUHJvcHMgZXh0ZW5kcyBJbmplY3RlZEludGxQcm9wc3tcbiAgYXBpUGF0aDogc3RyaW5nOyAvLyBcIi80LjU2NjdjNjMxMTVlZDZjMDM3OTBhNGM4Yy8xMi4xZjk1YTY3YTE1ZWUzMWVhMWM0NDQ3YjIuanNvblwiXG4gIHBhZ2VJZDogc3RyaW5nOyAvLyBzdi5QYWdlQ29udGV4dC5wYWdlSWRcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgZGF0YTogS2VkTGVhcm5pbmdHb2Fsc0RhdGEgfCBudWxsXG59XG5cbmNsYXNzIF9MZWFybmluZ1Rhc2tzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGRhdGE6IG51bGxcbiAgICB9XG4gIH1cblxuICBhc3luYyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgZ2V0TGVhcm5pbmdHb2Fsc0FuZFRhc2tzKFxuICAgICAgdGhpcy5wcm9wcy5hcGlQYXRoLFxuICAgICAgdGhpcy5wcm9wcy5wYWdlSWQpO1xuXG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRhdGEgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXRlLmRhdGEpIHJldHVybiA8ZGl2PjwvZGl2PjtcbiAgICBjb25zdCB7IG1vZHVsZU5hbWUsIHN1YmplY3QsIGNvbW1vblRhc2tzLCBsZWFybmluZ0dvYWxzLCBzdGVwIH0gPSB0aGlzLnN0YXRlLmRhdGE7XG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5wcm9wcztcbiAgICAvL2NvbnN0IHN0ZXAgPSB1bmRlZmluZWQ7IC8vIG1vZHVsZU5hbWUudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKFwic3RlZyBcIikgJiYgcGFyc2VJbnQobW9kdWxlTmFtZS5zdWJzdHIoNSkpO1xuICAgIGNvbnN0IGNvbW1vblRhc2tzTGlzdDogTGVhcm5pbmdNb2R1bGVUYXNrW10gPVxuICAgICAgY29tbW9uVGFza3MubWFwKHRhc2sgPT4gKHtcbiAgICAgICAgaWQ6IHRhc2suaWQsXG4gICAgICAgIG5hbWU6IHRhc2submFtZSxcbiAgICAgICAgdXJsOiB0YXNrLnVybCxcbiAgICAgICAgY291cnNlTmFtZTogc3ViamVjdC5uYW1lLFxuICAgICAgICBsZWFybmluZ0dvYWw6IHN0ZXAgJiYgbGVhcm5pbmdHb2Fscy5sZW5ndGggPiAwID8gYCR7bW9kdWxlTmFtZX0gLSDDtnZlcmdyaXBhbmRlYCA6IG1vZHVsZU5hbWVcbiAgICAgIH0pKTtcbiAgICAgIFxuICAgIGNvbnN0IGxlYXJuaW5nR29hbHNMaXN0OiBMZWFybmluZ0dvYWxbXSA9IGxlYXJuaW5nR29hbHMubWFwKGxlYXJuaW5nR29hbCA9PiAoe1xuICAgICAgbmFtZTogbGVhcm5pbmdHb2FsLm5hbWUsXG4gICAgICBsZWFybmluZ1Rhc2tzOiBsZWFybmluZ0dvYWwudGFza3MubWFwKHRhc2sgPT4gKHtcbiAgICAgICAgaWQ6IHRhc2suaWQsXG4gICAgICAgIG5hbWU6IHRhc2submFtZSxcbiAgICAgICAgdXJsOiB0YXNrLnVybCxcbiAgICAgICAgY291cnNlTmFtZTogc3ViamVjdC5uYW1lLFxuICAgICAgICBsZWFybmluZ0dvYWw6IGxlYXJuaW5nR29hbC5uYW1lXG4gICAgICB9KSlcbiAgICB9KSk7XG5cbiAgICBpZiAoc3RlcCkge1xuICAgICAgY29tbW9uVGFza3NMaXN0LmZvckVhY2godGFzayA9PiB0YXNrLnN0ZXAgPSBzdGVwKTtcbiAgICAgIGxlYXJuaW5nR29hbHNMaXN0LmZvckVhY2gobGcgPT4gbGcubGVhcm5pbmdUYXNrcy5mb3JFYWNoKHRhc2sgPT4gdGFzay5zdGVwID0gc3RlcCkpO1xuICAgIH1cblxuICAgIHJldHVybiA8TGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt7IGludGwgfX0+XG4gICAgICA8TGVhcm5pbmdHb2Fsc0xpc3RcbiAgICAgICAgY29tbW9uVGFza3M9e2NvbW1vblRhc2tzTGlzdH1cbiAgICAgICAgbGVhcm5pbmdHb2Fscz17bGVhcm5pbmdHb2Fsc0xpc3R9IC8+XG4gICAgPC9MYW5ndWFnZUNvbnRleHQuUHJvdmlkZXI+XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IExlYXJuaW5nVGFza3MgPSBzZXR1cEludGwoaW5qZWN0SW50bChfTGVhcm5pbmdUYXNrcykpO1xuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ291cnNlLCBTY2hvb2wsIFVzZXJIaWRkZW5Db3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBzaG93RXJyb3IsIGZsYXR0ZW4sIGNvbXBhcmVQcm9wLCBzaG93SW5mbywgTCB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZyB9IGZyb20gXCIuLi8uLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vYWNjZXNzLWNvbnRyb2wvaW5kZXgnO1xuaW1wb3J0IHsgaGlkZGVuQ291cnNlc1JlcG8sIENvdXJzZVdpdGhIaWRkZW5TdGF0ZSB9IGZyb20gJy4uLy4uL3JlcG9zL2hpZGRlbi1jb3Vyc2VzLXJlcG8nO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBpc0xvYWRpbmc6IGJvb2xlYW5cbiAgY291cnNlczogQ291cnNlV2l0aEhpZGRlblN0YXRlW11cbiAgaGVhZGVyT3BlbjogYm9vbGVhblxufVxuXG5leHBvcnQgY2xhc3MgTGlzdENvdXJzZXMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0xvYWRpbmc6IHRydWUsXG4gICAgICBjb3Vyc2VzOiBbXSxcbiAgICAgIGhlYWRlck9wZW46IGZhbHNlXG4gICAgfTtcbiAgICB0aGlzLnVwZGF0ZUhpZGRlbkNvdXJzZXMgPSB0aGlzLnVwZGF0ZUhpZGRlbkNvdXJzZXMuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICBoaWRkZW5Db3Vyc2VzUmVwby5zdWJzY3JpYmUodGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzLCB7ZnVsbENvdXJzZTogdHJ1ZX0pO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgaGlkZGVuQ291cnNlc1JlcG8udW5zdWJzY3JpYmUodGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzKTtcbiAgfVxuXG4gIHVwZGF0ZUhpZGRlbkNvdXJzZXMoY291cnNlczogQ291cnNlV2l0aEhpZGRlblN0YXRlW10pIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjb3Vyc2VzLCBpc0xvYWRpbmc6IGZhbHNlfSk7XG4gIH1cblxuICBhc3luYyBoaWRlQ291cnNlKGNvdXJzZTogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XG4gICAgc2hvd0luZm8oTGBTcGFyYXIuLi5gKTtcbiAgICBhd2FpdCBoaWRkZW5Db3Vyc2VzUmVwby5oaWRlQ291cnNlKGNvdXJzZSk7XG4gICAgc2hvd0luZm8oXCJcIik7XG4gIH1cblxuICBhc3luYyBzaG93Q291cnNlKGNvdXJzZTogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XG4gICAgc2hvd0luZm8oTGBTcGFyYXIuLi5gKTtcbiAgICBhd2FpdCBoaWRkZW5Db3Vyc2VzUmVwby5zaG93Q291cnNlKGNvdXJzZSk7XG4gICAgc2hvd0luZm8oXCJcIik7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUuaXNMb2FkaW5nKSByZXR1cm4gPFNwaW5uZXIgLz47XG4gICAgY29uc3Qge2NvdXJzZXN9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB2aXNpYmxlQ291cnNlcyA9IGNvdXJzZXMuZmlsdGVyKGNvdXJzZSA9PiBjb3Vyc2UudmlzaWJsZSk7XG4gICAgY29uc3QgaGlkZGVuQ291cnNlcyA9IGNvdXJzZXMuZmlsdGVyKGNvdXJzZSA9PiAhY291cnNlLnZpc2libGUpO1xuICAgIGNvbnN0IHF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xuICAgIGNvbnN0IHZpZXdDb3Vyc2VVcmwgPSBjZmcuS0VEX0NPVVJTRV9WSUVXRVJfVVJMO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XG4gICAgICA8aDM+U2tvbGFucyBrdXJzZXI8L2gzPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyIG9kZC1ldmVuXCI+XG4gICAgICAgIHt2aXNpYmxlQ291cnNlcy5tYXAoY291cnNlID0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdHVkZW50Q291cnNlXCIga2V5PXtjb3Vyc2UuaWR9PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHB1bGwtcmlnaHRcIj5cbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJoaWRlSXRlbVwiIG9uQ2xpY2s9eygpID0+IHRoaXMuaGlkZUNvdXJzZShjb3Vyc2UpfSAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICA8YSBocmVmPXtwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSh2aWV3Q291cnNlVXJsLCB7Y291cnNlSWQ6IGNvdXJzZS5pZH0pfT57Y291cnNlLm5hbWV9PC9hPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic21hbGxcIj57Y291cnNlLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2Pil9XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkNsb3NlXCIgKyAodGhpcy5zdGF0ZS5oZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XG4gICAgICAgICAgPGg1PkRvbGRhIGt1cnNlcjwvaDU+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5Db250ZW50XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyIG9kZC1ldmVuXCI+XG4gICAgICAgICAgICB7aGlkZGVuQ291cnNlcy5tYXAoY291cnNlID0+IFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdHVkZW50Q291cnNlXCIga2V5PXtjb3Vyc2UuaWR9PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBwdWxsLXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJzaG93SXRlbVwiIG9uQ2xpY2s9eygpID0+IHRoaXMuc2hvd0NvdXJzZShjb3Vyc2UpfT48L2E+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGEgaHJlZj17Z2VuZXJhdGVRdWVyeVN0cmluZyh7Li4ucXVlcnksIGNvdXJzZUlkOiBjb3Vyc2UuaWR9KX0+e2NvdXJzZS5uYW1lfTwvYT5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic21hbGxcIj57Y291cnNlLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDb3Vyc2UsIFVzZXJIaWRkZW5Db3Vyc2UsIFNjaG9vbCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGhpZGRlbkNvdXJzZXNSZXBvLCBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUgfSBmcm9tICcuLi8uLi9yZXBvcy9oaWRkZW4tY291cnNlcy1yZXBvJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IGZsYXR0ZW4sIGNvbXBhcmVQcm9wLCBhcnJheVRvTWFwLCBhcnJheVRvTG9va3VwIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgfSBmcm9tICcuLi8uLi9hY2Nlc3MtY29udHJvbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvcHMge1xuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGUge1xuICBjb3Vyc2VzOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXTtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBlcnJvcj86IEVycm9yO1xufVxuXG5leHBvcnQgY2xhc3MgTXlDb3Vyc2VzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNvdXJzZXM6IFtdLFxuICAgICAgaXNMb2FkaW5nOiB0cnVlXG4gICAgfVxuICAgIHRoaXMudXBkYXRlSGlkZGVuQ291cnNlc1N0YXRlID0gdGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzU3RhdGUuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGhpZGRlbkNvdXJzZXNSZXBvLnN1YnNjcmliZSh0aGlzLnVwZGF0ZUhpZGRlbkNvdXJzZXNTdGF0ZSwge2Z1bGxDb3Vyc2U6IGZhbHNlfSk7XG4gIH1cblxuICB1cGRhdGVIaWRkZW5Db3Vyc2VzU3RhdGUoY291cnNlczogQ291cnNlV2l0aEhpZGRlblN0YXRlW10pIHtcbiAgICB0aGlzLnNldFN0YXRlKHtjb3Vyc2VzLCBpc0xvYWRpbmc6IGZhbHNlfSk7XG4gIH1cblxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIGhpZGRlbkNvdXJzZXNSZXBvLnVuc3Vic2NyaWJlKHRoaXMudXBkYXRlSGlkZGVuQ291cnNlc1N0YXRlKTtcbiAgfVxuXG4gIGdldENvdXJzZVVybChjb3Vyc2VJZDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KHRoaXMucHJvcHMudmlld0NvdXJzZVVybCwgeyBjb3Vyc2VJZCB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7dmlld0NvdXJzZVVybH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtpc0xvYWRpbmcsIGVycm9yLCBjb3Vyc2VzIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHZpc2libGVDb3Vyc2VzID0gdGhpcy5zdGF0ZS5jb3Vyc2VzLmZpbHRlcihjID0+IGMudmlzaWJsZSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPD5cbiAgICAgICAge2lzTG9hZGluZyA/IChcbiAgICAgICAgICA8bGkgY2xhc3NOYW1lPVwibHZsMiBoZWFkZXJcIj5cbiAgICAgICAgICAgIDxhPkxhZGRhci4uLjwvYT5cbiAgICAgICAgICA8L2xpPlxuICAgICAgICApIDogZXJyb3IgPyAoXG4gICAgICAgICAgPGxpIGNsYXNzTmFtZT1cImx2MTJcIj5cbiAgICAgICAgICAgIDxhPkt1bmRlIGludGUgbGFkZGEga3Vyc2VyLjwvYT5cbiAgICAgICAgICA8L2xpPlxuICAgICAgICAgKSA6IChcbiAgICAgICAgICB2aXNpYmxlQ291cnNlcy5tYXAoKHtuYW1lLCBpZH0pID0+IChcbiAgICAgICAgICAgIDxsaSBrZXk9e2lkfSBjbGFzc05hbWU9XCJsdmwyXCI+XG4gICAgICAgICAgICAgIDxhIGhyZWY9e3RoaXMuZ2V0Q291cnNlVXJsKGlkKX0+e25hbWV9PC9hPlxuICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICApXG4gICAgICAgICkpXG4gICAgICAgIH1cblx0XHRcdDwvPlxuICAgICk7XG4gIH1cbn0iLCJpbXBvcnQgeyBlbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgZGIgfSBmcm9tICcuLi8uLi9nbG9iYWxzL2RiJztcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3BzIHtcbiAgICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XG4gIH1cblxuZXhwb3J0IGZ1bmN0aW9uIE15U3ViamVjdHNJbm5lcih7dmlld0NvdXJzZVVybH06IFByb3BzKSB7XG4gICAgY29uc3Qgc2Nob29sR3JhZGUgPSBlbnYuY3VycmVudFVzZXIuc2Nob29sR3JhZGU7XG4gICAgY29uc3QgaXNQcmltYXJ5U2Nob29sU3R1ZGVudCA9ICgnJytlbnYuY3VycmVudFVzZXIuc2Nob29sVHlwZSkudG9Mb3dlckNhc2UoKSAhPT0gXCJneW1uYXNpdW1cIjtcblxuICAgIGNvbnN0IHRhcmdldENvdXJzZXMgPSBzY2hvb2xHcmFkZSAmJiBpc1ByaW1hcnlTY2hvb2xTdHVkZW50ICYmIGRiLmNvdXJzZXMudGFncyhgZ3JhZGU6JHtzY2hvb2xHcmFkZX1gKS5pZHNBbmROYW1lc09ubHkoKS50b1ZhbHVlKCkucmVhZCgpO1xuICAgIHJldHVybiA8PnsgXG4gICAgICA8PlxuICAgICAgeyF0YXJnZXRDb3Vyc2VzIHx8IHRhcmdldENvdXJzZXMubGVuZ3RoID09PSAwID8gICAgICAgICAgIFxuICAgICAgICA8bGkgY2xhc3NOYW1lPVwibHZsMiBoZWFkZXJcIj5cbiAgICAgICAgICAgIDxhPkt1bmRlIGludGUgbGFkZGEga3Vyc2VyLjwvYT5cbiAgICAgICAgPC9saT4gOlxuICAgICAgICB0YXJnZXRDb3Vyc2VzLm1hcChjb3Vyc2UgPT4ge1xuICAgICAgICByZXR1cm4gPGxpIGtleT17Y291cnNlLmlkfSBjbGFzc05hbWU9XCJsdmwyXCI+XG4gICAgICAgICAgPGEgaHJlZj17cHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkodmlld0NvdXJzZVVybCwgeyBjb3Vyc2VJZDogY291cnNlLmlkfSApfT57Y291cnNlLm5hbWV9PC9hPlxuICAgICAgICA8L2xpPlxuICAgICAgICB9KX1cbiAgICAgIDwvPlxuICAgIH1cbiAgICA8Lz5cbiAgfVxuICBcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEVsbGlwc2lzTG9hZGVyIH0gZnJvbSAnLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvZWxsaXBzaXMtbG9hZGVyJztcbmltcG9ydCB7IE9ic2VydmUgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvb2JzZXJ2ZSc7XG5pbXBvcnQgeyBNeVN1YmplY3RzSW5uZXIgfSBmcm9tICcuL215LXN1YmplY3RzLWlubmVyJztcblxuZXhwb3J0IGludGVyZmFjZSBQcm9wcyB7XG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIE15U3ViamVjdHMoeyB2aWV3Q291cnNlVXJsIH06IFByb3BzKSB7XG4gIHJldHVybiAoPE9ic2VydmUgZmFsbGJhY2s9ezxFbGxpcHNpc0xvYWRlciAvPn0+XG4gICAgPE15U3ViamVjdHNJbm5lciB2aWV3Q291cnNlVXJsPXt2aWV3Q291cnNlVXJsfSAvPlxuICA8L09ic2VydmU+KVxufSIsImltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBFRFNTdHVkZW50IH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2Vkcyc7XG5pbXBvcnQgeyBjb21wYXJlUHJvcHMgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XG5pbXBvcnQgdHV0b3JFbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQudHV0b3JFbnYnO1xuaW1wb3J0IHtyZXF1ZXN0VHV0b3JlZFRva2Vuc30gZnJvbSAnLi4vLi4vdXRpbHMvcmVxdWVzdC10dXRvcmVkLXRva2Vucyc7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuXG5pbnRlcmZhY2UgU3R1ZGVudEluZm8ge1xuICBtYWlsOiBzdHJpbmc7XG4gIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBQcm9wcyB7XG5cbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBzdHVkZW50czogU3R1ZGVudEluZm9bXTtcbn1cblxuZXhwb3J0IGNsYXNzIFR1dG9yc1NlbGVjdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcblxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0xvYWRpbmc6IHRydWUsXG4gICAgICBzdHVkZW50czogW11cbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB0aGlzLmxvYWQoKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGVkc1N0dWRlbnRzID0gYXdhaXQgZW52LmVkc0NsaWVudC5nZXRUZWFjaGVyVHV0b3JTdHVkZW50cygpO1xuICAgICAgZWRzU3R1ZGVudHMuc29ydChjb21wYXJlUHJvcHMoW1wibGFzdE5hbWVcIiwgXCJmaXJzdE5hbWVcIl0pKTtcbiAgICAgIGNvbnN0IHN0dWRlbnRzID0gZWRzU3R1ZGVudHMubGVuZ3RoID4gMCA/XG4gICAgICAgIGVkc1N0dWRlbnRzLm1hcCgoe2VtYWlsLCBmaXJzdE5hbWUsIGxhc3ROYW1lfSk9Pih7XG4gICAgICAgICAgbWFpbDogZW1haWwsXG4gICAgICAgICAgZGlzcGxheU5hbWU6IGAke2ZpcnN0TmFtZX0gJHtsYXN0TmFtZX1gXG4gICAgICAgIH0pKSA6XG4gICAgICAgIFtlbnYuY3VycmVudFVzZXJdO1xuICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSh7c3R1ZGVudHN9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkIG5vdCBsaXN0IHR1dG9yIHN0dWRlbnRzXCIsIGVycm9yKTtcbiAgICAgIGF3YWl0IHRoaXMuc2V0U3RhdGUoe3N0dWRlbnRzOiBbZW52LmN1cnJlbnRVc2VyXX0pXG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2lzTG9hZGluZzogZmFsc2V9KTtcbiAgICB9XG4gIH1cblxuICBvblNlbGVjdFVzZXIoZW1haWw6IHN0cmluZykge1xuICAgIGNvbnN0IGNob29zZW5TdHVkZW50ID0gdGhpcy5zdGF0ZS5zdHVkZW50cy5maWx0ZXIocyA9PiBzLm1haWwgPT09IGVtYWlsKVswXTtcbiAgICBjb25zdCB1c2VyOiBVc2VyID0ge1xuICAgICAgLi4uY2hvb3NlblN0dWRlbnQsXG4gICAgICByb2xlczogW1wiVVNFUlwiXSxcblxuICAgIH1cbiAgICBcbiAgICB0dXRvckVudi5zZXROZXdFbnYodXNlciwgKCk9PnJlcXVlc3RUdXRvcmVkVG9rZW5zKGVtYWlsLCBlbWFpbCkpXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2lzTG9hZGluZywgc3R1ZGVudHN9ID0gdGhpcy5zdGF0ZTtcbiAgICBpZiAoaXNMb2FkaW5nKSByZXR1cm4gPFNwaW5uZXIgLz47XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ0dXRvcnMtc2VsZWN0XCI+XG4gICAgICA8c2VsZWN0IG9uQ2hhbmdlPXtldiA9PiBldi50YXJnZXQudmFsdWUgJiYgdGhpcy5vblNlbGVjdFVzZXIoZXYudGFyZ2V0LnZhbHVlKX0+XG4gICAgICAgIDxvcHRpb24gdmFsdWU9XCJcIj5Ww6RsaiBlbGV2PC9vcHRpb24+XG4gICAgICAgIHtzdHVkZW50cy5tYXAoc3R1ZGVudCA9PlxuICAgICAgICAgIDxvcHRpb24ga2V5PXtzdHVkZW50Lm1haWx9IHZhbHVlPXtzdHVkZW50Lm1haWx9PlxuICAgICAgICAgICAge3N0dWRlbnQuZGlzcGxheU5hbWV9ICh7c3R1ZGVudC5tYWlsfSlcbiAgICAgICAgICA8L29wdGlvbj4pfVxuICAgICAgPC9zZWxlY3Q+XG4gICAgPC9kaXY+O1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5leHBvcnQgY29uc3QgTGFuZ3VhZ2VDb250ZXh0ID0gUmVhY3QuY3JlYXRlQ29udGV4dCh7aW50bDogbnVsbH0pOyIsImltcG9ydCB7SW50bFByb3ZpZGVyLCBhZGRMb2NhbGVEYXRhfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCBsb2NhbGVfZW4gZnJvbSAncmVhY3QtaW50bC9sb2NhbGUtZGF0YS9lbic7XG5pbXBvcnQgbG9jYWxlX3N2IGZyb20gJ3JlYWN0LWludGwvbG9jYWxlLWRhdGEvc3YnO1xuaW1wb3J0IG1lc3NhZ2VzX3N2IGZyb20gXCIuLi8uLi90cmFuc2xhdGlvbnMvc3YuanNvblwiO1xuaW1wb3J0IG1lc3NhZ2VzX2VuIGZyb20gXCIuLi8uLi90cmFuc2xhdGlvbnMvZW4uanNvblwiO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNmZyBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5jZmcnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG5leHBvcnQgY29uc3Qgc2V0dXBJbnRsID0gPFAgZXh0ZW5kcyBvYmplY3Q+KENvbXBvbmVudDogUmVhY3QuQ29tcG9uZW50VHlwZTxQPikgPT5cbiAgICBjbGFzcyBfU2V0dXBMYW5ndWFnZUludGwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UD57XG4gICAgICAgIG1lc3NhZ2VzIDogb2JqZWN0O1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHByb3BzKXtcbiAgICAgICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgICAgIGFkZExvY2FsZURhdGEoWy4uLmxvY2FsZV9lbiwuLi5sb2NhbGVfc3ZdKTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSB7XG4gICAgICAgICAgICAnc3YnOiBtZXNzYWdlc19zdixcbiAgICAgICAgICAgICdlbic6IG1lc3NhZ2VzX2VuXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbW9tZW50KCkubG9jYWxlKGNmZy5LRURfTE9DQUxFKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlbmRlcigpe1xuICAgICAgICAgICAgcmV0dXJuIDxJbnRsUHJvdmlkZXIgbG9jYWxlPXtjZmcuS0VEX0xPQ0FMRX0gbWVzc2FnZXM9e3RoaXMubWVzc2FnZXNbY2ZnLktFRF9MT0NBTEVdfT5cbiAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi50aGlzLnByb3BzIGFzIFB9IC8+XG4gICAgICAgICAgICA8L0ludGxQcm92aWRlcj5cbiAgICAgICAgfVxuICAgIH0iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBzdGF0ZTogc3RyaW5nO1xuICBvbkNsaWNrPzogKCkgPT4gdm9pZDtcbiAgbGFiZWw6IEpTWC5FbGVtZW50IHwgc3RyaW5nO1xuICBvbkNoYW5nZT86ICgpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBjb25zdCBVSUNoZWNrYm94ID0gKHtzdGF0ZSwgb25DbGljaywgbGFiZWwsIG9uQ2hhbmdlfTpQcm9wcykgPT4ge1xuICAgIHJldHVybiA8bGFiZWwgY2xhc3NOYW1lPSd1aS1jaGVja2JveCc+XG4gICAgICB7bGFiZWx9XG4gICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgY2hlY2tlZD17c3RhdGU9PVwiY2hlY2tlZFwifSBvbkNsaWNrPXtvbkNsaWNrfSAvPlxuICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiY3VzdG9tLWVsZW1lbnRcIj48L3NwYW4+XG4gICAgPC9sYWJlbD5cbiAgfVxuXG5leHBvcnQgY29uc3QgVUlBZGRib3ggPSAoe3N0YXRlLCBvbkNsaWNrPSgpPT5udWxsLCBsYWJlbCwgb25DaGFuZ2U9KCk9Pm51bGx9OlByb3BzKSA9PiB7XG4gIHJldHVybiA8bGFiZWwgY2xhc3NOYW1lPSd1aS1hZGRib3gnPlxuICAgIHtsYWJlbH1cbiAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQ9e3N0YXRlPT1cImNoZWNrZWRcIn0gb25DbGljaz17b25DbGlja30gb25DaGFuZ2U9e29uQ2hhbmdlfSAvPlxuICA8c3BhbiBjbGFzc05hbWU9XCJjdXN0b20tZWxlbWVudFwiPjwvc3Bhbj5cbjwvbGFiZWw+XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbnRlcmZhY2UgQ0VQcm9wcyB7XG4gICAgdGV4dDogc3RyaW5nOyAvLyBUZXh0IHRvIGJlIHNob3duIGluIGZpZWxkXG4gICAgdGFnPzogJ3RkJyB8ICd0aCcgfCAnZGl2JyB8ICdzcGFuJyB8ICdwJyB8ICdoMScgfCAnaDInIHwgJ2gzJzsgLy8gYWxsb3dkIHRhZ3MgLS0gc2hvdWxkIHdlIGFkZCBtb3JlP1xuICAgIG9uQ2hhbmdlOiAobmV3TmFtZTogc3RyaW5nKSA9PiB2b2lkO1xuICAgIHBsYWNlaG9sZGVyPzogc3RyaW5nOyAvLyBJZiB0ZXh0IGlzIGVtcHR5LCB0aGlzIHdpbGwgYmUgdGhlIHBsYWNlaG9sZGVyXG4gICAgbWF4Q2hhcnM/OiBudW1iZXI7XG4gICAgcmVhZE9ubHk/OiBib29sZWFuO1xuICAgIGNsYXNzTmFtZT86IHN0cmluZztcbiAgICBwbGFjZUhvbGRlcj86IHN0cmluZztcblxuICAgIHZhbGlkYXRlVmFsdWU/OiBSZWdFeHA7XG5cbiAgICAvLyBGb3IgbmF2aWdhdGlvblxuICAgIGFsbG93TmF2aWdhdGlvbj86IGJvb2xlYW47IC8vIHRvIGFjdGl2YXRlIG5hdmlnYXRpb25cbiAgICBvbk5hdmlnYXRlPzogKGRpcmVjdGlvbjogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQ29udGVudEVkaXRhYmxlRmllbGQgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PENFUHJvcHM+IHtcbiAgICBteXNlbGY6IFJlYWN0LlJlZk9iamVjdDxhbnk+O1xuICAgIHByb3BhZ2F0ZWRPbkNoYW5nZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IENFUHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLm15c2VsZiA9IFJlYWN0LmNyZWF0ZVJlZjxIVE1MRWxlbWVudD4oKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIHRleHQ6IHByb3BzLnRleHQgfHwgJydcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3Qge3RhZywgdGV4dCwgcmVhZE9ubHl9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgVGFnVHlwZSA9IHRhZztcbiAgICAgICAgcmV0dXJuIDxUYWdUeXBlXG4gICAgICAgICAgICBjb250ZW50RWRpdGFibGU9eyFyZWFkT25seX1cbiAgICAgICAgICAgIGRhdGEtcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9XG4gICAgICAgICAgICByZWY9e3RoaXMubXlzZWxmfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXt0aGlzLnByb3BzLmNsYXNzTmFtZX1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICBvbktleURvd249e3RoaXMub25LZXlEb3duLmJpbmQodGhpcyl9XG4gICAgICAgICAgICBvbktleVVwPXt0aGlzLm9uS2V5VXAuYmluZCh0aGlzKX1cbiAgICAgICAgICAgIG9uQmx1cj17dGhpcy5vbkJsdXIuYmluZCh0aGlzKX1cbiAgICAgICAgICAgIG9uUGFzdGU9e3RoaXMub25QYXN0ZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRleHR9fSAvPlxuICAgIH1cblxuICAgIG9uQ2hhbmdlKGU6IEV2ZW50KSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0ZXh0OiB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dCB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlIGFjdGlvbiBkZXBlbmRpbmcgb24ga2V5LWV2ZW50XG4gICAgICogQHBhcmFtIGUgZXZlbnQgZnJvbSBmaWVsZFxuICAgICAqIFxuICAgICAqIElmIGFsbG93TmF2aWdhdGlvbiB0aGVuIGxpc3RlbiB0byBhcnJvdy1rZXlzXG4gICAgICogTGltaXRzIHRvIG1heENoYXJzXG4gICAgICovXG4gICAgb25LZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMubXlzZWxmLmN1cnJlbnQuaW5uZXJUZXh0O1xuICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dCA9IHRoaXMucHJvcHMudGV4dCB8fCBcIlwiO1xuICAgICAgICAgICAgdGhpcy5teXNlbGYuY3VycmVudC5ibHVyKCk7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9IGVsc2UgaWYoZS5rZXkgPT09ICdFbnRlcicpe1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZSh0ZXh0LCAnZG93bicpO1xuICAgICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnVGFiJykge1xuICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGVPbkNoYW5nZSh0ZXh0KTtcbiAgICAgICAgfSAgZWxzZSBpZih0ZXh0Lmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heENoYXJzICYmIChcbiAgICAgICAgICAgIC9eW1xcZFxcd1xcc10kLy50ZXN0KGUua2V5KSAmJiAhKGUubWV0YUtleSB8fCBlLmN0cmxLZXkpXG4gICAgICAgICkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9wcy5hbGxvd05hdmlnYXRpb24gPT09IHRydWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hdkRpciA9IGUua2V5LnN0YXJ0c1dpdGgoJ0Fycm93JykgPyBlLmtleS5yZXBsYWNlKCdBcnJvdycsICcnKS50b0xvd2VyQ2FzZSgpIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCBjYXJldCA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpLmdldFJhbmdlQXQoMCkuZW5kT2Zmc2V0OyAvLyBvbmx5IHdvcmtzIGZvciBwbGFpbnRleHRcbiAgICAgICAgICAgIGlmIChuYXZEaXIgJiYgdGV4dC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGUodGV4dCwgbmF2RGlyKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmF2RGlyICYmIChuYXZEaXIgPT0gJ3VwJyB8fCBuYXZEaXIgPT0gJ2Rvd24nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGUodGV4dCwgbmF2RGlyKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmF2RGlyICYmIChcbiAgICAgICAgICAgICAgICAobmF2RGlyID09ICdsZWZ0JyAmJiBjYXJldCA9PSAwKSB8fFxuICAgICAgICAgICAgICAgIChuYXZEaXIgPT0gJ3JpZ2h0JyAmJiBjYXJldCA9PSB0ZXh0Lmxlbmd0aClcbiAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlKHRleHQsIG5hdkRpcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZSBldmVudCBmcm9tIGZpZWxkXG4gICAgICogU29sZWx5IHVzZWQgdG8gaGFuZGUgdmFsaWRhdGlvbnMtaXNzdWVzXG4gICAgICovXG4gICAgb25LZXlVcChlOiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dDtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMudmFsaWRhdGVWYWx1ZSAhPT0gdW5kZWZpbmVkICYmICF0aGlzLnByb3BzLnZhbGlkYXRlVmFsdWUudGVzdCh0ZXh0KSkge1xuICAgICAgICAgICAgdGhpcy5teXNlbGYuY3VycmVudC5pbm5lclRleHQgPSB0aGlzLnByb3BzLnRleHQgfHwgXCJcIjtcbiAgICAgICAgICAgIHRoaXMubXlzZWxmLmN1cnJlbnQuYmx1cigpO1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHZhbHVlIGFuZCBwYXNzIHRvIHBhcmVudHMgbmF2aWdhdGUtZnVuY2l0b25cbiAgICAgKiBAcGFyYW0gdGV4dCBcbiAgICAgKiBAcGFyYW0gZGlyZWN0aW9uIFxuICAgICAqL1xuICAgIG5hdmlnYXRlKHRleHQ6IHN0cmluZywgZGlyZWN0aW9uOiBzdHJpbmcpIHtcbiAgICAgICAgLy8gZmlyc3QgdXBkYXRlIGNlbGxcbiAgICAgICAgdGhpcy5wcm9wYWdhdGVPbkNoYW5nZSh0ZXh0KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRleHQ6IHRleHR9ICk7XG4gICAgICAgIC8vIHRoZW4gbmF2aWdhdGUgYXdheVxuICAgICAgICB0aGlzLnByb3BzLm9uTmF2aWdhdGUoZGlyZWN0aW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNYWtlIHN1cmUgcGFzdGVkIHRleHQgaXMgcHVyZSB0ZXh0XG4gICAgICogQHBhcmFtIGUgdGhlIHBhc2V0IGV2ZW50XG4gICAgICovXG4gICAgb25QYXN0ZShlOiBDbGlwYm9hcmRFdmVudCkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRleHQgPSAoZS5jbGlwYm9hcmREYXRhICYmIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKT8gIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSA6ICcnO1xuICAgICAgICBkb2N1bWVudC5leGVjQ29tbWFuZChcImluc2VydEhUTUxcIiwgZmFsc2UsIHRleHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB2YWx1ZSBvbiBleGl0IGZyb20gZmllbGRcbiAgICAgKiBAcGFyYW0gZSBcbiAgICAgKi9cbiAgICBvbkJsdXIoZTogRXZlbnQpIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMubXlzZWxmLmN1cnJlbnQuaW5uZXJUZXh0O1xuICAgICAgICB0aGlzLnByb3BhZ2F0ZU9uQ2hhbmdlKHRleHQpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdGV4dDogdGV4dCB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPbmx5IHVwZGF0ZSB2YWx1ZSBpZiBpdCBoYXMgY2hhbmdlZFxuICAgICAqIEBwYXJhbSBuZXdWYWx1ZSBcbiAgICAgKi9cbiAgICBwcm9wYWdhdGVPbkNoYW5nZShuZXdWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5wcm9wYWdhdGVkT25DaGFuZ2UgIT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMucHJvcGFnYXRlZE9uQ2hhbmdlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBSZW1vdmVJdGVtIH0gZnJvbSAnLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0nO1xuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgZGlhbG9nczogUmVhY3QuQ29tcG9uZW50W107XG4gIHBvcERpYWxvZzogKCk9PnZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIGxhc3REaXY6IEhUTUxEaXZFbGVtZW50IHwgbnVsbDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBQcm9wcykge1xuICAgIGlmICh0aGlzLmxhc3REaXYgIT09IG51bGwgJiYgcHJldlByb3BzLmRpYWxvZ3MubGVuZ3RoID4gdGhpcy5wcm9wcy5kaWFsb2dzLmxlbmd0aCkge1xuICAgICAgLy8gQSBkaWFsb2cgd2FzIGNsb3NlZC4gTm93IGZvY3VzIHRoZSBsYXN0IGRpYWxvZzpcbiAgICAgICQoZmluZERPTU5vZGUodGhpcy5sYXN0RGl2KSkuZmluZCgnOmlucHV0JykuZmlyc3QoKS5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlciAoKSB7XG4gICAgdGhpcy5sYXN0RGl2ID0gbnVsbDtcbiAgICBjb25zdCB7ZGlhbG9ncywgcG9wRGlhbG9nfSA9IHRoaXMucHJvcHM7XG4gICAgJCgnYm9keScpLmF0dHIoJ2FyaWEtZGlzYWJsZWQnLCBkaWFsb2dzLmxlbmd0aCA+IDApO1xuICAgICQoJ2JvZHknKS5jc3MoJ292ZXJmbG93JywgZGlhbG9ncy5sZW5ndGggPiAwID8gJ2hpZGRlbicgOiAnYXV0bycpO1xuXG4gICAgcmV0dXJuIGRpYWxvZ3MubGVuZ3RoID4gMCAmJiA8ZGl2PlxuICAgICAge2RpYWxvZ3MubWFwKChkaWFsb2csIGlkeCkgPT4ge1xuICAgICAgICBsZXQgZGl2OiBIVE1MRGl2RWxlbWVudDtcbiAgICAgICAgZnVuY3Rpb24gb25LZXlQcmVzcyhldjogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDEzICYmICghZXYudGFyZ2V0IHx8IChldi50YXJnZXQgYXMgSFRNTEVsZW1lbnQpLnRhZ05hbWUgIT09ICdURVhUQVJFQScpKSB7XG4gICAgICAgICAgICAkKGZpbmRET01Ob2RlKGRpdikpLmZpbmQoJy5idG4tZGVmYXVsdCcpLmNsaWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIG9uS2V5RG93bihldikge1xuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gMjcpIHsgLy8gRXNjYXBlXG4gICAgICAgICAgICBwb3BEaWFsb2coKTtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDgzICYmIChldi5jdHJsS2V5IHx8IGV2Lm1ldGFLZXkpKSB7IC8vIENUUkwtU1xuICAgICAgICAgICAgY29uc3QgZG9tTm9kZSA9IGZpbmRET01Ob2RlKGRpdik7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgY29uc3QgZGVmYXVsdEJ1dHRvbiA9ICQoZG9tTm9kZSkuZmluZCgnLmJ0bi1kZWZhdWx0Jyk7XG4gICAgICAgICAgICBkZWZhdWx0QnV0dG9uLmNsaWNrKCk7XG4gICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDxkaXYga2V5PXtpZHh9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkYXJrZW5cIiAvPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlLXdyYXBcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlXCIgcmVmPXtlbGVtID0+IHtcbiAgICAgICAgICBkaXYgPSBlbGVtO1xuICAgICAgICAgIGlmIChpZHggPT09IGRpYWxvZ3MubGVuZ3RoIC0gMSkgdGhpcy5sYXN0RGl2ID0gZWxlbTtcbiAgICAgICAgfX1cbiAgICAgICAgICAgIHRhYkluZGV4PXswfVxuICAgICAgICAgICAgYXJpYS1kaXNhYmxlZD17aWR4IDwgZGlhbG9ncy5sZW5ndGggLSAxfVxuICAgICAgICAgICAgb25LZXlQcmVzcz17b25LZXlQcmVzc31cbiAgICAgICAgICAgIG9uS2V5RG93bj17b25LZXlEb3dufT5cbiAgICAgICAgICB7ZGlhbG9nfVxuICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9e3BvcERpYWxvZ30gLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0b3BGbG9hdHNcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj59KX1cbiAgPC9kaXY+O1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBGb3JtRmllbGQgfSBmcm9tICcuL2Zvcm0tZmllbGQnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBsYWJlbDogYW55O1xuICBpZDogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xuICBwbGFjZWhvbGRlcj86IHN0cmluZztcbiAgYXV0b0ZvY3VzPzogYm9vbGVhbjtcbiAgb25DaGFuZ2U6ICh2YWx1ZTogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgVGV4dElucHV0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGb3JtRmllbGQgbGFiZWw9e3RoaXMucHJvcHMubGFiZWx9PlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzPXt0aGlzLnByb3BzLmF1dG9Gb2N1c30gaWQ9e3RoaXMucHJvcHMuaWR9IHNpemU9ezM1fSB2YWx1ZT17dGhpcy5wcm9wcy52YWx1ZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMucHJvcHMub25DaGFuZ2UoZXYudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICA8L0Zvcm1GaWVsZD5cbiAgICApO1xuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4vZm9ybS1maWVsZCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxhYmVsOiBhbnk7XG4gIGlkOiBzdHJpbmc7XG4gIHZhbHVlOiBzdHJpbmc7XG4gIHBsYWNlaG9sZGVyPzogc3RyaW5nO1xuICBhdXRvRm9jdXM/OiBib29sZWFuO1xuICByb3dzPzogbnVtYmVyO1xuICBjaGlsZHJlbj87XG4gIG9uQ2hhbmdlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIFRleHRBcmVhRm9ybUZpZWxkIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxGb3JtRmllbGQgbGFiZWw9e3RoaXMucHJvcHMubGFiZWx9IGlkPXt0aGlzLnByb3BzLmlkfT5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgIDx0ZXh0YXJlYSBhdXRvRm9jdXM9e3RoaXMucHJvcHMuYXV0b0ZvY3VzfSBpZD17dGhpcy5wcm9wcy5pZH0gY29scz17MzV9IHJvd3M9e3RoaXMucHJvcHMucm93cyB8fCA1fSB2YWx1ZT17dGhpcy5wcm9wcy52YWx1ZX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMucHJvcHMub25DaGFuZ2UoZXYudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgeyEhdGhpcy5wcm9wcy5jaGlsZHJlbiAmJiA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XG4gICAgICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cbiAgICAgICAgICA8L2Rpdj59XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9Gb3JtRmllbGQ+XG4gICAgKTtcbiAgfVxufVxuXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxhYmVsOiBhbnk7XG4gIGNoaWxkcmVuOiBhbnk7XG4gIGlkPzogc3RyaW5nO1xufVxuXG5mdW5jdGlvbiBmaW5kSWQobm9kZSkge1xuICBjb25zdCByZWN1Y2hlY2sgPSBuZXcgU2V0KCk7XG4gIHJldHVybiAoZnVuY3Rpb24gZmluZElkKG5vZGUpe1xuICAgIGlmICh0eXBlb2Ygbm9kZSA9PT0gJ3N0cmluZycpIHJldHVybiBudWxsO1xuICAgIGlmIChyZWN1Y2hlY2suaGFzKG5vZGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHJlY3VjaGVjay5hZGQobm9kZSk7XG4gICAgaWYgKG5vZGUucHJvcHMpIHtcbiAgICAgIGlmIChub2RlLnByb3BzLmlkKSByZXR1cm4gbm9kZS5wcm9wcy5pZDtcbiAgICAgIGlmIChub2RlLnByb3BzLmNoaWxkcmVuKSB7XG4gICAgICAgIHJldHVybiBmaW5kSWQobm9kZS5wcm9wcy5jaGlsZHJlbik7XG4gICAgICB9XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChub2RlLmxlbmd0aCkge1xuICAgICAgZm9yIChsZXQgaT0wO2k8bm9kZS5sZW5ndGg7ICsraSkge1xuICAgICAgICBjb25zdCBjaGlsZCA9IG5vZGVbaV07XG4gICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgIGNvbnN0IGNoaWxkSWQgPSBmaW5kSWQoY2hpbGQpO1xuICAgICAgICAgIGlmIChjaGlsZElkKSByZXR1cm4gY2hpbGRJZDtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKGNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSkobm9kZSk7XG59XG5cbmV4cG9ydCBjbGFzcyBGb3JtRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gPD5cbiAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImtjbGFiZWxcIiBodG1sRm9yPXt0aGlzLnByb3BzLmlkIHx8IGZpbmRJZCh0aGlzLnByb3BzLmNoaWxkcmVuKX0+e3RoaXMucHJvcHMubGFiZWx9PC9sYWJlbD5cbiAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgPC8+XG4gIH1cbn1cbiIsImltcG9ydCB7IEZpYmVyLCBGaWJlckNvbnRleHQsIFN1YnNjcmlwdGlvbiB9IGZyb20gXCJrZWRiYWNrZW5kL29ic2VydmFibGVcIjtcbmltcG9ydCBSZWFjdCwgeyBTdXNwZW5zZSwgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcblxuY29uc3QgRmliZXJDb250ZXh0UmVhY3QgPSBSZWFjdC5jcmVhdGVDb250ZXh0PEZpYmVyIHwgbnVsbD4obnVsbCk7XG5cbkZpYmVyQ29udGV4dC5hZGRQcm92aWRlcigoKT0+XG4gIC8vIEhlcmUgd2UgYWN0dWFsbCBkbyB1c2VIb29rKEZpYmVyQ29udGV4dCkgYnV0IHdpdGhvdXQgbG9nZ2luZyB0byBpbnRlcm5hbCBkZWJ1ZyBsb2dzXG4gIC8vIE5vcm1hbGx5LCByZWFjdCBob29rcyBhcmUgc2Vuc2l0aXZlIGluIHdoaWNoIG9yZGVyIHRoZXkgYXJlIGNhbGxlZCAodXNlU3RhdGUoKSwgZXRjKVxuICAvLyBidXQgdXNlQ29udGV4dCgpIGlzIG5vdCBzZW5zaXRpdmUgYWJvdXQgdGhhdCBhdCBhbGwuXG4gIC8vIFN0aWxsLCB0aGUgZGVidWcgdmVyc2lvbiBvZiByZWFjdCB3aWxsIGxvZyBjYWxscyB0byB1c2VIb29rKCkgYW5kIHRocm93IGlmIGEgcmVuZGVyXG4gIC8vIGRvZXNuJ3QgdXNlIHRoZSBzYW1lIG51bWJlciBvZiBob29rcyBldmVyeSB0aW1lLiBUaGlzIGNoZWNrIHNob3VsZCBub3QgYXBwbHlcbiAgLy8gdG8gdXNlSG9vaygpIHNpbmNlIGl0IGlzIG5vdCBzZW5zaXRpdmUgdG8gdGhlIG9yZGVyIGluIHdoaWNoIGl0IHdhcyBjYWxsZWQuXG4gIC8vIEFuZCB3ZSBuZWVkIHRvIGJlIGFibGUgdG8gY2FsbCBpdCBmcm9tIHdpdGhpbiBjb250aXRpb25hbCBleHByZXNzaW9ucyAvIHN0YXRlbWVudHMsXG4gIC8vIHNvIHdlIG11c3QgYnlwYXNzIHRoaXMgZGVidWcgbG9nZ2luZyBoZXJlIGJ5IGFjY2Vzc2luZyB0aGUgX2N1cnJlbnRWYWx1ZSBkaXJlY3RseS5cbiAgKEZpYmVyQ29udGV4dFJlYWN0IGFzIGFueSkuX2N1cnJlbnRWYWx1ZSk7IFxuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBmYWxsYmFjaz86IE5vbk51bGxhYmxlPFJlYWN0Tm9kZT58bnVsbDtcbiAgZXJyb3JGYWxsYmFjaz86IE5vbk51bGxhYmxlPFJlYWN0Tm9kZT58bnVsbDtcbiAgY2hpbGRyZW4/OiBSZWFjdE5vZGU7XG59XG5cbmV4cG9ydCBjbGFzcyBPYnNlcnZlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCB7Y291bnRlcjogbnVtYmVyLCBlcnJvcjogbnVsbCB8IEVycm9yLCBpbmZvPzogc3RyaW5nfT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNvdW50ZXI6IDAsXG4gICAgICBlcnJvcjogbnVsbFxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnREaWRDYXRjaChlcnJvcjogYW55LCBpbmZvOiBhbnkpIHtcbiAgICBpZiAoIWVycm9yIHx8ICFlcnJvci5uYW1lKSBlcnJvciA9IG5ldyBFcnJvcignJytlcnJvcik7XG4gICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3IsIGluZm99KTtcbiAgICBjb25zb2xlLmxvZyhlcnJvciwgaW5mbyk7XG4gIH1cblxuICBzdWJzY3JpcHRpb25zOiBTdWJzY3JpcHRpb25bXSA9IFtdO1xuXG4gIG91dGVyU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24gPSB7XG4gICAgdW5zdWJzY3JpYmU6ICgpPT4ge1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLmZvckVhY2gocyA9PiBzLnVuc3Vic2NyaWJlKCkpO1xuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgfVxuICB9XG5cbiAgb2JzZXJ2ZXIgPSAodmFsdWU6IGFueSwgZXJyb3I6IGFueSwgc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24pID0+IHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtjb3VudGVyfSkgPT4gKHtjb3VudGVyOiBjb3VudGVyICsgMSwgZXJyb3J9KSk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMub3V0ZXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5lcnJvcikge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZXJyb3JGYWxsYmFjayB8fCA8cD57TGBLdW5kZSBpbnRlIGxhZGRhIGlubmVow6VsbGV0YH08L3A+O1xuICAgIH1cbiAgICB0aGlzLm91dGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgcmV0dXJuIDxTdXNwZW5zZSBmYWxsYmFjaz17dGhpcy5wcm9wcy5mYWxsYmFjayB8fCBudWxsfT5cbiAgICAgIDxGaWJlckNvbnRleHRSZWFjdC5Qcm92aWRlciB2YWx1ZT17dGhpc30+e3RoaXMucHJvcHMuY2hpbGRyZW59PC9GaWJlckNvbnRleHRSZWFjdC5Qcm92aWRlcj5cbiAgICA8L1N1c3BlbnNlPjtcbiAgfVxufVxuIiwiLyogUkVGQUNUT1I6IE1vdmUgdGhpcyBjb21wb25lbnQgb3V0c2lkZSBjb3Vyc2VidWlsZGVyIVxuICAgVGhpcyBpcyBhIGdlbmVyYWwtcHVycG9zZSBjb21wb25lbnRcbiovXG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEdvYWxQcm9ncmVzcyB9IGZyb20gJy4uL2NoYXJ0cy9nb2FsLXByb2dyZXNzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGl0bGU6IHN0cmluZyB8IEpTWC5FbGVtZW50O1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIGhlYWRlckNsYXNzTmFtZT86IHN0cmluZztcbiAgY29udGVudENsYXNzTmFtZT86IHN0cmluZztcbiAgaGVhZGVyT3Blbj86IGJvb2xlYW47XG4gIGluYWN0aXZhdGVkPzogYm9vbGVhbjtcbiAgaW5hY3RpdmF0ZWRSZW5kZXI/OiAnY2hpbGRyZW4nIHwgJ3RpdGxlQW5kQ2hpbGRyZW4nO1xuICBvbk9wZW5DbG9zZT86IChiZWNhbWVPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xuICBkaXNwbGF5UHJvZ3Jlc3M/OiBib29sZWFuO1xuICBwcm9ncmVzc0RhdGE/OiB7Y29tcGxldGVkTnVtYmVyT2ZUYXNrczogbnVtYmVyLCBudW1iZXJPZlRhc2tzOiBudW1iZXJ9O1xuICBjaGlsZHJlbjtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgaGVhZGVyT3BlbjogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIE9wZW5DbG9zZUJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGhlYWRlck9wZW46IHByb3BzLmhlYWRlck9wZW4gfHwgZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyAobmV4dFByb3BzOiBQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMuaGVhZGVyT3BlbiAhPT0gdGhpcy5wcm9wcy5oZWFkZXJPcGVuKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtoZWFkZXJPcGVuOiBuZXh0UHJvcHMuaGVhZGVyT3Blbn0pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHRpdGxlLCBjbGFzc05hbWUsIGNoaWxkcmVuLCBoZWFkZXJDbGFzc05hbWUsIGNvbnRlbnRDbGFzc05hbWUsIGRpc3BsYXlQcm9ncmVzcywgcHJvZ3Jlc3NEYXRhLFxuICAgICAgaW5hY3RpdmF0ZWQsIGluYWN0aXZhdGVkUmVuZGVyIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgaGVhZGVyT3BlbiB9ID0gdGhpcy5zdGF0ZTtcblxuICAgIGlmIChpbmFjdGl2YXRlZCkgcmV0dXJuIGluYWN0aXZhdGVkUmVuZGVyID09PSAndGl0bGVBbmRDaGlsZHJlbicgPyA8PlxuICAgICAgPD57dGl0bGV9PC8+XG4gICAgICA8PntjaGlsZHJlbn08Lz5cbiAgICA8Lz4gOiA8PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvPjtcblxuICAgIC8vdmFyIGN1cnJlbnRQcm9ncmVzc0RhdGEgPSAvL3Byb2dyZXNzRGF0YSgpO1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZXx8JycpICsgXCIgb3BlbkNsb3NlXCIgKyAoaGVhZGVyT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtcIm9wZW5IZWFkZXJcIiArIChoZWFkZXJDbGFzc05hbWUgPyBcIiBcIiArIGhlYWRlckNsYXNzTmFtZSA6IFwiXCIpfVxuICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMucHJvcHMub25PcGVuQ2xvc2UpIHRoaXMucHJvcHMub25PcGVuQ2xvc2UoIXRoaXMuc3RhdGUuaGVhZGVyT3Blbik7XG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGhlYWRlck9wZW46ICF0aGlzLnN0YXRlLmhlYWRlck9wZW4gfSk7XG4gICAgICAgIH19ID5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyQ29udGFpbmVyXCI+XG4gICAgICAgICAgPGRpdj57dGl0bGV9PC9kaXY+XG4gICAgICAgICAge2Rpc3BsYXlQcm9ncmVzcyAmJiA8R29hbFByb2dyZXNzIHsuLi5wcm9ncmVzc0RhdGF9Lz59XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT17XCJvcGVuQ29udGVudFwiICsgKGNvbnRlbnRDbGFzc05hbWUgPyBcIiBcIiArIGNvbnRlbnRDbGFzc05hbWUgOiBcIlwiKX0+XG4gICAgICAgIHtjaGlsZHJlbn1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PjtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGN1cnJlbnRVc2VyRW52LCB7IEVudiB9IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgdHV0b3JFbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQudHV0b3JFbnYnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0dXRvcmVkOiBib29sZWFuO1xuICBjcmVhdGVDb21wb25lbnQ6IChlbnY6IEVudik9PlJlYWN0LlJlYWN0Tm9kZVxufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBlbnY6IEVudjtcbn1cblxuZXhwb3J0IGNsYXNzIFR1dG9yYWJsZUNvbXBvbmVudCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMub25FbnZVcGRhdGVkID0gdGhpcy5vbkVudlVwZGF0ZWQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgZW52OiBwcm9wcy50dXRvcmVkID8gbnVsbCA6IGN1cnJlbnRVc2VyRW52XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMudHV0b3JlZCkge1xuICAgICAgdHV0b3JFbnYuc3Vic2NyaWJlKHRoaXMub25FbnZVcGRhdGVkKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBpZiAodGhpcy5wcm9wcy50dXRvcmVkKSB7XG4gICAgICB0dXRvckVudi51bnN1YnNjcmliZSh0aGlzLm9uRW52VXBkYXRlZCk7XG4gICAgfVxuICB9XG5cbiAgb25FbnZVcGRhdGVkKGVudjogRW52KSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7ZW52fSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2Vudn0gPSB0aGlzLnN0YXRlO1xuICAgIGlmICghZW52KSByZXR1cm4gPGRpdj48L2Rpdj47XG4gICAgaWYgKCFlbnYua2VkQmFja2VuZENsaWVudCkge1xuICAgICAgcmV0dXJuIDxkaXY+TGFkZGFyLi4uPC9kaXY+O1xuICAgIH1cbiAgICAvL2NvbnN0IHtjdXJyZW50VXNlciwgZWRzQ2xpZW50LCBrZWRCYWNrZW5kQ2xpZW50LCBrZ1Rlcm1QbGFubmVyUmVwb30gPSBlbnY7XG4gICAgLy9jb25zdCB7dHV0b3JlZH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiB0aGlzLnByb3BzLmNyZWF0ZUNvbXBvbmVudChlbnYpO1xuICB9XG59XG4iLCJpbXBvcnQgZXhlYyBmcm9tICcuL2V4ZWMnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIGJvbGQ6IHtcbiAgICBpY29uOiAnPGI+RjwvYj4nLFxuICAgIHRpdGxlOiAnRmV0c3RpbCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdib2xkJylcbiAgfSxcbiAgaXRhbGljOiB7XG4gICAgaWNvbjogJzxpPks8L2k+JyxcbiAgICB0aXRsZTogJ0t1cnNpdicsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpdGFsaWMnKVxuICB9LFxuICB1bmRlcmxpbmU6IHtcbiAgICBpY29uOiAnPHU+VTwvdT4nLFxuICAgIHRpdGxlOiAnVW5kZXJzdHJ1a2VuJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ3VuZGVybGluZScpXG4gIH0sXG4gIHN0cmlrZXRocm91Z2g6IHtcbiAgICBpY29uOiAnPHN0cmlrZT5TPC9zdHJpa2U+JyxcbiAgICB0aXRsZTogJ1N0cnVrZW4nLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnc3RyaWtlVGhyb3VnaCcpXG4gIH0sXG4gIGhlYWRpbmcxOiB7XG4gICAgaWNvbjogJzxiPkg8c3ViPjE8L3N1Yj48L2I+JyxcbiAgICB0aXRsZTogJ1J1YnJpayAxJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxIMT4nKVxuICB9LFxuICBoZWFkaW5nMjoge1xuICAgIGljb246ICc8Yj5IPHN1Yj4yPC9zdWI+PC9iPicsXG4gICAgdGl0bGU6ICdSdWJyaWsgMicsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDI+JylcbiAgfSxcbiAgaGVhZGluZzM6IHtcbiAgICBpY29uOiAnPGI+SDxzdWI+Mzwvc3ViPjwvYj4nLFxuICAgIHRpdGxlOiAnUnVicmlrIDMnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEgzPicpXG4gIH0sXG4gIHBhcmFncmFwaDoge1xuICAgIGljb246ICcmIzE4MjsnLFxuICAgIHRpdGxlOiAnUGFyYWdyYWYnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFA+JylcbiAgfSxcbiAgcXVvdGU6IHtcbiAgICBpY29uOiAnJiM4MjIwOyAmIzgyMjE7JyxcbiAgICB0aXRsZTogJ0NpdGF0JyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxCTE9DS1FVT1RFPicpXG4gIH0sXG4gIG9saXN0OiB7XG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtbGlzdC1vbFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnT3JkbmFkIGxpc3RhJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydE9yZGVyZWRMaXN0JylcbiAgfSxcbiAgdWxpc3Q6IHtcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1saXN0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXG4gICAgdGl0bGU6ICdQdW5rdGxpc3RhJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydFVub3JkZXJlZExpc3QnKVxuICB9LFxuICBvdXRkZW50OiB7XG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtb3V0ZGVudFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnTWluc2thIGluZHJhZycsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKFwib3V0ZGVudFwiKVxuICB9LFxuICBpbmRlbnQ6IHtcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1pbmRlbnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+JyxcbiAgICB0aXRsZTogJ8OWa2EgaW5kcmFnJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoXCJpbmRlbnRcIiksXG4gIH0sXG4gIGNvZGU6IHtcbiAgICBpY29uOiAnJmx0Oy8mZ3Q7JyxcbiAgICB0aXRsZTogJ1Byb2dyYW1rb2QnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFBSRT4nKVxuICB9LFxuICBsaW5lOiB7XG4gICAgaWNvbjogJyYjODIxMzsnLFxuICAgIHRpdGxlOiAnVsOlZ3LDpHQgbGluamUnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaW5zZXJ0SG9yaXpvbnRhbFJ1bGUnKVxuICB9LFxuICBsaW5rOiB7XG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtbGlua1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnSW5mb2dhIGzDpG5rJyxcbiAgICByZXN1bHQ6ICgpID0+IHtcbiAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5wcm9tcHQoJ0FuZ2UgbMOkbmtlbnMgVVJMJylcbiAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgdmFyIHNlbGVjdGVkID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCk7XG4gICAgICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgICAgIGVsZW0uaHJlZiA9IHVybDtcbiAgICAgICAgZWxlbS50YXJnZXQ9XCJfYmxhbmtcIjtcbiAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShzZWxlY3RlZC50b1N0cmluZygpKSk7XG4gICAgICAgIGV4ZWMoJ2luc2VydEhUTUwnLCBlbGVtLm91dGVySFRNTCk7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBpbWFnZToge1xuICAgIGljb246ICc8aSBjbGFzcz1cImZhIGZhLXBpY3R1cmUtb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnSW5mb2dhIGJpbGQnLFxuICAgIHByb21wdE1zZzogJ0FuZ2UgYmlsZGVucyBVUkwnLFxuICAgIHJlc3VsdCAoZXYsIGNvbXBvbmVudCkge1xuICAgICAgY29uc3QgdXJsID0gd2luZG93LnByb21wdCh0aGlzLnByb21wdE1zZyk7XG4gICAgICBpZiAodXJsKSB7XG4gICAgICAgIC8vZXhlYygnaW5zZXJ0SW1hZ2UnLCB1cmwpO1xuICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgICAgICBpbWcuc3JjID0gdXJsO1xuICAgICAgICBpbWcudGFiSW5kZXggPSAxO1xuICAgICAgICBpbnNlcnRFbGVtZW50KGltZyk7XG4gICAgICAgIGltZy5vbmZvY3VzID0gY29tcG9uZW50Lm9uRm9jdXM7XG4gICAgICAgIGltZy5vbmJsdXIgPSBjb21wb25lbnQub25CbHVyO1xuICAgICAgICBjb21wb25lbnQucHJvcHMub25DaGFuZ2UoY29tcG9uZW50LmNvbnRlbnREaXYuaW5uZXJIVE1MKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5zZXJ0RWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgIHZhciBzZWwsIHJhbmdlO1xuICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uICYmIChzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkpLnJhbmdlQ291bnQpIHtcbiAgICAgICAgcmFuZ2UgPSBzZWwuZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7XG4gICAgICAgIHJhbmdlLmluc2VydE5vZGUoZWxlbWVudCk7XG4gICAgICAgIC8vIE1vdmUgdGhlIGNhcmV0IGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBpbnNlcnRlZCBzcGFuXG4gICAgICAgIHJhbmdlLnNldFN0YXJ0QWZ0ZXIoZWxlbWVudCk7XG4gICAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpO1xuICAgICAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgICAgIHNlbC5hZGRSYW5nZShyYW5nZSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGV4ZWMgZnJvbSAnLi9leGVjJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBib2xkOiB7XG4gICAgaWNvbjogJzxiPkI8L2I+JyxcbiAgICB0aXRsZTogJ0JvbGQnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnYm9sZCcpXG4gIH0sXG4gIGl0YWxpYzoge1xuICAgIGljb246ICc8aT5JPC9pPicsXG4gICAgdGl0bGU6ICdJdGFsaWMnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaXRhbGljJylcbiAgfSxcbiAgdW5kZXJsaW5lOiB7XG4gICAgaWNvbjogJzx1PlU8L3U+JyxcbiAgICB0aXRsZTogJ1VuZGVybGluZScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCd1bmRlcmxpbmUnKVxuICB9LFxuICBzdHJpa2V0aHJvdWdoOiB7XG4gICAgaWNvbjogJzxzdHJpa2U+Uzwvc3RyaWtlPicsXG4gICAgdGl0bGU6ICdTdHJpa2UtdGhyb3VnaCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdzdHJpa2VUaHJvdWdoJylcbiAgfSxcbiAgaGVhZGluZzE6IHtcbiAgICBpY29uOiAnPGI+SDxzdWI+MTwvc3ViPjwvYj4nLFxuICAgIHRpdGxlOiAnSGVhZGluZyAxJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxIMT4nKVxuICB9LFxuICBoZWFkaW5nMjoge1xuICAgIGljb246ICc8Yj5IPHN1Yj4yPC9zdWI+PC9iPicsXG4gICAgdGl0bGU6ICdIZWFkaW5nIDInLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEgyPicpXG4gIH0sXG4gIGhlYWRpbmczOiB7XG4gICAgaWNvbjogJzxiPkg8c3ViPjM8L3N1Yj48L2I+JyxcbiAgICB0aXRsZTogJ0hlYWRpbmcgMycsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDM+JylcbiAgfSxcbiAgcGFyYWdyYXBoOiB7XG4gICAgaWNvbjogJyYjMTgyOycsXG4gICAgdGl0bGU6ICdQYXJhZ3JhcGgnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFA+JylcbiAgfSxcbiAgcXVvdGU6IHtcbiAgICBpY29uOiAnJiM4MjIwOyAmIzgyMjE7JyxcbiAgICB0aXRsZTogJ1F1b3RlJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxCTE9DS1FVT1RFPicpXG4gIH0sXG4gIG9saXN0OiB7XG4gICAgaWNvbjogJyYjMzU7JyxcbiAgICB0aXRsZTogJ09yZGVyZWQgTGlzdCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRPcmRlcmVkTGlzdCcpXG4gIH0sXG4gIHVsaXN0OiB7XG4gICAgaWNvbjogJyYjODIyNjsnLFxuICAgIHRpdGxlOiAnVW5vcmRlcmVkIExpc3QnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaW5zZXJ0VW5vcmRlcmVkTGlzdCcpXG4gIH0sXG4gIG91dGRlbnQ6IHtcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1vdXRkZW50XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXG4gICAgdGl0bGU6ICdPdXRkZW50JyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoXCJvdXRkZW50XCIpXG4gIH0sXG4gIGluZGVudDoge1xuICAgIGljb246ICc8aSBjbGFzcz1cImZhIGZhLWluZGVudFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnSW5kZW50JyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoXCJpbmRlbnRcIiksXG4gIH0sXG4gIGNvZGU6IHtcbiAgICBpY29uOiAnJmx0Oy8mZ3Q7JyxcbiAgICB0aXRsZTogJ0NvZGUnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFBSRT4nKVxuICB9LFxuICBsaW5lOiB7XG4gICAgaWNvbjogJyYjODIxMzsnLFxuICAgIHRpdGxlOiAnSG9yaXpvbnRhbCBMaW5lJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydEhvcml6b250YWxSdWxlJylcbiAgfSxcbiAgbGluazoge1xuICAgIGljb246ICcmIzEyODI3OTsnLFxuICAgIHRpdGxlOiAnTGluaycsXG4gICAgcmVzdWx0OiAoKSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KCdFbnRlciB0aGUgbGluayBVUkwnKVxuICAgICAgaWYgKHVybCkge1xuICAgICAgICB2YXIgc2VsZWN0ZWQgPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgZWxlbS5ocmVmID0gdXJsO1xuICAgICAgICBlbGVtLnRhcmdldD1cIl9ibGFua1wiO1xuICAgICAgICBlbGVtLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHNlbGVjdGVkLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgZXhlYygnaW5zZXJ0SFRNTCcsIGVsZW0ub3V0ZXJIVE1MKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGltYWdlOiB7XG4gICAgaWNvbjogJyYjMTI4MjQ3OycsXG4gICAgdGl0bGU6ICdJbWFnZScsXG4gICAgcHJvbXB0TXNnOiAnRW50ZXIgdGhlIFVSTCBvZiB0aGUgaW1hZ2UnLFxuICAgIHJlc3VsdCAoKSB7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KHRoaXMucHJvbXB0TXNnKVxuICAgICAgaWYgKHVybCkgZXhlYygnaW5zZXJ0SW1hZ2UnLCB1cmwpXG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCAoY29tbWFuZCwgdmFsdWUgPSBudWxsKSA9PiB7XG4gIGRvY3VtZW50LmV4ZWNDb21tYW5kKGNvbW1hbmQsIGZhbHNlLCB2YWx1ZSlcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGltYWdlRWRpdEFjdGlvbnMoY2IpIHtcbiAgcmV0dXJuIFt7XG4gICAgbmFtZTogJ2Zsb2F0LWxlZnQnLFxuICAgIGljb246IGA8ZGl2IHN0eWxlPVwicG9zaXRpb246cmVsYXRpdmVcIj5cbiAgICAgIDxpIGNsYXNzPVwiZmEgZmEtYWxpZ24tcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6LTRweDt0b3A6MDsgdHJhbnNmb3JtOiBzY2FsZSgwLjUpOyB0cmFuc2Zvcm0tb3JpZ2luOiBsZWZ0IHRvcFwiPlxuICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXBpY3R1cmUtb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PmAsXG4gICAgdGl0bGU6ICdMw6V0IGJpbGRlbiBmbHl0YSB2w6Ruc3RlciBvbSB0ZXh0JyxcbiAgICByZXN1bHQ6ICgpID0+IGNiKCdmbG9hdC1sZWZ0JylcbiAgfSwge1xuICAgIG5hbWU6ICdmbG9hdC1yaWdodCcsXG4gICAgaWNvbjogYDxkaXYgc3R5bGU9XCJwb3NpdGlvbjpyZWxhdGl2ZVwiPlxuICAgICAgPGkgY2xhc3M9XCJmYSBmYS1hbGlnbi1sZWZ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOyByaWdodDotNHB4O3RvcDowOyB0cmFuc2Zvcm06IHNjYWxlKDAuNSk7IHRyYW5zZm9ybS1vcmlnaW46IHJpZ2h0IHRvcFwiPlxuICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXBpY3R1cmUtb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PmAsXG4gICAgdGl0bGU6ICdMw6V0IGJpbGRlbiBmbHl0YSBow7ZnZXIgb20gdGV4dCcsXG4gICAgcmVzdWx0OiAoKSA9PiBjYignZmxvYXQtcmlnaHQnKVxuICB9LCB7XG4gICAgbmFtZTogJ3VuZmxvYXQnLFxuICAgIGljb246IGA8ZGl2IHN0eWxlPVwicG9zaXRpb246cmVsYXRpdmU7XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XG4gICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowXCI+JiM4MjU0OzwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowOmxlZnQ6MDt0cmFuc2Zvcm06IHNjYWxlKDAuNSk7IHRyYW5zZm9ybS1vcmlnaW46IGxlZnQgYm90dG9tXCI+XG4gICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtcGljdHVyZS1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowXCI+XzwvZGl2PlxuICAgIDwvZGl2PmAsXG4gICAgdGl0bGU6ICdQbGFjZXJhIGJpbGRlbiBww6UgZWdlbiByYWQnLFxuICAgIHJlc3VsdDogKCkgPT4gY2IoJ3VuZmxvYXQnKVxuICB9XTtcbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IGV4ZWMgZnJvbSAnLi9leGVjJztcbmltcG9ydCB7d2FzaEh0bWx9IGZyb20gJy4vd2FzaC1odG1sJztcbmltcG9ydCBpbWFnZUVkaXRBY3Rpb25zIGZyb20gJy4vaW1hZ2UtZWRpdC1hY3Rpb25zJztcbmltcG9ydCBhY3Rpb25zIGZyb20gJy4vYWN0aW9ucyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWN0aW9uIHtcbiAgbmFtZT86IHN0cmluZztcbiAgaWNvbjogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nO1xuICBwcm9tcHRNc2c/OiBzdHJpbmc7XG4gIHJlc3VsdDogKGV2OiBSZWFjdC5Nb3VzZUV2ZW50PEhUTUxCdXR0b25FbGVtZW50PiwgY29tcG9uZW50OiBXeXNpd3lnKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjbGFzc05hbWU/OiBzdHJpbmc7XG4gIGh0bWw6IHN0cmluZztcbiAgb25DaGFuZ2U/OiAoaHRtbDogc3RyaW5nKSA9PiB2b2lkO1xuICByZXBvcnROdW1DaGFycz86IChudW1DaGFyczogbnVtYmVyKSA9PiB2b2lkO1xuICBtYXhDaGFycz86IG51bWJlcjtcbiAgZGVmYXVsdEFjdGlvbnM/OiB7W25hbWU6IHN0cmluZ106IEFjdGlvbn07XG4gIGFjdGlvbnM/OiAoUGFydGlhbDxBY3Rpb24+IHwgc3RyaW5nKVtdO1xuICByZWFkT25seT86IGJvb2xlYW47XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGZvY3VzUmVjdDogQ2xpZW50UmVjdCB8IG51bGw7XG59XG5cbmNvbnN0IGNsYXNzZXMgPSB7XG4gIGFjdGlvbmJhcjogJ3d5c2l3eWctYWN0aW9uYmFyJyxcbiAgYnV0dG9uOiAnd3lzaXd5Zy1idXR0b24nLFxuICBjb250ZW50OiAnd3lzaXd5Zy1jb250ZW50JyxcbiAgZm9jdXNyZWN0OiAnd3lzaXd5Zy1mb2N1c3JlY3QnLFxuICBmb2N1c3BvaW50OiAnd3lzaXd5Zy1mb2N1c3BvaW50JyxcbiAgcmVhZG9ubHlDb250ZW50OiAnd3lzaXd5Zy1jb250ZW50IHJlYWRvbmx5J1xufVxuXG5leHBvcnQgY2xhc3MgV3lzaXd5ZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb250ZW50RGl2OiBIVE1MRGl2RWxlbWVudDtcbiAgZm9jdXNSZWN0RGl2OiBIVE1MRGl2RWxlbWVudDtcbiAgZm9jdXNFbGVtOiBIVE1MRWxlbWVudCB8IG51bGw7XG4gIGNvcm5lcjogc3RyaW5nO1xuICByZXNpemVTdGFydFg6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7Zm9jdXNSZWN0OiBudWxsfTtcbiAgICB0aGlzLm9uRm9jdXMgPSB0aGlzLm9uRm9jdXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uQmx1ciA9IHRoaXMub25CbHVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbk1vdXNlRG93biA9IHRoaXMub25Nb3VzZURvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uTW91c2VNb3ZlID0gdGhpcy5vbk1vdXNlTW92ZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Nb3VzZVVwID0gdGhpcy5vbk1vdXNlVXAuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGlmICghdGhpcy5wcm9wcy5yZWFkT25seSkge1xuICAgICAgQXJyYXkuZnJvbSh0aGlzLmNvbnRlbnREaXYucXVlcnlTZWxlY3RvckFsbChcImltZyxhXCIpKS5tYXAoZWxlbSA9PiAoZWxlbSBhcyAoSFRNTEltYWdlRWxlbWVudCB8IEhUTUxBbmNob3JFbGVtZW50KSkpXG4gICAgICAuZm9yRWFjaChlbGVtID0+IHtcbiAgICAgICAgZWxlbS50YWJJbmRleCA9IDE7XG4gICAgICAgIGVsZW0ub25mb2N1cyA9IHRoaXMub25Gb2N1cztcbiAgICAgICAgZWxlbS5vbmJsdXIgPSB0aGlzLm9uQmx1ciBhcyBhbnk7XG4gICAgICB9KTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3lzaXd5Zy1jb250ZW50XCIpLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25Nb3VzZURvd24pO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53eXNpd3lnLWNvbnRlbnRcIikuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5vbk1vdXNlTW92ZSk7XG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXApO1xuICAgIH1cbiAgICBpZiAodGhpcy5wcm9wcy5yZXBvcnROdW1DaGFycykge1xuICAgICAgdGhpcy5wcm9wcy5yZXBvcnROdW1DaGFycygodGhpcy5jb250ZW50RGl2ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQgJiYgdGhpcy5jb250ZW50RGl2LmlubmVyVGV4dC5sZW5ndGgpIHx8IDApO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICBBcnJheS5mcm9tKHRoaXMuY29udGVudERpdi5xdWVyeVNlbGVjdG9yQWxsKFwiaW1nLGFcIikpLm1hcChlbGVtID0+IChlbGVtIGFzIChIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTEFuY2hvckVsZW1lbnQpKSlcbiAgICAuZm9yRWFjaChlbGVtID0+IHtcbiAgICAgIGVsZW0udGFiSW5kZXggPSAxO1xuICAgICAgZWxlbS5vbmZvY3VzID0gdGhpcy5vbkZvY3VzO1xuICAgICAgZWxlbS5vbmJsdXIgPSB0aGlzLm9uQmx1ciBhcyBhbnk7XG4gICAgfSk7XG4gICAgaWYgKHRoaXMucHJvcHMucmVwb3J0TnVtQ2hhcnMpIHtcbiAgICAgIHRoaXMucHJvcHMucmVwb3J0TnVtQ2hhcnMoKHRoaXMuY29udGVudERpdiAmJiB0aGlzLmNvbnRlbnREaXYuaW5uZXJUZXh0ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQubGVuZ3RoKSB8fCAwKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uTW91c2VEb3duKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXApO1xuICB9XG5cbiAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wczogUHJvcHMsIG5leHRTdGF0ZTogU3RhdGUpIHtcbiAgICAvL3RoaXMuY29udGVudERpdi5vbmZvY3VzID0gdGhpcy5vbkZvY3VzO1xuICAgIC8vdGhpcy5jb250ZW50RGl2Lm9uYmx1ciA9IHRoaXMub25CbHVyO1xuICAgIHJldHVybiAhdGhpcy5jb250ZW50RGl2IHx8XG4gICAgICBuZXh0U3RhdGUgIT0gdGhpcy5zdGF0ZSB8fFxuICAgICAgbmV4dFByb3BzLnJlYWRPbmx5ICE9PSB0aGlzLnByb3BzLnJlYWRPbmx5IHx8XG4gICAgICB3YXNoSHRtbChuZXh0UHJvcHMuaHRtbCkgIT09IHdhc2hIdG1sKHRoaXMuY29udGVudERpdi5pbm5lckhUTUwpO1xuICB9XG5cbiAgdHJpZ2dlck9uQ2hhbmdlKGh0bWw6IHN0cmluZykge1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UgJiYgdGhpcy5wcm9wcy5vbkNoYW5nZSh3YXNoSHRtbChodG1sKSk7XG4gIH1cblxuICBvbkZvY3VzKGV2OiBGb2N1c0V2ZW50KSB7XG4gICAgY29uc3QgZWxlbSA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICBpZiAoIWVsZW0gfHwgIWVsZW0udGFnTmFtZSkgcmV0dXJuO1xuICAgIGlmIChlbGVtLnRhZ05hbWUgIT09ICdJTUcnICYmIGVsZW0udGFnTmFtZSAhPT0gJ0EnKSByZXR1cm47XG4gICAgY29uc3QgY29udGVudFBhcmVudCA9IHRoaXMuY29udGVudERpdi5wYXJlbnRFbGVtZW50O1xuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgZm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdChjb250ZW50UGFyZW50LCBlbGVtKSxcbiAgICB9XG4gICAgc3dpdGNoIChlbGVtLnRhZ05hbWUpIHtcbiAgICAgIGNhc2UgJ0EnOlxuICAgICAgY2FzZSAnSU1HJzpcblxuICAgICAgZGVmYXVsdDogYnJlYWs7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIHRoaXMuZm9jdXNFbGVtID0gZWxlbTtcbiAgfVxuXG4gIG9uQmx1cihldjogUmVhY3QuRm9jdXNFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgICAvKmlmIChldi5yZWxhdGVkVGFyZ2V0KSB7XG4gICAgICBjb25zdCByZWxhdGVkVGFyZ2V0ID0gZXYucmVsYXRlZFRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGlmIChyZWxhdGVkVGFyZ2V0LmNsYXNzTmFtZSAmJiByZWxhdGVkVGFyZ2V0LmNsYXNzTmFtZS5zcGxpdCgnICcpLmluZGV4T2YoY2xhc3Nlcy5idXR0b24pID49IDApIHtcbiAgICAgICAgLy8gQSBpbWFnZSBhY3Rpb24gYnV0dG9uIHdhcyBwcmVzc2VkXG4gICAgICAgIHNldFxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSovXG4gICAgaWYgKChldi50YXJnZXQgPT09IHRoaXMuZm9jdXNFbGVtICYmIGV2LnJlbGF0ZWRUYXJnZXQgIT09IHRoaXMuZm9jdXNSZWN0RGl2KSB8fFxuICAgICAgZXYudGFyZ2V0ID09PSB0aGlzLmZvY3VzUmVjdERpdilcbiAgICB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtmb2N1c1JlY3Q6IG51bGx9KTtcbiAgICB9XG4gIH1cblxuICBtYWtlQ2xpY2thYmxlKGVsZW06IEhUTUxFbGVtZW50KSB7XG4gICAgIGVsZW0udGFiSW5kZXggPSAxO1xuICB9XG5cbiAgb25Nb3VzZURvd24oZXYpIHtcbiAgICBpZiAoKGV2LnRhcmdldC5jbGFzc05hbWUgfHwgXCJcIikuc3BsaXQoJyAnKS5pbmRleE9mKGNsYXNzZXMuZm9jdXNwb2ludCkgPj0gMCkge1xuICAgICAgY29uc3QgY29ybmVyID0gdGhpcy5nZXRSZWN0Q29ybmVyKGV2KTtcbiAgICAgIHRoaXMuY29ybmVyID0gY29ybmVyO1xuICAgICAgdGhpcy5yZXNpemVTdGFydFggPSBldi5jbGllbnRYO1xuICAgIH1cbiAgfVxuXG4gIG9uTW91c2VNb3ZlKGV2OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKHRoaXMuY29ybmVyICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0ICYmIHRoaXMuZm9jdXNFbGVtKSB7XG4gICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gVE9ETzogUsOka25hIHV0IGJhc2VyYXQgcMOlIHRoaXMuY29ybmVyIGh1ciBiaWxkZW5zIHN0b3JsZWsgYm9yZGUgw6RuZHJhcy5cbiAgICAgIC8vIExldGEgdXBwIGJpbGRlbiBwZXIgSUQgZnLDpW4gdGhpcy5jb250ZW50RGl2XG4gICAgICAvLyBTw6R0dCBESVY6ZW5zIHN0eWxlIGF0dHJpYnV0IHdpZHRoIHRpbGwgbnkgd2lkdGguXG4gICAgICAvLyBPbSBESVY6ZW4gcmVkYW4gaGFkZSBoZWlnaHQsIHPDpHR0IG55IGhlaWdodCBtZWQgc2FtbWEgYXNwZWN0IHJhdGlvIHNvbSBpbm5hbixcbiAgICAgIC8vIGFubmFycywgc8OkdHQgaW50ZSBoZWlnaHQgYWxscyAoZWxsZXIgbcO2amxpZ3R2aXMgdGlsbCBhdXRvKSlcbiAgICAgIGNvbnN0IGZvY3VzUmVjdCA9IHRoaXMuZm9jdXNSZWN0RGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgaWYgKGZvY3VzUmVjdC53aWR0aCA8IDMyKSByZXR1cm47XG4gICAgICAvL2NvbnN0IGN1cnJlbnRXaWR0aCA9IGZvY3VzUmVjdC53aWR0aDtcbiAgICAgIC8vY29uc3QgY3VycmVudEhlaWdodCA9IGZvY3VzUmVjdC5oZWlnaHQ7XG4gICAgICAvL2NvbnN0IGhhc0hlaWdodFN0eWxlID0gIXRoaXMuZm9jdXNFbGVtLnN0eWxlLmhlaWdodCB8fCB0aGlzLmZvY3VzRWxlbS5zdHlsZS5oZWlnaHQgPT09IFwiYXV0b1wiO1xuICAgICAgY29uc3QgbmV3V2lkdGggPSBNYXRoLm1heCgzMiwgdGhpcy5jb3JuZXIuZW5kc1dpdGgoJ2wnKSA/XG4gICAgICAgIGZvY3VzUmVjdC53aWR0aCArICh0aGlzLnJlc2l6ZVN0YXJ0WCAtIGV2LmNsaWVudFgpIDpcbiAgICAgICAgLy9mb2N1c1JlY3QucmlnaHQgLSBldi5jbGllbnRYIDpcbiAgICAgICAgZm9jdXNSZWN0LndpZHRoIC0gKHRoaXMucmVzaXplU3RhcnRYIC0gZXYuY2xpZW50WCkpO1xuICAgICAgdGhpcy5yZXNpemVTdGFydFggPSBldi5jbGllbnRYO1xuICAgICAgICAvL2V2LmNsaWVudFggLSBmb2N1c1JlY3QubGVmdDtcbiAgICAgIGNvbnN0IGZhY3RvciA9IG5ld1dpZHRoIC8gZm9jdXNSZWN0LndpZHRoO1xuICAgICAgY29uc3QgbmV3SGVpZ2h0ID0gZm9jdXNSZWN0LmhlaWdodCAqIGZhY3RvcjtcbiAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLndpZHRoID0gbmV3V2lkdGggKyBcInB4XCI7XG4gICAgICB0aGlzLmZvY3VzRWxlbS5zdHlsZS5oZWlnaHQgPSBuZXdIZWlnaHQgKyBcInB4XCI7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCh0aGlzLmNvbnRlbnREaXYucGFyZW50RWxlbWVudCwgdGhpcy5mb2N1c0VsZW0pLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25Nb3VzZVVwKGV2KSB7XG4gICAgaWYgKHRoaXMuY29ybmVyICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0ICYmIHRoaXMuZm9jdXNFbGVtKSB7XG4gICAgICB0aGlzLmNvcm5lciA9IG51bGw7XG4gICAgICB0aGlzLnRyaWdnZXJPbkNoYW5nZSh0aGlzLmNvbnRlbnREaXYuaW5uZXJIVE1MKTtcbiAgICB9XG4gIH1cblxuICBnZXRSZWN0Q29ybmVyKGV2KSB7XG4gICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgKGV2LnRhcmdldC5jbGFzc05hbWUgfHwgJycpLnNwbGl0KCcgJykpIHtcbiAgICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAgIGNhc2UgJ2ZwdWwnOlxuICAgICAgICAgIHJldHVybiAndWwnO1xuICAgICAgICBjYXNlICdmcHVyJzpcbiAgICAgICAgICByZXR1cm4gJ2ZwdXInO1xuICAgICAgICBjYXNlICdmcGxyJzpcbiAgICAgICAgICByZXR1cm4gJ2xyJztcbiAgICAgICAgY2FzZSAnZnBsbCc6XG4gICAgICAgICAgcmV0dXJuICdsbCc7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZXhlY0ltYWdlRWRpdEFjdGlvbiAoY21kOiBzdHJpbmcpIHtcbiAgICAvL2NvbnNvbGUubG9nKGNtZCk7XG4gICAgaWYgKCF0aGlzLmZvY3VzRWxlbSkgcmV0dXJuO1xuICAgIC8vY29uc29sZS5sb2coXCJkb2luZyBpdFwiKTtcbiAgICBzd2l0Y2ggKGNtZCkge1xuICAgICAgY2FzZSAnZmxvYXQtbGVmdCc6XG4gICAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLmNzc0Zsb2F0ID0gJ2xlZnQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Zsb2F0LXJpZ2h0JzpcbiAgICAgICAgdGhpcy5mb2N1c0VsZW0uc3R5bGUuY3NzRmxvYXQgPSAncmlnaHQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3VuZmxvYXQnOlxuICAgICAgICB0aGlzLmZvY3VzRWxlbS5zdHlsZS5jc3NGbG9hdCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgdGhpcy50cmlnZ2VyT25DaGFuZ2UodGhpcy5jb250ZW50RGl2LmlubmVySFRNTCk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCh0aGlzLmNvbnRlbnREaXYucGFyZW50RWxlbWVudCwgdGhpcy5mb2N1c0VsZW0pfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgZGVmYXVsdEFjdGlvbnMgPSB0aGlzLnByb3BzLmRlZmF1bHRBY3Rpb25zIHx8IGFjdGlvbnM7XG4gICAgbGV0IGFjdGlvbnNUb1VzZSA9IHRoaXMucHJvcHMuYWN0aW9ucyA/IHRoaXMucHJvcHMuYWN0aW9ucy5tYXAoYWN0aW9uID0+XG4gICAgICB0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJyA/XG4gICAgICAgIGRlZmF1bHRBY3Rpb25zW2FjdGlvbl0gOlxuICAgICAgICBkZWZhdWx0QWN0aW9uc1thY3Rpb24ubmFtZV0gP1xuICAgICAgICAgIHsgLi4uZGVmYXVsdEFjdGlvbnNbYWN0aW9uLm5hbWVdLCAuLi5hY3Rpb24gfSA6XG4gICAgICAgICAgYWN0aW9uKVxuICAgIDogT2JqZWN0LmtleXMoZGVmYXVsdEFjdGlvbnMpLm1hcChhY3Rpb24gPT4gZGVmYXVsdEFjdGlvbnNbYWN0aW9uXSk7XG5cbiAgICBpZiAodGhpcy5zdGF0ZS5mb2N1c1JlY3QpIHtcbiAgICAgIGFjdGlvbnNUb1VzZSA9IGFjdGlvbnNUb1VzZS5jb25jYXQoaW1hZ2VFZGl0QWN0aW9ucyhjbWQgPT4gdGhpcy5leGVjSW1hZ2VFZGl0QWN0aW9uKGNtZCkpKTtcbiAgICB9XG5cbiAgICBjb25zdCB7Zm9jdXNSZWN0fSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qge3JlYWRPbmx5LCByZXBvcnROdW1DaGFycywgbWF4Q2hhcnN9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9PlxuICAgICAgeyFyZWFkT25seSAmJiA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5hY3Rpb25iYXJ9PlxuICAgICAgICB7YWN0aW9uc1RvVXNlLm1hcCgoYWN0aW9uLCBpZHgpID0+XG4gICAgICAgICAgPGJ1dHRvbiBrZXk9e2lkeH0gY2xhc3NOYW1lPXtjbGFzc2VzLmJ1dHRvbn1cbiAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBhY3Rpb24uaWNvbn19XG4gICAgICAgICAgICB0aXRsZT17YWN0aW9uLnRpdGxlfVxuICAgICAgICAgICAgb25Nb3VzZURvd249e2V2PT57YWN0aW9uLnJlc3VsdChldiwgdGhpcyl9fVxuICAgICAgICAgICAgb25Nb3VzZVVwPXtldj0+c2V0VGltZW91dCgoKT0+dGhpcy5jb250ZW50RGl2LmZvY3VzKCksIDEwKX1cbiAgICAgICAgICAvPil9XG4gICAgICA8L2Rpdj59XG4gICAgICA8ZGl2IGNsYXNzTmFtZT17cmVhZE9ubHkgPyBjbGFzc2VzLnJlYWRvbmx5Q29udGVudCA6IGNsYXNzZXMuY29udGVudH0gc3R5bGU9e3twb3NpdGlvbjogJ3JlbGF0aXZlJywgdG9wOiAwLCBsZWZ0OiAwfX0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZWRpdG9yXCJcbiAgICAgICAgICByZWY9e2RpdiA9PiB0aGlzLmNvbnRlbnREaXYgPSBkaXZ9XG4gICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHdhc2hIdG1sKHRoaXMucHJvcHMuaHRtbCl9fVxuICAgICAgICAgIGNvbnRlbnRFZGl0YWJsZT17IXJlYWRPbmx5fVxuICAgICAgICAgIG9uUGFzdGU9e2V2ID0+IHtcbiAgICAgICAgICAgIGlmICghaXNOYU4obWF4Q2hhcnMpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHt0YXJnZXQsIGN1cnJlbnRUYXJnZXR9ID0gZXY7XG4gICAgICAgICAgICAgIC8vY29uc3QgdGV4dEJlaW5nT3ZlcndyaXR0ZW4gPSAodGFyZ2V0IGFzIGFueSkuaW5uZXJUZXh0IHx8IFwiXCI7XG4gICAgICAgICAgICAgIGNvbnN0IGVkaXRvclRleHQgPSAoY3VycmVudFRhcmdldCAmJiBjdXJyZW50VGFyZ2V0LmlubmVyVGV4dCkgfHwgXCJcIjtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dEJlaW5nUGFzdGVkID0gZXYuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSB8fCBcIlwiO1xuICAgICAgICAgICAgICBpZiAoZWRpdG9yVGV4dC5sZW5ndGggKyB0ZXh0QmVpbmdQYXN0ZWQubGVuZ3RoID4gbWF4Q2hhcnMpIHtcbiAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfX1cbiAgICAgICAgICBvbktleVVwPXtyZXBvcnROdW1DaGFycyA/IGV2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtpbm5lclRleHR9ID0gKGV2LnRhcmdldCBhcyBhbnkpO1xuICAgICAgICAgICAgcmVwb3J0TnVtQ2hhcnMoaW5uZXJUZXh0ID8gaW5uZXJUZXh0Lmxlbmd0aCA6IDApO1xuICAgICAgICAgIH0gOiBudWxsfVxuICAgICAgICAgIG9uS2V5UHJlc3M9eyFpc05hTihtYXhDaGFycykgPyBldiA9PiB7XG4gICAgICAgICAgICBjb25zdCB7aW5uZXJUZXh0fSA9IChldi50YXJnZXQgYXMgYW55KTtcbiAgICAgICAgICAgIGlmIChpbm5lclRleHQgJiYgaW5uZXJUZXh0Lmxlbmd0aCA+PSBtYXhDaGFycykge1xuICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gOiBudWxsfVxuICAgICAgICAgIG9uSW5wdXQ9e2V2ID0+IHRoaXMudHJpZ2dlck9uQ2hhbmdlKChldi50YXJnZXQgYXMgYW55KS5pbm5lckhUTUwpfVxuICAgICAgICAgIG9uS2V5RG93bj17ZXYgPT4ge1xuICAgICAgICAgICAgaWYgKHJlYWRPbmx5KSByZXR1cm47XG4gICAgICAgICAgICBpZiAocmVwb3J0TnVtQ2hhcnMgJiYgZXYuY3VycmVudFRhcmdldCkge1xuICAgICAgICAgICAgICByZXBvcnROdW1DaGFycygoZXYuY3VycmVudFRhcmdldC5pbm5lclRleHQgfHwgXCJcIikubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIktleTogXCIgKyBldi53aGljaCk7XG4gICAgICAgICAgICBpZiAoZXYud2hpY2ggPj0gMzUgJiYgZXYud2hpY2ggPD0gNDApIHsvLyBob21lL2VuZC91cC9kb3duL2xlZnQvcmlnaHRcbiAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7IC8vIFByZXZlbnQgZW50aXJlIHBhZ2UgZnJvbSBzY3JvbGxpbmc/P1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV2LndoaWNoID09PSA5KSB7XG4gICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7Ly8gVEFCXG4gICAgICAgICAgICAgIGlmIChldi5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgIGV4ZWMoXCJvdXRkZW50XCIpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGV4ZWMoXCJpbmRlbnRcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAoZXYua2V5Q29kZSA9PT0gOCB8fCBldi5rZXlDb2RlID09PSA0NikgJiYgLy8gRGVsZXRlIG9yIEJhY2sgYnV0dG9uc1xuICAgICAgICAgICAgICB0aGlzLmZvY3VzRWxlbSAmJiB0aGlzLnN0YXRlLmZvY3VzUmVjdClcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuZm9jdXNFbGVtICYmIHRoaXMuZm9jdXNFbGVtLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzRWxlbS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuZm9jdXNFbGVtKTsgLy8gUmVtb3ZlIG1hcmtlZCBpbWFnZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHRoaXMuZm9jdXNFbGVtID0gbnVsbDtcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Zm9jdXNSZWN0OiBudWxsfSk7XG4gICAgICAgICAgICAgIHRoaXMudHJpZ2dlck9uQ2hhbmdlKHRoaXMuY29udGVudERpdi5pbm5lckhUTUwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH19XG4gICAgICAgIC8+XG4gICAgICAgIHtmb2N1c1JlY3QgJiYgPGRpdlxuICAgICAgICAgIHJlZj17ZGl2ID0+IHRoaXMuZm9jdXNSZWN0RGl2ID0gZGl2fVxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5mb2N1c3JlY3R9XG4gICAgICAgICAgb25CbHVyPXt0aGlzLm9uQmx1cn1cbiAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgb3V0bGluZTogMCxcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgdG9wOiB0aGlzLnN0YXRlLmZvY3VzUmVjdC50b3AsXG4gICAgICAgICAgICBsZWZ0OiB0aGlzLnN0YXRlLmZvY3VzUmVjdC5sZWZ0LFxuICAgICAgICAgICAgd2lkdGg6IHRoaXMuc3RhdGUuZm9jdXNSZWN0LndpZHRoLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLnN0YXRlLmZvY3VzUmVjdC5oZWlnaHR9fT5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5mb2N1c3BvaW50ICsgXCIgZnB1bFwifSBzdHlsZT17e3Bvc2l0aW9uOidhYnNvbHV0ZScsIHRvcDowLCBsZWZ0OjB9fSAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcHVyXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgdG9wOjAsIHJpZ2h0OjB9fSAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcGxyXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgYm90dG9tOjAsIHJpZ2h0OjB9fSAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcGxsXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgYm90dG9tOjAsIGxlZnQ6MH19IC8+XG4gICAgICAgIDwvZGl2Pn1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG5cbmZ1bmN0aW9uIGdldFJlbGF0YXRpdmVDbGllbnRSZWN0IChwYXJlbnQ6IEhUTUxFbGVtZW50LCBjaGlsZDogSFRNTEVsZW1lbnQpIDogQ2xpZW50UmVjdCB7XG4gIGNvbnN0IHBhcmVudFJlY3QgPSBwYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIGNvbnN0IGNoaWxkUmVjdCA9IGNoaWxkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4ge1xuICAgIHRvcDogY2hpbGRSZWN0LnRvcCAtIHBhcmVudFJlY3QudG9wICsgcGFyZW50LnNjcm9sbFRvcCxcbiAgICBsZWZ0OiBjaGlsZFJlY3QubGVmdCAtIHBhcmVudFJlY3QubGVmdCArIHBhcmVudC5zY3JvbGxMZWZ0LFxuICAgIGJvdHRvbTogY2hpbGRSZWN0LmJvdHRvbSAtIHBhcmVudFJlY3QudG9wICsgcGFyZW50LnNjcm9sbFRvcCxcbiAgICByaWdodDogY2hpbGRSZWN0LnJpZ2h0IC0gcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50LnNjcm9sbExlZnQsXG4gICAgd2lkdGg6IGNoaWxkUmVjdC53aWR0aCxcbiAgICBoZWlnaHQ6IGNoaWxkUmVjdC5oZWlnaHRcbiAgfTtcbn1cbiIsImltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5cbmNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcblxudHlwZSBIVE1MUG9saWN5ID0ge1t0YWdOYW1lTG93ZXI6IHN0cmluZ106IHtbYXR0cmlidXRlTG93ZXI6IHN0cmluZ106IGJvb2xlYW59fTtcblxuLyoqIFRhZ3MgLyBBdHRyaWJ1dGVzIFdoaXRlbGlzdFxuICogXG4gKi9cbmNvbnN0IEhUTUxfV0FTSF9QT0xJQ1k6IEhUTUxQb2xpY3kgPSB7XG4gIGI6IHt9LCAgLy8gYm9sZFxuICBpOiB7fSwgIC8vIGl0YWxpY1xuICBwOiB7fSwgIC8vIHBhcmFncmFwaFxuICB1OiB7fSwgIC8vIHVuZGVybGluZVxuICBzdHJpa2U6IHt9LCAvLyBzdHJpa2UtdGhyb3VnaFxuICBwcmU6IHt9LCAvLyB1bmZvcm1hdHRlZFxuICBoMToge30sIC8vIGhlYWRpbmcgMVxuICBoMjoge30sIC8vIGhlYWRpbmcgMlxuICBoMzoge30sIC8vIGhlYWRpbmcgM1xuICBoNDoge30sIC8vIGhlYWRpbmcgNFxuICBoNToge30sIC8vIGhlYWRpbmcgNVxuICBpbWc6IHtzcmM6IHRydWUsIGNsYXNzOiB0cnVlLCBzdHlsZTogdHJ1ZSwgdGFiaW5kZXg6IHRydWV9LCAvLyBpbWFnZS4gV2Ugc2V0IHN0eWxlIGFuZCB0YWJpbmRleCBvdXJzZWx2ZXMuIEFjY2VwdCB0aGF0LlxuICBhOiB7aHJlZjogdHJ1ZSwgdGFyZ2V0OiB0cnVlLCB0YWJpbmRleDogdHJ1ZX0sIC8vIGxpbmtcbiAgdWw6IHt9LCAvLyBVbm9yZGVyZWQgbGlzdFxuICBvbDoge30sIC8vIE9yZGVyZWQgbGlzdFxuICBsaToge30sIC8vIGxpc3QgaXRlbVxuICBocjoge30sIC8vIEhvcml6b250YWwgcnVsZVxuICBicjoge30sIC8vIEJyZWFrIGxpbmVcbiAgZGl2OiB7fSwvLyBPZiBzb21lIHJlYXNvbiwgZGl2cyBhcmUgc29tZXRpbWVzIGluc2VydGVkIHdoZW4gcHJlc3NpbmcgRU5URVIgaW4gdGhlIHd5c2l3eWcgZWRpdG9yLlxuICBzcGFuOiB7fSwvLyBTcGFucyBhcmUgaGFybWxlc3MsIGp1c3QgcmVtb3ZlIHRoZWlyIHN0eWxlIGFuZCBvdGhlciBhdHRyaWJ1dGVzIGFuZCBJIGZlZWwgZ3JlYXQuXG4gIC8vIHRhYmxlIHRhZ3M6XG4gIHRhYmxlOiB7Ym9yZGVyOiB0cnVlfSxcbiAgdGJvZHk6IHt9LFxuICB0aGVhZDoge30sXG4gIHRmb290OiB7fSxcbiAgdHI6IHt9LFxuICB0ZDoge2hlYWRlcnM6IHRydWUsIGNvbHNwYW46IHRydWUsIHJvd3NwYW46IHRydWV9LFxuICB0aDoge2FiYnI6IHRydWUsIGhlYWRlcnM6IHRydWUsIHNjb3BlOiB0cnVlLCBzb3J0ZWQ6IHRydWUsIGNvbHNwYW46IHRydWUsIHJvd3NwYW46IHRydWV9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gd2FzaEh0bWwgKGh0bWw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIik7XG4gIGNvbnN0IHtjaGlsZE5vZGVzfSA9IGRvYy5ib2R5O1xuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcbiAgZm9yIChsZXQgaT0wOyBpPGNoaWxkTm9kZXMubGVuZ3RoOyArK2kpIHtcbiAgICBpZiAod2FzaE5vZGUoY2hpbGROb2Rlcy5pdGVtKGkpKSkge1xuICAgICAgbW9kaWZpZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbW9kaWZpZWQgP1xuICAgIGRvYy5ib2R5LmlubmVySFRNTCA6XG4gICAgaHRtbDsgLy8gQnkgcmV0dXJuaW5nIHRoZSBvcmlnaW5hbCBIVE1MIHN0cmluZywgd2Ugc3BhcmUgdGhlIHVzZXIgZnJvbSByZWZyZXNoaW5nIHRoZSBlZGl0IGFyZWEsXG4gICAgICAgICAgLy8gd2hpY2ggd291bGQgb3RoZXJ3aXNlIHB1dCB0aGUgY3Vyc29yIGF0IHRoZSB0b3AsIGxvc2luZyB0aGUgcG9zaXRpb24gd2hlcmUgdXNlciB3aGVyZS5cbn1cblxuZnVuY3Rpb24gd2FzaE5vZGUobm9kZTogTm9kZSB8IEVsZW1lbnQgfCBIVE1MRWxlbWVudCk6IGJvb2xlYW4ge1xuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcbiAgaWYgKGlzRWxlbWVudChub2RlKSkge1xuICAgIGlmICh3YXNoRWxlbWVudChub2RlKSkge1xuICAgICAgbW9kaWZpZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuICBpZiAod2FzaENoaWxkTm9kZXMobm9kZSkpIHtcbiAgICBtb2RpZmllZCA9IHRydWU7XG4gIH1cbiAgcmV0dXJuIG1vZGlmaWVkO1xufVxuXG5mdW5jdGlvbiB3YXNoQ2hpbGROb2Rlcyhub2RlOiBOb2RlKSB7XG4gIGxldCBtb2RpZmllZCA9IGZhbHNlO1xuICBjb25zdCB7Y2hpbGROb2Rlc30gPSBub2RlO1xuICBmb3IgKGxldCBpPTA7IGk8Y2hpbGROb2Rlcy5sZW5ndGg7ICsraSkge1xuICAgIGlmICh3YXNoTm9kZShjaGlsZE5vZGVzLml0ZW0oaSkpKSB7XG4gICAgICBtb2RpZmllZCA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBtb2RpZmllZDtcbn0gXG5cbi8qKiBSZXBsYWNlIGFuIGVsZW1lbnQgd2l0aCBpdHMgY2hpbGQgbm9kZXMuXG4gKiBcbiAqL1xuZnVuY3Rpb24gcmVtb3ZlTWlkZGxlRWxlbWVudChlbGVtZW50OiBFbGVtZW50KSB7XG4gIGNvbnN0IHtjaGlsZE5vZGVzfSA9IGVsZW1lbnQ7XG4gIGZvciAobGV0IGk9MDsgaTxjaGlsZE5vZGVzLmxlbmd0aDsgKytpKSB7XG4gICAgZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjaGlsZE5vZGVzLml0ZW0oaSksIGVsZW1lbnQpO1xuICB9XG4gIGVsZW1lbnQucmVtb3ZlKCk7XG59XG5cbmZ1bmN0aW9uIHdhc2hFbGVtZW50KGVsZW1lbnQ6IEVsZW1lbnQpOiBib29sZWFuIHtcbiAgY29uc3QgcG9saWN5ID0gZWxlbWVudC50YWdOYW1lICYmIEhUTUxfV0FTSF9QT0xJQ1lbZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCldO1xuICBpZiAoIXBvbGljeSkge1xuICAgIGNvbnNvbGUud2FybihcIld5c2l3eWc6IG5vdCBhbGxvd2VkIHRhZ1wiLCBlbGVtZW50LnRhZ05hbWUpO1xuICAgIHdhc2hDaGlsZE5vZGVzKGVsZW1lbnQpO1xuICAgIHJlbW92ZU1pZGRsZUVsZW1lbnQoZWxlbWVudCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgbGV0IG1vZGlmaWVkID0gZmFsc2U7XG4gIGZvciAobGV0IGk9MDsgaTxlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoOyArK2kpIHtcbiAgICBjb25zdCBhdHRyID0gZWxlbWVudC5hdHRyaWJ1dGVzLml0ZW0oaSk7XG4gICAgY29uc3QgYWxsb3dlZCA9IGF0dHIubmFtZSAmJiAhIXBvbGljeVthdHRyLm5hbWUudG9Mb3dlckNhc2UoKV07XG4gICAgaWYgKCFhbGxvd2VkKSB7XG4gICAgICBtb2RpZmllZCA9IHRydWU7XG4gICAgICBjb25zb2xlLndhcm4oXCJXeXNpd3lnOiBub3QgYWxsb3dlZCBhdHRyaWJ1dGVcIiwgYXR0ci5uYW1lLCBcIlRhZzogXCIsIGVsZW1lbnQudGFnTmFtZSk7XG4gICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShhdHRyLm5hbWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbW9kaWZpZWQ7XG59XG5cbmZ1bmN0aW9uIGlzRWxlbWVudChub2RlOiBOb2RlKSA6IG5vZGUgaXMgRWxlbWVudCB7XG4gIHJldHVybiAhIShub2RlIGFzIEVsZW1lbnQpLnRhZ05hbWU7XG59XG4iLCJleHBvcnQgKiBmcm9tICcuL3dlZWstbm90ZWJvb2snO1xuZXhwb3J0ICogZnJvbSAnLi9yb290LXdlZWstbm90ZWJvb2snO1xuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgSW5qZWN0ZWRJbnRsUHJvcHMgfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuaW1wb3J0IHsgV2Vla05vdGVib29rIH0gZnJvbSAnLic7XG5cbmV4cG9ydCBmdW5jdGlvbiBSb290V2Vla05vdGVib29rIChwcm9wcyA6IEluamVjdGVkSW50bFByb3BzKSB7XG4gICAgY29uc3Qge2ludGx9ID0gcHJvcHM7XG4gICAgcmV0dXJuIDxMYW5ndWFnZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3tpbnRsfX0+XG4gICAgICAgICAgICAgIDxXZWVrTm90ZWJvb2sgLz5cbiAgICAgICAgICAgPC9MYW5ndWFnZUNvbnRleHQuUHJvdmlkZXI+O1xuICB9IiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHdlZWtOb3Rlc1JlcG8gfSBmcm9tICcuLi8uLi9yZXBvcy93ZWVrLW5vdGVzLXJlcG8nO1xuaW1wb3J0IHsgV2Vla05vdGUgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBQZW5kaW5nSm9iIH0gZnJvbSAnLi4vLi4vdXRpbHMvcGVuZGluZy1qb2InO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBXeXNpd3lnIH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcnO1xuaW1wb3J0IGFjdGlvbnNfc3dlZGlzaCBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9hY3Rpb25zLXN2JztcbmltcG9ydCBhY3Rpb25zX2VuIGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2FjdGlvbnMnO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xuaW1wb3J0IHsgaWZUYWtlc1RpbWUgfSBmcm9tICcuLi8uLi91dGlscy9pZi10YWtlcy10aW1lJztcbmltcG9ydCB7IEluamVjdGVkSW50bCwgRm9ybWF0dGVkTWVzc2FnZSB9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XG5cbmNvbnN0IE1BWF9OT1RFX0xFTkdUSCA9IDE2Mzg0O1xuXG5cbmludGVyZmFjZSBQcm9wcyB7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHdlZWtOb3RlPzogV2Vla05vdGU7XG4gIG5vdGVzOiBzdHJpbmc7XG4gIC8vd2VlazogbnVtYmVyO1xuICBpc0xvYWRpbmc6IGJvb2xlYW47XG4gIHNob3dMb2FkaW5nUHJvZ3Jlc3M6IGJvb2xlYW47XG4gIHNob3dTYXZpbmdQcm9ncmVzczogYm9vbGVhbjtcbiAgZXZlckVkaXRlZDogYm9vbGVhbjtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBXZWVrTm90ZWJvb2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIGF1dG9TYXZlcjogUGVuZGluZ0pvYjtcbiAgdGltZW91dEhhbmRsZTogYW55O1xuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5hdXRvU2F2ZXIgPSBuZXcgUGVuZGluZ0pvYigoKT0+dGhpcy5zYXZlKCkpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0xvYWRpbmc6IHRydWUsXG4gICAgICBzaG93TG9hZGluZ1Byb2dyZXNzOiBmYWxzZSxcbiAgICAgIHNob3dTYXZpbmdQcm9ncmVzczogZmFsc2UsXG4gICAgICBldmVyRWRpdGVkOiBmYWxzZSxcbiAgICAgIG5vdGVzOiBcIlwiLFxuICAgICAgLy93ZWVrOiBtb21lbnQoKS53ZWVrKClcbiAgICB9XG4gIH1cbiAgXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMuc2hvd1Byb2dyZXNzSWZMb2FkaW5nVGFrZXNUaW1lKCk7XG4gICAgd2Vla05vdGVzUmVwby5tZW0uc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xuICB9XG5cbiAgcHJpdmF0ZSBzaG93UHJvZ3Jlc3NJZkxvYWRpbmdUYWtlc1RpbWUoKSB7XG4gICAgdGhpcy50aW1lb3V0SGFuZGxlID0gc2V0VGltZW91dCgoKT0+dGhpcy5zdGF0ZS5pc0xvYWRpbmcgJiYgdGhpcy5zZXRTdGF0ZSh7c2hvd0xvYWRpbmdQcm9ncmVzczogdHJ1ZX0pLCAzMDApOyAgICBcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHdlZWtOb3Rlc1JlcG8ubWVtLnVuc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xuICAgIHRoaXMuYXV0b1NhdmVyLnN0b3AoKTtcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SGFuZGxlKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgX3NhdmUoKSB7XG4gICAgZm9yIChsZXQgbWF4SXRlcmF0aW9ucz0zOyB0aGlzLmlzTm90ZXNFZGl0ZWQoKSAmJiBtYXhJdGVyYXRpb25zOyAtLW1heEl0ZXJhdGlvbnMpIHtcbiAgICAgIGF3YWl0IHdlZWtOb3Rlc1JlcG8udXBzZXJ0KHRoaXMuc3RhdGUud2Vla05vdGUsIHduID0+IHtcbiAgICAgICAgd24uY29udGVudCA9IHRoaXMuc3RhdGUubm90ZXM7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIHNhdmUoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXRlLnNob3dTYXZpbmdQcm9ncmVzcyAmJiAhdGhpcy5zdGF0ZS5pc0xvYWRpbmcgJiYgdGhpcy5pc05vdGVzRWRpdGVkKCkpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0U3RhdGUoe2Vycm9yOiB1bmRlZmluZWR9KTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGlmVGFrZXNUaW1lKDMwMCwgKCk9PnRoaXMuX3NhdmUoKSwgKCk9PnRoaXMuc2V0U3RhdGUoe3Nob3dTYXZpbmdQcm9ncmVzczogdHJ1ZX0pKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIGF3YWl0IHRoaXMuc2V0U3RhdGUoe2Vycm9yOiB0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpcImNvbW1vbi5lcnJvclNhdmluZ0RhdGFcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiS3VuZGUgaW50ZSBzcGFyYS5cIn0pfSk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKHtzaG93U2F2aW5nUHJvZ3Jlc3M6IGZhbHNlfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaXNOb3Rlc0VkaXRlZCgpIHtcbiAgICBjb25zdCB7IHdlZWtOb3RlLCBub3RlcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gISF3ZWVrTm90ZSAmJiAobm90ZXMgIT09IHdlZWtOb3RlLmNvbnRlbnQpO1xuICB9ICBcblxuICAvL0lmIHRoZSBub3RlYm9vayBzaG91bGQgYmUgdXNlZCBpbiBtdWx0aXBsZSBtb2R1bGVzLCBtb3ZlIHRoaXMgZnVuY3Rpb25zIGludG8gYW4gdXRpbGl0eSBmaWxlXG4gIGdldFRyYW5zbGF0ZWRBY3Rpb25zKGludGw6IEluamVjdGVkSW50bCl7XG4gICAgLy9hY3Rpb25zIG1pZ2h0IGhhdmUgZGlmZmVyZW50IGljb25zIGZvciBlYWNoIGxhbmd1YWdlXG4gICAgLy93ZSBrZWVwIHRoZSBzYW1lIHN0cnVjdHVyZSBvZiB0aGUgYWN0aW9ucywgYnV0IHdlIHJlcGxhY2UgdGhlIHRleHRzIHdpdGggdGhlIG9uZXMgZnJvbSB0aGUgdHJhbnNsYXRlZCBmaWxlc1xuICAgIHZhciBsb2NhbGVBY3Rpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgaW50bC5sb2NhbGUgPT09IFwic3ZcIiA/IGFjdGlvbnNfc3dlZGlzaCA6IGFjdGlvbnNfZW4pO1xuICAgIE9iamVjdC5rZXlzKGxvY2FsZUFjdGlvbnMpLmZvckVhY2goZWxlbSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50VGl0bGUgPSBhY3Rpb25zX3N3ZWRpc2hbZWxlbV0udGl0bGU7XG4gICAgICBsb2NhbGVBY3Rpb25zW2VsZW1dLnRpdGxlID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDpgd3lzaXd5Zy4ke2VsZW19YCwgZGVmYXVsdE1lc3NhZ2U6IGN1cnJlbnRUaXRsZX0pO1xuICAgICAgXG4gICAgICAvL2JlY2F1c2UgdGhlIGltYWdlIGFjdGlvbiBuZWVkcyBhIGN1c3RvbSB0cmFuc2xhdGlvbiwgd2UgdHJlYXQgdGhpcyBzZXBhcmF0ZWx5XG4gICAgICBpZihlbGVtID09PSBcImltYWdlXCIpe1xuICAgICAgICBsb2NhbGVBY3Rpb25zW2VsZW1dLnByb21wdE1zZyA9IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6XCJ3eXNpd3lnLmltYWdlUHJvbXB0TXNnXCIsIGRlZmF1bHRNZXNzYWdlOiBhY3Rpb25zX3N3ZWRpc2hbZWxlbV0ucHJvbXB0TXNnfSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGxvY2FsZUFjdGlvbnM7XG4gIH1cblxuICBvbkNoYW5nZSh3ZWVrTm90ZXM6IFdlZWtOb3RlW10pIHtcbiAgICBjb25zdCB3ZWVrTm90ZSA9IHdlZWtOb3Rlcy5sZW5ndGggPiAwID9cbiAgICAgIHdlZWtOb3Rlc1t3ZWVrTm90ZXMubGVuZ3RoIC0gMV0gOlxuICAgICAge1xuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgLy9kYXRlVGltZTogd2Vla05vdGVzUmVwby5nZXRDdXJyZW50V2VlaygpLnRvRGF0ZSgpLmdldFRpbWUoKSxcbiAgICAgICAgY29udGVudDogXCJcIixcbiAgICAgICAgYWNsOiBbXG4gICAgICAgICAgLy8gRGVmYXVsdCBBQ0w6IExldCB1c2VyIHNlbGYgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGl0ZW06XG4gICAgICAgICAgbmV3IERvY3VtZW50QWNjZXNzKFwiZW1haWxcIiwgZW52LmN1cnJlbnRVc2VyLm1haWwsIFwiU1wiKVxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxuICAgICAgfTtcbiAgICBcbiAgICBjb25zdCBuZXdTdGF0ZTogUGFydGlhbDxTdGF0ZT4gPSB7XG4gICAgICB3ZWVrTm90ZSxcbiAgICAgIC8vd2Vlazogd2Vla05vdGVzUmVwby5nZXRDdXJyZW50V2VlaygpLndlZWsoKSxcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBzaG93TG9hZGluZ1Byb2dyZXNzOiBmYWxzZVxuICAgIH07XG5cbiAgICBpZiAoIXRoaXMuc3RhdGUud2Vla05vdGUgfHwgdGhpcy5zdGF0ZS53ZWVrTm90ZS5pZCAhPT0gd2Vla05vdGUuaWQgfHwgd2Vla05vdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgbmV3U3RhdGUubm90ZXMgPSB3ZWVrTm90ZS5jb250ZW50O1xuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKG5ld1N0YXRlIGFzIFN0YXRlKTtcbiAgfVxuXG4gIC8qYXN5bmMgY2hhbmdlV2VlayhkaXJlY3Rpb246IG51bWJlcikge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgICBldmVyRWRpdGVkOiBmYWxzZSxcbiAgICAgICAgd2Vla05vdGU6IG51bGwsXG4gICAgICAgIGVycm9yOiB1bmRlZmluZWRcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zaG93UHJvZ3Jlc3NJZkxvYWRpbmdUYWtlc1RpbWUoKTtcbiAgICAgIGF3YWl0IHdlZWtOb3Rlc1JlcG8uY2hhbmdlV2VlayhkaXJlY3Rpb24pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IFwiS3VuZGUgaW50ZSBsYWRkYSBkYXRhXCJ9KTtcbiAgICB9IFxuICB9XG5cbiAgcHJldldlZWsoKSB7XG4gICAgdGhpcy5jaGFuZ2VXZWVrKC0xKTtcbiAgfVxuXG4gIG5leHRXZWVrKCkge1xuICAgIHRoaXMuY2hhbmdlV2VlaygxKTtcbiAgfSovXG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtub3Rlcywgc2hvd0xvYWRpbmdQcm9ncmVzcywgaXNMb2FkaW5nLCBzaG93U2F2aW5nUHJvZ3Jlc3MsIGVycm9yLCBldmVyRWRpdGVkfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXY+XG4gICAgICAgIHsvKjxkaXYgY2xhc3NOYW1lPXtga2VkX2JveGVkIGtlZE5vdGVwYWQke3dlZWtOdW1iZXIgPT09IGN1cnJlbnRXZWVrID8gXCIgY3VycmVudFdlZWtcIiA6IFwiXCJ9YH0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHdlZWtTZWxlY3RgfT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxuICAgICAgICAgICAgICAgIDxwPntMYFZlY2thICR7d2Vla051bWJlcn1gfTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bi1ncm91cFwiPlxuICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByZXZXZWVrKCl9PlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1sZWZ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpID0+IHRoaXMubmV4dFdlZWsoKX0+XG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWFuZ2xlLXJpZ2h0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICovXG4gICAgICAgIH1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BrZWRfYm94ZWQga2VkTm90ZXBhZGB9PlxuICAgICAgICAgIDxoMz48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtOb3RlYm9vay50aXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiQW50ZWNrbmluZ2FyXCIvPjwvaDM+XG4gICAgICAgICAgPFd5c2l3eWdcbiAgICAgICAgICAgIGFjdGlvbnM9e1tcbiAgICAgICAgICAgICAgXCJib2xkXCIsXG4gICAgICAgICAgICAgIFwiaXRhbGljXCIsXG4gICAgICAgICAgICAgIFwidW5kZXJsaW5lXCIsXG4gICAgICAgICAgICAgIFwic3RyaWtldGhyb3VnaFwiLFxuICAgICAgICAgICAgICBcIm9saXN0XCIsXG4gICAgICAgICAgICAgIFwidWxpc3RcIixcbiAgICAgICAgICAgICAgXCJvdXRkZW50XCIsXG4gICAgICAgICAgICAgIFwiaW5kZW50XCIsXG4gICAgICAgICAgICAgIFwibGluZVwiXX1cbiAgICAgICAgICAgIGRlZmF1bHRBY3Rpb25zPXt0aGlzLmdldFRyYW5zbGF0ZWRBY3Rpb25zKGludGwpfVxuICAgICAgICAgICAgaHRtbD17aXNMb2FkaW5nID8gXCI8ZGl2PjwvZGl2PlwiIDogbm90ZXMuc3Vic3RyKDAsIE1BWF9OT1RFX0xFTkdUSCl9XG4gICAgICAgICAgICBvbkNoYW5nZT17IWlzTG9hZGluZyAmJiAoaHRtbCA9PiB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgIG5vdGVzOiBodG1sLnN1YnN0cigwLCBNQVhfTk9URV9MRU5HVEgpLFxuICAgICAgICAgICAgICAgIGV2ZXJFZGl0ZWQ6IHRydWVcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHRoaXMuYXV0b1NhdmVyLnRyaWdnZXJDaGFuZ2UoNTAwKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIC8+XG4gICAgICAgICAgPGhyLz5cbiAgICAgICAgICB7ZXJyb3IgP1xuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZXJyb3JcIj57ZXJyb3J9PC9wPiA6XG4gICAgICAgICAgICBzaG93TG9hZGluZ1Byb2dyZXNzID9cbiAgICAgICAgICAgICAgPHNwYW4+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24ubG9hZGluZ1wiIGRlZmF1bHRNZXNzYWdlPVwiTGFkZGFyLi4uXCIvPjxTcGlubmVyIC8+PC9zcGFuPiA6XG4gICAgICAgICAgICAgIHNob3dTYXZpbmdQcm9ncmVzcyA/IDw+XG4gICAgICAgICAgICAgICAgPHNwYW4+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2aW5nXCIgZGVmYXVsdE1lc3NhZ2U9XCJTcGFyYXIuLi5cIi8+ICZuYnNwOyA8L3NwYW4+XG4gICAgICAgICAgICAgICAgPFNwaW5uZXIgLz5cbiAgICAgICAgICAgICAgPC8+IDpcbiAgICAgICAgICAgICAgdGhpcy5pc05vdGVzRWRpdGVkKCkgPyBcbiAgICAgICAgICAgICAgICA8PiZuYnNwOzwvPiA6XG4gICAgICAgICAgICAgICAgICBldmVyRWRpdGVkID9cbiAgICAgICAgICAgICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiY29tbW9uLnNhdmVkXCIgZGVmYXVsdE1lc3NhZ2U9XCJTcGFyYWRcIi8+IDpcbiAgICAgICAgICAgICAgICAgICAgPD4mbmJzcDs8Lz59XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Rm9ybWF0dGVkTWVzc2FnZX0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQgeyBlbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBsZWFybmluZ0dvYWw/OiBzdHJpbmc7XG4gIG9uU2F2ZTogKGxlYXJuaW5nR29hbDogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBsZWFybmluZ0dvYWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEFkZEN1c3RvbUdvYWwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKVxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBsZWFybmluZ0dvYWw6IHByb3BzLmxlYXJuaW5nR29hbCB8fCAnJ1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7bGVhcm5pbmdHb2FsfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qge29uU2F2ZX0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGlzR3ltbmFzaXVtU3R1ZGVudCA9ICgnJyArIGVudi5jdXJyZW50VXNlci5zY2hvb2xUeXBlKS50b0xvd2VyQ2FzZSgpID09PSBcImd5bW5hc2l1bVwiO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgIDxoMj57aXNHeW1uYXNpdW1TdHVkZW50ID8gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxHeW1uYXNpdW1TY2hvb2xUaXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiTMOkZ2cgdGlsbCBydWJyaWtcIi8+IDogXG4gICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxQcmltYXJ5U2Nob29sVGl0bGVcIiBkZWZhdWx0TWVzc2FnZT1cIkzDpGdnIHRpbGwgZWdldCBsw6RyYW5kZW3DpWxcIi8+fTwvaDI+XG4gICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICB7aXNHeW1uYXNpdW1TdHVkZW50ID8gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxHeW1uYXNpdW1TY2hvb2xcIiBkZWZhdWx0TWVzc2FnZT1cIlJ1YnJpa1wiLz4gOiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmFkZExlYXJuaW5nR29hbFByaW1hcnlTY2hvb2xcIiBkZWZhdWx0TWVzc2FnZT1cIk3DpWxcIi8+IH1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgdGFiSW5kZXg9ezF9IHNpemU9ezUwfSBhdXRvRm9jdXNcbiAgICAgICAgICAgICAgICB2YWx1ZT17bGVhcm5pbmdHb2FsfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtlID0+IHRoaXMuc2V0U3RhdGUoe2xlYXJuaW5nR29hbDogZS50YXJnZXQudmFsdWV9KX0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCIgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8YnIgLz48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAgPGJ1dHRvblxuICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxuICAgICAgICAgIG9uQ2xpY2s9eygpPT5vblNhdmUobGVhcm5pbmdHb2FsKX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwic2F2ZVwiLz48L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFRleHRJbnB1dCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQnO1xuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XG5pbXBvcnQge0xhbmd1YWdlQ29udGV4dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgZW52IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgaXNUYXNrOiBib29sZWFuXG4gIG9uU2F2ZTogKG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgdXJsOiBzdHJpbmcpID0+IHZvaWQ7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBBZGRDdXN0b21UYXNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIG5hbWU6ICcnLFxuICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgdXJsOiAnJ1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBpc1Rhc2ssIG9uU2F2ZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgY29uc3QgaXNHeW1uYXNpdW1TdHVkZW50ID0gKCcnICsgZW52LmN1cnJlbnRVc2VyLnNjaG9vbFR5cGUpLnRvTG93ZXJDYXNlKCkgPT09IFwiZ3ltbmFzaXVtXCI7XG4gICAgXG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgIDxoMj57aXNHeW1uYXNpdW1TdHVkZW50ID8gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjdXN0b21UYXNrLmFkZFdvcmtHb2FsR3ltbmFzaXVtU2Nob29sVGl0bGVcIiBkZWZhdWx0TWVzc2FnZT1cIkzDpGdnIHRpbGwgdXBwZ2lmdFwiLz4gOiBcbiAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjdXN0b21UYXNrLmFkZFdvcmtHb2FsUHJpbWFyeVNjaG9vbFRpdGxlXCIgZGVmYXVsdE1lc3NhZ2U9XCJMw6RnZyB0aWxsIGVnZXQgYXJiZXRzbcOlbFwiLz59PC9oMj5cbiAgICAgICAgPGhyIC8+XG4gICAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLm5hbWVMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOiAnTmFtbid9KX1cbiAgICAgICAgICBpZD1cIkFkZEN1c3RvbVRhc2s6bmFtZVwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J2N1c3RvbVRhc2suZW50ZXJOYW1lUGxoZCcsIGRlZmF1bHRNZXNzYWdlOiAnQW5nZSBuYW1uLi4uJ30pfVxuICAgICAgICAgIHZhbHVlPXtuYW1lfVxuICAgICAgICAgIGF1dG9Gb2N1c1xuICAgICAgICAgIG9uQ2hhbmdlPXtuYW1lID0+IHRoaXMuc2V0U3RhdGUoe25hbWV9KX0gLz5cblxuICAgICAgICA8VGV4dEFyZWFGb3JtRmllbGRcbiAgICAgICAgICByb3dzPXs3fVxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonQmVza3Jpdm5pbmcnfSl9XG4gICAgICAgICAgaWQ9XCJBZGRDdXN0b21UYXNrOmRlc2NyaXB0aW9uXCJcbiAgICAgICAgICBwbGFjZWhvbGRlcj17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmFkZERlc2NyaXB0aW9uUGxoZCcsIGRlZmF1bHRNZXNzYWdlOiBcIkzDpGdnIHRpbGwgZW4gYmVza3Jpdm5pbmcuLi5cIn0pfVxuICAgICAgICAgIHZhbHVlPXtkZXNjcmlwdGlvbn1cbiAgICAgICAgICBvbkNoYW5nZT17ZGVzY3JpcHRpb249PnRoaXMuc2V0U3RhdGUoe2Rlc2NyaXB0aW9ufSl9IC8+XG5cbiAgICAgICAgPFRleHRJbnB1dFxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOidMw6Ruayd9KX0gXG4gICAgICAgICAgaWQ9XCJBZGRDdXN0b21UYXNrOnVybFwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJodHRwOi8vd3d3Li4uXCJcbiAgICAgICAgICB2YWx1ZT17dXJsfVxuICAgICAgICAgIG9uQ2hhbmdlPXt1cmwgPT4gdGhpcy5zZXRTdGF0ZSh7dXJsfSl9IC8+XG5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxuICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZSBidG4tZGVmYXVsdFwiXG4gICAgICAgICAgb25DbGljaz17KCkgPT4gb25TYXZlKG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwpfT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCJTcGFyYVwiLz48L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFRleHRJbnB1dCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQnO1xuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgVXNlclRhc2tzUmVwbyB9IGZyb20gJy4uLy4uL3JlcG9zL3VzZXItdGFza3MtcmVwbyc7XG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuXG50eXBlIFByb3BzID0ge1xuICAvLyBFZGl0IE1vZGVcbiAgbW9kZTogJ2FkZCc7XG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcbiAgY2xvc2VEaWFsb2c7XG4gIHVzZXJUYXNrc1JlcG86IFVzZXJUYXNrc1JlcG9cbn0gfCB7XG4gIG1vZGU6ICdlZGl0JztcbiAgdXNlclRhc2s6IFVzZXJUYXNrO1xuICBzdWJUYXNrOiBVc2VyU3ViVGFzaztcbiAgY2xvc2VEaWFsb2c6ICgpPT52b2lkO1xuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBBZGRPckVkaXRTdWJUYXNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XG4gICAgICBjb25zdCB7c3ViVGFza30gPSBwcm9wcztcbiAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgIG5hbWU6IHN1YlRhc2submFtZSB8fCAnJyxcbiAgICAgICAgZGVzY3JpcHRpb246IHN1YlRhc2suZGVzY3JpcHRpb24gfHwgJycsXG4gICAgICAgIHVybDogc3ViVGFzay51cmwgfHwgJydcbiAgICAgIH07XG4gICAgfSBlbHNlIHsgIFxuICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgbmFtZTogJycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgdXJsOiAnJ1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBzYXZlKCkge1xuICAgIC8vIFVwZGF0ZSByZXBvOlxuICAgIGNvbnN0IHtwcm9wc30gPSB0aGlzO1xuICAgIGNvbnN0IHt1c2VyVGFzaywgY2xvc2VEaWFsb2csIHVzZXJUYXNrc1JlcG99ID0gcHJvcHM7XG4gICAgY29uc3Qge25hbWUsIGRlc2NyaXB0aW9uLCB1cmx9ID0gdGhpcy5zdGF0ZTtcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XG4gICAgICAvLyBFZGl0IGV4aXN0aW5nOlxuICAgICAgdXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXQgPT4ge1xuICAgICAgICBjb25zdCB7c3ViVGFza3N9ID0gdXQ7XG4gICAgICAgIGlmIChzdWJUYXNrcykge1xuICAgICAgICAgIHV0LnN1YlRhc2tzID0gc3ViVGFza3MubWFwKHN0ID0+XG4gICAgICAgICAgICBzdC5pZCA9PT0gcHJvcHMuc3ViVGFzay5pZCA/IHsuLi5zdCwgbmFtZSwgZGVzY3JpcHRpb24sIHVybH0gOlxuICAgICAgICAgICAgey4uLnN0fVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDcmVhdGUgbmV3IHRhc2tcbiAgICAgIGNvbnN0IG5ld1N1YlRhc2sgPSB7XG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uLFxuICAgICAgICB1cmxcbiAgICAgIH07XG5cbiAgICAgIC8vIFVwZGF0ZSByZXBvOlxuICAgICAgdXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXQgPT4ge1xuICAgICAgICBpZiAoIXV0LnN1YlRhc2tzKSB7XG4gICAgICAgICAgdXQuc3ViVGFza3MgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICB1dC5zdWJUYXNrcyA9IHV0LnN1YlRhc2tzLmNvbmNhdChuZXdTdWJUYXNrKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIENsb3NlIGRpYWxvZ1xuICAgIGNsb3NlRGlhbG9nKCk7ICAgIFxuICB9XG5cbiAgZGVsZXRlKCkge1xuICAgIC8vIFVwZGF0ZSByZXBvOlxuICAgIGNvbnN0IHByb3BzID0gdGhpcy5wcm9wczsgIFxuICAgIGlmIChwcm9wcy5tb2RlICE9PSAnZWRpdCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbiBvbmx5IGRlbGV0ZSBpbiBlZGl0IG1vZGVcIik7XG4gICAgfVxuICAgIHByb3BzLnVzZXJUYXNrc1JlcG8udXBkYXRlKFtwcm9wcy51c2VyVGFza10sIHV0ID0+IHtcbiAgICAgIGlmICh1dC5zdWJUYXNrcykge1xuICAgICAgICB1dC5zdWJUYXNrcyA9IHV0LnN1YlRhc2tzLmZpbHRlcih0ID0+IHQuaWQgIT09IHByb3BzLnN1YlRhc2suaWQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gQ2xvc2UgZGlhbG9nOlxuICAgIHByb3BzLmNsb3NlRGlhbG9nKCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge25hbWUsIGRlc2NyaXB0aW9uLCB1cmx9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7cHJvcHN9ID0gdGhpcztcbiAgICBjb25zdCBpc0VkaXRNb2RlID0gcHJvcHMubW9kZSA9PT0gJ2VkaXQnO1xuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcbiAgICByZXR1cm4gPD5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgPGgyPntpc0VkaXRNb2RlID8gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5lZGl0U3VidGFza1wiIGRlZmF1bHRNZXNzYWdlPSdSZWRpZ2VyYSB1bmRlcnVwcGdpZnQnLz4gOiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImFkZGVkaXRzdWJ0YXNrLmFkZFN1YnRhc2tcIiBkZWZhdWx0TWVzc2FnZT0nTMOkZ2cgdGlsbCB1bmRlcnVwcGdpZnQnLz4gfTwvaDI+XG4gICAgICAgIDxociAvPlxuICAgICAgICA8VGV4dElucHV0XG4gICAgICAgICAgYXV0b0ZvY3VzXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidhZGRlZGl0c3VidGFzay5uYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonVW5kZXJ1cHBnaWZ0ZW5zIG5hbW4nfSl9XG4gICAgICAgICAgaWQ9XCJBZGRVc2VyU3ViVGFzazpuYW1lXCJcbiAgICAgICAgICBwbGFjZWhvbGRlcj1cIlwiXG4gICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUubmFtZX1cbiAgICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9XG4gICAgICAgICAgICAvPlxuICAgICAgICA8VGV4dEFyZWFGb3JtRmllbGRcbiAgICAgICAgICBsYWJlbD0ge2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J2NvbW1vbi5kZXNjcmlwdGlvbkxhYmVsJywgZGVmYXVsdE1lc3NhZ2U6J0Jlc2tyaXZuaW5nJ30pfVxuICAgICAgICAgIGlkPVwiQWRkVXNlclN1YlRhc2s6ZGVzY3JpcHRpb25cIlxuICAgICAgICAgIHJvd3M9ezd9XG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmRlc2NyaXB0aW9ufVxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbiA9PiB0aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPFRleHRJbnB1dFxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOidMw6Ruayd9KX1cbiAgICAgICAgICBpZD1cIkFkZFVzZXJTdWJUYXNrOnVybFwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnVybH1cbiAgICAgICAgICBvbkNoYW5nZT17dXJsID0+IHRoaXMuc2V0U3RhdGUoe3VybH0pfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgPGJyIC8+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAge1xuICAgICAgICAgIHByb3BzLm1vZGUgPT09ICdlZGl0JyAmJiA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiXG4gICAgICAgICAgb25DbGljaz17ZXYgPT4gdGhpcy5kZWxldGUoKX0+XG4gICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5kZWxldGVTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IHVuZGVydXBwZ2lmdFwiLz48L2J1dHRvbj59XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcbiAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5zYXZlKCl9PjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiY29tbW9uLnNhdmVcIiBkZWZhdWx0TWVzc2FnZT1cIlNwYXJhXCIvPjwvYnV0dG9uPlxuICAgICAgPC9kaXY+XG4gICAgPC8+XG4gIH1cbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVXNlclRhc2ssIFVzZXJTdWJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgUmVuYW1lYWJsZVRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvcmVuYW1lYWJsZS10ZXh0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBnZXRUYXNrVHlwZSB9IGZyb20gJy4vZ2V0LXRhc2stdHlwZSc7XG5pbXBvcnQgUmVhY3REYXRlUGlja2VyLCB7IFJlYWN0RGF0ZVBpY2tlclByb3BzIH0gZnJvbSAncmVhY3QtZGF0ZXBpY2tlcic7XG5pbXBvcnQgJy4uLy4uL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZSc7XG5pbXBvcnQge1RleHRJbnB1dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZCc7XG5pbXBvcnQgeyBBZGRPckVkaXRTdWJUYXNrIH0gZnJvbSAnLi9hZGQtb3ItZWRpdC1zdWItdGFzayc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcbmltcG9ydCB7IFVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XG5pbXBvcnQgeyBGb3JtYXR0ZWRNZXNzYWdlIH0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQge0xhbmd1YWdlQ29udGV4dH0gZnJvbSBcIi4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHRcIlxuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB1c2VyVGFzazogVXNlclRhc2s7XG4gIG9uVXBkYXRlOiAodXBkYXRlcjogKHVzZXJUYXNrOiBVc2VyVGFzaykgPT4gdm9pZCkgPT4gdm9pZDtcbiAgb25EZWxldGU6ICh1c2VyVGFza0lkOiBzdHJpbmcpID0+IHZvaWQ7XG4gIG9wZW5EaWFsb2c6IChkaWFsb2cpID0+IHZvaWQ7XG4gIGNsb3NlRGlhbG9nOiAoKT0+dm9pZDtcbiAgdXNlclRhc2tzUmVwbzogVXNlclRhc2tzUmVwb1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICB1c2VyVGFzazogVXNlclRhc2s7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGRlYWRsaW5lPzogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgc3ViVGFza3M/OiBVc2VyU3ViVGFza1tdO1xuICBzaG93Q2FsZW5kYXI/OiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgRWRpdFVzZXJUYXNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGRhdGVQaWNrZXI6IGFueTtcbiAgc3RhdGljIGNvbnRleHRUeXBlID0gTGFuZ3VhZ2VDb250ZXh0O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgdXNlclRhc2s6IHByb3BzLnVzZXJUYXNrLFxuICAgICAgbmFtZTogcHJvcHMudXNlclRhc2submFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBwcm9wcy51c2VyVGFzay5kZXNjcmlwdGlvbixcbiAgICAgIHVybDogcHJvcHMudXNlclRhc2sudXJsLFxuICAgICAgZGVhZGxpbmU6IHByb3BzLnVzZXJUYXNrLmRlYWRsaW5lLFxuICAgICAgc3ViVGFza3M6IHByb3BzLnVzZXJUYXNrLnN1YlRhc2tzXG4gICAgfVxuICAgIHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkID0gdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucHJvcHMudXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vblVzZXJUYXNrc0NoYW5nZWQpO1xuICB9XG5cbiAgb25Vc2VyVGFza3NDaGFuZ2VkKHVzZXJUYXNrczogVXNlclRhc2tbXSkge1xuICAgIGNvbnN0IG15VXNlclRhc2sgPSB1c2VyVGFza3MuZmluZCh1dCA9PiB1dC5pZCA9PT0gdGhpcy5wcm9wcy51c2VyVGFzay5pZCk7XG4gICAgaWYgKCFteVVzZXJUYXNrKSB7XG4gICAgICB0aGlzLnByb3BzLmNsb3NlRGlhbG9nKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdXNlclRhc2s6IG15VXNlclRhc2ssXG4gICAgICBzdWJUYXNrczogbXlVc2VyVGFzay5zdWJUYXNrc1xuICAgIH0pO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcbiAgfVxuXG4gIGlzTW9kaWZpZWQoKSB7XG4gICAgLy8gRG9uJ3QgY291bnQgc3VidGFzayBjaGFuZ2VzISBUaGV5IGxpdmUgdGhlaXIgb3duIGxpZmUgYW5kIGlzIG1haW50YWluZWRcbiAgICAvLyBpbiBhZGQtb3ItZWRpdC1zdWItdGFzay50c3guIFJlYXNvbjogVXNlciB3b3VsZCBleHBlY3QgYWRkZWQgL2VkaXRlZCBzdWJ0YXNrc1xuICAgIC8vIHRvIGJlIHBlcnNpc3RlZCByaWdodCBhd2F5LiBNYXkgY2xpY2sgYXdheSB0aGlzIGRpYWxvZy5cbiAgICAvLyBBbHNvIHJlYXNvbjogQ2FuIGludm9rZSB0aGF0IGRpYWxvZyBieSBpdHNlbGYgZnJvbSBvdGhlciBjb21wb25lbnRzLiBGcm9tIFdlZWtQbGFubmVyXG4gICAgLy8gd2hlbiBjbGlja2luZyB0aGUgc3VidGFzayBmb3IgZXhhbXBsZSFcblxuICAgIGNvbnN0IHtkZWFkbGluZSwgZGVzY3JpcHRpb24sIG5hbWUsIHVybCwgdXNlclRhc2t9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gKFxuICAgICAgZGVhZGxpbmUgIT09IHVzZXJUYXNrLmRlYWRsaW5lIHx8XG4gICAgICBkZXNjcmlwdGlvbiAhPT0gdXNlclRhc2suZGVzY3JpcHRpb24gfHxcbiAgICAgIG5hbWUgIT09IHVzZXJUYXNrLm5hbWUgfHxcbiAgICAgIHVybCAhPT0gdXNlclRhc2sudXJsKTtcbiAgfVxuXG4gIGFkZFN1YlRhc2soKTogYW55IHtcbiAgICB0aGlzLnByb3BzLm9wZW5EaWFsb2coPEFkZE9yRWRpdFN1YlRhc2tcbiAgICAgIG1vZGU9XCJhZGRcIlxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XG4gICAgICBjbG9zZURpYWxvZz17dGhpcy5wcm9wcy5jbG9zZURpYWxvZ31cbiAgICAgIHVzZXJUYXNrc1JlcG89e3RoaXMucHJvcHMudXNlclRhc2tzUmVwb31cbiAgICAvPik7XG4gIH1cblxuICBlZGl0U3ViVGFzayhzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xuICAgIHRoaXMucHJvcHMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xuICAgICAgbW9kZT1cImVkaXRcIlxuICAgICAgc3ViVGFzaz17c3ViVGFza31cbiAgICAgIHVzZXJUYXNrPXt0aGlzLnN0YXRlLnVzZXJUYXNrfVxuICAgICAgY2xvc2VEaWFsb2c9e3RoaXMucHJvcHMuY2xvc2VEaWFsb2d9XG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XG4gICAgLz4pO1xuICB9XG4gIFxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgdXJsLCBkZWFkbGluZSwgc3ViVGFza3MsIHNob3dDYWxlbmRhciwgdXNlclRhc2sgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgeyBpZCwgY291cnNlTmFtZSB9ID0gdXNlclRhc2s7XG4gICAgY29uc3QgeyBvblVwZGF0ZSwgb25EZWxldGUgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgaXNNb2RpZmllZCA9IHRoaXMuaXNNb2RpZmllZCgpO1xuXG4gICAgY29uc3QgdGFza1R5cGUgPSBnZXRUYXNrVHlwZSh1c2VyVGFzayk7XG4gICAgY29uc3QgaXNDdXN0b21UYXNrID0gdGFza1R5cGUgPT09ICdjdXN0b21UYXNrJztcbiAgICBjb25zdCBleHBpcmVkID0gbW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKSA8IG1vbWVudCgpO1xuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImVkaXRUYXNrRGlhbG9nIHN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICA8aDI+e2lzQ3VzdG9tVGFzayA/IFxuICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInRhc2suZWRpdFdvcmtHb2Fsc1wiIGRlZmF1bHRNZXNzYWdlPSdSZWRpZ2VyYSBhcmJldHNtw6VsJy8+IDogXG4gICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGFzay5lZGl0VGFza1wiIGRlZmF1bHRNZXNzYWdlPSdSZWRpZ2VyYSB1cHBnaWZ0Jy8+fVxuICAgICAgPC9oMj5cbiAgICAgIDxociAvPlxuICAgICAgPFRleHRJbnB1dFxuICAgICAgICBhdXRvRm9jdXNcbiAgICAgICAgbGFiZWw9e2lzQ3VzdG9tVGFzayA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLnRhcmdldE5hbWVMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOiAnQXJiZXRzbcOlbGV0cyBuYW1uJ30pICA6IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLnRhc2tOYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTogJ1VwcGdpZnRlbnMgbmFtbid9KX1cbiAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6bmFtZVwiXG4gICAgICAgIHBsYWNlaG9sZGVyPXtpc0N1c3RvbVRhc2sgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndGFzay53aGF0U2hvdWxkWW91RG9QbGhkJywgZGVmYXVsdE1lc3NhZ2U6ICdWYWQgc2thIGR1IGfDtnJhPyd9KSA6IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLmVudGVyVGFza05hbWVQbGhkJywgZGVmYXVsdE1lc3NhZ2U6ICdBbmdlIHVwcGdpZnRlbnMgbmFtbi4uLid9KSB9XG4gICAgICAgIHZhbHVlPXtuYW1lfVxuICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XG4gICAgICBcbiAgICAgIHtpc0N1c3RvbVRhc2sgJiYgPD5cbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXG4gICAgICAgICAgcm93cz17NX1cbiAgICAgICAgICBsYWJlbD0ge2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICdjb21tb24uZGVzY3JpcHRpb25MYWJlbCcsIGRlZmF1bHRNZXNzYWdlOiAnQmVza3Jpdm5pbmcnfSl9XG4gICAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6ZGVzY3JpcHRpb25cIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAnY29tbW9uLmFkZERlc2NyaXB0aW9uUGxoZCcsIGRlZmF1bHRNZXNzYWdlOiAnTMOkZ2cgdGlsbCBlbiBiZXNrcml2bmluZy4uLid9KX1cbiAgICAgICAgICB2YWx1ZT17ZGVzY3JpcHRpb259XG4gICAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uPT50aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfSAvPlxuXG4gICAgICAgIDxUZXh0SW5wdXRcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOlwiTMOkbmtcIn0pfVxuICAgICAgICAgIGlkPVwiRWR1dFVzZXJUYXNrOnVybFwiXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJodHRwKHMpOi8vLi4uXCJcbiAgICAgICAgICB2YWx1ZT17dXJsfVxuICAgICAgICAgIG9uQ2hhbmdlPXt1cmwgPT4gdGhpcy5zZXRTdGF0ZSh7dXJsfSl9ID5cblxuICAgICAgICA8L1RleHRJbnB1dD48Lz59XG5cbiAgICAgICAgPEZvcm1GaWVsZCBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2suc2V0RGVhZGxpbmUnLCBkZWZhdWx0TWVzc2FnZTogJ0FuZ2UgZGVhZGxpbmUnfSl9PlxuICAgICAgICAgIHsoZGVhZGxpbmUgfHwgc2hvd0NhbGVuZGFyKSA/XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICA8UmVhY3REYXRlUGlja2VyIHJlZj17ZWxlbSA9PiB0aGlzLmRhdGVQaWNrZXIgPSBlbGVtfVxuICAgICAgICAgICAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6ZGVhZGxpbmVcIlxuICAgICAgICAgICAgICAgICAgbmV4dE1vbnRoQnV0dG9uTGFiZWw9XCJcIiBcbiAgICAgICAgICAgICAgICAgIHByZXZpb3VzTW9udGhCdXR0b25MYWJlbD1cIlwiIFxuICAgICAgICAgICAgICAgICAgc2hvd1dlZWtOdW1iZXJzPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ9e2RlYWRsaW5lICYmIG1vbWVudChkZWFkbGluZSkudG9EYXRlKCl9XG4gICAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e3Nob3dDYWxlbmRhcn1cbiAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQ9XCJ5eXl5LU1NLWRkXCJcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17ZXhwaXJlZCA/IFwiZXhwaXJlZFwiIDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgbG9jYWxlPXtpbnRsLmxvY2FsZX1cbiAgICAgICAgICAgICAgICAgIHBvcHBlclBsYWNlbWVudD17aXNDdXN0b21UYXNrID8gXCJ0b3Atc3RhcnRcIiA6IFwiYm90dG9tLXN0YXJ0XCJ9XG4gICAgICAgICAgICAgICAgICBvbkJsdXI9eygpPT50aGlzLnNldFN0YXRlKHtzaG93Q2FsZW5kYXI6IGZhbHNlfSl9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dmFsdWU9PntcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgZGVhZGxpbmU6IHZhbHVlICYmIG1vbWVudCh2YWx1ZSkuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FsZW5kYXI6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJkZWxldGVEYXRlXCIgaHJlZj1cIiNcIiB0aXRsZT17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2sucmVtb3ZlRGVhZGxpbmUnLCBkZWZhdWx0TWVzc2FnZTogJ1RhIGJvcnQgZGVhZGxpbmUnfSl9IG9uQ2xpY2s9e2V2PT57XG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7ZGVhZGxpbmU6IG51bGwsIHNob3dDYWxlbmRhcjogZmFsc2V9KTtcbiAgICAgICAgICAgICAgICB9fT48L2E+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+IDpcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9wXCIgcmVmPXsoKT0+e3RoaXMuZGF0ZVBpY2tlciA9IG51bGx9fT5cbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRlUGlja2VyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0ZVBpY2tlci5zZXRPcGVuKHRydWUpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHNob3dDYWxlbmRhcjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfX0+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2FsZW5kYXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnNldERlYWRsaW5lTGFiZWxcIiBkZWZhdWx0TWVzc2FnZT1cIkFuZ2UgZGVhZGxpbmUuLi5cIi8+XG4gICAgICAgICAgICAgIDwvYT4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgPC9kaXY+fVxuICAgICAgICA8L0Zvcm1GaWVsZD5cbiAgICAgIDxGb3JtRmllbGQgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLnN1YlRhc2tzJywgZGVmYXVsdE1lc3NhZ2U6ICdVbmRlcnVwcGdpZnRlcid9KX0gPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxlYXJuaW5nR29hbFRhc2tzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XG5cbiAgICAgICAgICAgICAge3N1YlRhc2tzICYmIHN1YlRhc2tzLm1hcChzdWJUYXNrID0+IDxkaXYga2V5PXtzdWJUYXNrLmlkfSBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj48YVxuICAgICAgICAgICAgICAgICAgb25DbGljaz17KCk9PnRoaXMuZWRpdFN1YlRhc2soc3ViVGFzayl9XG4gICAgICAgICAgICAgICAgICBocmVmPVwiI1wiPntzdWJUYXNrLm5hbWV9PC9hPjwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0b3BcIj5cbiAgICAgICAgICAgIDxidXR0b24gaWQ9XCJFZGl0VXNlclRhc2s6YWRkU3ViVGFza1wiIGNsYXNzTmFtZT1cImJ0blwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLmFkZFN1YlRhc2soKX0+XG4gICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGFzay5hZGRTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJMw6RnZyB0aWxsIHVuZGVydXBwZ2lmdFwiLz5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvRm9ybUZpZWxkPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZpZGVyIGxhcmdlXCIgLz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxCdXR0b24gdG9wXCI+XG4gICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdFwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xuICAgICAgICAgICAgICBpc01vZGlmaWVkID8gb25VcGRhdGUodXNlclRhc2sgPT4ge1xuICAgICAgICAgICAgICAgIHVzZXJUYXNrLm5hbWUgPSBuYW1lO1xuICAgICAgICAgICAgICAgIHVzZXJUYXNrLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgdXNlclRhc2sudXJsID0gdXJsO1xuICAgICAgICAgICAgICAgIHVzZXJUYXNrLmRlYWRsaW5lID0gZGVhZGxpbmU7XG4gICAgICAgICAgICAgIH0pIDogdGhpcy5wcm9wcy5jbG9zZURpYWxvZygpO1xuICAgICAgICAgICAgfX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwiU3BhcmFcIi8+IFxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxCdXR0b24gdG9wXCI+XG4gICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0blwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xuICAgICAgICAgICAgICB0aGlzLnByb3BzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgICAgICB9fT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5jYW5jZWxcIiBkZWZhdWx0TWVzc2FnZT1cIkF2YnJ5dFwiLz48L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29uZmlybSB0b3AgcHVsbC1yaWdodFwiPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpPT57XG4gICAgICAgICAgICAgIG9uRGVsZXRlKGlkKTtcbiAgICAgICAgICAgIH19Pntpc0N1c3RvbVRhc2sgP1xuICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInRhc2sucmVtb3ZlV29ya0dvYWxzXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IGFyYmV0c23DpWxcIi8+IDpcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnJlbW92ZVRoaXNUYXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IGRlbiBow6RyIHVwcGdpZnRlblwiLz5cbiAgICAgICAgICB9PC9idXR0b24+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICBcbiAgICAgIHsvKjxkaXYgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17ZXYgPT4gb25EZWxldGUoaWQpfT5cbiAgICAgICAge0xgVGEgYm9ydCBhcmJldHNtw6VsYH08L2Rpdj5cbiAgICAgIHtpc01vZGlmaWVkICYmXG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcbiAgICAgICAgICB0YWJJbmRleD17MH1cbiAgICAgICAgICBvbkNsaWNrPXsoKT0+b25VcGRhdGUodXNlclRhc2sgPT4ge1xuICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XG4gICAgICAgICAgICB1c2VyVGFzay5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdXNlclRhc2sudXJsID0gdXJsO1xuICAgICAgICAgIH0pfT4gU3BhcmE8L2Rpdj59Ki99XG4gICAgPC9kaXY+XG4gIH1cbn1cblxuIiwiaW1wb3J0IHsgVXNlclRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhc2tUeXBlICh1c2VyVGFzazogVXNlclRhc2spIDogJ2NvdXJzZUJ1aWxkZXJUYXNrJyB8ICdzaXRlVmlzaW9uVGFzaycgfCAnc3ViamVjdFBsYW5uZXJUYXNrJyB8ICdjdXN0b21UYXNrJyB7XG4gIHJldHVybiB1c2VyVGFzay5jb3Vyc2UgJiYgdXNlclRhc2sudGFzayAmJiB1c2VyVGFzay5jb3Vyc2UubGVuZ3RoID4gMCAmJiB1c2VyVGFzay50YXNrLmxlbmd0aCA+IDAgP1xuICAgICdjb3Vyc2VCdWlsZGVyVGFzaycgOlxuICAgIHVzZXJUYXNrLnNpdGVWaXNpb25QYWdlSWQgP1xuICAgICAgJ3NpdGVWaXNpb25UYXNrJyA6XG4gICAgICAgIHVzZXJUYXNrLmNvdXJzZUluZm8gP1xuICAgICAgICAgICdzdWJqZWN0UGxhbm5lclRhc2snIDpcbiAgICAgICAgICAnY3VzdG9tVGFzayc7XG59XG4iLCJpbXBvcnQgeyBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IFVzZXJUYXNrc0JveFByb3BzIH0gZnJvbSAnLi91c2VyLXRhc2tzLWJveCc7XG5pbXBvcnQgeyBhcnJheVRvTWFwLCBhcnJheVRvTG9va3VwLCBjb21wYXJlUHJvcCwgTCB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZpcnR1YWxMZWFybmluZ0dvYWwge1xuICBuYW1lOiBzdHJpbmc7XG4gIGFsbFRhc2tzOiBVc2VyVGFza1tdO1xuICBzdGVwPzogbnVtYmVyO1xuICB1cmw/OiBzdHJpbmc7XG4gIHRhc2tzOiBVc2VyVGFza1tdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVmaW5lKHRhc2tzOiBVc2VyVGFza1tdKSB7XG4gIGNvbnN0IHJlc3VsdCA9IFtdIGFzIFBhcnRpYWw8VXNlclRhc2tzQm94UHJvcHM+W107XG4gIGNvbnN0IG1hcHBlciA9IHt9IGFzIHsgW25hbWU6IHN0cmluZ106IFVzZXJUYXNrc0JveFByb3BzIH07XG4gIGNvbnN0IHRhc2tzUGVyQ291cnNlID0gYXJyYXlUb0xvb2t1cCh0YXNrcywgdCA9PiB0LmNvdXJzZU5hbWUgfHwgJycpO1xuICBmb3IgKGNvbnN0IGNvdXJzZU5hbWUgb2YgT2JqZWN0LmtleXModGFza3NQZXJDb3Vyc2UpLnNvcnQoKS5maWx0ZXIoeCA9PiB4KS5jb25jYXQodGFza3NQZXJDb3Vyc2VbJyddID9cbiAgICBbJyddIDogW10pKSB7XG4gICAgY29uc3QgY291cnNlVGFza3MgPSB0YXNrc1BlckNvdXJzZVtjb3Vyc2VOYW1lXSB8fCB0YXNrc1BlckNvdXJzZVsnJ107XG4gICAgY29uc3QgdGFza3NQZXJMZWFybmluZ0dvYWwgPSBhcnJheVRvTG9va3VwKGNvdXJzZVRhc2tzLCB0ID0+IHQubGVhcm5pbmdHb2FsKTtcbiAgICBjb25zdCByZXN1bHRMZWFybmluZ0dvYWxzOiBWaXJ0dWFsTGVhcm5pbmdHb2FsW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IGxlYXJuaW5nR29hbCBvZiBPYmplY3Qua2V5cyh0YXNrc1BlckxlYXJuaW5nR29hbCkpIHtcbiAgICAgIGNvbnN0IGxnVGFza3MgPSB0YXNrc1BlckxlYXJuaW5nR29hbFtsZWFybmluZ0dvYWxdLnNvcnQoY29tcGFyZVByb3AoXCJkYXRlVGltZVwiKSk7XG4gICAgICBjb25zdCBsZWFybmluZ0dvYWxUYXNrID0gbGdUYXNrc1xuICAgICAgICAuZmlsdGVyKHQgPT4gdC5uYW1lID09IG51bGwpIC8vIElmIG5hbWUgaXMgdW5kZWZpbmVkIG9yIG51bGwsIHRoaXMgcmVwcmVzZW50cyBhIGxlYXJuaW5nIGdvYWxcbiAgICAgICAgWzBdO1xuICAgICAgY29uc3QgdXJsID0gbGVhcm5pbmdHb2FsVGFzayAmJiBsZWFybmluZ0dvYWxUYXNrLnVybDtcbiAgICAgIHJlc3VsdExlYXJuaW5nR29hbHMucHVzaCh7XG4gICAgICAgIG5hbWU6IGxlYXJuaW5nR29hbCxcbiAgICAgICAgYWxsVGFza3M6IGxnVGFza3MsXG4gICAgICAgIHVybCxcbiAgICAgICAgc3RlcDogbGdUYXNrcy5tYXAodCA9PiB0LnN0ZXApLmZpbHRlcihzdGVwID0+IHN0ZXApWzBdLFxuICAgICAgICB0YXNrczogbGdUYXNrcy5maWx0ZXIodCA9PiB0Lm5hbWUpXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmVzdWx0LnB1c2goe1xuICAgICAgY291cnNlTmFtZSxcbiAgICAgIGxlYXJuaW5nR29hbHM6IHJlc3VsdExlYXJuaW5nR29hbHNcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgVXNlclRhc2ssIFRhc2ssIFVzZXJTdWJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gJy4uLy4uL2FjY2Vzcy1jb250cm9sJztcbmltcG9ydCB7IGNvdXJzZU5hbWVUb0Nzc0NsYXNzIH0gZnJvbSAnLi4vY2FsZW5kYXIvY291cnNlLW5hbWUtdG8tY3NzLWNsYXNzJztcbmltcG9ydCB7IGdldFRhc2tUeXBlIH0gZnJvbSAnLi9nZXQtdGFzay10eXBlJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IFZpcnR1YWxMZWFybmluZ0dvYWwgfSBmcm9tICcuL3JlZmluZXInO1xuaW1wb3J0IHsgRmVhdHVyZXMgfSBmcm9tICcuLi8uLi9mZWF0dXJlcyc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xuaW1wb3J0IHsgZW52IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxuZXhwb3J0IGludGVyZmFjZSBVc2VyVGFza3NCb3hQcm9wcyB7XG4gIGNvdXJzZU5hbWU6IHN0cmluZztcbiAgbGVhcm5pbmdHb2FsczogVmlydHVhbExlYXJuaW5nR29hbFtdLFxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XG4gIG9wZW5Db3Vyc2VzPzogeyBbcGF0aDogc3RyaW5nXTogYm9vbGVhbiB9O1xuICBzZXRJc09wZW4/OiAoY291cnNlTmFtZTogc3RyaW5nLCBpc09wZW46IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHNldFRhc2tEb25lPzogKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xuICBzZXRTdWJUYXNrRG9uZTogKHRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaywgZG9uZTogYm9vbGVhbikgPT4gdm9pZDtcbiAgYWRkT3duVGFzaz86IChjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykgPT4gdm9pZDtcbiAgZWRpdFRhc2s6ICh0YXNrOiBVc2VyVGFzaykgPT4gdm9pZDtcbiAgZWRpdFN1YlRhc2s6ICh0YXNrOiBVc2VyVGFzaywgc3ViVGFzazogVXNlclN1YlRhc2spID0+IHZvaWQ7XG4gIHJlbW92ZUxlYXJuaW5nR29hbDogKGxnOiBWaXJ0dWFsTGVhcm5pbmdHb2FsKT0+dm9pZDtcbiAgZGlzcGxheVByb2dyZXNzOiBib29sZWFuO1xuICBwcm9ncmVzc0RhdGE6IHtjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXIsIG51bWJlck9mVGFza3M6IG51bWJlcn07XG59O1xuXG5leHBvcnQgY2xhc3MgVXNlclRhc2tzQm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFVzZXJUYXNrc0JveFByb3BzPiB7XG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcbiAgY29uc3RydWN0b3IocHJvcHM6IFVzZXJUYXNrc0JveFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICB9XG5cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgY291cnNlTmFtZSxcbiAgICAgIGxlYXJuaW5nR29hbHMsIFxuICAgICAgcHJvZ3Jlc3NEYXRhLFxuICAgICAgZGlzcGxheVByb2dyZXNzXG4gICAgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgaXNPcGVuID0gISF0aGlzLnByb3BzLm9wZW5Db3Vyc2VzW2NvdXJzZU5hbWVdO1xuICAgIGNvbnN0IGZlYXR1cmVzID0gbmV3IEZlYXR1cmVzKCk7XG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5jb250ZXh0O1xuICAgIGNvbnN0IGlzR3ltbmFzaXVtU3R1ZGVudCA9ICgnJyArIGVudi5jdXJyZW50VXNlci5zY2hvb2xUeXBlKS50b0xvd2VyQ2FzZSgpID09PSBcImd5bW5hc2l1bVwiO1xuXG4gICAgcmV0dXJuIDxPcGVuQ2xvc2VCb3hcbiAgdGl0bGU9ezxoNT57Y291cnNlTmFtZSB8fCAoaXNHeW1uYXNpdW1TdHVkZW50ID8gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ1c2VyVGFza3MuZ3ltbmFzaXVtU2Nob29sR29hbHNcIiAgZGVmYXVsdE1lc3NhZ2U9XCLDlnZyaWdhIHVwcGdpZnRlclwiLz4gOiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cInVzZXJUYXNrcy5wcmltYXJ5U2Nob29sR29hbHNcIiAgZGVmYXVsdE1lc3NhZ2U9XCJFZ25hIGzDpHJhbmRlbcOlbFwiLz4pIH08L2g1Pn1cbiAgICAgIGhlYWRlck9wZW49e2lzT3Blbn1cbiAgICAgIGNsYXNzTmFtZT17Y291cnNlTmFtZSAmJiBjb3Vyc2VOYW1lVG9Dc3NDbGFzcygnd3AtY291cnNlLScsIGNvdXJzZU5hbWUpfVxuICAgICAgb25PcGVuQ2xvc2U9e2JlY2FtZU9wZW4gPT4gdGhpcy5wcm9wcy5zZXRJc09wZW4oY291cnNlTmFtZSwgYmVjYW1lT3Blbil9XG4gICAgICBkaXNwbGF5UHJvZ3Jlc3M9IHtkaXNwbGF5UHJvZ3Jlc3N9ICAgICAgIFxuICAgICAgcHJvZ3Jlc3NEYXRhID0ge3Byb2dyZXNzRGF0YX1cbiAgICAgID5cbiAgICAgIHtsZWFybmluZ0dvYWxzLm1hcChsZyA9PlxuICAgICAgICA8ZGl2IGtleT17bGcubmFtZX0gY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsQ29udGFpbmVyXCI+XG4gICAgICAgICAge2xnLnN0ZXAgJiYgPGRpdiBjbGFzc05hbWU9XCJzdGVwSW5kaWNhdG9yXCI+e2xnLnN0ZXB9PC9kaXY+fVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUZXh0IGhvcml6b250YWxJdGVtIHRvcFwiPntsZy5uYW1lfTwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxuICAgICAgICAgICAgICAmbmJzcDs8YVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRyYXNoXCJcbiAgICAgICAgICAgICAgICBocmVmPVwiI1wiXG4gICAgICAgICAgICAgICAgIHRpdGxlPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid1c2VyVGFza3MuZGVsZXRlTGVhcm5pbmdHb2FsJywgZGVmYXVsdE1lc3NhZ2U6ICdUYSBib3J0IGzDpHJhbmRlbcOlbGV0IG9jaCBkZXNzIHVwcGdpZnRlcid9KX1cbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtldj0+e1xuICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMucmVtb3ZlTGVhcm5pbmdHb2FsKGxnKTtcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtdHJhc2hcIiAvPlxuICAgICAgICAgICAgICA8L2E+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsVGFza3NcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAgICAgICAgICB7bGcudGFza3MubWFwKHVzZXJUYXNrID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc1dvcmtpbmcgPSB1c2VyVGFzay4kbWV0YSA9PT0gJ2FkZGluZycgfHwgdXNlclRhc2suJG1ldGEgPT09ICdkZWxldGluZycgfHwgdXNlclRhc2suJG1ldGEgPT09ICd1cGRhdGluZyc7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0YXNrVHlwZSA9IGdldFRhc2tUeXBlKHVzZXJUYXNrKTtcbiAgICAgICAgICAgICAgICBjb25zdCBleHBpcmVkID0gbW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKS5zdGFydE9mKCdkYXknKSA8IG1vbWVudCgpLnN0YXJ0T2YoJ2RheScpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxkaXYga2V5PXt1c2VyVGFzay5pZH0gc3R5bGU9e2lzV29ya2luZyA/IHsgb3BhY2l0eTogMC41IH0gOiB7fX0+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKHVzZXJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+ICFpc1dvcmtpbmcgJiYgdGhpcy5wcm9wcy5zZXRUYXNrRG9uZSh1c2VyVGFzaywgIXVzZXJUYXNrLmRvbmUpfT5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAge3Rhc2tUeXBlID09PSAnY291cnNlQnVpbGRlclRhc2snID9cbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dldFRhc2tVcmwodXNlclRhc2ssIHRoaXMucHJvcHMudmlld0NvdXJzZVVybCl9Pnt1c2VyVGFzay5uYW1lfTwvYT4gOlxuICAgICAgICAgICAgICAgICAgICAgICB0YXNrVHlwZSA9PT0gJ3N1YmplY3RQbGFubmVyVGFzaycgP1xuICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17Z2V0U3ViamVjdFBsYW5uZXJUYXNrVXJsKHVzZXJUYXNrKX0+e3VzZXJUYXNrLm5hbWV9PC9hPiA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrVHlwZSA9PT0gJ3NpdGVWaXNpb25UYXNrJyA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e3VzZXJUYXNrLnVybH0+e3VzZXJUYXNrLm5hbWV9PC9hPiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXshdXNlclRhc2sudXJsID8gXCJsaW5rLWxlc3NcIjogXCJcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmPXt1c2VyVGFzay51cmwgfHwgdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD17KHVzZXJUYXNrLnVybCsnJykudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGxvY2F0aW9uLmhvc3QudG9Mb3dlckNhc2UoKSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfc2VsZlwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX2JsYW5rXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgICAgID57dXNlclRhc2submFtZX08L2E+fVxuICAgICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5kZWFkbGluZSAmJiA8ZGl2IGNsYXNzTmFtZT17XCJkYXRlU2V0XCIgKyAoZXhwaXJlZCA/ICcgZXhwaXJlZCcgOiAnJyl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPGkgdGl0bGU9e21vbWVudCh1c2VyVGFzay5kZWFkbGluZSkuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKX0gY2xhc3NOYW1lPVwiZmEgZmEtY2FsZW5kYXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+e319PjwvaT5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgdGFza0VkaXRcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImVkaXRJdGVtXCIgb25DbGljaz17KCkgPT4gdGhpcy5wcm9wcy5lZGl0VGFzayh1c2VyVGFzayl9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5zdWJUYXNrcyAmJiA8ZGl2IGNsYXNzTmFtZT1cInN1YnRhc2tzXCI+XG4gICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5zdWJUYXNrcy5tYXAoc3ViVGFzayA9PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYga2V5PXtzdWJUYXNrLmlkfSA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImNoZWNrQm94XCIgKyAoc3ViVGFzay5kb25lID8gXCIgY2hlY2tlZFwiIDogXCJcIil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZXYgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpc1dvcmtpbmcgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMuc2V0U3ViVGFza0RvbmUodXNlclRhc2ssIHN1YlRhc2ssICFzdWJUYXNrLmRvbmUpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZj17c3ViVGFzay51cmwgfHwgdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldD17KHVzZXJUYXNrLnVybCsnJykudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKGxvY2F0aW9uLmhvc3QudG9Mb3dlckNhc2UoKSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX3NlbGZcIiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViVGFzay51cmwgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGluay1sZXNzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICB9PntzdWJUYXNrLm5hbWV9PC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCB0YXNrRWRpdFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJlZGl0SXRlbVwiIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMuZWRpdFN1YlRhc2sodXNlclRhc2ssIHN1YlRhc2spfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+KX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsVG9vbHNcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGFkZE93bkdvYWxcIlxuICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmFkZE93blRhc2sodGhpcy5wcm9wcy5jb3Vyc2VOYW1lLCBsZy5uYW1lKX0+XG4gICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IHtpc0d5bW5hc2l1bVN0dWRlbnQgPyBcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5sZWFybmluZ0dvYWxHeW1uYXNpdW1cIiBkZWZhdWx0TWVzc2FnZT1cIlVwcGdpZnRcIi8+OlxuICAgICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD0ndXNlclRhc2tzLmFkZExlYXJuaW5nR29hbCcgZGVmYXVsdE1lc3NhZ2U9J0VnZXQgYXJiZXRzbcOlbCcvPlxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxiciAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9PcGVuQ2xvc2VCb3g+XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0VGFza1VybCh1c2VyVGFzazogVXNlclRhc2ssIHZpZXdDb3Vyc2VVcmw6IHN0cmluZykge1xuICBpZiAodXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLmNvdXJzZS5sZW5ndGggPiAwICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgY291cnNlVXJsID0gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkodmlld0NvdXJzZVVybCwgeyBjb3Vyc2VJZDogdXNlclRhc2suY291cnNlWzBdLmlkIH0pO1xuICAgIHJldHVybiBgJHtjb3Vyc2VVcmx9Iy90YXNrLyR7dXNlclRhc2sudGFza1swXS5pZH1gO1xuICB9XG4gIHJldHVybiB1c2VyVGFzay51cmw7XG59XG5cbmZ1bmN0aW9uIGdldFN1YmplY3RQbGFubmVyVGFza1VybCh1c2VyVGFzazogVXNlclRhc2spIHtcbiAgaWYgKHVzZXJUYXNrLmNvdXJzZUluZm8gJiYgdXNlclRhc2sudGFzayAmJiB1c2VyVGFzay50YXNrLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB7c2Nob29sLCBjb3Vyc2UsIHRhYiB9ID0gdXNlclRhc2suY291cnNlSW5mbztcbiAgICBjb25zdCBjb3Vyc2VVcmwgPSBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeShjZmcuS0VEX1NVQkpFQ1RfUExBTk5FUl9VUkwsIHt9KTtcbiAgICByZXR1cm4gYCR7Y291cnNlVXJsfSMvJHtzY2hvb2x9L2NvdXJzZXMvJHtjb3Vyc2V9L3RhYnMvJHt0YWJ9L3Rhc2tzLyR7dXNlclRhc2sudGFza1swXS5pZH1gO1xuICB9XG4gIHJldHVybiB1c2VyVGFzay51cmw7XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBsb2NhbE1vbWVudCB9IGZyb20gJy4uLy4uL2dsb2JhbHMvbW9tZW50LXN2LWxvY2FsZSc7XG5cbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcblxuZXhwb3J0IGNsYXNzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUge1xuICBzdGF0aWMgRVhQSVJBVElPTl9IT1VSUyA9IDEyO1xuICBzdGF0aWMgVkVSU0lPTiA9IDI7XG5cbiAgdXNlcjogc3RyaW5nO1xuICBsYXN0V3JpdGU6IG51bWJlcjtcbiAgd2Vla0RhdGU6IG51bWJlcjtcbiAgb3BlbkNvdXJzZXM6IHsgW3BhdGg6IHN0cmluZ106IGJvb2xlYW4gfVxuXG4gIGNvbnN0cnVjdG9yICh1c2VyT3JDb3B5OiBzdHJpbmcgfCBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKSB7XG4gICAgaWYgKHR5cGVvZiB1c2VyT3JDb3B5ID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy51c2VyID0gdXNlck9yQ29weTtcbiAgICAgIHRoaXMubGFzdFdyaXRlID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMud2Vla0RhdGUgPSBsb2NhbE1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XG4gICAgICB0aGlzLm9wZW5Db3Vyc2VzID0ge307XG4gICAgfSBlbHNlIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgdXNlck9yQ29weSk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGxvYWQodXNlcjogc3RyaW5nKSB7XG4gICAgY29uc3QgY29va2llID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ1dlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUyJyk7XG4gICAgY29uc3Qgc3RvcmVkRGF0YSA9IGNvb2tpZSAmJiAoSlNPTi5wYXJzZShjb29raWUpIGFzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUpO1xuICAgIGNvbnN0IHN0YXRlID0gbmV3IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUodXNlcik7XG4gICAgaWYgKHN0b3JlZERhdGEpIE9iamVjdC5hc3NpZ24oc3RhdGUsIHN0b3JlZERhdGEpO1xuXG4gICAgcmV0dXJuIHN0YXRlLnVzZXIgPT09IHVzZXIgJiYgIXN0YXRlLmlzRXhwaXJlZChtb21lbnQoKSkgP1xuICAgICAgc3RhdGUgOiBuZXcgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSh1c2VyKTtcbiAgfVxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgdGhpcy5sYXN0V3JpdGUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeSh0aGlzKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZTInLCBqc29uKTtcbiAgfVxuXG4gIGlzRXhwaXJlZCAoYXNPZjogTW9tZW50KSB7XG4gICAgICByZXR1cm4gbW9tZW50KHRoaXMubGFzdFdyaXRlKVxuICAgICAgICAuaXNCZWZvcmUoXG4gICAgICAgICAgICBhc09mLmFkZChcbiAgICAgICAgICAgICAgICAwLVdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUuRVhQSVJBVElPTl9IT1VSUywgJ2hvdXJzJylcbiAgICAgICAgKTtcbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtXZWVrUGxhbm5lcn0gZnJvbSAnLi93ZWVrcGxhbm5lcic7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgJy4uLy4uL3JlcG9zL3VzZXItdGFza3MtcmVwbyc7XG5pbXBvcnQgeyBMYW5ndWFnZUNvbnRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7SW5qZWN0ZWRJbnRsUHJvcHN9IGZyb20gJ3JlYWN0LWludGwnO1xuXG5pbnRlcmZhY2UgUHJvcHMgZXh0ZW5kcyBJbmplY3RlZEludGxQcm9wc3tcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFdlZWtQbGFubmVyU2VsZiAocHJvcHM6IFByb3BzKSB7XG4gIGNvbnN0IHtpbnRsfSA9IHByb3BzO1xuICByZXR1cm4gPExhbmd1YWdlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17e2ludGx9fT5cbiAgICAgICAgICA8V2Vla1BsYW5uZXIgZW52PXtlbnZ9IHZpZXdDb3Vyc2VVcmw9e2NmZy5LRURfQ09VUlNFX1ZJRVdFUl9VUkx9IC8+XG4gICAgICAgICA8L0xhbmd1YWdlQ29udGV4dC5Qcm92aWRlcj47XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1dlZWtQbGFubmVyfSBmcm9tICcuL3dlZWtwbGFubmVyJztcbmltcG9ydCB7IFR1dG9yYWJsZUNvbXBvbmVudCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy90dXRvcmFibGUtY29tcG9uZW50JztcbmltcG9ydCB7SW5qZWN0ZWRJbnRsUHJvcHN9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5cbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIEluamVjdGVkSW50bFByb3BzIHt9XG5cbmV4cG9ydCBmdW5jdGlvbiBXZWVrUGxhbm5lclR1dG9yZWQgKHByb3BzOiBQcm9wcykge1xuICBjb25zdCB7aW50bH0gPSBwcm9wcztcbiAgXG4gIHJldHVybiA8TGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt7aW50bH19PlxuICAgIDxUdXRvcmFibGVDb21wb25lbnRcbiAgICAgIHR1dG9yZWQ9e3RydWV9XG4gICAgICBjcmVhdGVDb21wb25lbnQ9e2VudiA9PlxuICAgICAgICA8V2Vla1BsYW5uZXJcbiAgICAgICAgICBrZXk9e2Vudi5jdXJyZW50VXNlci5tYWlsfVxuICAgICAgICAgIGVudj17ZW52fVxuICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e2NmZy5LRURfQ09VUlNFX1ZJRVdFUl9VUkx9Lz5cbiAgICAgIH1cbiAgICAvPlxuICA8L0xhbmd1YWdlQ29udGV4dC5Qcm92aWRlcj47XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBVc2VyVGFza3NCb3ggfSBmcm9tICcuL3VzZXItdGFza3MtYm94JztcbmltcG9ydCB7IFVzZXJUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEh0dHBFcnJvciB9IGZyb20gXCJrZWRiYWNrZW5kL2NsaWVudFwiO1xuaW1wb3J0IHsgcmVmaW5lLCBWaXJ0dWFsTGVhcm5pbmdHb2FsIH0gZnJvbSAnLi9yZWZpbmVyJztcbmltcG9ydCB7IEVudiwgZW52IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEwsIGNvbXBhcmVQcm9wIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuLy9pbXBvcnQgeyBDdXN0b21Hb2FsIH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0IHsgVFNPTiB9IGZyb20gJy4uLy4uL3V0aWxzL3Rzb24nO1xuaW1wb3J0IHsgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB9IGZyb20gJy4vd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlJztcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XG5pbXBvcnQgeyBEaWFsb2dzIH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2RpYWxvZ3MnO1xuaW1wb3J0IHsgQWRkQ3VzdG9tR29hbCB9IGZyb20gJy4vYWRkLWN1c3RvbS1nb2FsJztcbmltcG9ydCB7IEFkZEN1c3RvbVRhc2sgfSBmcm9tICcuL2FkZC1jdXN0b20tdGFzayc7XG5pbXBvcnQgeyBFZGl0VXNlclRhc2sgfSBmcm9tICcuL2VkaXQtdXNlci10YXNrJztcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XG5pbXBvcnQgeyBQZW5kaW5nSm9iIH0gZnJvbSAnLi4vLi4vdXRpbHMvcGVuZGluZy1qb2InO1xuaW1wb3J0IHsgQWRkT3JFZGl0U3ViVGFzayB9IGZyb20gJy4vYWRkLW9yLWVkaXQtc3ViLXRhc2snO1xuaW1wb3J0IHsgZ2V0QWRqdXN0ZWRXZWVrLCBLRURXZWVrLCBnZXROZXh0V2Vla0RhdGUsIGdldFByZXZXZWVrRGF0ZSB9IGZyb20gJy4uLy4uL3V0aWxzL3dlZWt1dGlsJztcbmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgfSBmcm9tICdyZWFjdC1pbnRsJztcbmltcG9ydCB7TGFuZ3VhZ2VDb250ZXh0fSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcbmltcG9ydCB7IFByb2dyZXNzIH0gZnJvbSAnLi4vY2hhcnRzL3Byb2dyZXNzJztcbmltcG9ydCB7Z2V0V2Vla3BsYW5uZXJQcm9ncmVzc0RhdGF9IGZyb20gJy4uL2NoYXJ0cy9jaGFydHMtdXRpbHMnXG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uL2ZlYXR1cmVzJztcblxuY29uc3QgTUFYX1NUUkFURUdZX0xFTkdUSCA9IDE2Mzg0O1xuY29uc3QgTUFYX0FTU0VTU01FTlRfTEVOR1RIID0gMTYzODQ7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcbiAgZW52OiBFbnY7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHdlZWtEYXRlOiBudW1iZXI7XG4gIGRpYWxvZ3M6IGFueVtdO1xuICB1c2VyVGFza3M6IFVzZXJUYXNrW107XG4gIG9wZW5Db3Vyc2VzOiB7IFtwYXRoOiBzdHJpbmddOiBib29sZWFuIH1cbiAgc3RyYXRlZ3k/OiBzdHJpbmc7XG4gIGFzc2Vzc21lbnQ/OiBzdHJpbmc7XG4gIHdlZWtUZXh0c1VUOiBVc2VyVGFzayB8IG51bGw7XG4gIHNhdmluZzogYm9vbGVhbjtcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xuICBpc0NvcHlpbmdUYXNrczogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIFdlZWtQbGFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICB3ZWVrVGV4dHNTYXZpbmdKb2I6IFBlbmRpbmdKb2I7XG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHVzZXJUYXNrczogW10sXG4gICAgICB3ZWVrRGF0ZTogRGF0ZS5ub3coKSxcbiAgICAgIG9wZW5Db3Vyc2VzOiB7fSxcbiAgICAgIGRpYWxvZ3M6IFtdLFxuICAgICAgc2F2aW5nOiBmYWxzZSxcbiAgICAgIHdlZWtUZXh0c1VUOiBudWxsLFxuICAgICAgaXNMb2FkaW5nOiB0cnVlLFxuICAgICAgaXNDb3B5aW5nVGFza3M6IGZhbHNlXG4gICAgfVxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy53ZWVrVGV4dHNTYXZpbmdKb2IgPSBuZXcgUGVuZGluZ0pvYigoKT0+dGhpcy5zYXZlV2Vla1RleHRzKCkpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25DaGFuZ2UpO1xuICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnN0b3AoKTtcbiAgfVxuXG4gIG9uQ2hhbmdlKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlLCB3ZWVrVGV4dHNVVDogVXNlclRhc2spIHtcbiAgICBjb25zdCBuZXdTdGF0ZSA6IFBhcnRpYWw8U3RhdGU+ID0ge1xuICAgICAgdXNlclRhc2tzLFxuICAgICAgd2Vla0RhdGU6IHBlcnNpc3RlZC53ZWVrRGF0ZSxcbiAgICAgIG9wZW5Db3Vyc2VzOiBwZXJzaXN0ZWQub3BlbkNvdXJzZXMsXG4gICAgICB3ZWVrVGV4dHNVVCxcbiAgICAgIGlzTG9hZGluZzogZmFsc2VcbiAgICB9XG4gICAgaWYgKCF0aGlzLnN0YXRlLndlZWtUZXh0c1VUIHx8ICh3ZWVrVGV4dHNVVC5kYXRlVGltZSAhPT0gdGhpcy5zdGF0ZS53ZWVrVGV4dHNVVC5kYXRlVGltZSkpIHtcbiAgICAgIC8vIENoYW5naW5nIHdlZWsuIFJlc2V0IHRvIG5ldyB3ZWVrJ3MgdmFsdWVzXG4gICAgICBuZXdTdGF0ZS5zdHJhdGVneSA9IHdlZWtUZXh0c1VULndlZWtUZXh0cy5zdHJhdGVneTtcbiAgICAgIG5ld1N0YXRlLmFzc2Vzc21lbnQgPSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuYXNzZXNzbWVudDtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSBhcyBhbnkpOyAvLyBSZWFjdCdzIHVzZSBvZiBQaWNrIGluc3RlYWQgb2YgUGFydGlhbCBtYWtlcyB0aGluZ3MgY29tcGxleCBoZXJlLlxuICB9XG5cbiAgaXNXZWVrVGV4dHNFZGl0ZWQoKSB7XG4gICAgY29uc3QgeyBzdHJhdGVneSwgYXNzZXNzbWVudCwgd2Vla1RleHRzVVQgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuICEhd2Vla1RleHRzVVQgJiYgKHN0cmF0ZWd5ICE9PSB3ZWVrVGV4dHNVVC53ZWVrVGV4dHMuc3RyYXRlZ3kgfHwgYXNzZXNzbWVudCAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLmFzc2Vzc21lbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBzYXZlV2Vla1RleHRzKCkge1xuICAgIGNvbnNvbGUubG9nKFwiU2F2aW5nIHRleHRzLi4uXCIpO1xuICAgIGNvbnN0IHsgc3RyYXRlZ3ksIGFzc2Vzc21lbnQsIHdlZWtUZXh0c1VUIH0gPSB0aGlzLnN0YXRlO1xuICAgIGlmICh0aGlzLmlzV2Vla1RleHRzRWRpdGVkKCkpIHtcbiAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8udXBzZXJ0KHdlZWtUZXh0c1VULCB1dCA9PiB7XG4gICAgICAgIHV0LndlZWtUZXh0cyA9IHsgc3RyYXRlZ3ksIGFzc2Vzc21lbnQgfTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHByZXZXZWVrKCkge1xuICAgIC8vdGhpcy5zYXZlV2Vla1RleHRzKCk7IFxuICAgIHZhciBwcmV2V2Vla09iaiA9IGdldFByZXZXZWVrRGF0ZShtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkpO1xuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uY2hhbmdlV2VlayhwcmV2V2Vla09iai5uZXh0RGF0ZSwgcHJldldlZWtPYmouYWRqdXN0ZWQpO1xuICB9XG5cbiAgbmV4dFdlZWsoKSB7XG4gICAgLy90aGlzLnNhdmVXZWVrVGV4dHMoKTtcbiAgICB2YXIgbmV4dFdlZWtPYmogPSBnZXROZXh0V2Vla0RhdGUobW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpKTtcbiAgICB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmNoYW5nZVdlZWsobmV4dFdlZWtPYmoubmV4dERhdGUsIG5leHRXZWVrT2JqLmFkanVzdGVkKTtcbiAgfVxuXG4gIG9wZW5EaWFsb2coZGlhbG9nKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGRpYWxvZ3M6IFsuLi50aGlzLnN0YXRlLmRpYWxvZ3MsIGRpYWxvZ10gfSk7XG4gIH1cblxuICBvcGVuQWRkR29hbERpYWxvZygpIHtcbiAgICB0aGlzLm9wZW5EaWFsb2coPEFkZEN1c3RvbUdvYWxcbiAgICAgIG9uU2F2ZT17YXN5bmMgKGxlYXJuaW5nR29hbDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmICghbGVhcm5pbmdHb2FsKSB0aHJvdyBuZXcgRXJyb3IgKHRoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid3ZWVrcGxhbm5lci5lbXB0eUxlYXJuaW5nR29hbEVycicsIGRlZmF1bHRNZXNzYWdlOiAnTMOkcmFuZGVtw6VsZXQga2FuIGludGUgdmFyYSB0b210J30pKTtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnNhdmluZykge1xuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IHRydWUgfSk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkQ3VzdG9tR29hbChsZWFybmluZ0dvYWwpO1xuICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiBmYWxzZSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgICB9XG4gICAgICB9fSAvPik7XG4gIH1cblxuICBvcGVuQWRkT3duVGFza0RpYWxvZyhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8QWRkQ3VzdG9tVGFza1xuICAgICAgaXNUYXNrPXshY291cnNlTmFtZX1cbiAgICAgIG9uU2F2ZT17YXN5bmMgKG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgdXJsOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKCFuYW1lKSB0aHJvdyBuZXcgRXJyb3IgKHRoaXMuY29udGV4dC5pbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid3ZWVrcGxhbm5lci5uYW1lQ2Fubm90QmVFbXB0eScsIGRlZmF1bHRNZXNzYWdlOiAnTmFtbmV0IGthbiBpbnRlIHZhcmEgdG9tdCd9KSk7XG4gICAgICAgIGlmICghdGhpcy5zdGF0ZS5zYXZpbmcpIHtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiB0cnVlIH0pO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFkZEN1c3RvbVRhc2soY291cnNlTmFtZSwgbGVhcm5pbmdHb2FsTmFtZSwgbmFtZSwgZGVzY3JpcHRpb24sIHVybCk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzYXZpbmc6IGZhbHNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH1cbiAgICAgIH19IC8+KTtcbiAgfVxuXG4gIGVkaXRUYXNrKHVzZXJUYXNrOiBVc2VyVGFzaykge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8RWRpdFVzZXJUYXNrXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvfVxuICAgICAgdXNlclRhc2s9e3VzZXJUYXNrfVxuICAgICAgb25VcGRhdGU9e2FzeW5jICh1cGRhdGVyOiAodXQ6IFVzZXJUYXNrKSA9PiB2b2lkKSA9PiB7XG4gICAgICAgIGNvbnN0IHRlc3QgPSB7Li4udXNlclRhc2t9O1xuICAgICAgICB1cGRhdGVyKHRlc3QpO1xuICAgICAgICBpZiAoIXRlc3QubmFtZSkgdGhyb3cgbmV3IEVycm9yICh0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDond2Vla3BsYW5uZXIubmFtZU11c3ROb3RCZUVtcHR5JywgZGVmYXVsdE1lc3NhZ2U6ICdOYW1uZXQgZsOlciBpbnRlIHZhcmEgdG9tdCd9KSk7XG4gICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXBkYXRlcik7XG4gICAgICB9fVxuICAgICAgb25EZWxldGU9e2FzeW5jIGlkID0+IHtcbiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmRlbGV0ZShbaWRdKTtcbiAgICAgIH19XG4gICAgICBvcGVuRGlhbG9nPXtkaWFsb2c9PnRoaXMub3BlbkRpYWxvZyhkaWFsb2cpfVxuICAgICAgY2xvc2VEaWFsb2c9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9XG4gICAgLz4pO1xuICB9XG5cbiAgZWRpdFN1YlRhc2sodXNlclRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xuICAgIHRoaXMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xuICAgICAgdXNlclRhc2tzUmVwbz17dGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwb31cbiAgICAgIG1vZGU9XCJlZGl0XCJcbiAgICAgIHVzZXJUYXNrPXt1c2VyVGFza31cbiAgICAgIHN1YlRhc2s9e3N1YlRhc2t9XG4gICAgICBjbG9zZURpYWxvZz17KCk9PnRoaXMuY2xvc2VEaWFsb2coKX1cbiAgICAvPik7XG4gIH1cblxuICBjbG9zZURpYWxvZygpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgZGlhbG9nczogdGhpcy5zdGF0ZS5kaWFsb2dzLnNsaWNlKDAsIHRoaXMuc3RhdGUuZGlhbG9ncy5sZW5ndGggLSAxKSB9KTtcbiAgfVxuXG5cblxuICBhc3luYyBhZGRDdXN0b21Hb2FsKGxlYXJuaW5nR29hbDogc3RyaW5nKSB7XG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxuICAgICAgTWF0aC5tYXgsXG4gICAgICBbdGhpcy5zdGF0ZS53ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmluc2VydChbe1xuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgIGxlYXJuaW5nR29hbCxcbiAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwXG4gICAgfV0pO1xuXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4oXCJcIiwgdHJ1ZSk7XG4gIH1cblxuICBhc3luYyByZW1vdmVMZWFybmluZ0dvYWwobGVhcm5pbmdHb2FsOiBWaXJ0dWFsTGVhcm5pbmdHb2FsKSB7XG4gICAgaWYgKGxlYXJuaW5nR29hbC50YXNrcy5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAoIWNvbmZpcm0odGhpcy5jb250ZXh0LmludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3dlZWtwbGFubmVyLmNvbmZpcm1SZW1vdmVMZWFybmluZ09iamVjdGl2ZXMnLCBkZWZhdWx0TWVzc2FnZTogJ1RhIGJvcnQgbMOkcmFuZGVtw6VsIHNhbXQge2xlYXJuaW5nR29hbHNOdW1iZXJ9IHVwcGdpZnRlcj8nfSwge2xlYXJuaW5nR29hbHNOdW1iZXI6IGxlYXJuaW5nR29hbC50YXNrcy5sZW5ndGh9KSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmRlbGV0ZShsZWFybmluZ0dvYWwuYWxsVGFza3MubWFwKHQgPT4gdC5pZCkpO1xuICB9XG5cbiAgYXN5bmMgYWRkQ3VzdG9tVGFzayhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmcsIHVybDogc3RyaW5nKSB7XG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxuICAgICAgTWF0aC5tYXgsXG4gICAgICBbdGhpcy5zdGF0ZS53ZWVrRGF0ZV0uY29uY2F0KHRoaXMuc3RhdGUudXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICAvKmNvbnN0IGVtcHR5TGVhcm5pbmdHb2FsUGxhY2Vob2xkZXIgPSB0aGlzLnN0YXRlLnVzZXJUYXNrcy5maW5kKHV0ID0+XG4gICAgICB1dC5uYW1lID09IG51bGwgJiZcbiAgICAgICF1dC5jb3Vyc2VOYW1lICYmXG4gICAgICB1dC5sZWFybmluZ0dvYWwgPT09IGxlYXJuaW5nR29hbCk7XG5cbiAgICBpZiAoZW1wdHlMZWFybmluZ0dvYWxQbGFjZWhvbGRlcikge1xuICAgICAgLy8gSGlqYWNrIGxlYXJuaW5nLWdvYWwgcGxhY2Vob2xkZXIgYW5kIG1ha2UgaXQgdGhlIHJlYWwgdGFzay5cbiAgICAgIC8vIFRoaXMgd2lsbCBtYWtlIHRoZSBsZWFybmluZyBnb2FsIGRpc2FwcGVhciBvbmNlIHRoaXMgdGFza1xuICAgICAgLy8gaXMgZGVsZXRlZC5cbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8udXBkYXRlKFtlbXB0eUxlYXJuaW5nR29hbFBsYWNlaG9sZGVyXSwgdXQgPT4ge1xuICAgICAgICBPYmplY3QuYXNzaWduKHV0LCB7IG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2UgeyovXG4gICAgICAvLyBBZGQgYW5vdGhlciB0YXNrIHRvIHNhbWUgbGVhcm5pbmctZ29hbFxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5pbnNlcnQoW3tcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgZGF0ZVRpbWU6IGxhdGVzdFRpbWVTdGFtcCArIDIwMDAsXG4gICAgICAgIGNvdXJzZU5hbWUsXG4gICAgICAgIGxlYXJuaW5nR29hbCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIHVybFxuICAgICAgfV0pO1xuICAgIC8vfVxuICB9XG5cbiAgc2V0SXNPcGVuKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSB7XG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZSwgaXNPcGVuKTtcbiAgfVxuXG4gIGFzeW5jIHNldFRhc2tEb25lKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSB7XG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRUYXNrRG9uZVN0YXRlKHRhc2ssIGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgc2V0U3ViVGFza0RvbmUodGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrLCBkb25lOiBib29sZWFuKSB7XG4gICAgYXdhaXQgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRTdWJUYXNrRG9uZVN0YXRlKHRhc2ssIHN1YlRhc2suaWQsIGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgY29weUZyb21QcmV2aW91c1dlZWsoKSB7XG4gICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSh7aXNDb3B5aW5nVGFza3M6IHRydWV9KTtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB1c2VyVGFza3MsIG9wZW5Db3Vyc2VzLCB3ZWVrRGF0ZSB9ID0gdGhpcy5zdGF0ZTtcblxuICAgICAgY29uc3QgcHJldldlZWsgPSBtb21lbnQod2Vla0RhdGUpLmFkZCgtMSwgJ3dlZWsnKTtcbiAgICAgIGNvbnN0IHByZXZXZWVrTm8gPSBnZXRBZGp1c3RlZFdlZWsgKHByZXZXZWVrKTtcbiAgICAgIGNvbnN0IHByZXZLRURXZWVrID0gS0VEV2VlayhwcmV2V2Vlay55ZWFyKCksIHByZXZXZWVrTm8pO1xuICAgICAgLy8gUmVhZCBsYXN0IHdlZWsncyBnb2FscyBhbmQgdGFza3NcbiAgICAgIGxldCBwcmV2VGFza3MgPSBhd2FpdCB0aGlzLnByb3BzLmVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8VXNlclRhc2s+KFwidXNlcnRhc2tzXCIsIHtcbiAgICAgICAgZnJvbTogcHJldktFRFdlZWsubm90QmVmb3JlLFxuICAgICAgICB0bzogcHJldktFRFdlZWsubm90QWZ0ZXIsXG4gICAgICAgIHJvbGU6IFwiVVNFUlwiLFxuICAgICAgICBpbmNsdWRlOiBbXCJ0YXNrXCIsIFwiY291cnNlXCIsIFwiYWNsXCJdLFxuICAgICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cbiAgICAgIH0pO1xuICAgICAgcHJldlRhc2tzID0gcHJldlRhc2tzXG4gICAgICAgIC5maWx0ZXIocHJldlRhc2sgPT4gIXByZXZUYXNrLmRvbmUpICAvLyBEb24ndCBjb3B5IGRvbmUgdGFza3NcbiAgICAgICAgLmZpbHRlcihwcmV2VGFzayA9PiAhIXByZXZUYXNrLm5hbWUpIC8vIERvbid0IGNvcHkgZW1wdHkgbGVhcm5pbmcgZ29hbHNcbiAgICAgICAgLmZpbHRlcihwcmV2VGFzayA9PiAhdXNlclRhc2tzLnNvbWUodGFza09mQ3VycmVudFdlZWsgPT5cbiAgICAgICAgICB0YXNrT2ZDdXJyZW50V2Vlay5uYW1lID09PSBwcmV2VGFzay5uYW1lICYmXG4gICAgICAgICAgdGFza09mQ3VycmVudFdlZWsubGVhcm5pbmdHb2FsID09PSBwcmV2VGFzay5sZWFybmluZ0dvYWwgJiZcbiAgICAgICAgICB0YXNrT2ZDdXJyZW50V2Vlay5jb3Vyc2VOYW1lID09PSBwcmV2VGFzay5jb3Vyc2VOYW1lKSk7IC8vIElnbm9yZSBpZGVudGljYWwgdGFza3MgKGFscmVhZHkgY29waWVkKVxuICAgICAgICAgIFxuICAgICAgdmFyIHRlc3QgPSBbd2Vla0RhdGVdLmNvbmNhdCh1c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpO1xuICAgICAgLy8gTm93IGNyZWF0ZSBjb3BpZXMgYnV0IHBsYWNlIHRoZW0gaW4gdGhlIGN1cnJlbnQgd2Vlay5cbiAgICAgIGxldCBsYXRlc3RUaW1lU3RhbXAgPSBNYXRoLm1heC5hcHBseShNYXRoLm1heCwgW3dlZWtEYXRlXS5jb25jYXQodXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XG5cbiAgICAgIGNvbnN0IGNvcGllcyA9IHByZXZUYXNrcy5zb3J0KGNvbXBhcmVQcm9wKFwiZGF0ZVRpbWVcIikpLm1hcCh0YXNrID0+IHtcbiAgICAgICAgY29uc3QgY29weTogVXNlclRhc2sgPSB7IC4uLnRhc2ssIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKz0gMTAwMCB9O1xuICAgICAgICBjb3B5LmlkID0gY3JlYXRlVVVJRCgpO1xuICAgICAgICBpZiAoY29weS5zdWJUYXNrcykge1xuICAgICAgICAgIGNvcHkuc3ViVGFza3MgPSBjb3B5LnN1YlRhc2tzLmZpbHRlcihzdCA9PiAhc3QuZG9uZSk7XG4gICAgICAgIH1cbiAgICAgICAgZGVsZXRlIGNvcHkuJGV0YWc7XG4gICAgICAgIHJldHVybiBjb3B5O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFN0b3JlIGl0XG4gICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmluc2VydChjb3BpZXMpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtpc0NvcHlpbmdUYXNrczogZmFsc2V9KTtcbiAgICB9XG4gIH1cblxuICBnZXRIZWFkZXJUaXRsZSgpe1xuICAgIHJldHVybiA8aDQ+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5sb2dCb29rXCIgIGRlZmF1bHRNZXNzYWdlPVwiTG9nZ2Jva1wiLz48L2g0PjtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB3ZWVrTnVtYmVyID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcbiAgICBjb25zdCBzaG93UHJvZ3Jlc3NDaGFydHMgPSBmZWF0dXJlcy53ZWVrcGxhbm5lckNoYXJ0cztcbiAgICAvL2NvbnNvbGUubG9nKFwiV2Vla3lkYXRlOiBcIiAgKyBuZXcgRGF0ZSh0aGlzLnN0YXRlLndlZWtEYXRlKSArIFwiIHdoaWNoIGlzIHdlZWsgbm8gXCIgKyB3ZWVrTnVtYmVyKTtcbiAgICBjb25zdCBjdXJyZW50V2VlayA9IG1vbWVudCgpLndlZWsoKTtcbiAgICBjb25zdCB0YXNrU2V0cyA9IHJlZmluZSh0aGlzLnN0YXRlLnVzZXJUYXNrcyk7XG4gICAgY29uc3QgeyBkaWFsb2dzLCB3ZWVrVGV4dHNVVCwgc3RyYXRlZ3ksIGFzc2Vzc21lbnQsIGlzTG9hZGluZywgaXNDb3B5aW5nVGFza3MgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgaXNTYXZpbmcgPSB3ZWVrVGV4dHNVVCAmJiAod2Vla1RleHRzVVQuJG1ldGEgPT09ICdhZGRpbmcnIHx8IHdlZWtUZXh0c1VULiRtZXRhID09PSAndXBkYXRpbmcnKTtcbiAgICBjb25zdCBpc1N0cmF0ZWd5RWRpdGVkID0gISF3ZWVrVGV4dHNVVCAmJiAoc3RyYXRlZ3kgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5zdHJhdGVneSk7XG4gICAgY29uc3QgaXNBc3Nlc3NtZW50RWRpdGVkID0gISF3ZWVrVGV4dHNVVCAmJiAoYXNzZXNzbWVudCAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLmFzc2Vzc21lbnQpO1xuICAgIGNvbnN0IGVuYWJsZVNhdmVCdXR0b24gPSAhaXNTYXZpbmcgJiYgKGlzU3RyYXRlZ3lFZGl0ZWQgfHwgaXNBc3Nlc3NtZW50RWRpdGVkKTtcbiAgICBjb25zdCBpc0d5bW5hc2l1bVN0dWRlbnQgPSAoJycgKyBlbnYuY3VycmVudFVzZXIuc2Nob29sVHlwZSkudG9Mb3dlckNhc2UoKSA9PT0gXCJneW1uYXNpdW1cIjsgXG5cbiAgICB2YXIgY2hhcnRUYXNrcyA9IGdldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhKHRhc2tTZXRzKTtcblxuICAgIHZhciBwZXJjZW50YWdlID0gY2hhcnRUYXNrcy50b3RhbE51bWJlck9mVGFza3MgPiAwID8gY2hhcnRUYXNrcy5jb21wbGV0ZWRUYXNrcyAvIGNoYXJ0VGFza3MudG90YWxOdW1iZXJPZlRhc2tzICogMTAwIDogMDtcbiAgICByZXR1cm4gPGRpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtga2VkX2JveGVkIHdlZWtQbGFubmVyJHt3ZWVrTnVtYmVyID09PSBjdXJyZW50V2VlayA/IFwiIGN1cnJlbnRXZWVrXCIgOiBcIlwifWB9XG4gICAgICAgIG9uS2V5RG93bj17ZXYgPT4ge1xuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gODMgJiYgZXYuY3RybEtleSkge1xuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmICghaXNTYXZpbmcgJiYgdGhpcy5pc1dlZWtUZXh0c0VkaXRlZCgpKSB7XG4gICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9fT5cbiAgICAgICAge3Nob3dQcm9ncmVzc0NoYXJ0cyAmJiBjaGFydFRhc2tzLnRvdGFsTnVtYmVyT2ZUYXNrcyA+IDAgJiYgIHRoaXMuZ2V0SGVhZGVyVGl0bGUoKX1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aWRnZXRzXCI+XG4gICAgICAgICAge3Nob3dQcm9ncmVzc0NoYXJ0cyAmJiBjaGFydFRhc2tzLnRvdGFsTnVtYmVyT2ZUYXNrcyA+IDAgPyA8ZGl2IGNsYXNzTmFtZT1cInByb2dyZXNzQmFyXCI+PFByb2dyZXNzIHBlcmNlbnRhZ2UgPSB7cGVyY2VudGFnZX0vPjwvZGl2PiA6IHRoaXMuZ2V0SGVhZGVyVGl0bGUoKX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHdlZWtTZWxlY3RgfT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW1cIj5cbiAgICAgICAgICAgICAgPHA+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci53ZWVrTnVtYmVyXCIgdmFsdWVzPXt7d2Vla051bWJlcjogd2Vla051bWJlcn19IGRlZmF1bHRNZXNzYWdlPVwiVmVja2Ege3dlZWtOdW1iZXJ9XCIvPjwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0bi1ncm91cFwiPlxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCkgPT4gdGhpcy5wcmV2V2VlaygpfT5cbiAgICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWFuZ2xlLWxlZnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLm5leHRXZWVrKCl9PlxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYW5nbGUtcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHt0YXNrU2V0cy5sZW5ndGggPiAwICYmIDxociAvPn1cblxuICAgICAgICB7dGFza1NldHMubWFwKHByb3BzID0+XG4gICAgICAgICAgPFVzZXJUYXNrc0JveFxuICAgICAgICAgICAga2V5PXtwcm9wcy5jb3Vyc2VOYW1lfVxuICAgICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgICAgY291cnNlTmFtZT17cHJvcHMuY291cnNlTmFtZX1cbiAgICAgICAgICAgIGxlYXJuaW5nR29hbHM9e3Byb3BzLmxlYXJuaW5nR29hbHN9XG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XG4gICAgICAgICAgICBvcGVuQ291cnNlcz17dGhpcy5zdGF0ZS5vcGVuQ291cnNlc31cbiAgICAgICAgICAgIGFkZE93blRhc2s9eyhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykgPT4gdGhpcy5vcGVuQWRkT3duVGFza0RpYWxvZyhjb3Vyc2VOYW1lLCBsZWFybmluZ0dvYWxOYW1lKX1cbiAgICAgICAgICAgIHNldElzT3Blbj17dGhpcy5zZXRJc09wZW4uYmluZCh0aGlzKX1cbiAgICAgICAgICAgIHNldFRhc2tEb25lPXt0aGlzLnNldFRhc2tEb25lLmJpbmQodGhpcyl9XG4gICAgICAgICAgICBzZXRTdWJUYXNrRG9uZT17dGhpcy5zZXRTdWJUYXNrRG9uZS5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgZWRpdFRhc2s9e3Rhc2sgPT4gdGhpcy5lZGl0VGFzayh0YXNrKX1cbiAgICAgICAgICAgIGVkaXRTdWJUYXNrPXsodGFzaywgc3ViVGFzaykgPT4gdGhpcy5lZGl0U3ViVGFzayh0YXNrLCBzdWJUYXNrKX1cbiAgICAgICAgICAgIHJlbW92ZUxlYXJuaW5nR29hbD17bGcgPT4gdGhpcy5yZW1vdmVMZWFybmluZ0dvYWwobGcpfSBcbiAgICAgICAgICAgIGRpc3BsYXlQcm9ncmVzcyA9IHtzaG93UHJvZ3Jlc3NDaGFydHN9XG4gICAgICAgICAgICBwcm9ncmVzc0RhdGEgPSB7Y2hhcnRUYXNrcy5zdWJqZWN0RGF0YVtwcm9wcy5jb3Vyc2VOYW1lXX0gLz4pfVxuXG4gICAgICAgIDxociAvPlxuXG4gICAgICAgIHtpc0xvYWRpbmcgPyA8U3Bpbm5lciAvPiA6IDxkaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXtldiA9PiB0aGlzLm9wZW5BZGRHb2FsRGlhbG9nKCl9PlxuICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtbGlzdC1hbHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICB7aXNHeW1uYXNpdW1TdHVkZW50ID8gIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIubGVhcm5pbmdHb2FsR3ltbmFzaXVtXCIgZGVmYXVsdE1lc3NhZ2U9XCJVcHBnaWZ0XCIvPiA6IDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIubGVhcm5pbmdHb2FsUHJpbWFyeVwiIGRlZmF1bHRNZXNzYWdlPVwiRWdldCBsw6RyYW5kZW3DpWxcIi8+fVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuXCIgc3R5bGU9e2lzQ29weWluZ1Rhc2tzID8ge29wYWNpdHk6IDAuNX0gOiB1bmRlZmluZWR9IG9uQ2xpY2s9e2V2ID0+ICghaXNDb3B5aW5nVGFza3MpICYmIHRoaXMuY29weUZyb21QcmV2aW91c1dlZWsoKX0+XG4gICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1jbG9uZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuY29weVByZXZpb3VzV2Vla1Rha3NcIiBkZWZhdWx0TWVzc2FnZT1cIktvcGllcmEgZWoga2xhcmEgZnLDpW4gZsO2cmVnw6VlbmRlIHZlY2thXCIvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxPcGVuQ2xvc2VCb3hcbiAgICAgICAgICAgIHRpdGxlPXs8aDU+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneUFuZEV2YWx1YXRpb25cIiBkZWZhdWx0TWVzc2FnZT1cIlN0cmF0ZWdpICYgVXR2w6RyZGVyaW5nXCIvPjwvaDU+fVxuICAgICAgICAgICAgaGVhZGVyT3Blbj17dGhpcy5zdGF0ZS5vcGVuQ291cnNlc1tcIlN0cmF0VXR2XCJdfVxuICAgICAgICAgICAgb25PcGVuQ2xvc2U9e2JlY2FtZU9wZW4gPT4gdGhpcy5zZXRJc09wZW4oXCJTdHJhdFV0dlwiLCBiZWNhbWVPcGVuKX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICA8aDM+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneVwiIGRlZmF1bHRNZXNzYWdlPVwiU3RyYXRlZ2lcIi8+PC9oMz5cbiAgICAgICAgICAgIDxwPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuc3RyYXRlZ3lEZXNjcmlwdGlvblwiIGRlZmF1bHRNZXNzYWdlPVwiSHVyIGphZyBza2EgZ8O2cmEgZsO2ciBhdHQgbMOkcmEgbWlnLlwiLz48L3A+XG4gICAgICAgICAgICA8aHIvPlxuICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlZWtwbGFubmVyLXRleHRhcmVhXCJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZW52LnR1dG9yZWR9XG4gICAgICAgICAgICAgIHZhbHVlPXtzdHJhdGVneSAmJiBzdHJhdGVneS5zdWJzdHIoMCwgTUFYX1NUUkFURUdZX0xFTkdUSCl9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7c3RyYXRlZ3k6IChldi50YXJnZXQudmFsdWUgfHwgJycpLnN1YnN0cigwLCBNQVhfU1RSQVRFR1lfTEVOR1RIKX0pO1xuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcbiAgICAgICAgICAgICAgfX0gLz5cblxuICAgICAgICAgICAgPGgzPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuZXZhbHVhdGlvblwiIGRlZmF1bHRNZXNzYWdlPVwiVXR2w6RyZGVyaW5nXCIvPjwvaDM+XG4gICAgICAgICAgICA8cD48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmV2YWx1YXRpb25EZXNjcmlwdGlvblwiIGRlZmF1bHRNZXNzYWdlPVwiUmVmbGVrdGlvbiBrcmluZyBkaW4gYXJiZXRzaW5zYXRzIG9jaCBkaW5hIHZhbGRhIHN0cmF0ZWdpZXIgdW5kZXIgdmVja2FuLlV0dsOkcmRlcmEgaSBmw7ZyaMOlbGxhbmRlIHRpbGwgZGluYSBtw6VsLlwiLz48L3A+XG4gICAgICAgICAgICA8aHIvPlxuICAgICAgICAgICAgPHRleHRhcmVhXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlZWtwbGFubmVyLXRleHRhcmVhXCJcbiAgICAgICAgICAgICAgdmFsdWU9e2Fzc2Vzc21lbnQgJiYgYXNzZXNzbWVudC5zdWJzdHIoMCwgTUFYX0FTU0VTU01FTlRfTEVOR1RIKX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZW52LnR1dG9yZWR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YXNzZXNzbWVudDogKGV2LnRhcmdldC52YWx1ZSB8fCAnJykuc3Vic3RyKDAsIE1BWF9BU1NFU1NNRU5UX0xFTkdUSCl9KVxuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcbiAgICAgICAgICAgICAgfSB9Lz5cbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuXCJcbiAgICAgICAgICAgICAgdGFiSW5kZXg9ezB9XG4gICAgICAgICAgICAgIHN0eWxlPXtlbmFibGVTYXZlQnV0dG9uID8ge30gOiB7b3BhY2l0eTogMC41fX1cbiAgICAgICAgICAgICAgb25DbGljaz17KCk9PiFpc1NhdmluZyAmJiB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDApfT5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1mbG9wcHktb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIC8+XG4gICAgICAgICAgICAgICAgICB7ZW5hYmxlU2F2ZUJ1dHRvbiA/IDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiY29tbW9uLnNhdmVcIiBkZWZhdWx0TWVzc2FnZT1cIiBTcGFyYVwiLz4gOiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlZFwiIGRlZmF1bHRNZXNzYWdlPVwiIFNwYXJhZFwiLz59XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9PcGVuQ2xvc2VCb3g+XG5cbiAgICAgICAgPC9kaXY+fVxuICAgICAgPC9kaXY+XG4gICAgICA8RGlhbG9nc1xuICAgICAgICBkaWFsb2dzPXtkaWFsb2dzfVxuICAgICAgICBwb3BEaWFsb2c9eygpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoXG4gICAgICAgICAgICAgICh7ZGlhbG9nc30pID0+ICh7IGRpYWxvZ3M6IGRpYWxvZ3Muc2xpY2UoMCwgZGlhbG9ncy5sZW5ndGggLSAxKSB9KSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IC8+XG4gICAgPC9kaXY+XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyBrZWRDb21wb25lbnRzIGZyb20gJy4va2VkY29tcG9uZW50cyc7XG5pbXBvcnQgeyBzZXR1cEludGwgfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9TZXR1cExhbmd1YWdlSW50bCc7XG5pbXBvcnQgeyBpbmplY3RJbnRsIH0gZnJvbSAncmVhY3QtaW50bCc7XG5cbi8vIDxURU1QT1JBUlkgRklYPlxuLy8gTmVlZCBhcyBjdXJyZW50IHByb2R1Y3Rpb24gaGFzIHRoZSBvbGQgU3ViamVjdFBsYW5uZXIgVVJMcyxcbi8vIHdoaWxlIHRoZSBuZXdlc3QgdmVyc2lvbiBoYXMgbmV3IHBhZ2VzIGZvciB0aGVtIVxuLy8gUkVNT1ZFIEFGVEVSIEdPSU5HIFRPIFBST0RVQ1RJT04gQU5EIEhBVklORyBUSEUgVkFMVUUgQ09ORklHVVJFRCBJTiBFTEVNRU5UUyFcbmltcG9ydCB7IGNmZyB9IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5jZmcuS0VEX1NVQkpFQ1RfUExBTk5FUl9VUkwgPSAnL2FwL2FtbmVzcGxhbmVyYXJlbic7XG5jZmcuS0VEX1NVQkpFQ1RfUExBTk5FUl9BRE1JTl9VUkwgPSAnL2FwL2FtbmVzcGxhbmVyYXJlbmFkbWluJzsgICBcbi8vIDwvVEVNUE9SQVJZIEZJWD5cblxuY29uc3QgaW50bENvbXBvbmVudHMgPSB7fTtcbk9iamVjdC5rZXlzKGtlZENvbXBvbmVudHMpLmZvckVhY2goayA9PiB7XG4gICAgaW50bENvbXBvbmVudHNba10gPSBzZXR1cEludGwoaW5qZWN0SW50bChrZWRDb21wb25lbnRzW2tdKSk7XG59KTtcblxuZXhwb3J0IGNvbnN0IGNvbXBvbmVudHMgPSB7Li4uaW50bENvbXBvbmVudHN9OyIsImltcG9ydCAnLi4vLi4vZ2xvYmFsLXNldHRlcnMvc2V0LWFsbCc7XG5cbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmVudi5iZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKTsgLy8gU3RhcnQgZ2V0dGluZyBiZWFyZXIgYXMgc29vbiBhcyBwb3NzaWJsZS5cbmVudi5nb29nbGVUb2tlblByb3ZpZGVyLmdldEJlYXJlcigpOyAvLyBTdGFydCBnZXR0aW5nIGdvb2dsZSBiZWFyZXIgYXMgc29vbiBhcyBwb3NzaWJsZS5cblxuLy8gQ29tbW9uIGNvbXBvbmVudHNcbmV4cG9ydCB7Q2FsZW5kYXJTZWxmIGFzIENhbGVuZGFyLH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jYWxlbmRhci9jYWxlbmRhci1zZWxmJztcbmV4cG9ydCB7Q2FsZW5kYXJUdXRvcmVkfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2NhbGVuZGFyL2NhbGVuZGFyLXR1dG9yZWQnO1xuZXhwb3J0IHtXZWVrUGxhbm5lclNlbGYgYXMgV2Vla1BsYW5uZXJ9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItc2VsZic7XG5leHBvcnQge1dlZWtQbGFubmVyVHV0b3JlZH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy93ZWVrcGxhbm5lci93ZWVrcGxhbm5lci10dXRvcmVkJztcbmV4cG9ydCB7TGF0ZXN0QXNzZXNzbWVudHN9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvbGF0ZXN0LWFzc2Vzc21lbnRzL2xhdGVzdC1hc3Nlc3NtZW50cyc7XG5leHBvcnQge0xlYXJuaW5nVGFza3N9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvbGVhcm5pbmctdGFza3MnO1xuZXhwb3J0IHtSb290V2Vla05vdGVib29rIGFzIFdlZWtOb3RlYm9va30gZnJvbSAnLi4vLi4vY29tcG9uZW50cy93ZWVrLW5vdGVib29rJztcbmV4cG9ydCB7VHV0b3JzU2VsZWN0fSBmcm9tICcuLi8uLi9jb21wb25lbnRzL3R1dG9ycy1zZWxlY3QvdHV0b3JzLXNlbGVjdCc7XG5cbi8vIEtHIG9ubHlcbmV4cG9ydCB7S0dUZXJtUGxhbm5lclNlbGYgYXMgS0dUZXJtUGxhbm5lcn0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9rZy10ZXJtcGxhbm5lci9rZy10ZXJtcGxhbm5lci1zZWxmJztcbmV4cG9ydCB7S0dUZXJtUGxhbm5lclR1dG9yZWR9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMva2ctdGVybXBsYW5uZXIva2ctdGVybXBsYW5uZXItdHV0b3JlZCc7XG5leHBvcnQge0xpc3RDb3Vyc2VzfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2xpc3QtY291cnNlcy9saXN0LWNvdXJzZXMnO1xuXG4vLyBLUyBvbmx5XG5leHBvcnQge0tTVGVybVBsYW5uZXJTZWxmIGFzIEtTVGVybVBsYW5uZXJ9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMva3MtdGVybXBsYW5uZXIva3MtdGVybXBsYW5uZXItc2VsZic7XG5leHBvcnQge0tTVGVybVBsYW5uZXJUdXRvcmVkfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2tzLXRlcm1wbGFubmVyL2tzLXRlcm1wbGFubmVyLXR1dG9yZWQnO1xuZXhwb3J0IHtLU0dvYWxzfSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2tzLWdvYWxzL2dvYWxzJ1xuZXhwb3J0IHtNeUNvdXJzZXN9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvbXktY291cnNlcy9teS1jb3Vyc2VzJztcbmV4cG9ydCB7TXlTdWJqZWN0c30gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9teS1zdWJqZWN0cy9teS1zdWJqZWN0cyc7IiwiaW1wb3J0IEtFRCBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRCc7XG5pbXBvcnQge2NvbXBvbmVudHN9IGZyb20gJy4va2VkY29tcG9uZW50cy5jbGllbnQnO1xuS0VELmNvbXBvbmVudHMgPSB7Li4uS0VELmNvbXBvbmVudHMsIC4uLmNvbXBvbmVudHN9O1xuIiwiaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJy4uL3V0aWxzL3F1ZXJ5LXN0cmluZyc7XG5pbXBvcnQgRmVhdHVyZURlc2NyaXB0aW9ucyBmcm9tICcuL2ZlYXR1cmUtZmxhZ3MuanNvbic7XG5pbXBvcnQgeyBjZmcgfSBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xuXG50eXBlIEZlYXR1cmVGbGFncyA9IHtyZWFkb25seSBbUCBpbiBrZXlvZiB0eXBlb2YgRmVhdHVyZURlc2NyaXB0aW9uc106IGJvb2xlYW59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVzIGV4dGVuZHMgRmVhdHVyZUZsYWdzIHt9XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlcyB7XG4gIHByaXZhdGUgX2ZlYXR1cmVzOiBGZWF0dXJlRmxhZ3M7XG4gIHByaXZhdGUgX2luaXRpYWxpemVkID0gZmFsc2U7XG5cbiAgaW5pdCgpIHtcbiAgICBpZiAodGhpcy5faW5pdGlhbGl6ZWQpIHJldHVybjtcbiAgICBsZXQgdHVybmVkT25GZWF0dXJlcyA9IChjZmcuS0VEX0ZFQVRVUkVTIHx8IFwiXCIpLnNwbGl0KCcsJykubWFwKG5hbWUgPT4gbmFtZS50cmltKCkudG9Mb3dlckNhc2UoKSk7XG4gICAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCwge3RvTG93ZXI6IHRydWV9KTtcblxuICAgIGlmIChxdWVyeS50ZXN0dmVyc2lvbikge1xuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IFtcIipcIl07XG4gICAgfVxuICAgIGlmIChxdWVyeS5mZWF0dXJlcykge1xuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IHF1ZXJ5LmZlYXR1cmVzXG4gICAgICAgIC5zcGxpdCgnLCcpXG4gICAgICAgIC5tYXAoZmVhdHVyZSA9PiBmZWF0dXJlLnRyaW0oKS50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gICAgY29uc3QgdHVybk9uQWxsID0gdHVybmVkT25GZWF0dXJlcy5pbmNsdWRlcygnKicpO1xuICAgIHRoaXMuX2ZlYXR1cmVzID0ge30gYXMgRmVhdHVyZUZsYWdzO1xuICAgIGZvciAoY29uc3QgZmVhdHVyZU5hbWUgb2YgT2JqZWN0LmtleXMoRmVhdHVyZURlc2NyaXB0aW9ucykpIHtcbiAgICAgIHRoaXMuX2ZlYXR1cmVzW2ZlYXR1cmVOYW1lXSA9IHR1cm5PbkFsbCB8fFxuICAgICAgICB0dXJuZWRPbkZlYXR1cmVzLmluY2x1ZGVzKGZlYXR1cmVOYW1lLnRvTG93ZXJDYXNlKCkpXG4gICAgfVxuICAgIHRoaXMuX2luaXRpYWxpemVkID0gdHJ1ZTsgICAgXG4gIH1cblxuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgZm9yIChjb25zdCBmZWF0dXJlTmFtZSBvZiBPYmplY3Qua2V5cyhGZWF0dXJlRGVzY3JpcHRpb25zKSkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGZlYXR1cmVOYW1lLCB7XG4gICAgICAgIGdldCgpIHtcbiAgICAgICAgICBpZiAoIXRoaXMuX2luaXRpYWxpemVkKSB0aGlzLmluaXQoKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZmVhdHVyZXNbZmVhdHVyZU5hbWVdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQodmFsdWUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlYXR1cmUgZmxhZ3MgY2Fubm90IGJlIHNldCBoZXJlJyk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBmZWF0dXJlcyA9IG5ldyBGZWF0dXJlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9mZWF0dXJlcyc7XG4iLCJpbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5cbmRlY2xhcmUgdmFyIHByb2Nlc3M6IGFueTtcblxuY2ZnLkVOVklST05NRU5UID0gcHJvY2Vzcy5lbnYuRU5WSVJPTk1FTlQgYXMgXCJwcm9kdWN0aW9uXCIgfCBcImRldmVsb3BtZW50XCIgfCBcInRlc3RcIjtcbmNmZy5LRURfQVBJX1VSTCA9IHByb2Nlc3MuZW52LktFRF9BUElfVVJMOyAvLyBcImh0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXG5jZmcuRURTX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5FRFNfQVBJX1VSTDsgLy8gXCJodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXG5jZmcuS0VEX1RPS0VOX1VSTCA9IHByb2Nlc3MuZW52LktFRF9UT0tFTl9VUkw7IC8vIFwiaHR0cHM6Ly9rZWRhdXRodGVzdC5henVyZXdlYnNpdGVzLm5ldC90b2tlblwiXG5jZmcuS0VEX0NMSUVOVF9JRCA9IHByb2Nlc3MuZW52LktFRF9DTElFTlRfSUQ7IC8vIFwiZGV2Y2xpZW50XCIsIFwidGVzdGNsaWVudFwiLCBcIi4uLlwiXG5jZmcuS0VEX0NMSUVOVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX1NFQ1JFVDtcbmNmZy5LRURfUkVBTE0gPSBwcm9jZXNzLmVudi5LRURfUkVBTE07IC8vIFwiU0UxXCJcbmNmZy5LRURfTE9DQUxFID0gY2ZnLktFRF9MT0NBTEUgfHwgcHJvY2Vzcy5lbnYuS0VEX0xPQ0FMRTsgLy8gXCJzdlwiLCBcImVuXCIuIE9ubHkgc2V0IGZyb20gcHJvY2Vzcy5lbnYgaWYgbm90IHNldCBmcm9tIFNpdGVWaXNpb24gZWxlbWVudCBjb25maWcuXG5jZmcuS0VEX1NDSE9PTF9MT0NBTEUgPSBjZmcuS0VEX1NDSE9PTF9MT0NBTEUgfHwgcHJvY2Vzcy5lbnYuS0VEX1NDSE9PTF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlbl9zaW5cIiwgXCJlbl9uaW5cIi4gT25seSBzZXQgZnJvbSBwcm9jZXNzLmVudiBpZiBub3Qgc2V0IGZyb20gU2l0ZVZpc2lvbiBlbGVtZW50IGNvbmZpZy5cbmNmZy5LRURfUkVTT1VSQ0VTX1VSTCA9IGNmZy5LRURfUkVTT1VSQ0VTX1VSTCB8fCBwcm9jZXNzLmVudi5LRURfUkVTT1VSQ0VTX1VSTDtcbiIsIi8qIFRoZXNlIHNjcmlwdHMgYXNzdW1lIHNvbWUgb2YgdGhlIGdsb2JhbCB2YXJzIGhhdmUgYWxyZWFkeSBiZWVuIHNldDpcbiAgKiBLRUQuY2ZnXG4gICogS0VELmVudi5jdXJyZW50VXNlclxuXG4gIFRoZSByZXN0IHdpbGwgYmUgc2V0IGhlcmUgKGNsaWVudCBzaWRlKVxuKi9cbmltcG9ydCAnLi9jb25maWd1cmUnO1xuaW1wb3J0ICcuL3NldC1iZWFyZXItcHJvdmlkZXJzJztcbmltcG9ydCAnLi9zZXQta2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCAnLi9zZXQtZWRzLWNsaWVudCc7XG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nLCBzcGxpdFVybEFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudFdlYiwgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIsIGlzb21vcnBoaWMsIHN0b3JhZ2UgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XG5pbXBvcnQgeyBCZWFyZXJQcm92aWRlciwgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5pbXBvcnQgeyBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyB9IGZyb20gXCIuLi9hY2Nlc3MtY29udHJvbC9pbmRleFwiO1xuaW1wb3J0IHsgY2hlcnJ5UGlja1Byb3BzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5cbmZ1bmN0aW9uIGdldE1lcmdlZFRva2VuUGF0aCh0b2tlblBhdGg6IHN0cmluZywgbG9jYXRpb25TZWFyY2g6IHN0cmluZywgc2NvcGVzOiBzdHJpbmdbXSkge1xuICAvLyBNZXJnZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtcyBvZiB0b2tlbiBwYXRoIHdpdGggcGFyYW1zIGdpdmVuIHRvIGN1cnJlbnQgcGFnZVxuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uU2VhcmNoKTtcbiAgY29uc3QgaW1wZXJzb25hdGlvblByb3BzID0gY2hlcnJ5UGlja1Byb3BzKGN1cnJlbnRRdWVyeSwgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpO1xuICBjb25zdCBbdG9rZW5QYXRoV2l0aG91dFF1ZXJ5LCB0b2tlblF1ZXJ5U3RyaW5nXSA9IHNwbGl0VXJsQW5kUXVlcnkodG9rZW5QYXRoKTtcbiAgY29uc3QgdG9rZW5QYXRoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKHRva2VuUXVlcnlTdHJpbmcpO1xuICByZXR1cm4gdG9rZW5QYXRoV2l0aG91dFF1ZXJ5ICsgZ2VuZXJhdGVRdWVyeVN0cmluZyh7XG4gICAgLi4udG9rZW5QYXRoUXVlcnksXG4gICAgLi4uaW1wZXJzb25hdGlvblByb3BzLFxuICAgIHNjb3Blczogc2NvcGVzLmpvaW4oJywnKVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcbiAgcmV0dXJuIG1lcmdlZFRva2VuUGF0aCArIFwiL1wiICsgdXNlckVtYWlsO1xufVxuXG5mdW5jdGlvbiBzYXZlVXNlckluZm8odXNlcjogVXNlciwgdG9rZW5JZDogc3RyaW5nKSB7XG4gIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XG4gIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCwgSlNPTi5zdHJpbmdpZnkodXNlcikpO1xufVxuXG5mdW5jdGlvbiBsb2FkVXNlckluZm8odG9rZW5JZDogc3RyaW5nKSB7XG4gIGNvbnN0IHN0b3JlZFNlc3Npb25Vc2VyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInVzZXJJbmZvXCIgKyB0b2tlbklkKTtcbiAgaWYgKHN0b3JlZFNlc3Npb25Vc2VyKSB7XG4gICAgZW52LmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRTZXNzaW9uVXNlcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgaWYgKHJlcy51c2VyKSB7XG4gICAgICBzYXZlVXNlckluZm8ocmVzLnVzZXIsIHRva2VuSWQpO1xuICAgIH1cbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcbiAgfSwgdG9rZW5JZCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUdvb2dsZVRva2VuUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgcmV0dXJuIHsgdG9rZW46IHJlcy50b2tlbiwgZXhwaXJlczogRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwIH07XG4gIH0sIHRva2VuSWQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcih0b2tlblVybDogc3RyaW5nLCB1c2VyOiBVc2VyLCBzY29wZXM6IHN0cmluZ1tdKSB7XG4gIHJldHVybiBuZXcgS2VkQmVhcmVyUHJvdmlkZXIoXG4gICAgaXNvbW9ycGhpYyxcbiAgICBzdG9yYWdlLFxuICAgIHRva2VuVXJsICsgdXNlci5tYWlsICsgbG9jYXRpb24uc2VhcmNoLFxuICAgIGNmZy5LRURfQ0xJRU5UX0lELFxuICAgIGNmZy5LRURfQ0xJRU5UX1NFQ1JFVCxcbiAgICB0b2tlblVybCwge1xuICAgICAgZW1haWw6IHVzZXIubWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgcm9sZXM6IHVzZXIucm9sZXMsXG4gICAgICBzY2hvb2w6IHVzZXIuc2Nob29sLFxuICAgICAgc2Nob29sVHlwZTogdXNlci5zY2hvb2xUeXBlLFxuICAgICAgc2NvcGVzXG4gICAgfSk7XG59XG5cbi8vIGVudi5jdXJyZW50VXNlci5tYWlsIGlzIHNldCBieSBTaXRlVmlzaW9uIHNlcnZlciBpbml0aWFsbHkuXG4vLyBBIHJlc3BvbnNlIGZyb20gL2FwaS90b2tlbiBtYXkgY2hhbmdlIHRoZSBtYWlsIGF0dHJpYnV0ZSBvZiB0aGUgY3VycmVudFxuLy8gdXNlciwgc28gZW52LmN1cnJlbnRVc2VyLm1haWwgbWF5IGJlIGRpZmZlcmVudCBhZnRlciBnZXR0aW5nIGEgcmVzcG9uc2UuXG4vLyBIb3dldmVyLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB2YWx1YWJsZSBhbHdheXMgaW4gb3JkZXIgdG8gZGlzdGluZ3Vpc2ggdGhlIGNhc2Vcbi8vIHdoZW4gb25lIG5vcm1hbCB1c2VyIGxvZ3Mgb3V0IGFuZCBhbm90aGVyIHVzZXIgbG9ncyBpbi5cbmNvbnN0IGluaXRpYWxVc2VyRW1haWwgPSBlbnYuY3VycmVudFVzZXIgJiYgZW52LmN1cnJlbnRVc2VyLm1haWw7IC8vIEluaXRpYWwgdmFsdWUgb2YgbWFpbC4gTWF5IGNoYW5nZS5cbmlmIChpbml0aWFsVXNlckVtYWlsKSB7XG4gIC8vIEtFRFxuICBpZiAoY2ZnLktFRF9UT0tFTl9QQVRIKSB7XG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFByb2R1Y3Rpb24gLyBTaXRlVmlzaW9uIHByb3hpZWQgL2FwaS90b2tlbiB0byByZXF1ZXN0IHRva2VucyBmcm9tOlxuICAgIC8vXG4gICAgLy9cbiAgICBjb25zdCBtZXJnZWRUb2tlblBhdGggPSBnZXRNZXJnZWRUb2tlblBhdGgoXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcbiAgICAgICAgXCJrZWRiYWNrZW5kXCIsXG4gICAgICAgIFwiRURTXCIsXG4gICAgICBdKTtcbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIGluaXRpYWxVc2VyRW1haWwpO1xuICAgIGxvYWRVc2VySW5mbyhnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCkpO1xuXG4gICAgLy8gR29vZ2xlXG4gICAgY29uc3QgZ29vZ2xlTWVyZ2VkUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcbiAgICAgIGNmZy5LRURfVE9LRU5fUEFUSCxcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCwgW1xuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcbiAgICAgICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2RyaXZlXCIsXG4gICAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5jb3Vyc2VzJyxcbiAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLnByb2ZpbGUuZW1haWxzJyxcbiAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLnByb2ZpbGUucGhvdG9zJyxcbiAgICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLnJvc3RlcnMucmVhZG9ubHknLFxuICAgICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jbGFzc3Jvb20ucm9zdGVycycsXG4gICAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5jb3Vyc2V3b3JrLnN0dWRlbnRzJ1xuICAgICAgICBcbiAgICAgIF0pO1xuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlR29vZ2xlVG9rZW5Qcm92aWRlcihnb29nbGVNZXJnZWRQYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcbiAgfSBlbHNlIGlmIChjZmcuS0VEX1RPS0VOX1VSTCAmJiBjZmcuS0VEX0NMSUVOVF9JRCAmJiBjZmcuS0VEX0NMSUVOVF9TRUNSRVQpIHtcbiAgICAvL1xuICAgIC8vXG4gICAgLy8gVGVzdCAtIGdvIGRpcmVjdGx5IHRvIEtFREFVVEggc2VydmVyIHRvIHJldHJpZXZlIHRva2Vuc1xuICAgIC8vXG4gICAgLy9cbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCwgZW52LmN1cnJlbnRVc2VyLCBbXG4gICAgICBcImtlZGJhY2tlbmRcIixcbiAgICAgIFwiRURTXCIsXG4gICAgXSk7XG4gICAgZW52Lmdvb2dsZVRva2VuUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCArIFwiL2dvb2dsZVwiLCBlbnYuY3VycmVudFVzZXIsIFtcbiAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5yZWFkb25seVwiLFxuICAgICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2RyaXZlXCIsXG4gICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jbGFzc3Jvb20uY291cnNlcycsXG4gICAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jbGFzc3Jvb20ucHJvZmlsZS5lbWFpbHMnLFxuICAgICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLnByb2ZpbGUucGhvdG9zJyxcbiAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5yb3N0ZXJzLnJlYWRvbmx5JyxcbiAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5yb3N0ZXJzJyxcbiAgICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5jb3Vyc2V3b3JrLnN0dWRlbnRzJ1xuICAgIF0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBjb25maWd1cmF0aW9uIHBhcmFtZXRlciBLRURfVE9LRU5fUEFUSGApO1xuICB9XG59XG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBpc29tb3JwaGljIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuaW1wb3J0IHsgRWRzQ2xpZW50IH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuXG5lbnYuZWRzQ2xpZW50ID0gbmV3IEVkc0NsaWVudCAoXG4gIGlzb21vcnBoaWMsXG4gIGNmZy5FRFNfQVBJX1VSTCxcbiAgZW52LmJlYXJlclByb3ZpZGVyLFxuICAoKT0+ZW52LmN1cnJlbnRVc2VyLm1haWwpO1xuXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuXG5lbnYua2VkQmFja2VuZENsaWVudCA9IG5ldyBLZWRCYWNrZW5kQ2xpZW50V2ViIChcbiAgY2ZnLktFRF9BUElfVVJMLFxuICBlbnYuYmVhcmVyUHJvdmlkZXIpO1xuXG4iLCJpbXBvcnQgS0VEIGZyb20gJy4vS0VEJztcblxuLyogVGhpcyBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaXMgdXNlZCBhcyBhIGZhbGxiYWNrLlxuTm9ybWFsbHkgYm90aCB0ZXN0IHBhZ2VzIGFuZCBwcm9kdWN0aW9uIHBhZ2VzIHdpbGwgb3ZlcnJpZGUgdGhlc2UgY29uZmlncmF0aW9uc1xuKi9cbi8qY29uc3QgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7XG4gIC8vIEVudmlyb25tZW50XG4gIEVOVklST05NRU5UOiAnZGV2ZWxvcG1lbnQnIGFzICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCcsXG4gIC8vIEF1dGhlbnRpY2F0aW9uIFNlcnZlcjpcbiAgS0VEX1RPS0VOX1VSTDogJ2h0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW4nLFxuICBLRURfVE9LRU5fUEFUSDogJy9hcGkvdG9rZW4uU2tyaXB0LnBvcnRsZXQ/c3YuY29udGVudHR5cGU9YXBwbGljYXRpb24vanNvbicsXG4gIEtFRF9DTElFTlRfSUQ6ICdkZXZjbGllbnQnLFxuICBLRURfQ0xJRU5UX1NFQ1JFVDogJzRmUmRmUXBXdEpxalRXZicsXG4gIC8vIFNlcnZpY2VzOlxuICBLRURfQVBJX1VSTDogJ2h0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLycsICBcbiAgRURTX0FQSV9VUkw6ICdodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLydcbn0qL1xuXG5leHBvcnQgaW50ZXJmYWNlIElLZWRDb25maWd1cmF0aW9uIHtcbiAgRU5WSVJPTk1FTlQ6ICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCc7XG4gIEtFRF9SRUFMTTogc3RyaW5nO1xuICBLRURfVE9LRU5fVVJMOiBzdHJpbmc7XG4gIEtFRF9UT0tFTl9QQVRIOiBzdHJpbmc7XG4gIEtFRF9DTElFTlRfSUQ6IHN0cmluZztcbiAgS0VEX0NMSUVOVF9TRUNSRVQ6IHN0cmluZztcbiAgS0VEX0FQSV9VUkw6IHN0cmluZztcbiAgRURTX0FQSV9VUkw6IHN0cmluZztcbiAgS0VEX0xPQ0FMRTogc3RyaW5nO1xuICBLRURfU0NIT09MX0xPQ0FMRTogc3RyaW5nO1xuICBLRURfQ09VUlNFX0JVSUxERVJfVVJMOiBzdHJpbmc7XG4gIEtFRF9DT1VSU0VfVklFV0VSX1VSTDogc3RyaW5nO1xuICBLRURfU1VCSkVDVF9QTEFOTkVSX0FETUlOX1VSTDogc3RyaW5nO1xuICBLRURfU1VCSkVDVF9QTEFOTkVSX1VSTDogc3RyaW5nO1xuICBLRURfRkVBVFVSRVM6IHN0cmluZztcbiAgS0VEX0tFRVBfQUxJVkVfVVJMOiBzdHJpbmc7XG4gIEtFRF9FTlVNX1dPUkRCQU5LU19VUkw6IHN0cmluZztcbiAgS0VEX1dPUkRCQU5LU19VUkw6IHN0cmluZztcbiAgS0VEX1JFU09VUkNFU19VUkw6IHN0cmluZztcbn07XG5cbmlmICghS0VELmNmZykgS0VELmNmZyA9IHt9O1xuXG5leHBvcnQgZGVmYXVsdCBLRUQuY2ZnIGFzIElLZWRDb25maWd1cmF0aW9uO1xuZXhwb3J0IGNvbnN0IGNmZzogSUtlZENvbmZpZ3VyYXRpb24gPSBLRUQuY2ZnO1xuIiwiaW1wb3J0IHtVc2VyLCBMZWFybmluZ01vZHVsZVRhc2tzfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBCZWFyZXJQcm92aWRlciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7VXNlclRhc2t9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi4vcmVwb3Mva2VkLXJlcG8nO1xuaW1wb3J0IHtFZHNDbGllbnR9IGZyb20gJy4uL2FwaXMvZWRzY2xpZW50JztcbmltcG9ydCBLRUQgZnJvbSAnLi9rZWQnO1xuaW1wb3J0IHsgS1NUZXJtUGxhbm5lclJlcG8gfSBmcm9tICcuLi9yZXBvcy9rcy10ZXJtcGxhbm5lci1yZXBvJztcblxuZXhwb3J0IGludGVyZmFjZSBFbnYge1xuICAgIGN1cnJlbnRVc2VyPzogVXNlcjtcbiAgICBsZWFybmluZ01vZHVsZVRhc2tzPzogTGVhcm5pbmdNb2R1bGVUYXNrcztcbiAgICBiZWFyZXJQcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xuICAgIGdvb2dsZVRva2VuUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcbiAgICBrZWRCYWNrZW5kQ2xpZW50PzogS2VkQmFja2VuZENsaWVudDtcbiAgICBlZHNDbGllbnQ/OiBFZHNDbGllbnQ7XG4gICAgdXNlclRhc2tzUmVwbz87XG4gICAgaGlkZGVuQ291cnNlc1JlcG8/O1xuICAgIHdlZWtOb3Rlc1JlcG8/O1xuICAgIGtnVGVybVBsYW5uZXJSZXBvPztcbiAgICBrc1Rlcm1QbGFubmVyUmVwbz86IEtTVGVybVBsYW5uZXJSZXBvXG4gICAgdHV0b3JlZDogYm9vbGVhbjtcbiAgICBlcnJvcj86IEVycm9yO1xufVxuXG5pZiAoIUtFRC5lbnYpIEtFRC5lbnYgPSB7fTtcblxuZXhwb3J0IGRlZmF1bHQgS0VELmVudiBhcyBFbnY7XG5leHBvcnQgY29uc3QgZW52OiBFbnYgPSBLRUQuZW52O1xuIiwiXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XG5cbmRlY2xhcmUgdmFyIEtFRDogYW55O1xuXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XG4iLCJpbXBvcnQge1VzZXIsIExlYXJuaW5nTW9kdWxlVGFza3N9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IEtFRCBmcm9tICcuL2tlZCc7XG5pbXBvcnQgZW52LCB7RW52fSBmcm9tICcuL0tFRC5lbnYnO1xuXG5leHBvcnQgY2xhc3MgVHV0b3JFbnYge1xuICBzdWJzY3JpYmVyczogQXJyYXk8KGVudjogRW52KT0+dm9pZD4gPSBbXTtcbiAgZW52OiBFbnYgfCBudWxsID0gbnVsbDtcbiAgdmVyc2lvbiA9IDE7XG4gIC8vcHJvbWlzZTogUHJvbWlzZTxFbnYgfCBudWxsPiA9IFByb21pc2UucmVzb2x2ZShudWxsKTtcblxuICBhc3luYyBzdWJzY3JpYmUoc3Vic2NyaWJlcjogKGVudjogRW52KSA9PiB2b2lkKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHN1YnNjcmliZXIpO1xuICAgIHN1YnNjcmliZXIodGhpcy5lbnYpO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoc3Vic2NyaWJlcjogKGVudjogRW52KSA9PiB2b2lkKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycyA9IHRoaXMuc3Vic2NyaWJlcnMuZmlsdGVyIChzID0+IHMgIT09IHN1YnNjcmliZXIpO1xuICB9XG5cbiAgYXN5bmMgbm90aWZ5U3Vic2NyaWJlcnMoKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHMgPT4gcyh0aGlzLmVudikpO1xuICB9XG5cbiAgYXN5bmMgc2V0TmV3RW52KHVzZXI6IFVzZXIsIGVudkdldHRlcjogKCk9PlByb21pc2U8RW52Pikge1xuICAgIGxldCB2ZXJzaW9uID0gKyt0aGlzLnZlcnNpb247XG4gICAgdGhpcy5lbnYgPSB7Y3VycmVudFVzZXI6IHVzZXIsIHR1dG9yZWQ6IHRydWV9O1xuICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcnMoKTsgLy8gTWFrZSBzdWJzY3JpYmVyIGRpc3BsYXkgXCJMb2FkaW5nLi4uIHVzZXIgbmFtZVwiXG4gICAgY29uc3QgZW52OiBFbnYgPSBhd2FpdCBlbnZHZXR0ZXIoKS5jYXRjaChlcnIgPT4gKHtcbiAgICAgIGN1cnJlbnRVc2VyOiB1c2VyLFxuICAgICAgdHV0b3JlZDogdHJ1ZSxcbiAgICAgIGVycm9yOiBlcnJcbiAgICB9KSk7XG4gICAgaWYgKHZlcnNpb24gPT09IHRoaXMudmVyc2lvbikge1xuICAgICAgLy8gTm8gb25lIGVsc2UgaGFzIGNhbGxlZCBzZXRFbnYgZHVyaW5nIHRoaXMgY2FsbC5cbiAgICAgICsrdGhpcy52ZXJzaW9uO1xuICAgICAgdGhpcy5lbnYgPSB7Li4uZW52LCB0dXRvcmVkOiB0cnVlfTtcbiAgICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcnMoKTsgLy8gTWFrZSBzdWJzY3JpYmVycyBkaXNwbGF5IHRoZSBkYXRhLlxuICAgIH1cbiAgfVxufVxuXG5pZiAoIUtFRC50dXRvckVudikgS0VELnR1dG9yRW52ID0gbmV3IFR1dG9yRW52KCk7XG5cbmV4cG9ydCBkZWZhdWx0IEtFRC50dXRvckVudiBhcyBUdXRvckVudjtcbiIsImltcG9ydCBlbnYgZnJvbSAnLi9LRUQuZW52JztcbmltcG9ydCB7IEtlZEJhY2tlbmRSZXBvIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcbmltcG9ydCB7IGdldEdsb2JhbElkLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IGNmZyBmcm9tICcuL0tFRC5jZmcnO1xuaW1wb3J0IHsgU2Nob29sLCBCcmFuY2ggfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XG5cbmV4cG9ydCBjb25zdCBkYiA9IG5ldyBLZWRCYWNrZW5kUmVwbyhcbiAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxuICAoKT0+ZW52LmN1cnJlbnRVc2VyID9cbiAgICBlbnYuY3VycmVudFVzZXIubWFpbCA6XG4gICAgXCJcIixcbiAgKCk9PmVudi5jdXJyZW50VXNlciA/XG4gICAgZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lIHx8IGVudi5jdXJyZW50VXNlci5tYWlsIDpcbiAgICBcIlwiKTtcblxuZXhwb3J0IGNvbnN0IGdsb2JhbElkID0gZ2V0R2xvYmFsSWQoY2ZnLktFRF9SRUFMTSk7XG5leHBvcnQgY29uc3QgU2Nob29scyA9IHtcbiAgc3RhbmRhcmRTY2hvb2w6IGRiLnNjaG9vbHMubmFtZShcInN0YW5kYXJkXCIpLmNhY2hlT3B0aW1pemVkKCkuc2luZ2xlKCksXG4gIGdldCBteVNjaG9vbCAoKSB7IHJldHVybiBkYi5zY2hvb2xzLm5hbWUoZW52LmN1cnJlbnRVc2VyLnNjaG9vbCkuY2FjaGVPcHRpbWl6ZWQoKS5zaW5nbGUoKTsgfVxufTtcbmV4cG9ydCBjb25zdCBDb3Vyc2VJbnN0YW5jZXMgPSB7XG4gIGdldEJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PlxuICAgICAgZGIuYnJhbmNoZXNcbiAgICAgICAgLmhhc0VkZ2VzRnJvbShbc2Nob29sLm9mZmljaWFsQnJhbmNoSWRdKVxuICAgICAgICAubmFtZShcImRyYWZ0XCIpXG4gICAgICAgIC50YWdzKGNvdXJzZUlkKVxuICAgICAgICAuaWRzT25seSgpXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKVxuICAgICAgICAudG9WYWx1ZSgpXG4gICAgICAgIC5tYXAoaWRzID0+IGlkcy5sZW5ndGggPiAwID8gaWRzWzBdIDogdW5kZWZpbmVkKSk7XG4gIH0sXG5cbiAgLyoqIEdldCBhIERSQUZUIGJyYW5jaCBmb3IgZ2l2ZW4gY291cnNlIElEIGFuZCBnaXZlbiBzY2hvb2wuXG4gICAqIElmIHRoZXJlIGlzIG5vdCB5ZXQgc3VjaCBhIGJyYW5jaCwgY3JlYXRlIGl0IHVzaW5nIG11dGF0aW9uc09uRW1wdHkoKSB3aGljaCB3aWxsXG4gICAqIGxlYWQgdG8gdGhlIEMjIGNvZGUgRG9jdW1lbnRSZXBvc2l0b3J5LlJlYWRPck11dGF0ZSgpIHZpYSBEb2N1bWVudENvbnRyb2xsZXIuXG4gICAqL1xuICBnZXRPckNyZWF0ZUJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBkYi5jb3Vyc2VJbnN0YW5jZXMuaWRzT25seSgpLmlkKGNvdXJzZUlkKS5zd2l0Y2hNYXAoKCk9PiAvLyBUSGlzIGZpcnN0IGxpbmUgdmVyaWZpZXMgY291cnNlIGV4aXN0cy4gSWYgZGVsZXRlZCwgZG9uJ3QgdHJ5IHRvIHJlY3JlYXRlIGl0cyBicmFuY2ghXG4gICAgICBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PiBcbiAgICAgIGRiLmJyYW5jaGVzXG4gICAgICAgIC5oYXNFZGdlc0Zyb20oW3NjaG9vbC5vZmZpY2lhbEJyYW5jaElkXSlcbiAgICAgICAgLm5hbWUoXCJkcmFmdFwiKVxuICAgICAgICAudGFncyhjb3Vyc2VJZClcbiAgICAgICAgLmlkc09ubHkoKVxuICAgICAgICAubXV0YXRpb25zT25FbXB0eSh0eCA9PiB7XG4gICAgICAgICAgLy8gVGhlc2UgMiBtdXRhdGlvbnMgd2lsbCBvY2N1ciBzZXJ2ZXIgc2lkZSwgYXRvbWljYWxseS5cbiAgICAgICAgICAvLyBXaWxsIGJlIHNlbnQgb24gZWFjaCByZXF1ZXN0IGluIHRoZSBxdWVyeSwgYnV0IHdpbGwgb25seSBleGVjdXRlIGlmIHF1ZXJ5IHJlc3VsdHMgaW4gemVybyBpdGVtcy5cbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU2Nob29sOlwiLCBzY2hvb2wpO1xuICAgICAgICAgIGNvbnN0IGlkID0gY3JlYXRlVVVJRCgpO1xuICAgICAgICAgIHR4LmFkZChcImJyYW5jaGVzXCIsIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgYWNsOiBbXG4gICAgICAgICAgICAgIFwicm9sZTpVU0VSOlJcIixcbiAgICAgICAgICAgICAgYHNjaG9vbFJvbGU6JHtzY2hvb2wubmFtZX0vRU1QTE9ZRUU6U2BcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBuYW1lOiAnZHJhZnQnLFxuICAgICAgICAgICAgc2Nob29sSWQ6IHNjaG9vbC5pZCxcbiAgICAgICAgICAgIHRyZWVQYXJlbnRJZDogc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsXG4gICAgICAgICAgICB0YWdzOiBbY291cnNlSWRdXG4gICAgICAgICAgfSBhcyBCcmFuY2gpO1xuICAgICAgICAgIC8vIEFwcHJvdmluZyB0aGUgYnJhbmNoIG1ha2VzIHN1cmUgdGhhdCBpdCB3YXMgY3JlYXRlZCBieSBhbiBFTVBMT1lFRSBvbiBnaXZlbiBzY2hvb2wuXG4gICAgICAgICAgdHgubGluazIoXCJicmFuY2hlc1wiLCBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCwgXCJhcHByb3ZlZENoaWxkcmVuXCIsIGlkKTtcbiAgICAgICAgfSlcbiAgICAgICAgLnNpbmdsZSgpXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKSkpO1xuICB9LFxuXG4gIGdldEFsbERlc2NlbmRhbnRJZHMoY291cnNlSWQ6IHN0cmluZykge1xuICAgIHJldHVybiBkYi5jb3Vyc2VCbG9ja3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpLmNvbmNhdChcbiAgICAgIGRiLmNvdXJzZUNvbnRlbnRzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSkuY29uY2F0KFxuICAgICAgZGIuY291cnNlVGFicy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpLmNvbmNhdChcbiAgICAgIGRiLnRhc2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSlcbiAgICAgIC5tYXAoeCA9PiB4LmlkKTtcbiAgfVxufVxuIiwiXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XG5cbmRlY2xhcmUgdmFyIEtFRDogYW55O1xuXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5cbmlmIChjZmcuS0VEX0xPQ0FMRSA9PT0gXCJzdlwiKSB7XG4gICAgbW9tZW50LnVwZGF0ZUxvY2FsZSgnc3YnLCB7XG4gICAgICAgIG1vbnRoczogJ2phbnVhcmlfZmVicnVhcmlfbWFyc19hcHJpbF9tYWpfanVuaV9qdWxpX2F1Z3VzdGlfc2VwdGVtYmVyX29rdG9iZXJfbm92ZW1iZXJfZGVjZW1iZXInLnNwbGl0KCdfJyksXG4gICAgICAgIG1vbnRoc1Nob3J0OiAnamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMnLnNwbGl0KCdfJyksXG4gICAgICAgIHdlZWtkYXlzOiAnc8O2bmRhZ19tw6VuZGFnX3Rpc2RhZ19vbnNkYWdfdG9yc2RhZ19mcmVkYWdfbMO2cmRhZycuc3BsaXQoJ18nKSxcbiAgICAgICAgd2Vla2RheXNTaG9ydDogJ3PDtm5fbcOlbl90aXNfb25zX3Rvcl9mcmVfbMO2cicuc3BsaXQoJ18nKSxcbiAgICAgICAgd2Vla2RheXNNaW46ICdzw7ZfbcOlX3RpX29uX3RvX2ZyX2zDticuc3BsaXQoJ18nKSxcbiAgICAgICAgbG9uZ0RhdGVGb3JtYXQ6IHtcbiAgICAgICAgICAgIExUOiAnSEg6bW0nLFxuICAgICAgICAgICAgTFRTOiAnSEg6bW06c3MnLFxuICAgICAgICAgICAgTDogJ1lZWVktTU0tREQnLFxuICAgICAgICAgICAgTEw6ICdEIE1NTU0gWVlZWScsXG4gICAgICAgICAgICBMTEw6ICdEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXG4gICAgICAgICAgICBMTExMOiAnZGRkZCBEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXG4gICAgICAgICAgICBsbGw6ICdEIE1NTSBZWVlZIEhIOm1tJyxcbiAgICAgICAgICAgIGxsbGw6ICdkZGQgRCBNTU0gWVlZWSBISDptbSdcbiAgICAgICAgfSxcbiAgICAgICAgY2FsZW5kYXI6IHtcbiAgICAgICAgICAgIHNhbWVEYXk6ICdbSWRhZ10gTFQnLFxuICAgICAgICAgICAgbmV4dERheTogJ1tJbW9yZ29uXSBMVCcsXG4gICAgICAgICAgICBsYXN0RGF5OiAnW0lnw6VyXSBMVCcsXG4gICAgICAgICAgICBuZXh0V2VlazogJ1tQw6VdIGRkZGQgTFQnLFxuICAgICAgICAgICAgbGFzdFdlZWs6ICdbSV0gZGRkZFtzXSBMVCcsXG4gICAgICAgICAgICBzYW1lRWxzZTogJ0wnXG4gICAgICAgIH0sXG4gICAgICAgIHJlbGF0aXZlVGltZToge1xuICAgICAgICAgICAgZnV0dXJlOiAnb20gJXMnLFxuICAgICAgICAgICAgcGFzdDogJ2bDtnIgJXMgc2VkYW4nLFxuICAgICAgICAgICAgczogJ27DpWdyYSBzZWt1bmRlcicsXG4gICAgICAgICAgICBzczogJyVkIHNla3VuZGVyJyxcbiAgICAgICAgICAgIG06ICdlbiBtaW51dCcsXG4gICAgICAgICAgICBtbTogJyVkIG1pbnV0ZXInLFxuICAgICAgICAgICAgaDogJ2VuIHRpbW1lJyxcbiAgICAgICAgICAgIGhoOiAnJWQgdGltbWFyJyxcbiAgICAgICAgICAgIGQ6ICdlbiBkYWcnLFxuICAgICAgICAgICAgZGQ6ICclZCBkYWdhcicsXG4gICAgICAgICAgICBNOiAnZW4gbcOlbmFkJyxcbiAgICAgICAgICAgIE1NOiAnJWQgbcOlbmFkZXInLFxuICAgICAgICAgICAgeTogJ2V0dCDDpXInLFxuICAgICAgICAgICAgeXk6ICclZCDDpXInXG4gICAgICAgIH0sXG4gICAgICAgIGRheU9mTW9udGhPcmRpbmFsUGFyc2U6IC9cXGR7MSwyfShlfGEpLyxcbiAgICAgICAgb3JkaW5hbDogZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICAgICAgdmFyIGIgPSBudW1iZXIgJSAxMCxcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSAofn4obnVtYmVyICUgMTAwIC8gMTApID09PSAxKSA/ICdlJyA6XG4gICAgICAgICAgICAgICAgICAgIChiID09PSAxKSA/ICdhJyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAoYiA9PT0gMikgPyAnYScgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChiID09PSAzKSA/ICdlJyA6ICdlJztcbiAgICAgICAgICAgIHJldHVybiBudW1iZXIgKyBvdXRwdXQ7XG4gICAgICAgIH0sXG4gICAgICAgIHdlZWs6IHtcbiAgICAgICAgICAgIGRvdzogMSwgLy8gTW9uZGF5IGlzIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWsuXG4gICAgICAgICAgICBkb3k6IDQgIC8vIFRoZSB3ZWVrIHRoYXQgY29udGFpbnMgSmFuIDR0aCBpcyB0aGUgZmlyc3Qgd2VlayBvZiB0aGUgeWVhci5cbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0IGNvbnN0IGxvY2FsTW9tZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBtb21lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKS5sb2NhbGUoY2ZnLktFRF9MT0NBTEUpO1xufVxuIiwiaW1wb3J0IHsgS2VkUmVwbyB9IGZyb20gJy4va2VkLXJlcG8nO1xuaW1wb3J0IHsgVXNlckhpZGRlbkNvdXJzZSwgU2Nob29sLCBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBFRFNDb3Vyc2UgfSBmcm9tICcuLi9jb250cmFjdHMvZWRzJztcbmltcG9ydCB7IHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AsIGFycmF5VG9NYXAgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgRURTUGVyaW9kIH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuaW1wb3J0IHsgZ2V0U2Nob29sTW9tZW50IH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5leHBvcnQgbGV0IGhpZGRlbkNvdXJzZXNSZXBvID0gZW52LmhpZGRlbkNvdXJzZXNSZXBvIGFzIEhpZGRlbkNvdXJzZXNSZXBvO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ291cnNlV2l0aEhpZGRlblN0YXRlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgdmlzaWJsZTogYm9vbGVhbjtcbiAgZGVmYXVsdFZpc2libGU6IGJvb2xlYW47XG59XG5cbmV4cG9ydCB0eXBlIEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyID0gKGNvdXJzZXM6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdKSA9PiB2b2lkO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmliZXJPcHRpb25zIHtcbiAgZnVsbENvdXJzZTogYm9vbGVhbjtcbn1cblxuY2xhc3MgSGlkZGVuQ291cnNlc1JlcG8ge1xuICByZXN1bHQ6IENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdIHwgbnVsbCA9IG51bGw7XG4gIHN1YnNjcmliZXJzOiB7c3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zfVtdID0gW107XG4gIGZ1bGxDb3Vyc2U6IGJvb2xlYW4gPSBmYWxzZTtcbiAga2VkQ291cnNlc1Byb21pc2U6IFByb21pc2U8UGFydGlhbDxDb3Vyc2U+W10+O1xuICBlZHNDb3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxFRFNDb3Vyc2VbXT47XG4gIHVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxVc2VySGlkZGVuQ291cnNlW10+O1xuICBrZWRSZXBvOiBLZWRSZXBvPFVzZXJIaWRkZW5Db3Vyc2U+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMua2VkUmVwbyA9IG5ldyBLZWRSZXBvPFVzZXJIaWRkZW5Db3Vyc2U+KHtcbiAgICAgIGdldENsaWVudDogKCkgPT4gZW52LmtlZEJhY2tlbmRDbGllbnQsXG4gICAgICBvcHRpbWlzdGljOiB0cnVlLFxuICAgICAgdGFibGU6IFwidXNlcmhpZGRlbmNvdXJzZXNcIixcbiAgICAgIHVzZXI6IGVudi5jdXJyZW50VXNlciA/IGVudi5jdXJyZW50VXNlci5tYWlsIDogXCJcIixcbiAgICAgIGdldFF1ZXJ5T3B0aW9uczogYXN5bmMgKCkgPT4gKHtyb2xlOiBcIlVTRVJcIn0pLFxuICAgIH0pO1xuXG4gICAgY29uc3QgaW5pdFByb21pc2UgPSB0aGlzLmluaXQoKTtcblxuICAgIFByb21pc2UuYWxsKFtcbiAgICAgIGluaXRQcm9taXNlLFxuICAgICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSxcbiAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2VcbiAgICBdKS5jYXRjaChlcnIgPT4gc2hvd0Vycm9yKGVycikpO1xuICB9XG5cbiAgYXN5bmMgaW5pdCgpIHtcbiAgICAvLyBXYWl0IHRpbGwgd2UgaGF2ZSBhIGN1cnJlbnRVc2VyIHRoYXQgaXMgYWNjdXJhdGUgYWxzbyBmb3IgaW1wZXJzb25hdGVkIHVzZXJzLlxuICAgIGNvbnN0IGJlYXJlclByb21pc2UgPSBlbnYuYmVhcmVyUHJvdmlkZXIgPyBlbnYuYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCkgOiBQcm9taXNlLnJlc29sdmUoe30pO1xuXG4gICAgLy8gSW4gcGFyYWxsZWxsLCB3ZSByZXF1ZXN0OlxuICAgIC8vICAxKSBLRURCYWNrZW5kOiBTY2hvb2xzLmFjdGl2ZUNvdXJzZXNcbiAgICAvLyAgMikgRURTLmdldEFjdGl2ZUFjb3Vyc2VzKClcbiAgICAvLyAgMykgKHZpYSBzdWJzY3JpcHRpb24pOiBLRURCYWNrZW5kOiB1c2VySGlkZGVuQ291cnNlc1xuICAgIFxuICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UgPSBiZWFyZXJQcm9taXNlLnRoZW4oKCk9PnRoaXMubGlzdEtlZENvdXJzZXMoKSk7XG4gICAgdGhpcy5lZHNDb3Vyc2VzUHJvbWlzZSA9IGJlYXJlclByb21pc2UudGhlbigoKT0+dGhpcy5saXN0RURTQ291cnNlcygpKTtcbiAgICBsZXQgcmVzb2x2ZVVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTogKHg6IFVzZXJIaWRkZW5Db3Vyc2VbXSk9PnZvaWQ7XG4gICAgbGV0IHVzZXJIaWRkZW5Db3Vyc2VzUmVzb2x2ZWQgPSBmYWxzZTtcbiAgICB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZSA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gcmVzb2x2ZVVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZSA9IHggPT4ge1xuICAgICAgaWYgKHVzZXJIaWRkZW5Db3Vyc2VzUmVzb2x2ZWQpIHtcbiAgICAgICAgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoeCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB1c2VySGlkZGVuQ291cnNlc1Jlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZSh4KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBhd2FpdCBiZWFyZXJQcm9taXNlO1xuXG4gICAgdGhpcy5rZWRSZXBvLm1lbS5zdWJzY3JpYmUoYXN5bmMgdXNlckhpZGRlbkNvdXJzZXMgPT4ge1xuICAgICAgLy8gQ2hhbmdlIG9yIGluaXRpYWwgdmFsdWUgcmVhZHkgdG8gYmUgbm90aWZpZWQgb3V0LlxuICAgICAgLy8gQnV0IGZpcnN0LCBjaGVjayB3ZSBoYXZlIGFsbCB0aGUgcmVsYXRlZCBkYXRhIHJlc3BvbnNlcyB3ZSBuZWVkLlxuICAgICAgY29uc3QgW2FjdGl2ZUNvdXJzZXMsIGVkc0FjdGl2ZUNvdXJzZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0aGlzLmtlZENvdXJzZXNQcm9taXNlLCBcbiAgICAgICAgdGhpcy5lZHNDb3Vyc2VzUHJvbWlzZV0pO1xuICAgICAgXG4gICAgICAvLyBSZWZpbmUgdGhlIHRocmVlIHJlc3VsdHMgaW50byBhIHNpbmdsZSByZXN1bHRcbiAgICAgIHRoaXMucmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVDb3Vyc2VzTGlzdChlZHNBY3RpdmVDb3Vyc2VzLCB1c2VySGlkZGVuQ291cnNlcywgYWN0aXZlQ291cnNlcyk7XG4gICAgICAvLyBOb3RpZnkgb3VyIHN1YnNjcmliZXJzOlxuICAgICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHN1YnNjcmliZXIgPT4gdGhpcy5ub3RpZnlTdWJzY3JpYmVyKHN1YnNjcmliZXIuc3Vic2NyaWJlciwgc3Vic2NyaWJlci5vcHRpb25zKSk7XG4gICAgICByZXNvbHZlVXNlckhpZGRlbkNvdXJzZXNQcm9taXNlKHVzZXJIaWRkZW5Db3Vyc2VzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGxpc3RLZWRDb3Vyc2VzKCkge1xuICAgIGNvbnN0IGZ1bGxDb3Vyc2UgPSB0aGlzLmZ1bGxDb3Vyc2U7XG4gICAgY29uc29sZS5sb2coXCJGdWxsQ291cnNlOiBcIisgZnVsbENvdXJzZSk7XG4gICAgY29uc3Qgc2Nob29scyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U2Nob29sPignc2Nob29scycsIHtcbiAgICAgIHJvbGU6IFwiVVNFUlwiLCAvLyBXb3JrYXJvdW5kIGZyb20gc2hvd2luZyBhY3RpdmF0ZWQgdGVtcGxhdGVzIGFtb25nIGNvdXJzZXMgb2YgdGhlIHNjaG9vbFxuICAgICAgbmFtZTogZW52LmN1cnJlbnRVc2VyLnNjaG9vbCxcbiAgICAgIGluY2x1ZGU6IFwiYWN0aXZlQ291cnNlc1wiLFxuICAgICAgZmxhZ3M6IGZ1bGxDb3Vyc2UgPyBbXSA6IFtcImluY2x1ZGVJZHNBbmROYW1lc09ubHlcIl0sXG4gICAgICBjYWNoZUJ1c3Q6IGVudi5jdXJyZW50VXNlci51c2VybmFtZVxuICAgIH0pO1xuICAgIGNvbnN0IGFjdGl2ZUNvdXJzZXMgPSBmbGF0dGVuKHNjaG9vbHMubWFwKHNjaG9vbCA9PiBzY2hvb2wuYWN0aXZlQ291cnNlcykpLnNvcnQoY29tcGFyZVByb3AoXCJuYW1lXCIpKVxuICAgIHJldHVybiBhY3RpdmVDb3Vyc2VzO1xuICB9XG5cbiAgbGlzdEVEU0NvdXJzZXMoKTogUHJvbWlzZTxFRFNDb3Vyc2VbXSB8IG51bGw+IHtcbiAgICBjb25zdCBwZXJpb2ROYW1lID0gbmV3IEVEU1BlcmlvZChnZXRTY2hvb2xNb21lbnQobW9tZW50KCkpKS5wZXJpb2Q7XG4gICAgcmV0dXJuIGVudi5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKCdFTVBMT1lFRScpID09PSAtMSA/XG4gICAgICAvLyBTVFVERU5UcyBzaG91bGQsIGJ5IGRlZmF1bHQsIG9ubHkgc2hvdyBjb3Vyc2VzIHRoYXQgaXMgbGlzdGVkIGluIEVEU1xuICAgICAgZW52LmVkc0NsaWVudC5nZXRBY3RpdmVDb3Vyc2VzKHtwZXJpb2ROYW1lfSkgOlxuICAgICAgLy8gRU1QTE9ZRUVzIHNob3VsZCwgYnkgZGVmYXVsdCwgc2hvdyBhbGwgY291cnNlcyBvbiBzY2hvb2wgLSBubyBuZWVkIHRvIHF1ZXJ5IEVEU1xuICAgICAgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUNvdXJzZXNMaXN0KFxuICAgIGVkc0FjdGl2ZUNvdXJzZXM6IEVEU0NvdXJzZVtdIHwgbnVsbCxcbiAgICB1c2VySGlkZGVuQ291cnNlczogVXNlckhpZGRlbkNvdXJzZVtdLFxuICAgIGFjdGl2ZUNvdXJzZXM6IFBhcnRpYWw8Q291cnNlPltdKSA6IFByb21pc2U8Q291cnNlV2l0aEhpZGRlblN0YXRlW10+XG4gIHtcbiAgICBjb25zdCBoaWRkZW5Db3Vyc2VzTWFwID0gYXJyYXlUb01hcCh1c2VySGlkZGVuQ291cnNlcy5maWx0ZXIoaGMgPT4gIWhjLnNob3cpLCBoYyA9PiBoYy5uYW1lKTtcbiAgICBjb25zdCB2aXNpYmxlQ291cnNlc01hcCA9IGFycmF5VG9NYXAodXNlckhpZGRlbkNvdXJzZXMuZmlsdGVyKGhjID0+IGhjLnNob3cpLCBoYyA9PiBoYy5uYW1lKTtcblxuICAgIGNvbnN0IGlzU3R1ZGVudCA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ1NUVURFTlQnKTtcblxuICAgIGNvbnN0IGVkc0NvdXJzZU1hcCA9IGVkc0FjdGl2ZUNvdXJzZXMgP1xuICAgICAgYXJyYXlUb01hcChlZHNBY3RpdmVDb3Vyc2VzLCBjID0+IGMubmFtZSkgOlxuICAgICAge307XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLmFsbChhY3RpdmVDb3Vyc2VzLm1hcChhc3luYyAoe2lkLCBuYW1lLCBkZXNjcmlwdGlvbiwgbW9kaWZpZWRCeX0pID0+IHtcblxuICAgICAgbGV0IGVkc0NvdXJzZSA9IGVkc0NvdXJzZU1hcFtuYW1lXTtcblxuICAgICAgbGV0IGRlZmF1bHRWaXNpYmxlID0gaXNTdHVkZW50ID9cbiAgICAgICAgZWRzQ291cnNlICE9IG51bGwgOiAvLyBDb3Vyc2UgbmFtZSBhbHNvIGxpc3RlZCBpbiBFRFNcbiAgICAgICAgdHJ1ZTsgLy8gVGVhY2hlcnMgbm90IGRlcGVuZGVudCBvbiBFRFMgbGlzdGluZ1xuXG4gICAgICBsZXQgdmlzaWJsZSA9IGRlZmF1bHRWaXNpYmxlID9cbiAgICAgICAgIWhpZGRlbkNvdXJzZXNNYXBbaWRdIDogLy8gVmlzaWJsZSB1bmxlc3MgdXNlciBoYXMgb3ZlcnJpZGRlbiB0aGF0LlxuICAgICAgICAhIXZpc2libGVDb3Vyc2VzTWFwW2lkXTsgLy8gSGlkZGVuIHVubGVzcyB1c2VyIGhhcyBvdmVycmlkZGVuIHRoYXQuXG4gICAgICBcbiAgICAgIC8vIFJlc29sdmUgZGVzY3JpcHRpb246XG4gICAgICBpZiAobW9kaWZpZWRCeSAmJiBtb2RpZmllZEJ5Lm5hbWUgJiYgIWRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gYCR7bW9kaWZpZWRCeS5uYW1lfXMgdmVyc2lvbmA7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkLFxuICAgICAgICBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgdmlzaWJsZSxcbiAgICAgICAgZGVmYXVsdFZpc2libGVcbiAgICAgIH07XG4gICAgfSkpO1xuXG4gICAgcmV0dXJuIHJlc3VsdC5zb3J0KCh7bmFtZTogYX0sIHtuYW1lOiBifSkgPT4gYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDApO1xuICB9XG5cbiAgYXN5bmMgaGlkZUNvdXJzZShjOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUpIHtcbiAgICBjb25zdCBvdmVycmlkZXMgPSB0aGlzLmtlZFJlcG8ubWVtLml0ZW1zLmZpbHRlcihoYyA9PiBoYy5uYW1lID09PSBjLmlkKTtcbiAgICBpZiAoYy5kZWZhdWx0VmlzaWJsZSkge1xuICAgICAgYXdhaXQgdGhpcy5rZWRSZXBvLmluc2VydChbe1xuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICBuYW1lOiBjLmlkXG4gICAgICB9XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5kZWxldGUob3ZlcnJpZGVzLm1hcChvdiA9PiBvdi5pZCkpOyAgICAgIFxuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHNob3dDb3Vyc2UoYzogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XG4gICAgY29uc3Qgb3ZlcnJpZGVzID0gdGhpcy5rZWRSZXBvLm1lbS5pdGVtcy5maWx0ZXIoaGMgPT4gaGMubmFtZSA9PT0gYy5pZCk7XG4gICAgaWYgKGMuZGVmYXVsdFZpc2libGUpIHtcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5kZWxldGUob3ZlcnJpZGVzLm1hcChvdiA9PiBvdi5pZCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCB0aGlzLmtlZFJlcG8uaW5zZXJ0KFt7XG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIG5hbWU6IGMuaWQsXG4gICAgICAgIHNob3c6IHRydWVcbiAgICAgIH1dKTtcbiAgICB9XG4gIH1cblxuICBub3RpZnlTdWJzY3JpYmVyID0gKHN1YnNjcmliZXI6IEhpZGRlbkNvdXJzZXNTdWJzY3JpYmVyLCBvcHRpb25zOiBTdWJzY3JpYmVyT3B0aW9ucykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzdWJzY3JpYmVyKG9wdGlvbnMuZnVsbENvdXJzZSA/IHRoaXMucmVzdWx0IDogdGhpcy5yZXN1bHQuZmlsdGVyKGMgPT4gYy52aXNpYmxlKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3Vic2NyaWJlIChzdWJzY3JpYmVyOiBIaWRkZW5Db3Vyc2VzU3Vic2NyaWJlciwgb3B0aW9uczogU3Vic2NyaWJlck9wdGlvbnMpIHtcbiAgICBpZiAoIXRoaXMuZnVsbENvdXJzZSAmJiBvcHRpb25zLmZ1bGxDb3Vyc2UpIHtcbiAgICAgIC8vIFRoZSBzdWJzY3JpYmVyIGRlbWFuZHMgZnVsbCBjb3Vyc2VzXG4gICAgICAvLyBOZWVkIHRvIHF1ZXJ5IHRoYXQgYmVmb3JlIG5vdGlmeWluZ1xuICAgICAgLy8gQWxzbyBhZmZlY3Qgc3RhdGUgZm9yIGZ1dHVyZSBpbnRlcm5hbCBub3RpZmljYXRpb25cbiAgICAgIHRoaXMuZnVsbENvdXJzZSA9IG9wdGlvbnMuZnVsbENvdXJzZTtcbiAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UgPSB0aGlzLmxpc3RLZWRDb3Vyc2VzKCk7IC8vIFJlZG8gdGhpcyBjYWxsLCBub3cgbG9hZGluZyBmdWxsIGNvdXJzZXNcbiAgICAgIC8vIFdhaXQgZm9yIGFsbCBvdXRzdGFuZGluZyBmZXRjaCgpIGNhbGxzIHRvIGNvbXBsZXRlOlxuICAgICAgY29uc3QgW2FjdGl2ZUNvdXJzZXMsIGVkc0FjdGl2ZUNvdXJzZXMsIHVzZXJIaWRkZW5Db3Vyc2VzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSwgXG4gICAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2UsXG4gICAgICAgIHRoaXMudXNlckhpZGRlbkNvdXJzZXNQcm9taXNlXSk7XG4gICAgICAvLyBBc3NlbWJsZSByZXN1bHQ6XG4gICAgICB0aGlzLnJlc3VsdCA9IGF3YWl0IHRoaXMuY3JlYXRlQ291cnNlc0xpc3QoZWRzQWN0aXZlQ291cnNlcywgdXNlckhpZGRlbkNvdXJzZXMsIGFjdGl2ZUNvdXJzZXMpO1xuICAgIH1cbiAgICBhd2FpdCB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTsgLy8gU28gd2Uga25vdyB0aGF0IHRoaXMucmVzdWx0IGlzIHRoZXJlLlxuICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcihzdWJzY3JpYmVyLCBvcHRpb25zKTtcbiAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goe3N1YnNjcmliZXIsIG9wdGlvbnN9KTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlIChzdWJzY3JpYmVyOiBIaWRkZW5Db3Vyc2VzU3Vic2NyaWJlcikge1xuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlcihzID0+IHMuc3Vic2NyaWJlciAhPT0gc3Vic2NyaWJlcik7XG4gIH1cbn1cblxuaWYgKCFoaWRkZW5Db3Vyc2VzUmVwbykge1xuICBoaWRkZW5Db3Vyc2VzUmVwbyA9IGVudi5oaWRkZW5Db3Vyc2VzUmVwbyA9IG5ldyBIaWRkZW5Db3Vyc2VzUmVwbygpO1xufVxuIiwiaW1wb3J0IHsgUmVwbywgUmVwb0NvbW11bmljYXRvcn0gZnJvbSAnLi9yZXBvJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIExpc3RPcHRpb25zLCBCYXRjaFJ1bm5lciwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IERvY3VtZW50fSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2VkUmVwb09wdGlvbnM8VCBleHRlbmRzIERvY3VtZW50PiB7XG4gIGdldENsaWVudDogKCk9PktlZEJhY2tlbmRDbGllbnQ7XG4gIGdldFF1ZXJ5T3B0aW9uczogKCk9PlByb21pc2U8TGlzdE9wdGlvbnM+O1xuICBvcHRpbWlzdGljOiBib29sZWFuO1xuICB0YWJsZTogc3RyaW5nO1xuICB1c2VyOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBLZWRSZXBvPFQgZXh0ZW5kcyBEb2N1bWVudD4ge1xuICBtZW06IFJlcG88VD47XG4gIG9wdGlvbnM6IEtlZFJlcG9PcHRpb25zPFQ+O1xuICBcbiAgY29uc3RydWN0b3Iob3B0aW9uczogS2VkUmVwb09wdGlvbnM8VD4pIHtcbiAgICBjb25zdCB7dGFibGUsIGdldENsaWVudCwgZ2V0UXVlcnlPcHRpb25zfSA9IG9wdGlvbnM7XG4gICAgdGhpcy5tZW0gPSBuZXcgUmVwbzxUPih7cXVlcnk6IGFzeW5jICgpPT57XG4gICAgICBjb25zdCBxdWVyeU9wdGlvbnMgPSBhd2FpdCBnZXRRdWVyeU9wdGlvbnMoKTtcbiAgICAgIHJldHVybiBhd2FpdCBnZXRDbGllbnQoKS5saXN0PFQ+KHRhYmxlLCB7XG4gICAgICAgIC4uLnF1ZXJ5T3B0aW9ucyxcbiAgICAgICAgY2FjaGVCdXN0OiB0aGlzLmdldENhY2hlQnVzdCgpfSk7XG4gICAgfX0pO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGdldENhY2hlQnVzdCgpIHtcbiAgICBjb25zdCB7dGFibGUsIHVzZXJ9ID0gdGhpcy5vcHRpb25zO1xuICAgIGNvbnN0IGNhY2hlQnVzdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWNoZS1idXN0LScgKyB0YWJsZSArICctJyArIHVzZXIpO1xuICAgIHJldHVybiBjYWNoZUJ1c3QgfHwgdGhpcy5yZWdlbmVyYXRlQ2FjaGVCdXN0KCk7XG4gIH1cblxuICBwcml2YXRlIHJlZ2VuZXJhdGVDYWNoZUJ1c3QoKSB7XG4gICAgY29uc3Qge3RhYmxlLCB1c2VyfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjYWNoZUJ1c3QgPSBjcmVhdGVVVUlEKCk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhY2hlLWJ1c3QtJyArIHRhYmxlICsgJy0nICsgdXNlciwgY2FjaGVCdXN0KTtcbiAgICByZXR1cm4gY2FjaGVCdXN0O1xuICB9XG5cbiAgYXN5bmMgdXBzZXJ0KGl0ZW06IFQsIHVwZGF0ZXI6IChpdGVtOiBUKSA9PiB2b2lkKSB7XG4gICAgaWYgKCFpdGVtLiRldGFnKSB7XG4gICAgICAvLyBJdGVtcyB3aXRob3V0ICRldGFnIGNhbm5vdCBiZSByZXRyaWV2ZWQgZnJvbSBzZXJ2ZXIsIHNvIGl0IHNob3VsZCBiZSBpbnNlcnRlZC5cbiAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSk7XG4gICAgICB1cGRhdGVyKHVwZGF0ZWRJdGVtKTtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmluc2VydChbdXBkYXRlZEl0ZW1dKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gV2UgaGF2ZSBhbiAkZXRhZywgc28gd2UgY2FuIGV4cGVjdCBpdCB0byBsaXZlIG9uIHRoZSBzZXJ2ZXIuXG4gICAgICAvLyBIb3dldmVyLCB0YWtlIGNhcmUgb2YgdGhlIHVubGlrZWx5IHNpdHVhdGlvbiB0aGF0IGl0IHdhcyBkZWxldGVkIGZyb20gc2VydmVyLFxuICAgICAgLy8gYW5kIGlmIHNvLCBpbnNlcnQgaXQgYWdhaW4uXG4gICAgICBhd2FpdCB0aGlzLnVwZGF0ZShbaXRlbV0sIHVwZGF0ZXIpLmNhdGNoKGUgPT4ge1xuICAgICAgICBpZiAoZS5uYW1lID09PSBcImh0dHA0MDRcIikge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgaXRlbSk7XG4gICAgICAgICAgdXBkYXRlcih1cGRhdGVkSXRlbSk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuaW5zZXJ0KFt1cGRhdGVkSXRlbV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZShpdGVtczogVFtdLCB1cGRhdGVyOiAoaXRlbTogVCkgPT4gdm9pZCkge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBjb25zdCBtb2RpZmllZEl0ZW1zOiBUW10gPSBpdGVtcy5tYXAoaXRlbSA9PiB7XG4gICAgICBjb25zdCBtZW1SZXBvSXRlbSA9IHRoaXMubWVtLml0ZW1zLmZpbmQoaXQgPT4gaXQuaWQgPT09IGl0ZW0uaWQpO1xuICAgICAgaXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIG1lbVJlcG9JdGVtIHx8IGl0ZW0pO1xuICAgICAgdXBkYXRlcihpdGVtKTtcbiAgICAgIHJldHVybiBpdGVtO1xuICAgIH0pO1xuICAgIGlmIChvcHRpbWlzdGljKSBhd2FpdCB0aGlzLm1lbS51cGRhdGUobW9kaWZpZWRJdGVtcy5tYXAoeCA9PiBPYmplY3QuYXNzaWduKHt9LCB4LCB7JG1ldGE6ICd1cGRhdGluZyd9KSkpO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNsaWVudC5kbyAoYnIgPT4gbW9kaWZpZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gYnIucHV0KHRhYmxlLCBpdGVtKSkpXG4gICAgLmNhdGNoKGUgPT4gZS5uYW1lID09PSBcImh0dHA0MDlcIiA/IC8vIGNvbmZsaWN0XG4gICAgICAvLyBHZXQgYSBmcmVzaCB2ZXJzaW9uIGZyb20gc2VydmVyOlxuICAgICAgY2xpZW50Lmxpc3Q8VD4odGFibGUsIHtpZHM6IGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uaWQpfSwge2NhY2hlOiAnbm8tY2FjaGUnfSkudGhlbihmcmVzaEl0ZW1zID0+IHtcbiAgICAgICAgLy8gVXBkYXRlIGxvY2FsIHZlcnNpb246XG4gICAgICAgIGNvbnN0IG1vZGlmaWVkSXRlbXMgPSBmcmVzaEl0ZW1zLm1hcChmcmVzaEl0ZW0gPT4ge1xuICAgICAgICAgIC8vIENsb25lIHRoZSBmcmVzaCBpdGVtXG4gICAgICAgICAgY29uc3QgbW9kaWZpZWQgPSBPYmplY3QuYXNzaWduKHt9LCBmcmVzaEl0ZW0pO1xuICAgICAgICAgIC8vIFJlLXJ1biB0aGUgdXBkYXRlciBvbiB0aGUgY2xvbmU6XG4gICAgICAgICAgdXBkYXRlcihtb2RpZmllZCk7XG4gICAgICAgICAgcmV0dXJuIG1vZGlmaWVkO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gUmUtZG8gdGhlIHRoZSBwdXQgb3BlcmF0aW9uIHRvd2FyZHMgdGhlIHNlcnZlci5cbiAgICAgICAgcmV0dXJuIGNsaWVudC5kbyhiciA9PiBtb2RpZmllZEl0ZW1zLmZvckVhY2goaXRlbSA9PiBici5wdXQodGFibGUsIGl0ZW0pKSk7XG4gICAgICB9KSA6XG4gICAgICAvLyBPdGhlciB1bmV4cGVjdGVkIGVycm9yOlxuICAgICAgUHJvbWlzZS5yZXNvbHZlKG9wdGltaXN0aWMgJiZcbiAgICAgICAgdGhpcy5tZW0udXBkYXRlKGl0ZW1zKSkgLy8gVW5kbyBvcHRpbWlzdGljIHVwZGF0ZVxuICAgICAgLnRoZW4oKCk9PntcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpOyAvLyBSZWplY3Qgd2l0aCB0aGUgZXJyb3Igbm8gbWF0dGVyLlxuICAgICAgfSkpO1xuICAgIHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xuICAgIG1vZGlmaWVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgIGl0ZW0uJGV0YWcgPSByZXMubmV3RXRhZ3NbaXRlbS5pZF07XG4gICAgICBpdGVtLiRtZXRhID0gdW5kZWZpbmVkO1xuICAgIH0pO1xuICAgIGF3YWl0IHRoaXMubWVtLnVwZGF0ZShtb2RpZmllZEl0ZW1zKTsgLy8gRW5zdXJlcyBuZXcgZXRhZyBpcyBpcyBhcHBsaWVkIG9uIG5leHQgYWN0aW9uLlxuICB9XG5cbiAgc3RyaXBHcmFwaHMgKGl0ZW1zOiBUW10sIGdyYXBoczogc3RyaW5nW10pIHtcbiAgICByZXR1cm4gaXRlbXMubWFwKGl0ZW0gPT4ge1xuICAgICAgY29uc3QgY2xvbmUgPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKTtcbiAgICAgIGdyYXBocy5mb3JFYWNoKGdyYXBoID0+IHtcbiAgICAgICAgaWYgKGl0ZW1bZ3JhcGhdKSB7XG4gICAgICAgICAgY2xvbmVbZ3JhcGhdID0gKGl0ZW1bZ3JhcGhdIGFzIHtpZDpzdHJpbmd9W10pLm1hcCAoZG9jID0+ICh7aWQ6IGRvYy5pZH0pKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gY2xvbmU7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBpbnNlcnQoaXRlbXM6IFRbXSkge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlLCBnZXRRdWVyeU9wdGlvbnN9ID0gdGhpcy5vcHRpb25zO1xuICAgIGNvbnN0IGNsaWVudCA9IGdldENsaWVudCgpO1xuICAgIGNvbnN0IHF1ZXJ5T3B0aW9ucyA9IGF3YWl0IGdldFF1ZXJ5T3B0aW9ucygpO1xuICAgIGNvbnN0IGdyYXBocyA9IFtdLmNvbmNhdChxdWVyeU9wdGlvbnMuaW5jbHVkZSk7XG4gICAgLy8gR2l2ZSBJRHMgdG8gZWFjaCBpdGVtOlxuICAgIGl0ZW1zID0gaXRlbXMubWFwKGl0ZW0gPT4gaXRlbS5pZCA/IGl0ZW0gOiBPYmplY3QuYXNzaWduKHt9LCBpdGVtLCB7aWQ6IGNyZWF0ZVVVSUQoKX0pKTtcbiAgICBjb25zdCBzdHJpcHBlZCA9IHRoaXMuc3RyaXBHcmFwaHMoaXRlbXMsIGdyYXBocyk7XG4gICAgaWYgKG9wdGltaXN0aWMpIGF3YWl0IHRoaXMubWVtLmluc2VydChzdHJpcHBlZC5tYXAoeCA9PiBPYmplY3QuYXNzaWduKHt9LCB4LCB7JG1ldGE6ICdhZGRpbmcnfSkpKTtcbiAgICBjb25zdCBiciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBzdHJpcHBlZCkge1xuICAgICAgLy8gQWxzbyBhZGQgbGlua3MgdG8gYWxsIGZvcmVpZ24gcmVsYXRlZCBpdGVtczpcbiAgICAgIGZvciAoY29uc3QgZ3JhcGggb2YgZ3JhcGhzKSB7XG4gICAgICAgIGNvbnN0IGZvcmVpZ25JdGVtczogRG9jdW1lbnRbXSA9IGl0ZW1bZ3JhcGhdO1xuICAgICAgICBpZiAoZm9yZWlnbkl0ZW1zKSB7XG4gICAgICAgICAgZm9yZWlnbkl0ZW1zLmZvckVhY2goZG9jID0+IHtcbiAgICAgICAgICAgIGJyLmxpbmsyKHRhYmxlLCBpdGVtLmlkLCBncmFwaCwgZG9jLmlkKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYnIuYWRkKHRhYmxlLCBpdGVtKTtcbiAgICB9XG4gICAgY29uc3QgcmVzID0gYXdhaXQgY2xpZW50LmJhdGNoKGJyLm11dGF0aW9uUmVxdWVzdHMpLmNhdGNoKGUgPT4ge1xuICAgICAgaWYgKG9wdGltaXN0aWMpIHRoaXMubWVtLmRlbGV0ZShpdGVtcy5tYXAoaXRlbSA9PiBpdGVtLmlkKSk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgfSlcbiAgICB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcbiAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4gaXRlbS4kZXRhZyA9IHJlcy5uZXdFdGFnc1tpdGVtLmlkXSk7XG4gICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUoaXRlbXMpOyAvLyBVcGRhdGUgd2l0aCBuZXcgJGV0YWcuXG4gICAgZWxzZVxuICAgICAgYXdhaXQgdGhpcy5tZW0uaW5zZXJ0KGl0ZW1zKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZSAoaWRzOiBzdHJpbmdbXSkge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKGlkc1xuICAgICAgLm1hcChpZCA9PiB0aGlzLm1lbS5pdGVtcy5maW5kKHggPT4geC5pZCA9PT0gaWQpKVxuICAgICAgLmZpbHRlcih4ID0+IHgpXG4gICAgICAubWFwKHggPT4gT2JqZWN0LmFzc2lnbih7fSwgeCwgeyRtZXRhOiAnZGVsZXRpbmcnfSkpKTtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjbGllbnQuZG8gKGJyID0+IGlkcy5mb3JFYWNoKGlkID0+IGJyLmRlbGV0ZSh0YWJsZSwgaWQpKSkuY2F0Y2goYXN5bmMgZSA9PiB7XG4gICAgICBpZiAob3B0aW1pc3RpYykge1xuICAgICAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUoaWRzXG4gICAgICAgICAgLm1hcChpZCA9PiB0aGlzLm1lbS5pdGVtcy5maW5kKHggPT4geC5pZCA9PT0gaWQpKVxuICAgICAgICAgIC5maWx0ZXIoeCA9PiB4KVxuICAgICAgICAgIC5tYXAoeCA9PiB7XG4gICAgICAgICAgICB4ID0gT2JqZWN0LmFzc2lnbih7fSwgeCk7XG4gICAgICAgICAgICBkZWxldGUgeC4kbWV0YTtcbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGU7XG4gICAgfSk7XG4gICAgdGhpcy5yZWdlbmVyYXRlQ2FjaGVCdXN0KCk7XG4gICAgYXdhaXQgdGhpcy5tZW0uZGVsZXRlKGlkcyk7XG4gIH1cbn1cbiIsImltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi9rZWQtcmVwbyc7XG5pbXBvcnQgeyBLR1Rlcm1QbGFubmVyV2Vla1BsYW5PclR1dG9yTm90ZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IGdldFRlcm1TdGFyRW5kRGF0ZSB9IGZyb20gJy4uL3V0aWxzL3NjaG9vbC1tb21lbnQnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5cbmV4cG9ydCBjbGFzcyBLR1Rlcm1QbGFubmVyUmVwbyBleHRlbmRzIEtlZFJlcG88S0dUZXJtUGxhbm5lcldlZWtQbGFuT3JUdXRvck5vdGU+IHtcbiAgY29uc3RydWN0b3IoZ2V0Q2xpZW50OiAoKT0+S2VkQmFja2VuZENsaWVudCwgZ2V0Q3VycmVudFVzZXI6ICgpPT5Vc2VyKSB7XG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgW3Rlcm1TdGFydCwgdGVybUVuZF0gPSBnZXRUZXJtU3RhckVuZERhdGUobm93LCBub3cuZ2V0TW9udGgoKSA+PSA3KTtcbiAgICBzdXBlcih7XG4gICAgICBnZXRDbGllbnQsXG4gICAgICBvcHRpbWlzdGljOiB0cnVlLFxuICAgICAgdGFibGU6IFwid2Vla3BsYW5zXCIsXG4gICAgICB1c2VyOiBjdXJyZW50VXNlciA/IGN1cnJlbnRVc2VyLm1haWwgOiBcIlwiLFxuICAgICAgZ2V0UXVlcnlPcHRpb25zOiBhc3luYyAoKT0+e1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZyb206IHRlcm1TdGFydC5zdGFydE9mKCd3ZWVrJykuYWRkKC0yLCAnZGF5cycpLnRvRGF0ZSgpLnZhbHVlT2YoKSxcbiAgICAgICAgICB0bzogdGVybUVuZC5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJykudG9EYXRlKCkudmFsdWVPZigpLFxuICAgICAgICAgIHJvbGU6IFwiVVNFUlwiXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgdGVybVBsYW5uZXJSZXBvID0gbmV3IEtHVGVybVBsYW5uZXJSZXBvKCgpPT5lbnYua2VkQmFja2VuZENsaWVudCwoKT0+ZW52LmN1cnJlbnRVc2VyKTtcbmVudi5rZ1Rlcm1QbGFubmVyUmVwbyA9IHRlcm1QbGFubmVyUmVwbztcbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEtTVGVybVBsYW5uZXJSZXBvIH0gZnJvbSAnLi9rcy10ZXJtcGxhbm5lci1yZXBvJztcblxuZXhwb3J0IGNvbnN0IHRlcm1QbGFubmVyUmVwb0tTID0gbmV3IEtTVGVybVBsYW5uZXJSZXBvKCgpPT5lbnYua2VkQmFja2VuZENsaWVudCwgKCk9PmVudi5jdXJyZW50VXNlcik7XG5lbnYua3NUZXJtUGxhbm5lclJlcG8gPSB0ZXJtUGxhbm5lclJlcG9LUztcbiIsImltcG9ydCB7IEtlZFJlcG8gfSBmcm9tICcuL2tlZC1yZXBvJztcbmltcG9ydCB7IEtTVGVybVBsYW5uZXJXZWVrUGxhbiwgVGVybVBsYW5uZXJUdXRvck5vdGUsIFRlcm1wbGFubmVyV2Vla09yVHV0b3IgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50IH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcblxuXG5leHBvcnQgY2xhc3MgS1NUZXJtUGxhbm5lclJlcG8gZXh0ZW5kcyBLZWRSZXBvPFRlcm1wbGFubmVyV2Vla09yVHV0b3I+IHtcbiAgc3RhcnREYXRlOiBtb21lbnQuTW9tZW50O1xuICBlbmREYXRlOiBtb21lbnQuTW9tZW50O1xuXG4gICBhc3luYyByZWZyZXNoRGF0YShkYXRlSW50ZXJ2YWwgOiBtb21lbnQuTW9tZW50W10pe1xuICAgIFt0aGlzLnN0YXJ0RGF0ZSwgdGhpcy5lbmREYXRlXSAgPSBkYXRlSW50ZXJ2YWw7XG4gICAgIGF3YWl0IHRoaXMubWVtLnJlZnJlc2hGcm9tU2VydmVyKCk7XG4gICB9XG5cbiAgY29uc3RydWN0b3IoZ2V0Q2xpZW50OiAoKT0+S2VkQmFja2VuZENsaWVudCwgZ2V0Q3VycmVudFVzZXI6ICgpPT5Vc2VyKSB7XG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xuICAgIHN1cGVyKHtcbiAgICAgIGdldENsaWVudCxcbiAgICAgIG9wdGltaXN0aWM6IHRydWUsXG4gICAgICB0YWJsZTogXCJ3ZWVrcGxhbnMta3NcIixcbiAgICAgIHVzZXI6IGN1cnJlbnRVc2VyID8gY3VycmVudFVzZXIubWFpbCA6IFwiXCIsXG4gICAgICBnZXRRdWVyeU9wdGlvbnM6IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhcnREYXRlVmFsdWUgPSAodGhpcy5zdGFydERhdGUgJiYgdGhpcy5zdGFydERhdGUudmFsdWVPZigpKSB8fCBtb21lbnQoKS52YWx1ZU9mKCk7XG4gICAgICAgIGNvbnN0IGVuZERhdGVWYWx1ZSA9ICh0aGlzLmVuZERhdGUgJiYgdGhpcy5lbmREYXRlLnZhbHVlT2YoKSkgfHwgbW9tZW50KCkudmFsdWVPZigpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZyb206IHN0YXJ0RGF0ZVZhbHVlLFxuICAgICAgICAgIHRvOiBlbmREYXRlVmFsdWUsXG4gICAgICAgICAgcm9sZTogXCJVU0VSXCJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJcblxuZXhwb3J0IGludGVyZmFjZSBSZXBvQ29tbXVuaWNhdG9yPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcbiAgcXVlcnkoKTogUHJvbWlzZTxUW10+O1xufVxuXG50eXBlIFN1YnNjcmliZXI8VD4gPSAoaXRlbXM6VFtdLCBlcnJvcjogdW5kZWZpbmVkIHwgRXJyb3IpID0+IGFueTtcblxuZXhwb3J0IGNsYXNzIFJlcG88VCBleHRlbmRzIHtpZDogc3RyaW5nfT4ge1xuICBsaXN0UHJvbWlzZTogUHJvbWlzZTx2b2lkPjtcbiAgaXRlbXM6IFRbXTtcbiAgZXJyb3I/OiBFcnJvcjtcbiAgc3Vic2NyaWJlcnM6IFN1YnNjcmliZXI8VD5bXTtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgY29tbTogUmVwb0NvbW11bmljYXRvcjxUPikge1xuICAgIHRoaXMubGlzdFByb21pc2UgPSBudWxsO1xuICAgIHRoaXMuaXRlbXMgPSBudWxsO1xuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcbiAgfVxuXG4gIHN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcbiAgICAgIHN1YnNjcmliZXIodGhpcy5pdGVtcywgdGhpcy5lcnJvcik7XG4gICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XG4gICAgfSk7XG4gIH1cblxuICB1bnN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycyA9IHRoaXMuc3Vic2NyaWJlcnMuZmlsdGVyIChzID0+IHMgIT09IHN1YnNjcmliZXIpO1xuICB9XG5cbiAgbm90aWZ5U3Vic2NyaWJlcnMoKSB7XG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHMgPT4gcyh0aGlzLml0ZW1zLCB0aGlzLmVycm9yKSk7XG4gIH1cblxuICBlbnN1cmVIYXNEYXRhKCkge1xuICAgIGlmICghdGhpcy5saXN0UHJvbWlzZSkgdGhpcy5yZWZyZXNoRnJvbVNlcnZlcigpO1xuICAgIHJldHVybiB0aGlzLmxpc3RQcm9taXNlO1xuICB9XG5cbiAgcmVmcmVzaEZyb21TZXJ2ZXIoKSB7XG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IHRoaXMuY29tbS5xdWVyeSgpLnRoZW4oaXRlbXMgPT4ge1xuICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMgfHwgW107XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMubGlzdFByb21pc2U7XG4gIH1cbiAgXG4gIGFzeW5jIHVwZGF0ZShpdGVtOiBUIHwgVFtdKSB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVIYXNEYXRhKCk7XG4gICAgY29uc3QgdXBkYXRlZEl0ZW1zID0gQXJyYXkuaXNBcnJheShpdGVtKSA/IGl0ZW0gOiBbaXRlbV07XG4gICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMubWFwKGl0ID0+IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtID0gdXBkYXRlZEl0ZW1zLmZpbmQoKHtpZH0pID0+IGl0LmlkID09PSBpZCk7XG4gICAgICByZXR1cm4gdXBkYXRlZEl0ZW0gP1xuICAgICAgICBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkSXRlbSkgOlxuICAgICAgICBpdDtcbiAgICB9KTtcbiAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gIH1cblxuICBpbnNlcnQoaXRlbTogVCB8IFRbXSkge1xuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XG4gICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcy5jb25jYXQoaXRlbSk7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gIH1cblxuICBkZWxldGUoaWQ6IHN0cmluZyB8IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgaWRzID0gQXJyYXkuaXNBcnJheShpZCkgPyBpZCA6IFtpZF07XG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLmZpbHRlcihpdCA9PiAhaWRzLnNvbWUoaWQgPT4gaXQuaWQgPT09IGlkKSk7XG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi9rZWQtcmVwbyc7XG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlXCI7XG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcywgS2VkQmFja2VuZENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IGdldEFkanVzdGVkV2VlaywgS0VEV2VlayB9IGZyb20gJy4uL3V0aWxzL3dlZWt1dGlsJztcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5cbmV4cG9ydCBsZXQgdXNlclRhc2tzUmVwbyA9IGVudi51c2VyVGFza3NSZXBvIGFzIFVzZXJUYXNrc1JlcG87XG5cbmV4cG9ydCBjbGFzcyBVc2VyVGFza3NSZXBvIGV4dGVuZHMgS2VkUmVwbzxVc2VyVGFzaz4ge1xuICBwZXJzaXN0ZWRTdGF0ZTogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB8IG51bGw7XG4gIGdldEN1cnJlbnRVc2VyOiAoKT0+VXNlcjtcblxuICBjb25zdHJ1Y3RvcihnZXRDbGllbnQ6ICgpPT5LZWRCYWNrZW5kQ2xpZW50LCBnZXRDdXJyZW50VXNlcjogKCk9PlVzZXIpIHsgICAgXG4gICAgc3VwZXIoe1xuICAgICAgZ2V0Q2xpZW50LFxuICAgICAgb3B0aW1pc3RpYzogdHJ1ZSxcbiAgICAgIHRhYmxlOiBcInVzZXJ0YXNrc1wiLFxuICAgICAgdXNlcjogZ2V0Q3VycmVudFVzZXIoKSA/IGdldEN1cnJlbnRVc2VyKCkubWFpbCA6IFwiXCIsXG4gICAgICBnZXRRdWVyeU9wdGlvbnM6IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xuICAgICAgICBjb25zdCB1c2VyRW1haWwgPSBjdXJyZW50VXNlciA/IGN1cnJlbnRVc2VyLm1haWwgOiBcIlwiO1xuICAgICAgICBpZiAoIXRoaXMucGVyc2lzdGVkU3RhdGUpXG4gICAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh1c2VyRW1haWwpO1xuICAgICAgICBjb25zdCB7IHdlZWtEYXRlIH0gPSB0aGlzLnBlcnNpc3RlZFN0YXRlO1xuICAgICAgICBjb25zdCB3ZWVrTnVtYmVyID0gbW9tZW50KHdlZWtEYXRlKS53ZWVrKCk7XG4gICAgICAgIGNvbnN0IGtlZFdlZWsgPSBLRURXZWVrKG1vbWVudCh3ZWVrRGF0ZSkueWVhcigpLCB3ZWVrTnVtYmVyKTtcbiAgICAgICAgLypjb25zdCBbZnJvbSwgdG9dID0gW21vbWVudCh3ZWVrRGF0ZSkuc3RhcnRPZignd2VlaycpLCBtb21lbnQod2Vla0RhdGUpLmVuZE9mKCd3ZWVrJyldXG4gICAgICAgICAgLm1hcChtID0+IG0udG9EYXRlKCkuZ2V0VGltZSgpKTsqL1xuICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZnJvbToga2VkV2Vlay5ub3RCZWZvcmUsXG4gICAgICAgICAgICB0bzoga2VkV2Vlay5ub3RBZnRlcixcbiAgICAgICAgICAgIHJvbGU6IFwiVVNFUlwiLFxuICAgICAgICAgICAgaW5jbHVkZTogW1widGFza1wiLCBcImNvdXJzZVwiXSxcbiAgICAgICAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IG51bGw7XG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9IGdldEN1cnJlbnRVc2VyO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlUGVyc2lzdGVkU3RhdGUoc3RhdGVDaGFuZ2VzOiBQYXJ0aWFsPFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGU+KSB7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLnBlcnNpc3RlZFN0YXRlLCBzdGF0ZUNoYW5nZXMpO1xuICAgIGF3YWl0IHRoaXMucGVyc2lzdGVkU3RhdGUuc2F2ZSgpO1xuICAgIHRoaXMubWVtLm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gIH1cblxuICBhc3luYyBzZXRUYXNrRG9uZVN0YXRlKHVzZXJUYXNrOiBVc2VyVGFzaywgZG9uZTogYm9vbGVhbikge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBjb25zdCBtb2RpZmllZEl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCB1c2VyVGFzaywge2RvbmV9KTtcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVkSXRlbSwgeyRtZXRhOiAndXBkYXRpbmcnfSkpO1xuICAgIC8vIE5vdyBtYWtlIHN1cmUgdG8gY2hhbmdlIHRoZSBzdGF0ZSBmb3Igb3RoZXIgd2Vla3MgYXMgd2VsbDpcbiAgICBjb25zdCBzaW1pbGFyVGFza3MgPSBhd2FpdCBjbGllbnQubGlzdDxVc2VyVGFzaz4oJ3VzZXJ0YXNrcycsIHtcbiAgICAgIG5hbWU6IHVzZXJUYXNrLm5hbWUsXG4gICAgICByb2xlOiBcIlVTRVJcIixcbiAgICAgIGluY2x1ZGU6IFtcInRhc2tcIixcImNvdXJzZVwiXSxcbiAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXSxcbiAgICAgIGZyb206IG1vbWVudCh0aGlzLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlKS5hZGQoLTMsICd3ZWVrcycpLnZhbHVlT2YoKSxcbiAgICAgIHRvOiBtb21lbnQodGhpcy5wZXJzaXN0ZWRTdGF0ZS53ZWVrRGF0ZSkuYWRkKDMsICd3ZWVrcycpLnZhbHVlT2YoKVxuICAgIH0sIHtcbiAgICAgIGNhY2hlOiAnbm8tY2FjaGUnXG4gICAgfSk7XG4gICAgY29uc3QgaWRlbnRpY2FsVGFza3MgPSBzaW1pbGFyVGFza3MuZmlsdGVyKHQgPT5cbiAgICAgIHQuY291cnNlTmFtZSA9PT0gdXNlclRhc2suY291cnNlTmFtZSAmJlxuICAgICAgdC5sZWFybmluZ0dvYWwgPT09IHVzZXJUYXNrLmxlYXJuaW5nR29hbCAmJlxuICAgICAgKCF1c2VyVGFzay50YXNrIHx8IHQudGFzay5tYXAodD0+dC5pZCkuam9pbignJykgPT09IHVzZXJUYXNrLnRhc2subWFwKHQ9PnQuaWQpLmpvaW4oJycpKSAmJlxuICAgICAgKCF1c2VyVGFzay5jb3Vyc2UgfHwgdC5jb3Vyc2UubWFwKGM9PmMuaWQpLmpvaW4oJycpID09PSB1c2VyVGFzay5jb3Vyc2UubWFwKGM9PmMuaWQpLmpvaW4oJycpKSk7XG4gICAgaWYgKGlkZW50aWNhbFRhc2tzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgaXNzdWUgaW4gU3ViamVjdFBsYW5uZXIgbWlncmF0aW9uICh1c2VydGFza3Mgd2l0aCBsb25nIG5hbWVzIGlzIG5vdCBmb3VuZClcbiAgICAgIGlkZW50aWNhbFRhc2tzLnB1c2godXNlclRhc2spXG4gICAgfVxuICAgIGF3YWl0IHRoaXMudXBkYXRlKGlkZW50aWNhbFRhc2tzLCB0ID0+IHQuZG9uZSA9IGRvbmUpO1xuICB9XG5cbiAgYXN5bmMgc2V0U3ViVGFza0RvbmVTdGF0ZSAodXNlclRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrSWQ6IHN0cmluZywgZG9uZTogYm9vbGVhbikge1xuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZShbdXNlclRhc2tdLFxuICAgICAgdCA9PiB0LnN1YlRhc2tzICYmIHQuc3ViVGFza3MuZmlsdGVyKHN0ID0+IHN0LmlkID09PSBzdWJUYXNrSWQpXG4gICAgICAgIC5mb3JFYWNoKHN0ID0+IHN0LmRvbmUgPSBkb25lKSk7XG4gIH1cblxuICBhc3luYyBzZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZTogc3RyaW5nLCBpc09wZW46IGJvb2xlYW4pIHtcbiAgICBjb25zdCBvcGVuQ291cnNlcyA9IHsgLi4udGhpcy5wZXJzaXN0ZWRTdGF0ZS5vcGVuQ291cnNlcyB9O1xuICAgIGlmIChpc09wZW4pXG4gICAgICBvcGVuQ291cnNlc1tjb3Vyc2VOYW1lXSA9IHRydWU7XG4gICAgZWxzZVxuICAgICAgZGVsZXRlIG9wZW5Db3Vyc2VzW2NvdXJzZU5hbWVdO1xuICAgIGF3YWl0IHRoaXMudXBkYXRlUGVyc2lzdGVkU3RhdGUoe29wZW5Db3Vyc2VzfSk7XG4gIH1cblxuICBhc3luYyBjaGFuZ2VXZWVrKHdlZWtEYXRlOiBEYXRlLCBrZWVwQ3VycmVudERhdGU/OiBib29sZWFuKSB7XG4gICAgbGV0IHBlcnNpc3RlZFN0YXRlID0gdGhpcy5wZXJzaXN0ZWRTdGF0ZTtcbiAgICBpZiAoIXBlcnNpc3RlZFN0YXRlKSB7XG4gICAgICBwZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh0aGlzLm9wdGlvbnMudXNlcik7XG4gICAgfVxuICAgIGNvbnN0IG5ld1BlcnNpc3RlZCA9IG5ldyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKHBlcnNpc3RlZFN0YXRlKTtcbiAgICBuZXdQZXJzaXN0ZWQud2Vla0RhdGUgPSBrZWVwQ3VycmVudERhdGUgPyBtb21lbnQod2Vla0RhdGUpLnZhbHVlT2YoKSA6IG1vbWVudCh3ZWVrRGF0ZSkuc3RhcnRPZignd2VlaycpLnZhbHVlT2YoKTtcbiAgICBuZXdQZXJzaXN0ZWQuc2F2ZSgpO1xuICAgIHRoaXMucGVyc2lzdGVkU3RhdGUgPSBuZXdQZXJzaXN0ZWQ7XG4gICAgYXdhaXQgdGhpcy5tZW0ucmVmcmVzaEZyb21TZXJ2ZXIoKTtcbiAgfVxuXG4gIHN1YnNjcmliZShzdWJzY3JpYmVyOiAodXNlclRhc2tzOiBVc2VyVGFza1tdLCBwZXJzaXN0ZWRTdGF0ZTogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSwgd2Vla1RleHRzVVQ6IFVzZXJUYXNrKSA9PiB2b2lkKSB7XG4gICAgY29uc3QgcHJveHlTdWJzY3JpYmVyID0gKHVzZXJUYXNrczogVXNlclRhc2tbXSkgPT4ge1xuICAgICAgc3Vic2NyaWJlcihcbiAgICAgICAgdXNlclRhc2tzLmZpbHRlcih1dCA9PiAhdXQud2Vla1RleHRzKSxcbiAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSxcbiAgICAgICAgdXNlclRhc2tzLmZpbHRlcih1dCA9PiAhIXV0LndlZWtUZXh0cylbMF0gfHwge1xuICAgICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgICAgZGF0ZVRpbWU6IHRoaXMucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUsXG4gICAgICAgICAgd2Vla1RleHRzOiB7YXNzZXNzbWVudDonJywgc3RyYXRlZ3k6Jyd9LFxuICAgICAgICAgIGFjbDogW1xuICAgICAgICAgICAgLy8gRGVmYXVsdCBBQ0w6IExldCB1c2VyIHNlbGYgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGl0ZW06XG4gICAgICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJlbWFpbFwiLCB0aGlzLmdldEN1cnJlbnRVc2VyKCkubWFpbCwgXCJTXCIpLFxuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBBQ0w6IExldCBlbXBsb3llZXMgb24gc2FtZSBzY2hvb2wgaGF2ZSByZWFkIGFjY2VzcyB0byBpdC5cbiAgICAgICAgICAgIC8vIFRoaXMgY3VycmVudGx5IG9ubHkgYXBwbGllcyB0byB0YXNrcyB0aGF0IHJlZmVyIHRvIGNvdXJzZSB0YXNrcyAobm90IG93biB0YXNrcyEpXG4gICAgICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJzY2hvb2xSb2xlXCIsIGAke3RoaXMuZ2V0Q3VycmVudFVzZXIoKS5zY2hvb2x9L0VNUExPWUVFYCwgXCJSXCIpXG4gICAgICAgICAgXS5tYXAoYWMgPT4gYWMudG9TdHJpbmcoKSlcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBwcm94eVN1YnNjcmliZXJbXCJzdWJzY3JpYmVyXCJdID0gc3Vic2NyaWJlcjtcbiAgICB0aGlzLm1lbS5zdWJzY3JpYmUocHJveHlTdWJzY3JpYmVyKTtcbiAgfVxuXG4gIHVuc3Vic2NyaWJlKHN1YnNjcmliZXI6ICh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZFN0YXRlOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlLCB3ZWVrVGV4dHNVVDogVXNlclRhc2spID0+IHZvaWQpIHtcbiAgICB0aGlzLm1lbS5zdWJzY3JpYmVycyA9IHRoaXMubWVtLnN1YnNjcmliZXJzLmZpbHRlciAocyA9PiBzW1wic3Vic2NyaWJlclwiXSAhPT0gc3Vic2NyaWJlcik7XG4gIH1cbiAgXG59XG5cbmlmICghdXNlclRhc2tzUmVwbykge1xuICB1c2VyVGFza3NSZXBvID0gZW52LnVzZXJUYXNrc1JlcG8gPSBuZXcgVXNlclRhc2tzUmVwbyhcbiAgICAoKT0+ZW52LmtlZEJhY2tlbmRDbGllbnQsXG4gICAgKCk9PmVudi5jdXJyZW50VXNlcik7XG4gIHVzZXJUYXNrc1JlcG8ubWVtLmVuc3VyZUhhc0RhdGEoKTtcbn1cbiIsImltcG9ydCB7IEtlZFJlcG8gfSBmcm9tICcuL2tlZC1yZXBvJztcbmltcG9ydCB7IFdlZWtOb3RlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBnZXRBZGp1c3RlZFdlZWssIEtFRFdlZWsgfSBmcm9tICcuLi91dGlscy93ZWVrdXRpbCc7XG5cbmV4cG9ydCBsZXQgd2Vla05vdGVzUmVwbyA9IGVudi53ZWVrTm90ZXNSZXBvIGFzIFdlZWtOb3Rlc1JlcG87XG5cbmV4cG9ydCBjbGFzcyBXZWVrTm90ZXNSZXBvIGV4dGVuZHMgS2VkUmVwbzxXZWVrTm90ZT4ge1xuICAvKnByaXZhdGUgY3VycmVudFdlZWs6IG1vbWVudC5Nb21lbnQ7XG5cbiAgZ2V0Q3VycmVudFdlZWsoKSB7XG4gICAgaWYgKCF0aGlzLmN1cnJlbnRXZWVrKSB7XG4gICAgICBjb25zdCB7d2Vla01pbGxpcywgZXhwaXJlfSA9IEpTT04ucGFyc2Uoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcIndlZWstbm90ZXMtd2Vla1wiKSB8fCBcInt9XCIpIGFzIHt3ZWVrTWlsbGlzPzogbnVtYmVyLCBleHBpcmU/OiBudW1iZXJ9O1xuICAgICAgdGhpcy5jdXJyZW50V2VlayA9IHdlZWtNaWxsaXMgJiYgZXhwaXJlICYmIGV4cGlyZSA+IERhdGUubm93KCkgP1xuICAgICAgICBtb21lbnQobmV3IERhdGUod2Vla01pbGxpcykpIDpcbiAgICAgICAgbW9tZW50KCkuc3RhcnRPZignd2VlaycpLmFkZCgxLCAnZGF5cycpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5jdXJyZW50V2Vlay5jbG9uZSgpO1xuICB9XG5cbiAgc2V0Q3VycmVudFdlZWsobmV3V2Vla01vbWVudDogbW9tZW50Lk1vbWVudCkge1xuICAgIHRoaXMuY3VycmVudFdlZWsgPSBuZXdXZWVrTW9tZW50O1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ3ZWVrLW5vdGVzLXdlZWtcIiwgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgd2Vla01pbGxpczogbmV3V2Vla01vbWVudC50b0RhdGUoKS5nZXRUaW1lKCksXG4gICAgICBleHBpcmU6IG1vbWVudCgpLmFkZCg4LCBcImhvdXJzXCIpLnRvRGF0ZSgpLmdldFRpbWUoKVxuICAgIH0pKVxuICB9Ki9cbiAgXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKHtcbiAgICAgIGdldENsaWVudCgpIHsgcmV0dXJuIGVudi5rZWRCYWNrZW5kQ2xpZW50OyB9LFxuICAgICAgb3B0aW1pc3RpYzogZmFsc2UsXG4gICAgICB0YWJsZTogXCJub3Rlc1wiLCAvLyBcIndlZWstbm90ZXNcIlxuICAgICAgdXNlcjogZW52LmN1cnJlbnRVc2VyID8gZW52LmN1cnJlbnRVc2VyLm1haWwgOiBcIlwiLFxuICAgICAgZ2V0UXVlcnlPcHRpb25zOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIC8vY29uc3QgdXNlckVtYWlsID0gZW52LmN1cnJlbnRVc2VyID8gZW52LmN1cnJlbnRVc2VyLm1haWwgOiBcIlwiO1xuICAgICAgICAvL2NvbnN0IGN1cnJlbnRXZWVrID0gdGhpcy5nZXRDdXJyZW50V2VlaygpO1xuICAgICAgICAvL2NvbnN0IHdlZWtOdW1iZXIgPSBjdXJyZW50V2Vlay53ZWVrKCk7XG4gICAgICAgIC8vY29uc3Qga2VkV2VlayA9IEtFRFdlZWsoY3VycmVudFdlZWsueWVhcigpLCB3ZWVrTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAvL2Zyb206IGtlZFdlZWsubm90QmVmb3JlLFxuICAgICAgICAgIC8vdG86IGtlZFdlZWsubm90QWZ0ZXIsXG4gICAgICAgICAgcm9sZTogXCJVU0VSXCJcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAvL3RoaXMuY3VycmVudFdlZWsgPSBudWxsO1xuICB9XG5cbiAgLyphc3luYyBjaGFuZ2VXZWVrKHdlZWtzVG9BZGQ6IG51bWJlcikge1xuICAgIHRoaXMuc2V0Q3VycmVudFdlZWsodGhpcy5nZXRDdXJyZW50V2VlaygpLmFkZCh3ZWVrc1RvQWRkLCBcIndlZWtzXCIpKTtcbiAgICBhd2FpdCB0aGlzLm1lbS5yZWZyZXNoRnJvbVNlcnZlcigpO1xuICB9Ki9cbn1cblxuaWYgKCF3ZWVrTm90ZXNSZXBvKSB7XG4gIHdlZWtOb3Rlc1JlcG8gPSBlbnYud2Vla05vdGVzUmVwbyA9IG5ldyBXZWVrTm90ZXNSZXBvKCk7XG59XG4iLCJcbmV4cG9ydCBjb25zdCBTRUNPTkQgPSAxMDAwO1xuZXhwb3J0IGNvbnN0IE1JTlVURSA9IFNFQ09ORCAqIDYwO1xuZXhwb3J0IGNvbnN0IEhPVVIgPSBNSU5VVEUgKiA2MDtcblxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgQWNhZGVtaWNZZWFyU3RydWN0dXJlLCBUZXJtIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0IHsgTW9ja0VEU0FjYWRlbWljWWVhciB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgR2VuZXJpY1NjaG9vbE1vbWVudCwgZ2V0Q3VycmVudEFjYWRlbWljWWVhciB9IGZyb20gJy4vZ2VuZXJpYy1zY2hvb2wtdXRpbHMnO1xuaW1wb3J0IHsgSW5qZWN0ZWRJbnRsIH0gZnJvbSAncmVhY3QtaW50bCc7XG5pbXBvcnQgeyBMQVNUX1NURVBfU1BSSU5HLCBMQVNUX1NURVBfQVVUVU1OIH0gZnJvbSAnLi4vY29tcG9uZW50cy9rcy10ZXJtcGxhbm5lci90ZXJtcGxhbm5lci11dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBHZW5lcmljU2Nob29sVGVybSB7XG4gIHNjaG9vbE1vbWVudDogR2VuZXJpY1NjaG9vbE1vbWVudDtcbiAgc2VsZWN0ZWREYXRlOiBEYXRlO1xuICBsb2NhbGU6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihjdXJyZW50RGF0ZTogRGF0ZSwgY3VycmVudExvY2FsZT86IHN0cmluZywgYWNhZGVtaWNZZWFyU3RydWN0dXJlPzogTW9ja0VEU0FjYWRlbWljWWVhcikge1xuICAgIHRoaXMubG9jYWxlID0gY3VycmVudExvY2FsZSB8fCBcInN2XCI7XG4gICAgdGhpcy5zZWxlY3RlZERhdGUgPSBjdXJyZW50RGF0ZTtcbiAgICB0aGlzLnNjaG9vbE1vbWVudCA9IGFjYWRlbWljWWVhclN0cnVjdHVyZSA/IGdldEN1cnJlbnRBY2FkZW1pY1llYXIobW9tZW50KGN1cnJlbnREYXRlKSwgYWNhZGVtaWNZZWFyU3RydWN0dXJlKSA6IG51bGw7XG4gIH1cblxuICBnZXRUZXJtU3RhcnRBbmRFbmQoaW5jbHVkZUV4dHJhV2Vlaz86IGJvb2xlYW4pOiBtb21lbnQuTW9tZW50W10ge1xuICAgIC8vSW4gY2FzZSB0aGF0IHRoZSB3ZWVrIHN0YXJ0IGRhdGUgaXMgYSBkYXRlIGZyb20gdGhlIHByZXZpb3VzIHllYXJcbiAgICAvL0NvbnNpZGVyIHRoZSBzdGFydCBvZiB0aGUgd2VlayAoIHN0YXJ0IGRhdGUpIGFzIHRoZSBkYXkgb2YgdGhlIDAxLjAxLnllYXJcbiAgICB2YXIgc3RhcnRPZlRlcm1XZWVrID0gdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLnN0YXJ0RGF0ZS5jbG9uZSgpLnN0YXJ0T2YoJ3dlZWsnKTtcblxuICAgIGlmIChzdGFydE9mVGVybVdlZWsueWVhcigpIDwgdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLnN0YXJ0RGF0ZS55ZWFyKCkpIHtcbiAgICAgIHN0YXJ0T2ZUZXJtV2VlayA9IHRoaXMuc2Nob29sTW9tZW50LmFjYWRlbWljWWVhclN0cnVjdHVyZS5zdGFydERhdGU7XG4gICAgfVxuXG4gICAgdmFyIGVuZE9mVGVybVdlZWsgPSB0aGlzLnNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXJTdHJ1Y3R1cmUuZW5kRGF0ZTtcblxuICAgIGlmKHRoaXMubG9jYWxlID09PSBcInN2XCIgJiYgaW5jbHVkZUV4dHJhV2VlayAmJiB0aGlzLnNjaG9vbE1vbWVudC50ZXJtID09PSBcIlNUXCIpe1xuICAgICAgZW5kT2ZUZXJtV2VlayA9IGVuZE9mVGVybVdlZWsuY2xvbmUoKS5hZGQoMywgJ3dlZWtzJykuZW5kT2YoJ3dlZWsnKTtcbiAgICB9XG4gICAgZWxzZSBpZihpbmNsdWRlRXh0cmFXZWVrKXtcbiAgICAgIGlmKHRoaXMubG9jYWxlICE9IFwic3ZcIil7XG4gICAgICAgIC8vIGZvciBpbmRpYSB0aGUgZW5kIGRhdGUgY2FuIGJlIGluIHRoZSBtaWRkbGUgb2YgdGhlIHdlZWtcbiAgICAgICAgZW5kT2ZUZXJtV2Vlaz0gdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmVuZERhdGUuY2xvbmUoKTtcbiAgICAgIH1cbiAgICAgIGVuZE9mVGVybVdlZWsgPSAgdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmVuZERhdGUuY2xvbmUoKS5hZGQoMSwgJ3dlZWsnKS5lbmRPZignd2VlaycpO1xuICAgIH1cblxuICAgIHJldHVybiBbc3RhcnRPZlRlcm1XZWVrLCBlbmRPZlRlcm1XZWVrXTtcbiAgfVxuXG4gIGdldEZpcnN0QW5kTGFzdFdlZWtPZlRlcm0oKSB7XG4gICAgcmV0dXJuIFt0aGlzLnNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXJTdHJ1Y3R1cmUuc3RhcnREYXRlLndlZWsoKSwgdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmVuZERhdGUud2VlaygpXTtcbiAgfVxuXG4gIGlzQ3VycmVudFdlZWsoZGF0ZVRpbWU6IG51bWJlcikgOiBib29sZWFuIHtcbiAgICB2YXIgdGVybURhdGUgPSBtb21lbnQoZGF0ZVRpbWUpXG4gICAgcmV0dXJuIHRlcm1EYXRlLnllYXIoKSA9PT0gbW9tZW50KCkueWVhcigpICYmIHRlcm1EYXRlLndlZWsoKSA9PT0gbW9tZW50KCkud2VlaygpO1xuICB9XG5cbiAgZ2V0TGFzdFN0ZXBXZWVrKGxvY2FsZTogc3RyaW5nKSB7XG4gICAgLy9UT0RPOiB0aGlzIHNob3VsZCBiZSByZWZhY3RvcmVkLiBUaGUgZ2VuZXJpYyBtZXRob2Qgc2hvdWxkIGJlIHVzZWRcbiAgICBpZihsb2NhbGUgPT09IFwic3ZcIil7XG4gICAgICByZXR1cm4gdGhpcy5zY2hvb2xNb21lbnQudGVybSA9PT0gXCJTVFwiID8gTEFTVF9TVEVQX1NQUklORyA6IExBU1RfU1RFUF9BVVRVTU47XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXJTdHJ1Y3R1cmUuZW5kRGF0ZS5jbG9uZSgpLmFkZCgxLCBcIndlZWtcIikud2VlaygpO1xuICB9XG5cbiAgdG9Mb2NhbGVTdHJpbmcoaW50bDogSW5qZWN0ZWRJbnRsLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XG4gICAgaWYodGhpcy5zY2hvb2xNb21lbnQpXG4gICAge1xuICAgIGxldCB5ZWFyID0gdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmVuZERhdGUueWVhcigpLnRvU3RyaW5nKCk7XG4gICAgbGV0IGFjYWRlbWljWWVhciA9IHRoaXMuc2Nob29sTW9tZW50LmFjYWRlbWljWWVhclN0cnVjdHVyZS5hY2FkZW1pY1llYXI7XG4gICAgaWYgKHNob3J0WWVhciAmJiBpbnRsLmxvY2FsZSA9PT0gJ3N2Jykge1xuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB5ZWFyID0gYWNhZGVtaWNZZWFyO1xuICAgIH1cblxuXG4gICAgcmV0dXJuIHRoaXMuc2Nob29sTW9tZW50LnRlcm0gPT09ICdBVCcgPyBpbnRsLmZvcm1hdE1lc3NhZ2UoeyBpZDogJ3Rlcm1wbGFubmVyLmZpcnN0VGVybScsIGRlZmF1bHRNZXNzYWdlOiAnSFQge3llYXJ9JyB9LCB7IHllYXI6IHllYXIgfSkgOlxuICAgICAgaW50bC5mb3JtYXRNZXNzYWdlKHsgaWQ6ICd0ZXJtcGxhbm5lci5zZWNvbmRUZXJtJywgZGVmYXVsdE1lc3NhZ2U6ICdWVCB7eWVhcn0nIH0sIHsgeWVhcjogeWVhciB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBuZXh0VGVybSgpIHtcbiAgICAvL3N3aXRjaCB0byBuZXh0IHNlbWVzdGVyLCB3ZSBzZXQgdGhlIGN1cnJlbnQgZGF0ZSBhcyBhZGRpbmcgMyBtb250aHMgdG8gdGhlIGVuZCBvZiB0aGUgY3VycmVudCBzZW1lc3RlclxuICAgIHZhciBlbmREYXRlID0gdGhpcy5zY2hvb2xNb21lbnQgPyB0aGlzLnNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXJTdHJ1Y3R1cmUuZW5kRGF0ZS5jbG9uZSgpIDogbW9tZW50KCk7XG4gICAgdmFyIG5leHREYXRlID0gZW5kRGF0ZS5hZGQoMywgJ21vbnRocycpO1xuICAgIHJldHVybiBuZXcgR2VuZXJpY1NjaG9vbFRlcm0obmV4dERhdGUudG9EYXRlKCksIHRoaXMubG9jYWxlKTtcbiAgfVxuXG4gIHByZXZUZXJtKCkge1xuICAgIC8vdG8gc3dpdGNoIHRvIG5leHQgc2VtZXN0ZXIsIHdlIHNldCB0aGUgY3VycmVudCBkYXRlIGFzIHN1YnRyYWN0aW5nIDMgbW9udGhzIGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBjdXJyZW50IHNlbWVzdGVyXG4gICAgdmFyIHN0YXJ0RGF0ZSA9IHRoaXMuc2Nob29sTW9tZW50ID8gIHRoaXMuc2Nob29sTW9tZW50LmFjYWRlbWljWWVhclN0cnVjdHVyZS5zdGFydERhdGUuY2xvbmUoKSA6IG1vbWVudCgpO1xuICAgIHZhciBwcmV2RGF0ZSA9IHN0YXJ0RGF0ZS5zdWJ0cmFjdCgzLCAnbW9udGhzJyk7XG4gICAgcmV0dXJuIG5ldyBHZW5lcmljU2Nob29sVGVybShwcmV2RGF0ZS50b0RhdGUoKSwgdGhpcy5sb2NhbGUpO1xuICB9XG5cbiAgZ2V0RWRzUGVyaW9kTmFtZSgpe1xuICAgIHJldHVybiB0aGlzLnNjaG9vbE1vbWVudC50ZXJtID09PSAnQVQnID8gXCJIVFwiIDogXCJWVFwiICsgdGhpcy5zY2hvb2xNb21lbnQuYWNhZGVtaWNZZWFyU3RydWN0dXJlLmVuZERhdGUueWVhcigpO1xuICB9XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQge01vY2tFRFNBY2FkZW1pY1llYXIsIE1vY2tFRFNEYXRlUmFuZ2V9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHtBY2FkZW1pY1llYXJTdHJ1Y3R1cmUsICBUZXJtIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0IHsgSW5qZWN0ZWRJbnRsIH0gZnJvbSAncmVhY3QtaW50bCc7ICBcblxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmljU2Nob29sTW9tZW50IHtcbiAgICBhY2FkZW1pY1llYXJTdHJ1Y3R1cmU6IEFjYWRlbWljWWVhclN0cnVjdHVyZTtcbiAgICB0ZXJtOiBUZXJtO1xuICB9XG4gIFxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRBY2FkZW1pY1llYXIoY3VycmVudERhdGU6IG1vbWVudC5Nb21lbnQsIGFjYWRlbWljWWVhcjogTW9ja0VEU0FjYWRlbWljWWVhcikgOiBHZW5lcmljU2Nob29sTW9tZW50XG57XG4gIHZhciBmaXJzdFRlcm1TdGFydERhdGUgPSBtb21lbnQobmV3IERhdGUoYWNhZGVtaWNZZWFyLmZpcnN0VGVybS5zdGFydERhdGUpKTtcbiAgdmFyIGZpcnN0VGVybUVuZERhdGUgPSBtb21lbnQobmV3IERhdGUoYWNhZGVtaWNZZWFyLmZpcnN0VGVybS5lbmREYXRlKSk7XG4gIHZhciBzZWNvbmRUZXJtU3RhcnREYXRlID0gbW9tZW50KG5ldyBEYXRlKGFjYWRlbWljWWVhci5zZWNvbmRUZXJtLnN0YXJ0RGF0ZSkpO1xuICB2YXIgc2Vjb25kVGVybUVuZERhdGUgPSBtb21lbnQobmV3IERhdGUoYWNhZGVtaWNZZWFyLnNlY29uZFRlcm0uZW5kRGF0ZSkpO1xuICB2YXIgYWNhZGVtaWNQZXJpb2QgPSBmaXJzdFRlcm1TdGFydERhdGUueWVhcigpLnRvU3RyaW5nKCkuc3Vic3RyKDIpICsgXCIvXCIgKyBzZWNvbmRUZXJtRW5kRGF0ZS55ZWFyKCkudG9TdHJpbmcoKS5zdWJzdHIoMik7XG5cbiAgdmFyIGhvbGlkYXlzID0gX2dldFRlcm1Ib2xpZGF5cyhhY2FkZW1pY1llYXIuaG9saWRheXMsIGZpcnN0VGVybVN0YXJ0RGF0ZSwgZmlyc3RUZXJtRW5kRGF0ZSk7IFxuICBpZihjdXJyZW50RGF0ZSA8IGZpcnN0VGVybUVuZERhdGUpXG4gIHtcbiAgICAvL2NvbXB1dGUgYWNhZGVtaWMgd2VlayBudW1iZXJzXG4gICAgdmFyIGFjYWRlbWljU3RhcnRXZWVrID0gMTtcbiAgICB2YXIgYWNhZGVtaWNFbmRXZWVrID0gZmlyc3RUZXJtRW5kRGF0ZS53ZWVrKCkgLSBmaXJzdFRlcm1TdGFydERhdGUud2VlaygpO1xuICAgIC8vZ2V0IGN1cnJlbnQgdGVybSBob2xpZGF5c1xuICAgIHJldHVybiB7dGVybTogJ0FUJywgYWNhZGVtaWNZZWFyU3RydWN0dXJlOiB7YWNhZGVtaWNZZWFyOiBhY2FkZW1pY1BlcmlvZCwgc3RhcnREYXRlOiBmaXJzdFRlcm1TdGFydERhdGUsIGVuZERhdGU6IGZpcnN0VGVybUVuZERhdGUsYWNhZGVtaWNTdGFydFdlZWssIGFjYWRlbWljRW5kV2VlaywgaG9saWRheXN9fTtcbiAgfVxuXG4gIC8vY29tcHV0ZSB0aGUgbnVtYmVyIG9mIGZpcnN0IHRlcm0gaG9saWRheXMgd2VlayBudW1iZXJzXG4gIHZhciBudW1iZXJPZkhvbGlkYXlXZWVrcyA9IF9nZXRIb2xpZGF5V2Vla3NOdW1iZXIoaG9saWRheXMpO1xuICAvL2NvbXB1dGUgYWNhZGVtaWMgd2VlayBudW1iZXJzXG4gIHZhciBhY2FkZW1pY1N0YXJ0V2VlayA9IHNlY29uZFRlcm1TdGFydERhdGUuY2xvbmUoKS5hZGQoMSwgJ3dlZWsnKS53ZWVrKCkgLSBmaXJzdFRlcm1TdGFydERhdGUud2VlaygpIC0gbnVtYmVyT2ZIb2xpZGF5V2Vla3M7XG4gIHZhciBhY2FkZW1pY0VuZFdlZWsgPSBzZWNvbmRUZXJtRW5kRGF0ZS5jbG9uZSgpLmFkZCgpLmFkZCgxLCAnd2VlaycpLndlZWsoKSAtIGZpcnN0VGVybVN0YXJ0RGF0ZS53ZWVrKCkgLSBudW1iZXJPZkhvbGlkYXlXZWVrcztcbiAgLy9nZXQgY3VycmVudCB0ZXJtIGhvbGlkYXlzXG4gIHZhciBob2xpZGF5cyA9IF9nZXRUZXJtSG9saWRheXMoYWNhZGVtaWNZZWFyLmhvbGlkYXlzLCBzZWNvbmRUZXJtU3RhcnREYXRlLCBzZWNvbmRUZXJtRW5kRGF0ZSk7XG4gIHJldHVybiB7dGVybTogJ1NUJywgYWNhZGVtaWNZZWFyU3RydWN0dXJlOiB7YWNhZGVtaWNZZWFyOiBhY2FkZW1pY1BlcmlvZCwgc3RhcnREYXRlOiBzZWNvbmRUZXJtU3RhcnREYXRlLCBlbmREYXRlOiBzZWNvbmRUZXJtRW5kRGF0ZSwgYWNhZGVtaWNTdGFydFdlZWssIGFjYWRlbWljRW5kV2VlaywgaG9saWRheXN9fTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2Nob29sVHJhbnNsYXRlZFN1YmplY3RzKHNjaG9vbExvY2FsZTogc3RyaW5nLCBpbnRsOiBJbmplY3RlZEludGwpe1xuICB2YXIgdHJhbnNsYXRlZENvbHVtbnMgPSB7fTtcbiAgLy90aGVzZSBhcmUgZml4ZWQgZm9yIGFsbCBzY2hvb2wgbG9jYWxlc1xuICB0cmFuc2xhdGVkQ29sdW1uc1tcIkt1cnNcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLmNvdXJzZVwiLCBkZWZhdWx0TWVzc2FnZTogXCJLdXJzXCJ9KTtcbiAgdHJhbnNsYXRlZENvbHVtbnNbXCJLb21tZW50YXJcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLmNvbW1lbnRzXCIsIGRlZmF1bHRNZXNzYWdlOiBcIktvbW1lbnRhclwifSk7XG5cbiAgaWYoc2Nob29sTG9jYWxlID09PSAnc3YnKXtcbiAgICB0cmFuc2xhdGVkQ29sdW1uc1tcIk0uc3ByXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5tb2Rlcm5MYW5ndWFnZVwiLCBkZWZhdWx0TWVzc2FnZTogXCJNLnNwclwifSk7XG4gICAgdHJhbnNsYXRlZENvbHVtbnNbXCJNYVwiXSA9IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6IFwidGVybXBsYW5uZXIubWF0aHNcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiTWFcIn0pO1xuICAgIHRyYW5zbGF0ZWRDb2x1bW5zW1wiU3YvU3ZBXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5zd2VkaXNoTGFuZ3VhZ2VcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiU3YvU3ZBXCJ9KTtcbiAgICB0cmFuc2xhdGVkQ29sdW1uc1tcIkVuZ1wiXSA9IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6IFwidGVybXBsYW5uZXIuZW5nbGlzaExhbmd1YWdlXCIsIGRlZmF1bHRNZXNzYWdlOiBcIkVuZ1wifSk7XG4gIH1cbiAgZWxzZSB7XG4gICAgdHJhbnNsYXRlZENvbHVtbnNbXCJNRkxcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLm1vZGVybkxhbmd1YWdlXCIsIGRlZmF1bHRNZXNzYWdlOiBcIk1GTFwifSk7XG4gICAgdHJhbnNsYXRlZENvbHVtbnNbXCJNYVwiXSA9IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6IFwidGVybXBsYW5uZXIubWF0aHNcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiTWF0aHNcIn0pO1xuICAgIHRyYW5zbGF0ZWRDb2x1bW5zW1wiSGlcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLmhpbmRpTGFuZ3VhZ2VcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiSGluZGlcIn0pO1xuICAgIHRyYW5zbGF0ZWRDb2x1bW5zW1wiRW5nXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5lbmdsaXNoTGFuZ3VhZ2VcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiRW5nbGlzaFwifSk7XG4gICAgdHJhbnNsYXRlZENvbHVtbnNbXCJZb2dhXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci55b2dhXCIsIGRlZmF1bHRNZXNzYWdlOiBcIllvZ2FcIn0pO1xuICAgIHRyYW5zbGF0ZWRDb2x1bW5zW1wiSUNUXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5pY3RcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiSUNUXCJ9KTtcbiAgfVxuICByZXR1cm4gdHJhbnNsYXRlZENvbHVtbnM7XG59XG5cbi8vdGhpcyBpcyByZWxhdGVkIHRvIGNoYXJ0cy4gSXQgaXMgdXNlZCBvbmx5IGZvciBzdiBsb2NhbGVcbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xUcmFuc2xhdGVkU3ViamVjdEZ1bGxuYW1lKGludGw6IEluamVjdGVkSW50bCl7XG4gIHZhciB0cmFuc2xhdGVkQ29sdW1ucyA9IHt9O1xuXG4gIHRyYW5zbGF0ZWRDb2x1bW5zW1wiTS5zcHJcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLm1vZGVybkxhbmd1YWdlRnVsbG5hbWVcIiwgZGVmYXVsdE1lc3NhZ2U6IFwiTS5zcHLDpWtcIn0pO1xuICB0cmFuc2xhdGVkQ29sdW1uc1tcIk1hXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5tYXRoc0Z1bGxuYW1lXCIsIGRlZmF1bHRNZXNzYWdlOiBcIk1hdGVtYXRpa1wifSk7XG4gIHRyYW5zbGF0ZWRDb2x1bW5zW1wiU3YvU3ZBXCJdID0gaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogXCJ0ZXJtcGxhbm5lci5zd2VkaXNoTGFuZ3VhZ2VGdWxsTmFtZVwiLCBkZWZhdWx0TWVzc2FnZTogXCJTdmVuc2thXCJ9KTtcbiAgdHJhbnNsYXRlZENvbHVtbnNbXCJFbmdcIl0gPSBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiBcInRlcm1wbGFubmVyLmVuZ2xpc2hMYW5ndWFnZUZ1bGxOYW1lXCIsIGRlZmF1bHRNZXNzYWdlOiBcIkVuZ2Vsc2thXCJ9KTtcblxuICByZXR1cm4gdHJhbnNsYXRlZENvbHVtbnM7XG59XG5cbmZ1bmN0aW9uIF9nZXRUZXJtSG9saWRheXMoaG9saWRheXM6IE1vY2tFRFNEYXRlUmFuZ2VbXSwgdGVybVN0YXJ0RGF0ZTogbW9tZW50Lk1vbWVudCwgdGVybUVuZERhdGU6IG1vbWVudC5Nb21lbnQpe1xuICByZXR1cm4gaG9saWRheXMuZmlsdGVyKGVsZW0gPT4ge1xuICAgIHJldHVybiBtb21lbnQoZWxlbS5zdGFydERhdGUpLmlzQmV0d2Vlbih0ZXJtU3RhcnREYXRlLCB0ZXJtRW5kRGF0ZSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBfZ2V0SG9saWRheVdlZWtzTnVtYmVyKGhvbGlkYXlzOk1vY2tFRFNEYXRlUmFuZ2VbXSl7XG4gIHZhciBudW1iZXJPZldlZWtzID0gMDtcbiAgaG9saWRheXMuZm9yRWFjaChlbGVtID0+IHtcbiAgICAvL3RoZSBudW1iZXIgb2Ygd2Vla3MgaXMgdGhlIGRpZmZlcmVuY2UgKyAxXG4gICAgbnVtYmVyT2ZXZWVrcys9IG1vbWVudChlbGVtLmVuZERhdGUpLmFkZCgxLCAnd2VlaycpLndlZWsoKSAtIG1vbWVudChlbGVtLnN0YXJ0RGF0ZSkud2VlaygpO1xuICB9KTtcbiAgcmV0dXJuIG51bWJlck9mV2Vla3M7XG59IiwiXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaWZUYWtlc1RpbWUobXM6IG51bWJlciwgdGFzazogKCk9PlByb21pc2U8YW55PiwgYWN0aW9uOiAoKT0+YW55KSB7XG4gIGxldCB0aW1lb3V0UmVhY2hlZCA9IGZhbHNlO1xuICBjb25zdCB0aCA9IHNldFRpbWVvdXQoKCk9PntcbiAgICB0aW1lb3V0UmVhY2hlZCA9IHRydWU7XG4gICAgYWN0aW9uKCk7XG4gIH0sIG1zKTtcbiAgY29uc3QgcnYgPSBhd2FpdCB0YXNrKCk7XG4gIGlmICghdGltZW91dFJlYWNoZWQpIGNsZWFyVGltZW91dCh0aCk7XG4gIHJldHVybiBydjtcbn1cbiIsImNvbnN0IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTiA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzLlxuXG50eXBlIFByb21pc2VSZXR1cm5pbmdNZXRob2ROYW1lczxBUEk+ID0ge1xuICBbTUVUSE9EIGluIGtleW9mIEFQSV06IEFQSVtNRVRIT0RdIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBQcm9taXNlPGFueT4gPyBNRVRIT0QgOiBuZXZlclxufVxuXG50eXBlIENvbnZlcnRNZXRob2RUb1N1c3BlbnNlPEY+ID0gRiBleHRlbmRzICguLi5hcmdzOiBpbmZlciBBKSA9PiBQcm9taXNlPGluZmVyIFI+ID9cbiAgKC4uLmFyZ3M6IEEpID0+IFIgOlxuICBGO1xuXG5leHBvcnQgdHlwZSBTdXNwZW5zZUJhc2VkQVBJPEFQST4gPSB7XG4gIFtNRVRIT0QgaW4ga2V5b2YgUHJvbWlzZVJldHVybmluZ01ldGhvZE5hbWVzPEFQST5dOiBDb252ZXJ0TWV0aG9kVG9TdXNwZW5zZTxBUElbTUVUSE9EXT5cbn1cblxudHlwZSBPcHRpb25zID0ge1xuICBpc0FwaU1ldGhvZD86IChwcm9wOiBzdHJpbmcpPT5ib29sZWFuLFxuICBjYWNoZUV4cGlyYXRpb24/OiBudW1iZXJcbn1cblxuY29uc3QgZGVmYXVsdE9wdGlvbnM6IE9wdGlvbnMgPSB7XG4gIGlzQXBpTWV0aG9kOiBmID0+IHR5cGVvZiBmID09PSAnZnVuY3Rpb24nLFxuICBjYWNoZUV4cGlyYXRpb246IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTlxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VTdXNwZW5zZUFwaTxBUEk+KGFwaTogQVBJLCBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnMpOiBTdXNwZW5zZUJhc2VkQVBJPEFQST5cbntcbiAgb3B0aW9ucyA9IHsuLi5kZWZhdWx0T3B0aW9ucywgLi4ub3B0aW9uc307XG4gIGNvbnN0IHtpc0FwaU1ldGhvZCwgY2FjaGVFeHBpcmF0aW9ufSA9IG9wdGlvbnM7XG5cbiAgY29uc3QgcnY6IFN1c3BlbnNlQmFzZWRBUEk8QVBJPiA9IE9iamVjdC5jcmVhdGUoYXBpIGFzIGFueSkgYXMgU3VzcGVuc2VCYXNlZEFQSTxBUEk+O1xuICBjb25zdCBjYWNoZToge1trZXk6IHN0cmluZ106IHt0aW1lb3V0OiBudW1iZXIsIHZhbHVlPzogYW55LCBlcnJvcj86IGFueSwgcHJvbWlzZT86IFByb21pc2U8YW55Pn19ID0ge307XG5cbiAgLy8gV2FsayB0aGUgaW5zdGFuY2UgKyBwcm90b3R5cGUgY2hhaW4gdG8gZ2VuZXJhdGUgc3VzcGVuc2UgdmVyc2lvbiBvZiBlYWNoIHByb21pc2UgcmV0dXJuaW5nIG1ldGhvZFxuICBmb3IgKGxldCBwcm90byA9IGFwaTsgcHJvdG8gJiYgcHJvdG8gIT09IE9iamVjdC5wcm90b3R5cGU7IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSkge1xuICAgIHN1c3BlbmRpZnkocHJvdG8pO1xuICB9XG5cbiAgZnVuY3Rpb24gc3VzcGVuZGlmeShwcm90bykge1xuICAgIE9iamVjdC5rZXlzKHByb3RvKS5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgaWYgKCFydi5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiBpc0FwaU1ldGhvZChwcm9wKSkge1xuICAgICAgICBydltwcm9wXSA9IGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gSlNPTi5zdHJpbmdpZnkoW3Byb3AsIC4uLmFyZ3NdKTtcbiAgICAgICAgICBjb25zdCBjYWNoZWRFbnRyeSA9IGNhY2hlW2tleV07XG4gICAgICAgICAgaWYgKGNhY2hlZEVudHJ5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGlmIChjYWNoZWRFbnRyeS5wcm9taXNlKSB0aHJvdyBjYWNoZWRFbnRyeS5wcm9taXNlO1xuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LmVycm9yKSB0aHJvdyBjYWNoZWRFbnRyeS5lcnJvcjtcbiAgICAgICAgICAgIGlmIChjYWNoZWRFbnRyeS50aW1lb3V0ID4gRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkRW50cnkudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm9taXNlID0gcHJvdG9bcHJvcF0uYXBwbHkoYXBpLCBhcmdzKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgdmFsdWU6IHJlc3VsdH07XG4gICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgZXJyb3J9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjYWNoZVtrZXldID0ge3RpbWVvdXQ6IERhdGUubm93KCkgKyBjYWNoZUV4cGlyYXRpb24sIHByb21pc2V9O1xuICAgICAgICAgICAgdGhyb3cgcHJvbWlzZTtcbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yLnRoZW4pIHRocm93IGVycm9yO1xuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBlcnJvcn07XG4gICAgICAgICAgfVxuICAgICAgICB9IGFzIGFueTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBydjtcbn1cbiIsIlxuZXhwb3J0IGNsYXNzIFBlbmRpbmdKb2Ige1xuICBwcml2YXRlIHRpbWVvdXRJZCA9IG51bGw7XG4gIHByaXZhdGUgY2FuY2VsbGVkID0gZmFsc2U7XG4gIHByaXZhdGUgcGVuZGluZyA9IGZhbHNlO1xuICBwcml2YXRlIGlzSm9iRXhlY3V0aW5nID0gZmFsc2U7XG4gIHByaXZhdGUgam9iQ2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT47XG4gIFxuICBjb25zdHJ1Y3RvcihjYWxsYmFjazogKCk9PlByb21pc2U8YW55Pikge1xuICAgIHRoaXMuam9iQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIHRyaWdnZXJDaGFuZ2UodGhyb3R0bGU6IG51bWJlcik6IGFueSB7XG4gICAgaWYgKHRoaXMuY2FuY2VsbGVkKSByZXR1cm47XG4gICAgdGhpcy5wZW5kaW5nID0gdHJ1ZTtcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgIHRoaXMudGltZW91dElkID0gc2V0VGltZW91dCgoKT0+dGhpcy5sYXVuY2hKb2IoKSwgdGhyb3R0bGUpO1xuICB9XG5cbiAgc3RvcCgpIHtcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgIHRoaXMudGltZW91dElkID0gbnVsbDtcbiAgICB0aGlzLmNhbmNlbGxlZCA9IHRydWU7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGxhdW5jaEpvYigpIHtcbiAgICBpZiAodGhpcy5jYW5jZWxsZWQpIHJldHVybjtcbiAgICBpZiAoIXRoaXMucGVuZGluZykgcmV0dXJuO1xuICAgIGlmICh0aGlzLmlzSm9iRXhlY3V0aW5nKSByZXR1cm47XG4gICAgdGhpcy50aW1lb3V0SWQgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgICAgYXdhaXQgdGhpcy5qb2JDYWxsYmFjaygpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGlmICh0aGlzLnBlbmRpbmcpXG4gICAgICBhd2FpdCB0aGlzLmxhdW5jaEpvYigpO1xuICB9XG59XG4iLCJleHBvcnQgaW50ZXJmYWNlIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zIHtcbiAgdG9Mb3dlcj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uU2VhcmNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucyk6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0ge1xuICBjb25zdCB7dG9Mb3dlcn0gPSAob3B0aW9ucyB8fMKge30pIGFzIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zO1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgaWYgKGxvY2F0aW9uU2VhcmNoICYmIGxvY2F0aW9uU2VhcmNoLmxlbmd0aCA+IDEpXG4gICAgbG9jYXRpb25TZWFyY2guc3Vic3RyKDEpXG4gICAgICAuc3BsaXQoJyYnKVxuICAgICAgLm1hcChwYXJ0ID0+IHBhcnQuc3BsaXQoJz0nKS5tYXAocyA9PiBkZWNvZGVVUklDb21wb25lbnQocy50cmltKCkpKSlcbiAgICAgIC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHJlc3VsdFt0b0xvd2VyID8ga2V5LnRvTG93ZXJDYXNlKCkgOiBrZXldID0gdmFsdWUpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBlbmNvZGVQYXJhbXMocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhwYXJhbXMpLmZpbHRlcihrZXkgPT4gcGFyYW1zW2tleV0gIT09IHVuZGVmaW5lZCkubWFwKGtleSA9PiBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQocGFyYW1zW2tleV0pfWApLmpvaW4oJyYnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlUXVlcnlTdHJpbmcocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBcIj9cIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VIYXNoUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucykge1xuICByZXR1cm4gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbkhhc2gsIG9wdGlvbnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVIYXNoUXVlcnlTdHJpbmcocGFyYW1zOiB7W2tleTogc3RyaW5nXTpzdHJpbmd9KSB7XG4gIHJldHVybiBcIiNcIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3BsaXRVcmxBbmRRdWVyeSAodXJsV2l0aFBvc3NpYmxlUXVlcnk6IHN0cmluZykge1xuICBjb25zdCBwUXVlcnkgPSB1cmxXaXRoUG9zc2libGVRdWVyeS5pbmRleE9mKCc/Jyk7XG4gIHJldHVybiBwUXVlcnkgPj0gMCA/XG4gICAgW3VybFdpdGhQb3NzaWJsZVF1ZXJ5LnN1YnN0cigwLCBwUXVlcnkpLCB1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIocFF1ZXJ5KV0gOlxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeSwgXCJcIl07XG59XG4iLCJpbXBvcnQgZW52LCB7IEVudiB9IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0IHsgQmVhcmVyVG9rZW5JbmZvLCBLZWRCYWNrZW5kQ2xpZW50LCBIdHRwRXJyb3IgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBFZHNDbGllbnQgfSBmcm9tICcuLi9hcGlzL2Vkc2NsaWVudCc7XG5pbXBvcnQgeyBpc29tb3JwaGljLCBLZWRCYWNrZW5kQ2xpZW50V2ViIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuaW1wb3J0IHsgS1NUZXJtUGxhbm5lclJlcG8gfSBmcm9tICcuLi9yZXBvcy9rcy10ZXJtcGxhbm5lci1yZXBvJztcbmltcG9ydCB7IEtHVGVybVBsYW5uZXJSZXBvIH0gZnJvbSAnLi4vcmVwb3Mva2ctdGVybXBsYW5uZXItcmVwbyc7XG5pbXBvcnQgeyBVc2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1ZXN0VHV0b3JlZFRva2Vucyh1c2VyRW1haWw6IHN0cmluZywgZGlzcGxheU5hbWU6IHN0cmluZyk6IFByb21pc2U8RW52PiB7XG4gIC8vbGV0IGJlYXJlclByb21pc2U6IFByb21pc2U8QmVhcmVyVG9rZW5JbmZvPiB8IG51bGwgPSBudWxsO1xuICAvL2xldCBnb29nbGVCZWFyZXJQcm9taXNlOiBQcm9taXNlPEJlYXJlclRva2VuSW5mbz4gfCBudWxsID0gbnVsbDtcblxuICBjb25zdCBjdXJyZW50VXNlcjogVXNlciA9IHtcbiAgICBtYWlsOiB1c2VyRW1haWwsXG4gICAgZGlzcGxheU5hbWUsXG4gICAgcm9sZXM6IFtcIlVTRVJcIl0sXG4gICAgc2Nob29sOiBlbnYuY3VycmVudFVzZXIuc2Nob29sLFxuICAgIHR1dG9yRm9yOiB1c2VyRW1haWxcbiAgfTtcblxuICBmdW5jdGlvbiBjcmVhdGVCZWFyZXJQcm92aWRlciAoY2xpZW50OiBSZXN0Q2xpZW50LCB0b2tlblVybDogc3RyaW5nLCBxdWVyeT8pIHtcbiAgICBsZXQgYmVhcmVyUHJvbWlzZTogUHJvbWlzZTxCZWFyZXJUb2tlbkluZm8+IHwgbnVsbCA9IG51bGw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0QmVhcmVyKCk6IFByb21pc2U8QmVhcmVyVG9rZW5JbmZvPiB7XG4gICAgICAgIHJldHVybiBiZWFyZXJQcm9taXNlIHx8IHRoaXMucmVmcmVzaEJlYXJlcigpO1xuICAgICAgfSxcbiAgICAgIHJlZnJlc2hCZWFyZXIoKTogUHJvbWlzZTxCZWFyZXJUb2tlbkluZm8+IHtcbiAgICAgICAgcmV0dXJuIChiZWFyZXJQcm9taXNlID0gcmV0cmlldmVUb2tlbigpKTtcbiAgICAgIH0sXG4gICAgfVxuXG4gICAgYXN5bmMgZnVuY3Rpb24gcmV0cmlldmVUb2tlbigpOiBQcm9taXNlPEJlYXJlclRva2VuSW5mbz4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgY2xpZW50LmdldCh0b2tlblVybCwgcXVlcnkpO1xuICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICByZXR1cm4gKGF3YWl0IHJlcy5qc29uKCkpIGFzIEJlYXJlclRva2VuSW5mbztcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cyxcbiAgICAgICAgXCJDb3VsZCBub3QgcmV0cmlldmUgdHV0b3IgdG9rZW4gZm9yIFwiICtcbiAgICAgICAgdXNlckVtYWlsICtcbiAgICAgICAgXCIuIEVycm9yIE1lc3NhZ2U6IFwiICsgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gVGhlIG1haW4gYmVhcmVycHJvdmlkZXIgd2lsbCByZXF1ZXN0IGEgdHV0b3ItdG9rZW4gYmFzZWQgb24gdGhlIHVzZXIncyBub3JtYWwgdG9rZW4uXG4gIGNvbnN0IGJlYXJlclByb3ZpZGVyID0gY3JlYXRlQmVhcmVyUHJvdmlkZXIoZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cCwgXCJ0dXRvci90b2tlblwiLCB7dXNlckVtYWlsfSk7XG4gIGNvbnN0IHR1dG9yZWRLZWRCYWNrZW5kQ2xpZW50ID0gbmV3IEtlZEJhY2tlbmRDbGllbnQoaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGNmZy5LRURfQVBJX1VSTCk7XG4gIC8vIE5vdywgY3JlYXRlIGJlYXJlciBwcm92aWRlcnMgZm9yIEVEUyBhbmQgR29vZ2xlIHRoYXQgZ2VuZXJhdGVzIHRva2VuIGJ5IGNvbnZlcnRpbmcgdGhlIHR1dG9yLXRva2VuXG4gIC8vIHRvIGFuIEVEUy0gb3IgR29vZ2xlIHRva2VuOlxuICAvL2NvbnN0IGVkc0JlYXJlclByb3ZpZGVyID0gY3JlYXRlQmVhcmVyUHJvdmlkZXIodHV0b3JlZEtlZEJhY2tlbmRDbGllbnQuaHR0cCwgXCJ0dXRvci9jb252ZXJ0LXRva2VuL2Vkc1wiKTtcbiAgY29uc3QgZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGNyZWF0ZUJlYXJlclByb3ZpZGVyKHR1dG9yZWRLZWRCYWNrZW5kQ2xpZW50Lmh0dHAsIFwidHV0b3IvY29udmVydC10b2tlbi9nb29nbGVcIik7XG5cbiAgY29uc3QgZWRzQ2xpZW50ID0gbmV3IEVkc0NsaWVudChpc29tb3JwaGljLCBjZmcuRURTX0FQSV9VUkwsIGJlYXJlclByb3ZpZGVyLCAoKT0+dXNlckVtYWlsKTtcbiAgXG4gIGNvbnN0IHR1dG9yRW52OiBFbnYgPSB7XG4gICAgY3VycmVudFVzZXIsXG4gICAgYmVhcmVyUHJvdmlkZXIsXG4gICAgZWRzQ2xpZW50LFxuICAgIGdvb2dsZVRva2VuUHJvdmlkZXIsXG4gICAga2VkQmFja2VuZENsaWVudDogdHV0b3JlZEtlZEJhY2tlbmRDbGllbnQsXG4gICAgdHV0b3JlZDogdHJ1ZVxuICB9O1xuICB0dXRvckVudi5rc1Rlcm1QbGFubmVyUmVwbyA9IG5ldyBLU1Rlcm1QbGFubmVyUmVwbygoKT0+dHV0b3JlZEtlZEJhY2tlbmRDbGllbnQsICgpPT5jdXJyZW50VXNlcik7XG4gIHR1dG9yRW52LmtnVGVybVBsYW5uZXJSZXBvID0gbmV3IEtHVGVybVBsYW5uZXJSZXBvKCgpPT50dXRvcmVkS2VkQmFja2VuZENsaWVudCwgKCk9PmN1cnJlbnRVc2VyKTtcbiAgdHV0b3JFbnYudXNlclRhc2tzUmVwbyA9IG5ldyBVc2VyVGFza3NSZXBvKCgpPT50dXRvcmVkS2VkQmFja2VuZENsaWVudCwgKCk9PmN1cnJlbnRVc2VyKTtcblxuICBhd2FpdCBiZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKS5jYXRjaChlcnJvciA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0pO1xuXG4gIHJldHVybiB0dXRvckVudjsgIFxufVxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgVGVybSwgQWNhZGVtaWNZZWFyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xuICB0ZXJtOiBUZXJtO1xuICB3ZWVrPzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XG4gIHJldHVybiB0ZXJtID09PSAnQVQnID9cbiAgICBbMzIsIDUxXSA6XG4gICAgWzEsIDI1XTtcbn1cblxuLy9Ob3QgdXNlZCBhbnltb3JlXG4vLyBleHBvcnQgZnVuY3Rpb24gZ2V0VGVybVN0YXJ0QW5kRW5kKG5vdzogbW9tZW50Lk1vbWVudCkgOiBtb21lbnQuTW9tZW50W10ge1xuLy8gICAgIHJldHVybiBub3cubW9udGgoKSA+PSA2ID8gLy8gNiA9IEp1bHkgaW4gSlMgRGF0ZXMgYW5kIGluIG1vbWVudCBhcyB3ZWxsIVxuLy8gICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNywgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMTEsIDMxKSldIDogLy8gYXVnMSAtIGRlYzMxXG4vLyAgICAgW21vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCAwLCAxKSksIG1vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCA2LCAzMSkpXTsgLy8gamFuMSAtIGp1bHkzMVxuLy8gfVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGU6IERhdGUsIGlzRmlyc3RUZXJtOiBib29sZWFuKTogbW9tZW50Lk1vbWVudFtdIHtcbiAgdmFyIGFkZFllYXIgPSBkYXRlLmdldE1vbnRoKCkgPj0gNztcbiAgdmFyIHRlcm1ZZWFyID0gbnVsbDtcblxuICBpZiAoYWRkWWVhcikge1xuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiBkYXRlLmdldEZ1bGxZZWFyKCkgKyAxO1xuICB9IGVsc2Uge1xuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgLSAxIDogZGF0ZS5nZXRGdWxsWWVhcigpO1xuICB9XG5cbiAgdmFyIHRlcm1ZZWFyTW9tZW50ID0gbW9tZW50KHRlcm1ZZWFyLnRvU3RyaW5nKCksIFwiWVlZWVwiKTtcblxuICBpZiAodGVybVllYXJNb21lbnQud2VlaygpICE9IDEpIHtcbiAgICB0ZXJtWWVhck1vbWVudCA9IHRlcm1ZZWFyTW9tZW50LmNsb25lKCkuYWRkKDEsICd3ZWVrJyk7XG4gIH1cblxuICByZXR1cm4gaXNGaXJzdFRlcm0gPyBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLndlZWsoMzIpLnN0YXJ0T2YoJ3dlZWsnKSwgbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLndlZWsoNTEpLmVuZE9mKCd3ZWVrJyldIDpcbiAgICBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLCBtb21lbnQodGVybVllYXJNb21lbnQuY2xvbmUoKSkud2VlaygyNSkuZW5kT2YoJ3dlZWsnKV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xNb21lbnQobTogbW9tZW50Lk1vbWVudCk6IFNjaG9vbE1vbWVudCB7XG4gIGNvbnN0IHRoaXNZZWFyID0gbS55ZWFyKCk7XG4gIGNvbnN0IGlzQXV0dW1uID0gbS5tb250aCgpID49IDY7IC8vIGRldGVybWluZSBcbiAgY29uc3QgW2F1dHVtblllYXIsIHNwcmluZ1llYXJdID0gaXNBdXR1bW4gP1xuICAgIFt0aGlzWWVhciwgdGhpc1llYXIgKyAxXSA6XG4gICAgW3RoaXNZZWFyIC0gMSwgdGhpc1llYXJdO1xuICBjb25zdCBhY2FkZW1pY1llYXIgPSAnJyArIGF1dHVtblllYXIgKyAnLycgKyBzcHJpbmdZZWFyO1xuICBjb25zdCB0ZXJtID0gaXNBdXR1bW4gPyAnQVQnIDogJ1NUJztcbiAgY29uc3Qgd2VlayA9IG0ud2VlaygpO1xuICByZXR1cm4geyBhY2FkZW1pY1llYXIsIHRlcm0sIHdlZWsgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXIoYVllYXI6IEFjYWRlbWljWWVhciwgbnVtWWVhcnNUb0FkZDogbnVtYmVyKTogQWNhZGVtaWNZZWFyIHtcbiAgcmV0dXJuIGFZZWFyLnNwbGl0KCcvJylcbiAgICAubWFwKHllYXJTdHIgPT4gcGFyc2VJbnQoeWVhclN0cikgKyBudW1ZZWFyc1RvQWRkKVxuICAgIC5tYXAoeWVhciA9PiAnJyArIHllYXIpXG4gICAgLmpvaW4oJy8nKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5leHRBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXZBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAtMSk7XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFNjaG9vbE1vbWVudCwgYWRkWWVhciB9IGZyb20gJy4vc2Nob29sLW1vbWVudCc7XG5pbXBvcnQgeyBBY2FkZW1pY1llYXIsIFRlcm0gfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5pbXBvcnQge0luamVjdGVkSW50bH0gZnJvbSAncmVhY3QtaW50bCc7XG5cbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcblxuZnVuY3Rpb24gaXNTY2hvb2xNb21lbnQob2JqOiBEYXRlIHwgU2Nob29sTW9tZW50KTogb2JqIGlzIFNjaG9vbE1vbWVudCB7XG4gIHJldHVybiAnYWNhZGVtaWNZZWFyJyBpbiBvYmo7XG59XG5cbmV4cG9ydCBjbGFzcyBTY2hvb2xUZXJtIHtcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XG4gIHRlcm06IFRlcm07XG5cbiAgY29uc3RydWN0b3IoZGF0ZU9yU2Nob29sTW9tZW50OiBEYXRlIHwgU2Nob29sTW9tZW50KSB7XG4gICAgY29uc3Qgc2Nob29sTW9tZW50ID0gaXNTY2hvb2xNb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSA/XG4gICAgICBkYXRlT3JTY2hvb2xNb21lbnQgOiBnZXRTY2hvb2xNb21lbnQobW9tZW50KGRhdGVPclNjaG9vbE1vbWVudCkpO1xuICAgIHRoaXMuYWNhZGVtaWNZZWFyID0gc2Nob29sTW9tZW50LmFjYWRlbWljWWVhcjtcbiAgICB0aGlzLnRlcm0gPSBzY2hvb2xNb21lbnQudGVybTtcbiAgfVxuXG4gIGdldCB5ZWFyKCkge1xuICAgIHJldHVybiBwYXJzZUludCh0aGlzLmFjYWRlbWljWWVhclxuICAgICAgICAuc3BsaXQoJy8nKVt0aGlzLnRlcm0gPT09ICdBVCcgPyAwIDogMV0pO1xuICB9XG5cbiAgbmV4dFRlcm0oKSB7XG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdTVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0gOlxuICAgICAge1xuICAgICAgICB0ZXJtOiAnQVQnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIDEpXG4gICAgICB9KTtcbiAgfVxuXG4gIHByZXZUZXJtKCkge1xuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAge1xuICAgICAgICB0ZXJtOiAnU1QnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIC0xKVxuICAgICAgfSA6XG4gICAgICB7XG4gICAgICAgIHRlcm06ICdBVCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcbiAgICAgIH0pO1xuICAgIFxuICB9XG5cbiAgdG9Mb2NhbGVTdHJpbmcoaW50bDogSW5qZWN0ZWRJbnRsLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XG4gICAgbGV0IHllYXIgPSB0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVswXTpcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMV07XG5cbiAgICBpZiAoc2hvcnRZZWFyKVxuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xuXG4gICAgcmV0dXJuIHRoaXMudGVybSA9PT0gJ0FUJyA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3Rlcm1wbGFubmVyLnNlY29uZFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonSFQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSkgOiBcbiAgICBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5maXJzdFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonVlQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSk7XG4gIH1cbn1cbiIsIlxuZXhwb3J0IGZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdCAoc3RyKSB7XG4gICAgZm9yIChsZXQgaT0wLCBsPXN0ci5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChpKSA8IDB4MjAwMCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHIoMCwgaSkgKyBzdHJbaV0udG9Mb2NhbGVVcHBlckNhc2UoKSArIHN0ci5zdWJzdHIoaSArIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRlbmQob2JqLCBleHRlbnNpb24pIHtcbiAgICBpZiAodHlwZW9mIGV4dGVuc2lvbiAhPT0gJ29iamVjdCcpIHJldHVybiBvYmo7XG4gICAgT2JqZWN0LmtleXMoZXh0ZW5zaW9uKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIG9ialtrZXldID0gZXh0ZW5zaW9uW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lPFQsRT4gKG9iaiA6IFQsIGV4dGVuc2lvbj86IEUpIHtcbiAgICBsZXQgY2xvbmUgPSB7fTtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsb25lLCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpKTtcbiAgICB9KTtcbiAgICBpZiAoZXh0ZW5zaW9uKSBleHRlbmQoY2xvbmUsIGV4dGVuc2lvbik7XG4gICAgcmV0dXJuIGNsb25lIGFzIChUICYgRSk7XG59XG5cbmNvbnN0IGNvbmNhdCA9IFtdLmNvbmNhdDtcbmV4cG9ydCBmdW5jdGlvbiBmbGF0dGVuPFQ+IChhIDogKFQgfCBUW10pW10pIHtcbiAgICByZXR1cm4gY29uY2F0LmFwcGx5KFtdLCBhKSBhcyBUW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcDxUPihwcm9wOmtleW9mIFQpIHtcbiAgICByZXR1cm4gKGE6IFQsYjogVCkgPT4ge1xuICAgICAgICBjb25zdCBhUHJvcCA9IGFbcHJvcF0sIGJQcm9wID0gYltwcm9wXTtcbiAgICAgICAgcmV0dXJuIGFQcm9wID4gYlByb3AgPyAxIDogYVByb3AgPCBiUHJvcCA/IC0xIDogMDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcHMoXG4gICAgcHJvcHM6IHN0cmluZyB8IHN0cmluZ1tdLFxuICAgIGxvY2FsZXM/OiBzdHJpbmcgfCBzdHJpbmdbXSxcbiAgICBvcHRpb25zPzogSW50bC5Db2xsYXRvck9wdGlvbnMpOiAoYTogYW55LCBiOiBhbnkpID0+IG51bWJlclxue1xuICAgIHByb3BzID0gQXJyYXkuaXNBcnJheShwcm9wcykgPyBwcm9wcyA6IFtwcm9wc107XG5cbiAgICBjb25zdCBsb2NhbGVDb21wYXJlID0gKGEsYikgPT5cbiAgICAgICAgdHlwZW9mIGEgPT09ICdzdHJpbmcnID9cbiAgICAgICAgICAgIGEubG9jYWxlQ29tcGFyZShiLCBsb2NhbGVzLCBvcHRpb25zKSA6XG4gICAgICAgICAgICBhIDwgYiA/IC0xIDogYSA+IGIgPyAxIDogMDtcblxuICAgIGZ1bmN0aW9uIGNtcFBhcnQgKGEsYixmaXJzdFBhcnQ6IHN0cmluZyxyZXN0OiBzdHJpbmdbXSkge1xuICAgICAgICBjb25zdCBmaXJzdEEgPSBhW2ZpcnN0UGFydF07XG4gICAgICAgIGNvbnN0IGZpcnN0QiA9IGJbZmlyc3RQYXJ0XTtcbiAgICAgICAgaWYgKGZpcnN0QSA9PT0gZmlyc3RCKSByZXR1cm4gMDtcbiAgICAgICAgaWYgKGZpcnN0QSA9PSBudWxsKSByZXR1cm4gLTE7XG4gICAgICAgIGlmIChmaXJzdEIgPT0gbnVsbCkgcmV0dXJuIDE7XG4gICAgICAgIHJldHVybiByZXN0Lmxlbmd0aCA9PT0gMCA/XG4gICAgICAgICAgICBsb2NhbGVDb21wYXJlKGZpcnN0QSwgZmlyc3RCKSA6XG4gICAgICAgICAgICBjbXBQYXJ0KGZpcnN0QSwgZmlyc3RCLCByZXN0WzBdLCByZXN0LnNsaWNlKDEpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvcHNcbiAgICAgICAgLm1hcChwcm9wID0+IHByb3Auc3BsaXQoJy4nKSlcbiAgICAgICAgLm1hcCgoW2ZpcnN0UGFydCwgLi4ucmVzdF0pID0+IChhLGIpID0+IGNtcFBhcnQoYSxiLCBmaXJzdFBhcnQsIHJlc3QpKVxuICAgICAgICAucmVkdWNlKChjbXAxLCBjbXAyKSA9PlxuICAgICAgICAgICAgKGEsYikgPT4gY21wMShhLGIpIHx8IGNtcDIoYSxiKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBMKHRleHQsIC4uLmFyZ3MpIHtcbiAgICBsZXQgZmlyc3QgPSB0ZXh0WzBdO1xuICAgIHJldHVybiBidWlsZE1lc3NhZ2UodGV4dCwgYXJncyk7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkTWVzc2FnZSAodGV4dCwgYXJncykge1xuICAgIGxldCBydiA9IHRleHRbMF07XG4gICAgZm9yIChsZXQgaT0xLCBsPXRleHQubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBydiArPSBhcmdzW2ktMV0gKyB0ZXh0W2ldO1xuICAgIH1cbiAgICByZXR1cm4gcnY7XG59XG5cbmV4cG9ydCBjbGFzcyBUQzxUPiB7XG4gICAgY29uc3RydWN0b3IodGVtcGxhdGU6IFQpIHtcbiAgICAgICAgZXh0ZW5kKHRoaXMsIHRlbXBsYXRlKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRlVGltZVJldml2ZXIgKGtleSwgdmFsdWUpIHtcbiAgICB2YXIgYTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICBhID0gL1xcL0RhdGVcXCgoXFxkKilcXClcXC8vLmV4ZWModmFsdWUpO1xuICAgICAgICBpZiAoYSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCthWzFdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59XG5cbi8vbGV0IGluZm9TZXJpYWwgPSAxO1xuZXhwb3J0IGZ1bmN0aW9uIHNob3dJbmZvIChtc2cpIHtcbiAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2luZm8nLCB7ICdkZXRhaWwnOiBtc2cgfSk7XG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yIChlcnJNc2c6IHN0cmluZyB8IEVycm9yKSB7XG4gICAgY29uc3QgbXNnID0gdHlwZW9mIGVyck1zZyA9PT0gJ3N0cmluZycgPyBlcnJNc2cgOiBlcnJNc2cubWVzc2FnZTtcbiAgICB2YXIgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2N1c3RvbWVycm9yJywgeyAnZGV0YWlsJzogbXNnIH0pO1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyTXNnKTtcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXhMZW5ndGgoc3RyOiBzdHJpbmcsIG1heExlbjogbnVtYmVyKSB7XG4gICAgcmV0dXJuIHN0ci5sZW5ndGggPiBtYXhMZW4gP1xuICAgICAgICBzdHIuc3Vic3RyKDAsIG1heExlbiAtIDMpICsgXCIuLi5cIiA6XG4gICAgICAgIHN0cjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5VG9Mb29rdXA8VD4oYTogVFtdLCBrZXlBY2Nlc3NvcjogKGl0ZW06IFQpID0+IHN0cmluZyB8IG51bWJlcikge1xuICAgIGNvbnN0IHJlc3VsdCA6IHtba2V5OiBzdHJpbmddIDogVFtdfSA9IHt9O1xuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XG4gICAgICAgIGNvbnN0IGtleSA9IGtleUFjY2Vzc29yKGl0ZW0pO1xuICAgICAgICBsZXQgYXJyYXkgPSByZXN1bHRba2V5XTtcbiAgICAgICAgaWYgKGFycmF5KSBhcnJheS5wdXNoKGl0ZW0pO1xuICAgICAgICBlbHNlIHJlc3VsdFtrZXldID0gW2l0ZW1dO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb01hcDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgY29uc3QgcmVzdWx0IDoge1trZXk6IHN0cmluZ10gOiBUfSA9IHt9O1xuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XG4gICAgICAgIGNvbnN0IGtleSA9IGtleUFjY2Vzc29yKGl0ZW0pO1xuICAgICAgICByZXN1bHRba2V5XSA9IGl0ZW07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVycnlQaWNrUHJvcHM8VD4gKG9iajogVCwgcHJvcHNUb1BpY2s6IHN0cmluZ1tdKTogUGFydGlhbDxUPiB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBwYXJhbSBvZiBwcm9wc1RvUGljaykge1xuICAgICAgaWYgKHBhcmFtIGluIG9iaikgcmVzdWx0W3BhcmFtXSA9IG9ialtwYXJhbV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQgYXMgUGFydGlhbDxUPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RpbmN0PFQ+IChhOiBUW10sIGtleUFjY2Vzc29yPzogKGl0ZW06IFQpID0+IGFueSkge1xuICAgIGNvbnN0IG1hcCA9IGFycmF5VG9NYXAoYSwga2V5QWNjZXNzb3IgfHwgKHggPT4geCkpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhtYXApLm1hcChrZXkgPT4gbWFwW2tleV0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hhbGxvd0VxdWFscyhhOiBhbnksIGI6IGFueSkge1xuICAgIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcbiAgICBpZiAoIWEgfHwgIWIpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIGEgIT09ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IGtleXNBID0gT2JqZWN0LmtleXMoYSk7XG4gICAgY29uc3Qga2V5c0IgPSBPYmplY3Qua2V5cyhiKTtcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGxldCBpPTAsIGw9a2V5c0EubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBjb25zdCBrZXkgPSBrZXlzQVtpXTtcbiAgICAgICAgaWYgKGtleXNCW2ldICE9PSBrZXkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKGFba2V5XSAhPT0gYltrZXldKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIiwiaW1wb3J0IG1vbWVudCwgeyBNb21lbnQgfSBmcm9tIFwibW9tZW50XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBLRURXZWVrICh5ZWFyOiBudW1iZXIsIHdlZWs6IG51bWJlcikge1xuICBjb25zdCBtID0gbW9tZW50KG5ldyBEYXRlKHllYXIsIDEsIDEpKS53ZWVrKHdlZWspO1xuICBjb25zdCByZXMgPSB7XG4gICAgeWVhcixcbiAgICB3ZWVrLFxuICAgIG5vdEJlZm9yZTogbS5jbG9uZSgpLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoLTIsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpLFxuICAgIG5vdEFmdGVyOiBtLmNsb25lKCkuc3RhcnRPZignd2VlaycpLmFkZCg1LCAnZGF5cycpLnRvRGF0ZSgpLmdldFRpbWUoKVxuICB9O1xuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmV4dFdlZWtEYXRlKGRhdGU6IE1vbWVudCk6IHsgYWRqdXN0ZWQ6IGJvb2xlYW4sIG5leHREYXRlOiBEYXRlIH17XG4gIHZhciBuZXh0RGF0ZSA9IG1vbWVudChkYXRlKS5hZGQoMSwgJ3dlZWsnKTtcbiAgLy9TZXQgdGhlIDAxLjAxIG9mIHRoZSBuZXh0IHllYXIgaW4gY2FzZSB0aGUgbmV4dCB3ZWVrIGlzIGluIHRoZSBzYW1lIHllYXIgXG4gIC8vYW5kIHRoZSBwcmV2aW91cyB3ZWVrIGlzIHRoZSBsYXN0IHdlZWsgb2YgdGhlIHllYXJcbiAgaWYoZGF0ZS53ZWVrKCkgPT09IGRhdGUud2Vla3NJblllYXIoKSAmJiBuZXh0RGF0ZS55ZWFyKCkgPT09IGRhdGUueWVhcigpKXtcbiAgICByZXR1cm4ge2FkanVzdGVkOiB0cnVlLCBuZXh0RGF0ZTogbW9tZW50KGAke2RhdGUueWVhcigpICsgMX0tMDEtMDFgKS50b0RhdGUoKX07XG4gIH1cblxuICByZXR1cm4ge2FkanVzdGVkOiBmYWxzZSwgbmV4dERhdGU6IG5leHREYXRlLnRvRGF0ZSgpfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZXZXZWVrRGF0ZShkYXRlOiBNb21lbnQpOiB7IGFkanVzdGVkOiBib29sZWFuLCBuZXh0RGF0ZTogRGF0ZSB9e1xuICB2YXIgcHJldkRhdGUgPSBtb21lbnQoZGF0ZSkuYWRkKC0xLCAnd2VlaycpO1xuICAvL1NldCB0aGUgMDEuMDEgb2YgdGhlIGN1cnJlbnQgeWVhciBpbiBjYXNlIHRoZSBwcmV2IHdlZWsgaXMgaW4gdGhlIHByZXZpb3VzIHllYXJcbiAgaWYoZGF0ZS53ZWVrKCkgPT09IDIgJiYgcHJldkRhdGUueWVhcigpICE9PSBkYXRlLnllYXIoKSl7XG4gICAgcmV0dXJuIHthZGp1c3RlZDogdHJ1ZSwgbmV4dERhdGU6IG1vbWVudChgJHtkYXRlLnllYXIoKX0tMDEtMDFgKS50b0RhdGUoKX07XG4gIH1cblxuICByZXR1cm4ge2FkanVzdGVkOiBmYWxzZSwgbmV4dERhdGU6IHByZXZEYXRlLnRvRGF0ZSgpfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFkanVzdGVkV2VlayhtOiBNb21lbnQpIHtcbiAgY29uc3QgY2xvbmUgPSBtLmNsb25lKCk7XG4gIHJldHVybiBtLndlZWtkYXkoKSA+PSA1ID8gLy8gTMO2cmRhZyAwMDowMCAvIFPDtm5kYWcgMDA6MDA/XG4gICAgICBtLndlZWsoKSArIDEgOiAvLyBUaWxsaMO2ciBuw6RzdGEgdmVja2FcbiAgICAgIG0ud2VlaygpO1xufVxuXG4vKmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrTGltaXRzIChtOiBNb21lbnQpIHtcbiAgY29uc3QgY2xvbmVkU3dlZGlzaCA9IG0uY2xvbmUoKS5sb2NhbGUoJ3N2Jyk7XG4gIGNvbnN0IGxpbWl0cyA9IHtcbiAgICBub3RCZWZvcmU6IGNsb25lZFN3ZWRpc2guc3RhcnRPZignd2VlaycpLmFkZCgtMiwgJ2RheXMnKSxcbiAgICBub3RBZnRlcjogY2xvbmVkU3dlZGlzaC5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJylcbiAgfTtcbn1cbiovXG4iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCJtb2R1bGUuZXhwb3J0cyA9IGpRdWVyeTsiLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3RET007Il0sInNvdXJjZVJvb3QiOiIifQ==