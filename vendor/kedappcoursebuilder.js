var kedappcoursebuilder =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"kedappcoursebuilder": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/elements/KEDAppCourseBuilder/webpack-entry.ts","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "./kedbackend/KED.Backend.API/schema.json":
/*!************************************************!*\
  !*** ./kedbackend/KED.Backend.API/schema.json ***!
  \************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "./kedbackend/client.js":
/*!******************************!*\
  !*** ./kedbackend/client.js ***!
  \******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "./kedbackend/clientweb.js":
/*!*********************************!*\
  !*** ./kedbackend/clientweb.js ***!
  \*********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "./kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!***************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \***************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!***********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \***********************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \***************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "./kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "./kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "./kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \***********************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "./kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "./kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.undoLink = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.undoLink(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.undoLink = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'undo-link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \*************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "./kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!****************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \***********************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!**************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \**************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                case 'undo-link':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js":
/*!**********************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js ***!
  \**********************************************************************************************/
/*! exports provided: applyMutationsOnDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyMutationsOnDeltas", function() { return applyMutationsOnDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");


function applyMutationsOnDeltas(branchId, deltas, mutations, optimistic, userDisplayName, hasAdditionalFilter) {
    var _loop_1 = function (m) {
        switch (m.op) {
            case 'add-related':
                //
                // AddRelated RepoMutation
                //
                if (!hasAdditionalFilter && m.branchId === branchId) {
                    deltas = [{
                            type: 'add',
                            sourceId: m.id,
                            targetId: m.relatedDoc.id,
                            label: m.graphProp,
                            sourceTable: m.table,
                            $meta: optimistic ? 'adding' : 'persisted',
                            dateTime: Date.now(),
                            targetName: m.relatedDoc.name,
                            contributor: userDisplayName
                        }].concat(deltas);
                }
                break;
            case 'clear-branch':
                //
                // ClearBranch RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                break;
            case 'delete':
                //
                // Delete RepoMutation
                //
                // This type of mutation can not be performed onto branches. There's no branchId property on m.
                break;
            case 'merge':
                //
                // Merge RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                else if (m.targetBranchId === branchId) {
                    // This change will append new deltas to our deltas array but we don't know what would come.
                    // Need to refetch from server.
                    if (!optimistic)
                        return { value: null }; // Caller should check for null and re-fetch data from server.
                }
                break;
            case 'remove-related':
                //
                // Remove-Related RepoMutation
                //
                if (hasAdditionalFilter || m.branchId !== branchId)
                    return "continue";
                deltas = [{
                        type: 'remove',
                        sourceId: m.id,
                        targetId: m.relatedDoc.id,
                        targetName: m.relatedDoc.name,
                        label: m.graphProp,
                        sourceTable: m.table,
                        contributor: userDisplayName,
                        dateTime: Date.now(),
                        $meta: optimistic ? 'adding' : 'persisted'
                    }].concat(deltas);
                break;
            case 'undo-link':
                //
                // Undo-Link RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (d) {
                        return (d.type === 'add' || d.type === 'remove' || d.type === 'undo-link') &&
                            d.sourceId === m.id &&
                            d.targetId === m.relatedId;
                    });
                    if (idx < 0)
                        return "continue";
                    // Found an "add" or "remove" delta to change:
                    if (optimistic) {
                        var deltaRelation = deltas[idx];
                        // Mark the existing add/remove delta as currenlty being deleted
                        deltas = deltas.slice(0, idx).concat([
                            tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaRelation, { $meta: optimistic ? 'removing' : 'persisted' })
                        ], deltas.slice(idx + 1));
                    }
                    else {
                        // Persisted. Just remove it:
                        deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                    }
                }
                break;
            case 'update':
                //
                // Update RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (delta) {
                        return delta.type === 'modify' &&
                            delta.targetId === m.id;
                    });
                    if (idx < 0 && !hasAdditionalFilter) {
                        deltas = [{
                                type: 'modify',
                                table: m.table,
                                targetId: m.id,
                                targetName: m.targetName,
                                data: m.deltaDoc,
                                dateTime: Date.now(),
                                contributors: [userDisplayName],
                                $meta: optimistic ? 'adding' : 'persisted',
                            }].concat(deltas);
                    }
                    else {
                        var existingDeltaDoc = deltas[idx];
                        var contributors = existingDeltaDoc.contributors.slice();
                        if (!contributors.includes(userDisplayName)) {
                            contributors.push(userDisplayName);
                        }
                        var newData = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_1__["mergeDeltas"])(existingDeltaDoc.data, m.deltaDoc, { removeUnsetProps: true });
                        if (!optimistic && Object.keys(newData).length === 0) {
                            // Committed mutation that resets a deltaDoc. Remove the deltaDoc entirely:
                            deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                        }
                        else {
                            // 
                            deltas = [
                                {
                                    type: 'modify',
                                    table: m.table,
                                    targetId: m.id,
                                    targetName: m.targetName,
                                    data: newData,
                                    dateTime: Date.now(),
                                    contributors: contributors,
                                    $meta: optimistic ? 'updating' : 'persisted',
                                }
                            ].concat(deltas.slice(0, idx), deltas.slice(idx + 1));
                        }
                    }
                }
                break;
        }
    };
    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {
        var m = mutations_1[_i];
        var state_1 = _loop_1(m);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return deltas;
}
//# sourceMappingURL=apply-mutations-on-deltas.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js":
/*!********************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js ***!
  \********************************************************************************/
/*! exports provided: DeltaCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCache", function() { return DeltaCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./apply-mutations-on-deltas */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js");



var DeltaCache = /** @class */ (function () {
    function DeltaCache(getClient, getUser, getUserDisplayName) {
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.lookup = {};
    }
    DeltaCache.prototype.applyMutations = function (mutations, _a) {
        var optimistic = (_a === void 0 ? { optimistic: false } : _a).optimistic;
        // Apply mutations locally onto the DeltaCache and notify their subscribers
        for (var _i = 0, _b = Object.keys(this.lookup); _i < _b.length; _i++) {
            var queryKey = _b[_i];
            var cacheEntry = this.lookup[queryKey];
            if (cacheEntry.value) {
                // Instead here: Store the mutations on cacheEntry. No matter if it yet has value or not.
                // Then apply mutation whenever subscribing! (Better handling of mutations that arrives before fetch() is done)
                // (See how I handle this in query-set.ts)
                var newValue = Object(_apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__["applyMutationsOnDeltas"])(cacheEntry.query.branchId, cacheEntry.value, mutations, optimistic, this.getUserDisplayName(), !!cacheEntry.query.tags);
                if (newValue === null) {
                    // The mutation requires cacheEntry to be refetched from server
                    if (!optimistic) {
                        // Caller has successfully performed the mutations and got success back from server.
                        // It's ok to refetch the deltas from server now:
                        cacheEntry.fetch();
                        // After fetch completes, it will notify the subscribers.
                    }
                }
                if (newValue !== cacheEntry.value) {
                    cacheEntry.optimisticValue = newValue;
                    if (!optimistic)
                        cacheEntry.value = newValue;
                    cacheEntry.notify(newValue);
                }
            }
        }
    };
    DeltaCache.prototype.subscribe = function (query, observer) {
        var _this = this;
        var cacheEntry = this.lookup[query.branchId + query.tags];
        if (!cacheEntry) {
            cacheEntry = new DeltaCacheEntry(this.getClient(), query);
            this.lookup[query.branchId + query.tags] = cacheEntry;
        }
        if (cacheEntry.cleanupTimer) {
            clearTimeout(cacheEntry.cleanupTimer);
            cacheEntry.cleanupTimer = null;
        }
        var subscription = {
            unsubscribe: function () {
                cacheEntry.subscribers = cacheEntry.subscribers.filter(function (_a) {
                    var o = _a.observer;
                    return o !== observer;
                });
                if (cacheEntry.subscribers.length === 0) {
                    cacheEntry.cleanupTimer = setTimeout(function () {
                        if (cacheEntry.subscribers.length === 0) {
                            delete _this.lookup[query.branchId + query.tags];
                        }
                    }, 100);
                }
            }
        };
        cacheEntry.subscribers.push({ observer: observer, subscription: subscription });
        if (cacheEntry.value) {
            // Value has been successfully retrieved already. Pick from cache.
            observer(cacheEntry.optimisticValue || cacheEntry.value, null, subscription);
        }
        else if (cacheEntry.isFetching) {
            // A value is on its way. Sit back and relax. All registered
            // observers (including this one) will be notified when data arrives
            // or fails.
        }
        else if (cacheEntry.error) {
            observer(null, cacheEntry.error, subscription);
        }
        else {
            cacheEntry.fetch();
        }
        return subscription;
    };
    return DeltaCache;
}());

var DeltaCacheEntry = /** @class */ (function () {
    function DeltaCacheEntry(client, query) {
        this.fetchOperationId = 0; // Makes sure a re-fetch will discard the result from any ongoing fetch.
        this.client = client;
        this.query = query;
        this.value = null;
        this.error = null;
        this.optimisticValue = null;
        this.subscribers = [];
        this.isFetching = false;
        this.cleanupTimer = null;
    }
    DeltaCacheEntry.prototype.fetch = function () {
        var _this = this;
        var fetchOperationId = ++this.fetchOperationId;
        this.isFetching = true;
        this.fetchFromServer().then(function (value) {
            // Success
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                value.sort(function (a, b) { return b.dateTime - a.dateTime; }); // Latest first
                _this.value = value;
                _this.optimisticValue = value;
                _this.notify(value);
            }
        }).catch(function (error) {
            // Fail
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                _this.error = error;
                _this.fail(error);
            }
        });
    };
    DeltaCacheEntry.prototype.fetchFromServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!this.query.branchId)
                            throw new Error('Deltas only available on branches');
                        return [4 /*yield*/, this.client.http.get('deltas', this.query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 300 || res.status < 200)) return [3 /*break*/, 3];
                        _a = _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    DeltaCacheEntry.prototype.notify = function (value) {
        for (var _i = 0, _a = this.subscribers; _i < _a.length; _i++) {
            var _b = _a[_i], observer = _b.observer, subscription = _b.subscription;
            observer(value, null, subscription);
        }
    };
    DeltaCacheEntry.prototype.fail = function (error) {
        var copy = this.subscribers.slice();
        this.subscribers = [];
        for (var _i = 0, copy_1 = copy; _i < copy_1.length; _i++) {
            var _a = copy_1[_i], observer = _a.observer, subscription = _a.subscription;
            observer(null, error, subscription);
        }
    };
    return DeltaCacheEntry;
}());
//# sourceMappingURL=delta-cache.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js":
/*!*************************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js ***!
  \*************************************************************************************/
/*! exports provided: DeltaCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCollection", function() { return DeltaCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../observable */ "./kedbackend/js/dist/js/observable/index.js");


var DeltaCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DeltaCollection, _super);
    function DeltaCollection(deltaCache, query) {
        var _this = _super.call(this, function (observer) { return _this.deltaCache.subscribe(query, observer); }) || this;
        _this.deltaCache = deltaCache;
        _this.query = query;
        return _this;
    }
    DeltaCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return new DeltaCollection(this.deltaCache, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, { tags: tags }));
    };
    return DeltaCollection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Collection"]));

//# sourceMappingURL=delta-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!***************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \***************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            // Do nothing on target doc!
                            targetDoc.$wasUnset = true; // Just mark it for re-retrieval after successful posting changes.
                            break;
                        }
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
// {name: "Ulla"}, {name: {$unset:0}
// {tags: {$add: "hej"}}, {tags: {$unset:0}"}
function mergeDeltas(delta1, delta2, _a) {
    var removeUnsetProps = (_a === void 0 ? { removeUnsetProps: false } : _a).removeUnsetProps;
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            if (removeUnsetProps) {
                                delete targetDelta[key];
                            }
                            else {
                                // No matter if targetDelta is empty or has value. Set it to {$unset:0}
                                // to make sure the very end result will have {$unset:0}
                                targetDelta[key] = { $unset: 0 };
                            }
                            break;
                        }
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _b = 0, metaInstructions_2 = metaInstructions; _b < metaInstructions_2.length; _b++) {
                    var mi = metaInstructions_2[_b];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \*********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "./kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!*************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \*************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "./kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return options && options.includeDeltaEdges ?
            hef.addFlags("includeDeltaEdges") :
            hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return options && options.includeDeltaEdges ?
            het.addFlags("includeDeltaEdges") :
            het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (doc, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: doc.id,
                deltaDoc: changes,
                targetName: doc.name
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.undoLink = function (id, label, relatedId) {
        if (!this.query.branchId)
            throw new Error("undo links can only be performed on branches");
        this.repo.writer.mutate([{
                op: 'undo-link',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "./kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedDoc.id ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedDoc.id; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedDoc.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedDoc.id; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!*******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \*******************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony import */ var _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-collection */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js");







var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, getUserDisplayName, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!defaultQueryOptions)
            this.defaultQueryOptions = {};
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser, getUserDisplayName);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
        this.deltas = new _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__["DeltaCollection"](this.writer.deltaCache, {
            branchId: this.defaultQueryOptions.branchId // If branchId is undefined. DeltaCollection will respond with Error on subscribe()
        });
    }
    KedBackendRepo.prototype.table = function (tableName) {
        var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](this, tableName, this.defaultQueryOptions);
        if (this.cacheOptimized)
            collection = collection.cacheOptimized();
        return collection;
    };
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, this.getUserDisplayName, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!***************************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \***************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!*********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "./kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "./kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony import */ var _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-cache */ "./kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js");







var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser, getUserDisplayName) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
        this.deltaCache = new _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__["DeltaCache"](getClient, getUser, getUserDisplayName);
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        this.deltaCache.applyMutations(this.mutationQueue.get(), { optimistic: true });
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] },
                            targetName: null // We don't have the target name. But this mutation won't be visible in a DeltaCollection anyway, so it wont be used.
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        this.deltaCache.applyMutations(mutations, { optimistic: false });
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'undo-link':
                    br.undoLink(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "./kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \*************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "./kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "./kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!*********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \*********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "./kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \***********************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!********************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!******************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!*************************************************************!*\
  !*** ./kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \*************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "./kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/collection.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/collection.js ***!
  \********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/emitter.js":
/*!*****************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/emitter.js ***!
  \*****************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/fiber-context.js":
/*!***********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/fiber-context.js ***!
  \***********************************************************/
/*! exports provided: FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return FiberContext; });
var stack = [];
var currentFiber = null;
var providers = [function () { return currentFiber; }];
function pushFiber(fiber) {
    stack.push(currentFiber);
    currentFiber = fiber;
}
function popFiber() {
    currentFiber = stack.pop();
}
var FiberContext = {
    get current() { return currentFiber; },
    /*run: function rerun<R>(fiber: Fiber, fn: ()=>R): R | Promise<R> {
      pushFiber(fiber);
      try {
        return Promise.resolve(fn());
      } catch (p) {
        if (p && typeof p.then === 'function') {
          return p.then(()=>rerun(fiber, fn));
        } else {
          return Promise.reject(p);
        }
      } finally {
        popFiber();
      }
    },*/
    addProvider: function (getCurrentFiber) {
        providers.push(getCurrentFiber);
        setCurrentGetterFromProviders();
    },
    removeProvider: function (getCurrentFiber) {
        providers = providers.filter(function (p) { return p !== getCurrentFiber; });
        setCurrentGetterFromProviders();
    }
};
function setCurrentGetterFromProviders() {
    Object.defineProperty(FiberContext, "current", {
        get: providers.reduce(function (p, c) { return function () { return p() || c(); }; }),
        set: function () { throw new Error("Use FiberContext.push() to change current fiber"); }
    });
}
//# sourceMappingURL=fiber-context.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/index.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/index.js ***!
  \***************************************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "./kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "./kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });

/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"]; });






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/map.js":
/*!*************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/map.js ***!
  \*************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/mixin.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/mixin.js ***!
  \***************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/observable.js":
/*!********************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/observable.js ***!
  \********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "./kedbackend/js/dist/js/observable/value.js":
/*!***************************************************!*\
  !*** ./kedbackend/js/dist/js/observable/value.js ***!
  \***************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "./kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "./kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "./kedbackend/js/dist/js/observable/collection.js");
/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "./kedbackend/js/dist/js/observable/fiber-context.js");





var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.read = function () {
        var resolved = false, result, err, notify;
        var subscription = this.subscribe(function (value, error, subsciption) {
            resolved = true;
            result = value;
            err = error;
            if (error && notify)
                notify(null, error, subsciption);
            else if (notify)
                notify(value, null, subsciption);
        });
        if (resolved) {
            var currentFiber = _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"].current;
            if (!currentFiber) {
                subscription.unsubscribe();
                throw new Error("Invalid Fiber Context");
            }
            if (err) {
                subscription.unsubscribe();
                throw err;
            }
            var subscriptions = currentFiber.subscriptions, observer = currentFiber.observer;
            subscriptions.push(subscription);
            notify = observer;
            return result;
        }
        throw new Promise(function (resolve, reject) {
            notify = function (value, error, subscription) {
                subscription.unsubscribe();
                if (error)
                    reject(error);
                else
                    resolve(value);
            };
        });
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "./kedbackend/observable.js":
/*!**********************************!*\
  !*** ./kedbackend/observable.js ***!
  \**********************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/observable */ "./kedbackend/js/dist/js/observable/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Value"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Collection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["Emitter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _js_dist_js_observable__WEBPACK_IMPORTED_MODULE_0__["FiberContext"]; });




/***/ }),

/***/ "./kedbackend/repo.js":
/*!****************************!*\
  !*** ./kedbackend/repo.js ***!
  \****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "./kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = [
    "user",
    "role",
    "school",
    "debug",
    "testVersion",
    "testversion",
    "features",
    "schoolType",
    "schooltype"
];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/buttons.tsx":
/*!******************************!*\
  !*** ./src/apis/buttons.tsx ***!
  \******************************/
/*! exports provided: DriveButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DriveButton", function() { return DriveButton; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var IconDrive = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, version: "1.1", xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 508.52 508.52", fill: "#ffffff", style: { verticalAlign: "middle", marginRight: "4px" } },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "484.492,284.58 339.024,32.577 169.496,32.577 314.996,284.58" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "145.437,74.276 0,326.279 84.764,473.05 230.169,221.143" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "234.396,316.363 143.371,475.943 423.756,475.943 508.52,316.36" })));
};
var IconClassroom = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 24 24", version: "1.1" },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("path", { d: "M5 2C3.348 2 2 3.348 2 5v14c0 1.652 1.348 3 3 3h14c1.652 0 3-1.348 3-3V5c0-1.652-1.348-3-3-3zm0 2h14c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1h-1v-2h-5v2H5c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1zm7 2a1.999 1.999 0 1 0 0 4 1.999 1.999 0 1 0 0-4zM7.5 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm9 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 11c-2.66 0-3.5 2.5-3.5 2.5 0-.848.5-1.5.5-1.5-.3-.188-1.07-.313-1.438-.313-1.214 0-2.562 1.192-2.562 2V16h14v-2.313c0-.808-1.512-2-2.563-2-.367 0-1.136.126-1.437.313 0 0 .5.652.5 1.5 0 0-.84-2.5-3.5-2.5z" })));
};
var DriveButton = function (_a) {
    var _b = _a.label, label = _b === void 0 ? 'Google Drive' : _b, action = _a.action;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a", { className: "btn", onClick: action },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(IconDrive, { size: 16 }),
        " ",
        label);
};


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json");
var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json", 1);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/make-suspense-api */ "./src/utils/make-suspense-api.ts");









var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        var _this = this;
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        var isApiMethod = function (m) {
            return typeof _this[m] === 'function' &&
                m !== 'constructor' && // Since makeSuspenseApi() walks prototype chain
                m !== 'privatizingCacheBust' &&
                m !== 'userEmailGetter';
        } // List non-API methods here...
        ;
        Object.keys(EdsClient.prototype).forEach(function (method) {
            if (isApiMethod(method)) {
                _this[method] = avoidSimultanousCalls(_this[method]);
            }
        });
        this.suspense = Object(_utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_7__["makeSuspenseApi"])(this, { isApiMethod: isApiMethod });
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    /**
     * getSchoolTuitionGroups()
     *
     * Return tuitiongroups for school
     *
     * @param schoolName - name of school
     * @param courseCode - Skolverkets code for course
     */
    EdsClient.prototype.getSchoolTuitionGroups = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTuitionGroups", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTuitionGroups];
                }
            });
        });
    };
    /**
     * getTuitionGroupStudents()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     * @param tuitionGroupName - tuition gruop name in EDS
     */
    EdsClient.prototype.getTuitionGroupStudents = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("TuitionGroupStudents", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.tuitionGroupStudents];
                }
            });
        });
    };
    /**
     * getSchoolTeachers()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     */
    EdsClient.prototype.getSchoolTeachers = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTeachers", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTeachers];
                }
            });
        });
    };
    // we assume that the EDS will return the current academic year dates determined by the current date
    EdsClient.prototype.getAcademicYearTerms = function (schoolLocale, date) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var holidays, firstTermMoment, secondTermMoment, startFirstTermDate, startSecondTermDate, endFirstTermDate, endSecondTermDate, firstTerm, secondTerm;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                // mock data
                switch (schoolLocale) {
                    case 'en_sin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.SouthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'en_nin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_5__.NorthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_6___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'sv':
                        {
                            holidays = [];
                            firstTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, true);
                            secondTermMoment = Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_2__["getTermStarEndDate"])(date, false);
                            startFirstTermDate = firstTermMoment[0];
                            startSecondTermDate = secondTermMoment[0];
                            endFirstTermDate = firstTermMoment[1];
                            endSecondTermDate = secondTermMoment[1];
                            firstTerm = { startDate: new Date(startFirstTermDate.year(), startFirstTermDate.month(), startFirstTermDate.date()).toDateString(), endDate: new Date(startFirstTermDate.year(), endFirstTermDate.month(), endFirstTermDate.date()).toDateString() };
                            secondTerm = { startDate: new Date(startSecondTermDate.year(), startSecondTermDate.month(), startSecondTermDate.date()).toDateString(), endDate: new Date(startSecondTermDate.year(), endSecondTermDate.month(), endSecondTermDate.date()).toDateString() };
                            return [2 /*return*/, { firstTerm: firstTerm, secondTerm: secondTerm, holidays: holidays }];
                        }
                }
                return [2 /*return*/];
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_3__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/apis/google-classroom-sync.ts":
/*!*******************************************!*\
  !*** ./src/apis/google-classroom-sync.ts ***!
  \*******************************************/
/*! exports provided: ClassroomSync */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClassroomSync", function() { return ClassroomSync; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _google_webclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-webclient */ "./src/apis/google-webclient.ts");
/* harmony import */ var _mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mock/mock-classroom-data */ "./src/apis/mock/mock-classroom-data.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");




/**
*
*/
var ClassroomSync = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ClassroomSync, _super);
    function ClassroomSync() {
        return _super.call(this, ['https://www.googleapis.com/auth/drive',
            'https://www.googleapis.com/auth/classroom.courses',
            'https://www.googleapis.com/auth/classroom.profile.photos',
            'https://www.googleapis.com/auth/classroom.profile.emails',
            'https://www.googleapis.com/auth/classroom.rosters',
            'https://www.googleapis.com/auth/classroom.coursework.students',
            'https://www.googleapis.com/auth/script.external_request'
        ]) || this;
    }
    /**
    *
    * @param func function name to call in ClassroomService
    * @param params optional parameters to send to function
    *
    * Calls the relevant funciton in ClassroomService
    * The paramaters must be what is expected in the called function
    * in ClassroomService and can only be basic types: string,
    * number, object or boolean.
    *
    */
    ClassroomSync.prototype.callSync = function (func, params) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        data = params ? {
                            'function': func,
                            'parameters': params
                        } : {
                            'function': func
                        };
                        // using dev-mode right now so we only need to run clasp push on ClassroomService
                        data.devMode = true;
                        return [4 /*yield*/, fetch('https://script.googleapis.com/v1/scripts/M1H0BlTkv983PNVTJjDXjNqXLxmQiBgGz:run?alt=json', {
                                method: 'post',
                                headers: {
                                    'Accept': 'application/json',
                                    'Content-Type': 'application/json',
                                    'Authorization': 'Bearer ' + this.authToken
                                },
                                body: JSON.stringify(data)
                            }).then(function (resp) { return resp.json(); })];
                    case 2: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
    *
    * @param param0
    */
    ClassroomSync.prototype.initSync = function (course, origCourse, fullSyncNeeded) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_1, _a, e_2, _b, emptyOrMock, _c, _d, group, data, edsSchoolNameGymn, edsStudents, _e, _f, group, tuitionGroupStudents, e_2_1, _g, subset, changes, action;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_h) {
                switch (_h.label) {
                    case 0:
                        emptyOrMock = {};
                        if (course.school === 'KED') {
                            try {
                                for (_c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](course.studyGroups), _d = _c.next(); !_d.done; _d = _c.next()) {
                                    group = _d.value;
                                    emptyOrMock[group] = _mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_2__["mockTuitionStudents"][group] ? _mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_2__["mockTuitionStudents"][group].map(function (s) { return s.studentEmailAddress; }) : [];
                                }
                            }
                            catch (e_1_1) { e_1 = { error: e_1_1 }; }
                            finally {
                                try {
                                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                                }
                                finally { if (e_1) throw e_1.error; }
                            }
                        }
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].kedBackendClient.http.get('schools', { 'cacheBust': 'static', 'name': course.school }).then(function (resp) { return resp.json(); })];
                    case 1:
                        data = _h.sent();
                        edsSchoolNameGymn = data[0].edsSchoolNameGymn;
                        edsStudents = edsSchoolNameGymn ? {} : emptyOrMock;
                        if (!course.studyGroups) return [3 /*break*/, 9];
                        if (!edsSchoolNameGymn) return [3 /*break*/, 9];
                        _h.label = 2;
                    case 2:
                        _h.trys.push([2, 7, 8, 9]);
                        _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](course.studyGroups), _f = _e.next();
                        _h.label = 3;
                    case 3:
                        if (!!_f.done) return [3 /*break*/, 6];
                        group = _f.value;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].edsClient.getTuitionGroupStudents({ schoolName: edsSchoolNameGymn, tuitionGroupName: group })];
                    case 4:
                        tuitionGroupStudents = _h.sent();
                        edsStudents[group] = tuitionGroupStudents.map(function (s) { return s.studentEmailAddress; });
                        _h.label = 5;
                    case 5:
                        _f = _e.next();
                        return [3 /*break*/, 3];
                    case 6: return [3 /*break*/, 9];
                    case 7:
                        e_2_1 = _h.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 9];
                    case 8:
                        try {
                            if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                        }
                        finally { if (e_2) throw e_2.error; }
                        return [7 /*endfinally*/];
                    case 9:
                        _g = this.diffCourse(course, origCourse, fullSyncNeeded), subset = _g.subset, changes = _g.changes, action = _g.action;
                        // send the changes to classroom-service with {id, school code} to update classrooms
                        // should we send the users from the groups or should classroom-service get these from EDS?
                        // if we handle users in kedcomponents a check if there are changes should probably be made?
                        console.log(subset);
                        console.log(changes);
                        console.log(edsStudents);
                        if (action == 'full') {
                            return [2 /*return*/, this.createClassroom(subset, edsStudents)];
                        }
                        else if (action == 'update') {
                            return [2 /*return*/, this.updateClassroom(subset, changes, edsStudents)];
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    ClassroomSync.prototype.archive = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                console.log('archiving');
                this.callSync('archive', [course.id, course.studyGroups]);
                return [2 /*return*/];
            });
        });
    };
    /**
    *
    * @param course current course state
    * @param origCourse previous course state
    *
    * Creates a subset of course and maakes a diff against previous course state
    * Note: there are probably more we could filter out before sending to ClasasroomService
    */
    ClassroomSync.prototype.diffCourse = function (course, origCourse, fullSyncNeeded) {
        // Filter out assignments from tasks and subset to only properties we are interested in
        var subsetAssignments = function (tasks) {
            var assignments = tasks.filter(function (t) { return t.assignment === true; });
            return assignments.map(function (t) {
                var assignment = t.assignment, deadline = t.deadline, id = t.id, name = t.name;
                return { assignment: assignment, deadline: deadline, id: id, name: name };
            });
        };
        // Calculates whats been added and removed betweens changes to an array.
        // Note: Perhaps we should return false if no changes?
        var diffArrays = fullSyncNeeded ? null : function (arr1, arr2) {
            var arr1set = new Set(arr1);
            var arr2set = new Set(arr2);
            var changes = {
                added: arr2.filter(function (x) { return !arr1set.has(x); }),
                removed: arr1.filter(function (x) { return !arr2set.has(x); }),
            };
            return (changes.added.length > 0 || changes.removed.length > 0) ? changes : false;
        };
        // create the subset of course
        var subset = (function (_a) {
            var id = _a.id, school = _a.school, code = _a.code, name = _a.name, description = _a.description, tasks = _a.tasks, responsibleTeachers = _a.responsibleTeachers, studyGroups = _a.studyGroups;
            return ({
                id: id,
                school: school,
                code: code,
                name: name,
                description: description,
                tasks: tasks,
                responsibleTeachers: responsibleTeachers,
                studyGroups: studyGroups
            });
        })(course);
        // only handle tsaks that are aassignments
        subset.tasks = subsetAssignments(subset.tasks);
        if (fullSyncNeeded) {
            console.log('Classroom switched on so sync everything');
            // Send subset to classroom-service to create the classrooms
            return { subset: subset, changes: {}, action: "full" };
        }
        else {
            console.log('Data has been updated so calculate and sync changes');
            var changes = {
                name: (origCourse.name !== course.name) ? course.name : false,
                description: (origCourse.description !== course.description) ? course.description : false,
                tasks: diffArrays(subsetAssignments(origCourse.tasks), subset.tasks),
                responsibleTeachers: diffArrays(origCourse.responsibleTeachers.map(function (t) { return t.url; }), course.responsibleTeachers.map(function (t) { return t.url; })),
                studyGroups: origCourse.studyGroups ? diffArrays(origCourse.studyGroups, course.studyGroups) : false,
            };
            return { subset: subset, changes: changes, action: "update" };
        }
    };
    ClassroomSync.prototype.createClassroom = function (course, studyGroups) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, this.callSync('createClassrooms', [course, studyGroups])];
            });
        });
    };
    ClassroomSync.prototype.updateClassroom = function (course, changes, studyGroups) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, this.callSync('updateClassrooms', [course, changes, studyGroups])];
            });
        });
    };
    return ClassroomSync;
}(_google_webclient__WEBPACK_IMPORTED_MODULE_1__["GoogleWebClient"]));



/***/ }),

/***/ "./src/apis/google-picker.ts":
/*!***********************************!*\
  !*** ./src/apis/google-picker.ts ***!
  \***********************************/
/*! exports provided: GooglePicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GooglePicker", function() { return GooglePicker; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _google_webclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./google-webclient */ "./src/apis/google-webclient.ts");


/**
 * GooglePicker
 * Includes the initiation of the correct api:s.
 * Certain options can be passed to the constructor
 * and there could be others worth incorporating (i.e. Team Drive-support).
 *
 * Right now two options are handled:
 * - upload: if a user can upload to Drive in the Google Drive Picker
 * - multiple: if a user can select multiple files
 *
 * We could probably split this into google-picker and google-drive where google-drive
 * handles the explicit calls to the google drive api.
 */
var GooglePicker = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GooglePicker, _super);
    function GooglePicker(options) {
        var _this = _super.call(this, ['https://www.googleapis.com/auth/drive']) || this;
        _this.options = options || { upload: false, multiple: false };
        return _this;
    }
    /**
     * show()
     *
     * If a single file is requested from the picker a list of files with one element is returned.
     * It is up to the caller to handle the list in a relevant manner.
     *
     * More data from the file could be extracted if it is deemed necessary.
     *
     */
    GooglePicker.prototype.show = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, new Promise(function (resolve, reject) {
                                var callback = function (response) {
                                    if (response['action'] == google.picker.Action.CANCEL) {
                                        reject();
                                    }
                                    else if (response['action'] == google.picker.Action.PICKED) {
                                        var selected_1 = [];
                                        response.docs.forEach(function (doc) {
                                            var fileId = doc.id, mimeType = doc.mimeType, name = doc.name, modifiedTime = doc.modifiedTime, iconUrl = doc.iconUrl, url = doc.url;
                                            var canExport = mimeType.includes('google-apps');
                                            selected_1.push({ fileId: fileId, mimeType: mimeType, name: name, modifiedTime: modifiedTime, canExport: canExport, iconUrl: iconUrl, url: url });
                                            // update permissions to read by all in domain
                                            _this.updatePermissions(fileId);
                                        });
                                        console.log(selected_1);
                                        resolve(selected_1);
                                    }
                                };
                                var pickerbuilder = new google.picker.PickerBuilder()
                                    .addView(new google.picker.DocsView()
                                    .setOwnedByMe(true) // should this be an option?
                                    .setIncludeFolders(true))
                                    .setLocale("sv") // should this be an option?
                                    .setSize(1051, 650) // should this be an option?
                                    .setOAuthToken(_this.authToken) // temp
                                    .setCallback(callback);
                                if (_this.options.upload) {
                                    pickerbuilder.addView(new google.picker.DocsUploadView().setIncludeFolders(true));
                                }
                                if (_this.options.multiple) {
                                    pickerbuilder.enableFeature(google.picker.Feature.MULTISELECT_ENABLED);
                                }
                                _this.picker = pickerbuilder.build();
                                _this.picker.setVisible(true);
                            })];
                }
            });
        });
    };
    /**
     * updatePermissions()
     *
     * @param fileId
     *
     * Make the file accessible to all in the domain. Should be unnecessary but some
     * teachers have changed their default permissions.
     * We don't care right now if this fails because this is just an extra precaution.
     * If we plan on using this on other domains the domain-attribute needs to be dynamic.
     *
     */
    GooglePicker.prototype.updatePermissions = function (fileId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]
                        })];
                    case 1:
                        _a.sent();
                        gapi.client.drive.permissions.create({
                            fileId: fileId,
                            sendNotificationEmail: false,
                            role: 'reader',
                            type: 'domain',
                            domain: 'kunskapsskolan.se'
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * downloadFile()
     * @param file
     *
     * When Classroom has been integrated we will want to handle only the fileId:s
     * so that editing capabilities are peserved on the file (if it is a google-apps file)
     * Right now google-apps files are converted to pdf and passed into the current flow.
     *
     * TODO: error handling
     */
    GooglePicker.prototype.downloadFile = function (_a) {
        var file = _a.file, limitSize = _a.limitSize;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var xhrDownload_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: 
                    // A file that can be exported to PDF is retreived with
                    // file.export() from Drive, converted to a blob and then
                    // to a File.
                    // A file that can not be exported to PDF is retrieved
                    // through XHR and converted to a File.
                    // If we don't need to handle the physical files on the client
                    // we could save only the fileId:s and display filename and mimeType
                    // for the file in our listings. When/if we use Google Classroom for
                    // our task-handling that would be the preferred approach to keep
                    // the file as an editable Google file
                    // Init the drive-api (only needed for download so not loaded initially)
                    return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]
                        })];
                    case 1:
                        // A file that can be exported to PDF is retreived with
                        // file.export() from Drive, converted to a blob and then
                        // to a File.
                        // A file that can not be exported to PDF is retrieved
                        // through XHR and converted to a File.
                        // If we don't need to handle the physical files on the client
                        // we could save only the fileId:s and display filename and mimeType
                        // for the file in our listings. When/if we use Google Classroom for
                        // our task-handling that would be the preferred approach to keep
                        // the file as an editable Google file
                        // Init the drive-api (only needed for download so not loaded initially)
                        _b.sent();
                        if (file.canExport) {
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    gapi.client.drive.files.export({
                                        fileId: file.fileId,
                                        mimeType: 'application/pdf'
                                    }).then(function (resp) {
                                        var len = resp.body.length;
                                        var data = new Uint8Array(new ArrayBuffer(len));
                                        for (var i = 0; i < len; i++) {
                                            data[i] = resp.body.charCodeAt(i);
                                        }
                                        var blob = new Blob([data], { type: 'application/pdf' });
                                        var filename = file.name + '.pdf';
                                        resolve(new File([blob], filename, { type: 'application/pdf', lastModified: file.modifiedTime }));
                                    });
                                })];
                        }
                        else {
                            xhrDownload_1 = function (file) {
                                return new Promise(function (resolve, reject) {
                                    var xhr = new XMLHttpRequest();
                                    xhr.open("GET", "https://www.googleapis.com/drive/v3/files/" + file.fileId + '?alt=media', true);
                                    xhr.setRequestHeader('Authorization', 'Bearer ' + _this.authToken);
                                    xhr.responseType = 'blob';
                                    xhr.onload = function () {
                                        resolve(new File([xhr.response], file.name, { type: file.mimeType, lastModified: file.modifiedTime }));
                                    };
                                    xhr.send();
                                });
                            };
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    if (limitSize !== undefined) {
                                        gapi.client.drive.files.get({
                                            fileId: file.fileId,
                                            fields: 'size'
                                        }).then(function (resp) {
                                            var size = Number(resp.result.size);
                                            if (size > limitSize * 1024 * 1024) {
                                                reject('GooglePickerError: Filsize is too laarge');
                                            }
                                        }).then(function () {
                                            xhrDownload_1(file).then(function (resp) {
                                                resolve(resp);
                                            });
                                        });
                                    }
                                    else {
                                        xhrDownload_1(file).then(function (resp) {
                                            resolve(resp);
                                        });
                                    }
                                })];
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    return GooglePicker;
}(_google_webclient__WEBPACK_IMPORTED_MODULE_1__["GoogleWebClient"]));



/***/ }),

/***/ "./src/apis/google-webclient.ts":
/*!**************************************!*\
  !*** ./src/apis/google-webclient.ts ***!
  \**************************************/
/*! exports provided: GoogleWebClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoogleWebClient", function() { return GoogleWebClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


var GoogleWebClient = /** @class */ (function () {
    function GoogleWebClient(scopes) {
        var _a;
        this.scopes = ['https://www.googleapis.com/auth/userinfo.email', 'https://www.googleapis.com/auth/userinfo.profile'];
        (_a = this.scopes).push.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](scopes));
    }
    GoogleWebClient.prototype.ensureInited = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var CLIENT_ID, SCOPES;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(typeof gapi === "undefined")) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadGapi()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        CLIENT_ID = "421572262269-u68v5lf5o8ss5t68l8gkq3pfarh6dbkv.apps.googleusercontent.com";
                        SCOPES = this.scopes.join(' ');
                        return [4 /*yield*/, new Promise(function (resolve, reject) {
                                gapi.load("client:auth2", function () {
                                    // Calls authorize without prompting the user. If authorization hasn't been given by
                                    // the user an error is returned and we call authorize again with consent-screen
                                    var reauthorize = false;
                                    console.log('loading client:auth2');
                                    return gapi.auth2.authorize({
                                        client_id: CLIENT_ID,
                                        scope: SCOPES,
                                        response_type: 'permission',
                                        login_hint: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.mail,
                                        prompt: 'none'
                                    }, function (resp) {
                                        console.log(resp);
                                        if (resp.error) {
                                            // no consent given so reauthorize
                                            reauthorize = true;
                                        }
                                        else {
                                            // check if we have all the scopes we want
                                            var scopeset_1 = new Set(resp.scope.split(' '));
                                            var missingScopes = _this.scopes.filter(function (x) { return !scopeset_1.has(x); });
                                            if (missingScopes.length > 0) {
                                                console.log('missing scopes');
                                                // scopes are missing from our consent so reauthorize
                                                reauthorize = true;
                                            }
                                            else {
                                                // everything seems to be ok so store our token
                                                _this.authToken = resp.access_token;
                                                resolve();
                                            }
                                        }
                                        if (reauthorize) {
                                            console.log('reauthorize');
                                            return gapi.auth2.authorize({
                                                client_id: CLIENT_ID,
                                                scope: SCOPES,
                                                response_type: 'permission',
                                                login_hint: _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser.mail,
                                                prompt: 'consent'
                                            }, function (resp) {
                                                console.log(resp);
                                                if (resp.error) {
                                                    // something is still wrong so throw an error
                                                    reject('Google Web Client: No access token');
                                                }
                                                else {
                                                    // we now have a token (hopefully with the right scopes)
                                                    // should we check again?
                                                    _this.authToken = resp.access_token;
                                                    resolve();
                                                }
                                            });
                                        }
                                    });
                                });
                            })];
                    case 3:
                        _a.sent();
                        if (!(typeof google === "undefined" || typeof google.picker === "undefined")) return [3 /*break*/, 5];
                        return [4 /*yield*/, new Promise(function (resolve) {
                                gapi.load("picker", function () { resolve(); });
                            })];
                    case 4:
                        _a.sent();
                        _a.label = 5;
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    GoogleWebClient.prototype.loadGapi = function () {
        return new Promise(function (resolve, reject) {
            if (typeof gapi !== "undefined")
                return resolve();
            var script = document.createElement("script");
            script.src = "https://apis.google.com/js/client.js?onload=gaapi_loaded";
            document.getElementsByTagName("head")[0].appendChild(script);
            window.gaapi_loaded = resolve;
        });
    };
    return GoogleWebClient;
}());



/***/ }),

/***/ "./src/apis/mock/mock-classroom-data.ts":
/*!**********************************************!*\
  !*** ./src/apis/mock/mock-classroom-data.ts ***!
  \**********************************************/
/*! exports provided: mockTeachers, mockTuitionGroups, mockTuitionStudents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mockTeachers", function() { return mockTeachers; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mockTuitionGroups", function() { return mockTuitionGroups; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mockTuitionStudents", function() { return mockTuitionStudents; });
var mockTeachers = [
    {
        schoolName: 'KED',
        teacherFirstName: 'Teacher 1',
        teacherLastName: 'Classroom',
        teacherEmailAddress: 'teacher1.classroom@kedschools.com'
    },
    {
        schoolName: 'KED',
        teacherFirstName: 'Teacher 2',
        teacherLastName: 'Classroom',
        teacherEmailAddress: 'teacher2.classroom@kedschools.com'
    },
    {
        schoolName: 'KED',
        teacherFirstName: 'Teacher 3',
        teacherLastName: 'Classroom',
        teacherEmailAddress: 'teacher3.classroom@kedschools.com'
    },
    {
        schoolName: 'KED',
        teacherFirstName: 'Carl',
        teacherLastName: 'Holmberg',
        teacherEmailAddress: 'carl@kedschools.com'
    },
    {
        schoolName: 'KED',
        teacherFirstName: 'David',
        teacherLastName: 'Fahlander',
        teacherEmailAddress: 'david.fahlander@kedschools.com'
    },
    {
        schoolName: 'KED',
        teacherFirstName: 'Andrei',
        teacherLastName: 'Spatarelu',
        teacherEmailAddress: 'andrei.spatarelu@kedschools.com'
    }
];
var mockTuitionGroups = {
    'DJUDJH0': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr1 (180816-190614)',
            courseCode: 'DJUDJH0'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr2 (180816-190614)',
            courseCode: 'DJUDJH0'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr3 (180816-190614)',
            courseCode: 'DJUDJH0'
        }
    ],
    'KEMKEM01': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr1 (180816-190614)',
            courseCode: 'KEMKEM01'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr2 (180816-190614)',
            courseCode: 'KEMKEM01'
        }
    ],
    'BIOBIO01': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr1 (180816-190614)',
            courseCode: 'BIOBIO01'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr2 (180816-190614)',
            courseCode: 'BIOBIO01'
        }
    ]
};
var mockTuitionStudents = {
    'IDR1_Gr1 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr1 (180816-190614)',
            studentFirstName: 'Student 1',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student1.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr1 (180816-190614)',
            studentFirstName: 'Student 2',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student2.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr1 (180816-190614)',
            studentFirstName: 'Student 3',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student3.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr1 (180816-190614)',
            studentFirstName: 'Student 4',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student4.classroom@kedschools.com'
        }
    ],
    'IDR1_Gr2 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr2 (180816-190614)',
            studentFirstName: 'Student 5',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student5.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr2 (180816-190614)',
            studentFirstName: 'Student 6',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student6.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr2 (180816-190614)',
            studentFirstName: 'Student 7',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student7.classroom@kedschools.com'
        }
    ],
    'IDR1_Gr3 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr3 (180816-190614)',
            studentFirstName: 'Student 8',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student8.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr3 (180816-190614)',
            studentFirstName: 'Student 9',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student9.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'IDR1_Gr3 (180816-190614)',
            studentFirstName: 'Student 10',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student10.classroom@kedschools.com'
        }
    ],
    'KEM1_Gr1 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr1 (180816-190614)',
            studentFirstName: 'Student 2',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student2.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr1 (180816-190614)',
            studentFirstName: 'Student 3',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student3.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr1 (180816-190614)',
            studentFirstName: 'Student 8',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student8.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr1 (180816-190614)',
            studentFirstName: 'Student 9',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student9.classroom@kedschools.com'
        }
    ],
    'KEM1_Gr2 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr2 (180816-190614)',
            studentFirstName: 'Student 1',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student1.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr2 (180816-190614)',
            studentFirstName: 'Student 5',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student5.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'KEM1_Gr2 (180816-190614)',
            studentFirstName: 'Student 6',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student6.classroom@kedschools.com'
        }
    ],
    'BIO1_Gr1 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr1 (180816-190614)',
            studentFirstName: 'Student 1',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student1.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr1 (180816-190614)',
            studentFirstName: 'Student 4',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student4.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr1 (180816-190614)',
            studentFirstName: 'Student 6',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student6.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr1 (180816-190614)',
            studentFirstName: 'Student 10',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student10.classroom@kedschools.com'
        }
    ],
    'BIO1_Gr2 (180816-190614)': [
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr2 (180816-190614)',
            studentFirstName: 'Student 2',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student2.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr2 (180816-190614)',
            studentFirstName: 'Student 7',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student7.classroom@kedschools.com'
        },
        {
            schoolName: 'KED',
            tuitionGroupName: 'BIO1_Gr2 (180816-190614)',
            studentFirstName: 'Student 8',
            studentLastName: 'Classroom',
            studentEmailAddress: 'student8.classroom@kedschools.com'
        },
    ]
};


/***/ }),

/***/ "./src/apis/mock/mock-eds-data.json":
/*!******************************************!*\
  !*** ./src/apis/mock/mock-eds-data.json ***!
  \******************************************/
/*! exports provided: SouthIndia, NorthIndia, default */
/***/ (function(module) {

module.exports = {"SouthIndia":[{"firstTerm":{"startDate":"2015-06-01T00:00:00.000Z","endDate":"2015-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2015-11-01T00:00:00.000Z","endDate":"2016-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-06-23T00:00:00.000Z","endDate":"2016-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2016-11-01T00:00:00.000Z","endDate":"2017-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-06-05T00:00:00.000Z","endDate":"2017-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2017-11-01T00:00:00.000Z","endDate":"2018-03-30T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2018-06-04T00:00:00.000Z","endDate":"2018-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2018-11-01T00:00:00.000Z","endDate":"2019-04-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2019-06-03T00:00:00.000Z","endDate":"2019-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2019-11-01T00:00:00.000Z","endDate":"2020-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-06-01T00:00:00.000Z","endDate":"2020-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2020-11-01T00:00:00.000Z","endDate":"2021-03-26T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-06-06T00:00:00.000Z","endDate":"2021-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2021-11-01T00:00:00.000Z","endDate":"2022-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-06-05T00:00:00.000Z","endDate":"2022-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2022-11-01T00:00:00.000Z","endDate":"2023-03-31T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-06-04T00:00:00.000Z","endDate":"2023-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2023-11-01T00:00:00.000Z","endDate":"2024-03-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2024-06-03T00:00:00.000Z","endDate":"2024-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2024-11-01T00:00:00.000Z","endDate":"2025-03-28T00:00:00.000Z"},"holidays":[]}],"NorthIndia":[{"firstTerm":{"startDate":"2024-04-03T00:00:00.000Z","endDate":"2024-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2024-10-01T00:00:00.000Z","endDate":"2025-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-04-05T00:00:00.000Z","endDate":"2023-10-01T00:00:00.000Z"},"secondTerm":{"startDate":"2023-10-02T00:00:00.000Z","endDate":"2024-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-04-06T00:00:00.000Z","endDate":"2022-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2022-10-04T00:00:00.000Z","endDate":"2023-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-04-01T00:00:00.000Z","endDate":"2021-10-04T00:00:00.000Z"},"secondTerm":{"startDate":"2021-10-05T00:00:00.000Z","endDate":"2022-04-05T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-04-01T00:00:00.000Z","endDate":"2020-09-28T00:00:00.000Z"},"secondTerm":{"startDate":"2020-09-29T00:00:00.000Z","endDate":"2021-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2020-05-17","endDate":"2020-06-28"}]},{"firstTerm":{"startDate":"2019-04-04T00:00:00.000Z","endDate":"2019-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2019-10-01T00:00:00.000Z","endDate":"2020-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2019-05-19","endDate":"2019-06-29"}]},{"firstTerm":{"startDate":"2018-04-04T00:00:00.000Z","endDate":"2018-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2018-10-01T00:00:00.000Z","endDate":"2019-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-04-05T00:00:00.000Z","endDate":"2017-10-02T00:00:00.000Z"},"secondTerm":{"startDate":"2017-10-03T00:00:00.000Z","endDate":"2018-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-04-06T00:00:00.000Z","endDate":"2016-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2016-10-04T00:00:00.000Z","endDate":"2017-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2015-04-01T00:00:00.000Z","endDate":"2015-10-05T00:00:00.000Z"},"secondTerm":{"startDate":"2015-10-06T00:00:00.000Z","endDate":"2016-04-05T00:00:00.000Z"},"holidays":[]}]};

/***/ }),

/***/ "./src/components/charts/goal-progress.tsx":
/*!*************************************************!*\
  !*** ./src/components/charts/goal-progress.tsx ***!
  \*************************************************/
/*! exports provided: GoalProgress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoalProgress", function() { return GoalProgress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var GoalProgress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoalProgress, _super);
    function GoalProgress() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.createProgress = function () {
            var _a = _this.props, numberOfTasks = _a.numberOfTasks, completedNumberOfTasks = _a.completedNumberOfTasks, maximumTasksDisplayed = _a.maximumTasksDisplayed, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
            var progress = [];
            if (numberOfTasks > maximumTasksDisplayed) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progress-overview" },
                    " ",
                    completedNumberOfTasks,
                    " / ",
                    numberOfTasks,
                    " ");
            }
            for (var taskNo = 1; taskNo <= numberOfTasks; taskNo++) {
                progress.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { key: taskNo },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", fill: taskNo > completedNumberOfTasks ? backgroundColor : progressColor, cx: "8", cy: "8", r: "8" })));
            }
            return progress;
        };
        return _this;
    }
    GoalProgress.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "goals-progress" }, this.createProgress());
    };
    GoalProgress.defaultProps = {
        numberofTasks: 0,
        completedNumberOfTasks: 0,
        maximumTasksDisplayed: 10,
        backgroundColor: "lightgrey",
        progressColor: "#3dbca2",
    };
    return GoalProgress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder-ks/logic/ordered-requirements.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/ordered-requirements.ts ***!
  \************************************************************************/
/*! exports provided: getOrderedDocs, resolveRequirementOrder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getOrderedDocs", function() { return getOrderedDocs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "resolveRequirementOrder", function() { return resolveRequirementOrder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




function getOrderedDocs(docs, order, _a) {
    var appendLeftovers = (_a === void 0 ? { appendLeftovers: false } : _a).appendLeftovers;
    // Mark doc IDs that where present in given 'order' array.
    // Will be used to find left-overs that were not present in the 'order' array.
    var markedDocs = {};
    if (!docs || !order) {
        // Special case: no docs or no order. Don't fail. Just return docs as is.
        return docs;
    }
    // Map given 'order' array to corresponding docs. Also mark in markedDocs.
    var result = (docs && order ?
        order.map(function (id) {
            markedDocs[id] = true;
            return docs.find(function (doc) { return doc.id === id; });
        }).filter(function (doc) { return !!doc; }) :
        docs);
    if (appendLeftovers) {
        // If any leftovers are there, concat them at the end:
        var leftOvers = docs.filter(function (doc) { return !markedDocs[doc.id]; });
        return result.concat(leftOvers);
    }
    else {
        return result;
    }
}
function resolveRequirementOrder(obj, orderDefiner) {
    var _a;
    var orderDefiningDocObservable;
    if (orderDefiner) {
        // User provided the orderDefining doc (use case is when obj is a Course or Subject, which contains its order by itself. User then provides the Course or Subject in both args)
        orderDefiningDocObservable = new kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["Emitter"]([orderDefiner]);
    }
    else {
        var courseCodes = obj.tags.filter(function (tag) { return tag.startsWith("course:"); });
        if (courseCodes.length === 0) {
            return new kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["Emitter"](obj); // No course tags. Not possible to resolve order.
        }
        orderDefiningDocObservable = (_a = _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].courses).tags.apply(_a, tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](courseCodes)).toValue();
    }
    return orderDefiningDocObservable.map(function (orderHolders) {
        var abilitiesOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.abilitiesOrder || []; }));
        var ccOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.centralContentOrder || []; }));
        var krOrder = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(orderHolders.map(function (orderHolder) { return orderHolder.knowledgeRequirementsOrder || []; }));
        var objClone = Object.assign({}, obj);
        if (objClone.abilities)
            objClone.abilities = getOrderedDocs(obj.abilities, abilitiesOrder);
        if (objClone.centralContent)
            objClone.centralContent = getOrderedDocs(obj.centralContent, ccOrder);
        if (objClone.knowledgeRequirements)
            objClone.knowledgeRequirements = getOrderedDocs(obj.knowledgeRequirements, krOrder);
        return objClone;
    });
}


/***/ }),

/***/ "./src/components/course-builder-ks/logic/task-order.ts":
/*!**************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/task-order.ts ***!
  \**************************************************************/
/*! exports provided: getSortedTasks, computeUpdatedOrder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSortedTasks", function() { return getSortedTasks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computeUpdatedOrder", function() { return computeUpdatedOrder; });
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _ordered_requirements__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ordered-requirements */ "./src/components/course-builder-ks/logic/ordered-requirements.ts");


function getSortedTasks(content) {
    return Object(_ordered_requirements__WEBPACK_IMPORTED_MODULE_1__["getOrderedDocs"])(content.tasks, content.taskOrder, { appendLeftovers: true });
}
function computeUpdatedOrder(docs, currentOrder, source, target, placement, _a) {
    var appendLeftovers = (_a === void 0 ? { appendLeftovers: false } : _a).appendLeftovers;
    var orderedIds = Object(_ordered_requirements__WEBPACK_IMPORTED_MODULE_1__["getOrderedDocs"])(docs, currentOrder, { appendLeftovers: true }).map(function (t) { return t.id; });
    var placeBefore = placement === 'before';
    var result = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_0__["flatten"])(orderedIds
        .filter(function (id) { return id !== source.id; }) // Remove source id
        .map(function (id) { return id !== target.id ?
        // We're not on target
        id :
        // We're on target. Place before or after?
        placeBefore ?
            [source.id, id] :
            [id, source.id]; }));
    return result;
}


/***/ }),

/***/ "./src/components/course-builder/courses/business-logic.ts":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/business-logic.ts ***!
  \*****************************************************************/
/*! exports provided: getUncoveredKnowledgeRequirements, getIdsNotCoveredByTasks, getIdsNotCoveredByReqReferencingDocs, sanityCheck, getTasksPerId, getSoftAccessList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUncoveredKnowledgeRequirements", function() { return getUncoveredKnowledgeRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByTasks", function() { return getIdsNotCoveredByTasks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByReqReferencingDocs", function() { return getIdsNotCoveredByReqReferencingDocs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sanityCheck", function() { return sanityCheck; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTasksPerId", function() { return getTasksPerId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSoftAccessList", function() { return getSoftAccessList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");



function getUncoveredKnowledgeRequirements(course) {
    var uncoveredRequirements = course.knowledgeRequirements.reduce(function (result, item) {
        result[item.id] = item;
        return result;
    }, {});
    course.tasks.forEach(function (task) {
        task.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredRequirements[kr.id];
        });
    });
    return Object.keys(uncoveredRequirements).map(function (id) { return uncoveredRequirements[id]; });
}
function getIdsNotCoveredByTasks(course) {
    return getIdsNotCoveredByReqReferencingDocs([course], course.tasks);
}
function getIdsNotCoveredByReqReferencingDocs(templates, docsBeingChecked) {
    var uncoveredIds = {};
    // 1. Mark the ids of all knowledge requirements, abilities and central content for this course:
    templates.forEach(function (course) {
        course.knowledgeRequirements.forEach(function (r) {
            uncoveredIds[r.id] = true;
        });
        course.abilities.forEach(function (a) {
            uncoveredIds[a.id] = true;
        });
        course.centralContent.forEach(function (cc) {
            uncoveredIds[cc.id] = true;
        });
    });
    // 2. List all tasks and unmark all ids that they refer to
    docsBeingChecked.forEach(function (doc) {
        doc.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredIds[kr.id];
        });
        doc.abilities.forEach(function (a) {
            delete uncoveredIds[a.id];
        });
        doc.centralContent.forEach(function (cc) {
            delete uncoveredIds[cc.id];
        });
    });
    return uncoveredIds;
}
function sanityCheck(course) {
    function hasDuplicateTasks(course) {
        var taskIds = {};
        return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])(course.modules.map(function (module) { return module.taskIds.map(function (taskId) {
            if (taskIds[taskId]) {
                var task = course.tasks.find(function (t) { return t.id === taskId; });
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""], ["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""])), task.name);
            }
            taskIds[taskId] = true;
        }).filter(function (x) { return x; }); }));
    }
    function tasksWithSameUrl(course) {
        var taskUrls = {};
        return course.tasks.map(function (task) {
            if (task.url) {
                if (taskUrls[task.url]) {
                    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""], ["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""])), taskUrls[task.url].name, task.name);
                }
                taskUrls[task.url] = task;
            }
        }).filter(function (x) { return x; });
    }
    function hasEmptyModuleNames(course) {
        return course.modules.some(function (module) { return module.name === ""; }) && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Det finns minst en modul utan angivet namn"], ["Det finns minst en modul utan angivet namn"])));
    }
    function hasDuplicateModuleNames(course) {
        var moduleNames = {};
        return course.modules.map(function (module) {
            if (module.name && moduleNames[module.name]) {
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"], ["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"])), module.name);
            }
            if (module.name)
                moduleNames[module.name] = true;
        });
    }
    var checks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])([
        hasDuplicateTasks(course),
        tasksWithSameUrl(course),
        hasEmptyModuleNames(course),
        hasDuplicateModuleNames(course)
    ]);
    return checks.filter(function (result) { return result; });
}
function getTasksPerId(course) {
    var result = {};
    function add(id, task) {
        var list = result[id] || (result[id] = []);
        list.push(task);
    }
    course.tasks.forEach(function (task) {
        task.abilities.forEach(function (a) { return add(a.id, task); });
        task.centralContent.forEach(function (c) { return add(c.id, task); });
        task.futureAbilities.forEach(function (fa) { return add(fa, task); });
    });
    return result;
}
/** Returns an access list for a course in a backward compatible way */
function getSoftAccessList(course) {
    var responsibleTeachers = course.responsibleTeachers;
    var result = responsibleTeachers.map(function (da) { return ({
        name: da.name,
        email: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getEmailFromDocAccess"])(da),
        access: da.access || 'edit'
    }); });
    return result;
}
var templateObject_1, templateObject_2, templateObject_3, templateObject_4;


/***/ }),

/***/ "./src/components/course-builder/courses/course-banner.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/course-banner.tsx ***!
  \*****************************************************************/
/*! exports provided: setCourseImage, CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setCourseImage", function() { return setCourseImage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");







var AdminMenuItems = [
    { name: "schools", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolor"], ["Skolor"]))), route: "/schools" },
    { name: "subjects", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnen"], ["\u00C4mnen"]))), route: "/subjects" },
];
var NonAdminMenuItems = [
    { name: "courseBuilder", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursbyggaren"], ["Kursbyggaren"]))), route: "/courses/new" },
    { name: "studentPage", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Elevsida"], ["Elevsida"]))), route: "" },
    { name: "feedback", text: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-commenting-o", "aria-hidden": "true" }),
            " Feedback"), route: "https://kg.kunskapsporten.se/kursbyggaren/" }
];
function onDropImage(ev, host, course, origCourse) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var files, url, items, file, form, res, _loop_1, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    ev.stopPropagation();
                    ev.preventDefault();
                    files = ev.dataTransfer.files;
                    url = null;
                    items = Array.from(ev.dataTransfer.items);
                    if (!(files.length > 0)) return [3 /*break*/, 3];
                    file = files[0];
                    if (file.size > 2 * 1024 * 1024) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"], ["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"]))));
                        return [2 /*return*/];
                    }
                    form = new FormData();
                    form.append("files", file);
                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.http.fetch('web-upload', 'put', {}, {}, {
                            body: form
                        })];
                case 1:
                    res = _a.sent();
                    if (res.status !== 200) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda upp filen till Google Storage"], ["Kunde inte ladda upp filen till Google Storage"]))));
                        return [2 /*return*/];
                    }
                    return [4 /*yield*/, res.text()];
                case 2:
                    url = _a.sent();
                    return [3 /*break*/, 7];
                case 3:
                    _loop_1 = function (i) {
                        var item;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    item = items[i];
                                    if (!item.type.match('^text/uri-list')) return [3 /*break*/, 2];
                                    return [4 /*yield*/, new Promise(function (resolve) { return item.getAsString(resolve); })];
                                case 1:
                                    // URI
                                    url = _a.sent();
                                    _a.label = 2;
                                case 2: return [2 /*return*/];
                            }
                        });
                    };
                    i = 0;
                    _a.label = 4;
                case 4:
                    if (!(i < items.length)) return [3 /*break*/, 7];
                    return [5 /*yield**/, _loop_1(i)];
                case 5:
                    _a.sent();
                    _a.label = 6;
                case 6:
                    ++i;
                    return [3 /*break*/, 4];
                case 7:
                    if (url == null) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"], ["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"]))));
                        return [2 /*return*/];
                    }
                    setCourseImage(course, origCourse, host, url);
                    return [2 /*return*/];
            }
        });
    });
}
function setCourseImage(course, origCourse, host, url) {
    var imageId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
    host.update({
        imageId: { $set: imageId },
        images: {
            $set: [{
                    id: imageId,
                    url: url,
                    acl: [
                        "role:USER:R",
                        "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school + "/EMPLOYEE:S"
                    ],
                    $meta: 'add'
                }]
        }
    });
}
/* This version had the bug that old images were not replaced.
One course at Uppsala contained 12 images.


export function setCourseImageOld(
  course: Course,
  origCourse: Course,
  host: ICourseEditorHost,
  url: string)
{
  if (!origCourse || !origCourse.imageId) {
    const imageId = createUUID();
    host.update({
      imageId: { $set: imageId },
      images: {
        $push: [{
          id: imageId,
          url,
          acl: course.isTemplate ? ["role:USER:R"] : ["role:USER:R", `schoolRole:${env.currentUser.school}/EMPLOYEE:S`],
          $meta: 'add'
        }]
      }
    });
  } else {
    // Update existing image:
    const imgIdx = course.images.findIndex(img => img.id === course.imageId);
    if (imgIdx >= 0) {
      const imageEntity = course.images[imgIdx];
      if (course.isTemplate) {
        // Templates: Update the template image content:
        host.update({
          images: {
            $splice: [[imgIdx, 1, {
              ...imageEntity,
              url,
              $meta: 'update'
            }]]
          }
        })
      } else {
        // Real courses: Replace with a new image
        const imageId = createUUID();
        host.update({
          imageId: { $set: imageId },
          images: {
            $splice: [[imgIdx, 1, {
              id: imageId,
              url,
              acl: [
                `role:USER:R`,
                `schoolRole:${env.currentUser.school}/EMPLOYEE:S`
              ],
              $meta: 'add'
            }]]
          }
        })
      }
    } else {
      showError(L`Kunde inte uppdatera bilden.`);
    }
  }
}
*/
var CourseBanner = function (props) {
    var title = props.title, isTemplate = props.isTemplate, host = props.host, course = props.course, origCourse = props.origCourse, backgroundImage = props.backgroundImage, activePage = props.activePage;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    var menuItems = NonAdminMenuItems;
    if (isAdmin)
        menuItems = AdminMenuItems.concat(menuItems);
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pageHeader", onDragOver: course && _utils__WEBPACK_IMPORTED_MODULE_3__["allowCopy"], onDrop: course && (function (ev) { return onDropImage(ev, host, course, origCourse); }) },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, menuItems.map(function (item) { return ({
                                    item: item,
                                    isActive: activePage === item.name,
                                    callback: props.callbacks && props.callbacks[item.name],
                                    givenRoute: (props.routes && props.routes[item.name]),
                                    defaultRoute: item.route
                                }); }).filter(function (x) { return x.callback || x.defaultRoute || x.givenRoute; }).map(function (_a) {
                                    var item = _a.item, isActive = _a.isActive, callback = _a.callback, defaultRoute = _a.defaultRoute, givenRoute = _a.givenRoute;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: item.name, className: isActive ? "activePage" : "", onClick: callback }, callback ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text) :
                                        defaultRoute || givenRoute ?
                                            givenRoute || /^http[s]\:\/\//i.test(defaultRoute) ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: givenRoute || defaultRoute }, item.text) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Link"], { to: defaultRoute }, item.text) :
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text));
                                })))))))));
};
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7;


/***/ }),

/***/ "./src/components/course-builder/courses/course-module-list.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/courses/course-module-list.tsx ***!
  \**********************************************************************/
/*! exports provided: CourseModuleList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModuleList", function() { return CourseModuleList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _course_module__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./course-module */ "./src/components/course-builder/courses/course-module.tsx");





var CourseModuleList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModuleList, _super);
    function CourseModuleList(props) {
        var _this = _super.call(this, props) || this;
        _this._moduleRefs = {};
        _this.state = {};
        return _this;
    }
    CourseModuleList.prototype.addModule = function () {
        this.props.host.update({ modules: { $push: [{
                        name: "Ny kursmodul",
                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                        resources: [],
                        taskIds: []
                    }
                ] } });
    };
    CourseModuleList.prototype.getOrderedModules = function () {
        var course = this.props.course;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        return moduleOrder
            // Map ordered id to module
            .map(function (id) { return course.modules.find(function (m) { return m.id === id; }); })
            // Ignore entries that only exists in moduleOrder but not in modules
            .filter(function (m) { return !!m; })
            // Append modules at end that are not listed in moduleOrder
            .concat(course.modules.filter(function (m) { return !moduleOrder.find(function (id) { return m.id === id; }); }));
    };
    CourseModuleList.prototype.reorder = function (moduleId, direction) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var course, orderedModules, moduleIndex, newModuleIndex, currentModuleAtPosition, moduleOrder, origScrollPos, elemModule;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        course = this.props.course;
                        orderedModules = this.getOrderedModules();
                        moduleIndex = orderedModules.findIndex(function (m) { return m.id === moduleId; });
                        newModuleIndex = moduleIndex + direction;
                        if (newModuleIndex < 0 || newModuleIndex >= orderedModules.length) {
                            // Cannot order outside limits.
                            return [2 /*return*/];
                        }
                        currentModuleAtPosition = orderedModules[newModuleIndex];
                        moduleOrder = orderedModules.map(function (m) { return m.id; });
                        moduleOrder[newModuleIndex] = moduleId;
                        moduleOrder[moduleIndex] = currentModuleAtPosition.id;
                        origScrollPos = document.documentElement.scrollTop;
                        return [4 /*yield*/, this.props.host.update({
                                moduleOrder: { $set: moduleOrder }
                            })];
                    case 1:
                        _a.sent();
                        elemModule = Object(react_dom__WEBPACK_IMPORTED_MODULE_2__["findDOMNode"])(this._moduleRefs[moduleId]);
                        if (elemModule) {
                            try {
                                window.scrollTo({ top: origScrollPos }); // Prohibit default scrolling directly upwards on move up.
                                if (elemModule.getBoundingClientRect().top < 0 || elemModule.getBoundingClientRect().bottom > document.documentElement.scrollHeight) {
                                    elemModule.scrollIntoView({ behavior: 'smooth', block: 'start' });
                                }
                            }
                            catch (e) {
                                // Only Chrome beta supports the arguments given above. Default for older browsers.
                                window.scrollTo(null, origScrollPos);
                                if (elemModule.getBoundingClientRect().top < 0 || elemModule.getBoundingClientRect().bottom > document.documentElement.scrollHeight) {
                                    elemModule.scrollIntoView(true);
                                }
                            }
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    CourseModuleList.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, host = _a.host, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        var orderedModules = this.getOrderedModules();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet", ref: function (elem) { return _this._elem = elem; } },
            orderedModules.map(function (module) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module__WEBPACK_IMPORTED_MODULE_4__["CourseModuleComponent"], { ref: function (elem) { return _this._moduleRefs[module.id] = elem; }, key: module.id, course: course, module: module, onReorder: function (direction) { return _this.reorder(module.id, direction); }, getOrderedModules: function () { return _this.getOrderedModules(); }, host: host, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask }); }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large", onClick: function () { return _this.addModule(); } }, "L\u00E4gg till kursmodul"));
    };
    return CourseModuleList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/courses/course-module.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/course-module.tsx ***!
  \*****************************************************************/
/*! exports provided: CourseModuleComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModuleComponent", function() { return CourseModuleComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _sub_components_editable_task_list__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sub-components/editable-task-list */ "./src/components/course-builder/sub-components/editable-task-list.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _sub_components_remove_item__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utility-components/wysiwyg */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utility_components_content_editable_field__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../utility-components/content-editable-field */ "./src/components/utility-components/content-editable-field.tsx");
/* harmony import */ var _course_builder_ks_logic_task_order__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../course-builder-ks/logic/task-order */ "./src/components/course-builder-ks/logic/task-order.ts");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");













var DEFAULT_KNOWLEDGE_MATRIX = [{
        abilityIds: [],
        EIds: [],
        CIds: [],
        AIds: []
    }];
var CourseModuleComponent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModuleComponent, _super);
    function CourseModuleComponent(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            editMandatoryContent: false
        };
        return _this;
    }
    CourseModuleComponent.prototype.getModuleIndex = function () {
        var _a = this.props, course = _a.course, module = _a.module;
        return course.modules.findIndex(function (m) { return m.id === module.id; });
    };
    CourseModuleComponent.prototype.getModuleOrderIndex = function () {
        var _a = this.props, course = _a.course, module = _a.module;
        var orderedModules = this.props.getOrderedModules();
        return orderedModules.findIndex(function (m) { return m.id === module.id; });
    };
    CourseModuleComponent.prototype.updateModule = function (moduleUpdates) {
        var module = this.props.module;
        var updatedModule = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(module, moduleUpdates);
        var moduleIndex = this.getModuleIndex();
        this.props.host.update({ modules: { $splice: [[moduleIndex, 1, updatedModule]] } });
    };
    /* This method works for both adding new tasks to the task table
    and adding references to existing tasks. The magic of that has to do with
    whether task.$meta = 'add' or not and is done in EditCourse.save()
    */
    CourseModuleComponent.prototype.onTaskAdded = function (task, taskCustomization) {
        // Add task ID to module taskIds list:
        var courseUpdates = {};
        var taskIds = this.props.module.taskIds.slice();
        taskIds.push(task.id);
        // Add physical Task to Course.tasks.
        if (!this.props.course.tasks.some(function (t) { return t.id === task.id; })) {
            courseUpdates.tasks = { $push: [task] };
        }
        var customizations = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, (this.props.module.taskCustomizations || {}));
        if (taskCustomization)
            customizations[task.id] = taskCustomization;
        var moduleIndex = this.getModuleIndex();
        courseUpdates.modules = {};
        courseUpdates.modules[moduleIndex] = {
            taskIds: { $set: taskIds },
            taskCustomizations: { $set: customizations }
        };
        // Update module
        this.props.host.update(courseUpdates);
    };
    CourseModuleComponent.prototype.onTaskUpdated = function (task) {
        if (!task.$meta)
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Hoppsan, blev lite knas. Fel ID: ", ""], ["Hoppsan, blev lite knas. Fel ID: ", ""])), 'Pa7Dq'));
        var taskIndex = this.props.course.tasks.findIndex(function (t) { return t.id === task.id; });
        if (taskIndex >= 0) {
            this.props.host.update({ tasks: { $splice: [[taskIndex, 1, task]] } });
        }
    };
    CourseModuleComponent.prototype.onTaskCustomized = function (taskId, customization) {
        var customizations = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, (this.props.module.taskCustomizations || {}));
        customizations[taskId] = customization;
        this.updateModule({ taskCustomizations: { $set: customizations } });
    };
    CourseModuleComponent.prototype.onTaskDeleted = function (id) {
        // Remove task ID from module taskIds list.
        // This depends on the fact that EditCourse._setState() maintains
        // removed Task links (which it actually does (or should do at least)).
        this.updateModule({
            taskIds: { $set: this.props.module.taskIds.filter(function (tid) { return tid !== id; }) },
            taskCustomizations: {
                $apply: function (customizations) {
                    var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, customizations);
                    delete copy[id];
                    return copy;
                }
            }
        });
    };
    CourseModuleComponent.prototype.onTaskReplaced = function (id, task) {
        var idxTask = this.props.module.taskIds.indexOf(id);
        if (idxTask < 0) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte spara uppgift. Felkod d72kQ"], ["Kunde inte spara uppgift. Felkod d72kQ"]))));
            return;
        }
        var moduleUpdates = {
            // Replace old id with new id:
            taskIds: { $splice: [[idxTask, 1, task.id]] },
            taskCustomizations: {
                $apply: function (customizations) {
                    var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, customizations);
                    delete copy[id];
                    return copy;
                }
            }
        };
        var updatedModule = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(this.props.module, moduleUpdates);
        var moduleIndex = this.getModuleIndex();
        this.props.host.update({
            // Apply moduleUpdates from above:
            modules: { $splice: [[moduleIndex, 1, updatedModule]] },
            // Add the new task to Course.tasks.
            // Don't remove the old one! Why? Because it may be referenced
            // by another module in same course! Let EditCourse._setState()
            // do the "garbage collection" instead.
            tasks: { $set: this.props.course.tasks.concat(task) }
        });
    };
    CourseModuleComponent.prototype.onTasksReordered = function (source, target, placement) {
        var newTaskIds = Object(_course_builder_ks_logic_task_order__WEBPACK_IMPORTED_MODULE_11__["computeUpdatedOrder"])(this.props.course.tasks, this.props.module.taskIds, source, target, placement, { appendLeftovers: false });
        this.updateModule({
            taskIds: { $set: newTaskIds }
        });
    };
    CourseModuleComponent.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, host = _a.host, module = _a.module, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
        var moduleIndex = this.getModuleIndex();
        var moduleOrderedIndex = this.getModuleOrderIndex();
        var knowledgeMatrixDiv;
        var updateModule = this.updateModule.bind(this);
        var week = 1;
        var startWeekOptions = ["--"];
        var endWeekOptions = ["--"];
        for (var i = 0; i < 51; ++i) {
            startWeekOptions.push('' + week);
            endWeekOptions.push('' + ++week);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_9__["OpenCloseBox"], { inactivated: !_features__WEBPACK_IMPORTED_MODULE_12__["features"].cbCollapseBoxes, title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: "right" } },
                    moduleOrderedIndex > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-up selectable", "aria-hidden": "true", onClick: function (e) { e.stopPropagation(); _this.props.onReorder(-1); } }),
                        " "),
                    moduleOrderedIndex < course.modules.length - 1 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-down selectable", "aria-hidden": "true", onClick: function (e) { e.stopPropagation(); _this.props.onReorder(1); } }),
                        " "),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_5__["RemoveItem"], { title: "Ta bort modulen", style: { display: 'inline-block' }, onClick: function (e) { e.stopPropagation(); confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort modul ", "?"], ["Ta bort modul ", "?"])), module.name)) && host.update({ modules: { $splice: [[moduleIndex, 1]] } }); } })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, module.name)), headerOpen: module.name == 'Ny kursmodul' },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-module ked_boxed", style: { position: 'relative' } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_content_editable_field__WEBPACK_IMPORTED_MODULE_10__["ContentEditableField"], { text: module.name, tag: 'h3', className: 'renameable-text', maxChars: 100, placeholder: "Namnl\u00F6s modul", onChange: function (newName) { return updateModule({ name: { $set: newName } }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Startvecka")),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: module.startWeek || "--", onChange: function (ev) { return updateModule({ startWeek: {
                                    $set: ev.target.value === '--' ?
                                        undefined :
                                        parseInt(ev.target.value)
                                }
                            }); } }, startWeekOptions.map(function (o) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: o, value: o }, o); }))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Slutvecka")),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: module.endWeek || "--", onChange: function (ev) { return updateModule({ endWeek: {
                                    $set: ev.target.value === '--' ?
                                        undefined :
                                        parseInt(ev.target.value)
                                }
                            }); } }, endWeekOptions.map(function (o) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: o, value: o }, o); })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Kursmodulens introduktion"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_7__["Wysiwyg"], { actions: [
                        "bold",
                        "italic",
                        "underline",
                        "strikethrough",
                        "heading2",
                        "heading3",
                        "olist",
                        "ulist",
                        "line",
                        "link",
                        "image"
                    ], defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_8__["default"], html: module.mandatoryContent, onChange: function (html) {
                        updateModule({ mandatoryContent: { $set: html } });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Uppgifter"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_task_list__WEBPACK_IMPORTED_MODULE_3__["EditableTaskList"], { taskIds: module.taskIds, taskCustomizations: module.taskCustomizations, course: course, module: module, host: host, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask, onTaskAdded: function (task, taskCustomization) { return _this.onTaskAdded(task, taskCustomization); }, onTaskUpdated: function (task) { return _this.onTaskUpdated(task); }, onTaskCustomizationUpdated: function (taskId, customization) {
                        return _this.onTaskCustomized(taskId, customization);
                    }, onTaskDeleted: function (id) { return _this.onTaskDeleted(id); }, onTaskReplaced: function (id, task) { return _this.onTaskReplaced(id, task); }, onTasksReordered: function (source, target, placement) { return _this.onTasksReordered(source, target, placement); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Modulresurser"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Eventuella resuser f\u00F6r redovisning av modulen samt f\u00F6r modulen som helhet)"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: module.resources, onUpdate: function (resourcesUpdates) { return updateModule({ resources: resourcesUpdates }); }, host: host }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { position: 'absolute', top: 0, right: 0 } },
                    moduleOrderedIndex > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-up selectable", "aria-hidden": "true", onClick: function () { return _this.props.onReorder(-1); } }),
                        " "),
                    moduleOrderedIndex < course.modules.length - 1 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-down selectable", "aria-hidden": "true", onClick: function () { return _this.props.onReorder(1); } }),
                        " "),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_5__["RemoveItem"], { title: "Ta bort modulen", style: { display: 'inline-block' }, onClick: function () { return confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort modul ", "?"], ["Ta bort modul ", "?"])), module.name)) && host.update({ modules: { $splice: [[moduleIndex, 1]] } }); } })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontal-align" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontaItem activateCourseModule" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-info" + (module.inactive ? " btn-activate" : " btn-inactivate"), onClick: function () { return updateModule({ inactive: { $set: !module.inactive } }); } }, module.inactive ? 'Aktivera modulen' : 'Inaktivera modulen')))));
    };
    return CourseModuleComponent;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4;


/***/ }),

/***/ "./src/components/course-builder/courses/create-new.tsx":
/*!**************************************************************!*\
  !*** ./src/components/course-builder/courses/create-new.tsx ***!
  \**************************************************************/
/*! exports provided: CreateNewCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateNewCourse", function() { return CreateNewCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _sub_components_school_courses__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sub-components/school-courses */ "./src/components/course-builder/sub-components/school-courses.tsx");








var CreateNewCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CreateNewCourse, _super);
    function CreateNewCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            courseOptions: null,
            selectedTemplateId: "--",
            courses: null,
            selectedCourseId: ""
        };
        return _this;
    }
    CreateNewCourse.prototype.componentDidMount = function () {
        this.load().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
    };
    CreateNewCourse.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subjects, courses, courseOptions;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar kurser");
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("subjects", {
                                tags: ["schoolType:gymnasium"],
                                include: "courseTemplates"
                            })];
                    case 1:
                        subjects = _a.sent();
                        courses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(subjects.map(function (s) { return s.courseTemplates; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        courseOptions = [{ id: "--", name: "--" }].concat(courses);
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        this.setState({ courseOptions: courseOptions });
                        return [2 /*return*/];
                }
            });
        });
    };
    CreateNewCourse.prototype.onSelectCourse = function (id) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var derivedCourses, courseOptions, kedStandardOptions, teacherMade, courses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("courses", { hasEdgesTo: [id] })];
                    case 1:
                        derivedCourses = _a.sent();
                        courseOptions = derivedCourses
                            .filter(function (course) { return course.active; })
                            .map(function (_a) {
                            var id = _a.id, school = _a.school, description = _a.description, createdBy = _a.createdBy, modifiedBy = _a.modifiedBy;
                            if (description)
                                description = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["maxLength"])(description, 80);
                            var descriptionOrAuthor = description ||
                                (createdBy ? createdBy.name + "s version" :
                                    modifiedBy && modifiedBy.name + "s version");
                            return {
                                id: id,
                                name: school === 'standard' ?
                                    description ? "Standard - " + description : "Standard" :
                                    school + " - " + Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["maxLength"])(descriptionOrAuthor, 90),
                                school: school
                            };
                        }).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        kedStandardOptions = courseOptions.filter(function (option) { return option.school === "standard"; });
                        teacherMade = courseOptions.filter(function (option) { return option.school !== "standard"; });
                        courses = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](kedStandardOptions, [
                            { id: id, name: "Tom" }
                        ], teacherMade);
                        this.setState({
                            courses: courses,
                            selectedTemplateId: id,
                            selectedCourseId: courses[0].id
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    CreateNewCourse.prototype.render = function () {
        var _this = this;
        var _a = this.state, courseOptions = _a.courseOptions, selectedTemplateId = _a.selectedTemplateId, courses = _a.courses, selectedCourseId = _a.selectedCourseId;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursbyggaren"], ["Kursbyggaren"]))), activePage: "courseBuilder", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Skapa ny kurs"),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "V\u00E4lj gymnasiekurs :"))),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, !courseOptions ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { disabled: true, value: "" },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", null, "--"))) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: this.state.selectedTemplateId, onChange: function (ev) { return _this.onSelectCourse(ev.target.value).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]); } }, courseOptions.map(function (course) {
                                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: course.id, value: course.id }, course.name);
                                                })))),
                                        courses && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Utg\u00E5 fr\u00E5n version: "))),
                                        courses && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: selectedCourseId, onChange: function (ev) { return _this.setState({
                                                        selectedCourseId: ev.target.value
                                                    }); } }, courses.map(function (course) {
                                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: course.id, value: course.id }, course.name);
                                                })))),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                        courses && selectedCourseId && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/create-from-template/" + this.state.selectedCourseId, className: "btn btn-large" }, "Skapa"))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_school_courses__WEBPACK_IMPORTED_MODULE_7__["SchoolCourses"], null))))))));
    };
    return CreateNewCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/courses/edit-course.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder/courses/edit-course.tsx ***!
  \***************************************************************/
/*! exports provided: EditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditCourse", function() { return EditCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _inner_edit_course__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./inner-edit-course */ "./src/components/course-builder/courses/inner-edit-course.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _sub_components_remove_item__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _business_logic__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../repos/school-courses */ "./src/repos/school-courses.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _globals_current_user__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../../globals/current-user */ "./src/globals/current-user.ts");
/* harmony import */ var _features_features__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../../features/features */ "./src/features/features.ts");
/* harmony import */ var _apis_google_classroom_sync__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../../apis/google-classroom-sync */ "./src/apis/google-classroom-sync.ts");




















var catcher = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_12__["default"].ENVIRONMENT === 'production' ?
    _utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"] : null;
var CONFIRM_NAVIGATE_MESSAGE = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Du har osparat data. V\u00E4lj avbryt och tryck CTRL+S om du vill spara f\u00F6rst."], ["Du har osparat data. V\u00E4lj avbryt och tryck CTRL+S om du vill spara f\u00F6rst."])));
var DEFAULT_STATE = {
    origCourse: null,
    origTemplate: null,
    course: null,
    dialogContainers: [],
    hasUnsavedData: false,
    view: 'courseBuilder',
    classroomSyncInProgress: false
};
var EditCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditCourse, _super);
    function EditCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_STATE);
        _this.update = _this.update.bind(_this);
        _this.refDialog = _this.refDialog.bind(_this);
        _this.contentYPos = 0;
        _this.onKeyDown = _this.onKeyDown.bind(_this);
        _this.beforeUnload = _this.beforeUnload.bind(_this);
        _this.onClickPreventUnload = _this.onClickPreventUnload.bind(_this);
        _this.isSaving = false;
        _this.dialogs = [];
        if (props.view)
            _this.state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _this.state, { view: props.view });
        return _this;
    }
    EditCourse.prototype.setStatePromised = function (state) {
        return this._setState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ hasUnsavedData: true }, state));
    };
    EditCourse.prototype.setNonSaveableDataState = function (state) {
        return this._setState(state);
    };
    EditCourse.prototype._setState = function (state) {
        var _this = this;
        if (state.course) {
            {
                //
                // Maintain course task links (remove links to tasks that are not used
                // by any module)
                //
                var _a = state.course, tasks = _a.tasks, modules = _a.modules;
                var usedTaskIds_1 = {};
                modules.forEach(function (module) { return module.taskIds.forEach(function (id) { return usedTaskIds_1[id] = true; }); });
                var filteredCourseTasks = tasks.filter(function (t) { return usedTaskIds_1[t.id]; });
                var modifiedCourse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state.course);
                modifiedCourse.tasks = filteredCourseTasks;
                state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state, { course: modifiedCourse });
            }
        }
        // Invoke our course into state property allCourses so that the
        // right-hand side list of courses gets update immediately with
        // the publishable state of this course.
        var allCourses = state.allCourses || this.state.allCourses;
        var course = state.course || this.state.course;
        if (allCourses) {
            var idxOurCourse = allCourses.findIndex(function (c) { return c.id === _this.props.id; });
            allCourses = react_addons_update__WEBPACK_IMPORTED_MODULE_9___default()(allCourses, { $splice: [[idxOurCourse, 1, course]] });
            state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state);
            state.allCourses = allCourses;
        }
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, function () { return state; }, resolve); });
    };
    EditCourse.prototype.componentWillMount = function () {
        this.load().catch(catcher);
        window.addEventListener('keydown', this.onKeyDown);
        window.addEventListener('beforeunload', this.beforeUnload);
        document.body.addEventListener('click', this.onClickPreventUnload);
    };
    EditCourse.prototype.componentWillUnmount = function () {
        window.removeEventListener('keydown', this.onKeyDown);
        window.removeEventListener('beforeunload', this.beforeUnload);
        document.body.removeEventListener('click', this.onClickPreventUnload);
        Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCourseBuilderStatus"])('');
    };
    EditCourse.prototype.componentWillReceiveProps = function (nextProps) {
        if (this.state && this.state.course) {
            if (nextProps.id !== this.props.id || nextProps.templateId !== this.props.templateId) {
                this.setStatePromised(DEFAULT_STATE);
            }
        }
        if (nextProps.view !== this.props.view) {
            this.setNonSaveableDataState({ view: nextProps.view });
        }
    };
    EditCourse.prototype.componentDidUpdate = function (prevProps, prevState) {
        if (this.contentDiv) {
            var contentDiv = Object(react_dom__WEBPACK_IMPORTED_MODULE_2__["findDOMNode"])(this.contentDiv);
            if (contentDiv) {
                this.contentYPos = contentDiv.getBoundingClientRect().top;
            }
        }
        if (prevState && prevState.course) {
            // This was not the initial update.
            // If props have been updated to point out another course or template, reset component:
            if (this.props.id !== prevProps.id || this.props.templateId !== prevProps.templateId) {
                this.load().catch(catcher);
            }
        }
        if (!prevState.hasUnsavedData && this.state.hasUnsavedData) {
            Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCourseBuilderStatus"])('unsaved');
        }
    };
    EditCourse.prototype.loadFromTemplate = function (templateId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var template, course, mySchool;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar data från mall...");
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_4__["loadCourse"])(templateId, { includeTemplateChain: true })];
                    case 1:
                        template = _a.sent();
                        course = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCreationStamp"])(Date.now(), template, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser);
                        course.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
                        course.parentId = templateId;
                        course.active = false;
                        course.isTemplate = false;
                        course.templateChain = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](course.templateChain);
                        course.templateChain.push({ id: templateId, $meta: 'ref' });
                        mySchool = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school;
                        course.school = mySchool;
                        course.description = "";
                        course.responsibleTeachers = [];
                        delete course.studyGroups;
                        course.acl = [
                            "role:USER:R",
                            "schoolRole:" + mySchool + "/EMPLOYEE:S" // Other teachers at same school should be able to modify the course.
                        ];
                        delete course.$etag;
                        delete course.createdBy;
                        delete course.createdDate;
                        delete course.modifiedBy;
                        delete course.modifiedDate;
                        delete course.activatedBy;
                        delete course.activatedDate;
                        delete course.googleClassRoomCode;
                        delete course.googleClassRoomURL;
                        delete course.googleCreateClassrooms;
                        return [4 /*yield*/, this.setStatePromised({ course: course, origCourse: null, origTemplate: template })];
                    case 2:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCourseBuilderStatus"])('');
                        if (!this.props.id) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadExistingCourse(this.props.id)];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 5];
                    case 2:
                        if (!this.props.templateId) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.loadFromTemplate(this.props.templateId)];
                    case 3:
                        _a.sent();
                        return [3 /*break*/, 5];
                    case 4: throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ogiltig parameter. id eller templateId m\u00E5ste anges"], ["Ogiltig parameter. id eller templateId m\u00E5ste anges"]))));
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.loadExistingCourse = function (courseId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var course;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar kurs");
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_4__["loadCourse"])(courseId)];
                    case 1:
                        course = _a.sent();
                        if (!course.responsibleTeachers)
                            course.responsibleTeachers = [];
                        return [4 /*yield*/, this.setNonSaveableDataState({ course: course, origCourse: course })];
                    case 2:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.update = function (courseUpdates) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.setStatePromised({ course: react_addons_update__WEBPACK_IMPORTED_MODULE_9___default()(this.state.course, courseUpdates) })];
                    case 1:
                        _a.sent();
                        //check classroom changes
                        this._checkClassroomChanges();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.deleteCourse = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_1, _a, courseSchool, parentId, courseId, children, br, children_1, children_1_1, childCourse;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Raderar kursen...");
                        courseSchool = this.state.course.school;
                        parentId = this.state.course.parentId;
                        courseId = this.props.id;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.list("courses", {
                                hasEdgesTo: [this.props.id]
                            })];
                    case 1:
                        children = _b.sent();
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        try {
                            for (children_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {
                                childCourse = children_1_1.value;
                                /* CANNOT DO THIS. MAY NOT HAVE ACCESS! if (childCourse.parentId === courseId) {
                                  // Reconnect child with my parent instead, as I will be disappearing...
                                  childCourse.parentId = parentId;
                                  br.put("courses", childCourse);
                                }*/
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        br.delete("courses", courseId);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.batch(br.mutationRequests)];
                    case 2:
                        _b.sent();
                        if (courseSchool === _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school) {
                            _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].delete(courseId);
                        }
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        location.hash = "#/courses/new";
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * In case that the course has changes which should be synced with classroom
     * Ask the user if the sync should be done
     */
    EditCourse.prototype.confirmSaveAndSync = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var course, syncWithClassroom;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        course = this.state.course;
                        syncWithClassroom = false;
                        //confirm should not be displayed in case the checkbox was saved and the feature flag is off
                        if (course.googleCreateClassrooms && !course.inSyncWithClassroom && _features_features__WEBPACK_IMPORTED_MODULE_17__["features"].studyGroups) {
                            syncWithClassroom = confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Synkurs kurs med klassrum?"], ["Synkurs kurs med klassrum?"]))));
                        }
                        return [4 /*yield*/, syncWithClassroom];
                    case 1:
                        (_a.sent()) ? this.syncWithClassroomAndSave() : this.save();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, course, origCourse, classroomSync, catcher_1, enableTeacherRights, origAccessList, modifiedAccessList, currentUser, err_1, errorMessage;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, course = _a.course, origCourse = _a.origCourse;
                        if (!(origCourse && origCourse.googleCreateClassrooms && !course.googleCreateClassrooms)) return [3 /*break*/, 5];
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, , 4]);
                        classroomSync = new _apis_google_classroom_sync__WEBPACK_IMPORTED_MODULE_18__["ClassroomSync"]();
                        return [4 /*yield*/, classroomSync.archive(course)];
                    case 2:
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        catcher_1 = _b.sent();
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                    case 5:
                        enableTeacherRights = _features_features__WEBPACK_IMPORTED_MODULE_17__["features"].teacherRights;
                        origAccessList = this.state.origCourse ? Object(_business_logic__WEBPACK_IMPORTED_MODULE_11__["getSoftAccessList"])(this.state.origCourse) : [];
                        modifiedAccessList = Object(_business_logic__WEBPACK_IMPORTED_MODULE_11__["getSoftAccessList"])(this.state.course);
                        currentUser = Object(_globals_current_user__WEBPACK_IMPORTED_MODULE_16__["getCurrentUser"])();
                        if (enableTeacherRights &&
                            (!currentUser.roles.includes("ADMIN") &&
                                !tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](origAccessList, modifiedAccessList).some(function (_a) {
                                    var email = _a.email, url = _a.url, access = _a.access;
                                    return (email || url) === currentUser.mail && // url is for backward compat! Has been renamed to email.
                                        (!access || // Backward compat. Was not possible to set access before!
                                            access === 'edit' || // Edit is fine
                                            access === 'full');
                                }))) {
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursen kunde inte sparas. L\u00E4gg till dig sj\u00E4lv i listan p\u00E5 ansvariga l\u00E4rare"], ["Kursen kunde inte sparas. L\u00E4gg till dig sj\u00E4lv i listan p\u00E5 ansvariga l\u00E4rare"]))));
                            return [2 /*return*/];
                        }
                        if (this.isSaving)
                            return [2 /*return*/];
                        _b.label = 6;
                    case 6:
                        _b.trys.push([6, 8, 9, 10]);
                        this.isSaving = true;
                        return [4 /*yield*/, this._save()];
                    case 7:
                        _b.sent();
                        return [3 /*break*/, 10];
                    case 8:
                        err_1 = _b.sent();
                        errorMessage = err_1 && err_1.message ? err_1.message : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ett ok\u00E4nt fel har intr\u00E4ffat..."], ["Ett ok\u00E4nt fel har intr\u00E4ffat..."])));
                        if (err_1) {
                            if (err_1.name === 'http409' || err_1.name === 'http412' || err_1.name === 'http404') {
                                // Conflict. Show a nicer error message:
                                errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursen har redigerad av annan anv\u00E4ndare. Ladda om sidan och g\u00F6r om \u00E4ndrinarna."], ["Kursen har redigerad av annan anv\u00E4ndare. Ladda om sidan och g\u00F6r om \u00E4ndrinarna."])));
                            }
                            else if (err_1.name === 'http403') {
                                if (this.state.course.isTemplate)
                                    errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ingen beh\u00F6righet att spara kursmallen. Endast administrat\u00F6rer kan redigera kursmallar."], ["Ingen beh\u00F6righet att spara kursmallen. Endast administrat\u00F6rer kan redigera kursmallar."])));
                                else if (this.state.course.school)
                                    errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ingen beh\u00F6righet att spara kursen ", ". Kursen kan bara redigeras av anst\u00E4llda p\u00E5 ", ""], ["Ingen beh\u00F6righet att spara kursen ", ". Kursen kan bara redigeras av anst\u00E4llda p\u00E5 ", ""])), this.state.course.name, this.state.course.school);
                            }
                        }
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(errorMessage);
                        Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCourseBuilderStatus"])('error');
                        return [3 /*break*/, 10];
                    case 9:
                        this.isSaving = false;
                        return [7 /*endfinally*/];
                    case 10: return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.syncInProgress = function () {
        return this.state.classroomSyncInProgress;
    };
    EditCourse.prototype.syncWithClassroomAndSave = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, course, origCourse, classroomSync, fullSyncNeeded, syncResult, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, course = _a.course, origCourse = _a.origCourse;
                        console.log(course);
                        console.log(origCourse);
                        return [4 /*yield*/, this.save()];
                    case 1:
                        _b.sent();
                        // if there is still unsaved data it means that an error encountered during save. 
                        // sync with google classroom will be canceled
                        if (this.state.hasUnsavedData) {
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_9 || (templateObject_9 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Synkronisering med klassrummet skulle inte ske"], ["Synkronisering med klassrummet skulle inte ske"]))));
                            return [2 /*return*/];
                        }
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, 7, , 8]);
                        this.setState({ classroomSyncInProgress: true });
                        classroomSync = new _apis_google_classroom_sync__WEBPACK_IMPORTED_MODULE_18__["ClassroomSync"]();
                        if (!course.googleCreateClassrooms) return [3 /*break*/, 6];
                        fullSyncNeeded = course.inSyncWithClassroom == null;
                        return [4 /*yield*/, classroomSync.initSync(course, origCourse, fullSyncNeeded)];
                    case 3:
                        syncResult = _b.sent();
                        if (!syncResult.done) return [3 /*break*/, 5];
                        this.update({ inSyncWithClassroom: { $set: true } });
                        this.setState({ classroomSyncInProgress: false });
                        //update inSyncWithClassroom flag
                        return [4 /*yield*/, this._save(true)];
                    case 4:
                        //update inSyncWithClassroom flag
                        _b.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_10 || (templateObject_10 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Synkronisering med framg\u00E5ng"], ["Synkronisering med framg\u00E5ng"]))));
                        return [3 /*break*/, 6];
                    case 5:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_11 || (templateObject_11 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Fel synkroniserat klassrum"], ["Fel synkroniserat klassrum"]))));
                        this.setState({ classroomSyncInProgress: false });
                        _b.label = 6;
                    case 6: return [3 /*break*/, 8];
                    case 7:
                        err_2 = _b.sent();
                        catcher;
                        return [3 /*break*/, 8];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype._save = function (silentSave) {
        if (silentSave === void 0) { silentSave = false; }
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, course, origCourse, origTemplate, doesAllTasksCoverAllRequirements, modifiedCourse, batch, orig, newCourseTasks, tags, schoolId, schoolId, schoolId, res;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, course = _a.course, origCourse = _a.origCourse, origTemplate = _a.origTemplate;
                        doesAllTasksCoverAllRequirements = Object(_business_logic__WEBPACK_IMPORTED_MODULE_11__["getUncoveredKnowledgeRequirements"])(course).length === 0;
                        !silentSave && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_12 || (templateObject_12 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateModificationStamp"])(Date.now(), course, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser);
                        batch = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        orig = origCourse || origTemplate;
                        newCourseTasks = modifiedCourse.tasks.map(function (task) {
                            if (task.$meta === 'add' || task.$meta === 'update') {
                                var origTask = orig.tasks.find(function (t) { return t.id === task.id; });
                                return Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateDocumentGraphs"])(origTask || {}, task, "tasks", {
                                    knowledgeRequirements: 'knowledge-requirements',
                                    centralContent: 'central-content',
                                    abilities: 'abilities'
                                }, batch);
                            }
                            else {
                                var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                                delete updatedTask.$meta;
                                return updatedTask;
                            }
                        });
                        modifiedCourse = react_addons_update__WEBPACK_IMPORTED_MODULE_9___default()(modifiedCourse, { tasks: { $set: newCourseTasks } });
                        modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateDocumentGraphs"])(origCourse || {}, modifiedCourse, 'courses', {
                            templateChain: 'courses',
                            centralContent: 'central-content',
                            knowledgeRequirements: 'knowledge-requirements',
                            abilities: 'abilities',
                            images: 'images',
                            tasks: 'tasks'
                        }, batch);
                        modifiedCourse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, modifiedCourse);
                        modifiedCourse.publishable = doesAllTasksCoverAllRequirements;
                        tags = (modifiedCourse.tags || []).filter(function (tag) { return tag !== 'incomplete'; });
                        modifiedCourse.tags = modifiedCourse.publishable ?
                            tags : tags.concat("incomplete");
                        if (!!origCourse) return [3 /*break*/, 3];
                        // A new course should be added:
                        batch.add('courses', modifiedCourse);
                        if (!course.school) return [3 /*break*/, 2];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 1:
                        schoolId = _b.sent();
                        batch.link("schools", schoolId, "courses", course.id, "courses");
                        if (course.active) {
                            batch.link("schools", schoolId, "courses", course.id, "activeCourses");
                        }
                        _b.label = 2;
                    case 2: return [3 /*break*/, 7];
                    case 3:
                        // An existing course should be updated:
                        batch.put('courses', modifiedCourse);
                        if (!(!origCourse.active && course.active)) return [3 /*break*/, 5];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 4:
                        schoolId = _b.sent();
                        batch.link("schools", schoolId, "courses", course.id, "activeCourses");
                        return [3 /*break*/, 7];
                    case 5:
                        if (!(origCourse.active && !course.active)) return [3 /*break*/, 7];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 6:
                        schoolId = _b.sent();
                        batch.unlink("schools", schoolId, "courses", course.id, "activeCourses");
                        _b.label = 7;
                    case 7: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.batch(batch.mutationRequests)];
                    case 8:
                        res = _b.sent();
                        !silentSave && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(origCourse ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_13 || (templateObject_13 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4ndringarna har sparats"], ["\u00C4ndringarna har sparats"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_14 || (templateObject_14 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursen har skapats"], ["Kursen har skapats"]))));
                        // Update state to reflect what has been posted:
                        if (res && res.newEtags)
                            modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["applyEtags"])(modifiedCourse, res.newEtags, ["images", "tasks"]);
                        if (course.school === _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school) {
                            // Update mySchoolCoursesRepo
                            if (!origCourse) {
                                _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].insert(modifiedCourse);
                            }
                            else {
                                _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].update(modifiedCourse);
                            }
                        }
                        return [4 /*yield*/, this.setNonSaveableDataState({ course: modifiedCourse, origCourse: modifiedCourse, hasUnsavedData: false })];
                    case 9:
                        _b.sent();
                        Object(_utils__WEBPACK_IMPORTED_MODULE_4__["updateCourseBuilderStatus"])('');
                        if (!origCourse) {
                            // This was the creation of a new course. Correct the route now when the user enters an edit state:
                            location.hash = "#/courses/" + modifiedCourse.id + "/edit";
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype._checkClassroomChanges = function () {
        var _a = this.state, course = _a.course, origCourse = _a.origCourse;
        var arr1set = course.tasks.filter(function (x) { return x.assignment; });
        //if (course.inSyncWithClassroom) {
        var arr2set = origCourse.tasks.filter(function (x) { return x.assignment; });
        //check tasks added or removed
        var hasTeacherChanges = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["hasChanges"])(origCourse.responsibleTeachers, course.responsibleTeachers);
        //
        var hasTasksChanges = arr1set.filter(function (x) { return !arr2set.find(function (y) { return y.id == x.id; }); }).length > 0 || arr2set.filter(function (x) { return !arr1set.find(function (y) { return y.id == x.id; }); }).length > 0;
        //check if any task renamed or changed its type
        if (!hasTasksChanges) {
            hasTasksChanges = arr1set.some(function (e1) { return arr2set.find(function (e2) {
                return e2.id === e1.id && e2.name !== e1.name;
            }) != null; });
        }
        var hasStudyGroupsChanges = Object(_utils__WEBPACK_IMPORTED_MODULE_4__["hasChanges"])(origCourse.studyGroups, course.studyGroups);
        //checks are made with the previous object in case that the user will revert the changes
        var prevStatus = course.inSyncWithClassroom;
        course.inSyncWithClassroom = !(hasTeacherChanges || hasTasksChanges || hasStudyGroupsChanges);
        if (prevStatus != course.inSyncWithClassroom) {
            this.setStatePromised({ course: course });
        }
    };
    EditCourse.prototype.activateAndSave = function () {
        var _this = this;
        var course = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.course);
        if (!course.active) {
            /*const uncoveredRequirements = getUncoveredKnowledgeRequirements(course);
            if (uncoveredRequirements.length > 0)
              return showError (L`Det finns kunskapskrav som inte uppfylls av någon modul. Kan inte aktivera kursen förrän alla kunskapskrav finns med.`);
            */
            course.active = true;
            course.activatedBy = {
                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.displayName,
                url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.mail
            };
            course.activatedDate = Date.now();
            this.setStatePromised({ course: course })
                .then(function () { return _this.save(); })
                .catch(catcher);
        }
    };
    EditCourse.prototype.inactivateAndSave = function () {
        var _this = this;
        var course = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.course);
        if (course.active) {
            course.active = false;
            course.inactivatedBy = {
                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.displayName,
                url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.mail
            };
            course.inactivatedDate = Date.now();
            this.setStatePromised({ course: course })
                .then(function () { return _this.save(); })
                .catch(catcher);
        }
    };
    EditCourse.prototype.openDialog = function (dialogContainer) {
        this.setNonSaveableDataState({ dialogContainers: this.state.dialogContainers.concat(dialogContainer) });
    };
    EditCourse.prototype.closeDialog = function () {
        var dialogContainers = this.state.dialogContainers;
        var length = dialogContainers.length;
        length && this.setNonSaveableDataState({ dialogContainers: dialogContainers.slice(0, length - 1) });
        // Now sync the direct 'dialogs' property with the new state:
        while (this.dialogs.length >= length)
            this.dialogs.pop();
    };
    EditCourse.prototype.refDialog = function (dialog, index) {
        this.dialogs[index] = dialog; // Setting per index instead of push(). Works even if the ref attribute could be invoked multiple times.
    };
    EditCourse.prototype.onKeyDown = function (ev) {
        if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
            ev.preventDefault();
            if (this.state.dialogContainers.length > 0) {
                this.saveDialog();
                return;
            }
            this.save();
        }
        else if (ev.which === 27 && this.state.dialogContainers.length > 0) {
            this.closeDialog();
            ev.preventDefault();
        }
        else if (ev.which === 13) {
            var targetElem = ev.target;
            if (this.state.dialogContainers.length > 0 &&
                targetElem.tagName !== 'TEXTAREA' &&
                targetElem.tagName !== 'INPUT' &&
                targetElem.tagName !== 'SELECT' &&
                targetElem.tagName !== 'OPTION' &&
                !targetElem.contentEditable) {
                this.saveDialog();
            }
        }
    };
    EditCourse.prototype.beforeUnload = function (ev) {
        if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {
            if (!_globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.http.bearerProvider.wantsRedirect) {
                ev.returnValue = CONFIRM_NAVIGATE_MESSAGE;
                return ev.returnValue;
            }
        }
    };
    EditCourse.prototype.onClickPreventUnload = function (ev) {
        if (ev.target && ('' + ev.target.tagName).toLowerCase() === 'a') {
            var a = ev.target;
            if (a.href && a.getAttribute('href') !== '#' && !a.target) {
                if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {
                    if (!confirm(CONFIRM_NAVIGATE_MESSAGE)) {
                        ev.preventDefault();
                        ev.stopPropagation();
                        return false;
                    }
                }
            }
        }
    };
    EditCourse.prototype.saveDialog = function () {
        if (this.state.dialogContainers.length > 0) {
            var dialog = this.dialogs[this.state.dialogContainers.length - 1]; // YES, should reference this.dialogs by length of dialogContainers. Strange yes, but leave it so!
            dialog && dialog.save();
        }
    };
    EditCourse.prototype.render = function () {
        var _this = this;
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.roles.indexOf("ADMIN") >= 0;
        var course = this.state.course;
        return !this.state.course ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_7__["CourseBanner"], { title: "", activePage: this.state.view, routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_13__["Spinner"], null),
                "V.g. v\u00E4nta medan kursen laddas...")) :
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_7__["CourseBanner"], { title: course.name + " - " + course.points + "p", activePage: this.state.view, routes: {
                        studentPage: Object(_access_control__WEBPACK_IMPORTED_MODULE_15__["preserveImpersonationQuery"])(this.props.viewCourseUrl, { courseId: this.props.id }),
                        feedback: this.props.feedbackUrl
                    }, host: this, course: course, origCourse: this.state.origCourse, backgroundImage: course.images.filter(function (img) { return img.id === course.imageId; }).map(function (img) { return img.url; })[0], isTemplate: course.isTemplate }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer", ref: function (div) { return _this.contentDiv = div; } },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_inner_edit_course__WEBPACK_IMPORTED_MODULE_8__["InnerEditCourse"], { course: this.state.course, origCourse: this.state.origCourse, host: this }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                this.state.dialogContainers.map(function (_a, i) {
                                    var Component = _a.Component, props = _a.props;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: i },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ ref: function (dialog) { return _this.refDialog(dialog, i); } }, props)),
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_10__["RemoveItem"], { onClick: function () { return _this.closeDialog(); } }))));
                                }))))));
    };
    return EditCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11, templateObject_12, templateObject_13, templateObject_14;


/***/ }),

/***/ "./src/components/course-builder/courses/index.tsx":
/*!*********************************************************!*\
  !*** ./src/components/course-builder/courses/index.tsx ***!
  \*********************************************************/
/*! exports provided: EditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _edit_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./edit-course */ "./src/components/course-builder/courses/edit-course.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EditCourse", function() { return _edit_course__WEBPACK_IMPORTED_MODULE_0__["EditCourse"]; });




/***/ }),

/***/ "./src/components/course-builder/courses/inner-edit-course.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/courses/inner-edit-course.tsx ***!
  \*********************************************************************/
/*! exports provided: InnerEditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InnerEditCourse", function() { return InnerEditCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _course_module_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./course-module-list */ "./src/components/course-builder/courses/course-module-list.tsx");
/* harmony import */ var _sub_components_school_courses__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sub-components/school-courses */ "./src/components/course-builder/sub-components/school-courses.tsx");
/* harmony import */ var _business_logic__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _sub_components_editable_teacher_list__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../sub-components/editable-teacher-list */ "./src/components/course-builder/sub-components/editable-teacher-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _sub_components_weighted_items_table__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../sub-components/weighted-items-table */ "./src/components/course-builder/sub-components/weighted-items-table.tsx");
/* harmony import */ var _utility_components_wysiwyg_index__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../utility-components/wysiwyg/index */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");
/* harmony import */ var _sub_components_editable_workflow_link__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../sub-components/editable-workflow-link */ "./src/components/course-builder/sub-components/editable-workflow-link.tsx");
/* harmony import */ var _globals_current_user__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../globals/current-user */ "./src/globals/current-user.ts");
/* harmony import */ var _utility_components_observe__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../../utility-components/observe */ "./src/components/utility-components/observe.tsx");
/* harmony import */ var _sub_components_select_study_groups__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../sub-components/select-study-groups */ "./src/components/course-builder/sub-components/select-study-groups.tsx");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");




















;
var InnerEditCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InnerEditCourse, _super);
    function InnerEditCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            changeImageUrl: false
        };
        return _this;
    }
    InnerEditCourse.prototype.setImageUrl = function (imageUrl) {
        var course = this.props.course;
        if (!course.imageId) {
        }
    };
    InnerEditCourse.prototype.render = function () {
        var _a = this.props, course = _a.course, origCourse = _a.origCourse, host = _a.host;
        var uncoveredKnowledgeRequirements = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["getUncoveredKnowledgeRequirements"])(course);
        var idsNotCoveredByAnyTask = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["getIdsNotCoveredByTasks"])(course);
        var sanityCheckWarnings = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["sanityCheck"])(course);
        var courseImage = course.images.find(function (img) { return img.id === course.imageId; });
        var courseImageIsDataUrl = courseImage && courseImage.url.startsWith('data:');
        var courseIsUploaded = courseImage && courseImage.url.indexOf('storage.googleapis.com') > 0;
        var softAccessList = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["getSoftAccessList"])(course);
        var currentUser = Object(_globals_current_user__WEBPACK_IMPORTED_MODULE_15__["getCurrentUser"])();
        var canDelete = softAccessList.some(function (user) { return user.email === currentUser.mail && user.access === 'full'; });
        var displayStudyGroups = _features__WEBPACK_IMPORTED_MODULE_19__["features"].studyGroups;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                    course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, "Kursmall"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kurs\u00F6vergripande"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_18__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kurs\u00F6vergripande"), headerOpen: true, inactivated: !_features__WEBPACK_IMPORTED_MODULE_19__["features"].cbCollapseBoxes },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Kursens bild"),
                                courseImageIsDataUrl ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens bild ligger i databasen. F\u00F6r att \u00E4ndra bild m\u00E5ste du dra och sl\u00E4ppa en ny bild ovanp\u00E5 den gamla h\u00F6gst upp p\u00E5 denna sida. Bilden kan antingen vara fr\u00E5n en annan webbsida. Lokala bildfiler g\u00E5r ocks\u00E5 bra att dra och sl\u00E4ppa.")
                                    : courseIsUploaded ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens bild ligger i Kunskapsskolans Google moln. F\u00F6r att \u00E4ndra bild m\u00E5ste du dra och sl\u00E4ppa en ny bild ovanp\u00E5 den gamla h\u00F6gst upp p\u00E5 denna sida. Bilden kan antingen vara fr\u00E5n en annan webbsida. Lokala bildfiler g\u00E5r ocks\u00E5 bra att dra och sl\u00E4ppa.") : courseImage ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { value: courseImage.url, style: { width: '100%', height: '30px' }, onChange: function (ev) { return Object(_course_banner__WEBPACK_IMPORTED_MODULE_7__["setCourseImage"])(course, origCourse, host, ev.target.value); } }),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Bilden som visas h\u00F6gst upp h\u00E4mtas fr\u00E5n angiven URL. F\u00F6r att \u00E4ndra bild kan du redigera URL ovan. Ett annat s\u00E4tt att \u00E4ndra bild \u00E4r att dra och sl\u00E4ppa en ny bild \u00F6ver den gamla h\u00F6gst upp p\u00E5 sidan.")) :
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursen saknar egen bild. L\u00E4gg till en bild genom att dra och sl\u00E4ppa en bild p\u00E5 kurs-bannern h\u00F6gst upp p\u00E5 den h\u00E4r sidan."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                            !course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Beskrivning"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Beskrivning av kursen. F\u00F6r att skilja mellan olika varianter av samma gymnasiekurs)"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "inputTextBox inputTextSmall", value: course.description, onChange: function (ev) { return host.update({ description: { $set: ev.target.value } }); } }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Upptaktstext"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(texten ska visas p\u00E5 kursens upptaktssektion)"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg_index__WEBPACK_IMPORTED_MODULE_12__["Wysiwyg"], { html: course.runUpText, defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_13__["default"], actions: [
                                        "bold",
                                        "italic",
                                        "underline",
                                        "strikethrough",
                                        "heading2",
                                        "heading3",
                                        "olist",
                                        "ulist",
                                        "line",
                                        "link",
                                        "image"
                                    ], onChange: function (newHtml) { return host.update({ runUpText: { $set: newHtml } }); } }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Kursresurser"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Resurser f\u00F6r upptakt och kursen som helhet)"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: course.resources, onUpdate: function (resourcesUpdates) { return host.update({ resources: resourcesUpdates }); }, host: host }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Arbetsg\u00E5ng"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Eventuell l\u00E4nk till arbetsg\u00E5ng f\u00F6r kursen)"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_workflow_link__WEBPACK_IMPORTED_MODULE_14__["EditableWorkFlowLink"], { url: course.workFlowLink, onUpdate: function (updates) { return host.update({ workFlowLink: updates }); }, host: host }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                            !course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Google Classroom"),
                                displayStudyGroups ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (course.googleCreateClassrooms ? " checked" : ""), onClick: function () { host.update({ googleCreateClassrooms: { $set: !course.googleCreateClassrooms } }); } })),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Skapa klassrum f\u00F6r kursen"))
                                    :
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { placeholder: "Google classroom URL", type: "text", size: 30, value: course.googleClassRoomURL, onChange: function (ev) { return host.update({ googleClassRoomURL: { $set: ev.target.value } }); } })),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { placeholder: "kod", type: "text", size: 8, value: course.googleClassRoomCode, onChange: function (ev) { return host.update({ googleClassRoomCode: { $set: ev.target.value } }); } })))),
                            course.isTemplate ? null : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_teacher_list__WEBPACK_IMPORTED_MODULE_9__["EditableTeacherList"], { school: course.school, teachers: course.responsibleTeachers, onUpdate: function (teachersUpdate) {
                                        host.update({ responsibleTeachers: { $set: teachersUpdate } });
                                    } }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                displayStudyGroups && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "select-studygroups" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_10__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Studiegrupper"], ["Studiegrupper"])))),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_observe__WEBPACK_IMPORTED_MODULE_16__["Observe"], { fallback: react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_8__["Spinner"], null), errorFallback: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_10__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda studiegrupper fr\u00E5n EDS"], ["Kunde inte ladda studiegrupper fr\u00E5n EDS"]))) },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_select_study_groups__WEBPACK_IMPORTED_MODULE_17__["SelectStudyGroups"], { school: course.school, courseCode: course.code, selectedStudyGroups: course.studyGroups || [], onUpdate: function (studyGroups) { return host.update({ studyGroups: { $set: studyGroups } }); } })))))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { id: "Kursensmoduler" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kursens moduler"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module_list__WEBPACK_IMPORTED_MODULE_4__["CourseModuleList"], { host: host, course: course, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_weighted_items_table__WEBPACK_IMPORTED_MODULE_11__["WeightedItemsTable"], { course: course })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kursens status"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        course.createdBy && course.createdDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen skapades ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.createdDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.createdBy.name),
                            "."),
                        course.modifiedBy && course.modifiedDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen redigerades senast ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.modifiedDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.modifiedBy.name),
                            "."),
                        course.active ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen \u00E4r ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, "AKTIV"),
                            " sedan ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.activatedDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.activatedBy.name),
                            ".") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen \u00E4r ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, "INAKTIV"),
                            course.inactivatedBy ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                                "sedan ",
                                Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.inactivatedDate),
                                " av ",
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.inactivatedBy.name),
                                ".") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null, ".")),
                        (uncoveredKnowledgeRequirements.length === 0 ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "markedGreen" }, "Modulernas kunskapskrav t\u00E4cker skolverkets krav f\u00F6r denna kurs") :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "markedRed warning-box" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Modulernas kunskapskrav t\u00E4cker inte skolverkets krav f\u00F6r denna kurs."))),
                        sanityCheckWarnings.map(function (warning) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: warning, className: "markedRed warning-box" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, warning)); }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        canDelete && !course.isTemplate && (origCourse ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () {
                                if (confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_10__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Bekr\u00E4fta borttagning av kursen \"", " - ", "\" f\u00F6r skolan ", "\n\nKursen kommar att raderas helt!\n\n\u00C4r du s\u00E4ker?"], ["Bekr\u00E4fta borttagning av kursen \"", " - ", "\" f\u00F6r skolan ", "\\n\\nKursen kommar att raderas helt!\\n\\n\u00C4r du s\u00E4ker?"])), course.name, course.description, course.school)))
                                    host.deleteCourse().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_10__["showError"]);
                            } }, "Ta bort kurs") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return history.go(-1); } }, "Avbryt")),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large", onClick: function () { return host.confirmSaveAndSync(); } }, "Spara"),
                        course.active ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-info btn-large", onClick: function () { return host.inactivateAndSave(); } }, "Inaktivera och spara") :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-info btn-large", onClick: function () { return host.activateAndSave(); } }, "Aktivera och spara"),
                        course.googleCreateClassrooms && displayStudyGroups &&
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-primary btn-large pull-right", onClick: function () { return host.syncWithClassroomAndSave(); } },
                                host.syncInProgress() ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_8__["Spinner"], null) :
                                    (course.inSyncWithClassroom ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fas fa-check", "aria-hidden": "true" })) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fas fa-code-branch" }))),
                                "\u00A0Sync med klassrum")))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_school_courses__WEBPACK_IMPORTED_MODULE_5__["SchoolCourses"], null)));
    };
    return InnerEditCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/index.tsx":
/*!*************************************************!*\
  !*** ./src/components/course-builder/index.tsx ***!
  \*************************************************/
/*! exports provided: CourseBuilder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBuilder", function() { return CourseBuilder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _schools__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./schools */ "./src/components/course-builder/schools/index.tsx");
/* harmony import */ var _schools_new_school__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./schools/new-school */ "./src/components/course-builder/schools/new-school.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _subjects__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./subjects */ "./src/components/course-builder/subjects/index.tsx");
/* harmony import */ var _courses__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./courses */ "./src/components/course-builder/courses/index.tsx");
/* harmony import */ var _schools_edit_school__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./schools/edit-school */ "./src/components/course-builder/schools/edit-school.tsx");
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _courses_create_new__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./courses/create-new */ "./src/components/course-builder/courses/create-new.tsx");
/* harmony import */ var _utils_keep_session_alive__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/keep-session-alive */ "./src/utils/keep-session-alive.ts");








// Views





// Keep Session Alive

Object(_utils_keep_session_alive__WEBPACK_IMPORTED_MODULE_13__["keepSessionAlive"])();
var CourseBuilder = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseBuilder, _super);
    function CourseBuilder(props) {
        return _super.call(this, props) || this;
    }
    CourseBuilder.prototype.render = function () {
        var _this = this;
        var isAuthorized = _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser.roles.some(function (role) { return role === "ADMIN" || role === "EMPLOYEE"; });
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-builder" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["HashRouter"], null, isAuthorized ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/", render: function (_a) {
                        var match = _a.match;
                        return isAdmin ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools__WEBPACK_IMPORTED_MODULE_5__["Schools"], { viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl }) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_create_new__WEBPACK_IMPORTED_MODULE_12__["CreateNewCourse"], { feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools__WEBPACK_IMPORTED_MODULE_5__["Schools"], { viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/new/gymnasium", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_new_school__WEBPACK_IMPORTED_MODULE_6__["NewSchool"], { type: "gymnasium", feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/new/primary", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_new_school__WEBPACK_IMPORTED_MODULE_6__["NewSchool"], { type: "primary", feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/:id/edit", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_edit_school__WEBPACK_IMPORTED_MODULE_10__["EditSchool"], { id: match.params.id, title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Editera skola"], ["Editera skola"]))), feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/subjects", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects__WEBPACK_IMPORTED_MODULE_8__["Subjects"], { feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/subjects/:id", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects__WEBPACK_IMPORTED_MODULE_8__["ShowSubject"], { id: match.params.id, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/courses/new", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_create_new__WEBPACK_IMPORTED_MODULE_12__["CreateNewCourse"], { feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/courses/create-from-template/:templateId", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses__WEBPACK_IMPORTED_MODULE_9__["EditCourse"], { templateId: match.params.templateId, view: "courseBuilder", viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/courses/:id/edit", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses__WEBPACK_IMPORTED_MODULE_9__["EditCourse"], { id: match.params.id, view: "courseBuilder", viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } })) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_11__["CourseBanner"], { title: "Kursbyggaren", activePage: "courseBuilder", routes: { feedback: _this.props.feedbackUrl } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Beh\u00F6righet saknas"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Detta verktyg \u00E4r endast till f\u00F6r anst\u00E4llda p\u00E5 Kunskapsskolan."),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Anv\u00E4ndarattribut"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "ked_boxed", style: { border: "1px solid #eee" } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Attribut"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "V\u00E4rde"))),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, Object.keys(_globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser).map(function (attr) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: attr },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, attr),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser[attr])); })))); } }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_4__["ErrorSuccessFeedback"], null));
    };
    return CourseBuilder;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-resource.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-resource.tsx ***!
  \*********************************************************************/
/*! exports provided: EditResource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditResource", function() { return EditResource; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_4__);





var EditResource = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditResource, _super);
    function EditResource(props) {
        var _this = _super.call(this, props) || this;
        _this.state = _this.props.resource || { name: '', url: '' };
        return _this;
    }
    EditResource.prototype.save = function () {
        var resource = this.state;
        if (!valid_url__WEBPACK_IMPORTED_MODULE_4___default.a.isUri(resource.url))
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med exempelvis http:, https: eller mailto:"], ["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med exempelvis http:, https: eller mailto:"])), resource.url));
        this.props.onSave(resource);
    };
    EditResource.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, onSave = _a.onSave, onDelete = _a.onDelete;
        var resource = this.state;
        var isValidUrl = valid_url__WEBPACK_IMPORTED_MODULE_4___default.a.isUri(this.state.url);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Namn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: true, tabIndex: 1, size: 50, value: resource.name, onChange: function (ev) { return _this.setState({ name: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "L\u00E4nk:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top " },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, value: resource.url, onChange: function (ev) { return _this.setState({ url: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                (resource.createdDate || resource.modifiedDate) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    resource.createdDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        "Resursen/L\u00E4nken skapades ",
                        Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(resource.createdDate),
                        " av ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, resource.createdBy.name),
                        "."),
                    resource.modifiedDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        "Resursen/L\u00E4nken redigerades senast ",
                        Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(resource.modifiedDate),
                        " av ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, resource.modifiedBy.name),
                        "."),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                onDelete && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () { return onDelete(); } }, "Ta bort resurs/l\u00E4nk"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large" + (isValidUrl ? "" : " btn-inactive"), onClick: isValidUrl && (function () { return onSave(resource); }) }, "Spara")));
    };
    return EditResource;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx":
/*!********************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx ***!
  \********************************************************************************************/
/*! exports provided: BasicEditableTaskFields */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicEditableTaskFields", function() { return BasicEditableTaskFields; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _task_migration_box__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./task-migration-box */ "./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx");
/* harmony import */ var _apis_google_picker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../apis/google-picker */ "./src/apis/google-picker.ts");
/* harmony import */ var _apis_buttons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../apis/buttons */ "./src/apis/buttons.tsx");







function BasicEditableTaskFields(_a) {
    var task = _a.task, course = _a.course, writeAccess = _a.writeAccess, features = _a.features, editTask = _a.editTask;
    var showGooglePicker = features.picker;
    return react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", null,
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("h2", null, "Uppgiftens namn och l\u00E4nk"),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal spaced" },
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Uppgiftens namn:")),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("input", { autoFocus: true, type: "text", size: 35, value: task.name, disabled: !writeAccess, readOnly: !writeAccess, onChange: function (ev) {
                        var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                        newTask.name = ev.target.value;
                        editTask.setStatePromised({ task: newTask });
                    } }))),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal spaced" },
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "URL:")),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("input", { className: "horizontalItem", type: "text", size: 35, value: task.url, disabled: !writeAccess, readOnly: !writeAccess, onChange: function (ev) {
                            var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                            newTask.url = ev.target.value;
                            editTask.setStatePromised({ task: newTask });
                        } })),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" }, showGooglePicker && react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_apis_buttons__WEBPACK_IMPORTED_MODULE_6__["DriveButton"], { label: "", action: function () {
                        var picker = new _apis_google_picker__WEBPACK_IMPORTED_MODULE_5__["GooglePicker"]({ upload: true });
                        picker.show().then(function (files) {
                            var fileurl = files[0].url;
                            var viewurl = fileurl.substr(0, fileurl.lastIndexOf('/')) + "/view";
                            if (viewurl == task.url)
                                return;
                            var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                            newTask.url = viewurl;
                            editTask.setStatePromised({ task: newTask });
                        });
                    } })))),
        task.migratedTexts && writeAccess && react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_task_migration_box__WEBPACK_IMPORTED_MODULE_4__["TaskMigrationBox"], { task: task, course: course, updateLink: function (id, linkOrUnlink) { return editTask.updateLink(id, linkOrUnlink); } }),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("h2", null, "Inl\u00E4mningsuppgift"),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "checkBox" + (editTask.getTaskProp("assignment") ? " checked" : ""), onClick: function () {
                            editTask.updateTaskOrCustomization("assignment", { $set: !editTask.getTaskProp("assignment") });
                        } })),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Den h\u00E4r uppgiften \u00E4r en inl\u00E4mningsuppgift"))),
            editTask.getTaskProp("assignment") && react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Inl\u00E4mningsdatum"),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_1__["default"], { nextMonthButtonLabel: "", previousMonthButtonLabel: "", showWeekNumbers: true, selected: editTask.getTaskProp("deadline") && moment__WEBPACK_IMPORTED_MODULE_2___default()(editTask.getTaskProp("deadline")).toDate(), dateFormat: "YYYY-MM-dd", locale: "sv", popperPlacement: "bottom-start", onChange: function (value) {
                                editTask.updateTaskOrCustomization("deadline", { $set: moment__WEBPACK_IMPORTED_MODULE_2___default()(value).format("YYYY-MM-DD") });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" }, editTask.getTaskProp("deadline") && react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("a", { className: "deleteDate", href: "#", title: "Ta bort inl\u00E4mningsdatum", onClick: function (ev) {
                            ev.preventDefault();
                            editTask.updateTaskOrCustomization("deadline", { $set: null });
                        } }))),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "taskContainer" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "checkBox" + ((task.sendToUrkund == null ? true : task.sendToUrkund) ? " checked" : ""), onClick: function () {
                                    return editTask.updateTaskOrCustomization("sendToUrkund", { $set: task.sendToUrkund == null ? false : !task.sendToUrkund });
                                } })),
                        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Verify assignments with Urkund")))))));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/edit-task.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/edit-task.tsx ***!
  \***************************************************************************/
/*! exports provided: EditTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditTask", function() { return EditTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sub-components/knowledge-matrix */ "./src/components/course-builder/sub-components/knowledge-matrix.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../sub-components/select-related-docs */ "./src/components/course-builder/sub-components/select-related-docs.tsx");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_cached_response__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../utils/cached-response */ "./src/utils/cached-response.ts");
/* harmony import */ var _contracts_ked_models__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../contracts/ked-models */ "./src/contracts/ked-models.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../../features */ "./src/features/index.ts");
/* harmony import */ var _search_results__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./search-results */ "./src/components/course-builder/modal-pages/edit-task/search-results.tsx");
/* harmony import */ var _basic_editable_task_fields__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./basic-editable-task-fields */ "./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx");
/* harmony import */ var _task_status_fragment__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./task-status-fragment */ "./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx");
/* harmony import */ var _save_or_cancel_buttons__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./save-or-cancel-buttons */ "./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx");
/* harmony import */ var _previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./previewable-task-fields */ "./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx");



















var EditTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditTask, _super);
    function EditTask(props) {
        var _this = _super.call(this, props) || this;
        _this.features = new _features__WEBPACK_IMPORTED_MODULE_13__["Features"]();
        var writeAccess = !props.task || Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, props.task);
        _this.state = {
            title: props.task ?
                writeAccess ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera uppgift till \"", "\""], ["Redigera uppgift till \"", "\""])), props.module.name) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Visa uppgift till \"", "\""], ["Visa uppgift till \"", "\""])), props.module.name) :
                props.searchMode ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["S\u00F6k ny uppgift till \"", "\""], ["S\u00F6k ny uppgift till \"", "\""])), props.module.name) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till egen uppgift till \"", "\""], ["L\u00E4gg till egen uppgift till \"", "\""])), props.module.name),
            futureAbilitiesOpen: false,
            taskCustomization: props.taskCustomization || {},
            task: props.task ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ $meta: props.task.$meta || 'update' }, props.task) : props.searchMode ? null :
                // No task was given. Set $meta = 'add' to inform EditCourse.save()
                // to add the task to the tasks table.
                {
                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(),
                    $meta: 'add',
                    tags: [
                        "sub:" + props.course.subjectCode,
                        "course:" + props.course.code
                    ],
                    school: !props.course.isTemplate && _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school,
                    resources: [],
                    abilities: [],
                    centralContent: [],
                    futureAbilities: [],
                    knowledgeRequirements: [],
                    name: "",
                    url: "",
                    acl: props.course.isTemplate ? [
                        "role:USER:R" // (OK to keep after kursbygg-changes). Templates (which will be empty!) will not have tasks. If they had, might not tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)
                    ] : [
                        "role:USER:R",
                        "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school + "/EMPLOYEE:S"
                    ]
                },
            searchMarkedIds: props.searchMode && [],
            searchResult: props.searchMode && [],
            isSearching: props.searchMode
        };
        if (props.searchMode) {
            _this.searchResponse = new _utils_cached_response__WEBPACK_IMPORTED_MODULE_9__["CachedResponse"](function () {
                return _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].kedBackendClient.list("tasks", {
                    tags: "course:" + props.course.code,
                    include: ['knowledgeRequirements', 'abilities', 'centralContent'],
                    flags: ['includeIdsOnly']
                });
            });
        }
        return _this;
    }
    EditTask.prototype.setStatePromised = function (state) {
        var _this = this;
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, function () { return state; }, resolve); });
    };
    EditTask.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.props.searchMode) return [3 /*break*/, 8];
                        this.setStatePromised({ isSearching: true });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 5, 6, 8]);
                        return [4 /*yield*/, this.searchResponse.query()];
                    case 2:
                        _a.sent();
                        if (!(this.state.searchMarkedIds && this.state.searchMarkedIds.length === 0)) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.updateSearchResult(this.state.searchMarkedIds)];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [3 /*break*/, 8];
                    case 5:
                        err_1 = _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["showError"])(err_1);
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.setStatePromised({ isSearching: false })];
                    case 7:
                        _a.sent();
                        return [7 /*endfinally*/];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.updateSearchMarkedIds = function (searchMarkedIds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var setStatePromise;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        setStatePromise = this.setStatePromised({ task: null, searchMarkedIds: searchMarkedIds, previewTaskContent: null });
                        if (!!this.searchResponse.result) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.searchResponse.promise];
                    case 1:
                        _a.sent();
                        // Refresh searchMarkedIds now as user might have clicked around while waiting for
                        // tasks to load...
                        return [4 /*yield*/, setStatePromise];
                    case 2:
                        // Refresh searchMarkedIds now as user might have clicked around while waiting for
                        // tasks to load...
                        _a.sent(); // So we know state has been reflected...
                        searchMarkedIds = this.state.searchMarkedIds;
                        _a.label = 3;
                    case 3: return [4 /*yield*/, this.updateSearchResult(searchMarkedIds)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.updateSearchResult = function (searchMarkedIds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var allTasksForSubject, searchResult;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.searchResponse.query()];
                    case 1:
                        allTasksForSubject = _a.sent();
                        searchResult = allTasksForSubject.filter(function (t) {
                            return searchMarkedIds.every(function (id) {
                                return t.knowledgeRequirements.some(function (kr) { return kr.id === id; }) ||
                                    t.abilities.some(function (a) { return a.id === id; }) ||
                                    t.centralContent.some(function (c) { return c.id === id; });
                            });
                        });
                        this.setStatePromised({
                            searchResult: searchResult
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.onMarkChanged = function (id, isMarked) {
        var searchMode = this.props.searchMode;
        if (searchMode) {
            var searchMarkedIds = this.state.searchMarkedIds;
            this.updateSearchMarkedIds(isMarked ?
                searchMarkedIds.concat(id) :
                searchMarkedIds.filter(function (x) { return x !== id; })).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["showError"]);
            return;
        }
        this.updateLink(id, isMarked);
    };
    EditTask.prototype.updateLink = function (id, linkOrUnlink) {
        var course = this.props.course;
        var task = this.state.task;
        // One of the following three will be found:
        var ability = course.abilities.find(function (a) { return a.id === id; });
        var knowledgeRequirement = course.knowledgeRequirements.find(function (r) { return r.id === id; });
        var centralContent = course.centralContent.find(function (cc) { return cc.id === id; });
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](ability ?
            ["abilities", ability] :
            knowledgeRequirement ?
                ["knowledgeRequirements", knowledgeRequirement] :
                centralContent ?
                    ["centralContent", centralContent] :
                    [null, null], 2), collectionProp = _a[0], item = _a[1];
        if (!collectionProp) {
            console.error("Could not find marked id " + id);
            return;
        }
        var updatedCollection = task[collectionProp].slice();
        var currentPos = updatedCollection.findIndex(function (doc) { return doc.id === id; });
        if (linkOrUnlink) {
            if (currentPos < 0) {
                updatedCollection.push(item);
            }
        }
        else {
            if (currentPos >= 0) {
                updatedCollection.splice(currentPos, 1);
            }
        }
        var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
        updatedTask[collectionProp] = updatedCollection;
        // Clear migratedTexts from task.
        // First deep clone:
        if (task && task.migratedTexts) {
            updatedTask.migratedTexts = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task.migratedTexts);
            if (task.migratedTexts[collectionProp]) {
                updatedTask.migratedTexts[collectionProp] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task.migratedTexts[collectionProp]);
                // Delete the id within the deep clone:
                delete updatedTask.migratedTexts[collectionProp][id];
            }
        }
        this.setStatePromised({
            task: updatedTask
        });
    };
    EditTask.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, task, taskCustomization, writeAccess;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
                        writeAccess = Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
                        if (!writeAccess) return [3 /*break*/, 5];
                        if (!task.url && !task.content)
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Uppgiften m\u00E5ste antingen ha en URL eller ett inneh\u00E5ll"], ["Uppgiften m\u00E5ste antingen ha en URL eller ett inneh\u00E5ll"]))));
                        if (task.url && !valid_url__WEBPACK_IMPORTED_MODULE_7___default.a.isUri(task.url))
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Den ska b\u00F6rja med http: eller https:"], ["Angiven URL '", "' \u00E4r ogiltig. Den ska b\u00F6rja med http: eller https:"])), task.url));
                        if (!(this.props.task && this.props.task.id !== task.id)) return [3 /*break*/, 2];
                        // Replace existing task with copy
                        return [4 /*yield*/, this.props.onReplace(this.props.task.id, task)];
                    case 1:
                        // Replace existing task with copy
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Update existing task
                    return [4 /*yield*/, this.props.onSave(task, null)];
                    case 3:
                        // Update existing task
                        _b.sent();
                        _b.label = 4;
                    case 4: return [3 /*break*/, 9];
                    case 5:
                        if (!this.props.searchMode) return [3 /*break*/, 7];
                        return [4 /*yield*/, this.props.onSave(task, taskCustomization)];
                    case 6:
                        _b.sent();
                        return [3 /*break*/, 9];
                    case 7:
                        if (this.props.course.isTemplate && task.$meta === 'add')
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Du saknar beh\u00F6righet f\u00F6r att spara nya versioner av uppgifter i kursmallen"], ["Du saknar beh\u00F6righet f\u00F6r att spara nya versioner av uppgifter i kursmallen"]))));
                        return [4 /*yield*/, this.props.onSaveCustomization(taskCustomization)];
                    case 8:
                        _b.sent();
                        _b.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.copyTask = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var taskCopy;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        taskCopy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.task, (this.state.taskCustomization || {}), { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(), acl: this.props.course.isTemplate ? [
                                "role:USER:R" // (OK to keep but this check might become unnescesary if we totally remove the possibility to edit templates) Template tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)
                            ] : [
                                "role:USER:R",
                                "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school + "/EMPLOYEE:S"
                            ], school: this.props.course.school });
                        taskCopy.$meta = 'add';
                        return [4 /*yield*/, this.setStatePromised({
                                task: taskCopy,
                                title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera kopierad uppgift till \"", "\""], ["Redigera kopierad uppgift till \"", "\""])), this.props.module.name),
                                taskCustomization: undefined
                            })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.getTaskProp = function (taskProp) {
        var _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
        var customization = taskCustomization && taskCustomization[taskProp];
        return customization !== undefined ?
            customization :
            task[taskProp];
    };
    EditTask.prototype.updateTaskOrCustomization = function (taskProp, updates) {
        var _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
        var writeAccess = task && Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
        if (writeAccess && (!taskCustomization || taskCustomization[taskProp] === undefined)) {
            var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
            newTask[taskProp] = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(task[taskProp], updates);
            this.setStatePromised({ task: newTask });
        }
        else {
            var newCustomization = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, taskCustomization);
            newCustomization[taskProp] = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(newCustomization[taskProp] || task[taskProp], updates);
            this.setStatePromised({ taskCustomization: newCustomization });
        }
    };
    EditTask.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, module = _a.module, onCancel = _a.onCancel, onDelete = _a.onDelete, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, searchMode = _a.searchMode;
        var _b = this.state, task = _b.task, taskCustomization = _b.taskCustomization, title = _b.title, searchResult = _b.searchResult, searchMarkedIds = _b.searchMarkedIds, isSearching = _b.isSearching;
        var markedIds = searchMode ?
            searchMarkedIds :
            task.centralContent.map(function (x) { return x.id; })
                .concat(task.abilities.map(function (x) { return x.id; }))
                .concat(task.knowledgeRequirements.map(function (x) { return x.id; }));
        var writeAccess = task && Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
        var taskUrlValid = task && valid_url__WEBPACK_IMPORTED_MODULE_7___default.a.isUri(task.url);
        var features = this.features;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, title))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-fluid-grid sv-grid-ksgs12 sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-6" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, searchMode ?
                                    "Filtrera på kunskapskrav" : writeAccess ?
                                    "Välj kunskapskrav" :
                                    "Kunskapskrav"),
                                searchMode ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Markera de kunskapskrav som uppgiften m\u00E5ste t\u00E4cka.") : writeAccess &&
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Markera de kunskapskrav som din uppgift t\u00E4cker."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_3__["KnowledgeMatrix"], { knowledgeRequirements: course.knowledgeRequirements, markedIds: markedIds, idsToMarkNotOk: idsNotCoveredByAnyTask, markMode: searchMode || writeAccess, migratedIds: task && task.migratedTexts && task.migratedTexts.knowledgeRequirements, onMarkChanged: this.onMarkChanged.bind(this) }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__["SelectRelatedDocs"], { options: course.abilities, title: writeAccess || searchMode ? "Välj förmågor" : "Förmågor", markedIds: markedIds, markMode: writeAccess || searchMode, migratedIds: task && task.migratedTexts && task.migratedTexts.abilities, onMarkChanged: this.onMarkChanged.bind(this) })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__["SelectRelatedDocs"], { options: course.centralContent, title: writeAccess || searchMode ? "Välj centralt innehåll" : "Centralt innehåll", markedIds: markedIds, markMode: writeAccess || searchMode, migratedIds: task && task.migratedTexts && task.migratedTexts.centralContent, onMarkChanged: this.onMarkChanged.bind(this) })),
                        !searchMode && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose larger" + (this.state.futureAbilitiesOpen ? " open" : "") },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setStatePromised({ futureAbilitiesOpen: !_this.state.futureAbilitiesOpen }); } }, writeAccess ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "V\u00E4lj ytterligare alternativ") :
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Ytterligare alternativ")),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Framtidsf\u00F6rm\u00E5gor"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, _contracts_ked_models__WEBPACK_IMPORTED_MODULE_10__["futureAbilities"].map(function (fa) {
                                        var selected = task.futureAbilities.indexOf(fa) >= 0;
                                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: fa },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (selected ? " checked" : ""), onClick: writeAccess ? function () {
                                                        var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                                                        updatedTask.futureAbilities =
                                                            selected ?
                                                                task.futureAbilities.filter(function (a) { return a != fa; }) :
                                                                task.futureAbilities.concat(fa);
                                                        _this.setStatePromised({ task: updatedTask });
                                                    } : undefined })),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, fa));
                                    })))))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-6" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                            isSearching && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__["Spinner"], null),
                                " Laddar uppgifter..."),
                            searchResult ?
                                /*
                                 *
                                 * Search Results Fragent
                                 *
                                 *
                                 */
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_search_results__WEBPACK_IMPORTED_MODULE_14__["SearchResults"], { searchMarkedIds: searchMarkedIds, searchResult: searchResult, task: task, writeAccess: writeAccess, taskCustomization: taskCustomization, editTask: this }),
                                    this.state.previewTaskContent ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: this.state.previewTaskContent } })
                                        : task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__["PreviewableTaskFields"], { writeAccess: writeAccess, task: task, taskCustomization: taskCustomization, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_status_fragment__WEBPACK_IMPORTED_MODULE_16__["TaskStatusFragment"], { task: task })) :
                                /*
                                 *
                                 * Edit Tasks Fragment
                                 *
                                 *
                                 */
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_basic_editable_task_fields__WEBPACK_IMPORTED_MODULE_15__["BasicEditableTaskFields"], { task: task, course: course, writeAccess: writeAccess, features: features, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__["PreviewableTaskFields"], { writeAccess: writeAccess, task: task, taskCustomization: taskCustomization, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_status_fragment__WEBPACK_IMPORTED_MODULE_16__["TaskStatusFragment"], { task: task }))),
                        task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_save_or_cancel_buttons__WEBPACK_IMPORTED_MODULE_17__["SaveOrCancelButtons"], { writeAccess: writeAccess, editTask: this })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" }))));
    };
    return EditTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/index.ts":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/index.ts ***!
  \**********************************************************************/
/*! exports provided: EditTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _edit_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./edit-task */ "./src/components/course-builder/modal-pages/edit-task/edit-task.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EditTask", function() { return _edit_task__WEBPACK_IMPORTED_MODULE_0__["EditTask"]; });




/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx":
/*!*****************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx ***!
  \*****************************************************************************************/
/*! exports provided: PreviewableTaskFields */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreviewableTaskFields", function() { return PreviewableTaskFields; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _task_content_fragment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./task-content-fragment */ "./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx");




function PreviewableTaskFields(_a) {
    var writeAccess = _a.writeAccess, task = _a.task, taskCustomization = _a.taskCustomization, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Uppgiftens l\u00E4randem\u00E5l"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "inputTextBox learning-goal-box", disabled: !writeAccess, value: task.learningGoal, onChange: function (ev) {
                        var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                        newTask.learningGoal = ev.target.value;
                        editTask.setStatePromised({ task: newTask });
                    } }))),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, (writeAccess || !!task.content) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_content_fragment__WEBPACK_IMPORTED_MODULE_3__["TaskContentFragment"], { writeAccess: writeAccess, task: task, editTask: editTask })),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            taskCustomization && taskCustomization.resources ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Resurser f\u00F6r uppgiften (modifierad f\u00F6r denna kursinstans)") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Resurser kopplade till uppgiften"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: (taskCustomization && taskCustomization.resources) || task.resources, host: editTask.props.host, onUpdate: function (resourceUpdates) {
                    editTask.updateTaskOrCustomization("resources", resourceUpdates);
                } })));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx":
/*!****************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx ***!
  \****************************************************************************************/
/*! exports provided: SaveOrCancelButtons */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SaveOrCancelButtons", function() { return SaveOrCancelButtons; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");


function SaveOrCancelButtons(_a) {
    var writeAccess = _a.writeAccess, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
        !!editTask.props.onDelete && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return editTask.props.onDelete(); } }, "Ta bort fr\u00E5n kursmodul"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pull-right" }, "\u00A0"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return editTask.props.onCancel(); } }, "Avbryt"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-large", onClick: function () { return editTask.save().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["showError"]); } }, "Spara"),
        !writeAccess && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-large", onClick: function () { return editTask.copyTask().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["showError"]); } }, "Skapa kopia av den h\u00E4r uppgiften"));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/search-results.tsx":
/*!********************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/search-results.tsx ***!
  \********************************************************************************/
/*! exports provided: SearchResults */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SearchResults", function() { return SearchResults; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");



function SearchResults(_a) {
    var searchMarkedIds = _a.searchMarkedIds, searchResult = _a.searchResult, task = _a.task, editTask = _a.editTask, writeAccess = _a.writeAccess, taskCustomization = _a.taskCustomization;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "task-search-result" + (!editTask.state.task && !editTask.state.previewTaskContent ? " fixed" : "") },
        searchMarkedIds.length === 0 ?
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "Samtliga uppgifter f\u00F6r kursen") :
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "Uppgifter som t\u00E4cker valda filter"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tbody", null, searchResult
                .filter(task ?
                function (foundTask) { return foundTask.id === task.id; } :
                function () { return true; })
                .map(function (foundTask) { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], { key: foundTask.id },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", null,
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { tabIndex: 1, className: "checkBox" + (task && task.id === foundTask.id ? " checked" : ""), onClick: function () { return toggleChooseTask(foundTask); } })),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, foundTask.content ?
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: "#", onClick: function (ev) {
                                toggleChooseTask(foundTask);
                                ev.preventDefault();
                                ev.stopPropagation();
                            } }, foundTask.name) :
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: foundTask.url, target: "_blank" }, foundTask.name)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, Object(_utils__WEBPACK_IMPORTED_MODULE_2__["shortPersonNameFormat"])(foundTask.modifiedBy.name)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, foundTask.school || "Standard"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, Object(_utils__WEBPACK_IMPORTED_MODULE_2__["shortDateFormat"])(foundTask.modifiedDate)))); }))),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("br", null),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("hr", null));
    function toggleChooseTask(foundTask) {
        if (task && task.id === foundTask.id) {
            editTask.updateSearchMarkedIds(searchMarkedIds);
        }
        else {
            Object(react_dom__WEBPACK_IMPORTED_MODULE_1__["findDOMNode"])(editTask).parentElement.scrollTop = 0;
            editTask.setStatePromised({ task: foundTask, previewTaskContent: null });
        }
    }
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx":
/*!***************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx ***!
  \***************************************************************************************/
/*! exports provided: TaskContentFragment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskContentFragment", function() { return TaskContentFragment; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utility-components/wysiwyg */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");




function TaskContentFragment(_a) {
    var writeAccess = _a.writeAccess, task = _a.task, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Uppgiftens inneh\u00E5ll"),
        writeAccess && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Om uppgiften inte l\u00E4nkar till n\u00E5got dokument kan du l\u00E4gga inneh\u00E5ll h\u00E4r."),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_2__["Wysiwyg"], { actions: [
                "bold",
                "italic",
                "underline",
                "strikethrough",
                "heading2",
                "heading3",
                "olist",
                "ulist",
                "line",
                "link",
                "image"
            ], defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_3__["default"], readOnly: !writeAccess, html: task.content, onChange: function (html) {
                var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                newTask.content = html;
                editTask.setState({ task: newTask });
            } }));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx":
/*!************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx ***!
  \************************************************************************************/
/*! exports provided: TaskMigrationBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskMigrationBox", function() { return TaskMigrationBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");



var TaskMigrationBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskMigrationBox, _super);
    function TaskMigrationBox(props) {
        return _super.call(this, props) || this;
    }
    TaskMigrationBox.prototype.render = function () {
        var _a = this.props, task = _a.task, course = _a.course, updateLink = _a.updateLink;
        if (!task.migratedTexts)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0");
        var _b = task.migratedTexts, abilities = _b.abilities, centralContent = _b.centralContent, knowledgeRequirements = _b.knowledgeRequirements;
        var krs = Object.keys(knowledgeRequirements || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.knowledgeRequirements.find(function (t) { return t.id === id; }), knowledgeRequirements[id])); }); //.filter(({name}) => !!name);
        var krA = { title: "Uppdaterat kunskapskrav för betyget A", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'A'; }) };
        var krC = { title: "Uppdaterat Kunskapskrav för betyget C", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'C'; }) };
        var krE = { title: "Uppdaterat kunskapskrav för betyget E", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'E'; }) };
        var abs = { title: "Uppdaterade förmågor", type: "abilities", items: Object.keys(abilities || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.abilities.find(function (t) { return t.id === id; }), abilities[id])); }) }; //.filter(({name}) => !!name)};
        var ccs = { title: "Uppdaterat centralt innehåll", type: "centralContent", items: Object.keys(centralContent || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.centralContent.find(function (cc) { return cc.id == id; }), centralContent[id])); }) }; //.filter(({name}) => !!name)};
        var tablesToShow = [krA, krC, krE, ccs, abs].filter(function (boxInfo) { return boxInfo.items.length > 0; });
        if (tablesToShow.length === 0)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0");
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { className: "larger", title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Uppdaterade formuleringar fr\u00E5n Skolverket")) }, tablesToShow.map(function (_a) {
            var title = _a.title, type = _a.type, items = _a.items;
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: title },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { style: { width: "40%" } }, "Ursprunglig formulering"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { style: { width: "40%" } }, "Skolverkets nya formulering"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "T\u00E4cker uppgiften den nya formuleringen?"))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, items.map(function (item) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: item.id },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { dangerouslySetInnerHTML: { __html: item.oldText } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { dangerouslySetInnerHTML: { __html: item.name } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return updateLink(item.id, true); } }, "Ja - beh\u00E5ll kopplingen"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return updateLink(item.id, false); } }, "Nej - ta bort kopplingen"))); }))));
        })));
    };
    return TaskMigrationBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx":
/*!**************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx ***!
  \**************************************************************************************/
/*! exports provided: TaskStatusFragment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskStatusFragment", function() { return TaskStatusFragment; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");


function TaskStatusFragment(_a) {
    var task = _a.task;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h3", null, "Uppgiftens status"),
        task.createdBy && task.createdDate && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null,
            "Uppgiften skapades ",
            Object(_utils__WEBPACK_IMPORTED_MODULE_1__["dtFormat"])(task.createdDate),
            " av ",
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("strong", null, task.createdBy.name),
            "."),
        task.modifiedBy && task.modifiedDate && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null,
            "Uppgiften redigerades senast ",
            Object(_utils__WEBPACK_IMPORTED_MODULE_1__["dtFormat"])(task.modifiedDate),
            " av ",
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("strong", null, task.modifiedBy.name),
            "."));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-workflow-link.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-workflow-link.tsx ***!
  \**************************************************************************/
/*! exports provided: EditWorkflowLink */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditWorkflowLink", function() { return EditWorkflowLink; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_3__);




var EditWorkflowLink = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditWorkflowLink, _super);
    function EditWorkflowLink(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { url: _this.props.url || '' };
        return _this;
    }
    EditWorkflowLink.prototype.save = function () {
        var url = this.state.url;
        if (!valid_url__WEBPACK_IMPORTED_MODULE_3___default.a.isUri(url))
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med http: eller https:"], ["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med http: eller https:"])), url));
        this.props.onSave(url);
    };
    EditWorkflowLink.prototype.render = function () {
        var _this = this;
        var _a = this.props, onSave = _a.onSave, onDelete = _a.onDelete;
        var state = this.state;
        var isValidUrl = valid_url__WEBPACK_IMPORTED_MODULE_3___default.a.isUri(this.state.url);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Koppla en arbetsg\u00E5ng till kursen"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Det g\u00E5r bara att l\u00E4gga in en arbetsg\u00E5ng per kurs."),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "L\u00E4nk:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top " },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, value: state.url, onChange: function (ev) { return _this.setState({ url: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet", id: "svid12_492422d515badf36646e4ff1" },
                onDelete && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () { return onDelete(); } }, "Ta bort arbetsg\u00E5ng"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large" + (isValidUrl ? "" : " btn-inactive"), onClick: isValidUrl && (function () { return onSave(state.url); }) }, "Spara")));
    };
    return EditWorkflowLink;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/schools/edit-school.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder/schools/edit-school.tsx ***!
  \***************************************************************/
/*! exports provided: EditSchool, EditSchoolNoBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchool", function() { return EditSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchoolNoBanner", function() { return EditSchoolNoBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");







var EditSchool = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", callbacks: { schools: function () { return location.hash = "#/schools"; } }, routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](EditSchoolNoBanner, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props))); };
var EditSchoolNoBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditSchoolNoBanner, _super);
    function EditSchoolNoBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = null;
        return _this;
    }
    EditSchoolNoBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    };
    EditSchoolNoBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var id, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.props.id) return [3 /*break*/, 2];
                        id = this.props.id;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.get("schools", id)];
                    case 1:
                        school = _a.sent();
                        this.origSchool = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school);
                        this.setState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school));
                        return [3 /*break*/, 3];
                    case 2:
                        // No id, create new instead.
                        this.setState({
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            officialBranchId: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            isGymnasium: this.props.type === 'gymnasium',
                            isPrimarySchool: this.props.type === 'primary'
                        });
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var r, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        r = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        school = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state, { tags: (this.state.tags || [])
                                .filter(function (tag) { return ["primary", "gymnasium"].indexOf(tag) < 0; }) });
                        if (school.isPrimarySchool)
                            school.tags.push("primary");
                        if (school.isGymnasium)
                            school.tags.push("gymnasium");
                        if (!(school.isGymnasium || school.isPrimarySchool)) {
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"], ["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"]))));
                        }
                        if (!this.origSchool) {
                            school.acl = ["role:USER:R"];
                            school.acl.push(new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString());
                            r.add("schools", school);
                            this.addSchoolBranch(school, r);
                        }
                        else if (this.origSchool.name !== this.state.name) {
                            throw new Error("Skolans namn får inte ändras. Kontakta Vemendo AB.");
                        }
                        else {
                            if (!school.officialBranchId) {
                                school.officialBranchId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
                                this.addSchoolBranch(school, r);
                            }
                            r.put("schools", school);
                        }
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(r.mutationRequests)];
                    case 1:
                        _a.sent();
                        location.hash = "#/schools";
                        return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.addSchoolBranch = function (school, r) {
        var branch = {
            id: school.officialBranchId,
            name: school.name,
            schoolId: school.id,
            acl: [
                "role:USER:R",
                new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString()
            ]
        };
        r.add("branches", branch);
    };
    EditSchoolNoBanner.prototype.deleteSchool = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schoolBranch, br_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(prompt(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"], ["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"])), this.state.name)) === this.state.name)) return [3 /*break*/, 3];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("branches", {
                                ids: [this.state.officialBranchId],
                                include: "approvedChildren",
                                flags: ["includeIdsOnly"]
                            })];
                    case 1:
                        schoolBranch = _a.sent();
                        br_1 = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        br_1.delete("schools", this.state.id);
                        schoolBranch[0].approvedChildren.forEach(function (_a) {
                            var id = _a.id;
                            br_1.delete("branches", id);
                        });
                        br_1.delete("branches", this.state.officialBranchId);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(br_1.mutationRequests)];
                    case 2:
                        _a.sent();
                        location.hash = "#/schools";
                        return [3 /*break*/, 4];
                    case 3:
                        alert("Skolan togs inte bort eftersom det namn du angav inte stämmer.");
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, id = _a.id;
        var editExisting = !!id;
        var school = this.state;
        var origSchool = this.origSchool;
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Namn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: !school || !school.name, disabled: !isAdmin || editExisting, tabIndex: 1, size: 50, value: school ? school.name : "", onChange: function (ev) { return _this.setState({ name: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Visningsnamn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: school && !school.displayName, disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.displayName : "", onChange: function (ev) { return _this.setState({ displayName: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                school && school.isGymnasium ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "EDS namn (gymnasium):"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.edsSchoolNameGymn : "", onChange: function (ev) { return _this.setState({ edsSchoolNameGymn: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })) : null,
                school && school.isPrimarySchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "EDS namn (grundskola):"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.edsSchoolNamePrim : "", onChange: function (ev) { return _this.setState({ edsSchoolNamePrim: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })) : null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Typ:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypePrimary", disabled: !isAdmin, checked: school && school.isPrimarySchool, tabIndex: 1, value: "primary", onChange: function (ev) { return _this.setState({ isPrimarySchool: ev.target.checked }); } }),
                        "\u00A0Grundskola"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypeGymnasium", disabled: !isAdmin, checked: school && school.isGymnasium, tabIndex: 1, value: "gymnasium", onChange: function (ev) { return _this.setState({ isGymnasium: ev.target.checked }); } }),
                        "\u00A0Gymnasium"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                isAdmin && editExisting && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () {
                        return _this.deleteSchool().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Ta bort skola"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pull-right" }, "\u00A0"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_6__["Link"], { className: "btn btn-warning btn-large pull-right", to: "/schools" }, "Avbryt"),
                isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large", onClick: function () {
                        if (origSchool && origSchool.name !== school.name) {
                            if (!confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."], ["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."]))))) {
                                return;
                            }
                        }
                        _this.save().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Spara")));
    };
    return EditSchoolNoBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/editable-school-list.tsx":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/schools/editable-school-list.tsx ***!
  \************************************************************************/
/*! exports provided: EditableSchoolList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableSchoolList", function() { return EditableSchoolList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var EditableSchoolList = function (props) {
    var schools = props.schools, viewCourseUrl = props.viewCourseUrl;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editable-school-list" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, schools.map(function (school) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { className: "align-horizontal", key: school.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { className: "editItem", to: "/schools/" + school.id + "/edit" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, school.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "EMPLOYEE", school: school.name }); } }, "Agera som l\u00E4rare p\u00E5 denna skola"))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "STUDENT", school: school.name, url: viewCourseUrl }); } }, "Agera som elev p\u00E5 denna skola"))));
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
            "V.g. v\u00E4nta medan skolor laddas")),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
        schools && isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { to: "/schools/new/" + props.type, className: "btn" }, props.type == 'gymnasium' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till gymnasieskola"], ["L\u00E4gg till gymnasieskola"]))) :
            props.type == 'primary' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till grundskola"], ["L\u00E4gg till grundskola"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"])))));
};
var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/index.tsx":
/*!*********************************************************!*\
  !*** ./src/components/course-builder/schools/index.tsx ***!
  \*********************************************************/
/*! exports provided: Schools, SchoolsWithoutBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolsWithoutBanner", function() { return SchoolsWithoutBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _editable_school_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editable-school-list */ "./src/components/course-builder/schools/editable-school-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var Schools = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](SchoolsWithoutBanner, { viewCourseUrl: props.viewCourseUrl })); };
var SchoolsWithoutBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolsWithoutBanner, _super);
    function SchoolsWithoutBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            schools: null
        };
        return _this;
    }
    SchoolsWithoutBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["showError"])(err.message || err); });
    };
    SchoolsWithoutBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schools;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("schools")];
                    case 1:
                        schools = _a.sent();
                        this.setState({ schools: schools });
                        return [2 /*return*/];
                }
            });
        });
    };
    SchoolsWithoutBanner.prototype.render = function () {
        var schools = this.state.schools;
        schools && schools.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("name"));
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" }, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Gymnasieskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isGymnasium; }), viewCourseUrl: this.props.viewCourseUrl, type: "gymnasium" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Grundskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isPrimarySchool; }), viewCourseUrl: this.props.viewCourseUrl, type: "primary" }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null)));
    };
    return SchoolsWithoutBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/schools/new-school.tsx":
/*!**************************************************************!*\
  !*** ./src/components/course-builder/schools/new-school.tsx ***!
  \**************************************************************/
/*! exports provided: NewSchool */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewSchool", function() { return NewSchool; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _edit_school__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./edit-school */ "./src/components/course-builder/schools/edit-school.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var NewSchool = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_school__WEBPACK_IMPORTED_MODULE_2__["EditSchool"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"]))), type: props.type, feedbackUrl: props.feedbackUrl }); };
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-resource-list.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-resource-list.tsx ***!
  \*********************************************************************************/
/*! exports provided: EditableResourceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableResourceList", function() { return EditableResourceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-resource */ "./src/components/course-builder/modal-pages/edit-resource.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _apis_buttons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../apis/buttons */ "./src/apis/buttons.tsx");
/* harmony import */ var _apis_google_picker__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../apis/google-picker */ "./src/apis/google-picker.ts");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");








var EditableResourceList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableResourceList, _super);
    function EditableResourceList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableResourceList.prototype.render = function () {
        var _a = this.props, host = _a.host, onUpdate = _a.onUpdate, resources = _a.resources;
        var showGooglePicker = _features__WEBPACK_IMPORTED_MODULE_7__["features"].picker;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, resources.map(function (resource, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return host.openDialog({
                                Component: _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__["EditResource"],
                                props: {
                                    title: "Redigera resurs",
                                    resource: resource,
                                    onSave: function (editedResource) {
                                        var updatedResource = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(editedResource, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                        onUpdate({ $splice: [[idx, 1, updatedResource]] });
                                        host.closeDialog();
                                    },
                                    onDelete: function () {
                                        onUpdate({ $splice: [[idx, 1]] });
                                        host.closeDialog();
                                    }
                                }
                            }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: resource.url, target: "_blank" }, resource.name)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontal-align spaced" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontaItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return host.openDialog({
                            Component: _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__["EditResource"],
                            props: {
                                title: "Lägg till resurs",
                                onSave: function (newResource) {
                                    var updatedResource = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(newResource, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                    onUpdate({ $push: [updatedResource] });
                                    host.closeDialog();
                                }
                            }
                        }); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-paperclip", "aria-hidden": true }),
                        " L\u00E4gg till resurs")),
                showGooglePicker && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontaItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_apis_buttons__WEBPACK_IMPORTED_MODULE_5__["DriveButton"], { label: "L\u00E4gg till fr\u00E5n Drive", action: function () {
                            var picker = new _apis_google_picker__WEBPACK_IMPORTED_MODULE_6__["GooglePicker"]({ upload: true, multiple: true });
                            picker.show().then(function (files) {
                                files.forEach(function (file) {
                                    var newResource = { url: file.url, name: file.name };
                                    var updatedResource = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(newResource, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                    onUpdate({ $push: [updatedResource] });
                                });
                            });
                        } }))));
    };
    return EditableResourceList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-task-list.tsx":
/*!*****************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-task-list.tsx ***!
  \*****************************************************************************/
/*! exports provided: EditableTaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableTaskList", function() { return EditableTaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-task */ "./src/components/course-builder/modal-pages/edit-task/index.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _utility_components_sortable_task_list__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utility-components/sortable-task-list */ "./src/components/utility-components/sortable-task-list.tsx");
/* harmony import */ var _course_builder_ks_logic_ordered_requirements__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../course-builder-ks/logic/ordered-requirements */ "./src/components/course-builder-ks/logic/ordered-requirements.ts");








var EditableTaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableTaskList, _super);
    function EditableTaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableTaskList.prototype.openTaskDialog = function (task) {
        var _a = this.props, taskCustomizations = _a.taskCustomizations, course = _a.course, host = _a.host, module = _a.module, taskIds = _a.taskIds, onTaskAdded = _a.onTaskAdded, onTaskUpdated = _a.onTaskUpdated, onTaskCustomizationUpdated = _a.onTaskCustomizationUpdated, onTaskDeleted = _a.onTaskDeleted, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, onTaskReplaced = _a.onTaskReplaced;
        host.openDialog({
            Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
            props: {
                task: task,
                taskCustomization: taskCustomizations && taskCustomizations[task.id],
                module: module,
                course: course,
                host: host,
                idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                onSave: function (task) {
                    var updatedTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(task, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                    onTaskUpdated(updatedTask);
                    host.closeDialog();
                },
                onSaveCustomization: function (customization) {
                    onTaskCustomizationUpdated(task.id, customization);
                    host.closeDialog();
                },
                onDelete: function () {
                    onTaskDeleted(task.id);
                    host.closeDialog();
                },
                onReplace: function (taskId, newTask) {
                    onTaskReplaced(taskId, newTask);
                    host.closeDialog();
                },
                onCancel: function () { return host.closeDialog(); }
            }
        });
    };
    EditableTaskList.prototype.render = function () {
        var _this = this;
        var props = this.props;
        var tasks = Object(_course_builder_ks_logic_ordered_requirements__WEBPACK_IMPORTED_MODULE_7__["getOrderedDocs"])(props.course.tasks, props.taskIds, { appendLeftovers: false });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_sortable_task_list__WEBPACK_IMPORTED_MODULE_6__["SortableTaskList"], { taskMetas: tasks.map(function (task) { return ({ task: task, isTaskOwner: Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser, task) }); }), renderEditLink: function (_a) {
                    var task = _a.task, isTaskOwner = _a.isTaskOwner;
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: isTaskOwner ?
                            "editItem" :
                            "viewItem", onClick: function () { return _this.openTaskDialog(task); } });
                }, renderLink: function (_a) {
                    var task = _a.task;
                    return task.content ?
                        // Rather than linking to url, show the task's content (by opening
                        // the task dialog)
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                ev.preventDefault();
                                _this.openTaskDialog(task);
                            } }, task.name) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: task.url, target: "_blank" }, task.name);
                }, onSort: function (source, target, placement) {
                    _this.props.onTasksReordered(source, target, placement);
                } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () {
                    var _a = _this.props, course = _a.course, host = _a.host, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, module = _a.module, onTaskAdded = _a.onTaskAdded, onTaskCustomizationUpdated = _a.onTaskCustomizationUpdated;
                    props.host.openDialog({
                        Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
                        props: {
                            searchMode: true,
                            module: module,
                            course: course,
                            host: host,
                            idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                            onSave: function (choosenTask, taskCustomization) {
                                choosenTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(choosenTask, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                onTaskAdded(choosenTask, taskCustomization);
                                host.closeDialog();
                            },
                            onCancel: function () { return host.closeDialog(); }
                        }
                    });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-search", "aria-hidden": true }),
                " S\u00F6k uppgift"),
            "\u00A0",
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () {
                    var _a = _this.props, course = _a.course, host = _a.host, module = _a.module, taskIds = _a.taskIds, onTaskAdded = _a.onTaskAdded, onTaskUpdated = _a.onTaskUpdated, onTaskDeleted = _a.onTaskDeleted, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
                    host.openDialog({
                        Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
                        props: {
                            module: module,
                            course: course,
                            host: host,
                            idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                            onSave: function (newTask) {
                                newTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(newTask, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                onTaskAdded(newTask);
                                host.closeDialog();
                            },
                            onCancel: function () { return host.closeDialog(); }
                        }
                    });
                }, className: "btn" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": true }),
                " L\u00E4gg till egen uppgift"));
    };
    return EditableTaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-teacher-list.tsx":
/*!********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-teacher-list.tsx ***!
  \********************************************************************************/
/*! exports provided: EditableTeacherList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableTeacherList", function() { return EditableTeacherList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _remove_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _select_teacher__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./select-teacher */ "./src/components/course-builder/sub-components/select-teacher.tsx");
/* harmony import */ var _utility_components_observe__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utility-components/observe */ "./src/components/utility-components/observe.tsx");
/* harmony import */ var _spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");








function EditableTeacherList(_a) {
    var school = _a.school, teachers = _a.teachers, onUpdate = _a.onUpdate;
    var nameElem = Object(react__WEBPACK_IMPORTED_MODULE_1__["useRef"])();
    var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])(false), 2), selectingTeacher = _b[0], setSelectingTeacher = _b[1];
    var displayTeacherRights = _features__WEBPACK_IMPORTED_MODULE_7__["features"].teacherRights;
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "teachers-list" },
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h3", null, "Ansvariga l\u00E4rare"),
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("table", { style: { width: "100%" } },
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("thead", null, teachers.length > 0 && react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("tr", null,
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("th", { style: { width: "15%" } }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Namn"], ["Namn"])))),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("th", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["E-postadress"], ["E-postadress"])))),
                displayTeacherRights && react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("th", { style: { width: "24px" } }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Beh\u00F6righet"], ["Beh\u00F6righet"])))),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("th", { style: { width: "24px" } }))),
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("tbody", null, teachers.map(function (teacher, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("tr", { key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("input", { type: "text", ref: nameElem, value: teacher.name, autoFocus: !teacher.name && idx > 0, onChange: function (ev) {
                                if (ev.target.value || teacher.email) {
                                    // Update row
                                    var clone = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers);
                                    clone[idx] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { name: ev.target.value });
                                    onUpdate(clone);
                                }
                                else {
                                    // Remove row
                                    onUpdate(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers.slice(0, idx), teachers.slice(idx + 1)));
                                }
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("input", { type: "text", style: { width: "100%" }, value: teacher.email || teacher.url, onKeyDown: function (ev) {
                                if (ev.which === 9 &&
                                    !ev.shiftKey &&
                                    idx === teachers.length - 1 &&
                                    (teachers.length < 1 || !!teachers[teachers.length - 1].name)) {
                                    setSelectingTeacher(true);
                                    ev.preventDefault();
                                }
                            }, onChange: function (ev) {
                                var editedTeacher = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { url: ev.target.value, email: ev.target.value });
                                if (ev.target.value || teacher.name) {
                                    // Update row
                                    var clone = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers);
                                    clone[idx] = editedTeacher;
                                    onUpdate(clone);
                                }
                                else {
                                    // Remove row
                                    onUpdate(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers.slice(0, idx), teachers.slice(idx + 1)));
                                }
                            } })),
                    displayTeacherRights && react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("select", { disabled: !(teacher.email || teacher.url), value: teacher.access || 'edit', onChange: function (ev) {
                                var clone = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers);
                                clone[idx] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { access: ev.target.value });
                                onUpdate(clone);
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "read" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4sa"], ["L\u00E4sa"])))),
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "edit" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera"], ["Redigera"])))),
                            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("option", { value: "full" }, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Full"], ["Full"])))))),
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_remove_item__WEBPACK_IMPORTED_MODULE_2__["RemoveItem"], { onClick: function () {
                                onUpdate(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers.slice(0, idx), teachers.slice(idx + 1)));
                            } })));
            }))),
        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("br", null),
        selectingTeacher ?
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_utility_components_observe__WEBPACK_IMPORTED_MODULE_5__["Observe"], { fallback: react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null), errorFallback: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunder inte h\u00E4mta skolans l\u00E4rare fr\u00E5n EDS"], ["Kunder inte h\u00E4mta skolans l\u00E4rare fr\u00E5n EDS"]))) },
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_select_teacher__WEBPACK_IMPORTED_MODULE_4__["SelectTeacher"], { school: school, selectedTeachers: teachers, onBlur: function () { return setSelectingTeacher(false); }, onSelect: function (_a) {
                        var name = _a.name, email = _a.email;
                        var newTeacher = {
                            name: name,
                            email: email,
                            url: email,
                            access: 'edit'
                        };
                        var clone = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](teachers);
                        clone.push(newTeacher);
                        onUpdate(clone);
                        setSelectingTeacher(false);
                    } })) :
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("a", { className: "btn", onClick: function () {
                    setSelectingTeacher(true);
                } },
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("i", { className: "fa fa-user-plus", "aria-hidden": true }), Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"]([" L\u00E4gg till ansvarig l\u00E4rare"], [" L\u00E4gg till ansvarig l\u00E4rare"])))));
}
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8;


/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-workflow-link.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-workflow-link.tsx ***!
  \*********************************************************************************/
/*! exports provided: EditableWorkFlowLink */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableWorkFlowLink", function() { return EditableWorkFlowLink; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-workflow-link */ "./src/components/course-builder/modal-pages/edit-workflow-link.tsx");



var EditableWorkFlowLink = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableWorkFlowLink, _super);
    function EditableWorkFlowLink(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableWorkFlowLink.prototype.render = function () {
        var _a = this.props, host = _a.host, onUpdate = _a.onUpdate, url = _a.url;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, url &&
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return host.openDialog({
                                Component: _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__["EditWorkflowLink"],
                                props: {
                                    url: url,
                                    onSave: function (newUrl) {
                                        onUpdate({ $set: newUrl });
                                        host.closeDialog();
                                    },
                                    onDelete: function () {
                                        onUpdate({ $set: undefined });
                                        host.closeDialog();
                                    }
                                }
                            }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: url, target: "_blank" }, "Nuvarande arbetsg\u00E5ng")))),
            !url && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return host.openDialog({
                    Component: _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__["EditWorkflowLink"],
                    props: {
                        onSave: function (newUrl) {
                            onUpdate({ $set: newUrl });
                            host.closeDialog();
                        }
                    }
                }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-paperclip", "aria-hidden": true }),
                " Koppla en arbetsg\u00E5ng till kursen"));
    };
    return EditableWorkFlowLink;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/knowledge-matrix.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/knowledge-matrix.tsx ***!
  \***************************************************************************/
/*! exports provided: KnowledgeMatrix */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeMatrix", function() { return KnowledgeMatrix; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



var KnowledgeMatrix = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KnowledgeMatrix, _super);
    function KnowledgeMatrix(props) {
        return _super.call(this, props) || this;
    }
    KnowledgeMatrix.prototype.render = function () {
        var _a = this.props, knowledgeRequirements = _a.knowledgeRequirements, markedIds = _a.markedIds, migratedIds = _a.migratedIds, explainedRequirements = _a.explainedRequirements;
        var _b = this.props, idsToMarkNotOk = _b.idsToMarkNotOk, markMode = _b.markMode, onMarkChanged = _b.onMarkChanged, onExplainedRequirementsChanged = _b.onExplainedRequirementsChanged;
        var columns = ["E", "C", "A"];
        var rows = [];
        var reqs = knowledgeRequirements.slice();
        var row = null;
        while (true) {
            row = columns.map(function (grade) {
                var pNext = reqs.findIndex(function (r) { return r.gradeStep && r.gradeStep.toUpperCase() === grade; });
                if (pNext < 0)
                    return null;
                var rv = reqs[pNext];
                reqs.splice(pNext, 1);
                return rv;
            });
            if (row.every(function (r) { return r === null; }))
                break;
            rows.push(row);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                        var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;
                        var isMarkedNotOK = requirement && idsToMarkNotOk && idsToMarkNotOk[requirement.id];
                        var isMigrated = requirement && migratedIds && !!migratedIds[requirement.id];
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: requirement ? requirement.name : "" }, className: (markMode ? "selectable" : "") +
                                (isMigrated ? " migrated" : "") +
                                (isMarkedOK ?
                                    " markedGreen" :
                                    (isMarkedNotOK ?
                                        " markedRed" :
                                        "")), onClick: markMode && requirement ?
                                function () { return onMarkChanged(requirement.id, !isMarkedOK); } :
                                undefined, title: isMigrated ?
                                markMode ?
                                    "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
                                    "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
                                undefined });
                    })),
                    explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                        var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j }, isMarkedOK ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { placeholder: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Beskriv kravet"], ["Beskriv kravet"]))), className: "inputTextBox inputTextLarge", style: { width: "100%" }, readOnly: !markMode, value: explainedRequirements[requirement.id] || "", onChange: onExplainedRequirementsChanged && (function (ev) { return onExplainedRequirementsChanged(requirement.id, ev.target.value); }) }) : undefined);
                    }))); }))));
        { /*return <div>
          <table>
            <thead>
              <tr>
                <th>E</th>
                <th>C</th>
                <th>A</th>
              </tr>
            </thead>
            <tbody>
              {tbody.map((row, i) =>
              <tr key={i}>{row.map((cell, j) => {
                const isMarkedOK = props.markedIds && props.markedIds.indexOf(cell.id) >= 0;
                const isMarkedNotOK = props.idsToMarkNotOk && props.idsToMarkNotOk[cell.id];
                return <td
                  key={j}
                  rowSpan={cell.rowSpan}
                  className={(props.markMode ? "selectable" : "") +
                    (isMarkedOK ?
                      " markedGreen" :
                      (isMarkedNotOK ?
                        " markedRed":
                        ""))}
                  onClick={props.markMode && (()=>props.onMarkChanged(cell.id, !isMarkedOK))}>
                  {cell.html && <div style={{position: 'relative'}}>
                    <p
                      className={cell.type === 'ability' ? 'abilityText' : 'criteriaText'}
                      dangerouslySetInnerHTML={{__html: cell.html}} />
                    {props.editMode && <RemoveItem className="upperRight" onClick={()=>
                      this.setCellIds(
                        cell.type,
                        cell.rowIndex,
                        this.getCellIds(
                          cell.type,
                          cell.rowIndex).filter(id => id != cell.id) )} /> }
                  </div>}
                </td>})}
              </tr>)}
            </tbody>
          </table>
        </div>*/
        }
    };
    return KnowledgeMatrix;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/school-courses.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/school-courses.tsx ***!
  \*************************************************************************/
/*! exports provided: SchoolCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolCourses", function() { return SchoolCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../repos/school-courses */ "./src/repos/school-courses.ts");
/* harmony import */ var _spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");









var SchoolCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolCourses, _super);
    function SchoolCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            schoolCourses: null
        };
        _this.onSchoolCoursesUpdated = _this.onSchoolCoursesUpdated.bind(_this);
        return _this;
    }
    SchoolCourses.prototype.componentDidMount = function () {
        _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__["mySchoolCoursesRepo"].subscribe(this.onSchoolCoursesUpdated).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showError"]);
    };
    SchoolCourses.prototype.componentWillUnmount = function () {
        _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__["mySchoolCoursesRepo"].unsubscribe(this.onSchoolCoursesUpdated);
    };
    SchoolCourses.prototype.onSchoolCoursesUpdated = function (schoolCourses) {
        var compareName = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("name");
        var compareCreatedDate = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("createdDate");
        schoolCourses.sort(function (a, b) { return compareName(a, b) || compareCreatedDate(a, b); });
        this.setState({ schoolCourses: schoolCourses });
    };
    SchoolCourses.prototype.outputCourses = function (courses, header, open) {
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_8__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, header), headerOpen: open, contentClassName: "odd-even" }, courses.map(function (course) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "schoolCourse", key: course.id },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/" + course.id + "/edit", className: "editItem" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/" + course.id + "/edit" }, course.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, course.active && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pill active" }, "Aktiv")),
                    course.active && !course.publishable && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pill incomplete" }, "Inkomplett"))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, course.description)),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, course.modifiedBy ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" },
                        "Redigerad av ",
                        course.modifiedBy.name,
                        " / ",
                        Object(_utils__WEBPACK_IMPORTED_MODULE_6__["shortDateFormat"])(course.modifiedDate)) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small", style: { fontStyle: 'italic' } }, " ")));
        })));
    };
    SchoolCourses.prototype.render = function () {
        var schoolCourses = this.state.schoolCourses;
        var myCourses = [];
        var othersCourses = [];
        if (schoolCourses) {
            var me_1 = _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser.mail;
            schoolCourses.forEach(function (course) {
                if (course.activatedBy && course.activatedBy.url == me_1) {
                    myCourses.push(course);
                }
                else if (course.responsibleTeachers.filter(function (t) { return t.url == me_1; }).length > 0) {
                    myCourses.push(course);
                }
                else {
                    othersCourses.push(course);
                }
            });
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, !schoolCourses ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                        " Laddar skolans kurser") :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        this.outputCourses(myCourses, 'Mina kurser', true),
                        this.outputCourses(othersCourses, 'Andra kurser', false))),
                location.hash !== "#/courses/new" && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { className: "btn", to: "/courses/new", onClick: function () { return window.scroll(0, 0); } }, "Skapa ny kurs")));
    };
    return SchoolCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/select-related-docs.tsx":
/*!******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/select-related-docs.tsx ***!
  \******************************************************************************/
/*! exports provided: SelectRelatedDocs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectRelatedDocs", function() { return SelectRelatedDocs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var SelectRelatedDocs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SelectRelatedDocs, _super);
    function SelectRelatedDocs(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    SelectRelatedDocs.prototype.render = function () {
        var _this = this;
        var _a = this.props, options = _a.options, title = _a.title, markedIds = _a.markedIds, markMode = _a.markMode, migratedIds = _a.migratedIds, uncoveredIds = _a.uncoveredIds;
        var groupedOptions = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToLookup"])(options, function (d) { return d.group || "default"; });
        var groups = Object.keys(groupedOptions);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: "larger" }, groups.map(function (group) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: group },
            groups.length === 1 ? null : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, group),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null)),
            groupedOptions[group].map(function (option) {
                var isMarked = markedIds.some(function (x) { return x === option.id; });
                var isMigrated = migratedIds && !!migratedIds[option.id];
                var isUncovered = uncoveredIds && uncoveredIds[option.id];
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: option.id, onClick: function () {
                        return markMode && _this.props.onMarkChanged(option.id, !isMarked);
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" +
                            (markMode ? " selectable" : "") +
                            (isMarked ? " markedGreen" : (isUncovered ?
                                " markedRed" :
                                "")) +
                            (isMigrated ? " migrated" : ""), title: isMigrated ?
                            markMode ?
                                "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
                                "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
                            undefined },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: option.name } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)));
            })); }));
    };
    return SelectRelatedDocs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/select-study-groups.tsx":
/*!******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/select-study-groups.tsx ***!
  \******************************************************************************/
/*! exports provided: SelectStudyGroups */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectStudyGroups", function() { return SelectStudyGroups; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var react_select__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-select */ "./node_modules/react-select/dist/react-select.esm.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _apis_mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../apis/mock/mock-classroom-data */ "./src/apis/mock/mock-classroom-data.ts");







function SelectStudyGroups(_a) {
    var school = _a.school, courseCode = _a.courseCode, selectedStudyGroups = _a.selectedStudyGroups, onUpdate = _a.onUpdate;
    // Mock-data for KED
    var emptyOrMock = school === 'KED' && _apis_mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_6__["mockTuitionGroups"][courseCode] ? _apis_mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_6__["mockTuitionGroups"][courseCode] : [];
    // Map given {school} to its name in EDS:
    var edsSchoolNameGymn = _globals_db__WEBPACK_IMPORTED_MODULE_5__["db"].schools
        .cacheOptimized() // Will add cacheBust to the query (making server add cache header)
        .name(school).single() // Get the single school instance with name={school}
        .read().edsSchoolNameGymn; // Read it the suspense-way (throwing Promise if not there...)
    // List studygroups for that school and given course:
    var studyGroups = edsSchoolNameGymn ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["env"].edsClient.suspense.getSchoolTuitionGroups({
        schoolName: edsSchoolNameGymn,
        courseCode: courseCode
    }) : emptyOrMock;
    // Convert to option objects as react-select wants them:
    var options = studyGroups.map(function (sg) { return ({
        label: sg.tuitionGroupName,
        value: sg.tuitionGroupName
    }); });
    // Display the mutliselect:
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_select__WEBPACK_IMPORTED_MODULE_3__["default"], { isMulti: true, options: options, value: selectedStudyGroups.map(function (group) { return ({ label: group, value: group }); }), placeholder: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Koppla studiegrupper till kursen..."], ["Koppla studiegrupper till kursen..."]))), noOptionsMessage: function () { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte hitta studiegrupper f\u00F6r denna kurs"], ["Kunde inte hitta studiegrupper f\u00F6r denna kurs"]))); }, onChange: function (options) {
            onUpdate(options.map(function (_a) {
                var value = _a.value;
                return value;
            }));
        } });
}
var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/course-builder/sub-components/select-teacher.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/select-teacher.tsx ***!
  \*************************************************************************/
/*! exports provided: SelectTeacher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectTeacher", function() { return SelectTeacher; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react_select__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-select */ "./node_modules/react-select/dist/react-select.esm.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _apis_mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../apis/mock/mock-classroom-data */ "./src/apis/mock/mock-classroom-data.ts");









function SelectTeacher(_a) {
    //
    // Load the teacher list asynchronically (using suspense)
    //
    var school = _a.school, selectedTeachers = _a.selectedTeachers, onSelect = _a.onSelect, onBlur = _a.onBlur;
    // Mock-data for KED
    var emptyOrMock = school === 'KED' ? _apis_mock_mock_classroom_data__WEBPACK_IMPORTED_MODULE_8__["mockTeachers"] : [];
    // Suspense-read from KedBackend:
    var edsSchoolNameGymn = _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].schools.cacheOptimized().name(school).single().read().edsSchoolNameGymn;
    // Suspense-read from EDS:
    var edsTeachers = edsSchoolNameGymn ?
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].edsClient.suspense.getSchoolTeachers({ schoolName: edsSchoolNameGymn }) :
        emptyOrMock;
    var teacherList = edsTeachers.map(function (_a) {
        var teacherFirstName = _a.teacherFirstName, teacherLastName = _a.teacherLastName, teacherEmailAddress = _a.teacherEmailAddress;
        return ({
            label: teacherFirstName + " " + teacherLastName,
            value: teacherEmailAddress
        });
    });
    // Add current user to the list (in case current user is ADMIN or EMPLOYEE at the school)
    var addCurrentUser = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isAdminOrTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].currentUser, school);
    if (addCurrentUser && !teacherList.some(function (t) { return t.value === _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].currentUser.mail; })) {
        teacherList.push({ label: _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].currentUser.displayName, value: _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["env"].currentUser.mail });
    }
    // Filter out already selected teachers:
    var teacherSet = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["arrayToLookup"])(selectedTeachers, function (t) { return t.email; });
    teacherList = teacherList
        .filter(function (t) { return !teacherSet[t.value]; }) // Remove already added ones
        .sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["compareProps"])(["label"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_5__["cfg"].KED_LOCALE)); // Sort by name
    // Show the select:
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react_select__WEBPACK_IMPORTED_MODULE_6__["default"], { isMulti: false, options: teacherList, defaultMenuIsOpen: true, autoFocus: true, onBlur: function () { return onBlur(); }, placeholder: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["V\u00E4lj bland skolans l\u00E4rare..."], ["V\u00E4lj bland skolans l\u00E4rare..."]))), noOptionsMessage: function () { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Det finns inga fler l\u00E4rare att v\u00E4lja fr\u00E5n"], ["Det finns inga fler l\u00E4rare att v\u00E4lja fr\u00E5n"]))); }, onChange: function (option) {
            var _a = option, label = _a.label, value = _a.value;
            onSelect({ name: label, email: value });
        } });
}
var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/sub-components/weighted-items-table.tsx":
/*!*******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/weighted-items-table.tsx ***!
  \*******************************************************************************/
/*! exports provided: WeightedItemsTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeightedItemsTable", function() { return WeightedItemsTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_business_logic__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _contracts_ked_models__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../contracts/ked-models */ "./src/contracts/ked-models.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");





var WeightedItemsTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeightedItemsTable, _super);
    function WeightedItemsTable(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isOpen: false
        };
        return _this;
    }
    WeightedItemsTable.prototype.render = function () {
        var course = this.props.course;
        var isOpen = this.state.isOpen;
        var rows = [];
        var tasksPerId = Object(_courses_business_logic__WEBPACK_IMPORTED_MODULE_2__["getTasksPerId"])(course);
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "centralContent", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "Centralt inneh\u00E5ll")));
        course.centralContent.forEach(function (cc, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: cc.id, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "criteriaText", dangerouslySetInnerHTML: { __html: cc.name } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[cc.id] || []).length)))); });
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "abilities", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "F\u00F6rm\u00E5gor")));
        course.abilities.forEach(function (ability, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: ability.id, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "abilityText", dangerouslySetInnerHTML: { __html: ability.name } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[ability.id] || []).length)))); });
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "futureAbilities", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "Framtidsf\u00F6rm\u00E5gor")));
        _contracts_ked_models__WEBPACK_IMPORTED_MODULE_3__["futureAbilities"].forEach(function (futureAbilityText, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: futureAbilityText, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "abilityText" }, futureAbilityText)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[futureAbilityText] || []).length)))); });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_4__["OpenCloseBox"], { className: "larger", title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens t\u00E4ckningstabell"), contentClassName: "weighted-items-table" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Tabellen anger hur m\u00E5nga uppgifter som ber\u00F6r varje del."),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows)));
    };
    return WeightedItemsTable;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts":
/*!*******************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/diff-xml-with-database.ts ***!
  \*******************************************************************************/
/*! exports provided: diffXmlWithDatabase */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffXmlWithDatabase", function() { return diffXmlWithDatabase; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _migrate_subject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./migrate-subject */ "./src/components/course-builder/subjects/diff/migrate-subject.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");




function diffXmlWithDatabase(existingSubject, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var expandedCourseTemplates, courseSets;
        var _this = this;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.get('subjects', existingSubject.id, { include: ["courseTemplates", "abilities"] })];
                case 1:
                    // Expand graphs of existing Subject
                    existingSubject = _a.sent();
                    return [4 /*yield*/, Promise.all(existingSubject.courseTemplates.map(function (ct) { return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["loadCourse"])(ct.id, {
                            include: [
                                'centralContent',
                                'knowledgeRequirements'
                            ]
                        }); }))];
                case 2:
                    expandedCourseTemplates = _a.sent();
                    console.log("Subject: " + existingSubject.name + ". Courses: " + expandedCourseTemplates.map(function (_a) {
                        var name = _a.name;
                        return name;
                    }));
                    return [4 /*yield*/, Promise.all(expandedCourseTemplates.map(function (courseTemplate) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                switch (_b.label) {
                                    case 0:
                                        _a = {
                                            template: courseTemplate
                                        };
                                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.list("courses", { name: courseTemplate.name, include: ['abilities'], flags: ['includeIdsOnly'] })];
                                    case 1: return [2 /*return*/, (_a.instances = _b.sent(),
                                            _a)];
                                }
                            });
                        }); }))];
                case 3:
                    courseSets = _a.sent();
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    return [4 /*yield*/, Object(_migrate_subject__WEBPACK_IMPORTED_MODULE_2__["migrateSubject"])(existingSubject, courseSets, subjectToImport, changes)];
                case 4:
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    _a.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/diff/migrate-subject.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/migrate-subject.ts ***!
  \************************************************************************/
/*! exports provided: migrateSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "migrateSubject", function() { return migrateSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");




function diffSubjectGlobalTexts(dbTextMap, xmlTexts) {
    var e_1, _a;
    var removedIds = new Set();
    var newTexts = new Map();
    var idsToAdd = new Set();
    xmlTexts.forEach(function (newText) {
        newText = newText.trim();
        if (!dbTextMap.has(newText)) {
            var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["createUUID"])();
            console.log("New id: " + id + ". Text: " + newText);
            newTexts.set(newText, id);
            idsToAdd.add(id);
        }
        else {
            newTexts.set(newText, dbTextMap.get(newText));
        }
    });
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](dbTextMap.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {
            var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_c.value, 2), oldText = _d[0], oldId = _d[1];
            if (xmlTexts.indexOf(oldText) === -1) {
                removedIds.add(oldId);
            }
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return {
        removedIds: removedIds,
        newTexts: newTexts,
        idsToAdd: idsToAdd
    };
}
var _fictiveOldId = 1;
function fictiveOldId() {
    return "fictiveOldId" + (++_fictiveOldId);
}
var stopWords = new Set(
// From https://github.com/MihaiValentin/lunr-languages/blob/master/lunr.sv.js#L252
('alla allt att av blev bli blir blivit de dem den denna deras dess dessa det detta dig din dina ditt du där då efter ej eller en er era ert ett från för ha hade han hans har henne hennes hon honom hur här i icke ingen inom inte jag ju kan kunde man med mellan men mig min mina mitt mot mycket ni nu när någon något några och om oss på samma sedan sig sin sina sitta själv skulle som så sådan sådana sådant till under upp ut utan vad var vara varför varit varje vars vart vem vi vid vilka vilkas vilken vilket vår våra vårt än är åt över' +
    ' kring') // This line contains additional stop-words missing in lunr.sv.
    .split(' '));
function getLexemes(html) {
    return new Set(removeTags(html).replace(/[^\w\såäö]/gi, '').toLowerCase().split(/\s/)
        .map(function (lexeme) { return lexeme.trim(); })
        .filter(function (lexeme) { return !!lexeme; })
        .filter(function (lexeme) { return !stopWords.has(lexeme); }));
}
function removeTags(html) {
    var div = document.createElement('div');
    div.innerHTML = html;
    return '' + div.innerText;
}
function getIdsToMigrate(dbTexts, xmlTexts, newTexts, textType, course) {
    var idsToMigrate = new Map();
    dbTexts = dbTexts.map(function (entity) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, entity, { name: entity.name.trim() })); }).filter(function (_a) {
        var name = _a.name;
        return !!name;
    });
    var xmlSet = new Map();
    xmlTexts.forEach(function (item) { return xmlSet.set(item.html, item); });
    var dbSet = new Map();
    dbTexts.forEach(function (entity) { return dbSet.set(entity.name, entity); });
    // Remove those who already exists identically
    dbTexts = dbTexts.filter(function (entity) { return !xmlSet.has(entity.name); });
    xmlTexts = xmlTexts.filter(function (item) { return !dbSet.has(item.html); });
    // Now, for the remainder, try the best to map old texts to new texts, and when done, check if there are new texts that never got mapped.
    // Start by putting all dbText into the result, without a paired xml text yet:
    dbTexts.forEach(function (dbText) { return idsToMigrate.set(dbText.id, {
        gradeStep: dbText.gradeStep,
        oldText: dbText.name,
        lexemes: getLexemes(dbText.name),
        matchLevel: 0
    }); });
    // Then try to pair each xmlText to an item in idsToMigrate
    var xmlSpinsters = [];
    while (xmlTexts.length > 0) {
        var xmlText = xmlTexts[0];
        var bestMatch = findBestMatch(xmlText);
        if (!bestMatch) {
            xmlSpinsters.push(xmlText);
        }
        else {
            if (bestMatch.newText) {
                // Throw out existing match
                xmlTexts.push({ html: bestMatch.newText, gradeStep: bestMatch.gradeStep });
            }
            var pair = idsToMigrate.get(bestMatch.id);
            // Pair myself with this match:
            pair.newText = xmlText.html;
            pair.matchLevel = bestMatch.myMatchLevel;
            pair.newId = newTexts.get(xmlText.html);
        }
        xmlTexts.shift();
    }
    // For each spinster (new texts that couldn't find any match in old texts),
    // Add them with an fictive old ID but omit oldText to mark it as a newcomer
    xmlSpinsters.forEach(function (spinster) {
        idsToMigrate.set(fictiveOldId(), {
            newId: newTexts.get(spinster.html),
            newText: spinster.html,
            gradeStep: spinster.gradeStep,
            matchLevel: 0,
            lexemes: new Set()
        });
    });
    // Mark typo-fixes
    idsToMigrate.forEach(function (match) {
        var oldText = match.oldText, newText = match.newText;
        if (oldText && newText) {
            if (tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(oldText)).join(' ') === tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(newText)).join(' ')) {
                match.isTypoFix = true;
            }
        }
    });
    console.log("IdsToMigrate", tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.values()).map(function (_a) {
        var oldText = _a.oldText, lexemes = _a.lexemes;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](lexemes).join(' ') + ": " + oldText;
    }));
    return idsToMigrate;
    function findBestMatch(xmlText) {
        var xmlLexemes = getLexemes(xmlText.html);
        var possiblePartners = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.entries()).filter(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], x = _b[1];
            return x.gradeStep === xmlText.gradeStep;
        })
            .map(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], _c = _b[1], gradeStep = _c.gradeStep, matchLevel = _c.matchLevel, newText = _c.newText, lexemes = _c.lexemes;
            return ({
                id: id,
                gradeStep: gradeStep,
                matchLevel: matchLevel,
                newText: newText,
                myMatchLevel: getMatchLevel(xmlLexemes, lexemes)
            });
        }).filter(function (pp) { return pp.myMatchLevel >= 50 && (!pp.matchLevel || pp.matchLevel < pp.myMatchLevel); });
        return possiblePartners.sort(function (a, b) { return b.myMatchLevel - a.myMatchLevel; })[0]; // highest first.
    }
    function getMatchLevel(lexemes1, lexemes2) {
        if (lexemes1.size === 0 || lexemes2.size === 0)
            return 0;
        var points1 = 0;
        var points2 = 0;
        lexemes1.forEach(function (word) {
            if (lexemes2.has(word))
                ++points1;
        });
        lexemes2.forEach(function (word) {
            if (lexemes1.has(word))
                ++points2;
        });
        return Math.round(100 * Math.max(points1 / lexemes1.size, points2 / lexemes2.size));
    }
    /*if (dbTexts.length !== xmlTexts.length) {
      // We can no longer assume that the changed texts refer to different formulations of the same meaning.
      // We not map old formulations to new ones.
      // In future, we could handle this case by assuming all old texts not occurring in new data, have been removed and all new have been added.
      throw new Error("Number of " + textType + (course ? ` on course ${course}` : "") + " differs. Cannot migrate.");
    }
    dbTexts.forEach(({name: oldText, id: oldId, gradeStep}, i) => {
      const xmlText = xmlTexts[i].trim();
      if (oldText.trim() !== xmlText) {
        idsToMigrate.set(oldId, {newText: xmlText, newId: newTexts.get(xmlText), oldText, gradeStep});
      }
    });
    return idsToMigrate;*/
}
function migrateSubject(existingSubject, courseSets, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        function migrateCourseInstance(course, courseToImport, idsToMigrate) {
            var showChanges = !shownChanges.has(course.name);
            shownChanges.add(course.name);
            abilityIdsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, oldText = _a.oldText;
                // Relink the course instance with abilities. This change does not need to be visible in GUI.
                changes.push({
                    mutations: function (br) {
                        if (oldText)
                            br.unlink2("courses", course.id, "abilities", oldId);
                        if (newId)
                            br.link2("courses", course.id, "abilities", newId);
                    }
                });
            });
            course.abilitiesOrder = subjectToImport.abilities.map(function (html) { return newAbilityTexts.get(html); });
            var ccsToMigrate = idsToMigrate.ccsToMigrate, krsToMigrate = idsToMigrate.krsToMigrate;
            // Central Content
            ccsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Centralt Inneh\u00E5ll" :
                                "Uppdaterat Centralt Inneh\u00E5ll" :
                            "Borttaget Centralt Inneh\u00E5ll" :
                        "Nytt Centralt Inneh\u00E5ll"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && ccsToAdd.has(newId) && !createdIds.has(newId)) {
                            var cc = {
                                id: newId,
                                name: newText,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            br.add("central-content", cc);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "centralContent", oldId);
                        if (newId)
                            br.link2("courses", course.id, "centralContent", newId);
                    }
                });
            });
            course.centralContentOrder = courseToImport.centralContent.map(function (_a) {
                var html = _a.html;
                return newCCTexts.get(html);
            });
            // Knowledge Requirements
            krsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, gradeStep = _a.gradeStep, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Kunskapskrav" :
                                "Uppdaterat Kunskapskrav" :
                            "Borttaget Kunskapskrav" :
                        "Nytt Kunskapskrav"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && krsToAdd.has(newId) && !createdIds.has(newId)) {
                            var kr = {
                                id: newId,
                                name: newText,
                                gradeStep: gradeStep,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            console.log("Adding Knowledge-Requirement " + newId + ": " + newText);
                            br.add("knowledge-requirements", kr);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "knowledgeRequirements", oldId);
                        if (newId)
                            br.link2("courses", course.id, "knowledgeRequirements", newId);
                    }
                });
            });
            course.knowledgeRequirementsOrder =
                courseToImport.knowledgeRequirements.map(function (kr) { return newKRTexts.get(kr.html); });
            // Updates the course properties centralContentOrder and knowledgeRequirementsOrder
            if (abilityIdsToMigrate.size > 0 || ccsToMigrate.size > 0 || krsToMigrate.size > 0) {
                changes.push({
                    change: !course.isTemplate ? "Uppdaterad Kursinstans" : "Uppdaterad Kursmall",
                    content: !course.isTemplate ?
                        course.name + ". Skola: " + (course.school || "ej angiven") + ". Beskrivning: " + (course.description || '') :
                        "" + course.name,
                    mutations: function (br) { return br.put("courses", course); }
                });
            }
        }
        // Tasks:
        // 1. ASYNC OPERATION: Go through all tasks that has edges to any of the old ids.
        // 2. For each found task, do:
        //    A: Iterate tags starting with "course:". Pick the course code.
        //    B: Populate the new property migrationTasks: {
        //         abilities: {[newId: string]: {oldText: string, oldId: string, importDate: number}}, // Be able to create a chain in the GUI !
        //         centralContent: {[newId: string]: {oldText: string, ..."...}},
        //         knowledgeRequirements: {[newId: string]: {oldText: string, ..."...}},
        //       }
        //       OBS1! Mergea abilities, centralCondent och knowledgeRequirements med ev tidigare värden (så man kan importera om och om igen!)
        //       OBS2! oldId kan förekomma på flera newId om task används av flera kurser. 
        //    C: Create sets for unlinks and link operations per type.
        //    D: For all courseCodes that the task is taggen on,
        //         * register ccsToMigrate.keys() in the unlink set of central contents
        //         * register ccsToMigrate.values() in the link set of central contents
        //         * --"-- for knowledgeRequirements
        //    E: unlink and link with regards to abilityIdsToMigrate (keys() and values() respectively).
        //    F: unlink and link according to the created sets of link / unlink operations.
        //    Note: Unlike course instances, there's no order property to take care of here!
        //
        function migrateTasks() {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                function fetchTasksInChunksWithEdgesTo(ids, options) {
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                        var result;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    // This function should make work around the case when given "ids" contains too many items, by
                                    // dividing the requests into several and merge the result using a Map.
                                    if (ids.length === 0)
                                        return [2 /*return*/, []]; // Otherwise we'll request every task in the system.
                                    result = new Map();
                                    console.log("Number of ids: " + ids.length);
                                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("tasks", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options, { hasEdgesTo: ids }))];
                                case 1: 
                                //return result.values();
                                return [2 /*return*/, _a.sent()];
                            }
                        });
                    });
                }
                var e_7, _a, oldIds, importDate, tasks, _loop_2, tasks_1, tasks_1_1, task;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            oldIds = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](abilityIdsToMigrate.keys(), Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(idsToMigratePerCourse.map(function (c) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](c.ccsToMigrate.keys(), c.krsToMigrate.keys()); }))).filter(function (id) { return !id.startsWith('fictiveOldId'); });
                            importDate = Date.now();
                            return [4 /*yield*/, fetchTasksInChunksWithEdgesTo(oldIds, {
                                    include: ["abilities", "knowledgeRequirements", "centralContent"],
                                    flags: ["includeIdsOnly"]
                                })];
                        case 1:
                            tasks = _b.sent();
                            _loop_2 = function (task) {
                                var e_8, _a, e_9, _b, e_10, _c, e_11, _d;
                                var oldMT = task.migratedTexts || {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                task.migratedTexts = {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                var mutations = [];
                                var changeDescriptions = [];
                                var _loop_3 = function (id) {
                                    var migrationInfo = abilityIdsToMigrate.get(id);
                                    if (migrationInfo) {
                                        var newId_1 = migrationInfo.newId, newText = migrationInfo.newText, isTypoFix = migrationInfo.isTypoFix;
                                        var oldText = migrationInfo.oldText;
                                        var oldId = id;
                                        if (oldMT.abilities[id]) {
                                            // If migrating stuff that was never acknowledges by a teacher,
                                            // We should point out the very old id and text instead of the never-acknowledged one.
                                            oldText = oldMT.abilities[id].oldText;
                                            oldId = oldMT.abilities[id].oldId;
                                        }
                                        if (newId_1 && oldText !== newText) {
                                            // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                            if (!isTypoFix) {
                                                // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                task.migratedTexts.abilities[newId_1] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                            }
                                        }
                                        mutations.push(function (br) {
                                            br.unlink2("tasks", task.id, "abilities", id);
                                            if (newId_1)
                                                br.link2("tasks", task.id, "abilities", newId_1);
                                        });
                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                        if (newId_1) {
                                            changeDescriptions.push(newText);
                                        }
                                    }
                                };
                                try {
                                    for (var _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.abilities), _f = _e.next(); !_f.done; _f = _e.next()) {
                                        var id = _f.value.id;
                                        _loop_3(id);
                                    }
                                }
                                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                                finally {
                                    try {
                                        if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                                    }
                                    finally { if (e_8) throw e_8.error; }
                                }
                                var taskCourseCodes = new Set(task.tags ?
                                    task.tags.filter(function (t) { return t.startsWith('course:'); }).map(function (t) { return t.substr("course:".length); }) :
                                    []);
                                // We need to keep track of linkedIds (for this particular task) for the following reason:
                                // Let's say the task was referred to by two different courses (possible in old versions),
                                // and in old Central Content, the two courses did have slightly different formulations of central content,
                                // so the task was mapped to both of them. Then, in new XML, the same central content was formulated
                                // in a new way that is identical this time between the two courses. Then both old IDs will be replaced
                                // by a single new ID. It would then be unnescessary to link to the new ID twice.
                                var linkedIds = new Set();
                                try {
                                    for (var idsToMigratePerCourse_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](idsToMigratePerCourse), idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next(); !idsToMigratePerCourse_1_1.done; idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next()) {
                                        var _g = idsToMigratePerCourse_1_1.value, krsToMigrate = _g.krsToMigrate, ccsToMigrate = _g.ccsToMigrate, courseCode = _g.courseCode;
                                        if (taskCourseCodes.size === 0 || taskCourseCodes.has(courseCode)) {
                                            var _loop_4 = function (id) {
                                                var migrationInfo = ccsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_2 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.centralContent[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.centralContent[id].oldText;
                                                        oldId = oldMT.centralContent[id].oldId;
                                                    }
                                                    if (newId_2 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.centralContent[newId_2] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_2 || !linkedIds.has(newId_2)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "centralContent", id);
                                                            if (newId_2)
                                                                br.link2("tasks", task.id, "centralContent", newId_2);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_2) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_2);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _h = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.centralContent), _j = _h.next(); !_j.done; _j = _h.next()) {
                                                    var id = _j.value.id;
                                                    _loop_4(id);
                                                }
                                            }
                                            catch (e_10_1) { e_10 = { error: e_10_1 }; }
                                            finally {
                                                try {
                                                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                                                }
                                                finally { if (e_10) throw e_10.error; }
                                            }
                                            var _loop_5 = function (id) {
                                                var migrationInfo = krsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_3 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.knowledgeRequirements[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.knowledgeRequirements[id].oldText;
                                                        oldId = oldMT.knowledgeRequirements[id].oldId;
                                                    }
                                                    if (newId_3 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.knowledgeRequirements[newId_3] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_3 || !linkedIds.has(newId_3)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "knowledgeRequirements", id);
                                                            if (newId_3)
                                                                br.link2("tasks", task.id, "knowledgeRequirements", newId_3);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_3) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_3);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _k = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.knowledgeRequirements), _l = _k.next(); !_l.done; _l = _k.next()) {
                                                    var id = _l.value.id;
                                                    _loop_5(id);
                                                }
                                            }
                                            catch (e_11_1) { e_11 = { error: e_11_1 }; }
                                            finally {
                                                try {
                                                    if (_l && !_l.done && (_d = _k.return)) _d.call(_k);
                                                }
                                                finally { if (e_11) throw e_11.error; }
                                            }
                                        }
                                    }
                                }
                                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                                finally {
                                    try {
                                        if (idsToMigratePerCourse_1_1 && !idsToMigratePerCourse_1_1.done && (_b = idsToMigratePerCourse_1.return)) _b.call(idsToMigratePerCourse_1);
                                    }
                                    finally { if (e_9) throw e_9.error; }
                                }
                                changes.push({
                                    change: "Migrerad Uppgift",
                                    content: "<h4>" + task.name + " " + (task.school ? "(" + task.school + ") " : '(skola ej angiven)') + "</h4>\n          <p>Kurskod: " + tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](taskCourseCodes).join(',') + "</p>\n          " + changeDescriptions.map(function (txt) { return "<p>" + txt + "</p>"; }).join(''),
                                    mutations: function (br) {
                                        br.put("tasks", task);
                                        mutations.forEach(function (m) { return m(br); });
                                    }
                                });
                            };
                            try {
                                /*const tasks = await env.kedBackendClient.list<Task>("tasks", {
                                  hasEdgesTo: oldIds,
                                  include: ["abilities", "knowledgeRequirements", "centralContent"],
                                  flags: ["includeIdsOnly"]
                                });*/
                                for (tasks_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](tasks), tasks_1_1 = tasks_1.next(); !tasks_1_1.done; tasks_1_1 = tasks_1.next()) {
                                    task = tasks_1_1.value;
                                    _loop_2(task);
                                }
                            }
                            catch (e_7_1) { e_7 = { error: e_7_1 }; }
                            finally {
                                try {
                                    if (tasks_1_1 && !tasks_1_1.done && (_a = tasks_1.return)) _a.call(tasks_1);
                                }
                                finally { if (e_7) throw e_7.error; }
                            }
                            return [2 /*return*/];
                    }
                });
            });
        }
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d, e_6, _e, dbTextMap, orderedAbilities, orderedAbilities_1, orderedAbilities_1_1, a, courseSets_1, courseSets_1_1, template, _f, _g, cc, _h, _j, kr, _k, newAbilityTexts, abilitiesToAdd, _l, newCCTexts, ccsToAdd, _m, newKRTexts, krsToAdd, abilityIdsToMigrate, idsToMigratePerCourse, createdIds, shownChanges, _loop_1, courseSets_2, courseSets_2_1, _o, template, instances;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_p) {
            switch (_p.label) {
                case 0:
                    dbTextMap = new Map();
                    orderedAbilities = existingSubject.abilitiesOrder ?
                        existingSubject.abilitiesOrder.map(function (id) { return existingSubject.abilities.find(function (a) { return a.id === id; }); }) :
                        existingSubject.abilities;
                    try {
                        for (orderedAbilities_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](orderedAbilities), orderedAbilities_1_1 = orderedAbilities_1.next(); !orderedAbilities_1_1.done; orderedAbilities_1_1 = orderedAbilities_1.next()) {
                            a = orderedAbilities_1_1.value;
                            dbTextMap.set(a.name.trim(), a.id);
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (orderedAbilities_1_1 && !orderedAbilities_1_1.done && (_a = orderedAbilities_1.return)) _a.call(orderedAbilities_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    try {
                        for (courseSets_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_1_1 = courseSets_1.next(); !courseSets_1_1.done; courseSets_1_1 = courseSets_1.next()) {
                            template = courseSets_1_1.value.template;
                            try {
                                for (_f = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.centralContent), _g = _f.next(); !_g.done; _g = _f.next()) {
                                    cc = _g.value;
                                    dbTextMap.set(cc.name.trim(), cc.id);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            try {
                                for (_h = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.knowledgeRequirements), _j = _h.next(); !_j.done; _j = _h.next()) {
                                    kr = _j.value;
                                    dbTextMap.set(kr.name.trim(), kr.id);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (_j && !_j.done && (_d = _h.return)) _d.call(_h);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (courseSets_1_1 && !courseSets_1_1.done && (_b = courseSets_1.return)) _b.call(courseSets_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                    _k = diffSubjectGlobalTexts(dbTextMap, subjectToImport.abilities), newAbilityTexts = _k.newTexts, abilitiesToAdd = _k.idsToAdd;
                    _l = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.centralContent.map(function (cc) { return cc.html; }); }))), newCCTexts = _l.newTexts, ccsToAdd = _l.idsToAdd;
                    _m = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.knowledgeRequirements.map(function (kr) { return kr.html; }); }))), newKRTexts = _m.newTexts, krsToAdd = _m.idsToAdd;
                    console.log("Abilities to add: " + abilitiesToAdd.size);
                    console.log("CCs to add: " + ccsToAdd.size);
                    console.log("KRs to add: " + krsToAdd.size);
                    abilityIdsToMigrate = getIdsToMigrate(orderedAbilities, subjectToImport.abilities.map(function (html) { return ({ html: html }); }), newAbilityTexts, "abilities");
                    idsToMigratePerCourse = courseSets.map(function (_a, i) {
                        var template = _a.template;
                        console.log("Course: " + template.name);
                        var xmlCourse = subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; });
                        return {
                            courseCode: template.code,
                            ccsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.centralContent, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.centralContent.map(function (_a) {
                                    var html = _a.html;
                                    return ({ html: html });
                                }), newCCTexts, "central content", template.name) :
                                new Map(),
                            krsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.knowledgeRequirements, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.knowledgeRequirements, newKRTexts, "knowledge requirements", template.name) :
                                new Map()
                        };
                    });
                    // OK so now we have all info.
                    // Now, we need to:
                    // Subject:
                    // 1. Remove links from subjects to abilities
                    // 2. Add links from subjects to abilities
                    abilityIdsToMigrate.forEach(function (_a, oldId) {
                        var newText = _a.newText, newId = _a.newId, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                        //const oldText = existingSubject.abilities.find(a => a.id === oldId).name;
                        changes.push({
                            change: (oldText ?
                                newText ?
                                    isTypoFix ?
                                        "Tryckfelsr\u00E4ttning F\u00F6rm\u00E5ga" :
                                        "Uppdaterad F\u00F6rm\u00E5ga" :
                                    "Borttagen F\u00F6rm\u00E5ga" :
                                "Ny F\u00F6rm\u00E5ga"),
                            content: "<strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                            mutations: function (br) {
                                if (newId && abilitiesToAdd.has(newId)) {
                                    var a = {
                                        id: newId,
                                        name: newText,
                                        acl: ["role:USER:R"],
                                        dateTime: Date.now()
                                    };
                                    br.add("abilities", a);
                                }
                                if (oldText)
                                    br.unlink2("subjects", existingSubject.id, "abilities", oldId);
                                if (newId)
                                    br.link2("subjects", existingSubject.id, "abilities", newId);
                            }
                        });
                    });
                    // 3. Update abilitiesOrder on Subject based on subjectToImport.abilities (mapped to ids in newTexts)
                    if (!existingSubject.abilitiesOrder || abilityIdsToMigrate.size > 0) {
                        existingSubject.abilitiesOrder = subjectToImport.abilities.map(function (xml) { return newAbilityTexts.get(xml); });
                        changes.push({
                            mutations: function (br) { return br.put("subjects", existingSubject); },
                            change: existingSubject.abilitiesOrder ?
                                null : // Ändringen redan visuell som "Uppdaterad för förmåga", etc, ovan
                                "Inf\u00F6r en ordnad lista p\u00E5 f\u00F6rm\u00E5gor i databasen",
                        });
                    }
                    createdIds = new Set();
                    changes.push({ mutations: function () { return createdIds.clear(); } }); // In case mutations run twice (which it doesn't as of current impl.)
                    shownChanges = new Set();
                    changes.push({ mutations: function () { return shownChanges.clear(); } });
                    _loop_1 = function (template, instances) {
                        var e_12, _a;
                        // Find courseToImport
                        var courseToImport = (subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; }));
                        // Find Central Content and Knowledge Requirements to migrate
                        var _b = idsToMigratePerCourse.find(function (x) { return x.courseCode === template.code; }), ccsToMigrate = _b.ccsToMigrate, krsToMigrate = _b.krsToMigrate;
                        try {
                            // Loop through all course instances (instances also contains templates)
                            // and migrate them. This will include creating missing entities in the DB.
                            for (var instances_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](instances), instances_1_1 = instances_1.next(); !instances_1_1.done; instances_1_1 = instances_1.next()) {
                                var course = instances_1_1.value;
                                migrateCourseInstance(course, courseToImport, { ccsToMigrate: ccsToMigrate, krsToMigrate: krsToMigrate });
                            }
                        }
                        catch (e_12_1) { e_12 = { error: e_12_1 }; }
                        finally {
                            try {
                                if (instances_1_1 && !instances_1_1.done && (_a = instances_1.return)) _a.call(instances_1);
                            }
                            finally { if (e_12) throw e_12.error; }
                        }
                    };
                    try {
                        // Courses:
                        // 1. Go through all course instances and:
                        //      A: Remove links from courses to abilities listed in abilityIdsToMigrate.keys()
                        //      B: Add links from courses to abilities abiltitiesToMigrate.values()
                        //      C: Update abilitiesOrder on course instances based on subjectToImport (mapped to ids in newTexts)
                        // 2, 3: Do the same for central-content and knowledge-requirementes:
                        //    Find ccs and krs to migrate based on courseInstance.code
                        //    For both ccs and krs, do:
                        //      A: Unlink ccsToMigrate.keys()
                        //      B: Link ccsToMigrate.values()
                        //      C: Update centralContentOrder based on subjectToImport.centralContent mapped to newTexts ids
                        //      (same for krsToMigrate, with knowledgeRequirementsOrder instead)
                        for (courseSets_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_2_1 = courseSets_2.next(); !courseSets_2_1.done; courseSets_2_1 = courseSets_2.next()) {
                            _o = courseSets_2_1.value, template = _o.template, instances = _o.instances;
                            _loop_1(template, instances);
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (courseSets_2_1 && !courseSets_2_1.done && (_e = courseSets_2.return)) _e.call(courseSets_2);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                    return [4 /*yield*/, migrateTasks()];
                case 1:
                    _p.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/index.tsx":
/*!**********************************************************!*\
  !*** ./src/components/course-builder/subjects/index.tsx ***!
  \**********************************************************/
/*! exports provided: ShowSubject, Subjects */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subjects", function() { return Subjects; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _show_subject__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./show-subject */ "./src/components/course-builder/subjects/show-subject.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return _show_subject__WEBPACK_IMPORTED_MODULE_3__["ShowSubject"]; });

/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _subjects_inner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./subjects-inner */ "./src/components/course-builder/subjects/subjects-inner.tsx");






var Subjects = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Subjects, _super);
    function Subjects(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isListingSubjects: true,
            primarySchoolSubjects: [],
            uploadedSubject: null
        };
        return _this;
    }
    Subjects.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_4__["CourseBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnen"], ["\u00C4mnen"]))), activePage: "subjects", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects_inner__WEBPACK_IMPORTED_MODULE_5__["SubjectsInner"], { linkPrefix: "/subjects/" }));
    };
    return Subjects;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject-inner.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject-inner.tsx ***!
  \***********************************************************************/
/*! exports provided: ShowSubjectInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubjectInner", function() { return ShowSubjectInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");




var ShowSubjectInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubjectInner, _super);
    function ShowSubjectInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubjectInner.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubjectInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubjectInner.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schoolType === 'primary' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Grundskole\u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, code = _a.code, publishable = _a.publishable, points = _a.points, schoolGrade = _a.schoolGrade;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " f\u00F6r \u00E5rskurs ",
                    schoolGrade);
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Kurser f\u00F6r \u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, name = _a.name, code = _a.code, publishable = _a.publishable, points = _a.points;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " - ",
                    points,
                    "p");
            }))));
    };
    return ShowSubjectInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject.tsx ***!
  \*****************************************************************/
/*! exports provided: ShowSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return ShowSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _show_subject_inner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./show-subject-inner */ "./src/components/course-builder/subjects/show-subject-inner.tsx");






var ShowSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubject, _super);
    function ShowSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubject.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubject.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubject.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_3__["CourseBanner"], { title: name, activePage: "subjects", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_show_subject_inner__WEBPACK_IMPORTED_MODULE_5__["ShowSubjectInner"], { id: this.props.id }));
    };
    return ShowSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/skolverket-subject.ts":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/subjects/skolverket-subject.ts ***!
  \**********************************************************************/
/*! exports provided: parseSkolverketYears */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseSkolverketYears", function() { return parseSkolverketYears; });
function parseSkolverketYears(inYear) {
    switch (inYear.trim()) {
        case '3':
        case '1-3':
            return ['1-3'];
        case '6':
        case '4-6':
            return ['4-6'];
        case '7-9':
        case '9':
            return ['7-9'];
        // Specials
        case '1': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1s': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1-6': return ["1-3", "4-6"]; // Förekommer i ämnet "Hem- och konsumentkunskap"
        case '4-9': return ["4-6", "7-9"]; // Förekommer i ämnet "Moderna språk"
        default: {
            throw new Error("Unexpected year in Skolverket XML: " + inYear + ". Expecting 3,6,9 or 1-3, 4-6, 7-9");
        }
    }
}


/***/ }),

/***/ "./src/components/course-builder/subjects/subjects-inner.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/course-builder/subjects/subjects-inner.tsx ***!
  \*******************************************************************/
/*! exports provided: ShowSubject, SubjectsInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectsInner", function() { return SubjectsInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _skolverket_subject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./skolverket-subject */ "./src/components/course-builder/subjects/skolverket-subject.ts");
/* harmony import */ var _uploaded_subject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./uploaded-subject */ "./src/components/course-builder/subjects/uploaded-subject.tsx");
/* harmony import */ var _show_subject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./show-subject */ "./src/components/course-builder/subjects/show-subject.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return _show_subject__WEBPACK_IMPORTED_MODULE_7__["ShowSubject"]; });

/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");











var SubjectsInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SubjectsInner, _super);
    function SubjectsInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isListingSubjects: true,
            gymnasiumSubjects: [],
            primarySchoolSubjects: [],
            uploadedSubject: null
        };
        return _this;
    }
    SubjectsInner.prototype.componentWillMount = function () {
        this.load();
    };
    SubjectsInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subjects, gymnasiumSubjects, primarySchoolSubjects;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        subjects = _a.sent();
                        subjects.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("name"));
                        gymnasiumSubjects = subjects.filter(function (s) { return s.schoolType !== 'primary'; });
                        primarySchoolSubjects = subjects.filter(function (s) { return s.schoolType === 'primary'; });
                        this.setState({ gymnasiumSubjects: gymnasiumSubjects, primarySchoolSubjects: primarySchoolSubjects, isListingSubjects: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.handleFileSelect = function (ev) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var files, xml, doc, typeOfSchooling, schoolType, model, courses, i, course, knownledgeRequirements, centralContents, knowledgeRequirements, centralContentsByStadium_1, knowledgeRequirementsByStadium_1, subjectName_1, subjectCode_1, subjectPurpose, coursesByStadium, model;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        ev.stopPropagation();
                        ev.preventDefault();
                        files = ev.dataTransfer.files;
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_9__["readBlobAsText"])(files[0])];
                    case 1:
                        xml = _a.sent();
                        doc = jquery__WEBPACK_IMPORTED_MODULE_4___default()(jquery__WEBPACK_IMPORTED_MODULE_4___default.a.parseXML(xml));
                        typeOfSchooling = doc.find("subject>originatorTypeOfSchooling").text().trim() ||
                            doc.find("subject>typeOfSchooling").text().trim();
                        schoolType = typeOfSchooling === "COMPULSORY_SCHOOL" ?
                            'primary' :
                            typeOfSchooling === "UPPER_SECONDARY_EDUCATION" ?
                                'gymnasium' :
                                null;
                        if (schoolType === 'gymnasium') {
                            model = {
                                name: doc.find("subject>name").text().trim(),
                                code: doc.find("subject>code").text().trim(),
                                purpose: doc.find("subject>purpose").text().trim(),
                                courses: [],
                                schoolType: 'gymnasium'
                            };
                            courses = doc.find("subject>courses");
                            for (i = 0; i < courses.length; ++i) {
                                course = jquery__WEBPACK_IMPORTED_MODULE_4___default()(courses[i]);
                                knownledgeRequirements = [].slice.call(course.find("knowledgeRequirements"))
                                    .map(function (r) { return ({
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('gradeStep').text().trim(),
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('text').text().trim()
                                }); });
                                model.courses.push({
                                    name: course.find("name").text().trim(),
                                    code: course.find("code").text().trim(),
                                    centralContent: course.find("centralContent").text().trim(),
                                    points: parseInt(course.find("point").text().trim()),
                                    knownledgeRequirements: knownledgeRequirements,
                                });
                            }
                            this.setState({ uploadedSubject: model });
                        }
                        else {
                            centralContents = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>centralContent"))
                                .map(function (cc) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('year').text().trim();
                                var typeOfCentralContent = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('typeOfCentralContent').text().trim();
                                if (typeOfCentralContent) {
                                    // Do not yet support multiple types of central content.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                var stadiums = Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year);
                                var centralContentsForEachStadium = stadiums.map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('text').text().trim()
                                }); });
                                return centralContentsForEachStadium;
                            }));
                            knowledgeRequirements = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>knowledgeRequirement"))
                                .map(function (kr) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('year').text().trim();
                                var typeOfRequirement = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('typeOfRequirement').text().trim();
                                if (typeOfRequirement) {
                                    // Do not yet support multiple types of knowledge requirement.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                return Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year).map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('text').text().trim(),
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('gradeStep').text().trim()
                                }); });
                            }));
                            centralContentsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(centralContents, function (cc) { return cc.year; });
                            knowledgeRequirementsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(knowledgeRequirements, function (kr) { return kr.year; });
                            subjectName_1 = doc.find("subject>name").text().trim();
                            subjectCode_1 = doc.find("subject>code").text().trim();
                            subjectPurpose = doc.find("subject>purpose").text().trim();
                            coursesByStadium = ['1-3', '4-6', '7-9']
                                .map(function (stadium) { return ({
                                name: subjectName_1 + ' ' + stadium,
                                code: subjectCode_1 + '|' + stadium,
                                points: 0,
                                year: stadium,
                                centralContent: (centralContentsByStadium_1[stadium] || []).map(function (cc) { return cc.text; }).join('\n'),
                                knownledgeRequirements: (knowledgeRequirementsByStadium_1[stadium] || []).map(function (_a) {
                                    var gradeStep = _a.gradeStep, text = _a.text;
                                    return ({ gradeStep: gradeStep, text: text });
                                })
                            }); });
                            model = {
                                name: subjectName_1,
                                code: subjectCode_1,
                                purpose: subjectPurpose,
                                schoolType: 'primary',
                                courses: coursesByStadium
                            };
                            this.setState({ uploadedSubject: model });
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.onImportSuccess = function (subject) {
        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Importen av ", " lyckades"], ["Importen av ", " lyckades"])), subject));
        this.setState({ uploadedSubject: null });
        this.load();
    };
    SubjectsInner.prototype.render = function () {
        var _this = this;
        var linkPrefix = this.props.linkPrefix;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, this.state.uploadedSubject ?
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_uploaded_subject__WEBPACK_IMPORTED_MODULE_6__["UploadedSubject"], { onCancel: function () { return _this.setState({ uploadedSubject: null }); }, onImportSuccess: function (subject) { return _this.onImportSuccess(subject); }, subject: this.state.uploadedSubject })
            : this.state.isListingSubjects ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__["Spinner"], null),
                        "Var god v\u00E4nta medan \u00E4mnen h\u00E4mtas...")) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Gymnasie\u00E4mnen"], ["Gymnasie\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.gymnasiumSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Grundskole\u00E4mnen"], ["Grundskole\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.primarySchoolSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone", onDragOver: _utils__WEBPACK_IMPORTED_MODULE_9__["allowCopy"], onDrop: function (ev) { return _this.handleFileSelect(ev); } },
                        "Droppa Subject-fil h\u00E4r fr\u00E5n skolverket (H\u00E4mtas fr\u00E5n ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "http://opendata.skolverket.se", target: "skolverket" }, "opendata.skolverket.se"),
                        ")")));
    };
    return SubjectsInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-builder/subjects/uploaded-subject.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/subjects/uploaded-subject.tsx ***!
  \*********************************************************************/
/*! exports provided: UploadedSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UploadedSubject", function() { return UploadedSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./diff/diff-xml-with-database */ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts");







var UploadedSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UploadedSubject, _super);
    function UploadedSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.coursesElems = {};
        _this.centralContentElems = [];
        _this.knowledgeRequirementElems = [];
        _this.state = {
            showFullText: false,
            changes: [],
            isWorking: true,
            isImporting: false
        };
        return _this;
    }
    UploadedSubject.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, changes, subjectToImport, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.addClassesForCherryPickedElements();
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, 4, 5]);
                        return [4 /*yield*/, this.diffWithExisting()];
                    case 2:
                        _a = _b.sent(), changes = _a.changes, subjectToImport = _a.subjectToImport;
                        this.setState({ changes: changes, subjectToImport: subjectToImport });
                        return [3 /*break*/, 5];
                    case 3:
                        error_1 = _b.sent();
                        this.setState({ error: '' + error_1 });
                        return [3 /*break*/, 5];
                    case 4:
                        this.setState({ isWorking: false });
                        return [7 /*endfinally*/];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.addClassesForCherryPickedElements = function () {
        var abilities = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li');
        abilities.addClass('ability');
        var centralContents = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.centralContentElems).find('li');
        centralContents.addClass('central-content');
        var knowledgeRequirements = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.knowledgeRequirementElems).find('p');
        knowledgeRequirements.addClass('knowledge-requirement');
        var all = jquery__WEBPACK_IMPORTED_MODULE_3___default()([abilities, centralContents, knowledgeRequirements]);
        all.addClass('marked-area');
    };
    UploadedSubject.prototype.cherryPickData = function () {
        var _this = this;
        //
        // Reads elements (tagged by classes in addClassesForCherryPickedElements()) and converts their inner HTML to the corresponding
        // model SubjectToImport. Note that if we need to adjust how to pick the right LI or P elements, we
        // will only need to change the code in addClassesForCherryPickedElements(), not this code.
        //
        var skolSubject = this.props.subject;
        var abilitiesLis = Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li'));
        var abilities = abilitiesLis.map(function (a, i) { return (i + 1 + ". " + jquery__WEBPACK_IMPORTED_MODULE_3___default()(a).html()).trim(); }).filter(function (html) { return !!html; });
        var result = {
            name: skolSubject.name,
            code: skolSubject.code,
            schoolType: skolSubject.schoolType,
            abilities: abilities,
            courses: Object.keys(this.coursesElems)
                .map(function (courseCode) { return _this.coursesElems[courseCode]; })
                .map(function (_a) {
                var course = _a.course, elem = _a.elem;
                return ({
                    name: course.name,
                    year: course.year,
                    code: course.code,
                    points: course.points,
                    centralContent: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.central-content')).map(function (c) { return ({
                        html: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).html().trim(),
                        group: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).parent('ul').prev('h4').text().trim()
                    }); }).filter(function (_a) {
                        var html = _a.html;
                        return !!html;
                    }),
                    knowledgeRequirements: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-none .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: null, html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-E .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "E", html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-C .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "C", html: html }); }))
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-A .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "A", html: html }); })))
                });
            })
        };
        return result;
    };
    UploadedSubject.prototype.diffWithExisting = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            function ct() {
                var rv = createTime;
                createTime += 2;
                return rv;
            }
            var e_1, _a, e_2, _b, subjectToImport, changes, existingSubjects, existingSubject, centralContent, knowledgeRequirements, createTime, newSubject_1, subjectAbilities, _loop_1, _c, _d, a, _loop_2, _e, _f, c;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_g) {
                switch (_g.label) {
                    case 0:
                        subjectToImport = this.cherryPickData();
                        changes = [];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        existingSubjects = _g.sent();
                        existingSubject = existingSubjects.filter(function (s) { return s.code === _this.props.subject.code; })[0];
                        centralContent = [], knowledgeRequirements = [];
                        createTime = Date.now();
                        if (!existingSubject) return [3 /*break*/, 3];
                        // Include abilities and standardCourses with the found Subject:
                        return [4 /*yield*/, Object(_diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__["diffXmlWithDatabase"])(existingSubject, subjectToImport, changes)];
                    case 2:
                        // Include abilities and standardCourses with the found Subject:
                        _g.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        newSubject_1 = existingSubject = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            schoolType: subjectToImport.schoolType,
                            tags: ["schoolType:" + subjectToImport.schoolType],
                            acl: ["role:USER:R"],
                            code: subjectToImport.code,
                            name: subjectToImport.name,
                            abilitiesOrder: [],
                            publishable: false,
                            dateTime: ct()
                        };
                        changes.push({
                            change: "Nytt ämne",
                            content: subjectToImport.name + " (" + subjectToImport.code + ")",
                            mutations: function (r) { return r.add("subjects", newSubject_1); }
                        });
                        subjectAbilities = [];
                        _loop_1 = function (a) {
                            var newAbility = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                name: a,
                                acl: ["role:USER:R"],
                                dateTime: ct()
                            };
                            subjectAbilities.push(newAbility); // To refer from in courses later on!
                            changes.push({
                                change: "Ny förmåga",
                                content: a,
                                mutations: function (r) {
                                    r.add("abilities", newAbility);
                                    r.link("subjects", newSubject_1.id, "abilities", newAbility.id, "abilities");
                                }
                            });
                        };
                        try {
                            for (_c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.abilities), _d = _c.next(); !_d.done; _d = _c.next()) {
                                a = _d.value;
                                _loop_1(a);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        // Update now when we have abilities order:
                        newSubject_1.abilitiesOrder = subjectAbilities.map(function (_a) {
                            var id = _a.id;
                            return id;
                        });
                        _loop_2 = function (c) {
                            var e_3, _a, e_4, _b, e_5, _c;
                            var newCourse = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                subjectCode: newSubject_1.code,
                                schoolType: newSubject_1.schoolType,
                                tags: [
                                    "sub:" + newSubject_1.code,
                                    "course:" + c.code,
                                    "schoolType:" + newSubject_1.schoolType
                                ],
                                dateTime: ct(),
                                isTemplate: true,
                                acl: ["role:EMPLOYEE:R"],
                                name: c.name,
                                code: c.code,
                                points: c.points,
                                modules: [],
                                subjectId: newSubject_1.id,
                                resources: [],
                                createdBy: { name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.displayName, url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.mail },
                                createdDate: Date.now(),
                                knowledgeRequirementsOrder: [],
                                centralContentOrder: [],
                                abilitiesOrder: subjectAbilities.map(function (_a) {
                                    var id = _a.id;
                                    return id;
                                })
                            };
                            if (c.year)
                                newCourse.schoolGrade = c.year;
                            changes.push({
                                change: "Ny kurs",
                                content: c.name,
                                mutations: function (r) {
                                    r.add("courses", newCourse);
                                    r.link("subjects", newSubject_1.id, "courses", newCourse.id, "courseTemplates");
                                }
                            });
                            var _loop_3 = function (ccGroup, html) {
                                // Check if there exists an identical central content on previous course first
                                var newCentralContent = centralContent.filter(function (cc) { return cc.name === html; })[0];
                                if (!newCentralContent) {
                                    newCentralContent = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: html,
                                        acl: ["role:USER:R"]
                                    };
                                    if (ccGroup)
                                        newCentralContent.group = ccGroup;
                                    centralContent.push(newCentralContent);
                                    changes.push({
                                        change: "Nytt centralt innehåll",
                                        content: "<h4>" + ccGroup + "</h4>" + html,
                                        mutations: function (r) {
                                            r.add("central-content", newCentralContent);
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                // Register the order in which this central content appeared in the XML:
                                newCourse.centralContentOrder.push(newCentralContent.id);
                            };
                            try {
                                for (var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.centralContent), _e = _d.next(); !_e.done; _e = _d.next()) {
                                    var _f = _e.value, ccGroup = _f.group, html = _f.html;
                                    _loop_3(ccGroup, html);
                                }
                            }
                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                            finally {
                                try {
                                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                                }
                                finally { if (e_3) throw e_3.error; }
                            }
                            var _loop_4 = function (cr) {
                                var newKnowledgeRequirement = knowledgeRequirements.filter(function (kr) { return kr.name === cr.html && kr.gradeStep === cr.gradeStep; })[0];
                                if (!newKnowledgeRequirement) {
                                    newKnowledgeRequirement = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: cr.html,
                                        gradeStep: cr.gradeStep,
                                        acl: ["role:USER:R"]
                                    };
                                    knowledgeRequirements.push(newKnowledgeRequirement);
                                    changes.push({
                                        change: "Nytt kunskapskrav för betyget " + cr.gradeStep,
                                        content: cr.html,
                                        mutations: function (r) {
                                            r.add("knowledge-requirements", newKnowledgeRequirement);
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                // Register the order in which this knowledge requirement appeared in the XML:
                                newCourse.knowledgeRequirementsOrder.push(newKnowledgeRequirement.id);
                            };
                            try {
                                for (var _g = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.knowledgeRequirements), _h = _g.next(); !_h.done; _h = _g.next()) {
                                    var cr = _h.value;
                                    _loop_4(cr);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            var _loop_5 = function (a) {
                                changes.push({
                                    mutations: function (r) {
                                        r.link("courses", newCourse.id, "abilities", a.id, "abilities");
                                    }
                                });
                            };
                            try {
                                // Build knowledge matrix
                                // Link directly from course template to all abilities that the subject has:
                                for (var subjectAbilities_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectAbilities), subjectAbilities_1_1 = subjectAbilities_1.next(); !subjectAbilities_1_1.done; subjectAbilities_1_1 = subjectAbilities_1.next()) {
                                    var a = subjectAbilities_1_1.value;
                                    _loop_5(a);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (subjectAbilities_1_1 && !subjectAbilities_1_1.done && (_c = subjectAbilities_1.return)) _c.call(subjectAbilities_1);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        };
                        try {
                            for (_e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.courses), _f = _e.next(); !_f.done; _f = _e.next()) {
                                c = _f.value;
                                _loop_2(c);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        _g.label = 4;
                    case 4: return [2 /*return*/, { changes: changes, subjectToImport: subjectToImport }];
                }
            });
        });
    };
    UploadedSubject.prototype.cancel = function () {
        this.props.onCancel();
    };
    UploadedSubject.prototype.import = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var allMutations;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ isWorking: true, isImporting: true });
                        allMutations = this.state.changes.map(function (change) { return change.mutations; });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.do(function (r) {
                                allMutations.forEach(function (mut) { return mut(r); });
                            })];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.setState({ isWorking: false, isImporting: false });
                        return [7 /*endfinally*/];
                    case 4:
                        this.props.onImportSuccess(this.props.subject.name);
                        return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.fixL = function (html) {
        return html; //.replace('<l fromat="OL">')
    };
    UploadedSubject.prototype.render = function () {
        var _this = this;
        var subjectToImport = this.state.subjectToImport;
        var subject = this.props.subject;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Uppladdat \u00C4mne ", ""], ["Uppladdat \u00C4mne ", ""])), subjectToImport ? subjectToImport.name : '')),
            this.state.error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Fel: ",
                this.state.error) :
                this.state.isWorking ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Arbetar...") :
                    this.state.isImporting ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Importerar...") :
                        this.state.changes.every(function (c) { return !c.change; }) ? // Inga ändringar att visa (bara pseudo-ändringar)
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kunde inte finna n\u00E5gra f\u00F6r\u00E4ndringar fr\u00E5n befintligt data. Klicka OK f\u00F6r att avbryta och \u00E5terg\u00E5."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); } }, " OK ")) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { border: "1px solid gray", padding: "2px" } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { colSpan: 2 }, "Granskning av \u00E4ndringar i grund-data")),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4ndring"),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inneh\u00E5ll"))),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, this.state.changes.filter(function (change) { return change.change; }).map(function (change, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" } }, change.change),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" }, dangerouslySetInnerHTML: { __html: change.content } })); }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); }, disabled: this.state.isImporting }, "Avbryt"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.import(); }, disabled: this.state.isImporting }, "Importera"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.setState({ showFullText: !_this.state.showFullText }); } }, this.state.showFullText ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["D\u00F6lj nedan"], ["D\u00F6lj nedan"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Visa hela texten fr\u00E5n Skolverket"], ["Visa hela texten fr\u00E5n Skolverket"])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { display: this.state.showFullText ? '' : 'none' } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Namn"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4mneskod"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.code)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Syfte"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.purposeElem = elem; }, dangerouslySetInnerHTML: { __html: this.fixL(subject.purpose) } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurser"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.courses.map(function (course) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { key: course.code, ref: function (elem) { return _this.coursesElems[course.code] = { course: course, elem: elem }; } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kursens namn"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.name)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurskod"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.code)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Po\u00E4ng"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.points)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Centralt inneh\u00E5ll"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.centralContentElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.centralContent) } })),
                                course.knownledgeRequirements.some(function (kr) { return !kr.gradeStep; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav utan betygs\u00E4ttning"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-none", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return !r.gradeStep; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'E'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg E"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-E", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'E'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'C'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg C"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-C", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'C'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'A'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg A"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-A", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'A'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined)); }))))));
    };
    return UploadedSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, getEmailFromDocAccess, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse, hasChanges */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEmailFromDocAccess", function() { return getEmailFromDocAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasChanges", function() { return hasChanges; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: now },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function getEmailFromDocAccess(resource) {
    if (resource.email)
        return resource.email;
    return resource.url ?
        resource.url.startsWith('mailto:') ?
            resource.url.substring('mailto:'.length) :
            resource.url :
        resource.url;
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}
// Check differences between two array of type T
function hasChanges(originalValues, currentValues) {
    return currentValues.filter(function (x) { return !originalValues.includes(x); }).length > 0 || originalValues.filter(function (x) { return !currentValues.includes(x); }).length > 0;
}


/***/ }),

/***/ "./src/components/utility-components/LanguageContext.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/LanguageContext.tsx ***!
  \***************************************************************/
/*! exports provided: LanguageContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LanguageContext", function() { return LanguageContext; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var LanguageContext = react__WEBPACK_IMPORTED_MODULE_0__["createContext"]({ intl: null });


/***/ }),

/***/ "./src/components/utility-components/SetupLanguageIntl.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/SetupLanguageIntl.tsx ***!
  \*****************************************************************/
/*! exports provided: setupIntl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupIntl", function() { return setupIntl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl/locale-data/en */ "./node_modules/react-intl/locale-data/en.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl/locale-data/sv */ "./node_modules/react-intl/locale-data/sv.js");
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../translations/sv.json */ "./src/translations/sv.json");
var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/sv.json */ "./src/translations/sv.json", 1);
/* harmony import */ var _translations_en_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../translations/en.json */ "./src/translations/en.json");
var _translations_en_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/en.json */ "./src/translations/en.json", 1);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__);









var setupIntl = function (Component) {
    return /** @class */ (function (_super) {
        tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_SetupLanguageIntl, _super);
        function _SetupLanguageIntl(props) {
            var _this = _super.call(this, props) || this;
            Object(react_intl__WEBPACK_IMPORTED_MODULE_1__["addLocaleData"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default.a, react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default.a));
            _this.messages = {
                'sv': _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__,
                'en': _translations_en_json__WEBPACK_IMPORTED_MODULE_5__
            };
            moment__WEBPACK_IMPORTED_MODULE_8___default()().locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE);
            return _this;
        }
        _SetupLanguageIntl.prototype.render = function () {
            return react__WEBPACK_IMPORTED_MODULE_6__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_1__["IntlProvider"], { locale: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE, messages: this.messages[_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE] },
                react__WEBPACK_IMPORTED_MODULE_6__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.props)));
        };
        return _SetupLanguageIntl;
    }(react__WEBPACK_IMPORTED_MODULE_6__["Component"]));
};


/***/ }),

/***/ "./src/components/utility-components/content-editable-field.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/utility-components/content-editable-field.tsx ***!
  \**********************************************************************/
/*! exports provided: ContentEditableField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContentEditableField", function() { return ContentEditableField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var ContentEditableField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ContentEditableField, _super);
    function ContentEditableField(props) {
        var _this = _super.call(this, props) || this;
        _this.myself = react__WEBPACK_IMPORTED_MODULE_1__["createRef"]();
        _this.state = {
            text: props.text || ''
        };
        return _this;
    }
    ContentEditableField.prototype.render = function () {
        var _a = this.props, tag = _a.tag, text = _a.text, readOnly = _a.readOnly;
        var TagType = tag;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](TagType, { contentEditable: !readOnly, "data-placeholder": this.props.placeholder, ref: this.myself, className: this.props.className, onChange: this.onChange.bind(this), onKeyDown: this.onKeyDown.bind(this), onKeyUp: this.onKeyUp.bind(this), onBlur: this.onBlur.bind(this), onPaste: this.onPaste.bind(this), dangerouslySetInnerHTML: { __html: text } });
    };
    ContentEditableField.prototype.onChange = function (e) {
        this.setState({ text: this.myself.current.innerText });
    };
    /**
     * Take action depending on key-event
     * @param e event from field
     *
     * If allowNavigation then listen to arrow-keys
     * Limits to maxChars
     */
    ContentEditableField.prototype.onKeyDown = function (e) {
        var text = this.myself.current.innerText;
        if (e.key === 'Escape') {
            this.myself.current.innerText = this.props.text || "";
            this.myself.current.blur();
            e.stopPropagation();
        }
        else if (e.key === 'Enter') {
            e.preventDefault();
            this.navigate(text, 'down');
        }
        else if (e.key === 'Tab') {
            this.propagateOnChange(text);
        }
        else if (text.length >= this.props.maxChars && (/^[\d\w\s]$/.test(e.key) && !(e.metaKey || e.ctrlKey))) {
            e.preventDefault();
        }
        if (this.props.allowNavigation === true) {
            var navDir = e.key.startsWith('Arrow') ? e.key.replace('Arrow', '').toLowerCase() : false;
            var caret = document.getSelection().getRangeAt(0).endOffset; // only works for plaintext
            if (navDir && text.length == 0) {
                this.navigate(text, navDir);
            }
            else if (navDir && (navDir == 'up' || navDir == 'down')) {
                this.navigate(text, navDir);
            }
            else if (navDir && ((navDir == 'left' && caret == 0) ||
                (navDir == 'right' && caret == text.length))) {
                this.navigate(text, navDir);
            }
        }
    };
    /**
     *
     * @param e event from field
     * Solely used to hande validations-issues
     */
    ContentEditableField.prototype.onKeyUp = function (e) {
        var text = this.myself.current.innerText;
        if (this.props.validateValue !== undefined && !this.props.validateValue.test(text)) {
            this.myself.current.innerText = this.props.text || "";
            this.myself.current.blur();
            e.preventDefault();
        }
    };
    /**
     * Update value and pass to parents navigate-funciton
     * @param text
     * @param direction
     */
    ContentEditableField.prototype.navigate = function (text, direction) {
        // first update cell
        this.propagateOnChange(text);
        this.setState({ text: text });
        // then navigate away
        this.props.onNavigate(direction);
    };
    /**
     * Make sure pasted text is pure text
     * @param e the paset event
     */
    ContentEditableField.prototype.onPaste = function (e) {
        e.preventDefault();
        var text = (e.clipboardData && e.clipboardData.getData) ? e.clipboardData.getData("text/plain") : '';
        document.execCommand("insertHTML", false, text);
    };
    /**
     * Update value on exit from field
     * @param e
     */
    ContentEditableField.prototype.onBlur = function (e) {
        var text = this.myself.current.innerText;
        this.propagateOnChange(text);
        this.setState({ text: text });
    };
    /**
     * Only update value if it has changed
     * @param newValue
     */
    ContentEditableField.prototype.propagateOnChange = function (newValue) {
        if (this.propagatedOnChange != newValue) {
            this.propagatedOnChange = newValue;
            this.props.onChange(newValue);
        }
    };
    return ContentEditableField;
}(react__WEBPACK_IMPORTED_MODULE_1__["PureComponent"]));



/***/ }),

/***/ "./src/components/utility-components/observe.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/observe.tsx ***!
  \*******************************************************/
/*! exports provided: Observe */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observe", function() { return Observe; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/observable */ "./kedbackend/observable.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");




var FiberContextReact = react__WEBPACK_IMPORTED_MODULE_2___default.a.createContext(null);
kedbackend_observable__WEBPACK_IMPORTED_MODULE_1__["FiberContext"].addProvider(function () {
    // Here we actuall do useHook(FiberContext) but without logging to internal debug logs
    // Normally, react hooks are sensitive in which order they are called (useState(), etc)
    // but useContext() is not sensitive about that at all.
    // Still, the debug version of react will log calls to useHook() and throw if a render
    // doesn't use the same number of hooks every time. This check should not apply
    // to useHook() since it is not sensitive to the order in which it was called.
    // And we need to be able to call it from within contitional expressions / statements,
    // so we must bypass this debug logging here by accessing the _currentValue directly.
    return FiberContextReact._currentValue;
});
var Observe = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Observe, _super);
    function Observe(props) {
        var _this = _super.call(this, props) || this;
        _this.subscriptions = [];
        _this.outerSubscription = {
            unsubscribe: function () {
                _this.subscriptions.forEach(function (s) { return s.unsubscribe(); });
                _this.subscriptions = [];
            }
        };
        _this.observer = function (value, error, subscription) {
            if (error) {
                _this.setState({ error: error });
            }
            else {
                _this.setState(function (_a) {
                    var counter = _a.counter;
                    return ({ counter: counter + 1, error: error });
                });
            }
        };
        _this.state = {
            counter: 0,
            error: null
        };
        return _this;
    }
    Observe.prototype.componentDidCatch = function (error, info) {
        if (!error || !error.name)
            error = new Error('' + error);
        this.setState({ error: error, info: info });
        console.log(error, info);
    };
    Observe.prototype.componentWillMount = function () {
        this.outerSubscription.unsubscribe();
    };
    Observe.prototype.render = function () {
        if (this.state.error) {
            return this.props.errorFallback || react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement("p", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda inneh\u00E5llet"], ["Kunde inte ladda inneh\u00E5llet"]))));
        }
        this.outerSubscription.unsubscribe();
        return react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_2__["Suspense"], { fallback: this.props.fallback || null },
            react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(FiberContextReact.Provider, { value: this }, this.props.children));
    };
    return Observe;
}(react__WEBPACK_IMPORTED_MODULE_2___default.a.Component));

var templateObject_1;


/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../charts/goal-progress */ "./src/components/charts/goal-progress.tsx");
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/



var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName, displayProgress = _a.displayProgress, progressData = _a.progressData, inactivated = _a.inactivated, inactivatedRender = _a.inactivatedRender;
        var headerOpen = this.state.headerOpen;
        if (inactivated)
            return inactivatedRender === 'titleAndChildren' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children)) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, children);
        //var currentProgressData = //progressData();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeaderContainer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, title),
                    displayProgress && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__["GoalProgress"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, progressData)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/sortable-task-list.tsx":
/*!******************************************************************!*\
  !*** ./src/components/utility-components/sortable-task-list.tsx ***!
  \******************************************************************/
/*! exports provided: taskHasMigratedTexts, SortableTaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "taskHasMigratedTexts", function() { return taskHasMigratedTexts; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SortableTaskList", function() { return SortableTaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function taskHasMigratedTexts(task) {
    return task.migratedTexts && Object.keys(task.migratedTexts).some(function (type) {
        return Object.keys(task.migratedTexts[type]).length > 0;
    });
}
function SortableTaskList(_a) {
    var taskMetas = _a.taskMetas, renderEditLink = _a.renderEditLink, renderLink = _a.renderLink, onSort = _a.onSort;
    var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(react__WEBPACK_IMPORTED_MODULE_1__["useState"])({
        taskBeingDragged: null,
        taskBeingHovered: null,
        insertBefore: false,
        originClientY: -1
    }), 2), dragState = _b[0], setDragState = _b[1];
    var taskBeingDragged = dragState.taskBeingDragged, taskBeingHovered = dragState.taskBeingHovered, insertBefore = dragState.insertBefore, originClientY = dragState.originClientY;
    return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "taskContainer sortable", onDrop: function (ev) {
            if (taskBeingHovered && taskBeingDragged) {
                onSort(taskBeingDragged, taskBeingHovered, insertBefore ? 'before' : 'after');
            }
            setDragState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState, { taskBeingHovered: null, taskBeingDragged: null }));
        } }, taskMetas.map(function (taskMeta) {
        var task = taskMeta.task, isTaskOwner = taskMeta.isTaskOwner;
        var hasMigratedTexts = taskHasMigratedTexts(task);
        var taskId = task.id;
        return react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, { key: taskId },
            insertBefore && taskBeingHovered === task ?
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "drop-target", onDragOver: function (ev) { return ev.preventDefault(); } }, "\u00A0") :
                null,
            react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: ["align-horizontal", "draggable", task === taskBeingDragged && "drag-source"].filter(function (x) { return x; }).join(' '), draggable: true, onDragStart: function (ev) {
                    ev.dataTransfer.effectAllowed = "move";
                    setDragState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState, { originClientY: ev.clientY, taskBeingDragged: task }));
                }, onDragOver: function (ev) {
                    if (!taskBeingDragged)
                        return;
                    if (taskBeingDragged === task) {
                        setDragState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState, { taskBeingHovered: null }));
                        return;
                    }
                    ev.preventDefault();
                    ev.dataTransfer.dropEffect = "move";
                    setDragState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState, { taskBeingHovered: task, insertBefore: originClientY > ev.clientY }));
                }, onDragEnd: function (ev) {
                    setDragState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, dragState, { taskBeingHovered: null, taskBeingDragged: null }));
                } },
                isTaskOwner && hasMigratedTexts && react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { style: { position: 'relative', top: '0.2em', left: '-0.7em' } },
                        react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("i", { className: "fa fa-pagelines", style: { position: 'absolute', top: 0, left: 0, color: '#49c35a' } }))),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "horizontalItem top" }, renderEditLink(taskMeta)),
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "horizontalItem top" }, renderLink(taskMeta))),
            !insertBefore && taskBeingHovered === task ?
                react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div", { className: "drop-target", onDragOver: function (ev) { return ev.preventDefault(); } }, "\u00A0") :
                null);
    }));
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions-sv.ts":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions-sv.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>F</b>',
        title: 'Fetstil',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>K</i>',
        title: 'Kursiv',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Understruken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Struken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Rubrik 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Rubrik 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Rubrik 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraf',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Citat',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '<i class="fa fa-list-ol" aria-hidden="true"></i>',
        title: 'Ordnad lista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '<i class="fa fa-list" aria-hidden="true"></i>',
        title: 'Punktlista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Programkod',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Vågrät linje',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '<i class="fa fa-link" aria-hidden="true"></i>',
        title: 'Infoga länk',
        result: function () {
            var url = window.prompt('Ange länkens URL');
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('createLink', url);
        }
    },
    image: {
        icon: '<i class="fa fa-picture-o" aria-hidden="true"></i>',
        title: 'Infoga bild',
        promptMsg: 'Ange bildens URL',
        result: function (ev, component) {
            var url = window.prompt(this.promptMsg);
            if (url) {
                //exec('insertImage', url);
                var img = document.createElement("img");
                img.src = url;
                img.tabIndex = 1;
                insertElement(img);
                img.onfocus = component.onFocus;
                img.onblur = component.onBlur;
                component.props.onChange(component.contentDiv.innerHTML);
            }
        }
    }
});
function insertElement(element) {
    var sel, range;
    if (window.getSelection && (sel = window.getSelection()).rangeCount) {
        range = sel.getRangeAt(0);
        range.collapse(true);
        range.insertNode(element);
        // Move the caret immediately after the inserted span
        range.setStartAfter(element);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
    }
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions.ts":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>B</b>',
        title: 'Bold',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>I</i>',
        title: 'Italic',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Underline',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Strike-through',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Heading 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Heading 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Heading 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraph',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Quote',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '&#35;',
        title: 'Ordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '&#8226;',
        title: 'Unordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Code',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Horizontal Line',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '&#128279;',
        title: 'Link',
        result: function () {
            var url = window.prompt('Enter the link URL');
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('createLink', url);
        }
    },
    image: {
        icon: '&#128247;',
        title: 'Image',
        promptMsg: 'Enter the URL of the image',
        result: function () {
            var url = window.prompt(this.promptMsg);
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertImage', url);
        }
    }
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/exec.ts":
/*!***********************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/exec.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (command, value) {
    if (value === void 0) { value = null; }
    document.execCommand(command, false, value);
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/image-edit-actions.ts":
/*!*************************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/image-edit-actions.ts ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return imageEditActions; });
function imageEditActions(cb) {
    return [{
            name: 'float-left',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-right\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; left:-4px;top:0; transform: scale(0.5); transform-origin: left top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Låt bilden flyta vänster om text',
            result: function () { return cb('float-left'); }
        }, {
            name: 'float-right',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-left\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; right:-4px;top:0; transform: scale(0.5); transform-origin: right top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Låt bilden flyta höger om text',
            result: function () { return cb('float-right'); }
        }, {
            name: 'unfloat',
            icon: "<div style=\"position:relative;\" aria-hidden=\"true\">\n      <div style=\"position:absolute;top:0;left:0\">&#8254;</div>\n      <div style=\"position:absolute;top:0:left:0;transform: scale(0.5); transform-origin: left bottom\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n      <div style=\"position:absolute;top:0;left:0\">_</div>\n    </div>",
            title: 'Placera bilden på egen rad',
            result: function () { return cb('unfloat'); }
        }];
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/index.tsx":
/*!*************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/index.tsx ***!
  \*************************************************************/
/*! exports provided: Wysiwyg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Wysiwyg", function() { return Wysiwyg; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");
/* harmony import */ var _wash_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./wash-html */ "./src/components/utility-components/wysiwyg/wash-html.ts");
/* harmony import */ var _image_edit_actions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./image-edit-actions */ "./src/components/utility-components/wysiwyg/image-edit-actions.ts");
/* harmony import */ var _actions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./actions */ "./src/components/utility-components/wysiwyg/actions.ts");






var classes = {
    actionbar: 'wysiwyg-actionbar',
    button: 'wysiwyg-button',
    content: 'wysiwyg-content',
    focusrect: 'wysiwyg-focusrect',
    focuspoint: 'wysiwyg-focuspoint',
    readonlyContent: 'wysiwyg-content readonly'
};
var Wysiwyg = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Wysiwyg, _super);
    function Wysiwyg(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { focusRect: null };
        _this.onFocus = _this.onFocus.bind(_this);
        _this.onBlur = _this.onBlur.bind(_this);
        _this.onMouseDown = _this.onMouseDown.bind(_this);
        _this.onMouseMove = _this.onMouseMove.bind(_this);
        _this.onMouseUp = _this.onMouseUp.bind(_this);
        return _this;
    }
    Wysiwyg.prototype.componentDidMount = function () {
        var _this = this;
        if (!this.props.readOnly) {
            Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
                .forEach(function (elem) {
                elem.tabIndex = 1;
                elem.onfocus = _this.onFocus;
                elem.onblur = _this.onBlur;
            });
            document.querySelector(".wysiwyg-content").addEventListener('mousedown', this.onMouseDown);
            document.querySelector(".wysiwyg-content").addEventListener('mousemove', this.onMouseMove);
            document.querySelector(".wysiwyg-content").addEventListener('mouseup', this.onMouseUp);
        }
        if (this.props.reportNumChars) {
            this.props.reportNumChars((this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length) || 0);
        }
    };
    Wysiwyg.prototype.componentDidUpdate = function () {
        var _this = this;
        Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
            .forEach(function (elem) {
            elem.tabIndex = 1;
            elem.onfocus = _this.onFocus;
            elem.onblur = _this.onBlur;
        });
        if (this.props.reportNumChars) {
            this.props.reportNumChars((this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length) || 0);
        }
    };
    Wysiwyg.prototype.componentWillUnmount = function () {
        document.querySelector(".wysiwyg-content").removeEventListener('mousedown', this.onMouseDown);
        document.querySelector(".wysiwyg-content").removeEventListener('mousemove', this.onMouseMove);
        document.querySelector(".wysiwyg-content").removeEventListener('mouseup', this.onMouseUp);
    };
    Wysiwyg.prototype.shouldComponentUpdate = function (nextProps, nextState) {
        //this.contentDiv.onfocus = this.onFocus;
        //this.contentDiv.onblur = this.onBlur;
        return !this.contentDiv ||
            nextState != this.state ||
            nextProps.readOnly !== this.props.readOnly ||
            Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(nextProps.html) !== Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.contentDiv.innerHTML);
    };
    Wysiwyg.prototype.triggerOnChange = function (html) {
        this.props.onChange && this.props.onChange(Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(html));
    };
    Wysiwyg.prototype.onFocus = function (ev) {
        var elem = ev.target;
        if (!elem || !elem.tagName)
            return;
        if (elem.tagName !== 'IMG' && elem.tagName !== 'A')
            return;
        var contentParent = this.contentDiv.parentElement;
        var newState = {
            focusRect: getRelatativeClientRect(contentParent, elem),
        };
        switch (elem.tagName) {
            case 'A':
            case 'IMG':
            default: break;
        }
        this.setState(newState);
        this.focusElem = elem;
    };
    Wysiwyg.prototype.onBlur = function (ev) {
        /*if (ev.relatedTarget) {
          const relatedTarget = ev.relatedTarget as HTMLElement;
          if (relatedTarget.className && relatedTarget.className.split(' ').indexOf(classes.button) >= 0) {
            // A image action button was pressed
            set
            return;
          }
        }*/
        if ((ev.target === this.focusElem && ev.relatedTarget !== this.focusRectDiv) ||
            ev.target === this.focusRectDiv) {
            this.setState({ focusRect: null });
        }
    };
    Wysiwyg.prototype.makeClickable = function (elem) {
        elem.tabIndex = 1;
    };
    Wysiwyg.prototype.onMouseDown = function (ev) {
        if ((ev.target.className || "").split(' ').indexOf(classes.focuspoint) >= 0) {
            var corner = this.getRectCorner(ev);
            this.corner = corner;
            this.resizeStartX = ev.clientX;
        }
    };
    Wysiwyg.prototype.onMouseMove = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            ev.preventDefault();
            // TODO: Räkna ut baserat på this.corner hur bildens storlek borde ändras.
            // Leta upp bilden per ID från this.contentDiv
            // Sätt DIV:ens style attribut width till ny width.
            // Om DIV:en redan hade height, sätt ny height med samma aspect ratio som innan,
            // annars, sätt inte height alls (eller möjligtvis till auto))
            var focusRect = this.focusRectDiv.getBoundingClientRect();
            if (focusRect.width < 32)
                return;
            //const currentWidth = focusRect.width;
            //const currentHeight = focusRect.height;
            //const hasHeightStyle = !this.focusElem.style.height || this.focusElem.style.height === "auto";
            var newWidth = Math.max(32, this.corner.endsWith('l') ?
                focusRect.width + (this.resizeStartX - ev.clientX) :
                //focusRect.right - ev.clientX :
                focusRect.width - (this.resizeStartX - ev.clientX));
            this.resizeStartX = ev.clientX;
            //ev.clientX - focusRect.left;
            var factor = newWidth / focusRect.width;
            var newHeight = focusRect.height * factor;
            this.focusElem.style.width = newWidth + "px";
            this.focusElem.style.height = newHeight + "px";
            this.setState({
                focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem),
            });
        }
    };
    Wysiwyg.prototype.onMouseUp = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            this.corner = null;
            this.triggerOnChange(this.contentDiv.innerHTML);
        }
    };
    Wysiwyg.prototype.getRectCorner = function (ev) {
        var e_1, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"]((ev.target.className || '').split(' ')), _c = _b.next(); !_c.done; _c = _b.next()) {
                var className = _c.value;
                switch (className) {
                    case 'fpul':
                        return 'ul';
                    case 'fpur':
                        return 'fpur';
                    case 'fplr':
                        return 'lr';
                    case 'fpll':
                        return 'll';
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return null;
    };
    Wysiwyg.prototype.execImageEditAction = function (cmd) {
        //console.log(cmd);
        if (!this.focusElem)
            return;
        //console.log("doing it");
        switch (cmd) {
            case 'float-left':
                this.focusElem.style.cssFloat = 'left';
                break;
            case 'float-right':
                this.focusElem.style.cssFloat = 'right';
                break;
            case 'unfloat':
                this.focusElem.style.cssFloat = '';
                break;
        }
        this.triggerOnChange(this.contentDiv.innerHTML);
        this.setState({ focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem) });
    };
    Wysiwyg.prototype.render = function () {
        var _this = this;
        var defaultActions = this.props.defaultActions || _actions__WEBPACK_IMPORTED_MODULE_5__["default"];
        var actionsToUse = this.props.actions ? this.props.actions.map(function (action) {
            return typeof action === 'string' ?
                defaultActions[action] :
                defaultActions[action.name] ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultActions[action.name], action) :
                    action;
        })
            : Object.keys(defaultActions).map(function (action) { return defaultActions[action]; });
        if (this.state.focusRect) {
            actionsToUse = actionsToUse.concat(Object(_image_edit_actions__WEBPACK_IMPORTED_MODULE_4__["default"])(function (cmd) { return _this.execImageEditAction(cmd); }));
        }
        var focusRect = this.state.focusRect;
        var _a = this.props, readOnly = _a.readOnly, reportNumChars = _a.reportNumChars, maxChars = _a.maxChars;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: this.props.className },
            !readOnly && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.actionbar }, actionsToUse.map(function (action, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { key: idx, className: classes.button, dangerouslySetInnerHTML: { __html: action.icon }, title: action.title, onMouseDown: function (ev) { action.result(ev, _this); }, onMouseUp: function (ev) { return setTimeout(function () { return _this.contentDiv.focus(); }, 10); } });
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: readOnly ? classes.readonlyContent : classes.content, style: { position: 'relative', top: 0, left: 0 } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editor", ref: function (div) { return _this.contentDiv = div; }, dangerouslySetInnerHTML: { __html: Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.props.html) }, contentEditable: !readOnly, onPaste: function (ev) {
                        if (!isNaN(maxChars)) {
                            var target = ev.target, currentTarget = ev.currentTarget;
                            //const textBeingOverwritten = (target as any).innerText || "";
                            var editorText = (currentTarget && currentTarget.innerText) || "";
                            var textBeingPasted = ev.clipboardData.getData("text/plain") || "";
                            if (editorText.length + textBeingPasted.length > maxChars) {
                                ev.preventDefault();
                            }
                        }
                    }, onKeyUp: reportNumChars ? function (ev) {
                        var innerText = ev.target.innerText;
                        reportNumChars(innerText ? innerText.length : 0);
                    } : null, onKeyPress: !isNaN(maxChars) ? function (ev) {
                        var innerText = ev.target.innerText;
                        if (innerText && innerText.length >= maxChars) {
                            ev.preventDefault();
                        }
                    } : null, onInput: function (ev) { return _this.triggerOnChange(ev.target.innerHTML); }, onKeyDown: function (ev) {
                        if (readOnly)
                            return;
                        if (reportNumChars && ev.currentTarget) {
                            reportNumChars((ev.currentTarget.innerText || "").length);
                        }
                        //console.log("Key: " + ev.which);
                        if (ev.which >= 35 && ev.which <= 40) { // home/end/up/down/left/right
                            ev.stopPropagation(); // Prevent entire page from scrolling??
                        }
                        if (ev.which === 9) {
                            ev.preventDefault(); // TAB
                            if (ev.shiftKey) {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("outdent");
                            }
                            else {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("indent");
                            }
                        }
                        if ((ev.keyCode === 8 || ev.keyCode === 46) && // Delete or Back buttons
                            _this.focusElem && _this.state.focusRect) {
                            if (_this.focusElem && _this.focusElem.parentElement) {
                                _this.focusElem.parentElement.removeChild(_this.focusElem); // Remove marked image
                            }
                            _this.focusElem = null;
                            _this.setState({ focusRect: null });
                            _this.triggerOnChange(_this.contentDiv.innerHTML);
                        }
                    } }),
                focusRect && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { ref: function (div) { return _this.focusRectDiv = div; }, className: classes.focusrect, onBlur: this.onBlur, tabIndex: 1, style: {
                        outline: 0,
                        position: 'absolute',
                        top: this.state.focusRect.top,
                        left: this.state.focusRect.left,
                        width: this.state.focusRect.width,
                        height: this.state.focusRect.height
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpul", style: { position: 'absolute', top: 0, left: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpur", style: { position: 'absolute', top: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fplr", style: { position: 'absolute', bottom: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpll", style: { position: 'absolute', bottom: 0, left: 0 } }))));
    };
    return Wysiwyg;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getRelatativeClientRect(parent, child) {
    var parentRect = parent.getBoundingClientRect();
    var childRect = child.getBoundingClientRect();
    return {
        top: childRect.top - parentRect.top + parent.scrollTop,
        left: childRect.left - parentRect.left + parent.scrollLeft,
        bottom: childRect.bottom - parentRect.top + parent.scrollTop,
        right: childRect.right - parentRect.left + parent.scrollLeft,
        width: childRect.width,
        height: childRect.height
    };
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/wash-html.ts":
/*!****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/wash-html.ts ***!
  \****************************************************************/
/*! exports provided: washHtml */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "washHtml", function() { return washHtml; });
var parser = new DOMParser();
/** Tags / Attributes Whitelist
 *
 */
var HTML_WASH_POLICY = {
    b: {},
    i: {},
    p: {},
    u: {},
    strike: {},
    pre: {},
    h1: {},
    h2: {},
    h3: {},
    h4: {},
    h5: {},
    img: { src: true, class: true, style: true, tabindex: true },
    a: { href: true, target: true, tabindex: true },
    ul: {},
    ol: {},
    li: {},
    hr: {},
    br: {},
    div: {},
    span: {},
    // table tags:
    table: { border: true },
    tbody: {},
    thead: {},
    tfoot: {},
    tr: {},
    td: { headers: true, colspan: true, rowspan: true },
    th: { abbr: true, headers: true, scope: true, sorted: true, colspan: true, rowspan: true }
};
function washHtml(html) {
    var doc = parser.parseFromString(html, "text/html");
    var childNodes = doc.body.childNodes;
    var modified = false;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified ?
        doc.body.innerHTML :
        html; // By returning the original HTML string, we spare the user from refreshing the edit area,
    // which would otherwise put the cursor at the top, losing the position where user where.
}
function washNode(node) {
    var modified = false;
    if (isElement(node)) {
        if (washElement(node)) {
            modified = true;
        }
    }
    if (washChildNodes(node)) {
        modified = true;
    }
    return modified;
}
function washChildNodes(node) {
    var modified = false;
    var childNodes = node.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified;
}
/** Replace an element with its child nodes.
 *
 */
function removeMiddleElement(element) {
    var childNodes = element.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        element.parentNode.insertBefore(childNodes.item(i), element);
    }
    element.remove();
}
function washElement(element) {
    var policy = element.tagName && HTML_WASH_POLICY[element.tagName.toLowerCase()];
    if (!policy) {
        console.warn("Wysiwyg: not allowed tag", element.tagName);
        washChildNodes(element);
        removeMiddleElement(element);
        return true;
    }
    var modified = false;
    for (var i = 0; i < element.attributes.length; ++i) {
        var attr = element.attributes.item(i);
        var allowed = attr.name && !!policy[attr.name.toLowerCase()];
        if (!allowed) {
            modified = true;
            console.warn("Wysiwyg: not allowed attribute", attr.name, "Tag: ", element.tagName);
            element.removeAttribute(attr.name);
        }
    }
    return modified;
}
function isElement(node) {
    return !!node.tagName;
}


/***/ }),

/***/ "./src/contracts/ked-models.ts":
/*!*************************************!*\
  !*** ./src/contracts/ked-models.ts ***!
  \*************************************/
/*! exports provided: Course, futureAbilities */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Course", function() { return Course; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "futureAbilities", function() { return futureAbilities; });
var Course = /** @class */ (function () {
    function Course() {
    }
    return Course;
}());

var futureAbilities = [
    "Lära att lära",
    "Samarbeta",
    "Agera globalt",
    "Visa handlingskraft",
    "Vara innovativ",
    "Leva digitalt"
];


/***/ }),

/***/ "./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx":
/*!***********************************************************************!*\
  !*** ./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx ***!
  \***********************************************************************/
/*! exports provided: KEDAppCourseBuilder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDAppCourseBuilder", function() { return KEDAppCourseBuilder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _components_course_builder__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/course-builder */ "./src/components/course-builder/index.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");




var bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer(); // Start getting bearer as soon as possible.







var _KEDAppCourseBuilder = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_KEDAppCourseBuilder, _super);
    function _KEDAppCourseBuilder(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isTokenLoaded: false
        };
        return _this;
    }
    _KEDAppCourseBuilder.prototype.componentWillMount = function () {
        var _this = this;
        bearerPromise.then(function () {
            _this.setState({ isTokenLoaded: true });
        }).catch(function (err) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["showError"])(err);
        });
    };
    _KEDAppCourseBuilder.prototype.render = function () {
        var intl = this.props.intl;
        return this.state.isTokenLoaded ?
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__["LanguageContext"].Provider, { value: { intl: intl } },
                react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_course_builder__WEBPACK_IMPORTED_MODULE_5__["CourseBuilder"], { viewCourseUrl: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_COURSE_VIEWER_URL, feedbackUrl: this.props.feedbackUrl })) :
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_7__["Spinner"], null),
                "V.g. v\u00E4nta... autenticerar...");
    };
    return _KEDAppCourseBuilder;
}(react__WEBPACK_IMPORTED_MODULE_4__["Component"]));
var KEDAppCourseBuilder = Object(_components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_9__["injectIntl"])(_KEDAppCourseBuilder));


/***/ }),

/***/ "./src/elements/KEDAppCourseBuilder/webpack-entry.ts":
/*!***********************************************************!*\
  !*** ./src/elements/KEDAppCourseBuilder/webpack-entry.ts ***!
  \***********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED */ "./src/globals/KED.ts");
/* harmony import */ var _app_coursebuilder_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app.coursebuilder.client */ "./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx");



// Add KEDAppCourseBuilder to the set of components in KED.components
_globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components, { KEDAppCourseBuilder: _app_coursebuilder_client__WEBPACK_IMPORTED_MODULE_2__["KEDAppCourseBuilder"] });


/***/ }),

/***/ "./src/features/feature-flags.json":
/*!*****************************************!*\
  !*** ./src/features/feature-flags.json ***!
  \*****************************************/
/*! exports provided: picker, ksTutorComment, kgTutorComment, termplannerCharts, weekplannerCharts, teacherRights, studyGroups, cbCollapseBoxes, ksAssignments, default */
/***/ (function(module) {

module.exports = {"picker":"Integrate coursebuilder and subjectplanner with Google Picker","ksTutorComment":"Integrate KSTermplanner with tutor comments","kgTutorComment":"Integrate KSTermplanner  with tutor comments","termplannerCharts":"Integrate KSTermplanner with progress charts","weekplannerCharts":"Integrate Weekplanner with progress charts","teacherRights":"Activate course builder teacher rights","studyGroups":"Add study groups functionality","cbCollapseBoxes":"Course Builder: Collapse modules by default","ksAssignments":"KS show hand-in assignments"};

/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "features", function() { return features; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./feature-flags.json */ "./src/features/feature-flags.json");
var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./feature-flags.json */ "./src/features/feature-flags.json", 1);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");




var Features = /** @class */ (function () {
    function Features() {
        var e_1, _a;
        this._initialized = false;
        var _loop_1 = function (featureName) {
            Object.defineProperty(this_1, featureName, {
                get: function () {
                    if (!this._initialized)
                        this.init();
                    return this._features[featureName];
                },
                set: function (value) {
                    throw new Error('Feature flags cannot be set here');
                }
            });
        };
        var this_1 = this;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                _loop_1(featureName);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    Features.prototype.init = function () {
        var e_2, _a;
        if (this._initialized)
            return;
        var turnedOnFeatures = (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["cfg"].KED_FEATURES || "").split(',').map(function (name) { return name.trim().toLowerCase(); });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(location.search, { toLower: true });
        if (query.testversion) {
            turnedOnFeatures = ["*"];
        }
        if (query.features) {
            turnedOnFeatures = query.features
                .split(',')
                .map(function (feature) { return feature.trim().toLowerCase(); });
        }
        var turnOnAll = turnedOnFeatures.includes('*');
        this._features = {};
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                this._features[featureName] = turnOnAll ||
                    turnedOnFeatures.includes(featureName.toLowerCase());
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._initialized = true;
    };
    return Features;
}());

var features = new Features();


/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://backend.kedschools.com/kedbackend-next/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE || "sv"; // "sv", "en". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE || "sv"; // "sv", "en_sin", "en_nin". Only set from process.env if not set from SiteVision element config.


/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "./kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default, cfg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cfg", function() { return cfg; });
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);
var cfg = _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg;


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default, env */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "env", function() { return env; });
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);
var env = _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env;


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/current-user.ts":
/*!*************************************!*\
  !*** ./src/globals/current-user.ts ***!
  \*************************************/
/*! exports provided: getCurrentUser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCurrentUser", function() { return getCurrentUser; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");

function getCurrentUser() {
    return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser;
}


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "./kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "./kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.displayName || _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/school-courses.ts":
/*!*************************************!*\
  !*** ./src/repos/school-courses.ts ***!
  \*************************************/
/*! exports provided: mySchoolCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mySchoolCoursesRepo", function() { return mySchoolCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");




var SchoolCoursesRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolCoursesRepo, _super);
    function SchoolCoursesRepo(getSchoolName) {
        var _this = _super.call(this, {
            query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var schoolName, schools;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            schoolName = getSchoolName();
                            return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list("schools", {
                                    name: schoolName,
                                    include: ["courses"]
                                })];
                        case 1:
                            schools = _a.sent();
                            this._schoolId = schools.length > 0 && schools[0].id;
                            if (!this._schoolId)
                                throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolan ", " finns inte registrerad i systemet.\n          Kontakta en administrat\u00F6r f\u00F6r Kursbyggarverktyget och be om att l\u00E4gga till skolan med namnet \"", "\""], ["Skolan ", " finns inte registrerad i systemet.\n          Kontakta en administrat\u00F6r f\u00F6r Kursbyggarverktyget och be om att l\u00E4gga till skolan med namnet \"", "\""])), schoolName, schoolName));
                            return [2 /*return*/, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.courses; }))];
                    }
                });
            }); }
        }) || this;
        return _this;
    }
    SchoolCoursesRepo.prototype.getSchoolId = function () {
        var _this = this;
        return this.ensureHasData().then(function () { return _this._schoolId; });
    };
    return SchoolCoursesRepo;
}(_repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]));
var mySchoolCoursesRepo = new SchoolCoursesRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school; });
var templateObject_1;


/***/ }),

/***/ "./src/translations/en.json":
/*!**********************************!*\
  !*** ./src/translations/en.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, addeditsubtask.addSubtask, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.ict, termplanner.loadingTermplanner, termplanner.maths, termplanner.modernLanguage, termplanner.noFinalStepAvailable, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.yoga, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.deleteSubtask":"Delete subtask","addeditsubtask.editSubtask":"Edit subtask","addeditsubtask.nameLabel":"Name of subtask","addeditsubtask.addSubtask":"Add sub-task","calendar.currentDate":"Week {week}, {year}","calendar.fullDayEventLocation":"Place: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"W{weekNumber}","common.addDescriptionPlhd":"Add description...","common.cancel":"Cancel","common.changesNotSavedErrorOccured":"An error occured while saving data. Your changes were not saved.","common.changesNotSavedUnauthorized":"The changes were not saved due to insufficient authority","common.descriptionLabel":"Description","common.errorSavingData":"An error occured while saving data.","common.linkLabel":"Link","common.loading":"Loading...","common.nameLabel":"Name","common.save":" Save","common.saved":" Saved","common.saving":"Saving","common.remove":"Delete","customTask.addWorkGoalTitle":"Add own working goal","customTask.enterNamePlhd":"Enter Name...","learningGoalsLost.overall":"Overall","task.addSubtask":"Add subtask","task.editTask":"Edit task","task.editWorkGoals":"Edit working goal","task.enterTaskNamePlhd":"Enter the name of task...","task.removeDeadline":"Delete deadline","task.removeThisTask":"Delete this task","task.removeWorkGoals":"Delete working goal","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Set deadline...","task.subTasks":"Subtasks","task.targetNameLabel":"Name of working goal","task.taskNameLabel":"Name of task","task.whatShouldYouDoPlhd":"What should you do?","taskList.nextWeekTask":"for next week (w{week})","taskList.lastWeekTask":"for last week (w{week})","taskList.currentWeekTask":"for week {week}","taskList.removeTaskFromWeeklyPlanning":"Delete task from your weekly planning {week}","taskList.addTaskToWeeklyPlanning":"Add task to your weekly planning {week}","termplanner.comments":"Comments","termplanner.course":"Theme course","termplanner.edsGoalGrades":"Intermediate goals","termplanner.englishLanguage":"Eng","termplanner.finalStep":"Final Step","termplanner.firstTerm":"FT {year}","termplanner.hindiLanguage":"Hindi","termplanner.ict":"ICT","termplanner.loadingTermplanner":"Loading Termplanner","termplanner.maths":"Maths","termplanner.modernLanguage":"MFL","termplanner.noFinalStepAvailable":"No final step available","termplanner.secondTerm":"ST {year}","termplanner.termPlanning":"Term planner","termplanner.weekNumber":"Week","termplanner.yoga":"Yoga","tutorNoteDialog.weekComment":"Note for week {weekNumber}","test.chooseComponentLabel":"Component","test.pageDescription":"Test page for the components on the starting page","userTasks.addLearningGoal":"Own working goal","userTasks.deleteLearningGoal":"Delete learning goal and its tasks","userTasks.goals":"Own learning goal","weekNotebook.title":"Notepad","weekplanner.addLearningGoal":"Goal:","weekplanner.addLearningGoalTitle":"Add own learning goal","weekplanner.confirmRemoveLearningObjectives":"Delete learning goal and {learningGoalsNumber} tasks?","weekplanner.copyPreviousWeekTaks":"Copy from previous week","weekplanner.emptyLearningGoalErr":"The learning goal cannot be empty","weekplanner.evaluation":"Evaluation","weekplanner.evaluationDescription":"Reflection on your work effort and your chosen strategies during the week. Evaluate in relation to your goals.","weekplanner.learningGoal":"Own learning goal","weekplanner.logBook":"Logbook","weekplanner.nameCannotBeEmpty":"Name cannot be empty","weekplanner.nameMustNotBeEmpty":"Name must not be empty","weekplanner.strategy":"Strategy","weekplanner.strategyAndEvaluation":"Strategy & Evaluation","weekplanner.strategyDescription":"What I should do to learn","weekplanner.weekNumber":"Week {weekNumber}","wysiwyg.bold":"Bold","wysiwyg.code":"Code","wysiwyg.heading1":"Heading 1","wysiwyg.heading2":"Heading 2","wysiwyg.heading3":"Heading 3","wysiwyg.image":"Insert image","wysiwyg.imagePromptMsg":"Enter the URL of the image","wysiwyg.italic":"Italics","wysiwyg.line":"Horizontal line","wysiwyg.link":"Insert link","wysiwyg.olist":"Ordered list","wysiwyg.paragraph":"Paragraph","wysiwyg.quote":"Quote","wysiwyg.strikethrough":"Strikethrough","wysiwyg.ulist":"Bullet list","wysiwyg.underline":"Underline"};

/***/ }),

/***/ "./src/translations/sv.json":
/*!**********************************!*\
  !*** ./src/translations/sv.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.addSubtask, addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, learningGoalsLost.overall, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, taskList.nextWeekTask, taskList.lastWeekTask, taskList.currentWeekTask, taskList.removeTaskFromWeeklyPlanning, taskList.addTaskToWeeklyPlanning, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.swedishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.loadingTermplanner, termplanner.modernLanguageFullname, termplanner.mathsFullname, termplanner.noFinalStepAvailable, termplanner.swedishLanguageFullName, termplanner.englishLanguageFullName, termplanner.maths, termplanner.modernLanguage, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.addSubtask":"Lägg till underuppgift","addeditsubtask.deleteSubtask":"Ta bort underuppgift","addeditsubtask.editSubtask":"Redigera underuppgift","addeditsubtask.nameLabel":"Underuppgiftens namn","calendar.currentDate":"Vecka {week}, {year}","calendar.fullDayEventLocation":"Plats: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"V{weekNumber}","common.addDescriptionPlhd":"Lägg till en beskrivning...","common.cancel":"Avbryt","common.changesNotSavedErrorOccured":"För tillfället problem att spara data. Dina ändringar sparades inte.","common.changesNotSavedUnauthorized":"Ändringarna sparades inte p.g.a. otillräcklig behörighet.","common.descriptionLabel":"Beskrivning","common.errorSavingData":"Kunde inte spara.","common.linkLabel":"Länk","common.loading":"Laddar...","common.nameLabel":"Namn","common.save":" Spara","common.saved":" Sparad","common.saving":"Sparar...","common.remove":"Ta bort","customTask.addWorkGoalTitle":"Lägg till eget arbetsmål","customTask.enterNamePlhd":"Ange namn...","learningGoalsLost.overall":"Övergripande","task.addSubtask":"Lägg till underuppgift","task.editTask":"Redigera uppgift","task.editWorkGoals":"Redigera arbetsmål","task.enterTaskNamePlhd":"Ange uppgiftens namn...","task.removeDeadline":"Ta bort deadline","task.removeThisTask":"Ta bort den här uppgiften","task.removeWorkGoals":"Ta bort arbetsmål","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Ange deadline...","task.subTasks":"Underuppgifter","task.targetNameLabel":"Arbetsmålets namn","task.taskNameLabel":"Uppgiftens namn","task.whatShouldYouDoPlhd":"Vad ska du göra?","taskList.nextWeekTask":"för nästa vecka (v{week})","taskList.lastWeekTask":"för förra veckan (v{week})","taskList.currentWeekTask":"för vecka {week}","taskList.removeTaskFromWeeklyPlanning":"Ta bort uppgiften från egen veckoplanering {week}","taskList.addTaskToWeeklyPlanning":"Lägg till uppgiften i egen veckoplanering {week}","termplanner.comments":"Kommentar","termplanner.course":"Kurs","termplanner.edsGoalGrades":"Terminsmål","termplanner.englishLanguage":"Eng","termplanner.swedishLanguage":"Sv/SvA","termplanner.finalStep":"Slutsteg","termplanner.firstTerm":"HT {year}","termplanner.hindiLanguage":"","termplanner.loadingTermplanner":"V.g. vänta medan terminsplaner laddas...","termplanner.modernLanguageFullname":"M.språk","termplanner.mathsFullname":"Matematik","termplanner.noFinalStepAvailable":"Inget slutsteg tillgängligt","termplanner.swedishLanguageFullName":"Svenska","termplanner.englishLanguageFullName":"Engelska","termplanner.maths":"Ma","termplanner.modernLanguage":"M.spr","termplanner.secondTerm":"VT {year}","termplanner.termPlanning":"Terminsplanering","termplanner.weekNumber":"Vecka","tutorNoteDialog.weekComment":"Kommentar för vecka {weekNumber}","test.chooseComponentLabel":"Komponent","test.pageDescription":"Testsida för komponenter till nya startsidan","userTasks.addLearningGoal":"Eget arbetsmål","userTasks.deleteLearningGoal":"Ta bort lärandemålet och dess uppgifter","userTasks.goals":"Egna lärandemål","weekNotebook.title":"Anteckningar","weekplanner.addLearningGoal":"Mål:","weekplanner.addLearningGoalTitle":"Lägg till eget lärandemål","weekplanner.confirmRemoveLearningObjectives":"Ta bort lärandemål samt {learningGoalsNumber} uppgifter?","weekplanner.copyPreviousWeekTaks":"Kopiera ej klara från föregående vecka","weekplanner.emptyLearningGoalErr":"Lärandemålet kan inte vara tomt","weekplanner.evaluation":"Utvärdering","weekplanner.evaluationDescription":"Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utvärdera i förhållande till dina mål.","weekplanner.learningGoal":"Eget lärandemål","weekplanner.logBook":"Loggbok","weekplanner.nameCannotBeEmpty":"Namnet kan inte vara tomt","weekplanner.nameMustNotBeEmpty":"Namnet får inte vara tomt","weekplanner.strategy":"Strategi","weekplanner.strategyAndEvaluation":"Strategi & Utvärdering","weekplanner.strategyDescription":"Hur jag ska göra för att lära mig.","weekplanner.weekNumber":"Vecka {weekNumber}","wysiwyg.bold":"Fetstil","wysiwyg.code":"Programkod","wysiwyg.heading1":"Rubrik 1","wysiwyg.heading2":"Rubrik 2","wysiwyg.heading3":"Rubrik 3","wysiwyg.image":"Infoga bild","wysiwyg.imagePromptMsg":"Ange bildens URL","wysiwyg.italic":"Kursiv","wysiwyg.line":"Vågrät linje","wysiwyg.link":"Infoga länk","wysiwyg.olist":"Ordnad lista","wysiwyg.paragraph":"Paragraf","wysiwyg.quote":"Citat","wysiwyg.strikethrough":"Struken","wysiwyg.ulist":"Punktlista","wysiwyg.underline":"Understruken"};

/***/ }),

/***/ "./src/utils/cached-response.ts":
/*!**************************************!*\
  !*** ./src/utils/cached-response.ts ***!
  \**************************************/
/*! exports provided: CachedResponse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CachedResponse", function() { return CachedResponse; });
var CachedResponse = /** @class */ (function () {
    function CachedResponse(queryer) {
        this.queryer = queryer;
        this.promise = null;
        this.result = null;
    }
    CachedResponse.prototype.query = function () {
        var _this = this;
        return this.promise ?
            this.promise :
            (this.promise = this.queryer().then(function (x) { return _this.result = x; }));
    };
    CachedResponse.prototype.reset = function () {
        this.promise = null;
    };
    return CachedResponse;
}());



/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 1)
                infos = infos.slice(1);
            return {
                infos: [message] // was: infos.concat(message). But it sucks!
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/keep-session-alive.ts":
/*!*****************************************!*\
  !*** ./src/utils/keep-session-alive.ts ***!
  \*****************************************/
/*! exports provided: keepSessionAlive */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "keepSessionAlive", function() { return keepSessionAlive; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");



var HEARTBEAT_INTERVAL = 5 * 60 * 1000; // 5 minutes.
var HEARTBEAT_URL = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["cfg"].KED_KEEP_ALIVE_URL;
var lastActivity = Date.now();
function keepSessionAlive() {
    setInterval(onTimeout, HEARTBEAT_INTERVAL);
    setTimeout(function () { return jquery__WEBPACK_IMPORTED_MODULE_1___default()('body')
        .mousemove(onUserActive)
        .keypress(onUserActive)
        .scroll(onUserActive); }, 100);
}
function onUserActive() {
    lastActivity = Date.now();
}
function onTimeout() {
    var inactivityTime = Date.now() - lastActivity;
    if (inactivityTime < HEARTBEAT_INTERVAL) {
        heartbeat();
    }
}
function heartbeat() {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var res, err_1;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    console.log("Sending heartbeat request to " + HEARTBEAT_URL);
                    _a.label = 1;
                case 1:
                    _a.trys.push([1, 3, , 4]);
                    return [4 /*yield*/, fetch(HEARTBEAT_URL, {
                            cache: 'no-cache',
                            credentials: 'same-origin'
                        })];
                case 2:
                    res = _a.sent();
                    console.log("Response from " + HEARTBEAT_URL + ": " + res.status + " " + res.statusText);
                    return [3 /*break*/, 4];
                case 3:
                    err_1 = _a.sent();
                    console.warn("Request to " + HEARTBEAT_URL + " failed: " + err_1);
                    return [3 /*break*/, 4];
                case 4: return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/utils/make-suspense-api.ts":
/*!****************************************!*\
  !*** ./src/utils/make-suspense-api.ts ***!
  \****************************************/
/*! exports provided: makeSuspenseApi */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeSuspenseApi", function() { return makeSuspenseApi; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var DEFAULT_CACHE_EXPIRATION = 30 * 60 * 1000; // 30 minutes.
var defaultOptions = {
    isApiMethod: function (f) { return typeof f === 'function'; },
    cacheExpiration: DEFAULT_CACHE_EXPIRATION
};
function makeSuspenseApi(api, options) {
    if (options === void 0) { options = defaultOptions; }
    options = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultOptions, options);
    var isApiMethod = options.isApiMethod, cacheExpiration = options.cacheExpiration;
    var rv = Object.create(api);
    var cache = {};
    // Walk the instance + prototype chain to generate suspense version of each promise returning method
    for (var proto = api; proto && proto !== Object.prototype; proto = Object.getPrototypeOf(proto)) {
        suspendify(proto);
    }
    function suspendify(proto) {
        Object.keys(proto).forEach(function (prop) {
            if (!rv.hasOwnProperty(prop) && isApiMethod(prop)) {
                rv[prop] = function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    var key = JSON.stringify(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([prop], args));
                    var cachedEntry = cache[key];
                    if (cachedEntry !== undefined) {
                        if (cachedEntry.promise)
                            throw cachedEntry.promise;
                        if (cachedEntry.error)
                            throw cachedEntry.error;
                        if (cachedEntry.timeout > Date.now()) {
                            return cachedEntry.value;
                        }
                    }
                    try {
                        var promise = proto[prop].apply(api, args).then(function (result) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, value: result };
                        }).catch(function (error) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                        });
                        cache[key] = { timeout: Date.now() + cacheExpiration, promise: promise };
                        throw promise;
                    }
                    catch (error) {
                        if (error.then)
                            throw error;
                        cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                    }
                };
            }
        });
    }
    return rv;
}


/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStarEndDate, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStarEndDate", function() { return getTermStarEndDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
//Not used anymore
// export function getTermStartAndEnd(now: moment.Moment) : moment.Moment[] {
//     return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
//     [moment(new Date(now.year(), 7, 1)), moment(new Date(now.year(), 11, 31))] : // aug1 - dec31
//     [moment(new Date(now.year(), 0, 1)), moment(new Date(now.year(), 6, 31))]; // jan1 - july31
// }
function getTermStarEndDate(date, isFirstTerm) {
    var addYear = date.getMonth() >= 7;
    var termYear = null;
    if (addYear) {
        termYear = isFirstTerm ? date.getFullYear() : date.getFullYear() + 1;
    }
    else {
        termYear = isFirstTerm ? date.getFullYear() - 1 : date.getFullYear();
    }
    var termYearMoment = moment__WEBPACK_IMPORTED_MODULE_1___default()(termYear.toString(), "YYYY");
    if (termYearMoment.week() != 1) {
        termYearMoment = termYearMoment.clone().add(1, 'week');
    }
    return isFirstTerm ? [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(32).startOf('week'), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(51).endOf('week')] :
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()), moment__WEBPACK_IMPORTED_MODULE_1___default()(termYearMoment.clone()).week(25).endOf('week')];
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6; // determine 
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");


function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        return this.term === 'AT' ? intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'HT {year}' }, { year: year }) :
            intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'VT {year}' }, { year: year });
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        if (firstA == null)
            return -1;
        var firstB = b[firstPart];
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ 0:
/*!*****************************************!*\
  !*** ../locale-data/index.js (ignored) ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 1:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9jbGllbnR3ZWIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvaGFzaC1yZXN0b3Jlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50LXdlYi9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaHR0cC1lcnJvci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3Jlc3RjbGllbnQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vYXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1jb2xsZWN0aW9uL2RlbHRhLWNhY2hlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXJlcG8uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vbXV0YXRpb24tcXVldWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vcXVlcnktc2V0LmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtbW9kZWwtbWlncmF0b3IvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLWNvdXJzZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL2ZpYmVyLWNvbnRleHQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL21peGluLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4va2VkYmFja2VuZC9vYnNlcnZhYmxlLmpzIiwid2VicGFjazovL1tuYW1lXS8uL2tlZGJhY2tlbmQvcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHN2fGVuIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9nZXQtdXNlci1jbGFpbXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2J1dHRvbnMudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2Vkc2NsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9nb29nbGUtY2xhc3Nyb29tLXN5bmMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvZ29vZ2xlLXBpY2tlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9nb29nbGUtd2ViY2xpZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL21vY2svbW9jay1jbGFzc3Jvb20tZGF0YS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvZ29hbC1wcm9ncmVzcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvb3JkZXJlZC1yZXF1aXJlbWVudHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIta3MvbG9naWMvdGFzay1vcmRlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2J1c2luZXNzLWxvZ2ljLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL2NvdXJzZXMvY291cnNlLWJhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvY291cnNlcy9jb3Vyc2UtbW9kdWxlLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL2NvdXJzZXMvY291cnNlLW1vZHVsZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvY291cnNlcy9jcmVhdGUtbmV3LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2VkaXQtY291cnNlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2lubmVyLWVkaXQtY291cnNlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC1yZXNvdXJjZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL2Jhc2ljLWVkaXRhYmxlLXRhc2stZmllbGRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svZWRpdC10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL3ByZXZpZXdhYmxlLXRhc2stZmllbGRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svc2F2ZS1vci1jYW5jZWwtYnV0dG9ucy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL3NlYXJjaC1yZXN1bHRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1jb250ZW50LWZyYWdtZW50LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1taWdyYXRpb24tYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1zdGF0dXMtZnJhZ21lbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL21vZGFsLXBhZ2VzL2VkaXQtd29ya2Zsb3ctbGluay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9lZGl0LXNjaG9vbC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9lZGl0YWJsZS1zY2hvb2wtbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9uZXctc2Nob29sLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lZGl0YWJsZS1yZXNvdXJjZS1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lZGl0YWJsZS10YXNrLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXRlYWNoZXItbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtd29ya2Zsb3ctbGluay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMva25vd2xlZGdlLW1hdHJpeC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NjaG9vbC1jb3Vyc2VzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zZWxlY3QtcmVsYXRlZC1kb2NzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zZWxlY3Qtc3R1ZHktZ3JvdXBzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zZWxlY3QtdGVhY2hlci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvd2VpZ2h0ZWQtaXRlbXMtdGFibGUudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL2RpZmYvZGlmZi14bWwtd2l0aC1kYXRhYmFzZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9kaWZmL21pZ3JhdGUtc3ViamVjdC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvc2hvdy1zdWJqZWN0LWlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9zaG93LXN1YmplY3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL3Nrb2x2ZXJrZXQtc3ViamVjdC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9zdWJqZWN0cy1pbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvdXBsb2FkZWQtc3ViamVjdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvY29udGVudC1lZGl0YWJsZS1maWVsZC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL29ic2VydmUudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3NvcnRhYmxlLXRhc2stbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy1zdi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9hY3Rpb25zLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2V4ZWMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvaW1hZ2UtZWRpdC1hY3Rpb25zLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy93YXNoLWh0bWwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbnRyYWN0cy9rZWQtbW9kZWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9lbGVtZW50cy9LRURBcHBDb3Vyc2VCdWlsZGVyL2FwcC5jb3Vyc2VidWlsZGVyLmNsaWVudC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2VsZW1lbnRzL0tFREFwcENvdXJzZUJ1aWxkZXIvd2VicGFjay1lbnRyeS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZmVhdHVyZXMvZmVhdHVyZXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2ZlYXR1cmVzL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9jb25maWd1cmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1iZWFyZXItcHJvdmlkZXJzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtZWRzLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWtlZC1iYWNrZW5kLWNsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuY2ZnLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC5lbnYudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL2N1cnJlbnQtdXNlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9kYi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9rZWQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3JlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3NjaG9vbC1jb3Vyc2VzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9jYWNoZWQtcmVzcG9uc2UudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9rZWVwLXNlc3Npb24tYWxpdmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL21ha2Utc3VzcGVuc2UtYXBpLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9xdWVyeS1zdHJpbmcudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3NjaG9vbC1tb21lbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3NjaG9vbC10ZXJtLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy91dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4vbG9jYWxlLWRhdGEvaW5kZXguanMgKGlnbm9yZWQpIiwid2VicGFjazovL1tuYW1lXS8uL2xpYi9sb2NhbGVzIChpZ25vcmVkKSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9saWIvbG9jYWxlcyAoaWdub3JlZCk/YTE3NyIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJqUXVlcnlcIiIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJSZWFjdFwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0RE9NXCIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFRLG9CQUFvQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUFpQiw0QkFBNEI7QUFDN0M7QUFDQTtBQUNBLDBCQUFrQiwyQkFBMkI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtEQUEwQyxnQ0FBZ0M7QUFDMUU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxnRUFBd0Qsa0JBQWtCO0FBQzFFO0FBQ0EseURBQWlELGNBQWM7QUFDL0Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUF5QyxpQ0FBaUM7QUFDMUUsd0hBQWdILG1CQUFtQixFQUFFO0FBQ3JJO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBZ0IsdUJBQXVCO0FBQ3ZDOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7Ozs7Ozs7QUNBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7OztBQ0FBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQsMEJBQTBCO0FBQ3hGO0FBQ0E7QUFDQSxvQ0FBb0MsMEJBQTBCO0FBQzlEO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDc0M7QUFDdkMseUQ7Ozs7Ozs7Ozs7OztBQ2xCQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNSO0FBQ1AseURBQXlELHdDQUF3QztBQUNqRztBQUNBLHlDOzs7Ozs7Ozs7Ozs7QUNiQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ21DO0FBQ1U7QUFDVjtBQUNOO0FBQ3JDO0FBQzhCO0FBQ3ZELGlGQUFxQixDQUFDLG9FQUFnQjtBQUMvQixrQkFBa0IsMEZBQTJCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQix5QkFBeUIsdUZBQXFCO0FBQzlDLDZCQUE2Qix1RkFBcUI7QUFDbEQ7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDO0FBQ0EsbUJBQW1CLGlEQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQSxzQ0FBc0MscUJBQXFCLG9CQUFvQjtBQUMvRTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFO0FBQ3RFLDBEQUEwRDtBQUMxRDtBQUNBLGdDQUFnQywyRUFBb0I7QUFDcEQ7QUFDQSwwQ0FBMEMsNkRBQVM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ2tDO0FBQzVCLGtCQUFrQjtBQUN6QjtBQUNBLElBQUksK0NBQWlCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0hBQXdILFVBQVUsK0NBQStDLEVBQUUsRUFBRTtBQUNyTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsQ0FBQyxvRUFBZ0I7QUFDYTtBQUMvQixpQzs7Ozs7Ozs7Ozs7O0FDdEdBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msc0NBQXNDLEVBQUU7QUFDeEUsbUNBQW1DLFdBQVcsRUFBRTtBQUNoRDtBQUNBO0FBQ0Esc0NBQXNDLHNCQUFzQixFQUFFO0FBQzlEO0FBQ0E7QUFDQSxDQUFDO0FBQ3lCO0FBQ25CO0FBQ1AsMENBQTBDLHlEQUF5RCxFQUFFO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBLDBDOzs7Ozs7Ozs7Ozs7QUNyREE7QUFBQTtBQUFBO0FBQWlDO0FBQ2pDO0FBQ0EsSUFBSSwrQ0FBaUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNvQjtBQUNyQixzQzs7Ozs7Ozs7Ozs7O0FDZEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdDQUFpQztBQUNTO0FBQ2xCO0FBQ2tDO0FBQ3pCO0FBQ1g7QUFDbUI7QUFDcEI7QUFDUTtBQUM3QjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0RBQVUsdUJBQXVCLGlDQUFpQztBQUMxRjtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIscURBQVM7QUFDdEM7QUFDQTtBQUNBLGdEQUFnRCxxREFBUztBQUN6RDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBUztBQUN0QztBQUNBO0FBQ0EsZ0RBQWdELHFEQUFTO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDO0FBQ0EsbUJBQW1CLGlEQUFtQjtBQUN0QztBQUNBO0FBQ0EsZ0NBQWdDLDhDQUFnQixHQUFHO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBUztBQUN0QztBQUNBO0FBQ0EsZ0RBQWdELHFEQUFTO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDO0FBQ0EsbUJBQW1CLGlEQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIscURBQVM7QUFDdEM7QUFDQTtBQUNBLGdEQUFnRCxxREFBUztBQUN6RDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixxREFBUztBQUN0QztBQUNBO0FBQ0EsZ0RBQWdELHFEQUFTO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHFDQUFxQywwQkFBMEIsRUFBRTtBQUNqRTtBQUNBO0FBQ0EscUNBQXFDLDBCQUEwQixFQUFFO0FBQ2pFO0FBQ0E7QUFDQSxxQ0FBcUMsZ0RBQWdELEVBQUU7QUFDdkY7QUFDQTtBQUNBLHFDQUFxQywwQ0FBMEMsRUFBRTtBQUNqRjtBQUNBO0FBQ0EscUNBQXFDLGdDQUFnQyxFQUFFO0FBQ3ZFO0FBQ0E7QUFDQSxxQ0FBcUMsNEJBQTRCLEVBQUU7QUFDbkU7QUFDQTtBQUNBLHFDQUFxQyxnQ0FBZ0MsRUFBRTtBQUN2RTtBQUNBO0FBQ0EscUNBQXFDLGtDQUFrQyxFQUFFO0FBQ3pFO0FBQ0E7QUFDQSxxQ0FBcUMsb0VBQW9FLEVBQUU7QUFDM0c7QUFDQTtBQUNBLHFDQUFxQyxrRUFBa0UsRUFBRTtBQUN6RztBQUNBO0FBQ0EscUNBQXFDLHNFQUFzRSxFQUFFO0FBQzdHO0FBQ0E7QUFDQSxxQ0FBcUMsb0VBQW9FLEVBQUU7QUFDM0c7QUFDQTtBQUNBLHFDQUFxQyxxRUFBcUUsRUFBRTtBQUM1RztBQUNBO0FBQ0EsQ0FBQztBQUMyQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLHdEQUF3RDtBQUM1RjtBQUNBO0FBQ0E7QUFDQSxjQUFjLDhDQUFnQixHQUFHO0FBQ2pDLHVCQUF1QjtBQUN2QixvQ0FBb0Msb0NBQW9DO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiw4Q0FBZ0IsR0FBRztBQUN0QyxvQ0FBb0MsNkVBQTZFO0FBQ2pIO0FBQ0E7QUFDQSxvQ0FBb0Msa0VBQWtFO0FBQ3RHO0FBQ0E7QUFDQSxvQ0FBb0MseUNBQXlDO0FBQzdFO0FBQ0E7QUFDQSxvQ0FBb0MscUNBQXFDO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyw4Q0FBOEM7QUFDbEY7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLGdEQUFnRDtBQUNwRjtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsdUhBQXVIO0FBQzNKO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxpSEFBaUg7QUFDcko7QUFDQTtBQUNBLG9DQUFvQyx5SEFBeUg7QUFDN0o7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLG1IQUFtSDtBQUN2SjtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0Msc0hBQXNIO0FBQzFKO0FBQ0E7QUFDQSxDQUFDO0FBQ3NCO0FBQ3ZCLGlDOzs7Ozs7Ozs7Ozs7QUN4T0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNTO0FBQ007QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCLDBCQUEwQixzREFBVTtBQUNwQztBQUNBO0FBQ0EsU0FBUztBQUNULHlCQUF5QixvRUFBcUI7QUFDOUMsNkJBQTZCLG9FQUFxQjtBQUNsRDtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RkFBOEYsa0JBQWtCO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUM0QjtBQUM3QiwrQzs7Ozs7Ozs7Ozs7O0FDMUZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBLG1CQUFtQjs7O0FBR25CO0FBQ0E7QUFDQTtBQUNBO0FBQ2lDO0FBQ0k7QUFDVztBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsMkRBQU87QUFDbEMsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsOENBQWdCLEdBQUcsVUFBVSxVQUFVLHlEQUFVLElBQUk7QUFDekY7QUFDQSxzRkFBc0YsaUNBQWlDLEVBQUU7QUFDekg7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsOENBQWdCLEdBQUcsc0JBQXNCLG1DQUFtQztBQUNwSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0VBQXdFLDhDQUFnQixHQUFHLHNCQUFzQixtQ0FBbUM7QUFDcEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHdDQUF3QywyQkFBMkIsY0FBYztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxRQUFRLDhDQUFnQixHQUFHLGlCQUFpQiw2QkFBNkI7QUFDbEY7QUFDQTtBQUNBLDJDQUEyQywyQkFBMkIsY0FBYyxTQUFTLDhDQUFnQixHQUFHLGlCQUFpQixhQUFhO0FBQzlJO0FBQ0E7QUFDQSxDQUFDO0FBQ3FCO0FBQ3RCLHNDOzs7Ozs7Ozs7Ozs7QUM5SEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDMUI7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixrQkFBa0I7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQLFdBQVcsK0NBQWlCO0FBQzVCO0FBQ0EsZUFBZSxpREFBbUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0EsU0FBUztBQUNULEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNNO0FBQ1A7QUFDQSxpQ0FBaUMsT0FBTztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLEtBQUs7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDOzs7Ozs7Ozs7Ozs7QUNsR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUE0RDtBQUNoQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0VBQWdFLEVBQUU7QUFDcEcsc0NBQXNDLGdCQUFnQixFQUFFO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxnQkFBZ0I7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsUUFBUSxvRUFBaUIsNkJBQTZCLEVBQUU7QUFDM0Ysc0NBQXNDLGdCQUFnQixFQUFFO0FBQ3hEO0FBQ0E7QUFDQSxzRUFBc0UsWUFBWSxFQUFFO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZDQUE2QyxnRUFBaUI7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDb0I7QUFDckIsc0M7Ozs7Ozs7Ozs7OztBQ3pEQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNZO0FBQ3RDO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsZUFBZTtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhDQUFnQixHQUFHLGtCQUFrQiwrQ0FBK0M7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGdFQUFXLHFDQUFxQyx5QkFBeUI7QUFDL0c7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHlCQUF5QjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEOzs7Ozs7Ozs7Ozs7QUMvSkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNvQjtBQUNnQjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLG9CQUFvQjtBQUMvRDtBQUNBLHVEQUF1RCxnQkFBZ0I7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHlGQUFzQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxpREFBaUQ7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNxQjtBQUN0QjtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsZ0NBQWdDLEVBQUUsRUFBRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDO0FBQ0EsbUJBQW1CLGlEQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDZEQUFTO0FBQ3RDO0FBQ0E7QUFDQSxnREFBZ0QsNkRBQVM7QUFDekQ7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsK0NBQStDLGdCQUFnQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxvQkFBb0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCx1Qzs7Ozs7Ozs7Ozs7O0FDOUpBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ2E7QUFDOUM7QUFDQSxJQUFJLCtDQUFpQjtBQUNyQjtBQUNBLDJEQUEyRCxvREFBb0QsRUFBRTtBQUNqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQSxvREFBb0QsOENBQWdCLEdBQUcsZUFBZSxhQUFhO0FBQ25HO0FBQ0E7QUFDQSxDQUFDLENBQUMsc0RBQVU7QUFDZTtBQUMzQiw0Qzs7Ozs7Ozs7Ozs7O0FDcEJBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQzFCO0FBQ1A7QUFDQTtBQUNBLG1DQUFtQyxvQkFBb0I7QUFDdkQ7QUFDQTtBQUNBLHdCQUF3Qiw4Q0FBZ0IsR0FBRztBQUMzQztBQUNBO0FBQ0E7QUFDQSx3Q0FBd0MsNEJBQTRCLEVBQUU7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXVEO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRTtBQUNsRTtBQUNBO0FBQ0EseUVBQXlFLDJCQUEyQjtBQUNwRztBQUNBLCtEQUErRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFLHNDQUFzQyxFQUFFO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUVBQXVFLGdDQUFnQztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksYUFBYSxHQUFHLE9BQU87QUFDM0IsSUFBSSxPQUFPLGFBQWEsR0FBRyxPQUFPLFNBQVM7QUFDcEM7QUFDUCw2Q0FBNkMsMEJBQTBCO0FBQ3ZFLGNBQWM7QUFDZDtBQUNBLHNCQUFzQiw4Q0FBZ0IsR0FBRztBQUN6QyxtQ0FBbUMsb0JBQW9CO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLDRCQUE0QixFQUFFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhGQUE4RjtBQUM5RiwrRUFBK0U7QUFDL0Usb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCw4Q0FBZ0IsR0FBRztBQUNqRjtBQUNBLHlFQUF5RTtBQUN6RSw0RkFBNEYsWUFBWTtBQUN4RztBQUNBO0FBQ0E7QUFDQSwyRUFBMkUsbUNBQW1DLEVBQUU7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCw4Q0FBZ0IsR0FBRztBQUNqRjtBQUNBLHlFQUF5RTtBQUN6RSw0RkFBNEYsZUFBZTtBQUMzRztBQUNBO0FBQ0E7QUFDQSx3RUFBd0Usc0NBQXNDLEVBQUU7QUFDaEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RUFBdUUsZ0NBQWdDO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUM7Ozs7Ozs7Ozs7OztBQzlKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUF3QztBQUNMO0FBQ0Q7QUFDUTtBQUNOO0FBQ0g7QUFDTDtBQUNRO0FBQ3BDLGlDOzs7Ozs7Ozs7Ozs7QUNSQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ21CO0FBQ2U7QUFDMUI7QUFDWTtBQUNDO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSwrQ0FBaUI7QUFDckI7QUFDQTtBQUNBLG1DQUFtQywrRUFBc0I7QUFDekQ7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixpRUFBZTtBQUNsQyxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLCtEQUErRCw4Q0FBZ0IsR0FBRztBQUNsRjtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGNBQWM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxxQkFBcUI7QUFDckQ7QUFDQTtBQUNBLGdDQUFnQyxhQUFhO0FBQzdDO0FBQ0E7QUFDQSx3REFBd0QsWUFBWSxFQUFFO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELFlBQVksRUFBRTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLFlBQVk7QUFDNUMsaUNBQWlDLCtFQUErRSxFQUFFO0FBQ2xILGlDQUFpQywwRUFBMEUsRUFBRTtBQUM3RyxTQUFTO0FBQ1Q7QUFDQTtBQUNBLGdDQUFnQyxXQUFXO0FBQzNDO0FBQ0E7QUFDQSxnQ0FBZ0MsYUFBYTtBQUM3QztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQSxnQ0FBZ0MsYUFBYTtBQUM3QztBQUNBO0FBQ0EsZ0NBQWdDLHFCQUFxQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsWUFBWSxxREFBUywyRUFBMkU7QUFDaEk7QUFDQTtBQUNBLHFCQUFxQiwrREFBVztBQUNoQztBQUNBLGdDQUFnQyx3Q0FBd0M7QUFDeEU7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxrQ0FBa0MsaUJBQWlCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RDtBQUNBO0FBQ0E7QUFDQSxTQUFTLEVBQUUsRUFBRTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLENBQUMsaUVBQVU7QUFDb0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDO0FBQzdDLGlEOzs7Ozs7Ozs7Ozs7QUNyTkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ3lCO0FBQ0c7QUFDbEI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSw0Q0FBYztBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDO0FBQ0E7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQTBEO0FBQzFEO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQyxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EscUVBQXFFLDJCQUEyQixFQUFFO0FBQ2xHO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEMsbUJBQW1CLGlEQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQztBQUNBLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQSx3RkFBd0YsOENBQWdCLEdBQUc7QUFDM0c7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4REFBZTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsNkVBQVc7QUFDbEM7QUFDQTtBQUNBLHlDQUF5QywrREFBVTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyw2RUFBVztBQUMxRDtBQUNBO0FBQ0EscURBQXFELCtEQUFVO0FBQy9EO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLHNDQUFzQyw4Q0FBZ0IsR0FBRyxlQUFlO0FBQ3hFO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw2RUFBVztBQUN0QztBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsOENBQWdCLEdBQUc7QUFDNUQ7QUFDQTtBQUNBLCtCQUErQiw4Q0FBZ0IsR0FBRyxlQUFlO0FBQ2pFLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsZ0VBQWlCO0FBQ3ZEO0FBQ0E7QUFDQSx3RkFBd0Ysd0NBQXdDLEVBQUU7QUFDbEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSwrQkFBK0IsRUFBRTtBQUM1RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEVBQThFO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDZFQUFXO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4Q0FBZ0IsR0FBRyxlQUFlO0FBQ2pFO0FBQ0EsMkRBQTJEO0FBQzNELG9DQUFvQyw4Q0FBZ0IsR0FBRyxNQUFNLG9CQUFvQixFQUFFLEVBQUU7QUFDckY7QUFDQSw4REFBOEQsaUNBQWlDLEVBQUU7QUFDakcscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELG1DQUFtQyw4Q0FBZ0IsR0FBRyxNQUFNLG9CQUFvQixNQUFNLEVBQUU7QUFDM0ksc0RBQXNELGlDQUFpQyxFQUFFO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELHNCQUFzQixFQUFFO0FBQzdFO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxVQUFVLHNCQUFzQixnRUFBaUIsZ0JBQWdCLEVBQUUsRUFBRTtBQUNwSDtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQSwrQkFBK0IsNkVBQVc7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyw4Q0FBZ0IsR0FBRyxlQUFlO0FBQzVFLHNFQUFzRSx3QkFBd0IsOENBQWdCLEdBQUcsTUFBTSxvQkFBb0IsTUFBTSxFQUFFO0FBQ25KO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBLDZCQUE2QjtBQUM3QjtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhDQUFnQixHQUFHO0FBQ3RDLGdEQUFnRCx3Q0FBd0MsRUFBRTtBQUMxRjtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQzBCO0FBQzNCLDRDOzs7Ozs7Ozs7Ozs7QUMzWUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDc0I7QUFDUTtBQUN4QjtBQUNVO0FBQ007QUFDZTtBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDZEQUFhO0FBQ2xEO0FBQ0EsZ0NBQWdDLG1EQUFRO0FBQ3hDO0FBQ0EsOEJBQThCLG1FQUFnQjtBQUM5QyxvQkFBb0Isb0VBQU07QUFDMUIsaUNBQWlDLDJFQUFvQix3Q0FBd0M7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsMEJBQTBCLGtGQUFlO0FBQ3pDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsMkVBQW9CO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RkFBOEYsOENBQWdCLEdBQUc7QUFDakg7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHFCQUFxQjtBQUNqRDtBQUNBO0FBQ0EsNEJBQTRCLGFBQWE7QUFDekM7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixrRUFBa0U7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsMkZBQTJGO0FBQ3hIO0FBQ0E7QUFDQSxlQUFlLCtDQUFpQjtBQUNoQyxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUM7QUFDeUI7QUFDMUIsMkM7Ozs7Ozs7Ozs7OztBQ2pGQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNEO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ2lDO0FBQ2xDLG1EOzs7Ozs7Ozs7Ozs7QUM3QkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDZ0I7QUFDRztBQUNHO0FBQ2Q7QUFDRDtBQUNvQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxtREFBTztBQUMzQztBQUNBO0FBQ0EsOEJBQThCLHdFQUFVO0FBQ3hDO0FBQ0E7QUFDQSwwQkFBMEIsZ0NBQWdDLEVBQUU7QUFDNUQ7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLDBCQUEwQiw0Q0FBNEMsRUFBRTtBQUN4RTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHVCQUF1QixFQUFFO0FBQ3BHLDJFQUEyRSx1QkFBdUIsRUFBRTtBQUNwRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxtQkFBbUI7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEMsdUdBQXVHLG9DQUFvQyxFQUFFO0FBQzdJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsRUFBRSxvQkFBb0Isc0NBQXNDLEVBQUU7QUFDL0c7QUFDQTtBQUNBO0FBQ0EsZUFBZSwrQ0FBaUI7QUFDaEM7QUFDQSxtQkFBbUIsaURBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUZBQXVGO0FBQ3ZGO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qyw0QkFBNEI7QUFDbkU7QUFDQSx5QkFBeUIsRUFBRSxFQUFFO0FBQzdCO0FBQ0Esd0JBQXdCLHFEQUFTO0FBQ2pDO0FBQ0E7QUFDQSxtRUFBbUUsb0JBQW9CO0FBQ3ZGLDJFQUEyRSw2REFBYTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRDtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1EO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHFCQUFxQiwrREFBVztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG9FQUFNO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDMkI7QUFDNUIsNkM7Ozs7Ozs7Ozs7OztBQzNOQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ3NDO0FBQzNCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Q0FBeUMsb0RBQW9ELEVBQUU7QUFDL0Y7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELFFBQVEsdURBQVEsU0FBUyw4REFBZTtBQUN4Rix5Q0FBeUMsRUFBRTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLFFBQVEsZ0VBQWlCLDJCQUEyQixFQUFFO0FBQzVILGdCQUFnQix1REFBUTtBQUN4QjtBQUNBLG1IQUFtSCxRQUFRLGdFQUFpQixlQUFlLEVBQUUsMEJBQTBCLFFBQVEsZ0VBQWlCLGlDQUFpQyxFQUFFO0FBQ25QLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLHVDQUF1Qyw4Q0FBZ0IsR0FBRyxNQUFNLFdBQVcsZ0VBQVcsMERBQTBEO0FBQ2hKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLFNBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDd0I7QUFDekIsMEM7Ozs7Ozs7Ozs7OztBQ25FQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNvQjtBQUNPO0FBQ3ZCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsK0NBQWlCO0FBQ2hDLG1CQUFtQixpREFBbUI7QUFDdEM7QUFDQSw0RkFBNEYsOENBQThDLEVBQUU7QUFDNUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSwrQ0FBK0MsdUJBQXVCLGlFQUFlLHdCQUF3QixFQUFFO0FBQy9HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsbUVBQW1FLEVBQUU7QUFDbEg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxRQUFRLG9FQUFpQix3Q0FBd0MsRUFBRTtBQUM1SDtBQUNBO0FBQ0EsaURBQWlELGdCQUFnQjtBQUNqRTtBQUNBLHNDQUFzQyx5REFBVTtBQUNoRCxzREFBc0Qsd0JBQXdCLEVBQUU7QUFDaEY7QUFDQSx5RUFBeUUsa0JBQWtCLEVBQUU7QUFDN0Y7QUFDQSx3REFBd0Qsb0NBQW9DLG9CQUFvQixFQUFFLEVBQUUsRUFBRTtBQUN0SDtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0Esa0RBQWtELGtDQUFrQyxFQUFFO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IseURBQVU7QUFDekM7QUFDQSxvREFBb0Qsb0NBQW9DLG9CQUFvQixFQUFFLEVBQUUsRUFBRTtBQUNsSDtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0EsMkNBQTJDLGdCQUFnQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixpRUFBZTtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEyRSxzQkFBc0IsRUFBRTtBQUNuRztBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDbUI7QUFDcEIscUM7Ozs7Ozs7Ozs7OztBQ3RKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBdUQ7QUFDaEQ7QUFDUCxXQUFXLG9FQUFNO0FBQ2pCO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDTztBQUNQLHlCQUF5QixpQ0FBaUM7QUFDMUQ7QUFDTztBQUNQLCtCQUErQixhQUFhO0FBQzVDO0FBQ0EseUNBQXlDLGlDQUFpQyxFQUFFO0FBQzVFO0FBQ0EseUNBQXlDLDhCQUE4QixFQUFFO0FBQ3pFO0FBQ0EseUNBQXlDLGlDQUFpQyxFQUFFO0FBQzVFO0FBQ0EseUNBQXlDLDhCQUE4QixFQUFFO0FBQ3pFO0FBQ0EseUNBQXlDLG1FQUFtRSw2QkFBNkIsRUFBRSxFQUFFLEVBQUU7QUFDL0k7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsaUM7Ozs7Ozs7Ozs7OztBQ2hDQTtBQUFBO0FBQUE7QUFBZ0M7QUFDekI7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx3REFBTztBQUNuQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxRQUFRLHdEQUFPLHVEQUF1RCxFQUFFO0FBQ25IO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGlDOzs7Ozs7Ozs7Ozs7QUN2QkE7QUFBQTtBQUFBO0FBQXlDO0FBQzFCO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCxRQUFRLDZEQUFXLE9BQU8sRUFBRTtBQUN0RjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSwwQzs7Ozs7Ozs7Ozs7O0FDakNBO0FBQUE7QUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLHdDOzs7Ozs7Ozs7Ozs7QUNKQTtBQUFBO0FBQUE7QUFBQTtBQUE2QztBQUNKO0FBQzFCO0FBQ2Y7QUFDQTtBQUNBLFlBQVksK0RBQWE7QUFDekI7QUFDQTtBQUNBLFlBQVksNkRBQVc7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsbUM7Ozs7Ozs7Ozs7OztBQ1pBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQWlDO0FBQ1M7QUFDSjtBQUNOO0FBQ0k7QUFDcEM7QUFDQSxJQUFJLCtDQUFpQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0RBQWdELHVCQUF1QixFQUFFO0FBQ3pFO0FBQ0EsZ0NBQWdDLGdEQUFPO0FBQ3ZDLGdEQUFnRCwrQkFBK0IsRUFBRTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyxtQ0FBbUMscUJBQXFCLEVBQUUsRUFBRSxFQUFFO0FBQ3pHO0FBQ0E7QUFDQSwyQ0FBMkMsbUNBQW1DLEVBQUU7QUFDaEY7QUFDQTtBQUNBLDJDQUEyQyw2QkFBNkIsRUFBRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxvREFBb0Q7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsU0FBUyxFQUFFLEVBQUUsNkJBQTZCLFVBQVUsRUFBRTtBQUN0RDtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNENBQUssZUFBZSwyQkFBMkIsRUFBRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esa0RBQWtELGVBQWUsRUFBRTtBQUNuRTtBQUNBO0FBQ0EsQ0FBQyxDQUFDLHNEQUFVO0FBQ1U7QUFDdEIsNEJBQTRCLDBEQUFhO0FBQ3pDLHNDOzs7Ozs7Ozs7Ozs7QUNqRUE7QUFBQTtBQUFBO0FBQUE7QUFBaUM7QUFDRDtBQUNoQztBQUNBLElBQUksK0NBQWlCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQztBQUMxQztBQUNBO0FBQ0EsaUJBQWlCLEVBQUUsRUFBRTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDLENBQUMsNENBQUs7QUFDWTtBQUNuQixtQzs7Ozs7Ozs7Ozs7O0FDL0NBO0FBQUE7QUFBQTtBQUNBO0FBQ0EsOEJBQThCLHFCQUFxQixFQUFFO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUCxtQkFBbUIscUJBQXFCLEVBQUU7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsbURBQW1ELDhCQUE4QixFQUFFO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MscUJBQXFCLG1CQUFtQixHQUFHLEVBQUU7QUFDNUYsMEJBQTBCLG9FQUFvRTtBQUM5RixLQUFLO0FBQ0w7QUFDQSx5Qzs7Ozs7Ozs7Ozs7O0FDekNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQTZCO0FBQ0w7QUFDSztBQUNIO0FBQ007QUFDaEMsaUM7Ozs7Ozs7Ozs7OztBQ0xBO0FBQUE7QUFBTztBQUNQO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxFQUFFLEVBQUU7QUFDYjtBQUNBO0FBQ0EsK0I7Ozs7Ozs7Ozs7OztBQ2hCQTtBQUFBO0FBQU87QUFDUDtBQUNBLG9CQUFvQix1QkFBdUI7QUFDM0M7QUFDQTtBQUNBLG1DQUFtQyw2Q0FBNkMsRUFBRTtBQUNsRjtBQUNBLGlDOzs7Ozs7Ozs7Ozs7QUNQQTtBQUFBO0FBQUE7QUFDQSxxQ0FBcUMsYUFBYTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLG1DQUFtQywyQkFBMkIsRUFBRSxFQUFFO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDcUI7QUFDdEIsc0M7Ozs7Ozs7Ozs7OztBQ3ZCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFpQztBQUNTO0FBQ0o7QUFDSTtBQUNLO0FBQy9DO0FBQ0EsSUFBSSwrQ0FBaUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJDQUEyQyx1QkFBdUIsRUFBRTtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSwrQkFBK0IsMkRBQVk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLEVBQUUsRUFBRTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLHNEQUFVLGVBQWUsdUNBQXVDLEVBQUU7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLENBQUMsQ0FBQyxzREFBVTtBQUNLO0FBQ2pCLHNCQUFzQiwwREFBYTtBQUNuQyxpQzs7Ozs7Ozs7Ozs7O0FDaktBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUF3Qzs7Ozs7Ozs7Ozs7OztBQ0F4QztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBOEM7Ozs7Ozs7Ozs7OztBQ0E5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RTs7Ozs7Ozs7Ozs7O0FDbkNBO0FBQUE7QUFBZSxTQUFTLGFBQWEsQ0FBRSxJQUFVO0lBQy9DLE9BQU8sQ0FBQztZQUNOLElBQUksRUFBRSxPQUFPO1lBQ2IsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJO1NBQ2pCLEVBQUM7WUFDQSxJQUFJLEVBQUUsUUFBUTtZQUNkLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTTtTQUNuQixDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLGNBQUksSUFBSSxRQUFDO1FBQ2hDLElBQUksRUFBRSxNQUFNO1FBQ1osS0FBSyxFQUFFLElBQUk7S0FDWixDQUFDLEVBSCtCLENBRy9CLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxjQUFJLElBQUksUUFBQztRQUNsQyxJQUFJLEVBQUUsWUFBWTtRQUNsQixLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLEdBQUcsSUFBSTtLQUNoQyxDQUFDLEVBSGlDLENBR2pDLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hCcUc7QUFFeEQ7QUFDZ0M7QUFFckQ7QUFFbEIsSUFBTSwwQkFBMEIsR0FBRztJQUN4QyxNQUFNO0lBQ04sTUFBTTtJQUNOLFFBQVE7SUFDUixPQUFPO0lBQ1AsYUFBYTtJQUNiLGFBQWE7SUFDYixVQUFVO0lBQ1YsWUFBWTtJQUNaLFlBQVk7Q0FBQyxDQUFDO0FBRVQsU0FBUyxTQUFTLENBQUMsSUFBVSxFQUFFLEdBQWEsRUFBRSxjQUEyQjtJQUM5RSxJQUFJLE1BQU0sR0FBRyxnRUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pDLElBQUksY0FBYyxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO1FBQzNDLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLGVBQUssSUFBSSxZQUFLLENBQUMsSUFBSSxLQUFLLE9BQU8sRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO0tBQ3pEO0lBQ0QsSUFBSSxNQUFNLEdBQUcsbUVBQVUsQ0FBQyxnRUFBYyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxjQUFjLENBQUMsQ0FBQztJQUMvRixrRkFBa0Y7SUFDbEYsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQztBQUVNLFNBQVMsYUFBYSxDQUFDLElBQVUsRUFBRSxHQUFhO0lBQ3JELE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDbkMsQ0FBQztBQUVNLFNBQVMsY0FBYyxDQUFDLElBQVUsRUFBRSxHQUFhO0lBQ3RELE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDbkMsQ0FBQztBQUVNLFNBQVMsY0FBYyxDQUFDLElBQVUsRUFBRSxHQUFhO0lBQ3RELE9BQU8sU0FBUyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDbkMsQ0FBQztBQUVNLFNBQVMsaUJBQWlCLENBQUMsSUFBVSxFQUFFLE1BQWM7SUFDMUQsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBSSxJQUFJLFdBQUksS0FBSyxVQUFVLElBQUksSUFBSSxLQUFLLE9BQU8sRUFBdkMsQ0FBdUMsQ0FBQyxDQUFDO0lBQ25GLElBQU0sZUFBZSxHQUFHLENBQUMsTUFBTSxJQUFFLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDakYsT0FBTyxDQUFDLFNBQVMsSUFBSSxlQUFlLENBQUMsQ0FBQztBQUN4QyxDQUFDO0FBRU0sU0FBUyx3QkFBd0IsQ0FBQyxJQUFVLEVBQUUsTUFBYztJQUNqRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLGlCQUFpQixDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN6RSxDQUFDO0FBRU0sSUFBTSxnQkFBZ0IsR0FBRztJQUM5QixLQUFLLEVBQUwsVUFBTyxPQUE2QjtRQUMzQix1QkFBSSxFQUFFLHVCQUFNLEVBQUUsaUJBQUcsQ0FBWTtRQUNwQyxJQUFNLFlBQVksR0FBRyw0RUFBZ0IsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdkQsSUFBTSxRQUFRLEdBQUcsbURBQUksWUFBWSxJQUFFLElBQUksUUFBRSxNQUFNLFdBQUMsQ0FBQztRQUNqRCxJQUFNLGNBQWMsR0FBRywrRUFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNyRCxJQUFJLEdBQUcsRUFBRTtZQUNQLFFBQVEsQ0FBQyxJQUFJLEdBQUcsS0FBRyxHQUFHLEdBQUcsY0FBZ0IsQ0FBQztTQUMzQzthQUFNO1lBQ0wsUUFBUSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7WUFDcEIsUUFBUSxDQUFDLE1BQU0sR0FBRyxjQUFjLENBQUM7U0FDbEM7SUFDSCxDQUFDO0NBQ0Y7QUFFTSxTQUFTLEtBQUssQ0FBQyxPQUE2QjtJQUNqRCxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDbEMsQ0FBQztBQUVNLFNBQVMsMEJBQTBCLENBQUUsR0FBVyxFQUFFLEtBQWdDOztJQUN2RixJQUFNLFlBQVksR0FBRyw0RUFBZ0IsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDdkQsSUFBTSxjQUFjLEdBQUcsRUFBRSxDQUFDOztRQUMxQixLQUFvQiw0R0FBMEIscUxBQUU7WUFBM0MsSUFBTSxLQUFLO1lBQ2QsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDO2dCQUFFLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDdEU7Ozs7Ozs7OztJQUNELElBQU0sY0FBYyxHQUFHLCtFQUFtQixDQUFDLG1EQUFJLGNBQWMsRUFBSyxLQUFLLEVBQUUsQ0FBQztJQUMxRSxJQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQy9CLE9BQU8sS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2pCLEtBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsS0FBSyxDQUFDLEdBQUcsY0FBYyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFHLENBQUMsQ0FBQztRQUMvRCxLQUFHLEdBQUcsR0FBRyxjQUFnQixDQUFDO0FBQzlCLENBQUM7Ozs7Ozs7Ozs7Ozs7QUNoRkQ7QUFBQTtBQUFBO0FBQUE7QUFBMEI7QUFFMUIsSUFBTSxTQUFTLEdBQUcsVUFBQyxFQUFhO1FBQVgsWUFBUyxFQUFULDhCQUFTO0lBQU8sUUFDbkMsb0VBQ0UsS0FBSyxFQUFFLElBQUksRUFDWCxPQUFPLEVBQUMsS0FBSyxFQUNiLEtBQUssRUFBQyw0QkFBNEIsRUFDbEMsVUFBVSxFQUFDLDhCQUE4QixFQUN6QyxPQUFPLEVBQUMsbUJBQW1CLEVBQzNCLElBQUksRUFBQyxTQUFTLEVBQ2QsS0FBSyxFQUFFLEVBQUMsYUFBYSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFDO1FBRXBELHdFQUFTLE1BQU0sRUFBQyw2REFBNkQsR0FBRztRQUNoRix3RUFBUyxNQUFNLEVBQUMsd0RBQXdELEdBQUc7UUFDM0Usd0VBQVMsTUFBTSxFQUFDLCtEQUErRCxHQUFHLENBQzlFLENBQ1A7QUFkb0MsQ0FjcEMsQ0FBQztBQUVGLElBQU0sYUFBYSxHQUFHLFVBQUMsRUFBYTtRQUFYLFlBQVMsRUFBVCw4QkFBUztJQUFPLFFBQ3ZDLG9FQUNFLEtBQUssRUFBRSxJQUFJLEVBQ1gsS0FBSyxFQUFDLDRCQUE0QixFQUNsQyxVQUFVLEVBQUMsOEJBQThCLEVBQ3pDLE9BQU8sRUFBQyxXQUFXLEVBQ25CLE9BQU8sRUFBQyxLQUFLO1FBRWIscUVBQU0sQ0FBQyxFQUFDLDZnQkFBNmdCLEdBQUcsQ0FDcGhCLENBQ1A7QUFWd0MsQ0FVeEMsQ0FBQztBQUVLLElBQU0sV0FBVyxHQUFHLFVBQUMsRUFBOEI7UUFBN0IsYUFBb0IsRUFBcEIsMkNBQW9CLEVBQUUsa0JBQU07SUFDdkQseUVBQUcsU0FBUyxFQUFDLEtBQUssRUFBQyxPQUFPLEVBQUUsTUFBTTtRQUFFLDJEQUFDLFNBQVMsSUFBQyxJQUFJLEVBQUUsRUFBRSxHQUFJOztRQUFFLEtBQUssQ0FBSztBQUF2RSxDQUF1RTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzlCMUI7QUFDOEI7QUFDSDtBQUN4QjtBQUNFO0FBQ0M7QUFDekI7QUFDbUQ7QUFFL0U7SUFLRSxtQkFDRSxVQUF5QixFQUN6QixPQUFlLEVBQ2YsY0FBOEIsRUFDOUIsZUFBMkI7UUFKN0IsaUJBcUJDO1FBZkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLDREQUFVLENBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxFQUFDLGNBQWMsa0JBQUMsQ0FBQyxDQUFDO1FBQ25FLElBQUksQ0FBQyxlQUFlLEdBQUcsZUFBZSxDQUFDO1FBQ3ZDLElBQU0sV0FBVyxHQUFHLFdBQUM7WUFDbkIsY0FBTyxLQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssVUFBVTtnQkFDN0IsQ0FBQyxLQUFLLGFBQWEsSUFBSSxnREFBZ0Q7Z0JBQ3ZFLENBQUMsS0FBSyxzQkFBc0I7Z0JBQzVCLENBQUMsS0FBSyxpQkFBaUI7UUFIdkIsQ0FHdUIsQ0FBQywrQkFBK0I7U0FDdEQ7UUFFSCxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsZ0JBQU07WUFDN0MsSUFBSSxXQUFXLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ3ZCLEtBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxxQkFBcUIsQ0FBQyxLQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQzthQUNwRDtRQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFFBQVEsR0FBRyxnRkFBZSxDQUFDLElBQUksRUFBRSxFQUFDLFdBQVcsZUFBQyxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVPLHdDQUFvQixHQUE1QjtRQUNFLE9BQU8sRUFBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLGVBQWUsRUFBRSxFQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVIOzs7O1NBSUs7SUFDRyxvQ0FBZ0IsR0FBdEIsVUFBdUIsQ0FBNEM7Ozs7Ozs7d0JBRXpELEtBQUssR0FBTyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQzt3QkFDOUMsSUFBSSxDQUFDLEVBQUU7NEJBQ0wsSUFBSSxDQUFDLENBQUMsVUFBVTtnQ0FBRSxLQUFLLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxVQUFVLENBQUM7NEJBQ2xELElBQUksQ0FBQyxDQUFDLFVBQVU7Z0NBQUUsS0FBSyxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUMsVUFBVSxDQUFDO3lCQUNuRDt3QkFDVyxxQkFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxLQUFLLENBQUM7O3dCQUF4RCxHQUFHLEdBQUcsU0FBa0Q7NkJBQzFELElBQUcsQ0FBQyxNQUFNLElBQUksR0FBRyxHQUFqQix3QkFBaUI7NkJBQVksMkRBQVM7c0NBQUMsR0FBRyxDQUFDLE1BQU07d0JBQUUscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs0QkFBaEQsTUFBTSxjQUFJLDJEQUFTLGFBQWEsU0FBZ0IsTUFBQyxDQUFDOzRCQUM1RCxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzt3QkFBdkIsSUFBSSxHQUFHLFNBQWdCO3dCQUM3QixzQkFBTyxJQUFJLENBQUMsT0FBc0IsRUFBQzs7O3dCQUVuQyxPQUFPLENBQUMsS0FBSyxDQUFDLGtCQUFrQixHQUFHLElBQUUsQ0FBQyxDQUFDO3dCQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLHNEQUFDLDZVQUF5RixLQUFDLENBQUM7Ozs7O0tBRS9HO0lBRUQ7Ozs7T0FJRztJQUNHLHdDQUFvQixHQUExQixVQUEyQixLQUFjOzs7Ozs7d0JBQ2pDLEtBQUssR0FBTyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQzt3QkFDOUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7NEJBQUUsS0FBSyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7d0JBQzNCLHFCQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLEtBQUssQ0FBQzs7d0JBQXRELEdBQUcsR0FBRyxTQUFnRDs2QkFDeEQsSUFBRyxDQUFDLE1BQU0sSUFBSSxHQUFHLEdBQWpCLHdCQUFpQjs2QkFBWSwyREFBUztzQ0FBQyxHQUFHLENBQUMsTUFBTTt3QkFBRSxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzRCQUFoRCxNQUFNLGNBQUksMkRBQVMsYUFBYSxTQUFnQixNQUFDLENBQUM7NEJBQzVELHFCQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUU7O3dCQUF2QixJQUFJLEdBQUcsU0FBZ0I7d0JBQzdCLHNCQUFPLElBQUksQ0FBQyxXQUE4QixFQUFDOzs7O0tBQzVDO0lBRUQ7O09BRUc7SUFDRyxtQ0FBZSxHQUFyQjs7Ozs7NEJBQ2MscUJBQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDOzt3QkFBdEUsR0FBRyxHQUFHLFNBQWdFOzZCQUN4RSxJQUFHLENBQUMsTUFBTSxJQUFJLEdBQUcsR0FBakIsd0JBQWlCOzZCQUFZLDJEQUFTO3NDQUFDLEdBQUcsQ0FBQyxNQUFNO3dCQUFFLHFCQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUU7NEJBQWhELE1BQU0sY0FBSSwyREFBUyxhQUFhLFNBQWdCLE1BQUMsQ0FBQzs0QkFDNUQscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs7d0JBQXZCLElBQUksR0FBRyxTQUFnQjt3QkFDN0Isc0JBQU8sSUFBSSxDQUFDLFlBQThCLEVBQUM7Ozs7S0FDNUM7SUFFSyw2Q0FBeUIsR0FBL0I7Ozs7OzRCQUNjLHFCQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLHdCQUF3QixFQUFFLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxDQUFDOzt3QkFBaEYsR0FBRyxHQUFHLFNBQTBFOzZCQUNsRixJQUFHLENBQUMsTUFBTSxJQUFJLEdBQUcsR0FBakIsd0JBQWlCOzZCQUFZLDJEQUFTO3NDQUFDLEdBQUcsQ0FBQyxNQUFNO3dCQUFFLHFCQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUU7NEJBQWhELE1BQU0sY0FBSSwyREFBUyxhQUFhLFNBQWdCLE1BQUMsQ0FBQzs0QkFDNUQscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs7d0JBQXZCLElBQUksR0FBRyxTQUFnQjt3QkFDN0Isc0JBQU8sSUFBSSxDQUFDLHNCQUFtRCxFQUFDOzs7O0tBQ2pFO0lBRUssMkNBQXVCLEdBQTdCOzs7Ozs0QkFDYyxxQkFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQzs7d0JBQTlFLEdBQUcsR0FBRyxTQUF3RTs2QkFDaEYsSUFBRyxDQUFDLE1BQU0sSUFBSSxHQUFHLEdBQWpCLHdCQUFpQjs2QkFBWSwyREFBUztzQ0FBQyxHQUFHLENBQUMsTUFBTTt3QkFBRSxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzRCQUFoRCxNQUFNLGNBQUksMkRBQVMsYUFBYSxTQUFnQixNQUFDLENBQUM7NEJBQzVELHFCQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUU7O3dCQUF2QixJQUFJLEdBQUcsU0FBZ0I7d0JBQzdCLHNCQUFPLElBQUksQ0FBQyxRQUF3QixFQUFDOzs7O0tBQ3RDO0lBRUQ7Ozs7Ozs7T0FPRztJQUNHLDBDQUFzQixHQUE1QixVQUE2QixDQUEyQzs7Ozs7NEJBQzFELHFCQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLHFCQUFxQixFQUFFLG1EQUFJLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxFQUFLLENBQUMsRUFBRTs7d0JBQXhGLEdBQUcsR0FBRyxTQUFrRjs2QkFDMUYsSUFBRyxDQUFDLE1BQU0sSUFBSSxHQUFHLEdBQWpCLHdCQUFpQjs2QkFBWSwyREFBUztzQ0FBQyxHQUFHLENBQUMsTUFBTTt3QkFBRSxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzRCQUFoRCxNQUFNLGNBQUksMkRBQVMsYUFBYSxTQUFnQixNQUFDLENBQUM7NEJBQzVELHFCQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUU7O3dCQUF2QixJQUFJLEdBQUcsU0FBZ0I7d0JBQzdCLHNCQUFPLElBQUksQ0FBQyxtQkFBd0MsRUFBQzs7OztLQUN0RDtJQUVEOzs7Ozs7O09BT0c7SUFDRywyQ0FBdUIsR0FBN0IsVUFBOEIsQ0FBaUQ7Ozs7OzRCQUNqRSxxQkFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsRUFBRSxtREFBSSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsRUFBSyxDQUFDLEVBQUU7O3dCQUF6RixHQUFHLEdBQUcsU0FBbUY7NkJBQzNGLElBQUcsQ0FBQyxNQUFNLElBQUksR0FBRyxHQUFqQix3QkFBaUI7NkJBQVksMkRBQVM7c0NBQUMsR0FBRyxDQUFDLE1BQU07d0JBQUUscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs0QkFBaEQsTUFBTSxjQUFJLDJEQUFTLGFBQWEsU0FBZ0IsTUFBQyxDQUFDOzRCQUM1RCxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzt3QkFBdkIsSUFBSSxHQUFHLFNBQWdCO3dCQUM3QixzQkFBTyxJQUFJLENBQUMsb0JBQTJDLEVBQUM7Ozs7S0FDekQ7SUFFRDs7Ozs7O09BTUc7SUFDRyxxQ0FBaUIsR0FBdkIsVUFBd0IsQ0FBdUI7Ozs7OzRCQUNqQyxxQkFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxtREFBSSxJQUFJLENBQUMsb0JBQW9CLEVBQUUsRUFBSyxDQUFDLEVBQUU7O3dCQUFuRixHQUFHLEdBQUcsU0FBNkU7NkJBQ3JGLElBQUcsQ0FBQyxNQUFNLElBQUksR0FBRyxHQUFqQix3QkFBaUI7NkJBQVksMkRBQVM7c0NBQUMsR0FBRyxDQUFDLE1BQU07d0JBQUUscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs0QkFBaEQsTUFBTSxjQUFJLDJEQUFTLGFBQWEsU0FBZ0IsTUFBQyxDQUFDOzRCQUM1RCxxQkFBTSxHQUFHLENBQUMsSUFBSSxFQUFFOzt3QkFBdkIsSUFBSSxHQUFHLFNBQWdCO3dCQUM3QixzQkFBTyxJQUFJLENBQUMsY0FBOEIsRUFBQzs7OztLQUM1QztJQUNELG9HQUFvRztJQUM5Rix3Q0FBb0IsR0FBMUIsVUFBMkIsWUFBb0IsRUFBRSxJQUFVOzs7O2dCQUN6RCxZQUFZO2dCQUNaLFFBQVEsWUFBWSxFQUFFO29CQUNwQixLQUFLLFFBQVE7d0JBQ2Isc0JBQU8scURBQVksQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxvREFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxJQUFJLDZDQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQXRHLENBQXNHLENBQUMsQ0FBQyxDQUFDLENBQXdCLEVBQUM7b0JBQzdLLEtBQUssUUFBUTt3QkFDYixzQkFBTyxxREFBWSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLG9EQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLElBQUksNkNBQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBdEcsQ0FBc0csQ0FBQyxDQUFDLENBQUMsQ0FBd0IsRUFBQztvQkFDN0ssS0FBSyxJQUFJO3dCQUNUOzRCQUNJLFFBQVEsR0FBRyxFQUF3QixDQUFDOzRCQUNwQyxlQUFlLEdBQUcsK0VBQWtCLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDOzRCQUNqRCxnQkFBZ0IsR0FBRywrRUFBa0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7NEJBRW5ELGtCQUFrQixHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQzs0QkFDeEMsbUJBQW1CLEdBQUcsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQzFDLGdCQUFnQixHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQzs0QkFDdEMsaUJBQWlCLEdBQUcsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLENBQUM7NEJBRXRDLFNBQVMsR0FBRyxFQUFDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsRUFBRSxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLEVBQUUsRUFBRSxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsRUFBRSxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFDLENBQUM7NEJBQ25QLFVBQVUsR0FBRyxFQUFDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsRUFBRSxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsRUFBRSxpQkFBaUIsQ0FBQyxLQUFLLEVBQUUsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFDLENBQUM7NEJBQ2hRLHNCQUFPLEVBQUMsU0FBUyxhQUFFLFVBQVUsY0FBRSxRQUFRLFlBQUMsRUFBQzt5QkFDeEM7aUJBQ0Y7Ozs7S0FDRjtJQUNILGdCQUFDO0FBQUQsQ0FBQzs7QUFJRDtJQUlFLG1CQUFhLHdCQUErQztRQUMxRCxJQUFJLE9BQU8sd0JBQXdCLEtBQUssUUFBUSxFQUFFO1lBQ2hELElBQUksQ0FBQyxNQUFNLEdBQUcsd0JBQXdCLENBQUM7WUFDdkMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFDdkQsSUFBSSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO2dCQUFFLE1BQU0sSUFBSSxLQUFLLENBQUUscUJBQW1CLElBQUksQ0FBQyxNQUFRLENBQUMsQ0FBQztTQUMxRTthQUFNO1lBQ0wsSUFBTSxVQUFVLEdBQUcsSUFBSSw2REFBVSxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDNUQsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUM7WUFDekUsSUFBSSxDQUFDLElBQUksR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDO1lBQzVCLElBQUksQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQztTQUM3QjtJQUNILENBQUM7SUFFRCxzQkFBSSxpQ0FBVTthQUFkO1lBQ0UsT0FBTyxJQUFJLDZEQUFVLENBQUM7Z0JBQ3BCLFlBQVksRUFBRSxJQUFJLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFDO29CQUM3QixJQUFJLENBQUMsSUFBSSxVQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBQztvQkFDOUIsSUFBSSxDQUFDLElBQUksR0FBQyxDQUFDLFNBQUksSUFBSSxDQUFDLElBQU07Z0JBQy9CLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTthQUNoQixDQUFDLENBQUM7UUFDTCxDQUFDOzs7T0FBQTtJQUVELDRCQUFRLEdBQVI7UUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDckIsQ0FBQztJQUVELDJCQUFPLEdBQVA7UUFDRSxPQUFPLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUNILGdCQUFDO0FBQUQsQ0FBQzs7QUFFTSxTQUFTLGlCQUFpQixDQUFFLFdBQW1CO0lBQ3BELElBQU0sSUFBSSxHQUFHLG9FQUFlLENBQUMsRUFBRSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQzlDLElBQUksQ0FBQyxDQUFDLElBQUksWUFBWSxJQUFJLENBQUM7UUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLDRCQUE0QixHQUFHLFdBQVcsQ0FBQyxDQUFDO0lBQ3pGLE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELFNBQVMscUJBQXFCLENBQU0sTUFBaUM7SUFDbkUsSUFBSSxlQUFlLEdBQXFDLEVBQUUsQ0FBQztJQUMzRCxPQUFPO1FBQ0wsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDOUIsZUFBZSxDQUFDLFFBQVEsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBTTtnQkFDbkUsT0FBTyxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQ2pDLE9BQU8sTUFBTSxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFDRCxPQUFPLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuQyxDQUFDO0FBQ0gsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDcE9vRDtBQUNZO0FBRXhCO0FBU3pDOztFQUVFO0FBQ0Y7SUFBbUMsdUVBQWU7SUFFaEQ7ZUFDRSxrQkFBTSxDQUFDLHVDQUF1QztZQUM5QyxtREFBbUQ7WUFDbkQsMERBQTBEO1lBQzFELDBEQUEwRDtZQUMxRCxtREFBbUQ7WUFDbkQsK0RBQStEO1lBQy9ELHlEQUF5RDtTQUMxRCxDQUFDO0lBQ0osQ0FBQztJQUVEOzs7Ozs7Ozs7O01BVUU7SUFDSSxnQ0FBUSxHQUFkLFVBQWUsSUFBVyxFQUFFLE1BQWE7Ozs7OzRCQUN2QyxxQkFBTSxJQUFJLENBQUMsWUFBWSxFQUFFOzt3QkFBekIsU0FBeUIsQ0FBQzt3QkFFcEIsSUFBSSxHQUFhLE1BQU0sRUFBQyxDQUFDOzRCQUM3QixVQUFVLEVBQUUsSUFBSTs0QkFDaEIsWUFBWSxFQUFFLE1BQU07eUJBQ3JCLENBQUMsQ0FBQyxDQUFDOzRCQUNGLFVBQVUsRUFBRSxJQUFJO3lCQUNqQixDQUFDO3dCQUVGLGlGQUFpRjt3QkFDakYsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7d0JBRWIscUJBQU0sS0FBSyxDQUFDLHlGQUF5RixFQUFFO2dDQUM5RyxNQUFNLEVBQUUsTUFBTTtnQ0FDZCxPQUFPLEVBQUU7b0NBQ1AsUUFBUSxFQUFFLGtCQUFrQjtvQ0FDNUIsY0FBYyxFQUFFLGtCQUFrQjtvQ0FDbEMsZUFBZSxFQUFFLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUztpQ0FDNUM7Z0NBQ0QsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDOzZCQUMzQixDQUFDLENBQUMsSUFBSSxDQUNMLGNBQUksSUFBSSxXQUFJLENBQUMsSUFBSSxFQUFFLEVBQVgsQ0FBVyxDQUNsQjs0QkFWRCxzQkFBTyxTQVVOLEVBQUM7Ozs7S0FDSDtJQUVEOzs7TUFHRTtJQUNJLGdDQUFRLEdBQWQsVUFBZSxNQUFNLEVBQUUsVUFBVSxFQUFFLGNBQWM7Ozs7Ozt3QkFHekMsV0FBVyxHQUFHLEVBQUUsQ0FBQzt3QkFFdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxLQUFLLEtBQUssRUFBRTs7Z0NBQzNCLEtBQW9CLDBEQUFNLENBQUMsV0FBVyw2Q0FBRTtvQ0FBN0IsS0FBSztvQ0FDZCxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsNkVBQW1CLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyw2RUFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxtQkFBbUIsRUFBckIsQ0FBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7aUNBQ2xIOzs7Ozs7Ozs7eUJBQ0Y7d0JBSVkscUJBQU0sb0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxFQUFDLFdBQVcsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFJLElBQUssV0FBSSxDQUFDLElBQUksRUFBRSxFQUFYLENBQVcsQ0FBQzs7d0JBQWhJLElBQUksR0FBRyxTQUF5SDt3QkFDL0gsaUJBQWlCLEdBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxrQkFBWCxDQUFZO3dCQUU5QixXQUFXLEdBQUcsaUJBQWlCLEVBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQzs2QkFHcEQsTUFBTSxDQUFDLFdBQVcsRUFBbEIsd0JBQWtCOzZCQUNoQixpQkFBaUIsRUFBakIsd0JBQWlCOzs7O3dCQUNDLDBEQUFNLENBQUMsV0FBVzs7Ozt3QkFBM0IsS0FBSzt3QkFDb0MscUJBQU0sb0RBQUcsQ0FBQyxTQUFTLENBQUMsdUJBQXVCLENBQUMsRUFBQyxVQUFVLEVBQUUsaUJBQWlCLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxFQUFDLENBQUM7O3dCQUFqSixvQkFBb0IsR0FBd0IsU0FBcUc7d0JBQ3ZKLFdBQVcsQ0FBQyxLQUFLLENBQUMsR0FBRyxvQkFBb0IsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxtQkFBbUIsRUFBckIsQ0FBcUIsQ0FBQyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozt3QkFNMUUsS0FBNEIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLGNBQWMsQ0FBQyxFQUE5RSxNQUFNLGNBQUUsT0FBTyxlQUFFLE1BQU0sYUFBd0Q7d0JBRXRGLG9GQUFvRjt3QkFDcEYsMkZBQTJGO3dCQUMzRiw0RkFBNEY7d0JBQzVGLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7d0JBQ3BCLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7d0JBQ3JCLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7d0JBQ3pCLElBQUksTUFBTSxJQUFJLE1BQU0sRUFBRTs0QkFDcEIsc0JBQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLEVBQUM7eUJBQ2xEOzZCQUFNLElBQUksTUFBTSxJQUFJLFFBQVEsRUFBRTs0QkFDN0Isc0JBQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFdBQVcsQ0FBQyxFQUFDO3lCQUMzRDs7Ozs7S0FDRjtJQUdLLCtCQUFPLEdBQWIsVUFBYyxNQUFNOzs7Z0JBQ2xCLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBQ3pCLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQzs7OztLQUMzRDtJQUdEOzs7Ozs7O01BT0U7SUFDRixrQ0FBVSxHQUFWLFVBQVcsTUFBTSxFQUFFLFVBQVUsRUFBRSxjQUFjO1FBQzNDLHVGQUF1RjtRQUN2RixJQUFNLGlCQUFpQixHQUFHLFVBQUMsS0FBSztZQUM5QixJQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsVUFBVSxLQUFLLElBQUksRUFBckIsQ0FBcUIsQ0FBQyxDQUFDO1lBQzdELE9BQU8sV0FBVyxDQUFDLEdBQUcsQ0FBQyxXQUFDO2dCQUNmLDZCQUFVLEVBQUUscUJBQVEsRUFBRSxTQUFFLEVBQUUsYUFBSSxDQUFNO2dCQUMzQyxPQUFPLEVBQUMsVUFBVSxjQUFFLFFBQVEsWUFBRSxFQUFFLE1BQUUsSUFBSSxRQUFDLENBQUM7WUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDO1FBRUQsd0VBQXdFO1FBQ3hFLHNEQUFzRDtRQUN0RCxJQUFNLFVBQVUsR0FBRyxjQUFjLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsVUFBQyxJQUFnQixFQUFFLElBQWdCO1lBQzVFLElBQU0sT0FBTyxHQUFHLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlCLElBQU0sT0FBTyxHQUFHLElBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlCLElBQU0sT0FBTyxHQUFHO2dCQUNkLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQUMsQ0FBQyxJQUFLLFFBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBZixDQUFlLENBQUM7Z0JBQzFDLE9BQU8sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLFVBQUMsQ0FBQyxJQUFLLFFBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBZixDQUFlLENBQUM7YUFDN0M7WUFDRCxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztRQUNwRixDQUFDO1FBRUQsOEJBQThCO1FBQzlCLElBQU0sTUFBTSxHQUFHLENBQUMsVUFBQyxFQVFIO2dCQVBaLFVBQUUsRUFDRixrQkFBTSxFQUNOLGNBQUksRUFDSixjQUFJLEVBQ0osNEJBQVcsRUFDWCxnQkFBSyxFQUNMLDRDQUFtQixFQUNuQiw0QkFBVztZQUFNLFFBQUM7Z0JBQ2hCLEVBQUU7Z0JBQ0YsTUFBTTtnQkFDTixJQUFJO2dCQUNKLElBQUk7Z0JBQ0osV0FBVztnQkFDWCxLQUFLO2dCQUNMLG1CQUFtQjtnQkFDbkIsV0FBVzthQUFDLENBQUM7UUFSRSxDQVFGLENBQ1osQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVWLDBDQUEwQztRQUN6QyxNQUFNLENBQUMsS0FBZSxHQUFHLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUUxRCxJQUFJLGNBQWMsRUFBRTtZQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLDBDQUEwQyxDQUFDLENBQUM7WUFDeEQsNERBQTREO1lBQzVELE9BQU8sRUFBQyxNQUFNLFVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFDLENBQUM7U0FDOUM7YUFBTTtZQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMscURBQXFELENBQUMsQ0FBQztZQUNuRSxJQUFNLE9BQU8sR0FBRztnQkFDZCxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUs7Z0JBQzVELFdBQVcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEtBQUssTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUFDLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsS0FBSztnQkFDeEYsS0FBSyxFQUFFLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQztnQkFDcEUsbUJBQW1CLEVBQUUsVUFBVSxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxHQUFHLEVBQUwsQ0FBSyxDQUFDLEVBQUUsTUFBTSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEdBQUcsRUFBTCxDQUFLLENBQUMsQ0FBQztnQkFDM0gsV0FBVyxFQUFFLFVBQVUsQ0FBQyxXQUFXLEVBQUMsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQUMsQ0FBQyxLQUFLO2FBQ25HO1lBRUQsT0FBTyxFQUFDLE1BQU0sVUFBRSxPQUFPLFdBQUUsTUFBTSxFQUFFLFFBQVEsRUFBQyxDQUFDO1NBQzVDO0lBQ0gsQ0FBQztJQUVLLHVDQUFlLEdBQXJCLFVBQXNCLE1BQU0sRUFBRSxXQUFXOzs7Z0JBQ3ZDLHNCQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLENBQUMsRUFBQzs7O0tBQ2pFO0lBRUssdUNBQWUsR0FBckIsVUFBc0IsTUFBTSxFQUFFLE9BQU8sRUFBRSxXQUFXOzs7Z0JBQ2hELHNCQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDLEVBQUM7OztLQUMxRTtJQUNILG9CQUFDO0FBQUQsQ0FBQyxDQXZMZ0MsaUVBQWUsR0F1TC9DOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdE1rRDtBQXVCckQ7Ozs7Ozs7Ozs7OztHQVlHO0FBQ0g7SUFBa0Msc0VBQWU7SUFJL0Msc0JBQVksT0FBaUI7UUFBN0IsWUFDRSxrQkFBTSxDQUFDLHVDQUF1QyxDQUFDLENBQUMsU0FFakQ7UUFEQyxLQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBQyxDQUFDOztJQUM3RCxDQUFDO0lBRUQ7Ozs7Ozs7O09BUUc7SUFDRywyQkFBSSxHQUFWOzs7Ozs0QkFDRSxxQkFBTSxJQUFJLENBQUMsWUFBWSxFQUFFOzt3QkFBekIsU0FBeUIsQ0FBQzt3QkFDMUIsc0JBQU8sSUFBSSxPQUFPLENBQWlCLFVBQUMsT0FBTyxFQUFFLE1BQU07Z0NBQ2pELElBQU0sUUFBUSxHQUFHLFVBQUMsUUFBUTtvQ0FDeEIsSUFBSSxRQUFRLENBQUMsUUFBUSxDQUFDLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO3dDQUNuRCxNQUFNLEVBQUUsQ0FBQztxQ0FDWjt5Q0FBTSxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUU7d0NBQzVELElBQUksVUFBUSxHQUFHLEVBQUUsQ0FBQzt3Q0FDbEIsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBQyxHQUFHOzRDQUNqQixtQkFBVSxFQUFFLHVCQUFRLEVBQUUsZUFBSSxFQUFFLCtCQUFZLEVBQUUscUJBQU8sRUFBRSxhQUFHLENBQVE7NENBQ3JFLElBQU0sU0FBUyxHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7NENBQ25ELFVBQVEsQ0FBQyxJQUFJLENBQUMsRUFBQyxNQUFNLFVBQUUsUUFBUSxZQUFFLElBQUksUUFBRSxZQUFZLGdCQUFFLFNBQVMsYUFBRSxPQUFPLFdBQUUsR0FBRyxPQUFDLENBQUMsQ0FBQzs0Q0FDL0UsOENBQThDOzRDQUM5QyxLQUFJLENBQUMsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7d0NBQ2pDLENBQUMsQ0FBQyxDQUFDO3dDQUNILE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBUSxDQUFDLENBQUM7d0NBQ3RCLE9BQU8sQ0FBQyxVQUFRLENBQUMsQ0FBQztxQ0FDbkI7Z0NBQ0gsQ0FBQyxDQUFDO2dDQUVGLElBQU0sYUFBYSxHQUFHLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUU7cUNBQ3BELE9BQU8sQ0FDTixJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFO3FDQUN6QixZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsNEJBQTRCO3FDQUMvQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FDM0I7cUNBQ0EsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLDRCQUE0QjtxQ0FDNUMsT0FBTyxDQUFDLElBQUksRUFBQyxHQUFHLENBQUMsQ0FBQyw0QkFBNEI7cUNBQzlDLGFBQWEsQ0FBQyxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTztxQ0FDckMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dDQUN6QixJQUFJLEtBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFO29DQUN2QixhQUFhLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2lDQUNuRjtnQ0FDRCxJQUFJLEtBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFO29DQUN6QixhQUFhLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7aUNBQ3hFO2dDQUNELEtBQUksQ0FBQyxNQUFNLEdBQUcsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFDO2dDQUNwQyxLQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQzs0QkFDL0IsQ0FBQyxDQUFDLEVBQUM7Ozs7S0FDSjtJQUVEOzs7Ozs7Ozs7O09BVUc7SUFDRyx3Q0FBaUIsR0FBdkIsVUFBd0IsTUFBTTs7Ozs0QkFDNUIscUJBQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7NEJBQ3JCLGFBQWEsRUFBRSxDQUFDLDREQUE0RCxDQUFDO3lCQUM5RSxDQUFDOzt3QkFGRixTQUVFLENBQUM7d0JBQ0gsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBTTs0QkFDeEMsTUFBTSxFQUFFLE1BQU07NEJBQ2QscUJBQXFCLEVBQUUsS0FBSzs0QkFDNUIsSUFBSSxFQUFFLFFBQVE7NEJBQ2QsSUFBSSxFQUFFLFFBQVE7NEJBQ2QsTUFBTSxFQUFFLG1CQUFtQjt5QkFDNUIsQ0FBQyxDQUFDOzs7OztLQUNKO0lBR0Q7Ozs7Ozs7OztPQVNHO0lBRUcsbUNBQVksR0FBbEIsVUFBbUIsRUFBaUI7WUFBaEIsY0FBSSxFQUFFLHdCQUFTOzs7Ozs7O29CQUNqQyx1REFBdUQ7b0JBQ3ZELHlEQUF5RDtvQkFDekQsYUFBYTtvQkFDYixzREFBc0Q7b0JBQ3RELHVDQUF1QztvQkFFdkMsOERBQThEO29CQUM5RCxvRUFBb0U7b0JBQ3BFLG9FQUFvRTtvQkFDcEUsaUVBQWlFO29CQUNqRSxzQ0FBc0M7b0JBRXRDLHdFQUF3RTtvQkFDeEUscUJBQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7NEJBQ3JCLGFBQWEsRUFBRSxDQUFDLDREQUE0RCxDQUFDO3lCQUM5RSxDQUFDOzt3QkFmRix1REFBdUQ7d0JBQ3ZELHlEQUF5RDt3QkFDekQsYUFBYTt3QkFDYixzREFBc0Q7d0JBQ3RELHVDQUF1Qzt3QkFFdkMsOERBQThEO3dCQUM5RCxvRUFBb0U7d0JBQ3BFLG9FQUFvRTt3QkFDcEUsaUVBQWlFO3dCQUNqRSxzQ0FBc0M7d0JBRXRDLHdFQUF3RTt3QkFDeEUsU0FFRSxDQUFDO3dCQUVILElBQUksSUFBSSxDQUFDLFNBQVMsRUFBRTs0QkFDbEIsc0JBQU8sSUFBSSxPQUFPLENBQU8sVUFBQyxPQUFPLEVBQUUsTUFBTTtvQ0FDdkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQzt3Q0FDN0IsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNO3dDQUNuQixRQUFRLEVBQUUsaUJBQWlCO3FDQUFDLENBQzdCLENBQUMsSUFBSSxDQUFDLGNBQUk7d0NBQ1QsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7d0NBQzdCLElBQU0sSUFBSSxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7d0NBQ2xELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7NENBQzVCLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQzt5Q0FDbkM7d0NBQ0QsSUFBTSxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFDLElBQUksRUFBRSxpQkFBaUIsRUFBQyxDQUFDLENBQUM7d0NBQ3pELElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUMsTUFBTSxDQUFDO3dDQUNsQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBQyxJQUFJLEVBQUUsaUJBQWlCLEVBQUUsWUFBWSxFQUFFLElBQUksQ0FBQyxZQUFZLEVBQUMsQ0FBQyxDQUFDLENBQUM7b0NBQ2xHLENBQUMsQ0FBQztnQ0FDSixDQUFDLENBQUMsRUFBQzt5QkFDSjs2QkFBTTs0QkFJQyxnQkFBYyxVQUFDLElBQWlCO2dDQUNwQyxPQUFPLElBQUksT0FBTyxDQUFPLFVBQUMsT0FBTyxFQUFFLE1BQU07b0NBQ3ZDLElBQU0sR0FBRyxHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7b0NBQ2pDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLDRDQUE0QyxHQUFDLElBQUksQ0FBQyxNQUFNLEdBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDO29DQUM3RixHQUFHLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxFQUFDLFNBQVMsR0FBQyxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7b0NBQy9ELEdBQUcsQ0FBQyxZQUFZLEdBQUcsTUFBTTtvQ0FDekIsR0FBRyxDQUFDLE1BQU0sR0FBRzt3Q0FDWCxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFDLElBQUksRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLFlBQVksRUFBRSxJQUFJLENBQUMsWUFBWSxFQUFDLENBQUMsQ0FBQyxDQUFDO29DQUN2RyxDQUFDLENBQUM7b0NBQ0YsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO2dDQUNiLENBQUMsQ0FBQyxDQUFDOzRCQUNMLENBQUM7NEJBRUQsc0JBQU8sSUFBSSxPQUFPLENBQU8sVUFBQyxPQUFPLEVBQUUsTUFBTTtvQ0FDdkMsSUFBSSxTQUFTLEtBQUssU0FBUyxFQUFFO3dDQUMzQixJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDOzRDQUMxQixNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU07NENBQ25CLE1BQU0sRUFBRSxNQUFNO3lDQUNmLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBSTs0Q0FDVixJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQzs0Q0FDdEMsSUFBSSxJQUFJLEdBQUcsU0FBUyxHQUFDLElBQUksR0FBQyxJQUFJLEVBQUU7Z0RBQzlCLE1BQU0sQ0FBQywwQ0FBMEMsQ0FBQzs2Q0FDbkQ7d0NBQ0gsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDOzRDQUNOLGFBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBSTtnREFDekIsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDOzRDQUNoQixDQUFDLENBQUM7d0NBQ0osQ0FBQyxDQUFDO3FDQUNIO3lDQUFNO3dDQUNMLGFBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBSTs0Q0FDekIsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO3dDQUNoQixDQUFDLENBQUM7cUNBQ0g7Z0NBQ0gsQ0FBQyxDQUFDO3lCQUNIOzs7OztLQUNGO0lBQ0gsbUJBQUM7QUFBRCxDQUFDLENBektpQyxpRUFBZSxHQXlLaEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3TW9DO0FBRXJDO0lBSUUseUJBQVksTUFBTTs7UUFDaEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLGdEQUFnRCxFQUFFLGtEQUFrRCxDQUFDLENBQUM7UUFDckgsVUFBSSxDQUFDLE1BQU0sRUFBQyxJQUFJLDBEQUFJLE1BQU0sR0FBRTtJQUM5QixDQUFDO0lBQ0ssc0NBQVksR0FBbEI7Ozs7Ozs7NkJBRU0sUUFBTyxJQUFJLEtBQUssV0FBVyxHQUEzQix3QkFBMkI7d0JBQUUscUJBQU0sSUFBSSxDQUFDLFFBQVEsRUFBRTs7d0JBQXJCLFNBQXFCLENBQUM7Ozt3QkFHakQsU0FBUyxHQUFHLDBFQUEwRSxDQUFDO3dCQUN2RixNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7d0JBRXJDLHFCQUFNLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFDLE1BQU07Z0NBQy9CLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFO29DQUN4QixvRkFBb0Y7b0NBQ3BGLGdGQUFnRjtvQ0FDaEYsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDO29DQUN4QixPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUM7b0NBQ3BDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7d0NBQzFCLFNBQVMsRUFBRSxTQUFTO3dDQUNwQixLQUFLLEVBQUUsTUFBTTt3Q0FDYixhQUFhLEVBQUUsWUFBWTt3Q0FDM0IsVUFBVSxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLElBQUk7d0NBQ2hDLE1BQU0sRUFBRSxNQUFNO3FDQUNmLEVBQUUsVUFBQyxJQUFJO3dDQUNOLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7d0NBQ2xCLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRTs0Q0FDZCxrQ0FBa0M7NENBQ2xDLFdBQVcsR0FBRyxJQUFJLENBQUM7eUNBQ3BCOzZDQUFNOzRDQUNMLDBDQUEwQzs0Q0FDMUMsSUFBTSxVQUFRLEdBQUcsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzs0Q0FDaEQsSUFBTSxhQUFhLEdBQUcsS0FBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsVUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBaEIsQ0FBZ0IsQ0FBQyxDQUFDOzRDQUNoRSxJQUFJLGFBQWEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dEQUM1QixPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7Z0RBQzlCLHFEQUFxRDtnREFDckQsV0FBVyxHQUFHLElBQUksQ0FBQzs2Q0FDcEI7aURBQU07Z0RBQ0wsK0NBQStDO2dEQUMvQyxLQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7Z0RBQ25DLE9BQU8sRUFBRSxDQUFDOzZDQUNYO3lDQUNGO3dDQUVELElBQUksV0FBVyxFQUFFOzRDQUNmLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLENBQUM7NENBQzNCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7Z0RBQzFCLFNBQVMsRUFBRSxTQUFTO2dEQUNwQixLQUFLLEVBQUUsTUFBTTtnREFDYixhQUFhLEVBQUUsWUFBWTtnREFDM0IsVUFBVSxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLElBQUk7Z0RBQ2hDLE1BQU0sRUFBRSxTQUFTOzZDQUNsQixFQUFFLFVBQUMsSUFBSTtnREFDTixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO2dEQUNsQixJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7b0RBQ2QsNkNBQTZDO29EQUM3QyxNQUFNLENBQUMsb0NBQW9DLENBQUMsQ0FBQztpREFDOUM7cURBQU07b0RBQ0wsd0RBQXdEO29EQUN4RCx5QkFBeUI7b0RBQ3pCLEtBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztvREFDbkMsT0FBTyxFQUFFLENBQUM7aURBQ1g7NENBQ0gsQ0FBQyxDQUFDLENBQUM7eUNBQ0o7b0NBRUgsQ0FBQyxDQUNGO2dDQUFBLENBQUMsQ0FBQyxDQUFDOzRCQUNOLENBQUMsQ0FBQzs7d0JBeERGLFNBd0RFLENBQUM7NkJBR0MsUUFBTyxNQUFNLEtBQUssV0FBVyxJQUFJLE9BQU8sTUFBTSxDQUFDLE1BQU0sS0FBSyxXQUFXLEdBQXJFLHdCQUFxRTt3QkFDdkUscUJBQU0sSUFBSSxPQUFPLENBQUMsaUJBQU87Z0NBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLGNBQVEsT0FBTyxFQUFFLEVBQUMsQ0FBQyxDQUFDLENBQUM7NEJBQzNDLENBQUMsQ0FBQzs7d0JBRkYsU0FFRSxDQUFDOzs7Ozs7S0FFTjtJQUdELGtDQUFRLEdBQVI7UUFDRSxPQUFPLElBQUksT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFFLE1BQU07WUFDakMsSUFBSSxPQUFPLElBQUksS0FBSyxXQUFXO2dCQUFFLE9BQU8sT0FBTyxFQUFFLENBQUM7WUFDbEQsSUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUNoRCxNQUFNLENBQUMsR0FBRyxHQUFHLDBEQUEwRCxDQUFDO1lBQ3hFLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDNUQsTUFBYyxDQUFDLFlBQVksR0FBRyxPQUFPLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBQ0gsc0JBQUM7QUFBRCxDQUFDOzs7Ozs7Ozs7Ozs7OztBQzVGRDtBQUFBO0FBQUE7QUFBQTtBQUFPLElBQU0sWUFBWSxHQUFpQjtJQUN0QztRQUNJLFVBQVUsRUFBRSxLQUFLO1FBQ2pCLGdCQUFnQixFQUFFLFdBQVc7UUFDN0IsZUFBZSxFQUFFLFdBQVc7UUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO0tBQzNEO0lBQ0Q7UUFDSSxVQUFVLEVBQUUsS0FBSztRQUNqQixnQkFBZ0IsRUFBRSxXQUFXO1FBQzdCLGVBQWUsRUFBRSxXQUFXO1FBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztLQUMzRDtJQUNEO1FBQ0ksVUFBVSxFQUFFLEtBQUs7UUFDakIsZ0JBQWdCLEVBQUUsV0FBVztRQUM3QixlQUFlLEVBQUUsV0FBVztRQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7S0FDM0Q7SUFDRDtRQUNJLFVBQVUsRUFBRSxLQUFLO1FBQ2pCLGdCQUFnQixFQUFFLE1BQU07UUFDeEIsZUFBZSxFQUFFLFVBQVU7UUFDM0IsbUJBQW1CLEVBQUUscUJBQXFCO0tBQzdDO0lBQ0Q7UUFDSSxVQUFVLEVBQUUsS0FBSztRQUNqQixnQkFBZ0IsRUFBRSxPQUFPO1FBQ3pCLGVBQWUsRUFBRSxXQUFXO1FBQzVCLG1CQUFtQixFQUFFLGdDQUFnQztLQUN4RDtJQUNEO1FBQ0ksVUFBVSxFQUFFLEtBQUs7UUFDakIsZ0JBQWdCLEVBQUUsUUFBUTtRQUMxQixlQUFlLEVBQUUsV0FBVztRQUM1QixtQkFBbUIsRUFBRSxpQ0FBaUM7S0FDekQ7Q0FDSixDQUFDO0FBRUssSUFBTSxpQkFBaUIsR0FBRztJQUM3QixTQUFTLEVBQUU7UUFDUDtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxVQUFVLEVBQUUsU0FBUztTQUN4QjtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLFVBQVUsRUFBRSxTQUFTO1NBQ3hCO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsVUFBVSxFQUFFLFNBQVM7U0FDeEI7S0FDSjtJQUNELFVBQVUsRUFBRTtRQUNSO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLFVBQVUsRUFBRSxVQUFVO1NBQ3pCO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsVUFBVSxFQUFFLFVBQVU7U0FDekI7S0FDSjtJQUNELFVBQVUsRUFBRTtRQUNSO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLFVBQVUsRUFBRSxVQUFVO1NBQ3pCO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsVUFBVSxFQUFFLFVBQVU7U0FDekI7S0FDSjtDQUNKO0FBRU0sSUFBTSxtQkFBbUIsR0FBRztJQUMvQiwwQkFBMEIsRUFBRztRQUN6QjtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7UUFDRDtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtLQUNKO0lBQ0QsMEJBQTBCLEVBQUc7UUFDekI7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7UUFDRDtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO0tBQ0o7SUFDRCwwQkFBMEIsRUFBRztRQUN6QjtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsWUFBWTtZQUM5QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxvQ0FBb0M7U0FDNUQ7S0FDSjtJQUNELDBCQUEwQixFQUFHO1FBQ3pCO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7UUFDRDtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO0tBQ0o7SUFDRCwwQkFBMEIsRUFBRztRQUN6QjtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7S0FDSjtJQUNELDBCQUEwQixFQUFHO1FBQ3pCO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7UUFDRDtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFlBQVk7WUFDOUIsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsb0NBQW9DO1NBQzVEO0tBQ0o7SUFDRCwwQkFBMEIsRUFBRztRQUN6QjtZQUNJLFVBQVUsRUFBRSxLQUFLO1lBQ2pCLGdCQUFnQixFQUFFLDBCQUEwQjtZQUM1QyxnQkFBZ0IsRUFBRSxXQUFXO1lBQzdCLGVBQWUsRUFBRSxXQUFXO1lBQzVCLG1CQUFtQixFQUFFLG1DQUFtQztTQUMzRDtRQUNEO1lBQ0ksVUFBVSxFQUFFLEtBQUs7WUFDakIsZ0JBQWdCLEVBQUUsMEJBQTBCO1lBQzVDLGdCQUFnQixFQUFFLFdBQVc7WUFDN0IsZUFBZSxFQUFFLFdBQVc7WUFDNUIsbUJBQW1CLEVBQUUsbUNBQW1DO1NBQzNEO1FBQ0Q7WUFDSSxVQUFVLEVBQUUsS0FBSztZQUNqQixnQkFBZ0IsRUFBRSwwQkFBMEI7WUFDNUMsZ0JBQWdCLEVBQUUsV0FBVztZQUM3QixlQUFlLEVBQUUsV0FBVztZQUM1QixtQkFBbUIsRUFBRSxtQ0FBbUM7U0FDM0Q7S0FDSjtDQUNKOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1UThCO0FBVS9CO0lBQWtDLHNFQUFzQjtJQUF4RDtRQUFBLHFFQTZCQztRQXBCRyxvQkFBYyxHQUFHO1lBQ1Asb0JBQTZHLEVBQTNHLGdDQUFhLEVBQUUsa0RBQXNCLEVBQUUsZ0RBQXFCLEVBQUUsb0NBQWUsRUFBRSxnQ0FBNEIsQ0FBQztZQUNwSCxJQUFJLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDbEIsSUFBRyxhQUFhLEdBQUcscUJBQXFCLEVBQUM7Z0JBQ3RDLE9BQU8sNkRBQUssU0FBUyxFQUFDLG1CQUFtQjs7b0JBQUcsc0JBQXNCOztvQkFBSyxhQUFhO3dCQUFRLENBQUM7YUFDL0Y7WUFFRCxLQUFLLElBQUksTUFBTSxHQUFHLENBQUMsRUFBRSxNQUFNLElBQUksYUFBYSxFQUFFLE1BQU0sRUFBRSxFQUFFO2dCQUNwRCxRQUFRLENBQUMsSUFBSSxDQUNiLDZEQUFLLEdBQUcsRUFBRSxNQUFNO29CQUNaLGdFQUFRLFNBQVMsRUFBQyx5QkFBeUIsRUFBQyxJQUFJLEVBQUUsTUFBTSxHQUFHLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLGFBQWEsRUFBRSxFQUFFLEVBQUMsR0FBRyxFQUFDLEVBQUUsRUFBQyxHQUFHLEVBQUMsQ0FBQyxFQUFDLEdBQUcsR0FBRyxDQUN6SSxDQUNMLENBQUM7YUFDTDtZQUNELE9BQU8sUUFBUSxDQUFDO1FBQ3BCLENBQUM7O0lBS0wsQ0FBQztJQUhHLDZCQUFNLEdBQU47UUFDSSxPQUFPLDZEQUFLLFNBQVMsRUFBQyxnQkFBZ0IsSUFBRSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQU87SUFDeEUsQ0FBQztJQTNCYSx5QkFBWSxHQUFHO1FBQ3pCLGFBQWEsRUFBRSxDQUFDO1FBQ2hCLHNCQUFzQixFQUFFLENBQUM7UUFDekIscUJBQXFCLEVBQUUsRUFBRTtRQUN6QixlQUFlLEVBQUUsV0FBVztRQUM1QixhQUFhLEVBQUUsU0FBUztLQUMzQixDQUFDO0lBc0JOLG1CQUFDO0NBQUEsQ0E3QmlDLCtDQUFlLEdBNkJoRDtBQTdCd0I7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ1YwQztBQUUxQjtBQUNnQjtBQWtCbEQsU0FBUyxjQUFjLENBQXlCLElBQVUsRUFBRSxLQUFnQixFQUFFLEVBQTJDO1FBQTFDLG1GQUFlO0lBQ25HLDBEQUEwRDtJQUMxRCw4RUFBOEU7SUFDOUUsSUFBTSxVQUFVLEdBQXlCLEVBQUUsQ0FBQztJQUU1QyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFFO1FBQ25CLHlFQUF5RTtRQUN6RSxPQUFPLElBQUksQ0FBQztLQUNiO0lBRUQsMEVBQTBFO0lBQzFFLElBQU0sTUFBTSxHQUFHLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxDQUFDO1FBQzdCLEtBQUssQ0FBQyxHQUFHLENBQUMsWUFBRTtZQUNWLFVBQVUsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUM7WUFDdEIsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQUcsSUFBSSxVQUFHLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBYixDQUFhLENBQUMsQ0FBQztRQUN6QyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsYUFBRyxJQUFJLFFBQUMsQ0FBQyxHQUFHLEVBQUwsQ0FBSyxDQUFDLENBQUMsQ0FBQztRQUN6QixJQUFJLENBQUMsQ0FBQztJQUVSLElBQUksZUFBZSxFQUFFO1FBQ25CLHNEQUFzRDtRQUN0RCxJQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQUcsSUFBSSxRQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQW5CLENBQW1CLENBQUMsQ0FBQztRQUMxRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUM7S0FDakM7U0FBTTtRQUNMLE9BQU8sTUFBTSxDQUFDO0tBQ2Y7QUFDSCxDQUFDO0FBRU0sU0FBUyx1QkFBdUIsQ0FBc0MsR0FBTSxFQUFFLFlBQStCOztJQUNsSCxJQUFJLDBCQUFxRCxDQUFDO0lBQzFELElBQUksWUFBWSxFQUFFO1FBQ2hCLCtLQUErSztRQUMvSywwQkFBMEIsR0FBRyxJQUFJLDZEQUFPLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO0tBQzFEO1NBQU07UUFDTCxJQUFNLFdBQVcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFHLElBQUksVUFBRyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsRUFBekIsQ0FBeUIsQ0FBQyxDQUFDO1FBQ3RFLElBQUksV0FBVyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDNUIsT0FBTyxJQUFJLDZEQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxpREFBaUQ7U0FDM0U7UUFDRCwwQkFBMEIsR0FBRyxvREFBRSxDQUFDLE9BQU8sRUFBQyxJQUFJLDBEQUFJLFdBQVcsR0FBRSxPQUFPLEVBQUUsQ0FBQztLQUN4RTtJQUVELE9BQU8sMEJBQTBCLENBQUMsR0FBRyxDQUFDLHNCQUFZO1FBQ2hELElBQU0sY0FBYyxHQUFHLDREQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxxQkFBVyxJQUFJLGtCQUFXLENBQUMsY0FBYyxJQUFJLEVBQUUsRUFBaEMsQ0FBZ0MsQ0FBQyxDQUFDLENBQUM7UUFDbEcsSUFBTSxPQUFPLEdBQUcsNERBQU8sQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLHFCQUFXLElBQUksa0JBQVcsQ0FBQyxtQkFBbUIsSUFBSSxFQUFFLEVBQXJDLENBQXFDLENBQUMsQ0FBQyxDQUFDO1FBQ2hHLElBQU0sT0FBTyxHQUFHLDREQUFPLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxxQkFBVyxJQUFJLGtCQUFXLENBQUMsMEJBQTBCLElBQUksRUFBRSxFQUE1QyxDQUE0QyxDQUFDLENBQUMsQ0FBQztRQUN2RyxJQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUN4QyxJQUFJLFFBQVEsQ0FBQyxTQUFTO1lBQUUsUUFBUSxDQUFDLFNBQVMsR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsQ0FBQztRQUMzRixJQUFJLFFBQVEsQ0FBQyxjQUFjO1lBQUUsUUFBUSxDQUFDLGNBQWMsR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNuRyxJQUFJLFFBQVEsQ0FBQyxxQkFBcUI7WUFBRSxRQUFRLENBQUMscUJBQXFCLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN4SCxPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7Ozs7Ozs7Ozs7Ozs7QUN0RUQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUE0RDtBQUVKO0FBRWpELFNBQVMsY0FBYyxDQUFDLE9BQTZCO0lBQzFELE9BQU8sNEVBQWMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxTQUFTLEVBQUUsRUFBQyxlQUFlLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztBQUNuRixDQUFDO0FBRU0sU0FBUyxtQkFBbUIsQ0FDakMsSUFBUyxFQUNULFlBQWtDLEVBQ2xDLE1BQVMsRUFDVCxNQUFTLEVBQ1QsU0FBNkIsRUFDN0IsRUFBNEM7UUFBM0MsbUZBQWU7SUFFaEIsSUFBTSxVQUFVLEdBQUcsNEVBQWMsQ0FBQyxJQUFJLEVBQUUsWUFBWSxFQUFFLEVBQUMsZUFBZSxFQUFFLElBQUksRUFBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxFQUFKLENBQUksQ0FBQyxDQUFDO0lBQzlGLElBQU0sV0FBVyxHQUFHLFNBQVMsS0FBSyxRQUFRLENBQUM7SUFFM0MsSUFBTSxNQUFNLEdBQUcsNERBQU8sQ0FDcEIsVUFBVTtTQUNQLE1BQU0sQ0FBQyxZQUFFLElBQUksU0FBRSxLQUFLLE1BQU0sQ0FBQyxFQUFFLEVBQWhCLENBQWdCLENBQUMsQ0FBQyxtQkFBbUI7U0FDbEQsR0FBRyxDQUFDLFlBQUUsSUFBSSxTQUFFLEtBQUssTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNCLHNCQUFzQjtRQUN0QixFQUFFLENBQUMsQ0FBQztRQUNKLDBDQUEwQztRQUMxQyxXQUFXLENBQUMsQ0FBQztZQUNYLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsRUFOUixDQU1RLENBQ2xCLENBQ0osQ0FBQztJQUNGLE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2hDaUQ7QUFFRDtBQUUxQyxTQUFTLGlDQUFpQyxDQUFDLE1BQWM7SUFDOUQsSUFBTSxxQkFBcUIsR0FBRyxNQUFNLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLFVBQUMsTUFBTSxFQUFFLElBQUk7UUFDN0UsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDdkIsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQyxFQUFFLEVBQTRDLENBQUMsQ0FBQztJQUVqRCxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxjQUFJO1FBQ3ZCLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxPQUFPLENBQUMsWUFBRTtZQUNuQyxPQUFPLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN0QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLENBQUMsR0FBRyxDQUFDLFlBQUUsSUFBSSw0QkFBcUIsQ0FBQyxFQUFFLENBQUMsRUFBekIsQ0FBeUIsQ0FBQyxDQUFDO0FBQ2pGLENBQUM7QUFRTSxTQUFTLHVCQUF1QixDQUFDLE1BQWM7SUFDcEQsT0FBTyxvQ0FBb0MsQ0FDekMsQ0FBQyxNQUFzRixDQUFDLEVBQ3hGLE1BQU0sQ0FBQyxLQUFxRixDQUFDLENBQUM7QUFDbEcsQ0FBQztBQUVNLFNBQVMsb0NBQW9DLENBQ2xELFNBQStCLEVBQy9CLGdCQUFzQztJQUV0QyxJQUFNLFlBQVksR0FBRyxFQUFFLENBQUM7SUFDeEIsZ0dBQWdHO0lBQ2hHLFNBQVMsQ0FBQyxPQUFPLENBQUMsZ0JBQU07UUFDdEIsTUFBTSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxXQUFDO1lBQ3BDLFlBQVksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBQzVCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsTUFBTSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsV0FBQztZQUN4QixZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUM1QixDQUFDLENBQUMsQ0FBQztRQUNILE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFlBQUU7WUFDOUIsWUFBWSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUNILDBEQUEwRDtJQUMxRCxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsYUFBRztRQUMxQixHQUFHLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLFlBQUU7WUFDbEMsT0FBTyxZQUFZLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO1FBQ0gsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsV0FBQztZQUNyQixPQUFPLFlBQVksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUIsQ0FBQyxDQUFDLENBQUM7UUFDSCxHQUFHLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxZQUFFO1lBQzNCLE9BQU8sWUFBWSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUM3QixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxZQUFZLENBQUM7QUFDdEIsQ0FBQztBQUVNLFNBQVMsV0FBVyxDQUFFLE1BQWM7SUFDekMsU0FBUyxpQkFBaUIsQ0FBQyxNQUFjO1FBQ3ZDLElBQU0sT0FBTyxHQUEyQixFQUFFLENBQUM7UUFDM0MsT0FBTyw0REFBTyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNLElBQUksYUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQU07WUFDbkUsSUFBSSxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ25CLElBQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLE1BQU0sRUFBZixDQUFlLENBQUMsQ0FBQztnQkFDckQsT0FBTyxzREFBQyx5TkFBMkMsRUFBUyxJQUFHLEtBQVosSUFBSSxDQUFDLElBQUksRUFBSTthQUNqRTtZQUNELE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDekIsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLEVBQUQsQ0FBQyxDQUFDLEVBTjJCLENBTTNCLENBQUMsQ0FBQyxDQUFDO0lBQ3RCLENBQUM7SUFFRCxTQUFTLGdCQUFnQixDQUFDLE1BQWM7UUFDdEMsSUFBTSxRQUFRLEdBQXlCLEVBQUUsQ0FBQztRQUMxQyxPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLGNBQUk7WUFDMUIsSUFBSSxJQUFJLENBQUMsR0FBRyxFQUFFO2dCQUNaLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRTtvQkFDdEIsT0FBTyxzREFBQyw2TkFBc0MsRUFBdUIsWUFBVyxFQUFTLElBQUcsS0FBOUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQVcsSUFBSSxDQUFDLElBQUksRUFBSTtpQkFDOUY7Z0JBQ0QsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7YUFDM0I7UUFDSCxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQztJQUNwQixDQUFDO0lBRUQsU0FBUyxtQkFBbUIsQ0FBQyxNQUFjO1FBQ3pDLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUUsZ0JBQU0sSUFBSSxhQUFNLENBQUMsSUFBSSxLQUFLLEVBQUUsRUFBbEIsQ0FBa0IsQ0FBQyxJQUN2RCxzREFBQyxpTUFBNEMsS0FBQztJQUNsRCxDQUFDO0lBRUQsU0FBUyx1QkFBdUIsQ0FBQyxNQUFjO1FBQzdDLElBQU0sV0FBVyxHQUEyQixFQUFFLENBQUM7UUFDL0MsT0FBTyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBTTtZQUM5QixJQUFJLE1BQU0sQ0FBQyxJQUFJLElBQUksV0FBVyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDM0MsT0FBTyxzREFBQyxxTEFBb0IsRUFBVyxvQ0FBMEIsS0FBckMsTUFBTSxDQUFDLElBQUksRUFBMkI7YUFDbkU7WUFDRCxJQUFJLE1BQU0sQ0FBQyxJQUFJO2dCQUFFLFdBQVcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBQ25ELENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRCxJQUFNLE1BQU0sR0FBRyw0REFBTyxDQUFDO1FBQ3JCLGlCQUFpQixDQUFDLE1BQU0sQ0FBQztRQUN6QixnQkFBZ0IsQ0FBQyxNQUFNLENBQUM7UUFDeEIsbUJBQW1CLENBQUMsTUFBTSxDQUFDO1FBQzNCLHVCQUF1QixDQUFDLE1BQU0sQ0FBQztLQUNoQyxDQUFDLENBQUM7SUFFSCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUUsZ0JBQU0sSUFBSSxhQUFNLEVBQU4sQ0FBTSxDQUFDLENBQUM7QUFDMUMsQ0FBQztBQUdNLFNBQVMsYUFBYSxDQUFFLE1BQWM7SUFDM0MsSUFBTSxNQUFNLEdBQTJCLEVBQUUsQ0FBQztJQUMxQyxTQUFTLEdBQUcsQ0FBQyxFQUFVLEVBQUUsSUFBVTtRQUNqQyxJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNsQixDQUFDO0lBQ0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsY0FBSTtRQUN2QixJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxXQUFDLElBQUksVUFBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQWYsQ0FBZSxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsV0FBQyxJQUFJLFVBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFmLENBQWUsQ0FBQyxDQUFDO1FBQ2xELElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLFlBQUUsSUFBSSxVQUFHLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFiLENBQWEsQ0FBQyxDQUFDO0lBQ3BELENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxNQUFNLENBQUM7QUFDaEIsQ0FBQztBQUVELHVFQUF1RTtBQUNoRSxTQUFTLGlCQUFpQixDQUFFLE1BQWM7SUFDeEMsb0RBQW1CLENBQVc7SUFDckMsSUFBTSxNQUFNLEdBQUcsbUJBQW1CLENBQUMsR0FBRyxDQUFDLFlBQUUsSUFBRyxRQUFDO1FBQzNDLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSTtRQUNiLEtBQUssRUFBRSxvRUFBcUIsQ0FBQyxFQUFFLENBQUM7UUFDaEMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxNQUFNLElBQUksTUFBTTtLQUNMLEdBSm9CLENBSXBCLENBQUMsQ0FBQztJQUMxQixPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3pJOEI7QUFDZ0Q7QUFHUDtBQUNwQjtBQUNMO0FBRUo7QUF1QjNDLElBQU0sY0FBYyxHQUFHO0lBQ3JCLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsc0RBQUMseUhBQVEsTUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFO0lBQ3ZELEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsc0RBQUMsaUlBQU8sTUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFO0NBRXpEO0FBRUQsSUFBTSxpQkFBaUIsR0FBRztJQUN4QixFQUFFLElBQUksRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLHNEQUFDLHFJQUFjLE1BQUUsS0FBSyxFQUFFLGNBQWMsRUFBRTtJQUN2RSxFQUFFLElBQUksRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLHNEQUFDLDZIQUFVLE1BQUUsS0FBSyxFQUFFLEVBQUUsRUFBRTtJQUNyRCxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFO1lBQU0sMkRBQUcsU0FBUyxFQUFDLG9CQUFvQixpQkFBYSxNQUFNLEdBQUs7d0JBQWdCLEVBQUUsS0FBSyxFQUFFLDRDQUE0QyxFQUFFO0NBQ2pLO0FBR0QsU0FBZSxXQUFXLENBQUMsRUFBbUMsRUFBRSxJQUF1QixFQUFFLE1BQWMsRUFBRSxVQUFrQjs7Ozs7O29CQUN6SCxFQUFFLENBQUMsZUFBZSxFQUFFLENBQUM7b0JBQ3JCLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztvQkFDZCxLQUFLLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUM7b0JBQ2hDLEdBQUcsR0FBRyxJQUFJLENBQUM7b0JBQ1QsS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQzt5QkFDNUMsTUFBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEdBQWhCLHdCQUFnQjtvQkFDWixJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN0QixJQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxHQUFHLElBQUksR0FBRyxJQUFJLEVBQUU7d0JBQy9CLDhEQUFTLENBQUMsc0RBQUMsaU5BQTBDLEtBQUMsQ0FBQzt3QkFDdkQsc0JBQU87cUJBQ1I7b0JBRUssSUFBSSxHQUFHLElBQUksUUFBUSxFQUFFLENBQUM7b0JBQzVCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO29CQUNmLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FDL0MsWUFBWSxFQUNaLEtBQUssRUFDTCxFQUFFLEVBQ0YsRUFBRSxFQUNGOzRCQUNFLElBQUksRUFBRSxJQUFJO3lCQUNYLENBQUM7O29CQVBFLEdBQUcsR0FBRyxTQU9SO29CQUNKLElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxHQUFHLEVBQUU7d0JBQ3RCLDhEQUFTLENBQUMsc0RBQUMseU1BQWdELEtBQUMsQ0FBQzt3QkFDN0Qsc0JBQU87cUJBQ1I7b0JBQ0sscUJBQU0sR0FBRyxDQUFDLElBQUksRUFBRTs7b0JBQXRCLEdBQUcsR0FBRyxTQUFnQixDQUFDOzs7d0NBRWQsQ0FBQzs7Ozs7b0NBQ0YsSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzt5Q0FDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsRUFBakMsd0JBQWlDO29DQUU3QixxQkFBTSxJQUFJLE9BQU8sQ0FBQyxpQkFBTyxJQUFJLFdBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEVBQXpCLENBQXlCLENBQUM7O29DQUQ3RCxNQUFNO29DQUNOLEdBQUcsR0FBRyxTQUF1RCxDQUFDOzs7Ozs7b0JBSnpELENBQUMsR0FBRyxDQUFDOzs7eUJBQUUsRUFBQyxHQUFHLEtBQUssQ0FBQyxNQUFNO2tEQUF2QixDQUFDOzs7OztvQkFBd0IsRUFBRSxDQUFDOzs7b0JBUXZDLElBQUksR0FBRyxJQUFJLElBQUksRUFBRTt3QkFDZiw4REFBUyxDQUFDLHNEQUFDLGlOQUEwQyxLQUFDLENBQUM7d0JBQ3ZELHNCQUFPO3FCQUNSO29CQUNELGNBQWMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQzs7Ozs7Q0FDL0M7QUFFTSxTQUFTLGNBQWMsQ0FDNUIsTUFBYyxFQUNkLFVBQWtCLEVBQ2xCLElBQXVCLEVBQ3ZCLEdBQVc7SUFFWCxJQUFNLE9BQU8sR0FBRyxvRUFBVSxFQUFFLENBQUM7SUFDN0IsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUNWLE9BQU8sRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7UUFDMUIsTUFBTSxFQUFFO1lBQ04sSUFBSSxFQUFFLENBQUM7b0JBQ0wsRUFBRSxFQUFFLE9BQU87b0JBQ1gsR0FBRztvQkFDSCxHQUFHLEVBQUU7d0JBQ0gsYUFBYTt3QkFDYixnQkFBYyx3REFBRyxDQUFDLFdBQVcsQ0FBQyxNQUFNLGdCQUFhO3FCQUNsRDtvQkFDRCxLQUFLLEVBQUUsS0FBSztpQkFDYixDQUFDO1NBQ0g7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBOERFO0FBRUssSUFBTSxZQUFZLEdBQUcsVUFBQyxLQUFZO0lBQy9CLHVCQUFLLEVBQUUsNkJBQVUsRUFBRSxpQkFBSSxFQUFFLHFCQUFNLEVBQUUsNkJBQVUsRUFBRSx1Q0FBZSxFQUFFLDZCQUFVLENBQVc7SUFDM0YsSUFBTSxPQUFPLEdBQUcsd0RBQUcsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFJLElBQUksV0FBSSxLQUFLLE9BQU8sRUFBaEIsQ0FBZ0IsQ0FBQyxDQUFDO0lBQ3JFLElBQUksU0FBUyxHQUFHLGlCQUFpQixDQUFDO0lBQ2xDLElBQUksT0FBTztRQUFFLFNBQVMsR0FBRyxjQUFjLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRTFELE9BQU8sNkRBQUssU0FBUyxFQUFDLGlDQUFpQztRQUNyRCw2REFBSyxTQUFTLEVBQUMsdUNBQXVDO1lBQ3BELDZEQUFLLFNBQVMsRUFBQyw2Q0FBNkM7Z0JBQ3pELGVBQWUsSUFBSSxtRUFBUSwrREFFRCxlQUFlLHNDQUUzQyxDQUFTO2dCQUNSLDZEQUFLLFNBQVMsRUFBQyxZQUFZLEVBQ3pCLFVBQVUsRUFBRSxNQUFNLElBQUksZ0RBQVMsRUFDL0IsTUFBTSxFQUFFLE1BQU0sSUFBSSxDQUFDLFlBQUUsSUFBSSxrQkFBVyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLFVBQVUsQ0FBQyxFQUF6QyxDQUF5QyxDQUFDO29CQUNuRTt3QkFDRSxnRUFBSyxLQUFLLENBQU0sQ0FDZDtvQkFDSiw2REFBSyxTQUFTLEVBQUMsY0FBYzt3QkFDM0IsNkRBQUssU0FBUyxFQUFDLGtCQUFrQjs0QkFDL0IsNkRBQUssU0FBUyxFQUFDLGtCQUFrQixHQUFPOzRCQUN4Qyw2REFBSyxTQUFTLEVBQUMsZ0JBQWdCO2dDQUM3QixnRUFDRyxTQUFTLENBQUMsR0FBRyxDQUFDLGNBQUksSUFBSSxRQUFDO29DQUN0QixJQUFJO29DQUNKLFFBQVEsRUFBRSxVQUFVLEtBQUssSUFBSSxDQUFDLElBQUk7b0NBQ2xDLFFBQVEsRUFBRSxLQUFLLENBQUMsU0FBUyxJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztvQ0FDdkQsVUFBVSxFQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztvQ0FDckQsWUFBWSxFQUFFLElBQUksQ0FBQyxLQUFLO2lDQUN6QixDQUFDLEVBTnFCLENBTXJCLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxRQUFRLElBQUksQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLENBQUMsVUFBVSxFQUE1QyxDQUE0QyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBc0Q7d0NBQXBELGNBQUksRUFBRSxzQkFBUSxFQUFFLHNCQUFRLEVBQUUsOEJBQVksRUFBRSwwQkFBVTtvQ0FDckgsT0FBTyw0REFDTCxHQUFHLEVBQUUsSUFBSSxDQUFDLElBQUksRUFDZCxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFDdkMsT0FBTyxFQUFFLFFBQVEsSUFFaEIsUUFBUSxDQUFDLENBQUM7d0NBQ1QsK0RBQUksSUFBSSxDQUFDLElBQUksQ0FBSyxDQUFDLENBQUM7d0NBQ3BCLFlBQVksSUFBSSxVQUFVLENBQUMsQ0FBQzs0Q0FDMUIsVUFBVSxJQUFJLGlCQUFpQixDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2dEQUNsRCwyREFBRyxJQUFJLEVBQUUsVUFBVSxJQUFJLFlBQVksSUFBRyxJQUFJLENBQUMsSUFBSSxDQUFLLENBQUMsQ0FBQztnREFDdEQsb0RBQUMscURBQUksSUFBQyxFQUFFLEVBQUUsWUFBWSxJQUFHLElBQUksQ0FBQyxJQUFJLENBQVEsQ0FBQyxDQUFDOzRDQUM5QywrREFBSSxJQUFJLENBQUMsSUFBSSxDQUFLLENBQ25CLENBQUM7Z0NBQ1IsQ0FBQyxDQUFDLENBQ0MsQ0FDRCxDQUNGLENBQ0YsQ0FDRixDQUNGLENBQ0YsQ0FDRjtBQUNSLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3JPOEI7QUFDUztBQUVPO0FBSVM7QUFXeEQ7SUFBc0MsMEVBQTRCO0lBSWhFLDBCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FJYjtRQUhDLEtBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLEtBQUksQ0FBQyxLQUFLLEdBQUcsRUFDWjs7SUFDSCxDQUFDO0lBRUQsb0NBQVMsR0FBVDtRQUNFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFDLE9BQU8sRUFBRSxFQUFDLEtBQUssRUFBRSxDQUFDO3dCQUN4QyxJQUFJLEVBQUUsY0FBYzt3QkFDcEIsRUFBRSxFQUFFLG9FQUFVLEVBQUU7d0JBQ2hCLFNBQVMsRUFBRSxFQUFFO3dCQUNiLE9BQU8sRUFBRSxFQUFFO3FCQUNLO2lCQUNqQixFQUFDLEVBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELDRDQUFpQixHQUFqQjtRQUNVLDhCQUFNLENBQWdCO1FBQzlCLElBQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEVBQUosQ0FBSSxDQUFDLENBQUM7UUFDeEUsT0FBTyxXQUFXO1lBQ2hCLDJCQUEyQjthQUMxQixHQUFHLENBQUMsWUFBRSxJQUFJLGFBQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBWCxDQUFXLENBQUMsRUFBckMsQ0FBcUMsQ0FBQztZQUNqRCxvRUFBb0U7YUFDbkUsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsQ0FBQyxFQUFILENBQUcsQ0FBQztZQUNqQiwyREFBMkQ7YUFDMUQsTUFBTSxDQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsWUFBRSxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFYLENBQVcsQ0FBQyxFQUFwQyxDQUFvQyxDQUFDLENBQUMsQ0FBQztJQUMvRSxDQUFDO0lBRUssa0NBQU8sR0FBYixVQUFlLFFBQWdCLEVBQUUsU0FBaUI7Ozs7Ozt3QkFDeEMsTUFBTSxHQUFLLElBQUksQ0FBQyxLQUFLLE9BQWYsQ0FBZ0I7d0JBQ3hCLGNBQWMsR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQzt3QkFDMUMsV0FBVyxHQUFHLGNBQWMsQ0FBQyxTQUFTLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssUUFBUSxFQUFqQixDQUFpQixDQUFDLENBQUM7d0JBQy9ELGNBQWMsR0FBRyxXQUFXLEdBQUcsU0FBUyxDQUFDO3dCQUMvQyxJQUFJLGNBQWMsR0FBRyxDQUFDLElBQUksY0FBYyxJQUFJLGNBQWMsQ0FBQyxNQUFNLEVBQUU7NEJBQ2pFLCtCQUErQjs0QkFDL0Isc0JBQU87eUJBQ1I7d0JBQ0ssdUJBQXVCLEdBQUcsY0FBYyxDQUFDLGNBQWMsQ0FBQyxDQUFDO3dCQUN6RCxXQUFXLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsRUFBSixDQUFJLENBQUMsQ0FBQzt3QkFDbEQsV0FBVyxDQUFDLGNBQWMsQ0FBQyxHQUFHLFFBQVEsQ0FBQzt3QkFDdkMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxHQUFHLHVCQUF1QixDQUFDLEVBQUUsQ0FBQzt3QkFDaEQsYUFBYSxHQUFHLFFBQVEsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDO3dCQUN6RCxxQkFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7Z0NBQzNCLFdBQVcsRUFBRSxFQUFDLElBQUksRUFBRSxXQUFXLEVBQUM7NkJBQ2pDLENBQUM7O3dCQUZGLFNBRUUsQ0FBQzt3QkFFRyxVQUFVLEdBQWdCLDZEQUFXLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBZ0IsQ0FBQzt3QkFDdkYsSUFBSSxVQUFVLEVBQUU7NEJBQ2QsSUFBSTtnQ0FDRixNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUMsR0FBRyxFQUFFLGFBQWEsRUFBQyxDQUFDLENBQUMsQ0FBQywwREFBMEQ7Z0NBQ2pHLElBQUksVUFBVSxDQUFDLHFCQUFxQixFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsSUFBSSxVQUFVLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxNQUFNLEdBQUcsUUFBUSxDQUFDLGVBQWUsQ0FBQyxZQUFZLEVBQUU7b0NBQ25JLFVBQVUsQ0FBQyxjQUFjLENBQUMsRUFBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUMsQ0FBQyxDQUFDO2lDQUNqRTs2QkFDRjs0QkFBQyxPQUFPLENBQUMsRUFBRTtnQ0FDVixtRkFBbUY7Z0NBQ25GLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLGFBQWEsQ0FBQyxDQUFDO2dDQUNyQyxJQUFJLFVBQVUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksVUFBVSxDQUFDLHFCQUFxQixFQUFFLENBQUMsTUFBTSxHQUFHLFFBQVEsQ0FBQyxlQUFlLENBQUMsWUFBWSxFQUFFO29DQUNuSSxVQUFVLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO2lDQUNqQzs2QkFDRjt5QkFDRjs7Ozs7S0FDRjtJQUVELGlDQUFNLEdBQU47UUFBQSxpQkFvQkM7UUFuQk8sbUJBQW9ELEVBQWxELGtCQUFNLEVBQUUsY0FBSSxFQUFFLGtEQUFvQyxDQUFDO1FBQzNELElBQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEVBQUosQ0FBSSxDQUFDLENBQUM7UUFDeEUsSUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFFaEQsT0FBTyw2REFBSyxTQUFTLEVBQUMsNEJBQTRCLEVBQUMsR0FBRyxFQUFFLGNBQUksSUFBSSxZQUFJLENBQUMsS0FBSyxHQUFHLElBQUksRUFBakIsQ0FBaUI7WUFDOUUsY0FBYyxDQUFDLEdBQUcsQ0FBQyxnQkFBTSxJQUFJLDJEQUFDLG9FQUFxQixJQUNsRCxHQUFHLEVBQUUsY0FBSSxJQUFJLFlBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBbEMsQ0FBa0MsRUFDL0MsR0FBRyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQ2QsTUFBTSxFQUFFLE1BQU0sRUFDZCxNQUFNLEVBQUUsTUFBTSxFQUNkLFNBQVMsRUFBRSxtQkFBUyxJQUFJLFlBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxTQUFTLENBQUMsRUFBbEMsQ0FBa0MsRUFDMUQsaUJBQWlCLEVBQUUsY0FBSSxZQUFJLENBQUMsaUJBQWlCLEVBQUUsRUFBeEIsQ0FBd0IsRUFDL0MsSUFBSSxFQUFFLElBQUksRUFDVixzQkFBc0IsRUFBRSxzQkFBc0IsR0FDN0MsRUFUMkIsQ0FTM0IsQ0FBQztZQUNKLDZEQUFLLFNBQVMsRUFBQyxlQUFlLEVBQUMsT0FBTyxFQUFFLGNBQUksWUFBSSxDQUFDLFNBQVMsRUFBRSxFQUFoQixDQUFnQiwrQkFFdEQsQ0FDRjtJQUNSLENBQUM7SUFDSCx1QkFBQztBQUFELENBQUMsQ0F6RnFDLCtDQUFlLEdBeUZwRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMzRzhCO0FBSWlEO0FBQ1I7QUFDL0I7QUFHa0I7QUFFUDtBQUVPO0FBQ2U7QUFDSDtBQUNnQjtBQUNSO0FBQ2xDO0FBZTdDLElBQU0sd0JBQXdCLEdBQUcsQ0FBQztRQUNoQyxVQUFVLEVBQUUsRUFBRTtRQUNkLElBQUksRUFBRSxFQUFFO1FBQ1IsSUFBSSxFQUFFLEVBQUU7UUFDUixJQUFJLEVBQUUsRUFBRTtLQUNULENBQUMsQ0FBQztBQUVIO0lBQTJDLCtFQUE0QjtJQUNyRSwrQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBSWI7UUFIQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsb0JBQW9CLEVBQUUsS0FBSztTQUM1Qjs7SUFDSCxDQUFDO0lBRUQsOENBQWMsR0FBZDtRQUNRLG1CQUE2QixFQUE1QixrQkFBTSxFQUFFLGtCQUFvQixDQUFDO1FBQ3BDLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssTUFBTSxDQUFDLEVBQUUsRUFBbEIsQ0FBa0IsQ0FBQyxDQUFDO0lBQzNELENBQUM7SUFFRCxtREFBbUIsR0FBbkI7UUFDUSxtQkFBNkIsRUFBNUIsa0JBQU0sRUFBRSxrQkFBb0IsQ0FBQztRQUNwQyxJQUFNLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDdEQsT0FBTyxjQUFjLENBQUMsU0FBUyxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLE1BQU0sQ0FBQyxFQUFFLEVBQWxCLENBQWtCLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBRUQsNENBQVksR0FBWixVQUFhLGFBQWE7UUFDakIsOEJBQU0sQ0FBZTtRQUM1QixJQUFNLGFBQWEsR0FBRywwREFBTSxDQUFDLE1BQU0sRUFBRSxhQUFhLENBQUMsQ0FBQztRQUNwRCxJQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdEYsQ0FBQztJQUVEOzs7TUFHRTtJQUNGLDJDQUFXLEdBQVgsVUFBYSxJQUFVLEVBQUUsaUJBQXVDO1FBQzlELHNDQUFzQztRQUN0QyxJQUFNLGFBQWEsR0FBTyxFQUFFLENBQUM7UUFDN0IsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2xELE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ3RCLHFDQUFxQztRQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSSxJQUFJLENBQUMsRUFBRSxFQUFmLENBQWUsQ0FBQyxFQUFFO1lBQ3ZELGFBQWEsQ0FBQyxLQUFLLEdBQUcsRUFBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBQyxDQUFDO1NBQ3ZDO1FBQ0QsSUFBTSxjQUFjLEdBQUcsbURBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLElBQUksaUJBQWlCO1lBQUUsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxpQkFBaUIsQ0FBQztRQUNuRSxJQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDMUMsYUFBYSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFDM0IsYUFBYSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsR0FBRztZQUNuQyxPQUFPLEVBQUUsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFDO1lBQ3hCLGtCQUFrQixFQUFFLEVBQUMsSUFBSSxFQUFFLGNBQWMsRUFBQztTQUMzQyxDQUFDO1FBQ0YsZ0JBQWdCO1FBQ2hCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQsNkNBQWEsR0FBYixVQUFlLElBQVU7UUFDdkIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLO1lBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxzREFBQyxtTEFBb0MsRUFBTyxFQUFFLEtBQVQsT0FBTyxFQUFHLENBQUM7UUFDakYsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsRUFBRSxFQUFoQixDQUFnQixDQUFDLENBQUM7UUFDM0UsSUFBSSxTQUFTLElBQUksQ0FBQyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFDLEtBQUssRUFBRSxFQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxFQUFDLEVBQUMsQ0FBQyxDQUFDO1NBQ3BFO0lBQ0gsQ0FBQztJQUVELGdEQUFnQixHQUFoQixVQUFrQixNQUFjLEVBQUUsYUFBNEI7UUFDNUQsSUFBTSxjQUFjLEdBQUcsbURBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLGNBQWMsQ0FBQyxNQUFNLENBQUMsR0FBRyxhQUFhLENBQUM7UUFDdkMsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFDLGtCQUFrQixFQUFFLEVBQUMsSUFBSSxFQUFFLGNBQWMsRUFBQyxFQUFDLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBRUQsNkNBQWEsR0FBYixVQUFlLEVBQVU7UUFDdkIsMkNBQTJDO1FBQzNDLGlFQUFpRTtRQUNqRSx1RUFBdUU7UUFDdkUsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixPQUFPLEVBQUUsRUFBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxhQUFHLElBQUksVUFBRyxLQUFLLEVBQUUsRUFBVixDQUFVLENBQUMsRUFBQztZQUNwRSxrQkFBa0IsRUFBRTtnQkFDbEIsTUFBTSxFQUFFLHdCQUFjO29CQUNwQixJQUFNLElBQUksR0FBRyxtREFBSSxjQUFjLENBQUMsQ0FBQztvQkFDakMsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQ2hCLE9BQU8sSUFBSSxDQUFDO2dCQUNkLENBQUM7YUFDRjtTQUNGLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCw4Q0FBYyxHQUFkLFVBQWdCLEVBQVUsRUFBRSxJQUFVO1FBQ3BDLElBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDdEQsSUFBSSxPQUFPLEdBQUcsQ0FBQyxFQUFFO1lBQ2YsOERBQVMsQ0FBQyxzREFBQyx5TEFBd0MsS0FBQyxDQUFDO1lBQ3JELE9BQU87U0FDUjtRQUNELElBQU0sYUFBYSxHQUFHO1lBQ3BCLDhCQUE4QjtZQUM5QixPQUFPLEVBQUUsRUFBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUM7WUFDM0Msa0JBQWtCLEVBQUU7Z0JBQ2xCLE1BQU0sRUFBRSx3QkFBYztvQkFDcEIsSUFBTSxJQUFJLEdBQUcsbURBQUksY0FBYyxDQUFDLENBQUM7b0JBQ2pDLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO29CQUNoQixPQUFPLElBQUksQ0FBQztnQkFDZCxDQUFDO2FBQ0Y7U0FDRjtRQUNELElBQU0sYUFBYSxHQUFHLDBEQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFDL0QsSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBQzFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztZQUNyQixrQ0FBa0M7WUFDbEMsT0FBTyxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxDQUFDLEVBQUU7WUFDdkQsb0NBQW9DO1lBQ3BDLDhEQUE4RDtZQUM5RCwrREFBK0Q7WUFDL0QsdUNBQXVDO1lBQ3ZDLEtBQUssRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFDO1NBQ3JELENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxnREFBZ0IsR0FBaEIsVUFBa0IsTUFBWSxFQUFFLE1BQVksRUFBRSxTQUE2QjtRQUN6RSxJQUFNLFVBQVUsR0FBRyxnR0FBbUIsQ0FDcEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUN2QixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQ3pCLE1BQU0sRUFDTixNQUFNLEVBQ04sU0FBUyxFQUNULEVBQUMsZUFBZSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7UUFFNUIsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUNoQixPQUFPLEVBQUUsRUFBQyxJQUFJLEVBQUUsVUFBVSxFQUFDO1NBQzVCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxzQ0FBTSxHQUFOO1FBQUEsaUJBMElDO1FBeklPLG1CQUE2RCxFQUEzRCxrQkFBTSxFQUFFLGNBQUksRUFBRSxrQkFBTSxFQUFFLGtEQUFxQyxDQUFDO1FBQ3BFLElBQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUMxQyxJQUFNLGtCQUFrQixHQUFHLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1FBQ3RELElBQUksa0JBQWtCLENBQUM7UUFFdkIsSUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEQsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ2IsSUFBTSxnQkFBZ0IsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hDLElBQU0sY0FBYyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUIsS0FBSyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRTtZQUN2QixnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFFLElBQUksQ0FBQyxDQUFDO1lBQ2hDLGNBQWMsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDakM7UUFHRCxPQUFPLG9EQUFDLCtFQUFZLElBQUMsV0FBVyxFQUFFLENBQUMsbURBQVEsQ0FBQyxlQUFlLEVBQUUsS0FBSyxFQUFFO2dCQUNsRSw2REFBSyxLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUUsT0FBTyxFQUFDO29CQUMzQixrQkFBa0IsR0FBRyxDQUFDLElBQUk7d0JBQ3pCLDJEQUFHLFNBQVMsRUFBQyxrQ0FBa0MsaUJBQ2pDLE1BQU0sRUFDbEIsT0FBTyxFQUFFLFdBQUMsSUFBRyxDQUFDLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxLQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFDLEdBQUk7NEJBQVE7b0JBQzFFLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSTt3QkFDakQsMkRBQUcsU0FBUyxFQUFDLG9DQUFvQyxpQkFDbkMsTUFBTSxFQUNsQixPQUFPLEVBQUUsV0FBQyxJQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxNQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsR0FBQyxHQUFJOzRCQUFRO29CQUN6RSxvREFBQyxzRUFBVSxJQUNULEtBQUssRUFBQyxpQkFBaUIsRUFDdkIsS0FBSyxFQUFFLEVBQUMsT0FBTyxFQUFFLGNBQWMsRUFBQyxFQUNoQyxPQUFPLEVBQUUsV0FBQyxJQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxzREFBQyw4SUFBaUIsRUFBVyxHQUFHLEtBQWQsTUFBTSxDQUFDLElBQUksRUFBSSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBQyxPQUFPLEVBQUUsRUFBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFDLEVBQUMsQ0FBQyxHQUFDLEdBQUksQ0FDdkk7Z0JBQ04sK0RBQUksTUFBTSxDQUFDLElBQUksQ0FBSyxDQUNqQixFQUFFLFVBQVUsRUFBRSxNQUFNLENBQUMsSUFBSSxJQUFJLGNBQWM7WUFDOUMsNkRBQUssU0FBUyxFQUFDLHlCQUF5QixFQUFDLEtBQUssRUFBRSxFQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUM7Z0JBQ3BFLG9EQUFDLGdHQUFvQixJQUNuQixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUksRUFDakIsR0FBRyxFQUFDLElBQUksRUFDUixTQUFTLEVBQUMsaUJBQWlCLEVBQzNCLFFBQVEsRUFBRSxHQUFHLEVBQ2IsV0FBVyxFQUFDLG9CQUFlLEVBQzNCLFFBQVEsRUFBRSxpQkFBTyxJQUFJLG1CQUFZLENBQUMsRUFBQyxJQUFJLEVBQUUsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFDLEVBQUMsQ0FBQyxFQUFyQyxDQUFxQyxHQUMxRDtnQkFDRiw2REFBSyxTQUFTLEVBQUMseUJBQXlCO29CQUN0Qyw2REFBSyxTQUFTLEVBQUMsdUJBQXVCO3dCQUNwQyw0RUFBaUIsQ0FDYjtvQkFDTiw2REFBSyxTQUFTLEVBQUMsdUJBQXVCO3dCQUNwQyxnRUFBUSxLQUFLLEVBQUUsTUFBTSxDQUFDLFNBQVMsSUFBSSxJQUFJLEVBQ3JDLFFBQVEsRUFBRSxZQUFFLElBQUksbUJBQVksQ0FBQyxFQUFDLFNBQVMsRUFBRTtvQ0FDdkMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxLQUFLLElBQUksQ0FBQyxDQUFDO3dDQUM5QixTQUFTLENBQUMsQ0FBQzt3Q0FDWCxRQUFRLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7aUNBQzVCOzZCQUNGLENBQUMsRUFMZ0IsQ0FLaEIsSUFDQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLHVFQUFRLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsSUFBRyxDQUFDLENBQVUsRUFBdEMsQ0FBc0MsQ0FBQyxDQUMzRCxDQUNMO29CQUNOLDZEQUFLLFNBQVMsRUFBQyx1QkFBdUI7d0JBQ3BDLDJFQUFnQixDQUNaO29CQUNOLDZEQUFLLFNBQVMsRUFBQyx1QkFBdUI7d0JBQ3BDLGdFQUFRLEtBQUssRUFBRSxNQUFNLENBQUMsT0FBTyxJQUFJLElBQUksRUFDbkMsUUFBUSxFQUFFLFlBQUUsSUFBSSxtQkFBWSxDQUFDLEVBQUMsT0FBTyxFQUFFO29DQUNyQyxJQUFJLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDLENBQUM7d0NBQzlCLFNBQVMsQ0FBQyxDQUFDO3dDQUNYLFFBQVEsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztpQ0FDNUI7NkJBQ0YsQ0FBQyxFQUxnQixDQUtoQixJQUNDLGNBQWMsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLHVFQUFRLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsSUFBRyxDQUFDLENBQVUsRUFBdEMsQ0FBc0MsQ0FBQyxDQUN6RCxDQUNMLENBQ0Y7Z0JBQ04sNEZBQWtDO2dCQUNsQyxvREFBQyxtRUFBTyxJQUNOLE9BQU8sRUFBRTt3QkFDUCxNQUFNO3dCQUNOLFFBQVE7d0JBQ1IsV0FBVzt3QkFDWCxlQUFlO3dCQUNmLFVBQVU7d0JBQ1YsVUFBVTt3QkFDVixPQUFPO3dCQUNQLE9BQU87d0JBQ1AsTUFBTTt3QkFDTixNQUFNO3dCQUNOLE9BQU87cUJBQUMsRUFDVixjQUFjLEVBQUUsOEVBQWUsRUFDL0IsSUFBSSxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0IsRUFDN0IsUUFBUSxFQUFFLGNBQUk7d0JBQ1osWUFBWSxDQUFDLEVBQUMsZ0JBQWdCLEVBQUUsRUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFDLEVBQUMsQ0FBQztvQkFDaEQsQ0FBQyxHQUFJO2dCQUVQLDRFQUFrQjtnQkFDbEIsb0RBQUMsbUZBQWdCLElBQ2YsT0FBTyxFQUFFLE1BQU0sQ0FBQyxPQUFPLEVBQ3ZCLGtCQUFrQixFQUFFLE1BQU0sQ0FBQyxrQkFBa0IsRUFDN0MsTUFBTSxFQUFFLE1BQU0sRUFDZCxNQUFNLEVBQUUsTUFBTSxFQUNkLElBQUksRUFBRSxJQUFJLEVBQ1Ysc0JBQXNCLEVBQUUsc0JBQXNCLEVBQzlDLFdBQVcsRUFBRSxVQUFDLElBQVUsRUFBRSxpQkFBZ0MsSUFBSyxZQUFJLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxpQkFBaUIsQ0FBQyxFQUF6QyxDQUF5QyxFQUN4RyxhQUFhLEVBQUUsVUFBQyxJQUFVLElBQUssWUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsRUFBeEIsQ0FBd0IsRUFDdkQsMEJBQTBCLEVBQUUsVUFBQyxNQUFjLEVBQUUsYUFBNEI7d0JBQ3ZFLFlBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsYUFBYSxDQUFDO29CQUE1QyxDQUE0QyxFQUM5QyxhQUFhLEVBQUUsVUFBQyxFQUFVLElBQUssWUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsRUFBdEIsQ0FBc0IsRUFDckQsY0FBYyxFQUFFLFVBQUMsRUFBVSxFQUFFLElBQVUsSUFBSyxZQUFJLENBQUMsY0FBYyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBN0IsQ0FBNkIsRUFDekUsZ0JBQWdCLEVBQUUsVUFBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsSUFBSyxZQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsRUFBaEQsQ0FBZ0QsR0FBSTtnQkFFdkcsZ0ZBQXNCO2dCQUN0QiwyREFBRyxTQUFTLEVBQUMsV0FBVyw0RkFBZ0Y7Z0JBQ3hHLG9EQUFDLDJGQUFvQixJQUNuQixTQUFTLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFDM0IsUUFBUSxFQUFFLDBCQUFnQixJQUFJLG1CQUFZLENBQUMsRUFBRSxTQUFTLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxFQUE3QyxDQUE2QyxFQUMzRSxJQUFJLEVBQUUsSUFBSSxHQUFJO2dCQUNoQiw2REFBSyxLQUFLLEVBQUUsRUFBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBQztvQkFDakQsa0JBQWtCLEdBQUcsQ0FBQyxJQUFJO3dCQUN6QiwyREFBRyxTQUFTLEVBQUMsa0NBQWtDLGlCQUNqQyxNQUFNLEVBQ2xCLE9BQU8sRUFBRSxjQUFJLFlBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQXhCLENBQXdCLEdBQUk7NEJBQVE7b0JBQ3BELGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSTt3QkFDakQsMkRBQUcsU0FBUyxFQUFDLG9DQUFvQyxpQkFDbkMsTUFBTSxFQUNsQixPQUFPLEVBQUUsY0FBSSxZQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBdkIsQ0FBdUIsR0FBSTs0QkFBUTtvQkFDcEQsb0RBQUMsc0VBQVUsSUFDVCxLQUFLLEVBQUMsaUJBQWlCLEVBQ3ZCLEtBQUssRUFBRSxFQUFDLE9BQU8sRUFBRSxjQUFjLEVBQUMsRUFDaEMsT0FBTyxFQUFFLGNBQUksY0FBTyxDQUFDLHNEQUFDLDhJQUFpQixFQUFXLEdBQUcsS0FBZCxNQUFNLENBQUMsSUFBSSxFQUFJLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFDLE9BQU8sRUFBRSxFQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUMsRUFBQyxDQUFDLEVBQWxHLENBQWtHLEdBQUksQ0FDakg7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9DQUFvQzt3QkFDakQsNkRBQUssU0FBUyxFQUFFLGNBQWMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsaUJBQWlCLENBQUMsRUFBRSxPQUFPLEVBQUUsY0FBSyxtQkFBWSxDQUFDLEVBQUMsUUFBUSxFQUFFLEVBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBQyxFQUFDLENBQUMsRUFBbEQsQ0FBa0QsSUFDdkosTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUN4RCxDQUNGLENBQ0YsQ0FDRixDQUVTO0lBQ2pCLENBQUM7SUFDSCw0QkFBQztBQUFELENBQUMsQ0F4UTBDLCtDQUFlLEdBd1F6RDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaFQ4QjtBQUNnQjtBQUNpRTtBQUVyRTtBQUNIO0FBQ1k7QUFDYTtBQWtCakU7SUFBcUMseUVBQTRCO0lBQy9ELHlCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FPYjtRQU5DLEtBQUksQ0FBQyxLQUFLLEdBQUc7WUFDWCxhQUFhLEVBQUUsSUFBSTtZQUNuQixrQkFBa0IsRUFBRSxJQUFJO1lBQ3hCLE9BQU8sRUFBRSxJQUFJO1lBQ2IsZ0JBQWdCLEVBQUUsRUFBRTtTQUNyQjs7SUFDSCxDQUFDO0lBRUQsMkNBQWlCLEdBQWpCO1FBQ0UsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxzREFBUyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVLLDhCQUFJLEdBQVY7Ozs7Ozt3QkFDRSw2REFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDO3dCQUNULHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFVLFVBQVUsRUFBRTtnQ0FDcEUsSUFBSSxFQUFFLENBQUMsc0JBQXNCLENBQUM7Z0NBQzlCLE9BQU8sRUFBRSxpQkFBaUI7NkJBQzNCLENBQUM7O3dCQUhJLFFBQVEsR0FBRyxTQUdmO3dCQUNJLE9BQU8sR0FBRyw0REFBTyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxlQUFlLEVBQWpCLENBQWlCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnRUFBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7d0JBQ2xGLGFBQWEsR0FDakIsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUM3Qyw2REFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNiLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxhQUFhLGlCQUFFLENBQUMsQ0FBQzs7Ozs7S0FDbEM7SUFFSyx3Q0FBYyxHQUFwQixVQUFxQixFQUFVOzs7Ozs0QkFDTixxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBUyxTQUFTLEVBQUUsRUFBRSxVQUFVLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDOzt3QkFBekYsY0FBYyxHQUFHLFNBQXdFO3dCQUN6RixhQUFhLEdBQUcsY0FBYzs2QkFDakMsTUFBTSxDQUFDLGdCQUFNLElBQUksYUFBTSxDQUFDLE1BQU0sRUFBYixDQUFhLENBQUM7NkJBQy9CLEdBQUcsQ0FBQyxVQUFDLEVBQWtEO2dDQUFoRCxVQUFFLEVBQUUsa0JBQU0sRUFBRSw0QkFBVyxFQUFFLHdCQUFTLEVBQUUsMEJBQVU7NEJBQ3BELElBQUksV0FBVztnQ0FBRSxXQUFXLEdBQUcsOERBQVMsQ0FBQyxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUM7NEJBQzFELElBQUksbUJBQW1CLEdBQUcsV0FBVztnQ0FDbkMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFJLFNBQVMsQ0FBQyxJQUFJLGNBQVcsQ0FBQyxDQUFDO29DQUMzQyxVQUFVLElBQU8sVUFBVSxDQUFDLElBQUksY0FBVyxDQUFDLENBQUM7NEJBQy9DLE9BQU87Z0NBQ0wsRUFBRTtnQ0FDRixJQUFJLEVBQUUsTUFBTSxLQUFLLFVBQVUsQ0FBQyxDQUFDO29DQUMzQixXQUFXLENBQUMsQ0FBQyxDQUFDLGdCQUFjLFdBQWEsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUM7b0NBQ3JELE1BQU0sV0FBTSw4REFBUyxDQUFDLG1CQUFtQixFQUFFLEVBQUUsQ0FBRztnQ0FDckQsTUFBTTs2QkFDUCxDQUFDO3dCQUNKLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxnRUFBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7d0JBQ3pCLGtCQUFrQixHQUFHLGFBQWEsQ0FBQyxNQUFNLENBQUMsZ0JBQU0sSUFBSSxhQUFNLENBQUMsTUFBTSxLQUFLLFVBQVUsRUFBNUIsQ0FBNEIsQ0FBQyxDQUFDO3dCQUNsRixXQUFXLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQyxnQkFBTSxJQUFJLGFBQU0sQ0FBQyxNQUFNLEtBQUssVUFBVSxFQUE1QixDQUE0QixDQUFDLENBQUM7d0JBQzNFLE9BQU8sR0FBRywrQ0FDWCxrQkFBa0I7NEJBQ3JCLEVBQUUsRUFBRSxNQUFFLElBQUksRUFBRSxLQUFLLEVBQUU7MkJBQ2hCLFdBQVcsQ0FBQyxDQUFDO3dCQUNsQixJQUFJLENBQUMsUUFBUSxDQUFDOzRCQUNaLE9BQU87NEJBQ1Asa0JBQWtCLEVBQUUsRUFBRTs0QkFDdEIsZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7eUJBQ2hDLENBQUMsQ0FBQzs7Ozs7S0FDSjtJQUVELGdDQUFNLEdBQU47UUFBQSxpQkFzRUM7UUFyRU8sbUJBQTZFLEVBQTNFLGdDQUFhLEVBQUUsMENBQWtCLEVBQUUsb0JBQU8sRUFBRSxzQ0FBK0IsQ0FBQztRQUNwRixPQUFPLDZEQUFLLEtBQUssRUFBRSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7WUFDL0Isb0RBQUMsMkRBQVksSUFDWCxLQUFLLEVBQUUsc0RBQUMscUlBQWMsTUFDdEIsVUFBVSxFQUFDLGVBQWUsRUFDMUIsTUFBTSxFQUFFLEVBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFDLEdBQzFDO1lBQ0YsNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtnQkFDL0IsNkRBQUssU0FBUyxFQUFDLHVDQUF1QztvQkFDcEQsNkRBQUssU0FBUyxFQUFDLHVEQUF1RDt3QkFDcEUsNkRBQUssU0FBUyxFQUFDLHVEQUF1RDs0QkFFcEUsNkRBQUssU0FBUyxFQUFDLGlDQUFpQztnQ0FDOUMsNkRBQUssU0FBUyxFQUFFLHNDQUFzQztvQ0FDcEQsNkRBQUssU0FBUyxFQUFDLDJDQUEyQzt3Q0FDeEQsZ0ZBQXNCO3dDQUN0QiwrREFBTTt3Q0FDTiw2REFBSyxTQUFTLEVBQUMseUJBQXlCOzRDQUN0Qyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO2dEQUNqQywwRkFBMEIsQ0FDdEIsQ0FDRjt3Q0FDTiw2REFBSyxTQUFTLEVBQUMseUJBQXlCOzRDQUN0Qyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLElBQ2hDLENBQUMsYUFBYSxDQUFDLENBQUM7Z0RBQ2Y7b0RBQUssb0RBQUMsK0RBQU8sT0FBRztvREFBQSxnRUFBUSxRQUFRLFFBQUMsS0FBSyxFQUFDLEVBQUU7d0RBQUMseUVBQW1CLENBQVMsQ0FBTSxDQUFDLENBQUM7Z0RBQzlFLGdFQUNFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixFQUNwQyxRQUFRLEVBQUUsWUFBRSxJQUFJLFlBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsc0RBQVMsQ0FBQyxFQUFyRCxDQUFxRCxJQUVwRSxhQUFhLENBQUMsR0FBRyxDQUFDLGdCQUFNO29EQUN2Qix1RUFBUSxHQUFHLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUUsSUFBRyxNQUFNLENBQUMsSUFBSSxDQUFVO2dEQUFoRSxDQUFnRSxDQUNqRSxDQUNNLENBQ1AsQ0FDRjt3Q0FDTCxPQUFPLElBQUksNkRBQUssU0FBUyxFQUFDLHlCQUF5Qjs0Q0FDbEQsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjtnREFDakMsK0ZBQTBCLENBQ3RCLENBQ0Y7d0NBQ0wsT0FBTyxJQUFJLDZEQUFLLFNBQVMsRUFBQyx5QkFBeUI7NENBQ2xELDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7Z0RBQ2pDLGdFQUFRLEtBQUssRUFBRSxnQkFBZ0IsRUFBRSxRQUFRLEVBQUUsWUFBRSxJQUFJLFlBQUksQ0FBQyxRQUFRLENBQUM7d0RBQzdELGdCQUFnQixFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSztxREFDbEMsQ0FBQyxFQUYrQyxDQUUvQyxJQUNDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZ0JBQU07b0RBQ2pCLHVFQUFRLEdBQUcsRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsRUFBRSxJQUFHLE1BQU0sQ0FBQyxJQUFJLENBQVU7Z0RBQWhFLENBQWdFLENBQ2pFLENBQ00sQ0FDTCxDQUNGO3dDQUNOLCtEQUFNO3dDQUFBLCtEQUFNO3dDQUNYLE9BQU8sSUFBSSxnQkFBZ0IsSUFBSSxvREFBQyxxREFBSSxJQUNuQyxFQUFFLEVBQUUsbUNBQWlDLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWtCLEVBQ2xFLFNBQVMsRUFBQyxlQUFlLFlBQ2QsQ0FDVCxDQUNGO2dDQUNOLDZEQUFLLFNBQVMsRUFBQyx1QkFBdUI7b0NBQ3BDLG9EQUFDLDRFQUFhLE9BQUcsQ0FDYixDQUNGLENBRUYsQ0FDRixDQUNGLENBQ0YsQ0FDRjtJQUNSLENBQUM7SUFDSCxzQkFBQztBQUFELENBQUMsQ0FqSW9DLCtDQUFlLEdBaUluRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFKOEI7QUFDUztBQUM0QztBQUNoRDtBQUVtQztBQUM1QjtBQUNJO0FBQ087QUFDYjtBQUM2STtBQUUzSDtBQUNzRDtBQUN0RTtBQUNTO0FBQ2dCO0FBQ0M7QUFDTjtBQUNUO0FBQ2M7QUFFcEUsSUFBTSxPQUFPLEdBQUcseURBQUcsQ0FBQyxXQUFXLEtBQUssWUFBWSxDQUFDLENBQUM7SUFDaEQsc0RBQVMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBdUJuQixJQUFNLHdCQUF3QixHQUM1QixzREFBQyxtUkFBMkUsS0FBQztBQUUvRSxJQUFNLGFBQWEsR0FBVTtJQUMzQixVQUFVLEVBQUUsSUFBSTtJQUNoQixZQUFZLEVBQUUsSUFBSTtJQUNsQixNQUFNLEVBQUUsSUFBSTtJQUNaLGdCQUFnQixFQUFFLEVBQUU7SUFDcEIsY0FBYyxFQUFFLEtBQUs7SUFDckIsSUFBSSxFQUFFLGVBQWU7SUFDckIsdUJBQXVCLEVBQUUsS0FBSztDQUMvQixDQUFDO0FBRUY7SUFBZ0Msb0VBQTRCO0lBK0MxRCxvQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBY2I7UUFiQyxLQUFJLENBQUMsS0FBSyxHQUFHLG1EQUFJLGFBQWEsQ0FBQyxDQUFDO1FBQ2hDLEtBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDckMsS0FBSSxDQUFDLFNBQVMsR0FBRyxLQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsQ0FBQztRQUMzQyxLQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQztRQUNyQixLQUFJLENBQUMsU0FBUyxHQUFHLEtBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxDQUFDO1FBQzNDLEtBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDakQsS0FBSSxDQUFDLG9CQUFvQixHQUFHLEtBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDakUsS0FBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7UUFDdEIsS0FBSSxDQUFDLE9BQU8sR0FBRyxFQUFFLENBQUM7UUFDbEIsSUFBSSxLQUFLLENBQUMsSUFBSTtZQUFFLEtBQUksQ0FBQyxLQUFLLEdBQUcsbURBQ3hCLEtBQUksQ0FBQyxLQUFLLElBQ2IsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLEdBQ2pCLENBQUM7O0lBQ0osQ0FBQztJQXZERCxxQ0FBZ0IsR0FBaEIsVUFBa0IsS0FBcUI7UUFDckMsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLGlEQUFDLGNBQWMsRUFBRSxJQUFJLElBQUssS0FBSyxFQUFFLENBQUM7SUFDMUQsQ0FBQztJQUVELDRDQUF1QixHQUF2QixVQUF5QixLQUFxQjtRQUM1QyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVELDhCQUFTLEdBQVQsVUFBVyxLQUFxQjtRQUFoQyxpQkE4QkM7UUE3QkMsSUFBSSxLQUFLLENBQUMsTUFBTSxFQUFFO1lBQ2hCO2dCQUNFLEVBQUU7Z0JBQ0Ysc0VBQXNFO2dCQUN0RSxpQkFBaUI7Z0JBQ2pCLEVBQUU7Z0JBQ0kscUJBQStCLEVBQTlCLGdCQUFLLEVBQUUsb0JBQXVCLENBQUM7Z0JBQ3RDLElBQU0sYUFBVyxHQUFHLEVBQUUsQ0FBQztnQkFDdkIsT0FBTyxDQUFDLE9BQU8sQ0FBQyxnQkFBTSxJQUFJLGFBQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLFlBQUUsSUFBSSxvQkFBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksRUFBdEIsQ0FBc0IsQ0FBQyxFQUFwRCxDQUFvRCxDQUFDLENBQUM7Z0JBQ2hGLElBQU0sbUJBQW1CLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksb0JBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQWpCLENBQWlCLENBQUMsQ0FBQztnQkFDakUsSUFBTSxjQUFjLEdBQUcsbURBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUN6QyxjQUFjLENBQUMsS0FBSyxHQUFHLG1CQUFtQixDQUFDO2dCQUMzQyxLQUFLLEdBQUcsbURBQUksS0FBSyxJQUFFLE1BQU0sRUFBRSxjQUFjLEdBQUMsQ0FBQzthQUM1QztTQUNGO1FBRUQsK0RBQStEO1FBQy9ELCtEQUErRDtRQUMvRCx3Q0FBd0M7UUFDeEMsSUFBSSxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQztRQUMzRCxJQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO1FBQ2pELElBQUksVUFBVSxFQUFFO1lBQ2QsSUFBTSxZQUFZLEdBQUcsVUFBVSxDQUFDLFNBQVMsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxLQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO1lBQ3ZFLFVBQVUsR0FBRywwREFBTSxDQUFDLFVBQVUsRUFBRSxFQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsWUFBWSxFQUFFLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztZQUN4RSxLQUFLLEdBQUcsbURBQUksS0FBSyxDQUFDLENBQUM7WUFDbkIsS0FBSyxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7U0FDL0I7UUFFRCxPQUFPLElBQUksT0FBTyxDQUFDLGlCQUFPLElBQUksd0JBQU0sUUFBUSxhQUFDLGNBQUksWUFBYyxFQUFkLENBQWMsRUFBRSxPQUFPLENBQUMsRUFBM0MsQ0FBMkMsQ0FBQyxDQUFDO0lBQzdFLENBQUM7SUFtQkQsdUNBQWtCLEdBQWxCO1FBQ0UsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMzQixNQUFNLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNuRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMzRCxRQUFRLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUNyRSxDQUFDO0lBRUQseUNBQW9CLEdBQXBCO1FBQ0UsTUFBTSxDQUFDLG1CQUFtQixDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdEQsTUFBTSxDQUFDLG1CQUFtQixDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDOUQsUUFBUSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUM7UUFDdEUsd0VBQXlCLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVELDhDQUF5QixHQUF6QixVQUEwQixTQUFnQjtRQUN4QyxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7WUFDbkMsSUFBSSxTQUFTLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxJQUFJLFNBQVMsQ0FBQyxVQUFVLEtBQUssSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUU7Z0JBQ3BGLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsQ0FBQzthQUN0QztTQUNGO1FBQ0QsSUFBSSxTQUFTLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFO1lBQ3RDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxFQUFDLElBQUksRUFBRSxTQUFTLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztTQUN0RDtJQUNILENBQUM7SUFFRCx1Q0FBa0IsR0FBbEIsVUFBbUIsU0FBZ0IsRUFBRSxTQUFnQjtRQUNuRCxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDbkIsSUFBTSxVQUFVLEdBQW1CLDZEQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBbUIsQ0FBQztZQUNsRixJQUFJLFVBQVUsRUFBRTtnQkFDZCxJQUFJLENBQUMsV0FBVyxHQUFHLFVBQVUsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLEdBQUcsQ0FBQzthQUMzRDtTQUNGO1FBRUQsSUFBSSxTQUFTLElBQUksU0FBUyxDQUFDLE1BQU0sRUFBRTtZQUNqQyxtQ0FBbUM7WUFDbkMsdUZBQXVGO1lBQ3ZGLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEtBQUssU0FBUyxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsS0FBSyxTQUFTLENBQUMsVUFBVSxFQUFFO2dCQUNwRixJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO2FBQzVCO1NBQ0Y7UUFFRCxJQUFJLENBQUMsU0FBUyxDQUFDLGNBQWMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRTtZQUMxRCx3RUFBeUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN0QztJQUNILENBQUM7SUFFSyxxQ0FBZ0IsR0FBdEIsVUFBdUIsVUFBa0I7Ozs7Ozt3QkFDdkMsNkRBQVEsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO3dCQUNwQixxQkFBTSx5REFBVSxDQUFDLFVBQVUsRUFBRSxFQUFDLG9CQUFvQixFQUFFLElBQUksRUFBQyxDQUFDOzt3QkFBckUsUUFBUSxHQUFHLFNBQTBEO3dCQUNyRSxNQUFNLEdBQUcsa0VBQW1CLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLFFBQVEsRUFBRSx3REFBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO3dCQUMxRSxNQUFNLENBQUMsRUFBRSxHQUFHLG9FQUFVLEVBQUUsQ0FBQzt3QkFDekIsTUFBTSxDQUFDLFFBQVEsR0FBRyxVQUFVLENBQUM7d0JBQzdCLE1BQU0sQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO3dCQUN0QixNQUFNLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQzt3QkFDMUIsTUFBTSxDQUFDLGFBQWEsR0FBRywrQ0FBSSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7d0JBQ2pELE1BQU0sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUMsRUFBRSxFQUFFLFVBQVUsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFXLENBQUMsQ0FBQzt3QkFDOUQsUUFBUSxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQzt3QkFDeEMsTUFBTSxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUM7d0JBQ3pCLE1BQU0sQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO3dCQUN4QixNQUFNLENBQUMsbUJBQW1CLEdBQUcsRUFBRSxDQUFDO3dCQUNoQyxPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUM7d0JBQzFCLE1BQU0sQ0FBQyxHQUFHLEdBQUc7NEJBQ1gsYUFBYTs0QkFDYixnQkFBYyxRQUFRLGdCQUFhLENBQUMscUVBQXFFO3lCQUMxRyxDQUFDO3dCQUNGLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQzt3QkFDcEIsT0FBTyxNQUFNLENBQUMsU0FBUyxDQUFDO3dCQUN4QixPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUM7d0JBQzFCLE9BQU8sTUFBTSxDQUFDLFVBQVUsQ0FBQzt3QkFDekIsT0FBTyxNQUFNLENBQUMsWUFBWSxDQUFDO3dCQUMzQixPQUFPLE1BQU0sQ0FBQyxXQUFXLENBQUM7d0JBQzFCLE9BQU8sTUFBTSxDQUFDLGFBQWEsQ0FBQzt3QkFDNUIsT0FBTyxNQUFNLENBQUMsbUJBQW1CLENBQUM7d0JBQ2xDLE9BQU8sTUFBTSxDQUFDLGtCQUFrQixDQUFDO3dCQUNqQyxPQUFPLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQzt3QkFDckMscUJBQU0sSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsTUFBTSxVQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsWUFBWSxFQUFFLFFBQVEsRUFBRSxDQUFDOzt3QkFBakYsU0FBaUYsQ0FBQzt3QkFDbEYsNkRBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQzs7Ozs7S0FDZDtJQUVLLHlCQUFJLEdBQVY7Ozs7O3dCQUNFLHdFQUF5QixDQUFDLEVBQUUsQ0FBQyxDQUFDOzZCQUMxQixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBYix3QkFBYTt3QkFDZixxQkFBTSxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7O3dCQUE1QyxTQUE0QyxDQUFDOzs7NkJBQ3BDLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFyQix3QkFBcUI7d0JBQzlCLHFCQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQzs7d0JBQWxELFNBQWtELENBQUM7OzRCQUVuRCxNQUFNLElBQUksS0FBSyxDQUFDLHNEQUFDLDJOQUFvRCxLQUFDLENBQUM7Ozs7O0tBRTFFO0lBRUssdUNBQWtCLEdBQXhCLFVBQXlCLFFBQWdCOzs7Ozs7d0JBQ3ZDLDZEQUFRLENBQUMsYUFBYSxDQUFDLENBQUM7d0JBQ1QscUJBQU0seURBQVUsQ0FBQyxRQUFRLENBQUM7O3dCQUFuQyxNQUFNLEdBQUcsU0FBMEI7d0JBQ3pDLElBQUksQ0FBQyxNQUFNLENBQUMsbUJBQW1COzRCQUFFLE1BQU0sQ0FBQyxtQkFBbUIsR0FBRyxFQUFFLENBQUM7d0JBQ2pFLHFCQUFNLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLE1BQU0sVUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLENBQUM7O3dCQUFsRSxTQUFrRSxDQUFDO3dCQUNuRSw2REFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDOzs7OztLQUNkO0lBRUssMkJBQU0sR0FBWixVQUFhLGFBQWE7Ozs7NEJBQ3hCLHFCQUFNLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLE1BQU0sRUFBRSwwREFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQyxFQUFFLENBQUM7O3dCQUFqRixTQUFpRixDQUFDO3dCQUNsRix5QkFBeUI7d0JBQ3pCLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxDQUFDOzs7OztLQUMvQjtJQUVLLGlDQUFZLEdBQWxCOzs7Ozs7d0JBQ0UsNkRBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO3dCQUN4QixZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDO3dCQUN4QyxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO3dCQUN0QyxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7d0JBRWQscUJBQU0sd0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQVMsU0FBUyxFQUFFO2dDQUNsRSxVQUFVLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQzs2QkFDNUIsQ0FBQzs7d0JBRkksUUFBUSxHQUFHLFNBRWY7d0JBQ0ksRUFBRSxHQUFHLElBQUksNkRBQVcsRUFBRSxDQUFDOzs0QkFDN0IsS0FBMEIsb0VBQVEsMkZBQUU7Z0NBQXpCLFdBQVc7Z0NBQ3BCOzs7O21DQUlHOzZCQUNKOzs7Ozs7Ozs7d0JBRUQsRUFBRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7d0JBQy9CLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQzs7d0JBQXJELFNBQXFELENBQUM7d0JBQ3RELElBQUksWUFBWSxLQUFLLHdEQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRTs0QkFDM0MsMEVBQW1CLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3lCQUN0Qzt3QkFDRCw2REFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNiLFFBQVEsQ0FBQyxJQUFJLEdBQUcsZUFBZSxDQUFDOzs7OztLQUNqQztJQUVEOzs7T0FHRztJQUNHLHVDQUFrQixHQUF4Qjs7Ozs7O3dCQUNVLE1BQU0sR0FBSSxJQUFJLENBQUMsS0FBSyxPQUFkLENBQWU7d0JBQ3pCLGlCQUFpQixHQUFHLEtBQUssQ0FBQzt3QkFDOUIsNEZBQTRGO3dCQUM1RixJQUFJLE1BQU0sQ0FBQyxzQkFBc0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsSUFBSSw0REFBUSxDQUFDLFdBQVcsRUFBRTs0QkFDeEYsaUJBQWlCLEdBQUcsT0FBTyxDQUFDLHNEQUFDLGlLQUE0QixLQUFDLENBQUM7eUJBQzVEO3dCQUNELHFCQUFNLGlCQUFpQjs7d0JBQXZCLFVBQXVCLEVBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7Ozs7O0tBQ3pFO0lBRUsseUJBQUksR0FBVjs7Ozs7O3dCQUVRLEtBQXlCLElBQUksQ0FBQyxLQUFLLEVBQWpDLE1BQU0sY0FBRSxVQUFVLGlCQUFnQjs2QkFDdEMsV0FBVSxJQUFJLFVBQVUsQ0FBQyxzQkFBc0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsR0FBakYsd0JBQWlGOzs7O3dCQUU3RSxhQUFhLEdBQUcsSUFBSSwwRUFBYSxFQUFFLENBQUM7d0JBQzFDLHFCQUFNLGFBQWEsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDOzt3QkFBbkMsU0FBbUMsQ0FBQzs7Ozs7NEJBQ2pCLHNCQUFPOzt3QkFHdEIsbUJBQW1CLEdBQUcsNERBQVEsQ0FBQyxhQUFhLENBQUM7d0JBQzdDLGNBQWMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsMEVBQWlCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO3dCQUN2RixrQkFBa0IsR0FBRywwRUFBaUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUMxRCxXQUFXLEdBQUcsNkVBQWMsRUFBRSxDQUFDO3dCQUNyQyxJQUFJLG1CQUFtQjs0QkFDckIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztnQ0FDbkMsQ0FBQywrQ0FBSSxjQUFjLEVBQUssa0JBQWtCLEVBQUUsSUFBSSxDQUM5QyxVQUFDLEVBQW9CO3dDQUFuQixnQkFBSyxFQUFFLFlBQUcsRUFBRSxrQkFBTTtvQ0FDbEIsUUFBQyxLQUFLLElBQUksR0FBRyxDQUFDLEtBQUssV0FBVyxDQUFDLElBQUksSUFBSSx5REFBeUQ7d0NBQ2hHLENBQ0UsQ0FBQyxNQUFNLElBQUksMERBQTBEOzRDQUNyRSxNQUFNLEtBQUssTUFBTSxJQUFJLGVBQWU7NENBQ3BDLE1BQU0sS0FBSyxNQUFNLENBQUM7Z0NBSnBCLENBSW9CLENBQ25CLENBQ0YsRUFFUDs0QkFDRSw4REFBUyxDQUFDLHNEQUFDLHlTQUE0RSxLQUFDLENBQUM7NEJBQ3pGLHNCQUFPO3lCQUNSO3dCQUNELElBQUksSUFBSSxDQUFDLFFBQVE7NEJBQUUsc0JBQU87Ozs7d0JBRXhCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO3dCQUNyQixxQkFBTSxJQUFJLENBQUMsS0FBSyxFQUFFOzt3QkFBbEIsU0FBa0IsQ0FBQzs7Ozt3QkFFZixZQUFZLEdBQUcsS0FBRyxJQUFJLEtBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLHNEQUFDLDZMQUFnQyxLQUFDO3dCQUN4RixJQUFJLEtBQUcsRUFBRTs0QkFDUCxJQUFJLEtBQUcsQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFJLEtBQUcsQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFJLEtBQUcsQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO2dDQUM5RSx3Q0FBd0M7Z0NBQ3hDLFlBQVksR0FBRyxzREFBQyx1U0FBZ0YsS0FBQzs2QkFDbEc7aUNBQU0sSUFBSSxLQUFHLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtnQ0FDakMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVO29DQUM5QixZQUFZLEdBQUcsc0RBQUMsNlNBQXdGLEtBQUM7cUNBQ3RHLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTTtvQ0FDL0IsWUFBWSxHQUFHLHNEQUFDLHlQQUFxQyxFQUFzQix3REFBK0MsRUFBd0IsRUFBRSxLQUEvRixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQStDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBRSxDQUFDOzZCQUN4Sjt5QkFDRjt3QkFDRCw4REFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO3dCQUN4Qix3RUFBeUIsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7O3dCQUVuQyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQzs7Ozs7O0tBRXpCO0lBRUQsbUNBQWMsR0FBZDtRQUNFLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQztJQUM1QyxDQUFDO0lBRUssNkNBQXdCLEdBQTlCOzs7Ozs7d0JBQ1EsS0FBeUIsSUFBSSxDQUFDLEtBQUssRUFBakMsTUFBTSxjQUFFLFVBQVUsaUJBQWdCO3dCQUMxQyxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUNwQixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO3dCQUN4QixxQkFBTSxJQUFJLENBQUMsSUFBSSxFQUFFOzt3QkFBakIsU0FBaUIsQ0FBQzt3QkFDbEIsa0ZBQWtGO3dCQUNsRiw4Q0FBOEM7d0JBQzlDLElBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUU7NEJBQzVCLDhEQUFTLENBQUMsc0RBQUMseU1BQWdELEtBQUMsQ0FBQzs0QkFDN0Qsc0JBQU87eUJBQ1I7Ozs7d0JBR0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLHVCQUF1QixFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7d0JBQzNDLGFBQWEsR0FBRyxJQUFJLDBFQUFhLEVBQUUsQ0FBQzs2QkFDdEMsTUFBTSxDQUFDLHNCQUFzQixFQUE3Qix3QkFBNkI7d0JBRTNCLGNBQWMsR0FBRyxNQUFNLENBQUMsbUJBQW1CLElBQUksSUFBSSxDQUFDO3dCQUN2QyxxQkFBTSxhQUFhLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsY0FBYyxDQUFDOzt3QkFBN0UsVUFBVSxHQUFHLFNBQWdFOzZCQUM5RSxVQUFVLENBQUMsSUFBSSxFQUFmLHdCQUFlO3dCQUNoQixJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUMsbUJBQW1CLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsQ0FBQyxDQUFDO3dCQUNuRCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQzt3QkFFbEQsaUNBQWlDO3dCQUNqQyxxQkFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQzs7d0JBRHRCLGlDQUFpQzt3QkFDakMsU0FBc0IsQ0FBQzt3QkFDdkIsNkRBQVEsQ0FBQyxzREFBQywrS0FBNkIsS0FBQyxDQUFDOzs7d0JBRXpDLDhEQUFTLENBQUMsc0RBQUMsbUtBQTRCLEtBQUMsQ0FBQzt3QkFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLHVCQUF1QixFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7Ozs7O3dCQUkxQyxPQUFPOzs7Ozs7S0FDdEI7SUFFYSwwQkFBSyxHQUFuQixVQUFvQixVQUEyQjtRQUEzQiwrQ0FBMkI7Ozs7Ozt3QkFDdkMsS0FBdUMsSUFBSSxDQUFDLEtBQUssRUFBL0MsTUFBTSxjQUFFLFVBQVUsa0JBQUUsWUFBWSxtQkFBZ0I7d0JBQ2xELGdDQUFnQyxHQUFHLDBGQUFpQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUM7d0JBRWhHLENBQUMsVUFBVSxJQUFJLDZEQUFRLENBQUMsc0RBQUMsaUlBQVcsS0FBQyxDQUFDO3dCQUNsQyxjQUFjLEdBQVcsc0VBQXVCLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLE1BQU0sRUFBRSx3REFBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO3dCQUVwRixLQUFLLEdBQUcsSUFBSSw2REFBVyxFQUFFLENBQUM7d0JBTzFCLElBQUksR0FBRyxVQUFVLElBQUksWUFBWSxDQUFDO3dCQUNsQyxjQUFjLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsY0FBSTs0QkFDbEQsSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLFFBQVEsRUFBRTtnQ0FDbkQsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLEVBQUUsRUFBaEIsQ0FBZ0IsQ0FBQyxDQUFDO2dDQUN4RCxPQUFPLG1FQUFvQixDQUFDLFFBQVEsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtvQ0FDekQscUJBQXFCLEVBQUUsd0JBQXdCO29DQUMvQyxjQUFjLEVBQUUsaUJBQWlCO29DQUNqQyxTQUFTLEVBQUUsV0FBVztpQ0FDdkIsRUFBRSxLQUFLLENBQUMsQ0FBQzs2QkFDWDtpQ0FBTTtnQ0FDTCxJQUFNLFdBQVcsR0FBRyxtREFBSSxJQUFJLENBQUMsQ0FBQztnQ0FDOUIsT0FBTyxXQUFXLENBQUMsS0FBSyxDQUFDO2dDQUN6QixPQUFPLFdBQVcsQ0FBQzs2QkFDcEI7d0JBQ0gsQ0FBQyxDQUFDLENBQUM7d0JBQ0gsY0FBYyxHQUFHLDBEQUFNLENBQUMsY0FBYyxFQUFFLEVBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLGNBQWMsRUFBQyxFQUFDLENBQUMsQ0FBQzt3QkFFekUsY0FBYyxHQUFHLG1FQUFvQixDQUFDLFVBQVUsSUFBSSxFQUFFLEVBQUUsY0FBYyxFQUFFLFNBQVMsRUFBRTs0QkFDakYsYUFBYSxFQUFFLFNBQVM7NEJBQ3hCLGNBQWMsRUFBRSxpQkFBaUI7NEJBQ2pDLHFCQUFxQixFQUFFLHdCQUF3Qjs0QkFDL0MsU0FBUyxFQUFFLFdBQVc7NEJBQ3RCLE1BQU0sRUFBRSxRQUFROzRCQUNoQixLQUFLLEVBQUUsT0FBTzt5QkFDZixFQUFFLEtBQUssQ0FBQyxDQUFDO3dCQUVWLGNBQWMsR0FBRyxtREFBSSxjQUFjLENBQUUsQ0FBQzt3QkFDdEMsY0FBYyxDQUFDLFdBQVcsR0FBRyxnQ0FBZ0MsQ0FBQzt3QkFDeEQsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsYUFBRyxJQUFJLFVBQUcsS0FBSyxZQUFZLEVBQXBCLENBQW9CLENBQUMsQ0FBQzt3QkFDN0UsY0FBYyxDQUFDLElBQUksR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLENBQUM7NEJBQ2hELElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQzs2QkFFL0IsQ0FBQyxVQUFVLEVBQVgsd0JBQVc7d0JBQ2IsZ0NBQWdDO3dCQUNoQyxLQUFLLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsQ0FBQzs2QkFDakMsTUFBTSxDQUFDLE1BQU0sRUFBYix3QkFBYTt3QkFDRSxxQkFBTSwwRUFBbUIsQ0FBQyxXQUFXLEVBQUU7O3dCQUFsRCxRQUFRLEdBQUcsU0FBdUM7d0JBQ3hELEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxTQUFTLENBQUMsQ0FBQzt3QkFDakUsSUFBSSxNQUFNLENBQUMsTUFBTSxFQUFFOzRCQUNqQixLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsZUFBZSxDQUFDLENBQUM7eUJBQ3hFOzs7O3dCQUdILHdDQUF3Qzt3QkFDeEMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsY0FBYyxDQUFDLENBQUM7NkJBQ2pDLEVBQUMsVUFBVSxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFuQyx3QkFBbUM7d0JBRXBCLHFCQUFNLDBFQUFtQixDQUFDLFdBQVcsRUFBRTs7d0JBQWxELFFBQVEsR0FBRyxTQUF1Qzt3QkFDeEQsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLGVBQWUsQ0FBQyxDQUFDOzs7NkJBQzlELFdBQVUsQ0FBQyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFuQyx3QkFBbUM7d0JBRTNCLHFCQUFNLDBFQUFtQixDQUFDLFdBQVcsRUFBRTs7d0JBQWxELFFBQVEsR0FBRyxTQUF1Qzt3QkFDeEQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLGVBQWUsQ0FBQyxDQUFDOzs0QkFLakUscUJBQU0sd0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDOzt3QkFBOUQsR0FBRyxHQUFHLFNBQXdEO3dCQUNwRSxDQUFDLFVBQVUsSUFBSSw2REFBUSxDQUFFLFVBQVUsQ0FBQyxDQUFDLENBQ25DLHNEQUFDLHVLQUF5QixLQUFDLENBQUMsQ0FDNUIsc0RBQUMsbUpBQW9CLEtBQUMsQ0FBQzt3QkFDekIsZ0RBQWdEO3dCQUNoRCxJQUFJLEdBQUcsSUFBSSxHQUFHLENBQUMsUUFBUTs0QkFDbkIsY0FBYyxHQUFHLHlEQUFVLENBQUMsY0FBYyxFQUFFLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQVcsQ0FBQzt3QkFFN0YsSUFBSSxNQUFNLENBQUMsTUFBTSxLQUFLLHdEQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRTs0QkFDNUMsNkJBQTZCOzRCQUM3QixJQUFJLENBQUMsVUFBVSxFQUFFO2dDQUNmLDBFQUFtQixDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQzs2QkFDNUM7aUNBQU07Z0NBQ0wsMEVBQW1CLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDOzZCQUM1Qzt5QkFDRjt3QkFFRCxxQkFBTSxJQUFJLENBQUMsdUJBQXVCLENBQUMsRUFBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLFVBQVUsRUFBRSxjQUFjLEVBQUUsY0FBYyxFQUFFLEtBQUssRUFBQyxDQUFDOzt3QkFBL0csU0FBK0csQ0FBQzt3QkFDaEgsd0VBQXlCLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQzlCLElBQUksQ0FBQyxVQUFVLEVBQUU7NEJBQ2YsbUdBQW1HOzRCQUNuRyxRQUFRLENBQUMsSUFBSSxHQUFHLGVBQWEsY0FBYyxDQUFDLEVBQUUsVUFBTyxDQUFDO3lCQUN2RDs7Ozs7S0FDRjtJQUVRLDJDQUFzQixHQUEvQjtRQUNRLG1CQUFtQyxFQUFqQyxrQkFBTSxFQUFFLDBCQUF5QixDQUFDO1FBQzFDLElBQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsVUFBVSxFQUFaLENBQVksQ0FBQyxDQUFDO1FBRXZELG1DQUFtQztRQUNuQyxJQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFVBQVUsRUFBWixDQUFZLENBQUMsQ0FBQztRQUMzRCw4QkFBOEI7UUFDOUIsSUFBSSxpQkFBaUIsR0FBRyx5REFBVSxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsRUFBRSxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUMvRixFQUFFO1FBQ0YsSUFBSSxlQUFlLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxRQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBWixDQUFZLENBQUMsRUFBaEMsQ0FBZ0MsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxRQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsRUFBWixDQUFZLENBQUMsRUFBaEMsQ0FBZ0MsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7UUFDL0osK0NBQStDO1FBQy9DLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDcEIsZUFBZSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBRSxJQUFJLGNBQU8sQ0FBQyxJQUFJLENBQUMsWUFBRTtnQkFDbEQsT0FBTyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLElBQUksS0FBSyxFQUFFLENBQUMsSUFBSSxDQUFDO1lBQ2hELENBQUMsQ0FBQyxJQUFJLElBQUksRUFGMkIsQ0FFM0IsQ0FBQyxDQUFDO1NBQ2I7UUFFRCxJQUFJLHFCQUFxQixHQUFHLHlEQUFVLENBQUMsVUFBVSxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDbkYsd0ZBQXdGO1FBQ3hGLElBQUksVUFBVSxHQUFJLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQztRQUM3QyxNQUFNLENBQUMsbUJBQW1CLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixJQUFJLGVBQWUsSUFBSSxxQkFBcUIsQ0FBQyxDQUFDO1FBQzlGLElBQUksVUFBVSxJQUFJLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRTtZQUM1QyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxNQUFNLFVBQUUsQ0FBQyxDQUFDO1NBQ25DO0lBQ0gsQ0FBQztJQUVELG9DQUFlLEdBQWY7UUFBQSxpQkFrQkM7UUFqQkMsSUFBTSxNQUFNLEdBQUcsbURBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN0QyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtZQUNsQjs7O2NBR0U7WUFFRixNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztZQUNyQixNQUFNLENBQUMsV0FBVyxHQUFHO2dCQUNuQixJQUFJLEVBQUUsd0RBQUcsQ0FBQyxXQUFXLENBQUMsV0FBVztnQkFDakMsR0FBRyxFQUFFLFNBQVMsR0FBSSx3REFBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJO2FBQ3ZDLENBQUM7WUFDRixNQUFNLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUNsQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBQyxNQUFNLFVBQUMsQ0FBQztpQkFDNUIsSUFBSSxDQUFDLGNBQUksWUFBSSxDQUFDLElBQUksRUFBRSxFQUFYLENBQVcsQ0FBQztpQkFDckIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ25CO0lBQ0gsQ0FBQztJQUVELHNDQUFpQixHQUFqQjtRQUFBLGlCQWFDO1FBWkMsSUFBTSxNQUFNLEdBQUcsbURBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN0QyxJQUFJLE1BQU0sQ0FBQyxNQUFNLEVBQUU7WUFDakIsTUFBTSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7WUFDdEIsTUFBTSxDQUFDLGFBQWEsR0FBRztnQkFDckIsSUFBSSxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLFdBQVc7Z0JBQ2pDLEdBQUcsRUFBRSxTQUFTLEdBQUksd0RBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSTthQUN2QyxDQUFDO1lBQ0YsTUFBTSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDcEMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUMsTUFBTSxVQUFDLENBQUM7aUJBQzVCLElBQUksQ0FBQyxjQUFJLFlBQUksQ0FBQyxJQUFJLEVBQUUsRUFBWCxDQUFXLENBQUM7aUJBQ3JCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUNuQjtJQUNILENBQUM7SUFFRCwrQkFBVSxHQUFWLFVBQVcsZUFBZ0M7UUFDekMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLEVBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLEVBQUMsQ0FBQyxDQUFDO0lBQ3hHLENBQUM7SUFFRCxnQ0FBVyxHQUFYO1FBQ1Msa0RBQWdCLENBQWU7UUFDL0Isb0NBQU0sQ0FBcUI7UUFDbEMsTUFBTSxJQUFJLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxFQUFDLGdCQUFnQixFQUFFLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztRQUNsRyw2REFBNkQ7UUFDN0QsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sSUFBSSxNQUFNO1lBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUMzRCxDQUFDO0lBRUQsOEJBQVMsR0FBVCxVQUFVLE1BQWdDLEVBQUUsS0FBYTtRQUN2RCxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLHdHQUF3RztJQUN4SSxDQUFDO0lBRUQsOEJBQVMsR0FBVCxVQUFXLEVBQWlCO1FBQzFCLElBQUksRUFBRSxDQUFDLEtBQUssS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsT0FBTyxJQUFJLEVBQUUsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLFNBQVM7WUFDNUQsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3BCLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO2dCQUMxQyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQ2xCLE9BQU87YUFDUjtZQUNELElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNiO2FBQU0sSUFBSSxFQUFFLENBQUMsS0FBSyxLQUFLLEVBQUUsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDcEUsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25CLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUNyQjthQUFNLElBQUksRUFBRSxDQUFDLEtBQUssS0FBSyxFQUFFLEVBQUU7WUFDMUIsSUFBTSxVQUFVLEdBQUcsRUFBRSxDQUFDLE1BQXFCLENBQUM7WUFDNUMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDO2dCQUN4QyxVQUFVLENBQUMsT0FBTyxLQUFLLFVBQVU7Z0JBQ2pDLFVBQVUsQ0FBQyxPQUFPLEtBQUssT0FBTztnQkFDOUIsVUFBVSxDQUFDLE9BQU8sS0FBSyxRQUFRO2dCQUMvQixVQUFVLENBQUMsT0FBTyxLQUFLLFFBQVE7Z0JBQy9CLENBQUMsVUFBVSxDQUFDLGVBQWUsRUFDN0I7Z0JBQ0UsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO2FBQ25CO1NBQ0Y7SUFDSCxDQUFDO0lBRUQsaUNBQVksR0FBWixVQUFhLEVBQVM7UUFDcEIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUU7WUFDdkUsSUFBSSxDQUFDLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLEVBQUU7Z0JBQzNELEVBQUUsQ0FBQyxXQUFXLEdBQUcsd0JBQXdCLENBQUM7Z0JBQzFDLE9BQU8sRUFBRSxDQUFDLFdBQVcsQ0FBQzthQUN2QjtTQUNGO0lBQ0gsQ0FBQztJQUVELHlDQUFvQixHQUFwQixVQUFxQixFQUFTO1FBQzVCLElBQUksRUFBRSxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUUsR0FBRSxFQUFFLENBQUMsTUFBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxLQUFLLEdBQUcsRUFBRTtZQUN0RSxJQUFNLENBQUMsR0FBc0IsRUFBRSxDQUFDLE1BQTJCLENBQUM7WUFDNUQsSUFBSSxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRTtnQkFDekQsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUU7b0JBQ3ZFLElBQUksQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsRUFBRTt3QkFDdEMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO3dCQUNwQixFQUFFLENBQUMsZUFBZSxFQUFFLENBQUM7d0JBQ3JCLE9BQU8sS0FBSyxDQUFDO3FCQUNkO2lCQUNGO2FBQ0Y7U0FDRjtJQUNILENBQUM7SUFFRCwrQkFBVSxHQUFWO1FBQ0UsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7WUFDMUMsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGdCQUFnQixDQUFDLE1BQU0sR0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGtHQUFrRztZQUNySyxNQUFNLElBQUksTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQ3pCO0lBQ0gsQ0FBQztJQUVELDJCQUFNLEdBQU47UUFBQSxpQkFtREM7UUFsREMsSUFBTSxPQUFPLEdBQUcsd0RBQUcsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDNUQsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7UUFDakMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyw2REFBSyxLQUFLLEVBQUUsRUFBQyxPQUFPLEVBQUUsQ0FBQyxFQUFDO1lBQ2xELG9EQUFDLDJEQUFZLElBQ1gsS0FBSyxFQUFDLEVBQUUsRUFDUixVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQzNCLE1BQU0sRUFBRSxFQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBQyxHQUMxQztZQUFBO2dCQUFHLG9EQUFDLGdFQUFPLE9BQUU7eURBQXFDLENBQzlDLENBQUMsQ0FBQztZQUNSLDZEQUFLLEtBQUssRUFBRSxFQUFDLE9BQU8sRUFBRSxDQUFDLEVBQUM7Z0JBQ3hCLG9EQUFDLDJEQUFZLElBQ1gsS0FBSyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUNoRCxVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQzNCLE1BQU0sRUFBRTt3QkFDTixXQUFXLEVBQUUsbUZBQTBCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUUsRUFBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUMsQ0FBQzt3QkFDNUYsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVztxQkFDakMsRUFDRCxJQUFJLEVBQUUsSUFBSSxFQUNWLE1BQU0sRUFBRSxNQUFNLEVBQ2QsVUFBVSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUNqQyxlQUFlLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBRyxJQUFJLFVBQUcsQ0FBQyxFQUFFLEtBQUssTUFBTSxDQUFDLE9BQU8sRUFBekIsQ0FBeUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFHLElBQUUsVUFBRyxDQUFDLEdBQUcsRUFBUCxDQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFDNUYsVUFBVSxFQUFFLE1BQU0sQ0FBQyxVQUFVLEdBQzVCO2dCQUNILDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7b0JBQy9CLDZEQUFLLFNBQVMsRUFBQyx1Q0FBdUM7d0JBQ3BELDZEQUFLLFNBQVMsRUFBQyx1REFBdUQ7NEJBQ3BFLDZEQUFLLFNBQVMsRUFBQyx1REFBdUQsRUFBQyxHQUFHLEVBQ3hFLGFBQUcsSUFBSSxZQUFJLENBQUMsVUFBVSxHQUFHLEdBQUcsRUFBckIsQ0FBcUI7Z0NBQzVCLG9EQUFDLGtFQUFlLElBQ2QsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUN6QixVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQ2pDLElBQUksRUFBRSxJQUFJLEdBQUk7Z0NBQ2hCLCtEQUFLO2dDQUNKLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBa0IsRUFBRSxDQUFDO3dDQUFwQix3QkFBUyxFQUFFLGdCQUFLO29DQUNqRCxPQUFPLDZEQUFLLEdBQUcsRUFBRSxDQUFDO3dDQUNoQiw2REFBSyxTQUFTLEVBQUMsUUFBUSxHQUNqQjt3Q0FDTiw2REFBSyxTQUFTLEVBQUMsaUJBQWlCOzRDQUM5Qiw2REFBSyxTQUFTLEVBQUMsWUFBWTtnREFDekIsb0RBQUMsU0FBUyxtREFBQyxHQUFHLEVBQUUsZ0JBQU0sSUFBRSxZQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBekIsQ0FBeUIsSUFBTSxLQUFLLEVBQUk7Z0RBQ2hFLG9EQUFDLHVFQUFVLElBQUMsT0FBTyxFQUFFLGNBQUksWUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFsQixDQUFrQixHQUFJLENBQzNDLENBQ0YsQ0FDRjtnQ0FDUixDQUFDLENBQUMsQ0FDRSxDQUNGLENBQ0YsQ0FDRixDQUNGO0lBQ1IsQ0FBQztJQUNILGlCQUFDO0FBQUQsQ0FBQyxDQXZrQitCLCtDQUFlLEdBdWtCOUM7Ozs7Ozs7Ozs7Ozs7OztBQ2xvQkQ7QUFBQTtBQUFBO0FBQUE7QUFBMkM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBWjtBQUVpRDtBQUM1QztBQUNvQjtBQUNTO0FBRTZEO0FBQzdFO0FBQ0c7QUFDMEI7QUFDMUI7QUFDd0I7QUFDWDtBQUNTO0FBQ007QUFFakI7QUFDSjtBQUNlO0FBQ0g7QUFDMUI7QUFNNUMsQ0FBQztBQU1GO0lBQXFDLHlFQUE0QjtJQUcvRCx5QkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBSWI7UUFIQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsY0FBYyxFQUFFLEtBQUs7U0FDdEIsQ0FBQzs7SUFDSixDQUFDO0lBRUQscUNBQVcsR0FBWCxVQUFZLFFBQWdCO1FBQ2xCLDhCQUFNLENBQWdCO1FBQzlCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFO1NBRXBCO0lBQ0gsQ0FBQztJQUVELGdDQUFNLEdBQU47UUFDUSxtQkFBeUMsRUFBdkMsa0JBQU0sRUFBRSwwQkFBVSxFQUFFLGNBQW1CLENBQUM7UUFDaEQsSUFBTSw4QkFBOEIsR0FBRyx5RkFBaUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNqRixJQUFNLHNCQUFzQixHQUFHLCtFQUF1QixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQy9ELElBQU0sbUJBQW1CLEdBQUcsbUVBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNoRCxJQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFHLElBQUksVUFBRyxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsT0FBTyxFQUF6QixDQUF5QixDQUFDLENBQUM7UUFDekUsSUFBTSxvQkFBb0IsR0FBRyxXQUFXLElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDaEYsSUFBTSxnQkFBZ0IsR0FBRyxXQUFXLElBQUksV0FBVyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDOUYsSUFBTSxjQUFjLEdBQUcseUVBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDakQsSUFBTSxXQUFXLEdBQUcsNkVBQWMsRUFBRSxDQUFDO1FBQ3JDLElBQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsY0FBSSxJQUFJLFdBQUksQ0FBQyxLQUFLLEtBQUssV0FBVyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsTUFBTSxLQUFLLE1BQU0sRUFBekQsQ0FBeUQsQ0FBQyxDQUFDO1FBQ3pHLElBQU0sa0JBQWtCLEdBQUcsbURBQVEsQ0FBQyxXQUFXLENBQUM7UUFFaEQsT0FBTyw2REFBSyxTQUFTLEVBQUMsaUNBQWlDO1lBQ3JELDZEQUFLLFNBQVMsRUFBRSxzQ0FBc0M7Z0JBQ3BELDZEQUFLLFNBQVMsRUFBQywyQ0FBMkM7b0JBQ3ZELE1BQU0sQ0FBQyxVQUFVLElBQUksMkVBQWlCO29CQUN2Qyx3RkFBeUI7b0JBRXpCLG9EQUFDLGdGQUFZLElBQUMsS0FBSyxFQUFFLHVGQUF1QixFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLENBQUMsbURBQVEsQ0FBQyxlQUFlO3dCQUN0Ryw2REFBSyxTQUFTLEVBQUMsV0FBVzs0QkFDeEI7Z0NBQ0UsK0VBQXFCO2dDQUNwQixvQkFBb0IsQ0FBQyxDQUFDO29DQUNyQiw2VkFDeUc7b0NBQ3hHLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsK1dBR2pCLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7d0NBQUssa0VBQ3pCLEtBQUssRUFBRSxXQUFXLENBQUMsR0FBRyxFQUN0QixLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUMsRUFDdEMsUUFBUSxFQUFFLFlBQUUsSUFBRSw0RUFBYyxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQXpELENBQXlELEdBQUc7d0NBQzFFLGdVQUNvSixDQUNoSixDQUFDLENBQUM7d0NBQ04sdU5BQ29HO2dDQUN4RywrREFBSyxDQUNEOzRCQUVMLENBQUMsTUFBTSxDQUFDLFVBQVUsSUFBSTtnQ0FDckIsOEVBQW9CO2dDQUNwQiwyREFBRyxTQUFTLEVBQUMsV0FBVyxnR0FBeUY7Z0NBQ2pILGtFQUFVLFNBQVMsRUFBQyw2QkFBNkIsRUFDL0MsS0FBSyxFQUFFLE1BQU0sQ0FBQyxXQUFXLEVBQ3pCLFFBQVEsRUFBRSxZQUFFLElBQUksV0FBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFdBQVcsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsRUFBdkQsQ0FBdUQsR0FBSTtnQ0FDN0UsK0RBQU0sQ0FDRjs0QkFFTjtnQ0FDRSwrRUFBcUI7Z0NBQ3JCLDJEQUFHLFNBQVMsRUFBQyxXQUFXLHlEQUFrRDtnQ0FDMUUsb0RBQUMsMEVBQU8sSUFDTixJQUFJLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFDdEIsY0FBYyxFQUFFLCtFQUFlLEVBQy9CLE9BQU8sRUFBRTt3Q0FDUCxNQUFNO3dDQUNOLFFBQVE7d0NBQ1IsV0FBVzt3Q0FDWCxlQUFlO3dDQUNmLFVBQVU7d0NBQ1YsVUFBVTt3Q0FDVixPQUFPO3dDQUNQLE9BQU87d0NBQ1AsTUFBTTt3Q0FDTixNQUFNO3dDQUNOLE9BQU87cUNBQUMsRUFDVixRQUFRLEVBQUUsaUJBQU8sSUFBSSxXQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBQyxFQUFDLENBQUMsRUFBMUMsQ0FBMEMsR0FBSTtnQ0FDckUsK0RBQU0sQ0FDRjs0QkFFTiwrRUFBcUI7NEJBQ3JCLDJEQUFHLFNBQVMsRUFBQyxXQUFXLHdEQUFpRDs0QkFDekUsb0RBQUMsMkZBQW9CLElBQ25CLFNBQVMsRUFBRSxNQUFNLENBQUMsU0FBUyxFQUMzQixRQUFRLEVBQUUsMEJBQWdCLElBQUksV0FBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFNBQVMsRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLEVBQTVDLENBQTRDLEVBQzFFLElBQUksRUFBRSxJQUFJLEdBQUk7NEJBQ2hCLCtEQUFNOzRCQUNOLGtGQUFtQjs0QkFDbkIsMkRBQUcsU0FBUyxFQUFDLFdBQVcsaUVBQWdEOzRCQUN4RSxvREFBQyw0RkFBb0IsSUFDbkIsR0FBRyxFQUFFLE1BQU0sQ0FBQyxZQUFZLEVBQ3hCLFFBQVEsRUFBRSxpQkFBTyxJQUFJLFdBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxZQUFZLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBdEMsQ0FBc0MsRUFDM0QsSUFBSSxFQUFFLElBQUksR0FBSTs0QkFDaEIsK0RBQU07NEJBQ0wsQ0FBQyxNQUFNLENBQUMsVUFBVSxJQUFJO2dDQUNyQixtRkFBeUI7Z0NBQ3hCLGtCQUFrQixDQUFDLENBQUMsQ0FBQyw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29DQUNyRCw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dDQUNqQyw2REFDRSxTQUFTLEVBQUUsVUFBVSxHQUFHLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUN6RSxPQUFPLEVBQUUsY0FBUSxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsc0JBQXNCLEVBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsc0JBQXNCLEVBQUUsRUFBRSxDQUFDLEVBQUMsQ0FBQyxHQUFJLENBQ3RHO29DQUNOLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IscUNBRTdCLENBQ0Y7b0NBQ04sQ0FBQzt3Q0FDRCw2REFBSyxTQUFTLEVBQUMseUJBQXlCOzRDQUN0Qyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO2dEQUNqQywrREFDRSxXQUFXLEVBQUMsc0JBQXNCLEVBQ2xDLElBQUksRUFBQyxNQUFNLEVBQ1gsSUFBSSxFQUFFLEVBQUUsRUFDUixLQUFLLEVBQUUsTUFBTSxDQUFDLGtCQUFrQixFQUNoQyxRQUFRLEVBQUUsWUFBRSxJQUFJLFdBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxrQkFBa0IsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsRUFBOUQsQ0FBOEQsR0FBSSxDQUNoRjs0Q0FDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO2dEQUNqQywrREFDRSxXQUFXLEVBQUMsS0FBSyxFQUNqQixJQUFJLEVBQUMsTUFBTSxFQUNYLElBQUksRUFBRSxDQUFDLEVBQ1AsS0FBSyxFQUFFLE1BQU0sQ0FBQyxtQkFBbUIsRUFDakMsUUFBUSxFQUFFLFlBQUUsSUFBSSxXQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsbUJBQW1CLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEVBQS9ELENBQStELEdBQUksQ0FDakYsQ0FDRixDQUVGOzRCQUVMLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0NBQzFCLG9EQUFDLHlGQUFtQixJQUNsQixNQUFNLEVBQUUsTUFBTSxDQUFDLE1BQU0sRUFDckIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxtQkFBbUIsRUFDcEMsUUFBUSxFQUFFLHdCQUFjO3dDQUN0QixJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUMsbUJBQW1CLEVBQUUsRUFBQyxJQUFJLEVBQUUsY0FBYyxFQUFDLEVBQUMsQ0FBQyxDQUFDO29DQUM3RCxDQUFDLEdBQUk7Z0NBQ1AsK0RBQUs7Z0NBQ0osa0JBQWtCLElBQUksNkRBQUssU0FBUyxFQUFDLG9CQUFvQjtvQ0FDeEQsZ0VBQUssdURBQUMsdUlBQWUsS0FBTTtvQ0FDM0Isb0RBQUMsb0VBQU8sSUFDTixRQUFRLEVBQUUsb0RBQUMsK0RBQU8sT0FBRyxFQUNyQixhQUFhLEVBQUUsdURBQUMscU1BQXlDO3dDQUV6RCxvREFBQyxzRkFBaUIsSUFDaEIsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNLEVBQ3JCLFVBQVUsRUFBRSxNQUFNLENBQUMsSUFBSSxFQUN2QixtQkFBbUIsRUFBRSxNQUFNLENBQUMsV0FBVyxJQUFJLEVBQUUsRUFDN0MsUUFBUSxFQUFFLHFCQUFXLElBQUksV0FBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFdBQVcsRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsRUFBRSxDQUFDLEVBQW5ELENBQW1ELEdBQUksQ0FFMUUsQ0FDTixDQUVMLENBeUJDLENBQ1M7b0JBQ2YsNkRBQUssU0FBUyxFQUFDLDRCQUE0Qjt3QkFDekMsNkRBQUssRUFBRSxFQUFDLGdCQUFnQixHQUNsQjt3QkFDTixrRkFBd0I7d0JBQ3hCLCtEQUFNLENBQ0Y7b0JBQ04sb0RBQUMsb0VBQWdCLElBQ2YsSUFBSSxFQUFFLElBQUksRUFDVixNQUFNLEVBQUUsTUFBTSxFQUNkLHNCQUFzQixFQUFFLHNCQUFzQixHQUFJO29CQUVwRDt3QkFDRSwrREFBSzt3QkFDTCxvREFBQyx3RkFBa0IsSUFBQyxNQUFNLEVBQUUsTUFBTSxHQUFHLENBQ2pDO29CQUVOLDZEQUFLLFNBQVMsRUFBQyw0QkFBNEI7d0JBQ3pDLGlGQUF1Qjt3QkFDdkIsK0RBQU07d0JBQ0wsTUFBTSxDQUFDLFNBQVMsSUFBSSxNQUFNLENBQUMsV0FBVyxJQUFJOzs0QkFDeEIsdURBQVEsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDOzs0QkFBSyxvRUFBUyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBVTtnQ0FDeEY7d0JBQ0gsTUFBTSxDQUFDLFVBQVUsSUFBSSxNQUFNLENBQUMsWUFBWSxJQUFJOzs0QkFDaEIsdURBQVEsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDOzs0QkFBSyxvRUFBUyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBVTtnQ0FDcEc7d0JBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7OzRCQUNMLDRFQUFzQjs7NEJBQVEsdURBQVEsQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDOzs0QkFBSyxvRUFBUyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBVTtnQ0FDbkgsQ0FBQyxDQUFDLENBQUM7OzRCQUNPLDhFQUF3Qjs0QkFBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQzs7Z0NBQ2pELHVEQUFRLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQzs7Z0NBQUssb0VBQVMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQVU7b0NBQVEsQ0FBQyxDQUFDLENBQUMsc0VBQWMsQ0FFakg7d0JBQ0wsQ0FBQyw4QkFBOEIsQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUM7NEJBQzdDLDJEQUFHLFNBQVMsRUFBQyxhQUFhLCtFQUFtRSxDQUFDLENBQUM7NEJBQy9GLDZEQUFLLFNBQVMsRUFBQyx1QkFBdUI7Z0NBQUMsNkRBQUssU0FBUyxFQUFDLGFBQWE7b0NBQ2pFLDJEQUFHLFNBQVMsRUFBQyw0QkFBNEIsaUJBQWEsTUFBTSxHQUFLLENBQzdEO2dDQUFBLGdKQUEyRSxDQUMzRSxDQUFDO3dCQUNSLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxpQkFBTyxJQUFJLG9FQUFLLEdBQUcsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFDLHVCQUF1Qjs0QkFBQyw2REFBSyxTQUFTLEVBQUMsYUFBYTtnQ0FDakgsMkRBQUcsU0FBUyxFQUFDLDRCQUE0QixpQkFBYSxNQUFNLEdBQUssQ0FDN0Q7NEJBQUEsK0RBQUksT0FBTyxDQUFLLENBQU0sRUFGTSxDQUVOLENBQUM7d0JBQy9CLCtEQUFNO3dCQUNMLFNBQVMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLDZEQUNoRCxTQUFTLEVBQUMsc0NBQXNDLEVBQ2hELE9BQU8sRUFBRTtnQ0FDUCxJQUFJLE9BQU8sQ0FBQyx1REFBQyx3UkFBbUMsRUFBVyxLQUFNLEVBQWtCLHFCQUFnQixFQUFhLG1FQUFxRCxLQUFySCxNQUFNLENBQUMsSUFBSSxFQUFNLE1BQU0sQ0FBQyxXQUFXLEVBQWdCLE1BQU0sQ0FBQyxNQUFNLEVBQXNEO29DQUNwSyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsS0FBSyxDQUFDLHVEQUFTLENBQUMsQ0FBQzs0QkFDekMsQ0FBQyxtQkFDZ0IsRUFBQyw4REFDbEIsU0FBUyxFQUFDLHNDQUFzQyxFQUNoRCxPQUFPLEVBQUUsY0FBSSxjQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQWQsQ0FBYyxhQUVyQixDQUFDO3dCQUNULDZEQUFLLFNBQVMsRUFBQyxlQUFlLEVBQUMsT0FBTyxFQUFFLGNBQU0sV0FBSSxDQUFDLGtCQUFrQixFQUFFLEVBQXpCLENBQXlCLFlBRWpFO3dCQUNMLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQzs0QkFDZCw2REFBSyxTQUFTLEVBQUMsd0JBQXdCLEVBQ3JDLE9BQU8sRUFBRSxjQUFNLFdBQUksQ0FBQyxpQkFBaUIsRUFBRSxFQUF4QixDQUF3QiwyQkFFbkMsQ0FBQyxDQUFDOzRCQUNSLDZEQUFLLFNBQVMsRUFBQyx3QkFBd0IsRUFDckMsT0FBTyxFQUFFLGNBQU0sV0FBSSxDQUFDLGVBQWUsRUFBRSxFQUF0QixDQUFzQix5QkFFakM7d0JBQ0wsTUFBTSxDQUFDLHNCQUFzQixJQUFJLGtCQUFrQjs0QkFDbEQsNkRBQUssU0FBUyxFQUFDLHNDQUFzQyxFQUFDLE9BQU8sRUFBRSxjQUFNLFdBQUksQ0FBQyx3QkFBd0IsRUFBRSxFQUEvQixDQUErQjtnQ0FDakcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxvREFBQywrREFBTyxPQUFHLENBQUMsQ0FBQztvQ0FDdEMsQ0FBQyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO3dDQUFNLDJEQUFHLFNBQVMsRUFBQyxjQUFjLGlCQUFhLE1BQU0sR0FBSyxDQUFPLEVBQUMsQ0FBQzt3Q0FBTSwyREFBRyxTQUFTLEVBQUMsb0JBQW9CLEdBQUssQ0FBTyxDQUFDOzBEQUVsSixDQUVKLENBQ0YsQ0FDRjtZQUNOLDZEQUFLLFNBQVMsRUFBQyx1QkFBdUI7Z0JBQ3BDLG9EQUFDLDRFQUFhLE9BQUcsQ0FDYixDQUNGO0lBQ1IsQ0FBQztJQUNILHNCQUFDO0FBQUQsQ0FBQyxDQTNRb0MsK0NBQWUsR0EyUW5EOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1UzhCO0FBQ087QUFDeUM7QUFDTDtBQUN0QztBQUNhO0FBQ1Q7QUFFeEMsUUFBUTtBQUMyQztBQUNaO0FBQ1k7QUFDSTtBQUNBO0FBR3ZELHFCQUFxQjtBQUM2QztBQUNsRSxtRkFBZ0IsRUFBRSxDQUFDO0FBVW5CO0lBQW1DLHVFQUE0QjtJQUM3RCx1QkFBWSxLQUFZO2VBQ3RCLGtCQUFNLEtBQUssQ0FBQztJQUNkLENBQUM7SUFFRCw4QkFBTSxHQUFOO1FBQUEsaUJBNkRDO1FBNURDLElBQU0sWUFBWSxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBSSxJQUFJLFdBQUksS0FBSyxPQUFPLElBQUksSUFBSSxLQUFLLFVBQVUsRUFBdkMsQ0FBdUMsQ0FBQyxDQUFDO1FBQ2pHLElBQU0sT0FBTyxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBSSxJQUFJLFdBQUksS0FBSyxPQUFPLEVBQWhCLENBQWdCLENBQUMsQ0FBQztRQUNyRSxPQUFPLDZEQUFLLFNBQVMsRUFBQyxnQkFBZ0I7WUFDcEMsb0RBQUMsMkRBQU0sUUFDSixZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUNkLG9EQUFDLHNEQUFLLElBQUMsS0FBSyxRQUFDLElBQUksRUFBQyxHQUFHLEVBQUMsTUFBTSxFQUFFLFVBQUMsRUFBUzs0QkFBUCxnQkFBSzt3QkFBTyxjQUFPLENBQUMsQ0FBQzs0QkFDcEQsb0RBQUMsZ0RBQU8sSUFBQyxhQUFhLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQUUsV0FBVyxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFJLENBQUMsQ0FBQzs0QkFDM0Ysb0RBQUMsb0VBQWUsSUFBQyxXQUFXLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUk7b0JBRmIsQ0FFYSxHQUFJO2dCQUM5RCxvREFBQyxzREFBSyxJQUFDLEtBQUssUUFBQyxJQUFJLEVBQUMsVUFBVSxFQUFDLE1BQU0sRUFBRSxVQUFDLEVBQVM7NEJBQVAsZ0JBQUs7d0JBQzNDLDJEQUFDLGdEQUFPLElBQ04sYUFBYSxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUN2QyxXQUFXLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUk7b0JBRnpDLENBRXlDLEdBQUk7Z0JBQy9DLG9EQUFDLHNEQUFLLElBQUMsS0FBSyxRQUFDLElBQUksRUFBQyx3QkFBd0IsRUFBQyxNQUFNLEVBQUUsY0FBSSwyREFBQyw2REFBUyxJQUFDLElBQUksRUFBQyxXQUFXLEVBQUMsV0FBVyxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFJLEVBQW5FLENBQW1FLEdBQUk7Z0JBQzlILG9EQUFDLHNEQUFLLElBQUMsS0FBSyxRQUFDLElBQUksRUFBQyxzQkFBc0IsRUFBQyxNQUFNLEVBQUUsY0FBSSwyREFBQyw2REFBUyxJQUFDLElBQUksRUFBQyxTQUFTLEVBQUMsV0FBVyxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFJLEVBQWpFLENBQWlFLEdBQUk7Z0JBQzFILG9EQUFDLHNEQUFLLElBQUMsS0FBSyxRQUFDLElBQUksRUFBQyxtQkFBbUIsRUFBQyxNQUFNLEVBQUUsVUFBQyxFQUFTOzRCQUFQLGdCQUFLO3dCQUFPLDJEQUFDLGdFQUFVLElBQ3RFLEVBQUUsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFDbkIsS0FBSyxFQUFFLHNEQUFDLHVJQUFlLE1BQ3ZCLFdBQVcsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBSTtvQkFIb0IsQ0FHcEIsR0FBSTtnQkFDN0Msb0RBQUMsc0RBQUssSUFBQyxLQUFLLFFBQUMsSUFBSSxFQUFDLFdBQVcsRUFBQyxNQUFNLEVBQUUsY0FBSSwyREFBQyxrREFBUSxJQUFDLFdBQVcsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBSSxFQUFqRCxDQUFpRCxHQUFJO2dCQUMvRixvREFBQyxzREFBSyxJQUFDLElBQUksRUFBQyxlQUFlLEVBQUMsTUFBTSxFQUFFLFVBQUMsRUFBUzs0QkFBUCxnQkFBSzt3QkFBTywyREFBQyxxREFBVyxJQUM3RCxFQUFFLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQ25CLFdBQVcsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FBSTtvQkFGVSxDQUVWLEdBQUk7Z0JBQzdDLG9EQUFDLHNEQUFLLElBQUMsS0FBSyxRQUFDLElBQUksRUFBQyxjQUFjLEVBQUMsTUFBTSxFQUFFLGNBQUssMkRBQUMsb0VBQWUsSUFDOUQsV0FBVyxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxHQUFJLEVBRE8sQ0FDUCxHQUFJO2dCQUMzQyxvREFBQyxzREFBSyxJQUFDLElBQUksRUFBQywyQ0FBMkMsRUFBQyxNQUFNLEVBQUUsVUFBQyxFQUFPOzRCQUFOLGdCQUFLO3dCQUFNLDJEQUFDLG1EQUFVLElBQ3RGLFVBQVUsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFDbkMsSUFBSSxFQUFDLGVBQWUsRUFDcEIsYUFBYSxFQUFFLEtBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUN2QyxXQUFXLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQ25DO29CQUwyRSxDQUszRSxHQUFHO2dCQUNMLG9EQUFDLHNEQUFLLElBQUMsSUFBSSxFQUFDLG1CQUFtQixFQUFDLE1BQU0sRUFBRSxVQUFDLEVBQU87NEJBQU4sZ0JBQUs7d0JBQU0sMkRBQUMsbURBQVUsSUFDOUQsRUFBRSxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUNuQixJQUFJLEVBQUMsZUFBZSxFQUNwQixhQUFhLEVBQUUsS0FBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQ3ZDLFdBQVcsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsR0FDbkM7b0JBTG1ELENBS25ELEdBQUksQ0FDRixDQUFDLENBQUMsQ0FBQztnQkFDTCxvREFBQyxzREFBSyxJQUFDLElBQUksRUFBQyxHQUFHLEVBQUMsTUFBTSxFQUFFLGNBQU07d0JBQzVCLG9EQUFDLG9FQUFZLElBQUMsS0FBSyxFQUFDLGNBQWMsRUFBQyxVQUFVLEVBQUMsZUFBZSxFQUFDLE1BQU0sRUFBRSxFQUFDLFFBQVEsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFBQyxHQUFJO3dCQUM1Ryx5RkFBMEI7d0JBQzFCLG1KQUFvRTt3QkFDcEUsd0ZBQXlCO3dCQUN6QiwrREFBTyxTQUFTLEVBQUMsV0FBVyxFQUFDLEtBQUssRUFBRSxFQUFDLE1BQU0sRUFBRSxnQkFBZ0IsRUFBQzs0QkFDNUQ7Z0NBQ0U7b0NBQ0UsMkVBQWlCO29DQUNqQiw2RUFBYyxDQUNYLENBQ0M7NEJBQ1IsbUVBQ0csTUFBTSxDQUFDLElBQUksQ0FBQyx3REFBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFJLElBQUksbUVBQUksR0FBRyxFQUFFLElBQUk7Z0NBQ3JELGdFQUFLLElBQUksQ0FBTTtnQ0FDZixnRUFBSyx3REFBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBTSxDQUM3QixFQUhxQyxDQUdyQyxDQUFDLENBQ0EsQ0FBUSxDQUNkLEVBbEJ3QixDQWtCeEIsR0FBSSxDQUNOLENBQ0Q7WUFDVCxvREFBQyxrRkFBb0IsT0FBRyxDQUNwQjtJQUNSLENBQUM7SUFDSCxvQkFBQztBQUFELENBQUMsQ0FuRWtDLCtDQUFlLEdBbUVqRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy9GOEI7QUFDVTtBQUdMO0FBRUg7QUFXakM7SUFBa0Msc0VBQTRCO0lBQzVELHNCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FFYjtRQURDLEtBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLElBQUksRUFBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUMsQ0FBQzs7SUFDMUQsQ0FBQztJQUVELDJCQUFJLEdBQUo7UUFDRSxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQzVCLElBQUksQ0FBQyxnREFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDO1lBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxzREFBQyx1TkFBZ0IsRUFBWSw4RUFBb0UsS0FBaEYsUUFBUSxDQUFDLEdBQUcsRUFBcUUsQ0FBQztRQUN0SixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUM5QixDQUFDO0lBRUQsNkJBQU0sR0FBTjtRQUFBLGlCQStDQztRQTlDTyxtQkFBc0MsRUFBckMsZ0JBQUssRUFBRSxrQkFBTSxFQUFFLHNCQUFzQixDQUFDO1FBQzdDLElBQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDNUIsSUFBTSxVQUFVLEdBQUcsZ0RBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUVsRCxPQUFPO1lBQUssNkRBQUssU0FBUyxFQUFDLDJDQUEyQztnQkFDcEUsZ0VBQUssS0FBSyxDQUFNO2dCQUNoQiwrREFBTTtnQkFDTiw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29CQUMvQiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLFlBQVk7b0JBQy9DLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7d0JBQ2pDLCtEQUFPLElBQUksRUFBQyxNQUFNLEVBQUMsU0FBUyxRQUMxQixRQUFRLEVBQUUsQ0FBQyxFQUNYLElBQUksRUFBRSxFQUFFLEVBQ1IsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLEVBQ3BCLFFBQVEsRUFBRSxZQUFFLElBQUUsWUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFDLElBQUksRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBQyxDQUFDLEVBQXRDLENBQXNDLEdBQUksQ0FDdEQ7b0JBQ04sNkRBQUssU0FBUyxFQUFDLDJCQUEyQixHQUFPLENBQzdDO2dCQUNOLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7b0JBQy9CLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IsaUJBQVk7b0JBQy9DLDZEQUFLLFNBQVMsRUFBQyxxQkFBcUI7d0JBQ2xDLCtEQUFPLElBQUksRUFBQyxNQUFNLEVBQ2hCLFFBQVEsRUFBRSxDQUFDLEVBQ1gsSUFBSSxFQUFFLEVBQUUsRUFDUixLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsRUFDbkIsUUFBUSxFQUFFLFlBQUUsSUFBRSxZQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFDLENBQUMsRUFBckMsQ0FBcUMsR0FBSSxDQUNyRDtvQkFDTiw2REFBSyxTQUFTLEVBQUMsMkJBQTJCLEdBQU8sQ0FDN0M7Z0JBQ04sK0RBQU0sQ0FBTTtZQUNaLDZEQUFLLFNBQVMsRUFBQyw0QkFBNEI7Z0JBQ3hDLENBQUMsUUFBUSxDQUFDLFdBQVcsSUFBSSxRQUFRLENBQUMsWUFBWSxDQUFDLElBQUk7b0JBQ2pELFFBQVEsQ0FBQyxXQUFXLElBQUk7O3dCQUNHLHVEQUFRLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQzs7d0JBQUssb0VBQVMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQVU7NEJBQ3JHO29CQUNILFFBQVEsQ0FBQyxZQUFZLElBQUk7O3dCQUNZLHVEQUFRLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQzs7d0JBQUssb0VBQVMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQVU7NEJBQ2pIO29CQUNKLCtEQUFNO29CQUFBLCtEQUFLLENBQ1A7Z0JBQ0wsUUFBUSxJQUFJLDZEQUFLLFFBQVEsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFDLHNDQUFzQyxFQUFDLE9BQU8sRUFBRSxjQUFJLGVBQVEsRUFBRSxFQUFWLENBQVUsK0JBRWpHO2dCQUNOLDJEQUFHLFFBQVEsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLGVBQWUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsRUFBRSxPQUFPLEVBQUUsVUFBVSxJQUFJLENBQUMsY0FBTSxhQUFNLENBQUMsUUFBUSxDQUFDLEVBQWhCLENBQWdCLENBQUMsWUFBVyxDQUN4SSxDQUNGO0lBQ1IsQ0FBQztJQUNILG1CQUFDO0FBQUQsQ0FBQyxDQTVEaUMsK0NBQWUsR0E0RGhEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMxRThDO0FBQ25CO0FBQ0c7QUFDdUI7QUFDUTtBQUNQO0FBVWhELFNBQVMsdUJBQXVCLENBQUMsRUFNaEM7UUFMTixjQUFJLEVBQ0osa0JBQU0sRUFDTiw0QkFBVyxFQUNYLHNCQUFRLEVBQ1Isc0JBQVE7SUFFUixJQUFNLGdCQUFnQixHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUM7SUFDekMsT0FBTztRQUNMLGdHQUFpQztRQUNqQyw2REFBSyxTQUFTLEVBQUMseUJBQXlCO1lBQ3RDLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7Z0JBQ2pDLGtGQUF1QixDQUNuQjtZQUNOLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7Z0JBQ2pDLCtEQUFPLFNBQVMsUUFBQyxJQUFJLEVBQUMsTUFBTSxFQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLENBQUMsV0FBVyxFQUFFLFFBQVEsRUFBRSxDQUFDLFdBQVcsRUFBRSxRQUFRLEVBQUUsWUFBRTt3QkFDbkgsSUFBTSxPQUFPLEdBQUcsbURBQUssSUFBSSxDQUFFLENBQUM7d0JBQzVCLE9BQU8sQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7d0JBQy9CLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDO29CQUMvQyxDQUFDLEdBQUssQ0FDRixDQUNGO1FBQ04sNkRBQUssU0FBUyxFQUFDLHlCQUF5QjtZQUN0Qyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO2dCQUNqQyxzRUFBVyxDQUNQO1lBQ04sNkRBQUssU0FBUyxFQUFDLHFDQUFxQztnQkFDbEQsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjtvQkFDakMsK0RBQU8sU0FBUyxFQUFDLGdCQUFnQixFQUFDLElBQUksRUFBQyxNQUFNLEVBQUMsSUFBSSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxRQUFRLEVBQUUsQ0FBQyxXQUFXLEVBQUUsUUFBUSxFQUFFLENBQUMsV0FBVyxFQUFFLFFBQVEsRUFBRSxZQUFFOzRCQUNySSxJQUFNLE9BQU8sR0FBRyxtREFBSyxJQUFJLENBQUUsQ0FBQzs0QkFDNUIsT0FBTyxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQzs0QkFDOUIsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7d0JBQy9DLENBQUMsR0FBSyxDQUNBO2dCQUNOLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IsSUFDaEMsZ0JBQWdCLElBQUksb0RBQUMseURBQVcsSUFBQyxLQUFLLEVBQUMsRUFBRSxFQUFDLE1BQU0sRUFBRTt3QkFDakQsSUFBTSxNQUFNLEdBQUcsSUFBSSxnRUFBWSxDQUFDLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7d0JBRWxELE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsZUFBSzs0QkFDdEIsSUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQzs0QkFDN0IsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLE9BQU87NEJBQ3JFLElBQUksT0FBTyxJQUFJLElBQUksQ0FBQyxHQUFHO2dDQUFFLE9BQU87NEJBQ2hDLElBQU0sT0FBTyxHQUFHLG1EQUFLLElBQUksQ0FBRSxDQUFDOzRCQUM1QixPQUFPLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQzs0QkFDdEIsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxDQUFDLENBQUM7d0JBQy9DLENBQUMsQ0FBQyxDQUFDO29CQUNMLENBQUMsR0FBSSxDQUVELENBQ0YsQ0FDRjtRQUNMLElBQUksQ0FBQyxhQUFhLElBQUksV0FBVyxJQUFJLG9EQUFDLG9FQUFnQixJQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsVUFBQyxFQUFFLEVBQUUsWUFBWSxJQUFLLGVBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLFlBQVksQ0FBQyxFQUFyQyxDQUFxQyxHQUFJO1FBQy9KO1lBQUUseUZBQTBCO1lBQzFCLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7Z0JBQy9CLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7b0JBQ2pDLDZEQUFLLFNBQVMsRUFBRSxVQUFVLEdBQUcsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE9BQU8sRUFBRTs0QkFDNUYsUUFBUSxDQUFDLHlCQUF5QixDQUFDLFlBQVksRUFBRSxFQUFFLElBQUksRUFBRSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNsRyxDQUFDLEdBQUssQ0FDRjtnQkFDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO29CQUNqQywwSEFBZ0QsQ0FDNUMsQ0FDRjtZQUNMLFFBQVEsQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDLElBQUk7Z0JBQ3JDLHNGQUFzQjtnQkFDdEIsNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjt3QkFDakMsb0RBQUMsd0RBQWUsSUFBQyxvQkFBb0IsRUFBQyxFQUFFLEVBQUMsd0JBQXdCLEVBQUMsRUFBRSxFQUFDLGVBQWUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFFBQVEsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLElBQUksNkNBQU0sQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsVUFBVSxFQUFDLFlBQVksRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLGVBQWUsRUFBQyxjQUFjLEVBQUMsUUFBUSxFQUFFLGVBQUs7Z0NBQy9RLFFBQVEsQ0FBQyx5QkFBeUIsQ0FBQyxVQUFVLEVBQUUsRUFBRSxJQUFJLEVBQUUsNkNBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDOzRCQUMvRixDQUFDLEdBQUssQ0FDRjtvQkFDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLElBQ2hDLFFBQVEsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLElBQUksMkRBQUcsU0FBUyxFQUFDLFlBQVksRUFBQyxJQUFJLEVBQUMsR0FBRyxFQUFDLEtBQUssRUFBQyw4QkFBeUIsRUFBQyxPQUFPLEVBQUUsWUFBRTs0QkFDakgsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDOzRCQUNwQixRQUFRLENBQUMseUJBQXlCLENBQUMsVUFBVSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7d0JBQ2pFLENBQUMsR0FBTyxDQUNKLENBQ0Y7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLGVBQWU7b0JBQzVCLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7d0JBQy9CLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7NEJBQ2pDLDZEQUFLLFNBQVMsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUU7b0NBQ2hILGVBQVEsQ0FBQyx5QkFBeUIsQ0FBQyxjQUFjLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFlBQVksSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7Z0NBQXBILENBQW9ILEdBQ2hILENBQ0Y7d0JBQ04sNkRBQUssU0FBUyxFQUFDLG9CQUFvQjs0QkFDakMsZ0dBQXFDLENBQ2pDLENBQ0YsQ0FDRixDQUNMLENBQ0YsQ0FDQyxDQUFDO0FBQ1QsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUMvRzhCO0FBR2dCO0FBQ3lCO0FBQy9CO0FBRW1CO0FBQ2lCO0FBQzVDO0FBQ3NCO0FBQ1k7QUFHQTtBQUNyQjtBQUNTO0FBSVA7QUFDQztBQUNzQjtBQUNYO0FBQ0c7QUFDRztBQTRCbEU7SUFBOEIsa0VBQTZCO0lBU3pELGtCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0F1RGI7UUE5REQsY0FBUSxHQUFHLElBQUksbURBQVEsRUFBRSxDQUFDO1FBUXhCLElBQU0sV0FBVyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxzRUFBYyxDQUFDLHlEQUFHLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvRSxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDakIsV0FBVyxDQUFDLENBQUMsQ0FDWCxzREFBQyxtS0FBMEIsRUFBaUIsSUFBRyxLQUFwQixLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksRUFBSSxDQUFDLENBQ2pELHNEQUFDLDJKQUFzQixFQUFpQixJQUFHLEtBQXBCLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFHLENBQUMsQ0FBQztnQkFDL0MsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQ2hCLHNEQUFDLHlLQUF3QixFQUFpQixJQUFHLEtBQXBCLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFJLENBQUMsQ0FDL0Msc0RBQUMseUxBQWdDLEVBQWlCLElBQUcsS0FBcEIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUc7WUFDekQsbUJBQW1CLEVBQUUsS0FBSztZQUMxQixpQkFBaUIsRUFBRSxLQUFLLENBQUMsaUJBQWlCLElBQUksRUFBRTtZQUNoRCxJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLGtEQUlkLEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxRQUFRLElBQ2hDLEtBQUssQ0FBQyxJQUFJLEVBQ2IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUMzQixtRUFBbUU7Z0JBQ25FLHNDQUFzQztnQkFDdEM7b0JBQ0UsRUFBRSxFQUFFLG9FQUFVLEVBQUU7b0JBQ2hCLEtBQUssRUFBRSxLQUFLO29CQUNaLElBQUksRUFBRTt3QkFDSixTQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsV0FBYTt3QkFDakMsWUFBVSxLQUFLLENBQUMsTUFBTSxDQUFDLElBQU07cUJBQzlCO29CQUNELE1BQU0sRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxJQUFJLHlEQUFHLENBQUMsV0FBVyxDQUFDLE1BQU07b0JBQzFELFNBQVMsRUFBRSxFQUFFO29CQUNiLFNBQVMsRUFBRSxFQUFFO29CQUNiLGNBQWMsRUFBRSxFQUFFO29CQUNsQixlQUFlLEVBQUUsRUFBRTtvQkFDbkIscUJBQXFCLEVBQUUsRUFBRTtvQkFDekIsSUFBSSxFQUFFLEVBQUU7b0JBQ1IsR0FBRyxFQUFFLEVBQUU7b0JBQ1AsR0FBRyxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQzt3QkFDN0IsYUFBYSxnUUFBK1A7cUJBQzdRLENBQUMsQ0FBQyxDQUFDO3dCQUNBLGFBQWE7d0JBQ2IsZ0JBQWMseURBQUcsQ0FBQyxXQUFXLENBQUMsTUFBTSxnQkFBYTtxQkFDbEQ7aUJBQ0o7WUFDTCxlQUFlLEVBQUUsS0FBSyxDQUFDLFVBQVUsSUFBSSxFQUFFO1lBQ3ZDLFlBQVksRUFBRSxLQUFLLENBQUMsVUFBVSxJQUFJLEVBQUU7WUFDcEMsV0FBVyxFQUFFLEtBQUssQ0FBQyxVQUFVO1NBQzlCLENBQUM7UUFDRixJQUFJLEtBQUssQ0FBQyxVQUFVLEVBQUU7WUFDcEIsS0FBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLHFFQUFjLENBQUM7Z0JBQ3ZDLGdFQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFPLE9BQU8sRUFBRTtvQkFDdkMsSUFBSSxFQUFFLFlBQVUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFNO29CQUNuQyxPQUFPLEVBQUUsQ0FBQyx1QkFBdUIsRUFBRSxXQUFXLEVBQUUsZ0JBQWdCLENBQUM7b0JBQ2pFLEtBQUssRUFBRSxDQUFDLGdCQUFnQixDQUFDO2lCQUMxQixDQUFDO1lBSkYsQ0FJRSxDQUFDLENBQUM7U0FDUDs7SUFDSCxDQUFDO0lBNURELG1DQUFnQixHQUFoQixVQUFpQixLQUFxQjtRQUF0QyxpQkFFQztRQURDLE9BQU8sSUFBSSxPQUFPLENBQUMsaUJBQU8sSUFBSSx3QkFBTSxRQUFRLGFBQUMsY0FBTSxZQUFjLEVBQWQsQ0FBYyxFQUFFLE9BQU8sQ0FBQyxFQUE3QyxDQUE2QyxDQUFDLENBQUM7SUFDL0UsQ0FBQztJQTRESyxvQ0FBaUIsR0FBdkI7Ozs7Ozs2QkFDTSxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBckIsd0JBQXFCO3dCQUN2QixJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQzs7Ozt3QkFFM0MscUJBQU0sSUFBSSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUU7O3dCQUFqQyxTQUFpQyxDQUFDOzZCQUM5QixLQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxHQUFyRSx3QkFBcUU7d0JBQ3ZFLHFCQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQzs7d0JBQXpELFNBQXlELENBQUM7Ozs7O3dCQUc1RCw4REFBUyxDQUFDLEtBQUcsQ0FBQyxDQUFDOzs0QkFFZixxQkFBTSxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLENBQUM7O3dCQUFuRCxTQUFtRCxDQUFDOzs7Ozs7S0FHekQ7SUFFSyx3Q0FBcUIsR0FBM0IsVUFBNEIsZUFBeUI7Ozs7Ozt3QkFDN0MsZUFBZSxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsZUFBZSxtQkFBRSxrQkFBa0IsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDOzZCQUNyRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUEzQix3QkFBMkI7d0JBQzdCLHFCQUFNLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTzs7d0JBQWpDLFNBQWlDLENBQUM7d0JBQ2xDLGtGQUFrRjt3QkFDbEYsbUJBQW1CO3dCQUNuQixxQkFBTSxlQUFlOzt3QkFGckIsa0ZBQWtGO3dCQUNsRixtQkFBbUI7d0JBQ25CLFNBQXFCLENBQUMsQ0FBQyx5Q0FBeUM7d0JBQ2hFLGVBQWUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQzs7NEJBRS9DLHFCQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxlQUFlLENBQUM7O3dCQUE5QyxTQUE4QyxDQUFDOzs7OztLQUNoRDtJQUVLLHFDQUFrQixHQUF4QixVQUF5QixlQUF5Qjs7Ozs7NEJBQ3JCLHFCQUFNLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFOzt3QkFBdEQsa0JBQWtCLEdBQUcsU0FBaUM7d0JBRXRELFlBQVksR0FBRyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsV0FBQzs0QkFDOUMsc0JBQWUsQ0FBQyxLQUFLLENBQUMsWUFBRTtnQ0FDdEIsUUFBQyxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVosQ0FBWSxDQUFDO29DQUNoRCxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDO29DQUNsQyxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDOzRCQUZ2QyxDQUV1QyxDQUFDO3dCQUgxQyxDQUcwQyxDQUFDLENBQUM7d0JBRTlDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQzs0QkFDcEIsWUFBWTt5QkFDYixDQUFDLENBQUM7Ozs7O0tBQ0o7SUFFRCxnQ0FBYSxHQUFiLFVBQWMsRUFBVSxFQUFFLFFBQWlCO1FBQ2pDLHNDQUFVLENBQWdCO1FBQ2xDLElBQUksVUFBVSxFQUFFO1lBQ04sZ0RBQWUsQ0FBZ0I7WUFDdkMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUNuQyxlQUFlLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQzVCLGVBQWUsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsS0FBSyxFQUFFLEVBQVIsQ0FBUSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsc0RBQVMsQ0FBQyxDQUFDO1lBQzFELE9BQU87U0FDUjtRQUNELElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRCw2QkFBVSxHQUFWLFVBQVcsRUFBVSxFQUFFLFlBQXFCO1FBQ2xDLDhCQUFNLENBQWdCO1FBQ3RCLDBCQUFJLENBQWdCO1FBQzVCLDRDQUE0QztRQUM1QyxJQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDLENBQUM7UUFDeEQsSUFBTSxvQkFBb0IsR0FBRyxNQUFNLENBQUMscUJBQXFCLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBWCxDQUFXLENBQUMsQ0FBQztRQUNqRixJQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVosQ0FBWSxDQUFDLENBQUM7UUFFaEU7Ozs7OztvQ0FPYyxFQVBiLHNCQUFjLEVBQUUsWUFPSCxDQUFDO1FBRXJCLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDbkIsT0FBTyxDQUFDLEtBQUssQ0FBQywyQkFBMkIsR0FBRyxFQUFFLENBQUMsQ0FBQztZQUNoRCxPQUFPO1NBQ1I7UUFFRCxJQUFNLGlCQUFpQixHQUFlLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNuRSxJQUFNLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsYUFBRyxJQUFJLFVBQUcsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFiLENBQWEsQ0FBQyxDQUFDO1FBQ3JFLElBQUksWUFBWSxFQUFFO1lBQ2hCLElBQUksVUFBVSxHQUFHLENBQUMsRUFBRTtnQkFDbEIsaUJBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO2FBQzlCO1NBQ0Y7YUFBTTtZQUNMLElBQUksVUFBVSxJQUFJLENBQUMsRUFBRTtnQkFDbkIsaUJBQWlCLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQzthQUN6QztTQUNGO1FBRUQsSUFBTSxXQUFXLEdBQUcsbURBQUssSUFBSSxDQUFFLENBQUM7UUFDaEMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxHQUFHLGlCQUFpQixDQUFDO1FBRWhELGlDQUFpQztRQUNqQyxvQkFBb0I7UUFDcEIsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLGFBQWEsRUFBRTtZQUM5QixXQUFXLENBQUMsYUFBYSxHQUFHLG1EQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNwRCxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLEVBQUU7Z0JBQ3RDLFdBQVcsQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLEdBQUcsbURBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO2dCQUNwRix1Q0FBdUM7Z0JBQ3ZDLE9BQU8sV0FBVyxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUN0RDtTQUNGO1FBRUQsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1lBQ3BCLElBQUksRUFBRSxXQUFXO1NBQ2xCLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFSyx1QkFBSSxHQUFWOzs7Ozs7d0JBQ1EsS0FBOEIsSUFBSSxDQUFDLEtBQUssRUFBdEMsSUFBSSxZQUFFLGlCQUFpQix3QkFBZ0I7d0JBQ3pDLFdBQVcsR0FBRyxzRUFBYyxDQUFDLHlEQUFHLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDOzZCQUN0RCxXQUFXLEVBQVgsd0JBQVc7d0JBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTzs0QkFDNUIsTUFBTSxJQUFJLEtBQUssQ0FBQyxzREFBQywyT0FBdUQsS0FBQyxDQUFDO3dCQUM1RSxJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxnREFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDOzRCQUN2QyxNQUFNLElBQUksS0FBSyxDQUFDLHNEQUFDLHVNQUFnQixFQUFRLDhEQUFvRCxLQUE1RCxJQUFJLENBQUMsR0FBRyxFQUFxRCxDQUFDOzZCQUM3RixLQUFJLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLEVBQUUsR0FBakQsd0JBQWlEO3dCQUNuRCxrQ0FBa0M7d0JBQ2xDLHFCQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7O3dCQURwRCxrQ0FBa0M7d0JBQ2xDLFNBQW9ELENBQUM7OztvQkFFckQsdUJBQXVCO29CQUN2QixxQkFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDOzt3QkFEbkMsdUJBQXVCO3dCQUN2QixTQUFtQyxDQUFDOzs7OzZCQUU3QixJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBckIsd0JBQXFCO3dCQUM5QixxQkFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsaUJBQWlCLENBQUM7O3dCQUFoRCxTQUFnRCxDQUFDOzs7d0JBRWpELElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssS0FBSzs0QkFDdEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxzREFBQyxxUkFBNEUsS0FBQyxDQUFDO3dCQUVqRyxxQkFBTSxJQUFJLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLGlCQUFpQixDQUFDOzt3QkFBdkQsU0FBdUQsQ0FBQzs7Ozs7O0tBRTNEO0lBRUssMkJBQVEsR0FBZDs7Ozs7O3dCQUNRLFFBQVEsR0FBRyxtREFDWixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFDZixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsaUJBQWlCLElBQUksRUFBRSxDQUFDLElBQ3ZDLEVBQUUsRUFBRSxvRUFBVSxFQUFFLEVBQ2hCLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dDQUNsQyxhQUFhLENBQUMsa1FBQWtROzZCQUNqUixDQUFDLENBQUMsQ0FBQztnQ0FDRixhQUFhO2dDQUNiLGdCQUFjLHlEQUFHLENBQUMsV0FBVyxDQUFDLE1BQU0sZ0JBQWE7NkJBQ2xELEVBQ0QsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sR0FDakMsQ0FBQzt3QkFDRixRQUFRLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQzt3QkFFdkIscUJBQU0sSUFBSSxDQUFDLGdCQUFnQixDQUFDO2dDQUMxQixJQUFJLEVBQUUsUUFBUTtnQ0FDZCxLQUFLLEVBQUUsc0RBQUMscUxBQW1DLEVBQXNCLElBQUcsS0FBekIsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFHO2dDQUNwRSxpQkFBaUIsRUFBRSxTQUFTOzZCQUM3QixDQUFDOzt3QkFKRixTQUlFLENBQUM7Ozs7O0tBQ0o7SUFFRCw4QkFBVyxHQUFYLFVBQWtDLFFBQVc7UUFDckMsbUJBQXNDLEVBQXJDLGNBQUksRUFBRSx3Q0FBK0IsQ0FBQztRQUM3QyxJQUFNLGFBQWEsR0FBRyxpQkFBaUIsSUFBSSxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN2RSxPQUFPLGFBQWEsS0FBSyxTQUFTLENBQUMsQ0FBQztZQUNsQyxhQUFhLENBQUMsQ0FBQztZQUNmLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuQixDQUFDO0lBRUQsNENBQXlCLEdBQXpCLFVBQTJCLFFBQW9CLEVBQUUsT0FBTztRQUNoRCxtQkFBc0MsRUFBckMsY0FBSSxFQUFFLHdDQUErQixDQUFDO1FBQzdDLElBQU0sV0FBVyxHQUFHLElBQUksSUFBSSxzRUFBYyxDQUFDLHlEQUFHLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2xFLElBQUksV0FBVyxJQUFJLENBQUMsQ0FBQyxpQkFBaUIsSUFBSSxpQkFBaUIsQ0FBQyxRQUFRLENBQUMsS0FBSyxTQUFTLENBQUMsRUFBRTtZQUNwRixJQUFNLE9BQU8sR0FBRyxtREFBSSxJQUFJLENBQUMsQ0FBQztZQUMxQixPQUFPLENBQUMsUUFBUSxDQUFDLEdBQUcsMERBQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDcEQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7U0FDeEM7YUFBTTtZQUNMLElBQU0sZ0JBQWdCLEdBQUcsbURBQUksaUJBQWlCLENBQUMsQ0FBQztZQUNoRCxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsR0FBRywwREFBTSxDQUNqQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQzVDLE9BQU8sQ0FDUixDQUFDO1lBQ0YsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEVBQUMsaUJBQWlCLEVBQUUsZ0JBQWdCLEVBQUMsQ0FBQyxDQUFDO1NBQzlEO0lBQ0gsQ0FBQztJQUVELHlCQUFNLEdBQU47UUFBQSxpQkFzS0M7UUFyS08sbUJBQXVGLEVBQXJGLGtCQUFNLEVBQUUsa0JBQU0sRUFBRSxzQkFBUSxFQUFFLHNCQUFRLEVBQUUsa0RBQXNCLEVBQUUsMEJBQXlCLENBQUM7UUFDeEYsbUJBQTJGLEVBQXpGLGNBQUksRUFBRSx3Q0FBaUIsRUFBRSxnQkFBSyxFQUFFLDhCQUFZLEVBQUUsb0NBQWUsRUFBRSw0QkFBMEIsQ0FBQztRQUNsRyxJQUFNLFNBQVMsR0FBRyxVQUFVLENBQUMsQ0FBQztZQUM1QixlQUFlLENBQUMsQ0FBQztZQUNqQixJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsRUFBSixDQUFJLENBQUM7aUJBQy9CLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsRUFBSixDQUFJLENBQUMsQ0FBQztpQkFDckMsTUFBTSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEVBQUosQ0FBSSxDQUFDLENBQUMsQ0FBQztRQUV2RCxJQUFNLFdBQVcsR0FBRyxJQUFJLElBQUksc0VBQWMsQ0FBQyx5REFBRyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNsRSxJQUFNLFlBQVksR0FBRyxJQUFJLElBQUksZ0RBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9DLDRCQUFRLENBQVM7UUFFeEIsT0FBTyw2REFBSyxTQUFTLEVBQUMsdURBQXVEO1lBQzNFLDZEQUFLLFNBQVMsRUFBQyx1REFBdUQ7Z0JBQ3BFLDZEQUFLLFNBQVMsRUFBQywrQ0FBK0M7b0JBQzVELDZEQUFLLFNBQVMsRUFBQyx5QkFBeUI7d0JBQ3RDLDREQUFJLFNBQVMsRUFBQyxJQUFJLElBQUUsS0FBSyxDQUFNLENBQzNCLENBQ0Y7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLHdDQUF3QztvQkFDckQsNkRBQUssU0FBUyxFQUFDLHNDQUFzQzt3QkFDbkQsNkRBQUssU0FBUyxFQUFDLDJDQUEyQzs0QkFDeEQsNkRBQUssU0FBUyxFQUFDLFdBQVc7Z0NBQ3hCLGdFQUFLLFVBQVUsQ0FBQyxDQUFDO29DQUNmLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQ0FDeEMsbUJBQW1CLENBQUMsQ0FBQztvQ0FDckIsY0FBYyxDQUFNO2dDQUN2QixVQUFVLENBQUMsQ0FBQztvQ0FDWCw4SEFFSSxDQUFDLENBQUMsQ0FBQyxXQUFXO29DQUNsQixzSEFFSTtnQ0FFTixvREFBQyxnRkFBZSxJQUNkLHFCQUFxQixFQUFFLE1BQU0sQ0FBQyxxQkFBcUIsRUFDbkQsU0FBUyxFQUFFLFNBQVMsRUFDcEIsY0FBYyxFQUFFLHNCQUFzQixFQUN0QyxRQUFRLEVBQUUsVUFBVSxJQUFJLFdBQVcsRUFDbkMsV0FBVyxFQUFFLElBQUksSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMscUJBQXFCLEVBQ25GLGFBQWEsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FDNUMsQ0FDRSxDQUNGO3dCQUVOLDZEQUFLLFNBQVMsRUFBQyw0QkFBNEI7NEJBQ3pDLG9EQUFDLHFGQUFpQixJQUNoQixPQUFPLEVBQUUsTUFBTSxDQUFDLFNBQVMsRUFDekIsS0FBSyxFQUFFLFdBQVcsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUMvRCxTQUFTLEVBQUUsU0FBUyxFQUNwQixRQUFRLEVBQUUsV0FBVyxJQUFJLFVBQVUsRUFDbkMsV0FBVyxFQUFFLElBQUksSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxFQUN2RSxhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQzNDLENBQ0M7d0JBRU4sNkRBQUssU0FBUyxFQUFDLDRCQUE0Qjs0QkFDekMsb0RBQUMscUZBQWlCLElBQ2hCLE9BQU8sRUFBRSxNQUFNLENBQUMsY0FBYyxFQUM5QixLQUFLLEVBQUUsV0FBVyxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLG1CQUFtQixFQUNqRixTQUFTLEVBQUUsU0FBUyxFQUNwQixRQUFRLEVBQUUsV0FBVyxJQUFJLFVBQVUsRUFDbkMsV0FBVyxFQUFFLElBQUksSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsY0FBYyxFQUM1RSxhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUksQ0FDOUM7d0JBRUwsQ0FBQyxVQUFVLElBQUksNkRBQUssU0FBUyxFQUFDLDRCQUE0Qjs0QkFBQyw2REFBSyxTQUFTLEVBQUUsa0JBQWtCLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQ0FDOUksNkRBQUssU0FBUyxFQUFDLFlBQVksRUFBQyxPQUFPLEVBQUUsY0FBTSxZQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxtQkFBbUIsRUFBRSxDQUFDLEtBQUksQ0FBQyxLQUFLLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxFQUEvRSxDQUErRSxJQUN2SCxXQUFXLENBQUMsQ0FBQztvQ0FDWixrR0FBa0MsQ0FBQyxDQUFDO29DQUNwQyx3RkFBNkIsQ0FDM0I7Z0NBQ04sNkRBQUssU0FBUyxFQUFDLGFBQWE7b0NBQzFCLDZGQUF5QjtvQ0FFekIsNkRBQUssU0FBUyxFQUFDLGVBQWUsSUFDM0Isc0VBQWUsQ0FBQyxHQUFHLENBQUMsWUFBRTt3Q0FDckIsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO3dDQUN2RCxPQUFPLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0IsRUFBQyxHQUFHLEVBQUUsRUFBRTs0Q0FDOUMsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjtnREFDakMsNkRBQ0UsU0FBUyxFQUFFLFVBQVUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFDcEQsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUM7d0RBQ3JCLElBQU0sV0FBVyxHQUFHLG1EQUFLLElBQUksQ0FBRSxDQUFDO3dEQUNoQyxXQUFXLENBQUMsZUFBZTs0REFDekIsUUFBUSxDQUFDLENBQUM7Z0VBQ1IsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsSUFBSSxFQUFFLEVBQVAsQ0FBTyxDQUFDLENBQUMsQ0FBQztnRUFDM0MsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7d0RBQ3BDLEtBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsQ0FBQyxDQUFDO29EQUMvQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsR0FBSSxDQUNmOzRDQUNOLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IsSUFBRSxFQUFFLENBQ2pDLENBQ0Y7b0NBQ1IsQ0FBQyxDQUFDLENBQ0UsQ0FDRixDQUVGLENBQU0sQ0FDUjtvQkFDTiw2REFBSyxTQUFTLEVBQUMsdUJBQXVCO3dCQUNwQyw2REFBSyxTQUFTLEVBQUMsMkNBQTJDOzRCQUN2RCxXQUFXLElBQUk7Z0NBQUcsb0RBQUMsZ0VBQU8sT0FBRzt1REFBd0I7NEJBQ3JELFlBQVksQ0FBQyxDQUFDO2dDQUNaOzs7OzttQ0FLRztnQ0FDTjtvQ0FDRSxvREFBQyw4REFBYSxJQUNaLGVBQWUsRUFBRSxlQUFlLEVBQ2hDLFlBQVksRUFBRSxZQUFZLEVBQzFCLElBQUksRUFBRSxJQUFJLEVBQ1YsV0FBVyxFQUFFLFdBQVcsRUFDeEIsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQ3BDLFFBQVEsRUFBRSxJQUFJLEdBQUk7b0NBRW5CLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQzt3Q0FDOUIsNkRBQUssdUJBQXVCLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBQyxHQUFJO3dDQUMzRSxDQUFDLENBQUMsSUFBSSxJQUFJLG9EQUFDLCtFQUFxQixJQUM5QixXQUFXLEVBQUUsV0FBVyxFQUN4QixJQUFJLEVBQUUsSUFBSSxFQUNWLGlCQUFpQixFQUFFLGlCQUFpQixFQUNwQyxRQUFRLEVBQUUsSUFBSSxHQUFJO29DQUVuQixJQUFJLElBQUksb0RBQUMseUVBQWtCLElBQUMsSUFBSSxFQUFFLElBQUksR0FBSSxDQUMxQyxDQUFDLENBQUM7Z0NBRUY7Ozs7O21DQUtHO2dDQUNOO29DQUNHLElBQUksSUFBSSxvREFBQyxvRkFBdUIsSUFDL0IsSUFBSSxFQUFFLElBQUksRUFDVixNQUFNLEVBQUUsTUFBTSxFQUNkLFdBQVcsRUFBRSxXQUFXLEVBQ3hCLFFBQVEsRUFBRSxRQUFRLEVBQ2xCLFFBQVEsRUFBRSxJQUFJLEdBQUk7b0NBRW5CLElBQUksSUFBSSxvREFBQywrRUFBcUIsSUFDN0IsV0FBVyxFQUFFLFdBQVcsRUFDeEIsSUFBSSxFQUFFLElBQUksRUFDVixpQkFBaUIsRUFBRSxpQkFBaUIsRUFDcEMsUUFBUSxFQUFFLElBQUksR0FBSTtvQ0FFbkIsSUFBSSxJQUFJLG9EQUFDLHlFQUFrQixJQUFDLElBQUksRUFBRSxJQUFJLEdBQUksQ0FDMUMsQ0FDQzt3QkFDTCxJQUFJLElBQUksNkRBQUssU0FBUyxFQUFDLDRCQUE0Qjs0QkFDbEQsK0RBQU07NEJBQ04sK0RBQU07NEJBQ04sb0RBQUMsNEVBQW1CLElBQUMsV0FBVyxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsSUFBSSxHQUFJLENBQzdELENBQ0YsQ0FDRjtnQkFDTiw2REFBSyxTQUFTLEVBQUMsV0FBVztvQkFDeEIsNkRBQUssU0FBUyxFQUFDLDJDQUEyQyxHQUFPLENBQzdELENBQ0YsQ0FBTTtJQUNoQixDQUFDO0lBQ0gsZUFBQztBQUFELENBQUMsQ0E3WjZCLCtDQUFlLEdBNlo1Qzs7Ozs7Ozs7Ozs7Ozs7O0FDbGREO0FBQUE7QUFBQTtBQUFBO0FBQTRCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNBRztBQUdvRDtBQUNyQjtBQVN2RCxTQUFTLHFCQUFxQixDQUFDLEVBQXVEO1FBQXRELDRCQUFXLEVBQUUsY0FBSSxFQUFFLHdDQUFpQixFQUFFLHNCQUFRO0lBQ25GLE9BQU87UUFDTDtZQUNFLGtHQUE4QjtZQUM5QjtnQkFDRSxrRUFDRSxTQUFTLEVBQUMsZ0NBQWdDLEVBQzFDLFFBQVEsRUFBRSxDQUFDLFdBQVcsRUFDdEIsS0FBSyxFQUFFLElBQUksQ0FBQyxZQUFZLEVBQ3hCLFFBQVEsRUFBRSxZQUFFO3dCQUNWLElBQU0sT0FBTyxHQUFHLG1EQUFLLElBQUksQ0FBRSxDQUFDO3dCQUM1QixPQUFPLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO3dCQUN2QyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztvQkFDL0MsQ0FBQyxHQUNELENBQ0UsQ0FDTDtRQUNILCtEQUFNO1FBQ04sMEdBQ0csQ0FBQyxXQUFXLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxvREFBQywwRUFBbUIsSUFDdEQsV0FBVyxFQUFFLFdBQVcsRUFDeEIsSUFBSSxFQUFFLElBQUksRUFDVixRQUFRLEVBQUUsUUFBUSxHQUFJLENBQ3ZCO1FBQ0g7WUFDRyxpQkFBaUIsSUFBSSxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFDakQsc0lBQWtFLENBQUMsQ0FBQztnQkFDcEUsbUdBQXlDO1lBRTNDLG9EQUFDLDJGQUFvQixJQUNuQixTQUFTLEVBQ1AsQ0FBQyxpQkFBaUIsSUFBSSxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUN0RSxJQUFJLEVBQUUsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQ3pCLFFBQVEsRUFBRSx5QkFBZTtvQkFDdkIsUUFBUSxDQUFDLHlCQUF5QixDQUFDLFdBQVcsRUFBRSxlQUFlLENBQUMsQ0FBQztnQkFDbkUsQ0FBQyxHQUFJLENBQ04sQ0FDRixDQUFDO0FBQ04sQ0FBQzs7Ozs7Ozs7Ozs7OztBQ25ERDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQStCO0FBRXFCO0FBRTdDLFNBQVMsbUJBQW1CLENBQUMsRUFBbUU7UUFBbEUsNEJBQVcsRUFBRSxzQkFBUTtJQUN4RCxPQUFPLG9EQUFDLDhDQUFjO1FBQ2pCLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLFFBQVEsSUFBSSw2REFBSyxTQUFTLEVBQUMsc0NBQXNDLEVBQUMsT0FBTyxFQUFFLGNBQU0sZUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsRUFBekIsQ0FBeUIsa0NBRXRIO1FBQ04sNkRBQUssU0FBUyxFQUFDLFlBQVksYUFBYTtRQUN4Qyw2REFBSyxTQUFTLEVBQUMsc0NBQXNDLEVBQUMsT0FBTyxFQUFFLGNBQU0sZUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsRUFBekIsQ0FBeUIsYUFFeEY7UUFFTiw2REFBSyxTQUFTLEVBQUMsZUFBZSxFQUFDLE9BQU8sRUFBRSxjQUFNLGVBQVEsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsc0RBQVMsQ0FBQyxFQUFoQyxDQUFnQyxZQUV4RTtRQUNMLENBQUMsV0FBVyxJQUFJLDZEQUFLLFNBQVMsRUFBQyxlQUFlLEVBQUMsT0FBTyxFQUFFLGNBQU0sZUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssQ0FBQyxzREFBUyxDQUFDLEVBQXBDLENBQW9DLDRDQUU3RixDQUNPLENBQUM7QUFDcEIsQ0FBQzs7Ozs7Ozs7Ozs7OztBQ25CRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUErQjtBQUNTO0FBQzZCO0FBYTlELFNBQVMsYUFBYSxDQUFFLEVBQXNGO1FBQXJGLG9DQUFlLEVBQUUsOEJBQVksRUFBRSxjQUFJLEVBQUUsc0JBQVEsRUFBRSw0QkFBVyxFQUFFLHdDQUFpQjtJQUN6RyxPQUFPLDZEQUFLLFNBQVMsRUFBRSxvQkFBb0IsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUNySCxlQUFlLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQzNCLHFHQUFzQyxDQUFDLENBQUM7WUFDeEMseUdBQTBDO1FBQzlDO1lBQU8sbUVBQ0YsWUFBWTtpQkFDVixNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ1osbUJBQVMsSUFBSSxnQkFBUyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsRUFBRSxFQUF4QixDQUF3QixDQUFDLENBQUM7Z0JBQ3ZDLGNBQU0sV0FBSSxFQUFKLENBQUksQ0FBQztpQkFDWixHQUFHLENBQUMsbUJBQVMsSUFBSSwyREFBQyw4Q0FBYyxJQUFDLEdBQUcsRUFBRSxTQUFTLENBQUMsRUFBRTtnQkFDakQ7b0JBQ0k7d0JBQ0ksNkRBQUssUUFBUSxFQUFFLENBQUMsRUFDZCxTQUFTLEVBQUUsVUFBVSxHQUFHLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxFQUFFLEtBQUssU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFDNUUsT0FBTyxFQUFFLGNBQUksdUJBQWdCLENBQUMsU0FBUyxDQUFDLEVBQTNCLENBQTJCLEdBQUssQ0FDOUM7b0JBQUEsZ0VBQ0EsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO3dCQUNoQiwyREFBRyxJQUFJLEVBQUMsR0FBRyxFQUFDLE9BQU8sRUFBRSxZQUFFO2dDQUNuQixnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQ0FDNUIsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO2dDQUNwQixFQUFFLENBQUMsZUFBZSxFQUFFLENBQUM7NEJBQ3pCLENBQUMsSUFBSSxTQUFTLENBQUMsSUFBSSxDQUFLLENBQUMsQ0FBQzt3QkFDMUIsMkRBQUcsSUFBSSxFQUFFLFNBQVMsQ0FBQyxHQUFHLEVBQUUsTUFBTSxFQUFDLFFBQVEsSUFBRSxTQUFTLENBQUMsSUFBSSxDQUFLLENBQy9EO29CQUNMLGdFQUNHLG9FQUFxQixDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQzlDO29CQUFBLGdFQUNGLFNBQVMsQ0FBQyxNQUFNLElBQUksVUFBVSxDQUM1QjtvQkFBQSxnRUFDQSw4REFBZSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FDdkMsQ0FDSixDQWVRLEVBckNHLENBcUNILENBQUMsQ0FDZCxDQUFRO1FBQ2hCLCtEQUFNO1FBQ04sK0RBQU0sQ0FDSixDQUFDO0lBRVQsU0FBUyxnQkFBZ0IsQ0FBQyxTQUFlO1FBQ3ZDLElBQUksSUFBSSxJQUFJLElBQUksQ0FBQyxFQUFFLEtBQUssU0FBUyxDQUFDLEVBQUUsRUFBRTtZQUNwQyxRQUFRLENBQUMscUJBQXFCLENBQUMsZUFBZSxDQUFDLENBQUM7U0FDakQ7YUFDSTtZQUNILDZEQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsYUFBYSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUM7WUFDbEQsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxrQkFBa0IsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1NBQzFFO0lBQ0gsQ0FBQztBQUNILENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQy9FOEI7QUFFK0I7QUFDZTtBQUd0RSxTQUFTLG1CQUFtQixDQUFDLEVBQXFGO1FBQXBGLDRCQUFXLEVBQUUsY0FBSSxFQUFFLHNCQUFRO0lBQzlELE9BQU8sb0RBQUMsOENBQWM7UUFDbEIsMkZBQTRCO1FBQzNCLFdBQVcsSUFBSSxrS0FFWjtRQUNKLG9EQUFDLG1FQUFPLElBQUMsT0FBTyxFQUFFO2dCQUNkLE1BQU07Z0JBQ04sUUFBUTtnQkFDUixXQUFXO2dCQUNYLGVBQWU7Z0JBQ2YsVUFBVTtnQkFDVixVQUFVO2dCQUNWLE9BQU87Z0JBQ1AsT0FBTztnQkFDUCxNQUFNO2dCQUNOLE1BQU07Z0JBQ04sT0FBTzthQUNWLEVBQUUsY0FBYyxFQUFFLDhFQUFlLEVBQUUsUUFBUSxFQUFFLENBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxjQUFJO2dCQUMxRixJQUFNLE9BQU8sR0FBRyxtREFBSyxJQUFJLENBQUUsQ0FBQztnQkFDNUIsT0FBTyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7Z0JBQ3ZCLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQztZQUN6QyxDQUFDLEdBQUssQ0FDTyxDQUFDO0FBQ3BCLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDOUI4QjtBQUUyQztBQVExRTtJQUFzQywwRUFBc0I7SUFDMUQsMEJBQVksS0FBWTtlQUN0QixrQkFBTSxLQUFLLENBQUM7SUFDZCxDQUFDO0lBRUQsaUNBQU0sR0FBTjtRQUNRLG1CQUF1QyxFQUF0QyxjQUFJLEVBQUUsa0JBQU0sRUFBRSwwQkFBd0IsQ0FBQztRQUM5QyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWE7WUFBRSxPQUFPLG1IQUFXLENBQUM7UUFDdEMsMkJBQXVFLEVBQXRFLHdCQUFTLEVBQUUsa0NBQWMsRUFBRSxnREFBMkMsQ0FBQztRQUM5RSxJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLHFCQUFxQixJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFFLElBQUksUUFBQyxtREFDM0QsTUFBTSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDLEVBQ25ELHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxFQUM1QixFQUg2RCxDQUc3RCxDQUFDLGdDQUE4QjtRQUNqQyxJQUFNLEdBQUcsR0FBRyxFQUFDLEtBQUssRUFBRSx1Q0FBdUMsRUFBRSxJQUFJLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxTQUFTLEtBQUssR0FBRyxFQUFwQixDQUFvQixDQUFDLEVBQUMsQ0FBQztRQUMzSSxJQUFNLEdBQUcsR0FBRyxFQUFDLEtBQUssRUFBRSx1Q0FBdUMsRUFBRSxJQUFJLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxTQUFTLEtBQUssR0FBRyxFQUFwQixDQUFvQixDQUFDLEVBQUMsQ0FBQztRQUMzSSxJQUFNLEdBQUcsR0FBRyxFQUFDLEtBQUssRUFBRSx1Q0FBdUMsRUFBRSxJQUFJLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxNQUFNLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxTQUFTLEtBQUssR0FBRyxFQUFwQixDQUFvQixDQUFDLEVBQUMsQ0FBQztRQUMzSSxJQUFNLEdBQUcsR0FBRyxFQUFDLEtBQUssRUFBRSxzQkFBc0IsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLFFBQUMsbURBQ3pHLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBWCxDQUFXLENBQUMsRUFDdkMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBRnlGLENBRXpGLENBQ25CLEVBQUMsaUNBQStCO1FBQ2pDLElBQU0sR0FBRyxHQUFHLEVBQUMsS0FBSyxFQUFFLDhCQUE4QixFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLElBQUksRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLFlBQUUsSUFBSSxRQUFDLG1EQUMzSCxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQVgsQ0FBVyxDQUFDLEVBQzdDLGNBQWMsQ0FBQyxFQUFFLENBQUMsRUFDbkIsRUFIMkgsQ0FHM0gsQ0FDSCxFQUFDLGlDQUErQjtRQUNqQyxJQUFNLFlBQVksR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsaUJBQU8sSUFBSSxjQUFPLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQXhCLENBQXdCLENBQUMsQ0FBQztRQUMzRixJQUFJLFlBQVksQ0FBQyxNQUFNLEtBQUssQ0FBQztZQUFFLE9BQU8sbUhBQVcsQ0FBQztRQUVsRCxPQUFPLENBQ0wsb0RBQUMsK0VBQVksSUFBQyxTQUFTLEVBQUMsUUFBUSxFQUFDLEtBQUssRUFBRTtnQkFDdEMsNkRBQUssU0FBUyxFQUFDLGFBQWE7b0JBQzFCLDJEQUFHLFNBQVMsRUFBQyw0QkFBNEIsaUJBQWEsTUFBTSxHQUFLLENBQzdEO2dCQUNOLGdIQUFnRCxDQUM1QyxJQUNILFlBQVksQ0FBQyxHQUFHLENBQUMsVUFBQyxFQUFvQjtnQkFBbkIsZ0JBQUssRUFBRSxjQUFJLEVBQUUsZ0JBQUs7WUFBTSxvRUFBSyxHQUFHLEVBQUUsS0FBSztnQkFDekQsZ0VBQUssS0FBSyxDQUFNO2dCQUNoQjtvQkFDRTt3QkFDRTs0QkFDRSw0REFBSSxLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFDLDhCQUE4Qjs0QkFDdkQsNERBQUksS0FBSyxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxrQ0FBa0M7NEJBQzNELCtHQUFnRCxDQUM3QyxDQUNDO29CQUNSLG1FQUNHLEtBQUssQ0FBQyxHQUFHLENBQUMsY0FBSSxJQUFJLG1FQUFJLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRTt3QkFDakMsNERBQUksdUJBQXVCLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBQyxHQUFJO3dCQUN2RCw0REFBSSx1QkFBdUIsRUFBRSxFQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFDLEdBQUk7d0JBQ3BEOzRCQUNFLGdFQUFRLE9BQU8sRUFBRSxjQUFJLGlCQUFVLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBekIsQ0FBeUIsa0NBQWlDOzRCQUMvRSxnRUFBUSxPQUFPLEVBQUUsY0FBSSxpQkFBVSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsS0FBSyxDQUFDLEVBQTFCLENBQTBCLCtCQUFtQyxDQUMvRSxDQUNGLEVBUGMsQ0FPZCxDQUFDLENBQ0EsQ0FDRixDQUNKO1FBckJzQyxDQXFCdEMsQ0FBQyxDQUNNLENBRWhCO0lBQ0gsQ0FBQztJQUNILHVCQUFDO0FBQUQsQ0FBQyxDQTdEcUMsK0NBQWUsR0E2RHBEOzs7Ozs7Ozs7Ozs7OztBQ3ZFRDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQStCO0FBQ1E7QUFHaEMsU0FBUyxrQkFBa0IsQ0FBQyxFQUFvQjtRQUFuQixjQUFJO0lBQ3RDLE9BQU87UUFDSCxvRkFBMEI7UUFFekIsSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsV0FBVyxJQUFJOztZQUNmLHVEQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQzs7WUFBSyxvRUFBUyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBVTtnQkFDekY7UUFDSCxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxZQUFZLElBQUk7O1lBQ1AsdURBQVEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDOztZQUFLLG9FQUFTLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFVO2dCQUNyRyxDQUNMLENBQUM7QUFDTixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDZjhCO0FBQ1U7QUFHUjtBQVlqQztJQUFzQywwRUFBNEI7SUFDaEUsMEJBQVksS0FBWTtRQUF4QixZQUNFLGtCQUFNLEtBQUssQ0FBQyxTQUViO1FBREMsS0FBSSxDQUFDLEtBQUssR0FBRyxFQUFDLEdBQUcsRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxFQUFFLEVBQUMsQ0FBQzs7SUFDM0MsQ0FBQztJQUVELCtCQUFJLEdBQUo7UUFDUyx3QkFBRyxDQUFlO1FBQ3pCLElBQUksQ0FBQyxnREFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7WUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLHNEQUFDLG1NQUFnQixFQUFHLDBEQUFnRCxLQUFuRCxHQUFHLEVBQWlELENBQUM7UUFDaEgsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDekIsQ0FBQztJQUVELGlDQUFNLEdBQU47UUFBQSxpQkErQkM7UUE5Qk8sbUJBQStCLEVBQTlCLGtCQUFNLEVBQUUsc0JBQXNCLENBQUM7UUFDdEMsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztRQUN6QixJQUFNLFVBQVUsR0FBRyxnREFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRWxELE9BQU87WUFBSyw2REFBSyxTQUFTLEVBQUMsMkNBQTJDO2dCQUNwRSx3R0FBeUM7Z0JBQ3pDLGtJQUF3RDtnQkFDeEQsK0RBQU07Z0JBQ04sNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9CQUFvQixpQkFBWTtvQkFDL0MsNkRBQUssU0FBUyxFQUFDLHFCQUFxQjt3QkFDbEMsK0RBQU8sSUFBSSxFQUFDLE1BQU0sRUFDaEIsUUFBUSxFQUFFLENBQUMsRUFDWCxJQUFJLEVBQUUsRUFBRSxFQUNSLEtBQUssRUFBRSxLQUFLLENBQUMsR0FBRyxFQUNoQixRQUFRLEVBQUUsWUFBRSxJQUFFLFlBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUMsQ0FBQyxFQUFyQyxDQUFxQyxHQUFJLENBQ3JEO29CQUNOLDZEQUFLLFNBQVMsRUFBQywyQkFBMkIsR0FBTyxDQUM3QztnQkFDTiwrREFBTSxDQUFNO1lBQ1osNkRBQUssU0FBUyxFQUFDLDRCQUE0QixFQUFDLEVBQUUsRUFBQyxpQ0FBaUM7Z0JBQzdFLFFBQVEsSUFBSSw2REFBSyxRQUFRLEVBQUUsQ0FBQyxFQUFFLFNBQVMsRUFBQyxzQ0FBc0MsRUFBQyxPQUFPLEVBQUUsY0FBSSxlQUFRLEVBQUUsRUFBVixDQUFVLDhCQUVqRztnQkFDTiwyREFDRSxRQUFRLEVBQUUsQ0FBQyxFQUNYLFNBQVMsRUFBRSxlQUFlLEdBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLEVBQ2hFLE9BQU8sRUFBRSxVQUFVLElBQUksQ0FBQyxjQUFNLGFBQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQWpCLENBQWlCLENBQUMsWUFBVyxDQUN6RCxDQUNGO0lBQ1IsQ0FBQztJQUNILHVCQUFDO0FBQUQsQ0FBQyxDQTVDcUMsK0NBQWUsR0E0Q3BEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1RDhCO0FBRXlCO0FBQ0o7QUFDVDtBQUNpQztBQUNwQztBQVVqQyxJQUFNLFVBQVUsR0FBRyxVQUFDLEtBQW9DLElBQUssb0VBQUssS0FBSyxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRTtJQUM1RixvREFBQyxtRUFBWSxJQUNYLEtBQUssRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFDLFNBQVMsRUFBQyxTQUFTLEVBQUUsRUFBQyxPQUFPLEVBQUUsY0FBSSxlQUFRLENBQUMsSUFBSSxHQUFDLFdBQVcsRUFBekIsQ0FBeUIsRUFBQyxFQUN2RixNQUFNLEVBQUUsRUFBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLFdBQVcsRUFBQyxHQUFJO0lBQzNDLG9EQUFDLGtCQUFrQixxREFBSyxLQUFLLEVBQUksQ0FDN0IsRUFMOEQsQ0FLOUQsQ0FBQztBQUVQO0lBQXdDLDRFQUE0QjtJQUdsRSw0QkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBRWI7UUFEQyxLQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQzs7SUFDcEIsQ0FBQztJQUVELDhDQUFpQixHQUFqQjtRQUNFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsYUFBRyxJQUFJLHFFQUFTLENBQUMsR0FBRyxDQUFDLEVBQWQsQ0FBYyxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVLLGlDQUFJLEdBQVY7Ozs7Ozs2QkFDTSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBYix3QkFBYTt3QkFFUCxFQUFFLEdBQUssSUFBSSxDQUFDLEtBQUssR0FBZixDQUFnQjt3QkFDWCxxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBUyxTQUFTLEVBQUUsRUFBRSxDQUFDOzt3QkFBOUQsTUFBTSxHQUFHLFNBQXFEO3dCQUNwRSxJQUFJLENBQUMsVUFBVSxHQUFHLG1EQUFLLE1BQU0sQ0FBRSxDQUFDO3dCQUNoQyxJQUFJLENBQUMsUUFBUSxDQUFDLG1EQUFLLE1BQU0sRUFBRyxDQUFDOzs7d0JBRTdCLDZCQUE2Qjt3QkFDN0IsSUFBSSxDQUFDLFFBQVEsQ0FBQzs0QkFDWixFQUFFLEVBQUUsb0VBQVUsRUFBRTs0QkFDaEIsZ0JBQWdCLEVBQUUsb0VBQVUsRUFBRTs0QkFDOUIsV0FBVyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLFdBQVc7NEJBQzVDLGVBQWUsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxTQUFTO3lCQUMvQyxDQUFDLENBQUM7Ozs7OztLQUVOO0lBRUssaUNBQUksR0FBVjs7Ozs7O3dCQUNRLENBQUMsR0FBRyxJQUFJLDZEQUFXLEVBQUUsQ0FBQzt3QkFDeEIsTUFBTSxHQUFHLG1EQUFLLElBQUksQ0FBQyxLQUFLLElBQUUsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO2lDQUN4RCxNQUFNLENBQUMsYUFBRyxJQUFJLFFBQUMsU0FBUyxFQUFFLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQXpDLENBQXlDLENBQUMsR0FDMUQsQ0FBQzt3QkFFRixJQUFJLE1BQU0sQ0FBQyxlQUFlOzRCQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO3dCQUN4RCxJQUFJLE1BQU0sQ0FBQyxXQUFXOzRCQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO3dCQUN0RCxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxJQUFJLE1BQU0sQ0FBQyxlQUFlLENBQUMsRUFBRTs0QkFDbkQsTUFBTSxJQUFJLEtBQUssQ0FBRSxzREFBQyxpT0FBdUQsS0FBQyxDQUFDO3lCQUM1RTt3QkFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRTs0QkFDcEIsTUFBTSxDQUFDLEdBQUcsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDOzRCQUM3QixNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FDYixJQUFJLGdFQUFjLENBQ2hCLFlBQVksRUFDVCxNQUFNLENBQUMsSUFBSSxjQUFXLEVBQUUsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQzs0QkFDaEQsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7NEJBQ3pCLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDO3lCQUNqQzs2QkFBTSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFOzRCQUVuRCxNQUFNLElBQUksS0FBSyxDQUFDLG9EQUFvRCxDQUFDO3lCQUV0RTs2QkFBTTs0QkFDTCxJQUFJLENBQUMsTUFBTSxDQUFDLGdCQUFnQixFQUFFO2dDQUM1QixNQUFNLENBQUMsZ0JBQWdCLEdBQUcsb0VBQVUsRUFBRSxDQUFDO2dDQUN2QyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQzs2QkFDakM7NEJBQ0QsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7eUJBQzFCO3dCQUVELHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQzs7d0JBQXBELFNBQW9ELENBQUM7d0JBRXJELFFBQVEsQ0FBQyxJQUFJLEdBQUcsV0FBVyxDQUFDOzs7OztLQUM3QjtJQUVPLDRDQUFlLEdBQXZCLFVBQXdCLE1BQTRVLEVBQUUsQ0FBYztRQUNsWCxJQUFNLE1BQU0sR0FBVztZQUNyQixFQUFFLEVBQUUsTUFBTSxDQUFDLGdCQUFnQjtZQUMzQixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7WUFDakIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxFQUFFO1lBQ25CLEdBQUcsRUFBRTtnQkFDSCxhQUFhO2dCQUNiLElBQUksZ0VBQWMsQ0FBQyxZQUFZLEVBQUssTUFBTSxDQUFDLElBQUksY0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsRUFBRTthQUM1RTtTQUNGLENBQUM7UUFDRixDQUFDLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRUsseUNBQVksR0FBbEI7Ozs7Ozs2QkFDTSxPQUFNLENBQUMsc0RBQUMsK1FBQXNDLEVBQWUsMERBQStDLEtBQTlELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFnRCxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFqSSx3QkFBaUk7d0JBQzlHLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFTLFVBQVUsRUFBRTtnQ0FDdkUsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQztnQ0FDbEMsT0FBTyxFQUFFLGtCQUFrQjtnQ0FDM0IsS0FBSyxFQUFFLENBQUMsZ0JBQWdCLENBQUM7NkJBQzFCLENBQUM7O3dCQUpJLFlBQVksR0FBRyxTQUluQjt3QkFDSSxPQUFLLElBQUksNkRBQVcsRUFBRSxDQUFDO3dCQUM3QixJQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNwQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFVBQUMsRUFBSTtnQ0FBSCxVQUFFOzRCQUMzQyxJQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQzt3QkFDNUIsQ0FBQyxDQUFDLENBQUM7d0JBQ0gsSUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO3dCQUNuRCxxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFFLENBQUMsZ0JBQWdCLENBQUM7O3dCQUFyRCxTQUFxRCxDQUFDO3dCQUN0RCxRQUFRLENBQUMsSUFBSSxHQUFFLFdBQVcsQ0FBQzs7O3dCQUUzQixLQUFLLENBQUMsZ0VBQWdFLENBQUMsQ0FBQzs7Ozs7O0tBRTNFO0lBRUQsbUNBQU0sR0FBTjtRQUFBLGlCQThHQztRQTdHTyxtQkFBMEIsRUFBeEIsZ0JBQUssRUFBRSxVQUFpQixDQUFDO1FBQ2pDLElBQU0sWUFBWSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDMUIsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztRQUMxQixJQUFNLFVBQVUsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ25DLElBQU0sT0FBTyxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBSSxJQUFJLFdBQUksS0FBSyxPQUFPLEVBQWhCLENBQWdCLENBQUMsQ0FBQztRQUNyRSxPQUFPLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7WUFDdEMsNkRBQUssU0FBUyxFQUFDLHVEQUF1RDtnQkFDcEUsZ0VBQUssS0FBSyxDQUFNO2dCQUNoQiwrREFBTTtnQkFDTiw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29CQUMvQiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLFlBQVk7b0JBQy9DLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7d0JBQ2pDLCtEQUFPLElBQUksRUFBQyxNQUFNLEVBQUMsU0FBUyxFQUFFLENBQUMsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFDbkQsUUFBUSxFQUFFLENBQUMsT0FBTyxJQUFJLFlBQVksRUFDbEMsUUFBUSxFQUFFLENBQUMsRUFDWCxJQUFJLEVBQUUsRUFBRSxFQUNSLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFDaEMsUUFBUSxFQUFFLFlBQUUsSUFBSSxZQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBeEMsQ0FBd0MsR0FBSSxDQUMxRDtvQkFDTiw2REFBSyxTQUFTLEVBQUMsMkJBQTJCLEdBQU8sQ0FDN0M7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9CQUFvQixvQkFBb0I7b0JBQ3ZELDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7d0JBQ2pDLCtEQUFPLElBQUksRUFBQyxNQUFNLEVBQUMsU0FBUyxFQUFFLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQ3pELFFBQVEsRUFBRSxDQUFDLE9BQU8sRUFDbEIsUUFBUSxFQUFFLENBQUMsRUFDWCxJQUFJLEVBQUUsRUFBRSxFQUNSLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFDdkMsUUFBUSxFQUFFLFlBQUUsSUFBSSxZQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsV0FBVyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBL0MsQ0FBK0MsR0FBSSxDQUNqRTtvQkFDTiw2REFBSyxTQUFTLEVBQUMsMkJBQTJCLEdBQU8sQ0FDN0M7Z0JBQ0wsTUFBTSxJQUFJLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLDZEQUFLLFNBQVMsRUFBQyxrQkFBa0I7b0JBQy9ELDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IsNEJBQTRCO29CQUMvRCw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dCQUNqQywrREFBTyxJQUFJLEVBQUMsTUFBTSxFQUNoQixRQUFRLEVBQUUsQ0FBQyxPQUFPLEVBQ2xCLFFBQVEsRUFBRSxDQUFDLEVBQ1gsSUFBSSxFQUFFLEVBQUUsRUFDUixLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFDN0MsUUFBUSxFQUFFLFlBQUUsSUFBSSxZQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsaUJBQWlCLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxFQUFyRCxDQUFxRCxHQUFJLENBQ3ZFO29CQUNOLDZEQUFLLFNBQVMsRUFBQywyQkFBMkIsR0FBTyxDQUM3QyxDQUFDLENBQUMsQ0FBQyxJQUFJO2dCQUNaLE1BQU0sSUFBSSxNQUFNLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29CQUNuRSw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLDZCQUE2QjtvQkFDaEUsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjt3QkFDakMsK0RBQU8sSUFBSSxFQUFDLE1BQU0sRUFDaEIsUUFBUSxFQUFFLENBQUMsT0FBTyxFQUNsQixRQUFRLEVBQUUsQ0FBQyxFQUNYLElBQUksRUFBRSxFQUFFLEVBQ1IsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQzdDLFFBQVEsRUFBRSxZQUFFLElBQUksWUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLGlCQUFpQixFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBckQsQ0FBcUQsR0FBSSxDQUN2RTtvQkFDTiw2REFBSyxTQUFTLEVBQUMsMkJBQTJCLEdBQU8sQ0FDN0MsQ0FBQyxDQUFDLENBQUMsSUFBSTtnQkFDYiw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29CQUMvQiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLFdBQVc7b0JBQzlDLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7d0JBQ2pDLCtEQUFPLElBQUksRUFBQyxVQUFVLEVBQ3BCLElBQUksRUFBQyxtQkFBbUIsRUFDeEIsUUFBUSxFQUFFLENBQUMsT0FBTyxFQUNsQixPQUFPLEVBQUUsTUFBTSxJQUFJLE1BQU0sQ0FBQyxlQUFlLEVBQ3pDLFFBQVEsRUFBRSxDQUFDLEVBQ1gsS0FBSyxFQUFDLFNBQVMsRUFDZixRQUFRLEVBQUUsWUFBRSxJQUFJLFlBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxlQUFlLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxFQUFyRCxDQUFxRCxHQUFJOzJDQUV2RTtvQkFDTiw2REFBSyxTQUFTLEVBQUMsMkJBQTJCLEdBQU8sQ0FDN0M7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9CQUFvQixHQUFPO29CQUMxQyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dCQUNqQywrREFBTyxJQUFJLEVBQUMsVUFBVSxFQUNwQixJQUFJLEVBQUMscUJBQXFCLEVBQzFCLFFBQVEsRUFBRSxDQUFDLE9BQU8sRUFDbEIsT0FBTyxFQUFFLE1BQU0sSUFBSSxNQUFNLENBQUMsV0FBVyxFQUNyQyxRQUFRLEVBQUUsQ0FBQyxFQUNYLEtBQUssRUFBQyxXQUFXLEVBQ2pCLFFBQVEsRUFBRSxZQUFFLElBQUksWUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLFdBQVcsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDLEVBQWpELENBQWlELEdBQUk7MENBRW5FO29CQUNOLDZEQUFLLFNBQVMsRUFBQywyQkFBMkIsR0FBTyxDQUM3QztnQkFDTiwrREFBSztnQkFDSixPQUFPLElBQUksWUFBWSxJQUFJLDZEQUFLLFFBQVEsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFDLHNDQUFzQyxFQUFDLE9BQU8sRUFBRTt3QkFDdEcsWUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDLEtBQUssQ0FBQyxzREFBUyxDQUFDO29CQUFwQyxDQUFvQyxvQkFFaEM7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLFlBQVksYUFBYTtnQkFDeEMsb0RBQUMscURBQUksSUFBQyxTQUFTLEVBQUMsc0NBQXNDLEVBQUMsRUFBRSxFQUFDLFVBQVUsYUFFN0Q7Z0JBRU4sT0FBTyxJQUFJLDJEQUFHLFFBQVEsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRSxPQUFPLEVBQUU7d0JBQy9ELElBQUksVUFBVSxJQUFJLFVBQVUsQ0FBQyxJQUFJLEtBQUssTUFBTSxDQUFDLElBQUksRUFBRTs0QkFDakQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxzREFBQyx5Z0NBSXVDLEtBQUMsRUFBRTtnQ0FDdEQsT0FBTzs2QkFDUjt5QkFDRjt3QkFDRCxLQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLHNEQUFTLENBQUMsQ0FBQztvQkFDL0IsQ0FBQyxZQUFXLENBQ1IsQ0FDRixDQUFDO0lBQ1QsQ0FBQztJQUNILHlCQUFDO0FBQUQsQ0FBQyxDQW5OdUMsK0NBQWUsR0FtTnREOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFPOEI7QUFHVTtBQUNFO0FBR0g7QUFDUTtBQUNJO0FBUTdDLElBQU0sa0JBQWtCLEdBQUcsVUFBQyxLQUFZO0lBQ3JDLDJCQUFPLEVBQUUsbUNBQWEsQ0FBVztJQUN6QyxJQUFNLE9BQU8sR0FBRyx3REFBRyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLGNBQUksSUFBSSxXQUFJLEtBQUssT0FBTyxFQUFoQixDQUFnQixDQUFDLENBQUM7SUFDckUsT0FBTyw2REFBSyxTQUFTLEVBQUMsc0JBQXNCO1FBQzFDLGlFQUNHLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDVCxtRUFDRyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNO2dCQUNqQixtRUFBSSxTQUFTLEVBQUMsa0JBQWtCLEVBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxFQUFFO29CQUM3Qzt3QkFDRSxvREFBQyxxREFBSSxJQUFDLFNBQVMsRUFBQyxVQUFVLEVBQUMsRUFBRSxFQUFFLGNBQVksTUFBTSxDQUFDLEVBQUUsVUFBTyxHQUFTLENBQ2pFO29CQUNMO3dCQUNFLCtEQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUssQ0FDakI7b0JBQ0w7d0JBQ0U7NEJBQUcsMkRBQUcsS0FBSyxFQUFFLEVBQUMsTUFBTSxFQUFFLFNBQVMsRUFBQyxFQUFFLE9BQU8sRUFBRSxjQUFJLG9FQUFLLENBQUMsRUFBQyxJQUFJLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFDLENBQUMsRUFBOUMsQ0FBOEMsZ0RBQXFDLENBQUksQ0FDbkk7b0JBQ0w7d0JBQ0U7NEJBQUcsMkRBQUcsS0FBSyxFQUFFLEVBQUMsTUFBTSxFQUFFLFNBQVMsRUFBQyxFQUFFLE9BQU8sRUFBRSxjQUFJLG9FQUFLLENBQUMsRUFBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxhQUFhLEVBQUMsQ0FBQyxFQUFqRSxDQUFpRSx5Q0FBbUMsQ0FBSSxDQUNwSixDQUNGO1lBYkwsQ0FhSyxDQUFDLENBQ0YsQ0FDRixDQUFDLENBQUMsQ0FBQztZQUFHLG9EQUFDLCtEQUFPLE9BQUc7a0RBQWtDLENBQ3ZEO1FBQ04sK0RBQU07UUFDTCxPQUFPLElBQUksT0FBTyxJQUFJLG9EQUFDLHFEQUFJLElBQUMsRUFBRSxFQUFFLGtCQUFnQixLQUFLLENBQUMsSUFBTSxFQUFFLFNBQVMsRUFBQyxLQUFLLElBQzFFLEtBQUssQ0FBQyxJQUFJLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxzREFBQyxxS0FBeUIsS0FBQyxDQUFDO1lBQ3hELEtBQUssQ0FBQyxJQUFJLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQyxzREFBQywrSkFBc0IsS0FBQyxDQUFDLENBQ25ELHNEQUFDLHFKQUFpQixLQUFRLENBQ3pCO0FBQ1QsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoRDhCO0FBQ3lCO0FBQ2I7QUFFaUI7QUFDRTtBQUNWO0FBVzdDLElBQU0sT0FBTyxHQUFHLFVBQUMsS0FBWSxJQUFLLG9FQUFLLEtBQUssRUFBRSxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUU7SUFDakUsb0RBQUMsbUVBQVksSUFBQyxLQUFLLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBQyxTQUFTLEVBQUMsTUFBTSxFQUFFLEVBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxXQUFXLEVBQUMsR0FBSTtJQUMzRixvREFBQyxvQkFBb0IsSUFBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLGFBQWEsR0FBSSxDQUN4RCxFQUhtQyxDQUduQztBQUVOO0lBQTBDLDhFQUFtRDtJQUMzRiw4QkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBSWI7UUFIQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsT0FBTyxFQUFFLElBQUk7U0FDZDs7SUFDSCxDQUFDO0lBRUQsZ0RBQWlCLEdBQWpCO1FBQ0UsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxhQUFHLElBQUkscUVBQVMsQ0FBQyxHQUFHLENBQUMsT0FBTyxJQUFJLEdBQUcsQ0FBQyxFQUE3QixDQUE2QixDQUFDLENBQUM7SUFDMUQsQ0FBQztJQUVLLG1DQUFJLEdBQVY7Ozs7OzRCQUNrQixxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBUyxTQUFTLENBQUM7O3dCQUE1RCxPQUFPLEdBQUcsU0FBa0Q7d0JBQ2xFLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxPQUFPLFdBQUUsQ0FBQyxDQUFDOzs7OztLQUM1QjtJQUVELHFDQUFNLEdBQU47UUFDVSxnQ0FBTyxDQUFnQjtRQUMvQixPQUFPLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxnRUFBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDN0MsT0FBTyw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO1lBQ3RDLDZEQUFLLFNBQVMsRUFBQyx1REFBdUQsSUFDbkUsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDWDtvQkFDRSxpRkFBdUI7b0JBQ3ZCLG9EQUFDLHdFQUFrQixJQUNqQixPQUFPLEVBQUUsT0FBTyxDQUFDLE1BQU0sQ0FBQyxnQkFBTSxJQUFJLGFBQU0sQ0FBQyxXQUFXLEVBQWxCLENBQWtCLENBQUMsRUFDckQsYUFBYSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUN2QyxJQUFJLEVBQUMsV0FBVyxHQUFHLENBQ2pCO2dCQUNOO29CQUNFLDhFQUFvQjtvQkFDcEIsb0RBQUMsd0VBQWtCLElBQ2pCLE9BQU8sRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLGdCQUFNLElBQUksYUFBTSxDQUFDLGVBQWUsRUFBdEIsQ0FBc0IsQ0FBQyxFQUN6RCxhQUFhLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLEVBQ3ZDLElBQUksRUFBQyxTQUFTLEdBQUcsQ0FDZixDQUNMLENBQUMsQ0FBQyxDQUFDLG9EQUFDLCtEQUFPLE9BQUcsQ0FDWCxDQUNGO0lBQ1IsQ0FBQztJQUNILDJCQUFDO0FBQUQsQ0FBQyxDQXpDeUMsK0NBQWUsR0F5Q3hEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0Q4QjtBQUNVO0FBQ0E7QUFPbEMsSUFBTSxTQUFTLEdBQUcsVUFBQyxLQUFZLElBQUcsMkRBQUMsdURBQVUsSUFDbEQsS0FBSyxFQUFFLHNEQUFDLHFKQUFpQixNQUN6QixJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksRUFDaEIsV0FBVyxFQUFFLEtBQUssQ0FBQyxXQUFXLEdBQUksRUFISyxDQUdMLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDWk47QUFJMkI7QUFDSztBQUNwQjtBQUNTO0FBQ087QUFFZDtBQVk3QztJQUEwQyw4RUFBNEI7SUFDcEUsOEJBQVksS0FBWTtRQUF4QixZQUNFLGtCQUFNLEtBQUssQ0FBQyxTQUViO1FBREMsS0FBSSxDQUFDLEtBQUssR0FBQyxFQUFFLENBQUM7O0lBQ2hCLENBQUM7SUFFRCxxQ0FBTSxHQUFOO1FBQ1EsbUJBQXdDLEVBQXZDLGNBQUksRUFBRSxzQkFBUSxFQUFFLHdCQUF1QixDQUFDO1FBQy9DLElBQU0sZ0JBQWdCLEdBQUcsa0RBQVEsQ0FBQyxNQUFNLENBQUM7UUFDekMsT0FBTztZQUNMLDZEQUFLLFNBQVMsRUFBQyxlQUFlLElBQzNCLFNBQVMsQ0FBQyxHQUFHLENBQUMsVUFBQyxRQUFRLEVBQUUsR0FBRztnQkFDM0Isb0VBQUssU0FBUyxFQUFDLGtCQUFrQixFQUFDLEdBQUcsRUFBRSxHQUFHO29CQUN4Qyw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dCQUNqQywyREFBRyxTQUFTLEVBQUMsVUFBVSxFQUFDLE9BQU8sRUFBRSxjQUFJLFdBQUksQ0FBQyxVQUFVLENBQUM7Z0NBQ25ELFNBQVMsRUFBRSx1RUFBWTtnQ0FDdkIsS0FBSyxFQUFFO29DQUNMLEtBQUssRUFBRSxpQkFBaUI7b0NBQ3hCLFFBQVE7b0NBQ1IsTUFBTSxFQUFFLHdCQUFjO3dDQUNwQixJQUFNLGVBQWUsR0FBRyxrRkFBbUMsQ0FBQyxjQUFjLEVBQUUsd0RBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQzt3Q0FDN0YsUUFBUSxDQUFDLEVBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO3dDQUNqRCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7b0NBQ3JCLENBQUM7b0NBQ0QsUUFBUSxFQUFFO3dDQUNSLFFBQVEsQ0FBQyxFQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO3dDQUNoQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7b0NBQ3JCLENBQUM7aUNBQ0Y7NkJBQ0YsQ0FBQyxFQWZtQyxDQWVuQyxHQUFNLENBQ0o7b0JBQ04sNkRBQUssU0FBUyxFQUFDLG9CQUFvQjt3QkFDakMsMkRBQUcsSUFBSSxFQUFFLFFBQVEsQ0FBQyxHQUFHLEVBQUUsTUFBTSxFQUFDLFFBQVEsSUFBRyxRQUFRLENBQUMsSUFBSSxDQUFLLENBQ3ZELENBQ0Y7WUF0Qk4sQ0FzQk0sQ0FBQyxDQUNOO1lBQ1AsNkRBQUssU0FBUyxFQUFDLHlCQUF5QjtnQkFDdEMsNkRBQUssU0FBUyxFQUFDLG1CQUFtQjtvQkFDaEMsMkRBQUcsU0FBUyxFQUFDLEtBQUssRUFBQyxPQUFPLEVBQUUsY0FBSSxXQUFJLENBQUMsVUFBVSxDQUFDOzRCQUM5QyxTQUFTLEVBQUUsdUVBQVk7NEJBQ3RCLEtBQUssRUFBRTtnQ0FDUCxLQUFLLEVBQUUsa0JBQWtCO2dDQUN6QixNQUFNLEVBQUUscUJBQVc7b0NBQ2pCLElBQU0sZUFBZSxHQUFHLGtGQUFtQyxDQUFDLFdBQVcsRUFBRSx3REFBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO29DQUMxRixRQUFRLENBQUMsRUFBQyxLQUFLLEVBQUUsQ0FBQyxlQUFlLENBQUMsRUFBQyxDQUFDO29DQUNwQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7Z0NBQ3JCLENBQUM7NkJBQ0Q7eUJBQ0YsQ0FBQyxFQVY4QixDQVU5Qjt3QkFBRSwyREFBRyxTQUFTLEVBQUMsaUJBQWlCLHdCQUFpQjtpREFBcUIsQ0FDbEU7Z0JBQ0wsZ0JBQWdCLElBQUksNkRBQUssU0FBUyxFQUFDLG1CQUFtQjtvQkFDckQsb0RBQUMseURBQVcsSUFBQyxLQUFLLEVBQUMsZ0NBQXNCLEVBQUMsTUFBTSxFQUFFOzRCQUNoRCxJQUFNLE1BQU0sR0FBRyxJQUFJLGdFQUFZLENBQUMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDOzRCQUVsRSxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxDQUFDLGVBQUs7Z0NBQ3RCLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBQyxJQUFJO29DQUNqQixJQUFNLFdBQVcsR0FBYSxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFO29DQUNoRSxJQUFNLGVBQWUsR0FBRyxrRkFBbUMsQ0FBQyxXQUFXLEVBQUUsd0RBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQ0FDMUYsUUFBUSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQztnQ0FDeEMsQ0FBQyxDQUFDLENBQUM7NEJBQ0wsQ0FBQyxDQUFDLENBQUM7d0JBRUwsQ0FBQyxHQUFJLENBQ0QsQ0FFRixDQUNGO0lBQ1IsQ0FBQztJQUNILDJCQUFDO0FBQUQsQ0FBQyxDQXBFeUMsK0NBQWUsR0FvRXhEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzFGOEI7QUFJcUI7QUFFVztBQUNwQjtBQUNjO0FBQ3dDO0FBQ2I7QUFxQnBGO0lBQXNDLDBFQUE0QjtJQUNoRSwwQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBRWI7UUFEQyxLQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQzs7SUFDbEIsQ0FBQztJQUVELHlDQUFjLEdBQWQsVUFBZSxJQUFVO1FBQ2pCLG1CQVlRLEVBWFosMENBQWtCLEVBQ2xCLGtCQUFNLEVBQ04sY0FBSSxFQUNKLGtCQUFNLEVBQ04sb0JBQU8sRUFDUCw0QkFBVyxFQUNYLGdDQUFhLEVBQ2IsMERBQTBCLEVBQzFCLGdDQUFhLEVBQ2Isa0RBQXNCLEVBQ3RCLGtDQUNZLENBQUM7UUFFZixJQUFJLENBQUMsVUFBVSxDQUFDO1lBQ2QsU0FBUyxFQUFFLCtEQUFRO1lBQ25CLEtBQUssRUFBRTtnQkFDTCxJQUFJO2dCQUNKLGlCQUFpQixFQUFFLGtCQUFrQixJQUFJLGtCQUFrQixDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7Z0JBQ3BFLE1BQU07Z0JBQ04sTUFBTTtnQkFDTixJQUFJO2dCQUNKLHNCQUFzQjtnQkFDdEIsTUFBTSxFQUFFLGNBQUk7b0JBQ1YsSUFBTSxXQUFXLEdBQUcsa0ZBQW1DLENBQUMsSUFBSSxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7b0JBQy9FLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDM0IsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUNyQixDQUFDO2dCQUNELG1CQUFtQixFQUFFLHVCQUFhO29CQUNoQywwQkFBMEIsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLGFBQWEsQ0FBQyxDQUFDO29CQUNuRCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7Z0JBQ3JCLENBQUM7Z0JBQ0QsUUFBUSxFQUFFO29CQUNSLGFBQWEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7b0JBQ3ZCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDckIsQ0FBQztnQkFDRCxTQUFTLEVBQUUsVUFBQyxNQUFjLEVBQUUsT0FBYTtvQkFDdkMsY0FBYyxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztvQkFDaEMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUNyQixDQUFDO2dCQUNELFFBQVEsRUFBRSxjQUFNLFdBQUksQ0FBQyxXQUFXLEVBQUUsRUFBbEIsQ0FBa0I7YUFDbkM7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsaUNBQU0sR0FBTjtRQUFBLGlCQXdFQztRQXZFQyxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3pCLElBQU0sS0FBSyxHQUFHLG9HQUFjLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLE9BQU8sRUFBRSxFQUFDLGVBQWUsRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO1FBRTFGLE9BQU87WUFDTCxvREFBQyx1RkFBZ0IsSUFDZixTQUFTLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxjQUFJLElBQUksUUFBQyxFQUFDLElBQUksUUFBRSxXQUFXLEVBQUUsc0VBQWMsQ0FBQyx3REFBRyxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFBQyxDQUFDLEVBQTVELENBQTRELENBQUMsRUFDMUYsY0FBYyxFQUFFLFVBQUMsRUFBbUI7d0JBQWxCLGNBQUksRUFBRSw0QkFBVztvQkFBTSxvRUFBSyxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUM7NEJBQ2xFLFVBQVUsQ0FBQyxDQUFDOzRCQUNaLFVBQVUsRUFDVixPQUFPLEVBQUUsY0FBSSxZQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUF6QixDQUF5QixHQUFJO2dCQUhMLENBR0ssRUFDOUMsVUFBVSxFQUFFLFVBQUMsRUFBTTt3QkFBTCxjQUFJO29CQUFNLFdBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQzt3QkFDcEMsa0VBQWtFO3dCQUNsRSxtQkFBbUI7d0JBQ25CLDJEQUFHLElBQUksRUFBQyxHQUFHLEVBQUMsT0FBTyxFQUFFLFlBQUU7Z0NBQ3JCLEVBQUUsQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQ0FDcEIsS0FBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQzs0QkFDNUIsQ0FBQyxJQUFHLElBQUksQ0FBQyxJQUFJLENBQUssQ0FBQyxDQUFDO3dCQUNwQiwyREFBRyxJQUFJLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxNQUFNLEVBQUMsUUFBUSxJQUFFLElBQUksQ0FBQyxJQUFJLENBQUs7Z0JBUDVCLENBTzRCLEVBQ3BELE1BQU0sRUFBRSxVQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsU0FBUztvQkFDaEMsS0FBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO2dCQUN6RCxDQUFDLEdBQUk7WUFFUCwrREFBTTtZQUNOLDJEQUFHLFNBQVMsRUFBQyxLQUFLLEVBQUMsT0FBTyxFQUFFO29CQUNwQixvQkFNcUMsRUFMekMsa0JBQU0sRUFDTixjQUFJLEVBQ0osa0RBQXNCLEVBQ3RCLGtCQUFNLEVBQ04sNEJBQVcsRUFDWCwwREFBeUMsQ0FBQztvQkFFNUMsS0FBSyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUM7d0JBQ3BCLFNBQVMsRUFBRSwrREFBUTt3QkFDbkIsS0FBSyxFQUFFOzRCQUNMLFVBQVUsRUFBRSxJQUFJOzRCQUNoQixNQUFNOzRCQUNOLE1BQU07NEJBQ04sSUFBSTs0QkFDSixzQkFBc0I7NEJBQ3RCLE1BQU0sRUFBRSxVQUFDLFdBQVcsRUFBRSxpQkFBaUI7Z0NBQ3JDLFdBQVcsR0FBRyxrRkFBbUMsQ0FBQyxXQUFXLEVBQUUsd0RBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQ0FDaEYsV0FBVyxDQUFDLFdBQVcsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dDQUM1QyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7NEJBQ3JCLENBQUM7NEJBQ0QsUUFBUSxFQUFFLGNBQU0sV0FBSSxDQUFDLFdBQVcsRUFBRSxFQUFsQixDQUFrQjt5QkFDbkM7cUJBQ0YsQ0FBQyxDQUFDO2dCQUNMLENBQUM7Z0JBQUUsMkRBQUcsU0FBUyxFQUFDLGNBQWMsd0JBQWU7b0NBQWdCOztZQUU3RCwyREFBRyxPQUFPLEVBQUU7b0JBQ0osb0JBQWlILEVBQS9HLGtCQUFNLEVBQUUsY0FBSSxFQUFFLGtCQUFNLEVBQUUsb0JBQU8sRUFBRSw0QkFBVyxFQUFFLGdDQUFhLEVBQUUsZ0NBQWEsRUFBRSxrREFBcUMsQ0FBQztvQkFDeEgsSUFBSSxDQUFDLFVBQVUsQ0FBQzt3QkFDZCxTQUFTLEVBQUUsK0RBQVE7d0JBQ25CLEtBQUssRUFBRTs0QkFDTCxNQUFNOzRCQUNOLE1BQU07NEJBQ04sSUFBSTs0QkFDSixzQkFBc0I7NEJBQ3RCLE1BQU0sRUFBRSxpQkFBTztnQ0FDYixPQUFPLEdBQUcsa0ZBQW1DLENBQUMsT0FBTyxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7Z0NBQ3hFLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQ0FDckIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDOzRCQUNyQixDQUFDOzRCQUNELFFBQVEsRUFBRSxjQUFNLFdBQUksQ0FBQyxXQUFXLEVBQUUsRUFBbEIsQ0FBa0I7eUJBQ25DO3FCQUNGLENBQUMsQ0FBQztnQkFDTCxDQUFDLEVBQUUsU0FBUyxFQUFDLEtBQUs7Z0JBQ2hCLDJEQUFHLFNBQVMsRUFBQyxZQUFZLHdCQUFlOytDQUN0QyxDQUNDO0lBQ1QsQ0FBQztJQUNILHVCQUFDO0FBQUQsQ0FBQyxDQTdIcUMsK0NBQWUsR0E2SHBEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzVKeUQ7QUFFZjtBQUNGO0FBQ1E7QUFDVTtBQUN2QjtBQUNTO0FBUXRDLFNBQVMsbUJBQW1CLENBQUUsRUFBbUM7UUFBbEMsa0JBQU0sRUFBRSxzQkFBUSxFQUFFLHNCQUFRO0lBQzlELElBQU0sUUFBUSxHQUFHLG9EQUFNLEVBQW9CLENBQUM7SUFDdEMsdUhBQXlELEVBQXhELHdCQUFnQixFQUFFLDJCQUFzQyxDQUFDO0lBQ2hFLElBQU0sb0JBQW9CLEdBQUcsa0RBQVEsQ0FBQyxhQUFhLENBQUM7SUFFcEQsT0FBTyxvRUFBSyxTQUFTLEVBQUMsZUFBZTtRQUNuQywrRkFBeUI7UUFDekIsc0VBQU8sS0FBSyxFQUFFLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBQztZQUMzQiwwRUFDRyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsSUFBSTtnQkFDdEIsbUVBQUksS0FBSyxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxJQUFHLHNEQUFDLHFIQUFNLEtBQU07Z0JBQ3pDLHVFQUFLLHNEQUFDLHFJQUFjLEtBQU07Z0JBQ3pCLG9CQUFvQixJQUFJLG1FQUFJLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxNQUFNLEVBQUMsSUFBRyxzREFBQywySUFBWSxLQUFNO2dCQUN6RSxtRUFBSSxLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUUsTUFBTSxFQUFDLEdBQU8sQ0FDOUIsQ0FDQztZQUNSLDBFQUNHLFFBQVEsQ0FBQyxHQUFHLENBQUMsVUFBQyxPQUFPLEVBQUUsR0FBRztnQkFDM0IsMEVBQUksR0FBRyxFQUFFLEdBQUc7b0JBQ1Y7d0JBQ0Usc0VBQU8sSUFBSSxFQUFDLE1BQU0sRUFBQyxHQUFHLEVBQUUsUUFBUSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksR0FBRyxHQUFHLENBQUMsRUFBRSxRQUFRLEVBQ3BHLFlBQUU7Z0NBQ0EsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFO29DQUNwQyxhQUFhO29DQUNiLElBQU0sS0FBSyxHQUFHLCtDQUFJLFFBQVEsQ0FBQyxDQUFDO29DQUM1QixLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsbURBQUksT0FBTyxJQUFFLElBQUksRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBQyxDQUFDO29DQUNqRCxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7aUNBQ2pCO3FDQUFNO29DQUNMLGFBQWE7b0NBQ2IsUUFBUSxDQUFDLCtDQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFLLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7aUNBQ25FOzRCQUNILENBQUMsR0FDQSxDQUFLO29CQUNSO3dCQUFJLHNFQUNGLElBQUksRUFBQyxNQUFNLEVBQ1gsS0FBSyxFQUFFLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBQyxFQUN0QixLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUssSUFBSSxPQUFPLENBQUMsR0FBRyxFQUNuQyxTQUFTLEVBQUUsWUFBRTtnQ0FDWCxJQUFJLEVBQUUsQ0FBQyxLQUFLLEtBQUssQ0FBQztvQ0FDZixDQUFDLEVBQUUsQ0FBQyxRQUFRO29DQUNaLEdBQUcsS0FBSyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUM7b0NBQzVCLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUMvRDtvQ0FDRSxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztvQ0FDMUIsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO2lDQUNyQjs0QkFDSCxDQUFDLEVBQ0QsUUFBUSxFQUFFLFlBQUU7Z0NBQ1YsSUFBTSxhQUFhLEdBQUcsbURBQ2pCLE9BQU8sSUFDVixHQUFHLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQ3BCLEtBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssR0FDdkIsQ0FBQztnQ0FDRixJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUU7b0NBQ25DLGFBQWE7b0NBQ2IsSUFBTSxLQUFLLEdBQUcsK0NBQUksUUFBUSxDQUFDLENBQUM7b0NBQzVCLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxhQUFhLENBQUM7b0NBQzNCLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztpQ0FDakI7cUNBQU07b0NBQ0wsYUFBYTtvQ0FDYixRQUFRLENBQUMsK0NBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUssUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQztpQ0FDbkU7NEJBQ0gsQ0FBQyxHQUVBLENBQ0U7b0JBRUgsb0JBQW9CLElBQUk7d0JBQ3hCLHVFQUFRLFFBQVEsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssSUFBSSxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxNQUFNLElBQUksTUFBTSxFQUFFLFFBQVEsRUFBRSxZQUFFO2dDQUM5RixJQUFNLEtBQUssR0FBRywrQ0FBSSxRQUFRLENBQUMsQ0FBQztnQ0FDNUIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLG1EQUFJLE9BQU8sSUFBRSxNQUFNLEVBQUUsRUFBRSxDQUFDLE1BQU0sQ0FBQyxLQUFxQyxHQUFDLENBQUM7Z0NBQ25GLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQzs0QkFDbEIsQ0FBQzs0QkFDQyx1RUFBUSxLQUFLLEVBQUMsTUFBTSxJQUFFLHNEQUFDLCtIQUFNLEtBQVU7NEJBQ3ZDLHVFQUFRLEtBQUssRUFBQyxNQUFNLElBQUUsc0RBQUMsNkhBQVUsS0FBVTs0QkFDM0MsdUVBQVEsS0FBSyxFQUFDLE1BQU0sSUFBRSxzREFBQyxxSEFBTSxLQUFVLENBQ2hDLENBQ047b0JBRUw7d0JBQ0UsMkRBQUMsdURBQVUsSUFBQyxPQUFPLEVBQUU7Z0NBQ25CLFFBQVEsQ0FBQywrQ0FBSSxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBSyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDOzRCQUNwRSxDQUFDLEdBQUksQ0FDRixDQUNGO1lBbEVMLENBa0VLLENBQUMsQ0FDQSxDQUNGO1FBQ1Isc0VBQUs7UUFDSixnQkFBZ0IsQ0FBQyxDQUFDO1lBQ2pCLDJEQUFDLG1FQUFPLElBQUMsUUFBUSxFQUFFLDJEQUFDLGdEQUFPLE9BQUcsRUFBRSxhQUFhLEVBQUUsc0RBQUMsNk5BQTJDO2dCQUN6RiwyREFBQyw2REFBYSxJQUNaLE1BQU0sRUFBRSxNQUFNLEVBQ2QsZ0JBQWdCLEVBQUUsUUFBUSxFQUMxQixNQUFNLEVBQUUsY0FBSSwwQkFBbUIsQ0FBQyxLQUFLLENBQUMsRUFBMUIsQ0FBMEIsRUFDdEMsUUFBUSxFQUFFLFVBQUMsRUFBYTs0QkFBWixjQUFJLEVBQUUsZ0JBQUs7d0JBQ3ZCLElBQU0sVUFBVSxHQUF1Qjs0QkFDckMsSUFBSTs0QkFDSixLQUFLOzRCQUNMLEdBQUcsRUFBRSxLQUFLOzRCQUNWLE1BQU0sRUFBRSxNQUFNO3lCQUNmLENBQUM7d0JBQ0YsSUFBTSxLQUFLLEdBQUcsK0NBQUksUUFBUSxDQUFDLENBQUM7d0JBQzVCLEtBQUssQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7d0JBQ3ZCLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQzt3QkFDaEIsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQzdCLENBQUMsR0FBSSxDQUNHLENBQUMsQ0FBQztZQUVaLGtFQUFHLFNBQVMsRUFBQyxLQUFLLEVBQUMsT0FBTyxFQUFFO29CQUMxQixtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDNUIsQ0FBQztnQkFDRCxrRUFBRyxTQUFTLEVBQUMsaUJBQWlCLHdCQUFlLEVBQzNDLHNEQUFDLHFMQUE0QixLQUFLLENBQ2xDO0FBQ1IsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDakk4QjtBQU9zQztBQVFyRTtJQUEwQyw4RUFBc0I7SUFDOUQsOEJBQVksS0FBWTtRQUF4QixZQUNFLGtCQUFNLEtBQUssQ0FBQyxTQUViO1FBREMsS0FBSSxDQUFDLEtBQUssR0FBQyxFQUFFLENBQUM7O0lBQ2hCLENBQUM7SUFFRCxxQ0FBTSxHQUFOO1FBQ1EsbUJBQWtDLEVBQWpDLGNBQUksRUFBRSxzQkFBUSxFQUFFLFlBQWlCLENBQUM7UUFDekMsT0FBTztZQUNMLDZEQUFLLFNBQVMsRUFBQyxlQUFlLElBQzNCLEdBQUc7Z0JBQ0YsNkRBQUssU0FBUyxFQUFDLGtCQUFrQjtvQkFDL0IsNkRBQUssU0FBUyxFQUFDLG9CQUFvQjt3QkFDakMsMkRBQUcsU0FBUyxFQUFDLFVBQVUsRUFBQyxPQUFPLEVBQUUsY0FBSSxXQUFJLENBQUMsVUFBVSxDQUFDO2dDQUNuRCxTQUFTLEVBQUUsZ0ZBQWdCO2dDQUMzQixLQUFLLEVBQUU7b0NBQ0wsR0FBRztvQ0FDSCxNQUFNLEVBQUUsZ0JBQU07d0NBQ1osUUFBUSxDQUFDLEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUM7d0NBQ3pCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztvQ0FDckIsQ0FBQztvQ0FDRCxRQUFRLEVBQUU7d0NBQ1IsUUFBUSxDQUFDLEVBQUMsSUFBSSxFQUFFLFNBQVMsRUFBQyxDQUFDLENBQUM7d0NBQzVCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztvQ0FDckIsQ0FBQztpQ0FDRjs2QkFDRixDQUFDLEVBYm1DLENBYW5DLEdBQU0sQ0FDSjtvQkFDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dCQUNqQywyREFBRyxJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBQyxRQUFRLGdDQUEwQixDQUNuRCxDQUNGLENBRUw7WUFDTixDQUFDLEdBQUcsSUFBSSwyREFBRyxTQUFTLEVBQUMsS0FBSyxFQUFDLE9BQU8sRUFBRSxjQUFJLFdBQUksQ0FBQyxVQUFVLENBQUM7b0JBQ3ZELFNBQVMsRUFBRSxnRkFBZ0I7b0JBQzNCLEtBQUssRUFBRTt3QkFDTCxNQUFNLEVBQUUsZ0JBQU07NEJBQ1osUUFBUSxDQUFDLEVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBQyxDQUFDOzRCQUN4QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7d0JBQ3JCLENBQUM7cUJBQ0Y7aUJBQ0YsQ0FBQyxFQVJ1QyxDQVF2QztnQkFBRSwyREFBRyxTQUFTLEVBQUMsaUJBQWlCLHdCQUFpQjt5REFBcUMsQ0FDbEY7SUFDUixDQUFDO0lBQ0gsMkJBQUM7QUFBRCxDQUFDLENBN0N5QywrQ0FBZSxHQTZDeEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzVEOEI7QUFLVTtBQWdCekM7SUFBcUMseUVBQTBCO0lBQzdELHlCQUFZLEtBQVk7ZUFDdEIsa0JBQU0sS0FBSyxDQUFDO0lBQ2QsQ0FBQztJQUVELGdDQUFNLEdBQU47UUFDUSxtQkFBcUYsRUFBbkYsZ0RBQXFCLEVBQUUsd0JBQVMsRUFBRSw0QkFBVyxFQUFFLGdEQUFvQyxDQUFDO1FBQ3RGLG1CQUF3RixFQUF0RixrQ0FBYyxFQUFFLHNCQUFRLEVBQUUsZ0NBQWEsRUFBRSxrRUFBNkMsQ0FBQztRQUUvRixJQUFNLE9BQU8sR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDaEMsSUFBTSxJQUFJLEdBQTZCLEVBQUUsQ0FBQztRQUMxQyxJQUFNLElBQUksR0FBRyxxQkFBcUIsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUMzQyxJQUFJLEdBQUcsR0FBa0MsSUFBSSxDQUFDO1FBQzlDLE9BQU8sSUFBSSxFQUFFO1lBQ1gsR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBSztnQkFDckIsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFNBQVMsSUFBSSxDQUFDLENBQUMsU0FBUyxDQUFDLFdBQVcsRUFBRSxLQUFLLEtBQUssRUFBbEQsQ0FBa0QsQ0FBQyxDQUFDO2dCQUN0RixJQUFJLEtBQUssR0FBRyxDQUFDO29CQUFFLE9BQU8sSUFBSSxDQUFDO2dCQUMzQixJQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ3ZCLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUN0QixPQUFPLEVBQUUsQ0FBQztZQUNaLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLFdBQUMsSUFBSSxRQUFDLEtBQUssSUFBSSxFQUFWLENBQVUsQ0FBQztnQkFDNUIsTUFBTTtZQUNSLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDaEI7UUFFRCxPQUFPO1lBQ0w7Z0JBQ0U7b0JBQ0UsZ0VBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksbUVBQUksR0FBRyxFQUFFLENBQUMsSUFBRyxDQUFDLENBQU0sRUFBcEIsQ0FBb0IsQ0FBQyxDQUNwQyxDQUNDO2dCQUNSLG1FQUNHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxHQUFHLEVBQUMsQ0FBQyxJQUFLLDJEQUFDLDhDQUFjLElBQUMsR0FBRyxFQUFFLENBQUM7b0JBQ3pDLGdFQUNHLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBQyxXQUFXLEVBQUMsQ0FBQzt3QkFDckIsSUFBTSxVQUFVLEdBQUcsV0FBVyxJQUFJLFNBQVMsSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQ3RGLElBQU0sYUFBYSxHQUFHLFdBQVcsSUFBSSxjQUFjLElBQUksY0FBYyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQzt3QkFDdEYsSUFBTSxVQUFVLEdBQUcsV0FBVyxJQUFJLFdBQVcsSUFBSSxDQUFDLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQzt3QkFDL0UsT0FBTyw0REFDTCxHQUFHLEVBQUUsQ0FBQyxFQUNOLHVCQUF1QixFQUFFLEVBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFDLEVBQ3RFLFNBQVMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0NBQ3pDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQ0FDL0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztvQ0FDWCxjQUFjLENBQUMsQ0FBQztvQ0FDaEIsQ0FBQyxhQUFhLENBQUMsQ0FBQzt3Q0FDZCxZQUFZLEVBQUM7d0NBQ2IsRUFBRSxDQUFDLENBQUMsRUFDTixPQUFPLEVBQUUsUUFBUSxJQUFJLFdBQVcsQ0FBQyxDQUFDO2dDQUNoQyxjQUFJLG9CQUFhLENBQUMsV0FBVyxDQUFDLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUExQyxDQUEwQyxDQUFDLENBQUM7Z0NBQ2hELFNBQVMsRUFDWCxLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7Z0NBQ2pCLFFBQVEsQ0FBQyxDQUFDO29DQUNSLGtNQUE0SyxDQUFDLENBQUM7b0NBQzlLLDhIQUFvSCxDQUFDLENBQUM7Z0NBQ3hILFNBQVMsR0FBSTtvQkFDckIsQ0FBQyxDQUFDLENBQ0M7b0JBQ0oscUJBQXFCLElBQUksZ0VBQ3ZCLEdBQUcsQ0FBQyxHQUFHLENBQUMsVUFBQyxXQUFXLEVBQUMsQ0FBQzt3QkFDckIsSUFBTSxVQUFVLEdBQUcsV0FBVyxJQUFJLFNBQVMsSUFBSSxTQUFTLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQ3RGLE9BQU8sNERBQUksR0FBRyxFQUFFLENBQUMsSUFDZCxVQUFVLENBQUMsQ0FBQyxDQUFDLGtFQUNaLFdBQVcsRUFBRSxzREFBQyx5SUFBZ0IsTUFDOUIsU0FBUyxFQUFDLDZCQUE2QixFQUFDLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxNQUFNLEVBQUMsRUFDOUQsUUFBUSxFQUFFLENBQUMsUUFBUSxFQUNuQixLQUFLLEVBQUUscUJBQXFCLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFDbEQsUUFBUSxFQUFFLDhCQUE4QixJQUFJLENBQzFDLFlBQUUsSUFBSSxxQ0FBOEIsQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQS9ELENBQStELENBQUMsR0FDeEUsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUNUO29CQUFBLENBQUMsQ0FBQyxDQUNSLENBQ1ksRUF4Q0UsQ0F3Q0YsQ0FDbEIsQ0FDSyxDQUNGLENBQ0o7UUFFTixFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2dCQXdDTztTQUFDO0lBQ1gsQ0FBQztJQUNILHNCQUFDO0FBQUQsQ0FBQyxDQTFIb0MsK0NBQWUsR0EwSG5EOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDL0k4QjtBQUNVO0FBT3hDLENBQUM7QUFFSyxJQUFNLFVBQVUsR0FBRyxVQUFDLEVBQTJDO1FBQXpDLG9CQUFPLEVBQUUsd0JBQVMsRUFBRSxnQkFBSyxFQUFFLGdCQUFLO0lBRTNELG9FQUNFLEtBQUssRUFBRSxLQUFLLElBQUksc0RBQUMseUhBQVEsTUFDekIsU0FBUyxFQUFFLGFBQWEsR0FBRyxDQUFDLFNBQVMsSUFBSSxFQUFFLENBQUMsRUFDNUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxHQUFJO0FBSHBDLENBR29DOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNmUDtBQUNrQztBQUVHO0FBQ2hDO0FBQ0k7QUFDRztBQUNBO0FBQzRCO0FBU3ZFO0lBQW1DLHVFQUE0QjtJQUM3RCx1QkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBS2I7UUFKQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsYUFBYSxFQUFFLElBQUk7U0FDcEI7UUFDRCxLQUFJLENBQUMsc0JBQXNCLEdBQUcsS0FBSSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsQ0FBQzs7SUFDdkUsQ0FBQztJQUVELHlDQUFpQixHQUFqQjtRQUNFLHlFQUFtQixDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxLQUFLLENBQUMsc0RBQVMsQ0FBQyxDQUFDO0lBQzlFLENBQUM7SUFFRCw0Q0FBb0IsR0FBcEI7UUFDRSx5RUFBbUIsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUM7SUFDL0QsQ0FBQztJQUVELDhDQUFzQixHQUF0QixVQUF1QixhQUF1QjtRQUM1QyxJQUFNLFdBQVcsR0FBRyxnRUFBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3hDLElBQU0sa0JBQWtCLEdBQUcsZ0VBQVcsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUN0RCxhQUFhLENBQUMsSUFBSSxDQUFDLFVBQUMsQ0FBQyxFQUFDLENBQUMsSUFBSyxrQkFBVyxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUMsSUFBSSxrQkFBa0IsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLEVBQTNDLENBQTJDLENBQUMsQ0FBQztRQUN6RSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsYUFBYSxpQkFBQyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELHFDQUFhLEdBQWIsVUFBYyxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUk7UUFDakMsT0FBTyxDQUFDLG9EQUFDLCtFQUFZLElBQUMsS0FBSyxFQUFFLCtEQUFJLE1BQU0sQ0FBSyxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUMsVUFBVSxJQUN4RixPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNO1lBQ25CLG9FQUFLLFNBQVMsRUFBQyxjQUFjLEVBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxFQUFFO2dCQUMxQyw2REFBSyxTQUFTLEVBQUMsa0JBQWtCO29CQUMvQiw2REFBSyxTQUFTLEVBQUMsK0JBQStCO3dCQUM1QyxvREFBQyxxREFBSSxJQUNILEVBQUUsRUFBRSxjQUFZLE1BQU0sQ0FBQyxFQUFFLFVBQU8sRUFDaEMsU0FBUyxFQUFDLFVBQVUsR0FDcEIsQ0FDRTtvQkFDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CO3dCQUNqQyxvREFBQyxxREFBSSxJQUFDLEVBQUUsRUFBRSxjQUFZLE1BQU0sQ0FBQyxFQUFFLFVBQU8sSUFBRyxNQUFNLENBQUMsSUFBSSxDQUFRLENBQU07b0JBQ2xFLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0IsSUFDaEMsTUFBTSxDQUFDLE1BQU0sSUFBSSw2REFBSyxTQUFTLEVBQUMsYUFBYSxZQUFZLENBQ3REO29CQUNMLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxJQUFJLDZEQUFLLFNBQVMsRUFBQyxvQkFBb0I7d0JBQzVFLDZEQUFLLFNBQVMsRUFBQyxpQkFBaUIsaUJBQWlCLENBQzdDLENBQ0Y7Z0JBQ04sNkRBQUssU0FBUyxFQUFDLG9CQUFvQjtvQkFDakMsK0RBQUksTUFBTSxDQUFDLFdBQVcsQ0FBSyxDQUN2QjtnQkFDTiw2REFBSyxTQUFTLEVBQUMsb0JBQW9CLElBQ2hDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztvQkFDbEIsMkRBQUcsU0FBUyxFQUFDLE9BQU87O3dCQUFlLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSTs7d0JBQUssOERBQWUsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUssQ0FBQyxDQUFDO29CQUN6RywyREFBRyxTQUFTLEVBQUMsT0FBTyxFQUFDLEtBQUssRUFBRSxFQUFDLFNBQVMsRUFBRSxRQUFRLEVBQUMsUUFBTyxDQUN0RCxDQUNGO1FBekJOLENBeUJNLENBQUMsQ0FFUSxDQUNoQjtJQUNILENBQUM7SUFFRCw4QkFBTSxHQUFOO1FBQ1MsNENBQWEsQ0FBZTtRQUVuQyxJQUFNLFNBQVMsR0FBRyxFQUFFLENBQUM7UUFDckIsSUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDO1FBRXpCLElBQUksYUFBYSxFQUFFO1lBQ2pCLElBQU0sSUFBRSxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQztZQUVoQyxhQUFhLENBQUMsT0FBTyxDQUFDLGdCQUFNO2dCQUMxQixJQUFJLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxHQUFHLElBQUksSUFBRSxFQUFFO29CQUN0RCxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2lCQUN4QjtxQkFBTSxJQUFJLE1BQU0sQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxHQUFHLElBQUksSUFBRSxFQUFYLENBQVcsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7b0JBQ3pFLFNBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7aUJBQ3hCO3FCQUFNO29CQUNMLGFBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7aUJBQzVCO1lBQ0gsQ0FBQyxDQUFDLENBQUM7U0FDSjtRQUVELE9BQU8sNkRBQUssU0FBUyxFQUFDLDJDQUEyQztZQUMvRCw2REFBSyxTQUFTLEVBQUMsV0FBVztnQkFDeEIsaUZBQXVCO2dCQUN2Qiw2REFBSyxTQUFTLEVBQUMsd0JBQXdCLElBQ3BDLENBQUMsYUFBYSxDQUFDLENBQUM7b0JBQ2Y7d0JBQUcsb0RBQUMsZ0RBQU8sT0FBRztpREFBMEIsQ0FBQyxDQUFDO29CQUMxQzt3QkFFRSxJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsRUFBRSxhQUFhLEVBQUUsSUFBSSxDQUFDO3dCQUdsRCxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsRUFBRSxjQUFjLEVBQUUsS0FBSyxDQUFDLENBRXpELENBQ0M7Z0JBQ0wsUUFBUSxDQUFDLElBQUksS0FBSyxlQUFlLElBQUksb0RBQUMscURBQUksSUFDekMsU0FBUyxFQUFDLEtBQUssRUFDZixFQUFFLEVBQUMsY0FBYyxFQUNqQixPQUFPLEVBQUUsY0FBSSxhQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBbkIsQ0FBbUIsb0JBRTNCLENBQ0gsQ0FDRjtJQUNSLENBQUM7SUFDSCxvQkFBQztBQUFELENBQUMsQ0F0R2tDLCtDQUFlLEdBc0dqRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3ZIOEI7QUFFd0M7QUFDbEI7QUFnQnJEO0lBQXVDLDJFQUE0QjtJQUNqRSwyQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBRWI7UUFEQyxLQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQzs7SUFDbEIsQ0FBQztJQUVELGtDQUFNLEdBQU47UUFBQSxpQkErQkM7UUE5Qk8sbUJBQTZFLEVBQTVFLG9CQUFPLEVBQUUsZ0JBQUssRUFBRSx3QkFBUyxFQUFFLHNCQUFRLEVBQUUsNEJBQVcsRUFBRSw4QkFBMEIsQ0FBQztRQUNwRixJQUFNLGNBQWMsR0FBRyxrRUFBYSxDQUFDLE9BQU8sRUFBRSxXQUFDLElBQUksUUFBQyxDQUFDLEtBQUssSUFBSSxTQUFTLEVBQXBCLENBQW9CLENBQUMsQ0FBQztRQUN6RSxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQzNDLE9BQU8sb0RBQUMsK0VBQVksSUFBQyxLQUFLLEVBQUUsK0RBQUksS0FBSyxDQUFLLEVBQUUsU0FBUyxFQUFDLFFBQVEsSUFDekQsTUFBTSxDQUFDLEdBQUcsQ0FBQyxlQUFLLElBQUksMkRBQUMsOENBQWMsSUFBQyxHQUFHLEVBQUUsS0FBSztZQUM1QyxNQUFNLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFBRSwrREFBSztnQkFBQSxnRUFBSyxLQUFLLENBQU07Z0JBQUEsK0RBQUssQ0FBRztZQUM1RCxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFNO2dCQUMvQixJQUFNLFFBQVEsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLEtBQUssTUFBTSxDQUFDLEVBQUUsRUFBZixDQUFlLENBQUMsQ0FBQztnQkFDdEQsSUFBTSxVQUFVLEdBQUcsV0FBVyxJQUFJLENBQUMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUMzRCxJQUFNLFdBQVcsR0FBRyxZQUFZLElBQUksWUFBWSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDNUQsT0FBTyw2REFBSyxTQUFTLEVBQUMsa0JBQWtCLEVBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFO3dCQUNoRSxlQUFRLElBQUksS0FBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQztvQkFBMUQsQ0FBMEQ7b0JBQzFELDZEQUFLLFNBQVMsRUFBRSwyQkFBMkI7NEJBQ3pDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQzs0QkFDL0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQ0FDekMsWUFBWSxFQUFDO2dDQUNiLEVBQUUsQ0FBQyxDQUFDOzRCQUNOLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUMvQixLQUFLLEVBQUUsVUFBVSxDQUFDLENBQUM7NEJBQ2pCLFFBQVEsQ0FBQyxDQUFDO2dDQUNSLGtNQUE0SyxDQUFDLENBQUM7Z0NBQzlLLDhIQUFvSCxDQUFDLENBQUM7NEJBQ3hILFNBQVM7d0JBQ1gsMkRBQUcsdUJBQXVCLEVBQUUsRUFBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLElBQUksRUFBQyxHQUFJO3dCQUNyRCwrREFBTSxDQUNGLENBQ0YsQ0FBQztZQUNULENBQUMsQ0FBQyxDQUNhLEVBeEJJLENBd0JKLENBQUMsQ0FDUDtJQUNqQixDQUFDO0lBQ0gsd0JBQUM7QUFBRCxDQUFDLENBdENzQywrQ0FBZSxHQXNDckQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN6RHlCO0FBQ2U7QUFDUDtBQUNhO0FBQ047QUFDa0M7QUFTcEUsU0FBUyxpQkFBaUIsQ0FBRSxFQUEwRDtRQUF6RCxrQkFBTSxFQUFFLDBCQUFVLEVBQUUsNENBQW1CLEVBQUUsc0JBQVE7SUFFbkYsb0JBQW9CO0lBQ3BCLElBQU0sV0FBVyxHQUFHLE1BQU0sS0FBSyxLQUFLLElBQUksZ0ZBQWlCLENBQUMsVUFBVSxDQUFDLEVBQUMsQ0FBQyxnRkFBaUIsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRzFHLHlDQUF5QztJQUNsQzs7O2lDQUFpQixDQUdkLENBQUMsOERBQThEO0lBRXpFLHFEQUFxRDtJQUNyRCxJQUFNLFdBQVcsR0FBRyxpQkFBaUIsRUFBQyxDQUFDLG9EQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQztRQUNuRixVQUFVLEVBQUUsaUJBQWlCO1FBQzdCLFVBQVU7S0FDWCxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQztJQUVqQix3REFBd0Q7SUFDeEQsSUFBTSxPQUFPLEdBQUcsV0FBVyxDQUFDLEdBQUcsQ0FBQyxZQUFFLElBQUksUUFBQztRQUNyQyxLQUFLLEVBQUUsRUFBRSxDQUFDLGdCQUFnQjtRQUMxQixLQUFLLEVBQUUsRUFBRSxDQUFDLGdCQUFnQjtLQUMzQixDQUFDLEVBSG9DLENBR3BDLENBQUMsQ0FBQztJQUVKLDJCQUEyQjtJQUMzQixPQUFPLDJEQUFDLG9EQUFNLElBQ1YsT0FBTyxFQUFFLElBQUksRUFDYixPQUFPLEVBQUUsT0FBTyxFQUNoQixLQUFLLEVBQUUsbUJBQW1CLENBQUMsR0FBRyxDQUFDLGVBQUssSUFBSSxRQUFDLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFDLENBQUMsRUFBOUIsQ0FBOEIsQ0FBQyxFQUN2RSxXQUFXLEVBQUUsc0RBQUMsbUxBQXFDLE1BQ25ELGdCQUFnQixFQUFFLGNBQUksNkRBQUMsaU5BQStDLE1BQWhELENBQWdELEVBQ3RFLFFBQVEsRUFBRSxVQUFDLE9BQThDO1lBQ3ZELFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBTztvQkFBTixnQkFBSztnQkFBTSxZQUFLO1lBQUwsQ0FBSyxDQUFDLENBQUMsQ0FBQztRQUM1QyxDQUFDLEdBQUk7QUFDWCxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNoRHlCO0FBRWU7QUFFTTtBQUN1QjtBQUN2QjtBQUNiO0FBQ2lDO0FBQ0c7QUFTL0QsU0FBUyxhQUFhLENBQUUsRUFBbUQ7SUFDaEYsRUFBRTtJQUNGLHlEQUF5RDtJQUN6RCxFQUFFO1FBSDRCLGtCQUFNLEVBQUUsc0NBQWdCLEVBQUUsc0JBQVEsRUFBRSxrQkFBTTtJQUt4RSxvQkFBb0I7SUFDcEIsSUFBTSxXQUFXLEdBQUcsTUFBTSxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsMkVBQVksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRXpELGlDQUFpQztJQUMxQiw4SUFBaUIsQ0FBNkQ7SUFFckYsMEJBQTBCO0lBQzFCLElBQU0sV0FBVyxHQUFpQixpQkFBaUIsQ0FBQyxDQUFDO1FBQ25ELG9EQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFDLFVBQVUsRUFBRSxpQkFBaUIsRUFBQyxDQUFDLENBQUMsQ0FBQztRQUMzRSxXQUFXLENBQUM7SUFFZCxJQUFJLFdBQVcsR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBd0Q7WUFBdkQsc0NBQWdCLEVBQUUsb0NBQWUsRUFBRSw0Q0FBbUI7UUFBTSxRQUFDO1lBQy9GLEtBQUssRUFBSyxnQkFBZ0IsU0FBSSxlQUFpQjtZQUMvQyxLQUFLLEVBQUUsbUJBQW1CO1NBQzNCLENBQUM7SUFIOEYsQ0FHOUYsQ0FBQyxDQUFDO0lBRUoseUZBQXlGO0lBQ3pGLElBQU0sY0FBYyxHQUFHLGdGQUF3QixDQUFDLG9EQUFHLENBQUMsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ3pFLElBQUksY0FBYyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEtBQUssS0FBSyxvREFBRyxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQWhDLENBQWdDLENBQUMsRUFBRTtRQUM5RSxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUMsS0FBSyxFQUFFLG9EQUFHLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxLQUFLLEVBQUUsb0RBQUcsQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztLQUNyRjtJQUVELHdDQUF3QztJQUN4QyxJQUFNLFVBQVUsR0FBRyxrRUFBYSxDQUFDLGdCQUFnQixFQUFFLFdBQUMsSUFBSSxRQUFDLENBQUMsS0FBSyxFQUFQLENBQU8sQ0FBQyxDQUFDO0lBQ2pFLFdBQVcsR0FBRyxXQUFXO1NBQ3RCLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFwQixDQUFvQixDQUFDLENBQUMsNEJBQTRCO1NBQzlELElBQUksQ0FBQyxpRUFBWSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsb0RBQUcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsZUFBZTtJQUVqRSxtQkFBbUI7SUFDbkIsT0FBTywyREFBQyxvREFBTSxJQUNaLE9BQU8sRUFBRSxLQUFLLEVBQ2QsT0FBTyxFQUFFLFdBQVcsRUFDcEIsaUJBQWlCLEVBQUUsSUFBSSxFQUN2QixTQUFTLEVBQUUsSUFBSSxFQUNmLE1BQU0sRUFBRSxjQUFJLGFBQU0sRUFBRSxFQUFSLENBQVEsRUFDcEIsV0FBVyxFQUFFLHNEQUFDLHlMQUE4QixNQUM1QyxnQkFBZ0IsRUFBRSxjQUFJLDZEQUFDLDZOQUEyQyxNQUE1QyxDQUE0QyxFQUNsRSxRQUFRLEVBQUUsZ0JBQU07WUFDUixlQUE4QixFQUE3QixnQkFBSyxFQUFFLGdCQUFzQixDQUFDO1lBQ3JDLFFBQVEsQ0FBQyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7UUFDeEMsQ0FBQyxHQUFJO0FBQ1QsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7QUNoRUQ7QUFBQTtBQUFBO0FBQUE7QUFBK0I7QUFFeEIsSUFBTSxPQUFPLEdBQUcsY0FBSztJQUFNLDJEQUFHLFNBQVMsRUFBQyx1QkFBdUIsaUJBQWEsTUFBTSxHQUFLO2FBQWEsRUFBL0UsQ0FBK0UsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0Y3RTtBQUUyQjtBQUNNO0FBQ087QUFVdkU7SUFBd0MsNEVBQTRCO0lBQ2xFLDRCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FJYjtRQUhDLEtBQUksQ0FBQyxLQUFLLEdBQUc7WUFDWCxNQUFNLEVBQUUsS0FBSztTQUNkLENBQUM7O0lBQ0osQ0FBQztJQUVELG1DQUFNLEdBQU47UUFDVSw4QkFBTSxDQUFnQjtRQUN0Qiw4QkFBTSxDQUFnQjtRQUM5QixJQUFNLElBQUksR0FBRyxFQUFFLENBQUM7UUFDaEIsSUFBTSxVQUFVLEdBQUcsNkVBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUV6QyxJQUFJLENBQUMsSUFBSSxDQUFDLDREQUFJLEdBQUcsRUFBQyxnQkFBZ0IsRUFBQyxTQUFTLEVBQUMsb0JBQW9CO1lBQUMsNERBQUksT0FBTyxFQUFFLENBQUMsNkJBQXdCLENBQUssQ0FBQyxDQUFDO1FBQy9HLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLFVBQUMsRUFBRSxFQUFDLEdBQUcsSUFBSyxXQUFJLENBQUMsSUFBSSxDQUFDLDREQUFJLEdBQUcsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDdEc7Z0JBQUksMkRBQUcsU0FBUyxFQUFDLGNBQWMsRUFBQyx1QkFBdUIsRUFBRSxFQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsSUFBSSxFQUFDLEdBQUcsQ0FBSztZQUNsRjtnQkFBSSwrREFBSSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFLLENBQUssQ0FDL0MsQ0FBQyxFQUhvQyxDQUdwQyxDQUFDLENBQUM7UUFFUixJQUFJLENBQUMsSUFBSSxDQUFDLDREQUFJLEdBQUcsRUFBQyxXQUFXLEVBQUMsU0FBUyxFQUFDLG9CQUFvQjtZQUFDLDREQUFJLE9BQU8sRUFBRSxDQUFDLHlCQUFlLENBQUssQ0FBQyxDQUFDO1FBQ2pHLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLFVBQUMsT0FBTyxFQUFDLEdBQUcsSUFBSyxXQUFJLENBQUMsSUFBSSxDQUFDLDREQUFJLEdBQUcsRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFLFNBQVMsRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDM0c7Z0JBQUksMkRBQUcsU0FBUyxFQUFDLGFBQWEsRUFBQyx1QkFBdUIsRUFBRSxFQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFDLEdBQUcsQ0FBSztZQUN0RjtnQkFBSSwrREFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFLLENBQUssQ0FDcEQsQ0FBQyxFQUhvQyxDQUdwQyxDQUFDLENBQUM7UUFFUixJQUFJLENBQUMsSUFBSSxDQUFDLDREQUFJLEdBQUcsRUFBQyxpQkFBaUIsRUFBQyxTQUFTLEVBQUMsb0JBQW9CO1lBQUMsNERBQUksT0FBTyxFQUFFLENBQUMsaUNBQXVCLENBQUssQ0FBQyxDQUFDO1FBQzlHLHFFQUFlLENBQUMsT0FBTyxDQUFDLFVBQUMsaUJBQWlCLEVBQUUsR0FBRyxJQUFLLFdBQUksQ0FBQyxJQUFJLENBQUMsNERBQUksR0FBRyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDN0g7Z0JBQUksMkRBQUcsU0FBUyxFQUFDLGFBQWEsSUFBRSxpQkFBaUIsQ0FBSyxDQUFLO1lBQzNEO2dCQUFJLCtEQUFJLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFLLENBQUssQ0FDM0QsQ0FBQyxFQUgrQyxDQUcvQyxDQUFDLENBQUM7UUFFUixPQUFPLG9EQUFDLCtFQUFZLElBQ2xCLFNBQVMsRUFBQyxRQUFRLEVBQ2xCLEtBQUssRUFBRSw4RkFBOEIsRUFDckMsZ0JBQWdCLEVBQUMsc0JBQXNCO1lBQ3JDLG1JQUE4RDtZQUM5RDtnQkFBTyxtRUFBUSxJQUFJLENBQVMsQ0FBUSxDQUN6QjtJQUNqQixDQUFDO0lBQ0gseUJBQUM7QUFBRCxDQUFDLENBeEN1QywrQ0FBZSxHQXdDdEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3RENkM7QUFLSztBQUNWO0FBR2xDLFNBQWUsbUJBQW1CLENBQUMsZUFBd0IsRUFBRSxlQUFnQyxFQUFFLE9BQWlCOzs7Ozs7d0JBRW5HLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFVBQVUsRUFBRSxlQUFlLENBQUMsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLENBQUMsaUJBQWlCLEVBQUUsV0FBVyxDQUFDLEVBQUUsQ0FBQzs7b0JBRC9ILG9DQUFvQztvQkFDcEMsZUFBZSxHQUFHLFNBQTZHLENBQUM7b0JBR2hHLHFCQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLGdFQUFVLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTs0QkFDNUcsT0FBTyxFQUFFO2dDQUNQLGdCQUFnQjtnQ0FDaEIsdUJBQXVCOzZCQUN4Qjt5QkFDRixDQUFDLEVBTDBGLENBSzFGLENBQUMsQ0FBQzs7b0JBTEUsdUJBQXVCLEdBQUcsU0FLNUI7b0JBRUosT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFZLGVBQWUsQ0FBQyxJQUFJLG1CQUFjLHVCQUF1QixDQUFDLEdBQUcsQ0FBQyxVQUFDLEVBQU07NEJBQUwsY0FBSTt3QkFBTSxXQUFJO29CQUFKLENBQUksQ0FBRyxDQUFDLENBQUM7b0JBRTNFLHFCQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsR0FBRyxDQUFFLFVBQU0sY0FBYzs7Ozs7OzRDQUNqRyxRQUFRLEVBQUUsY0FBYzs7d0NBQ2IscUJBQU0sd0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQVMsU0FBUyxFQUFFLEVBQUUsSUFBSSxFQUFFLGNBQWMsQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsV0FBVyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDOzRDQUYxQyx1QkFFckcsWUFBUyxHQUFFLFNBQW9JOytDQUMvSTs7OzZCQUFBLENBQUMsQ0FBQzs7b0JBSEUsVUFBVSxHQUFnQixTQUc1QjtvQkFFSjs7Ozs7OzhCQU1VO29CQUNSLHFCQUFNLHVFQUFjLENBQUMsZUFBZSxFQUFFLFVBQVUsRUFBRSxlQUFlLEVBQUUsT0FBTyxDQUFDOztvQkFQN0U7Ozs7Ozs4QkFNVTtvQkFDUixTQUEyRSxDQUFDOzs7OztDQUUvRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqQ3lGO0FBRXhDO0FBQ0o7QUFJOUMsU0FBUyxzQkFBc0IsQ0FBQyxTQUEwQixFQUFFLFFBQWtCOztJQUM1RSxJQUFNLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBTSxDQUFDO0lBQ2pDLElBQU0sUUFBUSxHQUFHLElBQUksR0FBRyxFQUFjLENBQUM7SUFDdkMsSUFBTSxRQUFRLEdBQUcsSUFBSSxHQUFHLEVBQU0sQ0FBQztJQUUvQixRQUFRLENBQUMsT0FBTyxDQUFDLGlCQUFPO1FBQ3RCLE9BQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDekIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDM0IsSUFBTSxFQUFFLEdBQUcsb0VBQVUsRUFBRSxDQUFDO1lBQ3hCLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBVyxFQUFFLGdCQUFXLE9BQVMsQ0FBQyxDQUFDO1lBQy9DLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQzFCLFFBQVEsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDbEI7YUFBTTtZQUNMLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUMvQztJQUNILENBQUMsQ0FBQyxDQUFDOztRQUVILEtBQStCLGlFQUFTLENBQUMsT0FBTyxFQUFFLDZDQUFFO1lBQXpDLGtFQUFnQixFQUFmLGVBQU8sRUFBRSxhQUFLO1lBQ3hCLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtnQkFDcEMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUN2QjtTQUNGOzs7Ozs7Ozs7SUFFRCxPQUFPO1FBQ0wsVUFBVTtRQUNWLFFBQVE7UUFDUixRQUFRO0tBQ1Q7QUFDSCxDQUFDO0FBRUQsSUFBSSxhQUFhLEdBQUcsQ0FBQyxDQUFDO0FBQ3RCLFNBQVMsWUFBWTtJQUNuQixPQUFPLGNBQWMsR0FBRyxDQUFDLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDNUMsQ0FBQztBQUVELElBQU0sU0FBUyxHQUFHLElBQUksR0FBRztBQUN2QixtRkFBbUY7QUFDbkYsQ0FBQyx5aEJBQXloQjtJQUMxaEIsUUFBUSxDQUFDLENBQUMsK0RBQStEO0tBQ3hFLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBRWYsU0FBUyxVQUFVLENBQUMsSUFBWTtJQUM5QixPQUFPLElBQUksR0FBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUM7U0FDbEYsR0FBRyxDQUFDLGdCQUFNLElBQUksYUFBTSxDQUFDLElBQUksRUFBRSxFQUFiLENBQWEsQ0FBQztTQUM1QixNQUFNLENBQUMsZ0JBQU0sSUFBSSxRQUFDLENBQUMsTUFBTSxFQUFSLENBQVEsQ0FBQztTQUMxQixNQUFNLENBQUMsZ0JBQU0sSUFBSSxRQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQXRCLENBQXNCLENBQUMsQ0FDMUMsQ0FBQztBQUNKLENBQUM7QUFFRCxTQUFTLFVBQVUsQ0FBQyxJQUFZO0lBQzlCLElBQU0sR0FBRyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDMUMsR0FBRyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7SUFDckIsT0FBTyxFQUFFLEdBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQztBQUMxQixDQUFDO0FBRUQsU0FBUyxlQUFlLENBQ3RCLE9BQXlELEVBQ3pELFFBQThDLEVBQzlDLFFBQXlCLEVBQ3pCLFFBQWdCLEVBQ2hCLE1BQWU7SUFRZixJQUFNLFlBQVksR0FBRyxJQUFJLEdBQUcsRUFReEIsQ0FBQztJQUNMLE9BQU8sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNLElBQUksUUFBQyxtREFBSSxNQUFNLElBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUUsRUFBdkMsQ0FBdUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFDLEVBQU07WUFBTCxjQUFJO1FBQU0sUUFBQyxDQUFDLElBQUk7SUFBTixDQUFNLENBQUMsQ0FBQztJQUNwRyxJQUFNLE1BQU0sR0FBRyxJQUFJLEdBQUcsRUFBOEMsQ0FBQztJQUNyRSxRQUFRLENBQUMsT0FBTyxDQUFDLGNBQUksSUFBSSxhQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQTNCLENBQTJCLENBQUMsQ0FBQztJQUN0RCxJQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsRUFBMEQsQ0FBQztJQUNoRixPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFNLElBQUksWUFBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxFQUE5QixDQUE4QixDQUFDLENBQUM7SUFDMUQsOENBQThDO0lBQzlDLE9BQU8sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLGdCQUFNLElBQUksUUFBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBeEIsQ0FBd0IsQ0FBQyxDQUFDO0lBQzdELFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLGNBQUksSUFBSSxRQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFyQixDQUFxQixDQUFDLENBQUM7SUFFMUQseUlBQXlJO0lBRXpJLDhFQUE4RTtJQUM5RSxPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFNLElBQUksbUJBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRTtRQUNwRCxTQUFTLEVBQUUsTUFBTSxDQUFDLFNBQVM7UUFDM0IsT0FBTyxFQUFFLE1BQU0sQ0FBQyxJQUFJO1FBQ3BCLE9BQU8sRUFBRSxVQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQztRQUNoQyxVQUFVLEVBQUUsQ0FBQztLQUNkLENBQUMsRUFMd0IsQ0FLeEIsQ0FBQyxDQUFDO0lBQ0osMkRBQTJEO0lBQzNELElBQU0sWUFBWSxHQUF5QyxFQUFFLENBQUM7SUFDOUQsT0FBTyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtRQUMxQixJQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUIsSUFBTSxTQUFTLEdBQUcsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3pDLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDZCxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzVCO2FBQU07WUFDTCxJQUFJLFNBQVMsQ0FBQyxPQUFPLEVBQUU7Z0JBQ3JCLDJCQUEyQjtnQkFDM0IsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLENBQUMsU0FBUyxFQUFDLENBQUMsQ0FBQzthQUMxRTtZQUNELElBQU0sSUFBSSxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQzVDLCtCQUErQjtZQUMvQixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7WUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsWUFBWSxDQUFDO1lBQ3pDLElBQUksQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDekM7UUFDRCxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7S0FDbEI7SUFDRCwyRUFBMkU7SUFDM0UsNEVBQTRFO0lBQzVFLFlBQVksQ0FBQyxPQUFPLENBQUMsa0JBQVE7UUFDM0IsWUFBWSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEVBQUUsRUFBRTtZQUMvQixLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO1lBQ2xDLE9BQU8sRUFBRSxRQUFRLENBQUMsSUFBSTtZQUN0QixTQUFTLEVBQUUsUUFBUSxDQUFDLFNBQVM7WUFDN0IsVUFBVSxFQUFFLENBQUM7WUFDYixPQUFPLEVBQUUsSUFBSSxHQUFHLEVBQVU7U0FBQyxDQUFDO0lBQ2hDLENBQUMsQ0FBQyxDQUFDO0lBRUgsa0JBQWtCO0lBQ2xCLFlBQVksQ0FBQyxPQUFPLENBQUMsZUFBSztRQUNqQiwyQkFBTyxFQUFFLHVCQUFPLENBQVU7UUFDakMsSUFBSSxPQUFPLElBQUksT0FBTyxFQUFFO1lBQ3RCLElBQUksK0NBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSywrQ0FBSSxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUM3RSxLQUFLLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQzthQUN4QjtTQUNGO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSwrQ0FBSSxZQUFZLENBQUMsTUFBTSxFQUFFLEVBQUUsR0FBRyxDQUFDLFVBQUMsRUFBa0I7WUFBakIsb0JBQU8sRUFBRSxvQkFBTztRQUFNLE9BQUcsK0NBQUksT0FBTyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBSyxPQUFTO0lBQXZDLENBQXVDLENBQUMsQ0FBQyxDQUFDO0lBRTdILE9BQU8sWUFBWSxDQUFDO0lBRXBCLFNBQVMsYUFBYSxDQUFDLE9BQTJDO1FBQ2hFLElBQU0sVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDNUMsSUFBTSxnQkFBZ0IsR0FBRywrQ0FBSSxZQUFZLENBQUMsT0FBTyxFQUFFLEVBQ2hELE1BQU0sQ0FBQyxVQUFDLEVBQU87Z0JBQVAsd0RBQU8sRUFBTixVQUFFLEVBQUUsU0FBQztZQUFNLFFBQUMsQ0FBQyxTQUFTLEtBQUssT0FBTyxDQUFDLFNBQVM7UUFBakMsQ0FBaUMsQ0FBQzthQUN0RCxHQUFHLENBQUMsVUFBQyxFQUErQztnQkFBL0Msd0RBQStDLEVBQTlDLFVBQUUsRUFBRSxVQUF5QyxFQUF4Qyx3QkFBUyxFQUFFLDBCQUFVLEVBQUUsb0JBQU8sRUFBRSxvQkFBTztZQUFPLFFBQUM7Z0JBQ3pELEVBQUU7Z0JBQ0YsU0FBUztnQkFDVCxVQUFVO2dCQUNWLE9BQU87Z0JBQ1AsWUFBWSxFQUFFLGFBQWEsQ0FBQyxVQUFVLEVBQUUsT0FBTyxDQUFDO2FBQ2pELENBQUM7UUFOd0QsQ0FNeEQsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLFlBQVksSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxVQUFVLElBQUksRUFBRSxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDLEVBQTVFLENBQTRFLENBQUMsQ0FBQztRQUNqRyxPQUFPLGdCQUFnQixDQUFDLElBQUksQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDLElBQUssUUFBQyxDQUFDLFlBQVksR0FBRyxDQUFDLENBQUMsWUFBWSxFQUEvQixDQUErQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxpQkFBaUI7SUFDL0YsQ0FBQztJQUVELFNBQVMsYUFBYSxDQUFDLFFBQXFCLEVBQUUsUUFBcUI7UUFDakUsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLENBQUM7WUFBRSxPQUFPLENBQUMsQ0FBQztRQUN6RCxJQUFJLE9BQU8sR0FBRyxDQUFDLENBQUM7UUFDaEIsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLFFBQVEsQ0FBQyxPQUFPLENBQUMsY0FBSTtZQUNuQixJQUFJLFFBQVEsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDO2dCQUFFLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBQ0gsUUFBUSxDQUFDLE9BQU8sQ0FBQyxjQUFJO1lBQ25CLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUM7Z0JBQUUsRUFBRSxPQUFPLENBQUM7UUFDcEMsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQyxJQUFJLEVBQUUsT0FBTyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ3RGLENBQUM7SUFFRDs7Ozs7Ozs7Ozs7OzBCQVlzQjtBQUN4QixDQUFDO0FBRU0sU0FBZSxjQUFjLENBQUMsZUFBd0IsRUFBRSxVQUF1QixFQUFFLGVBQWdDLEVBQUUsT0FBaUI7O1FBeUp6SSxTQUFTLHFCQUFxQixDQUM1QixNQUFjLEVBQ2QsY0FBOEIsRUFDOUIsWUFHQztZQUVELElBQU0sV0FBVyxHQUFHLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkQsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDOUIsbUJBQW1CLENBQUMsT0FBTyxDQUFDLFVBQUMsRUFBZ0IsRUFBRSxLQUFLO29CQUF0QixnQkFBSyxFQUFFLG9CQUFPO2dCQUMxQyw2RkFBNkY7Z0JBQzdGLE9BQU8sQ0FBQyxJQUFJLENBQUM7b0JBQ1gsU0FBUyxFQUFFLFlBQUU7d0JBQ1gsSUFBSSxPQUFPOzRCQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQyxDQUFDO3dCQUNsRSxJQUFJLEtBQUs7NEJBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQ2hFLENBQUM7aUJBQ0YsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7WUFDSCxNQUFNLENBQUMsY0FBYyxHQUFHLGVBQWUsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLGNBQUksSUFBSSxzQkFBZSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBekIsQ0FBeUIsQ0FBQyxDQUFDO1lBRWxGLDRDQUFZLEVBQUUsd0NBQVksQ0FBaUI7WUFFbEQsa0JBQWtCO1lBQ2xCLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBQyxFQUFvQyxFQUFFLEtBQUs7b0JBQTFDLGdCQUFLLEVBQUUsb0JBQU8sRUFBRSxvQkFBTyxFQUFFLHdCQUFTO2dCQUN2RCxPQUFPLENBQUMsSUFBSSxDQUFDO29CQUNYLE1BQU0sRUFBRSxXQUFXLElBQUksQ0FDckIsT0FBTyxDQUFDLENBQUM7d0JBQ1AsT0FBTyxDQUFDLENBQUM7NEJBQ1AsU0FBUyxDQUFDLENBQUM7Z0NBQ1QsK0NBQXFDLENBQUMsQ0FBQztnQ0FDdkMsbUNBQThCLENBQUMsQ0FBQzs0QkFDbEMsa0NBQTZCLENBQUMsQ0FBQzt3QkFDakMsNkJBQXdCLENBQUM7b0JBQzdCLE9BQU8sRUFBRSxTQUFPLE1BQU0sQ0FBQyxJQUFJLHNCQUFnQixPQUFPLElBQUksRUFBRSx3QkFBaUIsT0FBTyxJQUFJLEVBQUUsQ0FBRTtvQkFDeEYsU0FBUyxFQUFFLFlBQUU7d0JBQ1gsSUFBSSxLQUFLLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7NEJBQzFELElBQU0sRUFBRSxHQUFtQjtnQ0FDekIsRUFBRSxFQUFFLEtBQUs7Z0NBQ1QsSUFBSSxFQUFFLE9BQU87Z0NBQ2IsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDO2dDQUNwQixRQUFRLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTs2QkFDckIsQ0FBQzs0QkFDRixFQUFFLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLEVBQUUsQ0FBQyxDQUFDOzRCQUM5QixVQUFVLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO3lCQUN2Qjt3QkFDRCxJQUFJLE9BQU87NEJBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLEVBQUUsRUFBRSxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsQ0FBQzt3QkFDdkUsSUFBSSxLQUFLOzRCQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQ3JFLENBQUM7aUJBQ0YsQ0FBQztZQUNKLENBQUMsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxDQUFDLG1CQUFtQixHQUFHLGNBQWMsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBTTtvQkFBTCxjQUFJO2dCQUFNLGlCQUFVLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQztZQUFwQixDQUFvQixDQUFDLENBQUM7WUFFakcseUJBQXlCO1lBQ3pCLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBQyxFQUErQyxFQUFFLEtBQUs7b0JBQXJELGdCQUFLLEVBQUUsb0JBQU8sRUFBRSx3QkFBUyxFQUFFLG9CQUFPLEVBQUUsd0JBQVM7Z0JBQ2xFLE9BQU8sQ0FBQyxJQUFJLENBQUM7b0JBQ1gsTUFBTSxFQUFFLFdBQVcsSUFBSSxDQUNyQixPQUFPLENBQUMsQ0FBQzt3QkFDUCxPQUFPLENBQUMsQ0FBQzs0QkFDUCxTQUFTLENBQUMsQ0FBQztnQ0FDVCxxQ0FBZ0MsRUFBQztnQ0FDakMseUJBQXlCLENBQUMsQ0FBQzs0QkFDN0Isd0JBQXdCLENBQUMsQ0FBQzt3QkFDNUIsbUJBQW1CLENBQ3RCO29CQUNELE9BQU8sRUFBRSxTQUFPLE1BQU0sQ0FBQyxJQUFJLHNCQUFnQixPQUFPLElBQUksRUFBRSx3QkFBaUIsT0FBTyxJQUFJLEVBQUUsQ0FBRTtvQkFDeEYsU0FBUyxFQUFFLFlBQUU7d0JBQ1gsSUFBSSxLQUFLLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7NEJBQzFELElBQU0sRUFBRSxHQUF5QjtnQ0FDL0IsRUFBRSxFQUFFLEtBQUs7Z0NBQ1QsSUFBSSxFQUFFLE9BQU87Z0NBQ2IsU0FBUztnQ0FDVCxHQUFHLEVBQUUsQ0FBQyxhQUFhLENBQUM7Z0NBQ3BCLFFBQVEsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFOzZCQUNyQixDQUFDOzRCQUNGLE9BQU8sQ0FBQyxHQUFHLENBQUMsa0NBQWdDLEtBQUssVUFBSyxPQUFTLENBQUMsQ0FBQzs0QkFDakUsRUFBRSxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsRUFBRSxFQUFFLENBQUMsQ0FBQzs0QkFDckMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQzt5QkFDdkI7d0JBQ0QsSUFBSSxPQUFPOzRCQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxFQUFFLEVBQUUsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLENBQUM7d0JBQzlFLElBQUksS0FBSzs0QkFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFBRSxNQUFNLENBQUMsRUFBRSxFQUFFLHVCQUF1QixFQUFFLEtBQUssQ0FBQyxDQUFDO29CQUM1RSxDQUFDO2lCQUNGLENBQUMsQ0FBQztZQUNMLENBQUMsQ0FBQyxDQUFDO1lBQ0gsTUFBTSxDQUFDLDBCQUEwQjtnQkFDL0IsY0FBYyxDQUFDLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxZQUFFLElBQUksaUJBQVUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUF2QixDQUF1QixDQUFDLENBQUM7WUFFMUUsbUZBQW1GO1lBQ25GLElBQUksbUJBQW1CLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSSxZQUFZLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSSxZQUFZLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBRTtnQkFDbEYsT0FBTyxDQUFDLElBQUksQ0FBQztvQkFDWCxNQUFNLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUMscUJBQXFCO29CQUM3RSxPQUFPLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7d0JBQ3hCLE1BQU0sQ0FBQyxJQUFJLGtCQUFZLE1BQU0sQ0FBQyxNQUFNLElBQUksWUFBWSx5QkFBa0IsTUFBTSxDQUFDLFdBQVcsSUFBSSxFQUFFLENBQUUsQ0FBQyxDQUFDO3dCQUNyRyxLQUFHLE1BQU0sQ0FBQyxJQUFNO29CQUNsQixTQUFTLEVBQUUsWUFBRSxJQUFJLFNBQUUsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxFQUF6QixDQUF5QjtpQkFDM0MsQ0FBQyxDQUFDO2FBQ0o7UUFDSCxDQUFDO1FBRUQsU0FBUztRQUNULGlGQUFpRjtRQUNqRiw4QkFBOEI7UUFDOUIsb0VBQW9FO1FBQ3BFLG9EQUFvRDtRQUNwRCx3SUFBd0k7UUFDeEkseUVBQXlFO1FBQ3pFLGdGQUFnRjtRQUNoRixVQUFVO1FBQ1YsdUlBQXVJO1FBQ3ZJLG1GQUFtRjtRQUNuRiw4REFBOEQ7UUFDOUQsd0RBQXdEO1FBQ3hELCtFQUErRTtRQUMvRSwrRUFBK0U7UUFDL0UsNENBQTRDO1FBQzVDLGdHQUFnRztRQUNoRyxtRkFBbUY7UUFDbkYsb0ZBQW9GO1FBQ3BGLEVBQUU7UUFFRixTQUFlLFlBQVk7O2dCQWdCekIsU0FBZSw2QkFBNkIsQ0FBQyxHQUFhLEVBQUUsT0FBb0I7Ozs7OztvQ0FDOUUsOEZBQThGO29DQUM5Rix1RUFBdUU7b0NBQ3ZFLElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDO3dDQUFFLHNCQUFPLEVBQUUsRUFBQyxDQUFDLG9EQUFvRDtvQ0FDL0UsTUFBTSxHQUFHLElBQUksR0FBRyxFQUFZLENBQUM7b0NBQ25DLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWlCLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO29DQUVyQyxxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBTyxPQUFPLEVBQUUsbURBQ2pELE9BQU8sSUFDVixVQUFVLEVBQUUsR0FBRyxJQUNmOztnQ0FKRix5QkFBeUI7Z0NBQ3pCLHNCQUFPLFNBR0wsRUFBQzs7OztpQkFDSjs7Ozs7NEJBMUJLLE1BQU0sR0FBRywrQ0FDVixtQkFBbUIsQ0FBQyxJQUFJLEVBQUUsRUFDMUIsNERBQU8sQ0FBQyxxQkFBcUIsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLHNEQUNyQyxDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxFQUNyQixDQUFDLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxHQUZnQixDQUd6QyxDQUFDLENBQUMsRUFDSCxNQUFNLENBQUMsWUFBRSxJQUFJLFFBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsRUFBOUIsQ0FBOEIsQ0FBQyxDQUFDOzRCQUV6QyxVQUFVLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDOzRCQUVoQixxQkFBTSw2QkFBNkIsQ0FBQyxNQUFNLEVBQUU7b0NBQ3hELE9BQU8sRUFBRSxDQUFDLFdBQVcsRUFBRSx1QkFBdUIsRUFBRSxnQkFBZ0IsQ0FBQztvQ0FDakUsS0FBSyxFQUFFLENBQUMsZ0JBQWdCLENBQUM7aUNBQzFCLENBQUM7OzRCQUhJLEtBQUssR0FBRyxTQUdaO2dEQXFCUyxJQUFJOztnQ0FDYixJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsYUFBYSxJQUFJO29DQUNsQyxTQUFTLEVBQUUsRUFBRTtvQ0FDYixjQUFjLEVBQUUsRUFBRTtvQ0FDbEIscUJBQXFCLEVBQUUsRUFBRTtpQ0FDMUIsQ0FBQztnQ0FDRixJQUFJLENBQUMsYUFBYSxHQUFHO29DQUNuQixTQUFTLEVBQUUsRUFBRTtvQ0FDYixjQUFjLEVBQUUsRUFBRTtvQ0FDbEIscUJBQXFCLEVBQUUsRUFBRTtpQ0FDMUIsQ0FBQztnQ0FFRixJQUFNLFNBQVMsR0FBbUMsRUFBRSxDQUFDO2dDQUNyRCxJQUFNLGtCQUFrQixHQUFhLEVBQUUsQ0FBQzt3REFDNUIsRUFBRTtvQ0FDWixJQUFNLGFBQWEsR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7b0NBQ2xELElBQUksYUFBYSxFQUFFO3dDQUNWLGlDQUFLLEVBQUUsK0JBQU8sRUFBRSxtQ0FBUyxDQUFrQjt3Q0FDN0MsbUNBQU8sQ0FBa0I7d0NBQzlCLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQzt3Q0FDZixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLEVBQUU7NENBQ3ZCLCtEQUErRDs0Q0FDL0Qsc0ZBQXNGOzRDQUN0RixPQUFPLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUM7NENBQ3RDLEtBQUssR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQzt5Q0FDbkM7d0NBQ0QsSUFBSSxPQUFLLElBQUksT0FBTyxLQUFLLE9BQU8sRUFBRTs0Q0FDaEMsc0pBQXNKOzRDQUN0SixJQUFJLENBQUMsU0FBUyxFQUFFO2dEQUNkLHVGQUF1RjtnREFDdkYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsT0FBSyxDQUFDLEdBQUcsRUFBQyxLQUFLLFNBQUUsT0FBTyxXQUFFLFVBQVUsY0FBQyxDQUFDOzZDQUNwRTt5Q0FDRjt3Q0FDRCxTQUFTLENBQUMsSUFBSSxDQUFDLFlBQUU7NENBQ2YsRUFBRSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUsRUFBRSxDQUFDLENBQUM7NENBQzlDLElBQUksT0FBSztnREFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRSxPQUFLLENBQUMsQ0FBQzt3Q0FDNUQsQ0FBQyxDQUFDLENBQUM7d0NBQ0gsa0JBQWtCLENBQUMsSUFBSSxDQUFDLGFBQVcsT0FBTyxjQUFXLENBQUMsQ0FBQzt3Q0FDdkQsSUFBSSxPQUFLLEVBQUU7NENBQ1Qsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO3lDQUNsQztxQ0FDRjs7O29DQTNCSCxLQUFtQiw0REFBSSxDQUFDLFNBQVM7d0NBQXJCLG9CQUFFO2dEQUFGLEVBQUU7cUNBNEJiOzs7Ozs7Ozs7Z0NBRUQsSUFBTSxlQUFlLEdBQUcsSUFBSSxHQUFHLENBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO29DQUNqRCxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsRUFBdkIsQ0FBdUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEVBQTFCLENBQTBCLENBQUMsQ0FBQyxDQUFDO29DQUNyRixFQUFFLENBQUMsQ0FBQztnQ0FFTiwwRkFBMEY7Z0NBQzFGLDBGQUEwRjtnQ0FDMUYsMkdBQTJHO2dDQUMzRyxvR0FBb0c7Z0NBQ3BHLHVHQUF1RztnQ0FDdkcsaUZBQWlGO2dDQUNqRixJQUFNLFNBQVMsR0FBRyxJQUFJLEdBQUcsRUFBTSxDQUFDOztvQ0FFaEMsS0FBdUQsa0dBQXFCLDRKQUFFO3dDQUFuRSx3Q0FBd0MsRUFBdkMsOEJBQVksRUFBRSw4QkFBWSxFQUFFLDBCQUFVO3dDQUNoRCxJQUFJLGVBQWUsQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLGVBQWUsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLEVBQUU7b0VBQ3JELEVBQUU7Z0RBQ1osSUFBTSxhQUFhLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztnREFDM0MsSUFBSSxhQUFhLEVBQUU7b0RBQ1osaUNBQUssRUFBRSwrQkFBTyxFQUFFLCtCQUFPLEVBQUUsbUNBQVMsQ0FBa0I7b0RBQ3pELElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztvREFDZixJQUFJLEtBQUssQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLEVBQUU7d0RBQzVCLCtEQUErRDt3REFDL0Qsc0ZBQXNGO3dEQUN0RixPQUFPLEdBQUcsS0FBSyxDQUFDLGNBQWMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUM7d0RBQzNDLEtBQUssR0FBRyxLQUFLLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQztxREFDeEM7b0RBQ0QsSUFBSSxPQUFLLElBQUksT0FBTyxLQUFLLE9BQU8sRUFBRTt3REFDaEMsc0pBQXNKO3dEQUN0SixJQUFJLENBQUMsU0FBUyxFQUFFOzREQUNkLHVGQUF1Rjs0REFDdkYsSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsT0FBSyxDQUFDLEdBQUcsRUFBQyxLQUFLLFNBQUUsT0FBTyxXQUFFLFVBQVUsY0FBQyxDQUFDO3lEQUN6RTtxREFDRjtvREFDRCxJQUFJLENBQUMsT0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxPQUFLLENBQUMsRUFBRTt3REFDbkMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFFOzREQUNmLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsRUFBRSxDQUFDLENBQUM7NERBQ25ELElBQUksT0FBSztnRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLGdCQUFnQixFQUFFLE9BQUssQ0FBQyxDQUFDO3dEQUNqRSxDQUFDLENBQUMsQ0FBQzt3REFDSCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsYUFBVyxPQUFPLGNBQVcsQ0FBQyxDQUFDO3dEQUN2RCxJQUFJLE9BQUssRUFBRTs0REFDVCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7NERBQ2pDLFNBQVMsQ0FBQyxHQUFHLENBQUMsT0FBSyxDQUFDLENBQUM7eURBQ3RCO3FEQUNGO2lEQUNGOzs7Z0RBN0JILEtBQW1CLDREQUFJLENBQUMsY0FBYztvREFBMUIsb0JBQUU7NERBQUYsRUFBRTtpREE4QmI7Ozs7Ozs7OztvRUFDVyxFQUFFO2dEQUNaLElBQU0sYUFBYSxHQUFHLFlBQVksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7Z0RBQzNDLElBQUksYUFBYSxFQUFFO29EQUNaLGlDQUFLLEVBQUUsK0JBQU8sRUFBRSwrQkFBTyxFQUFFLG1DQUFTLENBQWtCO29EQUN6RCxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUM7b0RBQ2YsSUFBSSxLQUFLLENBQUMscUJBQXFCLENBQUMsRUFBRSxDQUFDLEVBQUU7d0RBQ25DLCtEQUErRDt3REFDL0Qsc0ZBQXNGO3dEQUN0RixPQUFPLEdBQUcsS0FBSyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQzt3REFDbEQsS0FBSyxHQUFHLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUM7cURBQy9DO29EQUNELElBQUksT0FBSyxJQUFJLE9BQU8sS0FBSyxPQUFPLEVBQUU7d0RBQ2hDLHNKQUFzSjt3REFDdEosSUFBSSxDQUFDLFNBQVMsRUFBRTs0REFDZCx1RkFBdUY7NERBQ3ZGLElBQUksQ0FBQyxhQUFhLENBQUMscUJBQXFCLENBQUMsT0FBSyxDQUFDLEdBQUcsRUFBQyxLQUFLLFNBQUUsT0FBTyxXQUFFLFVBQVUsY0FBQyxDQUFDO3lEQUNoRjtxREFDRjtvREFFRCxJQUFJLENBQUMsT0FBSyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxPQUFLLENBQUMsRUFBRTt3REFDbkMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFFOzREQUNmLEVBQUUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsdUJBQXVCLEVBQUUsRUFBRSxDQUFDLENBQUM7NERBQzFELElBQUksT0FBSztnRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLHVCQUF1QixFQUFFLE9BQUssQ0FBQyxDQUFDO3dEQUN4RSxDQUFDLENBQUMsQ0FBQzt3REFDSCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsYUFBVyxPQUFPLGNBQVcsQ0FBQyxDQUFDO3dEQUN2RCxJQUFJLE9BQUssRUFBRTs0REFDVCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7NERBQ2pDLFNBQVMsQ0FBQyxHQUFHLENBQUMsT0FBSyxDQUFDLENBQUM7eURBQ3RCO3FEQUNGO2lEQUNGOzs7Z0RBOUJILEtBQW1CLDREQUFJLENBQUMscUJBQXFCO29EQUFqQyxvQkFBRTs0REFBRixFQUFFO2lEQStCYjs7Ozs7Ozs7O3lDQUNGO3FDQUNGOzs7Ozs7Ozs7Z0NBRUQsT0FBTyxDQUFDLElBQUksQ0FBQztvQ0FDWCxNQUFNLEVBQUUsa0JBQWtCO29DQUMxQixPQUFPLEVBQUUsU0FBTyxJQUFJLENBQUMsSUFBSSxVQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQUksSUFBSSxDQUFDLE1BQU0sT0FBSSxDQUFDLENBQUMsQ0FBQyxvQkFBb0Isc0NBQ3JFLCtDQUFJLGVBQWUsRUFBRSxJQUFJLENBQUMsR0FBRyxDQUFDLHdCQUMxQyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsYUFBRyxJQUFJLGVBQU0sR0FBRyxTQUFNLEVBQWYsQ0FBZSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBRztvQ0FDN0QsU0FBUyxFQUFFLFlBQUU7d0NBQ1gsRUFBRSxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7d0NBQ3RCLFNBQVMsQ0FBQyxPQUFPLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLENBQUMsRUFBTCxDQUFLLENBQUMsQ0FBQztvQ0FDaEMsQ0FBQztpQ0FDRixDQUFDLENBQUM7OztnQ0EzSUw7Ozs7cUNBSUs7Z0NBRUwsS0FBbUIsOERBQUs7b0NBQWIsSUFBSTs0Q0FBSixJQUFJO2lDQXNJZDs7Ozs7Ozs7Ozs7OztTQUNGOzs7OztvQkF2YkssU0FBUyxHQUFHLElBQUksR0FBRyxFQUFjLENBQUM7b0JBQ2xDLGdCQUFnQixHQUFHLGVBQWUsQ0FBQyxjQUFjLENBQUMsQ0FBQzt3QkFDdkQsZUFBZSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLHNCQUFlLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDLEVBQWhELENBQWdELENBQUMsQ0FBQyxDQUFDO3dCQUM1RixlQUFlLENBQUMsU0FBUyxDQUFDOzt3QkFDNUIsS0FBZ0Isb0ZBQWdCLG1JQUFFOzRCQUF2QixDQUFDOzRCQUNWLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7eUJBQ3BDOzs7Ozs7Ozs7O3dCQUNELEtBQXlCLHdFQUFVLHFHQUFFOzRCQUF6QixRQUFROztnQ0FDbEIsS0FBaUIsNERBQVEsQ0FBQyxjQUFjLDZDQUFFO29DQUEvQixFQUFFO29DQUNYLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7aUNBQ3RDOzs7Ozs7Ozs7O2dDQUNELEtBQWlCLDREQUFRLENBQUMscUJBQXFCLDZDQUFFO29DQUF0QyxFQUFFO29DQUNYLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7aUNBQ3RDOzs7Ozs7Ozs7eUJBQ0Y7Ozs7Ozs7OztvQkFNSyxLQUNKLHNCQUFzQixDQUFDLFNBQVMsRUFBRSxlQUFlLENBQUMsU0FBUyxDQUFDLEVBRDdDLGVBQWUsZ0JBQVksY0FBYyxlQUNLO29CQUN6RCxLQUNKLHNCQUFzQixDQUFDLFNBQVMsRUFBRSw0REFBTyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLElBQUksRUFBUCxDQUFPLENBQUMsRUFBbkMsQ0FBbUMsQ0FBQyxDQUFDLENBQUMsRUFEbEcsVUFBVSxnQkFBWSxRQUFRLGVBQ3FFO29CQUM5RyxLQUNKLHNCQUFzQixDQUFDLFNBQVMsRUFBRSw0REFBTyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMscUJBQXFCLENBQUMsR0FBRyxDQUFDLFlBQUUsSUFBSSxTQUFFLENBQUMsSUFBSSxFQUFQLENBQU8sQ0FBQyxFQUExQyxDQUEwQyxDQUFDLENBQUMsQ0FBQyxFQUR6RyxVQUFVLGdCQUFZLFFBQVEsZUFDNEU7b0JBRTNILE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXFCLGNBQWMsQ0FBQyxJQUFNLENBQUMsQ0FBQztvQkFDeEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBZSxRQUFRLENBQUMsSUFBTSxDQUFDLENBQUM7b0JBQzVDLE9BQU8sQ0FBQyxHQUFHLENBQUMsaUJBQWUsUUFBUSxDQUFDLElBQU0sQ0FBQyxDQUFDO29CQUd0QyxtQkFBbUIsR0FBRyxlQUFlLENBQ3pDLGdCQUFnQixFQUNoQixlQUFlLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxjQUFJLElBQUksUUFBQyxFQUFDLElBQUksUUFBQyxDQUFDLEVBQVIsQ0FBUSxDQUFDLEVBQy9DLGVBQWUsRUFDZixXQUFXLENBQUMsQ0FBQztvQkFHVCxxQkFBcUIsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBVSxFQUFFLENBQUM7NEJBQVosc0JBQVE7d0JBQ3JELE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBVyxRQUFRLENBQUMsSUFBTSxDQUFDLENBQUM7d0JBQ3hDLElBQU0sU0FBUyxHQUFHLGVBQWUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxJQUFJLEVBQXhCLENBQXdCLENBQUM7NEJBQzNFLGVBQWUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsSUFBSSxLQUFLLFFBQVEsQ0FBQyxJQUFJLEVBQXhCLENBQXdCLENBQUMsQ0FBQzt3QkFDOUQsT0FBTzs0QkFDTCxVQUFVLEVBQUUsUUFBUSxDQUFDLElBQUk7NEJBQ3pCLFlBQVksRUFBRSxTQUFTLENBQUMsQ0FBQztnQ0FDdkIsZUFBZSxDQUNiLFFBQVEsQ0FBQyxjQUFjLEVBQUUsMERBQTBEO2dDQUNuRixTQUFTLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxVQUFDLEVBQU07d0NBQUwsY0FBSTtvQ0FBTSxRQUFDLEVBQUMsSUFBSSxRQUFDLENBQUM7Z0NBQVIsQ0FBUSxDQUFDLEVBQ2xELFVBQVUsRUFDVixpQkFBaUIsRUFDakIsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0NBQ2xCLElBQUksR0FBRyxFQUF5RTs0QkFDbEYsWUFBWSxFQUFFLFNBQVMsQ0FBQyxDQUFDO2dDQUN2QixlQUFlLENBQ2IsUUFBUSxDQUFDLHFCQUFxQixFQUFFLDBEQUEwRDtnQ0FDMUYsU0FBUyxDQUFDLHFCQUFxQixFQUMvQixVQUFVLEVBQ1Ysd0JBQXdCLEVBQ3hCLFFBQVEsQ0FBQyxJQUFJLENBQ2QsQ0FBQyxDQUFDO2dDQUNILElBQUksR0FBRyxFQUE0Rjt5QkFDdEcsQ0FBQztvQkFDSixDQUFDLENBQUMsQ0FBQztvQkFFSCw4QkFBOEI7b0JBQzlCLG1CQUFtQjtvQkFDbkIsV0FBVztvQkFDWCw2Q0FBNkM7b0JBQzdDLDBDQUEwQztvQkFDMUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLFVBQUMsRUFBb0MsRUFBRSxLQUFLOzRCQUExQyxvQkFBTyxFQUFFLGdCQUFLLEVBQUUsb0JBQU8sRUFBRSx3QkFBUzt3QkFDOUQsMkVBQTJFO3dCQUMzRSxPQUFPLENBQUMsSUFBSSxDQUFDOzRCQUNYLE1BQU0sRUFBRSxDQUNOLE9BQU8sQ0FBQyxDQUFDO2dDQUNQLE9BQU8sQ0FBQyxDQUFDO29DQUNQLFNBQVMsQ0FBQyxDQUFDO3dDQUNULDBDQUEyQixDQUFDLENBQUM7d0NBQzdCLDhCQUFvQixDQUFDLENBQUM7b0NBQ3hCLDZCQUFtQixDQUFDLENBQUM7Z0NBQ3ZCLHNCQUFZLENBQ2Y7NEJBQ0QsT0FBTyxFQUFFLGNBQVcsT0FBTyxJQUFJLEVBQUUsd0JBQWlCLE9BQU8sSUFBSSxFQUFFLENBQUU7NEJBQ2pFLFNBQVMsRUFBRSxZQUFFO2dDQUNYLElBQUksS0FBSyxJQUFJLGNBQWMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7b0NBQ3RDLElBQU0sQ0FBQyxHQUFZO3dDQUNqQixFQUFFLEVBQUUsS0FBSzt3Q0FDVCxJQUFJLEVBQUUsT0FBTzt3Q0FDYixHQUFHLEVBQUUsQ0FBQyxhQUFhLENBQUM7d0NBQ3BCLFFBQVEsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO3FDQUNyQixDQUFDO29DQUNGLEVBQUUsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO2lDQUN4QjtnQ0FDRCxJQUFJLE9BQU87b0NBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsZUFBZSxDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0NBQzVFLElBQUksS0FBSztvQ0FBRSxFQUFFLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxlQUFlLENBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQzs0QkFDMUUsQ0FBQzt5QkFDRixDQUFDO29CQUNKLENBQUMsQ0FBQyxDQUFDO29CQUNILHFHQUFxRztvQkFDckcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxjQUFjLElBQUksbUJBQW1CLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBRTt3QkFDbkUsZUFBZSxDQUFDLGNBQWMsR0FBRyxlQUFlLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxhQUFHLElBQUksc0JBQWUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQXhCLENBQXdCLENBQUMsQ0FBQzt3QkFDaEcsT0FBTyxDQUFDLElBQUksQ0FBQzs0QkFDWCxTQUFTLEVBQUUsWUFBRSxJQUFJLFNBQUUsQ0FBQyxHQUFHLENBQUMsVUFBVSxFQUFFLGVBQWUsQ0FBQyxFQUFuQyxDQUFtQzs0QkFDcEQsTUFBTSxFQUFFLGVBQWUsQ0FBQyxjQUFjLENBQUMsQ0FBQztnQ0FDdEMsSUFBSSxDQUFDLENBQUMsQ0FBQyxrRUFBa0U7Z0NBQ3pFLG1FQUErQzt5QkFDbEQsQ0FBQyxDQUFDO3FCQUNKO29CQUVLLFVBQVUsR0FBRyxJQUFJLEdBQUcsRUFBTSxDQUFDO29CQUNqQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUMsU0FBUyxFQUFFLGNBQUksaUJBQVUsQ0FBQyxLQUFLLEVBQUUsRUFBbEIsQ0FBa0IsRUFBQyxDQUFDLENBQUMsQ0FBQyxxRUFBcUU7b0JBQ2xILFlBQVksR0FBRyxJQUFJLEdBQUcsRUFBVSxDQUFDO29CQUN2QyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUMsU0FBUyxFQUFFLGNBQUksbUJBQVksQ0FBQyxLQUFLLEVBQUUsRUFBcEIsQ0FBb0IsRUFBQyxDQUFDLENBQUM7d0NBY3hDLFFBQVEsRUFBRSxTQUFTOzt3QkFDN0Isc0JBQXNCO3dCQUN0QixJQUFNLGNBQWMsR0FBbUIsQ0FDckMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLElBQUksRUFBeEIsQ0FBd0IsQ0FBQzs0QkFDM0QsZUFBZSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDLElBQUksRUFBeEIsQ0FBd0IsQ0FBQyxDQUM1RCxDQUFDO3dCQUVGLDZEQUE2RDt3QkFDdkQsNEZBRzZELEVBSDVELDhCQUFZLEVBQUUsOEJBRzhDLENBQUM7OzRCQUVwRSx3RUFBd0U7NEJBQ3hFLDJFQUEyRTs0QkFDM0UsS0FBcUIsMEVBQVMsZ0dBQUU7Z0NBQTNCLElBQU0sTUFBTTtnQ0FDZixxQkFBcUIsQ0FBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLEVBQUMsWUFBWSxnQkFBRSxZQUFZLGdCQUFDLENBQUMsQ0FBQzs2QkFDN0U7Ozs7Ozs7Ozs7O3dCQTdCSCxXQUFXO3dCQUNYLDBDQUEwQzt3QkFDMUMsc0ZBQXNGO3dCQUN0RiwyRUFBMkU7d0JBQzNFLHlHQUF5Rzt3QkFDekcscUVBQXFFO3dCQUNyRSw4REFBOEQ7d0JBQzlELCtCQUErQjt3QkFDL0IscUNBQXFDO3dCQUNyQyxxQ0FBcUM7d0JBQ3JDLG9HQUFvRzt3QkFDcEcsd0VBQXdFO3dCQUN4RSxLQUFvQyx3RUFBVTs0QkFBbkMseUJBQXFCLEVBQXBCLFFBQVEsZ0JBQUUsU0FBUztvQ0FBbkIsUUFBUSxFQUFFLFNBQVM7eUJBa0I5Qjs7Ozs7Ozs7O29CQUVELHFCQUFNLFlBQVksRUFBRTs7b0JBQXBCLFNBQW9CLENBQUM7b0JBQ3JCLHNCQUFPOzs7O0NBd1RSOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDaHBCOEI7QUFDeUQ7QUFNM0M7QUFHVztBQUVQO0FBTWpEO0lBQThCLGtFQUFzQjtJQUNsRCxrQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBTWI7UUFMQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsaUJBQWlCLEVBQUUsSUFBSTtZQUN2QixxQkFBcUIsRUFBRSxFQUFFO1lBQ3pCLGVBQWUsRUFBRSxJQUFJO1NBQ3RCLENBQUM7O0lBQ0osQ0FBQztJQUVELHlCQUFNLEdBQU47UUFDRSxPQUFPO1lBQUssb0RBQUMsbUVBQVksSUFDdkIsS0FBSyxFQUFFLHNEQUFDLGlJQUFPLE1BQ2YsVUFBVSxFQUFDLFVBQVUsRUFDckIsTUFBTSxFQUFFLEVBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFDLEdBQ3pDO1lBQ0Ysb0RBQUMsNkRBQWEsSUFBQyxVQUFVLEVBQUMsWUFBWSxHQUFHLENBQ3BDO0lBQ1IsQ0FBQztJQUNILGVBQUM7QUFBRCxDQUFDLENBbkI2QiwrQ0FBZSxHQW1CNUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDckM4QjtBQUdZO0FBR1M7QUFVcEQ7SUFBc0MsMEVBQTRCO0lBQ2hFLDBCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FFYjtRQURDLEtBQUksQ0FBQyxLQUFLLEdBQUcsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFDLENBQUM7O0lBQy9CLENBQUM7SUFFRCw2Q0FBa0IsR0FBbEI7UUFDRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDZCxDQUFDO0lBRUssK0JBQUksR0FBVjs7Ozs7NEJBQ2tCLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxDQUFVLFVBQVUsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxDQUFDOzt3QkFBNUcsT0FBTyxHQUFHLFNBQWtHO3dCQUNsSCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsT0FBTyxXQUFFLENBQUMsQ0FBQzs7Ozs7S0FDNUI7SUFFRCxpQ0FBTSxHQUFOO1FBQ0UsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTztZQUFFLE9BQU87Z0JBQUcsb0RBQUMsK0RBQU8sT0FBRyxDQUFJLENBQUM7UUFDN0MsMkJBQWdFLEVBQTlELGNBQUksRUFBRSxjQUFJLEVBQUUsb0NBQWUsRUFBRSwwQkFBaUMsQ0FBQztRQUN2RSxPQUFPLGlFQUNKLFVBQVUsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQzFCOztnQkFBcUIsSUFBSTs7Z0JBQUksSUFBSTtvQkFBTztZQUN4Qyw0REFBSSxTQUFTLEVBQUMsYUFBYSxJQUN4QixlQUFlLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBNEM7b0JBQTNDLFVBQUUsRUFBRSxjQUFJLEVBQUUsNEJBQVcsRUFBRSxrQkFBTSxFQUFFLDRCQUFXO2dCQUNqRSxtRUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLFNBQVMsRUFBQyxVQUFVO29CQUM5QixJQUFJOztvQkFBZSxXQUFXLENBQzVCO1lBRkwsQ0FFSyxDQUFDLENBQ0gsQ0FDSixDQUFFLENBQUMsQ0FBQztZQUNMOztnQkFBc0IsSUFBSTs7Z0JBQUksSUFBSTtvQkFBTztZQUN6Qyw0REFBSSxTQUFTLEVBQUMsYUFBYSxJQUN4QixlQUFlLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBcUM7b0JBQXBDLFVBQUUsRUFBRSxjQUFJLEVBQUUsY0FBSSxFQUFFLDRCQUFXLEVBQUUsa0JBQU07Z0JBQzFELG1FQUFJLEdBQUcsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFDLFVBQVU7b0JBQzlCLElBQUk7O29CQUFLLE1BQU07d0JBQ2I7WUFGTCxDQUVLLENBQUMsQ0FDSCxDQUNKLENBQ0MsQ0FBQztJQUNULENBQUM7SUFDSCx1QkFBQztBQUFELENBQUMsQ0F0Q3FDLCtDQUFlLEdBc0NwRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdEQ4QjtBQUdZO0FBRWE7QUFDSjtBQUNJO0FBV3hEO0lBQWlDLHFFQUE0QjtJQUMzRCxxQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBRWI7UUFEQyxLQUFJLENBQUMsS0FBSyxHQUFHLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBQyxDQUFDOztJQUMvQixDQUFDO0lBRUQsd0NBQWtCLEdBQWxCO1FBQ0UsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2QsQ0FBQztJQUVLLDBCQUFJLEdBQVY7Ozs7OzRCQUNrQixxQkFBTSx3REFBRyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBVSxVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQzs7d0JBQTVHLE9BQU8sR0FBRyxTQUFrRzt3QkFDbEgsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLE9BQU8sV0FBRSxDQUFDLENBQUM7Ozs7O0tBQzVCO0lBRUQsNEJBQU0sR0FBTjtRQUNFLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87WUFBRSxPQUFPO2dCQUFHLG9EQUFDLCtEQUFPLE9BQUcsQ0FBSSxDQUFDO1FBQzdDLDJCQUFnRSxFQUE5RCxjQUFJLEVBQUUsY0FBSSxFQUFFLG9DQUFlLEVBQUUsMEJBQWlDLENBQUM7UUFDdkUsT0FBTztZQUFLLG9EQUFDLG1FQUFZLElBQ3ZCLEtBQUssRUFBRSxJQUFJLEVBQ1gsVUFBVSxFQUFDLFVBQVUsRUFDckIsTUFBTSxFQUFFLEVBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFDLEdBQ3ZDO1lBQ0Ysb0RBQUMsb0VBQWdCLElBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxHQUFJLENBQ3BDLENBQUM7SUFDVCxDQUFDO0lBQ0gsa0JBQUM7QUFBRCxDQUFDLENBMUJnQywrQ0FBZSxHQTBCL0M7Ozs7Ozs7Ozs7Ozs7O0FDekJEO0FBQUE7QUFBTyxTQUFTLG9CQUFvQixDQUFFLE1BQWM7SUFDbEQsUUFBTyxNQUFNLENBQUMsSUFBSSxFQUFFLEVBQUU7UUFDcEIsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLEtBQUs7WUFDUixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDakIsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLEtBQUs7WUFDUixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDakIsS0FBSyxLQUFLLENBQUM7UUFDWCxLQUFLLEdBQUc7WUFDTixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDakIsV0FBVztRQUNYLEtBQUssR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsNkRBQTZEO1FBQ3ZGLEtBQUssSUFBSSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsNkRBQTZEO1FBQ3hGLEtBQUssS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLGlEQUFpRDtRQUNwRixLQUFLLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxxQ0FBcUM7UUFDeEUsT0FBTyxDQUFDLENBQUM7WUFDUCxNQUFNLElBQUksS0FBSyxDQUFDLHdDQUFzQyxNQUFNLHVDQUFvQyxDQUFDLENBQUM7U0FDbkc7S0FDRjtBQUNILENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2QzhCO0FBQ3lEO0FBQzdDO0FBRXBCO0FBQzBFO0FBQzVDO0FBQ1I7QUFDa0M7QUFDMUI7QUFFRDtBQWFwRDtJQUFtQyx1RUFBNEI7SUFDN0QsdUJBQVksS0FBWTtRQUF4QixZQUNFLGtCQUFNLEtBQUssQ0FBQyxTQU9iO1FBTkMsS0FBSSxDQUFDLEtBQUssR0FBRztZQUNYLGlCQUFpQixFQUFFLElBQUk7WUFDdkIsaUJBQWlCLEVBQUUsRUFBRTtZQUNyQixxQkFBcUIsRUFBRSxFQUFFO1lBQ3pCLGVBQWUsRUFBRSxJQUFJO1NBQ3RCLENBQUM7O0lBQ0osQ0FBQztJQUVELDBDQUFrQixHQUFsQjtRQUNFLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNkLENBQUM7SUFFSyw0QkFBSSxHQUFWOzs7Ozs0QkFDbUIscUJBQU0sd0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQVUsVUFBVSxDQUFDOzt3QkFBL0QsUUFBUSxHQUFHLFNBQW9EO3dCQUNyRSxRQUFRLENBQUMsSUFBSSxDQUFDLGdFQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQzt3QkFDN0IsaUJBQWlCLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFVBQVUsS0FBSyxTQUFTLEVBQTFCLENBQTBCLENBQUMsQ0FBQzt3QkFDckUscUJBQXFCLEdBQUcsUUFBUSxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFVBQVUsS0FBSyxTQUFTLEVBQTFCLENBQTBCLENBQUMsQ0FBQzt3QkFDL0UsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLGlCQUFpQixxQkFBRSxxQkFBcUIseUJBQUUsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQzs7Ozs7S0FDdkY7SUFFSyx3Q0FBZ0IsR0FBdEIsVUFBdUIsRUFBbUM7Ozs7Ozt3QkFDeEQsRUFBRSxDQUFDLGVBQWUsRUFBRSxDQUFDO3dCQUNyQixFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7d0JBQ2QsS0FBSyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDO3dCQUN4QixxQkFBTSw2REFBYyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzs7d0JBQXBDLEdBQUcsR0FBRyxTQUE4Qjt3QkFDcEMsR0FBRyxHQUFHLDZDQUFDLENBQUMsNkNBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzt3QkFDekIsZUFBZSxHQUNuQixHQUFHLENBQUMsSUFBSSxDQUFDLG1DQUFtQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFOzRCQUMzRCxHQUFHLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7d0JBQzlDLFVBQVUsR0FBNEIsZUFBZSxLQUFLLG1CQUFtQixDQUFDLENBQUM7NEJBQ25GLFNBQVMsQ0FBQyxDQUFDOzRCQUNYLGVBQWUsS0FBSywyQkFBMkIsQ0FBQyxDQUFDO2dDQUMvQyxXQUFXLENBQUMsQ0FBQztnQ0FDYixJQUFJLENBQUM7d0JBRVQsSUFBSSxVQUFVLEtBQUssV0FBVyxFQUFFOzRCQUN4QixLQUFLLEdBQXNCO2dDQUMvQixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7Z0NBQzVDLElBQUksRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRTtnQ0FDNUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7Z0NBQ2xELE9BQU8sRUFBRSxFQUFFO2dDQUNYLFVBQVUsRUFBRSxXQUFXOzZCQUN4QixDQUFDOzRCQUNJLE9BQU8sR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7NEJBQzVDLEtBQVMsQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFBRTtnQ0FDN0IsTUFBTSxHQUFHLDZDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0NBQ3ZCLHNCQUFzQixHQUFHLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztxQ0FDL0UsR0FBRyxDQUFDLFdBQUMsSUFBSSxRQUFDO29DQUNULFNBQVMsRUFBRSw2Q0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7b0NBQy9DLElBQUksRUFBRSw2Q0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7aUNBQ3RDLENBQUMsRUFIUSxDQUdSLENBQUMsQ0FBQztnQ0FFTixLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztvQ0FDakIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO29DQUN2QyxJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUU7b0NBQ3ZDLGNBQWMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO29DQUMzRCxNQUFNLEVBQUUsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7b0NBQ3BELHNCQUFzQjtpQ0FDdkIsQ0FBQyxDQUFDOzZCQUNKOzRCQUNELElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxlQUFlLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQzt5QkFDekM7NkJBQU07NEJBQ0MsZUFBZSxHQUFHLDREQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLENBQUM7aUNBQzNFLEdBQUcsQ0FBQyxZQUFFO2dDQUNMLElBQU0sSUFBSSxHQUFHLDZDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBWSxDQUFDO2dDQUN4RCxJQUFNLG9CQUFvQixHQUFHLDZDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLHNCQUFzQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFZLENBQUM7Z0NBRXhGLElBQUksb0JBQW9CLEVBQUU7b0NBQ3hCLHdEQUF3RDtvQ0FDeEQsTUFBTSxJQUFJLEtBQUssQ0FBRSxzREFBQyx1VUFBc0YsS0FBQyxDQUFDO2lDQUMzRztnQ0FFRCxJQUFNLFFBQVEsR0FBRyxnRkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQ0FDNUMsSUFBTSw2QkFBNkIsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFFLGlCQUFPLElBQUksUUFBQztvQ0FDOUQsSUFBSSxFQUFFLE9BQU87b0NBQ2IsSUFBSSxFQUFFLDZDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBWTtpQ0FDakQsQ0FBQyxFQUg2RCxDQUc3RCxDQUFDLENBQUM7Z0NBQ0osT0FBTyw2QkFBNkIsQ0FBQzs0QkFDdkMsQ0FBQyxDQUFDLENBQUMsQ0FBQzs0QkFFQSxxQkFBcUIsR0FBRyw0REFBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO2lDQUN2RixHQUFHLENBQUMsWUFBRTtnQ0FDTCxJQUFNLElBQUksR0FBRyw2Q0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQ0FFOUMsSUFBTSxpQkFBaUIsR0FBRyw2Q0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBWSxDQUFDO2dDQUNsRixJQUFJLGlCQUFpQixFQUFFO29DQUNyQiw4REFBOEQ7b0NBQzlELE1BQU0sSUFBSSxLQUFLLENBQUUsc0RBQUMsbVRBQWlGLEtBQUMsQ0FBQztpQ0FDdEc7Z0NBRUQsT0FBTyxnRkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsaUJBQU8sSUFBSSxRQUFDO29DQUNoRCxJQUFJLEVBQUUsT0FBTztvQ0FDYixJQUFJLEVBQUUsNkNBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO29DQUN0QyxTQUFTLEVBQUUsNkNBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFO2lDQUNqRCxDQUFDLEVBSitDLENBSS9DLENBQUMsQ0FBQzs0QkFDTixDQUFDLENBQUMsQ0FBQyxDQUFDOzRCQUVBLDZCQUEyQixrRUFBYSxDQUFDLGVBQWUsRUFBRSxZQUFFLElBQUksU0FBRSxDQUFDLElBQUksRUFBUCxDQUFPLENBQUMsQ0FBQzs0QkFDekUsbUNBQWlDLGtFQUFhLENBQUMscUJBQXFCLEVBQUUsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEVBQVAsQ0FBTyxDQUFDLENBQUM7NEJBRXJGLGdCQUFjLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBQ3JELGdCQUFjLEdBQUcsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBQ3JELGNBQWMsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBYTNELGdCQUFnQixHQUF3QixDQUFDLEtBQUssRUFBQyxLQUFLLEVBQUMsS0FBSyxDQUFrQztpQ0FDL0YsR0FBRyxDQUFDLGlCQUFPLElBQUksUUFBQztnQ0FDZixJQUFJLEVBQUUsYUFBVyxHQUFDLEdBQUcsR0FBQyxPQUFPO2dDQUM3QixJQUFJLEVBQUUsYUFBVyxHQUFDLEdBQUcsR0FBQyxPQUFPO2dDQUM3QixNQUFNLEVBQUUsQ0FBQztnQ0FDVCxJQUFJLEVBQUUsT0FBTztnQ0FDYixjQUFjLEVBQUUsQ0FBQywwQkFBd0IsQ0FBQyxPQUFPLENBQUMsSUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEVBQVAsQ0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztnQ0FDckYsc0JBQXNCLEVBQUUsQ0FBQyxnQ0FBOEIsQ0FBQyxPQUFPLENBQUMsSUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxFQUFpQjt3Q0FBaEIsd0JBQVMsRUFBRSxjQUFJO29DQUFNLFFBQUMsRUFBQyxTQUFTLGFBQUUsSUFBSSxRQUFDLENBQUM7Z0NBQW5CLENBQW1CLENBQUM7NkJBQ3RILENBQUMsRUFQYyxDQU9kLENBQUMsQ0FBQzs0QkFFQSxLQUFLLEdBQXNCO2dDQUMvQixJQUFJLEVBQUUsYUFBVztnQ0FDakIsSUFBSSxFQUFFLGFBQVc7Z0NBQ2pCLE9BQU8sRUFBRSxjQUFjO2dDQUN2QixVQUFVLEVBQUUsU0FBUztnQ0FDckIsT0FBTyxFQUFFLGdCQUFnQjs2QkFDMUIsQ0FBQzs0QkFDRixJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsZUFBZSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7eUJBQ3pDOzs7OztLQUdGO0lBRUQsdUNBQWUsR0FBZixVQUFnQixPQUFPO1FBQ3BCLDZEQUFRLENBQUMsc0RBQUMsa0pBQWUsRUFBTyxXQUFXLEtBQWxCLE9BQU8sRUFBWSxDQUFDO1FBQzdDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxlQUFlLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUN2QyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDZixDQUFDO0lBRUQsOEJBQU0sR0FBTjtRQUFBLGlCQTRCQztRQTNCUSxzQ0FBVSxDQUFlO1FBQ2hDLE9BQU8saUVBQ0osSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUM3QixvREFBQyxpRUFBZSxJQUNkLFFBQVEsRUFBRSxjQUFJLFlBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxlQUFlLEVBQUUsSUFBSSxFQUFDLENBQUMsRUFBdEMsQ0FBc0MsRUFDcEQsZUFBZSxFQUFFLGlCQUFPLElBQUksWUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsRUFBN0IsQ0FBNkIsRUFDekQsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxHQUFJO1lBQzNDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUM7Z0JBQzlCO29CQUFLO3dCQUFHLG9EQUFDLGdFQUFPLE9BQUU7NkVBQXVDLENBQU0sQ0FBQyxDQUFDO2dCQUNqRTtvQkFDRSxnRUFBSyxzREFBQyxpSkFBZSxLQUFNO29CQUMzQixnRUFBSyxJQUFJLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxXQUFDO3dCQUNyQyxtRUFBSSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxZQUFZOzRCQUNqRSxvREFBQyxxREFBSSxJQUFDLEVBQUUsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBRyxDQUFDLENBQUMsSUFBSSxDQUFRLENBQ3pDO29CQUZMLENBRUssQ0FBQyxDQUNIO29CQUNMLGdFQUFLLHNEQUFDLHFKQUFpQixLQUFNO29CQUM3QixnRUFBSyxJQUFJLENBQUMsS0FBSyxDQUFDLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxXQUFDO3dCQUN6QyxtRUFBSSxHQUFHLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxZQUFZOzRCQUNqRSxvREFBQyxxREFBSSxJQUFDLEVBQUUsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBRyxDQUFDLENBQUMsSUFBSSxDQUFRLENBQ3pDO29CQUZMLENBRUssQ0FBQyxDQUNIO29CQUNMLDZEQUFLLFNBQVMsRUFBQyxXQUFXLEVBQUMsVUFBVSxFQUFFLGdEQUFTLEVBQUUsTUFBTSxFQUFFLFlBQUUsSUFBRSxZQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLEVBQXpCLENBQXlCOzt3QkFDakMsMkRBQUcsSUFBSSxFQUFDLCtCQUErQixFQUFDLE1BQU0sRUFBQyxZQUFZLDZCQUEyQjs0QkFDdEksQ0FDRixDQUNEO0lBQ1QsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxDQWhMa0MsK0NBQWUsR0FnTGpEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN4TThCO0FBQ1U7QUFFbEI7QUFDb0I7QUFFa0M7QUFHVDtBQWtCcEU7SUFBcUMseUVBQTZCO0lBTWhFLHlCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FVYjtRQVRDLEtBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLEtBQUksQ0FBQyxtQkFBbUIsR0FBRyxFQUFFLENBQUM7UUFDOUIsS0FBSSxDQUFDLHlCQUF5QixHQUFHLEVBQUUsQ0FBQztRQUNwQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsWUFBWSxFQUFFLEtBQUs7WUFDbkIsT0FBTyxFQUFFLEVBQUU7WUFDWCxTQUFTLEVBQUUsSUFBSTtZQUNmLFdBQVcsRUFBRSxLQUFLO1NBQ25CLENBQUM7O0lBQ0osQ0FBQztJQUVLLDJDQUFpQixHQUF2Qjs7Ozs7O3dCQUNFLElBQUksQ0FBQyxpQ0FBaUMsRUFBRSxDQUFDOzs7O3dCQUVKLHFCQUFNLElBQUksQ0FBQyxnQkFBZ0IsRUFBRTs7d0JBQTFELEtBQTZCLFNBQTZCLEVBQXpELE9BQU8sZUFBRSxlQUFlO3dCQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsT0FBTyxXQUFFLGVBQWUsbUJBQUUsQ0FBQyxDQUFDOzs7O3dCQUU1QyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsR0FBQyxPQUFLLEVBQUUsQ0FBQyxDQUFDOzs7d0JBRW5DLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQzs7Ozs7O0tBRXZDO0lBRUQsMkRBQWlDLEdBQWpDO1FBQ0UsSUFBTSxTQUFTLEdBQUcsNkNBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqRixTQUFTLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzlCLElBQU0sZUFBZSxHQUFHLDZDQUFDLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQy9ELGVBQWUsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUM1QyxJQUFNLHFCQUFxQixHQUFHLDZDQUFDLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzFFLHFCQUFxQixDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1FBQ3hELElBQU0sR0FBRyxHQUFHLDZDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsZUFBZSxFQUFFLHFCQUFxQixDQUFDLENBQUMsQ0FBQztRQUNuRSxHQUFHLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCx3Q0FBYyxHQUFkO1FBQUEsaUJBNkNDO1FBNUNDLEVBQUU7UUFDRiwrSEFBK0g7UUFDL0gsbUdBQW1HO1FBQ25HLDJGQUEyRjtRQUMzRixFQUFFO1FBQ0YsSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUM7UUFDdkMsSUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyw2Q0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDaEcsSUFBTSxTQUFTLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDLElBQUssUUFBRyxDQUFDLEdBQUcsQ0FBQyxVQUFLLDZDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFJLEVBQUMsSUFBSSxFQUFFLEVBQWpDLENBQWlDLENBQUMsQ0FBQyxNQUFNLENBQUMsY0FBSSxJQUFJLFFBQUMsQ0FBQyxJQUFJLEVBQU4sQ0FBTSxDQUFDLENBQUM7UUFFdkcsSUFBTSxNQUFNLEdBQW9CO1lBQzlCLElBQUksRUFBRSxXQUFXLENBQUMsSUFBSTtZQUN0QixJQUFJLEVBQUUsV0FBVyxDQUFDLElBQUk7WUFDdEIsVUFBVSxFQUFFLFdBQVcsQ0FBQyxVQUFVO1lBQ2xDLFNBQVM7WUFDVCxPQUFPLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO2lCQUNwQyxHQUFHLENBQUMsb0JBQVUsSUFBSSxZQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxFQUE3QixDQUE2QixDQUFDO2lCQUNoRCxHQUFHLENBQWlCLFVBQUMsRUFBZ0I7b0JBQWQsa0JBQU0sRUFBRSxjQUFJO2dCQUFPLFFBQUM7b0JBQzFDLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTtvQkFDakIsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO29CQUNqQixJQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7b0JBQ2pCLE1BQU0sRUFBRSxNQUFNLENBQUMsTUFBTTtvQkFDckIsY0FBYyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsNkNBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksUUFBQzt3QkFDckUsSUFBSSxFQUFFLDZDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFZO3dCQUNsQyxLQUFLLEVBQUUsNkNBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRTtxQkFDbEQsQ0FBQyxFQUhvRSxDQUdwRSxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQUMsRUFBTTs0QkFBTCxjQUFJO3dCQUFNLFFBQUMsQ0FBQyxJQUFJO29CQUFOLENBQU0sQ0FBQztvQkFDOUIscUJBQXFCLEVBQ25CLEtBQUssQ0FBQyxJQUFJLENBQUMsNkNBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMseUNBQXlDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFDLElBQUksb0RBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBbEIsQ0FBa0IsQ0FBQzt5QkFDN0YsTUFBTSxDQUFDLGNBQUksSUFBSSxRQUFDLENBQUMsSUFBSSxFQUFOLENBQU0sQ0FBQzt5QkFDdEIsR0FBRyxDQUFDLGNBQUksSUFBSSxRQUFDLEVBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLFFBQUUsQ0FBQyxFQUExQixDQUEwQixDQUFDO3lCQUN2QyxNQUFNLENBQ0wsS0FBSyxDQUFDLElBQUksQ0FBQyw2Q0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxvREFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxFQUFsQixDQUFrQixDQUFDO3lCQUMxRixNQUFNLENBQUMsY0FBSSxJQUFJLFFBQUMsQ0FBQyxJQUFJLEVBQU4sQ0FBTSxDQUFDO3lCQUN0QixHQUFHLENBQUMsY0FBSSxJQUFJLFFBQUMsRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLElBQUksUUFBRSxDQUFDLEVBQTFCLENBQTBCLENBQUM7eUJBQ3ZDLE1BQU0sQ0FDTCxLQUFLLENBQUMsSUFBSSxDQUFDLDZDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLHNDQUFzQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBQyxJQUFJLG9EQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxFQUFFLEVBQWxCLENBQWtCLENBQUM7eUJBQzFGLE1BQU0sQ0FBQyxjQUFJLElBQUksUUFBQyxDQUFDLElBQUksRUFBTixDQUFNLENBQUM7eUJBQ3RCLEdBQUcsQ0FBQyxjQUFJLElBQUksUUFBQyxFQUFFLFNBQVMsRUFBRSxHQUFHLEVBQUUsSUFBSSxRQUFFLENBQUMsRUFBMUIsQ0FBMEIsQ0FBQyxDQUFDO3lCQUN4QyxNQUFNLENBQ0wsS0FBSyxDQUFDLElBQUksQ0FBQyw2Q0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxvREFBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxFQUFsQixDQUFrQixDQUFDO3lCQUMxRixNQUFNLENBQUMsY0FBSSxJQUFJLFFBQUMsQ0FBQyxJQUFJLEVBQU4sQ0FBTSxDQUFDO3lCQUN0QixHQUFHLENBQUMsY0FBSSxJQUFJLFFBQUMsRUFBRSxTQUFTLEVBQUUsR0FBRyxFQUFFLElBQUksUUFBRSxDQUFDLEVBQTFCLENBQTBCLENBQUMsQ0FBQyxDQUFDO2lCQUMvQyxDQUFDO1lBekI2QixDQXlCN0IsQ0FBQztTQUNsQixDQUFDO1FBQ0YsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVLLDBDQUFnQixHQUF0Qjs7WUFVRSxTQUFTLEVBQUU7Z0JBQ1QsSUFBTSxFQUFFLEdBQUcsVUFBVSxDQUFDO2dCQUN0QixVQUFVLElBQUksQ0FBQyxDQUFDO2dCQUNoQixPQUFPLEVBQUUsQ0FBQztZQUNaLENBQUM7Ozs7Ozt3QkFiSyxlQUFlLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO3dCQUMxQyxPQUFPLEdBQWEsRUFBRSxDQUFDO3dCQUVGLHFCQUFNLHdEQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFVLFVBQVUsQ0FBQzs7d0JBQXZFLGdCQUFnQixHQUFHLFNBQW9EO3dCQUN6RSxlQUFlLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsSUFBSSxLQUFLLEtBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksRUFBbEMsQ0FBa0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUN0RixjQUFjLEdBQUcsRUFBc0IsRUFDekMscUJBQXFCLEdBQUcsRUFBNEIsQ0FBQzt3QkFFbkQsVUFBVSxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzs2QkFPeEIsZUFBZSxFQUFmLHdCQUFlO3dCQUNqQixnRUFBZ0U7d0JBQ2hFLHFCQUFNLHdGQUFtQixDQUFDLGVBQWUsRUFBRSxlQUFlLEVBQUUsT0FBTyxDQUFDOzt3QkFEcEUsZ0VBQWdFO3dCQUNoRSxTQUFvRSxDQUFDOzs7d0JBRy9ELGVBQXNCLGVBQWUsR0FBRzs0QkFDNUMsRUFBRSxFQUFFLG9FQUFVLEVBQUU7NEJBQ2hCLFVBQVUsRUFBRSxlQUFlLENBQUMsVUFBVTs0QkFDdEMsSUFBSSxFQUFFLENBQUMsYUFBYSxHQUFHLGVBQWUsQ0FBQyxVQUFVLENBQUM7NEJBQ2xELEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FBQzs0QkFDcEIsSUFBSSxFQUFFLGVBQWUsQ0FBQyxJQUFJOzRCQUMxQixJQUFJLEVBQUUsZUFBZSxDQUFDLElBQUk7NEJBQzFCLGNBQWMsRUFBRSxFQUFFOzRCQUNsQixXQUFXLEVBQUUsS0FBSzs0QkFDbEIsUUFBUSxFQUFFLEVBQUUsRUFBRTt5QkFDZixDQUFDO3dCQUNGLE9BQU8sQ0FBQyxJQUFJLENBQUM7NEJBQ1gsTUFBTSxFQUFFLFdBQVc7NEJBQ25CLE9BQU8sRUFBSyxlQUFlLENBQUMsSUFBSSxVQUFLLGVBQWUsQ0FBQyxJQUFJLE1BQUc7NEJBQzVELFNBQVMsRUFBRSxXQUFDLElBQUksUUFBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsWUFBVSxDQUFDLEVBQTdCLENBQTZCO3lCQUM5QyxDQUFDLENBQUM7d0JBRUcsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDOzRDQUVuQixDQUFDOzRCQUNSLElBQU0sVUFBVSxHQUFZO2dDQUMxQixFQUFFLEVBQUUsb0VBQVUsRUFBRTtnQ0FDaEIsSUFBSSxFQUFFLENBQUM7Z0NBQ1AsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDO2dDQUNwQixRQUFRLEVBQUUsRUFBRSxFQUFFOzZCQUNmLENBQUM7NEJBRUYsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMscUNBQXFDOzRCQUV4RSxPQUFPLENBQUMsSUFBSSxDQUFDO2dDQUNYLE1BQU0sRUFBRSxZQUFZO2dDQUNwQixPQUFPLEVBQUUsQ0FBQztnQ0FDVixTQUFTLEVBQUUsV0FBQztvQ0FDVixDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztvQ0FDL0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsWUFBVSxDQUFDLEVBQUUsRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDLEVBQUUsRUFBRSxXQUFXLENBQUMsQ0FBQztnQ0FDN0UsQ0FBQzs2QkFDRixDQUFDLENBQUM7Ozs0QkFqQkwsS0FBYyxtRUFBZSxDQUFDLFNBQVM7Z0NBQTlCLENBQUM7d0NBQUQsQ0FBQzs2QkFrQlQ7Ozs7Ozs7Ozt3QkFFRCwyQ0FBMkM7d0JBQzNDLFlBQVUsQ0FBQyxjQUFjLEdBQUcsZ0JBQWdCLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBSTtnQ0FBSCxVQUFFOzRCQUFNLFNBQUU7d0JBQUYsQ0FBRSxDQUFDLENBQUM7NENBRXRELENBQUM7OzRCQUNSLElBQU0sU0FBUyxHQUFXO2dDQUN4QixFQUFFLEVBQUUsb0VBQVUsRUFBRTtnQ0FDaEIsV0FBVyxFQUFFLFlBQVUsQ0FBQyxJQUFJO2dDQUM1QixVQUFVLEVBQUUsWUFBVSxDQUFDLFVBQVU7Z0NBQ2pDLElBQUksRUFBRTtvQ0FDSixNQUFNLEdBQUcsWUFBVSxDQUFDLElBQUk7b0NBQ3hCLFNBQVMsR0FBRyxDQUFDLENBQUMsSUFBSTtvQ0FDbEIsYUFBYSxHQUFHLFlBQVUsQ0FBQyxVQUFVO2lDQUN0QztnQ0FDRCxRQUFRLEVBQUUsRUFBRSxFQUFFO2dDQUNkLFVBQVUsRUFBRSxJQUFJO2dDQUNoQixHQUFHLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztnQ0FDeEIsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJO2dDQUNaLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSTtnQ0FDWixNQUFNLEVBQUUsQ0FBQyxDQUFDLE1BQU07Z0NBQ2hCLE9BQU8sRUFBRSxFQUFFO2dDQUNYLFNBQVMsRUFBRSxZQUFVLENBQUMsRUFBRTtnQ0FDeEIsU0FBUyxFQUFFLEVBQUU7Z0NBQ2IsU0FBUyxFQUFFLEVBQUUsSUFBSSxFQUFFLHdEQUFHLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUUsU0FBUyxHQUFHLHdEQUFHLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRTtnQ0FDdkYsV0FBVyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0NBQ3ZCLDBCQUEwQixFQUFFLEVBQUU7Z0NBQzlCLG1CQUFtQixFQUFFLEVBQUU7Z0NBQ3ZCLGNBQWMsRUFBRSxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsVUFBQyxFQUFJO3dDQUFILFVBQUU7b0NBQU0sU0FBRTtnQ0FBRixDQUFFLENBQUM7NkJBQ25ELENBQUM7NEJBQ0YsSUFBSSxDQUFDLENBQUMsSUFBSTtnQ0FBRSxTQUFTLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7NEJBRTNDLE9BQU8sQ0FBQyxJQUFJLENBQUM7Z0NBQ1gsTUFBTSxFQUFFLFNBQVM7Z0NBQ2pCLE9BQU8sRUFBRSxDQUFDLENBQUMsSUFBSTtnQ0FDZixTQUFTLEVBQUUsV0FBQztvQ0FDVixDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxTQUFTLENBQUMsQ0FBQztvQ0FDNUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsWUFBVSxDQUFDLEVBQUUsRUFBRSxTQUFTLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO2dDQUNoRixDQUFDOzZCQUNGLENBQUMsQ0FBQztvREFFYyxPQUFPLEVBQUUsSUFBSTtnQ0FDNUIsOEVBQThFO2dDQUM5RSxJQUFJLGlCQUFpQixHQUFHLGNBQWMsQ0FBQyxNQUFNLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEtBQUssSUFBSSxFQUFoQixDQUFnQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0NBQ3pFLElBQUksQ0FBQyxpQkFBaUIsRUFBRTtvQ0FDdEIsaUJBQWlCLEdBQUc7d0NBQ2xCLEVBQUUsRUFBRSxvRUFBVSxFQUFFO3dDQUNoQixRQUFRLEVBQUUsRUFBRSxFQUFFO3dDQUNkLElBQUksRUFBRSxJQUFJO3dDQUNWLEdBQUcsRUFBRSxDQUFDLGFBQWEsQ0FBQztxQ0FDckIsQ0FBQztvQ0FDRixJQUFJLE9BQU87d0NBQUUsaUJBQWlCLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztvQ0FDL0MsY0FBYyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO29DQUV2QyxPQUFPLENBQUMsSUFBSSxDQUFDO3dDQUNYLE1BQU0sRUFBRSx3QkFBd0I7d0NBQ2hDLE9BQU8sRUFBRSxTQUFPLE9BQU8sYUFBUSxJQUFNO3dDQUNyQyxTQUFTLEVBQUUsV0FBQzs0Q0FDVixDQUFDLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLGlCQUFpQixDQUFDLENBQUM7NENBQzVDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxFQUFFLEVBQUUsaUJBQWlCLEVBQUUsaUJBQWlCLENBQUMsRUFBRSxFQUFFLGdCQUFnQixDQUFDLENBQUM7d0NBQzdGLENBQUM7cUNBQ0YsQ0FBQyxDQUFDO2lDQUNKO3FDQUFNO29DQUVMLE9BQU8sQ0FBQyxJQUFJLENBQUM7d0NBQ1gsU0FBUyxFQUFFLFdBQUM7NENBQ1YsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSxpQkFBaUIsRUFBRSxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQzt3Q0FDN0YsQ0FBQztxQ0FDRixDQUFDLENBQUM7aUNBQ0o7Z0NBQ0Qsd0VBQXdFO2dDQUN4RSxTQUFTLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQyxDQUFDOzs7Z0NBOUIzRCxLQUFtQyx5REFBQyxDQUFDLGNBQWM7b0NBQTFDLGlCQUFzQixFQUFyQixrQkFBYyxFQUFFLGNBQUk7NENBQWIsT0FBTyxFQUFFLElBQUk7aUNBK0I3Qjs7Ozs7Ozs7O29EQUVRLEVBQUU7Z0NBQ1QsSUFBSSx1QkFBdUIsR0FBRyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsU0FBUyxLQUFLLEVBQUUsQ0FBQyxTQUFTLEVBQXBELENBQW9ELENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQ0FDMUgsSUFBSSxDQUFDLHVCQUF1QixFQUFFO29DQUM1Qix1QkFBdUIsR0FBRzt3Q0FDeEIsRUFBRSxFQUFFLG9FQUFVLEVBQUU7d0NBQ2hCLFFBQVEsRUFBRSxFQUFFLEVBQUU7d0NBQ2QsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJO3dDQUNiLFNBQVMsRUFBRSxFQUFFLENBQUMsU0FBUzt3Q0FDdkIsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDO3FDQUNyQixDQUFDO29DQUVGLHFCQUFxQixDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO29DQUVwRCxPQUFPLENBQUMsSUFBSSxDQUFDO3dDQUNYLE1BQU0sRUFBRSxnQ0FBZ0MsR0FBRyxFQUFFLENBQUMsU0FBUzt3Q0FDdkQsT0FBTyxFQUFFLEVBQUUsQ0FBQyxJQUFJO3dDQUNoQixTQUFTLEVBQUUsV0FBQzs0Q0FDVixDQUFDLENBQUMsR0FBRyxDQUFDLHdCQUF3QixFQUFFLHVCQUF1QixDQUFDLENBQUM7NENBQ3pELENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxFQUFFLEVBQUUsd0JBQXdCLEVBQUUsdUJBQXVCLENBQUMsRUFBRSxFQUFFLHVCQUF1QixDQUFDLENBQUM7d0NBQ2pILENBQUM7cUNBQ0YsQ0FBQyxDQUFDO2lDQUNKO3FDQUFNO29DQUNMLE9BQU8sQ0FBQyxJQUFJLENBQUM7d0NBQ1gsU0FBUyxFQUFFLFdBQUM7NENBQ1YsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSx3QkFBd0IsRUFBRSx1QkFBdUIsQ0FBQyxFQUFFLEVBQUUsdUJBQXVCLENBQUMsQ0FBQzt3Q0FDakgsQ0FBQztxQ0FDRixDQUFDO2lDQUNIO2dDQUNELDhFQUE4RTtnQ0FDOUUsU0FBUyxDQUFDLDBCQUEwQixDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLENBQUMsQ0FBQzs7O2dDQTdCeEUsS0FBZSx5REFBQyxDQUFDLHFCQUFxQjtvQ0FBakMsSUFBSSxFQUFFOzRDQUFGLEVBQUU7aUNBOEJWOzs7Ozs7Ozs7b0RBSVUsQ0FBQztnQ0FDVixPQUFPLENBQUMsSUFBSSxDQUFDO29DQUNYLFNBQVMsRUFBRSxXQUFDO3dDQUNWLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxFQUFFLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsV0FBVyxDQUFDLENBQUM7b0NBQ2xFLENBQUM7aUNBQ0YsQ0FBQzs7O2dDQVJKLHlCQUF5QjtnQ0FFekIsNEVBQTRFO2dDQUM1RSxLQUFnQix3RkFBZ0I7b0NBQTNCLElBQU0sQ0FBQzs0Q0FBRCxDQUFDO2lDQU1YOzs7Ozs7Ozs7Ozs0QkE3R0gsS0FBYyxtRUFBZSxDQUFDLE9BQU87Z0NBQTVCLENBQUM7d0NBQUQsQ0FBQzs2QkE4R1Q7Ozs7Ozs7Ozs7NEJBRUgsc0JBQU8sRUFBQyxPQUFPLFdBQUUsZUFBZSxtQkFBQyxFQUFDOzs7O0tBQ25DO0lBRUQsZ0NBQU0sR0FBTjtRQUNFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVLLGdDQUFNLEdBQVo7Ozs7Ozt3QkFDRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQzt3QkFDaEQsWUFBWSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBTSxJQUFJLGFBQU0sQ0FBQyxTQUFTLEVBQWhCLENBQWdCLENBQUMsQ0FBQzs7Ozt3QkFFdEUscUJBQU0sd0RBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsV0FBQztnQ0FDN0IsWUFBWSxDQUFDLE9BQU8sQ0FBQyxhQUFHLElBQUksVUFBRyxDQUFDLENBQUMsQ0FBQyxFQUFOLENBQU0sQ0FBQyxDQUFDOzRCQUN0QyxDQUFDLENBQUM7O3dCQUZGLFNBRUUsQ0FBQzs7O3dCQUVILElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDOzs7d0JBRTFELElBQUksQ0FBQyxLQUFLLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDOzs7OztLQUNyRDtJQUVELDhCQUFJLEdBQUosVUFBSyxJQUFZO1FBQ2YsT0FBTyxJQUFJLENBQUMsOEJBQTZCO0lBQzNDLENBQUM7SUFFRCxnQ0FBTSxHQUFOO1FBQUEsaUJBMkZDO1FBMUZRLGdEQUFlLENBQWU7UUFDOUIsZ0NBQU8sQ0FBZTtRQUM3QixPQUFPO1lBQUssZ0VBQUssc0RBQUMseUpBQWtCLEVBQTJDLEVBQUUsS0FBN0MsZUFBZSxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQVE7WUFDcEYsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDOztnQkFBUyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBSyxDQUFDLENBQUM7Z0JBQ25ELElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyw0RUFBaUIsQ0FBQyxDQUFDO29CQUMxQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsK0VBQW9CLENBQUMsQ0FBQzt3QkFDL0MsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsQ0FBQyxNQUFNLEVBQVQsQ0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLGtEQUFrRDs0QkFDeEY7Z0NBQ0Usb01BQXNHO2dDQUN0RyxnRUFBUSxPQUFPLEVBQUUsY0FBTSxZQUFJLENBQUMsTUFBTSxFQUFFLEVBQWIsQ0FBYSxXQUFlLENBQy9DLENBQUMsQ0FBQzs0QkFDWjtnQ0FDRSwrREFBTyxLQUFLLEVBQUUsRUFBQyxNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRTtvQ0FBRTt3Q0FBTzs0Q0FDbEUsNERBQUksT0FBTyxFQUFFLENBQUMsZ0RBQTJDLENBQ3REO3dDQUFBOzRDQUNELCtFQUFnQjs0Q0FDaEIsZ0ZBQWlCLENBQ2QsQ0FBUTtvQ0FBQSxtRUFDVixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsZ0JBQU0sSUFBSSxhQUFNLENBQUMsTUFBTSxFQUFiLENBQWEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLE1BQU0sRUFBQyxDQUFDLElBQUssbUVBQUksR0FBRyxFQUFFLENBQUM7d0NBQzlFLDREQUFJLEtBQUssRUFBRSxFQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUMsSUFBRyxNQUFNLENBQUMsTUFBTSxDQUFNO3dDQUNqRCw0REFBSSxLQUFLLEVBQUUsRUFBQyxPQUFPLEVBQUUsS0FBSyxFQUFDLEVBQUUsdUJBQXVCLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLE9BQU8sRUFBRSxHQUFJLENBQ2pGLEVBSGlFLENBR2pFLENBQUMsQ0FDQSxDQUFRO2dDQUNsQixnRUFBUSxPQUFPLEVBQUUsY0FBTSxZQUFJLENBQUMsTUFBTSxFQUFFLEVBQWIsQ0FBYSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsYUFBaUI7Z0NBQ3ZGLGdFQUFRLE9BQU8sRUFBRSxjQUFNLFlBQUksQ0FBQyxNQUFNLEVBQUUsRUFBYixDQUFhLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxnQkFBb0I7Z0NBQzFGLCtEQUFNLENBQ0E7WUFDUixnRUFDRSxPQUFPLEVBQUUsY0FBTSxZQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsWUFBWSxFQUFFLENBQUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsQ0FBQyxFQUF6RCxDQUF5RCxJQUN2RSxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQ3hCLHNEQUFDLDJJQUFZLEtBQUMsQ0FBQyxDQUNmLHNEQUFDLHVMQUFrQyxLQUM5QjtZQUlULCtEQUFPLEtBQUssRUFBRSxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUU7Z0JBQUU7b0JBQU87d0JBQ3ZFLHVFQUVLO3dCQUNMLGdFQUNHLE9BQU8sQ0FBQyxJQUFJLENBQ1YsQ0FDRjtvQkFBQTt3QkFDRCxnRkFFSzt3QkFDTCxnRUFDRyxPQUFPLENBQUMsSUFBSSxDQUNWLENBQ0Y7b0JBQUE7d0JBQ0gsd0VBRUs7d0JBQ0wsNERBQUksR0FBRyxFQUFFLGNBQUksSUFBSSxZQUFJLENBQUMsV0FBVyxHQUFHLElBQUksRUFBdkIsQ0FBdUIsRUFBRSx1QkFBdUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxHQUFJLENBQzFHO29CQUFBO3dCQUNILHlFQUVLO3dCQUNMLGdFQUNHLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNLElBQUksc0VBQU8sR0FBRyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLGNBQUksSUFBSSxZQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE1BQU0sVUFBRSxJQUFJLFFBQUUsRUFBakQsQ0FBaUQ7NEJBQUU7Z0NBQ3RIO29DQUFJLCtFQUFxQjtvQ0FBQSxnRUFBSyxNQUFNLENBQUMsSUFBSSxDQUFNLENBQUs7Z0NBQ3BEO29DQUFJLDBFQUFnQjtvQ0FBQSxnRUFBSyxNQUFNLENBQUMsSUFBSSxDQUFNLENBQUs7Z0NBQy9DO29DQUFJLDZFQUFjO29DQUFBLGdFQUFLLE1BQU0sQ0FBQyxNQUFNLENBQU0sQ0FBSztnQ0FDL0M7b0NBQUkseUZBQTBCO29DQUFBLDREQUFJLEdBQUcsRUFBRSxjQUFJLElBQUksWUFBSSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBbkMsQ0FBbUMsRUFBRSx1QkFBdUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsRUFBRSxHQUFJLENBQUs7Z0NBQ2pLLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsWUFBRSxJQUFJLFFBQUMsRUFBRSxDQUFDLFNBQVMsRUFBYixDQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7b0NBQ3pELHVHQUF3QztvQ0FDeEMsNERBQUksU0FBUyxFQUFDLGlCQUFpQixFQUFDLEdBQUcsRUFBRSxjQUFJLElBQUksWUFBSSxDQUFDLHlCQUF5QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBekMsQ0FBeUMsRUFBRSx1QkFBdUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBWixDQUFZLENBQUMsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEVBQVAsQ0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBSSxDQUM1TixDQUFDLENBQUMsQ0FBQyxTQUFTO2dDQUVoQixNQUFNLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFlBQUUsSUFBSSxTQUFFLENBQUMsU0FBUyxLQUFJLEdBQUcsRUFBbkIsQ0FBbUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQ0FDL0QsdUZBQTZCO29DQUM3Qiw0REFBSSxTQUFTLEVBQUMsY0FBYyxFQUFDLEdBQUcsRUFBRSxjQUFJLElBQUksWUFBSSxDQUFDLHlCQUF5QixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBekMsQ0FBeUMsRUFBRSx1QkFBdUIsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxTQUFTLEtBQUssR0FBRyxFQUFuQixDQUFtQixDQUFDLENBQUMsR0FBRyxDQUFDLFlBQUUsSUFBSSxTQUFFLENBQUMsSUFBSSxFQUFQLENBQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUksQ0FDaE8sQ0FBQyxDQUFDLENBQUMsU0FBUztnQ0FFaEIsTUFBTSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLFNBQVMsS0FBSSxHQUFHLEVBQW5CLENBQW1CLENBQUMsQ0FBQyxDQUFDLENBQUM7b0NBQy9ELHVGQUE2QjtvQ0FDN0IsNERBQUksU0FBUyxFQUFDLGNBQWMsRUFBQyxHQUFHLEVBQUUsY0FBSSxJQUFJLFlBQUksQ0FBQyx5QkFBeUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQXpDLENBQXlDLEVBQUUsdUJBQXVCLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsc0JBQXNCLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsU0FBUyxLQUFLLEdBQUcsRUFBbkIsQ0FBbUIsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxZQUFFLElBQUksU0FBRSxDQUFDLElBQUksRUFBUCxDQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFJLENBQ2hPLENBQUMsQ0FBQyxDQUFDLFNBQVM7Z0NBRWhCLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxTQUFTLEtBQUksR0FBRyxFQUFuQixDQUFtQixDQUFDLENBQUMsQ0FBQyxDQUFDO29DQUMvRCx1RkFBNkI7b0NBQzdCLDREQUFJLFNBQVMsRUFBQyxjQUFjLEVBQUMsR0FBRyxFQUFFLGNBQUksSUFBSSxZQUFJLENBQUMseUJBQXlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUF6QyxDQUF5QyxFQUFFLHVCQUF1QixFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFNBQVMsS0FBSyxHQUFHLEVBQW5CLENBQW1CLENBQUMsQ0FBQyxHQUFHLENBQUMsWUFBRSxJQUFJLFNBQUUsQ0FBQyxJQUFJLEVBQVAsQ0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsR0FBSSxDQUNoTyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBRVgsQ0FBUSxFQXpCZSxDQXlCZixDQUFDLENBQ2QsQ0FDRixDQUNDLENBQVEsQ0FDWjtJQUNSLENBQUM7SUFDSCxzQkFBQztBQUFELENBQUMsQ0E1WG9DLCtDQUFlLEdBNFhuRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdloyQjtBQUdnQztBQUNuQjtBQUVsQjtBQUNpQjtBQUdqQyxTQUFTLG9CQUFvQixDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBYSxFQUFFLE1BQW1DLEVBQUUsS0FBa0I7O0lBQ3pILElBQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztJQUN0QixJQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDOzRCQUNmLE9BQU87O1FBQ2QsSUFBTSxZQUFZLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3JDLElBQU0sT0FBTyxHQUFlLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbEQsSUFBTSxPQUFPLEdBQWUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzVDLElBQUksQ0FBQyxPQUFPOzhCQUFXO1FBQ3ZCLElBQU0sTUFBTSxHQUFHLE9BQU87YUFDbkIsR0FBRyxDQUFDLFVBQUMsR0FBRyxFQUFFLEdBQUcsSUFBRyxRQUFDLEVBQUMsR0FBRyxPQUFFLEdBQUcsT0FBQyxDQUFDLEVBQVosQ0FBWSxDQUFDLENBQUMsQ0FBQyw4REFBOEQ7UUFDaEcsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxlQUFLLElBQUksUUFBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsRUFBRSxLQUFLLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFyQixDQUFxQixDQUFDLEVBQXpDLENBQXlDLENBQUMsQ0FBQyxDQUFDLG1CQUFtQjs7WUFFcEcsS0FBYyxrRUFBSyw0RUFBRTtnQkFBaEIsSUFBSSxDQUFDO2dCQUNSLElBQU0sYUFBYSxHQUFHLG1EQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDakMsSUFBTSxJQUFJLEdBQUcsYUFBYSxDQUFDLEtBQUssQ0FBQztnQkFDakMsT0FBTyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUMsMEVBQTBFO2dCQUN0RyxJQUFJLElBQUksS0FBSyxLQUFLLEVBQUU7b0JBQ2xCLElBQUksQ0FBQyxhQUFhLENBQUMsRUFBRTt3QkFBRSxhQUFhLENBQUMsRUFBRSxHQUFHLG9FQUFVLEVBQUUsQ0FBQyxDQUFDLCtCQUErQjtvQkFDdkYsZ0RBQWdEO29CQUNoRCxLQUFLLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxhQUFhLENBQUMsQ0FBQztpQkFDeEM7cUJBQU0sSUFBSSxJQUFJLEtBQUssUUFBUSxFQUFFO29CQUM1QixLQUFLLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxhQUFhLENBQUMsQ0FBQztpQkFDeEM7Z0JBQ0QsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxhQUFhLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDO2dCQUVsRSwyRUFBMkU7Z0JBQzNFLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDO29CQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7Z0JBQ25ELFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBQyxJQUFJLEVBQUUsYUFBYSxFQUFDLENBQUM7YUFDcEQ7Ozs7Ozs7OztRQUNELElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFJLFFBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFiLENBQWEsQ0FBQyxFQUFqQyxDQUFpQyxDQUFDLENBQUM7O1lBQ3ZFLEtBQWMsc0VBQU8sc0ZBQUU7Z0JBQWxCLElBQUksQ0FBQztnQkFDUixLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLENBQUM7YUFDekQ7Ozs7Ozs7OztRQUNELElBQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsZUFBSyxJQUFJLGNBQU8sQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEtBQUssUUFBUSxFQUFyRCxDQUFxRCxDQUFDLEVBQXhFLENBQXdFLENBQUMsQ0FBQzs7WUFDakgsS0FBYyxzRUFBTyxzRkFBRTtnQkFBbEIsSUFBSSxDQUFDO2dCQUNSLElBQU0sYUFBYSxHQUFHLG1EQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDakMsT0FBTyxhQUFhLENBQUMsS0FBSyxDQUFDO2dCQUMzQixLQUFLLENBQUMsR0FBRyxDQUFDLFlBQVksRUFBRSxhQUFhLENBQUMsQ0FBQztnQkFFdkMsK0ZBQStGO2dCQUMvRixJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQztvQkFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO2dCQUNuRCxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUMsSUFBSSxFQUFFLGFBQWEsRUFBQyxDQUFDO2FBQ3BEOzs7Ozs7Ozs7OztRQXZDSCxLQUFvQiw4REFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7WUFBbEMsSUFBSSxPQUFPO29CQUFQLE9BQU87U0F3Q2Y7Ozs7Ozs7OztJQUNELE9BQU8sMERBQU0sQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDcEMsQ0FBQztBQUVNLFNBQVMsUUFBUSxDQUFDLFFBQXVDO0lBQzlELE9BQU8sNkNBQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVNLFNBQVMsZUFBZSxDQUFDLFFBQXVDO0lBQ3JFLE9BQU8sNkNBQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDM0MsQ0FBQztBQUVNLFNBQVMscUJBQXFCLENBQUMsSUFBWTtJQUNoRCxJQUFJLENBQUMsSUFBSTtRQUFFLE9BQU8sRUFBRSxDQUFDO0lBQ3JCLElBQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQUMsSUFBSSxRQUFDLENBQUMsQ0FBQyxFQUFILENBQUcsQ0FBQyxDQUFDO0lBQy9DLElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUM3QixPQUFPLEtBQUssQ0FBQyxHQUFHLENBQUMsY0FBSSxJQUFJLE9BQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFHLEVBQWIsQ0FBYSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNyRSxDQUFDO0FBRU0sU0FBUyx1QkFBdUIsQ0FBRSxHQUFXLEVBQUUsR0FBd0IsRUFBRSxJQUFVO0lBQ3hGLE9BQU8sMERBQU0sQ0FBQyxHQUFHLEVBQUU7UUFDakIsUUFBUSxFQUFFLEVBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQztRQUNyQixZQUFZLEVBQUUsRUFBQyxJQUFJLEVBQUUsR0FBRyxFQUFDO1FBQ3pCLFVBQVUsRUFBRTtZQUNWLElBQUksRUFBRTtnQkFDSixJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVc7Z0JBQ3RCLEdBQUcsRUFBRSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUk7YUFDM0I7U0FDRjtLQUNGLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFTSxTQUFTLG1CQUFtQixDQUFpQyxHQUFXLEVBQUUsR0FBTSxFQUFFLElBQVU7SUFDakcsT0FBTywwREFBTSxDQUFDLEdBQUcsRUFBRTtRQUNqQixXQUFXLEVBQUUsRUFBQyxJQUFJLEVBQUUsR0FBRyxFQUFDO1FBQ3hCLFNBQVMsRUFBRTtZQUNULElBQUksRUFBRTtnQkFDSixJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVc7Z0JBQ3RCLEdBQUcsRUFBRSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUk7YUFDM0I7U0FDRjtLQUNGLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFTSxTQUFTLHFCQUFxQixDQUFFLFFBQTRCO0lBQ2pFLElBQUksUUFBUSxDQUFDLEtBQUs7UUFBRSxPQUFPLFFBQVEsQ0FBQyxLQUFLLENBQUM7SUFDMUMsT0FBTyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbkIsUUFBUSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNsQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztZQUMxQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDaEIsUUFBUSxDQUFDLEdBQUcsQ0FBQztBQUNqQixDQUFDO0FBRU0sU0FBUyxtQ0FBbUMsQ0FBQyxHQUF3QixFQUFFLElBQVU7SUFDdEYsSUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ3ZCLEdBQUcsR0FBRyx1QkFBdUIsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzlDLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUztRQUFFLEdBQUcsR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzlELE9BQU8sR0FBRyxDQUFDO0FBQ2IsQ0FBQztBQUVNLFNBQVMsVUFBVSxDQUFDLEdBQWEsRUFBRSxRQUFnQyxFQUFFLE1BQWdCOztJQUMxRixJQUFNLEdBQUcsR0FBRyxtREFBSSxHQUFHLENBQUMsQ0FBQztJQUNyQixJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzlCLElBQUksSUFBSTtRQUNOLEdBQUcsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDOztRQUNuQixLQUFrQixvRUFBTSxpRkFBRTtZQUFyQixJQUFJLEtBQUs7WUFDWixJQUFNLE9BQU8sR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQUMsSUFBSSxpQkFBVSxDQUFDLENBQUMsRUFBRSxRQUFRLEVBQUUsRUFBRSxDQUFDLEVBQTNCLENBQTJCLENBQUMsQ0FBQztZQUNqRSxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDO1NBQ3RCOzs7Ozs7Ozs7SUFDRCxPQUFPLEdBQUcsQ0FBQztBQUNiLENBQUM7QUFFTSxTQUFTLFFBQVEsQ0FBQyxJQUFVLEVBQUUsQ0FBdUI7SUFDMUQsT0FBTyxJQUFJLE9BQU8sQ0FBQyxVQUFDLE9BQU8sRUFBRSxNQUFNO1FBQ2pDLElBQU0sTUFBTSxHQUFHLElBQUksVUFBVSxFQUFFLENBQUM7UUFDaEMsTUFBTSxDQUFDLE1BQU0sR0FBRyxZQUFFLElBQUksY0FBTyxDQUFFLEVBQUUsQ0FBQyxNQUFjLENBQUMsTUFBTSxDQUFDLEVBQWxDLENBQWtDLENBQUM7UUFDekQsTUFBTSxDQUFDLE9BQU8sR0FBRyxZQUFFLElBQUksYUFBTSxDQUFDLElBQUksS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUMsRUFBdEMsQ0FBc0MsQ0FBQztRQUM5RCxNQUFNLENBQUMsT0FBTyxHQUFHLFlBQUUsSUFBSSxhQUFNLENBQUUsRUFBRSxDQUFDLE1BQWMsQ0FBQyxLQUFLLENBQUMsRUFBaEMsQ0FBZ0MsQ0FBQztRQUN4RCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDWixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFTSxTQUFTLGNBQWMsQ0FBRSxJQUFVO0lBQ3hDLE9BQU8sUUFBUSxDQUFDLElBQUksRUFBRSxXQUFDLElBQUUsUUFBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBbEIsQ0FBa0IsQ0FBQyxDQUFDO0FBQy9DLENBQUM7QUFFTSxTQUFTLGlCQUFpQixDQUFFLElBQVU7SUFDM0MsT0FBTyxRQUFRLENBQUMsSUFBSSxFQUFFLFdBQUMsSUFBRSxRQUFDLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxFQUFyQixDQUFxQixDQUFDLENBQUM7QUFDbEQsQ0FBQztBQUVNLFNBQVMsU0FBUyxDQUFDLENBQWtDO0lBQzFELENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztJQUNwQixDQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDbkIsQ0FBQyxDQUFDLFlBQVksQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDO0FBQ3JDLENBQUM7QUFFTSxTQUFTLHlCQUF5QixDQUFDLE1BQTBDO0lBQ2xGLElBQU0sR0FBRyxHQUFHLDZDQUFDLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN2QyxJQUFJLEdBQUc7UUFBRSxHQUFHLENBQUMsU0FBUyxHQUFHLGdCQUFnQixHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxVQUFVLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNsRixDQUFDO0FBRU0sU0FBZSxVQUFVLENBQUMsRUFBVSxFQUFFLE9BRzFDOzs7Ozs7b0JBRUssTUFBTSxHQUFHLHdEQUFHLENBQUMsZ0JBQWdCLENBQUM7b0JBQzlCLG9CQUFvQixHQUFHLE9BQU8sSUFBSSxPQUFPLENBQUMsb0JBQW9CLENBQUM7b0JBQy9ELFlBQVksR0FBRyxDQUFDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7b0JBQy9DLHFCQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUM7NEJBQzlELE1BQU0sQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRTtnQ0FDeEIsT0FBTyxFQUFFLE9BQU8sSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxXQUFDLElBQUksUUFBQyxLQUFLLE9BQU8sRUFBYixDQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7b0NBQ2pGLGdCQUFnQjtvQ0FDaEIsdUJBQXVCO29DQUN2QixXQUFXO29DQUNYLFFBQVE7b0NBQ1IsS0FBSyxDQUFDLDhCQUE4QjtpQ0FDckM7NkJBQ0YsQ0FBQzs0QkFDRiw0RUFBNEU7NEJBQzVFLGlCQUFpQjs0QkFDakIsWUFBWSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFO2dDQUNuQyxZQUFZLEVBQUUsRUFBRTtnQ0FDaEIsT0FBTyxFQUFFLENBQUMsdUJBQXVCLEVBQUUsZ0JBQWdCLEVBQUUsV0FBVyxFQUFFLEtBQUssQ0FBQztnQ0FDeEUsS0FBSyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxxREFBcUQ7NkJBQ2hGLENBQUM7NEJBQ0Ysb0JBQW9CLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUU7Z0NBQzdDLFlBQVksRUFBRSxFQUFFO2dDQUNoQixLQUFLLEVBQUUsQ0FBQyxTQUFTLENBQUM7NkJBQ25CLENBQUM7eUJBQ0gsQ0FBQzs7b0JBckJJLGlFQUF1QyxDQUFDLFNBcUI1QyxDQUErQixPQXJCMUIsTUFBTSxVQUFFLFdBQVcsVUFBRSxhQUFhO29CQXNCekMsTUFBTSxDQUFDLEtBQUssR0FBRyxXQUFXLENBQUM7b0JBRTNCLGlDQUFpQztvQkFDakMsSUFBSSxNQUFNLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxjQUFjLEVBQUU7d0JBQzdDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsWUFBRTs0QkFDN0MsYUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBQyxJQUFJLFFBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFYLENBQVcsQ0FBQzt3QkFBdkMsQ0FBdUMsQ0FBQyxDQUFDO3FCQUM1QztvQkFFRCw2Q0FBNkM7b0JBQzdDLElBQUksTUFBTSxDQUFDLHFCQUFxQixJQUFJLE1BQU0sQ0FBQywwQkFBMEIsRUFBRTt3QkFDckUsTUFBTSxDQUFDLHFCQUFxQixHQUFHLE1BQU0sQ0FBQywwQkFBMEIsQ0FBQyxHQUFHLENBQUMsWUFBRTs0QkFDckUsYUFBTSxDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxDQUFDO3dCQUFuRCxDQUFtRCxDQUFDLENBQUM7cUJBQ3hEO29CQUVELHNDQUFzQztvQkFDdEMsSUFBSSxNQUFNLENBQUMsY0FBYyxJQUFJLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRTt3QkFDdkQsTUFBTSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUMsbUJBQW1CLENBQUMsR0FBRyxDQUFDLFlBQUU7NEJBQ3ZELGFBQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFlBQUUsSUFBSSxTQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBWixDQUFZLENBQUM7d0JBQTlDLENBQThDLENBQUMsQ0FBQyw0R0FBMkc7cUJBQzlKO29CQUVELHVDQUF1QztvQkFDdkMsSUFBSSxvQkFBb0I7d0JBQUUsTUFBTSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7b0JBQy9ELHNCQUFPLE1BQU0sRUFBQzs7OztDQUNmO0FBRUQsZ0RBQWdEO0FBQ3pDLFNBQVMsVUFBVSxDQUFDLGNBQTBCLEVBQUUsYUFBeUI7SUFDOUUsT0FBTyxhQUFhLENBQUMsTUFBTSxDQUFDLFVBQUMsQ0FBQyxJQUFLLFFBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBM0IsQ0FBMkIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLElBQUksY0FBYyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxRQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQTFCLENBQTBCLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBQ3BKLENBQUM7Ozs7Ozs7Ozs7Ozs7QUNwTkQ7QUFBQTtBQUFBO0FBQUE7QUFBK0I7QUFDeEIsSUFBTSxlQUFlLEdBQUcsbURBQW1CLENBQUMsRUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0RWO0FBQ0w7QUFDQTtBQUNHO0FBQ0E7QUFDdEI7QUFDUztBQUNaO0FBRXJCLElBQU0sU0FBUyxHQUFHLFVBQW1CLFNBQWlDO0lBQ3pFO1FBQWlDLDRFQUFrQjtRQUcvQyw0QkFBWSxLQUFLO1lBQWpCLFlBQ0ksa0JBQU0sS0FBSyxDQUFDLFNBT2Y7WUFORyxnRUFBYSxDQUFDLCtDQUFJLGdFQUFTLEVBQUksZ0VBQVMsRUFBRSxDQUFDO1lBQzNDLEtBQUksQ0FBQyxRQUFRLEdBQUc7Z0JBQ2hCLElBQUksRUFBRSxrREFBVztnQkFDakIsSUFBSSxFQUFFLGtEQUFXO2FBQ2hCLENBQUM7WUFDRiw2Q0FBTSxFQUFFLENBQUMsTUFBTSxDQUFDLHdEQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7O1FBQ3BDLENBQUM7UUFFRCxtQ0FBTSxHQUFOO1lBQ0ksT0FBTyxvREFBQyx1REFBWSxJQUFDLE1BQU0sRUFBRSx3REFBRyxDQUFDLFVBQVUsRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyx3REFBRyxDQUFDLFVBQVUsQ0FBQztnQkFDaEYsb0RBQUMsU0FBUyxxREFBSyxJQUFJLENBQUMsS0FBVSxFQUFJLENBQ3ZCO1FBQ25CLENBQUM7UUFDTCx5QkFBQztJQUFELENBQUMsQ0FsQmdDLCtDQUFlO0FBQWhELENBa0JDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDNUIwQjtBQW1CL0I7SUFBMEMsOEVBQTRCO0lBSWxFLDhCQUFZLEtBQWM7UUFBMUIsWUFDSSxrQkFBTSxLQUFLLENBQUMsU0FLZjtRQUpHLEtBQUksQ0FBQyxNQUFNLEdBQUcsK0NBQWUsRUFBZSxDQUFDO1FBQzdDLEtBQUksQ0FBQyxLQUFLLEdBQUc7WUFDVCxJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksSUFBSSxFQUFFO1NBQ3pCOztJQUNMLENBQUM7SUFFRCxxQ0FBTSxHQUFOO1FBQ1UsbUJBQWtDLEVBQWpDLFlBQUcsRUFBRSxjQUFJLEVBQUUsc0JBQXNCLENBQUM7UUFDekMsSUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDO1FBQ3BCLE9BQU8sb0RBQUMsT0FBTyxJQUNYLGVBQWUsRUFBRSxDQUFDLFFBQVEsc0JBQ1IsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQ3hDLEdBQUcsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUNoQixTQUFTLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQy9CLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFDbEMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUNwQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQ2hDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFDOUIsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUNoQyx1QkFBdUIsRUFBRSxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUMsR0FBSTtJQUNuRCxDQUFDO0lBRUQsdUNBQVEsR0FBUixVQUFTLENBQVE7UUFDYixJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUM7SUFDM0QsQ0FBQztJQUVEOzs7Ozs7T0FNRztJQUNILHdDQUFTLEdBQVQsVUFBVSxDQUFnQjtRQUN0QixJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7UUFDM0MsSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLFFBQVEsRUFBRTtZQUNwQixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO1lBQ3RELElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQzNCLENBQUMsQ0FBQyxlQUFlLEVBQUUsQ0FBQztTQUN2QjthQUFNLElBQUcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxPQUFPLEVBQUM7WUFDeEIsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ25CLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1NBQy9CO2FBQU0sSUFBSSxDQUFDLENBQUMsR0FBRyxLQUFLLEtBQUssRUFBRTtZQUN4QixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDaEM7YUFBTyxJQUFHLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLElBQUksQ0FDN0MsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUN4RCxFQUFFO1lBQ0MsQ0FBQyxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3RCO1FBQ0QsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsS0FBSyxJQUFJLEVBQUU7WUFDckMsSUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBQzVGLElBQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsMkJBQTJCO1lBQzFGLElBQUksTUFBTSxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksQ0FBQyxFQUFFO2dCQUM1QixJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQzthQUMvQjtpQkFBTSxJQUFJLE1BQU0sSUFBSSxDQUFDLE1BQU0sSUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxFQUFFO2dCQUN2RCxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQzthQUMvQjtpQkFBTSxJQUFJLE1BQU0sSUFBSSxDQUNqQixDQUFDLE1BQU0sSUFBSSxNQUFNLElBQUksS0FBSyxJQUFJLENBQUMsQ0FBQztnQkFDaEMsQ0FBQyxNQUFNLElBQUksT0FBTyxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQzlDLEVBQUU7Z0JBQ0MsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7YUFDL0I7U0FDSjtJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsc0NBQU8sR0FBUCxVQUFRLENBQWdCO1FBQ3BCLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztRQUMzQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxLQUFLLFNBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNoRixJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDO1lBQ3RELElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQzNCLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztTQUN0QjtJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0gsdUNBQVEsR0FBUixVQUFTLElBQVksRUFBRSxTQUFpQjtRQUNwQyxvQkFBb0I7UUFDcEIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUUsQ0FBQztRQUM5QixxQkFBcUI7UUFDckIsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVEOzs7T0FHRztJQUNILHNDQUFPLEdBQVAsVUFBUSxDQUFpQjtRQUNyQixDQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDbkIsSUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUMsYUFBYSxJQUFJLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBRSxDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQ3ZHLFFBQVEsQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gscUNBQU0sR0FBTixVQUFPLENBQVE7UUFDWCxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7UUFDM0MsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsZ0RBQWlCLEdBQWpCLFVBQWtCLFFBQVE7UUFDdEIsSUFBSSxJQUFJLENBQUMsa0JBQWtCLElBQUksUUFBUSxFQUFFO1lBQ3JDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxRQUFRLENBQUM7WUFDbkMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDakM7SUFDTCxDQUFDO0lBQ0wsMkJBQUM7QUFBRCxDQUFDLENBaEl5QyxtREFBbUIsR0FnSTVEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbkp5RTtBQUN2QjtBQUNiO0FBRXRDLElBQU0saUJBQWlCLEdBQUcsNENBQUssQ0FBQyxhQUFhLENBQWUsSUFBSSxDQUFDLENBQUM7QUFFbEUsa0VBQVksQ0FBQyxXQUFXLENBQUM7SUFDdkIsc0ZBQXNGO0lBQ3RGLHVGQUF1RjtJQUN2Rix1REFBdUQ7SUFDdkQsc0ZBQXNGO0lBQ3RGLCtFQUErRTtJQUMvRSw4RUFBOEU7SUFDOUUsc0ZBQXNGO0lBQ3RGLHFGQUFxRjtJQUNyRixPQUFDLGlCQUF5QixDQUFDLGFBQWE7QUFBeEMsQ0FBd0MsQ0FBQyxDQUFDO0FBUTVDO0lBQTZCLGlFQUE2RTtJQUN4RyxpQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBS2I7UUFRRCxtQkFBYSxHQUFtQixFQUFFLENBQUM7UUFFbkMsdUJBQWlCLEdBQWlCO1lBQ2hDLFdBQVcsRUFBRTtnQkFDWCxLQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxXQUFDLElBQUksUUFBQyxDQUFDLFdBQVcsRUFBRSxFQUFmLENBQWUsQ0FBQyxDQUFDO2dCQUNqRCxLQUFJLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQztZQUMxQixDQUFDO1NBQ0Y7UUFFRCxjQUFRLEdBQUcsVUFBQyxLQUFVLEVBQUUsS0FBVSxFQUFFLFlBQTBCO1lBQzVELElBQUksS0FBSyxFQUFFO2dCQUNULEtBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxLQUFLLFNBQUMsQ0FBQyxDQUFDO2FBQ3hCO2lCQUFNO2dCQUNMLEtBQUksQ0FBQyxRQUFRLENBQUMsVUFBQyxFQUFTO3dCQUFSLG9CQUFPO29CQUFNLFFBQUMsRUFBQyxPQUFPLEVBQUUsT0FBTyxHQUFHLENBQUMsRUFBRSxLQUFLLFNBQUMsQ0FBQztnQkFBL0IsQ0FBK0IsQ0FBQyxDQUFDO2FBQy9EO1FBQ0gsQ0FBQztRQTNCQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsT0FBTyxFQUFFLENBQUM7WUFDVixLQUFLLEVBQUUsSUFBSTtTQUNaLENBQUM7O0lBQ0osQ0FBQztJQUVELG1DQUFpQixHQUFqQixVQUFrQixLQUFVLEVBQUUsSUFBUztRQUNyQyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUk7WUFBRSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsRUFBRSxHQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZELElBQUksQ0FBQyxRQUFRLENBQUMsRUFBQyxLQUFLLFNBQUUsSUFBSSxRQUFDLENBQUMsQ0FBQztRQUM3QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMzQixDQUFDO0lBbUJELG9DQUFrQixHQUFsQjtRQUNFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUN2QyxDQUFDO0lBRUQsd0JBQU0sR0FBTjtRQUNFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUU7WUFDcEIsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsSUFBSSxzRUFBSSxzREFBQyw2S0FBNkIsS0FBSyxDQUFDO1NBQzVFO1FBQ0QsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3JDLE9BQU8sMkRBQUMsOENBQVEsSUFBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLElBQUksSUFBSTtZQUNwRCwyREFBQyxpQkFBaUIsQ0FBQyxRQUFRLElBQUMsS0FBSyxFQUFFLElBQUksSUFBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBOEIsQ0FDbEYsQ0FBQztJQUNkLENBQUM7SUFDSCxjQUFDO0FBQUQsQ0FBQyxDQTdDNEIsNENBQUssQ0FBQyxTQUFTLEdBNkMzQzs7Ozs7Ozs7Ozs7Ozs7O0FDcEVEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztFQUVFOztBQUU2QjtBQUN3QjtBQW9CdkQ7SUFBa0Msc0VBQTRCO0lBQzVELHNCQUFZLEtBQVk7UUFBeEIsWUFDRSxrQkFBTSxLQUFLLENBQUMsU0FJYjtRQUhDLEtBQUksQ0FBQyxLQUFLLEdBQUc7WUFDWCxVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVUsSUFBSSxLQUFLO1NBQ3RDLENBQUM7O0lBQ0osQ0FBQztJQUVELGdEQUF5QixHQUF6QixVQUEyQixTQUFnQjtRQUN6QyxJQUFJLFNBQVMsQ0FBQyxVQUFVLEtBQUssSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEVBQUU7WUFDbEQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsVUFBVSxFQUFDLENBQUMsQ0FBQztTQUNuRDtJQUNILENBQUM7SUFFRCw2QkFBTSxHQUFOO1FBQUEsaUJBNEJDO1FBM0JPLG1CQUN5QyxFQUR2QyxnQkFBSyxFQUFFLHdCQUFTLEVBQUUsc0JBQVEsRUFBRSxvQ0FBZSxFQUFFLHNDQUFnQixFQUFFLG9DQUFlLEVBQUUsOEJBQVksRUFDbEcsNEJBQVcsRUFBRSx3Q0FBZ0MsQ0FBQztRQUN4QyxzQ0FBVSxDQUFnQjtRQUVsQyxJQUFJLFdBQVc7WUFBRSxPQUFPLGlCQUFpQixLQUFLLGtCQUFrQixDQUFDLENBQUMsQ0FBQztnQkFDakUsMEdBQUcsS0FBSyxDQUFJO2dCQUNaLDBHQUFHLFFBQVEsQ0FBSSxDQUNkLENBQUMsQ0FBQyxDQUFDLDBHQUNILFFBQVEsQ0FDUixDQUFDO1FBRUosNkNBQTZDO1FBQzdDLE9BQU8sNkRBQUssU0FBUyxFQUFFLENBQUMsU0FBUyxJQUFFLEVBQUUsQ0FBQyxHQUFHLFlBQVksR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDakYsNkRBQUssU0FBUyxFQUFFLFlBQVksR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQzNFLE9BQU8sRUFBRTtvQkFDUCxJQUFJLEtBQUksQ0FBQyxLQUFLLENBQUMsV0FBVzt3QkFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEtBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUM7b0JBQzNFLEtBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxVQUFVLEVBQUUsQ0FBQyxLQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUM7Z0JBQ3hELENBQUM7Z0JBQ0QsNkRBQUssU0FBUyxFQUFDLHFCQUFxQjtvQkFDbEMsaUVBQU0sS0FBSyxDQUFPO29CQUNqQixlQUFlLElBQUksb0RBQUMsa0VBQVkscURBQUssWUFBWSxFQUFHLENBQ2pELENBQ0Y7WUFDTiw2REFBSyxTQUFTLEVBQUUsYUFBYSxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQzdFLFFBQVEsQ0FDTCxDQUNGLENBQUM7SUFDVCxDQUFDO0lBQ0gsbUJBQUM7QUFBRCxDQUFDLENBM0NpQywrQ0FBZSxHQTJDaEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ3BFdUM7QUFlakMsU0FBUyxvQkFBb0IsQ0FBQyxJQUFVO0lBQzdDLE9BQU8sSUFBSSxDQUFDLGFBQWEsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBSTtRQUNwRSxhQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQztJQUFoRCxDQUFnRCxDQUFDLENBQUM7QUFDdEQsQ0FBQztBQUVNLFNBQVMsZ0JBQWdCLENBQUMsRUFBc0Q7UUFBckQsd0JBQVMsRUFBRSxrQ0FBYyxFQUFFLDBCQUFVLEVBQUUsa0JBQU07SUFDdkU7Ozs7O1VBS0osRUFMSyxpQkFBUyxFQUFFLG9CQUtoQixDQUFDO0lBQ0ksaURBQWdCLEVBQUUsNkNBQWdCLEVBQUUscUNBQVksRUFBRSx1Q0FBYSxDQUFjO0lBRXBGLE9BQU8sb0VBQUssU0FBUyxFQUFDLHdCQUF3QixFQUMxQyxNQUFNLEVBQUUsWUFBRTtZQUNSLElBQUksZ0JBQWdCLElBQUksZ0JBQWdCLEVBQUU7Z0JBQ3hDLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRSxnQkFBZ0IsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDL0U7WUFDRCxZQUFZLENBQUMsbURBQUksU0FBUyxJQUFFLGdCQUFnQixFQUFFLElBQUksRUFBRSxnQkFBZ0IsRUFBRSxJQUFJLElBQUUsQ0FBQztRQUMvRSxDQUFDLElBRUosU0FBUyxDQUFDLEdBQUcsQ0FBQyxrQkFBUTtRQUNkLHdCQUFJLEVBQUUsa0NBQVcsQ0FBYTtRQUNyQyxJQUFNLGdCQUFnQixHQUFHLG9CQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3BELElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUM7UUFFdkIsT0FBTywyREFBQyw0Q0FBSyxDQUFDLFFBQVEsSUFBQyxHQUFHLEVBQUUsTUFBTTtZQUUvQixZQUFZLElBQUksZ0JBQWdCLEtBQUssSUFBSSxDQUFDLENBQUM7Z0JBQzFDLG9FQUFLLFNBQVMsRUFBQyxhQUFhLEVBQUMsVUFBVSxFQUFFLFlBQUUsSUFBSSxTQUFFLENBQUMsY0FBYyxFQUFFLEVBQW5CLENBQW1CLGFBQWMsQ0FBQyxDQUFDO2dCQUNsRixJQUFJO1lBR04sb0VBQ0UsU0FBUyxFQUFFLENBQUMsa0JBQWtCLEVBQUUsV0FBVyxFQUFFLElBQUksS0FBSyxnQkFBZ0IsSUFBSSxhQUFhLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBQyxJQUFFLFFBQUMsRUFBRCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQy9HLFNBQVMsRUFBRSxJQUFJLEVBQ2YsV0FBVyxFQUFFLFlBQUU7b0JBQ2IsRUFBRSxDQUFDLFlBQVksQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDO29CQUN2QyxZQUFZLENBQUMsbURBQUksU0FBUyxJQUFFLGFBQWEsRUFBRSxFQUFFLENBQUMsT0FBTyxFQUFFLGdCQUFnQixFQUFFLElBQUksSUFBRTtnQkFDakYsQ0FBQyxFQUNELFVBQVUsRUFBRSxZQUFFO29CQUNaLElBQUksQ0FBQyxnQkFBZ0I7d0JBQUUsT0FBTztvQkFDOUIsSUFBSSxnQkFBZ0IsS0FBSyxJQUFJLEVBQUU7d0JBQzdCLFlBQVksQ0FBQyxtREFBSSxTQUFTLElBQUUsZ0JBQWdCLEVBQUUsSUFBSSxJQUFFLENBQUM7d0JBQ3JELE9BQU87cUJBQ1I7b0JBQ0QsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO29CQUNwQixFQUFFLENBQUMsWUFBWSxDQUFDLFVBQVUsR0FBRyxNQUFNLENBQUM7b0JBQ3BDLFlBQVksQ0FBQyxtREFBSSxTQUFTLElBQUUsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxhQUFhLEdBQUcsRUFBRSxDQUFDLE9BQU8sSUFBRSxDQUFDO2dCQUNqRyxDQUFDLEVBQ0QsU0FBUyxFQUFFLFlBQUU7b0JBQ1gsWUFBWSxDQUFDLG1EQUFJLFNBQVMsSUFBRSxnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsZ0JBQWdCLEVBQUUsSUFBSSxJQUFFLENBQUM7Z0JBQy9FLENBQUM7Z0JBQ0EsV0FBVyxJQUFJLGdCQUFnQixJQUFJLG9FQUFLLFNBQVMsRUFBQyxvQkFBb0I7b0JBQ3JFLG9FQUFLLEtBQUssRUFBRSxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUUsR0FBRyxFQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFDO3dCQUM1RCxrRUFBRyxTQUFTLEVBQUMsaUJBQWlCLEVBQUMsS0FBSyxFQUFFLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFDLFNBQVMsRUFBQyxHQUFJLENBQzdGLENBQ0Y7Z0JBQ04sb0VBQUssU0FBUyxFQUFDLG9CQUFvQixJQUNoQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQ3JCO2dCQUNOLG9FQUFLLFNBQVMsRUFBQyxvQkFBb0IsSUFDaEMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUNqQixDQUNGO1lBRUwsQ0FBQyxZQUFZLElBQUksZ0JBQWdCLEtBQUssSUFBSSxDQUFDLENBQUM7Z0JBQzNDLG9FQUFLLFNBQVMsRUFBQyxhQUFhLEVBQUMsVUFBVSxFQUFFLFlBQUUsSUFBSSxTQUFFLENBQUMsY0FBYyxFQUFFLEVBQW5CLENBQW1CLGFBQWMsQ0FBQyxDQUFDO2dCQUNsRixJQUFJLENBR1MsQ0FBQztJQUNwQixDQUFDLENBQUMsQ0FDSSxDQUFDO0FBQ1QsQ0FBQzs7Ozs7Ozs7Ozs7OztBQzFGRDtBQUFBO0FBQTBCO0FBRVg7SUFDYixJQUFJLEVBQUU7UUFDSixJQUFJLEVBQUUsVUFBVTtRQUNoQixLQUFLLEVBQUUsU0FBUztRQUNoQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFaLENBQVk7S0FDM0I7SUFDRCxNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsVUFBVTtRQUNoQixLQUFLLEVBQUUsUUFBUTtRQUNmLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsUUFBUSxDQUFDLEVBQWQsQ0FBYztLQUM3QjtJQUNELFNBQVMsRUFBRTtRQUNULElBQUksRUFBRSxVQUFVO1FBQ2hCLEtBQUssRUFBRSxjQUFjO1FBQ3JCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsV0FBVyxDQUFDLEVBQWpCLENBQWlCO0tBQ2hDO0lBQ0QsYUFBYSxFQUFFO1FBQ2IsSUFBSSxFQUFFLG9CQUFvQjtRQUMxQixLQUFLLEVBQUUsU0FBUztRQUNoQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLGVBQWUsQ0FBQyxFQUFyQixDQUFxQjtLQUNwQztJQUNELFFBQVEsRUFBRTtRQUNSLElBQUksRUFBRSxzQkFBc0I7UUFDNUIsS0FBSyxFQUFFLFVBQVU7UUFDakIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLEVBQTNCLENBQTJCO0tBQzFDO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsSUFBSSxFQUFFLHNCQUFzQjtRQUM1QixLQUFLLEVBQUUsVUFBVTtRQUNqQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsRUFBM0IsQ0FBMkI7S0FDMUM7SUFDRCxRQUFRLEVBQUU7UUFDUixJQUFJLEVBQUUsc0JBQXNCO1FBQzVCLEtBQUssRUFBRSxVQUFVO1FBQ2pCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsYUFBYSxFQUFFLE1BQU0sQ0FBQyxFQUEzQixDQUEyQjtLQUMxQztJQUNELFNBQVMsRUFBRTtRQUNULElBQUksRUFBRSxRQUFRO1FBQ2QsS0FBSyxFQUFFLFVBQVU7UUFDakIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLEVBQTFCLENBQTBCO0tBQ3pDO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsSUFBSSxFQUFFLGlCQUFpQjtRQUN2QixLQUFLLEVBQUUsT0FBTztRQUNkLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsYUFBYSxFQUFFLGNBQWMsQ0FBQyxFQUFuQyxDQUFtQztLQUNsRDtJQUNELEtBQUssRUFBRTtRQUNMLElBQUksRUFBRSxrREFBa0Q7UUFDeEQsS0FBSyxFQUFFLGNBQWM7UUFDckIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxtQkFBbUIsQ0FBQyxFQUF6QixDQUF5QjtLQUN4QztJQUNELEtBQUssRUFBRTtRQUNMLElBQUksRUFBRSwrQ0FBK0M7UUFDckQsS0FBSyxFQUFFLFlBQVk7UUFDbkIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxxQkFBcUIsQ0FBQyxFQUEzQixDQUEyQjtLQUMxQztJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxXQUFXO1FBQ2pCLEtBQUssRUFBRSxZQUFZO1FBQ25CLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxFQUE1QixDQUE0QjtLQUMzQztJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxTQUFTO1FBQ2YsS0FBSyxFQUFFLGNBQWM7UUFDckIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxzQkFBc0IsQ0FBQyxFQUE1QixDQUE0QjtLQUMzQztJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSwrQ0FBK0M7UUFDckQsS0FBSyxFQUFFLGFBQWE7UUFDcEIsTUFBTSxFQUFFO1lBQ04sSUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQztZQUM3QyxJQUFJLEdBQUc7Z0JBQUUscURBQUksQ0FBQyxZQUFZLEVBQUUsR0FBRyxDQUFDO1FBQ2xDLENBQUM7S0FDRjtJQUNELEtBQUssRUFBRTtRQUNMLElBQUksRUFBRSxvREFBb0Q7UUFDMUQsS0FBSyxFQUFFLGFBQWE7UUFDcEIsU0FBUyxFQUFFLGtCQUFrQjtRQUM3QixNQUFNLFlBQUUsRUFBRSxFQUFFLFNBQVM7WUFDbkIsSUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDMUMsSUFBSSxHQUFHLEVBQUU7Z0JBQ1AsMkJBQTJCO2dCQUMzQixJQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMxQyxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztnQkFDZCxHQUFHLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztnQkFDakIsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNuQixHQUFHLENBQUMsT0FBTyxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUM7Z0JBQ2hDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQztnQkFDOUIsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQzthQUMxRDtRQUNILENBQUM7S0FDRjtDQUNGO0FBRUQsU0FBUyxhQUFhLENBQUMsT0FBb0I7SUFDdkMsSUFBSSxHQUFHLEVBQUUsS0FBSyxDQUFDO0lBQ2YsSUFBSSxNQUFNLENBQUMsWUFBWSxJQUFJLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDLFVBQVUsRUFBRTtRQUNqRSxLQUFLLEdBQUcsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMxQixLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JCLEtBQUssQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDMUIscURBQXFEO1FBQ3JELEtBQUssQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDN0IsS0FBSyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyQixHQUFHLENBQUMsZUFBZSxFQUFFLENBQUM7UUFDdEIsR0FBRyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUN2QjtBQUNMLENBQUM7Ozs7Ozs7Ozs7Ozs7QUM1R0Q7QUFBQTtBQUEwQjtBQUVYO0lBQ2IsSUFBSSxFQUFFO1FBQ0osSUFBSSxFQUFFLFVBQVU7UUFDaEIsS0FBSyxFQUFFLE1BQU07UUFDYixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFaLENBQVk7S0FDM0I7SUFDRCxNQUFNLEVBQUU7UUFDTixJQUFJLEVBQUUsVUFBVTtRQUNoQixLQUFLLEVBQUUsUUFBUTtRQUNmLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsUUFBUSxDQUFDLEVBQWQsQ0FBYztLQUM3QjtJQUNELFNBQVMsRUFBRTtRQUNULElBQUksRUFBRSxVQUFVO1FBQ2hCLEtBQUssRUFBRSxXQUFXO1FBQ2xCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsV0FBVyxDQUFDLEVBQWpCLENBQWlCO0tBQ2hDO0lBQ0QsYUFBYSxFQUFFO1FBQ2IsSUFBSSxFQUFFLG9CQUFvQjtRQUMxQixLQUFLLEVBQUUsZ0JBQWdCO1FBQ3ZCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsZUFBZSxDQUFDLEVBQXJCLENBQXFCO0tBQ3BDO0lBQ0QsUUFBUSxFQUFFO1FBQ1IsSUFBSSxFQUFFLHNCQUFzQjtRQUM1QixLQUFLLEVBQUUsV0FBVztRQUNsQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsRUFBM0IsQ0FBMkI7S0FDMUM7SUFDRCxRQUFRLEVBQUU7UUFDUixJQUFJLEVBQUUsc0JBQXNCO1FBQzVCLEtBQUssRUFBRSxXQUFXO1FBQ2xCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsYUFBYSxFQUFFLE1BQU0sQ0FBQyxFQUEzQixDQUEyQjtLQUMxQztJQUNELFFBQVEsRUFBRTtRQUNSLElBQUksRUFBRSxzQkFBc0I7UUFDNUIsS0FBSyxFQUFFLFdBQVc7UUFDbEIsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLEVBQTNCLENBQTJCO0tBQzFDO0lBQ0QsU0FBUyxFQUFFO1FBQ1QsSUFBSSxFQUFFLFFBQVE7UUFDZCxLQUFLLEVBQUUsV0FBVztRQUNsQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsRUFBMUIsQ0FBMEI7S0FDekM7SUFDRCxLQUFLLEVBQUU7UUFDTCxJQUFJLEVBQUUsaUJBQWlCO1FBQ3ZCLEtBQUssRUFBRSxPQUFPO1FBQ2QsTUFBTSxFQUFFLGNBQU0sNERBQUksQ0FBQyxhQUFhLEVBQUUsY0FBYyxDQUFDLEVBQW5DLENBQW1DO0tBQ2xEO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsSUFBSSxFQUFFLE9BQU87UUFDYixLQUFLLEVBQUUsY0FBYztRQUNyQixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLG1CQUFtQixDQUFDLEVBQXpCLENBQXlCO0tBQ3hDO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsSUFBSSxFQUFFLFNBQVM7UUFDZixLQUFLLEVBQUUsZ0JBQWdCO1FBQ3ZCLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMscUJBQXFCLENBQUMsRUFBM0IsQ0FBMkI7S0FDMUM7SUFDRCxJQUFJLEVBQUU7UUFDSixJQUFJLEVBQUUsV0FBVztRQUNqQixLQUFLLEVBQUUsTUFBTTtRQUNiLE1BQU0sRUFBRSxjQUFNLDREQUFJLENBQUMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxFQUE1QixDQUE0QjtLQUMzQztJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxTQUFTO1FBQ2YsS0FBSyxFQUFFLGlCQUFpQjtRQUN4QixNQUFNLEVBQUUsY0FBTSw0REFBSSxDQUFDLHNCQUFzQixDQUFDLEVBQTVCLENBQTRCO0tBQzNDO0lBQ0QsSUFBSSxFQUFFO1FBQ0osSUFBSSxFQUFFLFdBQVc7UUFDakIsS0FBSyxFQUFFLE1BQU07UUFDYixNQUFNLEVBQUU7WUFDTixJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLG9CQUFvQixDQUFDO1lBQy9DLElBQUksR0FBRztnQkFBRSxxREFBSSxDQUFDLFlBQVksRUFBRSxHQUFHLENBQUM7UUFDbEMsQ0FBQztLQUNGO0lBQ0QsS0FBSyxFQUFFO1FBQ0wsSUFBSSxFQUFFLFdBQVc7UUFDakIsS0FBSyxFQUFFLE9BQU87UUFDZCxTQUFTLEVBQUUsNEJBQTRCO1FBQ3ZDLE1BQU07WUFDSixJQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDekMsSUFBSSxHQUFHO2dCQUFFLHFEQUFJLENBQUMsYUFBYSxFQUFFLEdBQUcsQ0FBQztRQUNuQyxDQUFDO0tBQ0Y7Q0FDRjs7Ozs7Ozs7Ozs7OztBQ3JGRDtBQUFlLHlFQUFDLE9BQU8sRUFBRSxLQUFZO0lBQVosb0NBQVk7SUFDbkMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQztBQUM3QyxDQUFDOzs7Ozs7Ozs7Ozs7O0FDRkQ7QUFBQTtBQUFlLFNBQVMsZ0JBQWdCLENBQUMsRUFBRTtJQUN6QyxPQUFPLENBQUM7WUFDTixJQUFJLEVBQUUsWUFBWTtZQUNsQixJQUFJLEVBQUUsMFNBS0M7WUFDUCxLQUFLLEVBQUUsa0NBQWtDO1lBQ3pDLE1BQU0sRUFBRSxjQUFNLFNBQUUsQ0FBQyxZQUFZLENBQUMsRUFBaEIsQ0FBZ0I7U0FDL0IsRUFBRTtZQUNELElBQUksRUFBRSxhQUFhO1lBQ25CLElBQUksRUFBRSwyU0FLQztZQUNQLEtBQUssRUFBRSxnQ0FBZ0M7WUFDdkMsTUFBTSxFQUFFLGNBQU0sU0FBRSxDQUFDLGFBQWEsQ0FBQyxFQUFqQixDQUFpQjtTQUNoQyxFQUFFO1lBQ0QsSUFBSSxFQUFFLFNBQVM7WUFDZixJQUFJLEVBQUUsOFhBTUM7WUFDUCxLQUFLLEVBQUUsNEJBQTRCO1lBQ25DLE1BQU0sRUFBRSxjQUFNLFNBQUUsQ0FBQyxTQUFTLENBQUMsRUFBYixDQUFhO1NBQzVCLENBQUMsQ0FBQztBQUNMLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDakM4QjtBQUNMO0FBQ1c7QUFDZTtBQUNwQjtBQXlCaEMsSUFBTSxPQUFPLEdBQUc7SUFDZCxTQUFTLEVBQUUsbUJBQW1CO0lBQzlCLE1BQU0sRUFBRSxnQkFBZ0I7SUFDeEIsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixTQUFTLEVBQUUsbUJBQW1CO0lBQzlCLFVBQVUsRUFBRSxvQkFBb0I7SUFDaEMsZUFBZSxFQUFFLDBCQUEwQjtDQUM1QztBQUVEO0lBQTZCLGlFQUE0QjtJQU92RCxpQkFBYSxLQUFZO1FBQXpCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBT2I7UUFOQyxLQUFJLENBQUMsS0FBSyxHQUFHLEVBQUMsU0FBUyxFQUFFLElBQUksRUFBQyxDQUFDO1FBQy9CLEtBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDdkMsS0FBSSxDQUFDLE1BQU0sR0FBRyxLQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsQ0FBQztRQUNyQyxLQUFJLENBQUMsV0FBVyxHQUFHLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQyxDQUFDO1FBQy9DLEtBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLENBQUM7UUFDL0MsS0FBSSxDQUFDLFNBQVMsR0FBRyxLQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsQ0FBQzs7SUFDN0MsQ0FBQztJQUVELG1DQUFpQixHQUFqQjtRQUFBLGlCQWVDO1FBZEMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFO1lBQ3hCLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFJLElBQUksT0FBQyxJQUErQyxFQUFoRCxDQUFnRCxDQUFDO2lCQUNsSCxPQUFPLENBQUMsY0FBSTtnQkFDWCxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztnQkFDbEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFJLENBQUMsT0FBTyxDQUFDO2dCQUM1QixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUksQ0FBQyxNQUFhLENBQUM7WUFDbkMsQ0FBQyxDQUFDLENBQUM7WUFDSCxRQUFRLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzRixRQUFRLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUMsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMzRixRQUFRLENBQUMsYUFBYSxDQUFDLGtCQUFrQixDQUFDLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN4RjtRQUNELElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUU7WUFDN0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ3BIO0lBQ0gsQ0FBQztJQUVELG9DQUFrQixHQUFsQjtRQUFBLGlCQVVDO1FBVEMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLGNBQUksSUFBSSxPQUFDLElBQStDLEVBQWhELENBQWdELENBQUM7YUFDbEgsT0FBTyxDQUFDLGNBQUk7WUFDWCxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztZQUNsQixJQUFJLENBQUMsT0FBTyxHQUFHLEtBQUksQ0FBQyxPQUFPLENBQUM7WUFDNUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFJLENBQUMsTUFBYSxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRTtZQUM3QixJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDcEg7SUFDSCxDQUFDO0lBRUQsc0NBQW9CLEdBQXBCO1FBQ0UsUUFBUSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDOUYsUUFBUSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7UUFDOUYsUUFBUSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDNUYsQ0FBQztJQUVELHVDQUFxQixHQUFyQixVQUFzQixTQUFnQixFQUFFLFNBQWdCO1FBQ3RELHlDQUF5QztRQUN6Qyx1Q0FBdUM7UUFDdkMsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVO1lBQ3JCLFNBQVMsSUFBSSxJQUFJLENBQUMsS0FBSztZQUN2QixTQUFTLENBQUMsUUFBUSxLQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUTtZQUMxQywyREFBUSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSywyREFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckUsQ0FBQztJQUVELGlDQUFlLEdBQWYsVUFBZ0IsSUFBWTtRQUMxQixJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQywyREFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDN0QsQ0FBQztJQUVELHlCQUFPLEdBQVAsVUFBUSxFQUFjO1FBQ3BCLElBQU0sSUFBSSxHQUFHLEVBQUUsQ0FBQyxNQUFxQixDQUFDO1FBQ3RDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTztZQUFFLE9BQU87UUFDbkMsSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLEtBQUssSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLEdBQUc7WUFBRSxPQUFPO1FBQzNELElBQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDO1FBQ3BELElBQU0sUUFBUSxHQUFHO1lBQ2YsU0FBUyxFQUFFLHVCQUF1QixDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUM7U0FDeEQ7UUFDRCxRQUFRLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDcEIsS0FBSyxHQUFHLENBQUM7WUFDVCxLQUFLLEtBQUssQ0FBQztZQUVYLE9BQU8sQ0FBQyxDQUFDLE1BQU07U0FDaEI7UUFDRCxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0lBQ3hCLENBQUM7SUFFRCx3QkFBTSxHQUFOLFVBQU8sRUFBb0M7UUFDekM7Ozs7Ozs7V0FPRztRQUNILElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDLGFBQWEsS0FBSyxJQUFJLENBQUMsWUFBWSxDQUFDO1lBQzFFLEVBQUUsQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLFlBQVksRUFDakM7WUFDRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsU0FBUyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7U0FDbEM7SUFDSCxDQUFDO0lBRUQsK0JBQWEsR0FBYixVQUFjLElBQWlCO1FBQzVCLElBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDO0lBQ3JCLENBQUM7SUFFRCw2QkFBVyxHQUFYLFVBQVksRUFBRTtRQUNaLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsSUFBSSxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDM0UsSUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUN0QyxJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztZQUNyQixJQUFJLENBQUMsWUFBWSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUM7U0FDaEM7SUFDSCxDQUFDO0lBRUQsNkJBQVcsR0FBWCxVQUFZLEVBQWM7UUFDeEIsSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDekQsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3BCLDBFQUEwRTtZQUMxRSw4Q0FBOEM7WUFDOUMsbURBQW1EO1lBQ25ELGdGQUFnRjtZQUNoRiw4REFBOEQ7WUFDOUQsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO1lBQzVELElBQUksU0FBUyxDQUFDLEtBQUssR0FBRyxFQUFFO2dCQUFFLE9BQU87WUFDakMsdUNBQXVDO1lBQ3ZDLHlDQUF5QztZQUN6QyxnR0FBZ0c7WUFDaEcsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztnQkFDdkQsU0FBUyxDQUFDLEtBQUssR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ3BELGdDQUFnQztnQkFDaEMsU0FBUyxDQUFDLEtBQUssR0FBRyxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDdEQsSUFBSSxDQUFDLFlBQVksR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDO1lBQzdCLDhCQUE4QjtZQUNoQyxJQUFNLE1BQU0sR0FBRyxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQztZQUMxQyxJQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztZQUM1QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsUUFBUSxHQUFHLElBQUksQ0FBQztZQUM3QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsU0FBUyxHQUFHLElBQUksQ0FBQztZQUMvQyxJQUFJLENBQUMsUUFBUSxDQUFDO2dCQUNaLFNBQVMsRUFBRSx1QkFBdUIsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDO2FBQ2xGLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQztJQUVELDJCQUFTLEdBQVQsVUFBVSxFQUFFO1FBQ1YsSUFBSSxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDekQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7WUFDbkIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQ2pEO0lBQ0gsQ0FBQztJQUVELCtCQUFhLEdBQWIsVUFBYyxFQUFFOzs7WUFDZCxLQUF3Qix5REFBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsSUFBSSxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLDZDQUFFO2dCQUEzRCxJQUFNLFNBQVM7Z0JBQ2xCLFFBQVEsU0FBUyxFQUFFO29CQUNqQixLQUFLLE1BQU07d0JBQ1QsT0FBTyxJQUFJLENBQUM7b0JBQ2QsS0FBSyxNQUFNO3dCQUNULE9BQU8sTUFBTSxDQUFDO29CQUNoQixLQUFLLE1BQU07d0JBQ1QsT0FBTyxJQUFJLENBQUM7b0JBQ2QsS0FBSyxNQUFNO3dCQUNULE9BQU8sSUFBSSxDQUFDO2lCQUNmO2FBQ0Y7Ozs7Ozs7OztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELHFDQUFtQixHQUFuQixVQUFxQixHQUFXO1FBQzlCLG1CQUFtQjtRQUNuQixJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVM7WUFBRSxPQUFPO1FBQzVCLDBCQUEwQjtRQUMxQixRQUFRLEdBQUcsRUFBRTtZQUNYLEtBQUssWUFBWTtnQkFDZixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDO2dCQUN2QyxNQUFNO1lBQ1IsS0FBSyxhQUFhO2dCQUNoQixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO2dCQUN4QyxNQUFNO1lBQ1IsS0FBSyxTQUFTO2dCQUNaLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7Z0JBQ25DLE1BQU07U0FDVDtRQUNELElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNoRCxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUMsU0FBUyxFQUFFLHVCQUF1QixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBQyxDQUFDLENBQUM7SUFDckcsQ0FBQztJQUVELHdCQUFNLEdBQU47UUFBQSxpQkF5R0M7UUF4R0MsSUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLElBQUksZ0RBQU8sQ0FBQztRQUM1RCxJQUFJLFlBQVksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFNO1lBQ25FLGNBQU8sTUFBTSxLQUFLLFFBQVEsQ0FBQyxDQUFDO2dCQUMxQixjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFDeEIsY0FBYyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLG9EQUN0QixjQUFjLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFLLE1BQU0sRUFBRyxDQUFDO29CQUMvQyxNQUFNO1FBSlYsQ0FJVSxDQUFDO1lBQ2IsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFNLElBQUkscUJBQWMsQ0FBQyxNQUFNLENBQUMsRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO1FBRXBFLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUU7WUFDeEIsWUFBWSxHQUFHLFlBQVksQ0FBQyxNQUFNLENBQUMsbUVBQWdCLENBQUMsYUFBRyxJQUFJLFlBQUksQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDLENBQUM7U0FDNUY7UUFFTSxvQ0FBUyxDQUFlO1FBQ3pCLG1CQUFpRCxFQUFoRCxzQkFBUSxFQUFFLGtDQUFjLEVBQUUsc0JBQXNCLENBQUM7UUFFeEQsT0FBTyw2REFBSyxTQUFTLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTO1lBQ3hDLENBQUMsUUFBUSxJQUFJLDZEQUFLLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxJQUM1QyxZQUFZLENBQUMsR0FBRyxDQUFDLFVBQUMsTUFBTSxFQUFFLEdBQUc7Z0JBQzVCLHVFQUFRLEdBQUcsRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQ3pDLHVCQUF1QixFQUFFLEVBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUMsRUFDOUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLLEVBQ25CLFdBQVcsRUFBRSxZQUFFLElBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsS0FBSSxDQUFDLEdBQUMsRUFDMUMsU0FBUyxFQUFFLFlBQUUsSUFBRSxpQkFBVSxDQUFDLGNBQUksWUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsRUFBdkIsQ0FBdUIsRUFBRSxFQUFFLENBQUMsRUFBM0MsQ0FBMkMsR0FDMUQ7WUFMRixDQUtFLENBQUMsQ0FDRDtZQUNOLDZEQUFLLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUMsUUFBUSxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUM7Z0JBQ2xILDZEQUFLLFNBQVMsRUFBQyxRQUFRLEVBQ3JCLEdBQUcsRUFBRSxhQUFHLElBQUksWUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLEVBQXJCLENBQXFCLEVBQ2pDLHVCQUF1QixFQUFFLEVBQUMsTUFBTSxFQUFFLDJEQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBQyxFQUM1RCxlQUFlLEVBQUUsQ0FBQyxRQUFRLEVBQzFCLE9BQU8sRUFBRSxZQUFFO3dCQUNULElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUU7NEJBQ2Isc0JBQU0sRUFBRSxnQ0FBYSxDQUFPOzRCQUNuQywrREFBK0Q7NEJBQy9ELElBQU0sVUFBVSxHQUFHLENBQUMsYUFBYSxJQUFJLGFBQWEsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUM7NEJBQ3BFLElBQU0sZUFBZSxHQUFHLEVBQUUsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsQ0FBQzs0QkFDckUsSUFBSSxVQUFVLENBQUMsTUFBTSxHQUFHLGVBQWUsQ0FBQyxNQUFNLEdBQUcsUUFBUSxFQUFFO2dDQUN6RCxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7NkJBQ3JCO3lCQUNGO29CQUNILENBQUMsRUFDRCxPQUFPLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxZQUFFO3dCQUNuQixtQ0FBUyxDQUF1Qjt3QkFDdkMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ25ELENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUNSLFVBQVUsRUFBRSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBRTt3QkFDeEIsbUNBQVMsQ0FBdUI7d0JBQ3ZDLElBQUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxNQUFNLElBQUksUUFBUSxFQUFFOzRCQUM3QyxFQUFFLENBQUMsY0FBYyxFQUFFLENBQUM7eUJBQ3JCO29CQUNILENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUNSLE9BQU8sRUFBRSxZQUFFLElBQUksWUFBSSxDQUFDLGVBQWUsQ0FBRSxFQUFFLENBQUMsTUFBYyxDQUFDLFNBQVMsQ0FBQyxFQUFsRCxDQUFrRCxFQUNqRSxTQUFTLEVBQUUsWUFBRTt3QkFDWCxJQUFJLFFBQVE7NEJBQUUsT0FBTzt3QkFDckIsSUFBSSxjQUFjLElBQUksRUFBRSxDQUFDLGFBQWEsRUFBRTs0QkFDdEMsY0FBYyxDQUFDLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7eUJBQzNEO3dCQUVELGtDQUFrQzt3QkFDbEMsSUFBSSxFQUFFLENBQUMsS0FBSyxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsS0FBSyxJQUFJLEVBQUUsRUFBRSxFQUFDLDhCQUE4Qjs0QkFDbkUsRUFBRSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsdUNBQXVDO3lCQUM5RDt3QkFDRCxJQUFJLEVBQUUsQ0FBQyxLQUFLLEtBQUssQ0FBQyxFQUFFOzRCQUNsQixFQUFFLENBQUMsY0FBYyxFQUFFLENBQUMsT0FBTTs0QkFDMUIsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFO2dDQUNmLHFEQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7NkJBQ2pCO2lDQUFNO2dDQUNMLHFEQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7NkJBQ2hCO3lCQUNGO3dCQUVELElBQ0UsQ0FBQyxFQUFFLENBQUMsT0FBTyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQyxJQUFJLHlCQUF5Qjs0QkFDcEUsS0FBSSxDQUFDLFNBQVMsSUFBSSxLQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFDeEM7NEJBQ0UsSUFBSSxLQUFJLENBQUMsU0FBUyxJQUFJLEtBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxFQUFFO2dDQUNsRCxLQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsS0FBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsc0JBQXNCOzZCQUNqRjs0QkFDRCxLQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQzs0QkFDdEIsS0FBSSxDQUFDLFFBQVEsQ0FBQyxFQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDOzRCQUNqQyxLQUFJLENBQUMsZUFBZSxDQUFDLEtBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7eUJBQ2pEO29CQUNILENBQUMsR0FDRDtnQkFDRCxTQUFTLElBQUksNkRBQ1osR0FBRyxFQUFFLGFBQUcsSUFBSSxZQUFJLENBQUMsWUFBWSxHQUFHLEdBQUcsRUFBdkIsQ0FBdUIsRUFDbkMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxTQUFTLEVBQzVCLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUNuQixRQUFRLEVBQUUsQ0FBQyxFQUNYLEtBQUssRUFBRTt3QkFDTCxPQUFPLEVBQUUsQ0FBQzt3QkFDVixRQUFRLEVBQUUsVUFBVTt3QkFDcEIsR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLEdBQUc7d0JBQzdCLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJO3dCQUMvQixLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSzt3QkFDakMsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU07cUJBQUM7b0JBQ3RDLDZEQUFLLFNBQVMsRUFBRSxPQUFPLENBQUMsVUFBVSxHQUFHLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQUUsSUFBSSxFQUFDLENBQUMsRUFBQyxHQUFJO29CQUM3Riw2REFBSyxTQUFTLEVBQUUsT0FBTyxDQUFDLFVBQVUsR0FBRyxPQUFPLEVBQUUsS0FBSyxFQUFFLEVBQUMsUUFBUSxFQUFDLFVBQVUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUFFLEtBQUssRUFBQyxDQUFDLEVBQUMsR0FBSTtvQkFDOUYsNkRBQUssU0FBUyxFQUFFLE9BQU8sQ0FBQyxVQUFVLEdBQUcsT0FBTyxFQUFFLEtBQUssRUFBRSxFQUFDLFFBQVEsRUFBQyxVQUFVLEVBQUUsTUFBTSxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUMsQ0FBQyxFQUFDLEdBQUk7b0JBQ2pHLDZEQUFLLFNBQVMsRUFBRSxPQUFPLENBQUMsVUFBVSxHQUFHLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBQyxRQUFRLEVBQUMsVUFBVSxFQUFFLE1BQU0sRUFBQyxDQUFDLEVBQUUsSUFBSSxFQUFDLENBQUMsRUFBQyxHQUFJLENBQzVGLENBQ0YsQ0FDRjtJQUNSLENBQUM7SUFDSCxjQUFDO0FBQUQsQ0FBQyxDQWhTNEIsK0NBQWUsR0FnUzNDOztBQUVELFNBQVMsdUJBQXVCLENBQUUsTUFBbUIsRUFBRSxLQUFrQjtJQUN2RSxJQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUNsRCxJQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMscUJBQXFCLEVBQUUsQ0FBQztJQUNoRCxPQUFPO1FBQ0wsR0FBRyxFQUFFLFNBQVMsQ0FBQyxHQUFHLEdBQUcsVUFBVSxDQUFDLEdBQUcsR0FBRyxNQUFNLENBQUMsU0FBUztRQUN0RCxJQUFJLEVBQUUsU0FBUyxDQUFDLElBQUksR0FBRyxVQUFVLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxVQUFVO1FBQzFELE1BQU0sRUFBRSxTQUFTLENBQUMsTUFBTSxHQUFHLFVBQVUsQ0FBQyxHQUFHLEdBQUcsTUFBTSxDQUFDLFNBQVM7UUFDNUQsS0FBSyxFQUFFLFNBQVMsQ0FBQyxLQUFLLEdBQUcsVUFBVSxDQUFDLElBQUksR0FBRyxNQUFNLENBQUMsVUFBVTtRQUM1RCxLQUFLLEVBQUUsU0FBUyxDQUFDLEtBQUs7UUFDdEIsTUFBTSxFQUFFLFNBQVMsQ0FBQyxNQUFNO0tBQ3pCLENBQUM7QUFDSixDQUFDOzs7Ozs7Ozs7Ozs7O0FDalZEO0FBQUE7QUFBQSxJQUFNLE1BQU0sR0FBRyxJQUFJLFNBQVMsRUFBRSxDQUFDO0FBSS9COztHQUVHO0FBQ0gsSUFBTSxnQkFBZ0IsR0FBZTtJQUNuQyxDQUFDLEVBQUUsRUFBRTtJQUNMLENBQUMsRUFBRSxFQUFFO0lBQ0wsQ0FBQyxFQUFFLEVBQUU7SUFDTCxDQUFDLEVBQUUsRUFBRTtJQUNMLE1BQU0sRUFBRSxFQUFFO0lBQ1YsR0FBRyxFQUFFLEVBQUU7SUFDUCxFQUFFLEVBQUUsRUFBRTtJQUNOLEVBQUUsRUFBRSxFQUFFO0lBQ04sRUFBRSxFQUFFLEVBQUU7SUFDTixFQUFFLEVBQUUsRUFBRTtJQUNOLEVBQUUsRUFBRSxFQUFFO0lBQ04sR0FBRyxFQUFFLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBQztJQUMxRCxDQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBQztJQUM3QyxFQUFFLEVBQUUsRUFBRTtJQUNOLEVBQUUsRUFBRSxFQUFFO0lBQ04sRUFBRSxFQUFFLEVBQUU7SUFDTixFQUFFLEVBQUUsRUFBRTtJQUNOLEVBQUUsRUFBRSxFQUFFO0lBQ04sR0FBRyxFQUFFLEVBQUU7SUFDUCxJQUFJLEVBQUUsRUFBRTtJQUNSLGNBQWM7SUFDZCxLQUFLLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFDO0lBQ3JCLEtBQUssRUFBRSxFQUFFO0lBQ1QsS0FBSyxFQUFFLEVBQUU7SUFDVCxLQUFLLEVBQUUsRUFBRTtJQUNULEVBQUUsRUFBRSxFQUFFO0lBQ04sRUFBRSxFQUFFLEVBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUM7SUFDakQsRUFBRSxFQUFFLEVBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUM7Q0FDekYsQ0FBQztBQUVLLFNBQVMsUUFBUSxDQUFF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QUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdCLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxLQUFLLENBQUMsTUFBTTtRQUFFLE9BQU8sS0FBSyxDQUFDO0lBQ2hELEtBQUssSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFFLENBQUMsR0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUU7UUFDcEMsSUFBTSxHQUFHLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JCLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEdBQUc7WUFBRSxPQUFPLEtBQUssQ0FBQztRQUNuQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxDQUFDO1lBQUUsT0FBTyxLQUFLLENBQUM7S0FDdkM7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDOzs7Ozs7Ozs7Ozs7QUNyS0QsZTs7Ozs7Ozs7Ozs7QUNBQSxlOzs7Ozs7Ozs7OztBQ0FBLGU7Ozs7Ozs7Ozs7O0FDQUEsd0I7Ozs7Ozs7Ozs7O0FDQUEsdUI7Ozs7Ozs7Ozs7O0FDQUEsMEIiLCJmaWxlIjoia2VkYXBwY291cnNlYnVpbGRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuIFx0XHR2YXIgZXhlY3V0ZU1vZHVsZXMgPSBkYXRhWzJdO1xuXG4gXHRcdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuIFx0XHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcbiBcdFx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMCwgcmVzb2x2ZXMgPSBbXTtcbiBcdFx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG4gXHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG4gXHRcdFx0XHRyZXNvbHZlcy5wdXNoKGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSk7XG4gXHRcdFx0fVxuIFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG4gXHRcdH1cbiBcdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcbiBcdFx0XHRcdG1vZHVsZXNbbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRpZihwYXJlbnRKc29ucEZ1bmN0aW9uKSBwYXJlbnRKc29ucEZ1bmN0aW9uKGRhdGEpO1xuXG4gXHRcdHdoaWxlKHJlc29sdmVzLmxlbmd0aCkge1xuIFx0XHRcdHJlc29sdmVzLnNoaWZ0KCkoKTtcbiBcdFx0fVxuXG4gXHRcdC8vIGFkZCBlbnRyeSBtb2R1bGVzIGZyb20gbG9hZGVkIGNodW5rIHRvIGRlZmVycmVkIGxpc3RcbiBcdFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyB8fCBbXSk7XG5cbiBcdFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG4gXHRcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIFx0fTtcbiBcdGZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCkge1xuIFx0XHR2YXIgcmVzdWx0O1xuIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWRNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0dmFyIGRlZmVycmVkTW9kdWxlID0gZGVmZXJyZWRNb2R1bGVzW2ldO1xuIFx0XHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuIFx0XHRcdGZvcih2YXIgaiA9IDE7IGogPCBkZWZlcnJlZE1vZHVsZS5sZW5ndGg7IGorKykge1xuIFx0XHRcdFx0dmFyIGRlcElkID0gZGVmZXJyZWRNb2R1bGVbal07XG4gXHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbZGVwSWRdICE9PSAwKSBmdWxmaWxsZWQgPSBmYWxzZTtcbiBcdFx0XHR9XG4gXHRcdFx0aWYoZnVsZmlsbGVkKSB7XG4gXHRcdFx0XHRkZWZlcnJlZE1vZHVsZXMuc3BsaWNlKGktLSwgMSk7XG4gXHRcdFx0XHRyZXN1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IGRlZmVycmVkTW9kdWxlWzBdKTtcbiBcdFx0XHR9XG4gXHRcdH1cblxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJrZWRhcHBjb3Vyc2VidWlsZGVyXCI6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goW1wiLi9zcmMvZWxlbWVudHMvS0VEQXBwQ291cnNlQnVpbGRlci93ZWJwYWNrLWVudHJ5LnRzXCIsXCJ2ZW5kb3JzXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudCc7IiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWInOyIsInZhciBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoaWQsIHRva2VuSW5mbykge1xyXG4gICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJiZWFyZXItXCIgKyBpZCwgSlNPTi5zdHJpbmdpZnkodG9rZW5JbmZvKSk7XHJcbiAgICB9O1xyXG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdmFyIGpzb24gPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZTtcclxufSgpKTtcclxuZXhwb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlLmpzLm1hcCIsInZhciByZWRpckhhc2ggPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwicmVkaXItaGFzaFwiKTtcclxuaWYgKHJlZGlySGFzaClcclxuICAgIHRyeSB7XHJcbiAgICAgICAgdmFyIF9hID0gSlNPTi5wYXJzZShyZWRpckhhc2gpLCB0aW1lID0gX2EudGltZSwgaGFzaCA9IF9hLmhhc2g7XHJcbiAgICAgICAgaWYgKHRpbWUgJiYgdGltZSA+IERhdGUubm93KCkgLSA2MDAwMCkge1xyXG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFwicmVkaXItaGFzaFwiKTtcclxuICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKF8pIHsgfVxyXG5leHBvcnQgZnVuY3Rpb24gcmVtZW1iZXJIYXNoTG9jYXRpb24oKSB7XHJcbiAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwicmVkaXItaGFzaFwiLCBKU09OLnN0cmluZ2lmeSh7IHRpbWU6IERhdGUubm93KCksIGhhc2g6IGxvY2F0aW9uLmhhc2ggfSkpO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhhc2gtcmVzdG9yZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCwgSHR0cEVycm9yIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH0gZnJvbSBcIi4vYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2VcIjtcclxuaW1wb3J0IHsgYXZvaWRTaW11bHRhbm91c0NhbGxzIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcclxuaW1wb3J0IHsgS2VkTW9kZWxNaWdyYXRvck1peGluIH0gZnJvbSAnLi4va2VkLW1vZGVsLW1pZ3JhdG9yJztcclxuaW1wb3J0ICcuL2hhc2gtcmVzdG9yZXInO1xyXG5pbXBvcnQgeyByZW1lbWJlckhhc2hMb2NhdGlvbiB9IGZyb20gJy4vaGFzaC1yZXN0b3Jlcic7XHJcbktlZE1vZGVsTWlncmF0b3JNaXhpbihLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZSk7XHJcbmV4cG9ydCB2YXIgc3RvcmFnZSA9IG5ldyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKTtcclxudmFyIHRpbWVPZlBhZ2VMb2FkID0gRGF0ZS5ub3coKTtcclxudmFyIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIodG9rZW5QYXRoLCB0b2tlblJlc3BvbnNlTWFwcGVyLCB0b2tlbklkKSB7XHJcbiAgICAgICAgdGhpcy50b2tlblBhdGggPSB0b2tlblBhdGg7XHJcbiAgICAgICAgdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyID0gdG9rZW5SZXNwb25zZU1hcHBlcjtcclxuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xyXG4gICAgICAgIHRoaXMudG9rZW5JbmZvID0geyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9O1xyXG4gICAgICAgIHRoaXMuZ2V0QmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMuZ2V0QmVhcmVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlci5wcm90b3R5cGUuZ2V0QmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhdGhpcy50b2tlbkluZm8udG9rZW4pIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudG9rZW5JZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgc3RvcmFnZS5sb2FkKHRoaXMudG9rZW5JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudG9rZW5JbmZvID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnRva2VuSW5mby5leHBpcmVzIDwgRGF0ZS5ub3coKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5yZWZyZXNoQmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2IsIF9jLCBfZDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBmZXRjaCh0aGlzLnRva2VuUGF0aCwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBY2NlcHQ6IFwidGV4dC9wbGFpbjsgYXBwbGljYXRpb24vanNvblwiIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZTogJ25vLWNhY2hlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiBcInNhbWUtb3JpZ2luXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMzAyIHx8ICghcmVzLnN0YXR1cyAmJiByZXMudHlwZSA9PT0gXCJvcGFxdWVyZWRpcmVjdFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXNlciBzZXNzaW9uIHRpbWVkIG91dCBhbmQgc2VydmVyIHdhbnRzIHRvIHJlZGlyZWN0IGVudGlyZSBwYWdlIHRvIGxvZ2luIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRpbWUgdG8gcmVsb2FkIGN1cnJlbnQgcGFnZSB0byBmb3JjZSBhIHJlZGlyZWN0IG9mIHRoZSBlbnRpcmUgcGFnZSBpbnN0ZWFkIGZvclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZWRpcmVjdGluZyB0byAvYXBpL3Rva2VuIG9yIHdoYXRldmVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSB0aW1lT2ZQYWdlTG9hZCA+IDYwMDAwKSB7IC8vIHByb2hpYml0IGVuZGxlc3MgbG9vcCBvZiByZWxvYWRpbmcgc2VsZi5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLndhbnRzUmVkaXJlY3QgPSB0cnVlOyAvLyBTbyB0aGF0IGxpc3RlbmVycyB0byBvbmJlZm9yZXVubG9hZCBjb3VsZCBzaG93IGFsdGVybmF0ZSBtZXNzYWdlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVkaXJlY3Qgd2FudGVkLiBSZWxvYWQgcGFnZS5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtZW1iZXJIYXNoTG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoMzAyLCBcIlJlZGlyZWN0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFwiSFRUUFwiICsgcmVzLnN0YXR1cyArIFwiIFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoRXJyb3IsIFt2b2lkIDAsIF9iICsgKF9lLnNlbnQoKSldKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSB0aGlzLnRva2VuUmVzcG9uc2VNYXBwZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudG9rZW5JbmZvID0gX2QuYXBwbHkodGhpcywgW19lLnNlbnQoKV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yYWdlLnNhdmUodGhpcy50b2tlbklkLCB0aGlzLnRva2VuSW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcjtcclxufSgpKTtcclxuZXhwb3J0IHsgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIgfTtcclxuZXhwb3J0IHZhciBpc29tb3JwaGljID0geyBmZXRjaDogZmV0Y2guYmluZChzZWxmKSwgYnRvYTogYnRvYS5iaW5kKHNlbGYpIH07XHJcbnZhciBLZWRCYWNrZW5kQ2xpZW50V2ViID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoS2VkQmFja2VuZENsaWVudFdlYiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDbGllbnRXZWIoYXBpQmFzZVVybCwgcHJvdmlkZXJPclRva2VuUGF0aCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGJlYXJlclByb3ZpZGVyID0gdHlwZW9mIHByb3ZpZGVyT3JUb2tlblBhdGggIT09ICdzdHJpbmcnID9cclxuICAgICAgICAgICAgcHJvdmlkZXJPclRva2VuUGF0aCA6XHJcbiAgICAgICAgICAgIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihwcm92aWRlck9yVG9rZW5QYXRoLCAob3B0aW9ucyAmJiBvcHRpb25zLnRva2VuUmVzcG9uc2VNYXBwZXIpIHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4gKHsgdG9rZW46IHgsIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogNjAgfSk7IH0pLCBvcHRpb25zICYmIG9wdGlvbnMudG9rZW5JZCk7XHJcbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBpc29tb3JwaGljLCBiZWFyZXJQcm92aWRlciwgYXBpQmFzZVVybCkgfHwgdGhpcztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZENsaWVudFdlYjtcclxufShLZWRCYWNrZW5kQ2xpZW50KSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwidmFyIERvY3VtZW50QWNjZXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRG9jdW1lbnRBY2Nlc3MoYWNjZXNzQ2xhaW1UeXBlLCBhY2Nlc3NDbGFpbVZhbHVlLCByaWdodCkge1xyXG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1UeXBlID0gYWNjZXNzQ2xhaW1UeXBlO1xyXG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1WYWx1ZSA9IGFjY2Vzc0NsYWltVmFsdWU7XHJcbiAgICAgICAgdGhpcy5yaWdodCA9IHJpZ2h0O1xyXG4gICAgfVxyXG4gICAgRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChhYykge1xyXG4gICAgICAgIGlmICghYWMpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIHZhciBzcGxpdCA9IGFjLnNwbGl0KCc6Jyk7XHJcbiAgICAgICAgaWYgKHNwbGl0Lmxlbmd0aCA8IDMpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XHJcbiAgICAgICAgdmFyIGNsYWltVHlwZSA9IERvY3VtZW50QWNjZXNzLnVuZXNjYXBlKHNwbGl0WzBdKTtcclxuICAgICAgICB2YXIgY2xhaW1WYWx1ZSA9IERvY3VtZW50QWNjZXNzLnVuZXNjYXBlKHNwbGl0WzFdKTtcclxuICAgICAgICB2YXIgcmlnaHQgPSBzcGxpdFsyXTtcclxuICAgICAgICBpZiAocmlnaHQgIT09ICdSJyAmJiByaWdodCAhPT0gJ1cnICYmIHJpZ2h0ICE9PSAnUycpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEFjY2VzcyhjbGFpbVR5cGUsIGNsYWltVmFsdWUsIHJpZ2h0KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIGFjY2Vzc0NvbXBvbmVudC5yZXBsYWNlKC9cXCUvZywgXCIlMjVcIikucmVwbGFjZSgvXFw6L2csIFwiJTNBXCIpO1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50QWNjZXNzLnVuZXNjYXBlID0gZnVuY3Rpb24gKGFjY2Vzc0NvbXBvbmVudCkge1xyXG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlM0EvZywgXCI6XCIpLnJlcGxhY2UoL1xcJTI1L2csIFwiJVwiKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVHlwZSkgKyBcIjpcIiArXHJcbiAgICAgICAgICAgIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVmFsdWUpICsgXCI6XCIgK1xyXG4gICAgICAgICAgICB0aGlzLnJpZ2h0O1xyXG4gICAgfTtcclxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmdBcnJheSA9IGZ1bmN0aW9uIChhY2wpIHtcclxuICAgICAgICByZXR1cm4gYWNsXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nKGFjKTsgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjOyB9KTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy50b1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xyXG4gICAgICAgIHJldHVybiBhY2wubWFwKGZ1bmN0aW9uIChhYykgeyByZXR1cm4gYWMudG9TdHJpbmcoKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERvY3VtZW50QWNjZXNzO1xyXG59KCkpO1xyXG5leHBvcnQgeyBEb2N1bWVudEFjY2VzcyB9O1xyXG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKGFjbCwgdXNlckNsYWltcywgcmVxdWVzdGVkUmlnaHQpIHtcclxuICAgIGlmICh1c2VyQ2xhaW1zLnNvbWUoZnVuY3Rpb24gKGNsYWltKSB7IHJldHVybiBjbGFpbS50eXBlID09PSAncm9sZScgJiYgY2xhaW0udmFsdWUgPT09IFwiQURNSU5cIjsgfSkpXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gYWNsLnNvbWUoZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICByZXR1cm4gdXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhLmFjY2Vzc0NsYWltVHlwZSA9PT0gYy50eXBlICYmXHJcbiAgICAgICAgICAgICAgICBhLmFjY2Vzc0NsYWltVmFsdWUgPT09IGMudmFsdWUgJiYgKChhLnJpZ2h0ID09PSAnUicgJiYgcmVxdWVzdGVkUmlnaHQgPT09ICdSJykgfHxcclxuICAgICAgICAgICAgICAgIChhLnJpZ2h0ID09PSAnVycgJiYgWydSJywgJ1cnXS5pbmRleE9mKHJlcXVlc3RlZFJpZ2h0KSA+PSAwKSB8fFxyXG4gICAgICAgICAgICAgICAgKGEucmlnaHQgPT09ICdTJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjZXNzLWNvbnRyb2wuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxudmFyIEh0dHBFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEh0dHBFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEh0dHBFcnJvcihjb2RlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgXCJIVFRQXCIgKyBjb2RlICsgXCIgXCIgKyBtZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNvZGUgPSBjb2RlO1xyXG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSBcImh0dHBcIiArIGNvZGU7XHJcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gSHR0cEVycm9yO1xyXG59KEVycm9yKSk7XHJcbmV4cG9ydCB7IEh0dHBFcnJvciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1odHRwLWVycm9yLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xyXG5leHBvcnQgKiBmcm9tICcuL3V0aWxzJztcclxuZXhwb3J0IHsgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICcuL2tlZC1iZWFyZXItcHJvdmlkZXInO1xyXG5leHBvcnQgKiBmcm9tICcuL2FjY2Vzcy1jb250cm9sJztcclxuZXhwb3J0IHsgUmVzdENsaWVudCB9O1xyXG5pbXBvcnQgeyBIdHRwRXJyb3IgfSBmcm9tICcuL2h0dHAtZXJyb3InO1xyXG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcclxuZXhwb3J0ICogZnJvbSAnLi9yZXN0Y2xpZW50JztcclxuO1xyXG52YXIgS2VkQmFja2VuZENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDbGllbnQoaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGJhc2VVcmwpIHtcclxuICAgICAgICB0aGlzLmh0dHAgPSBuZXcgUmVzdENsaWVudChpc29tb3JwaGljLCBiYXNlVXJsLCB7IGJlYXJlclByb3ZpZGVyOiBiZWFyZXJQcm92aWRlciB9KTtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmdldE15Q2xhaW1zID0gZnVuY3Rpb24gKHRhYmxlLCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQoXCJtZS9jbGFpbXMvXCIgKyAodGFibGUgfHwgXCJcIiksIG51bGwsIGZldGNoT3B0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmdldCh0YWJsZSArIFwiL1wiICsgaWQsIG9wdGlvbnMsIGZldGNoT3B0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpc3QgPSBmdW5jdGlvbiAodGFibGUsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnksIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubXV0YXRpb25zT25FbXB0eSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5Lm11dGF0aW9uc09uRW1wdHkgPSBKU09OLnN0cmluZ2lmeShvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwiXCIgKyB0YWJsZSwgcXVlcnksIGZldGNoT3B0aW9ucyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmJhdGNoID0gZnVuY3Rpb24gKHJlcXMsIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVvcmRlciBvcGVyYXRpb25zIHNvIHRoYXQgJ2FkZCdzIGNvbWUgZmlyc3QgYW5kICdkZWxldGUncyBjb21lIGxhc3Q6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXMgPSByZXFzLnNsaWNlKCkuc29ydChmdW5jdGlvbiAocmVxMSwgcmVxMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcTEub3AgPT09ICdhZGQnID8gLTEgOiByZXEyLm9wID09PSAnYWRkJyA/IDEgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcTEub3AgPT09ICdkZWxldGUnID8gMSA6IHJlcTIub3AgPT09ICdkZWxldGUnID8gLTEgOiAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLnBvc3QoXCJiYXRjaFwiLCByZXFzLCBmZXRjaE9wdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kbyA9IGZ1bmN0aW9uIChzY29wZUZuKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBydW5uZXI7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmVyID0gbmV3IEJhdGNoUnVubmVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlRm4ocnVubmVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5iYXRjaChydW5uZXIubXV0YXRpb25SZXF1ZXN0cyldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmRlbGV0ZVJlYWxtID0gZnVuY3Rpb24gKHJlYWxtKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZGVsZXRlKFwicmVhbG1zL1wiICsgcmVhbG0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5hZGQodGFibGUsIGRvYyk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIucHV0KHRhYmxlLCBkb2MpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51cGRhdGUodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5tZXJnZShicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmNsZWFyQnJhbmNoKGJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmRlbGV0ZSh0YWJsZSwgaWQpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnNoYXJlKHRhYmxlLCBpZCwgYWNsKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVuc2hhcmUodGFibGUsIGlkLCBhY2wpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmxpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubGluazIoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVubGluayhzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVubGluazIoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudW5kb0xpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnQ7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnQgfTtcclxudmFyIEJhdGNoUnVubmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmF0Y2hSdW5uZXIoKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzID0gW107XHJcbiAgICB9XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2FkZCcsIHRhYmxlOiB0YWJsZSwgZG9jOiBkb2MsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUucHV0ID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MpIHtcclxuICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xyXG4gICAgICAgIGRlbGV0ZSBkb2MuYWNsOyAvLyBGb3JiaWRkZW4gdG8gc2VuZCBhY2wgd2l0aCBwdXQoKSBjYWxscy5cclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAncHV0JywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYyB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgZGVsdGFEb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YURvYyk7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3VwZGF0ZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBkZWx0YURvYzogZGVsdGFEb2MsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ21lcmdlJywgYnJhbmNoSWQ6IGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZDogdGFyZ2V0QnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2NsZWFyLWJyYW5jaCcsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdkZWxldGUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnc2hhcmUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgYWNsOiBhY2wgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5zaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnbGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRUYWJsZTogdGFyZ2V0VGFibGUsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5saW5rMiA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnbGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCwgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51bmxpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3VubGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRUYWJsZTogdGFyZ2V0VGFibGUsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3VuZG8tbGluaycsIHNvdXJjZVRhYmxlOiBzb3VyY2VUYWJsZSwgc291cmNlSWQ6IHNvdXJjZUlkLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCwgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCYXRjaFJ1bm5lcjtcclxufSgpKTtcclxuZXhwb3J0IHsgQmF0Y2hSdW5uZXIgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgUmVzdENsaWVudCB9IGZyb20gJy4vcmVzdGNsaWVudCc7XHJcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4vdXRpbHMnO1xyXG52YXIgS2VkQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBLZWRCZWFyZXJQcm92aWRlcihpc29tb3JwaGljLCBzdG9yYWdlLCB0b2tlbklkLCBjbGllbnRJZCwgY2xpZW50U2VjcmV0LCB0b2tlblVybCwgdG9rZW5RdWVyeSkge1xyXG4gICAgICAgIHRoaXMuaXNvbW9ycGhpYyA9IGlzb21vcnBoaWM7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcclxuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcclxuICAgICAgICB0aGlzLmNsaWVudFNlY3JldCA9IGNsaWVudFNlY3JldDtcclxuICAgICAgICB0aGlzLnRva2VuVXJsID0gdG9rZW5Vcmw7XHJcbiAgICAgICAgdGhpcy50b2tlblF1ZXJ5ID0gdG9rZW5RdWVyeTtcclxuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcclxuICAgICAgICB0aGlzLmNsaWVudCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIFwiXCIsIHtcclxuICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMuY2xpZW50SWQsXHJcbiAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLmNsaWVudFNlY3JldFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZ2V0QmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMuZ2V0QmVhcmVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgICBLZWRCZWFyZXJQcm92aWRlci5wcm90b3R5cGUuZ2V0QmVhcmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2EsIHRva2VuLCBleHBpcmVzLCBfYiwgZV8xO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy50b2tlbkluZm8sIHRva2VuID0gX2EudG9rZW4sIGV4cGlyZXMgPSBfYS5leHBpcmVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW4gJiYgZXhwaXJlcyA+PSBEYXRlLm5vdygpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudHJ5cy5wdXNoKFsxLCA0LCAsIDZdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnN0b3JhZ2UubG9hZCh0aGlzLmNsaWVudElkICsgXCIvXCIgKyB0aGlzLnRva2VuSWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRva2VuSW5mbyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudG9rZW5JbmZvLnRva2VuICYmIHRoaXMudG9rZW5JbmZvLmV4cGlyZXMgPj0gRGF0ZS5ub3coKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVfMSA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCZWFyZXJQcm92aWRlci5wcm90b3R5cGUucmVmcmVzaEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgcmV0cmllcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJpZXMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXRyaWVzIDwgNikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJldHJpZXZpbmcgdG9rZW4gZm9yIFwiICsgdGhpcy50b2tlbklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGllbnQuZ2V0KHRoaXMudG9rZW5VcmwsIHRoaXMudG9rZW5RdWVyeSwgeyBjYWNoZTogJ3JlbG9hZCcgfSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJHb3QgXCIgKyByZXMuc3RhdHVzICsgXCIgXCIgKyByZXMuc3RhdHVzVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudG9rZW5JbmZvID0gKF9iLnRva2VuID0gX2Muc2VudCgpLCBfYi5leHBpcmVzID0gRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwLCBfYik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IHRva2VuIGZvciBcIiArIHRoaXMudG9rZW5JZCArIFwiOiBcIiArIEpTT04uc3RyaW5naWZ5KHRoaXMudG9rZW5JbmZvKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5zYXZlKHRoaXMuY2xpZW50SWQgKyBcIi9cIiArIHRoaXMudG9rZW5JZCwgdGhpcy50b2tlbkluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgKytyZXRyaWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byByZXRyaWV2ZSB0b2tlbiBmb3IgXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuSWQpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEtlZEJlYXJlclByb3ZpZGVyO1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCZWFyZXJQcm92aWRlciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWQtYmVhcmVyLXByb3ZpZGVyLmpzLm1hcCIsIi8qXHJcbmRlY2xhcmUgdmFyIEJ1ZmZlcjsgLy8gbm9kZSBidWlsdC1pblxyXG5cclxuXHJcbmZ1bmN0aW9uIGJhc2ljQXV0aEhlYWRlcih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICAgIHJldHVybiBcIkJhc2ljIFwiICsgbmV3IEJ1ZmZlcih1c2VybmFtZSArIFwiOlwiICsgcGFzc3dvcmQpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xyXG59XHJcbiovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tIFwiLi91dGlsc1wiO1xyXG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9lbWl0dGVyJztcclxudmFyIFJlc3RDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIG9wdGlvbnMpIHtcclxuICAgICAgICB0aGlzLmlzb21vcnBoaWMgPSBpc29tb3JwaGljO1xyXG4gICAgICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgICB0aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucyA9IDA7XHJcbiAgICAgICAgdGhpcy5fc3RhdHVzID0gbmV3IEVtaXR0ZXIodGhpcyk7XHJcbiAgICAgICAgdGhpcy5mZXRjaE9wdGlvbnMgPSB7IG1vZGU6ICdjb3JzJyB9O1xyXG4gICAgICAgIHRoaXMuYXV0aEhlYWRlciA9IG9wdGlvbnMuYmVhcmVyID9cclxuICAgICAgICAgICAgXCJCZWFyZXIgXCIgKyBvcHRpb25zLmJlYXJlciA6XHJcbiAgICAgICAgICAgIG9wdGlvbnMudXNlcm5hbWUgP1xyXG4gICAgICAgICAgICAgICAgXCJCYXNpYyBcIiArIGlzb21vcnBoaWMuYnRvYShvcHRpb25zLnVzZXJuYW1lICsgXCI6XCIgKyAob3B0aW9ucy5wYXNzd29yZCB8fCBcIlwiKSkgOlxyXG4gICAgICAgICAgICAgICAgbnVsbDtcclxuICAgICAgICB0aGlzLmJlYXJlclByb3ZpZGVyID0gb3B0aW9ucy5iZWFyZXJQcm92aWRlciB8fCBudWxsO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlc3RDbGllbnQucHJvdG90eXBlLCBcInN0YXR1c1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uIChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICsrdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XHJcbiAgICAgICAgdGhpcy5fc3RhdHVzLmRpc3BhdGNoKHRoaXMpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9mZXRjaChwYXRoLCBtZXRob2QsIGhlYWRlcnMsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuICAgICAgICAgICAgLS1fdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XHJcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMuZGlzcGF0Y2goX3RoaXMpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzO1xyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgLS1fdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XHJcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMuZGlzcGF0Y2goX3RoaXMpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5fZmV0Y2ggPSBmdW5jdGlvbiAocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeVN0ciwgX2EsIGF1dGhIZWFkZXIsIHRva2VuSW5mbywgYmVhcmVyUHJvdmlkZXIsIF9iLCBfYywgdXJsLCByZXMsIHd3d2F1dGgsIF9kO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2UubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmZXRjaE9wdGlvbnMgJiYgZmV0Y2hPcHRpb25zLmNhY2hlID09PSAnbm8tY2FjaGUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBiYWNrLWJ1dHRvbiBub3QgcmVzcGVjdGluZyBjYWNoZSBjb250cm9sIGluIENocm9tZS9PcGVyYS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBhIHF1ZXJ5IHBhcmFtZXRlciB0byBmb3JjZSBhIGNhY2hlIGVudHJ5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHRzbGliXzEuX19hc3NpZ24oe30sIHF1ZXJ5LCB7IG5vY2FjaGU6IGNyZWF0ZVVVSUQoKSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVN0ciA9IHF1ZXJ5ICYmIE9iamVjdC5rZXlzKHF1ZXJ5KS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gcXVlcnlba2V5XSAhPT0gdW5kZWZpbmVkOyB9KS5tYXAoZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrZXkpICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIj1cIiArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5W2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJyYnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLCBhdXRoSGVhZGVyID0gX2EuYXV0aEhlYWRlciwgdG9rZW5JbmZvID0gX2EudG9rZW5JbmZvLCBiZWFyZXJQcm92aWRlciA9IF9hLmJlYXJlclByb3ZpZGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghYXV0aEhlYWRlciAmJiAhdG9rZW5JbmZvICYmIGJlYXJlclByb3ZpZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IudG9rZW5JbmZvID0gdG9rZW5JbmZvID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRva2VuSW5mbykgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRva2VuSW5mby5leHBpcmVzIDwgRGF0ZS5ub3coKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRva2VuIGV4cGlyZWQuIFJlZnJlc2ggaXQ6XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGJlYXJlclByb3ZpZGVyLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50b2tlbkluZm8gPSB0b2tlbkluZm8gPSBfZS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhIZWFkZXIgPSBcIkJlYXJlciBcIiArIHRva2VuSW5mby50b2tlbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gb25lIHdheSBvciBhbm90aGVyLCB3ZSd2ZSBjb25jbHVkZWQgYW4gQXV0aG9yaXphdGlvbiBoZWFkZXIgdG8gdXNlOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aEhlYWRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gYXV0aEhlYWRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB0aGlzLmJhc2VVcmwgKyBwYXRoICsgKHF1ZXJ5U3RyID8gXCI/XCIgKyBxdWVyeVN0ciA6IFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPT0gNDAxICYmIHRoaXMuYmVhcmVyUHJvdmlkZXIpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd3d3YXV0aCA9IHJlcy5oZWFkZXJzLmdldChcInd3dy1hdXRoZW50aWNhdGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IFwiICsgcmVzLnN0YXR1cyArIFwiIGZyb20gXCIgKyAodGhpcy5iYXNlVXJsICsgcGF0aCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh3d3dhdXRoICYmIC9CZWFyZXIvaS50ZXN0KHd3d2F1dGgpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5iZWFyZXJQcm92aWRlci5yZWZyZXNoQmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2QudG9rZW5JbmZvID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLkF1dGhvcml6YXRpb24gPSBcIkJlYXJlciBcIiArIHRoaXMudG9rZW5JbmZvLnRva2VuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmlzb21vcnBoaWMuZmV0Y2godXJsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmZldGNoT3B0aW9ucywgeyBoZWFkZXJzOiBoZWFkZXJzLCBtZXRob2Q6IG1ldGhvZCB9LCBmZXRjaE9wdGlvbnMpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gOTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovLCByZXNdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocGF0aCwgcXVlcnksIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiR0VUXCIsIHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb247IHRleHQvcGxhaW5cIiB9LCBxdWVyeSwgZmV0Y2hPcHRpb25zKTtcclxuICAgIH07XHJcbiAgICBSZXN0Q2xpZW50LnByb3RvdHlwZS5wb3N0ID0gZnVuY3Rpb24gKHBhdGgsIGRhdGEsIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiUE9TVFwiLCB7XHJcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICAgIH0sIG51bGwsIHRzbGliXzEuX19hc3NpZ24oe30sIGZldGNoT3B0aW9ucywgeyBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSB9KSk7XHJcbiAgICB9O1xyXG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHBhdGgsIHF1ZXJ5LCBib2R5LCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIkRFTEVURVwiLCB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uOyB0ZXh0L3BsYWluXCIgfSwgcXVlcnksIHRzbGliXzEuX19hc3NpZ24oe30sIGZldGNoT3B0aW9ucywgeyBib2R5OiBib2R5IH0pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVzdENsaWVudDtcclxufSgpKTtcclxuZXhwb3J0IHsgUmVzdENsaWVudCB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZXN0Y2xpZW50LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVVVUlEKCkge1xyXG4gICAgLy8gRGVjZW50IHNvbHV0aW9uIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDUwMzQvaG93LXRvLWNyZWF0ZS1hLWd1aWQtdXVpZC1pbi1qYXZhc2NyaXB0XHJcbiAgICB2YXIgZCA9IERhdGUubm93KCk7XHJcbiAgICB2YXIgdXVpZCA9ICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICB2YXIgciA9IChkICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDtcclxuICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpO1xyXG4gICAgICAgIHJldHVybiAoYyA9PT0gJ3gnID8gciA6IChyICYgMHg3IHwgMHg4KSkudG9TdHJpbmcoMTYpO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdXVpZDtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gYXZvaWRTaW11bHRhbm91c0NhbGxzKG1ldGhvZCkge1xyXG4gICAgdmFyIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCFvbmdvaW5nUHJvbWlzZSkge1xyXG4gICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgb25nb2luZ1Byb21pc2UgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvbmdvaW5nUHJvbWlzZTtcclxuICAgIH07XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbElkKHJlYWxtKSB7XHJcbiAgICB2YXIgcHJlZml4ID0gJ2VjOTZiM2JlLTQ1ZmMtNDFkMy1iNjllLSc7XHJcbiAgICB2YXIgcGFkID0gWyc1MCcsICcwOCcsICdlMScsICc0MCcsICdlNCcsICdlNyddO1xyXG4gICAgaWYgKHJlYWxtLmxlbmd0aCA+IDYpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVG9vIGxvbmcgcmVhbG1cIik7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYWxtLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgdmFyIGhleCA9IHJlYWxtLmNoYXJDb2RlQXQoaSkudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgIHBhZFtpXSA9IGhleC5sZW5ndGggPT09IDIgP1xyXG4gICAgICAgICAgICBoZXggOlxyXG4gICAgICAgICAgICAnMCcgKyBoZXg7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcHJlZml4ICsgcGFkLmpvaW4oJycpO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlUHJlZGVzdGluYXRlZElkKGlucHV0KSB7XHJcbiAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZW5jb2RlciwgZGF0YSwgZGlnZXN0LCBfYSwgaTtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgIGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhID0gZW5jb2Rlci5lbmNvZGUoaW5wdXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIF9hID0gVWludDhBcnJheS5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgIGRpZ2VzdCA9IG5ldyAoX2EuYXBwbHkoVWludDhBcnJheSwgW3ZvaWQgMCwgX2Iuc2VudCgpXSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuaWJibGUgPSBkaWdlc3RbaSsrXSAlIDE2IHwgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3YXNoZWROaWJibGUgPSBjID09PSAneCcgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pYmJsZSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlICYgMHg3IHwgMHg4O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdhc2hlZE5pYmJsZS50b1N0cmluZygxNik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuLypleHBvcnQgZnVuY3Rpb24gYnVmMmhleChidWZmZXI6IEFycmF5QnVmZmVyKSB7XHJcbiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChcclxuICAgIG5ldyBVaW50OEFycmF5KGJ1ZmZlciksXHJcbiAgICAoeDogbnVtYmVyKSA9PiAoJzAwJyArIHgudG9TdHJpbmcoMTYpKS5zbGljZSgtMikpLmpvaW4oJycpO1xyXG59Ki9cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5KGEsIG1hcHBlcikge1xyXG4gICAgdmFyIHJldHZhbCA9IGE7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgKytpKSB7XHJcbiAgICAgICAgdmFyIHQgPSBhW2ldO1xyXG4gICAgICAgIHZhciBtYXBwZWQgPSBtYXBwZXIodCk7XHJcbiAgICAgICAgaWYgKG1hcHBlZCAhPT0gdCkge1xyXG4gICAgICAgICAgICBpZiAocmV0dmFsID09PSBhKVxyXG4gICAgICAgICAgICAgICAgcmV0dmFsID0gYS5zbGljZSgpO1xyXG4gICAgICAgICAgICByZXR2YWxbaV0gPSBtYXBwZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldHZhbDtcclxufVxyXG4vKlxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQXJyYXk8VD4oYTogVFtdLCBtYXBwZXI6ICh0OiBUKSA9PiBUIHwgZmFsc2UpOiBUW10ge1xyXG4gIGxldCByZXR2YWwgPSBhO1xyXG4gIGxldCBqID0gMDtcclxuICBmb3IgKGxldCBpPTAsbD1hLmxlbmd0aDsgaTxsOyArK2ksICsraikge1xyXG4gICAgY29uc3QgdCA9IGFbaV07XHJcbiAgICBjb25zdCBtYXBwZWQgPSBtYXBwZXIodCk7XHJcbiAgICBpZiAobWFwcGVkID09PSBmYWxzZSkge1xyXG4gICAgICAvLyBNYXBwZXIgd2FudHMgdG8gZGVsZXRlIHRoaXMgZG9jLlxyXG4gICAgICBpZiAocmV0dmFsID09PSBhKSByZXR2YWwgPSBhLnNsaWNlKCk7XHJcbiAgICAgIHJldHZhbC5zcGxpY2UoaiwgMSk7XHJcbiAgICAgIC0tajsgLy8gY29tcGVuc2F0ZSBmb3IgKytqXHJcbiAgICB9IGVsc2UgaWYgKG1hcHBlZCAhPT0gdCkge1xyXG4gICAgICBpZiAocmV0dmFsID09PSBhKSByZXR2YWwgPSBhLnNsaWNlKCk7XHJcbiAgICAgIHJldHZhbFtqXSA9IG1hcHBlZDtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIHJldHZhbDtcclxufVxyXG4qLyBcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIiwiaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tIFwia2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb25cIjtcclxuaW1wb3J0IHsgZ2V0VGFibGVGcm9tTGFiZWwgfSBmcm9tIFwiLi91dGlsc1wiO1xyXG52YXIgQ2FjaGVCdXN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ2FjaGVCdXN0KCkge1xyXG4gICAgfVxyXG4gICAgQ2FjaGVCdXN0LmdldENhY2hlQnVzdCA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnksIHVzZXIsIGluY2x1ZGVzKSB7XHJcbiAgICAgICAgdmFyIGludm9sdmVkSXRlbXMgPSBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKTtcclxuICAgICAgICByZXR1cm4gaW52b2x2ZWRJdGVtc1xyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImNhY2hlLWJ1c3QtXCIgKyB1c2VyICsgXCItXCIgKyBpdGVtKTsgfSlcclxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICEhdmFsdWU7IH0pXHJcbiAgICAgICAgICAgIC5qb2luKCcvJykgfHwgJ3N0YXRpYyc7XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZSA9IGZ1bmN0aW9uIChyZXFzLCB1c2VyKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMocmVxcyk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBpdGVtID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImNhY2hlLWJ1c3QtXCIgKyB1c2VyICsgXCItXCIgKyBpdGVtLCAnJyArIERhdGUubm93KCkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKSB7XHJcbiAgICAgICAgdmFyIGhhc0VkZ2VzRnJvbSA9IHF1ZXJ5Lmhhc0VkZ2VzRnJvbTtcclxuICAgICAgICB2YXIgcmVsYXRlZFRhYmxlcyA9IGluY2x1ZGVzXHJcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBKc29uU2NoZW1hLnRhYmxlc1t0YWJsZV0ucmVsYXRpb25zaGlwc1tsYWJlbF07IH0pXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiAhIXRhYmxlOyB9KTtcclxuICAgICAgICBpZiAoaGFzRWRnZXNGcm9tKVxyXG4gICAgICAgICAgICByZWxhdGVkVGFibGVzLnB1c2goXCJoZWZcIiArIHRhYmxlKTtcclxuICAgICAgICByZXR1cm4gW3RhYmxlLCAnbWFzdGVyJywgcXVlcnkuYnJhbmNoSWRdLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4gISF4OyB9KS5jb25jYXQocmVsYXRlZFRhYmxlcykuc29ydCgpO1xyXG4gICAgfTtcclxuICAgIENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMgPSBmdW5jdGlvbiAocmVxcykge1xyXG4gICAgICAgIHZhciBpbnZhbGlkYXRpb25TZXQgPSB7fTtcclxuICAgICAgICByZXFzLmZvckVhY2goZnVuY3Rpb24gKHJlcSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHJlcS5vcCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3B1dCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLnRhYmxlXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdsaW5rJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VubGluayc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1bmRvLWxpbmsnOlxyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuc291cmNlVGFibGVdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbXCJoZWYtXCIgKyBnZXRUYWJsZUZyb21MYWJlbChyZXEuc291cmNlVGFibGUsIHJlcS5sYWJlbCldID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5icmFuY2hJZF0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbWVyZ2UnOlxyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLnRhcmdldEJyYW5jaElkIHx8IFwibWFzdGVyXCJdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhpbnZhbGlkYXRpb25TZXQpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDYWNoZUJ1c3Q7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IENhY2hlQnVzdCB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jYWNoZS1idXN0LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IG1lcmdlRGVsdGFzIH0gZnJvbSAnLi4vZGVsdGEtbWVyZ2UnO1xyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlNdXRhdGlvbnNPbkRlbHRhcyhicmFuY2hJZCwgZGVsdGFzLCBtdXRhdGlvbnMsIG9wdGltaXN0aWMsIHVzZXJEaXNwbGF5TmFtZSwgaGFzQWRkaXRpb25hbEZpbHRlcikge1xyXG4gICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAobSkge1xyXG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xyXG4gICAgICAgICAgICBjYXNlICdhZGQtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gQWRkUmVsYXRlZCBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAoIWhhc0FkZGl0aW9uYWxGaWx0ZXIgJiYgbS5icmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2FkZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VJZDogbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLnJlbGF0ZWREb2MuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbS5ncmFwaFByb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VUYWJsZTogbS50YWJsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS5yZWxhdGVkRG9jLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcjogdXNlckRpc3BsYXlOYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dLmNvbmNhdChkZWx0YXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXJCcmFuY2ggUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKG0uYnJhbmNoSWQgPT09IGJyYW5jaElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBEZWxldGUgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyB0eXBlIG9mIG11dGF0aW9uIGNhbiBub3QgYmUgcGVyZm9ybWVkIG9udG8gYnJhbmNoZXMuIFRoZXJlJ3Mgbm8gYnJhbmNoSWQgcHJvcGVydHkgb24gbS5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdtZXJnZSc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gTWVyZ2UgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKG0uYnJhbmNoSWQgPT09IGJyYW5jaElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChtLnRhcmdldEJyYW5jaElkID09PSBicmFuY2hJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgY2hhbmdlIHdpbGwgYXBwZW5kIG5ldyBkZWx0YXMgdG8gb3VyIGRlbHRhcyBhcnJheSBidXQgd2UgZG9uJ3Qga25vdyB3aGF0IHdvdWxkIGNvbWUuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byByZWZldGNoIGZyb20gc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG51bGwgfTsgLy8gQ2FsbGVyIHNob3VsZCBjaGVjayBmb3IgbnVsbCBhbmQgcmUtZmV0Y2ggZGF0YSBmcm9tIHNlcnZlci5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlLVJlbGF0ZWQgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhc0FkZGl0aW9uYWxGaWx0ZXIgfHwgbS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgIGRlbHRhcyA9IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZW1vdmUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VJZDogbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0ucmVsYXRlZERvYy5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS5yZWxhdGVkRG9jLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBtLmdyYXBoUHJvcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVGFibGU6IG0udGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yOiB1c2VyRGlzcGxheU5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbWV0YTogb3B0aW1pc3RpYyA/ICdhZGRpbmcnIDogJ3BlcnNpc3RlZCdcclxuICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICd1bmRvLWxpbmsnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIFVuZG8tTGluayBSZXBvTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICBpZiAobS5icmFuY2hJZCAhPT0gYnJhbmNoSWQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gZGVsdGFzLmZpbmRJbmRleChmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGQudHlwZSA9PT0gJ2FkZCcgfHwgZC50eXBlID09PSAncmVtb3ZlJyB8fCBkLnR5cGUgPT09ICd1bmRvLWxpbmsnKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5zb3VyY2VJZCA9PT0gbS5pZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZC50YXJnZXRJZCA9PT0gbS5yZWxhdGVkSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA8IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRm91bmQgYW4gXCJhZGRcIiBvciBcInJlbW92ZVwiIGRlbHRhIHRvIGNoYW5nZTpcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW1pc3RpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGFSZWxhdGlvbiA9IGRlbHRhc1tpZHhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSBleGlzdGluZyBhZGQvcmVtb3ZlIGRlbHRhIGFzIGN1cnJlbmx0eSBiZWluZyBkZWxldGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IGRlbHRhcy5zbGljZSgwLCBpZHgpLmNvbmNhdChbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YVJlbGF0aW9uLCB7ICRtZXRhOiBvcHRpbWlzdGljID8gJ3JlbW92aW5nJyA6ICdwZXJzaXN0ZWQnIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sIGRlbHRhcy5zbGljZShpZHggKyAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQZXJzaXN0ZWQuIEp1c3QgcmVtb3ZlIGl0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBkZWx0YXMuc2xpY2UoMCwgaWR4KS5jb25jYXQoZGVsdGFzLnNsaWNlKGlkeCArIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKG0uYnJhbmNoSWQgIT09IGJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IGRlbHRhcy5maW5kSW5kZXgoZnVuY3Rpb24gKGRlbHRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWx0YS50eXBlID09PSAnbW9kaWZ5JyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGEudGFyZ2V0SWQgPT09IG0uaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkeCA8IDAgJiYgIWhhc0FkZGl0aW9uYWxGaWx0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9kaWZ5JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZTogbS50YWJsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBtLnRhcmdldE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbS5kZWx0YURvYyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnM6IFt1c2VyRGlzcGxheU5hbWVdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ2FkZGluZycgOiAncGVyc2lzdGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dLmNvbmNhdChkZWx0YXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRGVsdGFEb2MgPSBkZWx0YXNbaWR4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRyaWJ1dG9ycyA9IGV4aXN0aW5nRGVsdGFEb2MuY29udHJpYnV0b3JzLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY29udHJpYnV0b3JzLmluY2x1ZGVzKHVzZXJEaXNwbGF5TmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9ycy5wdXNoKHVzZXJEaXNwbGF5TmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0RhdGEgPSBtZXJnZURlbHRhcyhleGlzdGluZ0RlbHRhRG9jLmRhdGEsIG0uZGVsdGFEb2MsIHsgcmVtb3ZlVW5zZXRQcm9wczogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljICYmIE9iamVjdC5rZXlzKG5ld0RhdGEpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29tbWl0dGVkIG11dGF0aW9uIHRoYXQgcmVzZXRzIGEgZGVsdGFEb2MuIFJlbW92ZSB0aGUgZGVsdGFEb2MgZW50aXJlbHk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBkZWx0YXMuc2xpY2UoMCwgaWR4KS5jb25jYXQoZGVsdGFzLnNsaWNlKGlkeCArIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21vZGlmeScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlOiBtLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5pZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS50YXJnZXROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBuZXdEYXRhLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3JzOiBjb250cmlidXRvcnMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZXRhOiBvcHRpbWlzdGljID8gJ3VwZGF0aW5nJyA6ICdwZXJzaXN0ZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uY29uY2F0KGRlbHRhcy5zbGljZSgwLCBpZHgpLCBkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGZvciAodmFyIF9pID0gMCwgbXV0YXRpb25zXzEgPSBtdXRhdGlvbnM7IF9pIDwgbXV0YXRpb25zXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIG0gPSBtdXRhdGlvbnNfMVtfaV07XHJcbiAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKG0pO1xyXG4gICAgICAgIGlmICh0eXBlb2Ygc3RhdGVfMSA9PT0gXCJvYmplY3RcIilcclxuICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGVsdGFzO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGx5LW11dGF0aW9ucy1vbi1kZWx0YXMuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgSHR0cEVycm9yIH0gZnJvbSAnLi4vLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgYXBwbHlNdXRhdGlvbnNPbkRlbHRhcyB9IGZyb20gJy4vYXBwbHktbXV0YXRpb25zLW9uLWRlbHRhcyc7XHJcbnZhciBEZWx0YUNhY2hlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVsdGFDYWNoZShnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSkge1xyXG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlciA9IGdldFVzZXI7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUgPSBnZXRVc2VyRGlzcGxheU5hbWU7XHJcbiAgICAgICAgdGhpcy5sb29rdXAgPSB7fTtcclxuICAgIH1cclxuICAgIERlbHRhQ2FjaGUucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgX2EpIHtcclxuICAgICAgICB2YXIgb3B0aW1pc3RpYyA9IChfYSA9PT0gdm9pZCAwID8geyBvcHRpbWlzdGljOiBmYWxzZSB9IDogX2EpLm9wdGltaXN0aWM7XHJcbiAgICAgICAgLy8gQXBwbHkgbXV0YXRpb25zIGxvY2FsbHkgb250byB0aGUgRGVsdGFDYWNoZSBhbmQgbm90aWZ5IHRoZWlyIHN1YnNjcmliZXJzXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYiA9IE9iamVjdC5rZXlzKHRoaXMubG9va3VwKTsgX2kgPCBfYi5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5S2V5ID0gX2JbX2ldO1xyXG4gICAgICAgICAgICB2YXIgY2FjaGVFbnRyeSA9IHRoaXMubG9va3VwW3F1ZXJ5S2V5XTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIC8vIEluc3RlYWQgaGVyZTogU3RvcmUgdGhlIG11dGF0aW9ucyBvbiBjYWNoZUVudHJ5LiBObyBtYXR0ZXIgaWYgaXQgeWV0IGhhcyB2YWx1ZSBvciBub3QuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGVuIGFwcGx5IG11dGF0aW9uIHdoZW5ldmVyIHN1YnNjcmliaW5nISAoQmV0dGVyIGhhbmRsaW5nIG9mIG11dGF0aW9ucyB0aGF0IGFycml2ZXMgYmVmb3JlIGZldGNoKCkgaXMgZG9uZSlcclxuICAgICAgICAgICAgICAgIC8vIChTZWUgaG93IEkgaGFuZGxlIHRoaXMgaW4gcXVlcnktc2V0LnRzKVxyXG4gICAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gYXBwbHlNdXRhdGlvbnNPbkRlbHRhcyhjYWNoZUVudHJ5LnF1ZXJ5LmJyYW5jaElkLCBjYWNoZUVudHJ5LnZhbHVlLCBtdXRhdGlvbnMsIG9wdGltaXN0aWMsIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lKCksICEhY2FjaGVFbnRyeS5xdWVyeS50YWdzKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBtdXRhdGlvbiByZXF1aXJlcyBjYWNoZUVudHJ5IHRvIGJlIHJlZmV0Y2hlZCBmcm9tIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxsZXIgaGFzIHN1Y2Nlc3NmdWxseSBwZXJmb3JtZWQgdGhlIG11dGF0aW9ucyBhbmQgZ290IHN1Y2Nlc3MgYmFjayBmcm9tIHNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXQncyBvayB0byByZWZldGNoIHRoZSBkZWx0YXMgZnJvbSBzZXJ2ZXIgbm93OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LmZldGNoKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFmdGVyIGZldGNoIGNvbXBsZXRlcywgaXQgd2lsbCBub3RpZnkgdGhlIHN1YnNjcmliZXJzLlxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gY2FjaGVFbnRyeS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkub3B0aW1pc3RpY1ZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LnZhbHVlID0gbmV3VmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5ub3RpZnkobmV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERlbHRhQ2FjaGUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChxdWVyeSwgb2JzZXJ2ZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBjYWNoZUVudHJ5ID0gdGhpcy5sb29rdXBbcXVlcnkuYnJhbmNoSWQgKyBxdWVyeS50YWdzXTtcclxuICAgICAgICBpZiAoIWNhY2hlRW50cnkpIHtcclxuICAgICAgICAgICAgY2FjaGVFbnRyeSA9IG5ldyBEZWx0YUNhY2hlRW50cnkodGhpcy5nZXRDbGllbnQoKSwgcXVlcnkpO1xyXG4gICAgICAgICAgICB0aGlzLmxvb2t1cFtxdWVyeS5icmFuY2hJZCArIHF1ZXJ5LnRhZ3NdID0gY2FjaGVFbnRyeTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNhY2hlRW50cnkuY2xlYW51cFRpbWVyKSB7XHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChjYWNoZUVudHJ5LmNsZWFudXBUaW1lcik7XHJcbiAgICAgICAgICAgIGNhY2hlRW50cnkuY2xlYW51cFRpbWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcclxuICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGNhY2hlRW50cnkuc3Vic2NyaWJlcnMgPSBjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IF9hLm9ic2VydmVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvICE9PSBvYnNlcnZlcjtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgX3RoaXMubG9va3VwW3F1ZXJ5LmJyYW5jaElkICsgcXVlcnkudGFnc107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBjYWNoZUVudHJ5LnN1YnNjcmliZXJzLnB1c2goeyBvYnNlcnZlcjogb2JzZXJ2ZXIsIHN1YnNjcmlwdGlvbjogc3Vic2NyaXB0aW9uIH0pO1xyXG4gICAgICAgIGlmIChjYWNoZUVudHJ5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIFZhbHVlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWQgYWxyZWFkeS4gUGljayBmcm9tIGNhY2hlLlxyXG4gICAgICAgICAgICBvYnNlcnZlcihjYWNoZUVudHJ5Lm9wdGltaXN0aWNWYWx1ZSB8fCBjYWNoZUVudHJ5LnZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjYWNoZUVudHJ5LmlzRmV0Y2hpbmcpIHtcclxuICAgICAgICAgICAgLy8gQSB2YWx1ZSBpcyBvbiBpdHMgd2F5LiBTaXQgYmFjayBhbmQgcmVsYXguIEFsbCByZWdpc3RlcmVkXHJcbiAgICAgICAgICAgIC8vIG9ic2VydmVycyAoaW5jbHVkaW5nIHRoaXMgb25lKSB3aWxsIGJlIG5vdGlmaWVkIHdoZW4gZGF0YSBhcnJpdmVzXHJcbiAgICAgICAgICAgIC8vIG9yIGZhaWxzLlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjYWNoZUVudHJ5LmVycm9yKSB7XHJcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGNhY2hlRW50cnkuZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjYWNoZUVudHJ5LmZldGNoKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlbHRhQ2FjaGU7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IERlbHRhQ2FjaGUgfTtcclxudmFyIERlbHRhQ2FjaGVFbnRyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlbHRhQ2FjaGVFbnRyeShjbGllbnQsIHF1ZXJ5KSB7XHJcbiAgICAgICAgdGhpcy5mZXRjaE9wZXJhdGlvbklkID0gMDsgLy8gTWFrZXMgc3VyZSBhIHJlLWZldGNoIHdpbGwgZGlzY2FyZCB0aGUgcmVzdWx0IGZyb20gYW55IG9uZ29pbmcgZmV0Y2guXHJcbiAgICAgICAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub3B0aW1pc3RpY1ZhbHVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5pc0ZldGNoaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jbGVhbnVwVGltZXIgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBmZXRjaE9wZXJhdGlvbklkID0gKyt0aGlzLmZldGNoT3BlcmF0aW9uSWQ7XHJcbiAgICAgICAgdGhpcy5pc0ZldGNoaW5nID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmZldGNoRnJvbVNlcnZlcigpLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIC8vIFN1Y2Nlc3NcclxuICAgICAgICAgICAgaWYgKGZldGNoT3BlcmF0aW9uSWQgPT09IF90aGlzLmZldGNoT3BlcmF0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmlzRmV0Y2hpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHZhbHVlLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGIuZGF0ZVRpbWUgLSBhLmRhdGVUaW1lOyB9KTsgLy8gTGF0ZXN0IGZpcnN0XHJcbiAgICAgICAgICAgICAgICBfdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub3B0aW1pc3RpY1ZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5ub3RpZnkodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIEZhaWxcclxuICAgICAgICAgICAgaWYgKGZldGNoT3BlcmF0aW9uSWQgPT09IF90aGlzLmZldGNoT3BlcmF0aW9uSWQpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmlzRmV0Y2hpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5mYWlsKGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUuZmV0Y2hGcm9tU2VydmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnF1ZXJ5LmJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEZWx0YXMgb25seSBhdmFpbGFibGUgb24gYnJhbmNoZXMnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5jbGllbnQuaHR0cC5nZXQoJ2RlbHRhcycsIHRoaXMucXVlcnkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyA+PSAzMDAgfHwgcmVzLnN0YXR1cyA8IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUubm90aWZ5ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuc3Vic2NyaWJlcnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfYiA9IF9hW19pXSwgb2JzZXJ2ZXIgPSBfYi5vYnNlcnZlciwgc3Vic2NyaXB0aW9uID0gX2Iuc3Vic2NyaXB0aW9uO1xyXG4gICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRGVsdGFDYWNoZUVudHJ5LnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSB0aGlzLnN1YnNjcmliZXJzLnNsaWNlKCk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgY29weV8xID0gY29weTsgX2kgPCBjb3B5XzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IGNvcHlfMVtfaV0sIG9ic2VydmVyID0gX2Eub2JzZXJ2ZXIsIHN1YnNjcmlwdGlvbiA9IF9hLnN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWx0YUNhY2hlRW50cnk7XHJcbn0oKSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlbHRhLWNhY2hlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tICcuLi8uLi9vYnNlcnZhYmxlJztcclxudmFyIERlbHRhQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKERlbHRhQ29sbGVjdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIERlbHRhQ29sbGVjdGlvbihkZWx0YUNhY2hlLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuZGVsdGFDYWNoZS5zdWJzY3JpYmUocXVlcnksIG9ic2VydmVyKTsgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5kZWx0YUNhY2hlID0gZGVsdGFDYWNoZTtcclxuICAgICAgICBfdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIERlbHRhQ29sbGVjdGlvbi5wcm90b3R5cGUudGFncyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdGFncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHRhZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEZWx0YUNvbGxlY3Rpb24odGhpcy5kZWx0YUNhY2hlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5LCB7IHRhZ3M6IHRhZ3MgfSkpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWx0YUNvbGxlY3Rpb247XHJcbn0oQ29sbGVjdGlvbikpO1xyXG5leHBvcnQgeyBEZWx0YUNvbGxlY3Rpb24gfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtY29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlEZWx0YShkb2MsIGRlbHRhKSB7XHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRlbHRhKTtcclxuICAgIHZhciB0YXJnZXREb2MgPSBkb2M7XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMSA9IGtleXM7IF9pIDwga2V5c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBrZXkgPSBrZXlzXzFbX2ldO1xyXG4gICAgICAgIGlmICh0YXJnZXREb2MgPT09IGRvYylcclxuICAgICAgICAgICAgdGFyZ2V0RG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jKTtcclxuICAgICAgICB2YXIgdmFsID0gZGVsdGFba2V5XTtcclxuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhSW5zdHJ1Y3Rpb25zID0gT2JqZWN0LmtleXModmFsKVxyXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcclxuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAobWkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHVuc2V0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdGhpbmcgb24gdGFyZ2V0IGRvYyFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvYy4kd2FzVW5zZXQgPSB0cnVlOyAvLyBKdXN0IG1hcmsgaXQgZm9yIHJlLXJldHJpZXZhbCBhZnRlciBzdWNjZXNzZnVsIHBvc3RpbmcgY2hhbmdlcy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZCA9IG1pVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9BZGQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJGFkZCBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QXJyYXkgPSB0YXJnZXREb2Nba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0YXJnZXRBcnJheSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSB0YXJnZXRBcnJheS5zbGljZSgpOyAvLyBPbiBKUyBzaWRlLCB3ZSBtdXN0IGJlIGltbXV0YWJsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB0YXJnZXRBcnJheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVzVG9BZGRfMSA9IHZhbHVlc1RvQWRkOyBfaSA8IHZhbHVlc1RvQWRkXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNUb0FkZF8xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldEFycmF5LmluY2x1ZGVzKHYpKSB7IC8vIGF2b2lkIGR1cHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkucHVzaCh2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMSA9IG1pVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9SZW1vdmVfMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBcnJheSA9IHRhcmdldERvY1trZXldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzEuaW5jbHVkZXModCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBtZXRhSW5zdHJ1Y3Rpb25zXzEgPSBtZXRhSW5zdHJ1Y3Rpb25zOyBfYSA8IG1ldGFJbnN0cnVjdGlvbnNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzEobWkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB2YWw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0RG9jO1xyXG59XHJcbi8vIHtuYW1lOiBcIlVsbGFcIn0sIHtuYW1lOiB7JHVuc2V0OjB9XHJcbi8vIHt0YWdzOiB7JGFkZDogXCJoZWpcIn19LCB7dGFnczogeyR1bnNldDowfVwifVxyXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VEZWx0YXMoZGVsdGExLCBkZWx0YTIsIF9hKSB7XHJcbiAgICB2YXIgcmVtb3ZlVW5zZXRQcm9wcyA9IChfYSA9PT0gdm9pZCAwID8geyByZW1vdmVVbnNldFByb3BzOiBmYWxzZSB9IDogX2EpLnJlbW92ZVVuc2V0UHJvcHM7XHJcbiAgICAvL3JldHVybiB7Li4uZGVsdGExLCAuLi5kZWx0YTJ9O1xyXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YTIpO1xyXG4gICAgdmFyIHRhcmdldERlbHRhID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZGVsdGExKTtcclxuICAgIGZvciAodmFyIF9pID0gMCwga2V5c18yID0ga2V5czsgX2kgPCBrZXlzXzIubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMltfaV07XHJcbiAgICAgICAgdmFyIHZhbCA9IGRlbHRhMltrZXldO1xyXG4gICAgICAgIGlmICh2YWwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xyXG4gICAgICAgICAgICBpZiAobWV0YUluc3RydWN0aW9ucy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChtaSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkdW5zZXRcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbW92ZVVuc2V0UHJvcHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0RGVsdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vIG1hdHRlciBpZiB0YXJnZXREZWx0YSBpcyBlbXB0eSBvciBoYXMgdmFsdWUuIFNldCBpdCB0byB7JHVuc2V0OjB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gbWFrZSBzdXJlIHRoZSB2ZXJ5IGVuZCByZXN1bHQgd2lsbCBoYXZlIHskdW5zZXQ6MH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0geyAkdW5zZXQ6IDAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZF8yID0gbWlWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb0FkZF8yKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRhZGQgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0RGVsdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB0YXJnZXRNZXRhUHJvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBqdXN0IGNoZWNrIGlmIHRhcmdldCBtZXRhUHJvcCBoYXMgeyRyZW1vdmU6IFsuLi5pdGVtc119XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JGFkZDogWy4uLl19IGFycmF5cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRSZW1vdmVBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRSZW1vdmVBcnJheSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9BZGRfMi5pbmNsdWRlcyh0KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFQcm9wLiRyZW1vdmUubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRyZW1vdmUgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRyZW1vdmUgcHJvcC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93IGl0J3MgdGltZSB0byBtZXJnZSBvciBjcmVhdGUgdGFyZ2V0ICRhZGQgYXJyYXkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kYWRkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRBZGRBcnJheSA/IHRhcmdldEFkZEFycmF5LmNvbmNhdCh2YWx1ZXNUb0FkZF8yKSA6IHZhbHVlc1RvQWRkXzIuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRhZGQgPSB0YXJnZXRBZGRBcnJheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb1JlbW92ZV8yID0gbWlWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8yKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0RGVsdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB0YXJnZXRNZXRhUHJvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBqdXN0IGNoZWNrIGlmIHRhcmdldCBtZXRhUHJvcCBoYXMgeyRhZGQ6IFsuLi5pdGVtc119XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JHJlbW92ZTogWy4uLl19IGFycmF5cy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBZGRBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRyZW1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRBZGRBcnJheSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QWRkQXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9SZW1vdmVfMi5pbmNsdWRlcyh0KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFQcm9wLiRhZGQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRhZGQgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRhZGQgcHJvcC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldE1ldGFQcm9wLiRhZGQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm93IGl0J3MgdGltZSB0byBtZXJnZSBvciBjcmVhdGUgdGFyZ2V0ICRyZW1vdmUgYXJyYXkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRSZW1vdmVBcnJheSA/IHRhcmdldFJlbW92ZUFycmF5LmNvbmNhdCh2YWx1ZXNUb1JlbW92ZV8yKSA6IHZhbHVlc1RvUmVtb3ZlXzIuc2xpY2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wLiRyZW1vdmUgPSB0YXJnZXRSZW1vdmVBcnJheTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgbWV0YUluc3RydWN0aW9uc18yID0gbWV0YUluc3RydWN0aW9uczsgX2IgPCBtZXRhSW5zdHJ1Y3Rpb25zXzIubGVuZ3RoOyBfYisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pID0gbWV0YUluc3RydWN0aW9uc18yW19iXTtcclxuICAgICAgICAgICAgICAgICAgICBfbG9vcF8yKG1pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldERlbHRhW2tleV0gPSB2YWw7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGFyZ2V0RGVsdGE7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtbWVyZ2UuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLWNvbGxlY3Rpb24nO1xyXG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xyXG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtcmVwbyc7XHJcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1zdWJzY3JpcHRpb24nO1xyXG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcclxuZXhwb3J0ICogZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XHJcbmV4cG9ydCAqIGZyb20gJy4vcXVlcnktc2V0JztcclxuZXhwb3J0ICogZnJvbSAnLi4vb2JzZXJ2YWJsZS9taXhpbic7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9IGZyb20gXCIuL2tlZGJhY2tlbmQtc3Vic2NyaXB0aW9uXCI7XHJcbmltcG9ydCB7IENhY2hlQnVzdCB9IGZyb20gJy4vY2FjaGUtYnVzdCc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9IGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XHJcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tICcuLi9vYnNlcnZhYmxlL2NvbGxlY3Rpb24nO1xyXG4vKipcclxuICogUmVwcmVzZW50cyBhIFwibGl2ZVwiIHF1ZXJ5IGFnYWluc3QgYSB0YWJsZSBvciBmaWx0ZXJlZCB0YWJsZS5cclxuICovXHJcbnZhciBLZWRCYWNrZW5kQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDb2xsZWN0aW9uLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENvbGxlY3Rpb24ocmVwbywgdGFibGUsIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgS2VkQmFja2VuZFN1YnNjcmlwdGlvbihvYnNlcnZlciwgX3RoaXMpO1xyXG4gICAgICAgICAgICBfdGhpcy5yZXBvLnF1ZXJ5U2V0LnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xyXG4gICAgICAgIH0pIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMucmVwbyA9IHJlcG87XHJcbiAgICAgICAgX3RoaXMudGFibGUgPSB0YWJsZTtcclxuICAgICAgICBfdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwicXVlcnlLZXlcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5KHRoaXMudGFibGUsIHRoaXMucXVlcnkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZSwgXCJpbmNsdWRlc1wiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmNsdWRlcyB8fCAodGhpcy5faW5jbHVkZXMgPSBbXS5jb25jYXQodGhpcy5xdWVyeS5pbmNsdWRlIHx8IFtdKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYXBwbHlRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgS2VkQmFja2VuZENvbGxlY3Rpb24odGhpcy5yZXBvLCB0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5LCBxdWVyeSkpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRUb1F1ZXJ5QXJyYXlQcm9wID0gZnVuY3Rpb24gKGFycmF5UHJvcCwgZW50cmllcykge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KChfYSA9IHt9LCBfYVthcnJheVByb3BdID0gKHRoaXMucXVlcnlbYXJyYXlQcm9wXSB8fCBbXSkuY29uY2F0KGVudHJpZXMpLCBfYSkpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRGbGFncyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmxhZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBmbGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiZmxhZ3NcIiwgZmxhZ3MpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgZGVidWc6IHRydWUgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkc09ubHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpZHNPbmx5XCIpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpZHNBbmROYW1lc09ubHlcIik7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaW5jbHVkZUlkc09ubHlcIik7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGVJZHNBbmROYW1lc09ubHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpbmNsdWRlSWRzQW5kTmFtZXNPbmx5XCIpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5iZXR3ZWVuID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGZyb206IGZyb20sIHRvOiB0byB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucm9sZSA9IGZ1bmN0aW9uIChyb2xlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IHJvbGU6IHJvbGUgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzRnJvbSA9IGZ1bmN0aW9uIChpZHMsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCB8fCBpZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICFpZDsgfSkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzRnJvbShcIiArIEpTT04uc3RyaW5naWZ5KGlkcykgKyBcIilcIik7XHJcbiAgICAgICAgdmFyIGhlZiA9IHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImhhc0VkZ2VzRnJvbVwiLCBpZHMpO1xyXG4gICAgICAgIHJldHVybiBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZURlbHRhRWRnZXMgP1xyXG4gICAgICAgICAgICBoZWYuYWRkRmxhZ3MoXCJpbmNsdWRlRGVsdGFFZGdlc1wiKSA6XHJcbiAgICAgICAgICAgIGhlZjtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaGFzRWRnZXNUbyA9IGZ1bmN0aW9uIChpZHMsIG9wdGlvbnMpIHtcclxuICAgICAgICBpZiAoaWRzLmxlbmd0aCA9PT0gMCB8fCBpZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICFpZDsgfSkpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzVG8oXCIgKyBKU09OLnN0cmluZ2lmeShpZHMpICsgXCIpXCIpO1xyXG4gICAgICAgIHZhciBoZXQgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc1RvXCIsIGlkcyk7XHJcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlRGVsdGFFZGdlcyA/XHJcbiAgICAgICAgICAgIGhldC5hZGRGbGFncyhcImluY2x1ZGVEZWx0YUVkZ2VzXCIpIDpcclxuICAgICAgICAgICAgaGV0O1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGlkczogW2lkXSB9KS5zaW5nbGUoe1xyXG4gICAgICAgICAgICBvblplcm86IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGZpbmQgZW50aXR5IGluIFwiICsgX3RoaXMudGFibGUgKyBcIiB3aXRoIGlkIFwiICsgaWQpOyB9LFxyXG4gICAgICAgICAgICBvbk1hbnk6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgZW50cmllcyBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzID0gZnVuY3Rpb24gKGlkcykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IGlkcyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IG5hbWU6IG5hbWUgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRhZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyB0YWdzOiB0YWdzIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5icmFuY2hJZCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmluY2x1ZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGdyYXBocyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGdyYXBoc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaW5jbHVkZVwiLCBncmFwaHMpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5jYWNoZU9wdGltaXplZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgY2FjaGVCdXN0OiBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMucmVwby5nZXRVc2VyKCksIHRoaXMuaW5jbHVkZXMpIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5tdXRhdGlvbnNPbkVtcHR5ID0gZnVuY3Rpb24gKG11dGF0aW9uRmFjdG9yeSkge1xyXG4gICAgICAgIHZhciB0eCA9IG5ldyBCYXRjaFJ1bm5lcigpO1xyXG4gICAgICAgIG11dGF0aW9uRmFjdG9yeSh0eCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IG11dGF0aW9uc09uRW1wdHk6IHR4Lm11dGF0aW9uUmVxdWVzdHMgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnNpbmdsZSA9IGZ1bmN0aW9uICh0aHJvd2Vycykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIF9hID0gdGhyb3dlcnMgfHwge30sIG9uWmVybyA9IF9hLm9uWmVybywgb25NYW55ID0gX2Eub25NYW55O1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVmFsdWUoKS5tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChvblplcm8pXHJcbiAgICAgICAgICAgICAgICAgICAgb25aZXJvKCk7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICBpZiAob25NYW55KVxyXG4gICAgICAgICAgICAgICAgICAgIG9uTWFueSgpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IFwiICsgaXRlbXMubGVuZ3RoICsgXCIgd2FzIGZvdW5kLlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbMF07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLypjb21iaW5lTGF0ZXN0PFRPdGhlcj4ob3RoZXI6IFF1ZXJ5T2JzZXJ2YWJsZTxUT3RoZXI+KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlcih4ID0+IHgpLmNvbWJpbmVMYXRlc3Qob3RoZXIpO1xyXG4gICAgfSovXHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGRvYywgY2hhbmdlcywgZGVib3VuY2UpIHtcclxuICAgICAgICBpZiAoZGVib3VuY2UgPT09IHZvaWQgMCkgeyBkZWJvdW5jZSA9IDEwMDA7IH1cclxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShbe1xyXG4gICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxyXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGlkOiBkb2MuaWQsXHJcbiAgICAgICAgICAgICAgICBkZWx0YURvYzogY2hhbmdlcyxcclxuICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IGRvYy5uYW1lXHJcbiAgICAgICAgICAgIH1dLCBkZWJvdW5jZSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkRG9jKSB7XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAnYWRkLXJlbGF0ZWQnLFxyXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoUHJvcDogbGFiZWwsXHJcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXHJcbiAgICAgICAgICAgIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUucmVtb3ZlUmVsYXRlZCA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWREb2MpIHtcclxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShbe1xyXG4gICAgICAgICAgICAgICAgb3A6ICdyZW1vdmUtcmVsYXRlZCcsXHJcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcclxuICAgICAgICAgICAgICAgIHJlbGF0ZWREb2M6IHJlbGF0ZWREb2NcclxuICAgICAgICAgICAgfV0sIDApO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS51bmRvTGluayA9IGZ1bmN0aW9uIChpZCwgbGFiZWwsIHJlbGF0ZWRJZCkge1xyXG4gICAgICAgIGlmICghdGhpcy5xdWVyeS5icmFuY2hJZClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidW5kbyBsaW5rcyBjYW4gb25seSBiZSBwZXJmb3JtZWQgb24gYnJhbmNoZXNcIik7XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAndW5kby1saW5rJyxcclxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICBncmFwaFByb3A6IGxhYmVsLFxyXG4gICAgICAgICAgICAgICAgcmVsYXRlZElkOiByZWxhdGVkSWRcclxuICAgICAgICAgICAgfV0sIDApO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgaWRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKGlkcy5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAoe1xyXG4gICAgICAgICAgICBvcDogJ2RlbGV0ZScsXHJcbiAgICAgICAgICAgIHRhYmxlOiBfdGhpcy50YWJsZSxcclxuICAgICAgICAgICAgaWQ6IGlkXHJcbiAgICAgICAgfSk7IH0pLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5yZXBvLnF1ZXJ5U2V0LnVuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDb2xsZWN0aW9uO1xyXG59KENvbGxlY3Rpb24pKTtcclxuZXhwb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfTtcclxuLyptaXhpbihcclxuICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsXHJcbiAgTWFwcGVkQ29sbGVjdGlvbi5wcm90b3R5cGUsXHJcbiAgXCJtYXBcIiwgXCJmbGF0XCIsIFwiY29uY2F0XCIsIFwicmVuZGVyXCIsIFwibG9hZFwiKTsqL1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgdXBkYXRlQXJyYXkgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQvdXRpbHMnO1xyXG5pbXBvcnQgeyBicmFuY2hTZW5zaXRpdmUsIGdldFRhYmxlRnJvbUxhYmVsIH0gZnJvbSAnLi91dGlscyc7XHJcbmltcG9ydCB7IGFwcGx5RGVsdGEgfSBmcm9tICcuL2RlbHRhLW1lcmdlJztcclxudmFyIEtlZEJhY2tlbmRRdWVyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRRdWVyeSh0YWJsZSwgcXVlcnksIHVzZXIsIHJlcG8sIG11dGF0aW9uUXVldWUpIHtcclxuICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7XHJcbiAgICAgICAgdGhpcy5xdWVyeSA9IHF1ZXJ5O1xyXG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XHJcbiAgICAgICAgdGhpcy5yZXBvID0gcmVwbztcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5pbnZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5sb2FkZWRWZXJzaW9uID0gMDtcclxuICAgICAgICB0aGlzLl9sb2FkUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pbmNsdWRlcyA9IHF1ZXJ5LmluY2x1ZGUgP1xyXG4gICAgICAgICAgICB0eXBlb2YgcXVlcnkuaW5jbHVkZSA9PT0gJ3N0cmluZycgP1xyXG4gICAgICAgICAgICAgICAgW3F1ZXJ5LmluY2x1ZGVdIDpcclxuICAgICAgICAgICAgICAgIHF1ZXJ5LmluY2x1ZGUgOlxyXG4gICAgICAgICAgICBbXTtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRRdWVyeS5xdWVyeUtleSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25zT25FbXB0eSA9IHF1ZXJ5Lm11dGF0aW9uc09uRW1wdHksIGNvbXBhcmFibGVQcm9wcyA9IHRzbGliXzEuX19yZXN0KHF1ZXJ5LCBbXCJtdXRhdGlvbnNPbkVtcHR5XCJdKTtcclxuICAgICAgICByZXR1cm4gdGFibGUgKyBKU09OLnN0cmluZ2lmeShjb21wYXJhYmxlUHJvcHMpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLCBcInF1ZXJ5S2V5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtlZEJhY2tlbmRRdWVyeS5xdWVyeUtleSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSwgZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLmdvdEluaXRpYWxSZXNwb25zZSAmJiAhdGhpcy5pbnZhbGlkKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCksIHRydWUsIHRoaXMuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLnF1ZXJ5TG9jYWxseSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLm5vdGlmeVN1YnNjcmliZXIoZGF0YSwgdGhpcy5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2FkKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBsb2FkUHJvbWlzZTtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nb3RJbml0aWFsUmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG11dGF0aW9uc09uRW1wdHkgc2hvdWxkIG5ldmVyIGJlIHVzZWQgdHdpY2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5xdWVyeS5tdXRhdGlvbnNPbkVtcHR5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCF2ZXJzaW9uICYmIHRoaXMuX2xvYWRQcm9taXNlKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX2xvYWRQcm9taXNlXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvYWRpbmcgaXMgb25nb2luZywgYW5kIGNhbGxlciBkb2VzIG5vdCByZXF1aXJlIGEgcmVjZW50IHJlZnJlc2guXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgdGhlIG9uZ29pbmcgbG9hZCB0byBjb21wbGV0ZVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgdGhpcy5yZXBvLndyaXRlci5wZXJzaXN0ZWRWZXJzaW9uLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkUHJvbWlzZSA9IHRoaXMuX2xvYWRQcm9taXNlID0gdGhpcy5fbG9hZCh2ZXJzaW9uKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmxvYWRlZFZlcnNpb24gPSBNYXRoLm1heChfdGhpcy5sb2FkZWRWZXJzaW9uLCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vb25lIGhhcyByZWZyZXNoZWQgb3VyIGxvYWQuIFRoZSBlcnJvciBpcyB0aGUgZmluYWwgcmVzdWx0LiBTZXQgaXQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vb25lIGhhcyByZWZyZXNoZWQgb3VyIGxvYWQuIFdlJ3JlIGZpbmlzaGVkLiBEYXRhIG9yIGVycm9yIGlzIGFscmVhZHkgc2V0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgZ290SW5pdGlhbFJlc3BvbnNlIHRvIHRydWUgYW5kIG5vdGlmeSBzdWJzY3JpYmVycy5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmdvdEluaXRpYWxSZXNwb25zZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubm90aWZ5U3Vic2NyaWJlcnMoX3RoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBIG1vcmUgcmVjZW50IGNhbGwgdG8gbG9hZCgpIGlzIG9uZ29pbmcsIE9SIHdhcyBvbmdvaW5nIGJ1dCByZXNwb25kZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWZvcmUgdXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gYW55IGNhc2UgcmV0dXJuIHRoaXMuX2xvYWRQcm9taXNlLiBJZiBpdCdzIG9uZ29pbmcgd2UnbGwgd2FpdCBmb3IgaXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBmaW5pc2guIElmIGl0J3MgbnVsbCwgd2UnbGwgYmUgcmV0dXJuaW5nIGZpbmFsbHkgaGVyZSB3aXRob3V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW55IGFjdGlvbiwgYmVjYXVzZSB0aGUgYWN0aW9uIHdhcyB0YWtlbiBieSB0aGUgcmVmcmVzaGVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5fbG9hZFByb21pc2U7IC8vIFdhaXQgZm9yIHRoZSByZWZyZXNoZWQgbG9hZCB0byBjb21wbGV0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgbG9hZFByb21pc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuX2xvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5tdXRhdGlvblF1ZXVlLmFmZmVjdHNRdWVyeSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBvdXRnb2luZyBtdXRhdGlvbnMgdGhhdCBhZmZlY3RzIHRoaXMgcXVlcnkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gd2FpdCB0aWxsIHRoZXkgcmVhY2ggc2VydmVyIGFuZCBzZXJ2ZXIgcmVzcG9uZHMgd2l0aCBPSyBiZWZvcmUgcXVlcnlpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlci4gT3RoZXJ3aXNlLCB3ZSBtYXkgZ2V0IGluYWNjdXJhdGUgZGF0YSBmcm9tIHNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLndyaXRlci53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIuIE90aGVyd2lzZSwgd2UgbWF5IGdldCBpbmFjY3VyYXRlIGRhdGEgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5xdWVyeVNlcnZlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IHN1YnNjcmlwdGlvbjsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5jb21taXRNdXRhdGlvbnMgPSBmdW5jdGlvbiAobXV0YXRpb25zLCB2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfaSwgbXV0YXRpb25zXzEsIG0sIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IG11dGF0aW9uc18xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtID0gbXV0YXRpb25zXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAnY2xlYXItYnJhbmNoJyAmJiAobS5icmFuY2hJZCA9PT0gdGhpcy5xdWVyeS5icmFuY2hJZCkpKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobS5vcCA9PT0gJ21lcmdlJyAmJiAoIW0udGFyZ2V0QnJhbmNoSWQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0udGFyZ2V0QnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaE9ySW52YWxpZGF0ZSh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICd1cGRhdGUnICYmICgobS5kZWx0YURvYy50YWdzICYmIHRoaXMucXVlcnkudGFncykgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChtLmRlbHRhRG9jLm5hbWUgJiYgdGhpcy5xdWVyeS5uYW1lKSkpKSByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBxdWVyeSBtdXN0IGJlIHJlZnJlc2hlZCBmcm9tIHNlcnZlciBhcyB3ZSBjYW5ub3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBxdWVyeSBpcyBkZXBlbmRlbnQgb24gdGhlIHNhbWUgcHJvcGVydHkuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBxdWVyeSBtdXN0IGJlIHJlZnJlc2hlZCBmcm9tIHNlcnZlciBhcyB3ZSBjYW5ub3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKG11dGF0aW9ucywgZmFsc2UsIHRoaXMuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gOTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5yZWZyZXNoT3JJbnZhbGlkYXRlID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnN1YnNjcmlwdGlvbnMubGVuZ3RoID09PSAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5sb2FkKHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXJzID0gZnVuY3Rpb24gKG9wdGltaXN0aWNNdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmRhdGEgJiYgdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGFfMSA9IHRoaXMuZ2V0RGF0YVdpdGhNdXRhdGlvbnNBcHBsaWVkKG9wdGltaXN0aWNNdXRhdGlvbnMsIHRydWUsIHRoaXMuZGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XHJcbiAgICAgICAgICAgICAgICBzLm5vdGlmeVN1YnNjcmliZXIoZGF0YV8xLCBfdGhpcy5lcnJvcik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnF1ZXJ5TG9jYWxseSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXBvLnF1ZXJ5U2V0LnF1ZXJ5TG9jYWxseSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnF1ZXJ5U2VydmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlcG8uZ2V0Q2xpZW50KCkubGlzdCh0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5KSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGRhdGFdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIG9wdGltaXN0aWMsIGRhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtdXRhdGlvbikge1xyXG4gICAgICAgICAgICBkYXRhID0gX3RoaXMuYXBwbHlNdXRhdGlvbnNPbkRhdGEoZGF0YSwgbXV0YXRpb24sIG9wdGltaXN0aWMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuYXBwbHlNdXRhdGlvbnNPbkRhdGEgPSBmdW5jdGlvbiAoZGF0YSwgbSwgb3B0aW1pc3RpYykge1xyXG4gICAgICAgIGlmIChicmFuY2hTZW5zaXRpdmUobSkgJiYgbS5icmFuY2hJZCAhPSB0aGlzLnF1ZXJ5LmJyYW5jaElkKVxyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB2YXIgX2EgPSB0aGlzLCB0YWJsZSA9IF9hLnRhYmxlLCBpbmNsdWRlcyA9IF9hLmluY2x1ZGVzLCBsaXN0T3B0aW9ucyA9IF9hLnF1ZXJ5O1xyXG4gICAgICAgIHZhciBzb3VyY2VJZHMgPSBsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20gPyBbXS5jb25jYXQobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tIHx8IFtdKSA6IFtdO1xyXG4gICAgICAgIHZhciByZXF1ZXN0ZWRUYWdzID0gbGlzdE9wdGlvbnMudGFncyA/IFtdLmNvbmNhdChsaXN0T3B0aW9ucy50YWdzIHx8IFtdKSA6IFtdO1xyXG4gICAgICAgIHN3aXRjaCAobS5vcCkge1xyXG4gICAgICAgICAgICBjYXNlICd1cGRhdGUnOiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgPT09IG0uaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgZGVsdGEgb24gdXBkYXRlZCBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZERvYyA9IGFwcGx5RGVsdGEoZG9jLCBtLmRlbHRhRG9jKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkRG9jLiRtZXRhID0gJ3VwZGF0aW5nJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWREb2M7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGlkIGRvZXMgbm90IGFwcGx5IHRvIHRoaXMgZG9jLCBzZWFyY2ggaW4gZ3JhcGhzIHRoZSBpZCBpcyBmb3VuZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFtb25nIGdyYXBoIGluY2x1ZGVkIGRvY3MsIGFuZCBpZiBzbywgdXBkYXRlIHRoYXQgb25lOlxyXG4gICAgICAgICAgICAgICAgICAgIGluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkRG9jcyA9IGRvY1tsYWJlbF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmNsdWRlZERvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkQXJyYXkgPSB1cGRhdGVBcnJheShpbmNsdWRlZERvY3MsIGZ1bmN0aW9uIChyZWxhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWQuaWQgIT09IG0uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWxhdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkUmVsYXRlZCA9IGFwcGx5RGVsdGEocmVsYXRlZCwgbS5kZWx0YURvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRSZWxhdGVkLiRtZXRhID0gJ3VwZGF0aW5nJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlZFJlbGF0ZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVkQXJyYXkgIT09IGluY2x1ZGVkRG9jcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW2xhYmVsXSA9IHVwZGF0ZWRBcnJheSwgX2EpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlICdhZGQtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgZXhwcmVzc2lvbiBpcyBgZGIuY291cnNlQmxvY2tzLi4uLndoYXRldmVyLi4gLmluY2x1ZGUoXCJhYmlsaXRpZXNcIilgLCBkZXRlY3Q6IGRiLmNvdXJzZUJsb2Nrcy5hZGRSZWxhdGVkKGJsb2NrSWQsICdhYmlsaXRpZXMnLCAuLi4pXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gLi4uYmVjYXVzZSB0YWJsZSA9ICdjb3Vyc2VCbG9ja3MnIGFuZCBpbmNsdWRlcyBoYXMgXCJhYmlsaXRpZXNcIi5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgIT09IG0uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYXRlZERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0ucmVsYXRlZERvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZERvYy4kbWV0YSA9ICdhZGRpbmcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbS5ncmFwaFByb3BdID0gZG9jW20uZ3JhcGhQcm9wXS5jb25jYXQoW3JlbGF0ZWREb2NdKSwgX2EpKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlSWRzLmluY2x1ZGVzKG0uaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgYGRiLmNvdXJzZUJsb2Nrcy5oYXNFZGdlc0Zyb20oW2NvdXJzZUlkXSlgICAobWVhbmluZyB0YWJsZT0nY291cnNlQmxvY2tzJyBhbmQgc291cmNlSWRzIGluY2x1ZGVzIGNvdXJzZUlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAsIGRldGVjdDogZGIuY291cnNlSW5zdGFuY2VzLmFkZFJlbGF0ZWQoY291cnNlSWQsICdjb3Vyc2VCbG9ja3MnLCAuLi4uKSAvLyBtLmdyYXBoUHJvcCA9PT0gJ2Jsb2NrcyctLT4gZ2V0VGFibGVGcm9tTGFiZWwgLS0+ICdjb3Vyc2VCbG9ja3MnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gZ2V0VGFibGVGcm9tTGFiZWwobS50YWJsZSwgbS5ncmFwaFByb3ApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxpc3RPcHRpb25zLnRhZ3MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtLnJlbGF0ZWREb2MudGFncyAmJiByZXF1ZXN0ZWRUYWdzLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4gbS5yZWxhdGVkRG9jLnRhZ3MuaW5jbHVkZXModGFnKTsgfSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmlkcyAmJiBsaXN0T3B0aW9ucy5pZHMuc29tZShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIGlkID09PSBtLnJlbGF0ZWREb2MuaWQ7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQSBjZXJ0YWluIElEIGlzIG9ic2VydmVkLiBBIGRvYyB3aXRoIHRoaXMgaWQgaXMgYmVpbmcgYWRkZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBkb2MgdG8gdGhlIHJlc3VsdC4gRXhhY3RseSB0aGlzIFdJTEwgaGFwcGVuIGluIHRoZSBmb2xsb3dpbmcgdHlwaWNhbCBzY2VuYXJpbzpcclxuICAgICAgICAgICAgICAgICAgICAvLyAxLiBVc2VyIGFkZHMgYSByZWxhdGVkIGRvY3VtZW50IHRvIGEgbGlzdC5cclxuICAgICAgICAgICAgICAgICAgICAvLyAyLiBEb2N1bWVudCByZW1haW5zIHdpdGhpbiB0aGUgTXV0YXRpb25RdWV1ZSB3aGlsZSBiYXRjaC1yZXF1ZXN0IGlzIGJlaW5nIHByb2Nlc3NlZCBieSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gVXNlciBjbGlja3MgdGhlIGFkZGVkIGl0ZW0gdG8gZWRpdCBvciB2aWV3IGl0IChvciBvdXIgY29tcG9uZW50IHJlZGlyZWN0cyB0byBpdHMgZWRpdG9yKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIDQuIEEgbmV3IHF1ZXJ5IG9mIHRoYXQgcGFydGljdWxhciBJRCBpcyBzdWJzY3JpYmVkIHRvIHtpZHM9W3RoZUlkXX1cclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBLZWRCYWNrZW5kUXVlcnkuc3Vic2NyaWJlIHRoZW4gZG9lcyB0aGlzOlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMS4gQ2FsbCBxdWVyeUxvY2FsbHkoKSBiZWZvcmUgcXVlcnlpbmcgc2VydmVyXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAyLiBxdWVyeUxvY2FsbHkoKSBpbnNwZWN0cyBtdXRhdGlvbnMgYW5kIGZpbmRzIGEgbWF0Y2gsIHJldHVybmluZyBhbiBlbXB0eSBsaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAoYXNzdW1lcyBhcyB3ZSBhcmUgYWRkaW5nIGl0LCBpdCBjYW4ndCBleGlzdCBvbiB0aGUgc2VydmVyIGFueXdheSlcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDMuIEtlZEJhY2tlbmRRVWVyeSBhcHBsaWVzIG11dGF0aW9ucyBvbnRvIHRoZSBlbXB0eSBsaXN0LCBhbmQgZW5kcyB1cCBoZXJlIHRvIGFkZFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgaXQgb3B0aW1pc3RpY2FsbHkuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICA0LiBXaGVuIHNlcnZlciByZXNwb25kcyB3aXRoIDIwMCBPSywgY2FsbHMgdXMgaGVyZSBhZ2FpbiB3aXRoIG9wdGltaXN0aWM9ZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRvIFwicGVyc2lzdFwiIGl0IGluIHRoZSBxdWVyeSdzIGRhdGEgYXJyYXkuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICA0QjogSWYgbm90IDIwMCBPSywgbXV0YXRpb24gbWF5IGJlIGdvbmUgYW5kIHRoZSBzdWJzY3JpYmVyIHdpbGwgc2UgYW4gZXJyb3IgcGFnZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgXCJDb3VsZCBub3QgZmluZCBlbnRpdHkgd2l0aCBpZCBYLlwiIGFsb25nIHdpdGggYSByZWQgZXJyb3IgbWVzc2FnZSBvbiB0aGUgc2NyZWVuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBhYm91dCB0aGF0IGl0IGZhaWxlZCB0byBzYXZlIG9uIHNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5jb25jYXQodGhpcy5zZXRHcmFwaFByb3BzKG0ucmVsYXRlZERvYykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcclxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSAmJiBpbmNsdWRlcy5pbmRleE9mKG0uZ3JhcGhQcm9wKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZERvY3MgPSBkb2NbbS5ncmFwaFByb3BdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluY2x1ZGVkRG9jcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgIT09IG0uaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbS5ncmFwaFByb3BdID0gb3B0aW1pc3RpYyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSB3aXRoICRtZXRhOiAnZGVsZXRpbmcnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZERvY3MubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLnJlbGF0ZWREb2MuaWQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgOiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pOyB9KSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgcmVsYXRlZC1kb2MtdG8tcmVtb3ZlIGZyb20gZG9jW2dyYXBQcm9wXTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGVkRG9jcy5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZERvYy5pZDsgfSksIF9hKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUlkcy5pbmNsdWRlcyhtLmlkKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGltaXN0aWMgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0ucmVsYXRlZERvYy5pZCA/IHRzbGliXzEuX19hc3NpZ24oe30sIGQsIHsgJG1ldGE6ICdkZWxldGluZycgfSkgOiBkOyB9KSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkOyB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLmlkOyB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGxpc3RPcHRpb25zLmluY2x1ZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWRUYWJsZXMgPSBpbmNsdWRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gKHsgbGFiZWw6IGxhYmVsLCB0YWJsZTogZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB9KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsc18xID0gaW5jbHVkZWRUYWJsZXMuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBfYS50YWJsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09PSBtLnRhYmxlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYWJlbHNfMS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHNfMS5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IF9hLmxhYmVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYXRlZERvY3MgPSBkb2NbbGFiZWxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkRG9jcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYiA9IHt9LCBfYltsYWJlbF0gPSBvcHRpbWlzdGljID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2NzLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCA9PT0gbS5pZCA/IHRzbGliXzEuX19hc3NpZ24oe30sIGQsIHsgJG1ldGE6ICdkZWxldGluZycgfSkgOiBkOyB9KSA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX2EuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlkICE9PSBtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIF9iKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnNldEdyYXBoUHJvcHMgPSBmdW5jdGlvbiAoZG9jKSB7XHJcbiAgICAgICAgdmFyIGNvcHkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xyXG4gICAgICAgIHRoaXMuaW5jbHVkZXMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGNvcHlbbGFiZWxdID0gY29weVtsYWJlbF0gfHwgW107IH0pO1xyXG4gICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnk7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLXF1ZXJ5LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcclxuaW1wb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfSBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XHJcbmltcG9ydCB7IFF1ZXJ5U2V0IH0gZnJvbSAnLi9xdWVyeS1zZXQnO1xyXG5pbXBvcnQgeyBNdXRhdGlvblF1ZXVlIH0gZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcclxuaW1wb3J0IHsgRGVsdGFDb2xsZWN0aW9uIH0gZnJvbSAnLi9kZWx0YS1jb2xsZWN0aW9uL2RlbHRhLWNvbGxlY3Rpb24nO1xyXG52YXIgS2VkQmFja2VuZFJlcG8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUmVwbyhnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucywgbXV0YXRpb25RdWV1ZSwgcXVlcnlTZXQsIHdyaXRlciwgY2FjaGVPcHRpbWl6ZWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlciA9IGdldFVzZXI7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUgPSBnZXRVc2VyRGlzcGxheU5hbWU7XHJcbiAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zID0gZGVmYXVsdFF1ZXJ5T3B0aW9ucztcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgICAgIHRoaXMucXVlcnlTZXQgPSBxdWVyeVNldDtcclxuICAgICAgICB0aGlzLndyaXRlciA9IHdyaXRlcjtcclxuICAgICAgICB0aGlzLmNhY2hlT3B0aW1pemVkID0gY2FjaGVPcHRpbWl6ZWQ7XHJcbiAgICAgICAgaWYgKCFkZWZhdWx0UXVlcnlPcHRpb25zKVxyXG4gICAgICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMgPSB7fTtcclxuICAgICAgICBpZiAoIW11dGF0aW9uUXVldWUpXHJcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IG5ldyBNdXRhdGlvblF1ZXVlKCk7XHJcbiAgICAgICAgaWYgKCFxdWVyeVNldClcclxuICAgICAgICAgICAgdGhpcy5xdWVyeVNldCA9IG5ldyBRdWVyeVNldCh0aGlzLm11dGF0aW9uUXVldWUpO1xyXG4gICAgICAgIGlmICghd3JpdGVyKVxyXG4gICAgICAgICAgICB0aGlzLndyaXRlciA9IG5ldyBLZWRCYWNrZW5kV3JpdGVyKHRoaXMubXV0YXRpb25RdWV1ZSwgdGhpcy5xdWVyeVNldCwgZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUpO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHRhYmxlcykuZm9yRWFjaChmdW5jdGlvbiAodGFibGUpIHtcclxuICAgICAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSBuZXcgS2VkQmFja2VuZENvbGxlY3Rpb24oX3RoaXMsIHRhYmxlLCBkZWZhdWx0UXVlcnlPcHRpb25zIHx8IHt9KTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlT3B0aW1pemVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF90aGlzW3RhYmxlXSA9IGNvbGxlY3Rpb247XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5kZWx0YXMgPSBuZXcgRGVsdGFDb2xsZWN0aW9uKHRoaXMud3JpdGVyLmRlbHRhQ2FjaGUsIHtcclxuICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZCAvLyBJZiBicmFuY2hJZCBpcyB1bmRlZmluZWQuIERlbHRhQ29sbGVjdGlvbiB3aWxsIHJlc3BvbmQgd2l0aCBFcnJvciBvbiBzdWJzY3JpYmUoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnRhYmxlID0gZnVuY3Rpb24gKHRhYmxlTmFtZSkge1xyXG4gICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKHRoaXMsIHRhYmxlTmFtZSwgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zKTtcclxuICAgICAgICBpZiAodGhpcy5jYWNoZU9wdGltaXplZClcclxuICAgICAgICAgICAgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb24uY2FjaGVPcHRpbWl6ZWQoKTtcclxuICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuX2Nsb25lID0gZnVuY3Rpb24gKHF1ZXJ5T3B0aW9ucywgY2FjaGVPcHRpbWl6ZWQpIHtcclxuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgS2VkQmFja2VuZFJlcG8odGhpcy5nZXRDbGllbnQsIHRoaXMuZ2V0VXNlciwgdGhpcy5nZXRVc2VyRGlzcGxheU5hbWUsIHRzbGliXzEuX19hc3NpZ24oe30sIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucywgcXVlcnlPcHRpb25zKSwgdGhpcy5tdXRhdGlvblF1ZXVlLCB0aGlzLnF1ZXJ5U2V0LCB0aGlzLndyaXRlciwgY2FjaGVPcHRpbWl6ZWQgPT09IHVuZGVmaW5lZCA/IHRoaXMuY2FjaGVPcHRpbWl6ZWQgOiBjYWNoZU9wdGltaXplZCk7XHJcbiAgICAgICAgcmV0dXJuIGNsb25lO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5icmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7IHJvbGU6IHJvbGUgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLm9wdGltaXplQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHt9LCB0cnVlKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBjbGVhciBtYXN0ZXIgYnJhbmNoXCIpO1xyXG4gICAgICAgIHRoaXMud3JpdGVyLm11dGF0ZShbeyBvcDogJ2NsZWFyLWJyYW5jaCcsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQgfV0sIDApO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uICh0YXJnZXRCcmFuY2hJZCkge1xyXG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgbWVyZ2UgZnJvbSBtYXN0ZXIgYnJhbmNoXCIpO1xyXG4gICAgICAgIHRoaXMud3JpdGVyLm11dGF0ZShbeyBvcDogJ21lcmdlJywgYnJhbmNoSWQ6IHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQ6IHRhcmdldEJyYW5jaElkIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuc2F2ZU5vdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLndyaXRlci53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCh0aGlzLndyaXRlci5jdXJyZW50VmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kUmVwbztcclxufSgpKTtcclxuZXhwb3J0IHsgS2VkQmFja2VuZFJlcG8gfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1yZXBvLmpzLm1hcCIsInZhciBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFN1YnNjcmlwdGlvbihzdWJzY3JpYmVyLCBjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVyID0gc3Vic2NyaWJlcjtcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xyXG4gICAgfVxyXG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlciA9IGZ1bmN0aW9uIChkYXRhLCBlcnJvcikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvcilcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXJyb3IsIHRoaXMpO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhICE9PSB0aGlzLmxhc3ROb3RpZmllZERhdGEpIHsgLy8gV2lsbCBpbi1mYWN0IGJlIGVxdWFsIGJ5IHJlZmVyZW5jZSBpZiBkYXRhIGlzIHNhbWUgYXMgbGFzdCBub3RpZmljYXRpb24gKGFzIHdlIHVzZSBhbiBpbW11dGFibGUgYXBwcm9hY2ggb24gZGF0YSlcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdE5vdGlmaWVkRGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoZGF0YSwgZXJyb3IsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyKFtdLCBleCwgdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGV4Mikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHdoaWxlIG5vdGlmeWluZyBLZWRCYWNrZW5kU3Vic2NyaWJlcjpcIiwgZXgyLCAnb3JpZ2luYWxseSBub3RpZmllZCBlcnJvcjonLCBleCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFN1YnNjcmlwdGlvbi5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnVuc3Vic2NyaWJlKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uO1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtc3Vic2NyaXB0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcclxuaW1wb3J0IHsgQmF0Y2hSdW5uZXIgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xyXG5pbXBvcnQgeyB0YWJsZXMgfSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XHJcbmltcG9ydCB7IENhY2hlQnVzdCB9IGZyb20gJy4vY2FjaGUtYnVzdCc7XHJcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tICcuLi9vYnNlcnZhYmxlJztcclxuaW1wb3J0IHsgRGVsdGFDYWNoZSB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jYWNoZSc7XHJcbnZhciBLZWRCYWNrZW5kV3JpdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFdyaXRlcihtdXRhdGlvblF1ZXVlLCBxdWVyeVNldCwgZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgICAgIHRoaXMucXVlcnlTZXQgPSBxdWVyeVNldDtcclxuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcclxuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWZXJzaW9uID0gMDtcclxuICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24gPSBuZXcgRW1pdHRlcigwKTtcclxuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLmRlbHRhQ2FjaGUgPSBuZXcgRGVsdGFDYWNoZShnZXRDbGllbnQsIGdldFVzZXIsIGdldFVzZXJEaXNwbGF5TmFtZSk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUsIFwiaXNTYXZpbmdcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISF0aGlzLl9pc1NhdmluZ1Byb21pc2U7IH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzRWRpdGVkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwOyB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub25TdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycy5wdXNoKGNhbGxiYWNrKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSB0aGlzLmVycm9yU3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBjYWxsYmFjazsgfSk7XHJcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gdGhpcy5zdGF0ZVN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gY2FsbGJhY2s7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IsIHJldHJ5YWJsZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnJvciwgcmV0cnlhYmxlLCBfdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLmRpc3BhdGNoU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKF90aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoXykgeyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubXV0YXRlID0gZnVuY3Rpb24gKG11dGF0aW9ucywgZGVib3VuY2UpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUuYWRkKG11dGF0aW9ucyk7XHJcbiAgICAgICAgKyt0aGlzLmN1cnJlbnRWZXJzaW9uO1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xyXG4gICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgICAgICB0aGlzLmRlbHRhQ2FjaGUuYXBwbHlNdXRhdGlvbnModGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLCB7IG9wdGltaXN0aWM6IHRydWUgfSk7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9pc1NhdmluZ1Byb21pc2UpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZClcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SWQpO1xyXG4gICAgICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBzZXRUaW1lb3V0KHRoaXMuc2F2ZS5iaW5kKHRoaXMpLCBkZWJvdW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIGlzU2F2aW5nLCB3ZSBkb24ndCBuZWVkIHRvIGRvIGFueXRoaW5nLCBiZWNhc2UgaXQgd2lsbCByZS1jaGVjayBpZiBhZGRpdGlvbmFsXHJcbiAgICAgICAgLy8gbXV0YXRpb25zIGhhdmUgY29tZSwgd2hlbiBzYXZpbmcgaXMgZG9uZS5cclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5yZXRyeVNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZSgpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLndhaXRGb3JWZXJzaW9uVG9QZXJzaXN0ID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBlcnNpc3RlZFZlcnNpb247XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmxvYWQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0ZWRWZXJzaW9uID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShwZXJzaXN0ZWRWZXJzaW9uIDwgdmVyc2lvbikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmUoKTsgLy8gQmUgbW9yZSBlYWdlciB0byBzYXZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5maWx0ZXIoZnVuY3Rpb24gKHBlcnNpc3RlZFZlcnNpb24pIHsgcmV0dXJuIHBlcnNpc3RlZFZlcnNpb24gPj0gdmVyc2lvbjsgfSkubG9hZCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZClcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXRJZCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzU2F2aW5nUHJvbWlzZSlcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2F2aW5nUHJvbWlzZTtcclxuICAgICAgICBpZiAoIXRoaXMuaXNFZGl0ZWQpXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2lzU2F2aW5nUHJvbWlzZSA9IHRoaXMuX3NhdmUoKTtcclxuICAgICAgICB0aGlzLl9pc1NhdmluZ1Byb21pc2UuY2F0Y2goZnVuY3Rpb24gKCkgeyB9KS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9pc1NhdmluZ1Byb21pc2UgPSBudWxsOyB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNTYXZpbmdQcm9taXNlO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLl9zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbXV0YXRpb25zLCB2ZXJzaW9uLCBtdXRhdGlvblJlcXVlc3RzLCByZXNfMSwgZXRhZ011dGF0aW9ucywgZXJyb3JfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zID0gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gdGhpcy5jdXJyZW50VmVyc2lvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLm1vdmVUb1NhdmluZ1F1ZXVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9uUmVxdWVzdHMgPSB0aGlzLm1hcE11dGF0aW9ucyhtdXRhdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDYsIDExLCAxMl0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmdldENsaWVudCgpLmJhdGNoKG11dGF0aW9uUmVxdWVzdHMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc18xID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldGFnTXV0YXRpb25zID0gT2JqZWN0LmtleXMocmVzXzEubmV3RXRhZ3MpLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcDogJ3VwZGF0ZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZTogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhRG9jOiB7ICRldGFnOiByZXNfMS5uZXdFdGFnc1tpZF0gfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG51bGwgLy8gV2UgZG9uJ3QgaGF2ZSB0aGUgdGFyZ2V0IG5hbWUuIEJ1dCB0aGlzIG11dGF0aW9uIHdvbid0IGJlIHZpc2libGUgaW4gYSBEZWx0YUNvbGxlY3Rpb24gYW55d2F5LCBzbyBpdCB3b250IGJlIHVzZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW52YWxpZGF0ZSBjYWNoZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBDYWNoZUJ1c3QuaW52YWxpZGF0ZUNhY2hlKG11dGF0aW9uUmVxdWVzdHMsIHRoaXMuZ2V0VXNlcigpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29tbW1pdCBtdXRhdGlvbnMgYWxvbmcgd2l0aCBldGFnTXV0YXRpb25zIGludG8gcXVlcmllcyBjYWNoZWQgZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2godmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsdGFDYWNoZS5hcHBseU11dGF0aW9ucyhtdXRhdGlvbnMsIHsgb3B0aW1pc3RpYzogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXQuY29tbWl0TXV0YXRpb25zKE11dGF0aW9uUXVldWUubWVyZ2UobXV0YXRpb25zLCBldGFnTXV0YXRpb25zKSwgdmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPbiBzdWNjZXNzLCBjbGVhciBzYXZpbmcgcXVldWUgYXMgdGhlIG11dGF0aW9ucyB3aWxsIG5vdyBiZSBjb21taXR0ZWQgdG8gYWxsIHF1ZXJ5J3MgZGF0YSBpbnN0ZWFkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUuY2xlYXJTYXZpbmdRdWV1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmFsbHksIG5vdGlmeSBzdWJzY3JpYmVycyBzbyB0aGF0IHZpZXdzIGdldCB1cGRhdGVkIHdpdGggY29tbWl0dGVkIHJlc3VsdHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVNldC5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhcyB3ZWxsLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zYXZlKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiByZXR1cm4gWzMgLypicmVhayovLCAxMl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2hFcnJvcihlcnJvcl8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZXJyb3JfMSAmJiBlcnJvcl8xLm5hbWUgJiYgZXJyb3JfMS5uYW1lLnN0YXJ0c1dpdGgoXCJodHRwNFwiKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBY2Nlc3MgQ29udHJvbCBkZW5pZWQsIGJhZCByZXF1ZXN0IG9yIHNpbWlsYXIuIFRocm93IG11dGF0aW9ucyBhd2F5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUuY2xlYXJTYXZpbmdRdWV1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLmxlbmd0aCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG8gaG8hIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFsb25lLiBUSGV5IG1pZ2h0IGJlIG1vcmUgbHVja3kuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3NhdmUoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIbyBobyEgQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYWxvbmUuIFRIZXkgbWlnaHQgYmUgbW9yZSBsdWNreS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDg7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzcgLyplbmRmaW5hbGx5Ki9dO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUubWFwTXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHZhciBiciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xyXG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAobS5vcCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcclxuICAgICAgICAgICAgICAgICAgICBici51cGRhdGUobS50YWJsZSwgbS5pZCwgbS5kZWx0YURvYywgbS5icmFuY2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhZGQtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtLnJlbGF0ZWREb2MuJGV0YWcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm8gJGV0YWcgbWVhbnMgdGhpcyBpcyBhIG5ldyBkb2N1bWVudC4gQWRkIGl0IGJlZm9yZSBsaW5raW5nIHRvIGl0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBici5hZGQodGFibGVzW20udGFibGVdLnJlbGF0aW9uc2hpcHNbbS5ncmFwaFByb3BdLCBtLnJlbGF0ZWREb2MsIG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBici5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkRG9jLmlkLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcclxuICAgICAgICAgICAgICAgICAgICBici51bmxpbmsyKG0udGFibGUsIG0uaWQsIG0uZ3JhcGhQcm9wLCBtLnJlbGF0ZWREb2MuaWQsIG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAndW5kby1saW5rJzpcclxuICAgICAgICAgICAgICAgICAgICBici51bmRvTGluayhtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkSWQsIG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgICAgICBici5kZWxldGUobS50YWJsZSwgbS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbGVhci1icmFuY2gnOlxyXG4gICAgICAgICAgICAgICAgICAgIGJyLmNsZWFyQnJhbmNoKG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbWVyZ2UnOlxyXG4gICAgICAgICAgICAgICAgICAgIGJyLm1lcmdlKG0uYnJhbmNoSWQsIG0udGFyZ2V0QnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGJyLm11dGF0aW9uUmVxdWVzdHM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEtlZEJhY2tlbmRXcml0ZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC13cml0ZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgZ2V0VGFibGVGcm9tTGFiZWwsIGJyYW5jaFNlbnNpdGl2ZSwgZ2xvYmFsT3AgfSBmcm9tICcuL3V0aWxzJztcclxuaW1wb3J0IHsgbWVyZ2VEZWx0YXMgfSBmcm9tICcuL2RlbHRhLW1lcmdlJztcclxudmFyIE11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNdXRhdGlvblF1ZXVlKCkge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBbXTtcclxuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XHJcbiAgICB9XHJcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAobXV0YXRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5xdWV1ZSwgbXV0YXRpb25zKTtcclxuICAgIH07XHJcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5tb3ZlVG9TYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gTXV0YXRpb25RdWV1ZS5tZXJnZSh0aGlzLnNhdmluZ1F1ZXVlLCB0aGlzLnF1ZXVlKTtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gW107XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2xlYXJTYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmluZ1F1ZXVlLmNvbmNhdCh0aGlzLnF1ZXVlKTtcclxuICAgIH07XHJcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZmZlY3RzUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSB0aGlzLmdldCgpO1xyXG4gICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ21lcmdlJyB8fCBtLm9wID09PSAnY2xlYXItYnJhbmNoJzsgfSkpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGlmIChxdWVyeS5pZHMpIHtcclxuICAgICAgICAgICAgLy8gQSBxdWVyeSB3aXRoIFwiaWRzXCIgZmlsdGVyIHdpbGwgYmUgZWFzeSB0byBkZXRlY3QgYSBuby1tYXRjaCBvbjpcclxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBnbG9iYWxPcChtKSB8fCAoIWJyYW5jaFNlbnNpdGl2ZShtKSB8fCBtLmJyYW5jaElkID09PSBxdWVyeS5icmFuY2hJZCkgJiZcclxuICAgICAgICAgICAgICAgIHF1ZXJ5Lmlkcy5pbmNsdWRlcyhtLmlkKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXV0YXRpb25zIGFmZmVjdCBzYW1lIGJyYW5jaCBhbmQgdGFibGUuIENvdWxkIGJlIGRvbmUgbW9yZSBmaW5lIGdyYWluZWQsXHJcbiAgICAgICAgLy8gYnV0IHRoYXQgd291bGQgb25seSBiZSBhIHN1Ym9wdGltaXphdGlvbi5cclxuICAgICAgICByZXR1cm4gbXV0YXRpb25zLnNvbWUoZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG0ub3AgPT09ICdkZWxldGUnID9cclxuICAgICAgICAgICAgICAgIG0udGFibGUgPT09IHRhYmxlIHx8IChpbmNsdWRlcy5zb21lKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSA9PT0gbS50YWJsZTsgfSkpIDpcclxuICAgICAgICAgICAgICAgIGdsb2JhbE9wKG0pID8gdHJ1ZSA6XHJcbiAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PSBxdWVyeS5icmFuY2hJZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAobS50YWJsZSA9PT0gdGFibGUgfHwgKG0ub3AgIT09ICd1cGRhdGUnICYmIChbdGFibGVdLmNvbmNhdChpbmNsdWRlcy5tYXAoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbCh0YWJsZSwgbGFiZWwpOyB9KSkuc29tZShmdW5jdGlvbiAodGFibGUpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKG0udGFibGUsIG0uZ3JhcGhQcm9wKSA9PT0gdGFibGU7IH0pKSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uUXVldWUubWVyZ2UgPSBmdW5jdGlvbiAocXVldWUxLCBxdWV1ZTIpIHtcclxuICAgICAgICB2YXIgbXV0YWJsZVF1ZXVlMSA9IHF1ZXVlMS5zbGljZSgpO1xyXG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUyID0gcXVldWUyLnNsaWNlKCk7XHJcbiAgICAgICAgLy9pZiAobXV0YWJsZVF1ZXVlMS5sZW5ndGggPiAwKSBkZWJ1Z2dlcjtcclxuICAgICAgICB2YXIgbGVuID0gcXVldWUxLmxlbmd0aDtcclxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XHJcbiAgICAgICAgICAgIHZhciBtID0gcXVldWUxW2ldO1xyXG4gICAgICAgICAgICBpZiAobS5vcCA9PT0gJ3VwZGF0ZScpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvdmVybGFwcGluZ0lkT3BJZHggPSBtdXRhYmxlUXVldWUyLmZpbmRJbmRleChmdW5jdGlvbiAobmV3TXV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld011dC5vcCA9PT0gJ3VwZGF0ZScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3TXV0LmJyYW5jaElkID09PSBtLmJyYW5jaElkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5pZCA9PT0gbS5pZDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKG92ZXJsYXBwaW5nSWRPcElkeCA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMVtpXSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0sIHsgZGVsdGFEb2M6IG1lcmdlRGVsdGFzKG0uZGVsdGFEb2MsIG11dGFibGVRdWV1ZTJbb3ZlcmxhcHBpbmdJZE9wSWR4XS5kZWx0YURvYykgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMi5zcGxpY2Uob3ZlcmxhcHBpbmdJZE9wSWR4LCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xyXG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbXV0YWJsZVF1ZXVlMS5jb25jYXQobXV0YWJsZVF1ZXVlMik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE11dGF0aW9uUXVldWU7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IE11dGF0aW9uUXVldWUgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bXV0YXRpb24tcXVldWUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgS2VkQmFja2VuZFF1ZXJ5IH0gZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcclxuaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XHJcbmltcG9ydCB7IHF1ZXJ5QXJyYXkgfSBmcm9tICcuL3V0aWxzJztcclxudmFyIFF1ZXJ5U2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUXVlcnlTZXQobXV0YXRpb25RdWV1ZSkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IG11dGF0aW9uUXVldWU7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gW107XHJcbiAgICB9XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuY29tbWl0TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgdmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIFByb21pc2UuYWxsKHRoaXMucXVlcmllcy5tYXAoZnVuY3Rpb24gKHEpIHsgcmV0dXJuIHEuY29tbWl0TXV0YXRpb25zKG11dGF0aW9ucywgdmVyc2lvbik7IH0pKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYW51cEludmFsaWRRdWVyaWVzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNsZWFudXBJbnZhbGlkUXVlcmllcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7XHJcbiAgICAgICAgICAgIGlmIChxLmludmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChxLnRpbWVvdXRIYW5kbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocS50aW1lb3V0SGFuZGxlKTtcclxuICAgICAgICAgICAgICAgICAgICBxLnRpbWVvdXRIYW5kbGUgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVycyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgb3B0aW1pc3RpY011dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcclxuICAgICAgICB0aGlzLnF1ZXJpZXMuZm9yRWFjaChmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICBxLm5vdGlmeVN1YnNjcmliZXJzKG9wdGltaXN0aWNNdXRhdGlvbnMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5maW5kUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcmllcy5maW5kKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLnF1ZXJ5S2V5ID09PSBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGFibGUsIHF1ZXJ5KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLnF1ZXJ5TG9jYWxseSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKSB7XHJcbiAgICAgICAgLy8gRm9yIG5vdywgb25seSBoYW5kbGUgdGhpcyB2ZXJ5IGNvbW1vbiBhbmQgc3BlY2lhbCBjYXNlICh3aGljaFxyXG4gICAgICAgIC8vIHdpbGwgc2F2ZSBhIGxvdCBvZiB1bm5lc2Nlc3NhcnkgbmV0d29yayB0cmFmZmljIGlmIEkgYW0gdGhpbmtpbmcgcmlnaHQuLi4pXHJcbiAgICAgICAgdmFyIG11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcclxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgd2FudHMgdG8gZ2V0IGEgc2luZ2xlIGVudGl0eSBieSBpdHMgSUQ6XHJcbiAgICAgICAgaWYgKHF1ZXJ5LmlkcyAmJiBxdWVyeS5pZHMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIC8vIEFuZCBpZiBzbywgaWYgd2UgaGF2ZSBhbiBvdXRnb2luZyBtdXRhdGlvbiB0byBjcmVhdGUgdGhhdCBlbnRpdHk6XHJcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ2FkZC1yZWxhdGVkJyAmJiBtLnJlbGF0ZWREb2MuaWQgPT09IHF1ZXJ5Lmlkc1swXTsgfSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFRoZW4gcmV0dXJuIGFuIEVNUFRZIHJlc3BvbnNlLCBzaWduYWxsaW5nIHRoYXQgd2UgY2FuIHJlc29sdmUgdGhpcyBsb2NhbGx5LFxyXG4gICAgICAgICAgICAgICAgLy8gYnV0IGxldCB0aGUgb3B0aXN0aWMgZmVhdHVyZSBvZiBLZWRCYWNrZW5kUXVlcnkgYXBwbHkgdGhlIG11dGF0aW9uIGJlZm9yZVxyXG4gICAgICAgICAgICAgICAgLy8gbm90aWZ5aW5nIHN1YnNjcmliZXJzICh3ZSBkb24ndCB3YW50IGl0IHRvIGJlIHBlcnNpc3RlbnQgYmVmb3JlIHRoZSBzZXJ2ZXJcclxuICAgICAgICAgICAgICAgIC8vIGhhcyBhY2NlcHRlZCB0aGUgbXV0YXRpb24pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gT0ssIGFub3RoZXIgcXVpdGUgY29tbW9uIGNhc2UgaXMgd2hlbiB3ZSBhc2sgZm9yIGEgY2VydGFpbiBJRCBhbmQgdGhhdCBJRCByZXBsaWVzXHJcbiAgICAgICAgLy8gd2l0aGluIGFub3RoZXIgcXVlcnlcclxuICAgICAgICBpZiAocXVlcnkuaGFzRWRnZXNGcm9tIHx8IHF1ZXJ5Lmhhc0VkZ2VzVG8pXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBOb3QgcG9zc2libGUgdG8gaGFuZGxlXHJcbiAgICAgICAgaWYgKCFxdWVyeS5pZHMpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvLyBGb3Igbm93LCBqdXN0IHRha2UgaGlnaHQgZm9yIHRoaXMgcGFydGljdWxhciBhbmQgbW9zdCBjb21tb24gY2FzZSFcclxuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChxKSB7XHJcbiAgICAgICAgICAgIGlmICghcS5nb3RJbml0aWFsUmVzcG9uc2UpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICBpZiAocS5xdWVyeS5icmFuY2hJZCAhPT0gcXVlcnkuYnJhbmNoSWQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICBpZiAocS5xdWVyeS5mbGFncylcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7IC8vIEl0IHdvdWxkIGJlIGNvbXBsZXggdG8gc3VwcG9ydCB2YXJpb3VzIGZsYWdzLiBRdWVyeSdzIGRhdGEgbWF5IGluY2x1ZGUgaWRzIG9ubHkuIENhbid0IHJlbHkgb24gdGhlIHF1ZXJ5LlxyXG4gICAgICAgICAgICB2YXIgcUluY2x1ZGVzID0gcS5pbmNsdWRlcztcclxuICAgICAgICAgICAgaWYgKHFJbmNsdWRlcy5sZW5ndGggPiAwICYmICghcXVlcnkuaW5jbHVkZSB8fCBxdWVyeS5pbmNsdWRlLmxlbmd0aCA9PT0gMCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IGluY2x1ZGUsIGJ1dCB0aGlzIHF1ZXJ5IGRvZXMuIENoZWNrIGlmIHdlIGNhbiBmaW5kIG91ciByZXN1bHQgd2l0aGluIGl0LlxyXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcUluY2x1ZGVzLmZpbmQoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3EudGFibGVdW1wicmVsYXRpb25zaGlwc1wiXVtsXSA9PT0gdGFibGU7IH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc18xID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHEuZGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVudGl0eSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YkRhdGEgPSBxdWVyeUFycmF5KHF1ZXJ5LCBlbnRpdHlbbGFiZWxdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IHJldHVybiByZXNfMVtyLmlkXSA9IHI7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0XzEgPSBPYmplY3Qua2V5cyhyZXNfMSkubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzXzFbaWRdOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5pZHMuZXZlcnkoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXN1bHRfMS5zb21lKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmlkID09PSBpZDsgfSk7IH0pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMSB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghaW5jbHVkZXMuZXZlcnkoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBxSW5jbHVkZXMuaW5jbHVkZXMobGFiZWwpOyB9KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XHJcbiAgICAgICAgICAgIC8vIExhc3RseSwgaWYgdGhlIHF1ZXJ5IGluY2x1ZGVzIGFsbCBncmFwaHMgdGhhdCB3ZSBkbywgcGljayB0aGUgc3Vic2V0IGZyb20gdGhhdCBxdWVyeS5cclxuICAgICAgICAgICAgLy8gQ29uY3JldGUgZXhhbXBsZTogV2Ugb2JzZXJ2ZSBhIGNlcnRhaW4gVGFzayBieSBJRCBhbmQgd2FudCBpdHMga25vd2xlZGdlUmVxdWlyZW1lbnRzIGFsb25nIHdpdGggaXQsXHJcbiAgICAgICAgICAgIC8vIGFuZCB0aGVyZSdzIGFub3RoZXIgcXVlcnkgb2YgYWxsIHRhc2tzIHRoYXQgYWxzbyBpbmNsdWRlcyBrbm93bGVkZ2VSZXF1aXJlbWVudHMuIFVzZSBpdC4gXHJcbiAgICAgICAgICAgIGlmIChxLnRhYmxlID09PSB0YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8yID0gcXVlcnlBcnJheShxdWVyeSwgcS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIC8vIE9ubHkgcmV0dXJuIHJlc3VsdCBpZiB3ZSBjb3VsZCBsb29rIHVwIGV2ZXJ5IHJlcXVlc3RlZCBJRDpcclxuICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzIuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHJlc3VsdF8yIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnF1ZXJpZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBxID0gX2FbX2ldO1xyXG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocSk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhdGVfMSA9PT0gXCJvYmplY3RcIilcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcclxuICAgICAgICB2YXIga2JRdWVyeSA9IHRoaXMuZmluZFF1ZXJ5KHRhYmxlLCBxdWVyeSk7XHJcbiAgICAgICAgaWYgKCFrYlF1ZXJ5KSB7XHJcbiAgICAgICAgICAgIGtiUXVlcnkgPSBuZXcgS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgcmVwby5nZXRVc2VyKCksIHJlcG8sIHRoaXMubXV0YXRpb25RdWV1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcmllcy5wdXNoKGtiUXVlcnkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGtiUXVlcnkudGltZW91dEhhbmRsZSkge1xyXG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGtiUXVlcnkudGltZW91dEhhbmRsZSk7XHJcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGtiUXVlcnkuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIF9hID0gc3Vic2NyaXB0aW9uLmNvbGxlY3Rpb24sIHRhYmxlID0gX2EudGFibGUsIHF1ZXJ5ID0gX2EucXVlcnksIHJlcG8gPSBfYS5yZXBvO1xyXG4gICAgICAgIHZhciBrYlF1ZXJ5ID0gdGhpcy5maW5kUXVlcnkodGFibGUsIHF1ZXJ5KTtcclxuICAgICAgICBpZiAoa2JRdWVyeSkge1xyXG4gICAgICAgICAgICAvLyBQcm9oaWJpdCBmdXJ0aGVyIG5vdGlmaWNhdGlvbnMgdG8gdGhpcyBzdWJzY3JpcHRpb246XHJcbiAgICAgICAgICAgIGtiUXVlcnkudW5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgLy8gUmVsZWFzZSB1bm5lc2Nlc3NhcnkgbWVtb3J5IHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgc3Vic2NyaXB0aW9ucyBvZiB0aGlzIHF1ZXJ5LCBieSByZW1vdmluZyB0aGUgcXVlcnkgaXRzZWxmXHJcbiAgICAgICAgICAgIC8vIFRvIHRoYXQgaW4gYSBkZWxheWVkIG1hbm5lciwgc28gdGhhdCBhbiB1bnN1YnNjcmliZSgpIGZvbGxvd2VkIGJ5IGFuIGltbWVkaWF0ZSBzdWJzY3JpYmUoKSBkb24ndCBoYXZlIHRvIHJlLXF1ZXJ5IHRoZSBzZXJ2ZXI6XHJcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnN1YnNjcmlwdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGluIDUgbWludXRlczpcclxuICAgICAgICAgICAgICAgIGtiUXVlcnkudGltZW91dEhhbmRsZSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGtiUXVlcnkgc3RpbGwgaGFzIG5vIHN1YnNjcmlwdGlvbnMgKG5vdCBjZXJ0YWluISBBIG5ldyBzdWJzY3JpYmVyIG1heSBoYXZlIGNvbWUgYWxvbmcuLi4pXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RpbGwgbm8gc3Vic2NyaXB0aW9ucyBvbiBpdCwgdGltZSB0byByZWxlYXNlIHNvbWUgbWVtb3J5IGFuZCBmb3JnZXQgdGhlIGluLW1lbW9yeSBjYWNoZSBvZiB0aGUgcXVlcnkgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXJpZXMgPSBfdGhpcy5xdWVyaWVzLmZpbHRlcihmdW5jdGlvbiAocSkgeyByZXR1cm4gcSAhPT0ga2JRdWVyeTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgdGhpcy5xdWVyaWVzLmxlbmd0aCA+IDUwID9cclxuICAgICAgICAgICAgICAgICAgICA1MDAgOiAvLyBEb24ndCBob3N0IHRvbyBtYW55IHF1ZXJpZXMuIEdhcmJhZ2UgY29sbGVjdCB0aGlzIHdpdGhpbiA1MDAgbXNcclxuICAgICAgICAgICAgICAgICAgICA1ICogNjAwMDApOyAvLyBBbGxvdyBxdWVyeSBpbiBtZW1vcnkgZm9yIGFub3RoZXIgNSBtaW51dGVzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFF1ZXJ5U2V0O1xyXG59KCkpO1xyXG5leHBvcnQgeyBRdWVyeVNldCB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1xdWVyeS1zZXQuanMubWFwIiwiaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB7XHJcbiAgICByZXR1cm4gdGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlBcnJheShxdWVyeSwgZGF0YSkge1xyXG4gICAgdmFyIGZpbHRlciA9IGdldEZpbHRlckZyb21RdWVyeShxdWVyeSk7XHJcbiAgICByZXR1cm4gZGF0YS5maWx0ZXIoZmlsdGVyKTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gQU5EKGZpbHRlcjEsIGZpbHRlcjIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoeCkgeyByZXR1cm4gZmlsdGVyMSh4KSAmJiBmaWx0ZXIyKHgpOyB9O1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpIHtcclxuICAgIHZhciBmaWx0ZXIgPSBmdW5jdGlvbiAoeCkgeyByZXR1cm4gdHJ1ZTsgfTtcclxuICAgIGlmIChxdWVyeS5mcm9tKVxyXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA+PSBxdWVyeS5mcm9tOyB9KTtcclxuICAgIGlmIChxdWVyeS50bylcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZGF0ZVRpbWUgPCBxdWVyeS50bzsgfSk7XHJcbiAgICBpZiAocXVlcnkuaWRzKVxyXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4gcXVlcnkuaWRzLmluY2x1ZGVzKHguaWQpOyB9KTtcclxuICAgIGlmIChxdWVyeS5uYW1lKVxyXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5uYW1lID09PSBxdWVyeS5uYW1lOyB9KTtcclxuICAgIGlmIChxdWVyeS50YWdzKVxyXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50YWdzICYmIFtdLmNvbmNhdChxdWVyeS50YWdzIHx8IFtdKS5zb21lKGZ1bmN0aW9uICh0YWcpIHsgcmV0dXJuIHgudGFncy5pbmNsdWRlcyh0YWcpOyB9KTsgfSk7XHJcbiAgICAvLyBxdWVyeS5oYXNFZGdlc0Zyb20gYW5kIHF1ZXJ5Lmhhc0VkZ2VzVG8gY2Fubm90IGJ5IGZpbHRlcmVkIGhlcmVcclxuICAgIHJldHVybiBmaWx0ZXI7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGJyYW5jaFNlbnNpdGl2ZShtKSB7XHJcbiAgICByZXR1cm4gbS5vcCAhPT0gJ2RlbGV0ZSc7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGdsb2JhbE9wKG0pIHtcclxuICAgIHJldHVybiBtLm9wID09PSAnY2xlYXItYnJhbmNoJyB8fCBtLm9wID09PSAnbWVyZ2UnO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSc7XHJcbmV4cG9ydCB2YXIgS2VkTW9kZWxNaWdyYXRvck1peGluID0gZnVuY3Rpb24gKGNsaWVudCkge1xyXG4gICAgaWYgKGNsaWVudC5fX21pZ3JhdG9yX21peGVkX2luKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGNsaWVudC5fX21pZ3JhdG9yX21peGVkX2luID0gdHJ1ZTtcclxuICAgIHZhciBnZXQgPSBjbGllbnQuZ2V0O1xyXG4gICAgdmFyIGxpc3QgPSBjbGllbnQubGlzdDtcclxuICAgIGNsaWVudC5nZXQgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIGluY2x1ZGUgPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZTtcclxuICAgICAgICByZXR1cm4gZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIG1pZ3JhdGUocmVzdWx0LCB0YWJsZSwgaW5jbHVkZSAmJiBpbmNsdWRlLnRvU3RyaW5nKCkuc3BsaXQoJywnKSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgY2xpZW50Lmxpc3QgPSBmdW5jdGlvbiAodGFibGUsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xyXG4gICAgICAgIHJldHVybiBsaXN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5mb3JFYWNoKGZ1bmN0aW9uIChkb2MpIHsgcmV0dXJuIG1pZ3JhdGUoZG9jLCB0YWJsZSwgaW5jbHVkZSAmJiBpbmNsdWRlLnRvU3RyaW5nKCkuc3BsaXQoJywnKSk7IH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBjbGllbnQ7XHJcbn07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVDb3Vyc2UoY291cnNlLCBncmFwaHMpIHtcclxuICAgIGlmICghY291cnNlLm1vZHVsZXMpXHJcbiAgICAgICAgY291cnNlLm1vZHVsZXMgPSBbXTtcclxuICAgIGNvdXJzZS5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZSkge1xyXG4gICAgICAgIGlmICghbW9kdWxlLnJlc291cmNlcykge1xyXG4gICAgICAgICAgICBtb2R1bGUucmVzb3VyY2VzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghbW9kdWxlLnRhc2tJZHMpIHtcclxuICAgICAgICAgICAgbW9kdWxlLnRhc2tJZHMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmICghY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMpIHtcclxuICAgICAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xyXG4gICAgfVxyXG4gICAgLy8gRWFybGllciB3cm9uZyBzcGVsbGluZyBvZiByZXNvdXJjZXNcclxuICAgIGlmICgncmVzb3Vyc2VzJyBpbiBjb3Vyc2UgJiYgISgncmVzb3VyY2VzJyBpbiBjb3Vyc2UpKSB7XHJcbiAgICAgICAgY291cnNlLnJlc291cmNlcyA9IGNvdXJzZS5yZXNvdXJzZXM7XHJcbiAgICAgICAgZGVsZXRlIGNvdXJzZS5yZXNvdXJzZXM7XHJcbiAgICB9XHJcbiAgICBpZiAoIWNvdXJzZS5yZXNvdXJjZXMpIHtcclxuICAgICAgICBjb3Vyc2UucmVzb3VyY2VzID0gW107XHJcbiAgICB9XHJcbiAgICBpZiAoZ3JhcGhzKSB7XHJcbiAgICAgICAgZ3JhcGhzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAobGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3Rhc2tzJzpcclxuICAgICAgICAgICAgICAgICAgICBjb3Vyc2UudGFza3MuZm9yRWFjaChmdW5jdGlvbiAodGFzaykgeyByZXR1cm4gbWlncmF0ZVRhc2sodGFzayk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWlncmF0ZS1jb3Vyc2UuanMubWFwIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWlncmF0ZVRhc2sodGFzaykge1xyXG4gICAgaWYgKCF0YXNrLnJlc291cmNlcylcclxuICAgICAgICB0YXNrLnJlc291cmNlcyA9IFtdO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtdGFzay5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZUNvdXJzZSBmcm9tICcuL21pZ3JhdGUtY291cnNlJztcclxuaW1wb3J0IG1pZ3JhdGVUYXNrIGZyb20gJy4vbWlncmF0ZS10YXNrJztcclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWlncmF0ZShkb2MsIHRhYmxlLCBncmFwaHMpIHtcclxuICAgIHN3aXRjaCAodGFibGUpIHtcclxuICAgICAgICBjYXNlIFwiY291cnNlc1wiOlxyXG4gICAgICAgICAgICBtaWdyYXRlQ291cnNlKGRvYywgZ3JhcGhzKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcInRhc2tzXCI6XHJcbiAgICAgICAgICAgIG1pZ3JhdGVUYXNrKGRvYyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSB9IGZyb20gXCIuL29ic2VydmFibGVcIjtcclxuaW1wb3J0IHsgaW5pdE1hcE1ldGhvZCB9IGZyb20gXCIuL21hcFwiO1xyXG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XHJcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tIFwiLi9lbWl0dGVyXCI7XHJcbnZhciBDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIENvbGxlY3Rpb24oc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHN1YnNjcmliZSkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLl9tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XHJcbiAgICAgICAgdGhyb3cgXCJtaXhlZGluXCI7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5mcm9tID0gZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICBpZiAoeC5zdWJzY3JpYmUpXHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHgpKSB7XHJcbiAgICAgICAgICAgIHZhciBlbWl0dGVyXzEgPSBuZXcgRW1pdHRlcih4KTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBlbWl0dGVyXzEuc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiT2JzZXJ2YWJsZUNvbGxlY3Rpb24uZnJvbSgpIGNhbiBvbmx5IHRha2UgYXJyYXlzIG9yIG9ic2VydmFibGVzXCIpO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBtYXBwZXIoaXRlbSk7IH0pOyB9KTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5mbGF0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBbXS5jb25jYXQuYXBwbHkoW10sIGl0ZW1zKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcy5maWx0ZXIoZmlsdGVyKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIENvbGxlY3Rpb24uZnJvbSh0aGlzLnRvVmFsdWUoKS5jb21iaW5lTGF0ZXN0KG90aGVyKS5tYXAoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgIHZhciBtZSA9IF9hWzBdLCBvdGhlciA9IF9hWzFdO1xyXG4gICAgICAgICAgICByZXR1cm4gbWUuY29uY2F0KG90aGVyKTtcclxuICAgICAgICB9KSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUub3JkZXJCeSA9IGZ1bmN0aW9uIChwcm9wKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoYXJyYXkpIHsgcmV0dXJuIGFycmF5LnNsaWNlKCkuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICB2YXIgYVByb3AgPSBhICYmIGFbcHJvcF07XHJcbiAgICAgICAgICAgIHZhciBiUHJvcCA9IGIgJiYgYltwcm9wXTtcclxuICAgICAgICAgICAgcmV0dXJuIGFQcm9wID4gYlByb3AgPyAxIDogYVByb3AgPCBiUHJvcCA/IC0xIDogMDtcclxuICAgICAgICB9KTsgfSkudG9Db2xsZWN0aW9uKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS50b1ZhbHVlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAocykgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5ncm91cEJ5ID0gZnVuY3Rpb24gKHByb3ApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xyXG4gICAgICAgICAgICB2YXIgcnYgPSB7fTtcclxuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBydltpdGVtW3Byb3BdXSB8fCAocnZbaXRlbVtwcm9wXV0gPSBbXSk7XHJcbiAgICAgICAgICAgICAgICBsaXN0LnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcnY7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmlyc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoYXJyKSB7IHJldHVybiBhcnJbMF07IH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb2xsZWN0aW9uO1xyXG59KE9ic2VydmFibGUpKTtcclxuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xyXG5Db2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gaW5pdE1hcE1ldGhvZChDb2xsZWN0aW9uKTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29sbGVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XHJcbnZhciBFbWl0dGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoRW1pdHRlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEVtaXR0ZXIoaW5pdGlhbFZhbHVlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBfYVswXTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcyAhPT0gb2JzZXJ2ZXI7XHJcbiAgICAgICAgICAgICAgICB9KTsgfSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlcnMucHVzaChbb2JzZXJ2ZXIsIHN1YnNjcmlwdGlvbl0pO1xyXG4gICAgICAgICAgICBpZiAoX3RoaXMuZXJyb3IpXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIoX3RoaXMudmFsdWUsIHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcclxuICAgICAgICB9KSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgX3RoaXMudmFsdWUgPSBpbml0aWFsVmFsdWU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgRW1pdHRlci5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcclxuICAgICAgICB0aGlzLl9kaXNwYXRjaCgpO1xyXG4gICAgfTtcclxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcclxuICAgIH07XHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5fZGlzcGF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IF9hWzBdLCBzdWJzY3JpcHRpb24gPSBfYVsxXTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRW1pdHRlcjtcclxufShWYWx1ZSkpO1xyXG5leHBvcnQgeyBFbWl0dGVyIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVtaXR0ZXIuanMubWFwIiwidmFyIHN0YWNrID0gW107XHJcbnZhciBjdXJyZW50RmliZXIgPSBudWxsO1xyXG52YXIgcHJvdmlkZXJzID0gW2Z1bmN0aW9uICgpIHsgcmV0dXJuIGN1cnJlbnRGaWJlcjsgfV07XHJcbmZ1bmN0aW9uIHB1c2hGaWJlcihmaWJlcikge1xyXG4gICAgc3RhY2sucHVzaChjdXJyZW50RmliZXIpO1xyXG4gICAgY3VycmVudEZpYmVyID0gZmliZXI7XHJcbn1cclxuZnVuY3Rpb24gcG9wRmliZXIoKSB7XHJcbiAgICBjdXJyZW50RmliZXIgPSBzdGFjay5wb3AoKTtcclxufVxyXG5leHBvcnQgdmFyIEZpYmVyQ29udGV4dCA9IHtcclxuICAgIGdldCBjdXJyZW50KCkgeyByZXR1cm4gY3VycmVudEZpYmVyOyB9LFxyXG4gICAgLypydW46IGZ1bmN0aW9uIHJlcnVuPFI+KGZpYmVyOiBGaWJlciwgZm46ICgpPT5SKTogUiB8IFByb21pc2U8Uj4ge1xyXG4gICAgICBwdXNoRmliZXIoZmliZXIpO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZm4oKSk7XHJcbiAgICAgIH0gY2F0Y2ggKHApIHtcclxuICAgICAgICBpZiAocCAmJiB0eXBlb2YgcC50aGVuID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICByZXR1cm4gcC50aGVuKCgpPT5yZXJ1bihmaWJlciwgZm4pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICBwb3BGaWJlcigpO1xyXG4gICAgICB9XHJcbiAgICB9LCovXHJcbiAgICBhZGRQcm92aWRlcjogZnVuY3Rpb24gKGdldEN1cnJlbnRGaWJlcikge1xyXG4gICAgICAgIHByb3ZpZGVycy5wdXNoKGdldEN1cnJlbnRGaWJlcik7XHJcbiAgICAgICAgc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKTtcclxuICAgIH0sXHJcbiAgICByZW1vdmVQcm92aWRlcjogZnVuY3Rpb24gKGdldEN1cnJlbnRGaWJlcikge1xyXG4gICAgICAgIHByb3ZpZGVycyA9IHByb3ZpZGVycy5maWx0ZXIoZnVuY3Rpb24gKHApIHsgcmV0dXJuIHAgIT09IGdldEN1cnJlbnRGaWJlcjsgfSk7XHJcbiAgICAgICAgc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKTtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gc2V0Q3VycmVudEdldHRlckZyb21Qcm92aWRlcnMoKSB7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmliZXJDb250ZXh0LCBcImN1cnJlbnRcIiwge1xyXG4gICAgICAgIGdldDogcHJvdmlkZXJzLnJlZHVjZShmdW5jdGlvbiAocCwgYykgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyByZXR1cm4gcCgpIHx8IGMoKTsgfTsgfSksXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIlVzZSBGaWJlckNvbnRleHQucHVzaCgpIHRvIGNoYW5nZSBjdXJyZW50IGZpYmVyXCIpOyB9XHJcbiAgICB9KTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWJlci1jb250ZXh0LmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vb2JzZXJ2YWJsZSc7XHJcbmV4cG9ydCAqIGZyb20gJy4vdmFsdWUnO1xyXG5leHBvcnQgKiBmcm9tICcuL2NvbGxlY3Rpb24nO1xyXG5leHBvcnQgKiBmcm9tICcuL2VtaXR0ZXInO1xyXG5leHBvcnQgKiBmcm9tICcuL2ZpYmVyLWNvbnRleHQnO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJleHBvcnQgZnVuY3Rpb24gaW5pdE1hcE1ldGhvZChjdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKG1hcHBlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBjdG9yKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihtYXBwZXIodmFsdWUpLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYXAuanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIG1peGluKHRhcmdldFByb3RvLCBtaXhpblByb3RvKSB7XHJcbiAgICB2YXIgcHJvcHMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgcHJvcHNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBwcm9wcy5mb3JFYWNoKGZ1bmN0aW9uIChwcm9wKSB7IHJldHVybiB0YXJnZXRQcm90b1twcm9wXSA9IG1peGluUHJvdG9bcHJvcF07IH0pO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1peGluLmpzLm1hcCIsInZhciBPYnNlcnZhYmxlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgLy9zdGF0aWMgZ2V0IFtTeW1ib2wuc3BlY2llc10oKSB7IHJldHVybiB0aGlzOyB9XHJcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKF9zdWJzY3JpYmUpIHtcclxuICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBfc3Vic2NyaWJlO1xyXG4gICAgfVxyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIoaXRlbXMsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVyciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgeyB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyB9IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gT2JzZXJ2YWJsZTtcclxufSgpKTtcclxuZXhwb3J0IHsgT2JzZXJ2YWJsZSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1vYnNlcnZhYmxlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XHJcbmltcG9ydCB7IGluaXRNYXBNZXRob2QgfSBmcm9tIFwiLi9tYXBcIjtcclxuaW1wb3J0IHsgQ29sbGVjdGlvbiB9IGZyb20gXCIuL2NvbGxlY3Rpb25cIjtcclxuaW1wb3J0IHsgRmliZXJDb250ZXh0IH0gZnJvbSAnLi9maWJlci1jb250ZXh0JztcclxudmFyIFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVmFsdWUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBWYWx1ZShzdWJzY3JpYmUpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgVmFsdWUuZnJvbSA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgaWYgKHguc3Vic2NyaWJlKVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChzKSB7IHJldHVybiB4LnN1YnNjcmliZShzKTsgfSk7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUuZnJvbSgpIGNhbiBvbmx5IHRha2Ugb2JzZXJ2YWJsZXNcIik7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLnJlYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHJlc29sdmVkID0gZmFsc2UsIHJlc3VsdCwgZXJyLCBub3RpZnk7XHJcbiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjaXB0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlc29sdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIGVyciA9IGVycm9yO1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IgJiYgbm90aWZ5KVxyXG4gICAgICAgICAgICAgICAgbm90aWZ5KG51bGwsIGVycm9yLCBzdWJzY2lwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG5vdGlmeSlcclxuICAgICAgICAgICAgICAgIG5vdGlmeSh2YWx1ZSwgbnVsbCwgc3Vic2NpcHRpb24pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChyZXNvbHZlZCkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudEZpYmVyID0gRmliZXJDb250ZXh0LmN1cnJlbnQ7XHJcbiAgICAgICAgICAgIGlmICghY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgRmliZXIgQ29udGV4dFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgIHRocm93IGVycjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9ucyA9IGN1cnJlbnRGaWJlci5zdWJzY3JpcHRpb25zLCBvYnNlcnZlciA9IGN1cnJlbnRGaWJlci5vYnNlcnZlcjtcclxuICAgICAgICAgICAgc3Vic2NyaXB0aW9ucy5wdXNoKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIG5vdGlmeSA9IG9ic2VydmVyO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIG5vdGlmeSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY2lwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICBzdWJzY2lwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKGZuKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgZWxzZSBpZiAoZm4odmFsdWUpKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKHByZWZpeCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwcmVmaXgsIHgpO1xyXG4gICAgICAgICAgICByZXR1cm4geDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUudG9Db2xsZWN0aW9uID0gZnVuY3Rpb24gKG1hcHBlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBfdGhpcy5tYXAobWFwcGVyKS5zdWJzY3JpYmUocyk7IH0pO1xyXG4gICAgfTtcclxuICAgIFZhbHVlLnByb3RvdHlwZS5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKG90aGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFZhbHVlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW251bGwsIG51bGxdO1xyXG4gICAgICAgICAgICB2YXIgbXlTdWJzY3JpcHRpb24sIG90aGVyU3Vic2NyaXB0aW9uO1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBteVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG90aGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG15U3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcywgZXJyb3IsIHMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHMudW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhbHVlc1swXSA9IGl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSAhPT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZXMsIG51bGwsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBvdGhlclN1YnNjcmlwdGlvbiA9IG90aGVyLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbMF0gIT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUuc3dpdGNoTWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdmFyIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgcmV0dXJuZWRTdWJzY3JpcHRpb24gPSB7XHJcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtYXBwZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW0sIGVycm9yLCBzKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24gPSBzO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hcHBlZFN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYnNlcnZhYmxlT3JWYWx1ZSA9IG1hcHBlcihpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmFibGVPclZhbHVlICYmIHR5cGVvZiBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG9ic2VydmFibGVPclZhbHVlLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIob2JzZXJ2YWJsZU9yVmFsdWUsIG51bGwsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5lZFN1YnNjcmlwdGlvbjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVmFsdWU7XHJcbn0oT2JzZXJ2YWJsZSkpO1xyXG5leHBvcnQgeyBWYWx1ZSB9O1xyXG5WYWx1ZS5wcm90b3R5cGUubWFwID0gaW5pdE1hcE1ldGhvZChWYWx1ZSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZhbHVlLmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vanMvZGlzdC9qcy9vYnNlcnZhYmxlJztcclxuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8nO1xyXG4iLCJ2YXIgbWFwID0ge1xuXHRcIi4vZW4tU0dcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLVNHLmpzXCIsXG5cdFwiLi9lbi1TRy5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tU0cuanNcIixcblx0XCIuL2VuLWF1XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1hdS5qc1wiLFxuXHRcIi4vZW4tYXUuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWF1LmpzXCIsXG5cdFwiLi9lbi1jYVwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tY2EuanNcIixcblx0XCIuL2VuLWNhLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1jYS5qc1wiLFxuXHRcIi4vZW4tZ2JcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWdiLmpzXCIsXG5cdFwiLi9lbi1nYi5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tZ2IuanNcIixcblx0XCIuL2VuLWllXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pZS5qc1wiLFxuXHRcIi4vZW4taWUuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWllLmpzXCIsXG5cdFwiLi9lbi1pbFwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWwuanNcIixcblx0XCIuL2VuLWlsLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pbC5qc1wiLFxuXHRcIi4vZW4tbnpcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLW56LmpzXCIsXG5cdFwiLi9lbi1uei5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tbnouanNcIixcblx0XCIuL3N2XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9zdi5qc1wiLFxuXHRcIi4vc3YuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL3N2LmpzXCJcbn07XG5cblxuZnVuY3Rpb24gd2VicGFja0NvbnRleHQocmVxKSB7XG5cdHZhciBpZCA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpO1xuXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhpZCk7XG59XG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKSB7XG5cdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8obWFwLCByZXEpKSB7XG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBtYXBbcmVxXTtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUgc3luYyByZWN1cnNpdmUgc3Z8ZW5cIjsiLCJpbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRVc2VyQ2xhaW1zICh1c2VyOiBVc2VyKSB7XHJcbiAgcmV0dXJuIFt7XHJcbiAgICB0eXBlOiBcImVtYWlsXCIsXHJcbiAgICB2YWx1ZTogdXNlci5tYWlsXHJcbiAgfSx7XHJcbiAgICB0eXBlOiBcInNjaG9vbFwiLFxyXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sXHJcbiAgfV0uY29uY2F0KHVzZXIucm9sZXMubWFwKHJvbGUgPT4gKHtcclxuICAgIHR5cGU6IFwicm9sZVwiLFxyXG4gICAgdmFsdWU6IHJvbGVcclxuICB9KSkpLmNvbmNhdCh1c2VyLnJvbGVzLm1hcChyb2xlID0+ICh7XHJcbiAgICB0eXBlOiBcInNjaG9vbFJvbGVcIixcclxuICAgIHZhbHVlOiB1c2VyLnNjaG9vbCArIFwiL1wiICsgcm9sZVxyXG4gIH0pKSk7XHJcbn1cclxuIiwiaW1wb3J0IHsgQWNjZXNzQ2xhaW0sIERvY3VtZW50QWNjZXNzLCBoYXNBY2Nlc3MgYXMgX2hhc0FjY2VzcywgQWNjZXNzUmlnaHQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IERvY3VtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgZ2V0VXNlckNsYWltcyBmcm9tICcuL2dldC11c2VyLWNsYWltcyc7XHJcbmltcG9ydCB7IHBhcnNlUXVlcnlTdHJpbmcsIGdlbmVyYXRlUXVlcnlTdHJpbmcgfSBmcm9tIFwiLi4vdXRpbHMvcXVlcnktc3RyaW5nXCI7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmV4cG9ydCB7IGdldFVzZXJDbGFpbXMgfTtcclxuXHJcbmV4cG9ydCBjb25zdCBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyA9IFtcclxuICBcInVzZXJcIixcclxuICBcInJvbGVcIixcclxuICBcInNjaG9vbFwiLFxyXG4gIFwiZGVidWdcIixcclxuICBcInRlc3RWZXJzaW9uXCIsXHJcbiAgXCJ0ZXN0dmVyc2lvblwiLFxyXG4gIFwiZmVhdHVyZXNcIixcclxuICBcInNjaG9vbFR5cGVcIixcclxuICBcInNjaG9vbHR5cGVcIl07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQsIHJlcXVlc3RlZFJpZ2h0OiBBY2Nlc3NSaWdodCkge1xyXG4gIHZhciBjbGFpbXMgPSBnZXRVc2VyQ2xhaW1zKHVzZXIpO1xyXG4gIGlmIChyZXF1ZXN0ZWRSaWdodCAhPT0gJ1InICYmIHVzZXIudHV0b3JGb3IpIHtcclxuICAgIGNsYWltcyA9IGNsYWltcy5maWx0ZXIoY2xhaW0gPT4gY2xhaW0udHlwZSAhPT0gJ2VtYWlsJyk7XHJcbiAgfVxyXG4gIHZhciByZXN1bHQgPSBfaGFzQWNjZXNzKERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmdBcnJheShkb2MuYWNsIHx8IFtdKSwgY2xhaW1zLCByZXF1ZXN0ZWRSaWdodCk7XHJcbiAgLy9jb25zb2xlLmxvZyhgSGFzICR7cmVxdWVzdGVkUmlnaHR9IGFjY2VzcyB0byAke2RvYy5uYW1lfS8ke2RvYy5pZH06ICR7cmVzdWx0fWApO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNSZWFkQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcclxuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1InKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1dyaXRlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcclxuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1cnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc1NoYXJlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcclxuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1MnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzVGVhY2hlckF0U2Nob29sKHVzZXI6IFVzZXIsIHNjaG9vbDogc3RyaW5nKSB7XHJcbiAgY29uc3QgaXNUZWFjaGVyID0gdXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ0VNUExPWUVFJyB8fCByb2xlID09PSAnQURNSU4nKTtcclxuICBjb25zdCBiZWxvbmdzVG9TY2hvb2wgPSAoc2Nob29sfHxcIlwiKS50b0xvd2VyQ2FzZSgpID09PSB1c2VyLnNjaG9vbC50b0xvd2VyQ2FzZSgpO1xyXG4gIHJldHVybiAoaXNUZWFjaGVyICYmIGJlbG9uZ3NUb1NjaG9vbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0FkbWluT3JUZWFjaGVyQXRTY2hvb2wodXNlcjogVXNlciwgc2Nob29sOiBzdHJpbmcpIHtcclxuICByZXR1cm4gdXNlci5yb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpIHx8IGlzVGVhY2hlckF0U2Nob29sKHVzZXIsIHNjaG9vbCk7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBpbXBlcnNvbmF0aW9uRW52ID0ge1xyXG4gIGFjdEFzIChvcHRpb25zOiB7cm9sZSwgc2Nob29sLCB1cmw/fSkge1xyXG4gICAgY29uc3Qge3JvbGUsIHNjaG9vbCwgdXJsfSA9IG9wdGlvbnM7XHJcbiAgICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICBjb25zdCBuZXdRdWVyeSA9IHsuLi5jdXJyZW50UXVlcnksIHJvbGUsIHNjaG9vbH07XHJcbiAgICBjb25zdCBuZXdRdWVyeVN0cmluZyA9IGdlbmVyYXRlUXVlcnlTdHJpbmcobmV3UXVlcnkpO1xyXG4gICAgaWYgKHVybCkge1xyXG4gICAgICBsb2NhdGlvbi5ocmVmID0gYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSBcIiNcIjtcclxuICAgICAgbG9jYXRpb24uc2VhcmNoID0gbmV3UXVlcnlTdHJpbmc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWN0QXMob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcclxuICBpbXBlcnNvbmF0aW9uRW52LmFjdEFzKG9wdGlvbnMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHJlc2VydmVJbXBlcnNvbmF0aW9uUXVlcnkgKHVybDogc3RyaW5nLCBxdWVyeToge1tuYW1lOiBzdHJpbmddIDogc3RyaW5nfSkge1xyXG4gIGNvbnN0IGN1cnJlbnRRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoKTtcclxuICBjb25zdCBwcmVzZXJ2ZWRRdWVyeSA9IHt9O1xyXG4gIGZvciAoY29uc3QgcGFyYW0gb2YgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpIHtcclxuICAgIGlmIChjdXJyZW50UXVlcnlbcGFyYW1dKSBwcmVzZXJ2ZWRRdWVyeVtwYXJhbV0gPSBjdXJyZW50UXVlcnlbcGFyYW1dO1xyXG4gIH1cclxuICBjb25zdCBuZXdRdWVyeVN0cmluZyA9IGdlbmVyYXRlUXVlcnlTdHJpbmcoey4uLnByZXNlcnZlZFF1ZXJ5LCAuLi5xdWVyeX0pO1xyXG4gIGNvbnN0IHBIYXNoID0gdXJsLmluZGV4T2YoJyMnKTtcclxuICByZXR1cm4gcEhhc2ggPj0gMCA/XHJcbiAgICBgJHt1cmwuc3Vic3RyKDAscEhhc2gpfSR7bmV3UXVlcnlTdHJpbmd9JHt1cmwuc3Vic3RyKHBIYXNoKX1gIDpcclxuICAgIGAke3VybH0ke25ld1F1ZXJ5U3RyaW5nfWA7XHJcbn1cclxuIiwiaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xyXG5cclxuY29uc3QgSWNvbkRyaXZlID0gKHsgc2l6ZSA9IDMwIH0pID0+IChcclxuICA8c3ZnXHJcbiAgICB3aWR0aD17c2l6ZX1cclxuICAgIHZlcnNpb249XCIxLjFcIlxyXG4gICAgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXHJcbiAgICB4bWxuc1hsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiXHJcbiAgICB2aWV3Qm94PVwiMCAwIDUwOC41MiA1MDguNTJcIlxyXG4gICAgZmlsbD1cIiNmZmZmZmZcIlxyXG4gICAgc3R5bGU9e3t2ZXJ0aWNhbEFsaWduOiBcIm1pZGRsZVwiLCBtYXJnaW5SaWdodDogXCI0cHhcIn19XHJcbiAgPlxyXG4gICAgPHBvbHlnb24gcG9pbnRzPVwiNDg0LjQ5MiwyODQuNTggMzM5LjAyNCwzMi41NzcgMTY5LjQ5NiwzMi41NzcgMzE0Ljk5NiwyODQuNThcIiAvPlxyXG4gICAgPHBvbHlnb24gcG9pbnRzPVwiMTQ1LjQzNyw3NC4yNzYgMCwzMjYuMjc5IDg0Ljc2NCw0NzMuMDUgMjMwLjE2OSwyMjEuMTQzXCIgLz5cclxuICAgIDxwb2x5Z29uIHBvaW50cz1cIjIzNC4zOTYsMzE2LjM2MyAxNDMuMzcxLDQ3NS45NDMgNDIzLjc1Niw0NzUuOTQzIDUwOC41MiwzMTYuMzZcIiAvPlxyXG4gIDwvc3ZnPlxyXG4pO1xyXG5cclxuY29uc3QgSWNvbkNsYXNzcm9vbSA9ICh7IHNpemUgPSAzMCB9KSA9PiAoXHJcbiAgPHN2Z1xyXG4gICAgd2lkdGg9e3NpemV9XHJcbiAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcclxuICAgIHhtbG5zWGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCJcclxuICAgIHZpZXdCb3g9XCIwIDAgMjQgMjRcIlxyXG4gICAgdmVyc2lvbj1cIjEuMVwiXHJcbiAgPlxyXG4gICAgPHBhdGggZD1cIk01IDJDMy4zNDggMiAyIDMuMzQ4IDIgNXYxNGMwIDEuNjUyIDEuMzQ4IDMgMyAzaDE0YzEuNjUyIDAgMy0xLjM0OCAzLTNWNWMwLTEuNjUyLTEuMzQ4LTMtMy0zem0wIDJoMTRjLjU1IDAgMSAuNDUgMSAxdjE0YzAgLjU1LS40NSAxLTEgMWgtMXYtMmgtNXYySDVjLS41NSAwLTEtLjQ1LTEtMVY1YzAtLjU1LjQ1LTEgMS0xem03IDJhMS45OTkgMS45OTkgMCAxIDAgMCA0IDEuOTk5IDEuOTk5IDAgMSAwIDAtNHpNNy41IDhhMS41IDEuNSAwIDEgMCAwIDMgMS41IDEuNSAwIDAgMCAwLTN6bTkgMGExLjUgMS41IDAgMSAwIDAgMyAxLjUgMS41IDAgMCAwIDAtM3pNMTIgMTFjLTIuNjYgMC0zLjUgMi41LTMuNSAyLjUgMC0uODQ4LjUtMS41LjUtMS41LS4zLS4xODgtMS4wNy0uMzEzLTEuNDM4LS4zMTMtMS4yMTQgMC0yLjU2MiAxLjE5Mi0yLjU2MiAyVjE2aDE0di0yLjMxM2MwLS44MDgtMS41MTItMi0yLjU2My0yLS4zNjcgMC0xLjEzNi4xMjYtMS40MzcuMzEzIDAgMCAuNS42NTIuNSAxLjUgMCAwLS44NC0yLjUtMy41LTIuNXpcIiAvPlxyXG4gIDwvc3ZnPlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IERyaXZlQnV0dG9uID0gKHtsYWJlbD0nR29vZ2xlIERyaXZlJywgYWN0aW9ufSkgPT4gXHJcbiAgPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17YWN0aW9ufT48SWNvbkRyaXZlIHNpemU9ezE2fSAvPiB7bGFiZWx9PC9hPlxyXG4iLCJpbXBvcnQgeyBFRFNDb3Vyc2UsIEVEU0Fzc2Vzc21lbnQsIEVEU1N0dWR5UGxhbiwgRURTU3R1ZGVudEZ1dHVyZUFiaWxpdHksIEVEU1N0dWRlbnQsIEVEU1R1aXRpb25Hcm91cCwgRURTVHVpdGlvblN0dWRlbnQsIEVEU1RlYWNoZXIsIE1vY2tFRFNBY2FkZW1pY1llYXIsIE1vY2tFRFNEYXRlUmFuZ2UgfSBmcm9tICcuLi9jb250cmFjdHMvZWRzJztcclxuaW1wb3J0IHsgUmVzdENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgSXNvbW9ycGhpY0VudiwgQmVhcmVyUHJvdmlkZXIsIEh0dHBFcnJvciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgU2Nob29sTW9tZW50LCBnZXRUZXJtU3RhckVuZERhdGUgfSBmcm9tICcuLi91dGlscy9zY2hvb2wtbW9tZW50JztcclxuaW1wb3J0IHsgU2Nob29sVGVybSB9IGZyb20gJy4uL3V0aWxzL3NjaG9vbC10ZXJtJztcclxuaW1wb3J0IHsgZGF0ZVRpbWVSZXZpdmVyLCBMIH0gZnJvbSAnLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgbW9ja0pzb25GaWxlIGZyb20gJy4vbW9jay9tb2NrLWVkcy1kYXRhLmpzb24nO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IFN1c3BlbnNlQmFzZWRBUEksIG1ha2VTdXNwZW5zZUFwaSB9IGZyb20gJy4uL3V0aWxzL21ha2Utc3VzcGVuc2UtYXBpJztcclxuXHJcbmV4cG9ydCBjbGFzcyBFZHNDbGllbnQge1xyXG4gIGh0dHA6IFJlc3RDbGllbnQ7XHJcbiAgdXNlckVtYWlsR2V0dGVyOiAoKT0+c3RyaW5nO1xyXG4gIHN1c3BlbnNlOiBTdXNwZW5zZUJhc2VkQVBJPEVkc0NsaWVudD47XHJcblxyXG4gIGNvbnN0cnVjdG9yIChcclxuICAgIGlzb21vcnBoaWM6IElzb21vcnBoaWNFbnYsXHJcbiAgICBiYXNlVXJsOiBzdHJpbmcsXHJcbiAgICBiZWFyZXJQcm92aWRlcjogQmVhcmVyUHJvdmlkZXIsXHJcbiAgICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmdcclxuICApIHtcclxuICAgIHRoaXMuaHR0cCA9IG5ldyBSZXN0Q2xpZW50IChpc29tb3JwaGljLCBiYXNlVXJsLCB7YmVhcmVyUHJvdmlkZXJ9KTtcclxuICAgIHRoaXMudXNlckVtYWlsR2V0dGVyID0gdXNlckVtYWlsR2V0dGVyO1xyXG4gICAgY29uc3QgaXNBcGlNZXRob2QgPSBtID0+XHJcbiAgICAgIHR5cGVvZiB0aGlzW21dID09PSAnZnVuY3Rpb24nICYmXHJcbiAgICAgIG0gIT09ICdjb25zdHJ1Y3RvcicgJiYgLy8gU2luY2UgbWFrZVN1c3BlbnNlQXBpKCkgd2Fsa3MgcHJvdG90eXBlIGNoYWluXHJcbiAgICAgIG0gIT09ICdwcml2YXRpemluZ0NhY2hlQnVzdCcgJiZcclxuICAgICAgbSAhPT0gJ3VzZXJFbWFpbEdldHRlcicgLy8gTGlzdCBub24tQVBJIG1ldGhvZHMgaGVyZS4uLlxyXG4gICAgICA7XHJcblxyXG4gICAgT2JqZWN0LmtleXMoRWRzQ2xpZW50LnByb3RvdHlwZSkuZm9yRWFjaChtZXRob2QgPT4ge1xyXG4gICAgICBpZiAoaXNBcGlNZXRob2QobWV0aG9kKSkge1xyXG4gICAgICAgIHRoaXNbbWV0aG9kXSA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzW21ldGhvZF0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMuc3VzcGVuc2UgPSBtYWtlU3VzcGVuc2VBcGkodGhpcywge2lzQXBpTWV0aG9kfSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHByaXZhdGl6aW5nQ2FjaGVCdXN0KCkge1xyXG4gICAgcmV0dXJuIHt1c2VyOiB0aGlzLnVzZXJFbWFpbEdldHRlcigpfTtcclxuICB9XHJcblxyXG4vKipcclxuICAgKiBSZXRyaWV2ZSBhY3RpdmUgY291cnNlcyBmb3IgY3VycmVudCBsb2dnZWQgaW4gc3R1ZGVudC5cclxuICAgKlxyXG4gICAqIEBwYXJhbSBjb3Vyc2VDb2RlIFNob3J0LW5hbWUgb2YgdGhlIGNvdXJzZS4gT3B0aW9uYWwuXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0QWN0aXZlQ291cnNlcyhxOiB7Y291cnNlQ29kZT86IHN0cmluZywgcGVyaW9kTmFtZTogc3RyaW5nfSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcXVlcnk6YW55ID0gdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpO1xyXG4gICAgICBpZiAocSkge1xyXG4gICAgICAgIGlmIChxLmNvdXJzZUNvZGUpIHF1ZXJ5LkNvdXJzZUNvZGUgPSBxLmNvdXJzZUNvZGU7XHJcbiAgICAgICAgaWYgKHEucGVyaW9kTmFtZSkgcXVlcnkuUGVyaW9kTmFtZSA9IHEucGVyaW9kTmFtZTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwic3R1ZGVudGFjdGl2ZWNvdXJzZXNcIiwgcXVlcnkpO1xyXG4gICAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgICByZXR1cm4ganNvbi5jb3Vyc2VzIGFzIEVEU0NvdXJzZVtdO1xyXG4gICAgfSBjYXRjaCAoZXgpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZyb20gRURTOiBcIiArIGV4KTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKExgS3VuZGUgdHl2w6RyciBpbnRlIGxhZGRhIHRlcm1pbnNtw6VsIGVsbGVyIGF2a2xhcmFkZSBzdGVnIGZyw6VuIEVEUy4gRsO2cnPDtmsgaWdlbiBzZW5hcmUuLi5gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIGxhdGVzdCBhc3Nlc3NtZW50cyBmb3IgY3VycmVudCBsb2dnZWQgaW4gdXNlci5cclxuICAgKiBcclxuICAgKiBAcGFyYW0gbGltaXQgT3B0aW9uYWwgbGltaXRcclxuICAgKi9cclxuICBhc3luYyBnZXRMYXRlc3RBc3Nlc3NtZW50cyhsaW1pdD86IG51bWJlcikge1xyXG4gICAgY29uc3QgcXVlcnk6YW55ID0gdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpO1xyXG4gICAgaWYgKCFpc05hTihsaW1pdCkpIHF1ZXJ5LkNvdW50ID0gbGltaXQ7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwic3R1ZGVudGFzc2Vzc21lbnRzXCIsIHF1ZXJ5KTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24uYXNzZXNzbWVudHMgYXMgRURTQXNzZXNzbWVudFtdOyAgICBcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIHN0dWR5cGxhbnMgZm9yIGN1cnJlbnQgbG9nZ2VkLWluIHVzZXJcclxuICAgKi9cclxuICBhc3luYyBnZXRTdHVkZW50R29hbHMoKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwic3R1ZGVudGdvYWxzXCIsIHRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBqc29uLnN0dWRlbnRHb2FscyBhcyBFRFNTdHVkeVBsYW5bXTsgICAgXHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRTdHVkZW50RnV0dXJlQWJpbGl0aWVzKCkge1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRGdXR1cmVBYmlsaXRpZXNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEZ1dHVyZUFiaWxpdGllcyBhcyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMoKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwidGVhY2hlcnR1dG9yc3R1ZGVudHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudHMgYXMgRURTU3R1ZGVudFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0U2Nob29sVHVpdGlvbkdyb3VwcygpXHJcbiAgICogXHJcbiAgICogUmV0dXJuIHR1aXRpb25ncm91cHMgZm9yIHNjaG9vbFxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBzY2hvb2xOYW1lIC0gbmFtZSBvZiBzY2hvb2xcclxuICAgKiBAcGFyYW0gY291cnNlQ29kZSAtIFNrb2x2ZXJrZXRzIGNvZGUgZm9yIGNvdXJzZVxyXG4gICAqL1xyXG4gIGFzeW5jIGdldFNjaG9vbFR1aXRpb25Hcm91cHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgY291cnNlQ29kZTogc3RyaW5nfSkge1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcIlNjaG9vbFR1aXRpb25Hcm91cHNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zY2hvb2xUdWl0aW9uR3JvdXBzIGFzIEVEU1R1aXRpb25Hcm91cFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0VHVpdGlvbkdyb3VwU3R1ZGVudHMoKVxyXG4gICAqIFxyXG4gICAqIFJldHVybiBuYW1lIGFuZCBtYWlsYWRyZXNzZXMgZm9yIHR1dGl0aW9uZ3JvdXBzIGluIHNjaG9vbHNcclxuICAgKiBcclxuICAgKiBAcGFyYW0gc2Nob29sTmFtZSAtIG5hbWUgb2Ygc2Nob29sXHJcbiAgICogQHBhcmFtIHR1aXRpb25Hcm91cE5hbWUgLSB0dWl0aW9uIGdydW9wIG5hbWUgaW4gRURTXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0VHVpdGlvbkdyb3VwU3R1ZGVudHMocToge3NjaG9vbE5hbWU6IHN0cmluZywgdHVpdGlvbkdyb3VwTmFtZTogc3RyaW5nfSkge1xyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcIlR1aXRpb25Hcm91cFN0dWRlbnRzXCIsIHsuLi50aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCksIC4uLnF9KTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24udHVpdGlvbkdyb3VwU3R1ZGVudHMgYXMgRURTVHVpdGlvblN0dWRlbnRbXTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGdldFNjaG9vbFRlYWNoZXJzKClcclxuICAgKiBcclxuICAgKiBSZXR1cm4gbmFtZSBhbmQgbWFpbGFkcmVzc2VzIGZvciB0dXRpdGlvbmdyb3VwcyBpbiBzY2hvb2xzXHJcbiAgICogXHJcbiAgICogQHBhcmFtIHNjaG9vbE5hbWUgLSBuYW1lIG9mIHNjaG9vbFxyXG4gICAqL1xyXG4gIGFzeW5jIGdldFNjaG9vbFRlYWNoZXJzKHE6IHtzY2hvb2xOYW1lOiBzdHJpbmd9KSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiU2Nob29sVGVhY2hlcnNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zY2hvb2xUZWFjaGVycyBhcyBFRFNUZWFjaGVyW107XHJcbiAgfVxyXG4gIC8vIHdlIGFzc3VtZSB0aGF0IHRoZSBFRFMgd2lsbCByZXR1cm4gdGhlIGN1cnJlbnQgYWNhZGVtaWMgeWVhciBkYXRlcyBkZXRlcm1pbmVkIGJ5IHRoZSBjdXJyZW50IGRhdGVcclxuICBhc3luYyBnZXRBY2FkZW1pY1llYXJUZXJtcyhzY2hvb2xMb2NhbGU6IHN0cmluZywgZGF0ZTogRGF0ZSkge1xyXG4gICAgLy8gbW9jayBkYXRhXHJcbiAgICBzd2l0Y2ggKHNjaG9vbExvY2FsZSkge1xyXG4gICAgICBjYXNlICdlbl9zaW4nOlxyXG4gICAgICByZXR1cm4gbW9ja0pzb25GaWxlLlNvdXRoSW5kaWEuZmlsdGVyKGYgPT4gbW9tZW50KGRhdGUpLmlzU2FtZU9yQWZ0ZXIoZi5maXJzdFRlcm0uc3RhcnREYXRlKSAmJiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JCZWZvcmUoZi5zZWNvbmRUZXJtLmVuZERhdGUpKVswXSBhcyBNb2NrRURTQWNhZGVtaWNZZWFyO1xyXG4gICAgICBjYXNlICdlbl9uaW4nOlxyXG4gICAgICByZXR1cm4gbW9ja0pzb25GaWxlLk5vcnRoSW5kaWEuZmlsdGVyKGYgPT4gbW9tZW50KGRhdGUpLmlzU2FtZU9yQWZ0ZXIoZi5maXJzdFRlcm0uc3RhcnREYXRlKSAmJiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JCZWZvcmUoZi5zZWNvbmRUZXJtLmVuZERhdGUpKVswXSBhcyBNb2NrRURTQWNhZGVtaWNZZWFyO1xyXG4gICAgICBjYXNlICdzdic6XHJcbiAgICAgIHtcclxuICAgICAgdmFyIGhvbGlkYXlzID0gW10gYXMgTW9ja0VEU0RhdGVSYW5nZVtdO1xyXG4gICAgICB2YXIgZmlyc3RUZXJtTW9tZW50ID0gZ2V0VGVybVN0YXJFbmREYXRlKGRhdGUsIHRydWUpO1xyXG4gICAgICB2YXIgc2Vjb25kVGVybU1vbWVudCA9IGdldFRlcm1TdGFyRW5kRGF0ZShkYXRlLCBmYWxzZSk7XHJcblxyXG4gICAgICB2YXIgc3RhcnRGaXJzdFRlcm1EYXRlID0gZmlyc3RUZXJtTW9tZW50WzBdO1xyXG4gICAgICB2YXIgc3RhcnRTZWNvbmRUZXJtRGF0ZSA9IHNlY29uZFRlcm1Nb21lbnRbMF07XHJcbiAgICAgIHZhciBlbmRGaXJzdFRlcm1EYXRlID0gZmlyc3RUZXJtTW9tZW50WzFdO1xyXG4gICAgICB2YXIgZW5kU2Vjb25kVGVybURhdGUgPSBzZWNvbmRUZXJtTW9tZW50WzFdO1xyXG5cclxuICAgICAgY29uc3QgZmlyc3RUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoc3RhcnRGaXJzdFRlcm1EYXRlLnllYXIoKSwgc3RhcnRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIHN0YXJ0Rmlyc3RUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShzdGFydEZpcnN0VGVybURhdGUueWVhcigpLCBlbmRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIGVuZEZpcnN0VGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XHJcbiAgICAgIGNvbnN0IHNlY29uZFRlcm0gPSB7c3RhcnREYXRlOiBuZXcgRGF0ZShzdGFydFNlY29uZFRlcm1EYXRlLnllYXIoKSwgc3RhcnRTZWNvbmRUZXJtRGF0ZS5tb250aCgpLCBzdGFydFNlY29uZFRlcm1EYXRlLmRhdGUoKSkudG9EYXRlU3RyaW5nKCksIGVuZERhdGU6IG5ldyBEYXRlKHN0YXJ0U2Vjb25kVGVybURhdGUueWVhcigpLCBlbmRTZWNvbmRUZXJtRGF0ZS5tb250aCgpLCBlbmRTZWNvbmRUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpfTtcclxuICAgICAgcmV0dXJuIHtmaXJzdFRlcm0sIHNlY29uZFRlcm0sIGhvbGlkYXlzfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgRURTUGVyaW9kIHtcclxuICBwZXJpb2Q6IHN0cmluZztcclxuICB0ZXJtOiAnQVQnIHwgJ1NUJztcclxuICB5ZWFyOiBudW1iZXI7XHJcbiAgY29uc3RydWN0b3IgKHBlcmlvZFN0cmluZ09yU2Nob29sVGVybTogc3RyaW5nIHwgU2Nob29sTW9tZW50KSB7XHJcbiAgICBpZiAodHlwZW9mIHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgdGhpcy5wZXJpb2QgPSBwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm07XHJcbiAgICAgIHRoaXMudGVybSA9IHRoaXMucGVyaW9kLnN0YXJ0c1dpdGgoJ0hUJykgPyAnQVQnIDogJ1NUJztcclxuICAgICAgdGhpcy55ZWFyID0gcGFyc2VJbnQodGhpcy5wZXJpb2Quc3Vic3RyKDIpKTtcclxuICAgICAgaWYgKGlzTmFOKHRoaXMueWVhcikpIHRocm93IG5ldyBFcnJvciAoYEludmFsaWQgcGVyaW9kOiAke3RoaXMucGVyaW9kfWApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3Qgc2Nob29sVGVybSA9IG5ldyBTY2hvb2xUZXJtKHBlcmlvZFN0cmluZ09yU2Nob29sVGVybSk7XHJcbiAgICAgIHRoaXMucGVyaW9kID0gKHNjaG9vbFRlcm0udGVybSA9PT0gJ0FUJyA/IFwiSFRcIiA6IFwiVlRcIikgKyBzY2hvb2xUZXJtLnllYXI7XHJcbiAgICAgIHRoaXMudGVybSA9IHNjaG9vbFRlcm0udGVybTtcclxuICAgICAgdGhpcy55ZWFyID0gc2Nob29sVGVybS55ZWFyO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2V0IHNjaG9vbFRlcm0gKCkgOiBTY2hvb2xUZXJtIHtcclxuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh7XHJcbiAgICAgIGFjYWRlbWljWWVhcjogdGhpcy50ZXJtID09PSAnQVQnID9cclxuICAgICAgICBgJHt0aGlzLnllYXJ9LyR7dGhpcy55ZWFyICsgMX1gIDpcclxuICAgICAgICBgJHt0aGlzLnllYXItMX0vJHt0aGlzLnllYXJ9YCxcclxuICAgICAgdGVybTogdGhpcy50ZXJtXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucGVyaW9kO1xyXG4gIH1cclxuXHJcbiAgdmFsdWVPZigpIHtcclxuICAgIHJldHVybiB0aGlzLnllYXIgKyBcIjpcIiArICh0aGlzLnRlcm0gPT09ICdTVCcgPyBcIjFcIiA6IFwiMlwiKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25EYXRlX29sZCAoanNvbkRhdGVTdHI6IHN0cmluZykgOiBEYXRlIHtcclxuICBjb25zdCBkYXRlID0gZGF0ZVRpbWVSZXZpdmVyKFwiXCIsIGpzb25EYXRlU3RyKTtcclxuICBpZiAoIShkYXRlIGluc3RhbmNlb2YgRGF0ZSkpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgSlNPTiBkYXRlIHN0cmluZzogXCIgKyBqc29uRGF0ZVN0cik7XHJcbiAgcmV0dXJuIGRhdGU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGF2b2lkU2ltdWx0YW5vdXNDYWxsczxULEE+KG1ldGhvZDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPikgOiAoLi4uYXJnczpBW10pPT5Qcm9taXNlPFQ+IHtcclxuICBsZXQgb25nb2luZ1Byb21pc2VzOiB7W2FyZ3NKc29uOiBzdHJpbmddOiBQcm9taXNlPFQ+fSA9IHt9O1xyXG4gIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgIGNvbnN0IGFyZ3NKc29uID0gSlNPTi5zdHJpbmdpZnkoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcclxuICAgIGlmICghb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXSkge1xyXG4gICAgICBvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dID0gbWV0aG9kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihyZXN1bHQ9PntcclxuICAgICAgICBkZWxldGUgb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBvbmdvaW5nUHJvbWlzZXNbYXJnc0pzb25dO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBHb29nbGVXZWJDbGllbnQgfSBmcm9tICcuL2dvb2dsZS13ZWJjbGllbnQnO1xyXG5pbXBvcnQgeyBtb2NrVHVpdGlvblN0dWRlbnRzIH0gZnJvbSAnLi9tb2NrL21vY2stY2xhc3Nyb29tLWRhdGEnO1xyXG5pbXBvcnQgeyBFRFNUdWl0aW9uU3R1ZGVudCB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xyXG5pbXBvcnQgeyBlbnYgfSBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5cclxuaW50ZXJmYWNlIEdBU0ZpZWxkcyB7XHJcbiAgZnVuY3Rpb246IHN0cmluZztcclxuICBwYXJhbWV0ZXJzPzogYW55W107XHJcbiAgZGV2TW9kZT86IGJvb2xlYW47XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBcclxuKi9cclxuZXhwb3J0IGNsYXNzIENsYXNzcm9vbVN5bmMgZXh0ZW5kcyBHb29nbGVXZWJDbGllbnQge1xyXG4gIFxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoWydodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2RyaXZlJyxcclxuICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5jb3Vyc2VzJyxcclxuICAgICdodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NsYXNzcm9vbS5wcm9maWxlLnBob3RvcycsXHJcbiAgICAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jbGFzc3Jvb20ucHJvZmlsZS5lbWFpbHMnLFxyXG4gICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLnJvc3RlcnMnLFxyXG4gICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2xhc3Nyb29tLmNvdXJzZXdvcmsuc3R1ZGVudHMnLFxyXG4gICAgJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvc2NyaXB0LmV4dGVybmFsX3JlcXVlc3QnXHJcbiAgXSk7XHJcbn1cclxuXHJcbi8qKlxyXG4qIFxyXG4qIEBwYXJhbSBmdW5jIGZ1bmN0aW9uIG5hbWUgdG8gY2FsbCBpbiBDbGFzc3Jvb21TZXJ2aWNlXHJcbiogQHBhcmFtIHBhcmFtcyBvcHRpb25hbCBwYXJhbWV0ZXJzIHRvIHNlbmQgdG8gZnVuY3Rpb25cclxuKiBcclxuKiBDYWxscyB0aGUgcmVsZXZhbnQgZnVuY2l0b24gaW4gQ2xhc3Nyb29tU2VydmljZVxyXG4qIFRoZSBwYXJhbWF0ZXJzIG11c3QgYmUgd2hhdCBpcyBleHBlY3RlZCBpbiB0aGUgY2FsbGVkIGZ1bmN0aW9uXHJcbiogaW4gQ2xhc3Nyb29tU2VydmljZSBhbmQgY2FuIG9ubHkgYmUgYmFzaWMgdHlwZXM6IHN0cmluZyxcclxuKiBudW1iZXIsIG9iamVjdCBvciBib29sZWFuLlxyXG4qIFxyXG4qL1xyXG5hc3luYyBjYWxsU3luYyhmdW5jOnN0cmluZywgcGFyYW1zPzphbnlbXSkge1xyXG4gIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGVkKCk7XHJcbiAgXHJcbiAgY29uc3QgZGF0YTpHQVNGaWVsZHMgPSBwYXJhbXM/IHtcclxuICAgICdmdW5jdGlvbic6IGZ1bmMsXHJcbiAgICAncGFyYW1ldGVycyc6IHBhcmFtc1xyXG4gIH0gOiB7XHJcbiAgICAnZnVuY3Rpb24nOiBmdW5jXHJcbiAgfTtcclxuICBcclxuICAvLyB1c2luZyBkZXYtbW9kZSByaWdodCBub3cgc28gd2Ugb25seSBuZWVkIHRvIHJ1biBjbGFzcCBwdXNoIG9uIENsYXNzcm9vbVNlcnZpY2VcclxuICBkYXRhLmRldk1vZGUgPSB0cnVlO1xyXG4gIFxyXG4gIHJldHVybiBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9zY3JpcHQuZ29vZ2xlYXBpcy5jb20vdjEvc2NyaXB0cy9NMUgwQmxUa3Y5ODNQTlZUSmpEWGpOcVhMeG1RaUJnR3o6cnVuP2FsdD1qc29uJywge1xyXG4gIG1ldGhvZDogJ3Bvc3QnLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgJ0F1dGhvcml6YXRpb24nOiAnQmVhcmVyICcgKyB0aGlzLmF1dGhUb2tlblxyXG4gIH0sXHJcbiAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcclxufSkudGhlbihcclxuICByZXNwID0+IHJlc3AuanNvbigpXHJcbiAgKTtcclxufVxyXG5cclxuLyoqXHJcbiogXHJcbiogQHBhcmFtIHBhcmFtMCBcclxuKi9cclxuYXN5bmMgaW5pdFN5bmMoY291cnNlLCBvcmlnQ291cnNlLCBmdWxsU3luY05lZWRlZCkge1xyXG4gIFxyXG4gIC8vIE1vY2stZGF0YSBmb3IgS0VEXHJcbiAgY29uc3QgZW1wdHlPck1vY2sgPSB7fTtcclxuICBcclxuICBpZiAoY291cnNlLnNjaG9vbCA9PT0gJ0tFRCcpIHtcclxuICAgIGZvciAoY29uc3QgZ3JvdXAgb2YgY291cnNlLnN0dWR5R3JvdXBzKSB7XHJcbiAgICAgIGVtcHR5T3JNb2NrW2dyb3VwXSA9IG1vY2tUdWl0aW9uU3R1ZGVudHNbZ3JvdXBdPyBtb2NrVHVpdGlvblN0dWRlbnRzW2dyb3VwXS5tYXAocyA9PiBzLnN0dWRlbnRFbWFpbEFkZHJlc3MpIDogW107XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIC0tIG1vY2tcclxuICBcclxuICAvLyBHZXQgZWRzU2Nob29sTmFtZSBmcm9tIEtlZEJhY2tlbmQ6XHJcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHAuZ2V0KCdzY2hvb2xzJywgeydjYWNoZUJ1c3QnOiAnc3RhdGljJywgJ25hbWUnOiBjb3Vyc2Uuc2Nob29sfSkudGhlbihyZXNwID0+ICByZXNwLmpzb24oKSk7XHJcbiAgY29uc3Qge2Vkc1NjaG9vbE5hbWVHeW1ufSA9IGRhdGFbMF07XHJcbiAgXHJcbiAgY29uc3QgZWRzU3R1ZGVudHMgPSBlZHNTY2hvb2xOYW1lR3ltbj8ge30gOiBlbXB0eU9yTW9jaztcclxuICBcclxuICAvLyBHZXQgYW5kIG1lcmdlIHN0dWRlbnRzIGZyb20gRURTIHR1aXRpb24gZ3JvdXBzOlxyXG4gIGlmIChjb3Vyc2Uuc3R1ZHlHcm91cHMpIHtcclxuICAgIGlmIChlZHNTY2hvb2xOYW1lR3ltbikge1xyXG4gICAgICBmb3IgKGNvbnN0IGdyb3VwIG9mIGNvdXJzZS5zdHVkeUdyb3Vwcykge1xyXG4gICAgICAgIGNvbnN0IHR1aXRpb25Hcm91cFN0dWRlbnRzOiBFRFNUdWl0aW9uU3R1ZGVudFtdID0gYXdhaXQgZW52LmVkc0NsaWVudC5nZXRUdWl0aW9uR3JvdXBTdHVkZW50cyh7c2Nob29sTmFtZTogZWRzU2Nob29sTmFtZUd5bW4sIHR1aXRpb25Hcm91cE5hbWU6IGdyb3VwfSlcclxuICAgICAgICBlZHNTdHVkZW50c1tncm91cF3CoD0gdHVpdGlvbkdyb3VwU3R1ZGVudHMubWFwKHMgPT4gcy5zdHVkZW50RW1haWxBZGRyZXNzKTtcclxuICAgICAgfVxyXG4gICAgfSBcclxuICB9XHJcbiAgXHJcbiAgLy8gY3JlYXRlIGEgc3Vic2V0IG9mIHRoZSBjb3Vyc2UgYWFuZCBjYWFsY3VsYXRlIGNoYW5nZXNcclxuICBjb25zdCB7c3Vic2V0LCBjaGFuZ2VzLCBhY3Rpb259ID0gdGhpcy5kaWZmQ291cnNlKGNvdXJzZSwgb3JpZ0NvdXJzZSwgZnVsbFN5bmNOZWVkZWQpO1xyXG4gIFxyXG4gIC8vIHNlbmQgdGhlIGNoYW5nZXMgdG8gY2xhc3Nyb29tLXNlcnZpY2Ugd2l0aCB7aWQsIHNjaG9vbCBjb2RlfSB0byB1cGRhdGUgY2xhc3Nyb29tc1xyXG4gIC8vIHNob3VsZCB3ZSBzZW5kIHRoZSB1c2VycyBmcm9tIHRoZSBncm91cHMgb3Igc2hvdWxkIGNsYXNzcm9vbS1zZXJ2aWNlIGdldCB0aGVzZSBmcm9tIEVEUz9cclxuICAvLyBpZiB3ZSBoYW5kbGUgdXNlcnMgaW4ga2VkY29tcG9uZW50cyBhIGNoZWNrIGlmIHRoZXJlIGFyZSBjaGFuZ2VzIHNob3VsZCBwcm9iYWJseSBiZSBtYWRlP1xyXG4gIGNvbnNvbGUubG9nKHN1YnNldCk7XHJcbiAgY29uc29sZS5sb2coY2hhbmdlcyk7XHJcbiAgY29uc29sZS5sb2coZWRzU3R1ZGVudHMpO1xyXG4gIGlmIChhY3Rpb24gPT0gJ2Z1bGwnKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVDbGFzc3Jvb20oc3Vic2V0LCBlZHNTdHVkZW50cyk7XHJcbiAgfSBlbHNlIGlmIChhY3Rpb24gPT0gJ3VwZGF0ZScpIHtcclxuICAgIHJldHVybiB0aGlzLnVwZGF0ZUNsYXNzcm9vbShzdWJzZXQsIGNoYW5nZXMsIGVkc1N0dWRlbnRzKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5hc3luYyBhcmNoaXZlKGNvdXJzZSkge1xyXG4gIGNvbnNvbGUubG9nKCdhcmNoaXZpbmcnKTtcclxuICB0aGlzLmNhbGxTeW5jKCdhcmNoaXZlJywgW2NvdXJzZS5pZCwgY291cnNlLnN0dWR5R3JvdXBzXSk7XHJcbn1cclxuXHJcblxyXG4vKipcclxuKiBcclxuKiBAcGFyYW0gY291cnNlIGN1cnJlbnQgY291cnNlIHN0YXRlXHJcbiogQHBhcmFtIG9yaWdDb3Vyc2UgcHJldmlvdXMgY291cnNlIHN0YXRlXHJcbiogXHJcbiogQ3JlYXRlcyBhIHN1YnNldCBvZiBjb3Vyc2UgYW5kIG1hYWtlcyBhIGRpZmYgYWdhaW5zdCBwcmV2aW91cyBjb3Vyc2Ugc3RhdGVcclxuKiBOb3RlOiB0aGVyZSBhcmUgcHJvYmFibHkgbW9yZSB3ZSBjb3VsZCBmaWx0ZXIgb3V0IGJlZm9yZSBzZW5kaW5nIHRvIENsYXNhc3Jvb21TZXJ2aWNlXHJcbiovXHJcbmRpZmZDb3Vyc2UoY291cnNlLCBvcmlnQ291cnNlLCBmdWxsU3luY05lZWRlZCkge1xyXG4gIC8vIEZpbHRlciBvdXQgYXNzaWdubWVudHMgZnJvbSB0YXNrcyBhbmQgc3Vic2V0IHRvIG9ubHkgcHJvcGVydGllcyB3ZSBhcmUgaW50ZXJlc3RlZCBpblxyXG4gIGNvbnN0IHN1YnNldEFzc2lnbm1lbnRzID0gKHRhc2tzKSA9PiB7XHJcbiAgICBjb25zdCBhc3NpZ25tZW50cyA9IHRhc2tzLmZpbHRlcih0ID0+IHQuYXNzaWdubWVudCA9PT0gdHJ1ZSk7XHJcbiAgICByZXR1cm4gYXNzaWdubWVudHMubWFwKHQgPT4ge1xyXG4gICAgICBjb25zdCB7YXNzaWdubWVudCwgZGVhZGxpbmUsIGlkLCBuYW1lfSA9IHQ7XHJcbiAgICAgIHJldHVybiB7YXNzaWdubWVudCwgZGVhZGxpbmUsIGlkLCBuYW1lfTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICAvLyBDYWxjdWxhdGVzIHdoYXRzIGJlZW4gYWRkZWQgYW5kIHJlbW92ZWQgYmV0d2VlbnMgY2hhbmdlcyB0byBhbiBhcnJheS5cclxuICAvLyBOb3RlOiBQZXJoYXBzIHdlIHNob3VsZCByZXR1cm4gZmFsc2UgaWYgbm8gY2hhbmdlcz9cclxuICBjb25zdCBkaWZmQXJyYXlzID0gZnVsbFN5bmNOZWVkZWQgPyBudWxsIDogKGFycjE6IEFycmF5PGFueT4sIGFycjI6IEFycmF5PGFueT4pOiB7YWRkZWQ6IEFycmF5PGFueT4sIHJlbW92ZWQ6IEFycmF5PGFueT59IHwgYm9vbGVhbiA9PiB7XHJcbiAgICBjb25zdCBhcnIxc2V0ID0gbmV3IFNldChhcnIxKTtcclxuICAgIGNvbnN0IGFycjJzZXQgPSBuZXcgU2V0KGFycjIpO1xyXG4gICAgY29uc3QgY2hhbmdlcyA9IHtcclxuICAgICAgYWRkZWQ6IGFycjIuZmlsdGVyKCh4KSA9PiAhYXJyMXNldC5oYXMoeCkpLFxyXG4gICAgICByZW1vdmVkOiBhcnIxLmZpbHRlcigoeCkgPT4gIWFycjJzZXQuaGFzKHgpKSxcclxuICAgIH1cclxuICAgIHJldHVybiAoY2hhbmdlcy5hZGRlZC5sZW5ndGggPiAwIHx8IGNoYW5nZXMucmVtb3ZlZC5sZW5ndGggPiAwKSA/IGNoYW5nZXMgOiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgLy8gY3JlYXRlIHRoZSBzdWJzZXQgb2YgY291cnNlXHJcbiAgY29uc3Qgc3Vic2V0ID0gKCh7XHJcbiAgICBpZCxcclxuICAgIHNjaG9vbCxcclxuICAgIGNvZGUsXHJcbiAgICBuYW1lLFxyXG4gICAgZGVzY3JpcHRpb24sXHJcbiAgICB0YXNrcyxcclxuICAgIHJlc3BvbnNpYmxlVGVhY2hlcnMsXHJcbiAgICBzdHVkeUdyb3Vwc30pID0+ICh7IFxyXG4gICAgICBpZCxcclxuICAgICAgc2Nob29sLFxyXG4gICAgICBjb2RlLFxyXG4gICAgICBuYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgdGFza3MsXHJcbiAgICAgIHJlc3BvbnNpYmxlVGVhY2hlcnMsXHJcbiAgICAgIHN0dWR5R3JvdXBzfSlcclxuICAgICAgKShjb3Vyc2UpO1xyXG4gICAgICBcclxuICAgICAgLy8gb25seSBoYW5kbGUgdHNha3MgdGhhdCBhcmUgYWFzc2lnbm1lbnRzXHJcbiAgICAgIChzdWJzZXQudGFza3MgYXMgYW55W10pID0gc3Vic2V0QXNzaWdubWVudHMoc3Vic2V0LnRhc2tzKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChmdWxsU3luY05lZWRlZCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdDbGFzc3Jvb20gc3dpdGNoZWQgb24gc28gc3luYyBldmVyeXRoaW5nJyk7XHJcbiAgICAgICAgLy8gU2VuZCBzdWJzZXQgdG8gY2xhc3Nyb29tLXNlcnZpY2UgdG8gY3JlYXRlIHRoZSBjbGFzc3Jvb21zXHJcbiAgICAgICAgcmV0dXJuIHtzdWJzZXQsIGNoYW5nZXM6IHt9LCBhY3Rpb246IFwiZnVsbFwifTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnRGF0YSBoYXMgYmVlbiB1cGRhdGVkIHNvIGNhbGN1bGF0ZSBhbmQgc3luYyBjaGFuZ2VzJyk7XHJcbiAgICAgICAgY29uc3QgY2hhbmdlcyA9IHtcclxuICAgICAgICAgIG5hbWU6IChvcmlnQ291cnNlLm5hbWUgIT09IGNvdXJzZS5uYW1lKT8gY291cnNlLm5hbWUgOiBmYWxzZSxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAob3JpZ0NvdXJzZS5kZXNjcmlwdGlvbiAhPT0gY291cnNlLmRlc2NyaXB0aW9uKT8gY291cnNlLmRlc2NyaXB0aW9uIDogZmFsc2UsXHJcbiAgICAgICAgICB0YXNrczogZGlmZkFycmF5cyhzdWJzZXRBc3NpZ25tZW50cyhvcmlnQ291cnNlLnRhc2tzKSwgc3Vic2V0LnRhc2tzKSxcclxuICAgICAgICAgIHJlc3BvbnNpYmxlVGVhY2hlcnM6IGRpZmZBcnJheXMob3JpZ0NvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzLm1hcCh0ID0+IHQudXJsKSwgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMubWFwKHQgPT4gdC51cmwpKSxcclxuICAgICAgICAgIHN0dWR5R3JvdXBzOiBvcmlnQ291cnNlLnN0dWR5R3JvdXBzPyBkaWZmQXJyYXlzKG9yaWdDb3Vyc2Uuc3R1ZHlHcm91cHMsIGNvdXJzZS5zdHVkeUdyb3Vwcyk6IGZhbHNlLFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge3N1YnNldCwgY2hhbmdlcywgYWN0aW9uOiBcInVwZGF0ZVwifTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhc3luYyBjcmVhdGVDbGFzc3Jvb20oY291cnNlLCBzdHVkeUdyb3Vwcykge1xyXG4gICAgICByZXR1cm4gdGhpcy5jYWxsU3luYygnY3JlYXRlQ2xhc3Nyb29tcycsIFtjb3Vyc2UsIHN0dWR5R3JvdXBzXSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFzeW5jIHVwZGF0ZUNsYXNzcm9vbShjb3Vyc2UsIGNoYW5nZXMsIHN0dWR5R3JvdXBzKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNhbGxTeW5jKCd1cGRhdGVDbGFzc3Jvb21zJywgW2NvdXJzZSwgY2hhbmdlcywgc3R1ZHlHcm91cHNdKTtcclxuICAgIH0gICBcclxuICB9XHJcbiAgIiwiaW1wb3J0IHsgR29vZ2xlV2ViQ2xpZW50IH0gZnJvbSAnLi9nb29nbGUtd2ViY2xpZW50JztcclxuXHJcbmludGVyZmFjZSBvcHRpb25zIHtcclxuICB1cGxvYWQ/OiBib29sZWFuO1xyXG4gIG11bHRpcGxlPzogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIHNlbGVjdGVkRmlsZSB7XHJcbiAgZmlsZUlkOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgbWltZVR5cGU6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgbW9kaWZpZWRUaW1lOiBudW1iZXI7XHJcbiAgY2FuRXhwb3J0OiBib29sZWFuO1xyXG4gIGljb25Vcmw/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBkb3dubG9hZEFyZ3Mge1xyXG4gIGZpbGU6IHNlbGVjdGVkRmlsZTtcclxuICBsaW1pdFNpemU/OiBudW1iZXI7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogR29vZ2xlUGlja2VyXHJcbiAqIEluY2x1ZGVzIHRoZSBpbml0aWF0aW9uIG9mIHRoZSBjb3JyZWN0IGFwaTpzLlxyXG4gKiBDZXJ0YWluIG9wdGlvbnMgY2FuIGJlIHBhc3NlZCB0byB0aGUgY29uc3RydWN0b3JcclxuICogYW5kIHRoZXJlIGNvdWxkIGJlIG90aGVycyB3b3J0aCBpbmNvcnBvcmF0aW5nIChpLmUuIFRlYW0gRHJpdmUtc3VwcG9ydCkuXHJcbiAqIFxyXG4gKiBSaWdodCBub3cgdHdvIG9wdGlvbnMgYXJlIGhhbmRsZWQ6XHJcbiAqIC0gdXBsb2FkOiBpZiBhIHVzZXIgY2FuIHVwbG9hZCB0byBEcml2ZSBpbiB0aGUgR29vZ2xlIERyaXZlIFBpY2tlclxyXG4gKiAtIG11bHRpcGxlOiBpZiBhIHVzZXIgY2FuIHNlbGVjdCBtdWx0aXBsZSBmaWxlc1xyXG4gKiBcclxuICogV2UgY291bGQgcHJvYmFibHkgc3BsaXQgdGhpcyBpbnRvIGdvb2dsZS1waWNrZXIgYW5kIGdvb2dsZS1kcml2ZSB3aGVyZSBnb29nbGUtZHJpdmVcclxuICogaGFuZGxlcyB0aGUgZXhwbGljaXQgY2FsbHMgdG8gdGhlIGdvb2dsZSBkcml2ZSBhcGkuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgR29vZ2xlUGlja2VyIGV4dGVuZHMgR29vZ2xlV2ViQ2xpZW50IHtcclxuICBwaWNrZXI6IGdvb2dsZS5waWNrZXIuUGlja2VyO1xyXG4gIG9wdGlvbnM6IG9wdGlvbnM7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBvcHRpb25zKSB7XHJcbiAgICBzdXBlcihbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvZHJpdmUnXSk7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt1cGxvYWQ6IGZhbHNlLCBtdWx0aXBsZTogZmFsc2V9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogc2hvdygpXHJcbiAgICogXHJcbiAgICogSWYgYSBzaW5nbGUgZmlsZSBpcyByZXF1ZXN0ZWQgZnJvbSB0aGUgcGlja2VyIGEgbGlzdCBvZiBmaWxlcyB3aXRoIG9uZSBlbGVtZW50IGlzIHJldHVybmVkLlxyXG4gICAqIEl0IGlzIHVwIHRvIHRoZSBjYWxsZXIgdG8gaGFuZGxlIHRoZSBsaXN0IGluIGEgcmVsZXZhbnQgbWFubmVyLlxyXG4gICAqIFxyXG4gICAqIE1vcmUgZGF0YSBmcm9tIHRoZSBmaWxlIGNvdWxkIGJlIGV4dHJhY3RlZCBpZiBpdCBpcyBkZWVtZWQgbmVjZXNzYXJ5LlxyXG4gICAqIFxyXG4gICAqL1xyXG4gIGFzeW5jIHNob3coKSB7XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRlZCgpO1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHNlbGVjdGVkRmlsZVtdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlWydhY3Rpb24nXSA9PSBnb29nbGUucGlja2VyLkFjdGlvbi5DQU5DRUwpIHtcclxuICAgICAgICAgICAgcmVqZWN0KCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZVsnYWN0aW9uJ10gPT0gZ29vZ2xlLnBpY2tlci5BY3Rpb24uUElDS0VEKSB7XHJcbiAgICAgICAgICBsZXQgc2VsZWN0ZWQgPSBbXTtcclxuICAgICAgICAgIHJlc3BvbnNlLmRvY3MuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHtpZDogZmlsZUlkLCBtaW1lVHlwZSwgbmFtZSwgbW9kaWZpZWRUaW1lLCBpY29uVXJsLCB1cmx9ID0gZG9jO1xyXG4gICAgICAgICAgICBjb25zdCBjYW5FeHBvcnQgPSBtaW1lVHlwZS5pbmNsdWRlcygnZ29vZ2xlLWFwcHMnKTtcclxuICAgICAgICAgICAgc2VsZWN0ZWQucHVzaCh7ZmlsZUlkLCBtaW1lVHlwZSwgbmFtZSwgbW9kaWZpZWRUaW1lLCBjYW5FeHBvcnQsIGljb25VcmwsIHVybH0pO1xyXG4gICAgICAgICAgICAvLyB1cGRhdGUgcGVybWlzc2lvbnMgdG8gcmVhZCBieSBhbGwgaW4gZG9tYWluXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUGVybWlzc2lvbnMoZmlsZUlkKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coc2VsZWN0ZWQpO1xyXG4gICAgICAgICAgcmVzb2x2ZShzZWxlY3RlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcGlja2VyYnVpbGRlciA9IG5ldyBnb29nbGUucGlja2VyLlBpY2tlckJ1aWxkZXIoKVxyXG4gICAgICAgIC5hZGRWaWV3KFxyXG4gICAgICAgICAgbmV3IGdvb2dsZS5waWNrZXIuRG9jc1ZpZXcoKVxyXG4gICAgICAgICAgICAuc2V0T3duZWRCeU1lKHRydWUpIC8vIHNob3VsZCB0aGlzIGJlIGFuIG9wdGlvbj9cclxuICAgICAgICAgICAgLnNldEluY2x1ZGVGb2xkZXJzKHRydWUpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIC5zZXRMb2NhbGUoXCJzdlwiKSAvLyBzaG91bGQgdGhpcyBiZSBhbiBvcHRpb24/XHJcbiAgICAgICAgLnNldFNpemUoMTA1MSw2NTApIC8vIHNob3VsZCB0aGlzIGJlIGFuIG9wdGlvbj9cclxuICAgICAgICAuc2V0T0F1dGhUb2tlbih0aGlzLmF1dGhUb2tlbikgLy8gdGVtcFxyXG4gICAgICAgIC5zZXRDYWxsYmFjayhjYWxsYmFjayk7XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudXBsb2FkKSB7XHJcbiAgICAgICAgcGlja2VyYnVpbGRlci5hZGRWaWV3KG5ldyBnb29nbGUucGlja2VyLkRvY3NVcGxvYWRWaWV3KCkuc2V0SW5jbHVkZUZvbGRlcnModHJ1ZSkpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMubXVsdGlwbGUpIHtcclxuICAgICAgICBwaWNrZXJidWlsZGVyLmVuYWJsZUZlYXR1cmUoZ29vZ2xlLnBpY2tlci5GZWF0dXJlLk1VTFRJU0VMRUNUX0VOQUJMRUQpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMucGlja2VyID0gcGlja2VyYnVpbGRlci5idWlsZCgpO1xyXG4gICAgICB0aGlzLnBpY2tlci5zZXRWaXNpYmxlKHRydWUpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiB1cGRhdGVQZXJtaXNzaW9ucygpXHJcbiAgICogXHJcbiAgICogQHBhcmFtIGZpbGVJZCBcclxuICAgKiBcclxuICAgKiBNYWtlIHRoZSBmaWxlIGFjY2Vzc2libGUgdG8gYWxsIGluIHRoZSBkb21haW4uIFNob3VsZCBiZSB1bm5lY2Vzc2FyeSBidXQgc29tZVxyXG4gICAqIHRlYWNoZXJzIGhhdmUgY2hhbmdlZCB0aGVpciBkZWZhdWx0IHBlcm1pc3Npb25zLlxyXG4gICAqIFdlIGRvbid0IGNhcmUgcmlnaHQgbm93IGlmIHRoaXMgZmFpbHMgYmVjYXVzZSB0aGlzIGlzIGp1c3QgYW4gZXh0cmEgcHJlY2F1dGlvbi5cclxuICAgKiBJZiB3ZSBwbGFuIG9uIHVzaW5nIHRoaXMgb24gb3RoZXIgZG9tYWlucyB0aGUgZG9tYWluLWF0dHJpYnV0ZSBuZWVkcyB0byBiZSBkeW5hbWljLlxyXG4gICAqIFxyXG4gICAqL1xyXG4gIGFzeW5jIHVwZGF0ZVBlcm1pc3Npb25zKGZpbGVJZCkge1xyXG4gICAgYXdhaXQgZ2FwaS5jbGllbnQuaW5pdCh7XHJcbiAgICAgIGRpc2NvdmVyeURvY3M6IFtcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2Rpc2NvdmVyeS92MS9hcGlzL2RyaXZlL3YzL3Jlc3RcIl1cclxuICAgIH0pO1xyXG4gICAgZ2FwaS5jbGllbnQuZHJpdmUucGVybWlzc2lvbnMuY3JlYXRlKDxhbnk+e1xyXG4gICAgICBmaWxlSWQ6IGZpbGVJZCxcclxuICAgICAgc2VuZE5vdGlmaWNhdGlvbkVtYWlsOiBmYWxzZSxcclxuICAgICAgcm9sZTogJ3JlYWRlcicsXHJcbiAgICAgIHR5cGU6ICdkb21haW4nLFxyXG4gICAgICBkb21haW46ICdrdW5za2Fwc3Nrb2xhbi5zZSdcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIGRvd25sb2FkRmlsZSgpXHJcbiAgICogQHBhcmFtIGZpbGUgXHJcbiAgICogXHJcbiAgICogV2hlbiBDbGFzc3Jvb20gaGFzIGJlZW4gaW50ZWdyYXRlZCB3ZSB3aWxsIHdhbnQgdG8gaGFuZGxlIG9ubHkgdGhlIGZpbGVJZDpzXHJcbiAgICogc28gdGhhdCBlZGl0aW5nIGNhcGFiaWxpdGllcyBhcmUgcGVzZXJ2ZWQgb24gdGhlIGZpbGUgKGlmIGl0IGlzIGEgZ29vZ2xlLWFwcHMgZmlsZSlcclxuICAgKiBSaWdodCBub3cgZ29vZ2xlLWFwcHMgZmlsZXMgYXJlIGNvbnZlcnRlZCB0byBwZGYgYW5kIHBhc3NlZCBpbnRvIHRoZSBjdXJyZW50IGZsb3cuXHJcbiAgICogXHJcbiAgICogVE9ETzogZXJyb3IgaGFuZGxpbmdcclxuICAgKi9cclxuXHJcbiAgYXN5bmMgZG93bmxvYWRGaWxlKHtmaWxlLCBsaW1pdFNpemV9KSB7XHJcbiAgICAvLyBBIGZpbGUgdGhhdCBjYW4gYmUgZXhwb3J0ZWQgdG8gUERGIGlzIHJldHJlaXZlZCB3aXRoXHJcbiAgICAvLyBmaWxlLmV4cG9ydCgpIGZyb20gRHJpdmUsIGNvbnZlcnRlZCB0byBhIGJsb2IgYW5kIHRoZW5cclxuICAgIC8vIHRvIGEgRmlsZS5cclxuICAgIC8vIEEgZmlsZSB0aGF0IGNhbiBub3QgYmUgZXhwb3J0ZWQgdG8gUERGIGlzIHJldHJpZXZlZFxyXG4gICAgLy8gdGhyb3VnaCBYSFIgYW5kIGNvbnZlcnRlZCB0byBhIEZpbGUuXHJcblxyXG4gICAgLy8gSWYgd2UgZG9uJ3QgbmVlZCB0byBoYW5kbGUgdGhlIHBoeXNpY2FsIGZpbGVzIG9uIHRoZSBjbGllbnRcclxuICAgIC8vIHdlIGNvdWxkIHNhdmUgb25seSB0aGUgZmlsZUlkOnMgYW5kIGRpc3BsYXkgZmlsZW5hbWUgYW5kIG1pbWVUeXBlXHJcbiAgICAvLyBmb3IgdGhlIGZpbGUgaW4gb3VyIGxpc3RpbmdzLiBXaGVuL2lmIHdlIHVzZSBHb29nbGUgQ2xhc3Nyb29tIGZvclxyXG4gICAgLy8gb3VyIHRhc2staGFuZGxpbmcgdGhhdCB3b3VsZCBiZSB0aGUgcHJlZmVycmVkIGFwcHJvYWNoIHRvIGtlZXBcclxuICAgIC8vIHRoZSBmaWxlIGFzIGFuIGVkaXRhYmxlIEdvb2dsZSBmaWxlXHJcblxyXG4gICAgLy8gSW5pdCB0aGUgZHJpdmUtYXBpIChvbmx5IG5lZWRlZCBmb3IgZG93bmxvYWQgc28gbm90IGxvYWRlZCBpbml0aWFsbHkpXHJcbiAgICBhd2FpdCBnYXBpLmNsaWVudC5pbml0KHtcclxuICAgICAgZGlzY292ZXJ5RG9jczogW1wiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vZGlzY292ZXJ5L3YxL2FwaXMvZHJpdmUvdjMvcmVzdFwiXVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGZpbGUuY2FuRXhwb3J0KSB7XHJcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxGaWxlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgZ2FwaS5jbGllbnQuZHJpdmUuZmlsZXMuZXhwb3J0KHtcclxuICAgICAgICAgIGZpbGVJZDogZmlsZS5maWxlSWQsXHJcbiAgICAgICAgICBtaW1lVHlwZTogJ2FwcGxpY2F0aW9uL3BkZid9XHJcbiAgICAgICAgKS50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgY29uc3QgbGVuID0gcmVzcC5ib2R5Lmxlbmd0aDtcclxuICAgICAgICAgIGNvbnN0IGRhdGEgPSBuZXcgVWludDhBcnJheShuZXcgQXJyYXlCdWZmZXIobGVuKSk7XHJcbiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGRhdGFbaV0gPSByZXNwLmJvZHkuY2hhckNvZGVBdChpKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbZGF0YV0sIHt0eXBlOiAnYXBwbGljYXRpb24vcGRmJ30pO1xyXG4gICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBmaWxlLm5hbWUrJy5wZGYnO1xyXG4gICAgICAgICAgcmVzb2x2ZShuZXcgRmlsZShbYmxvYl0sIGZpbGVuYW1lLCB7dHlwZTogJ2FwcGxpY2F0aW9uL3BkZicsIGxhc3RNb2RpZmllZDogZmlsZS5tb2RpZmllZFRpbWV9KSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgfSk7ICBcclxuICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAvLyBhIGZpbGUgdGhhdCBpc24ndCBhIGdvb2dsZS1hcHBzIGZpbGUgbmVlZHMgdG8gYmUgZmV0Y2hlZCB2aWEgWEhSXHJcbiAgICAgIC8vIGJlY2F1c2UgcmVzcG9uc2VUeXBlIGFuZCA/YWx0PW1lZGlhIG5lZWRzIHRvIGJlIHNldCB0byBhdm9pZCBDT1JTXHJcbiAgICAgIGNvbnN0IHhockRvd25sb2FkID0gKGZpbGU6c2VsZWN0ZWRGaWxlKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPEZpbGU+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgICAgICAgeGhyLm9wZW4oXCJHRVRcIiwgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9kcml2ZS92My9maWxlcy9cIitmaWxlLmZpbGVJZCsnP2FsdD1tZWRpYScsIHRydWUpO1xyXG4gICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0F1dGhvcml6YXRpb24nLCdCZWFyZXIgJyt0aGlzLmF1dGhUb2tlbik7XHJcbiAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXHJcbiAgICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcmVzb2x2ZShuZXcgRmlsZShbeGhyLnJlc3BvbnNlXSwgZmlsZS5uYW1lLCB7dHlwZTogZmlsZS5taW1lVHlwZSwgbGFzdE1vZGlmaWVkOiBmaWxlLm1vZGlmaWVkVGltZX0pKTtcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gbmV3IFByb21pc2U8RmlsZT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIGlmIChsaW1pdFNpemUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgZ2FwaS5jbGllbnQuZHJpdmUuZmlsZXMuZ2V0KHtcclxuICAgICAgICAgICAgZmlsZUlkOiBmaWxlLmZpbGVJZCxcclxuICAgICAgICAgICAgZmllbGRzOiAnc2l6ZSdcclxuICAgICAgICAgIH0pLnRoZW4ocmVzcCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNpemUgPSBOdW1iZXIocmVzcC5yZXN1bHQuc2l6ZSk7XHJcbiAgICAgICAgICAgIGlmIChzaXplID4gbGltaXRTaXplKjEwMjQqMTAyNCkge1xyXG4gICAgICAgICAgICAgIHJlamVjdCgnR29vZ2xlUGlja2VyRXJyb3I6IEZpbHNpemUgaXMgdG9vIGxhYXJnZScpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICB4aHJEb3dubG9hZChmaWxlKS50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICAgIHJlc29sdmUocmVzcCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB4aHJEb3dubG9hZChmaWxlKS50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKHJlc3ApO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVXZWJDbGllbnQge1xyXG4gIGF1dGhUb2tlbjogc3RyaW5nO1xyXG4gIHNjb3Blczogc3RyaW5nW107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHNjb3Blcykge1xyXG4gICAgdGhpcy5zY29wZXMgPSBbJ2h0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvdXNlcmluZm8uZW1haWwnLCAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC91c2VyaW5mby5wcm9maWxlJ107XHJcbiAgICB0aGlzLnNjb3Blcy5wdXNoKC4uLnNjb3Blcyk7XHJcbiAgfVxyXG4gIGFzeW5jIGVuc3VyZUluaXRlZCgpIHtcclxuICAgIC8vIExvYWQgR0FQSVxyXG4gICAgaWYgKHR5cGVvZiBnYXBpID09PSBcInVuZGVmaW5lZFwiKSBhd2FpdCB0aGlzLmxvYWRHYXBpKCk7XHJcblxyXG4gICAgLy8gS0VEU1NjaG9vbHNcclxuICAgIGNvbnN0IENMSUVOVF9JRCA9IFwiNDIxNTcyMjYyMjY5LXU2OHY1bGY1bzhzczV0NjhsOGdrcTNwZmFyaDZkYmt2LmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tXCI7XHJcbiAgICBjb25zdCBTQ09QRVMgPSB0aGlzLnNjb3Blcy5qb2luKCcgJyk7XHJcbiAgICBcclxuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLHJlamVjdCkgPT4ge1xyXG4gICAgICBnYXBpLmxvYWQoXCJjbGllbnQ6YXV0aDJcIiwgKCkgPT4ge1xyXG4gICAgICAgIC8vIENhbGxzIGF1dGhvcml6ZSB3aXRob3V0IHByb21wdGluZyB0aGUgdXNlci4gSWYgYXV0aG9yaXphdGlvbiBoYXNuJ3QgYmVlbiBnaXZlbiBieVxyXG4gICAgICAgIC8vIHRoZSB1c2VyIGFuIGVycm9yIGlzIHJldHVybmVkIGFuZCB3ZSBjYWxsIGF1dGhvcml6ZSBhZ2FpbiB3aXRoIGNvbnNlbnQtc2NyZWVuXHJcbiAgICAgICAgbGV0IHJlYXV0aG9yaXplID0gZmFsc2U7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2xvYWRpbmcgY2xpZW50OmF1dGgyJyk7XHJcbiAgICAgICAgcmV0dXJuIGdhcGkuYXV0aDIuYXV0aG9yaXplKHtcclxuICAgICAgICAgIGNsaWVudF9pZDogQ0xJRU5UX0lELFxyXG4gICAgICAgICAgc2NvcGU6IFNDT1BFUyxcclxuICAgICAgICAgIHJlc3BvbnNlX3R5cGU6ICdwZXJtaXNzaW9uJyxcclxuICAgICAgICAgIGxvZ2luX2hpbnQ6IGVudi5jdXJyZW50VXNlci5tYWlsLFxyXG4gICAgICAgICAgcHJvbXB0OiAnbm9uZSdcclxuICAgICAgICB9LCAocmVzcCkgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2cocmVzcCk7XHJcbiAgICAgICAgICBpZiAocmVzcC5lcnJvcikge1xyXG4gICAgICAgICAgICAvLyBubyBjb25zZW50IGdpdmVuIHNvIHJlYXV0aG9yaXplXHJcbiAgICAgICAgICAgIHJlYXV0aG9yaXplID0gdHJ1ZTsgICAgICAgICAgICBcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGhhdmUgYWxsIHRoZSBzY29wZXMgd2Ugd2FudFxyXG4gICAgICAgICAgICBjb25zdCBzY29wZXNldCA9IG5ldyBTZXQocmVzcC5zY29wZS5zcGxpdCgnICcpKTtcclxuICAgICAgICAgICAgY29uc3QgbWlzc2luZ1Njb3BlcyA9IHRoaXMuc2NvcGVzLmZpbHRlcih4ID0+ICFzY29wZXNldC5oYXMoeCkpO1xyXG4gICAgICAgICAgICBpZiAobWlzc2luZ1Njb3Blcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ21pc3Npbmcgc2NvcGVzJyk7XHJcbiAgICAgICAgICAgICAgLy8gc2NvcGVzIGFyZSBtaXNzaW5nIGZyb20gb3VyIGNvbnNlbnQgc28gcmVhdXRob3JpemVcclxuICAgICAgICAgICAgICByZWF1dGhvcml6ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgLy8gZXZlcnl0aGluZyBzZWVtcyB0byBiZSBvayBzbyBzdG9yZSBvdXIgdG9rZW5cclxuICAgICAgICAgICAgICB0aGlzLmF1dGhUb2tlbiA9IHJlc3AuYWNjZXNzX3Rva2VuO1xyXG4gICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChyZWF1dGhvcml6ZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncmVhdXRob3JpemUnKTtcclxuICAgICAgICAgICAgcmV0dXJuIGdhcGkuYXV0aDIuYXV0aG9yaXplKHtcclxuICAgICAgICAgICAgICBjbGllbnRfaWQ6IENMSUVOVF9JRCxcclxuICAgICAgICAgICAgICBzY29wZTogU0NPUEVTLFxyXG4gICAgICAgICAgICAgIHJlc3BvbnNlX3R5cGU6ICdwZXJtaXNzaW9uJyxcclxuICAgICAgICAgICAgICBsb2dpbl9oaW50OiBlbnYuY3VycmVudFVzZXIubWFpbCxcclxuICAgICAgICAgICAgICBwcm9tcHQ6ICdjb25zZW50J1xyXG4gICAgICAgICAgICB9LCAocmVzcCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3ApO1xyXG4gICAgICAgICAgICAgIGlmIChyZXNwLmVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzb21ldGhpbmcgaXMgc3RpbGwgd3Jvbmcgc28gdGhyb3cgYW4gZXJyb3JcclxuICAgICAgICAgICAgICAgIHJlamVjdCgnR29vZ2xlIFdlYiBDbGllbnQ6IE5vIGFjY2VzcyB0b2tlbicpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3ZSBub3cgaGF2ZSBhIHRva2VuIChob3BlZnVsbHkgd2l0aCB0aGUgcmlnaHQgc2NvcGVzKVxyXG4gICAgICAgICAgICAgICAgLy8gc2hvdWxkIHdlIGNoZWNrIGFnYWluP1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSByZXNwLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICl9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIExvYWQgUGlja2VyIEFQSVxyXG4gICAgaWYgKHR5cGVvZiBnb29nbGUgPT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIGdvb2dsZS5waWNrZXIgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgICAgZ2FwaS5sb2FkKFwicGlja2VyXCIsICgpID0+IHsgcmVzb2x2ZSgpIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICBsb2FkR2FwaSgpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGlmICh0eXBlb2YgZ2FwaSAhPT0gXCJ1bmRlZmluZWRcIikgcmV0dXJuIHJlc29sdmUoKTtcclxuICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcclxuICAgICAgc2NyaXB0LnNyYyA9IFwiaHR0cHM6Ly9hcGlzLmdvb2dsZS5jb20vanMvY2xpZW50LmpzP29ubG9hZD1nYWFwaV9sb2FkZWRcIjtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKHNjcmlwdCk7XHJcbiAgICAgICh3aW5kb3cgYXMgYW55KS5nYWFwaV9sb2FkZWQgPSByZXNvbHZlO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEVEU1RlYWNoZXIsIEVEU1R1aXRpb25Hcm91cCB9IGZyb20gJy4uLy4uL2NvbnRyYWN0cy9lZHMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IG1vY2tUZWFjaGVyczogRURTVGVhY2hlcltdID0gW1xyXG4gICAge1xyXG4gICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgIHRlYWNoZXJGaXJzdE5hbWU6ICdUZWFjaGVyIDEnLFxyXG4gICAgICAgIHRlYWNoZXJMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgdGVhY2hlckVtYWlsQWRkcmVzczogJ3RlYWNoZXIxLmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgdGVhY2hlckZpcnN0TmFtZTogJ1RlYWNoZXIgMicsXHJcbiAgICAgICAgdGVhY2hlckxhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICB0ZWFjaGVyRW1haWxBZGRyZXNzOiAndGVhY2hlcjIuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICB0ZWFjaGVyRmlyc3ROYW1lOiAnVGVhY2hlciAzJyxcclxuICAgICAgICB0ZWFjaGVyTGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgIHRlYWNoZXJFbWFpbEFkZHJlc3M6ICd0ZWFjaGVyMy5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgIHRlYWNoZXJGaXJzdE5hbWU6ICdDYXJsJyxcclxuICAgICAgICB0ZWFjaGVyTGFzdE5hbWU6ICdIb2xtYmVyZycsXHJcbiAgICAgICAgdGVhY2hlckVtYWlsQWRkcmVzczogJ2NhcmxAa2Vkc2Nob29scy5jb20nXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgIHRlYWNoZXJGaXJzdE5hbWU6ICdEYXZpZCcsXHJcbiAgICAgICAgdGVhY2hlckxhc3ROYW1lOiAnRmFobGFuZGVyJyxcclxuICAgICAgICB0ZWFjaGVyRW1haWxBZGRyZXNzOiAnZGF2aWQuZmFobGFuZGVyQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICB0ZWFjaGVyRmlyc3ROYW1lOiAnQW5kcmVpJyxcclxuICAgICAgICB0ZWFjaGVyTGFzdE5hbWU6ICdTcGF0YXJlbHUnLFxyXG4gICAgICAgIHRlYWNoZXJFbWFpbEFkZHJlc3M6ICdhbmRyZWkuc3BhdGFyZWx1QGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgfVxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IG1vY2tUdWl0aW9uR3JvdXBzID0ge1xyXG4gICAgJ0RKVURKSDAnOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIGNvdXJzZUNvZGU6ICdESlVESkgwJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IyICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIGNvdXJzZUNvZGU6ICdESlVESkgwJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IzICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIGNvdXJzZUNvZGU6ICdESlVESkgwJ1xyXG4gICAgICAgIH1cclxuICAgIF0sXHJcbiAgICAnS0VNS0VNMDEnOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0tFTTFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIGNvdXJzZUNvZGU6ICdLRU1LRU0wMSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdLRU0xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBjb3Vyc2VDb2RlOiAnS0VNS0VNMDEnXHJcbiAgICAgICAgfVxyXG4gICAgXSxcclxuICAgICdCSU9CSU8wMSc6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnQklPMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgY291cnNlQ29kZTogJ0JJT0JJTzAxJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0JJTzFfR3IyICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIGNvdXJzZUNvZGU6ICdCSU9CSU8wMSdcclxuICAgICAgICB9XHJcbiAgICBdXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtb2NrVHVpdGlvblN0dWRlbnRzID0ge1xyXG4gICAgJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScgOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDEnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDEuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDInLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDIuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDMnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDMuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0lEUjFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDQnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDQuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH1cclxuICAgIF0sXHJcbiAgICAnSURSMV9HcjIgKDE4MDgxNi0xOTA2MTQpJyA6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnSURSMV9HcjIgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgNScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50NS5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnSURSMV9HcjIgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgNicsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50Ni5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnSURSMV9HcjIgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgNycsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50Ny5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfVxyXG4gICAgXSxcclxuICAgICdJRFIxX0dyMyAoMTgwODE2LTE5MDYxNCknIDogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdJRFIxX0dyMyAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA4JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ4LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdJRFIxX0dyMyAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA5JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ5LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdJRFIxX0dyMyAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCAxMCcsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50MTAuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH1cclxuICAgIF0sXHJcbiAgICAnS0VNMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyA6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnS0VNMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgMicsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50Mi5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnS0VNMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgMycsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50My5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnS0VNMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgOCcsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50OC5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNjaG9vbE5hbWU6ICdLRUQnLFxyXG4gICAgICAgICAgICB0dWl0aW9uR3JvdXBOYW1lOiAnS0VNMV9HcjEgKDE4MDgxNi0xOTA2MTQpJyxcclxuICAgICAgICAgICAgc3R1ZGVudEZpcnN0TmFtZTogJ1N0dWRlbnQgOScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRMYXN0TmFtZTogJ0NsYXNzcm9vbScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRFbWFpbEFkZHJlc3M6ICdzdHVkZW50OS5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfVxyXG4gICAgXSxcclxuICAgICdLRU0xX0dyMiAoMTgwODE2LTE5MDYxNCknIDogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdLRU0xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCAxJyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQxLmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdLRU0xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA1JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ1LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdLRU0xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA2JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ2LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9XHJcbiAgICBdLFxyXG4gICAgJ0JJTzFfR3IxICgxODA4MTYtMTkwNjE0KScgOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0JJTzFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDEnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDEuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0JJTzFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDQnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDQuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0JJTzFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDYnLFxyXG4gICAgICAgICAgICBzdHVkZW50TGFzdE5hbWU6ICdDbGFzc3Jvb20nLFxyXG4gICAgICAgICAgICBzdHVkZW50RW1haWxBZGRyZXNzOiAnc3R1ZGVudDYuY2xhc3Nyb29tQGtlZHNjaG9vbHMuY29tJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzY2hvb2xOYW1lOiAnS0VEJyxcclxuICAgICAgICAgICAgdHVpdGlvbkdyb3VwTmFtZTogJ0JJTzFfR3IxICgxODA4MTYtMTkwNjE0KScsXHJcbiAgICAgICAgICAgIHN0dWRlbnRGaXJzdE5hbWU6ICdTdHVkZW50IDEwJyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQxMC5jbGFzc3Jvb21Aa2Vkc2Nob29scy5jb20nXHJcbiAgICAgICAgfVxyXG4gICAgXSxcclxuICAgICdCSU8xX0dyMiAoMTgwODE2LTE5MDYxNCknIDogW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdCSU8xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCAyJyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQyLmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdCSU8xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA3JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ3LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2Nob29sTmFtZTogJ0tFRCcsXHJcbiAgICAgICAgICAgIHR1aXRpb25Hcm91cE5hbWU6ICdCSU8xX0dyMiAoMTgwODE2LTE5MDYxNCknLFxyXG4gICAgICAgICAgICBzdHVkZW50Rmlyc3ROYW1lOiAnU3R1ZGVudCA4JyxcclxuICAgICAgICAgICAgc3R1ZGVudExhc3ROYW1lOiAnQ2xhc3Nyb29tJyxcclxuICAgICAgICAgICAgc3R1ZGVudEVtYWlsQWRkcmVzczogJ3N0dWRlbnQ4LmNsYXNzcm9vbUBrZWRzY2hvb2xzLmNvbSdcclxuICAgICAgICB9LFxyXG4gICAgXVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgICBudW1iZXJPZlRhc2tzOiBudW1iZXI7XHJcbiAgICBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXI7XHJcbiAgICBtYXhpbXVtVGFza3NEaXNwbGF5ZWQ/OiBudW1iZXI7XHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I/OiBzdHJpbmc7XHJcbiAgICBwcm9ncmVzc0NvbG9yPzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgR29hbFByb2dyZXNzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgICBwdWJsaWMgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBudW1iZXJvZlRhc2tzOiAwLFxyXG4gICAgICAgIGNvbXBsZXRlZE51bWJlck9mVGFza3M6IDAsXHJcbiAgICAgICAgbWF4aW11bVRhc2tzRGlzcGxheWVkOiAxMCxcclxuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwibGlnaHRncmV5XCIsXHJcbiAgICAgICAgcHJvZ3Jlc3NDb2xvcjogXCIjM2RiY2EyXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIGNyZWF0ZVByb2dyZXNzID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgbnVtYmVyT2ZUYXNrcywgY29tcGxldGVkTnVtYmVyT2ZUYXNrcywgbWF4aW11bVRhc2tzRGlzcGxheWVkLCBiYWNrZ3JvdW5kQ29sb3IsIHByb2dyZXNzQ29sb3IgfSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgbGV0IHByb2dyZXNzID0gW107XHJcbiAgICAgICAgaWYobnVtYmVyT2ZUYXNrcyA+IG1heGltdW1UYXNrc0Rpc3BsYXllZCl7XHJcbiAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwicHJvZ3Jlc3Mtb3ZlcnZpZXdcIj4ge2NvbXBsZXRlZE51bWJlck9mVGFza3N9IC8ge251bWJlck9mVGFza3N9IDwvZGl2PjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IHRhc2tObyA9IDE7IHRhc2tObyA8PSBudW1iZXJPZlRhc2tzOyB0YXNrTm8rKykge1xyXG4gICAgICAgICAgICBwcm9ncmVzcy5wdXNoKFxyXG4gICAgICAgICAgICA8c3ZnIGtleT17dGFza05vfT5cclxuICAgICAgICAgICAgICAgIDxjaXJjbGUgY2xhc3NOYW1lPVwiY2lyY2xlLWNoYXJ0LWJhY2tncm91bmRcIiBmaWxsPXt0YXNrTm8gPiBjb21wbGV0ZWROdW1iZXJPZlRhc2tzID8gYmFja2dyb3VuZENvbG9yIDogcHJvZ3Jlc3NDb2xvcn0gY3g9XCI4XCIgY3k9XCI4XCIgcj1cIjhcIiAvPlxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByb2dyZXNzO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpeyAgXHJcbiAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZ29hbHMtcHJvZ3Jlc3NcIj57dGhpcy5jcmVhdGVQcm9ncmVzcygpfTwvZGl2PlxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgQ29sbGVjdGlvbiwgRW1pdHRlciwgVmFsdWUgfSBmcm9tICdrZWRiYWNrZW5kL29ic2VydmFibGUnO1xyXG5pbXBvcnQgeyBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvZGInO1xyXG5pbXBvcnQgeyBmbGF0dGVuLCBkaXN0aW5jdCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgV2l0aEdyYXBocyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XHJcblxyXG4vKiogQ291cnNlICovXHJcbmludGVyZmFjZSBPcmRlckRlZmluaW5nRG9jIHtcclxuICBrbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlcj86IHN0cmluZ1tdICAgLy8gQ291cnNlXHJcbiAgY2VudHJhbENvbnRlbnRPcmRlcj86IHN0cmluZ1tdICAgICAgICAgIC8vIENvdXJzZVxyXG4gIGFiaWxpdGllc09yZGVyPzogc3RyaW5nW10gICAgICAgICAgICAgICAvLyBDb3Vyc2UgKyBTdWJqZWN0XHJcbn1cclxuXHJcbi8qKiBDb3Vyc2UsIENvdXJzZUluc3RhbmNlLCBUYXNrLCBMZWFybmluZ0dvYWxzQ29udGVudCBvciBDb3Vyc2VCbG9jayAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJlcXVpcmVtZW50c0NvbnRhaW5pbmdEb2Mge1xyXG4gIHRhZ3M6IHN0cmluZ1tdOyAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3Vyc2UgKyBDb3Vyc2VJbnN0YW5jZSwgVGFza1xyXG4gIGNlbnRyYWxDb250ZW50Pzoge2lkOiBzdHJpbmd9W107ICAgICAgICAvLyBDb3Vyc2UgKyBMZWFybmluZ0dvYWxzQ29udGVudCArIENvdXJzZUJsb2NrICsgVGFza1xyXG4gIGtub3dsZWRnZVJlcXVpcmVtZW50cz86IHtpZDogc3RyaW5nfVtdOyAvLyBDb3Vyc2UgKyBMZWFybmluZ0dvYWxzQ29udGVudCArIENvdXJzZUJsb2NrICsgVGFza1xyXG4gIGFiaWxpdGllcz86IHtpZDogc3RyaW5nfVtdOyAvLyBDb3Vyc2UsIExlYXJuaW5nR29hbHNDb250ZW50LCBDb3Vyc2VCbG9jaywgVGFza1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3JkZXJlZERvY3M8VCBleHRlbmRzIHtpZDogc3RyaW5nfT4oZG9jcz86IFRbXSwgb3JkZXI/OiBzdHJpbmdbXSwge2FwcGVuZExlZnRvdmVyc30gPSB7YXBwZW5kTGVmdG92ZXJzOmZhbHNlfSkge1xyXG4gIC8vIE1hcmsgZG9jIElEcyB0aGF0IHdoZXJlIHByZXNlbnQgaW4gZ2l2ZW4gJ29yZGVyJyBhcnJheS5cclxuICAvLyBXaWxsIGJlIHVzZWQgdG8gZmluZCBsZWZ0LW92ZXJzIHRoYXQgd2VyZSBub3QgcHJlc2VudCBpbiB0aGUgJ29yZGVyJyBhcnJheS5cclxuICBjb25zdCBtYXJrZWREb2NzOiB7W2lkOiBzdHJpbmddOiB0cnVlfSA9IHt9O1xyXG5cclxuICBpZiAoIWRvY3MgfHwgIW9yZGVyKSB7XHJcbiAgICAvLyBTcGVjaWFsIGNhc2U6IG5vIGRvY3Mgb3Igbm8gb3JkZXIuIERvbid0IGZhaWwuIEp1c3QgcmV0dXJuIGRvY3MgYXMgaXMuXHJcbiAgICByZXR1cm4gZG9jcztcclxuICB9XHJcblxyXG4gIC8vIE1hcCBnaXZlbiAnb3JkZXInIGFycmF5IHRvIGNvcnJlc3BvbmRpbmcgZG9jcy4gQWxzbyBtYXJrIGluIG1hcmtlZERvY3MuXHJcbiAgY29uc3QgcmVzdWx0ID0gKGRvY3MgJiYgb3JkZXIgP1xyXG4gICAgb3JkZXIubWFwKGlkID0+IHtcclxuICAgICAgbWFya2VkRG9jc1tpZF0gPSB0cnVlO1xyXG4gICAgICByZXR1cm4gZG9jcy5maW5kKGRvYyA9PiBkb2MuaWQgPT09IGlkKTtcclxuICAgIH0pLmZpbHRlcihkb2MgPT4gISFkb2MpIDpcclxuICAgIGRvY3MpO1xyXG5cclxuICBpZiAoYXBwZW5kTGVmdG92ZXJzKSB7ICAgICAgXHJcbiAgICAvLyBJZiBhbnkgbGVmdG92ZXJzIGFyZSB0aGVyZSwgY29uY2F0IHRoZW0gYXQgdGhlIGVuZDpcclxuICAgIGNvbnN0IGxlZnRPdmVycyA9IGRvY3MuZmlsdGVyKGRvYyA9PiAhbWFya2VkRG9jc1tkb2MuaWRdKTtcclxuICAgIHJldHVybiByZXN1bHQuY29uY2F0KGxlZnRPdmVycyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVJlcXVpcmVtZW50T3JkZXI8VCBleHRlbmRzIFJlcXVpcmVtZW50c0NvbnRhaW5pbmdEb2M+KG9iajogVCwgb3JkZXJEZWZpbmVyPzogT3JkZXJEZWZpbmluZ0RvYyk6IFZhbHVlPFQ+IHtcclxuICBsZXQgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGU6IFZhbHVlPE9yZGVyRGVmaW5pbmdEb2NbXT47XHJcbiAgaWYgKG9yZGVyRGVmaW5lcikge1xyXG4gICAgLy8gVXNlciBwcm92aWRlZCB0aGUgb3JkZXJEZWZpbmluZyBkb2MgKHVzZSBjYXNlIGlzIHdoZW4gb2JqIGlzIGEgQ291cnNlIG9yIFN1YmplY3QsIHdoaWNoIGNvbnRhaW5zIGl0cyBvcmRlciBieSBpdHNlbGYuIFVzZXIgdGhlbiBwcm92aWRlcyB0aGUgQ291cnNlIG9yIFN1YmplY3QgaW4gYm90aCBhcmdzKVxyXG4gICAgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGUgPSBuZXcgRW1pdHRlcihbb3JkZXJEZWZpbmVyXSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNvbnN0IGNvdXJzZUNvZGVzID0gb2JqLnRhZ3MuZmlsdGVyKHRhZyA9PiB0YWcuc3RhcnRzV2l0aChcImNvdXJzZTpcIikpO1xyXG4gICAgaWYgKGNvdXJzZUNvZGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gbmV3IEVtaXR0ZXIob2JqKTsgLy8gTm8gY291cnNlIHRhZ3MuIE5vdCBwb3NzaWJsZSB0byByZXNvbHZlIG9yZGVyLlxyXG4gICAgfVxyXG4gICAgb3JkZXJEZWZpbmluZ0RvY09ic2VydmFibGUgPSBkYi5jb3Vyc2VzLnRhZ3MoLi4uY291cnNlQ29kZXMpLnRvVmFsdWUoKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBvcmRlckRlZmluaW5nRG9jT2JzZXJ2YWJsZS5tYXAob3JkZXJIb2xkZXJzID0+IHtcclxuICAgIGNvbnN0IGFiaWxpdGllc09yZGVyID0gZmxhdHRlbihvcmRlckhvbGRlcnMubWFwKG9yZGVySG9sZGVyID0+IG9yZGVySG9sZGVyLmFiaWxpdGllc09yZGVyIHx8IFtdKSk7XHJcbiAgICBjb25zdCBjY09yZGVyID0gZmxhdHRlbihvcmRlckhvbGRlcnMubWFwKG9yZGVySG9sZGVyID0+IG9yZGVySG9sZGVyLmNlbnRyYWxDb250ZW50T3JkZXIgfHwgW10pKTtcclxuICAgIGNvbnN0IGtyT3JkZXIgPSBmbGF0dGVuKG9yZGVySG9sZGVycy5tYXAob3JkZXJIb2xkZXIgPT4gb3JkZXJIb2xkZXIua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgfHwgW10pKTtcclxuICAgIGNvbnN0IG9iakNsb25lID0gT2JqZWN0LmFzc2lnbih7fSwgb2JqKTtcclxuICAgIGlmIChvYmpDbG9uZS5hYmlsaXRpZXMpIG9iakNsb25lLmFiaWxpdGllcyA9IGdldE9yZGVyZWREb2NzKG9iai5hYmlsaXRpZXMsIGFiaWxpdGllc09yZGVyKTtcclxuICAgIGlmIChvYmpDbG9uZS5jZW50cmFsQ29udGVudCkgb2JqQ2xvbmUuY2VudHJhbENvbnRlbnQgPSBnZXRPcmRlcmVkRG9jcyhvYmouY2VudHJhbENvbnRlbnQsIGNjT3JkZXIpO1xyXG4gICAgaWYgKG9iakNsb25lLmtub3dsZWRnZVJlcXVpcmVtZW50cykgb2JqQ2xvbmUua25vd2xlZGdlUmVxdWlyZW1lbnRzID0gZ2V0T3JkZXJlZERvY3Mob2JqLmtub3dsZWRnZVJlcXVpcmVtZW50cywga3JPcmRlcik7XHJcbiAgICByZXR1cm4gb2JqQ2xvbmU7XHJcbiAgfSk7XHJcbn1cclxuIiwiaW1wb3J0IHsgVGFzaywgTGVhcm5pbmdHb2Fsc0NvbnRlbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNvbXBhcmVQcm9wLCBmbGF0dGVuIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XHJcbmltcG9ydCB7IGdldE9yZGVyZWREb2NzIH0gZnJvbSAnLi9vcmRlcmVkLXJlcXVpcmVtZW50cyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U29ydGVkVGFza3MoY29udGVudDogTGVhcm5pbmdHb2Fsc0NvbnRlbnQpIHtcclxuICByZXR1cm4gZ2V0T3JkZXJlZERvY3MoY29udGVudC50YXNrcywgY29udGVudC50YXNrT3JkZXIsIHthcHBlbmRMZWZ0b3ZlcnM6IHRydWV9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVVcGRhdGVkT3JkZXI8VCBleHRlbmRzIHtpZDogc3RyaW5nfT4oXHJcbiAgZG9jczogVFtdLFxyXG4gIGN1cnJlbnRPcmRlcjogc3RyaW5nW10gfCB1bmRlZmluZWQsXHJcbiAgc291cmNlOiBULFxyXG4gIHRhcmdldDogVCxcclxuICBwbGFjZW1lbnQ6ICdiZWZvcmUnIHwgJ2FmdGVyJyxcclxuICB7YXBwZW5kTGVmdG92ZXJzfSA9IHthcHBlbmRMZWZ0b3ZlcnM6IGZhbHNlfSkgOiBzdHJpbmdbXVxyXG57XHJcbiAgY29uc3Qgb3JkZXJlZElkcyA9IGdldE9yZGVyZWREb2NzKGRvY3MsIGN1cnJlbnRPcmRlciwge2FwcGVuZExlZnRvdmVyczogdHJ1ZX0pLm1hcCh0ID0+IHQuaWQpO1xyXG4gIGNvbnN0IHBsYWNlQmVmb3JlID0gcGxhY2VtZW50ID09PSAnYmVmb3JlJztcclxuXHJcbiAgY29uc3QgcmVzdWx0ID0gZmxhdHRlbihcclxuICAgIG9yZGVyZWRJZHNcclxuICAgICAgLmZpbHRlcihpZCA9PiBpZCAhPT0gc291cmNlLmlkKSAvLyBSZW1vdmUgc291cmNlIGlkXHJcbiAgICAgIC5tYXAoaWQgPT4gaWQgIT09IHRhcmdldC5pZCA/XHJcbiAgICAgICAgLy8gV2UncmUgbm90IG9uIHRhcmdldFxyXG4gICAgICAgIGlkIDpcclxuICAgICAgICAvLyBXZSdyZSBvbiB0YXJnZXQuIFBsYWNlIGJlZm9yZSBvciBhZnRlcj9cclxuICAgICAgICBwbGFjZUJlZm9yZSA/XHJcbiAgICAgICAgICBbc291cmNlLmlkLCBpZF0gOlxyXG4gICAgICAgICAgW2lkLCBzb3VyY2UuaWRdXHJcbiAgICAgIClcclxuICApO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwiaW1wb3J0IHsgRG9jdW1lbnQsIENvdXJzZSwgS25vd2xlZGdlUmVxdWlyZW1lbnQsIENvdXJzZU1vZHVsZSwgVGFzaywgU29mdERvY3VtZW50QWNjZXNzIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBmbGF0dGVuLCBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcbmltcG9ydCB7IFdpdGhHcmFwaHMgfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xyXG5pbXBvcnQgeyBnZXRFbWFpbEZyb21Eb2NBY2Nlc3MgfSBmcm9tICcuLi91dGlscyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzKGNvdXJzZTogQ291cnNlKSB7XHJcbiAgY29uc3QgdW5jb3ZlcmVkUmVxdWlyZW1lbnRzID0gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5yZWR1Y2UoKHJlc3VsdCwgaXRlbSkgPT4ge1xyXG4gICAgcmVzdWx0W2l0ZW0uaWRdID0gaXRlbTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfSwge30gYXMgeyBbaWQ6IHN0cmluZ106IEtub3dsZWRnZVJlcXVpcmVtZW50IH0pO1xyXG5cclxuICBjb3Vyc2UudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcclxuICAgIHRhc2sua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZvckVhY2goa3IgPT4ge1xyXG4gICAgICBkZWxldGUgdW5jb3ZlcmVkUmVxdWlyZW1lbnRzW2tyLmlkXTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gT2JqZWN0LmtleXModW5jb3ZlcmVkUmVxdWlyZW1lbnRzKS5tYXAoaWQgPT4gdW5jb3ZlcmVkUmVxdWlyZW1lbnRzW2lkXSk7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVxc1JlZmVyZW5jaW5nRG9jIHtcclxuICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IEFycmF5PHtpZDogc3RyaW5nfT5cclxuICBhYmlsaXRpZXM6IEFycmF5PHtpZDogc3RyaW5nfT5cclxuICBjZW50cmFsQ29udGVudDogQXJyYXk8e2lkOiBzdHJpbmd9PlxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWRzTm90Q292ZXJlZEJ5VGFza3MoY291cnNlOiBDb3Vyc2UpIDoge1tpZDogc3RyaW5nXTogdHJ1ZX0ge1xyXG4gIHJldHVybiBnZXRJZHNOb3RDb3ZlcmVkQnlSZXFSZWZlcmVuY2luZ0RvY3MoXHJcbiAgICBbY291cnNlIGFzIFdpdGhHcmFwaHM8Q291cnNlLCBcImFiaWxpdGllc1wiIHwgXCJjZW50cmFsQ29udGVudFwiIHwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIj5dLFxyXG4gICAgY291cnNlLnRhc2tzIGFzIFdpdGhHcmFwaHM8VGFzaywgXCJhYmlsaXRpZXNcIiB8IFwiY2VudHJhbENvbnRlbnRcIiB8IFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCI+W10pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWRzTm90Q292ZXJlZEJ5UmVxUmVmZXJlbmNpbmdEb2NzKFxyXG4gIHRlbXBsYXRlczogUmVxc1JlZmVyZW5jaW5nRG9jW10sXHJcbiAgZG9jc0JlaW5nQ2hlY2tlZDogUmVxc1JlZmVyZW5jaW5nRG9jW10pIDoge1tpZDogc3RyaW5nXTogdHJ1ZX1cclxue1xyXG4gIGNvbnN0IHVuY292ZXJlZElkcyA9IHt9O1xyXG4gIC8vIDEuIE1hcmsgdGhlIGlkcyBvZiBhbGwga25vd2xlZGdlIHJlcXVpcmVtZW50cywgYWJpbGl0aWVzIGFuZCBjZW50cmFsIGNvbnRlbnQgZm9yIHRoaXMgY291cnNlOlxyXG4gIHRlbXBsYXRlcy5mb3JFYWNoKGNvdXJzZSA9PiB7XHJcbiAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZvckVhY2gociA9PiB7XHJcbiAgICAgIHVuY292ZXJlZElkc1tyLmlkXSA9IHRydWU7XHJcbiAgICB9KTtcclxuICAgIGNvdXJzZS5hYmlsaXRpZXMuZm9yRWFjaChhID0+IHtcclxuICAgICAgdW5jb3ZlcmVkSWRzW2EuaWRdID0gdHJ1ZTtcclxuICAgIH0pO1xyXG4gICAgY291cnNlLmNlbnRyYWxDb250ZW50LmZvckVhY2goY2MgPT4ge1xyXG4gICAgICB1bmNvdmVyZWRJZHNbY2MuaWRdID0gdHJ1ZTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG4gIC8vIDIuIExpc3QgYWxsIHRhc2tzIGFuZCB1bm1hcmsgYWxsIGlkcyB0aGF0IHRoZXkgcmVmZXIgdG9cclxuICBkb2NzQmVpbmdDaGVja2VkLmZvckVhY2goZG9jID0+IHtcclxuICAgIGRvYy5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZm9yRWFjaChrciA9PiB7XHJcbiAgICAgIGRlbGV0ZSB1bmNvdmVyZWRJZHNba3IuaWRdO1xyXG4gICAgfSk7XHJcbiAgICBkb2MuYWJpbGl0aWVzLmZvckVhY2goYSA9PiB7XHJcbiAgICAgIGRlbGV0ZSB1bmNvdmVyZWRJZHNbYS5pZF07XHJcbiAgICB9KTtcclxuICAgIGRvYy5jZW50cmFsQ29udGVudC5mb3JFYWNoKGNjID0+IHtcclxuICAgICAgZGVsZXRlIHVuY292ZXJlZElkc1tjYy5pZF07XHJcbiAgICB9KTtcclxuICB9KTtcclxuICByZXR1cm4gdW5jb3ZlcmVkSWRzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2FuaXR5Q2hlY2sgKGNvdXJzZTogQ291cnNlKSB7XHJcbiAgZnVuY3Rpb24gaGFzRHVwbGljYXRlVGFza3MoY291cnNlOiBDb3Vyc2UpIHtcclxuICAgIGNvbnN0IHRhc2tJZHM6IHtbaWQ6c3RyaW5nXTogYm9vbGVhbn0gPSB7fTtcclxuICAgIHJldHVybiBmbGF0dGVuKGNvdXJzZS5tb2R1bGVzLm1hcChtb2R1bGUgPT4gbW9kdWxlLnRhc2tJZHMubWFwKHRhc2tJZCA9PiB7XHJcbiAgICAgIGlmICh0YXNrSWRzW3Rhc2tJZF0pIHtcclxuICAgICAgICBjb25zdCB0YXNrID0gY291cnNlLnRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrSWQpO1xyXG4gICAgICAgIHJldHVybiBMYFNhbW1hIHVwcGdpZnQgZsO2cmVrb21tZXIgZmxlcmEgZ8OlbmdlcjogXCIke3Rhc2submFtZX1cImA7XHJcbiAgICAgIH1cclxuICAgICAgdGFza0lkc1t0YXNrSWRdID0gdHJ1ZTtcclxuICAgIH0pLmZpbHRlcih4ID0+IHgpKSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB0YXNrc1dpdGhTYW1lVXJsKGNvdXJzZTogQ291cnNlKSB7XHJcbiAgICBjb25zdCB0YXNrVXJsczoge1t1cmw6c3RyaW5nXTogVGFza30gPSB7fTtcclxuICAgIHJldHVybiBjb3Vyc2UudGFza3MubWFwKHRhc2sgPT4ge1xyXG4gICAgICBpZiAodGFzay51cmwpIHtcclxuICAgICAgICBpZiAodGFza1VybHNbdGFzay51cmxdKSB7XHJcbiAgICAgICAgICByZXR1cm4gTGBUdsOlIHVwcGdpZnRlciBwZWthciBww6Ugc2FtbWEgVVJMOiBcIiR7dGFza1VybHNbdGFzay51cmxdLm5hbWV9XCIgc2FtdCBcIiR7dGFzay5uYW1lfVwiYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGFza1VybHNbdGFzay51cmxdID0gdGFzaztcclxuICAgICAgfVxyXG4gICAgfSkuZmlsdGVyKHggPT4geCk7ICBcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhhc0VtcHR5TW9kdWxlTmFtZXMoY291cnNlOiBDb3Vyc2UpIHtcclxuICAgIHJldHVybiBjb3Vyc2UubW9kdWxlcy5zb21lIChtb2R1bGUgPT4gbW9kdWxlLm5hbWUgPT09IFwiXCIpICYmXHJcbiAgICAgIExgRGV0IGZpbm5zIG1pbnN0IGVuIG1vZHVsIHV0YW4gYW5naXZldCBuYW1uYDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhhc0R1cGxpY2F0ZU1vZHVsZU5hbWVzKGNvdXJzZTogQ291cnNlKSB7XHJcbiAgICBjb25zdCBtb2R1bGVOYW1lczoge1tuYW1lOiBzdHJpbmddOiB0cnVlfSA9IHt9O1xyXG4gICAgcmV0dXJuIGNvdXJzZS5tb2R1bGVzLm1hcChtb2R1bGUgPT4ge1xyXG4gICAgICBpZiAobW9kdWxlLm5hbWUgJiYgbW9kdWxlTmFtZXNbbW9kdWxlLm5hbWVdKSB7XHJcbiAgICAgICAgcmV0dXJuIExgTW9kdWxlbiBtZWQgbmFtbiAke21vZHVsZS5uYW1lfSBmw7ZyZWtvbW1lciBmbGVyYSBnw6VuZ2VyYDtcclxuICAgICAgfVxyXG4gICAgICBpZiAobW9kdWxlLm5hbWUpIG1vZHVsZU5hbWVzW21vZHVsZS5uYW1lXSA9IHRydWU7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY29uc3QgY2hlY2tzID0gZmxhdHRlbihbXHJcbiAgICBoYXNEdXBsaWNhdGVUYXNrcyhjb3Vyc2UpLFxyXG4gICAgdGFza3NXaXRoU2FtZVVybChjb3Vyc2UpLFxyXG4gICAgaGFzRW1wdHlNb2R1bGVOYW1lcyhjb3Vyc2UpLFxyXG4gICAgaGFzRHVwbGljYXRlTW9kdWxlTmFtZXMoY291cnNlKVxyXG4gIF0pO1xyXG5cclxuICByZXR1cm4gY2hlY2tzLmZpbHRlciAocmVzdWx0ID0+IHJlc3VsdCk7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFza3NQZXJJZCAoY291cnNlOiBDb3Vyc2UpIHtcclxuICBjb25zdCByZXN1bHQ6IHtbaWQ6IHN0cmluZ106IFRhc2tbXX0gPSB7fTtcclxuICBmdW5jdGlvbiBhZGQoaWQ6IHN0cmluZywgdGFzazogVGFzaykge1xyXG4gICAgY29uc3QgbGlzdCA9IHJlc3VsdFtpZF0gfHwgKHJlc3VsdFtpZF0gPSBbXSk7XHJcbiAgICBsaXN0LnB1c2godGFzayk7XHJcbiAgfVxyXG4gIGNvdXJzZS50YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xyXG4gICAgdGFzay5hYmlsaXRpZXMuZm9yRWFjaChhID0+IGFkZChhLmlkLCB0YXNrKSk7XHJcbiAgICB0YXNrLmNlbnRyYWxDb250ZW50LmZvckVhY2goYyA9PiBhZGQoYy5pZCwgdGFzaykpO1xyXG4gICAgdGFzay5mdXR1cmVBYmlsaXRpZXMuZm9yRWFjaChmYSA9PiBhZGQoZmEsIHRhc2spKTtcclxuICB9KTtcclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG4vKiogUmV0dXJucyBhbiBhY2Nlc3MgbGlzdCBmb3IgYSBjb3Vyc2UgaW4gYSBiYWNrd2FyZCBjb21wYXRpYmxlIHdheSAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0U29mdEFjY2Vzc0xpc3QgKGNvdXJzZTogQ291cnNlKTogU29mdERvY3VtZW50QWNjZXNzW10ge1xyXG4gIGNvbnN0IHtyZXNwb25zaWJsZVRlYWNoZXJzfSA9IGNvdXJzZTtcclxuICBjb25zdCByZXN1bHQgPSByZXNwb25zaWJsZVRlYWNoZXJzLm1hcChkYSA9Pih7XHJcbiAgICBuYW1lOiBkYS5uYW1lLFxyXG4gICAgZW1haWw6IGdldEVtYWlsRnJvbURvY0FjY2VzcyhkYSksXHJcbiAgICBhY2Nlc3M6IGRhLmFjY2VzcyB8fCAnZWRpdCdcclxuICB9IGFzIFNvZnREb2N1bWVudEFjY2VzcykpO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB7IElDb3Vyc2VFZGl0b3JIb3N0IH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0XCI7XHJcbmltcG9ydCB7IENvdXJzZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgcmVhZEJsb2JBc1RleHQsIGFsbG93Q29weSwgcmVhZEJsb2JBc0RhdGFVcmwgfSBmcm9tIFwiLi4vdXRpbHNcIjtcclxuaW1wb3J0IHsgc2hvd0Vycm9yLCBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tIFwia2VkYmFja2VuZC9jbGllbnRcIjtcclxuaW1wb3J0IHsgaGFzQWNjZXNzIH0gZnJvbSBcIi4uLy4uLy4uL2FjY2Vzcy1jb250cm9sXCI7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuXHJcbnR5cGUgQ2FsbGJhY2sgPSAoKSA9PiB2b2lkO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIGFjdGl2ZVBhZ2U6IEJhbm5lck1lbnVJdGVtLFxyXG4gIGNhbGxiYWNrcz86IHsgW21lbnVOYW1lOiBzdHJpbmddOiBDYWxsYmFjayB9LFxyXG4gIHJvdXRlczogeyBbbWVudU5hbWU6IHN0cmluZ106IHN0cmluZyB9ICYgeyBmZWVkYmFjazogc3RyaW5nIH0sXHJcbiAgYmFja2dyb3VuZEltYWdlPzogc3RyaW5nLFxyXG4gIGlzVGVtcGxhdGU/LFxyXG4gIGhvc3Q/OiBJQ291cnNlRWRpdG9ySG9zdCxcclxuICBjb3Vyc2U/OiBDb3Vyc2UsXHJcbiAgb3JpZ0NvdXJzZT86IENvdXJzZVxyXG59XHJcblxyXG50eXBlIEJhbm5lck1lbnVJdGVtID1cclxuICBcImNvdXJzZUJ1aWxkZXJcIiB8XHJcbiAgXCJzdHVkZW50UGFnZVwiIHxcclxuICBcInRlbXBsYXRlQnVpbGRlclwiIHxcclxuICBcInN1YmplY3RzXCIgfFxyXG4gIFwic2Nob29sc1wiO1xyXG5cclxuY29uc3QgQWRtaW5NZW51SXRlbXMgPSBbXHJcbiAgeyBuYW1lOiBcInNjaG9vbHNcIiwgdGV4dDogTGBTa29sb3JgLCByb3V0ZTogXCIvc2Nob29sc1wiIH0sXHJcbiAgeyBuYW1lOiBcInN1YmplY3RzXCIsIHRleHQ6IExgw4RtbmVuYCwgcm91dGU6IFwiL3N1YmplY3RzXCIgfSxcclxuICAvL3tuYW1lOiBcInRlbXBsYXRlQnVpbGRlclwiLCB0ZXh0OiBMYE1hbGxieWdnYXJlbmAsIHJvdXRlOiBcIi9jb3Vyc2UtdGVtcGxhdGVzXCJ9LFxyXG5dXHJcblxyXG5jb25zdCBOb25BZG1pbk1lbnVJdGVtcyA9IFtcclxuICB7IG5hbWU6IFwiY291cnNlQnVpbGRlclwiLCB0ZXh0OiBMYEt1cnNieWdnYXJlbmAsIHJvdXRlOiBcIi9jb3Vyc2VzL25ld1wiIH0sXHJcbiAgeyBuYW1lOiBcInN0dWRlbnRQYWdlXCIsIHRleHQ6IExgRWxldnNpZGFgLCByb3V0ZTogXCJcIiB9LFxyXG4gIHsgbmFtZTogXCJmZWVkYmFja1wiLCB0ZXh0OiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYSBmYS1jb21tZW50aW5nLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+IEZlZWRiYWNrPC9zcGFuPiwgcm91dGU6IFwiaHR0cHM6Ly9rZy5rdW5za2Fwc3BvcnRlbi5zZS9rdXJzYnlnZ2FyZW4vXCIgfVxyXG5dXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gb25Ecm9wSW1hZ2UoZXY6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4sIGhvc3Q6IElDb3Vyc2VFZGl0b3JIb3N0LCBjb3Vyc2U6IENvdXJzZSwgb3JpZ0NvdXJzZTogQ291cnNlKSB7XHJcbiAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBmaWxlcyA9IGV2LmRhdGFUcmFuc2Zlci5maWxlcztcclxuICBsZXQgdXJsID0gbnVsbDtcclxuICBjb25zdCBpdGVtcyA9IEFycmF5LmZyb20oZXYuZGF0YVRyYW5zZmVyLml0ZW1zKTtcclxuICBpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xyXG4gICAgY29uc3QgZmlsZSA9IGZpbGVzWzBdO1xyXG4gICAgaWYgKGZpbGUuc2l6ZSA+IDIgKiAxMDI0ICogMTAyNCkge1xyXG4gICAgICBzaG93RXJyb3IoTGBLYW4gaW50ZSBsYWRkYSB1cHAgYmlsZGVyIHN0w7ZycmUgw6RuIDIgTUJgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgLy91cmwgPSBhd2FpdCByZWFkQmxvYkFzRGF0YVVybChmaWxlKTtcclxuICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIGZvcm0uYXBwZW5kKFwiZmlsZXNcIiwgZmlsZSk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKFxyXG4gICAgICAnd2ViLXVwbG9hZCcsXHJcbiAgICAgICdwdXQnLFxyXG4gICAgICB7fSxcclxuICAgICAge30sXHJcbiAgICAgIHtcclxuICAgICAgICBib2R5OiBmb3JtXHJcbiAgICAgIH0pO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICBzaG93RXJyb3IoTGBLdW5kZSBpbnRlIGxhZGRhIHVwcCBmaWxlbiB0aWxsIEdvb2dsZSBTdG9yYWdlYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHVybCA9IGF3YWl0IHJlcy50ZXh0KCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldO1xyXG4gICAgICBpZiAoaXRlbS50eXBlLm1hdGNoKCdedGV4dC91cmktbGlzdCcpKSB7XHJcbiAgICAgICAgLy8gVVJJXHJcbiAgICAgICAgdXJsID0gYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBpdGVtLmdldEFzU3RyaW5nKHJlc29sdmUpKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBpZiAodXJsID09IG51bGwpIHtcclxuICAgIHNob3dFcnJvcihMYEt1bmRlIGludGUgaGl0dGEgbsOlZ29uIGJpbGQgaSBpbm5laMOlbGxldGApO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBzZXRDb3Vyc2VJbWFnZShjb3Vyc2UsIG9yaWdDb3Vyc2UsIGhvc3QsIHVybCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRDb3Vyc2VJbWFnZShcclxuICBjb3Vyc2U6IENvdXJzZSxcclxuICBvcmlnQ291cnNlOiBDb3Vyc2UsXHJcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3QsXHJcbiAgdXJsOiBzdHJpbmdcclxuKSB7XHJcbiAgY29uc3QgaW1hZ2VJZCA9IGNyZWF0ZVVVSUQoKTtcclxuICBob3N0LnVwZGF0ZSh7XHJcbiAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcclxuICAgIGltYWdlczoge1xyXG4gICAgICAkc2V0OiBbe1xyXG4gICAgICAgIGlkOiBpbWFnZUlkLFxyXG4gICAgICAgIHVybCxcclxuICAgICAgICBhY2w6IFtcclxuICAgICAgICAgIGByb2xlOlVTRVI6UmAsXHJcbiAgICAgICAgICBgc2Nob29sUm9sZToke2Vudi5jdXJyZW50VXNlci5zY2hvb2x9L0VNUExPWUVFOlNgXHJcbiAgICAgICAgXSxcclxuICAgICAgICAkbWV0YTogJ2FkZCdcclxuICAgICAgfV1cclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyogVGhpcyB2ZXJzaW9uIGhhZCB0aGUgYnVnIHRoYXQgb2xkIGltYWdlcyB3ZXJlIG5vdCByZXBsYWNlZC5cclxuT25lIGNvdXJzZSBhdCBVcHBzYWxhIGNvbnRhaW5lZCAxMiBpbWFnZXMuXHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNldENvdXJzZUltYWdlT2xkKFxyXG4gIGNvdXJzZTogQ291cnNlLFxyXG4gIG9yaWdDb3Vyc2U6IENvdXJzZSxcclxuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdCxcclxuICB1cmw6IHN0cmluZylcclxue1xyXG4gIGlmICghb3JpZ0NvdXJzZSB8fCAhb3JpZ0NvdXJzZS5pbWFnZUlkKSB7XHJcbiAgICBjb25zdCBpbWFnZUlkID0gY3JlYXRlVVVJRCgpO1xyXG4gICAgaG9zdC51cGRhdGUoe1xyXG4gICAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcclxuICAgICAgaW1hZ2VzOiB7XHJcbiAgICAgICAgJHB1c2g6IFt7XHJcbiAgICAgICAgICBpZDogaW1hZ2VJZCxcclxuICAgICAgICAgIHVybCxcclxuICAgICAgICAgIGFjbDogY291cnNlLmlzVGVtcGxhdGUgPyBbXCJyb2xlOlVTRVI6UlwiXSA6IFtcInJvbGU6VVNFUjpSXCIsIGBzY2hvb2xSb2xlOiR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUU6U2BdLFxyXG4gICAgICAgICAgJG1ldGE6ICdhZGQnXHJcbiAgICAgICAgfV1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIFVwZGF0ZSBleGlzdGluZyBpbWFnZTpcclxuICAgIGNvbnN0IGltZ0lkeCA9IGNvdXJzZS5pbWFnZXMuZmluZEluZGV4KGltZyA9PiBpbWcuaWQgPT09IGNvdXJzZS5pbWFnZUlkKTtcclxuICAgIGlmIChpbWdJZHggPj0gMCkge1xyXG4gICAgICBjb25zdCBpbWFnZUVudGl0eSA9IGNvdXJzZS5pbWFnZXNbaW1nSWR4XTtcclxuICAgICAgaWYgKGNvdXJzZS5pc1RlbXBsYXRlKSB7XHJcbiAgICAgICAgLy8gVGVtcGxhdGVzOiBVcGRhdGUgdGhlIHRlbXBsYXRlIGltYWdlIGNvbnRlbnQ6XHJcbiAgICAgICAgaG9zdC51cGRhdGUoe1xyXG4gICAgICAgICAgaW1hZ2VzOiB7XHJcbiAgICAgICAgICAgICRzcGxpY2U6IFtbaW1nSWR4LCAxLCB7XHJcbiAgICAgICAgICAgICAgLi4uaW1hZ2VFbnRpdHksXHJcbiAgICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICAgICRtZXRhOiAndXBkYXRlJ1xyXG4gICAgICAgICAgICB9XV1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIFJlYWwgY291cnNlczogUmVwbGFjZSB3aXRoIGEgbmV3IGltYWdlXHJcbiAgICAgICAgY29uc3QgaW1hZ2VJZCA9IGNyZWF0ZVVVSUQoKTtcclxuICAgICAgICBob3N0LnVwZGF0ZSh7XHJcbiAgICAgICAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcclxuICAgICAgICAgIGltYWdlczoge1xyXG4gICAgICAgICAgICAkc3BsaWNlOiBbW2ltZ0lkeCwgMSwge1xyXG4gICAgICAgICAgICAgIGlkOiBpbWFnZUlkLFxyXG4gICAgICAgICAgICAgIHVybCxcclxuICAgICAgICAgICAgICBhY2w6IFtcclxuICAgICAgICAgICAgICAgIGByb2xlOlVTRVI6UmAsXHJcbiAgICAgICAgICAgICAgICBgc2Nob29sUm9sZToke2Vudi5jdXJyZW50VXNlci5zY2hvb2x9L0VNUExPWUVFOlNgXHJcbiAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAkbWV0YTogJ2FkZCdcclxuICAgICAgICAgICAgfV1dXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2hvd0Vycm9yKExgS3VuZGUgaW50ZSB1cHBkYXRlcmEgYmlsZGVuLmApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4qL1xyXG5cclxuZXhwb3J0IGNvbnN0IENvdXJzZUJhbm5lciA9IChwcm9wczogUHJvcHMpID0+IHtcclxuICBjb25zdCB7IHRpdGxlLCBpc1RlbXBsYXRlLCBob3N0LCBjb3Vyc2UsIG9yaWdDb3Vyc2UsIGJhY2tncm91bmRJbWFnZSwgYWN0aXZlUGFnZSB9ID0gcHJvcHM7XHJcbiAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gXCJBRE1JTlwiKTtcclxuICBsZXQgbWVudUl0ZW1zID0gTm9uQWRtaW5NZW51SXRlbXM7XHJcbiAgaWYgKGlzQWRtaW4pIG1lbnVJdGVtcyA9IEFkbWluTWVudUl0ZW1zLmNvbmNhdChtZW51SXRlbXMpO1xyXG5cclxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tMTJcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zY3JpcHQtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAge2JhY2tncm91bmRJbWFnZSAmJiA8c3R5bGU+e2BcclxuICAgICAgICAucGFnZUhlYWRlciB7XHJcbiAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJyR7YmFja2dyb3VuZEltYWdlfScpICFpbXBvcnRhbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICBgfTwvc3R5bGU+fVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZUhlYWRlclwiXHJcbiAgICAgICAgICBvbkRyYWdPdmVyPXtjb3Vyc2UgJiYgYWxsb3dDb3B5fVxyXG4gICAgICAgICAgb25Ecm9wPXtjb3Vyc2UgJiYgKGV2ID0+IG9uRHJvcEltYWdlKGV2LCBob3N0LCBjb3Vyc2UsIG9yaWdDb3Vyc2UpKX0+XHJcbiAgICAgICAgICA8YT5cclxuICAgICAgICAgICAgPGgxPnt0aXRsZX08L2gxPlxyXG4gICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zRmllbGRcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2hvcml6b250YWxNZW51Jz5cclxuICAgICAgICAgICAgICAgIDx1bD5cclxuICAgICAgICAgICAgICAgICAge21lbnVJdGVtcy5tYXAoaXRlbSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0sXHJcbiAgICAgICAgICAgICAgICAgICAgaXNBY3RpdmU6IGFjdGl2ZVBhZ2UgPT09IGl0ZW0ubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogcHJvcHMuY2FsbGJhY2tzICYmIHByb3BzLmNhbGxiYWNrc1tpdGVtLm5hbWVdLFxyXG4gICAgICAgICAgICAgICAgICAgIGdpdmVuUm91dGU6IChwcm9wcy5yb3V0ZXMgJiYgcHJvcHMucm91dGVzW2l0ZW0ubmFtZV0pLFxyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRSb3V0ZTogaXRlbS5yb3V0ZVxyXG4gICAgICAgICAgICAgICAgICB9KSkuZmlsdGVyKHggPT4geC5jYWxsYmFjayB8fCB4LmRlZmF1bHRSb3V0ZSB8fCB4LmdpdmVuUm91dGUpLm1hcCgoeyBpdGVtLCBpc0FjdGl2ZSwgY2FsbGJhY2ssIGRlZmF1bHRSb3V0ZSwgZ2l2ZW5Sb3V0ZSB9KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxsaVxyXG4gICAgICAgICAgICAgICAgICAgICAga2V5PXtpdGVtLm5hbWV9XHJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2lzQWN0aXZlID8gXCJhY3RpdmVQYWdlXCIgOiBcIlwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17Y2FsbGJhY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAge2NhbGxiYWNrID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGE+e2l0ZW0udGV4dH08L2E+IDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFJvdXRlIHx8IGdpdmVuUm91dGUgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGdpdmVuUm91dGUgfHwgL15odHRwW3NdXFw6XFwvXFwvL2kudGVzdChkZWZhdWx0Um91dGUpID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dpdmVuUm91dGUgfHwgZGVmYXVsdFJvdXRlfT57aXRlbS50ZXh0fTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpbmsgdG89e2RlZmF1bHRSb3V0ZX0+e2l0ZW0udGV4dH08L0xpbms+IDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YT57aXRlbS50ZXh0fTwvYT59XHJcbiAgICAgICAgICAgICAgICAgICAgPC9saT47XHJcbiAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IGZpbmRET01Ob2RlIH0gZnJvbSAncmVhY3QtZG9tJztcclxuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIEltYWdlLCBUYXNrLCBEb2N1bWVudCwgQWJpbGl0eSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcclxuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7IENvdXJzZU1vZHVsZUNvbXBvbmVudCB9IGZyb20gJy4vY291cnNlLW1vZHVsZSc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNvdXJzZTogQ291cnNlO1xyXG4gIGhvc3Q6IElDb3Vyc2VFZGl0b3JIb3N0O1xyXG4gIGlkc05vdENvdmVyZWRCeUFueVRhc2s6IHtbaWQ6IHN0cmluZ106IHRydWV9O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ291cnNlTW9kdWxlTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIF9lbGVtOiBIVE1MRGl2RWxlbWVudDtcclxuICBfbW9kdWxlUmVmczoge1ttb2R1bGVJZDogc3RyaW5nXTogQ291cnNlTW9kdWxlQ29tcG9uZW50fTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLl9tb2R1bGVSZWZzID0ge307XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYWRkTW9kdWxlKCkge1xyXG4gICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZSh7bW9kdWxlczogeyRwdXNoOiBbe1xyXG4gICAgICBuYW1lOiBcIk55IGt1cnNtb2R1bFwiLFxyXG4gICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICByZXNvdXJjZXM6IFtdLFxyXG4gICAgICB0YXNrSWRzOiBbXVxyXG4gICAgIH0gYXMgQ291cnNlTW9kdWxlXHJcbiAgICBdfX0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0T3JkZXJlZE1vZHVsZXMoKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IG1vZHVsZU9yZGVyID0gY291cnNlLm1vZHVsZU9yZGVyIHx8IGNvdXJzZS5tb2R1bGVzLm1hcChtID0+IG0uaWQpO1xyXG4gICAgcmV0dXJuIG1vZHVsZU9yZGVyXHJcbiAgICAgIC8vIE1hcCBvcmRlcmVkIGlkIHRvIG1vZHVsZVxyXG4gICAgICAubWFwKGlkID0+IGNvdXJzZS5tb2R1bGVzLmZpbmQobSA9PiBtLmlkID09PSBpZCkpXHJcbiAgICAgIC8vIElnbm9yZSBlbnRyaWVzIHRoYXQgb25seSBleGlzdHMgaW4gbW9kdWxlT3JkZXIgYnV0IG5vdCBpbiBtb2R1bGVzXHJcbiAgICAgIC5maWx0ZXIobSA9PiAhIW0pXHJcbiAgICAgIC8vIEFwcGVuZCBtb2R1bGVzIGF0IGVuZCB0aGF0IGFyZSBub3QgbGlzdGVkIGluIG1vZHVsZU9yZGVyXHJcbiAgICAgIC5jb25jYXQgKGNvdXJzZS5tb2R1bGVzLmZpbHRlcihtID0+ICFtb2R1bGVPcmRlci5maW5kKGlkID0+IG0uaWQgPT09IGlkKSkpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgcmVvcmRlciAobW9kdWxlSWQ6IHN0cmluZywgZGlyZWN0aW9uOiAtMSB8IDEpIHtcclxuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qgb3JkZXJlZE1vZHVsZXMgPSB0aGlzLmdldE9yZGVyZWRNb2R1bGVzKCk7XHJcbiAgICBjb25zdCBtb2R1bGVJbmRleCA9IG9yZGVyZWRNb2R1bGVzLmZpbmRJbmRleChtID0+IG0uaWQgPT09IG1vZHVsZUlkKTtcclxuICAgIGNvbnN0IG5ld01vZHVsZUluZGV4ID0gbW9kdWxlSW5kZXggKyBkaXJlY3Rpb247XHJcbiAgICBpZiAobmV3TW9kdWxlSW5kZXggPCAwIHx8IG5ld01vZHVsZUluZGV4ID49IG9yZGVyZWRNb2R1bGVzLmxlbmd0aCkge1xyXG4gICAgICAvLyBDYW5ub3Qgb3JkZXIgb3V0c2lkZSBsaW1pdHMuXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGN1cnJlbnRNb2R1bGVBdFBvc2l0aW9uID0gb3JkZXJlZE1vZHVsZXNbbmV3TW9kdWxlSW5kZXhdO1xyXG4gICAgY29uc3QgbW9kdWxlT3JkZXIgPSBvcmRlcmVkTW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcclxuICAgIG1vZHVsZU9yZGVyW25ld01vZHVsZUluZGV4XSA9IG1vZHVsZUlkO1xyXG4gICAgbW9kdWxlT3JkZXJbbW9kdWxlSW5kZXhdID0gY3VycmVudE1vZHVsZUF0UG9zaXRpb24uaWQ7XHJcbiAgICBjb25zdCBvcmlnU2Nyb2xsUG9zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcclxuICAgIGF3YWl0IHRoaXMucHJvcHMuaG9zdC51cGRhdGUoe1xyXG4gICAgICBtb2R1bGVPcmRlcjogeyRzZXQ6IG1vZHVsZU9yZGVyfVxyXG4gICAgfSk7XHJcbiAgICAvLyBOb3csIHNjcm9sbCBzbW9vdGhseSBpbnRvIHZpZXcgYWZ0ZXIgcmVvcmRlcmluZzpcclxuICAgIGNvbnN0IGVsZW1Nb2R1bGU6IEhUTUxFbGVtZW50ID0gZmluZERPTU5vZGUodGhpcy5fbW9kdWxlUmVmc1ttb2R1bGVJZF0pIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgaWYgKGVsZW1Nb2R1bGUpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oe3RvcDogb3JpZ1Njcm9sbFBvc30pOyAvLyBQcm9oaWJpdCBkZWZhdWx0IHNjcm9sbGluZyBkaXJlY3RseSB1cHdhcmRzIG9uIG1vdmUgdXAuXHJcbiAgICAgICAgaWYgKGVsZW1Nb2R1bGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wIDwgMCB8fCBlbGVtTW9kdWxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSA+IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQpIHtcclxuICAgICAgICAgIGVsZW1Nb2R1bGUuc2Nyb2xsSW50b1ZpZXcoe2JlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICdzdGFydCd9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAvLyBPbmx5IENocm9tZSBiZXRhIHN1cHBvcnRzIHRoZSBhcmd1bWVudHMgZ2l2ZW4gYWJvdmUuIERlZmF1bHQgZm9yIG9sZGVyIGJyb3dzZXJzLlxyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbyhudWxsLCBvcmlnU2Nyb2xsUG9zKTtcclxuICAgICAgICBpZiAoZWxlbU1vZHVsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgPCAwIHx8IGVsZW1Nb2R1bGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuYm90dG9tID4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCkge1xyXG4gICAgICAgICAgZWxlbU1vZHVsZS5zY3JvbGxJbnRvVmlldyh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgY291cnNlLCBob3N0LCBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCBtb2R1bGVPcmRlciA9IGNvdXJzZS5tb2R1bGVPcmRlciB8fCBjb3Vyc2UubW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcclxuICAgIGNvbnN0IG9yZGVyZWRNb2R1bGVzID0gdGhpcy5nZXRPcmRlcmVkTW9kdWxlcygpO1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCIgcmVmPXtlbGVtID0+IHRoaXMuX2VsZW0gPSBlbGVtfT5cclxuICAgICAge29yZGVyZWRNb2R1bGVzLm1hcChtb2R1bGUgPT4gPENvdXJzZU1vZHVsZUNvbXBvbmVudFxyXG4gICAgICAgIHJlZj17ZWxlbSA9PiB0aGlzLl9tb2R1bGVSZWZzW21vZHVsZS5pZF0gPSBlbGVtfVxyXG4gICAgICAgIGtleT17bW9kdWxlLmlkfVxyXG4gICAgICAgIGNvdXJzZT17Y291cnNlfVxyXG4gICAgICAgIG1vZHVsZT17bW9kdWxlfVxyXG4gICAgICAgIG9uUmVvcmRlcj17ZGlyZWN0aW9uID0+IHRoaXMucmVvcmRlcihtb2R1bGUuaWQsIGRpcmVjdGlvbil9XHJcbiAgICAgICAgZ2V0T3JkZXJlZE1vZHVsZXM9eygpPT50aGlzLmdldE9yZGVyZWRNb2R1bGVzKCl9XHJcbiAgICAgICAgaG9zdD17aG9zdH1cclxuICAgICAgICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrPXtpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfVxyXG4gICAgICAgLz4pfVxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKT0+dGhpcy5hZGRNb2R1bGUoKX0+XHJcbiAgICAgICAgTMOkZ2cgdGlsbCBrdXJzbW9kdWxcclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgSW1hZ2UsIFRhc2ssIERvY3VtZW50LCBBYmlsaXR5IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xyXG5pbXBvcnQgeyBFZGl0YWJsZVJlc291cmNlTGlzdCB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXJlc291cmNlLWxpc3QnO1xyXG5pbXBvcnQgeyBFZGl0YWJsZVRhc2tMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtdGFzay1saXN0JztcclxuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcclxuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7IFJlbmFtZWFibGVUZXh0IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3JlbmFtZWFibGUtdGV4dCc7XHJcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IEwsIHNob3dFcnJvciB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IFd5c2l3eWcgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zyc7XHJcbmltcG9ydCBhY3Rpb25zX3N3ZWRpc2ggZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy1zdic7XHJcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XHJcbmltcG9ydCB7IENvbnRlbnRFZGl0YWJsZUZpZWxkIH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL2NvbnRlbnQtZWRpdGFibGUtZmllbGQnO1xyXG5pbXBvcnQgeyBjb21wdXRlVXBkYXRlZE9yZGVyIH0gZnJvbSAnLi4vLi4vY291cnNlLWJ1aWxkZXIta3MvbG9naWMvdGFzay1vcmRlcic7XHJcbmltcG9ydCB7IGZlYXR1cmVzIH0gZnJvbSAnLi4vLi4vLi4vZmVhdHVyZXMnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBtb2R1bGU6IENvdXJzZU1vZHVsZTtcclxuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcclxuICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrOiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcclxuICBvblJlb3JkZXI6IChkaXJlY3Rpb246IDEgfCAtMSkgPT4gdm9pZDtcclxuICBnZXRPcmRlcmVkTW9kdWxlczogKCk9PkNvdXJzZU1vZHVsZVtdO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGVkaXRNYW5kYXRvcnlDb250ZW50OiBib29sZWFuO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX0tOT1dMRURHRV9NQVRSSVggPSBbe1xyXG4gIGFiaWxpdHlJZHM6IFtdLFxyXG4gIEVJZHM6IFtdLFxyXG4gIENJZHM6IFtdLFxyXG4gIEFJZHM6IFtdXHJcbn1dO1xyXG5cclxuZXhwb3J0IGNsYXNzIENvdXJzZU1vZHVsZUNvbXBvbmVudCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgZWRpdE1hbmRhdG9yeUNvbnRlbnQ6IGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRNb2R1bGVJbmRleCgpIHtcclxuICAgIGNvbnN0IHtjb3Vyc2UsIG1vZHVsZX0gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIGNvdXJzZS5tb2R1bGVzLmZpbmRJbmRleChtID0+IG0uaWQgPT09IG1vZHVsZS5pZCk7XHJcbiAgfVxyXG5cclxuICBnZXRNb2R1bGVPcmRlckluZGV4KCkge1xyXG4gICAgY29uc3Qge2NvdXJzZSwgbW9kdWxlfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCBvcmRlcmVkTW9kdWxlcyA9IHRoaXMucHJvcHMuZ2V0T3JkZXJlZE1vZHVsZXMoKTtcclxuICAgIHJldHVybiBvcmRlcmVkTW9kdWxlcy5maW5kSW5kZXgobSA9PiBtLmlkID09PSBtb2R1bGUuaWQpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTW9kdWxlKG1vZHVsZVVwZGF0ZXMpIHtcclxuICAgIGNvbnN0IHttb2R1bGV9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHVwZGF0ZWRNb2R1bGUgPSB1cGRhdGUobW9kdWxlLCBtb2R1bGVVcGRhdGVzKTtcclxuICAgIGNvbnN0IG1vZHVsZUluZGV4ID0gdGhpcy5nZXRNb2R1bGVJbmRleCgpO1xyXG4gICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZSh7IG1vZHVsZXM6IHsgJHNwbGljZTogW1ttb2R1bGVJbmRleCwgMSwgdXBkYXRlZE1vZHVsZV1dIH0gfSk7XHJcbiAgfVxyXG5cclxuICAvKiBUaGlzIG1ldGhvZCB3b3JrcyBmb3IgYm90aCBhZGRpbmcgbmV3IHRhc2tzIHRvIHRoZSB0YXNrIHRhYmxlXHJcbiAgYW5kIGFkZGluZyByZWZlcmVuY2VzIHRvIGV4aXN0aW5nIHRhc2tzLiBUaGUgbWFnaWMgb2YgdGhhdCBoYXMgdG8gZG8gd2l0aFxyXG4gIHdoZXRoZXIgdGFzay4kbWV0YSA9ICdhZGQnIG9yIG5vdCBhbmQgaXMgZG9uZSBpbiBFZGl0Q291cnNlLnNhdmUoKVxyXG4gICovXHJcbiAgb25UYXNrQWRkZWQgKHRhc2s6IFRhc2ssIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+IHwgbnVsbCkge1xyXG4gICAgLy8gQWRkIHRhc2sgSUQgdG8gbW9kdWxlIHRhc2tJZHMgbGlzdDpcclxuICAgIGNvbnN0IGNvdXJzZVVwZGF0ZXM6YW55ID0ge307XHJcbiAgICBjb25zdCB0YXNrSWRzID0gdGhpcy5wcm9wcy5tb2R1bGUudGFza0lkcy5zbGljZSgpO1xyXG4gICAgdGFza0lkcy5wdXNoKHRhc2suaWQpO1xyXG4gICAgLy8gQWRkIHBoeXNpY2FsIFRhc2sgdG8gQ291cnNlLnRhc2tzLlxyXG4gICAgaWYgKCF0aGlzLnByb3BzLmNvdXJzZS50YXNrcy5zb21lKHQgPT4gdC5pZCA9PT10YXNrLmlkKSkge1xyXG4gICAgICBjb3Vyc2VVcGRhdGVzLnRhc2tzID0geyRwdXNoOiBbdGFza119O1xyXG4gICAgfVxyXG4gICAgY29uc3QgY3VzdG9taXphdGlvbnMgPSB7Li4uKHRoaXMucHJvcHMubW9kdWxlLnRhc2tDdXN0b21pemF0aW9ucyB8fCB7fSl9O1xyXG4gICAgaWYgKHRhc2tDdXN0b21pemF0aW9uKSBjdXN0b21pemF0aW9uc1t0YXNrLmlkXSA9IHRhc2tDdXN0b21pemF0aW9uO1xyXG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XHJcbiAgICBjb3Vyc2VVcGRhdGVzLm1vZHVsZXMgPSB7fTtcclxuICAgIGNvdXJzZVVwZGF0ZXMubW9kdWxlc1ttb2R1bGVJbmRleF0gPSB7XHJcbiAgICAgIHRhc2tJZHM6IHskc2V0OiB0YXNrSWRzfSxcclxuICAgICAgdGFza0N1c3RvbWl6YXRpb25zOiB7JHNldDogY3VzdG9taXphdGlvbnN9XHJcbiAgICB9O1xyXG4gICAgLy8gVXBkYXRlIG1vZHVsZVxyXG4gICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZShjb3Vyc2VVcGRhdGVzKTtcclxuICB9XHJcblxyXG4gIG9uVGFza1VwZGF0ZWQgKHRhc2s6IFRhc2spIHtcclxuICAgIGlmICghdGFzay4kbWV0YSkgdGhyb3cgbmV3IEVycm9yKExgSG9wcHNhbiwgYmxldiBsaXRlIGtuYXMuIEZlbCBJRDogJHsnUGE3RHEnfWApO1xyXG4gICAgY29uc3QgdGFza0luZGV4ID0gdGhpcy5wcm9wcy5jb3Vyc2UudGFza3MuZmluZEluZGV4KHQgPT4gdC5pZCA9PT0gdGFzay5pZCk7XHJcbiAgICBpZiAodGFza0luZGV4ID49IDApIHtcclxuICAgICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZSh7dGFza3M6IHskc3BsaWNlOiBbW3Rhc2tJbmRleCwgMSwgdGFza11dfX0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb25UYXNrQ3VzdG9taXplZCAodGFza0lkOiBzdHJpbmcsIGN1c3RvbWl6YXRpb246IFBhcnRpYWw8VGFzaz4pIHtcclxuICAgIGNvbnN0IGN1c3RvbWl6YXRpb25zID0gey4uLih0aGlzLnByb3BzLm1vZHVsZS50YXNrQ3VzdG9taXphdGlvbnMgfHwge30pfTtcclxuICAgIGN1c3RvbWl6YXRpb25zW3Rhc2tJZF0gPSBjdXN0b21pemF0aW9uO1xyXG4gICAgdGhpcy51cGRhdGVNb2R1bGUoe3Rhc2tDdXN0b21pemF0aW9uczogeyRzZXQ6IGN1c3RvbWl6YXRpb25zfX0pO1xyXG4gIH1cclxuXHJcbiAgb25UYXNrRGVsZXRlZCAoaWQ6IHN0cmluZykge1xyXG4gICAgLy8gUmVtb3ZlIHRhc2sgSUQgZnJvbSBtb2R1bGUgdGFza0lkcyBsaXN0LlxyXG4gICAgLy8gVGhpcyBkZXBlbmRzIG9uIHRoZSBmYWN0IHRoYXQgRWRpdENvdXJzZS5fc2V0U3RhdGUoKSBtYWludGFpbnNcclxuICAgIC8vIHJlbW92ZWQgVGFzayBsaW5rcyAod2hpY2ggaXQgYWN0dWFsbHkgZG9lcyAob3Igc2hvdWxkIGRvIGF0IGxlYXN0KSkuXHJcbiAgICB0aGlzLnVwZGF0ZU1vZHVsZSh7XHJcbiAgICAgIHRhc2tJZHM6IHskc2V0OiB0aGlzLnByb3BzLm1vZHVsZS50YXNrSWRzLmZpbHRlcih0aWQgPT4gdGlkICE9PSBpZCl9LFxyXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbnM6IHtcclxuICAgICAgICAkYXBwbHk6IGN1c3RvbWl6YXRpb25zID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNvcHkgPSB7Li4uY3VzdG9taXphdGlvbnN9O1xyXG4gICAgICAgICAgZGVsZXRlIGNvcHlbaWRdO1xyXG4gICAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9uVGFza1JlcGxhY2VkIChpZDogc3RyaW5nLCB0YXNrOiBUYXNrKSB7XHJcbiAgICBjb25zdCBpZHhUYXNrID0gdGhpcy5wcm9wcy5tb2R1bGUudGFza0lkcy5pbmRleE9mKGlkKTtcclxuICAgIGlmIChpZHhUYXNrIDwgMCkge1xyXG4gICAgICBzaG93RXJyb3IoTGBLdW5kZSBpbnRlIHNwYXJhIHVwcGdpZnQuIEZlbGtvZCBkNzJrUWApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBtb2R1bGVVcGRhdGVzID0ge1xyXG4gICAgICAvLyBSZXBsYWNlIG9sZCBpZCB3aXRoIG5ldyBpZDpcclxuICAgICAgdGFza0lkczogeyRzcGxpY2U6IFtbaWR4VGFzaywgMSwgdGFzay5pZF1dfSxcclxuICAgICAgdGFza0N1c3RvbWl6YXRpb25zOiB7XHJcbiAgICAgICAgJGFwcGx5OiBjdXN0b21pemF0aW9ucyA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjb3B5ID0gey4uLmN1c3RvbWl6YXRpb25zfTtcclxuICAgICAgICAgIGRlbGV0ZSBjb3B5W2lkXTtcclxuICAgICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY29uc3QgdXBkYXRlZE1vZHVsZSA9IHVwZGF0ZSh0aGlzLnByb3BzLm1vZHVsZSwgbW9kdWxlVXBkYXRlcyk7XHJcbiAgICBjb25zdCBtb2R1bGVJbmRleCA9IHRoaXMuZ2V0TW9kdWxlSW5kZXgoKTtcclxuICAgIHRoaXMucHJvcHMuaG9zdC51cGRhdGUoe1xyXG4gICAgICAvLyBBcHBseSBtb2R1bGVVcGRhdGVzIGZyb20gYWJvdmU6XHJcbiAgICAgIG1vZHVsZXM6IHsgJHNwbGljZTogW1ttb2R1bGVJbmRleCwgMSwgdXBkYXRlZE1vZHVsZV1dIH0sXHJcbiAgICAgIC8vIEFkZCB0aGUgbmV3IHRhc2sgdG8gQ291cnNlLnRhc2tzLlxyXG4gICAgICAvLyBEb24ndCByZW1vdmUgdGhlIG9sZCBvbmUhIFdoeT8gQmVjYXVzZSBpdCBtYXkgYmUgcmVmZXJlbmNlZFxyXG4gICAgICAvLyBieSBhbm90aGVyIG1vZHVsZSBpbiBzYW1lIGNvdXJzZSEgTGV0IEVkaXRDb3Vyc2UuX3NldFN0YXRlKClcclxuICAgICAgLy8gZG8gdGhlIFwiZ2FyYmFnZSBjb2xsZWN0aW9uXCIgaW5zdGVhZC5cclxuICAgICAgdGFza3M6IHsgJHNldDogdGhpcy5wcm9wcy5jb3Vyc2UudGFza3MuY29uY2F0KHRhc2spfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvblRhc2tzUmVvcmRlcmVkIChzb3VyY2U6IFRhc2ssIHRhcmdldDogVGFzaywgcGxhY2VtZW50OiAnYmVmb3JlJyB8ICdhZnRlcicpIHtcclxuICAgIGNvbnN0IG5ld1Rhc2tJZHMgPSBjb21wdXRlVXBkYXRlZE9yZGVyKFxyXG4gICAgICB0aGlzLnByb3BzLmNvdXJzZS50YXNrcyxcclxuICAgICAgdGhpcy5wcm9wcy5tb2R1bGUudGFza0lkcyxcclxuICAgICAgc291cmNlLFxyXG4gICAgICB0YXJnZXQsXHJcbiAgICAgIHBsYWNlbWVudCxcclxuICAgICAge2FwcGVuZExlZnRvdmVyczogZmFsc2V9KTtcclxuXHJcbiAgICB0aGlzLnVwZGF0ZU1vZHVsZSh7XHJcbiAgICAgIHRhc2tJZHM6IHskc2V0OiBuZXdUYXNrSWRzfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZSwgaG9zdCwgbW9kdWxlLCBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XHJcbiAgICBjb25zdCBtb2R1bGVPcmRlcmVkSW5kZXggPSB0aGlzLmdldE1vZHVsZU9yZGVySW5kZXgoKTtcclxuICAgIGxldCBrbm93bGVkZ2VNYXRyaXhEaXY7XHJcblxyXG4gICAgY29uc3QgdXBkYXRlTW9kdWxlID0gdGhpcy51cGRhdGVNb2R1bGUuYmluZCh0aGlzKTtcclxuICAgIGxldCB3ZWVrID0gMTtcclxuICAgIGNvbnN0IHN0YXJ0V2Vla09wdGlvbnMgPSBbXCItLVwiXTtcclxuICAgIGNvbnN0IGVuZFdlZWtPcHRpb25zID0gW1wiLS1cIl07XHJcbiAgICBmb3IgKGxldCBpPTA7IGk8NTE7ICsraSkge1xyXG4gICAgICBzdGFydFdlZWtPcHRpb25zLnB1c2goJycrIHdlZWspO1xyXG4gICAgICBlbmRXZWVrT3B0aW9ucy5wdXNoKCcnKyArK3dlZWspO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgcmV0dXJuIDxPcGVuQ2xvc2VCb3ggaW5hY3RpdmF0ZWQ9eyFmZWF0dXJlcy5jYkNvbGxhcHNlQm94ZXN9IHRpdGxlPXs8PlxyXG4gICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6IFwicmlnaHRcIn19PlxyXG4gICAgICB7bW9kdWxlT3JkZXJlZEluZGV4ID4gMCAmJiA8c3Bhbj5cclxuICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hcnJvdy1jaXJjbGUtdXAgc2VsZWN0YWJsZVwiXHJcbiAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxyXG4gICAgICAgICAgb25DbGljaz17ZT0+e2Uuc3RvcFByb3BhZ2F0aW9uKCk7IHRoaXMucHJvcHMub25SZW9yZGVyKC0xKX19IC8+IDwvc3Bhbj59XHJcbiAgICAgIHttb2R1bGVPcmRlcmVkSW5kZXggPCBjb3Vyc2UubW9kdWxlcy5sZW5ndGggLSAxICYmIDxzcGFuPlxyXG4gICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWFycm93LWNpcmNsZS1kb3duIHNlbGVjdGFibGVcIlxyXG4gICAgICAgICAgYXJpYS1oaWRkZW49XCJ0cnVlXCJcclxuICAgICAgICAgIG9uQ2xpY2s9e2U9PntlLnN0b3BQcm9wYWdhdGlvbigpO3RoaXMucHJvcHMub25SZW9yZGVyKDEpfX0gLz4gPC9zcGFuPn1cclxuICAgICAgPFJlbW92ZUl0ZW1cclxuICAgICAgICB0aXRsZT1cIlRhIGJvcnQgbW9kdWxlblwiXHJcbiAgICAgICAgc3R5bGU9e3tkaXNwbGF5OiAnaW5saW5lLWJsb2NrJ319XHJcbiAgICAgICAgb25DbGljaz17ZT0+e2Uuc3RvcFByb3BhZ2F0aW9uKCk7IGNvbmZpcm0oTGBUYSBib3J0IG1vZHVsICR7bW9kdWxlLm5hbWV9P2ApICYmIGhvc3QudXBkYXRlKHttb2R1bGVzOiB7JHNwbGljZTogW1ttb2R1bGVJbmRleCwgMV1dfX0pfX0gLz5cclxuICAgIDwvZGl2PlxyXG4gICAgPHA+e21vZHVsZS5uYW1lfTwvcD5cclxuICAgIDwvPn0gaGVhZGVyT3Blbj17bW9kdWxlLm5hbWUgPT0gJ055IGt1cnNtb2R1bCd9PlxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJjb3Vyc2UtbW9kdWxlIGtlZF9ib3hlZFwiIHN0eWxlPXt7cG9zaXRpb246ICdyZWxhdGl2ZSd9fT5cclxuICAgICAgPENvbnRlbnRFZGl0YWJsZUZpZWxkXHJcbiAgICAgICAgdGV4dD17bW9kdWxlLm5hbWV9XHJcbiAgICAgICAgdGFnPSdoMydcclxuICAgICAgICBjbGFzc05hbWU9J3JlbmFtZWFibGUtdGV4dCdcclxuICAgICAgICBtYXhDaGFycz17MTAwfVxyXG4gICAgICAgIHBsYWNlaG9sZGVyPVwiTmFtbmzDtnMgbW9kdWxcIlxyXG4gICAgICAgIG9uQ2hhbmdlPXtuZXdOYW1lID0+IHVwZGF0ZU1vZHVsZSh7bmFtZTogeyRzZXQ6IG5ld05hbWV9fSl9XHJcbiAgICAgIC8+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbCBzcGFjZWRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIGNlbnRlclwiPlxyXG4gICAgICAgICAgPHA+U3RhcnR2ZWNrYTwvcD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIGNlbnRlclwiPlxyXG4gICAgICAgICAgPHNlbGVjdCB2YWx1ZT17bW9kdWxlLnN0YXJ0V2VlayB8fCBcIi0tXCJ9XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB1cGRhdGVNb2R1bGUoe3N0YXJ0V2Vlazoge1xyXG4gICAgICAgICAgICAgICRzZXQ6IGV2LnRhcmdldC52YWx1ZSA9PT0gJy0tJyA/XHJcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxyXG4gICAgICAgICAgICAgICAgcGFyc2VJbnQoZXYudGFyZ2V0LnZhbHVlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KX0+XHJcbiAgICAgICAgICAgIHtzdGFydFdlZWtPcHRpb25zLm1hcChvID0+IDxvcHRpb24ga2V5PXtvfSB2YWx1ZT17b30+e299PC9vcHRpb24+KX1cclxuICAgICAgICAgIDwvc2VsZWN0PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gY2VudGVyXCI+XHJcbiAgICAgICAgICA8cD5TbHV0dmVja2E8L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSBjZW50ZXJcIj5cclxuICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e21vZHVsZS5lbmRXZWVrIHx8IFwiLS1cIn1cclxuICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHVwZGF0ZU1vZHVsZSh7ZW5kV2Vlazoge1xyXG4gICAgICAgICAgICAgICRzZXQ6IGV2LnRhcmdldC52YWx1ZSA9PT0gJy0tJyA/XHJcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxyXG4gICAgICAgICAgICAgICAgcGFyc2VJbnQoZXYudGFyZ2V0LnZhbHVlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KX0+XHJcbiAgICAgICAgICAgIHtlbmRXZWVrT3B0aW9ucy5tYXAobyA9PiA8b3B0aW9uIGtleT17b30gdmFsdWU9e299PntvfTwvb3B0aW9uPil9XHJcbiAgICAgICAgICA8L3NlbGVjdD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxoND5LdXJzbW9kdWxlbnMgaW50cm9kdWt0aW9uPC9oND5cclxuICAgICAgPFd5c2l3eWdcclxuICAgICAgICBhY3Rpb25zPXtbXHJcbiAgICAgICAgICBcImJvbGRcIixcclxuICAgICAgICAgIFwiaXRhbGljXCIsXHJcbiAgICAgICAgICBcInVuZGVybGluZVwiLFxyXG4gICAgICAgICAgXCJzdHJpa2V0aHJvdWdoXCIsXHJcbiAgICAgICAgICBcImhlYWRpbmcyXCIsXHJcbiAgICAgICAgICBcImhlYWRpbmczXCIsXHJcbiAgICAgICAgICBcIm9saXN0XCIsXHJcbiAgICAgICAgICBcInVsaXN0XCIsXHJcbiAgICAgICAgICBcImxpbmVcIixcclxuICAgICAgICAgIFwibGlua1wiLFxyXG4gICAgICAgICAgXCJpbWFnZVwiXX1cclxuICAgICAgICBkZWZhdWx0QWN0aW9ucz17YWN0aW9uc19zd2VkaXNofVxyXG4gICAgICAgIGh0bWw9e21vZHVsZS5tYW5kYXRvcnlDb250ZW50fVxyXG4gICAgICAgIG9uQ2hhbmdlPXtodG1sID0+IHtcclxuICAgICAgICAgIHVwZGF0ZU1vZHVsZSh7bWFuZGF0b3J5Q29udGVudDogeyRzZXQ6IGh0bWx9fSlcclxuICAgICAgICB9fSAvPlxyXG5cclxuICAgICAgPGg0PlVwcGdpZnRlcjwvaDQ+XHJcbiAgICAgIDxFZGl0YWJsZVRhc2tMaXN0XHJcbiAgICAgICAgdGFza0lkcz17bW9kdWxlLnRhc2tJZHN9XHJcbiAgICAgICAgdGFza0N1c3RvbWl6YXRpb25zPXttb2R1bGUudGFza0N1c3RvbWl6YXRpb25zfVxyXG4gICAgICAgIGNvdXJzZT17Y291cnNlfVxyXG4gICAgICAgIG1vZHVsZT17bW9kdWxlfVxyXG4gICAgICAgIGhvc3Q9e2hvc3R9XHJcbiAgICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzaz17aWRzTm90Q292ZXJlZEJ5QW55VGFza31cclxuICAgICAgICBvblRhc2tBZGRlZD17KHRhc2s6IFRhc2ssIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+KSA9PiB0aGlzLm9uVGFza0FkZGVkKHRhc2ssIHRhc2tDdXN0b21pemF0aW9uKX1cclxuICAgICAgICBvblRhc2tVcGRhdGVkPXsodGFzazogVGFzaykgPT4gdGhpcy5vblRhc2tVcGRhdGVkKHRhc2spfVxyXG4gICAgICAgIG9uVGFza0N1c3RvbWl6YXRpb25VcGRhdGVkPXsodGFza0lkOiBzdHJpbmcsIGN1c3RvbWl6YXRpb246IFBhcnRpYWw8VGFzaz4pID0+XHJcbiAgICAgICAgICB0aGlzLm9uVGFza0N1c3RvbWl6ZWQodGFza0lkLCBjdXN0b21pemF0aW9uKX1cclxuICAgICAgICBvblRhc2tEZWxldGVkPXsoaWQ6IHN0cmluZykgPT4gdGhpcy5vblRhc2tEZWxldGVkKGlkKX1cclxuICAgICAgICBvblRhc2tSZXBsYWNlZD17KGlkOiBzdHJpbmcsIHRhc2s6IFRhc2spID0+IHRoaXMub25UYXNrUmVwbGFjZWQoaWQsIHRhc2spfVxyXG4gICAgICAgIG9uVGFza3NSZW9yZGVyZWQ9eyhzb3VyY2UsIHRhcmdldCwgcGxhY2VtZW50KSA9PiB0aGlzLm9uVGFza3NSZW9yZGVyZWQoc291cmNlLCB0YXJnZXQsIHBsYWNlbWVudCl9IC8+XHJcblxyXG4gICAgICA8aDQ+TW9kdWxyZXN1cnNlcjwvaDQ+XHJcbiAgICAgIDxwIGNsYXNzTmFtZT1cInN1YkhlYWRlclwiPihFdmVudHVlbGxhIHJlc3VzZXIgZsO2ciByZWRvdmlzbmluZyBhdiBtb2R1bGVuIHNhbXQgZsO2ciBtb2R1bGVuIHNvbSBoZWxoZXQpPC9wPlxyXG4gICAgICA8RWRpdGFibGVSZXNvdXJjZUxpc3RcclxuICAgICAgICByZXNvdXJjZXM9e21vZHVsZS5yZXNvdXJjZXN9XHJcbiAgICAgICAgb25VcGRhdGU9e3Jlc291cmNlc1VwZGF0ZXMgPT4gdXBkYXRlTW9kdWxlKHsgcmVzb3VyY2VzOiByZXNvdXJjZXNVcGRhdGVzIH0pfVxyXG4gICAgICAgIGhvc3Q9e2hvc3R9IC8+XHJcbiAgICAgIDxkaXYgc3R5bGU9e3twb3NpdGlvbjogJ2Fic29sdXRlJywgdG9wOiAwLCByaWdodDogMH19PlxyXG4gICAgICAgIHttb2R1bGVPcmRlcmVkSW5kZXggPiAwICYmIDxzcGFuPlxyXG4gICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYXJyb3ctY2lyY2xlLXVwIHNlbGVjdGFibGVcIlxyXG4gICAgICAgICAgICBhcmlhLWhpZGRlbj1cInRydWVcIlxyXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5wcm9wcy5vblJlb3JkZXIoLTEpfSAvPiA8L3NwYW4+fVxyXG4gICAgICAgIHttb2R1bGVPcmRlcmVkSW5kZXggPCBjb3Vyc2UubW9kdWxlcy5sZW5ndGggLSAxICYmIDxzcGFuPlxyXG4gICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYXJyb3ctY2lyY2xlLWRvd24gc2VsZWN0YWJsZVwiXHJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXHJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLnByb3BzLm9uUmVvcmRlcigxKX0gLz4gPC9zcGFuPn1cclxuICAgICAgICA8UmVtb3ZlSXRlbVxyXG4gICAgICAgICAgdGl0bGU9XCJUYSBib3J0IG1vZHVsZW5cIlxyXG4gICAgICAgICAgc3R5bGU9e3tkaXNwbGF5OiAnaW5saW5lLWJsb2NrJ319XHJcbiAgICAgICAgICBvbkNsaWNrPXsoKT0+Y29uZmlybShMYFRhIGJvcnQgbW9kdWwgJHttb2R1bGUubmFtZX0/YCkgJiYgaG9zdC51cGRhdGUoe21vZHVsZXM6IHskc3BsaWNlOiBbW21vZHVsZUluZGV4LCAxXV19fSl9IC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWwtYWxpZ25cIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YUl0ZW0gYWN0aXZhdGVDb3Vyc2VNb2R1bGVcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcImJ0biBidG4taW5mb1wiICsgKG1vZHVsZS5pbmFjdGl2ZSA/IFwiIGJ0bi1hY3RpdmF0ZVwiIDogXCIgYnRuLWluYWN0aXZhdGVcIil9IG9uQ2xpY2s9eygpPT4gdXBkYXRlTW9kdWxlKHtpbmFjdGl2ZTogeyRzZXQ6ICFtb2R1bGUuaW5hY3RpdmV9fSl9PlxyXG4gICAgICAgICAgICB7bW9kdWxlLmluYWN0aXZlID8gJ0FrdGl2ZXJhIG1vZHVsZW4nIDogJ0luYWt0aXZlcmEgbW9kdWxlbid9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgICA8L09wZW5DbG9zZUJveD5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4vY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgeyBMLCBzaG93RXJyb3IsIGZsYXR0ZW4sIGNvbXBhcmVQcm9wLCBzaG93SW5mbywgbWF4TGVuZ3RoLCBjYXBpdGFsaXplRmlyc3QgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IHsgQ291cnNlLCBTdWJqZWN0IH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgTGluayB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcclxuaW1wb3J0IHsgU2Nob29sQ291cnNlcyB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zY2hvb2wtY291cnNlc1wiO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBmZWVkYmFja1VybDogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGNvdXJzZU9wdGlvbnM6IENvdXJzZU9wdGlvbltdO1xyXG4gIHNlbGVjdGVkVGVtcGxhdGVJZDogc3RyaW5nO1xyXG4gIGNvdXJzZXM6IENvdXJzZU9wdGlvbltdIHwgbnVsbDtcclxuICBzZWxlY3RlZENvdXJzZUlkOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBDb3Vyc2VPcHRpb24ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ3JlYXRlTmV3Q291cnNlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBjb3Vyc2VPcHRpb25zOiBudWxsLFxyXG4gICAgICBzZWxlY3RlZFRlbXBsYXRlSWQ6IFwiLS1cIixcclxuICAgICAgY291cnNlczogbnVsbCxcclxuICAgICAgc2VsZWN0ZWRDb3Vyc2VJZDogXCJcIlxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChzaG93RXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZCgpIHtcclxuICAgIHNob3dJbmZvKFwiTGFkZGFyIGt1cnNlclwiKTtcclxuICAgIGNvbnN0IHN1YmplY3RzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTdWJqZWN0PihcInN1YmplY3RzXCIsIHtcclxuICAgICAgdGFnczogW1wic2Nob29sVHlwZTpneW1uYXNpdW1cIl0sXHJcbiAgICAgIGluY2x1ZGU6IFwiY291cnNlVGVtcGxhdGVzXCJcclxuICAgIH0pO1xyXG4gICAgY29uc3QgY291cnNlcyA9IGZsYXR0ZW4oc3ViamVjdHMubWFwKHMgPT4gcy5jb3Vyc2VUZW1wbGF0ZXMpKS5zb3J0KGNvbXBhcmVQcm9wKFwibmFtZVwiKSk7XHJcbiAgICBjb25zdCBjb3Vyc2VPcHRpb25zOiBDb3Vyc2VPcHRpb25bXSA9XHJcbiAgICAgIFt7IGlkOiBcIi0tXCIsIG5hbWU6IFwiLS1cIiB9XS5jb25jYXQoY291cnNlcyk7XHJcbiAgICBzaG93SW5mbyhcIlwiKTtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyBjb3Vyc2VPcHRpb25zIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgb25TZWxlY3RDb3Vyc2UoaWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgZGVyaXZlZENvdXJzZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PENvdXJzZT4oXCJjb3Vyc2VzXCIsIHsgaGFzRWRnZXNUbzogW2lkXSB9KTtcclxuICAgIGNvbnN0IGNvdXJzZU9wdGlvbnMgPSBkZXJpdmVkQ291cnNlc1xyXG4gICAgICAuZmlsdGVyKGNvdXJzZSA9PiBjb3Vyc2UuYWN0aXZlKVxyXG4gICAgICAubWFwKCh7IGlkLCBzY2hvb2wsIGRlc2NyaXB0aW9uLCBjcmVhdGVkQnksIG1vZGlmaWVkQnkgfSkgPT4ge1xyXG4gICAgICAgIGlmIChkZXNjcmlwdGlvbikgZGVzY3JpcHRpb24gPSBtYXhMZW5ndGgoZGVzY3JpcHRpb24sIDgwKTtcclxuICAgICAgICBsZXQgZGVzY3JpcHRpb25PckF1dGhvciA9IGRlc2NyaXB0aW9uIHx8XHJcbiAgICAgICAgICAoY3JlYXRlZEJ5ID8gYCR7Y3JlYXRlZEJ5Lm5hbWV9cyB2ZXJzaW9uYCA6XHJcbiAgICAgICAgICBtb2RpZmllZEJ5ICYmIGAke21vZGlmaWVkQnkubmFtZX1zIHZlcnNpb25gKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgaWQsXHJcbiAgICAgICAgICBuYW1lOiBzY2hvb2wgPT09ICdzdGFuZGFyZCcgP1xyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbiA/IGBTdGFuZGFyZCAtICR7ZGVzY3JpcHRpb259YCA6IFwiU3RhbmRhcmRcIiA6XHJcbiAgICAgICAgICAgIGAke3NjaG9vbH0gLSAke21heExlbmd0aChkZXNjcmlwdGlvbk9yQXV0aG9yLCA5MCl9YCxcclxuICAgICAgICAgIHNjaG9vbFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0pLnNvcnQoY29tcGFyZVByb3AoXCJuYW1lXCIpKTtcclxuICAgIGNvbnN0IGtlZFN0YW5kYXJkT3B0aW9ucyA9IGNvdXJzZU9wdGlvbnMuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24uc2Nob29sID09PSBcInN0YW5kYXJkXCIpO1xyXG4gICAgY29uc3QgdGVhY2hlck1hZGUgPSBjb3Vyc2VPcHRpb25zLmZpbHRlcihvcHRpb24gPT4gb3B0aW9uLnNjaG9vbCAhPT0gXCJzdGFuZGFyZFwiKTtcclxuICAgIGNvbnN0IGNvdXJzZXMgPSBbXHJcbiAgICAgIC4uLmtlZFN0YW5kYXJkT3B0aW9ucyxcclxuICAgICAgeyBpZCwgbmFtZTogXCJUb21cIiB9LFxyXG4gICAgICAuLi50ZWFjaGVyTWFkZV07XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgY291cnNlcyxcclxuICAgICAgc2VsZWN0ZWRUZW1wbGF0ZUlkOiBpZCxcclxuICAgICAgc2VsZWN0ZWRDb3Vyc2VJZDogY291cnNlc1swXS5pZFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZU9wdGlvbnMsIHNlbGVjdGVkVGVtcGxhdGVJZCwgY291cnNlcywgc2VsZWN0ZWRDb3Vyc2VJZCB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIHJldHVybiA8ZGl2IHN0eWxlPXt7IG91dGxpbmU6IDAgfX0+XHJcbiAgICAgIDxDb3Vyc2VCYW5uZXJcclxuICAgICAgICB0aXRsZT17TGBLdXJzYnlnZ2FyZW5gfVxyXG4gICAgICAgIGFjdGl2ZVBhZ2U9XCJjb3Vyc2VCdWlsZGVyXCJcclxuICAgICAgICByb3V0ZXM9e3tmZWVkYmFjazogdGhpcy5wcm9wcy5mZWVkYmFja1VybH19XHJcbiAgICAgIC8+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zcGFjZXItMjBweHZ0IHN2LXZlcnRpY2FsIHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2Vjb250ZW50IHN2LWxheW91dCBzdi1zcGFjZXItMjBweHZ0IHN2LXNraXAtc3BhY2VyXCI+XHJcblxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e1wic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi03XCJ9PlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGgyPlNrYXBhIG55IGt1cnM8L2gyPlxyXG4gICAgICAgICAgICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbCBzcGFjZWRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwPlbDpGxqIGd5bW5hc2lla3VycyA6PC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgeyFjb3Vyc2VPcHRpb25zID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PjxTcGlubmVyIC8+PHNlbGVjdCBkaXNhYmxlZCB2YWx1ZT1cIlwiPjxvcHRpb24+LS08L29wdGlvbj48L3NlbGVjdD48L2Rpdj4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnNlbGVjdGVkVGVtcGxhdGVJZH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLm9uU2VsZWN0Q291cnNlKGV2LnRhcmdldC52YWx1ZSkuY2F0Y2goc2hvd0Vycm9yKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291cnNlT3B0aW9ucy5tYXAoY291cnNlID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24ga2V5PXtjb3Vyc2UuaWR9IHZhbHVlPXtjb3Vyc2UuaWR9Pntjb3Vyc2UubmFtZX08L29wdGlvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+fVxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAge2NvdXJzZXMgJiYgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHA+VXRnw6UgZnLDpW4gdmVyc2lvbjogPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgICAgICAgICAgICAgIHtjb3Vyc2VzICYmIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbCBzcGFjZWRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e3NlbGVjdGVkQ291cnNlSWR9IG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZENvdXJzZUlkOiBldi50YXJnZXQudmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtjb3Vyc2VzLm1hcChjb3Vyc2UgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24ga2V5PXtjb3Vyc2UuaWR9IHZhbHVlPXtjb3Vyc2UuaWR9Pntjb3Vyc2UubmFtZX08L29wdGlvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3NlbGVjdD5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgICAgICAgICAgICA8YnIgLz48YnIgLz5cclxuICAgICAgICAgICAgICAgICAgICB7Y291cnNlcyAmJiBzZWxlY3RlZENvdXJzZUlkICYmIDxMaW5rXHJcbiAgICAgICAgICAgICAgICAgICAgICB0bz17YC9jb3Vyc2VzL2NyZWF0ZS1mcm9tLXRlbXBsYXRlLyR7dGhpcy5zdGF0ZS5zZWxlY3RlZENvdXJzZUlkfWB9XHJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlXCJcclxuICAgICAgICAgICAgICAgICAgICA+U2thcGE8L0xpbms+fVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3YtY29sdW1uLTVcIj5cclxuICAgICAgICAgICAgICAgICAgPFNjaG9vbENvdXJzZXMgLz5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IGZpbmRET01Ob2RlIH0gZnJvbSAncmVhY3QtZG9tJztcclxuaW1wb3J0IHsgTCwgc2hvd0luZm8sIHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7aGFzQ2hhbmdlc30gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIFJlc291cmNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgU3ViamVjdCwgQWJpbGl0eSwgVGFzaywgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBCYXRjaFJ1bm5lciwgSHR0cEVycm9yLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gJy4vY291cnNlLWJhbm5lcic7XHJcbmltcG9ydCB7IElubmVyRWRpdENvdXJzZSB9IGZyb20gJy4vaW5uZXItZWRpdC1jb3Vyc2UnO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyB1cGRhdGVEb2N1bWVudEdyYXBocywgYXBwbHlFdGFncywgdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cywgbG9hZENvdXJzZSwgdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMsIHVwZGF0ZUNyZWF0aW9uU3RhbXAsIHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wIH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCwgRGlhbG9nLCBEaWFsb2dDb250YWluZXIgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XHJcbmltcG9ydCB7IGdldFVuY292ZXJlZEtub3dsZWRnZVJlcXVpcmVtZW50cywgZ2V0SWRzTm90Q292ZXJlZEJ5VGFza3MsIGdldFNvZnRBY2Nlc3NMaXN0IH0gZnJvbSAnLi9idXNpbmVzcy1sb2dpYyc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XHJcbmltcG9ydCB7IG15U2Nob29sQ291cnNlc1JlcG8gfSBmcm9tICcuLi8uLi8uLi9yZXBvcy9zY2hvb2wtY291cnNlcyc7XHJcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSBcIi4uLy4uLy4uL2FjY2Vzcy1jb250cm9sXCI7XHJcbmltcG9ydCB7IGdldEN1cnJlbnRVc2VyIH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9jdXJyZW50LXVzZXInO1xyXG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uLy4uL2ZlYXR1cmVzL2ZlYXR1cmVzJztcclxuaW1wb3J0IHsgQ2xhc3Nyb29tU3luYyB9IGZyb20gJy4uLy4uLy4uL2FwaXMvZ29vZ2xlLWNsYXNzcm9vbS1zeW5jJztcclxuXHJcbmNvbnN0IGNhdGNoZXIgPSBjZmcuRU5WSVJPTk1FTlQgPT09ICdwcm9kdWN0aW9uJyA/XHJcbiAgc2hvd0Vycm9yIDogbnVsbDtcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbiAgc3ViamVjdElkPzogc3RyaW5nO1xyXG4gIGlzVGVtcGxhdGU/OiBib29sZWFuO1xyXG4gIHRlbXBsYXRlSWQ/OiBzdHJpbmc7XHJcbiAgdmlldz86ICdzdHVkZW50UGFnZScgfCAnY291cnNlQnVpbGRlcicgfCAndGVtcGxhdGVCdWlsZGVyJztcclxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XHJcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBvcmlnQ291cnNlOiBDb3Vyc2UgfCBudWxsO1xyXG4gIG9yaWdUZW1wbGF0ZTogQ291cnNlIHwgbnVsbDtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBhbGxDb3Vyc2VzPzogQ291cnNlW107XHJcbiAgZGlhbG9nQ29udGFpbmVyczogRGlhbG9nQ29udGFpbmVyW107IC8vIFdoZW4gZWRpdGluZyBpdGVtcywgaXQgbWF5IHNob3cgYXMgYSBkaWFsb2dcclxuICBoYXNVbnNhdmVkRGF0YTogYm9vbGVhbjtcclxuICB2aWV3OiAnc3R1ZGVudFBhZ2UnIHwgJ2NvdXJzZUJ1aWxkZXInIHwgJ3RlbXBsYXRlQnVpbGRlcic7XHJcbiAgY2xhc3Nyb29tU3luY0luUHJvZ3Jlc3M6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNvbnN0IENPTkZJUk1fTkFWSUdBVEVfTUVTU0FHRSA9XHJcbiAgTGBEdSBoYXIgb3NwYXJhdCBkYXRhLiBWw6RsaiBhdmJyeXQgb2NoIHRyeWNrIENUUkwrUyBvbSBkdSB2aWxsIHNwYXJhIGbDtnJzdC5gO1xyXG4gIFxyXG5jb25zdCBERUZBVUxUX1NUQVRFOiBTdGF0ZSA9IHtcclxuICBvcmlnQ291cnNlOiBudWxsLFxyXG4gIG9yaWdUZW1wbGF0ZTogbnVsbCxcclxuICBjb3Vyc2U6IG51bGwsXHJcbiAgZGlhbG9nQ29udGFpbmVyczogW10sXHJcbiAgaGFzVW5zYXZlZERhdGE6IGZhbHNlLFxyXG4gIHZpZXc6ICdjb3Vyc2VCdWlsZGVyJyxcclxuICBjbGFzc3Jvb21TeW5jSW5Qcm9ncmVzczogZmFsc2VcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBFZGl0Q291cnNlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiBpbXBsZW1lbnRzIElDb3Vyc2VFZGl0b3JIb3N0IHtcclxuICBwYWdlWU9mZnNldDogbnVtYmVyO1xyXG4gIGNvbnRlbnREaXY6IEhUTUxEaXZFbGVtZW50O1xyXG4gIGNvbnRlbnRZUG9zOiBudW1iZXI7XHJcbiAgaXNTYXZpbmc6IGJvb2xlYW47XHJcbiAgZGlhbG9nczogRGlhbG9nW107XHJcblxyXG4gIHNldFN0YXRlUHJvbWlzZWQgKHN0YXRlOiBQYXJ0aWFsPFN0YXRlPikgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX3NldFN0YXRlKHtoYXNVbnNhdmVkRGF0YTogdHJ1ZSwgLi4uc3RhdGV9KTtcclxuICB9XHJcblxyXG4gIHNldE5vblNhdmVhYmxlRGF0YVN0YXRlIChzdGF0ZTogUGFydGlhbDxTdGF0ZT4pIDogUHJvbWlzZTxhbnk+IHtcclxuICAgIHJldHVybiB0aGlzLl9zZXRTdGF0ZShzdGF0ZSk7XHJcbiAgfVxyXG5cclxuICBfc2V0U3RhdGUgKHN0YXRlOiBQYXJ0aWFsPFN0YXRlPikgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgaWYgKHN0YXRlLmNvdXJzZSkge1xyXG4gICAgICB7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBNYWludGFpbiBjb3Vyc2UgdGFzayBsaW5rcyAocmVtb3ZlIGxpbmtzIHRvIHRhc2tzIHRoYXQgYXJlIG5vdCB1c2VkXHJcbiAgICAgICAgLy8gYnkgYW55IG1vZHVsZSlcclxuICAgICAgICAvL1xyXG4gICAgICAgIGNvbnN0IHt0YXNrcywgbW9kdWxlc30gPSBzdGF0ZS5jb3Vyc2U7XHJcbiAgICAgICAgY29uc3QgdXNlZFRhc2tJZHMgPSB7fTtcclxuICAgICAgICBtb2R1bGVzLmZvckVhY2gobW9kdWxlID0+IG1vZHVsZS50YXNrSWRzLmZvckVhY2goaWQgPT4gdXNlZFRhc2tJZHNbaWRdID0gdHJ1ZSkpO1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQ291cnNlVGFza3MgPSB0YXNrcy5maWx0ZXIodCA9PiB1c2VkVGFza0lkc1t0LmlkXSk7XHJcbiAgICAgICAgY29uc3QgbW9kaWZpZWRDb3Vyc2UgPSB7Li4uc3RhdGUuY291cnNlfTtcclxuICAgICAgICBtb2RpZmllZENvdXJzZS50YXNrcyA9IGZpbHRlcmVkQ291cnNlVGFza3M7XHJcbiAgICAgICAgc3RhdGUgPSB7Li4uc3RhdGUsIGNvdXJzZTogbW9kaWZpZWRDb3Vyc2V9O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW52b2tlIG91ciBjb3Vyc2UgaW50byBzdGF0ZSBwcm9wZXJ0eSBhbGxDb3Vyc2VzIHNvIHRoYXQgdGhlXHJcbiAgICAvLyByaWdodC1oYW5kIHNpZGUgbGlzdCBvZiBjb3Vyc2VzIGdldHMgdXBkYXRlIGltbWVkaWF0ZWx5IHdpdGhcclxuICAgIC8vIHRoZSBwdWJsaXNoYWJsZSBzdGF0ZSBvZiB0aGlzIGNvdXJzZS5cclxuICAgIGxldCBhbGxDb3Vyc2VzID0gc3RhdGUuYWxsQ291cnNlcyB8fCB0aGlzLnN0YXRlLmFsbENvdXJzZXM7XHJcbiAgICBjb25zdCBjb3Vyc2UgPSBzdGF0ZS5jb3Vyc2UgfHwgdGhpcy5zdGF0ZS5jb3Vyc2U7XHJcbiAgICBpZiAoYWxsQ291cnNlcykge1xyXG4gICAgICBjb25zdCBpZHhPdXJDb3Vyc2UgPSBhbGxDb3Vyc2VzLmZpbmRJbmRleChjID0+IGMuaWQgPT09IHRoaXMucHJvcHMuaWQpO1xyXG4gICAgICBhbGxDb3Vyc2VzID0gdXBkYXRlKGFsbENvdXJzZXMsIHskc3BsaWNlOiBbW2lkeE91ckNvdXJzZSwgMSwgY291cnNlXV19KTtcclxuICAgICAgc3RhdGUgPSB7Li4uc3RhdGV9O1xyXG4gICAgICBzdGF0ZS5hbGxDb3Vyc2VzID0gYWxsQ291cnNlcztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzdXBlci5zZXRTdGF0ZSgoKT0+c3RhdGUgYXMgU3RhdGUsIHJlc29sdmUpKTtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHsuLi5ERUZBVUxUX1NUQVRFfTtcclxuICAgIHRoaXMudXBkYXRlID0gdGhpcy51cGRhdGUuYmluZCh0aGlzKTtcclxuICAgIHRoaXMucmVmRGlhbG9nID0gdGhpcy5yZWZEaWFsb2cuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuY29udGVudFlQb3MgPSAwO1xyXG4gICAgdGhpcy5vbktleURvd24gPSB0aGlzLm9uS2V5RG93bi5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5iZWZvcmVVbmxvYWQgPSB0aGlzLmJlZm9yZVVubG9hZC5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5vbkNsaWNrUHJldmVudFVubG9hZCA9IHRoaXMub25DbGlja1ByZXZlbnRVbmxvYWQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuaXNTYXZpbmcgPSBmYWxzZTtcclxuICAgIHRoaXMuZGlhbG9ncyA9IFtdO1xyXG4gICAgaWYgKHByb3BzLnZpZXcpIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIC4uLnRoaXMuc3RhdGUsXHJcbiAgICAgIHZpZXc6IHByb3BzLnZpZXdcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChjYXRjaGVyKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5vbktleURvd24pO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMuYmVmb3JlVW5sb2FkKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uQ2xpY2tQcmV2ZW50VW5sb2FkKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5iZWZvcmVVbmxvYWQpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbGlja1ByZXZlbnRVbmxvYWQpO1xyXG4gICAgdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cygnJyk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgIGlmICh0aGlzLnN0YXRlICYmIHRoaXMuc3RhdGUuY291cnNlKSB7XHJcbiAgICAgIGlmIChuZXh0UHJvcHMuaWQgIT09IHRoaXMucHJvcHMuaWQgfHwgbmV4dFByb3BzLnRlbXBsYXRlSWQgIT09IHRoaXMucHJvcHMudGVtcGxhdGVJZCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZChERUZBVUxUX1NUQVRFKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKG5leHRQcm9wcy52aWV3ICE9PSB0aGlzLnByb3BzLnZpZXcpIHtcclxuICAgICAgdGhpcy5zZXROb25TYXZlYWJsZURhdGFTdGF0ZSh7dmlldzogbmV4dFByb3BzLnZpZXd9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IFByb3BzLCBwcmV2U3RhdGU6IFN0YXRlKSB7XHJcbiAgICBpZiAodGhpcy5jb250ZW50RGl2KSB7XHJcbiAgICAgIGNvbnN0IGNvbnRlbnREaXY6IEhUTUxEaXZFbGVtZW50ID0gZmluZERPTU5vZGUodGhpcy5jb250ZW50RGl2KSBhcyBIVE1MRGl2RWxlbWVudDtcclxuICAgICAgaWYgKGNvbnRlbnREaXYpIHtcclxuICAgICAgICB0aGlzLmNvbnRlbnRZUG9zID0gY29udGVudERpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAocHJldlN0YXRlICYmIHByZXZTdGF0ZS5jb3Vyc2UpIHtcclxuICAgICAgLy8gVGhpcyB3YXMgbm90IHRoZSBpbml0aWFsIHVwZGF0ZS5cclxuICAgICAgLy8gSWYgcHJvcHMgaGF2ZSBiZWVuIHVwZGF0ZWQgdG8gcG9pbnQgb3V0IGFub3RoZXIgY291cnNlIG9yIHRlbXBsYXRlLCByZXNldCBjb21wb25lbnQ6XHJcbiAgICAgIGlmICh0aGlzLnByb3BzLmlkICE9PSBwcmV2UHJvcHMuaWQgfHwgdGhpcy5wcm9wcy50ZW1wbGF0ZUlkICE9PSBwcmV2UHJvcHMudGVtcGxhdGVJZCkge1xyXG4gICAgICAgIHRoaXMubG9hZCgpLmNhdGNoKGNhdGNoZXIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFwcmV2U3RhdGUuaGFzVW5zYXZlZERhdGEgJiYgdGhpcy5zdGF0ZS5oYXNVbnNhdmVkRGF0YSkge1xyXG4gICAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCd1bnNhdmVkJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkRnJvbVRlbXBsYXRlKHRlbXBsYXRlSWQ6IHN0cmluZykge1xyXG4gICAgc2hvd0luZm8oXCJMYWRkYXIgZGF0YSBmcsOlbiBtYWxsLi4uXCIpO1xyXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBsb2FkQ291cnNlKHRlbXBsYXRlSWQsIHtpbmNsdWRlVGVtcGxhdGVDaGFpbjogdHJ1ZX0pO1xyXG4gICAgY29uc3QgY291cnNlID0gdXBkYXRlQ3JlYXRpb25TdGFtcChEYXRlLm5vdygpLCB0ZW1wbGF0ZSwgZW52LmN1cnJlbnRVc2VyKTtcclxuICAgIGNvdXJzZS5pZCA9IGNyZWF0ZVVVSUQoKTtcclxuICAgIGNvdXJzZS5wYXJlbnRJZCA9IHRlbXBsYXRlSWQ7XHJcbiAgICBjb3Vyc2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICBjb3Vyc2UuaXNUZW1wbGF0ZSA9IGZhbHNlO1xyXG4gICAgY291cnNlLnRlbXBsYXRlQ2hhaW4gPSBbLi4uY291cnNlLnRlbXBsYXRlQ2hhaW5dO1xyXG4gICAgY291cnNlLnRlbXBsYXRlQ2hhaW4ucHVzaCh7aWQ6IHRlbXBsYXRlSWQsICRtZXRhOiAncmVmJ30gYXMgQ291cnNlKTtcclxuICAgIGNvbnN0IG15U2Nob29sID0gZW52LmN1cnJlbnRVc2VyLnNjaG9vbDtcclxuICAgIGNvdXJzZS5zY2hvb2wgPSBteVNjaG9vbDtcclxuICAgIGNvdXJzZS5kZXNjcmlwdGlvbiA9IFwiXCI7XHJcbiAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xyXG4gICAgZGVsZXRlIGNvdXJzZS5zdHVkeUdyb3VwcztcclxuICAgIGNvdXJzZS5hY2wgPSBbXHJcbiAgICAgIFwicm9sZTpVU0VSOlJcIiwgLy8gQWxsIHVzZXJzIG1heSB2aWV3IGl0LiAoQ291bGQgaGF2ZSByZXN0cmljdGVkIGl0IHRvIHNjaG9vbCwgYnV0IG5vdCBuZXNjZXNzYXJ5ISlcclxuICAgICAgYHNjaG9vbFJvbGU6JHtteVNjaG9vbH0vRU1QTE9ZRUU6U2AgLy8gT3RoZXIgdGVhY2hlcnMgYXQgc2FtZSBzY2hvb2wgc2hvdWxkIGJlIGFibGUgdG8gbW9kaWZ5IHRoZSBjb3Vyc2UuXHJcbiAgICBdO1xyXG4gICAgZGVsZXRlIGNvdXJzZS4kZXRhZztcclxuICAgIGRlbGV0ZSBjb3Vyc2UuY3JlYXRlZEJ5O1xyXG4gICAgZGVsZXRlIGNvdXJzZS5jcmVhdGVkRGF0ZTtcclxuICAgIGRlbGV0ZSBjb3Vyc2UubW9kaWZpZWRCeTtcclxuICAgIGRlbGV0ZSBjb3Vyc2UubW9kaWZpZWREYXRlO1xyXG4gICAgZGVsZXRlIGNvdXJzZS5hY3RpdmF0ZWRCeTtcclxuICAgIGRlbGV0ZSBjb3Vyc2UuYWN0aXZhdGVkRGF0ZTtcclxuICAgIGRlbGV0ZSBjb3Vyc2UuZ29vZ2xlQ2xhc3NSb29tQ29kZTtcclxuICAgIGRlbGV0ZSBjb3Vyc2UuZ29vZ2xlQ2xhc3NSb29tVVJMO1xyXG4gICAgZGVsZXRlIGNvdXJzZS5nb29nbGVDcmVhdGVDbGFzc3Jvb21zO1xyXG4gICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKHsgY291cnNlLCBvcmlnQ291cnNlOiBudWxsLCBvcmlnVGVtcGxhdGU6IHRlbXBsYXRlIH0pO1xyXG4gICAgc2hvd0luZm8oXCJcIik7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkKCkge1xyXG4gICAgdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cygnJyk7XHJcbiAgICBpZiAodGhpcy5wcm9wcy5pZCkge1xyXG4gICAgICBhd2FpdCB0aGlzLmxvYWRFeGlzdGluZ0NvdXJzZSh0aGlzLnByb3BzLmlkKTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy50ZW1wbGF0ZUlkKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMubG9hZEZyb21UZW1wbGF0ZSh0aGlzLnByb3BzLnRlbXBsYXRlSWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKExgT2dpbHRpZyBwYXJhbWV0ZXIuIGlkIGVsbGVyIHRlbXBsYXRlSWQgbcOlc3RlIGFuZ2VzYCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkRXhpc3RpbmdDb3Vyc2UoY291cnNlSWQ6IHN0cmluZykge1xyXG4gICAgc2hvd0luZm8oXCJMYWRkYXIga3Vyc1wiKTtcclxuICAgIGNvbnN0IGNvdXJzZSA9IGF3YWl0IGxvYWRDb3Vyc2UoY291cnNlSWQpO1xyXG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMgPSBbXTtcclxuICAgIGF3YWl0IHRoaXMuc2V0Tm9uU2F2ZWFibGVEYXRhU3RhdGUoeyBjb3Vyc2UsIG9yaWdDb3Vyc2U6IGNvdXJzZSB9KTtcclxuICAgIHNob3dJbmZvKFwiXCIpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlKGNvdXJzZVVwZGF0ZXMpIHtcclxuICAgIGF3YWl0IHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7IGNvdXJzZTogdXBkYXRlKHRoaXMuc3RhdGUuY291cnNlLCBjb3Vyc2VVcGRhdGVzKSB9KTsgIFxyXG4gICAgLy9jaGVjayBjbGFzc3Jvb20gY2hhbmdlc1xyXG4gICAgdGhpcy5fY2hlY2tDbGFzc3Jvb21DaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBkZWxldGVDb3Vyc2UoKSB7XHJcbiAgICBzaG93SW5mbyhcIlJhZGVyYXIga3Vyc2VuLi4uXCIpO1xyXG4gICAgY29uc3QgY291cnNlU2Nob29sID0gdGhpcy5zdGF0ZS5jb3Vyc2Uuc2Nob29sO1xyXG4gICAgY29uc3QgcGFyZW50SWQgPSB0aGlzLnN0YXRlLmNvdXJzZS5wYXJlbnRJZDtcclxuICAgIGNvbnN0IGNvdXJzZUlkID0gdGhpcy5wcm9wcy5pZDtcclxuXHJcbiAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8Q291cnNlPihcImNvdXJzZXNcIiwge1xyXG4gICAgICBoYXNFZGdlc1RvOiBbdGhpcy5wcm9wcy5pZF1cclxuICAgIH0pO1xyXG4gICAgY29uc3QgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgIGZvciAoY29uc3QgY2hpbGRDb3Vyc2Ugb2YgY2hpbGRyZW4pIHtcclxuICAgICAgLyogQ0FOTk9UIERPIFRISVMuIE1BWSBOT1QgSEFWRSBBQ0NFU1MhIGlmIChjaGlsZENvdXJzZS5wYXJlbnRJZCA9PT0gY291cnNlSWQpIHtcclxuICAgICAgICAvLyBSZWNvbm5lY3QgY2hpbGQgd2l0aCBteSBwYXJlbnQgaW5zdGVhZCwgYXMgSSB3aWxsIGJlIGRpc2FwcGVhcmluZy4uLlxyXG4gICAgICAgIGNoaWxkQ291cnNlLnBhcmVudElkID0gcGFyZW50SWQ7XHJcbiAgICAgICAgYnIucHV0KFwiY291cnNlc1wiLCBjaGlsZENvdXJzZSk7XHJcbiAgICAgIH0qL1xyXG4gICAgfVxyXG5cclxuICAgIGJyLmRlbGV0ZShcImNvdXJzZXNcIiwgY291cnNlSWQpO1xyXG4gICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goYnIubXV0YXRpb25SZXF1ZXN0cyk7XHJcbiAgICBpZiAoY291cnNlU2Nob29sID09PSBlbnYuY3VycmVudFVzZXIuc2Nob29sKSB7XHJcbiAgICAgIG15U2Nob29sQ291cnNlc1JlcG8uZGVsZXRlKGNvdXJzZUlkKTtcclxuICAgIH1cclxuICAgIHNob3dJbmZvKFwiXCIpO1xyXG4gICAgbG9jYXRpb24uaGFzaCA9IFwiIy9jb3Vyc2VzL25ld1wiO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW4gY2FzZSB0aGF0IHRoZSBjb3Vyc2UgaGFzIGNoYW5nZXMgd2hpY2ggc2hvdWxkIGJlIHN5bmNlZCB3aXRoIGNsYXNzcm9vbVxyXG4gICAqIEFzayB0aGUgdXNlciBpZiB0aGUgc3luYyBzaG91bGQgYmUgZG9uZVxyXG4gICAqL1xyXG4gIGFzeW5jIGNvbmZpcm1TYXZlQW5kU3luYygpe1xyXG4gICAgY29uc3QgeyBjb3Vyc2V9ID0gdGhpcy5zdGF0ZTtcclxuICAgIHZhciBzeW5jV2l0aENsYXNzcm9vbSA9IGZhbHNlO1xyXG4gICAgLy9jb25maXJtIHNob3VsZCBub3QgYmUgZGlzcGxheWVkIGluIGNhc2UgdGhlIGNoZWNrYm94IHdhcyBzYXZlZCBhbmQgdGhlIGZlYXR1cmUgZmxhZyBpcyBvZmZcclxuICAgIGlmIChjb3Vyc2UuZ29vZ2xlQ3JlYXRlQ2xhc3Nyb29tcyAmJiAhY291cnNlLmluU3luY1dpdGhDbGFzc3Jvb20gJiYgZmVhdHVyZXMuc3R1ZHlHcm91cHMpIHtcclxuICAgICAgc3luY1dpdGhDbGFzc3Jvb20gPSBjb25maXJtKExgU3lua3VycyBrdXJzIG1lZCBrbGFzc3J1bT9gKTsgICBcclxuICAgIH1cclxuICAgIGF3YWl0IHN5bmNXaXRoQ2xhc3Nyb29tID8gdGhpcy5zeW5jV2l0aENsYXNzcm9vbUFuZFNhdmUoKSA6IHRoaXMuc2F2ZSgpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgc2F2ZSAoKSB7XHJcbiAgICAvL2FyY2hpdmUgZ29vZ2xlIGNsYXNzcm9vbSBzeW5jZWQgY291cnNlc1xyXG4gICAgY29uc3QgeyBjb3Vyc2UsIG9yaWdDb3Vyc2UgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBpZiAob3JpZ0NvdXJzZSAmJiBvcmlnQ291cnNlLmdvb2dsZUNyZWF0ZUNsYXNzcm9vbXMgJiYgIWNvdXJzZS5nb29nbGVDcmVhdGVDbGFzc3Jvb21zKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNsYXNzcm9vbVN5bmMgPSBuZXcgQ2xhc3Nyb29tU3luYygpO1xyXG4gICAgICBhd2FpdCBjbGFzc3Jvb21TeW5jLmFyY2hpdmUoY291cnNlKTtcclxuICAgICAgfSBjYXRjaChjYXRjaGVyKXt9IHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlbmFibGVUZWFjaGVyUmlnaHRzID0gZmVhdHVyZXMudGVhY2hlclJpZ2h0cztcclxuICAgIGNvbnN0IG9yaWdBY2Nlc3NMaXN0ID0gdGhpcy5zdGF0ZS5vcmlnQ291cnNlID8gZ2V0U29mdEFjY2Vzc0xpc3QodGhpcy5zdGF0ZS5vcmlnQ291cnNlKSA6IFtdO1xyXG4gICAgY29uc3QgbW9kaWZpZWRBY2Nlc3NMaXN0ID0gZ2V0U29mdEFjY2Vzc0xpc3QodGhpcy5zdGF0ZS5jb3Vyc2UpO1xyXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xyXG4gICAgaWYgKGVuYWJsZVRlYWNoZXJSaWdodHMgJiZcclxuICAgICAgKCFjdXJyZW50VXNlci5yb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpICYmXHJcbiAgICAgICAgIVsuLi5vcmlnQWNjZXNzTGlzdCwgLi4ubW9kaWZpZWRBY2Nlc3NMaXN0XS5zb21lKFxyXG4gICAgICAgICAgKHtlbWFpbCwgdXJsLCBhY2Nlc3N9KSA9PiAvLyB1cmwgaXMgZm9yIGJhY2thcmQgY29tcGF0ISBIYXMgYmVlbiByZW5hbWVkIHRvIGVtYWlsLlxyXG4gICAgICAgICAgICAoZW1haWwgfHwgdXJsKSA9PT0gY3VycmVudFVzZXIubWFpbCAmJiAvLyB1cmwgaXMgZm9yIGJhY2t3YXJkIGNvbXBhdCEgSGFzIGJlZW4gcmVuYW1lZCB0byBlbWFpbC5cclxuICAgICAgICAgICAgKFxyXG4gICAgICAgICAgICAgICFhY2Nlc3MgfHwgLy8gQmFja3dhcmQgY29tcGF0LiBXYXMgbm90IHBvc3NpYmxlIHRvIHNldCBhY2Nlc3MgYmVmb3JlIVxyXG4gICAgICAgICAgICAgIGFjY2VzcyA9PT0gJ2VkaXQnIHx8IC8vIEVkaXQgaXMgZmluZVxyXG4gICAgICAgICAgICAgIGFjY2VzcyA9PT0gJ2Z1bGwnKVxyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgICApXHJcbiAgICAgIClcclxuICAgIHtcclxuICAgICAgc2hvd0Vycm9yKExgS3Vyc2VuIGt1bmRlIGludGUgc3BhcmFzLiBMw6RnZyB0aWxsIGRpZyBzasOkbHYgaSBsaXN0YW4gcMOlIGFuc3ZhcmlnYSBsw6RyYXJlYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmlzU2F2aW5nKSByZXR1cm47XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLmlzU2F2aW5nID0gdHJ1ZTtcclxuICAgICAgYXdhaXQgdGhpcy5fc2F2ZSgpO1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBlcnIgJiYgZXJyLm1lc3NhZ2UgPyBlcnIubWVzc2FnZSA6IExgRXR0IG9rw6RudCBmZWwgaGFyIGludHLDpGZmYXQuLi5gO1xyXG4gICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgaWYgKGVyci5uYW1lID09PSAnaHR0cDQwOScgfHwgZXJyLm5hbWUgPT09ICdodHRwNDEyJyB8fCBlcnIubmFtZSA9PT0gJ2h0dHA0MDQnKSB7XHJcbiAgICAgICAgICAvLyBDb25mbGljdC4gU2hvdyBhIG5pY2VyIGVycm9yIG1lc3NhZ2U6XHJcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBMYEt1cnNlbiBoYXIgcmVkaWdlcmFkIGF2IGFubmFuIGFudsOkbmRhcmUuIExhZGRhIG9tIHNpZGFuIG9jaCBnw7ZyIG9tIMOkbmRyaW5hcm5hLmA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlcnIubmFtZSA9PT0gJ2h0dHA0MDMnKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5jb3Vyc2UuaXNUZW1wbGF0ZSlcclxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gTGBJbmdlbiBiZWjDtnJpZ2hldCBhdHQgc3BhcmEga3Vyc21hbGxlbi4gRW5kYXN0IGFkbWluaXN0cmF0w7ZyZXIga2FuIHJlZGlnZXJhIGt1cnNtYWxsYXIuYDtcclxuICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdGUuY291cnNlLnNjaG9vbClcclxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gTGBJbmdlbiBiZWjDtnJpZ2hldCBhdHQgc3BhcmEga3Vyc2VuICR7dGhpcy5zdGF0ZS5jb3Vyc2UubmFtZX0uIEt1cnNlbiBrYW4gYmFyYSByZWRpZ2VyYXMgYXYgYW5zdMOkbGxkYSBww6UgJHt0aGlzLnN0YXRlLmNvdXJzZS5zY2hvb2x9YDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgc2hvd0Vycm9yKGVycm9yTWVzc2FnZSk7XHJcbiAgICAgIHVwZGF0ZUNvdXJzZUJ1aWxkZXJTdGF0dXMoJ2Vycm9yJyk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICB0aGlzLmlzU2F2aW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzeW5jSW5Qcm9ncmVzcygpIDogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5jbGFzc3Jvb21TeW5jSW5Qcm9ncmVzcztcclxuICB9XHJcblxyXG4gIGFzeW5jIHN5bmNXaXRoQ2xhc3Nyb29tQW5kU2F2ZSgpIHtcclxuICAgIGNvbnN0IHsgY291cnNlLCBvcmlnQ291cnNlIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc29sZS5sb2coY291cnNlKTtcclxuICAgIGNvbnNvbGUubG9nKG9yaWdDb3Vyc2UpO1xyXG4gICAgYXdhaXQgdGhpcy5zYXZlKCk7IFxyXG4gICAgLy8gaWYgdGhlcmUgaXMgc3RpbGwgdW5zYXZlZCBkYXRhIGl0IG1lYW5zIHRoYXQgYW4gZXJyb3IgZW5jb3VudGVyZWQgZHVyaW5nIHNhdmUuIFxyXG4gICAgLy8gc3luYyB3aXRoIGdvb2dsZSBjbGFzc3Jvb20gd2lsbCBiZSBjYW5jZWxlZFxyXG4gICAgaWYodGhpcy5zdGF0ZS5oYXNVbnNhdmVkRGF0YSkge1xyXG4gICAgICBzaG93RXJyb3IoTGBTeW5rcm9uaXNlcmluZyBtZWQga2xhc3NydW1tZXQgc2t1bGxlIGludGUgc2tlYCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHsgY2xhc3Nyb29tU3luY0luUHJvZ3Jlc3M6IHRydWUgfSk7XHJcbiAgICAgIGNvbnN0IGNsYXNzcm9vbVN5bmMgPSBuZXcgQ2xhc3Nyb29tU3luYygpO1xyXG4gICAgICBpZiAoY291cnNlLmdvb2dsZUNyZWF0ZUNsYXNzcm9vbXMpIHtcclxuICAgICAgICAvL2NvdXJzZSBpcyBub3QgY3JlYXRlZCBpbiBjbGFzc3Jvb20geWV0XHJcbiAgICAgICAgdmFyIGZ1bGxTeW5jTmVlZGVkID0gY291cnNlLmluU3luY1dpdGhDbGFzc3Jvb20gPT0gbnVsbDtcclxuICAgICAgICB2YXIgc3luY1Jlc3VsdCA9IGF3YWl0IGNsYXNzcm9vbVN5bmMuaW5pdFN5bmMoY291cnNlLCBvcmlnQ291cnNlLCBmdWxsU3luY05lZWRlZCk7XHJcbiAgICAgICAgaWYoc3luY1Jlc3VsdC5kb25lKXtcclxuICAgICAgICAgIHRoaXMudXBkYXRlKHtpblN5bmNXaXRoQ2xhc3Nyb29tOiB7ICRzZXQ6IHRydWUgfX0pO1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNsYXNzcm9vbVN5bmNJblByb2dyZXNzOiBmYWxzZSB9KTtcclxuXHJcbiAgICAgICAgICAvL3VwZGF0ZSBpblN5bmNXaXRoQ2xhc3Nyb29tIGZsYWdcclxuICAgICAgICAgIGF3YWl0IHRoaXMuX3NhdmUodHJ1ZSk7XHJcbiAgICAgICAgICBzaG93SW5mbyhMYFN5bmtyb25pc2VyaW5nIG1lZCBmcmFtZ8OlbmdgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc2hvd0Vycm9yKExgRmVsIHN5bmtyb25pc2VyYXQga2xhc3NydW1gKTtcclxuICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjbGFzc3Jvb21TeW5jSW5Qcm9ncmVzczogZmFsc2UgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyKSB7IGNhdGNoZXIgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBfc2F2ZShzaWxlbnRTYXZlOiBib29sZWFuID0gZmFsc2UpIHtcclxuICAgIGNvbnN0IHsgY291cnNlLCBvcmlnQ291cnNlLCBvcmlnVGVtcGxhdGUgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBkb2VzQWxsVGFza3NDb3ZlckFsbFJlcXVpcmVtZW50cyA9IGdldFVuY292ZXJlZEtub3dsZWRnZVJlcXVpcmVtZW50cyhjb3Vyc2UpLmxlbmd0aCA9PT0gMDtcclxuXHJcbiAgICAhc2lsZW50U2F2ZSAmJiBzaG93SW5mbyhMYFNwYXJhci4uLmApO1xyXG4gICAgbGV0IG1vZGlmaWVkQ291cnNlOiBDb3Vyc2UgPSB1cGRhdGVNb2RpZmljYXRpb25TdGFtcChEYXRlLm5vdygpLCBjb3Vyc2UsIGVudi5jdXJyZW50VXNlcik7XHJcblxyXG4gICAgY29uc3QgYmF0Y2ggPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuXHJcbiAgICAvLyBSZXNvbHZlIG1hbmlwdWxhdGVkIGdyYXBocyBvZiBlYWNoIHRhc2sgYW5kIHJlbW92ZSAkbWV0YSwgZ2VuZXJhdGUgVVVJRCBldGMgZm9yXHJcbiAgICAvLyBlYWNoIGFkZGVkIC8gdXBkYXRlZCB0YXNrLlxyXG4gICAgLy8gVGhlIHJlc3VsdCBvZiB0aGlzIG9wZXJhdGlvbiBpcyB0d28tZm9sZDpcclxuICAgIC8vICAxKSBSZW1vdmUgJG1ldGEgYW5kIGNyZWF0ZSBpZCBmb3IgZWFjaCB0YXNrLiBUbyBiZSByZWZsZWN0ZWQgaW50byBuZXh0IHN0YXRlLlxyXG4gICAgLy8gIDIpIEdlbmVyYXRlIG11dGF0aW9uIHJlcXVlc3RzIGludG8gJ2JhdGNoJyB0byBpbmNsdWRlIGluIHRoZSBzaW5nbGUgYmF0Y2ggcmVxdWVzdCB0byB0aGUgc2VydmVyLlxyXG4gICAgY29uc3Qgb3JpZyA9IG9yaWdDb3Vyc2UgfHwgb3JpZ1RlbXBsYXRlO1xyXG4gICAgY29uc3QgbmV3Q291cnNlVGFza3MgPSBtb2RpZmllZENvdXJzZS50YXNrcy5tYXAodGFzayA9PiB7XHJcbiAgICAgIGlmICh0YXNrLiRtZXRhID09PSAnYWRkJyB8fCB0YXNrLiRtZXRhID09PSAndXBkYXRlJykge1xyXG4gICAgICAgIGNvbnN0IG9yaWdUYXNrID0gb3JpZy50YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFzay5pZCk7XHJcbiAgICAgICAgcmV0dXJuIHVwZGF0ZURvY3VtZW50R3JhcGhzKG9yaWdUYXNrIHx8IHt9LCB0YXNrLCBcInRhc2tzXCIsIHtcclxuICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50czogJ2tub3dsZWRnZS1yZXF1aXJlbWVudHMnLFxyXG4gICAgICAgICAgY2VudHJhbENvbnRlbnQ6ICdjZW50cmFsLWNvbnRlbnQnLFxyXG4gICAgICAgICAgYWJpbGl0aWVzOiAnYWJpbGl0aWVzJ1xyXG4gICAgICAgIH0sIGJhdGNoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHsuLi50YXNrfTtcclxuICAgICAgICBkZWxldGUgdXBkYXRlZFRhc2suJG1ldGE7XHJcbiAgICAgICAgcmV0dXJuIHVwZGF0ZWRUYXNrO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIG1vZGlmaWVkQ291cnNlID0gdXBkYXRlKG1vZGlmaWVkQ291cnNlLCB7dGFza3M6IHskc2V0OiBuZXdDb3Vyc2VUYXNrc319KTtcclxuXHJcbiAgICBtb2RpZmllZENvdXJzZSA9IHVwZGF0ZURvY3VtZW50R3JhcGhzKG9yaWdDb3Vyc2UgfHwge30sIG1vZGlmaWVkQ291cnNlLCAnY291cnNlcycsIHtcclxuICAgICAgdGVtcGxhdGVDaGFpbjogJ2NvdXJzZXMnLFxyXG4gICAgICBjZW50cmFsQ29udGVudDogJ2NlbnRyYWwtY29udGVudCcsXHJcbiAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50czogJ2tub3dsZWRnZS1yZXF1aXJlbWVudHMnLFxyXG4gICAgICBhYmlsaXRpZXM6ICdhYmlsaXRpZXMnLFxyXG4gICAgICBpbWFnZXM6ICdpbWFnZXMnLFxyXG4gICAgICB0YXNrczogJ3Rhc2tzJ1xyXG4gICAgfSwgYmF0Y2gpO1xyXG5cclxuICAgIG1vZGlmaWVkQ291cnNlID0gey4uLm1vZGlmaWVkQ291cnNlIH07XHJcbiAgICBtb2RpZmllZENvdXJzZS5wdWJsaXNoYWJsZSA9IGRvZXNBbGxUYXNrc0NvdmVyQWxsUmVxdWlyZW1lbnRzO1xyXG4gICAgY29uc3QgdGFncyA9IChtb2RpZmllZENvdXJzZS50YWdzIHx8IFtdKS5maWx0ZXIodGFnID0+IHRhZyAhPT0gJ2luY29tcGxldGUnKTtcclxuICAgIG1vZGlmaWVkQ291cnNlLnRhZ3MgPSBtb2RpZmllZENvdXJzZS5wdWJsaXNoYWJsZSA/XHJcbiAgICAgIHRhZ3MgOiB0YWdzLmNvbmNhdChcImluY29tcGxldGVcIik7XHJcblxyXG4gICAgaWYgKCFvcmlnQ291cnNlKSB7XHJcbiAgICAgIC8vIEEgbmV3IGNvdXJzZSBzaG91bGQgYmUgYWRkZWQ6XHJcbiAgICAgIGJhdGNoLmFkZCgnY291cnNlcycsIG1vZGlmaWVkQ291cnNlKTtcclxuICAgICAgaWYgKGNvdXJzZS5zY2hvb2wpIHtcclxuICAgICAgICBjb25zdCBzY2hvb2xJZCA9IGF3YWl0IG15U2Nob29sQ291cnNlc1JlcG8uZ2V0U2Nob29sSWQoKTtcclxuICAgICAgICBiYXRjaC5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJjb3Vyc2VzXCIpO1xyXG4gICAgICAgIGlmIChjb3Vyc2UuYWN0aXZlKSB7XHJcbiAgICAgICAgICBiYXRjaC5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJhY3RpdmVDb3Vyc2VzXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gQW4gZXhpc3RpbmcgY291cnNlIHNob3VsZCBiZSB1cGRhdGVkOlxyXG4gICAgICBiYXRjaC5wdXQoJ2NvdXJzZXMnLCBtb2RpZmllZENvdXJzZSk7XHJcbiAgICAgIGlmICghb3JpZ0NvdXJzZS5hY3RpdmUgJiYgY291cnNlLmFjdGl2ZSkge1xyXG4gICAgICAgIC8vIENvdXJzZSB3YXMgYWN0aXZhdGVkLiBBZGQgYSByZWZlcmVuY2UgdG8gdGhlIGNvdXJzZSBvbiBzY2hvb2wuYWN0aXZlQ291cnNlcy5cclxuICAgICAgICBjb25zdCBzY2hvb2xJZCA9IGF3YWl0IG15U2Nob29sQ291cnNlc1JlcG8uZ2V0U2Nob29sSWQoKTtcclxuICAgICAgICBiYXRjaC5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJhY3RpdmVDb3Vyc2VzXCIpO1xyXG4gICAgICB9IGVsc2UgaWYgKG9yaWdDb3Vyc2UuYWN0aXZlICYmICFjb3Vyc2UuYWN0aXZlKSB7XHJcbiAgICAgICAgLy8gQ291cnNlIHdhcyBpbmFjdGl2YXRlZC4gUmVtb3ZlIGZyb20gc2Nob29sLmFjdGl2ZUNvdXJzZXMuXHJcbiAgICAgICAgY29uc3Qgc2Nob29sSWQgPSBhd2FpdCBteVNjaG9vbENvdXJzZXNSZXBvLmdldFNjaG9vbElkKCk7XHJcbiAgICAgICAgYmF0Y2gudW5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJhY3RpdmVDb3Vyc2VzXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUGVyZm9ybSB0aGUgZW50aXJlIGJhdGNoIHRocm91Z2ggYSBzaW5nbGUgUE9TVCByZXF1ZXN0OlxyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goYmF0Y2gubXV0YXRpb25SZXF1ZXN0cyk7XHJcbiAgICAhc2lsZW50U2F2ZSAmJiBzaG93SW5mbyAob3JpZ0NvdXJzZSA/XHJcbiAgICAgIExgw4RuZHJpbmdhcm5hIGhhciBzcGFyYXRzYCA6XHJcbiAgICAgIExgS3Vyc2VuIGhhciBza2FwYXRzYCk7XHJcbiAgICAvLyBVcGRhdGUgc3RhdGUgdG8gcmVmbGVjdCB3aGF0IGhhcyBiZWVuIHBvc3RlZDpcclxuICAgIGlmIChyZXMgJiYgcmVzLm5ld0V0YWdzKVxyXG4gICAgICAgIG1vZGlmaWVkQ291cnNlID0gYXBwbHlFdGFncyhtb2RpZmllZENvdXJzZSwgcmVzLm5ld0V0YWdzLCBbXCJpbWFnZXNcIiwgXCJ0YXNrc1wiXSkgYXMgQ291cnNlO1xyXG4gICAgXHJcbiAgICBpZiAoY291cnNlLnNjaG9vbCA9PT0gZW52LmN1cnJlbnRVc2VyLnNjaG9vbCkge1xyXG4gICAgICAvLyBVcGRhdGUgbXlTY2hvb2xDb3Vyc2VzUmVwb1xyXG4gICAgICBpZiAoIW9yaWdDb3Vyc2UpIHtcclxuICAgICAgICBteVNjaG9vbENvdXJzZXNSZXBvLmluc2VydChtb2RpZmllZENvdXJzZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbXlTY2hvb2xDb3Vyc2VzUmVwby51cGRhdGUobW9kaWZpZWRDb3Vyc2UpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgdGhpcy5zZXROb25TYXZlYWJsZURhdGFTdGF0ZSh7Y291cnNlOiBtb2RpZmllZENvdXJzZSwgb3JpZ0NvdXJzZTogbW9kaWZpZWRDb3Vyc2UsIGhhc1Vuc2F2ZWREYXRhOiBmYWxzZX0pO1xyXG4gICAgdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cygnJyk7XHJcbiAgICBpZiAoIW9yaWdDb3Vyc2UpIHtcclxuICAgICAgLy8gVGhpcyB3YXMgdGhlIGNyZWF0aW9uIG9mIGEgbmV3IGNvdXJzZS4gQ29ycmVjdCB0aGUgcm91dGUgbm93IHdoZW4gdGhlIHVzZXIgZW50ZXJzIGFuIGVkaXQgc3RhdGU6XHJcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSBgIy9jb3Vyc2VzLyR7bW9kaWZpZWRDb3Vyc2UuaWR9L2VkaXRgO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSAgX2NoZWNrQ2xhc3Nyb29tQ2hhbmdlcygpe1xyXG4gICAgY29uc3QgeyBjb3Vyc2UsIG9yaWdDb3Vyc2UgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBhcnIxc2V0ID0gY291cnNlLnRhc2tzLmZpbHRlcih4ID0+IHguYXNzaWdubWVudCk7XHJcbiAgICBcclxuICAgIC8vaWYgKGNvdXJzZS5pblN5bmNXaXRoQ2xhc3Nyb29tKSB7XHJcbiAgICBjb25zdCBhcnIyc2V0ID0gb3JpZ0NvdXJzZS50YXNrcy5maWx0ZXIoeCA9PiB4LmFzc2lnbm1lbnQpOyAgIFxyXG4gICAgLy9jaGVjayB0YXNrcyBhZGRlZCBvciByZW1vdmVkXHJcbiAgICB2YXIgaGFzVGVhY2hlckNoYW5nZXMgPSBoYXNDaGFuZ2VzKG9yaWdDb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycywgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMpO1xyXG4gICAgLy9cclxuICAgIHZhciBoYXNUYXNrc0NoYW5nZXMgPSBhcnIxc2V0LmZpbHRlcigoeCkgPT4gIWFycjJzZXQuZmluZCh5ID0+IHkuaWQgPT0geC5pZCkpLmxlbmd0aCA+IDAgfHwgYXJyMnNldC5maWx0ZXIoKHgpID0+ICFhcnIxc2V0LmZpbmQoeSA9PiB5LmlkID09IHguaWQpKS5sZW5ndGggPiAwOyAgICBcclxuICAgIC8vY2hlY2sgaWYgYW55IHRhc2sgcmVuYW1lZCBvciBjaGFuZ2VkIGl0cyB0eXBlXHJcbiAgICBpZiAoIWhhc1Rhc2tzQ2hhbmdlcykge1xyXG4gICAgICBoYXNUYXNrc0NoYW5nZXMgPSBhcnIxc2V0LnNvbWUoZTEgPT4gYXJyMnNldC5maW5kKGUyID0+IHtcclxuICAgICAgICByZXR1cm4gZTIuaWQgPT09IGUxLmlkICYmIGUyLm5hbWUgIT09IGUxLm5hbWU7XHJcbiAgICAgIH0pICE9IG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBoYXNTdHVkeUdyb3Vwc0NoYW5nZXMgPSBoYXNDaGFuZ2VzKG9yaWdDb3Vyc2Uuc3R1ZHlHcm91cHMsIGNvdXJzZS5zdHVkeUdyb3Vwcyk7XHJcbiAgICAvL2NoZWNrcyBhcmUgbWFkZSB3aXRoIHRoZSBwcmV2aW91cyBvYmplY3QgaW4gY2FzZSB0aGF0IHRoZSB1c2VyIHdpbGwgcmV2ZXJ0IHRoZSBjaGFuZ2VzXHJcbiAgICB2YXIgcHJldlN0YXR1cyA9ICBjb3Vyc2UuaW5TeW5jV2l0aENsYXNzcm9vbTtcclxuICAgIGNvdXJzZS5pblN5bmNXaXRoQ2xhc3Nyb29tID0gIShoYXNUZWFjaGVyQ2hhbmdlcyB8fCBoYXNUYXNrc0NoYW5nZXMgfHwgaGFzU3R1ZHlHcm91cHNDaGFuZ2VzKTtcclxuICAgIGlmIChwcmV2U3RhdHVzICE9IGNvdXJzZS5pblN5bmNXaXRoQ2xhc3Nyb29tKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7IGNvdXJzZSB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFjdGl2YXRlQW5kU2F2ZSgpIHtcclxuICAgIGNvbnN0IGNvdXJzZSA9IHsuLi50aGlzLnN0YXRlLmNvdXJzZX07XHJcbiAgICBpZiAoIWNvdXJzZS5hY3RpdmUpIHtcclxuICAgICAgLypjb25zdCB1bmNvdmVyZWRSZXF1aXJlbWVudHMgPSBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMoY291cnNlKTtcclxuICAgICAgaWYgKHVuY292ZXJlZFJlcXVpcmVtZW50cy5sZW5ndGggPiAwKSBcclxuICAgICAgICByZXR1cm4gc2hvd0Vycm9yIChMYERldCBmaW5ucyBrdW5za2Fwc2tyYXYgc29tIGludGUgdXBwZnlsbHMgYXYgbsOlZ29uIG1vZHVsLiBLYW4gaW50ZSBha3RpdmVyYSBrdXJzZW4gZsO2cnLDpG4gYWxsYSBrdW5za2Fwc2tyYXYgZmlubnMgbWVkLmApO1xyXG4gICAgICAqL1xyXG5cclxuICAgICAgY291cnNlLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgIGNvdXJzZS5hY3RpdmF0ZWRCeSA9IHtcclxuICAgICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArICBlbnYuY3VycmVudFVzZXIubWFpbFxyXG4gICAgICB9O1xyXG4gICAgICBjb3Vyc2UuYWN0aXZhdGVkRGF0ZSA9IERhdGUubm93KCk7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7Y291cnNlfSlcclxuICAgICAgICAudGhlbigoKT0+dGhpcy5zYXZlKCkpXHJcbiAgICAgICAgLmNhdGNoKGNhdGNoZXIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaW5hY3RpdmF0ZUFuZFNhdmUoKSB7XHJcbiAgICBjb25zdCBjb3Vyc2UgPSB7Li4udGhpcy5zdGF0ZS5jb3Vyc2V9O1xyXG4gICAgaWYgKGNvdXJzZS5hY3RpdmUpIHtcclxuICAgICAgY291cnNlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICBjb3Vyc2UuaW5hY3RpdmF0ZWRCeSA9IHtcclxuICAgICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArICBlbnYuY3VycmVudFVzZXIubWFpbFxyXG4gICAgICB9O1xyXG4gICAgICBjb3Vyc2UuaW5hY3RpdmF0ZWREYXRlID0gRGF0ZS5ub3coKTtcclxuICAgICAgdGhpcy5zZXRTdGF0ZVByb21pc2VkKHtjb3Vyc2V9KVxyXG4gICAgICAgIC50aGVuKCgpPT50aGlzLnNhdmUoKSlcclxuICAgICAgICAuY2F0Y2goY2F0Y2hlcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvcGVuRGlhbG9nKGRpYWxvZ0NvbnRhaW5lcjogRGlhbG9nQ29udGFpbmVyKSB7XHJcbiAgICB0aGlzLnNldE5vblNhdmVhYmxlRGF0YVN0YXRlKHtkaWFsb2dDb250YWluZXJzOiB0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMuY29uY2F0KGRpYWxvZ0NvbnRhaW5lcil9KTtcclxuICB9XHJcblxyXG4gIGNsb3NlRGlhbG9nKCkge1xyXG4gICAgY29uc3Qge2RpYWxvZ0NvbnRhaW5lcnN9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHtsZW5ndGh9ID0gZGlhbG9nQ29udGFpbmVycztcclxuICAgIGxlbmd0aCAmJiB0aGlzLnNldE5vblNhdmVhYmxlRGF0YVN0YXRlKHtkaWFsb2dDb250YWluZXJzOiBkaWFsb2dDb250YWluZXJzLnNsaWNlKDAsIGxlbmd0aCAtIDEpfSk7XHJcbiAgICAvLyBOb3cgc3luYyB0aGUgZGlyZWN0ICdkaWFsb2dzJyBwcm9wZXJ0eSB3aXRoIHRoZSBuZXcgc3RhdGU6XHJcbiAgICB3aGlsZSAodGhpcy5kaWFsb2dzLmxlbmd0aCA+PSBsZW5ndGgpIHRoaXMuZGlhbG9ncy5wb3AoKTtcclxuICB9XHJcblxyXG4gIHJlZkRpYWxvZyhkaWFsb2c6IERpYWxvZyAmIFJlYWN0LkNvbXBvbmVudCwgaW5kZXg6IG51bWJlcikge1xyXG4gICAgdGhpcy5kaWFsb2dzW2luZGV4XSA9IGRpYWxvZzsgLy8gU2V0dGluZyBwZXIgaW5kZXggaW5zdGVhZCBvZiBwdXNoKCkuIFdvcmtzIGV2ZW4gaWYgdGhlIHJlZiBhdHRyaWJ1dGUgY291bGQgYmUgaW52b2tlZCBtdWx0aXBsZSB0aW1lcy5cclxuICB9XHJcblxyXG4gIG9uS2V5RG93biAoZXY6IEtleWJvYXJkRXZlbnQpIHtcclxuICAgIGlmIChldi53aGljaCA9PT0gODMgJiYgKGV2LmN0cmxLZXkgfHwgZXYubWV0YUtleSkpIHsgLy8gQ1RSTC1TXHJcbiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHRoaXMuc2F2ZURpYWxvZygpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNhdmUoKTtcclxuICAgIH0gZWxzZSBpZiAoZXYud2hpY2ggPT09IDI3ICYmIHRoaXMuc3RhdGUuZGlhbG9nQ29udGFpbmVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0gZWxzZSBpZiAoZXYud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgIGNvbnN0IHRhcmdldEVsZW0gPSBldi50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCAmJlxyXG4gICAgICAgIHRhcmdldEVsZW0udGFnTmFtZSAhPT0gJ1RFWFRBUkVBJyAmJlxyXG4gICAgICAgIHRhcmdldEVsZW0udGFnTmFtZSAhPT0gJ0lOUFVUJyAmJlxyXG4gICAgICAgIHRhcmdldEVsZW0udGFnTmFtZSAhPT0gJ1NFTEVDVCcgJiZcclxuICAgICAgICB0YXJnZXRFbGVtLnRhZ05hbWUgIT09ICdPUFRJT04nICYmXHJcbiAgICAgICAgIXRhcmdldEVsZW0uY29udGVudEVkaXRhYmxlKVxyXG4gICAgICB7XHJcbiAgICAgICAgdGhpcy5zYXZlRGlhbG9nKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGJlZm9yZVVubG9hZChldjogRXZlbnQpIHtcclxuICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCB8fCB0aGlzLnN0YXRlLmhhc1Vuc2F2ZWREYXRhKSB7XHJcbiAgICAgIGlmICghZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cC5iZWFyZXJQcm92aWRlci53YW50c1JlZGlyZWN0KSB7XHJcbiAgICAgICAgZXYucmV0dXJuVmFsdWUgPSBDT05GSVJNX05BVklHQVRFX01FU1NBR0U7XHJcbiAgICAgICAgcmV0dXJuIGV2LnJldHVyblZhbHVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkNsaWNrUHJldmVudFVubG9hZChldjogRXZlbnQpIHtcclxuICAgIGlmIChldi50YXJnZXQgJiYgKCcnKyhldi50YXJnZXQgYXMgYW55KS50YWdOYW1lKS50b0xvd2VyQ2FzZSgpID09PSAnYScpIHtcclxuICAgICAgY29uc3QgYTogSFRNTEFuY2hvckVsZW1lbnQgPSBldi50YXJnZXQgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XHJcbiAgICAgIGlmIChhLmhyZWYgJiYgYS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSAhPT0gJyMnICYmICFhLnRhcmdldCkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCB8fCB0aGlzLnN0YXRlLmhhc1Vuc2F2ZWREYXRhKSB7XHJcbiAgICAgICAgICBpZiAoIWNvbmZpcm0oQ09ORklSTV9OQVZJR0FURV9NRVNTQUdFKSkge1xyXG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2F2ZURpYWxvZygpIHtcclxuICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBjb25zdCBkaWFsb2cgPSB0aGlzLmRpYWxvZ3NbdGhpcy5zdGF0ZS5kaWFsb2dDb250YWluZXJzLmxlbmd0aC0xXTsgLy8gWUVTLCBzaG91bGQgcmVmZXJlbmNlIHRoaXMuZGlhbG9ncyBieSBsZW5ndGggb2YgZGlhbG9nQ29udGFpbmVycy4gU3RyYW5nZSB5ZXMsIGJ1dCBsZWF2ZSBpdCBzbyFcclxuICAgICAgZGlhbG9nICYmIGRpYWxvZy5zYXZlKCk7IFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKFwiQURNSU5cIikgPj0gMDtcclxuICAgIGNvbnN0IGNvdXJzZSA9IHRoaXMuc3RhdGUuY291cnNlO1xyXG4gICAgcmV0dXJuICF0aGlzLnN0YXRlLmNvdXJzZSA/IDxkaXYgc3R5bGU9e3tvdXRsaW5lOiAwfX0+XHJcbiAgICAgIDxDb3Vyc2VCYW5uZXJcclxuICAgICAgICB0aXRsZT1cIlwiXHJcbiAgICAgICAgYWN0aXZlUGFnZT17dGhpcy5zdGF0ZS52aWV3fVxyXG4gICAgICAgIHJvdXRlcz17e2ZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsfX1cclxuICAgICAgLz48cD48U3Bpbm5lci8+Vi5nLiB2w6RudGEgbWVkYW4ga3Vyc2VuIGxhZGRhcy4uLjwvcD5cclxuICAgICAgPC9kaXY+IDpcclxuICAgICAgPGRpdiBzdHlsZT17e291dGxpbmU6IDB9fT5cclxuICAgICAgPENvdXJzZUJhbm5lclxyXG4gICAgICAgIHRpdGxlPXtjb3Vyc2UubmFtZSArIFwiIC0gXCIgKyBjb3Vyc2UucG9pbnRzICsgXCJwXCJ9XHJcbiAgICAgICAgYWN0aXZlUGFnZT17dGhpcy5zdGF0ZS52aWV3fVxyXG4gICAgICAgIHJvdXRlcz17e1xyXG4gICAgICAgICAgc3R1ZGVudFBhZ2U6IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KHRoaXMucHJvcHMudmlld0NvdXJzZVVybCwge2NvdXJzZUlkOiB0aGlzLnByb3BzLmlkfSksXHJcbiAgICAgICAgICBmZWVkYmFjazogdGhpcy5wcm9wcy5mZWVkYmFja1VybFxyXG4gICAgICAgIH19XHJcbiAgICAgICAgaG9zdD17dGhpc31cclxuICAgICAgICBjb3Vyc2U9e2NvdXJzZX1cclxuICAgICAgICBvcmlnQ291cnNlPXt0aGlzLnN0YXRlLm9yaWdDb3Vyc2V9XHJcbiAgICAgICAgYmFja2dyb3VuZEltYWdlPXtjb3Vyc2UuaW1hZ2VzLmZpbHRlcihpbWcgPT4gaW1nLmlkID09PSBjb3Vyc2UuaW1hZ2VJZCkubWFwKGltZz0+aW1nLnVybClbMF19XHJcbiAgICAgICAgaXNUZW1wbGF0ZT17Y291cnNlLmlzVGVtcGxhdGV9XHJcbiAgICAgICAvPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tMTJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytc3BhY2VyLTIwcHh2dCBzdi12ZXJ0aWNhbCBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiIHJlZj17XHJcbiAgICAgICAgICAgICAgZGl2ID0+IHRoaXMuY29udGVudERpdiA9IGRpdn0+XHJcbiAgICAgICAgICAgICAgPElubmVyRWRpdENvdXJzZVxyXG4gICAgICAgICAgICAgICAgY291cnNlPXt0aGlzLnN0YXRlLmNvdXJzZX1cclxuICAgICAgICAgICAgICAgIG9yaWdDb3Vyc2U9e3RoaXMuc3RhdGUub3JpZ0NvdXJzZX1cclxuICAgICAgICAgICAgICAgIGhvc3Q9e3RoaXN9IC8+XHJcbiAgICAgICAgICAgICAgPGJyLz5cclxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5kaWFsb2dDb250YWluZXJzLm1hcCgoe0NvbXBvbmVudCwgcHJvcHN9LCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gPGRpdiBrZXk9e2l9PlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRhcmtlblwiPlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlLXdyYXBcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXBhZ2VcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxDb21wb25lbnQgcmVmPXtkaWFsb2c9PnRoaXMucmVmRGlhbG9nKGRpYWxvZywgaSl9IHsuLi5wcm9wc30gLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCB7IEVkaXRDb3Vyc2UgfSBmcm9tICcuL2VkaXQtY291cnNlJztcclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIEFiaWxpdHksIFN1YmplY3QgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IEVkaXRhYmxlUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtcmVzb3VyY2UtbGlzdCc7XHJcbmltcG9ydCB7IGR0Rm9ybWF0IH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBDb3Vyc2VNb2R1bGVMaXN0IH0gZnJvbSAnLi9jb3Vyc2UtbW9kdWxlLWxpc3QnO1xyXG5pbXBvcnQgeyBTY2hvb2xDb3Vyc2VzIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvc2Nob29sLWNvdXJzZXMnO1xyXG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCB9IGZyb20gJy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0JztcclxuaW1wb3J0IHsgZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzLCBzYW5pdHlDaGVjaywgZ2V0SWRzTm90Q292ZXJlZEJ5VGFza3MsIGdldFNvZnRBY2Nlc3NMaXN0IH0gZnJvbSAnLi9idXNpbmVzcy1sb2dpYyc7XHJcbmltcG9ydCB7IHNldENvdXJzZUltYWdlIH0gZnJvbSBcIi4vY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XHJcbmltcG9ydCB7IEVkaXRhYmxlVGVhY2hlckxpc3QgfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9lZGl0YWJsZS10ZWFjaGVyLWxpc3QnO1xyXG5pbXBvcnQgeyBzaG93RXJyb3IsIEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IHsgV2VpZ2h0ZWRJdGVtc1RhYmxlIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvd2VpZ2h0ZWQtaXRlbXMtdGFibGUnO1xyXG5pbXBvcnQgeyBXeXNpd3lnIH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvaW5kZXgnO1xyXG5pbXBvcnQgYWN0aW9uc19zd2VkaXNoIGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2FjdGlvbnMtc3YnO1xyXG5pbXBvcnQgeyBFZGl0YWJsZVdvcmtGbG93TGluayB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXdvcmtmbG93LWxpbmsnO1xyXG5pbXBvcnQgeyBSZW5hbWVhYmxlVGV4dCB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9yZW5hbWVhYmxlLXRleHQnO1xyXG5pbXBvcnQgeyBnZXRDdXJyZW50VXNlciB9IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvY3VycmVudC11c2VyJztcclxuaW1wb3J0IHsgT2JzZXJ2ZSB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9vYnNlcnZlJztcclxuaW1wb3J0IHsgU2VsZWN0U3R1ZHlHcm91cHMgfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9zZWxlY3Qtc3R1ZHktZ3JvdXBzJztcclxuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcclxuaW1wb3J0IHsgZmVhdHVyZXMgfSBmcm9tICcuLi8uLi8uLi9mZWF0dXJlcyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNvdXJzZTogQ291cnNlO1xyXG4gIG9yaWdDb3Vyc2U6IENvdXJzZTtcclxuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcclxufTtcclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgY2hhbmdlSW1hZ2VVcmw6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBJbm5lckVkaXRDb3Vyc2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBwcm9wczogUHJvcHM7XHJcbiAgc3RhdGU6IFN0YXRlO1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgY2hhbmdlSW1hZ2VVcmw6IGZhbHNlXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0SW1hZ2VVcmwoaW1hZ2VVcmw6IHN0cmluZykge1xyXG4gICAgY29uc3QgeyBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBpZiAoIWNvdXJzZS5pbWFnZUlkKSB7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBjb3Vyc2UsIG9yaWdDb3Vyc2UsIGhvc3QgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB1bmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMgPSBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMoY291cnNlKTtcclxuICAgIGNvbnN0IGlkc05vdENvdmVyZWRCeUFueVRhc2sgPSBnZXRJZHNOb3RDb3ZlcmVkQnlUYXNrcyhjb3Vyc2UpO1xyXG4gICAgY29uc3Qgc2FuaXR5Q2hlY2tXYXJuaW5ncyA9IHNhbml0eUNoZWNrKGNvdXJzZSk7XHJcbiAgICBjb25zdCBjb3Vyc2VJbWFnZSA9IGNvdXJzZS5pbWFnZXMuZmluZChpbWcgPT4gaW1nLmlkID09PSBjb3Vyc2UuaW1hZ2VJZCk7XHJcbiAgICBjb25zdCBjb3Vyc2VJbWFnZUlzRGF0YVVybCA9IGNvdXJzZUltYWdlICYmIGNvdXJzZUltYWdlLnVybC5zdGFydHNXaXRoKCdkYXRhOicpO1xyXG4gICAgY29uc3QgY291cnNlSXNVcGxvYWRlZCA9IGNvdXJzZUltYWdlICYmIGNvdXJzZUltYWdlLnVybC5pbmRleE9mKCdzdG9yYWdlLmdvb2dsZWFwaXMuY29tJykgPiAwO1xyXG4gICAgY29uc3Qgc29mdEFjY2Vzc0xpc3QgPSBnZXRTb2Z0QWNjZXNzTGlzdChjb3Vyc2UpO1xyXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBnZXRDdXJyZW50VXNlcigpO1xyXG4gICAgY29uc3QgY2FuRGVsZXRlID0gc29mdEFjY2Vzc0xpc3Quc29tZSh1c2VyID0+IHVzZXIuZW1haWwgPT09IGN1cnJlbnRVc2VyLm1haWwgJiYgdXNlci5hY2Nlc3MgPT09ICdmdWxsJyk7XHJcbiAgICBjb25zdCBkaXNwbGF5U3R1ZHlHcm91cHMgPSBmZWF0dXJlcy5zdHVkeUdyb3VwcztcclxuXHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtcInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tN1wifT5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICB7Y291cnNlLmlzVGVtcGxhdGUgJiYgPGgxPkt1cnNtYWxsPC9oMT4gfVxyXG4gICAgICAgICAgPGgyPkt1cnPDtnZlcmdyaXBhbmRlPC9oMj5cclxuXHJcbiAgICAgICAgICA8T3BlbkNsb3NlQm94IHRpdGxlPXs8cD5LdXJzw7Z2ZXJncmlwYW5kZTwvcD59IGhlYWRlck9wZW49e3RydWV9IGluYWN0aXZhdGVkPXshZmVhdHVyZXMuY2JDb2xsYXBzZUJveGVzfT5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XHJcbiAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgPGgzPkt1cnNlbnMgYmlsZDwvaDM+XHJcbiAgICAgICAgICAgICAge2NvdXJzZUltYWdlSXNEYXRhVXJsID9cclxuICAgICAgICAgICAgICAgIDxwPkt1cnNlbnMgYmlsZCBsaWdnZXIgaSBkYXRhYmFzZW4uIEbDtnIgYXR0IMOkbmRyYSBiaWxkIG3DpXN0ZSBkdSBkcmEgb2NoIHNsw6RwcGEgZW4gbnkgYmlsZCBvdmFucMOlIGRlbiBnYW1sYSBow7Znc3QgdXBwIHDDpSBkZW5uYSBzaWRhLlxyXG4gICAgICAgICAgICAgICAgICBCaWxkZW4ga2FuIGFudGluZ2VuIHZhcmEgZnLDpW4gZW4gYW5uYW4gd2ViYnNpZGEuIExva2FsYSBiaWxkZmlsZXIgZ8OlciBvY2tzw6UgYnJhIGF0dCBkcmEgb2NoIHNsw6RwcGEuPC9wPlxyXG4gICAgICAgICAgICAgICAgIDogY291cnNlSXNVcGxvYWRlZCA/IDxwPlxyXG4gICAgICAgICAgICAgICAgICAgS3Vyc2VucyBiaWxkIGxpZ2dlciBpIEt1bnNrYXBzc2tvbGFucyBHb29nbGUgbW9sbi4gRsO2ciBhdHQgw6RuZHJhIGJpbGQgbcOlc3RlIGR1IGRyYSBvY2ggc2zDpHBwYSBlbiBueSBiaWxkIG92YW5ww6UgZGVuIGdhbWxhIGjDtmdzdCB1cHAgcMOlIGRlbm5hIHNpZGEuXHJcbiAgICAgICAgICAgICAgICAgIEJpbGRlbiBrYW4gYW50aW5nZW4gdmFyYSBmcsOlbiBlbiBhbm5hbiB3ZWJic2lkYS4gTG9rYWxhIGJpbGRmaWxlciBnw6VyIG9ja3PDpSBicmEgYXR0IGRyYSBvY2ggc2zDpHBwYS5cclxuICAgICAgICAgICAgICAgICA8L3A+IDogY291cnNlSW1hZ2UgPyA8ZGl2Pjx0ZXh0YXJlYVxyXG4gICAgICAgICAgICAgICAgICB2YWx1ZT17Y291cnNlSW1hZ2UudXJsfVxyXG4gICAgICAgICAgICAgICAgICBzdHlsZT17e3dpZHRoOiAnMTAwJScsIGhlaWdodDogJzMwcHgnfX1cclxuICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2PT5zZXRDb3Vyc2VJbWFnZShjb3Vyc2UsIG9yaWdDb3Vyc2UsIGhvc3QsIGV2LnRhcmdldC52YWx1ZSl9Lz5cclxuICAgICAgICAgICAgICAgICAgPHA+QmlsZGVuIHNvbSB2aXNhcyBow7Znc3QgdXBwIGjDpG10YXMgZnLDpW4gYW5naXZlbiBVUkwuXHJcbiAgICAgICAgICAgICAgICAgICAgRsO2ciBhdHQgw6RuZHJhIGJpbGQga2FuIGR1IHJlZGlnZXJhIFVSTCBvdmFuLiBFdHQgYW5uYXQgc8OkdHQgYXR0IMOkbmRyYSBiaWxkIMOkciBhdHQgZHJhIG9jaCBzbMOkcHBhIGVuIG55IGJpbGQgw7Z2ZXIgZGVuIGdhbWxhIGjDtmdzdCB1cHAgcMOlIHNpZGFuLjwvcD5cclxuICAgICAgICAgICAgICAgIDwvZGl2PiA6XHJcbiAgICAgICAgICAgICAgICAgIDxwPkt1cnNlbiBzYWtuYXIgZWdlbiBiaWxkLlxyXG4gICAgICAgICAgICAgICAgICAgIEzDpGdnIHRpbGwgZW4gYmlsZCBnZW5vbSBhdHQgZHJhIG9jaCBzbMOkcHBhIGVuIGJpbGQgcMOlIGt1cnMtYmFubmVybiBow7Znc3QgdXBwIHDDpSBkZW4gaMOkciBzaWRhbi48L3A+fVxyXG4gICAgICAgICAgICAgIDxici8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgeyFjb3Vyc2UuaXNUZW1wbGF0ZSAmJiA8ZGl2PlxyXG4gICAgICAgICAgICAgIDxoMz5CZXNrcml2bmluZzwvaDM+XHJcbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic3ViSGVhZGVyXCI+KEJlc2tyaXZuaW5nIGF2IGt1cnNlbi4gRsO2ciBhdHQgc2tpbGphIG1lbGxhbiBvbGlrYSB2YXJpYW50ZXIgYXYgc2FtbWEgZ3ltbmFzaWVrdXJzKTwvcD5cclxuICAgICAgICAgICAgICA8dGV4dGFyZWEgY2xhc3NOYW1lPVwiaW5wdXRUZXh0Qm94IGlucHV0VGV4dFNtYWxsXCJcclxuICAgICAgICAgICAgICAgIHZhbHVlPXtjb3Vyc2UuZGVzY3JpcHRpb259XHJcbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gaG9zdC51cGRhdGUoeyBkZXNjcmlwdGlvbjogeyAkc2V0OiBldi50YXJnZXQudmFsdWUgfSB9KX0gLz5cclxuICAgICAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgICAgPC9kaXY+fSAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICA8aDM+VXBwdGFrdHN0ZXh0PC9oMz5cclxuICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzdWJIZWFkZXJcIj4odGV4dGVuIHNrYSB2aXNhcyBww6Uga3Vyc2VucyB1cHB0YWt0c3Nla3Rpb24pPC9wPlxyXG4gICAgICAgICAgICAgIDxXeXNpd3lnXHJcbiAgICAgICAgICAgICAgICBodG1sPXtjb3Vyc2UucnVuVXBUZXh0fVxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdEFjdGlvbnM9e2FjdGlvbnNfc3dlZGlzaH1cclxuICAgICAgICAgICAgICAgIGFjdGlvbnM9e1tcclxuICAgICAgICAgICAgICAgICAgXCJib2xkXCIsXHJcbiAgICAgICAgICAgICAgICAgIFwiaXRhbGljXCIsXHJcbiAgICAgICAgICAgICAgICAgIFwidW5kZXJsaW5lXCIsXHJcbiAgICAgICAgICAgICAgICAgIFwic3RyaWtldGhyb3VnaFwiLFxyXG4gICAgICAgICAgICAgICAgICBcImhlYWRpbmcyXCIsXHJcbiAgICAgICAgICAgICAgICAgIFwiaGVhZGluZzNcIixcclxuICAgICAgICAgICAgICAgICAgXCJvbGlzdFwiLFxyXG4gICAgICAgICAgICAgICAgICBcInVsaXN0XCIsXHJcbiAgICAgICAgICAgICAgICAgIFwibGluZVwiLFxyXG4gICAgICAgICAgICAgICAgICBcImxpbmtcIixcclxuICAgICAgICAgICAgICAgICAgXCJpbWFnZVwiXX1cclxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtuZXdIdG1sID0+IGhvc3QudXBkYXRlKHsgcnVuVXBUZXh0OiB7JHNldDogbmV3SHRtbH19KX0gLz5cclxuICAgICAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICA8aDM+S3Vyc3Jlc3Vyc2VyPC9oMz5cclxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic3ViSGVhZGVyXCI+KFJlc3Vyc2VyIGbDtnIgdXBwdGFrdCBvY2gga3Vyc2VuIHNvbSBoZWxoZXQpPC9wPlxyXG4gICAgICAgICAgICA8RWRpdGFibGVSZXNvdXJjZUxpc3RcclxuICAgICAgICAgICAgICByZXNvdXJjZXM9e2NvdXJzZS5yZXNvdXJjZXN9XHJcbiAgICAgICAgICAgICAgb25VcGRhdGU9e3Jlc291cmNlc1VwZGF0ZXMgPT4gaG9zdC51cGRhdGUoeyByZXNvdXJjZXM6IHJlc291cmNlc1VwZGF0ZXMgfSl9XHJcbiAgICAgICAgICAgICAgaG9zdD17aG9zdH0gLz5cclxuICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICAgIDxoMz5BcmJldHNnw6VuZzwvaDM+XHJcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInN1YkhlYWRlclwiPihFdmVudHVlbGwgbMOkbmsgdGlsbCBhcmJldHNnw6VuZyBmw7ZyIGt1cnNlbik8L3A+XHJcbiAgICAgICAgICAgIDxFZGl0YWJsZVdvcmtGbG93TGlua1xyXG4gICAgICAgICAgICAgIHVybD17Y291cnNlLndvcmtGbG93TGlua31cclxuICAgICAgICAgICAgICBvblVwZGF0ZT17dXBkYXRlcyA9PiBob3N0LnVwZGF0ZSh7IHdvcmtGbG93TGluazogdXBkYXRlcyB9KX1cclxuICAgICAgICAgICAgICBob3N0PXtob3N0fSAvPlxyXG4gICAgICAgICAgICA8YnIgLz5cclxuICAgICAgICAgICAgeyFjb3Vyc2UuaXNUZW1wbGF0ZSAmJiA8ZGl2PlxyXG4gICAgICAgICAgICAgIDxoMz5Hb29nbGUgQ2xhc3Nyb29tPC9oMz5cclxuICAgICAgICAgICAgICB7ZGlzcGxheVN0dWR5R3JvdXBzID8gPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImNoZWNrQm94XCIgKyAoY291cnNlLmdvb2dsZUNyZWF0ZUNsYXNzcm9vbXMgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7IGhvc3QudXBkYXRlKHsgZ29vZ2xlQ3JlYXRlQ2xhc3Nyb29tczogeyAkc2V0OiAhY291cnNlLmdvb2dsZUNyZWF0ZUNsYXNzcm9vbXMgfSB9KSB9fSAvPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgICBTa2FwYSBrbGFzc3J1bSBmw7ZyIGt1cnNlblxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+IFxyXG4gICAgICAgICAgICAgIDpcclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWwgc3BhY2VkXCI+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkdvb2dsZSBjbGFzc3Jvb20gVVJMXCJcclxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT17MzB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2NvdXJzZS5nb29nbGVDbGFzc1Jvb21VUkx9XHJcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IGhvc3QudXBkYXRlKHsgZ29vZ2xlQ2xhc3NSb29tVVJMOiB7ICRzZXQ6IGV2LnRhcmdldC52YWx1ZSB9IH0pfSAvPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgICA8aW5wdXRcclxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cImtvZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU9ezh9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU9e2NvdXJzZS5nb29nbGVDbGFzc1Jvb21Db2RlfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiBob3N0LnVwZGF0ZSh7IGdvb2dsZUNsYXNzUm9vbUNvZGU6IHsgJHNldDogZXYudGFyZ2V0LnZhbHVlIH0gfSl9IC8+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDwvZGl2Pn1cclxuXHJcbiAgICAgICAgICAgIHtjb3Vyc2UuaXNUZW1wbGF0ZSA/IG51bGwgOiA8PlxyXG4gICAgICAgICAgICAgIDxFZGl0YWJsZVRlYWNoZXJMaXN0IFxyXG4gICAgICAgICAgICAgICAgc2Nob29sPXtjb3Vyc2Uuc2Nob29sfVxyXG4gICAgICAgICAgICAgICAgdGVhY2hlcnM9e2NvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzfVxyXG4gICAgICAgICAgICAgICAgb25VcGRhdGU9e3RlYWNoZXJzVXBkYXRlID0+IHtcclxuICAgICAgICAgICAgICAgICAgaG9zdC51cGRhdGUoe3Jlc3BvbnNpYmxlVGVhY2hlcnM6IHskc2V0OiB0ZWFjaGVyc1VwZGF0ZX19KTtcclxuICAgICAgICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgICAgICAgPGJyLz5cclxuICAgICAgICAgICAgICB7ZGlzcGxheVN0dWR5R3JvdXBzICYmIDxkaXYgY2xhc3NOYW1lPVwic2VsZWN0LXN0dWR5Z3JvdXBzXCI+XHJcbiAgICAgICAgICAgICAgICA8aDM+e0xgU3R1ZGllZ3J1cHBlcmB9PC9oMz5cclxuICAgICAgICAgICAgICAgIDxPYnNlcnZlXHJcbiAgICAgICAgICAgICAgICAgIGZhbGxiYWNrPXs8U3Bpbm5lciAvPn1cclxuICAgICAgICAgICAgICAgICAgZXJyb3JGYWxsYmFjaz17TGBLdW5kZSBpbnRlIGxhZGRhIHN0dWRpZWdydXBwZXIgZnLDpW4gRURTYH0+XHJcblxyXG4gICAgICAgICAgICAgICAgICA8U2VsZWN0U3R1ZHlHcm91cHNcclxuICAgICAgICAgICAgICAgICAgICBzY2hvb2w9e2NvdXJzZS5zY2hvb2x9XHJcbiAgICAgICAgICAgICAgICAgICAgY291cnNlQ29kZT17Y291cnNlLmNvZGV9XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRTdHVkeUdyb3Vwcz17Y291cnNlLnN0dWR5R3JvdXBzIHx8IFtdfVxyXG4gICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlPXtzdHVkeUdyb3VwcyA9PiBob3N0LnVwZGF0ZSh7IHN0dWR5R3JvdXBzOiB7ICRzZXQ6IHN0dWR5R3JvdXBzIH0gfSl9IC8+XHJcblxyXG4gICAgICAgICAgICAgICAgPC9PYnNlcnZlPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgPC8+XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgey8qXHJcbiAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICA8aDM+SW5sw6RtbmluZ3MgRS1wb3N0PC9oMz5cclxuICAgICAgICAgICAgPHRhYmxlIHRhYkluZGV4PXsxfSBzdHlsZT17e3dpZHRoOiAnMTAwJSd9fT5cclxuICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5cclxuICAgICAgICAgICAgICAgIEUtcG9zdGFkZHJlc3NcclxuICAgICAgICAgICAgICA8L3RoPjwvdHI+PC90aGVhZD5cclxuICAgICAgICAgICAgICA8dGJvZHk+XHJcbiAgICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICA8UmVuYW1lYWJsZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAgIGVhZ2VyPXt0cnVlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgY2xpY2tBZHZlcnRpc2VUZXh0PVwiS2xpY2thIGjDpHIgZsO2ciBhdHQgYW5nZSB2ZW0gc29tIHRhciBlbW90IGlubMOkbW5pbmdzdXBwZ2lmdGVyXCJcclxuICAgICAgICAgICAgICAgICAgICAgIHRleHQ9e2NvdXJzZS5hc3NpZ25tZW50RW1haWxzID8gY291cnNlLmFzc2lnbm1lbnRFbWFpbHNbMF0gOiBcIlwifVxyXG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBbmdlIG1vdHRhZ2FyZSBhdiBpbmzDpG1uaW5nc3VwcGdpZnRlclwiXHJcbiAgICAgICAgICAgICAgICAgICAgICB0YWc9XCJpbnB1dFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dmFsdWUgPT4gaG9zdC51cGRhdGUoe2Fzc2lnbm1lbnRFbWFpbHM6IHskc2V0OiBbdmFsdWVdfX0pfVxyXG4gICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgIDwvdGJvZHk+XHJcbiAgICAgICAgICAgIDwvdGFibGU+Ki99XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L09wZW5DbG9zZUJveD5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICAgICAgPGRpdiBpZD1cIkt1cnNlbnNtb2R1bGVyXCI+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8aDI+S3Vyc2VucyBtb2R1bGVyPC9oMj5cclxuICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxDb3Vyc2VNb2R1bGVMaXN0XHJcbiAgICAgICAgICAgIGhvc3Q9e2hvc3R9XHJcbiAgICAgICAgICAgIGNvdXJzZT17Y291cnNlfVxyXG4gICAgICAgICAgICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrPXtpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfSAvPlxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICA8YnIvPlxyXG4gICAgICAgICAgICA8V2VpZ2h0ZWRJdGVtc1RhYmxlIGNvdXJzZT17Y291cnNlfS8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAgICAgIDxoMj5LdXJzZW5zIHN0YXR1czwvaDI+XHJcbiAgICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgICB7Y291cnNlLmNyZWF0ZWRCeSAmJiBjb3Vyc2UuY3JlYXRlZERhdGUgJiYgPHA+XHJcbiAgICAgICAgICAgICAgS3Vyc2VuIHNrYXBhZGVzIHtkdEZvcm1hdChjb3Vyc2UuY3JlYXRlZERhdGUpfSBhdiA8c3Ryb25nPntjb3Vyc2UuY3JlYXRlZEJ5Lm5hbWV9PC9zdHJvbmc+LlxyXG4gICAgICAgICAgICA8L3A+fVxyXG4gICAgICAgICAgICB7Y291cnNlLm1vZGlmaWVkQnkgJiYgY291cnNlLm1vZGlmaWVkRGF0ZSAmJiA8cD5cclxuICAgICAgICAgICAgICBLdXJzZW4gcmVkaWdlcmFkZXMgc2VuYXN0IHtkdEZvcm1hdChjb3Vyc2UubW9kaWZpZWREYXRlKX0gYXYgPHN0cm9uZz57Y291cnNlLm1vZGlmaWVkQnkubmFtZX08L3N0cm9uZz4uXHJcbiAgICAgICAgICAgIDwvcD59XHJcbiAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlID8gPHA+XHJcbiAgICAgICAgICAgICAgS3Vyc2VuIMOkciA8c3Ryb25nPkFLVElWPC9zdHJvbmc+IHNlZGFuIHtkdEZvcm1hdChjb3Vyc2UuYWN0aXZhdGVkRGF0ZSl9IGF2IDxzdHJvbmc+e2NvdXJzZS5hY3RpdmF0ZWRCeS5uYW1lfTwvc3Ryb25nPi5cclxuICAgICAgICAgICAgPC9wPiA6IDxwPlxyXG4gICAgICAgICAgICAgICAgS3Vyc2VuIMOkciA8c3Ryb25nPklOQUtUSVY8L3N0cm9uZz57Y291cnNlLmluYWN0aXZhdGVkQnkgPyA8c3Bhbj5cclxuICAgICAgICAgICAgICAgICAgc2VkYW4ge2R0Rm9ybWF0KGNvdXJzZS5pbmFjdGl2YXRlZERhdGUpfSBhdiA8c3Ryb25nPntjb3Vyc2UuaW5hY3RpdmF0ZWRCeS5uYW1lfTwvc3Ryb25nPi48L3NwYW4+IDogPHNwYW4+Ljwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICA8L3A+fVxyXG4gICAgICAgICAgICB7KHVuY292ZXJlZEtub3dsZWRnZVJlcXVpcmVtZW50cy5sZW5ndGggPT09IDAgP1xyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cIm1hcmtlZEdyZWVuXCI+TW9kdWxlcm5hcyBrdW5za2Fwc2tyYXYgdMOkY2tlciBza29sdmVya2V0cyBrcmF2IGbDtnIgZGVubmEga3VyczwvcD4gOlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFya2VkUmVkIHdhcm5pbmctYm94XCI+PGRpdiBjbGFzc05hbWU9XCJ3YXJuaW5nRmxhZ1wiPlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgICAgICAgICAgPC9kaXY+PHA+TW9kdWxlcm5hcyBrdW5za2Fwc2tyYXYgdMOkY2tlciBpbnRlIHNrb2x2ZXJrZXRzIGtyYXYgZsO2ciBkZW5uYSBrdXJzLjwvcD5cclxuICAgICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgICB7c2FuaXR5Q2hlY2tXYXJuaW5ncy5tYXAod2FybmluZyA9PiA8ZGl2IGtleT17d2FybmluZ30gY2xhc3NOYW1lPVwibWFya2VkUmVkIHdhcm5pbmctYm94XCI+PGRpdiBjbGFzc05hbWU9XCJ3YXJuaW5nRmxhZ1wiPlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgICAgICAgICAgPC9kaXY+PHA+e3dhcm5pbmd9PC9wPjwvZGl2Pil9XHJcbiAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICB7Y2FuRGVsZXRlICYmICFjb3Vyc2UuaXNUZW1wbGF0ZSAmJiAob3JpZ0NvdXJzZSA/IDxkaXZcclxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIlxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT57XHJcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlybShMYEJla3LDpGZ0YSBib3J0dGFnbmluZyBhdiBrdXJzZW4gXCIke2NvdXJzZS5uYW1lfSAtICR7Y291cnNlLmRlc2NyaXB0aW9ufVwiIGbDtnIgc2tvbGFuICR7Y291cnNlLnNjaG9vbH1cXG5cXG5LdXJzZW4ga29tbWFyIGF0dCByYWRlcmFzIGhlbHQhXFxuXFxuw4RyIGR1IHPDpGtlcj9gKSlcclxuICAgICAgICAgICAgICAgICAgaG9zdC5kZWxldGVDb3Vyc2UoKS5jYXRjaChzaG93RXJyb3IpO1xyXG4gICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgID5UYSBib3J0IGt1cnM8L2Rpdj46PGRpdlxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiXHJcbiAgICAgICAgICAgICAgb25DbGljaz17KCk9Pmhpc3RvcnkuZ28oLTEpfVxyXG4gICAgICAgICAgICA+QXZicnl0XHJcbiAgICAgICAgICAgICAgPC9kaXY+KX1cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlXCIgb25DbGljaz17KCkgPT4gaG9zdC5jb25maXJtU2F2ZUFuZFN5bmMoKX0+XHJcbiAgICAgICAgICAgICAgU3BhcmFcclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlID9cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4taW5mbyBidG4tbGFyZ2VcIlxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaG9zdC5pbmFjdGl2YXRlQW5kU2F2ZSgpfT5cclxuICAgICAgICAgICAgICAgIEluYWt0aXZlcmEgb2NoIHNwYXJhXHJcbiAgICAgICAgICAgICAgPC9kaXY+IDpcclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4taW5mbyBidG4tbGFyZ2VcIlxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaG9zdC5hY3RpdmF0ZUFuZFNhdmUoKX0+XHJcbiAgICAgICAgICAgICAgICBBa3RpdmVyYSBvY2ggc3BhcmFcclxuICAgICAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICAgICAge2NvdXJzZS5nb29nbGVDcmVhdGVDbGFzc3Jvb21zICYmIGRpc3BsYXlTdHVkeUdyb3VwcyAmJlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLXByaW1hcnkgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXsoKSA9PiBob3N0LnN5bmNXaXRoQ2xhc3Nyb29tQW5kU2F2ZSgpfT5cclxuICAgICAgICAgICAgICAgICAge2hvc3Quc3luY0luUHJvZ3Jlc3MoKSA/IDxTcGlubmVyIC8+IDogXHJcbiAgICAgICAgICAgICAgICAgIChjb3Vyc2UuaW5TeW5jV2l0aENsYXNzcm9vbSA/IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhcyBmYS1jaGVja1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT48L3NwYW4+OiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYXMgZmEtY29kZS1icmFuY2hcIj48L2k+PC9zcGFuPil9XHJcbiAgICAgICAgICAgICAgICAgICZuYnNwO1N5bmMgbWVkIGtsYXNzcnVtXHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1jb2x1bW4tNVwiPlxyXG4gICAgICAgIDxTY2hvb2xDb3Vyc2VzIC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB7IEVycm9yU3VjY2Vzc0ZlZWRiYWNrIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3Itc3VjY2Vzcy1mZWVkYmFjayc7XHJcbmltcG9ydCB7IFNjaG9vbHMgfSBmcm9tICcuL3NjaG9vbHMnO1xyXG5pbXBvcnQgeyBOZXdTY2hvb2wgfSBmcm9tICcuL3NjaG9vbHMvbmV3LXNjaG9vbCc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuXHJcbi8vIFZpZXdzXHJcbmltcG9ydCB7IFN1YmplY3RzLCBTaG93U3ViamVjdCB9IGZyb20gJy4vc3ViamVjdHMnO1xyXG5pbXBvcnQgeyBFZGl0Q291cnNlIH0gZnJvbSAnLi9jb3Vyc2VzJztcclxuaW1wb3J0IHsgRWRpdFNjaG9vbCB9IGZyb20gXCIuL3NjaG9vbHMvZWRpdC1zY2hvb2xcIjtcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XHJcbmltcG9ydCB7IENyZWF0ZU5ld0NvdXJzZSB9IGZyb20gXCIuL2NvdXJzZXMvY3JlYXRlLW5ld1wiO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xyXG5cclxuLy8gS2VlcCBTZXNzaW9uIEFsaXZlXHJcbmltcG9ydCB7IGtlZXBTZXNzaW9uQWxpdmUgfSBmcm9tICcuLi8uLi91dGlscy9rZWVwLXNlc3Npb24tYWxpdmUnO1xyXG5rZWVwU2Vzc2lvbkFsaXZlKCk7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZztcclxuICBmZWVkYmFja1VybDogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ291cnNlQnVpbGRlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgaXNBdXRob3JpemVkID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSBcIkFETUlOXCIgfHwgcm9sZSA9PT0gXCJFTVBMT1lFRVwiKTtcclxuICAgIGNvbnN0IGlzQWRtaW4gPSBlbnYuY3VycmVudFVzZXIucm9sZXMuc29tZShyb2xlID0+IHJvbGUgPT09IFwiQURNSU5cIik7XHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJjb3Vyc2UtYnVpbGRlclwiPlxyXG4gICAgICA8Um91dGVyPlxyXG4gICAgICAgIHtpc0F1dGhvcml6ZWQgPyA8ZGl2PlxyXG4gICAgICAgICAgPFJvdXRlIGV4YWN0IHBhdGg9XCIvXCIgcmVuZGVyPXsoeyBtYXRjaCB9KSA9PiBpc0FkbWluID9cclxuICAgICAgICAgICAgPFNjaG9vbHMgdmlld0NvdXJzZVVybD17dGhpcy5wcm9wcy52aWV3Q291cnNlVXJsfSBmZWVkYmFja1VybD17dGhpcy5wcm9wcy5mZWVkYmFja1VybH0gLz4gOlxyXG4gICAgICAgICAgICA8Q3JlYXRlTmV3Q291cnNlIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3NjaG9vbHNcIiByZW5kZXI9eyh7IG1hdGNoIH0pID0+XHJcbiAgICAgICAgICAgIDxTY2hvb2xzXHJcbiAgICAgICAgICAgICAgdmlld0NvdXJzZVVybD17dGhpcy5wcm9wcy52aWV3Q291cnNlVXJsfVxyXG4gICAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3NjaG9vbHMvbmV3L2d5bW5hc2l1bVwiIHJlbmRlcj17KCk9PjxOZXdTY2hvb2wgdHlwZT1cImd5bW5hc2l1bVwiIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3NjaG9vbHMvbmV3L3ByaW1hcnlcIiByZW5kZXI9eygpPT48TmV3U2Nob29sIHR5cGU9XCJwcmltYXJ5XCIgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9IC8+fSAvPlxyXG4gICAgICAgICAgPFJvdXRlIGV4YWN0IHBhdGg9XCIvc2Nob29scy86aWQvZWRpdFwiIHJlbmRlcj17KHsgbWF0Y2ggfSkgPT4gPEVkaXRTY2hvb2xcclxuICAgICAgICAgICAgaWQ9e21hdGNoLnBhcmFtcy5pZH1cclxuICAgICAgICAgICAgdGl0bGU9e0xgRWRpdGVyYSBza29sYWB9XHJcbiAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3N1YmplY3RzXCIgcmVuZGVyPXsoKT0+PFN1YmplY3RzIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBwYXRoPVwiL3N1YmplY3RzLzppZFwiIHJlbmRlcj17KHsgbWF0Y2ggfSkgPT4gPFNob3dTdWJqZWN0XHJcbiAgICAgICAgICAgIGlkPXttYXRjaC5wYXJhbXMuaWR9XHJcbiAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL2NvdXJzZXMvbmV3XCIgcmVuZGVyPXsoKT0+IDxDcmVhdGVOZXdDb3Vyc2VcclxuICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cclxuICAgICAgICAgIDxSb3V0ZSBwYXRoPVwiL2NvdXJzZXMvY3JlYXRlLWZyb20tdGVtcGxhdGUvOnRlbXBsYXRlSWRcIiByZW5kZXI9eyh7bWF0Y2h9KSA9PiA8RWRpdENvdXJzZVxyXG4gICAgICAgICAgICB0ZW1wbGF0ZUlkPXttYXRjaC5wYXJhbXMudGVtcGxhdGVJZH1cclxuICAgICAgICAgICAgdmlldz1cImNvdXJzZUJ1aWxkZXJcIlxyXG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XHJcbiAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfVxyXG4gICAgICAgICAgLz59Lz5cclxuICAgICAgICAgIDxSb3V0ZSBwYXRoPVwiL2NvdXJzZXMvOmlkL2VkaXRcIiByZW5kZXI9eyh7bWF0Y2h9KSA9PiA8RWRpdENvdXJzZVxyXG4gICAgICAgICAgICBpZD17bWF0Y2gucGFyYW1zLmlkfVxyXG4gICAgICAgICAgICB2aWV3PVwiY291cnNlQnVpbGRlclwiXHJcbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cclxuICAgICAgICAgICAgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9XHJcbiAgICAgICAgICAvPn0gLz5cclxuICAgICAgICA8L2Rpdj4gOiA8ZGl2PlxyXG4gICAgICAgICAgICA8Um91dGUgcGF0aD1cIi9cIiByZW5kZXI9eygpID0+IDxkaXY+XHJcbiAgICAgICAgICAgICAgPENvdXJzZUJhbm5lciB0aXRsZT1cIkt1cnNieWdnYXJlblwiIGFjdGl2ZVBhZ2U9XCJjb3Vyc2VCdWlsZGVyXCIgcm91dGVzPXt7ZmVlZGJhY2s6IHRoaXMucHJvcHMuZmVlZGJhY2tVcmx9fSAvPlxyXG4gICAgICAgICAgICAgIDxoMj5CZWjDtnJpZ2hldCBzYWtuYXM8L2gyPlxyXG4gICAgICAgICAgICAgIDxwPkRldHRhIHZlcmt0eWcgw6RyIGVuZGFzdCB0aWxsIGbDtnIgYW5zdMOkbGxkYSBww6UgS3Vuc2thcHNza29sYW4uPC9wPlxyXG4gICAgICAgICAgICAgIDxoMz5BbnbDpG5kYXJhdHRyaWJ1dDwvaDM+XHJcbiAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiIHN0eWxlPXt7Ym9yZGVyOiBcIjFweCBzb2xpZCAjZWVlXCJ9fT5cclxuICAgICAgICAgICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0aD5BdHRyaWJ1dDwvdGg+XHJcbiAgICAgICAgICAgICAgICAgICAgPHRoPlbDpHJkZTwvdGg+XHJcbiAgICAgICAgICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxyXG4gICAgICAgICAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAgICAgICAgICB7T2JqZWN0LmtleXMoZW52LmN1cnJlbnRVc2VyKS5tYXAoYXR0ciA9PiA8dHIga2V5PXthdHRyfT5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+e2F0dHJ9PC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+e2Vudi5jdXJyZW50VXNlclthdHRyXX08L3RkPlxyXG4gICAgICAgICAgICAgICAgICA8L3RyPil9XHJcbiAgICAgICAgICAgICAgICA8L3Rib2R5PjwvdGFibGU+XHJcbiAgICAgICAgICAgIDwvZGl2Pn0gLz5cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgPC9Sb3V0ZXI+XHJcbiAgICAgIDxFcnJvclN1Y2Nlc3NGZWVkYmFjayAvPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgU2Nob29sQ291cnNlcyB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL3NjaG9vbC1jb3Vyc2VzJztcclxuaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGR0Rm9ybWF0IH0gZnJvbSAnLi4vdXRpbHMnO1xyXG5pbXBvcnQgeyBEaWFsb2cgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB2YWxpZFVybCBmcm9tICd2YWxpZC11cmwnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICByZXNvdXJjZT86IFJlc291cmNlO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgb25TYXZlOiAobmV3UmVzb3VyY2U6IFJlc291cmNlKSA9PiB2b2lkO1xyXG4gIG9uRGVsZXRlPzogKCk9PnZvaWQ7XHJcbn1cclxuXHJcbnR5cGUgU3RhdGUgPSBSZXNvdXJjZTtcclxuXHJcbmV4cG9ydCBjbGFzcyBFZGl0UmVzb3VyY2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IGltcGxlbWVudHMgRGlhbG9nIHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB0aGlzLnByb3BzLnJlc291cmNlIHx8IHtuYW1lOiAnJywgdXJsOiAnJ307XHJcbiAgfVxyXG5cclxuICBzYXZlKCkge1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSB0aGlzLnN0YXRlO1xyXG4gICAgaWYgKCF2YWxpZFVybC5pc1VyaShyZXNvdXJjZS51cmwpKSB0aHJvdyBuZXcgRXJyb3IoTGBBbmdpdmVuIFVSTCAnJHtyZXNvdXJjZS51cmx9JyDDpHIgb2dpbHRpZy4gU2thIGLDtnJqYSBtZWQgZXhlbXBlbHZpcyBodHRwOiwgaHR0cHM6IGVsbGVyIG1haWx0bzpgKTtcclxuICAgIHRoaXMucHJvcHMub25TYXZlKHJlc291cmNlKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHt0aXRsZSwgb25TYXZlLCBvbkRlbGV0ZX0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgcmVzb3VyY2UgPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgaXNWYWxpZFVybCA9IHZhbGlkVXJsLmlzVXJpKHRoaXMuc3RhdGUudXJsKTtcclxuXHJcbiAgICByZXR1cm4gPGRpdj48ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxoMj57dGl0bGV9PC9oMj5cclxuICAgICAgPGhyIC8+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+TmFtbjo8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzXHJcbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBzaXplPXs1MH1cclxuICAgICAgICAgICAgdmFsdWU9e3Jlc291cmNlLm5hbWV9XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXtldj0+dGhpcy5zZXRTdGF0ZSh7bmFtZTogZXYudGFyZ2V0LnZhbHVlfSl9IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPkzDpG5rOjwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIFwiPlxyXG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgIHNpemU9ezUwfVxyXG4gICAgICAgICAgICB2YWx1ZT17cmVzb3VyY2UudXJsfVxyXG4gICAgICAgICAgICBvbkNoYW5nZT17ZXY9PnRoaXMuc2V0U3RhdGUoe3VybDogZXYudGFyZ2V0LnZhbHVlfSl9IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8YnIgLz48L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgIHsocmVzb3VyY2UuY3JlYXRlZERhdGUgfHwgcmVzb3VyY2UubW9kaWZpZWREYXRlKSAmJiA8ZGl2PlxyXG4gICAgICAgICAge3Jlc291cmNlLmNyZWF0ZWREYXRlICYmIDxwPlxyXG4gICAgICAgICAgICBSZXN1cnNlbi9Mw6Rua2VuIHNrYXBhZGVzIHtkdEZvcm1hdChyZXNvdXJjZS5jcmVhdGVkRGF0ZSl9IGF2IDxzdHJvbmc+e3Jlc291cmNlLmNyZWF0ZWRCeS5uYW1lfTwvc3Ryb25nPi5cclxuICAgICAgICAgIDwvcD59XHJcbiAgICAgICAgICB7cmVzb3VyY2UubW9kaWZpZWREYXRlICYmIDxwPlxyXG4gICAgICAgICAgICBSZXN1cnNlbi9Mw6Rua2VuIHJlZGlnZXJhZGVzIHNlbmFzdCB7ZHRGb3JtYXQocmVzb3VyY2UubW9kaWZpZWREYXRlKX0gYXYgPHN0cm9uZz57cmVzb3VyY2UubW9kaWZpZWRCeS5uYW1lfTwvc3Ryb25nPi5cclxuICAgICAgICAgIDwvcD59XHJcbiAgICAgICAgICA8YnIgLz48YnIvPlxyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgICB7b25EZWxldGUgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCk9Pm9uRGVsZXRlKCl9PlxyXG4gICAgICAgICAgVGEgYm9ydCByZXN1cnMvbMOkbmtcclxuICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgPGEgdGFiSW5kZXg9ezF9IGNsYXNzTmFtZT17XCJidG4gYnRuLWxhcmdlXCIgKyAoaXNWYWxpZFVybCA/IFwiXCIgOiBcIiBidG4taW5hY3RpdmVcIil9IG9uQ2xpY2s9e2lzVmFsaWRVcmwgJiYgKCgpID0+IG9uU2F2ZShyZXNvdXJjZSkpfT5TcGFyYTwvYT5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgVGFzaywgQ291cnNlIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcbmltcG9ydCB7IEZlYXR1cmVzIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2ZlYXR1cmVzXCI7XHJcbmltcG9ydCB7IEVkaXRUYXNrIH0gZnJvbSBcIi4vZWRpdC10YXNrXCI7XHJcbmltcG9ydCBSZWFjdERhdGVQaWNrZXIgZnJvbSBcInJlYWN0LWRhdGVwaWNrZXJcIjtcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7VGFza01pZ3JhdGlvbkJveH0gZnJvbSBcIi4vdGFzay1taWdyYXRpb24tYm94XCI7XHJcbmltcG9ydCB7IEdvb2dsZVBpY2tlciB9IGZyb20gJy4uLy4uLy4uLy4uL2FwaXMvZ29vZ2xlLXBpY2tlcic7XHJcbmltcG9ydCB7IERyaXZlQnV0dG9uIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2FwaXMvYnV0dG9uc1wiO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0YXNrOiBUYXNrO1xyXG4gIGNvdXJzZTogQ291cnNlO1xyXG4gIHdyaXRlQWNjZXNzOiBib29sZWFuO1xyXG4gIGZlYXR1cmVzOiBGZWF0dXJlcztcclxuICBlZGl0VGFzazogRWRpdFRhc2s7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBCYXNpY0VkaXRhYmxlVGFza0ZpZWxkcyh7XHJcbiAgdGFzayxcclxuICBjb3Vyc2UsXHJcbiAgd3JpdGVBY2Nlc3MsXHJcbiAgZmVhdHVyZXMsXHJcbiAgZWRpdFRhc2tcclxufTogUHJvcHMpIHtcclxuICBjb25zdCBzaG93R29vZ2xlUGlja2VyID0gZmVhdHVyZXMucGlja2VyO1xyXG4gIHJldHVybiA8ZGl2PlxyXG4gICAgPGgyPlVwcGdpZnRlbnMgbmFtbiBvY2ggbMOkbms8L2gyPlxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgIDxwPlVwcGdpZnRlbnMgbmFtbjo8L3A+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgIDxpbnB1dCBhdXRvRm9jdXMgdHlwZT1cInRleHRcIiBzaXplPXszNX0gdmFsdWU9e3Rhc2submFtZX0gZGlzYWJsZWQ9eyF3cml0ZUFjY2Vzc30gcmVhZE9ubHk9eyF3cml0ZUFjY2Vzc30gb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcclxuICAgICAgICAgIG5ld1Rhc2submFtZSA9IGV2LnRhcmdldC52YWx1ZTtcclxuICAgICAgICAgIGVkaXRUYXNrLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiBuZXdUYXNrIH0pO1xyXG4gICAgICAgIH0gfSAvPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgIDxwPlVSTDo8L3A+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgIDxpbnB1dCBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiIHR5cGU9XCJ0ZXh0XCIgc2l6ZT17MzV9IHZhbHVlPXt0YXNrLnVybH0gZGlzYWJsZWQ9eyF3cml0ZUFjY2Vzc30gcmVhZE9ubHk9eyF3cml0ZUFjY2Vzc30gb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcclxuICAgICAgICAgIG5ld1Rhc2sudXJsID0gZXYudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgZWRpdFRhc2suc2V0U3RhdGVQcm9taXNlZCh7IHRhc2s6IG5ld1Rhc2sgfSk7XHJcbiAgICAgICAgfSB9IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgIHtzaG93R29vZ2xlUGlja2VyICYmIDxEcml2ZUJ1dHRvbiBsYWJlbD1cIlwiIGFjdGlvbj17KCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBwaWNrZXIgPSBuZXcgR29vZ2xlUGlja2VyKHsgdXBsb2FkOiB0cnVlIH0pO1xyXG5cclxuICAgICAgICAgICAgcGlja2VyLnNob3coKS50aGVuKGZpbGVzID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBmaWxldXJsID0gZmlsZXNbMF0udXJsO1xyXG4gICAgICAgICAgICAgIGNvbnN0IHZpZXd1cmwgPSBmaWxldXJsLnN1YnN0cigwLCBmaWxldXJsLmxhc3RJbmRleE9mKCcvJykpICsgXCIvdmlld1wiXHJcbiAgICAgICAgICAgICAgaWYgKHZpZXd1cmwgPT0gdGFzay51cmwpIHJldHVybjtcclxuICAgICAgICAgICAgICBjb25zdCBuZXdUYXNrID0geyAuLi50YXNrIH07XHJcbiAgICAgICAgICAgICAgbmV3VGFzay51cmwgPSB2aWV3dXJsO1xyXG4gICAgICAgICAgICAgIGVkaXRUYXNrLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiBuZXdUYXNrIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgICB7dGFzay5taWdyYXRlZFRleHRzICYmIHdyaXRlQWNjZXNzICYmIDxUYXNrTWlncmF0aW9uQm94IHRhc2s9e3Rhc2t9IGNvdXJzZT17Y291cnNlfSB1cGRhdGVMaW5rPXsoaWQsIGxpbmtPclVubGluaykgPT4gZWRpdFRhc2sudXBkYXRlTGluayhpZCwgbGlua09yVW5saW5rKX0gLz59XHJcbiAgICA8PjxoMj5JbmzDpG1uaW5nc3VwcGdpZnQ8L2gyPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArIChlZGl0VGFzay5nZXRUYXNrUHJvcChcImFzc2lnbm1lbnRcIikgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX0gb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgICBlZGl0VGFzay51cGRhdGVUYXNrT3JDdXN0b21pemF0aW9uKFwiYXNzaWdubWVudFwiLCB7ICRzZXQ6ICFlZGl0VGFzay5nZXRUYXNrUHJvcChcImFzc2lnbm1lbnRcIikgfSk7XHJcbiAgICAgICAgICB9IH0gLz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgPHA+RGVuIGjDpHIgdXBwZ2lmdGVuIMOkciBlbiBpbmzDpG1uaW5nc3VwcGdpZnQ8L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICB7ZWRpdFRhc2suZ2V0VGFza1Byb3AoXCJhc3NpZ25tZW50XCIpICYmIDw+XHJcbiAgICAgICAgPHA+SW5sw6RtbmluZ3NkYXR1bTwvcD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgIDxSZWFjdERhdGVQaWNrZXIgbmV4dE1vbnRoQnV0dG9uTGFiZWw9XCJcIiBwcmV2aW91c01vbnRoQnV0dG9uTGFiZWw9XCJcIiBzaG93V2Vla051bWJlcnM9e3RydWV9IHNlbGVjdGVkPXtlZGl0VGFzay5nZXRUYXNrUHJvcChcImRlYWRsaW5lXCIpICYmIG1vbWVudChlZGl0VGFzay5nZXRUYXNrUHJvcChcImRlYWRsaW5lXCIpKS50b0RhdGUoKX0gZGF0ZUZvcm1hdD1cIllZWVktTU0tZGRcIiBsb2NhbGU9e1wic3ZcIn0gcG9wcGVyUGxhY2VtZW50PVwiYm90dG9tLXN0YXJ0XCIgb25DaGFuZ2U9e3ZhbHVlID0+IHtcclxuICAgICAgICAgICAgICBlZGl0VGFzay51cGRhdGVUYXNrT3JDdXN0b21pemF0aW9uKFwiZGVhZGxpbmVcIiwgeyAkc2V0OiBtb21lbnQodmFsdWUpLmZvcm1hdChcIllZWVktTU0tRERcIikgfSk7XHJcbiAgICAgICAgICAgIH0gfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICB7ZWRpdFRhc2suZ2V0VGFza1Byb3AoXCJkZWFkbGluZVwiKSAmJiA8YSBjbGFzc05hbWU9XCJkZWxldGVEYXRlXCIgaHJlZj1cIiNcIiB0aXRsZT1cIlRhIGJvcnQgaW5sw6RtbmluZ3NkYXR1bVwiIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgIGVkaXRUYXNrLnVwZGF0ZVRhc2tPckN1c3RvbWl6YXRpb24oXCJkZWFkbGluZVwiLCB7ICRzZXQ6IG51bGwgfSk7XHJcbiAgICAgICAgICAgIH0gfT48L2E+fVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKCh0YXNrLnNlbmRUb1Vya3VuZCA9PSBudWxsID8gdHJ1ZSA6IHRhc2suc2VuZFRvVXJrdW5kKSA/IFwiIGNoZWNrZWRcIiA6IFwiXCIpfSBvbkNsaWNrPXsoKSA9PlxyXG4gICAgICAgICAgICAgICAgZWRpdFRhc2sudXBkYXRlVGFza09yQ3VzdG9taXphdGlvbihcInNlbmRUb1Vya3VuZFwiLCB7ICRzZXQ6IHRhc2suc2VuZFRvVXJrdW5kID09IG51bGwgPyBmYWxzZSA6ICF0YXNrLnNlbmRUb1Vya3VuZCB9KX0+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxwPlZlcmlmeSBhc3NpZ25tZW50cyB3aXRoIFVya3VuZDwvcD5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC8+fVxyXG4gICAgPC8+XHJcbiAgPC9kaXY+O1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgQWJpbGl0eSwgVGFzaywgRG9jdW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IEtub3dsZWRnZU1hdHJpeCB9IGZyb20gJy4uLy4uL3N1Yi1jb21wb25lbnRzL2tub3dsZWRnZS1tYXRyaXgnO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyBEaWFsb2csIElDb3Vyc2VFZGl0b3JIb3N0IH0gZnJvbSBcIi4uLy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0XCI7XHJcbmltcG9ydCB7IGhhc1dyaXRlQWNjZXNzIH0gZnJvbSAnLi4vLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5pbXBvcnQgeyBTZWxlY3RSZWxhdGVkRG9jcyB9IGZyb20gJy4uLy4uL3N1Yi1jb21wb25lbnRzL3NlbGVjdC1yZWxhdGVkLWRvY3MnO1xyXG5pbXBvcnQgdmFsaWRVcmwgZnJvbSAndmFsaWQtdXJsJztcclxuaW1wb3J0IHsgTCwgc2hvd0Vycm9yIH0gZnJvbSBcIi4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcbmltcG9ydCB7IENhY2hlZFJlc3BvbnNlIH0gZnJvbSBcIi4uLy4uLy4uLy4uL3V0aWxzL2NhY2hlZC1yZXNwb25zZVwiO1xyXG5pbXBvcnQgeyBFZGl0YWJsZVJlc291cmNlTGlzdCB9IGZyb20gXCIuLi8uLi9zdWItY29tcG9uZW50cy9lZGl0YWJsZS1yZXNvdXJjZS1saXN0XCI7XHJcbmltcG9ydCB7IGR0Rm9ybWF0LCBzaG9ydERhdGVGb3JtYXQsIHNob3J0UGVyc29uTmFtZUZvcm1hdCB9IGZyb20gXCIuLi8uLi91dGlsc1wiO1xyXG5pbXBvcnQgeyBmdXR1cmVBYmlsaXRpZXMgfSBmcm9tIFwiLi4vLi4vLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uLy4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcclxuaW1wb3J0IHsgV3lzaXd5ZyB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnJztcclxuaW1wb3J0IGFjdGlvbnNfc3dlZGlzaCBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9hY3Rpb25zLXN2JztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBGZWF0dXJlcyB9IGZyb20gJy4uLy4uLy4uLy4uL2ZlYXR1cmVzJztcclxuaW1wb3J0IHsgU2VhcmNoUmVzdWx0cyB9IGZyb20gJy4vc2VhcmNoLXJlc3VsdHMnO1xyXG5pbXBvcnQgeyBCYXNpY0VkaXRhYmxlVGFza0ZpZWxkcyB9IGZyb20gJy4vYmFzaWMtZWRpdGFibGUtdGFzay1maWVsZHMnO1xyXG5pbXBvcnQgeyBUYXNrU3RhdHVzRnJhZ21lbnQgfSBmcm9tICcuL3Rhc2stc3RhdHVzLWZyYWdtZW50JztcclxuaW1wb3J0IHsgU2F2ZU9yQ2FuY2VsQnV0dG9ucyB9IGZyb20gJy4vc2F2ZS1vci1jYW5jZWwtYnV0dG9ucyc7XHJcbmltcG9ydCB7IFByZXZpZXdhYmxlVGFza0ZpZWxkcyB9IGZyb20gJy4vcHJldmlld2FibGUtdGFzay1maWVsZHMnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBzZWFyY2hNb2RlPzogYm9vbGVhbjtcclxuICB0YXNrPzogVGFzaztcclxuICB0YXNrQ3VzdG9taXphdGlvbj86IFBhcnRpYWw8VGFzaz47XHJcbiAgbW9kdWxlOiBDb3Vyc2VNb2R1bGU7XHJcbiAgY291cnNlOiBDb3Vyc2U7XHJcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3Q7XHJcbiAgaWRzTm90Q292ZXJlZEJ5QW55VGFzazogeyBbaWQ6IHN0cmluZ106IHRydWUgfTtcclxuICBvblNhdmU6ICh0YXNrOiBUYXNrLCB0YXNrQ3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPikgPT4gUHJvbWlzZTxhbnk+O1xyXG4gIG9uU2F2ZUN1c3RvbWl6YXRpb246ICh0YXNrQ3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPikgPT4gUHJvbWlzZTxhbnk+O1xyXG4gIG9uUmVwbGFjZTogKHRhc2tJZDogc3RyaW5nLCB0YXNrOiBUYXNrKSA9PiBQcm9taXNlPGFueT47XHJcbiAgb25DYW5jZWw6ICgpID0+IHZvaWQ7XHJcbiAgb25EZWxldGU6ICgpID0+IHZvaWQ7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgdGl0bGU6IHN0cmluZztcclxuICB0YXNrOiBUYXNrO1xyXG4gIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+XHJcbiAgZnV0dXJlQWJpbGl0aWVzT3BlbjogYm9vbGVhbjtcclxuICBzZWFyY2hSZXN1bHQ/OiBUYXNrW107XHJcbiAgc2VhcmNoTWFya2VkSWRzPzogc3RyaW5nW107XHJcbiAgaXNTZWFyY2hpbmc6IGJvb2xlYW47XHJcbiAgcHJldmlld1Rhc2tDb250ZW50Pzogc3RyaW5nOyAvLyBUT0RPOiBSZW1vdmUgdGhpcyBzdGF0ZS4gUHJldmlld2luZyBjb250ZW50IGlzIG5vdyBlcXVpdmFsZW50IHRvIGNoZWNraW5nIGEgY2hlY2tib3guXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFZGl0VGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IGltcGxlbWVudHMgRGlhbG9nIHtcclxuICBzZWFyY2hSZXNwb25zZT86IENhY2hlZFJlc3BvbnNlPFRhc2tbXT47XHJcbiAgZGlhbG9nRWxlbTogSFRNTERpdkVsZW1lbnQ7XHJcbiAgZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcclxuXHJcbiAgc2V0U3RhdGVQcm9taXNlZChzdGF0ZTogUGFydGlhbDxTdGF0ZT4pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHN1cGVyLnNldFN0YXRlKCgpID0+IHN0YXRlIGFzIFN0YXRlLCByZXNvbHZlKSk7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIGNvbnN0IHdyaXRlQWNjZXNzID0gIXByb3BzLnRhc2sgfHwgaGFzV3JpdGVBY2Nlc3MoZW52LmN1cnJlbnRVc2VyLCBwcm9wcy50YXNrKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHRpdGxlOiBwcm9wcy50YXNrID9cclxuICAgICAgICB3cml0ZUFjY2VzcyA/XHJcbiAgICAgICAgICBMYFJlZGlnZXJhIHVwcGdpZnQgdGlsbCBcIiR7cHJvcHMubW9kdWxlLm5hbWV9XCJgIDpcclxuICAgICAgICAgIExgVmlzYSB1cHBnaWZ0IHRpbGwgXCIke3Byb3BzLm1vZHVsZS5uYW1lfVwiYCA6XHJcbiAgICAgICAgcHJvcHMuc2VhcmNoTW9kZSA/XHJcbiAgICAgICAgICBMYFPDtmsgbnkgdXBwZ2lmdCB0aWxsIFwiJHtwcm9wcy5tb2R1bGUubmFtZX1cImAgOlxyXG4gICAgICAgICAgTGBMw6RnZyB0aWxsIGVnZW4gdXBwZ2lmdCB0aWxsIFwiJHtwcm9wcy5tb2R1bGUubmFtZX1cImAsXHJcbiAgICAgIGZ1dHVyZUFiaWxpdGllc09wZW46IGZhbHNlLFxyXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbjogcHJvcHMudGFza0N1c3RvbWl6YXRpb24gfHwge30sXHJcbiAgICAgIHRhc2s6IHByb3BzLnRhc2sgP1xyXG4gICAgICAgIC8vIEEgdGFzayB3YXMgZ2l2ZW4uIENsb25lIGl0IGFuZCBhZGQgJG1ldGE6ICd1cGRhdGUnIHRvIGl0XHJcbiAgICAgICAgLy8gdG8gaW5mb3JtIEVkaXRDb3Vyc2Uuc2F2ZSgpIHRvIHVwZGF0ZSBpdCBvbiBpdHMgb3duIGVudGl0eS5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAkbWV0YTogcHJvcHMudGFzay4kbWV0YSB8fCAndXBkYXRlJyxcclxuICAgICAgICAgIC4uLnByb3BzLnRhc2tcclxuICAgICAgICB9IDogcHJvcHMuc2VhcmNoTW9kZSA/IG51bGwgOlxyXG4gICAgICAgICAgLy8gTm8gdGFzayB3YXMgZ2l2ZW4uIFNldCAkbWV0YSA9ICdhZGQnIHRvIGluZm9ybSBFZGl0Q291cnNlLnNhdmUoKVxyXG4gICAgICAgICAgLy8gdG8gYWRkIHRoZSB0YXNrIHRvIHRoZSB0YXNrcyB0YWJsZS5cclxuICAgICAgICAgIHtcclxuICAgICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICAgICAgJG1ldGE6ICdhZGQnLFxyXG4gICAgICAgICAgICB0YWdzOiBbXHJcbiAgICAgICAgICAgICAgYHN1Yjoke3Byb3BzLmNvdXJzZS5zdWJqZWN0Q29kZX1gLFxyXG4gICAgICAgICAgICAgIGBjb3Vyc2U6JHtwcm9wcy5jb3Vyc2UuY29kZX1gXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHNjaG9vbDogIXByb3BzLmNvdXJzZS5pc1RlbXBsYXRlICYmIGVudi5jdXJyZW50VXNlci5zY2hvb2wsXHJcbiAgICAgICAgICAgIHJlc291cmNlczogW10sXHJcbiAgICAgICAgICAgIGFiaWxpdGllczogW10sXHJcbiAgICAgICAgICAgIGNlbnRyYWxDb250ZW50OiBbXSxcclxuICAgICAgICAgICAgZnV0dXJlQWJpbGl0aWVzOiBbXSxcclxuICAgICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiBbXSxcclxuICAgICAgICAgICAgbmFtZTogXCJcIixcclxuICAgICAgICAgICAgdXJsOiBcIlwiLFxyXG4gICAgICAgICAgICBhY2w6IHByb3BzLmNvdXJzZS5pc1RlbXBsYXRlID8gW1xyXG4gICAgICAgICAgICAgIGByb2xlOlVTRVI6UmAvLyAoT0sgdG8ga2VlcCBhZnRlciBrdXJzYnlnZy1jaGFuZ2VzKS4gVGVtcGxhdGVzICh3aGljaCB3aWxsIGJlIGVtcHR5ISkgd2lsbCBub3QgaGF2ZSB0YXNrcy4gSWYgdGhleSBoYWQsIG1pZ2h0IG5vdCB0YXNrcyBzaG91bGQgbm90IGJlIHBvc3NpYmxlIHRvIG1vZGlmeS4gKEFuIEFETUlOIGNvdWxkIGJlbG9uZyB0byBhIHNjaG9vbCEgT3RoZXIgbm9uLWFkbWlucyBhdCB0aGF0IHNjaG9vbCBzaG91bGQgbm90IGJlIGFibGUgdG8gZWRpdCBpdClcclxuICAgICAgICAgICAgXSA6IFtcclxuICAgICAgICAgICAgICAgIGByb2xlOlVTRVI6UmAsXHJcbiAgICAgICAgICAgICAgICBgc2Nob29sUm9sZToke2Vudi5jdXJyZW50VXNlci5zY2hvb2x9L0VNUExPWUVFOlNgXHJcbiAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfSxcclxuICAgICAgc2VhcmNoTWFya2VkSWRzOiBwcm9wcy5zZWFyY2hNb2RlICYmIFtdLFxyXG4gICAgICBzZWFyY2hSZXN1bHQ6IHByb3BzLnNlYXJjaE1vZGUgJiYgW10sXHJcbiAgICAgIGlzU2VhcmNoaW5nOiBwcm9wcy5zZWFyY2hNb2RlXHJcbiAgICB9O1xyXG4gICAgaWYgKHByb3BzLnNlYXJjaE1vZGUpIHtcclxuICAgICAgdGhpcy5zZWFyY2hSZXNwb25zZSA9IG5ldyBDYWNoZWRSZXNwb25zZSgoKSA9PlxyXG4gICAgICAgIGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8VGFzaz4oXCJ0YXNrc1wiLCB7XHJcbiAgICAgICAgICB0YWdzOiBgY291cnNlOiR7cHJvcHMuY291cnNlLmNvZGV9YCxcclxuICAgICAgICAgIGluY2x1ZGU6IFsna25vd2xlZGdlUmVxdWlyZW1lbnRzJywgJ2FiaWxpdGllcycsICdjZW50cmFsQ29udGVudCddLFxyXG4gICAgICAgICAgZmxhZ3M6IFsnaW5jbHVkZUlkc09ubHknXVxyXG4gICAgICAgIH0pKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgaWYgKHRoaXMucHJvcHMuc2VhcmNoTW9kZSkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoeyBpc1NlYXJjaGluZzogdHJ1ZSB9KTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCB0aGlzLnNlYXJjaFJlc3BvbnNlLnF1ZXJ5KCk7XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuc2VhcmNoTWFya2VkSWRzICYmIHRoaXMuc3RhdGUuc2VhcmNoTWFya2VkSWRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZWFyY2hSZXN1bHQodGhpcy5zdGF0ZS5zZWFyY2hNYXJrZWRJZHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgc2hvd0Vycm9yKGVycik7XHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKHsgaXNTZWFyY2hpbmc6IGZhbHNlIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyB1cGRhdGVTZWFyY2hNYXJrZWRJZHMoc2VhcmNoTWFya2VkSWRzOiBzdHJpbmdbXSkge1xyXG4gICAgY29uc3Qgc2V0U3RhdGVQcm9taXNlID0gdGhpcy5zZXRTdGF0ZVByb21pc2VkKHsgdGFzazogbnVsbCwgc2VhcmNoTWFya2VkSWRzLCBwcmV2aWV3VGFza0NvbnRlbnQ6IG51bGwgfSk7XHJcbiAgICBpZiAoIXRoaXMuc2VhcmNoUmVzcG9uc2UucmVzdWx0KSB7XHJcbiAgICAgIGF3YWl0IHRoaXMuc2VhcmNoUmVzcG9uc2UucHJvbWlzZTtcclxuICAgICAgLy8gUmVmcmVzaCBzZWFyY2hNYXJrZWRJZHMgbm93IGFzIHVzZXIgbWlnaHQgaGF2ZSBjbGlja2VkIGFyb3VuZCB3aGlsZSB3YWl0aW5nIGZvclxyXG4gICAgICAvLyB0YXNrcyB0byBsb2FkLi4uXHJcbiAgICAgIGF3YWl0IHNldFN0YXRlUHJvbWlzZTsgLy8gU28gd2Uga25vdyBzdGF0ZSBoYXMgYmVlbiByZWZsZWN0ZWQuLi5cclxuICAgICAgc2VhcmNoTWFya2VkSWRzID0gdGhpcy5zdGF0ZS5zZWFyY2hNYXJrZWRJZHM7XHJcbiAgICB9XHJcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZVNlYXJjaFJlc3VsdChzZWFyY2hNYXJrZWRJZHMpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlU2VhcmNoUmVzdWx0KHNlYXJjaE1hcmtlZElkczogc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IGFsbFRhc2tzRm9yU3ViamVjdCA9IGF3YWl0IHRoaXMuc2VhcmNoUmVzcG9uc2UucXVlcnkoKTtcclxuXHJcbiAgICBjb25zdCBzZWFyY2hSZXN1bHQgPSBhbGxUYXNrc0ZvclN1YmplY3QuZmlsdGVyKHQgPT5cclxuICAgICAgc2VhcmNoTWFya2VkSWRzLmV2ZXJ5KGlkID0+XHJcbiAgICAgICAgdC5rbm93bGVkZ2VSZXF1aXJlbWVudHMuc29tZShrciA9PiBrci5pZCA9PT0gaWQpIHx8XHJcbiAgICAgICAgdC5hYmlsaXRpZXMuc29tZShhID0+IGEuaWQgPT09IGlkKSB8fFxyXG4gICAgICAgIHQuY2VudHJhbENvbnRlbnQuc29tZShjID0+IGMuaWQgPT09IGlkKSkpO1xyXG5cclxuICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7XHJcbiAgICAgIHNlYXJjaFJlc3VsdFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvbk1hcmtDaGFuZ2VkKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCB7IHNlYXJjaE1vZGUgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBpZiAoc2VhcmNoTW9kZSkge1xyXG4gICAgICBjb25zdCB7IHNlYXJjaE1hcmtlZElkcyB9ID0gdGhpcy5zdGF0ZTtcclxuICAgICAgdGhpcy51cGRhdGVTZWFyY2hNYXJrZWRJZHMoaXNNYXJrZWQgP1xyXG4gICAgICAgIHNlYXJjaE1hcmtlZElkcy5jb25jYXQoaWQpIDpcclxuICAgICAgICBzZWFyY2hNYXJrZWRJZHMuZmlsdGVyKHggPT4geCAhPT0gaWQpKS5jYXRjaChzaG93RXJyb3IpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnVwZGF0ZUxpbmsoaWQsIGlzTWFya2VkKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpbmsoaWQ6IHN0cmluZywgbGlua09yVW5saW5rOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHsgdGFzayB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIC8vIE9uZSBvZiB0aGUgZm9sbG93aW5nIHRocmVlIHdpbGwgYmUgZm91bmQ6XHJcbiAgICBjb25zdCBhYmlsaXR5ID0gY291cnNlLmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpO1xyXG4gICAgY29uc3Qga25vd2xlZGdlUmVxdWlyZW1lbnQgPSBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZpbmQociA9PiByLmlkID09PSBpZCk7XHJcbiAgICBjb25zdCBjZW50cmFsQ29udGVudCA9IGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09PSBpZCk7XHJcblxyXG4gICAgY29uc3QgW2NvbGxlY3Rpb25Qcm9wLCBpdGVtXSA9XHJcbiAgICAgIGFiaWxpdHkgP1xyXG4gICAgICAgIFtcImFiaWxpdGllc1wiLCBhYmlsaXR5XSA6XHJcbiAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnQgP1xyXG4gICAgICAgICAgW1wia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsIGtub3dsZWRnZVJlcXVpcmVtZW50XSA6XHJcbiAgICAgICAgICBjZW50cmFsQ29udGVudCA/XHJcbiAgICAgICAgICAgIFtcImNlbnRyYWxDb250ZW50XCIsIGNlbnRyYWxDb250ZW50XSA6XHJcbiAgICAgICAgICAgIFtudWxsLCBudWxsXTtcclxuXHJcbiAgICBpZiAoIWNvbGxlY3Rpb25Qcm9wKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZmluZCBtYXJrZWQgaWQgXCIgKyBpZCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB1cGRhdGVkQ29sbGVjdGlvbjogRG9jdW1lbnRbXSA9IHRhc2tbY29sbGVjdGlvblByb3BdLnNsaWNlKCk7XHJcbiAgICBjb25zdCBjdXJyZW50UG9zID0gdXBkYXRlZENvbGxlY3Rpb24uZmluZEluZGV4KGRvYyA9PiBkb2MuaWQgPT09IGlkKTtcclxuICAgIGlmIChsaW5rT3JVbmxpbmspIHtcclxuICAgICAgaWYgKGN1cnJlbnRQb3MgPCAwKSB7XHJcbiAgICAgICAgdXBkYXRlZENvbGxlY3Rpb24ucHVzaChpdGVtKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGN1cnJlbnRQb3MgPj0gMCkge1xyXG4gICAgICAgIHVwZGF0ZWRDb2xsZWN0aW9uLnNwbGljZShjdXJyZW50UG9zLCAxKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHVwZGF0ZWRUYXNrID0geyAuLi50YXNrIH07XHJcbiAgICB1cGRhdGVkVGFza1tjb2xsZWN0aW9uUHJvcF0gPSB1cGRhdGVkQ29sbGVjdGlvbjtcclxuXHJcbiAgICAvLyBDbGVhciBtaWdyYXRlZFRleHRzIGZyb20gdGFzay5cclxuICAgIC8vIEZpcnN0IGRlZXAgY2xvbmU6XHJcbiAgICBpZiAodGFzayAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMpIHtcclxuICAgICAgdXBkYXRlZFRhc2subWlncmF0ZWRUZXh0cyA9IHsuLi50YXNrLm1pZ3JhdGVkVGV4dHN9O1xyXG4gICAgICBpZiAodGFzay5taWdyYXRlZFRleHRzW2NvbGxlY3Rpb25Qcm9wXSkge1xyXG4gICAgICAgIHVwZGF0ZWRUYXNrLm1pZ3JhdGVkVGV4dHNbY29sbGVjdGlvblByb3BdID0gey4uLnRhc2subWlncmF0ZWRUZXh0c1tjb2xsZWN0aW9uUHJvcF19O1xyXG4gICAgICAgIC8vIERlbGV0ZSB0aGUgaWQgd2l0aGluIHRoZSBkZWVwIGNsb25lOlxyXG4gICAgICAgIGRlbGV0ZSB1cGRhdGVkVGFzay5taWdyYXRlZFRleHRzW2NvbGxlY3Rpb25Qcm9wXVtpZF07XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoe1xyXG4gICAgICB0YXNrOiB1cGRhdGVkVGFza1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlKCkge1xyXG4gICAgY29uc3QgeyB0YXNrLCB0YXNrQ3VzdG9taXphdGlvbiB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHdyaXRlQWNjZXNzID0gaGFzV3JpdGVBY2Nlc3MoZW52LmN1cnJlbnRVc2VyLCB0YXNrKTtcclxuICAgIGlmICh3cml0ZUFjY2Vzcykge1xyXG4gICAgICBpZiAoIXRhc2sudXJsICYmICF0YXNrLmNvbnRlbnQpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKExgVXBwZ2lmdGVuIG3DpXN0ZSBhbnRpbmdlbiBoYSBlbiBVUkwgZWxsZXIgZXR0IGlubmVow6VsbGApO1xyXG4gICAgICBpZiAodGFzay51cmwgJiYgIXZhbGlkVXJsLmlzVXJpKHRhc2sudXJsKSlcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTGBBbmdpdmVuIFVSTCAnJHt0YXNrLnVybH0nIMOkciBvZ2lsdGlnLiBEZW4gc2thIGLDtnJqYSBtZWQgaHR0cDogZWxsZXIgaHR0cHM6YCk7XHJcbiAgICAgIGlmICh0aGlzLnByb3BzLnRhc2sgJiYgdGhpcy5wcm9wcy50YXNrLmlkICE9PSB0YXNrLmlkKSB7XHJcbiAgICAgICAgLy8gUmVwbGFjZSBleGlzdGluZyB0YXNrIHdpdGggY29weVxyXG4gICAgICAgIGF3YWl0IHRoaXMucHJvcHMub25SZXBsYWNlKHRoaXMucHJvcHMudGFzay5pZCwgdGFzayk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIHRhc2tcclxuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLm9uU2F2ZSh0YXNrLCBudWxsKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnNlYXJjaE1vZGUpIHtcclxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5vblNhdmUodGFzaywgdGFza0N1c3RvbWl6YXRpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHRoaXMucHJvcHMuY291cnNlLmlzVGVtcGxhdGUgJiYgdGFzay4kbWV0YSA9PT0gJ2FkZCcpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKExgRHUgc2FrbmFyIGJlaMO2cmlnaGV0IGbDtnIgYXR0IHNwYXJhIG55YSB2ZXJzaW9uZXIgYXYgdXBwZ2lmdGVyIGkga3Vyc21hbGxlbmApO1xyXG5cclxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5vblNhdmVDdXN0b21pemF0aW9uKHRhc2tDdXN0b21pemF0aW9uKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIGNvcHlUYXNrKCkge1xyXG4gICAgY29uc3QgdGFza0NvcHkgPSB7XHJcbiAgICAgIC4uLnRoaXMuc3RhdGUudGFzayxcclxuICAgICAgLi4uKHRoaXMuc3RhdGUudGFza0N1c3RvbWl6YXRpb24gfHwge30pLFxyXG4gICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICBhY2w6IHRoaXMucHJvcHMuY291cnNlLmlzVGVtcGxhdGUgPyBbXHJcbiAgICAgICAgYHJvbGU6VVNFUjpSYCAvLyAoT0sgdG8ga2VlcCBidXQgdGhpcyBjaGVjayBtaWdodCBiZWNvbWUgdW5uZXNjZXNhcnkgaWYgd2UgdG90YWxseSByZW1vdmUgdGhlIHBvc3NpYmlsaXR5IHRvIGVkaXQgdGVtcGxhdGVzKSBUZW1wbGF0ZSB0YXNrcyBzaG91bGQgbm90IGJlIHBvc3NpYmxlIHRvIG1vZGlmeS4gKEFuIEFETUlOIGNvdWxkIGJlbG9uZyB0byBhIHNjaG9vbCEgT3RoZXIgbm9uLWFkbWlucyBhdCB0aGF0IHNjaG9vbCBzaG91bGQgbm90IGJlIGFibGUgdG8gZWRpdCBpdClcclxuICAgICAgXSA6IFtcclxuICAgICAgICBgcm9sZTpVU0VSOlJgLFxyXG4gICAgICAgIGBzY2hvb2xSb2xlOiR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUU6U2BcclxuICAgICAgXSxcclxuICAgICAgc2Nob29sOiB0aGlzLnByb3BzLmNvdXJzZS5zY2hvb2xcclxuICAgIH07XHJcbiAgICB0YXNrQ29weS4kbWV0YSA9ICdhZGQnO1xyXG5cclxuICAgIGF3YWl0IHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7XHJcbiAgICAgIHRhc2s6IHRhc2tDb3B5LFxyXG4gICAgICB0aXRsZTogTGBSZWRpZ2VyYSBrb3BpZXJhZCB1cHBnaWZ0IHRpbGwgXCIke3RoaXMucHJvcHMubW9kdWxlLm5hbWV9XCJgLFxyXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbjogdW5kZWZpbmVkXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFRhc2tQcm9wPFQgZXh0ZW5kcyBrZXlvZiBUYXNrPih0YXNrUHJvcDogVCkgOiBUYXNrW1RdIHtcclxuICAgIGNvbnN0IHt0YXNrLCB0YXNrQ3VzdG9taXphdGlvbn0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgY3VzdG9taXphdGlvbiA9IHRhc2tDdXN0b21pemF0aW9uICYmIHRhc2tDdXN0b21pemF0aW9uW3Rhc2tQcm9wXTtcclxuICAgIHJldHVybiBjdXN0b21pemF0aW9uICE9PSB1bmRlZmluZWQgP1xyXG4gICAgICBjdXN0b21pemF0aW9uIDpcclxuICAgICAgdGFza1t0YXNrUHJvcF07XHJcbiAgfVxyXG5cclxuICB1cGRhdGVUYXNrT3JDdXN0b21pemF0aW9uICh0YXNrUHJvcDoga2V5b2YgVGFzaywgdXBkYXRlcykge1xyXG4gICAgY29uc3Qge3Rhc2ssIHRhc2tDdXN0b21pemF0aW9ufSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCB3cml0ZUFjY2VzcyA9IHRhc2sgJiYgaGFzV3JpdGVBY2Nlc3MoZW52LmN1cnJlbnRVc2VyLCB0YXNrKTtcclxuICAgIGlmICh3cml0ZUFjY2VzcyAmJiAoIXRhc2tDdXN0b21pemF0aW9uIHx8IHRhc2tDdXN0b21pemF0aW9uW3Rhc2tQcm9wXSA9PT0gdW5kZWZpbmVkKSkge1xyXG4gICAgICBjb25zdCBuZXdUYXNrID0gey4uLnRhc2t9O1xyXG4gICAgICBuZXdUYXNrW3Rhc2tQcm9wXSA9IHVwZGF0ZSh0YXNrW3Rhc2tQcm9wXSwgdXBkYXRlcyk7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7dGFzazogbmV3VGFza30pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc3QgbmV3Q3VzdG9taXphdGlvbiA9IHsuLi50YXNrQ3VzdG9taXphdGlvbn07XHJcbiAgICAgIG5ld0N1c3RvbWl6YXRpb25bdGFza1Byb3BdID0gdXBkYXRlIChcclxuICAgICAgICBuZXdDdXN0b21pemF0aW9uW3Rhc2tQcm9wXSB8fCB0YXNrW3Rhc2tQcm9wXSxcclxuICAgICAgICB1cGRhdGVzXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7dGFza0N1c3RvbWl6YXRpb246IG5ld0N1c3RvbWl6YXRpb259KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgY291cnNlLCBtb2R1bGUsIG9uQ2FuY2VsLCBvbkRlbGV0ZSwgaWRzTm90Q292ZXJlZEJ5QW55VGFzaywgc2VhcmNoTW9kZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHsgdGFzaywgdGFza0N1c3RvbWl6YXRpb24sIHRpdGxlLCBzZWFyY2hSZXN1bHQsIHNlYXJjaE1hcmtlZElkcywgaXNTZWFyY2hpbmcgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBtYXJrZWRJZHMgPSBzZWFyY2hNb2RlID9cclxuICAgICAgc2VhcmNoTWFya2VkSWRzIDpcclxuICAgICAgdGFzay5jZW50cmFsQ29udGVudC5tYXAoeCA9PiB4LmlkKVxyXG4gICAgICAgIC5jb25jYXQodGFzay5hYmlsaXRpZXMubWFwKHggPT4geC5pZCkpXHJcbiAgICAgICAgLmNvbmNhdCh0YXNrLmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoeCA9PiB4LmlkKSk7XHJcblxyXG4gICAgY29uc3Qgd3JpdGVBY2Nlc3MgPSB0YXNrICYmIGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgdGFzayk7XHJcbiAgICBjb25zdCB0YXNrVXJsVmFsaWQgPSB0YXNrICYmIHZhbGlkVXJsLmlzVXJpKHRhc2sudXJsKTtcclxuICAgIGNvbnN0IHtmZWF0dXJlc30gPSB0aGlzO1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LXNwYWNlci0yMHB4dnQgc3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZWNvbnRlbnQgc3YtbGF5b3V0IHN2LXNwYWNlci0yMHB4dnQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXRleHQtcG9ydGxldCBzdi11c2UtbWFyZ2lucyBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxyXG4gICAgICAgICAgICA8aDEgY2xhc3NOYW1lPVwiaDFcIj57dGl0bGV9PC9oMT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtZmx1aWQtZ3JpZCBzdi1ncmlkLWtzZ3MxMiBzdi1sYXlvdXRcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi02XCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiPlxyXG4gICAgICAgICAgICAgICAgPGgzPntzZWFyY2hNb2RlID9cclxuICAgICAgICAgICAgICAgICAgXCJGaWx0cmVyYSBww6Uga3Vuc2thcHNrcmF2XCIgOiB3cml0ZUFjY2VzcyA/XHJcbiAgICAgICAgICAgICAgICAgICAgXCJWw6RsaiBrdW5za2Fwc2tyYXZcIiA6XHJcbiAgICAgICAgICAgICAgICAgICAgXCJLdW5za2Fwc2tyYXZcIn08L2gzPlxyXG4gICAgICAgICAgICAgICAge3NlYXJjaE1vZGUgP1xyXG4gICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICBNYXJrZXJhIGRlIGt1bnNrYXBza3JhdiBzb20gdXBwZ2lmdGVuIG3DpXN0ZSB0w6Rja2EuXHJcbiAgICAgICAgICAgICAgICAgIDwvcD4gOiB3cml0ZUFjY2VzcyAmJlxyXG4gICAgICAgICAgICAgICAgICA8cD5cclxuICAgICAgICAgICAgICAgICAgICBNYXJrZXJhIGRlIGt1bnNrYXBza3JhdiBzb20gZGluIHVwcGdpZnQgdMOkY2tlci5cclxuICAgICAgICAgICAgICAgICAgPC9wPlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgPEtub3dsZWRnZU1hdHJpeFxyXG4gICAgICAgICAgICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM9e2NvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHN9XHJcbiAgICAgICAgICAgICAgICAgIG1hcmtlZElkcz17bWFya2VkSWRzfVxyXG4gICAgICAgICAgICAgICAgICBpZHNUb01hcmtOb3RPaz17aWRzTm90Q292ZXJlZEJ5QW55VGFza31cclxuICAgICAgICAgICAgICAgICAgbWFya01vZGU9e3NlYXJjaE1vZGUgfHwgd3JpdGVBY2Nlc3N9XHJcbiAgICAgICAgICAgICAgICAgIG1pZ3JhdGVkSWRzPXt0YXNrICYmIHRhc2subWlncmF0ZWRUZXh0cyAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMua25vd2xlZGdlUmVxdWlyZW1lbnRzfVxyXG4gICAgICAgICAgICAgICAgICBvbk1hcmtDaGFuZ2VkPXt0aGlzLm9uTWFya0NoYW5nZWQuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgICAgICAgIDxTZWxlY3RSZWxhdGVkRG9jc1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucz17Y291cnNlLmFiaWxpdGllc31cclxuICAgICAgICAgICAgICAgIHRpdGxlPXt3cml0ZUFjY2VzcyB8fCBzZWFyY2hNb2RlID8gXCJWw6RsaiBmw7ZybcOlZ29yXCIgOiBcIkbDtnJtw6Vnb3JcIn1cclxuICAgICAgICAgICAgICAgIG1hcmtlZElkcz17bWFya2VkSWRzfVxyXG4gICAgICAgICAgICAgICAgbWFya01vZGU9e3dyaXRlQWNjZXNzIHx8IHNlYXJjaE1vZGV9XHJcbiAgICAgICAgICAgICAgICBtaWdyYXRlZElkcz17dGFzayAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMgJiYgdGFzay5taWdyYXRlZFRleHRzLmFiaWxpdGllc31cclxuICAgICAgICAgICAgICAgIG9uTWFya0NoYW5nZWQ9e3RoaXMub25NYXJrQ2hhbmdlZC5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICAgICAgICA8U2VsZWN0UmVsYXRlZERvY3NcclxuICAgICAgICAgICAgICAgIG9wdGlvbnM9e2NvdXJzZS5jZW50cmFsQ29udGVudH1cclxuICAgICAgICAgICAgICAgIHRpdGxlPXt3cml0ZUFjY2VzcyB8fCBzZWFyY2hNb2RlID8gXCJWw6RsaiBjZW50cmFsdCBpbm5laMOlbGxcIiA6IFwiQ2VudHJhbHQgaW5uZWjDpWxsXCJ9XHJcbiAgICAgICAgICAgICAgICBtYXJrZWRJZHM9e21hcmtlZElkc31cclxuICAgICAgICAgICAgICAgIG1hcmtNb2RlPXt3cml0ZUFjY2VzcyB8fCBzZWFyY2hNb2RlfVxyXG4gICAgICAgICAgICAgICAgbWlncmF0ZWRJZHM9e3Rhc2sgJiYgdGFzay5taWdyYXRlZFRleHRzICYmIHRhc2subWlncmF0ZWRUZXh0cy5jZW50cmFsQ29udGVudH1cclxuICAgICAgICAgICAgICAgIG9uTWFya0NoYW5nZWQ9e3RoaXMub25NYXJrQ2hhbmdlZC5iaW5kKHRoaXMpfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgIHshc2VhcmNoTW9kZSAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+PGRpdiBjbGFzc05hbWU9e1wib3BlbkNsb3NlIGxhcmdlclwiICsgKHRoaXMuc3RhdGUuZnV0dXJlQWJpbGl0aWVzT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlUHJvbWlzZWQoeyBmdXR1cmVBYmlsaXRpZXNPcGVuOiAhdGhpcy5zdGF0ZS5mdXR1cmVBYmlsaXRpZXNPcGVuIH0pfT5cclxuICAgICAgICAgICAgICAgIHt3cml0ZUFjY2VzcyA/XHJcbiAgICAgICAgICAgICAgICAgIDxwPlbDpGxqIHl0dGVybGlnYXJlIGFsdGVybmF0aXY8L3A+IDpcclxuICAgICAgICAgICAgICAgICAgPHA+WXR0ZXJsaWdhcmUgYWx0ZXJuYXRpdjwvcD59XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuQ29udGVudFwiPlxyXG4gICAgICAgICAgICAgICAgPGg0PkZyYW10aWRzZsO2cm3DpWdvcjwvaDQ+XHJcblxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICAgICAgICAgIHtmdXR1cmVBYmlsaXRpZXMubWFwKGZhID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRhc2suZnV0dXJlQWJpbGl0aWVzLmluZGV4T2YoZmEpID49IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiIGtleT17ZmF9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKHNlbGVjdGVkID8gXCIgY2hlY2tlZFwiIDogXCJcIil9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17d3JpdGVBY2Nlc3MgPyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHsgLi4udGFzayB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZFRhc2suZnV0dXJlQWJpbGl0aWVzID1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suZnV0dXJlQWJpbGl0aWVzLmZpbHRlcihhID0+IGEgIT0gZmEpIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXNrLmZ1dHVyZUFiaWxpdGllcy5jb25jYXQoZmEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZVByb21pc2VkKHsgdGFzazogdXBkYXRlZFRhc2sgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHVuZGVmaW5lZH0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj57ZmF9XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgfSl9XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICAgIDwvZGl2PjwvZGl2Pn1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3YtY29sdW1uLTZcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICAgIHtpc1NlYXJjaGluZyAmJiA8cD48U3Bpbm5lciAvPiBMYWRkYXIgdXBwZ2lmdGVyLi4uPC9wPn1cclxuICAgICAgICAgICAgICB7c2VhcmNoUmVzdWx0ID8gXHJcbiAgICAgICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAqIFNlYXJjaCBSZXN1bHRzIEZyYWdlbnRcclxuICAgICAgICAgICAgICAgICAgKiBcclxuICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgICAgICA8U2VhcmNoUmVzdWx0c1xyXG4gICAgICAgICAgICAgICAgICBzZWFyY2hNYXJrZWRJZHM9e3NlYXJjaE1hcmtlZElkc31cclxuICAgICAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0PXtzZWFyY2hSZXN1bHR9XHJcbiAgICAgICAgICAgICAgICAgIHRhc2s9e3Rhc2t9XHJcbiAgICAgICAgICAgICAgICAgIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc31cclxuICAgICAgICAgICAgICAgICAgdGFza0N1c3RvbWl6YXRpb249e3Rhc2tDdXN0b21pemF0aW9ufVxyXG4gICAgICAgICAgICAgICAgICBlZGl0VGFzaz17dGhpc30gLz5cclxuXHJcbiAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnQgPyBcclxuICAgICAgICAgICAgICAgICAgPGRpdiBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogdGhpcy5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnR9fSAvPlxyXG4gICAgICAgICAgICAgICAgOiB0YXNrICYmIDxQcmV2aWV3YWJsZVRhc2tGaWVsZHNcclxuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxyXG4gICAgICAgICAgICAgICAgICB0YXNrPXt0YXNrfVxyXG4gICAgICAgICAgICAgICAgICB0YXNrQ3VzdG9taXphdGlvbj17dGFza0N1c3RvbWl6YXRpb259XHJcbiAgICAgICAgICAgICAgICAgIGVkaXRUYXNrPXt0aGlzfSAvPn1cclxuXHJcbiAgICAgICAgICAgICAgICB7dGFzayAmJiA8VGFza1N0YXR1c0ZyYWdtZW50IHRhc2s9e3Rhc2t9IC8+fVxyXG4gICAgICAgICAgICAgIDwvPiA6IFxyXG5cclxuICAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICogRWRpdCBUYXNrcyBGcmFnbWVudFxyXG4gICAgICAgICAgICAgICAgICAqIFxyXG4gICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgPD5cclxuICAgICAgICAgICAgICAgIHt0YXNrICYmIDxCYXNpY0VkaXRhYmxlVGFza0ZpZWxkc1xyXG4gICAgICAgICAgICAgICAgICB0YXNrPXt0YXNrfVxyXG4gICAgICAgICAgICAgICAgICBjb3Vyc2U9e2NvdXJzZX1cclxuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxyXG4gICAgICAgICAgICAgICAgICBmZWF0dXJlcz17ZmVhdHVyZXN9XHJcbiAgICAgICAgICAgICAgICAgIGVkaXRUYXNrPXt0aGlzfSAvPn1cclxuXHJcbiAgICAgICAgICAgICAgICB7dGFzayAmJiA8UHJldmlld2FibGVUYXNrRmllbGRzXHJcbiAgICAgICAgICAgICAgICAgIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc31cclxuICAgICAgICAgICAgICAgICAgdGFzaz17dGFza31cclxuICAgICAgICAgICAgICAgICAgdGFza0N1c3RvbWl6YXRpb249e3Rhc2tDdXN0b21pemF0aW9ufVxyXG4gICAgICAgICAgICAgICAgICBlZGl0VGFzaz17dGhpc30gLz59XHJcblxyXG4gICAgICAgICAgICAgICAge3Rhc2sgJiYgPFRhc2tTdGF0dXNGcmFnbWVudCB0YXNrPXt0YXNrfSAvPn1cclxuICAgICAgICAgICAgICA8Lz59XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICB7dGFzayAmJiA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICAgICAgPFNhdmVPckNhbmNlbEJ1dHRvbnMgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfSBlZGl0VGFzaz17dGhpc30gLz5cclxuICAgICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXRcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+PC9kaXY+XHJcbiAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgKiBmcm9tICcuL2VkaXQtdGFzayc7XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgRWRpdFRhc2sgfSBmcm9tICcuL2VkaXQtdGFzayc7XHJcbmltcG9ydCB7IEVkaXRhYmxlUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtcmVzb3VyY2UtbGlzdCc7XHJcbmltcG9ydCB7IFRhc2tDb250ZW50RnJhZ21lbnQgfSBmcm9tICcuL3Rhc2stY29udGVudC1mcmFnbWVudCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHdyaXRlQWNjZXNzOiBib29sZWFuO1xyXG4gIHRhc2s6IFRhc2s7XHJcbiAgdGFza0N1c3RvbWl6YXRpb246IFBhcnRpYWw8VGFzaz47XHJcbiAgZWRpdFRhc2s6IEVkaXRUYXNrO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gUHJldmlld2FibGVUYXNrRmllbGRzKHt3cml0ZUFjY2VzcywgdGFzaywgdGFza0N1c3RvbWl6YXRpb24sIGVkaXRUYXNrfTogUHJvcHMpIHtcclxuICByZXR1cm4gPD5cclxuICAgIDw+XHJcbiAgICAgIDxoMz5VcHBnaWZ0ZW5zIGzDpHJhbmRlbcOlbDwvaDM+XHJcbiAgICAgIDxkaXY+XHJcbiAgICAgICAgPHRleHRhcmVhXHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJpbnB1dFRleHRCb3ggbGVhcm5pbmctZ29hbC1ib3hcIlxyXG4gICAgICAgICAgZGlzYWJsZWQ9eyF3cml0ZUFjY2Vzc31cclxuICAgICAgICAgIHZhbHVlPXt0YXNrLmxlYXJuaW5nR29hbH1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcclxuICAgICAgICAgICAgbmV3VGFzay5sZWFybmluZ0dvYWwgPSBldi50YXJnZXQudmFsdWU7XHJcbiAgICAgICAgICAgIGVkaXRUYXNrLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiBuZXdUYXNrIH0pO1xyXG4gICAgICAgICAgfX1cclxuICAgICAgICAvPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvPlxyXG4gICAgPGJyIC8+XHJcbiAgICA8PlxyXG4gICAgICB7KHdyaXRlQWNjZXNzIHx8ICEhdGFzay5jb250ZW50KSAmJiA8VGFza0NvbnRlbnRGcmFnbWVudFxyXG4gICAgICAgIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc31cclxuICAgICAgICB0YXNrPXt0YXNrfVxyXG4gICAgICAgIGVkaXRUYXNrPXtlZGl0VGFza30gLz59XHJcbiAgICA8Lz5cclxuICAgIDw+XHJcbiAgICAgIHt0YXNrQ3VzdG9taXphdGlvbiAmJiB0YXNrQ3VzdG9taXphdGlvbi5yZXNvdXJjZXMgP1xyXG4gICAgICAgIDxoMz5SZXN1cnNlciBmw7ZyIHVwcGdpZnRlbiAobW9kaWZpZXJhZCBmw7ZyIGRlbm5hIGt1cnNpbnN0YW5zKTwvaDM+IDpcclxuICAgICAgICA8aDM+UmVzdXJzZXIga29wcGxhZGUgdGlsbCB1cHBnaWZ0ZW48L2gzPn1cclxuXHJcbiAgICAgIDxFZGl0YWJsZVJlc291cmNlTGlzdFxyXG4gICAgICAgIHJlc291cmNlcz17XHJcbiAgICAgICAgICAodGFza0N1c3RvbWl6YXRpb24gJiYgdGFza0N1c3RvbWl6YXRpb24ucmVzb3VyY2VzKSB8fCB0YXNrLnJlc291cmNlc31cclxuICAgICAgICBob3N0PXtlZGl0VGFzay5wcm9wcy5ob3N0fVxyXG4gICAgICAgIG9uVXBkYXRlPXtyZXNvdXJjZVVwZGF0ZXMgPT4ge1xyXG4gICAgICAgICAgZWRpdFRhc2sudXBkYXRlVGFza09yQ3VzdG9taXphdGlvbihcInJlc291cmNlc1wiLCByZXNvdXJjZVVwZGF0ZXMpO1xyXG4gICAgICAgIH19IC8+XHJcbiAgICA8Lz5cclxuICA8Lz47XHJcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEVkaXRUYXNrIH0gZnJvbSAnLi9lZGl0LXRhc2snO1xyXG5pbXBvcnQgeyBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy91dGlscyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gU2F2ZU9yQ2FuY2VsQnV0dG9ucyh7d3JpdGVBY2Nlc3MsIGVkaXRUYXNrfToge3dyaXRlQWNjZXNzOiBib29sZWFuLCBlZGl0VGFzazogRWRpdFRhc2t9KSB7XHJcbiAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudD5cclxuICAgICAgeyEhZWRpdFRhc2sucHJvcHMub25EZWxldGUgJiYgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5wcm9wcy5vbkRlbGV0ZSgpfT5cclxuICAgICAgICAgIFRhIGJvcnQgZnLDpW4ga3Vyc21vZHVsXHJcbiAgICAgIDwvZGl2Pn1cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwdWxsLXJpZ2h0XCI+Jm5ic3A7PC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCkgPT4gZWRpdFRhc2sucHJvcHMub25DYW5jZWwoKX0+XHJcbiAgICAgICAgICBBdmJyeXRcclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5zYXZlKCkuY2F0Y2goc2hvd0Vycm9yKX0+XHJcbiAgICAgICAgICBTcGFyYVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgeyF3cml0ZUFjY2VzcyAmJiA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5jb3B5VGFzaygpLmNhdGNoKHNob3dFcnJvcil9PlxyXG4gICAgICAgICAgU2thcGEga29waWEgYXYgZGVuIGjDpHIgdXBwZ2lmdGVuXHJcbiAgICAgIDwvZGl2Pn1cclxuICA8L1JlYWN0LkZyYWdtZW50PjtcclxufVxyXG5cclxuIiwiaW1wb3J0IHsgVGFzayB9IGZyb20gXCJrZWRiYWNrZW5kL21vZGVsc1wiO1xyXG5pbXBvcnQgeyBFZGl0VGFzayB9IGZyb20gXCIuL2VkaXQtdGFza1wiO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgeyBzaG9ydFBlcnNvbk5hbWVGb3JtYXQsIHNob3J0RGF0ZUZvcm1hdCB9IGZyb20gXCIuLi8uLi91dGlsc1wiO1xyXG5pbXBvcnQgeyBQcmV2aWV3YWJsZVRhc2tGaWVsZHMgfSBmcm9tICcuL3ByZXZpZXdhYmxlLXRhc2stZmllbGRzJztcclxuaW1wb3J0IHsgU2F2ZU9yQ2FuY2VsQnV0dG9ucyB9IGZyb20gJy4vc2F2ZS1vci1jYW5jZWwtYnV0dG9ucyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHNlYXJjaE1hcmtlZElkczogc3RyaW5nW107XHJcbiAgc2VhcmNoUmVzdWx0OiBUYXNrW107XHJcbiAgdGFzazogVGFzaztcclxuICB3cml0ZUFjY2VzczogYm9vbGVhbjtcclxuICB0YXNrQ3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPjtcclxuICBlZGl0VGFzazogRWRpdFRhc2s7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBTZWFyY2hSZXN1bHRzICh7c2VhcmNoTWFya2VkSWRzLCBzZWFyY2hSZXN1bHQsIHRhc2ssIGVkaXRUYXNrLCB3cml0ZUFjY2VzcywgdGFza0N1c3RvbWl6YXRpb259OiBQcm9wcykge1xyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtcInRhc2stc2VhcmNoLXJlc3VsdFwiICsgKCFlZGl0VGFzay5zdGF0ZS50YXNrICYmICFlZGl0VGFzay5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnQgPyBcIiBmaXhlZFwiIDogXCJcIil9PlxyXG4gICAgICAgIHtzZWFyY2hNYXJrZWRJZHMubGVuZ3RoID09PSAwID9cclxuICAgICAgICAgICAgPGgyPlNhbXRsaWdhIHVwcGdpZnRlciBmw7ZyIGt1cnNlbjwvaDI+IDpcclxuICAgICAgICAgICAgPGgyPlVwcGdpZnRlciBzb20gdMOkY2tlciB2YWxkYSBmaWx0ZXI8L2gyPn1cclxuICAgICAgICA8dGFibGU+PHRib2R5PlxyXG4gICAgICAgICAgICB7c2VhcmNoUmVzdWx0XHJcbiAgICAgICAgICAgICAgLmZpbHRlcih0YXNrID9cclxuICAgICAgICAgICAgICAgIGZvdW5kVGFzayA9PiBmb3VuZFRhc2suaWQgPT09IHRhc2suaWQgOlxyXG4gICAgICAgICAgICAgICAgKCkgPT4gdHJ1ZSlcclxuICAgICAgICAgICAgICAubWFwKGZvdW5kVGFzayA9PiA8UmVhY3QuRnJhZ21lbnQga2V5PXtmb3VuZFRhc2suaWR9PlxyXG4gICAgICAgICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArICh0YXNrICYmIHRhc2suaWQgPT09IGZvdW5kVGFzay5pZCA/IFwiIGNoZWNrZWRcIiA6IFwiXCIpfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50b2dnbGVDaG9vc2VUYXNrKGZvdW5kVGFzaykgfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+PHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7Zm91bmRUYXNrLmNvbnRlbnQgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXtldiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2hvb3NlVGFzayhmb3VuZFRhc2spO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0+e2ZvdW5kVGFzay5uYW1lfTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17Zm91bmRUYXNrLnVybH0gdGFyZ2V0PVwiX2JsYW5rXCI+e2ZvdW5kVGFzay5uYW1lfTwvYT59XHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICB7c2hvcnRQZXJzb25OYW1lRm9ybWF0KGZvdW5kVGFzay5tb2RpZmllZEJ5Lm5hbWUpfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+PHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAge2ZvdW5kVGFzay5zY2hvb2wgfHwgXCJTdGFuZGFyZFwifVxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+PHRkPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7c2hvcnREYXRlRm9ybWF0KGZvdW5kVGFzay5tb2RpZmllZERhdGUpfVxyXG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICAgICAgey8qdGFzayAmJiB0YXNrLmlkID09PSBmb3VuZFRhc2suaWQgJiYgPHRyPjx0ZCBjb2xTcGFuPXs0fT5cclxuICAgICAgICAgICAgICAgICAge2VkaXRUYXNrLnN0YXRlLnByZXZpZXdUYXNrQ29udGVudCA/IFxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGVkaXRUYXNrLnN0YXRlLnByZXZpZXdUYXNrQ29udGVudH19IC8+XHJcbiAgICAgICAgICAgICAgICAgIDogPFByZXZpZXdhYmxlVGFza0ZpZWxkc1xyXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc31cclxuICAgICAgICAgICAgICAgICAgICB0YXNrPXt0YXNrfVxyXG4gICAgICAgICAgICAgICAgICAgIHRhc2tDdXN0b21pemF0aW9uPXt0YXNrQ3VzdG9taXphdGlvbn1cclxuICAgICAgICAgICAgICAgICAgICBlZGl0VGFzaz17ZWRpdFRhc2t9IC8+fVxyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICAgICAgICA8U2F2ZU9yQ2FuY2VsQnV0dG9ucyB3cml0ZUFjY2Vzcz17d3JpdGVBY2Nlc3N9IGVkaXRUYXNrPXtlZGl0VGFza30gLz5cclxuICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICA8L3RkPjwvdHI+Ki99XHJcbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+KX1cclxuICAgICAgICA8L3Rib2R5PjwvdGFibGU+XHJcbiAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgPGhyIC8+XHJcbiAgICA8L2Rpdj47XHJcblxyXG4gIGZ1bmN0aW9uIHRvZ2dsZUNob29zZVRhc2soZm91bmRUYXNrOiBUYXNrKSB7XHJcbiAgICBpZiAodGFzayAmJiB0YXNrLmlkID09PSBmb3VuZFRhc2suaWQpIHtcclxuICAgICAgZWRpdFRhc2sudXBkYXRlU2VhcmNoTWFya2VkSWRzKHNlYXJjaE1hcmtlZElkcyk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgZmluZERPTU5vZGUoZWRpdFRhc2spLnBhcmVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgZWRpdFRhc2suc2V0U3RhdGVQcm9taXNlZCh7IHRhc2s6IGZvdW5kVGFzaywgcHJldmlld1Rhc2tDb250ZW50OiBudWxsIH0pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IFd5c2l3eWcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zyc7XHJcbmltcG9ydCBhY3Rpb25zX3N3ZWRpc2ggZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy1zdic7XHJcbmltcG9ydCB7IEVkaXRUYXNrIH0gZnJvbSAnLi9lZGl0LXRhc2snO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIFRhc2tDb250ZW50RnJhZ21lbnQoe3dyaXRlQWNjZXNzLCB0YXNrLCBlZGl0VGFza306IHt3cml0ZUFjY2VzczogYm9vbGVhbiwgdGFzazogVGFzaywgZWRpdFRhc2s6IEVkaXRUYXNrfSkge1xyXG4gIHJldHVybiA8UmVhY3QuRnJhZ21lbnQ+XHJcbiAgICAgIDxoMz5VcHBnaWZ0ZW5zIGlubmVow6VsbDwvaDM+XHJcbiAgICAgIHt3cml0ZUFjY2VzcyAmJiA8cD5cclxuICAgICAgICAgIE9tIHVwcGdpZnRlbiBpbnRlIGzDpG5rYXIgdGlsbCBuw6Vnb3QgZG9rdW1lbnQga2FuIGR1IGzDpGdnYSBpbm5laMOlbGwgaMOkci5cclxuICAgICAgPC9wPn1cclxuICAgICAgPFd5c2l3eWcgYWN0aW9ucz17W1xyXG4gICAgICAgICAgXCJib2xkXCIsXHJcbiAgICAgICAgICBcIml0YWxpY1wiLFxyXG4gICAgICAgICAgXCJ1bmRlcmxpbmVcIixcclxuICAgICAgICAgIFwic3RyaWtldGhyb3VnaFwiLFxyXG4gICAgICAgICAgXCJoZWFkaW5nMlwiLFxyXG4gICAgICAgICAgXCJoZWFkaW5nM1wiLFxyXG4gICAgICAgICAgXCJvbGlzdFwiLFxyXG4gICAgICAgICAgXCJ1bGlzdFwiLFxyXG4gICAgICAgICAgXCJsaW5lXCIsXHJcbiAgICAgICAgICBcImxpbmtcIixcclxuICAgICAgICAgIFwiaW1hZ2VcIlxyXG4gICAgICBdfSBkZWZhdWx0QWN0aW9ucz17YWN0aW9uc19zd2VkaXNofSByZWFkT25seT17IXdyaXRlQWNjZXNzfSBodG1sPXt0YXNrLmNvbnRlbnR9IG9uQ2hhbmdlPXtodG1sID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcclxuICAgICAgICAgIG5ld1Rhc2suY29udGVudCA9IGh0bWw7XHJcbiAgICAgICAgICBlZGl0VGFzay5zZXRTdGF0ZSh7IHRhc2s6IG5ld1Rhc2sgfSk7XHJcbiAgICAgIH0gfSAvPlxyXG4gIDwvUmVhY3QuRnJhZ21lbnQ+O1xyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7VGFzaywgQ291cnNlfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRhc2s6IFRhc2s7XHJcbiAgY291cnNlOiBDb3Vyc2U7XHJcbiAgdXBkYXRlTGluazogKGlkOiBzdHJpbmcsIGxpbmtPclVubGluazogYm9vbGVhbikgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRhc2tNaWdyYXRpb25Cb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHt0YXNrLCBjb3Vyc2UsIHVwZGF0ZUxpbmt9ID0gdGhpcy5wcm9wcztcclxuICAgIGlmICghdGFzay5taWdyYXRlZFRleHRzKSByZXR1cm4gPD4mbmJzcDs8Lz47XHJcbiAgICBjb25zdCB7YWJpbGl0aWVzLCBjZW50cmFsQ29udGVudCwga25vd2xlZGdlUmVxdWlyZW1lbnRzfSA9IHRhc2subWlncmF0ZWRUZXh0cztcclxuICAgIGNvbnN0IGtycyA9IE9iamVjdC5rZXlzKGtub3dsZWRnZVJlcXVpcmVtZW50cyB8fCB7fSkubWFwKGlkID0+ICh7XHJcbiAgICAgIC4uLmNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZCh0ID0+IHQuaWQgPT09IGlkKSxcclxuICAgICAgLi4ua25vd2xlZGdlUmVxdWlyZW1lbnRzW2lkXVxyXG4gICAgfSkpLy8uZmlsdGVyKCh7bmFtZX0pID0+ICEhbmFtZSk7XHJcbiAgICBjb25zdCBrckEgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhdCBrdW5za2Fwc2tyYXYgZsO2ciBiZXR5Z2V0IEFcIiwgdHlwZTogXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgaXRlbXM6IGtycy5maWx0ZXIoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSAnQScpfTtcclxuICAgIGNvbnN0IGtyQyA9IHt0aXRsZTogXCJVcHBkYXRlcmF0IEt1bnNrYXBza3JhdiBmw7ZyIGJldHlnZXQgQ1wiLCB0eXBlOiBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBpdGVtczoga3JzLmZpbHRlcihrciA9PiBrci5ncmFkZVN0ZXAgPT09ICdDJyl9O1xyXG4gICAgY29uc3Qga3JFID0ge3RpdGxlOiBcIlVwcGRhdGVyYXQga3Vuc2thcHNrcmF2IGbDtnIgYmV0eWdldCBFXCIsIHR5cGU6IFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsIGl0ZW1zOiBrcnMuZmlsdGVyKGtyID0+IGtyLmdyYWRlU3RlcCA9PT0gJ0UnKX07XHJcbiAgICBjb25zdCBhYnMgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhZGUgZsO2cm3DpWdvclwiLCB0eXBlOiBcImFiaWxpdGllc1wiLCBpdGVtczogT2JqZWN0LmtleXMoYWJpbGl0aWVzIHx8IHt9KS5tYXAoaWQgPT4gKHtcclxuICAgICAgLi4uY291cnNlLmFiaWxpdGllcy5maW5kKHQgPT4gdC5pZCA9PT0gaWQpLFxyXG4gICAgICAuLi5hYmlsaXRpZXNbaWRdfSlcclxuICAgICl9Ly8uZmlsdGVyKCh7bmFtZX0pID0+ICEhbmFtZSl9O1xyXG4gICAgY29uc3QgY2NzID0ge3RpdGxlOiBcIlVwcGRhdGVyYXQgY2VudHJhbHQgaW5uZWjDpWxsXCIsIHR5cGU6IFwiY2VudHJhbENvbnRlbnRcIiwgaXRlbXM6IE9iamVjdC5rZXlzKGNlbnRyYWxDb250ZW50IHx8IHt9KS5tYXAoaWQgPT4gKHtcclxuICAgICAgLi4uY291cnNlLmNlbnRyYWxDb250ZW50LmZpbmQoY2MgPT4gY2MuaWQgPT0gaWQpLFxyXG4gICAgICAuLi5jZW50cmFsQ29udGVudFtpZF1cclxuICAgICAgfSlcclxuICAgICl9Ly8uZmlsdGVyKCh7bmFtZX0pID0+ICEhbmFtZSl9O1xyXG4gICAgY29uc3QgdGFibGVzVG9TaG93ID0gW2tyQSwga3JDLCBrckUsIGNjcywgYWJzXS5maWx0ZXIoYm94SW5mbyA9PiBib3hJbmZvLml0ZW1zLmxlbmd0aCA+IDApO1xyXG4gICAgaWYgKHRhYmxlc1RvU2hvdy5sZW5ndGggPT09IDApIHJldHVybiA8PiZuYnNwOzwvPjtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8T3BlbkNsb3NlQm94IGNsYXNzTmFtZT1cImxhcmdlclwiIHRpdGxlPXs8ZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2FybmluZ0ZsYWdcIj5cclxuICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxwPlVwcGRhdGVyYWRlIGZvcm11bGVyaW5nYXIgZnLDpW4gU2tvbHZlcmtldDwvcD5cclxuICAgICAgPC9kaXY+fT5cclxuICAgICAgICB7dGFibGVzVG9TaG93Lm1hcCgoe3RpdGxlLCB0eXBlLCBpdGVtc30pID0+IDxkaXYga2V5PXt0aXRsZX0+XHJcbiAgICAgICAgICA8aDU+e3RpdGxlfTwvaDU+XHJcbiAgICAgICAgICA8dGFibGU+XHJcbiAgICAgICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgICAgICA8dHI+XHJcbiAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t3aWR0aDogXCI0MCVcIn19PlVyc3BydW5nbGlnIGZvcm11bGVyaW5nPC90aD5cclxuICAgICAgICAgICAgICAgIDx0aCBzdHlsZT17e3dpZHRoOiBcIjQwJVwifX0+U2tvbHZlcmtldHMgbnlhIGZvcm11bGVyaW5nPC90aD5cclxuICAgICAgICAgICAgICAgIDx0aD5Uw6Rja2VyIHVwcGdpZnRlbiBkZW4gbnlhIGZvcm11bGVyaW5nZW4/PC90aD5cclxuICAgICAgICAgICAgICA8L3RyPlxyXG4gICAgICAgICAgICA8L3RoZWFkPlxyXG4gICAgICAgICAgICA8dGJvZHk+XHJcbiAgICAgICAgICAgICAge2l0ZW1zLm1hcChpdGVtID0+IDx0ciBrZXk9e2l0ZW0uaWR9PlxyXG4gICAgICAgICAgICAgICAgPHRkIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBpdGVtLm9sZFRleHR9fSAvPlxyXG4gICAgICAgICAgICAgICAgPHRkIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBpdGVtLm5hbWV9fSAvPlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT51cGRhdGVMaW5rKGl0ZW0uaWQsIHRydWUpfT5KYSAtIGJlaMOlbGwga29wcGxpbmdlbjwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT51cGRhdGVMaW5rKGl0ZW0uaWQsIGZhbHNlKX0+TmVqIC0gdGEgYm9ydCBrb3BwbGluZ2VuPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgIDwvdHI+KX1cclxuICAgICAgICAgICAgPC90Ym9keT5cclxuICAgICAgICAgIDwvdGFibGU+XHJcbiAgICAgICAgPC9kaXY+KX1cclxuICAgICAgPC9PcGVuQ2xvc2VCb3g+XHJcblxyXG4gICAgKVxyXG4gIH1cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgZHRGb3JtYXQgfSBmcm9tICcuLi8uLi91dGlscyc7XHJcbmltcG9ydCB7IFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gVGFza1N0YXR1c0ZyYWdtZW50KHt0YXNrfToge3Rhc2s6IFRhc2t9KSB7XHJcbiAgcmV0dXJuIDw+XHJcbiAgICAgIDxoMz5VcHBnaWZ0ZW5zIHN0YXR1czwvaDM+XHJcblxyXG4gICAgICB7dGFzay5jcmVhdGVkQnkgJiYgdGFzay5jcmVhdGVkRGF0ZSAmJiA8cD5cclxuICAgICAgICAgIFVwcGdpZnRlbiBza2FwYWRlcyB7ZHRGb3JtYXQodGFzay5jcmVhdGVkRGF0ZSl9IGF2IDxzdHJvbmc+e3Rhc2suY3JlYXRlZEJ5Lm5hbWV9PC9zdHJvbmc+LlxyXG4gICAgICA8L3A+fVxyXG4gICAgICB7dGFzay5tb2RpZmllZEJ5ICYmIHRhc2subW9kaWZpZWREYXRlICYmIDxwPlxyXG4gICAgICAgICAgVXBwZ2lmdGVuIHJlZGlnZXJhZGVzIHNlbmFzdCB7ZHRGb3JtYXQodGFzay5tb2RpZmllZERhdGUpfSBhdiA8c3Ryb25nPnt0YXNrLm1vZGlmaWVkQnkubmFtZX08L3N0cm9uZz4uXHJcbiAgICAgIDwvcD59XHJcbiAgPC8+O1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IERpYWxvZyB9IGZyb20gJy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0JztcclxuaW1wb3J0IHZhbGlkVXJsIGZyb20gJ3ZhbGlkLXVybCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHVybD86IHN0cmluZztcclxuICBvblNhdmU6IChuZXdVcmw6IHN0cmluZykgPT4gdm9pZDtcclxuICBvbkRlbGV0ZT86ICgpPT52b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIHVybDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRWRpdFdvcmtmbG93TGluayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4gaW1wbGVtZW50cyBEaWFsb2cge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHt1cmw6IHRoaXMucHJvcHMudXJsIHx8ICcnfTtcclxuICB9XHJcblxyXG4gIHNhdmUoKSB7XHJcbiAgICBjb25zdCB7dXJsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBpZiAoIXZhbGlkVXJsLmlzVXJpKHVybCkpIHRocm93IG5ldyBFcnJvcihMYEFuZ2l2ZW4gVVJMICcke3VybH0nIMOkciBvZ2lsdGlnLiBTa2EgYsO2cmphIG1lZCBodHRwOiBlbGxlciBodHRwczpgKTtcclxuICAgIHRoaXMucHJvcHMub25TYXZlKHVybCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7b25TYXZlLCBvbkRlbGV0ZX0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qgc3RhdGUgPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgaXNWYWxpZFVybCA9IHZhbGlkVXJsLmlzVXJpKHRoaXMuc3RhdGUudXJsKTtcclxuXHJcbiAgICByZXR1cm4gPGRpdj48ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxoMj5Lb3BwbGEgZW4gYXJiZXRzZ8OlbmcgdGlsbCBrdXJzZW48L2gyPlxyXG4gICAgICA8cD5EZXQgZ8OlciBiYXJhIGF0dCBsw6RnZ2EgaW4gZW4gYXJiZXRzZ8OlbmcgcGVyIGt1cnMuPC9wPlxyXG4gICAgICA8YnIgLz5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5Mw6Ruazo8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBcIj5cclxuICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBzaXplPXs1MH1cclxuICAgICAgICAgICAgdmFsdWU9e3N0YXRlLnVybH1cclxuICAgICAgICAgICAgb25DaGFuZ2U9e2V2PT50aGlzLnNldFN0YXRlKHt1cmw6IGV2LnRhcmdldC52YWx1ZX0pfSAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHNwYWNlZFwiPjwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGJyIC8+PC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIiBpZD1cInN2aWQxMl80OTI0MjJkNTE1YmFkZjM2NjQ2ZTRmZjFcIj5cclxuICAgICAgICB7b25EZWxldGUgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCk9Pm9uRGVsZXRlKCl9PlxyXG4gICAgICAgICAgVGEgYm9ydCBhcmJldHNnw6VuZ1xyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgICA8YVxyXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICBjbGFzc05hbWU9e1wiYnRuIGJ0bi1sYXJnZVwiICsgKGlzVmFsaWRVcmwgPyBcIlwiIDogXCIgYnRuLWluYWN0aXZlXCIpfVxyXG4gICAgICAgICAgb25DbGljaz17aXNWYWxpZFVybCAmJiAoKCkgPT4gb25TYXZlKHN0YXRlLnVybCkpfT5TcGFyYTwvYT5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBTY2hvb2wsIEJyYW5jaCwgQ291cnNlIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcclxuaW1wb3J0IHsgc2hvd0Vycm9yLCBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MsIEJhdGNoUnVubmVyIH0gZnJvbSBcImtlZGJhY2tlbmQvY2xpZW50XCI7XHJcbmltcG9ydCB7IExpbmsgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgaWQ/OiBzdHJpbmdcclxuICB0aXRsZTogc3RyaW5nXHJcbiAgdHlwZT86ICdneW1uYXNpdW0nIHwgJ3ByaW1hcnknXHJcbn1cclxuXHJcbnR5cGUgU3RhdGUgPSBTY2hvb2w7XHJcblxyXG5leHBvcnQgY29uc3QgRWRpdFNjaG9vbCA9IChwcm9wczogUHJvcHMgJiB7ZmVlZGJhY2tVcmw6IHN0cmluZ30pID0+IDxkaXYgc3R5bGU9e3sgb3V0bGluZTogMCB9fT5cclxuICA8Q291cnNlQmFubmVyXHJcbiAgICB0aXRsZT1cIlNrb2xvclwiIGFjdGl2ZVBhZ2U9XCJzY2hvb2xzXCIgY2FsbGJhY2tzPXt7c2Nob29sczogKCk9PmxvY2F0aW9uLmhhc2g9XCIjL3NjaG9vbHNcIn19XHJcbiAgICByb3V0ZXM9e3tmZWVkYmFjazogcHJvcHMuZmVlZGJhY2tVcmx9fSAvPlxyXG4gIDxFZGl0U2Nob29sTm9CYW5uZXIgey4uLnByb3BzfSAvPlxyXG48L2Rpdj47XHJcblxyXG5leHBvcnQgY2xhc3MgRWRpdFNjaG9vbE5vQmFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgb3JpZ1NjaG9vbDogU2Nob29sO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChlcnIgPT4gc2hvd0Vycm9yKGVycikpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZCgpIHtcclxuICAgIGlmICh0aGlzLnByb3BzLmlkKSB7XHJcbiAgICAgIC8vIElEIGdpdmVuLCBsb2FkIGl0LlxyXG4gICAgICBjb25zdCB7IGlkIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICBjb25zdCBzY2hvb2wgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5nZXQ8U2Nob29sPihcInNjaG9vbHNcIiwgaWQpO1xyXG4gICAgICB0aGlzLm9yaWdTY2hvb2wgPSB7IC4uLnNjaG9vbCB9O1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHsgLi4uc2Nob29sIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gTm8gaWQsIGNyZWF0ZSBuZXcgaW5zdGVhZC5cclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICBvZmZpY2lhbEJyYW5jaElkOiBjcmVhdGVVVUlEKCksXHJcbiAgICAgICAgaXNHeW1uYXNpdW06IHRoaXMucHJvcHMudHlwZSA9PT0gJ2d5bW5hc2l1bScsXHJcbiAgICAgICAgaXNQcmltYXJ5U2Nob29sOiB0aGlzLnByb3BzLnR5cGUgPT09ICdwcmltYXJ5J1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIHNhdmUoKSB7XHJcbiAgICBjb25zdCByID0gbmV3IEJhdGNoUnVubmVyKCk7XHJcbiAgICBsZXQgc2Nob29sID0geyAuLi50aGlzLnN0YXRlLCB0YWdzOiAodGhpcy5zdGF0ZS50YWdzIHx8IFtdKVxyXG4gICAgICAuZmlsdGVyKHRhZyA9PiBbXCJwcmltYXJ5XCIsIFwiZ3ltbmFzaXVtXCJdLmluZGV4T2YodGFnKSA8IDApXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChzY2hvb2wuaXNQcmltYXJ5U2Nob29sKSBzY2hvb2wudGFncy5wdXNoKFwicHJpbWFyeVwiKTtcclxuICAgIGlmIChzY2hvb2wuaXNHeW1uYXNpdW0pIHNjaG9vbC50YWdzLnB1c2goXCJneW1uYXNpdW1cIik7XHJcbiAgICBpZiAoIShzY2hvb2wuaXNHeW1uYXNpdW0gfHwgc2Nob29sLmlzUHJpbWFyeVNjaG9vbCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yIChMYFNrb2xhbiBtw6VzdGUgYW50aW5nZW4gdmFyYSBneW1uYXNpdW0gZWxsZXIgZ3J1bmRza29sYWApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghdGhpcy5vcmlnU2Nob29sKSB7XHJcbiAgICAgIHNjaG9vbC5hY2wgPSBbXCJyb2xlOlVTRVI6UlwiXTtcclxuICAgICAgc2Nob29sLmFjbC5wdXNoKFxyXG4gICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcclxuICAgICAgICAgIFwic2Nob29sUm9sZVwiLFxyXG4gICAgICAgICAgYCR7c2Nob29sLm5hbWV9L0VNUExPWUVFYCwgXCJXXCIpLnRvU3RyaW5nKCkpO1xyXG4gICAgICByLmFkZChcInNjaG9vbHNcIiwgc2Nob29sKTtcclxuICAgICAgdGhpcy5hZGRTY2hvb2xCcmFuY2goc2Nob29sLCByKTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnU2Nob29sLm5hbWUgIT09IHRoaXMuc3RhdGUubmFtZSkge1xyXG5cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2tvbGFucyBuYW1uIGbDpXIgaW50ZSDDpG5kcmFzLiBLb250YWt0YSBWZW1lbmRvIEFCLlwiKVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmICghc2Nob29sLm9mZmljaWFsQnJhbmNoSWQpIHtcclxuICAgICAgICBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCA9IGNyZWF0ZVVVSUQoKTtcclxuICAgICAgICB0aGlzLmFkZFNjaG9vbEJyYW5jaChzY2hvb2wsIHIpO1xyXG4gICAgICB9XHJcbiAgICAgIHIucHV0KFwic2Nob29sc1wiLCBzY2hvb2wpO1xyXG4gICAgfVxyXG5cclxuICAgIGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmJhdGNoKHIubXV0YXRpb25SZXF1ZXN0cyk7XHJcblxyXG4gICAgbG9jYXRpb24uaGFzaCA9IFwiIy9zY2hvb2xzXCI7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFkZFNjaG9vbEJyYW5jaChzY2hvb2w6IHsgdGFnczogc3RyaW5nW107IG5hbWU6IHN0cmluZzsgaXNQcmltYXJ5U2Nob29sPzogYm9vbGVhbjsgaXNHeW1uYXNpdW0/OiBib29sZWFuOyBvZmZpY2lhbEJyYW5jaElkOiBzdHJpbmc7IGNvdXJzZXM/OiBDb3Vyc2VbXTsgYWN0aXZlQ291cnNlcz86IENvdXJzZVtdOyBpZDogc3RyaW5nOyBhY2w/OiBzdHJpbmdbXTsgZGF0ZVRpbWU/OiBudW1iZXI7IHRyZWVQYXJlbnRJZD86IHN0cmluZzsgJGV0YWc/OiBzdHJpbmc7ICRtZXRhPzogXCJhZGRcIiB8IFwicmVmXCIgfCBcInVwZGF0ZVwiIHwgXCJhZGRpbmdcIiB8IFwidXBkYXRpbmdcIiB8IFwiZGVsZXRpbmdcIiB8IFwiZGVsZXRlZFwiOyB9LCByOiBCYXRjaFJ1bm5lcikge1xyXG4gICAgY29uc3QgYnJhbmNoOiBCcmFuY2ggPSB7XHJcbiAgICAgIGlkOiBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCxcclxuICAgICAgbmFtZTogc2Nob29sLm5hbWUsXHJcbiAgICAgIHNjaG9vbElkOiBzY2hvb2wuaWQsXHJcbiAgICAgIGFjbDogW1xyXG4gICAgICAgIFwicm9sZTpVU0VSOlJcIixcclxuICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJzY2hvb2xSb2xlXCIsIGAke3NjaG9vbC5uYW1lfS9FTVBMT1lFRWAsIFwiV1wiKS50b1N0cmluZygpXHJcbiAgICAgIF1cclxuICAgIH07XHJcbiAgICByLmFkZChcImJyYW5jaGVzXCIsIGJyYW5jaCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBkZWxldGVTY2hvb2woKSB7XHJcbiAgICBpZiAocHJvbXB0KExgw4RyIGR1IHPDpGtlciBww6UgYXR0IHRhIGJvcnQgc2tvbGFuIFwiJHt0aGlzLnN0YXRlLm5hbWV9XCI/IFNrcml2IHNrb2xhbnMgZXhha3RhIG5hbW4gZsO2ciBhdHQgYmVrcsOkZnRhYCkgPT09IHRoaXMuc3RhdGUubmFtZSApIHtcclxuICAgICAgY29uc3Qgc2Nob29sQnJhbmNoID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxCcmFuY2g+KFwiYnJhbmNoZXNcIiwge1xyXG4gICAgICAgIGlkczogW3RoaXMuc3RhdGUub2ZmaWNpYWxCcmFuY2hJZF0sXHJcbiAgICAgICAgaW5jbHVkZTogXCJhcHByb3ZlZENoaWxkcmVuXCIsXHJcbiAgICAgICAgZmxhZ3M6IFtcImluY2x1ZGVJZHNPbmx5XCJdXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCBiciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xyXG4gICAgICBici5kZWxldGUoXCJzY2hvb2xzXCIsIHRoaXMuc3RhdGUuaWQpO1xyXG4gICAgICBzY2hvb2xCcmFuY2hbMF0uYXBwcm92ZWRDaGlsZHJlbi5mb3JFYWNoKCh7aWR9KSA9PiB7XHJcbiAgICAgICAgYnIuZGVsZXRlKFwiYnJhbmNoZXNcIiwgaWQpO1xyXG4gICAgICB9KTtcclxuICAgICAgYnIuZGVsZXRlKFwiYnJhbmNoZXNcIiwgdGhpcy5zdGF0ZS5vZmZpY2lhbEJyYW5jaElkKTtcclxuICAgICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goYnIubXV0YXRpb25SZXF1ZXN0cyk7XHJcbiAgICAgIGxvY2F0aW9uLmhhc2g9IFwiIy9zY2hvb2xzXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhbGVydChcIlNrb2xhbiB0b2dzIGludGUgYm9ydCBlZnRlcnNvbSBkZXQgbmFtbiBkdSBhbmdhdiBpbnRlIHN0w6RtbWVyLlwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgdGl0bGUsIGlkIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgZWRpdEV4aXN0aW5nID0gISFpZDtcclxuICAgIGNvbnN0IHNjaG9vbCA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBvcmlnU2Nob29sID0gdGhpcy5vcmlnU2Nob29sO1xyXG4gICAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gXCJBRE1JTlwiKTtcclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIDxoMj57dGl0bGV9PC9oMj5cclxuICAgICAgICA8aHIgLz5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+TmFtbjo8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGF1dG9Gb2N1cz17IXNjaG9vbCB8fCAhc2Nob29sLm5hbWV9XHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWluIHx8IGVkaXRFeGlzdGluZ31cclxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICBzaXplPXs1MH1cclxuICAgICAgICAgICAgICB2YWx1ZT17c2Nob29sID8gc2Nob29sLm5hbWUgOiBcIlwifVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgbmFtZTogZXYudGFyZ2V0LnZhbHVlIH0pfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+VmlzbmluZ3NuYW1uOjwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzPXtzY2hvb2wgJiYgIXNjaG9vbC5kaXNwbGF5TmFtZX1cclxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XHJcbiAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgc2l6ZT17NTB9XHJcbiAgICAgICAgICAgICAgdmFsdWU9e3NjaG9vbCA/IHNjaG9vbC5kaXNwbGF5TmFtZSA6IFwiXCJ9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMuc2V0U3RhdGUoeyBkaXNwbGF5TmFtZTogZXYudGFyZ2V0LnZhbHVlIH0pfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICB7c2Nob29sICYmIHNjaG9vbC5pc0d5bW5hc2l1bSA/IDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5FRFMgbmFtbiAoZ3ltbmFzaXVtKTo8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWlufVxyXG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICAgIHNpemU9ezUwfVxyXG4gICAgICAgICAgICAgIHZhbHVlPXtzY2hvb2wgPyBzY2hvb2wuZWRzU2Nob29sTmFtZUd5bW4gOiBcIlwifVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgZWRzU2Nob29sTmFtZUd5bW46IGV2LnRhcmdldC52YWx1ZSB9KX0gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XHJcbiAgICAgICAgPC9kaXY+IDogbnVsbH1cclxuICAgICAgICB7c2Nob29sICYmIHNjaG9vbC5pc1ByaW1hcnlTY2hvb2wgPyA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+RURTIG5hbW4gKGdydW5kc2tvbGEpOjwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XHJcbiAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgc2l6ZT17NTB9XHJcbiAgICAgICAgICAgICAgdmFsdWU9e3NjaG9vbCA/IHNjaG9vbC5lZHNTY2hvb2xOYW1lUHJpbSA6IFwiXCJ9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMuc2V0U3RhdGUoeyBlZHNTY2hvb2xOYW1lUHJpbTogZXYudGFyZ2V0LnZhbHVlIH0pfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj4gOiBudWxsfVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5UeXA6PC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCJcclxuICAgICAgICAgICAgICBuYW1lPVwic2Nob29sVHlwZVByaW1hcnlcIlxyXG4gICAgICAgICAgICAgIGRpc2FibGVkPXshaXNBZG1pbn1cclxuICAgICAgICAgICAgICBjaGVja2VkPXtzY2hvb2wgJiYgc2Nob29sLmlzUHJpbWFyeVNjaG9vbH1cclxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgICB2YWx1ZT1cInByaW1hcnlcIlxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgaXNQcmltYXJ5U2Nob29sOiBldi50YXJnZXQuY2hlY2tlZCB9KX0gLz5cclxuICAgICAgICAgICAgJm5ic3A7R3J1bmRza29sYVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+PC9kaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCJcclxuICAgICAgICAgICAgICBuYW1lPVwic2Nob29sVHlwZUd5bW5hc2l1bVwiXHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWlufVxyXG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3NjaG9vbCAmJiBzY2hvb2wuaXNHeW1uYXNpdW19XHJcbiAgICAgICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICAgICAgdmFsdWU9XCJneW1uYXNpdW1cIlxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgaXNHeW1uYXNpdW06IGV2LnRhcmdldC5jaGVja2VkIH0pfSAvPlxyXG4gICAgICAgICAgICAmbmJzcDtHeW1uYXNpdW1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGJyLz5cclxuICAgICAgICB7aXNBZG1pbiAmJiBlZGl0RXhpc3RpbmcgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCkgPT5cclxuICAgICAgICAgIHRoaXMuZGVsZXRlU2Nob29sKCkuY2F0Y2goc2hvd0Vycm9yKX0+XHJcbiAgICAgICAgICBUYSBib3J0IHNrb2xhXHJcbiAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHVsbC1yaWdodFwiPiZuYnNwOzwvZGl2PlxyXG4gICAgICAgIDxMaW5rIGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiIHRvPVwiL3NjaG9vbHNcIj5cclxuICAgICAgICAgIEF2YnJ5dFxyXG4gICAgICAgIDwvTGluaz5cclxuICAgICAgICBcclxuICAgICAgICB7aXNBZG1pbiAmJiA8YSB0YWJJbmRleD17MX0gY2xhc3NOYW1lPXtcImJ0biBidG4tbGFyZ2VcIn0gb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgaWYgKG9yaWdTY2hvb2wgJiYgb3JpZ1NjaG9vbC5uYW1lICE9PSBzY2hvb2wubmFtZSkge1xyXG4gICAgICAgICAgICBpZiAoIWNvbmZpcm0oTGDDhHIgZHUgc8Oka2VyIHDDpSBhdHQgZHUgdmlsbCBkw7ZwYSBvbSBza29sYW4/IERldHRhIHDDpXZlcmthciBwb3J0YWxlbnMgZnVua3Rpb24gZsO2ciBsw6RyYXJlIG9jaCBlbGV2ZXIgc29tIHRpbGxow7ZyIHNrb2xhbi4gTmFtbmV0IG3DpXN0ZSBzdMOkbW1hIGV4YWt0IMO2dmVyZW5zIG1lZCBuYW1uZ2l2bmluZ2VuIGF2IHNrb2xhbiBww6UgYW52w6RuZGFyb2JqZWt0ZW4uXHJcblxyXG5EZXQgc29tIGjDpG5kZXIgYW5uYXJzIMOkciBhdHQgZWxldmVyIG9jaCBsw6RyYXJlIHDDpSBza29sYW4gaW50ZSBsw6RuZ3JlIGhpdHRhciBuw6VncmEga3Vyc2VyLlxyXG5cclxuQmxpciBkZXQgZmVsIGthbiBkdSBkb2NrIGFsbHRpZCBiYXJhIGTDtnBhIHRpbGxiYWthIHNrb2xhbnMgbmFtbi5gKSkge1xyXG4gICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5zYXZlKCkuY2F0Y2goc2hvd0Vycm9yKTtcclxuICAgICAgICB9fT5TcGFyYTwvYT59XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+O1xyXG4gIH1cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBEaWFsb2dDb250YWluZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3RcIjtcclxuaW1wb3J0IHsgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzIH0gZnJvbSBcIi4uL3V0aWxzXCI7XHJcbmltcG9ydCB7IEVkaXRTY2hvb2wgfSBmcm9tICcuL2VkaXQtc2Nob29sJztcclxuaW1wb3J0IHsgTGluayB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5pbXBvcnQgeyBhY3RBcyB9IGZyb20gXCIuLi8uLi8uLi9hY2Nlc3MtY29udHJvbFwiO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgc2Nob29scz86IFNjaG9vbFtdXHJcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nXHJcbiAgdHlwZTogJ2d5bW5hc2l1bScgfCAncHJpbWFyeSdcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEVkaXRhYmxlU2Nob29sTGlzdCA9IChwcm9wczogUHJvcHMpID0+IHtcclxuICBjb25zdCB7IHNjaG9vbHMsIHZpZXdDb3Vyc2VVcmwgfSA9IHByb3BzO1xyXG4gIGNvbnN0IGlzQWRtaW4gPSBlbnYuY3VycmVudFVzZXIucm9sZXMuc29tZShyb2xlID0+IHJvbGUgPT09IFwiQURNSU5cIik7XHJcbiAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZWRpdGFibGUtc2Nob29sLWxpc3RcIj5cclxuICAgIDxkaXY+XHJcbiAgICAgIHtzY2hvb2xzID8gPHRhYmxlPlxyXG4gICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgIHtzY2hvb2xzLm1hcChzY2hvb2wgPT5cclxuICAgICAgICAgICAgPHRyIGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e3NjaG9vbC5pZH0+XHJcbiAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgPExpbmsgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiB0bz17YC9zY2hvb2xzLyR7c2Nob29sLmlkfS9lZGl0YH0+PC9MaW5rPlxyXG4gICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgPHA+e3NjaG9vbC5uYW1lfTwvcD5cclxuICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgICAgIDxwPjxhIHN0eWxlPXt7Y3Vyc29yOiAncG9pbnRlcid9fSBvbkNsaWNrPXsoKT0+YWN0QXMoe3JvbGU6IFwiRU1QTE9ZRUVcIiwgc2Nob29sOiBzY2hvb2wubmFtZX0pfT5BZ2VyYSBzb20gbMOkcmFyZSBww6UgZGVubmEgc2tvbGE8L2E+PC9wPlxyXG4gICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgPHA+PGEgc3R5bGU9e3tjdXJzb3I6ICdwb2ludGVyJ319IG9uQ2xpY2s9eygpPT5hY3RBcyh7cm9sZTogXCJTVFVERU5UXCIsIHNjaG9vbDogc2Nob29sLm5hbWUsIHVybDogdmlld0NvdXJzZVVybH0pfT5BZ2VyYSBzb20gZWxldiBww6UgZGVubmEgc2tvbGE8L2E+PC9wPlxyXG4gICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgIDwvdHI+KX1cclxuICAgICAgICA8L3Rib2R5PlxyXG4gICAgICA8L3RhYmxlPiA6IDxwPjxTcGlubmVyIC8+Vi5nLiB2w6RudGEgbWVkYW4gc2tvbG9yIGxhZGRhczwvcD59XHJcbiAgICA8L2Rpdj5cclxuICAgIDxiciAvPlxyXG4gICAge3NjaG9vbHMgJiYgaXNBZG1pbiAmJiA8TGluayB0bz17YC9zY2hvb2xzL25ldy8ke3Byb3BzLnR5cGV9YH0gY2xhc3NOYW1lPVwiYnRuXCI+e1xyXG4gICAgICAgIHByb3BzLnR5cGUgPT0gJ2d5bW5hc2l1bScgPyBMYEzDpGdnIHRpbGwgZ3ltbmFzaWVza29sYWAgOlxyXG4gICAgICAgIHByb3BzLnR5cGUgPT0gJ3ByaW1hcnknID8gTGBMw6RnZyB0aWxsIGdydW5kc2tvbGFgIDpcclxuICAgICAgICBMYEzDpGdnIHRpbGwgc2tvbGFgfTwvTGluaz59XHJcbiAgPC9kaXYgPlxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFNjaG9vbCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgRWRpdGFibGVTY2hvb2xMaXN0IH0gZnJvbSAnLi9lZGl0YWJsZS1zY2hvb2wtbGlzdCc7XHJcbmltcG9ydCB7IHNob3dFcnJvciwgY29tcGFyZVByb3AgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XHJcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBzY2hvb2xzOiBTY2hvb2xbXSB8IG51bGxcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFNjaG9vbHMgPSAocHJvcHM6IFByb3BzKSA9PiA8ZGl2IHN0eWxlPXt7IG91dGxpbmU6IDAgfX0+XHJcbiAgPENvdXJzZUJhbm5lciB0aXRsZT1cIlNrb2xvclwiIGFjdGl2ZVBhZ2U9XCJzY2hvb2xzXCIgcm91dGVzPXt7ZmVlZGJhY2s6IHByb3BzLmZlZWRiYWNrVXJsfX0gLz5cclxuICA8U2Nob29sc1dpdGhvdXRCYW5uZXIgdmlld0NvdXJzZVVybD17cHJvcHMudmlld0NvdXJzZVVybH0gLz5cclxuPC9kaXY+XHJcblxyXG5leHBvcnQgY2xhc3MgU2Nob29sc1dpdGhvdXRCYW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UGljazxQcm9wcywgXCJ2aWV3Q291cnNlVXJsXCI+LFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBzY2hvb2xzOiBudWxsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgIHRoaXMubG9hZCgpLmNhdGNoKGVyciA9PiBzaG93RXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkKCkge1xyXG4gICAgY29uc3Qgc2Nob29scyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U2Nob29sPihcInNjaG9vbHNcIik7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgc2Nob29scyB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgc2Nob29scyB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIHNjaG9vbHMgJiYgc2Nob29scy5zb3J0KGNvbXBhcmVQcm9wKFwibmFtZVwiKSk7XHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0XCI+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZWNvbnRlbnQgc3YtbGF5b3V0IHN2LXNwYWNlci0yMHB4dnQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICB7c2Nob29scyA/IDw+XHJcbiAgICAgICAgPGRpdj5cclxuICAgICAgICAgIDxoMj5HeW1uYXNpZXNrb2xvcjwvaDI+XHJcbiAgICAgICAgICA8RWRpdGFibGVTY2hvb2xMaXN0XHJcbiAgICAgICAgICAgIHNjaG9vbHM9e3NjaG9vbHMuZmlsdGVyKHNjaG9vbCA9PiBzY2hvb2wuaXNHeW1uYXNpdW0pfVxyXG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XHJcbiAgICAgICAgICAgIHR5cGU9XCJneW1uYXNpdW1cIiAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXY+XHJcbiAgICAgICAgICA8aDI+R3J1bmRza29sb3I8L2gyPlxyXG4gICAgICAgICAgPEVkaXRhYmxlU2Nob29sTGlzdFxyXG4gICAgICAgICAgICBzY2hvb2xzPXtzY2hvb2xzLmZpbHRlcihzY2hvb2wgPT4gc2Nob29sLmlzUHJpbWFyeVNjaG9vbCl9XHJcbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cclxuICAgICAgICAgICAgdHlwZT1cInByaW1hcnlcIiAvPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8Lz4gOiA8U3Bpbm5lciAvPn1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQge0VkaXRTY2hvb2x9IGZyb20gJy4vZWRpdC1zY2hvb2wnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0eXBlOiAnZ3ltbmFzaXVtJyB8ICdwcmltYXJ5J1xyXG4gIGZlZWRiYWNrVXJsOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBOZXdTY2hvb2wgPSAocHJvcHM6IFByb3BzKT0+PEVkaXRTY2hvb2xcclxuICB0aXRsZT17TGBMw6RnZyB0aWxsIHNrb2xhYH1cclxuICB0eXBlPXtwcm9wcy50eXBlfVxyXG4gIGZlZWRiYWNrVXJsPXtwcm9wcy5mZWVkYmFja1VybH0gLz47XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtSZXNvdXJjZX0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQge0xpbmt9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5pbXBvcnQge0lDb3Vyc2VFZGl0b3JIb3N0fSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7RWRpdFJlc291cmNlfSBmcm9tICcuLi9tb2RhbC1wYWdlcy9lZGl0LXJlc291cmNlJztcclxuaW1wb3J0IHsgdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMgfSBmcm9tICcuLi91dGlscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgRHJpdmVCdXR0b24gfSBmcm9tICcuLi8uLi8uLi9hcGlzL2J1dHRvbnMnO1xyXG5pbXBvcnQgeyBHb29nbGVQaWNrZXIgfSBmcm9tICcuLi8uLi8uLi9hcGlzL2dvb2dsZS1waWNrZXInO1xyXG5pbXBvcnQgeyByZXNvbHZlUHRyIH0gZnJvbSAnZG5zJztcclxuaW1wb3J0IHsgZmVhdHVyZXMgfSBmcm9tICcuLi8uLi8uLi9mZWF0dXJlcyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHJlc291cmNlczogUmVzb3VyY2VbXTtcclxuICBvblVwZGF0ZTogKHJlc291cmNlc1VwZGF0ZXMpID0+IHZvaWQ7XHJcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3Q7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRWRpdGFibGVSZXNvdXJjZUxpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGU9e307XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7aG9zdCwgb25VcGRhdGUsIHJlc291cmNlc30gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qgc2hvd0dvb2dsZVBpY2tlciA9IGZlYXR1cmVzLnBpY2tlcjtcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICB7cmVzb3VyY2VzLm1hcCgocmVzb3VyY2UsIGlkeCkgPT4gXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2lkeH0+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKT0+aG9zdC5vcGVuRGlhbG9nKHtcclxuICAgICAgICAgICAgICAgIENvbXBvbmVudDogRWRpdFJlc291cmNlLFxyXG4gICAgICAgICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiUmVkaWdlcmEgcmVzdXJzXCIsXHJcbiAgICAgICAgICAgICAgICAgIHJlc291cmNlLFxyXG4gICAgICAgICAgICAgICAgICBvblNhdmU6IGVkaXRlZFJlc291cmNlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkUmVzb3VyY2UgPSB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhlZGl0ZWRSZXNvdXJjZSwgZW52LmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgICAgICAgICBvblVwZGF0ZSh7JHNwbGljZTogW1tpZHgsIDEsIHVwZGF0ZWRSZXNvdXJjZV1dfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICBvbkRlbGV0ZTogKCk9PntcclxuICAgICAgICAgICAgICAgICAgICBvblVwZGF0ZSh7JHNwbGljZTogW1tpZHgsIDFdXX0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pfT48L2E+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxhIGhyZWY9e3Jlc291cmNlLnVybH0gdGFyZ2V0PVwiX2JsYW5rXCIgPntyZXNvdXJjZS5uYW1lfTwvYT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgIDwvZGl2PlxyXG4gICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsLWFsaWduIHNwYWNlZFwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YUl0ZW0gdG9wXCI+XHJcbiAgICAgICAgPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCk9Pmhvc3Qub3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICBDb21wb25lbnQ6IEVkaXRSZXNvdXJjZSxcclxuICAgICAgICAgICBwcm9wczoge1xyXG4gICAgICAgICAgIHRpdGxlOiBcIkzDpGdnIHRpbGwgcmVzdXJzXCIsXHJcbiAgICAgICAgICAgb25TYXZlOiBuZXdSZXNvdXJjZSA9PiB7XHJcbiAgICAgICAgICAgICBjb25zdCB1cGRhdGVkUmVzb3VyY2UgPSB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhuZXdSZXNvdXJjZSwgZW52LmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgIG9uVXBkYXRlKHskcHVzaDogW3VwZGF0ZWRSZXNvdXJjZV19KVxyXG4gICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KX0+PGkgY2xhc3NOYW1lPVwiZmEgZmEtcGFwZXJjbGlwXCIgYXJpYS1oaWRkZW4+PC9pPiBMw6RnZyB0aWxsIHJlc3VyczwvYT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICB7c2hvd0dvb2dsZVBpY2tlciAmJiA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YUl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICA8RHJpdmVCdXR0b24gbGFiZWw9XCJMw6RnZyB0aWxsIGZyw6VuIERyaXZlXCIgYWN0aW9uPXsoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBpY2tlciA9IG5ldyBHb29nbGVQaWNrZXIoeyB1cGxvYWQ6IHRydWUsIG11bHRpcGxlOiB0cnVlIH0pO1xyXG5cclxuICAgICAgICAgICAgcGlja2VyLnNob3coKS50aGVuKGZpbGVzID0+IHtcclxuICAgICAgICAgICAgICBmaWxlcy5mb3JFYWNoKChmaWxlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdSZXNvdXJjZTogUmVzb3VyY2UgPSB7IHVybDogZmlsZS51cmwsIG5hbWU6IGZpbGUubmFtZSB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkUmVzb3VyY2UgPSB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhuZXdSZXNvdXJjZSwgZW52LmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgICAgIG9uVXBkYXRlKHsgJHB1c2g6IFt1cGRhdGVkUmVzb3VyY2VdIH0pXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IFRhc2ssIENvdXJzZSwgQ291cnNlTW9kdWxlLCBBYmlsaXR5IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB7IEVkaXRUYXNrIH0gZnJvbSAnLi4vbW9kYWwtcGFnZXMvZWRpdC10YXNrJztcclxuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzIH0gZnJvbSBcIi4uL3V0aWxzXCI7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgaGFzV3JpdGVBY2Nlc3MgfSBmcm9tIFwiLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2xcIjtcclxuaW1wb3J0IHsgU29ydGFibGVUYXNrTGlzdCwgVGFza1dpdGhNZXRhZGF0YSB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9zb3J0YWJsZS10YXNrLWxpc3QnO1xyXG5pbXBvcnQgeyBnZXRPcmRlcmVkRG9jcyB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyLWtzL2xvZ2ljL29yZGVyZWQtcmVxdWlyZW1lbnRzJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgdGFza0lkczogc3RyaW5nW107XHJcbiAgdGFza0N1c3RvbWl6YXRpb25zPzogeyBbdGFza0lkOiBzdHJpbmddOiBQYXJ0aWFsPFRhc2s+IH1cclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBtb2R1bGU6IENvdXJzZU1vZHVsZTtcclxuICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrOiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcclxuICBvblRhc2tBZGRlZDogKHRhc2s6IFRhc2ssIHRhc2tDdXN0b21pemF0aW9uPzogUGFydGlhbDxUYXNrPikgPT4gdm9pZDtcclxuICBvblRhc2tVcGRhdGVkOiAodGFzaykgPT4gdm9pZDtcclxuICBvblRhc2tDdXN0b21pemF0aW9uVXBkYXRlZDogKHRhc2tJZCwgY3VzdG9taXphdGlvbikgPT4gdm9pZDtcclxuICBvblRhc2tEZWxldGVkOiAoaWQpID0+IHZvaWQ7XHJcbiAgb25UYXNrUmVwbGFjZWQ6IChpZCwgdGFzaykgPT4gdm9pZDtcclxuICBvblRhc2tzUmVvcmRlcmVkOiAoc291cmNlOiBUYXNrLCB0YXJnZXQ6IFRhc2ssIHBsYWNlbWVudDogJ2FmdGVyJyB8ICdiZWZvcmUnKSA9PiB2b2lkXHJcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3Q7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRWRpdGFibGVUYXNrTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gIH1cclxuXHJcbiAgb3BlblRhc2tEaWFsb2codGFzazogVGFzaykge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbnMsXHJcbiAgICAgIGNvdXJzZSxcclxuICAgICAgaG9zdCxcclxuICAgICAgbW9kdWxlLFxyXG4gICAgICB0YXNrSWRzLFxyXG4gICAgICBvblRhc2tBZGRlZCxcclxuICAgICAgb25UYXNrVXBkYXRlZCxcclxuICAgICAgb25UYXNrQ3VzdG9taXphdGlvblVwZGF0ZWQsXHJcbiAgICAgIG9uVGFza0RlbGV0ZWQsXHJcbiAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2ssXHJcbiAgICAgIG9uVGFza1JlcGxhY2VkXHJcbiAgICB9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICBob3N0Lm9wZW5EaWFsb2coe1xyXG4gICAgICBDb21wb25lbnQ6IEVkaXRUYXNrLFxyXG4gICAgICBwcm9wczoge1xyXG4gICAgICAgIHRhc2ssXHJcbiAgICAgICAgdGFza0N1c3RvbWl6YXRpb246IHRhc2tDdXN0b21pemF0aW9ucyAmJiB0YXNrQ3VzdG9taXphdGlvbnNbdGFzay5pZF0sXHJcbiAgICAgICAgbW9kdWxlLFxyXG4gICAgICAgIGNvdXJzZSxcclxuICAgICAgICBob3N0LFxyXG4gICAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2ssXHJcbiAgICAgICAgb25TYXZlOiB0YXNrID0+IHtcclxuICAgICAgICAgIGNvbnN0IHVwZGF0ZWRUYXNrID0gdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHModGFzaywgZW52LmN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgIG9uVGFza1VwZGF0ZWQodXBkYXRlZFRhc2spO1xyXG4gICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25TYXZlQ3VzdG9taXphdGlvbjogY3VzdG9taXphdGlvbiA9PiB7XHJcbiAgICAgICAgICBvblRhc2tDdXN0b21pemF0aW9uVXBkYXRlZCh0YXNrLmlkLCBjdXN0b21pemF0aW9uKTtcclxuICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uRGVsZXRlOiAoKSA9PiB7XHJcbiAgICAgICAgICBvblRhc2tEZWxldGVkKHRhc2suaWQpO1xyXG4gICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25SZXBsYWNlOiAodGFza0lkOiBzdHJpbmcsIG5ld1Rhc2s6IFRhc2spID0+IHtcclxuICAgICAgICAgIG9uVGFza1JlcGxhY2VkKHRhc2tJZCwgbmV3VGFzayk7XHJcbiAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkNhbmNlbDogKCkgPT4gaG9zdC5jbG9zZURpYWxvZygpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgcHJvcHMgPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgdGFza3MgPSBnZXRPcmRlcmVkRG9jcyhwcm9wcy5jb3Vyc2UudGFza3MsIHByb3BzLnRhc2tJZHMsIHthcHBlbmRMZWZ0b3ZlcnM6IGZhbHNlfSk7XHJcbiAgICAgICAgXHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPFNvcnRhYmxlVGFza0xpc3RcclxuICAgICAgICB0YXNrTWV0YXM9e3Rhc2tzLm1hcCh0YXNrID0+ICh7dGFzaywgaXNUYXNrT3duZXI6IGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgdGFzayl9KSl9XHJcbiAgICAgICAgcmVuZGVyRWRpdExpbms9eyh7dGFzaywgaXNUYXNrT3duZXJ9KSA9PiA8ZGl2IGNsYXNzTmFtZT17aXNUYXNrT3duZXIgP1xyXG4gICAgICAgICAgICBcImVkaXRJdGVtXCIgOlxyXG4gICAgICAgICAgICBcInZpZXdJdGVtXCJcclxuICAgICAgICAgIH0gb25DbGljaz17KCk9PnRoaXMub3BlblRhc2tEaWFsb2codGFzayl9IC8+fVxyXG4gICAgICAgIHJlbmRlckxpbms9eyh7dGFza30pID0+IHRhc2suY29udGVudCA/XHJcbiAgICAgICAgICAvLyBSYXRoZXIgdGhhbiBsaW5raW5nIHRvIHVybCwgc2hvdyB0aGUgdGFzaydzIGNvbnRlbnQgKGJ5IG9wZW5pbmdcclxuICAgICAgICAgIC8vIHRoZSB0YXNrIGRpYWxvZylcclxuICAgICAgICAgIDxhIGhyZWY9XCIjXCIgb25DbGljaz17ZXY9PntcclxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5vcGVuVGFza0RpYWxvZyh0YXNrKTtcclxuICAgICAgICAgIH19Pnt0YXNrLm5hbWV9PC9hPiA6XHJcbiAgICAgICAgICA8YSBocmVmPXt0YXNrLnVybH0gdGFyZ2V0PVwiX2JsYW5rXCI+e3Rhc2submFtZX08L2E+fVxyXG4gICAgICAgIG9uU29ydD17KHNvdXJjZSwgdGFyZ2V0LCBwbGFjZW1lbnQpID0+IHtcclxuICAgICAgICAgIHRoaXMucHJvcHMub25UYXNrc1Jlb3JkZXJlZChzb3VyY2UsIHRhcmdldCwgcGxhY2VtZW50KTtcclxuICAgICAgICB9fSAvPlxyXG5cclxuICAgICAgPGJyIC8+XHJcbiAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICBjb3Vyc2UsXHJcbiAgICAgICAgICBob3N0LFxyXG4gICAgICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzayxcclxuICAgICAgICAgIG1vZHVsZSxcclxuICAgICAgICAgIG9uVGFza0FkZGVkLFxyXG4gICAgICAgICAgb25UYXNrQ3VzdG9taXphdGlvblVwZGF0ZWQgfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgICAgIHByb3BzLmhvc3Qub3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICBDb21wb25lbnQ6IEVkaXRUYXNrLFxyXG4gICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgc2VhcmNoTW9kZTogdHJ1ZSxcclxuICAgICAgICAgICAgbW9kdWxlLFxyXG4gICAgICAgICAgICBjb3Vyc2UsXHJcbiAgICAgICAgICAgIGhvc3QsXHJcbiAgICAgICAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2ssXHJcbiAgICAgICAgICAgIG9uU2F2ZTogKGNob29zZW5UYXNrLCB0YXNrQ3VzdG9taXphdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgIGNob29zZW5UYXNrID0gdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMoY2hvb3NlblRhc2ssIGVudi5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgICAgICAgb25UYXNrQWRkZWQoY2hvb3NlblRhc2ssIHRhc2tDdXN0b21pemF0aW9uKTtcclxuICAgICAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiBob3N0LmNsb3NlRGlhbG9nKClcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfX0+PGkgY2xhc3NOYW1lPVwiZmEgZmEtc2VhcmNoXCIgYXJpYS1oaWRkZW4gLz4gU8O2ayB1cHBnaWZ0PC9hPlxyXG4gICAgICAmbmJzcDtcclxuICAgICAgPGEgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgY291cnNlLCBob3N0LCBtb2R1bGUsIHRhc2tJZHMsIG9uVGFza0FkZGVkLCBvblRhc2tVcGRhdGVkLCBvblRhc2tEZWxldGVkLCBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIGhvc3Qub3BlbkRpYWxvZyh7XHJcbiAgICAgICAgICBDb21wb25lbnQ6IEVkaXRUYXNrLFxyXG4gICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgbW9kdWxlLFxyXG4gICAgICAgICAgICBjb3Vyc2UsXHJcbiAgICAgICAgICAgIGhvc3QsXHJcbiAgICAgICAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2ssXHJcbiAgICAgICAgICAgIG9uU2F2ZTogbmV3VGFzayA9PiB7XHJcbiAgICAgICAgICAgICAgbmV3VGFzayA9IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKG5ld1Rhc2ssIGVudi5jdXJyZW50VXNlcik7XHJcbiAgICAgICAgICAgICAgb25UYXNrQWRkZWQobmV3VGFzayk7XHJcbiAgICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gaG9zdC5jbG9zZURpYWxvZygpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH19IGNsYXNzTmFtZT1cImJ0blwiPlxyXG4gICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIiBhcmlhLWhpZGRlbiAvPiBMw6RnZyB0aWxsIGVnZW4gdXBwZ2lmdFxyXG4gICAgICA8L2E+XHJcbiAgICA8L2RpdiA+XHJcbiAgfVxyXG59IiwiaW1wb3J0IFJlYWN0LCB7dXNlUmVmLCB1c2VTdGF0ZSwgdXNlQ29udGV4dH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBTb2Z0RG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tIFwiLi9yZW1vdmUtaXRlbVwiO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBTZWxlY3RUZWFjaGVyIH0gZnJvbSAnLi9zZWxlY3QtdGVhY2hlcic7XHJcbmltcG9ydCB7IE9ic2VydmUgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb2JzZXJ2ZSc7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuL3NwaW5uZXInO1xyXG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uLy4uL2ZlYXR1cmVzJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgc2Nob29sOiBzdHJpbmc7XHJcbiAgdGVhY2hlcnM6IFNvZnREb2N1bWVudEFjY2Vzc1tdO1xyXG4gIG9uVXBkYXRlOiAodGVhY2hlcnM6IFNvZnREb2N1bWVudEFjY2Vzc1tdKSA9PiB2b2lkO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gRWRpdGFibGVUZWFjaGVyTGlzdCAoe3NjaG9vbCwgdGVhY2hlcnMsIG9uVXBkYXRlfTogUHJvcHMpIHtcclxuICBjb25zdCBuYW1lRWxlbSA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50PigpO1xyXG4gIGNvbnN0IFtzZWxlY3RpbmdUZWFjaGVyLCBzZXRTZWxlY3RpbmdUZWFjaGVyXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBkaXNwbGF5VGVhY2hlclJpZ2h0cyA9IGZlYXR1cmVzLnRlYWNoZXJSaWdodHM7XHJcblxyXG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInRlYWNoZXJzLWxpc3RcIj5cclxuICAgIDxoMz5BbnN2YXJpZ2EgbMOkcmFyZTwvaDM+XHJcbiAgICA8dGFibGUgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fT5cclxuICAgICAgPHRoZWFkPlxyXG4gICAgICAgIHt0ZWFjaGVycy5sZW5ndGggPiAwICYmIDx0cj5cclxuICAgICAgICAgIDx0aCBzdHlsZT17e3dpZHRoOiBcIjE1JVwifX0+e0xgTmFtbmB9PC90aD5cclxuICAgICAgICAgIDx0aD57TGBFLXBvc3RhZHJlc3NgfTwvdGg+XHJcbiAgICAgICAgICB7ZGlzcGxheVRlYWNoZXJSaWdodHMgJiYgPHRoIHN0eWxlPXt7d2lkdGg6IFwiMjRweFwifX0+e0xgQmVow7ZyaWdoZXRgfTwvdGg+fVxyXG4gICAgICAgICAgPHRoIHN0eWxlPXt7d2lkdGg6IFwiMjRweFwifX0+PC90aD5cclxuICAgICAgICA8L3RyPn1cclxuICAgICAgPC90aGVhZD5cclxuICAgICAgPHRib2R5PlxyXG4gICAgICAgIHt0ZWFjaGVycy5tYXAoKHRlYWNoZXIsIGlkeCkgPT4gXHJcbiAgICAgICAgPHRyIGtleT17aWR4fT5cclxuICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgcmVmPXtuYW1lRWxlbX0gdmFsdWU9e3RlYWNoZXIubmFtZX0gYXV0b0ZvY3VzPXshdGVhY2hlci5uYW1lICYmIGlkeCA+IDB9IG9uQ2hhbmdlPXtcclxuICAgICAgICAgICAgZXY9PntcclxuICAgICAgICAgICAgICBpZiAoZXYudGFyZ2V0LnZhbHVlIHx8IHRlYWNoZXIuZW1haWwpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSByb3dcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNsb25lID0gWy4uLnRlYWNoZXJzXTtcclxuICAgICAgICAgICAgICAgIGNsb25lW2lkeF0gPSB7Li4udGVhY2hlciwgbmFtZTogZXYudGFyZ2V0LnZhbHVlfTtcclxuICAgICAgICAgICAgICAgIG9uVXBkYXRlKGNsb25lKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHJvd1xyXG4gICAgICAgICAgICAgICAgb25VcGRhdGUoWy4uLnRlYWNoZXJzLnNsaWNlKDAsIGlkeCksIC4uLnRlYWNoZXJzLnNsaWNlKGlkeCArIDEpXSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9Lz48L3RkPlxyXG4gICAgICAgICAgPHRkPjxpbnB1dFxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwifX1cclxuICAgICAgICAgICAgdmFsdWU9e3RlYWNoZXIuZW1haWwgfHwgdGVhY2hlci51cmx9XHJcbiAgICAgICAgICAgIG9uS2V5RG93bj17ZXYgPT4ge1xyXG4gICAgICAgICAgICAgIGlmIChldi53aGljaCA9PT0gOSAmJlxyXG4gICAgICAgICAgICAgICAgICFldi5zaGlmdEtleSAmJlxyXG4gICAgICAgICAgICAgICAgIGlkeCA9PT0gdGVhY2hlcnMubGVuZ3RoIC0gMSAmJlxyXG4gICAgICAgICAgICAgICAgKHRlYWNoZXJzLmxlbmd0aCA8IDEgfHwgISF0ZWFjaGVyc1t0ZWFjaGVycy5sZW5ndGggLSAxXS5uYW1lKSlcclxuICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3RpbmdUZWFjaGVyKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZWRpdGVkVGVhY2hlciA9IHtcclxuICAgICAgICAgICAgICAgIC4uLnRlYWNoZXIsXHJcbiAgICAgICAgICAgICAgICB1cmw6IGV2LnRhcmdldC52YWx1ZSwgLy8gVE9ETzogUmVtb3ZlIHByb3BlcnR5IHVybCAocmVuYW1lZCB0byAnZW1haWwnKSB3aGVuIG1pZ3JhdGVkIGZ1bGx5IChhZnRlciByZWxlYXNpbmcgQ2xhc3Nyb29tIEludGVncmF0aW9uKVxyXG4gICAgICAgICAgICAgICAgZW1haWw6IGV2LnRhcmdldC52YWx1ZVxyXG4gICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgaWYgKGV2LnRhcmdldC52YWx1ZSB8fCB0ZWFjaGVyLm5hbWUpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSByb3dcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNsb25lID0gWy4uLnRlYWNoZXJzXTtcclxuICAgICAgICAgICAgICAgIGNsb25lW2lkeF0gPSBlZGl0ZWRUZWFjaGVyO1xyXG4gICAgICAgICAgICAgICAgb25VcGRhdGUoY2xvbmUpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcm93XHJcbiAgICAgICAgICAgICAgICBvblVwZGF0ZShbLi4udGVhY2hlcnMuc2xpY2UoMCwgaWR4KSwgLi4udGVhY2hlcnMuc2xpY2UoaWR4ICsgMSldKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICB9Lz5cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUZWFjaGVyUmlnaHRzICYmIDx0ZD5cclxuICAgICAgICAgICAgPHNlbGVjdCBkaXNhYmxlZD17ISh0ZWFjaGVyLmVtYWlsIHx8IHRlYWNoZXIudXJsKX0gdmFsdWU9e3RlYWNoZXIuYWNjZXNzIHx8wqAnZWRpdCd9IG9uQ2hhbmdlPXtldiA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgY2xvbmUgPSBbLi4udGVhY2hlcnNdO1xyXG4gICAgICAgICAgICAgIGNsb25lW2lkeF0gPSB7Li4udGVhY2hlciwgYWNjZXNzOiBldi50YXJnZXQudmFsdWUgYXMgU29mdERvY3VtZW50QWNjZXNzW1wiYWNjZXNzXCJdfTtcclxuICAgICAgICAgICAgICBvblVwZGF0ZShjbG9uZSk7XHJcbiAgICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJyZWFkXCI+e0xgTMOkc2FgfTwvb3B0aW9uPlxyXG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJlZGl0XCI+e0xgUmVkaWdlcmFgfTwvb3B0aW9uPlxyXG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCJmdWxsXCI+e0xgRnVsbGB9PC9vcHRpb24+XHJcbiAgICAgICAgICAgIDwvc2VsZWN0PlxyXG4gICAgICAgICAgPC90ZD5cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAgPFJlbW92ZUl0ZW0gb25DbGljaz17KCk9PntcclxuICAgICAgICAgICAgICBvblVwZGF0ZShbLi4udGVhY2hlcnMuc2xpY2UoMCwgaWR4KSwgLi4udGVhY2hlcnMuc2xpY2UoaWR4ICsgMSldKTtcclxuICAgICAgICAgICAgfX0gLz5cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgPC90cj4pfVxyXG4gICAgICA8L3Rib2R5PlxyXG4gICAgPC90YWJsZT5cclxuICAgIDxici8+XHJcbiAgICB7c2VsZWN0aW5nVGVhY2hlciA/XHJcbiAgICAgIDxPYnNlcnZlIGZhbGxiYWNrPXs8U3Bpbm5lciAvPn0gZXJyb3JGYWxsYmFjaz17TGBLdW5kZXIgaW50ZSBow6RtdGEgc2tvbGFucyBsw6RyYXJlIGZyw6VuIEVEU2B9PlxyXG4gICAgICAgIDxTZWxlY3RUZWFjaGVyXHJcbiAgICAgICAgICBzY2hvb2w9e3NjaG9vbH1cclxuICAgICAgICAgIHNlbGVjdGVkVGVhY2hlcnM9e3RlYWNoZXJzfVxyXG4gICAgICAgICAgb25CbHVyPXsoKT0+c2V0U2VsZWN0aW5nVGVhY2hlcihmYWxzZSl9XHJcbiAgICAgICAgICBvblNlbGVjdD17KHtuYW1lLCBlbWFpbH0pID0+IHtcclxuICAgICAgICAgIGNvbnN0IG5ld1RlYWNoZXI6IFNvZnREb2N1bWVudEFjY2VzcyA9IHtcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgZW1haWwsXHJcbiAgICAgICAgICAgIHVybDogZW1haWwsIC8vIFRPRE86IFJlbW92ZSBwcm9wZXJ0eSB1cmwgKHJlbmFtZWQgdG8gJ2VtYWlsJykgd2hlbiBtaWdyYXRlZCBmdWxseSAoYWZ0ZXIgcmVsZWFzaW5nIENsYXNzcm9vbSBJbnRlZ3JhdGlvbilcclxuICAgICAgICAgICAgYWNjZXNzOiAnZWRpdCdcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBjb25zdCBjbG9uZSA9IFsuLi50ZWFjaGVyc107XHJcbiAgICAgICAgICBjbG9uZS5wdXNoKG5ld1RlYWNoZXIpO1xyXG4gICAgICAgICAgb25VcGRhdGUoY2xvbmUpO1xyXG4gICAgICAgICAgc2V0U2VsZWN0aW5nVGVhY2hlcihmYWxzZSk7XHJcbiAgICAgICAgfX0gLz5cclxuICAgICAgPC9PYnNlcnZlPiA6XHJcblxyXG4gICAgICA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+e1xyXG4gICAgICAgIHNldFNlbGVjdGluZ1RlYWNoZXIodHJ1ZSk7XHJcbiAgICAgIH19PlxyXG4gICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS11c2VyLXBsdXNcIiBhcmlhLWhpZGRlbiAvPlxyXG4gICAgICAge0xgIEzDpGdnIHRpbGwgYW5zdmFyaWcgbMOkcmFyZWB9PC9hPn1cclxuICA8L2Rpdj5cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtSZXNvdXJjZX0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQge0xpbmt9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5pbXBvcnQge0lDb3Vyc2VFZGl0b3JIb3N0fSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XHJcbmltcG9ydCB7RWRpdFJlc291cmNlfSBmcm9tICcuLi9tb2RhbC1wYWdlcy9lZGl0LXJlc291cmNlJztcclxuaW1wb3J0IHsgdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMgfSBmcm9tICcuLi91dGlscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgRWRpdFdvcmtmbG93TGluayB9IGZyb20gJy4uL21vZGFsLXBhZ2VzL2VkaXQtd29ya2Zsb3ctbGluayc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHVybDogc3RyaW5nO1xyXG4gIG9uVXBkYXRlOiAodXBkYXRlcykgPT4gdm9pZDtcclxuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVkaXRhYmxlV29ya0Zsb3dMaW5rIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlPXt9O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2hvc3QsIG9uVXBkYXRlLCB1cmx9ID0gdGhpcy5wcm9wcztcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICB7dXJsICYmXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJlZGl0SXRlbVwiIG9uQ2xpY2s9eygpPT5ob3N0Lm9wZW5EaWFsb2coe1xyXG4gICAgICAgICAgICAgICAgQ29tcG9uZW50OiBFZGl0V29ya2Zsb3dMaW5rLFxyXG4gICAgICAgICAgICAgICAgcHJvcHM6IHtcclxuICAgICAgICAgICAgICAgICAgdXJsLFxyXG4gICAgICAgICAgICAgICAgICBvblNhdmU6IG5ld1VybCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzZXQ6IG5ld1VybH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgb25EZWxldGU6ICgpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzZXQ6IHVuZGVmaW5lZH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pfT48L2E+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxhIGhyZWY9e3VybH0gdGFyZ2V0PVwiX2JsYW5rXCIgPk51dmFyYW5kZSBhcmJldHNnw6VuZzwvYT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICB9XHJcbiAgICAgPC9kaXY+XHJcbiAgICB7IXVybCAmJiA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+aG9zdC5vcGVuRGlhbG9nKHtcclxuICAgICAgQ29tcG9uZW50OiBFZGl0V29ya2Zsb3dMaW5rLFxyXG4gICAgICBwcm9wczoge1xyXG4gICAgICAgIG9uU2F2ZTogbmV3VXJsID0+IHtcclxuICAgICAgICAgIG9uVXBkYXRlKHskc2V0OiBuZXdVcmx9KVxyXG4gICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSl9PjxpIGNsYXNzTmFtZT1cImZhIGZhLXBhcGVyY2xpcFwiIGFyaWEtaGlkZGVuPjwvaT4gS29wcGxhIGVuIGFyYmV0c2fDpW5nIHRpbGwga3Vyc2VuPC9hPn1cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7QWJpbGl0eSwgS25vd2xlZGdlUmVxdWlyZW1lbnR9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQge1JlbW92ZUl0ZW19IGZyb20gJy4vcmVtb3ZlLWl0ZW0nO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IEtub3dsZWRnZVJlcXVpcmVtZW50W107XHJcbiAgaWRzVG9NYXJrTm90T2s/OiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcclxuICBleHBsYWluZWRSZXF1aXJlbWVudHM/OiB7W3JlcXVpcmVtZW50SWQ6IHN0cmluZ106IHN0cmluZ31cclxuICAvLyBQcm9wcyB1c2VkIGluIGVkaXQgbW9kZSAoZWRpdGluZyBjb3Vyc2UgdGVtcGxhdGVzKVxyXG4gIC8vY292ZXJlZElkcz86IHN0cmluZ1tdO1xyXG4gIC8vIFByb3BzIHVzZWQgaW4gbWFyayBtb2RlIChlZGl0aW5nIHRhc2tzKVxyXG4gIG1hcmtNb2RlPzogYm9vbGVhbjtcclxuICBtYXJrZWRJZHM/OiBzdHJpbmdbXTtcclxuICBtaWdyYXRlZElkcz86IHtbaWQ6IHN0cmluZ106IGFueX07XHJcbiAgb25NYXJrQ2hhbmdlZDogKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIG9uRXhwbGFpbmVkUmVxdWlyZW1lbnRzQ2hhbmdlZD86IChyZXFJZDogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpID0+IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBLbm93bGVkZ2VNYXRyaXggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIHt9PiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGtub3dsZWRnZVJlcXVpcmVtZW50cywgbWFya2VkSWRzLCBtaWdyYXRlZElkcywgZXhwbGFpbmVkUmVxdWlyZW1lbnRzIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgeyBpZHNUb01hcmtOb3RPaywgbWFya01vZGUsIG9uTWFya0NoYW5nZWQsIG9uRXhwbGFpbmVkUmVxdWlyZW1lbnRzQ2hhbmdlZCB9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgICBjb25zdCBjb2x1bW5zID0gW1wiRVwiLCBcIkNcIiwgXCJBXCJdO1xyXG4gICAgY29uc3Qgcm93czogS25vd2xlZGdlUmVxdWlyZW1lbnRbXVtdID0gW107XHJcbiAgICBjb25zdCByZXFzID0ga25vd2xlZGdlUmVxdWlyZW1lbnRzLnNsaWNlKCk7XHJcbiAgICBsZXQgcm93OiBLbm93bGVkZ2VSZXF1aXJlbWVudFtdIHwgbnVsbCA9IG51bGw7XHJcbiAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICByb3cgPSBjb2x1bW5zLm1hcChncmFkZSA9PiB7XHJcbiAgICAgICAgY29uc3QgcE5leHQgPSByZXFzLmZpbmRJbmRleChyID0+IHIuZ3JhZGVTdGVwICYmIHIuZ3JhZGVTdGVwLnRvVXBwZXJDYXNlKCkgPT09IGdyYWRlKTtcclxuICAgICAgICBpZiAocE5leHQgPCAwKSByZXR1cm4gbnVsbDtcclxuICAgICAgICBjb25zdCBydiA9IHJlcXNbcE5leHRdO1xyXG4gICAgICAgIHJlcXMuc3BsaWNlKHBOZXh0LCAxKTtcclxuICAgICAgICByZXR1cm4gcnY7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAocm93LmV2ZXJ5KHIgPT4gciA9PT0gbnVsbCkpXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIHJvd3MucHVzaChyb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8dGFibGU+XHJcbiAgICAgICAgPHRoZWFkPlxyXG4gICAgICAgICAgPHRyPlxyXG4gICAgICAgICAgICB7Y29sdW1ucy5tYXAoYyA9PiA8dGgga2V5PXtjfT57Y308L3RoPil9XHJcbiAgICAgICAgICA8L3RyPlxyXG4gICAgICAgIDwvdGhlYWQ+XHJcbiAgICAgICAgPHRib2R5PlxyXG4gICAgICAgICAge3Jvd3MubWFwKChyb3csaSkgPT4gPFJlYWN0LkZyYWdtZW50IGtleT17aX0+XHJcbiAgICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgICB7cm93Lm1hcCgocmVxdWlyZW1lbnQsaikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNNYXJrZWRPSyA9IHJlcXVpcmVtZW50ICYmIG1hcmtlZElkcyAmJiBtYXJrZWRJZHMuaW5kZXhPZihyZXF1aXJlbWVudC5pZCkgPj0gMDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkTm90T0sgPSByZXF1aXJlbWVudCAmJiBpZHNUb01hcmtOb3RPayAmJiBpZHNUb01hcmtOb3RPa1tyZXF1aXJlbWVudC5pZF07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc01pZ3JhdGVkID0gcmVxdWlyZW1lbnQgJiYgbWlncmF0ZWRJZHMgJiYgISFtaWdyYXRlZElkc1tyZXF1aXJlbWVudC5pZF07XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gPHRkXHJcbiAgICAgICAgICAgICAgICAgIGtleT17an1cclxuICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHJlcXVpcmVtZW50ID8gcmVxdWlyZW1lbnQubmFtZSA6IFwiXCJ9fVxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9eyhtYXJrTW9kZSA/IFwic2VsZWN0YWJsZVwiIDogXCJcIikgK1xyXG4gICAgICAgICAgICAgICAgICAoaXNNaWdyYXRlZCA/IFwiIG1pZ3JhdGVkXCIgOiBcIlwiKSArXHJcbiAgICAgICAgICAgICAgICAgIChpc01hcmtlZE9LID9cclxuICAgICAgICAgICAgICAgICAgICBcIiBtYXJrZWRHcmVlblwiIDpcclxuICAgICAgICAgICAgICAgICAgICAoaXNNYXJrZWROb3RPSyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICBcIiBtYXJrZWRSZWRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgIFwiXCIpKX1cclxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXttYXJrTW9kZSAmJiByZXF1aXJlbWVudCA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAoKT0+b25NYXJrQ2hhbmdlZChyZXF1aXJlbWVudC5pZCwgIWlzTWFya2VkT0spIDpcclxuICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17aXNNaWdyYXRlZCA/XHJcbiAgICAgICAgICAgICAgICAgICAgICBtYXJrTW9kZSA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGBTa29sdmVya2V0IGhhciB1cHBkYXRlcmF0IHRleHRlbnMgZm9ybXVsZXJpbmcuIER1IGthbiBncmFuc2thIMOkbmRyaW5nZW4gZ2Vub20gYXR0IGbDpGxsYSB1dCB2YXJuaW5nc2JveGVuIHRpbGwgaMO2Z2VyLCBtZWQgdGl0ZWwgXCJVcHBkYXRlcmFkZSBmb3JtdWxlcmluZ2FyIGZyw6VuIFNrb2x2ZXJrZXRcImAgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBgU2tvbHZlcmtldCBoYXIgdXBwZGF0ZXJhdCB0ZXh0ZW5zIGZvcm11bGVyaW5nLCBtZW4gZGV0dGEgaGFyIMOkbm51IGludGUgZ3JhbnNrYXRzIGF2IHVwcGdpZnRlbnMgcmVkaWdlcmluZ3NiZWjDtnJpZ2VgIDpcclxuICAgICAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZH0gLz5cclxuICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAge2V4cGxhaW5lZFJlcXVpcmVtZW50cyAmJiA8dHI+XHJcbiAgICAgICAgICAgICAge3Jvdy5tYXAoKHJlcXVpcmVtZW50LGopID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkT0sgPSByZXF1aXJlbWVudCAmJiBtYXJrZWRJZHMgJiYgbWFya2VkSWRzLmluZGV4T2YocmVxdWlyZW1lbnQuaWQpID49IDA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gPHRkIGtleT17an0+XHJcbiAgICAgICAgICAgICAgICAgIHtpc01hcmtlZE9LID8gPHRleHRhcmVhXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e0xgQmVza3JpdiBrcmF2ZXRgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImlucHV0VGV4dEJveCBpbnB1dFRleHRMYXJnZVwiIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwifX1cclxuICAgICAgICAgICAgICAgICAgICByZWFkT25seT17IW1hcmtNb2RlfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtleHBsYWluZWRSZXF1aXJlbWVudHNbcmVxdWlyZW1lbnQuaWRdIHx8IFwiXCJ9XHJcbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uRXhwbGFpbmVkUmVxdWlyZW1lbnRzQ2hhbmdlZCAmJiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICBldiA9PiBvbkV4cGxhaW5lZFJlcXVpcmVtZW50c0NoYW5nZWQocmVxdWlyZW1lbnQuaWQsIGV2LnRhcmdldC52YWx1ZSkpfVxyXG4gICAgICAgICAgICAgICAgICAvPiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgICAgPC90ZD59KX1cclxuICAgICAgICAgICAgPC90cj59XHJcbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvdGJvZHk+XHJcbiAgICAgIDwvdGFibGU+XHJcbiAgICA8L2Rpdj5cclxuXHJcbiAgICB7LypyZXR1cm4gPGRpdj5cclxuICAgICAgPHRhYmxlPlxyXG4gICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAgPHRoPkU8L3RoPlxyXG4gICAgICAgICAgICA8dGg+QzwvdGg+XHJcbiAgICAgICAgICAgIDx0aD5BPC90aD5cclxuICAgICAgICAgIDwvdHI+XHJcbiAgICAgICAgPC90aGVhZD5cclxuICAgICAgICA8dGJvZHk+XHJcbiAgICAgICAgICB7dGJvZHkubWFwKChyb3csIGkpID0+IFxyXG4gICAgICAgICAgPHRyIGtleT17aX0+e3Jvdy5tYXAoKGNlbGwsIGopID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWRPSyA9IHByb3BzLm1hcmtlZElkcyAmJiBwcm9wcy5tYXJrZWRJZHMuaW5kZXhPZihjZWxsLmlkKSA+PSAwO1xyXG4gICAgICAgICAgICBjb25zdCBpc01hcmtlZE5vdE9LID0gcHJvcHMuaWRzVG9NYXJrTm90T2sgJiYgcHJvcHMuaWRzVG9NYXJrTm90T2tbY2VsbC5pZF07XHJcbiAgICAgICAgICAgIHJldHVybiA8dGRcclxuICAgICAgICAgICAgICBrZXk9e2p9XHJcbiAgICAgICAgICAgICAgcm93U3Bhbj17Y2VsbC5yb3dTcGFufVxyXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT17KHByb3BzLm1hcmtNb2RlID8gXCJzZWxlY3RhYmxlXCIgOiBcIlwiKSArXHJcbiAgICAgICAgICAgICAgICAoaXNNYXJrZWRPSyA/XHJcbiAgICAgICAgICAgICAgICAgIFwiIG1hcmtlZEdyZWVuXCIgOlxyXG4gICAgICAgICAgICAgICAgICAoaXNNYXJrZWROb3RPSyA/XHJcbiAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgXCJcIikpfVxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e3Byb3BzLm1hcmtNb2RlICYmICgoKT0+cHJvcHMub25NYXJrQ2hhbmdlZChjZWxsLmlkLCAhaXNNYXJrZWRPSykpfT5cclxuICAgICAgICAgICAgICB7Y2VsbC5odG1sICYmIDxkaXYgc3R5bGU9e3twb3NpdGlvbjogJ3JlbGF0aXZlJ319PlxyXG4gICAgICAgICAgICAgICAgPHBcclxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtjZWxsLnR5cGUgPT09ICdhYmlsaXR5JyA/ICdhYmlsaXR5VGV4dCcgOiAnY3JpdGVyaWFUZXh0J31cclxuICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGNlbGwuaHRtbH19IC8+XHJcbiAgICAgICAgICAgICAgICB7cHJvcHMuZWRpdE1vZGUgJiYgPFJlbW92ZUl0ZW0gY2xhc3NOYW1lPVwidXBwZXJSaWdodFwiIG9uQ2xpY2s9eygpPT5cclxuICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDZWxsSWRzKFxyXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBjZWxsLnJvd0luZGV4LFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q2VsbElkcyhcclxuICAgICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgIGNlbGwucm93SW5kZXgpLmZpbHRlcihpZCA9PiBpZCAhPSBjZWxsLmlkKSApfSAvPiB9XHJcbiAgICAgICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgICAgICA8L3RkPn0pfVxyXG4gICAgICAgICAgPC90cj4pfVxyXG4gICAgICAgIDwvdGJvZHk+XHJcbiAgICAgIDwvdGFibGU+XHJcbiAgICA8L2Rpdj4qL31cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIG9uQ2xpY2ssXHJcbiAgY2xhc3NOYW1lPyxcclxuICBzdHlsZT8sXHJcbiAgdGl0bGU/XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgUmVtb3ZlSXRlbSA9ICh7IG9uQ2xpY2ssIGNsYXNzTmFtZSwgc3R5bGUsIHRpdGxlIH06IFByb3BzKSA9PlxyXG5cclxuICA8ZGl2XHJcbiAgICB0aXRsZT17dGl0bGUgfHwgTGBSYWRlcmFgfVxyXG4gICAgY2xhc3NOYW1lPXtcInJlbW92ZUl0ZW0gXCIgKyAoY2xhc3NOYW1lIHx8IFwiXCIpfVxyXG4gICAgb25DbGljaz17b25DbGlja30gc3R5bGU9e3N0eWxlfSAvPlxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwsIHNob3dFcnJvciwgY29tcGFyZVByb3AgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IENvdXJzZSB9IGZyb20gXCJrZWRiYWNrZW5kL21vZGVsc1wiO1xyXG5pbXBvcnQgeyBteVNjaG9vbENvdXJzZXNSZXBvIH0gZnJvbSBcIi4uLy4uLy4uL3JlcG9zL3NjaG9vbC1jb3Vyc2VzXCI7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi9zcGlubmVyXCI7XHJcbmltcG9ydCB7IExpbmsgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgc2hvcnREYXRlRm9ybWF0IH0gZnJvbSBcIi4uL3V0aWxzXCI7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgc2Nob29sQ291cnNlczogQ291cnNlW10gfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2Nob29sQ291cnNlcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgc2Nob29sQ291cnNlczogbnVsbFxyXG4gICAgfVxyXG4gICAgdGhpcy5vblNjaG9vbENvdXJzZXNVcGRhdGVkID0gdGhpcy5vblNjaG9vbENvdXJzZXNVcGRhdGVkLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgIG15U2Nob29sQ291cnNlc1JlcG8uc3Vic2NyaWJlKHRoaXMub25TY2hvb2xDb3Vyc2VzVXBkYXRlZCkuY2F0Y2goc2hvd0Vycm9yKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgbXlTY2hvb2xDb3Vyc2VzUmVwby51bnN1YnNjcmliZSh0aGlzLm9uU2Nob29sQ291cnNlc1VwZGF0ZWQpO1xyXG4gIH1cclxuXHJcbiAgb25TY2hvb2xDb3Vyc2VzVXBkYXRlZChzY2hvb2xDb3Vyc2VzOiBDb3Vyc2VbXSkge1xyXG4gICAgY29uc3QgY29tcGFyZU5hbWUgPSBjb21wYXJlUHJvcChcIm5hbWVcIik7XHJcbiAgICBjb25zdCBjb21wYXJlQ3JlYXRlZERhdGUgPSBjb21wYXJlUHJvcChcImNyZWF0ZWREYXRlXCIpO1xyXG4gICAgc2Nob29sQ291cnNlcy5zb3J0KChhLGIpID0+IGNvbXBhcmVOYW1lKGEsYikgfHwgY29tcGFyZUNyZWF0ZWREYXRlKGEsYikpO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7c2Nob29sQ291cnNlc30pO1xyXG4gIH1cclxuXHJcbiAgb3V0cHV0Q291cnNlcyhjb3Vyc2VzLCBoZWFkZXIsIG9wZW4pIHtcclxuICAgIHJldHVybiAoPE9wZW5DbG9zZUJveCB0aXRsZT17PHA+e2hlYWRlcn08L3A+fSBoZWFkZXJPcGVuPXtvcGVufSBjb250ZW50Q2xhc3NOYW1lPVwib2RkLWV2ZW5cIj5cclxuICAgICAge2NvdXJzZXMubWFwKGNvdXJzZSA9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInNjaG9vbENvdXJzZVwiIGtleT17Y291cnNlLmlkfT5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHB1bGwtcmlnaHRcIj5cclxuICAgICAgICAgICAgPExpbmtcclxuICAgICAgICAgICAgICB0bz17YC9jb3Vyc2VzLyR7Y291cnNlLmlkfS9lZGl0YH1cclxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJlZGl0SXRlbVwiXHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgIDxMaW5rIHRvPXtgL2NvdXJzZXMvJHtjb3Vyc2UuaWR9L2VkaXRgfT57Y291cnNlLm5hbWV9PC9MaW5rPjwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlICYmIDxkaXYgY2xhc3NOYW1lPVwicGlsbCBhY3RpdmVcIj5Ba3RpdjwvZGl2Pn1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlICYmICFjb3Vyc2UucHVibGlzaGFibGUgJiYgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwaWxsIGluY29tcGxldGVcIj5JbmtvbXBsZXR0PC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgIDxwPntjb3Vyc2UuZGVzY3JpcHRpb259PC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICB7Y291cnNlLm1vZGlmaWVkQnkgP1xyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPlJlZGlnZXJhZCBhdiB7Y291cnNlLm1vZGlmaWVkQnkubmFtZX0gLyB7c2hvcnREYXRlRm9ybWF0KGNvdXJzZS5tb2RpZmllZERhdGUpfTwvcD4gOlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiIHN0eWxlPXt7Zm9udFN0eWxlOiAnaXRhbGljJ319PiA8L3A+fVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj4pfVxyXG5cclxuICAgICAgPC9PcGVuQ2xvc2VCb3g+XHJcbiAgICApXHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7c2Nob29sQ291cnNlc30gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgIGNvbnN0IG15Q291cnNlcyA9IFtdO1xyXG4gICAgY29uc3Qgb3RoZXJzQ291cnNlcyA9IFtdO1xyXG5cclxuICAgIGlmIChzY2hvb2xDb3Vyc2VzKSB7XHJcbiAgICAgIGNvbnN0IG1lID0gZW52LmN1cnJlbnRVc2VyLm1haWw7XHJcbiAgXHJcbiAgICAgIHNjaG9vbENvdXJzZXMuZm9yRWFjaChjb3Vyc2UgPT4ge1xyXG4gICAgICAgIGlmIChjb3Vyc2UuYWN0aXZhdGVkQnkgJiYgY291cnNlLmFjdGl2YXRlZEJ5LnVybCA9PSBtZSkge1xyXG4gICAgICAgICAgbXlDb3Vyc2VzLnB1c2goY291cnNlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzLmZpbHRlcih0ID0+IHQudXJsID09IG1lKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBteUNvdXJzZXMucHVzaChjb3Vyc2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBvdGhlcnNDb3Vyc2VzLnB1c2goY291cnNlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pOyAgXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgICA8aDM+U2tvbGFucyBrdXJzZXI8L2gzPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lciBvZGQtZXZlblwiPlxyXG4gICAgICAgICAgeyFzY2hvb2xDb3Vyc2VzID9cclxuICAgICAgICAgICAgPHA+PFNwaW5uZXIgLz4gTGFkZGFyIHNrb2xhbnMga3Vyc2VyPC9wPiA6XHJcbiAgICAgICAgICAgIDw+XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICB0aGlzLm91dHB1dENvdXJzZXMobXlDb3Vyc2VzLCAnTWluYSBrdXJzZXInLCB0cnVlKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICB0aGlzLm91dHB1dENvdXJzZXMob3RoZXJzQ291cnNlcywgJ0FuZHJhIGt1cnNlcicsIGZhbHNlKVxyXG4gICAgICAgICAgICB9ICBcclxuICAgICAgICAgIDwvPn1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICB7bG9jYXRpb24uaGFzaCAhPT0gXCIjL2NvdXJzZXMvbmV3XCIgJiYgPExpbmtcclxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0blwiXHJcbiAgICAgICAgICB0bz1cIi9jb3Vyc2VzL25ld1wiXHJcbiAgICAgICAgICBvbkNsaWNrPXsoKT0+d2luZG93LnNjcm9sbCgwLCAwKX0+XHJcbiAgICAgICAgICBTa2FwYSBueSBrdXJzXHJcbiAgICAgICAgPC9MaW5rPn1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgVGFzaywgRG9jdW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gXCIuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3hcIjtcclxuaW1wb3J0IHsgYXJyYXlUb0xvb2t1cCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzIH0gZnJvbSAnLi4vY291cnNlcy9idXNpbmVzcy1sb2dpYyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIG9wdGlvbnM6IChEb2N1bWVudCAmIHtncm91cD86IHN0cmluZ30pW107XHJcbiAgdGl0bGU7XHJcbiAgbWFya01vZGU6IGJvb2xlYW47XHJcbiAgbWFya2VkSWRzOiBzdHJpbmdbXTtcclxuICBtaWdyYXRlZElkcz86IHtbaWQ6IHN0cmluZ106IGFueX07XHJcbiAgdW5jb3ZlcmVkSWRzPzoge1tpZDogc3RyaW5nXTogdHJ1ZX07XHJcbiAgb25NYXJrQ2hhbmdlZDogKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSA9PiB2b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2VsZWN0UmVsYXRlZERvY3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7fTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtvcHRpb25zLCB0aXRsZSwgbWFya2VkSWRzLCBtYXJrTW9kZSwgbWlncmF0ZWRJZHMsIHVuY292ZXJlZElkc30gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgZ3JvdXBlZE9wdGlvbnMgPSBhcnJheVRvTG9va3VwKG9wdGlvbnMsIGQgPT4gZC5ncm91cCB8fCBcImRlZmF1bHRcIik7XHJcbiAgICBjb25zdCBncm91cHMgPSBPYmplY3Qua2V5cyhncm91cGVkT3B0aW9ucyk7XHJcbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveCB0aXRsZT17PHA+e3RpdGxlfTwvcD59IGNsYXNzTmFtZT1cImxhcmdlclwiPlxyXG4gICAgICAgIHtncm91cHMubWFwKGdyb3VwID0+IDxSZWFjdC5GcmFnbWVudCBrZXk9e2dyb3VwfT5cclxuICAgICAgICAgIHtncm91cHMubGVuZ3RoID09PSAxID8gbnVsbCA6IDw+PGJyLz48aDU+e2dyb3VwfTwvaDU+PGhyLz48Lz59XHJcbiAgICAgICAgICB7Z3JvdXBlZE9wdGlvbnNbZ3JvdXBdLm1hcChvcHRpb24gPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpc01hcmtlZCA9IG1hcmtlZElkcy5zb21lKHggPT4geCA9PT0gb3B0aW9uLmlkKTtcclxuICAgICAgICAgICAgY29uc3QgaXNNaWdyYXRlZCA9IG1pZ3JhdGVkSWRzICYmICEhbWlncmF0ZWRJZHNbb3B0aW9uLmlkXTtcclxuICAgICAgICAgICAgY29uc3QgaXNVbmNvdmVyZWQgPSB1bmNvdmVyZWRJZHMgJiYgdW5jb3ZlcmVkSWRzW29wdGlvbi5pZF07XHJcbiAgICAgICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e29wdGlvbi5pZH0gb25DbGljaz17KCk9PlxyXG4gICAgICAgICAgICAgIG1hcmtNb2RlICYmIHRoaXMucHJvcHMub25NYXJrQ2hhbmdlZChvcHRpb24uaWQsICFpc01hcmtlZCl9PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIiArXHJcbiAgICAgICAgICAgICAgICAobWFya01vZGUgPyBcIiBzZWxlY3RhYmxlXCIgOiBcIlwiKSArXHJcbiAgICAgICAgICAgICAgICAoaXNNYXJrZWQgPyBcIiBtYXJrZWRHcmVlblwiIDogKGlzVW5jb3ZlcmVkID9cclxuICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XHJcbiAgICAgICAgICAgICAgICAgIFwiXCIpKSArXHJcbiAgICAgICAgICAgICAgICAoaXNNaWdyYXRlZCA/IFwiIG1pZ3JhdGVkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgIHRpdGxlPXtpc01pZ3JhdGVkID9cclxuICAgICAgICAgICAgICAgICAgbWFya01vZGUgP1xyXG4gICAgICAgICAgICAgICAgICAgIGBTa29sdmVya2V0IGhhciB1cHBkYXRlcmF0IHRleHRlbnMgZm9ybXVsZXJpbmcuIER1IGthbiBncmFuc2thIMOkbmRyaW5nZW4gZ2Vub20gYXR0IGbDpGxsYSB1dCB2YXJuaW5nc2JveGVuIHRpbGwgaMO2Z2VyLCBtZWQgdGl0ZWwgXCJVcHBkYXRlcmFkZSBmb3JtdWxlcmluZ2FyIGZyw6VuIFNrb2x2ZXJrZXRcImAgOlxyXG4gICAgICAgICAgICAgICAgICAgIGBTa29sdmVya2V0IGhhciB1cHBkYXRlcmF0IHRleHRlbnMgZm9ybXVsZXJpbmcsIG1lbiBkZXR0YSBoYXIgw6RubnUgaW50ZSBncmFuc2thdHMgYXYgdXBwZ2lmdGVucyByZWRpZ2VyaW5nc2JlaMO2cmlnZWAgOlxyXG4gICAgICAgICAgICAgICAgICB1bmRlZmluZWR9PlxyXG4gICAgICAgICAgICAgICAgPHAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IG9wdGlvbi5uYW1lfX0gLz5cclxuICAgICAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj47XHJcbiAgICAgICAgICB9KX1cclxuICAgICAgICA8L1JlYWN0LkZyYWdtZW50Pil9XHJcbiAgICA8L09wZW5DbG9zZUJveD5cclxuICB9XHJcbn0iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgU2VsZWN0IGZyb20gJ3JlYWN0LXNlbGVjdCc7XHJcbmltcG9ydCB7IGVudiB9IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9kYic7XHJcbmltcG9ydCB7IG1vY2tUdWl0aW9uR3JvdXBzIH0gZnJvbSAnLi4vLi4vLi4vYXBpcy9tb2NrL21vY2stY2xhc3Nyb29tLWRhdGEnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBzY2hvb2w6IHN0cmluZ1xyXG4gIGNvdXJzZUNvZGU6IHN0cmluZ1xyXG4gIHNlbGVjdGVkU3R1ZHlHcm91cHM6IHN0cmluZ1tdXHJcbiAgb25VcGRhdGU6IChzdHVkeUdyb3Vwczogc3RyaW5nW10pID0+IHZvaWRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIFNlbGVjdFN0dWR5R3JvdXBzICh7c2Nob29sLCBjb3Vyc2VDb2RlLCBzZWxlY3RlZFN0dWR5R3JvdXBzLCBvblVwZGF0ZX06IFByb3BzKSB7XHJcblxyXG4gIC8vIE1vY2stZGF0YSBmb3IgS0VEXHJcbiAgY29uc3QgZW1wdHlPck1vY2sgPSBzY2hvb2wgPT09ICdLRUQnICYmIG1vY2tUdWl0aW9uR3JvdXBzW2NvdXJzZUNvZGVdPyBtb2NrVHVpdGlvbkdyb3Vwc1tjb3Vyc2VDb2RlXSA6IFtdO1xyXG5cclxuXHJcbiAgLy8gTWFwIGdpdmVuIHtzY2hvb2x9IHRvIGl0cyBuYW1lIGluIEVEUzpcclxuICBjb25zdCB7ZWRzU2Nob29sTmFtZUd5bW59ID0gZGIuc2Nob29sc1xyXG4gICAgLmNhY2hlT3B0aW1pemVkKCkgLy8gV2lsbCBhZGQgY2FjaGVCdXN0IHRvIHRoZSBxdWVyeSAobWFraW5nIHNlcnZlciBhZGQgY2FjaGUgaGVhZGVyKVxyXG4gICAgLm5hbWUoc2Nob29sKS5zaW5nbGUoKSAvLyBHZXQgdGhlIHNpbmdsZSBzY2hvb2wgaW5zdGFuY2Ugd2l0aCBuYW1lPXtzY2hvb2x9XHJcbiAgICAucmVhZCgpOyAvLyBSZWFkIGl0IHRoZSBzdXNwZW5zZS13YXkgKHRocm93aW5nIFByb21pc2UgaWYgbm90IHRoZXJlLi4uKVxyXG5cclxuICAvLyBMaXN0IHN0dWR5Z3JvdXBzIGZvciB0aGF0IHNjaG9vbCBhbmQgZ2l2ZW4gY291cnNlOlxyXG4gIGNvbnN0IHN0dWR5R3JvdXBzID0gZWRzU2Nob29sTmFtZUd5bW4/IGVudi5lZHNDbGllbnQuc3VzcGVuc2UuZ2V0U2Nob29sVHVpdGlvbkdyb3Vwcyh7XHJcbiAgICBzY2hvb2xOYW1lOiBlZHNTY2hvb2xOYW1lR3ltbixcclxuICAgIGNvdXJzZUNvZGVcclxuICB9KSA6IGVtcHR5T3JNb2NrO1xyXG5cclxuICAvLyBDb252ZXJ0IHRvIG9wdGlvbiBvYmplY3RzIGFzIHJlYWN0LXNlbGVjdCB3YW50cyB0aGVtOlxyXG4gIGNvbnN0IG9wdGlvbnMgPSBzdHVkeUdyb3Vwcy5tYXAoc2cgPT4gKHtcclxuICAgIGxhYmVsOiBzZy50dWl0aW9uR3JvdXBOYW1lLFxyXG4gICAgdmFsdWU6IHNnLnR1aXRpb25Hcm91cE5hbWVcclxuICB9KSk7XHJcblxyXG4gIC8vIERpc3BsYXkgdGhlIG11dGxpc2VsZWN0OlxyXG4gIHJldHVybiA8U2VsZWN0XHJcbiAgICAgIGlzTXVsdGk9e3RydWV9XHJcbiAgICAgIG9wdGlvbnM9e29wdGlvbnN9XHJcbiAgICAgIHZhbHVlPXtzZWxlY3RlZFN0dWR5R3JvdXBzLm1hcChncm91cCA9PiAoe2xhYmVsOiBncm91cCwgdmFsdWU6IGdyb3VwfSkpfVxyXG4gICAgICBwbGFjZWhvbGRlcj17TGBLb3BwbGEgc3R1ZGllZ3J1cHBlciB0aWxsIGt1cnNlbi4uLmB9XHJcbiAgICAgIG5vT3B0aW9uc01lc3NhZ2U9eygpPT5MYEt1bmRlIGludGUgaGl0dGEgc3R1ZGllZ3J1cHBlciBmw7ZyIGRlbm5hIGt1cnNgfVxyXG4gICAgICBvbkNoYW5nZT17KG9wdGlvbnM6IEFycmF5PHtsYWJlbDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nfT4pID0+IHtcclxuICAgICAgICBvblVwZGF0ZShvcHRpb25zLm1hcCgoe3ZhbHVlfSkgPT4gdmFsdWUpKTtcclxuICAgICAgfX0gLz5cclxufVxyXG4iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBTb2Z0RG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGRiIH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9kYic7XHJcbmltcG9ydCB7IEVEU1RlYWNoZXIgfSBmcm9tICcuLi8uLi8uLi9jb250cmFjdHMvZWRzJztcclxuaW1wb3J0IHsgZW52IH0gZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgYXJyYXlUb0xvb2t1cCwgY29tcGFyZVByb3BzLCBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBjZmcgfSBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5pbXBvcnQgU2VsZWN0IGZyb20gJ3JlYWN0LXNlbGVjdCc7XHJcbmltcG9ydCB7IGlzQWRtaW5PclRlYWNoZXJBdFNjaG9vbCB9IGZyb20gJy4uLy4uLy4uL2FjY2Vzcy1jb250cm9sJztcclxuaW1wb3J0IHsgbW9ja1RlYWNoZXJzIH0gZnJvbSAnLi4vLi4vLi4vYXBpcy9tb2NrL21vY2stY2xhc3Nyb29tLWRhdGEnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBzY2hvb2w6IHN0cmluZztcclxuICBzZWxlY3RlZFRlYWNoZXJzOiBTb2Z0RG9jdW1lbnRBY2Nlc3NbXTtcclxuICBvbkJsdXI6ICgpPT52b2lkO1xyXG4gIG9uU2VsZWN0OiAodGVhY2hlcjoge25hbWU6IHN0cmluZywgZW1haWw6IHN0cmluZ30pID0+IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBTZWxlY3RUZWFjaGVyICh7c2Nob29sLCBzZWxlY3RlZFRlYWNoZXJzLCBvblNlbGVjdCwgb25CbHVyfTogUHJvcHMpIHtcclxuICAvL1xyXG4gIC8vIExvYWQgdGhlIHRlYWNoZXIgbGlzdCBhc3luY2hyb25pY2FsbHkgKHVzaW5nIHN1c3BlbnNlKVxyXG4gIC8vXHJcblxyXG4gIC8vIE1vY2stZGF0YSBmb3IgS0VEXHJcbiAgY29uc3QgZW1wdHlPck1vY2sgPSBzY2hvb2wgPT09ICdLRUQnID8gbW9ja1RlYWNoZXJzIDogW107XHJcblxyXG4gIC8vIFN1c3BlbnNlLXJlYWQgZnJvbSBLZWRCYWNrZW5kOlxyXG4gIGNvbnN0IHtlZHNTY2hvb2xOYW1lR3ltbn0gPSBkYi5zY2hvb2xzLmNhY2hlT3B0aW1pemVkKCkubmFtZShzY2hvb2wpLnNpbmdsZSgpLnJlYWQoKTtcclxuICBcclxuICAvLyBTdXNwZW5zZS1yZWFkIGZyb20gRURTOlxyXG4gIGNvbnN0IGVkc1RlYWNoZXJzOiBFRFNUZWFjaGVyW10gPSBlZHNTY2hvb2xOYW1lR3ltbiA/XHJcbiAgICBlbnYuZWRzQ2xpZW50LnN1c3BlbnNlLmdldFNjaG9vbFRlYWNoZXJzKHtzY2hvb2xOYW1lOiBlZHNTY2hvb2xOYW1lR3ltbn0pIDpcclxuICAgIGVtcHR5T3JNb2NrO1xyXG5cclxuICBsZXQgdGVhY2hlckxpc3QgPSBlZHNUZWFjaGVycy5tYXAoKHt0ZWFjaGVyRmlyc3ROYW1lLCB0ZWFjaGVyTGFzdE5hbWUsIHRlYWNoZXJFbWFpbEFkZHJlc3N9KSA9PiAoe1xyXG4gICAgbGFiZWw6IGAke3RlYWNoZXJGaXJzdE5hbWV9ICR7dGVhY2hlckxhc3ROYW1lfWAsXHJcbiAgICB2YWx1ZTogdGVhY2hlckVtYWlsQWRkcmVzc1xyXG4gIH0pKTtcclxuXHJcbiAgLy8gQWRkIGN1cnJlbnQgdXNlciB0byB0aGUgbGlzdCAoaW4gY2FzZSBjdXJyZW50IHVzZXIgaXMgQURNSU4gb3IgRU1QTE9ZRUUgYXQgdGhlIHNjaG9vbClcclxuICBjb25zdCBhZGRDdXJyZW50VXNlciA9IGlzQWRtaW5PclRlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIHNjaG9vbCk7XHJcbiAgaWYgKGFkZEN1cnJlbnRVc2VyICYmICF0ZWFjaGVyTGlzdC5zb21lKHQgPT4gdC52YWx1ZSA9PT0gZW52LmN1cnJlbnRVc2VyLm1haWwpKSB7XHJcbiAgICB0ZWFjaGVyTGlzdC5wdXNoKHtsYWJlbDogZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lLCB2YWx1ZTogZW52LmN1cnJlbnRVc2VyLm1haWx9KTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRmlsdGVyIG91dCBhbHJlYWR5IHNlbGVjdGVkIHRlYWNoZXJzOlxyXG4gIGNvbnN0IHRlYWNoZXJTZXQgPSBhcnJheVRvTG9va3VwKHNlbGVjdGVkVGVhY2hlcnMsIHQgPT4gdC5lbWFpbCk7XHJcbiAgdGVhY2hlckxpc3QgPSB0ZWFjaGVyTGlzdFxyXG4gICAgLmZpbHRlcih0ID0+ICF0ZWFjaGVyU2V0W3QudmFsdWVdKSAvLyBSZW1vdmUgYWxyZWFkeSBhZGRlZCBvbmVzXHJcbiAgICAuc29ydChjb21wYXJlUHJvcHMoW1wibGFiZWxcIl0sIGNmZy5LRURfTE9DQUxFKSk7IC8vIFNvcnQgYnkgbmFtZVxyXG5cclxuICAvLyBTaG93IHRoZSBzZWxlY3Q6XHJcbiAgcmV0dXJuIDxTZWxlY3RcclxuICAgIGlzTXVsdGk9e2ZhbHNlfVxyXG4gICAgb3B0aW9ucz17dGVhY2hlckxpc3R9XHJcbiAgICBkZWZhdWx0TWVudUlzT3Blbj17dHJ1ZX1cclxuICAgIGF1dG9Gb2N1cz17dHJ1ZX1cclxuICAgIG9uQmx1cj17KCk9Pm9uQmx1cigpfVxyXG4gICAgcGxhY2Vob2xkZXI9e0xgVsOkbGogYmxhbmQgc2tvbGFucyBsw6RyYXJlLi4uYH1cclxuICAgIG5vT3B0aW9uc01lc3NhZ2U9eygpPT5MYERldCBmaW5ucyBpbmdhIGZsZXIgbMOkcmFyZSBhdHQgdsOkbGphIGZyw6VuYH1cclxuICAgIG9uQ2hhbmdlPXtvcHRpb24gPT4ge1xyXG4gICAgICBjb25zdCB7bGFiZWwsIHZhbHVlfSA9IG9wdGlvbiBhcyBhbnk7XHJcbiAgICAgIG9uU2VsZWN0KHtuYW1lOiBsYWJlbCwgZW1haWw6IHZhbHVlfSk7XHJcbiAgICB9fSAvPlxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuXHJcbmV4cG9ydCBjb25zdCBTcGlubmVyID0gKCk9PiA8c3Bhbj48aSBjbGFzc05hbWU9XCJmYSBmYS1zcGlubmVyIGZhLXNwaW5cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+Jm5ic3A7PC9zcGFuPjtcclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGdldFRhc2tzUGVySWQgfSBmcm9tIFwiLi4vY291cnNlcy9idXNpbmVzcy1sb2dpY1wiO1xyXG5pbXBvcnQgeyBmdXR1cmVBYmlsaXRpZXMgfSBmcm9tIFwiLi4vLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcclxuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSBcIi4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveFwiO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBpc09wZW46IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBXZWlnaHRlZEl0ZW1zVGFibGUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGlzT3BlbjogZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHsgaXNPcGVuIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3Qgcm93cyA9IFtdO1xyXG4gICAgY29uc3QgdGFza3NQZXJJZCA9IGdldFRhc2tzUGVySWQoY291cnNlKTtcclxuXHJcbiAgICByb3dzLnB1c2goPHRyIGtleT1cImNlbnRyYWxDb250ZW50XCIgY2xhc3NOYW1lPVwiY292ZXJlZC1pdGVtLWxhYmVsXCI+PHRkIGNvbFNwYW49ezJ9PkNlbnRyYWx0IGlubmVow6VsbDwvdGQ+PC90cj4pO1xyXG4gICAgY291cnNlLmNlbnRyYWxDb250ZW50LmZvckVhY2goKGNjLGlkeCkgPT4gcm93cy5wdXNoKDx0ciBrZXk9e2NjLmlkfSBjbGFzc05hbWU9e2lkeCAlIDIgPyBcInRhYmxlT2RkXCIgOiBcIlwifT5cclxuICAgICAgPHRkPjxwIGNsYXNzTmFtZT1cImNyaXRlcmlhVGV4dFwiIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjYy5uYW1lfX0vPjwvdGQ+XHJcbiAgICAgIDx0ZD48cD57KHRhc2tzUGVySWRbY2MuaWRdIHx8IFtdKS5sZW5ndGh9PC9wPjwvdGQ+XHJcbiAgICA8L3RyPikpO1xyXG5cclxuICAgIHJvd3MucHVzaCg8dHIga2V5PVwiYWJpbGl0aWVzXCIgY2xhc3NOYW1lPVwiY292ZXJlZC1pdGVtLWxhYmVsXCI+PHRkIGNvbFNwYW49ezJ9PkbDtnJtw6Vnb3I8L3RkPjwvdHI+KTtcclxuICAgIGNvdXJzZS5hYmlsaXRpZXMuZm9yRWFjaCgoYWJpbGl0eSxpZHgpID0+IHJvd3MucHVzaCg8dHIga2V5PXthYmlsaXR5LmlkfSBjbGFzc05hbWU9e2lkeCAlIDIgPyBcInRhYmxlT2RkXCIgOiBcIlwifT5cclxuICAgICAgPHRkPjxwIGNsYXNzTmFtZT1cImFiaWxpdHlUZXh0XCIgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGFiaWxpdHkubmFtZX19Lz48L3RkPlxyXG4gICAgICA8dGQ+PHA+eyh0YXNrc1BlcklkW2FiaWxpdHkuaWRdIHx8IFtdKS5sZW5ndGh9PC9wPjwvdGQ+XHJcbiAgICA8L3RyPikpO1xyXG5cclxuICAgIHJvd3MucHVzaCg8dHIga2V5PVwiZnV0dXJlQWJpbGl0aWVzXCIgY2xhc3NOYW1lPVwiY292ZXJlZC1pdGVtLWxhYmVsXCI+PHRkIGNvbFNwYW49ezJ9PkZyYW10aWRzZsO2cm3DpWdvcjwvdGQ+PC90cj4pO1xyXG4gICAgIGZ1dHVyZUFiaWxpdGllcy5mb3JFYWNoKChmdXR1cmVBYmlsaXR5VGV4dCwgaWR4KSA9PiByb3dzLnB1c2goPHRyIGtleT17ZnV0dXJlQWJpbGl0eVRleHR9IGNsYXNzTmFtZT17aWR4ICUgMiA/IFwidGFibGVPZGRcIiA6IFwiXCJ9PlxyXG4gICAgICA8dGQ+PHAgY2xhc3NOYW1lPVwiYWJpbGl0eVRleHRcIj57ZnV0dXJlQWJpbGl0eVRleHR9PC9wPjwvdGQ+XHJcbiAgICAgIDx0ZD48cD57KHRhc2tzUGVySWRbZnV0dXJlQWJpbGl0eVRleHRdIHx8IFtdKS5sZW5ndGh9PC9wPjwvdGQ+XHJcbiAgICA8L3RyPikpO1xyXG5cclxuICAgIHJldHVybiA8T3BlbkNsb3NlQm94XHJcbiAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiXHJcbiAgICAgIHRpdGxlPXs8cD5LdXJzZW5zIHTDpGNrbmluZ3N0YWJlbGw8L3A+fVxyXG4gICAgICBjb250ZW50Q2xhc3NOYW1lPVwid2VpZ2h0ZWQtaXRlbXMtdGFibGVcIj5cclxuICAgICAgICA8cD5UYWJlbGxlbiBhbmdlciBodXIgbcOlbmdhIHVwcGdpZnRlciBzb20gYmVyw7ZyIHZhcmplIGRlbC48L3A+XHJcbiAgICAgICAgPHRhYmxlPjx0Ym9keT57cm93c308L3Rib2R5PjwvdGFibGU+XHJcbiAgICA8L09wZW5DbG9zZUJveD5cclxuICB9XHJcbn0iLCJpbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFN1YmplY3QsIENvdXJzZSwgQWJpbGl0eSwgS25vd2xlZGdlUmVxdWlyZW1lbnQsIENlbnRyYWxDb250ZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBTdWJqZWN0VG9JbXBvcnQgfSBmcm9tICcuLi9zdWJqZWN0LXRvLWltcG9ydCc7XHJcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gJy4vY2hhbmdlJztcclxuaW1wb3J0IHsgbWlncmF0ZU9yZGVyTGlzdHNPZkNvdXJzZUluc3RhbmNlcywgbWlncmF0ZUFiaWxpdGllc09yZGVyT25TdWJqZWN0IH0gZnJvbSAnLi9taWdyYXRpb25zJztcclxuaW1wb3J0IHsgbWlncmF0ZVN1YmplY3QgfSBmcm9tICcuL21pZ3JhdGUtc3ViamVjdCc7XHJcbmltcG9ydCB7IGxvYWRDb3Vyc2UgfSBmcm9tICcuLi8uLi91dGlscyc7XHJcbmltcG9ydCB7IENvdXJzZVNldCB9IGZyb20gJy4vY291cnNlLXNldCc7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGlmZlhtbFdpdGhEYXRhYmFzZShleGlzdGluZ1N1YmplY3Q6IFN1YmplY3QsIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0LCBjaGFuZ2VzOiBDaGFuZ2VbXSkge1xyXG4gIC8vIEV4cGFuZCBncmFwaHMgb2YgZXhpc3RpbmcgU3ViamVjdFxyXG4gIGV4aXN0aW5nU3ViamVjdCA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmdldCgnc3ViamVjdHMnLCBleGlzdGluZ1N1YmplY3QuaWQsIHsgaW5jbHVkZTogW1wiY291cnNlVGVtcGxhdGVzXCIsIFwiYWJpbGl0aWVzXCJdIH0pO1xyXG4gIC8vIExhemlseSBsb2FkIGFsbCBjZW50cmFsIGNvbnRlbnRzIGFuZCBrbm93bGVkZ2VSZXF1aXJlbWVudHMgb25cclxuICAvLyBlYWNoIGNvdXJzZSB0ZW1wbGF0ZVxyXG4gIGNvbnN0IGV4cGFuZGVkQ291cnNlVGVtcGxhdGVzID0gYXdhaXQgUHJvbWlzZS5hbGwoZXhpc3RpbmdTdWJqZWN0LmNvdXJzZVRlbXBsYXRlcy5tYXAoY3QgPT4gbG9hZENvdXJzZShjdC5pZCwge1xyXG4gICAgaW5jbHVkZTogW1xyXG4gICAgICAnY2VudHJhbENvbnRlbnQnLFxyXG4gICAgICAna25vd2xlZGdlUmVxdWlyZW1lbnRzJ1xyXG4gICAgXVxyXG4gIH0pKSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGBTdWJqZWN0OiAke2V4aXN0aW5nU3ViamVjdC5uYW1lfS4gQ291cnNlczogJHtleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5tYXAoKHtuYW1lfSkgPT4gbmFtZSl9YCk7XHJcblxyXG4gIGNvbnN0IGNvdXJzZVNldHM6IENvdXJzZVNldFtdID0gYXdhaXQgUHJvbWlzZS5hbGwoZXhwYW5kZWRDb3Vyc2VUZW1wbGF0ZXMubWFwIChhc3luYyBjb3Vyc2VUZW1wbGF0ZSA9PiAoe1xyXG4gICAgdGVtcGxhdGU6IGNvdXJzZVRlbXBsYXRlLFxyXG4gICAgaW5zdGFuY2VzOiBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PENvdXJzZT4oXCJjb3Vyc2VzXCIsIHsgbmFtZTogY291cnNlVGVtcGxhdGUubmFtZSwgaW5jbHVkZTogWydhYmlsaXRpZXMnXSwgZmxhZ3M6IFsnaW5jbHVkZUlkc09ubHknXSB9KVxyXG4gIH0pKSk7XHJcblxyXG4gIC8qaWYgKGV4cGFuZGVkQ291cnNlVGVtcGxhdGVzLnNvbWUgKGNvdXJzZSA9PiAhY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIgfHwgIWNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlciB8fCAhY291cnNlLmFiaWxpdGllc09yZGVyKSkge1xyXG4gICAgbWlncmF0ZU9yZGVyTGlzdHNPZkNvdXJzZUluc3RhbmNlcyhjb3Vyc2VTZXRzLCBzdWJqZWN0VG9JbXBvcnQsIGNoYW5nZXMpO1xyXG4gICAgLy8gSW4gZnV0dXJlLCBhcyBhYmlsaXRpZXMgbWF5IGJlIGFkZGVkIG9yIHJlbW92ZWQsIHdlIHdpbGwgaGF2ZSB0byBtYWludGFpbiB0aGUgb3JkZXIgb2YgYWJpbGl0aWVzIG9uIHRoZSBjb3Vyc2UgaW5zdGFuY2VzLFxyXG4gICAgLy8gdGhlIHNhbWUgd2F5IHdlIGRvIGl0IHdpdGggY2VudHJhbCBjb250ZW50IGFuZCBrbm93bGVkZ2UgcmVxdWlyZW1lbnRzLiBUT0RPIHJlc3BlY3QgYWJpbGl0aWVzIG9yZGVyIG9uIGV2ZXJ5IHBsYWNlIGFiaWxpdGllcyBhcmUgZW51bWVyYXRlZCxcclxuICAgIC8vIHN1Y2ggYXMgb24gY291cnNlIHZpZXdlciwgY291cnNlIGJ1aWxkZXIsIGV0Yy5cclxuICAgIG1pZ3JhdGVBYmlsaXRpZXNPcmRlck9uU3ViamVjdChleGlzdGluZ1N1YmplY3QsIGNvdXJzZVNldHMsIGNoYW5nZXMpO1xyXG4gIH0gZWxzZSB7Ki9cclxuICAgIGF3YWl0IG1pZ3JhdGVTdWJqZWN0KGV4aXN0aW5nU3ViamVjdCwgY291cnNlU2V0cywgc3ViamVjdFRvSW1wb3J0LCBjaGFuZ2VzKTtcclxuICAvL31cclxufVxyXG5cclxuIiwiaW1wb3J0IHsgU3ViamVjdCwgQ291cnNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQWJpbGl0eSwgQ2VudHJhbENvbnRlbnQsIFRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcclxuaW1wb3J0IHsgU3ViamVjdFRvSW1wb3J0LCBDb3Vyc2VUb0ltcG9ydCB9IGZyb20gXCIuLi9zdWJqZWN0LXRvLWltcG9ydFwiO1xyXG5pbXBvcnQgeyBDaGFuZ2UgfSBmcm9tIFwiLi9jaGFuZ2VcIjtcclxuaW1wb3J0IHsgQ291cnNlU2V0IH0gZnJvbSAnLi9jb3Vyc2Utc2V0JztcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCwgQmF0Y2hSdW5uZXIsIE11dGF0aW9uUmVxdWVzdCwgTGlzdE9wdGlvbnMgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IEF1dG9WYWx1ZU1hcCB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL2F1dG8tdmFsdWUtbWFwJztcclxuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5cclxudHlwZSBJRCA9IHN0cmluZztcclxuXHJcbmZ1bmN0aW9uIGRpZmZTdWJqZWN0R2xvYmFsVGV4dHMoZGJUZXh0TWFwOiBNYXA8c3RyaW5nLCBJRD4sIHhtbFRleHRzOiBzdHJpbmdbXSkge1xyXG4gIGNvbnN0IHJlbW92ZWRJZHMgPSBuZXcgU2V0PElEPigpO1xyXG4gIGNvbnN0IG5ld1RleHRzID0gbmV3IE1hcDxzdHJpbmcsIElEPigpO1xyXG4gIGNvbnN0IGlkc1RvQWRkID0gbmV3IFNldDxJRD4oKTtcclxuXHJcbiAgeG1sVGV4dHMuZm9yRWFjaChuZXdUZXh0ID0+IHtcclxuICAgIG5ld1RleHQgPSBuZXdUZXh0LnRyaW0oKTtcclxuICAgIGlmICghZGJUZXh0TWFwLmhhcyhuZXdUZXh0KSkge1xyXG4gICAgICBjb25zdCBpZCA9IGNyZWF0ZVVVSUQoKTtcclxuICAgICAgY29uc29sZS5sb2coYE5ldyBpZDogJHtpZH0uIFRleHQ6ICR7bmV3VGV4dH1gKTtcclxuICAgICAgbmV3VGV4dHMuc2V0KG5ld1RleHQsIGlkKTtcclxuICAgICAgaWRzVG9BZGQuYWRkKGlkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG5ld1RleHRzLnNldChuZXdUZXh0LCBkYlRleHRNYXAuZ2V0KG5ld1RleHQpKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgZm9yIChjb25zdCBbb2xkVGV4dCwgb2xkSWRdIG9mIGRiVGV4dE1hcC5lbnRyaWVzKCkpIHtcclxuICAgIGlmICh4bWxUZXh0cy5pbmRleE9mKG9sZFRleHQpID09PSAtMSkge1xyXG4gICAgICByZW1vdmVkSWRzLmFkZChvbGRJZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgcmVtb3ZlZElkcyxcclxuICAgIG5ld1RleHRzLFxyXG4gICAgaWRzVG9BZGRcclxuICB9XHJcbn1cclxuXHJcbmxldCBfZmljdGl2ZU9sZElkID0gMTtcclxuZnVuY3Rpb24gZmljdGl2ZU9sZElkKCkge1xyXG4gIHJldHVybiBcImZpY3RpdmVPbGRJZFwiICsgKCsrX2ZpY3RpdmVPbGRJZCk7XHJcbn1cclxuXHJcbmNvbnN0IHN0b3BXb3JkcyA9IG5ldyBTZXQoXHJcbiAgLy8gRnJvbSBodHRwczovL2dpdGh1Yi5jb20vTWloYWlWYWxlbnRpbi9sdW5yLWxhbmd1YWdlcy9ibG9iL21hc3Rlci9sdW5yLnN2LmpzI0wyNTJcclxuICAoJ2FsbGEgYWxsdCBhdHQgYXYgYmxldiBibGkgYmxpciBibGl2aXQgZGUgZGVtIGRlbiBkZW5uYSBkZXJhcyBkZXNzIGRlc3NhIGRldCBkZXR0YSBkaWcgZGluIGRpbmEgZGl0dCBkdSBkw6RyIGTDpSBlZnRlciBlaiBlbGxlciBlbiBlciBlcmEgZXJ0IGV0dCBmcsOlbiBmw7ZyIGhhIGhhZGUgaGFuIGhhbnMgaGFyIGhlbm5lIGhlbm5lcyBob24gaG9ub20gaHVyIGjDpHIgaSBpY2tlIGluZ2VuIGlub20gaW50ZSBqYWcganUga2FuIGt1bmRlIG1hbiBtZWQgbWVsbGFuIG1lbiBtaWcgbWluIG1pbmEgbWl0dCBtb3QgbXlja2V0IG5pIG51IG7DpHIgbsOlZ29uIG7DpWdvdCBuw6VncmEgb2NoIG9tIG9zcyBww6Ugc2FtbWEgc2VkYW4gc2lnIHNpbiBzaW5hIHNpdHRhIHNqw6RsdiBza3VsbGUgc29tIHPDpSBzw6VkYW4gc8OlZGFuYSBzw6VkYW50IHRpbGwgdW5kZXIgdXBwIHV0IHV0YW4gdmFkIHZhciB2YXJhIHZhcmbDtnIgdmFyaXQgdmFyamUgdmFycyB2YXJ0IHZlbSB2aSB2aWQgdmlsa2Egdmlsa2FzIHZpbGtlbiB2aWxrZXQgdsOlciB2w6VyYSB2w6VydCDDpG4gw6RyIMOldCDDtnZlcicgK1xyXG4gICcga3JpbmcnKSAvLyBUaGlzIGxpbmUgY29udGFpbnMgYWRkaXRpb25hbCBzdG9wLXdvcmRzIG1pc3NpbmcgaW4gbHVuci5zdi5cclxuICAuc3BsaXQoJyAnKSk7XHJcblxyXG5mdW5jdGlvbiBnZXRMZXhlbWVzKGh0bWw6IHN0cmluZyk6IFNldDxzdHJpbmc+IHtcclxuICByZXR1cm4gbmV3IFNldChyZW1vdmVUYWdzKGh0bWwpLnJlcGxhY2UoL1teXFx3XFxzw6XDpMO2XS9naSwgJycpLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccy8pXHJcbiAgICAubWFwKGxleGVtZSA9PiBsZXhlbWUudHJpbSgpKVxyXG4gICAgLmZpbHRlcihsZXhlbWUgPT4gISFsZXhlbWUpXHJcbiAgICAuZmlsdGVyKGxleGVtZSA9PiAhc3RvcFdvcmRzLmhhcyhsZXhlbWUpKVxyXG4gICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZVRhZ3MoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcclxuICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBkaXYuaW5uZXJIVE1MID0gaHRtbDtcclxuICByZXR1cm4gJycrZGl2LmlubmVyVGV4dDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0SWRzVG9NaWdyYXRlKFxyXG4gIGRiVGV4dHM6IHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ31bXSxcclxuICB4bWxUZXh0czoge2h0bWw6IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfVtdLFxyXG4gIG5ld1RleHRzOiBNYXA8c3RyaW5nLCBJRD4sXHJcbiAgdGV4dFR5cGU6IHN0cmluZyxcclxuICBjb3Vyc2U/OiBzdHJpbmcpIDogTWFwPElELCB7XHJcbiAgICBuZXdUZXh0Pzogc3RyaW5nLFxyXG4gICAgbmV3SWQ/OiBJRCxcclxuICAgIG9sZFRleHQ/OiBzdHJpbmcsXHJcbiAgICBncmFkZVN0ZXA/OiBzdHJpbmcsXHJcbiAgICBpc1R5cG9GaXg/OiBib29sZWFuXHJcbiAgfT5cclxue1xyXG4gIGNvbnN0IGlkc1RvTWlncmF0ZSA9IG5ldyBNYXA8SUQsIHtcclxuICAgIG5ld1RleHQ/OiBzdHJpbmcsXHJcbiAgICBuZXdJZD86IElELFxyXG4gICAgb2xkVGV4dD86IHN0cmluZyxcclxuICAgIGdyYWRlU3RlcD86IHN0cmluZyxcclxuICAgIGlzVHlwb0ZpeD86IGJvb2xlYW4sXHJcbiAgICBtYXRjaExldmVsOiBudW1iZXIsXHJcbiAgICBsZXhlbWVzOiBTZXQ8c3RyaW5nPlxyXG4gIH0+KCk7XHJcbiAgZGJUZXh0cyA9IGRiVGV4dHMubWFwKGVudGl0eSA9PiAoey4uLmVudGl0eSwgbmFtZTogZW50aXR5Lm5hbWUudHJpbSgpfSkpLmZpbHRlcigoe25hbWV9KSA9PiAhIW5hbWUpO1xyXG4gIGNvbnN0IHhtbFNldCA9IG5ldyBNYXA8c3RyaW5nLCB7aHRtbDogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9PigpO1xyXG4gIHhtbFRleHRzLmZvckVhY2goaXRlbSA9PiB4bWxTZXQuc2V0KGl0ZW0uaHRtbCwgaXRlbSkpO1xyXG4gIGNvbnN0IGRiU2V0ID0gbmV3IE1hcDxzdHJpbmcsIHtpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ30+KCk7XHJcbiAgZGJUZXh0cy5mb3JFYWNoKGVudGl0eSA9PiBkYlNldC5zZXQoZW50aXR5Lm5hbWUsIGVudGl0eSkpO1xyXG4gIC8vIFJlbW92ZSB0aG9zZSB3aG8gYWxyZWFkeSBleGlzdHMgaWRlbnRpY2FsbHlcclxuICBkYlRleHRzID0gZGJUZXh0cy5maWx0ZXIoZW50aXR5ID0+ICF4bWxTZXQuaGFzKGVudGl0eS5uYW1lKSk7XHJcbiAgeG1sVGV4dHMgPSB4bWxUZXh0cy5maWx0ZXIoaXRlbSA9PiAhZGJTZXQuaGFzKGl0ZW0uaHRtbCkpO1xyXG5cclxuICAvLyBOb3csIGZvciB0aGUgcmVtYWluZGVyLCB0cnkgdGhlIGJlc3QgdG8gbWFwIG9sZCB0ZXh0cyB0byBuZXcgdGV4dHMsIGFuZCB3aGVuIGRvbmUsIGNoZWNrIGlmIHRoZXJlIGFyZSBuZXcgdGV4dHMgdGhhdCBuZXZlciBnb3QgbWFwcGVkLlxyXG5cclxuICAvLyBTdGFydCBieSBwdXR0aW5nIGFsbCBkYlRleHQgaW50byB0aGUgcmVzdWx0LCB3aXRob3V0IGEgcGFpcmVkIHhtbCB0ZXh0IHlldDpcclxuICBkYlRleHRzLmZvckVhY2goZGJUZXh0ID0+IGlkc1RvTWlncmF0ZS5zZXQoZGJUZXh0LmlkLCB7XHJcbiAgICBncmFkZVN0ZXA6IGRiVGV4dC5ncmFkZVN0ZXAsXHJcbiAgICBvbGRUZXh0OiBkYlRleHQubmFtZSxcclxuICAgIGxleGVtZXM6IGdldExleGVtZXMoZGJUZXh0Lm5hbWUpLFxyXG4gICAgbWF0Y2hMZXZlbDogMFxyXG4gIH0pKTtcclxuICAvLyBUaGVuIHRyeSB0byBwYWlyIGVhY2ggeG1sVGV4dCB0byBhbiBpdGVtIGluIGlkc1RvTWlncmF0ZVxyXG4gIGNvbnN0IHhtbFNwaW5zdGVyczoge2h0bWw6IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfVtdID0gW107XHJcbiAgd2hpbGUgKHhtbFRleHRzLmxlbmd0aCA+IDApIHtcclxuICAgIGNvbnN0IHhtbFRleHQgPSB4bWxUZXh0c1swXTtcclxuICAgIGNvbnN0IGJlc3RNYXRjaCA9IGZpbmRCZXN0TWF0Y2goeG1sVGV4dCk7XHJcbiAgICBpZiAoIWJlc3RNYXRjaCkge1xyXG4gICAgICB4bWxTcGluc3RlcnMucHVzaCh4bWxUZXh0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChiZXN0TWF0Y2gubmV3VGV4dCkge1xyXG4gICAgICAgIC8vIFRocm93IG91dCBleGlzdGluZyBtYXRjaFxyXG4gICAgICAgIHhtbFRleHRzLnB1c2goe2h0bWw6IGJlc3RNYXRjaC5uZXdUZXh0LCBncmFkZVN0ZXA6IGJlc3RNYXRjaC5ncmFkZVN0ZXB9KTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBwYWlyID0gaWRzVG9NaWdyYXRlLmdldChiZXN0TWF0Y2guaWQpO1xyXG4gICAgICAvLyBQYWlyIG15c2VsZiB3aXRoIHRoaXMgbWF0Y2g6XHJcbiAgICAgIHBhaXIubmV3VGV4dCA9IHhtbFRleHQuaHRtbDtcclxuICAgICAgcGFpci5tYXRjaExldmVsID0gYmVzdE1hdGNoLm15TWF0Y2hMZXZlbDtcclxuICAgICAgcGFpci5uZXdJZCA9IG5ld1RleHRzLmdldCh4bWxUZXh0Lmh0bWwpO1xyXG4gICAgfVxyXG4gICAgeG1sVGV4dHMuc2hpZnQoKTtcclxuICB9XHJcbiAgLy8gRm9yIGVhY2ggc3BpbnN0ZXIgKG5ldyB0ZXh0cyB0aGF0IGNvdWxkbid0IGZpbmQgYW55IG1hdGNoIGluIG9sZCB0ZXh0cyksXHJcbiAgLy8gQWRkIHRoZW0gd2l0aCBhbiBmaWN0aXZlIG9sZCBJRCBidXQgb21pdCBvbGRUZXh0IHRvIG1hcmsgaXQgYXMgYSBuZXdjb21lclxyXG4gIHhtbFNwaW5zdGVycy5mb3JFYWNoKHNwaW5zdGVyID0+IHtcclxuICAgIGlkc1RvTWlncmF0ZS5zZXQoZmljdGl2ZU9sZElkKCksIHtcclxuICAgICAgbmV3SWQ6IG5ld1RleHRzLmdldChzcGluc3Rlci5odG1sKSxcclxuICAgICAgbmV3VGV4dDogc3BpbnN0ZXIuaHRtbCxcclxuICAgICAgZ3JhZGVTdGVwOiBzcGluc3Rlci5ncmFkZVN0ZXAsXHJcbiAgICAgIG1hdGNoTGV2ZWw6IDAsXHJcbiAgICAgIGxleGVtZXM6IG5ldyBTZXQ8c3RyaW5nPigpfSlcclxuICB9KTtcclxuXHJcbiAgLy8gTWFyayB0eXBvLWZpeGVzXHJcbiAgaWRzVG9NaWdyYXRlLmZvckVhY2gobWF0Y2ggPT4ge1xyXG4gICAgY29uc3Qge29sZFRleHQsIG5ld1RleHR9ID0gbWF0Y2g7XHJcbiAgICBpZiAob2xkVGV4dCAmJiBuZXdUZXh0KSB7XHJcbiAgICAgIGlmIChbLi4uZ2V0TGV4ZW1lcyhvbGRUZXh0KV0uam9pbignICcpID09PSBbLi4uZ2V0TGV4ZW1lcyhuZXdUZXh0KV0uam9pbignICcpKSB7XHJcbiAgICAgICAgbWF0Y2guaXNUeXBvRml4ID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBjb25zb2xlLmxvZyhcIklkc1RvTWlncmF0ZVwiLCBbLi4uaWRzVG9NaWdyYXRlLnZhbHVlcygpXS5tYXAoKHtvbGRUZXh0LCBsZXhlbWVzfSkgPT4gYCR7Wy4uLmxleGVtZXNdLmpvaW4oJyAnKX06ICR7b2xkVGV4dH1gKSk7XHJcblxyXG4gIHJldHVybiBpZHNUb01pZ3JhdGU7XHJcblxyXG4gIGZ1bmN0aW9uIGZpbmRCZXN0TWF0Y2goeG1sVGV4dDoge2h0bWw6IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfSkge1xyXG4gICAgY29uc3QgeG1sTGV4ZW1lcyA9IGdldExleGVtZXMoeG1sVGV4dC5odG1sKTtcclxuICAgIGNvbnN0IHBvc3NpYmxlUGFydG5lcnMgPSBbLi4uaWRzVG9NaWdyYXRlLmVudHJpZXMoKV1cclxuICAgICAgLmZpbHRlcigoW2lkLCB4XSkgPT4geC5ncmFkZVN0ZXAgPT09IHhtbFRleHQuZ3JhZGVTdGVwKVxyXG4gICAgICAubWFwKChbaWQsIHtncmFkZVN0ZXAsIG1hdGNoTGV2ZWwsIG5ld1RleHQsIGxleGVtZXN9XSkgPT4gKHtcclxuICAgICAgICBpZCxcclxuICAgICAgICBncmFkZVN0ZXAsXHJcbiAgICAgICAgbWF0Y2hMZXZlbCxcclxuICAgICAgICBuZXdUZXh0LFxyXG4gICAgICAgIG15TWF0Y2hMZXZlbDogZ2V0TWF0Y2hMZXZlbCh4bWxMZXhlbWVzLCBsZXhlbWVzKVxyXG4gICAgICB9KSkuZmlsdGVyKHBwID0+IHBwLm15TWF0Y2hMZXZlbCA+PSA1MCAmJiAoIXBwLm1hdGNoTGV2ZWwgfHwgcHAubWF0Y2hMZXZlbCA8IHBwLm15TWF0Y2hMZXZlbCkpO1xyXG4gICAgcmV0dXJuIHBvc3NpYmxlUGFydG5lcnMuc29ydCgoYSwgYikgPT4gYi5teU1hdGNoTGV2ZWwgLSBhLm15TWF0Y2hMZXZlbClbMF07IC8vIGhpZ2hlc3QgZmlyc3QuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRNYXRjaExldmVsKGxleGVtZXMxOiBTZXQ8c3RyaW5nPiwgbGV4ZW1lczI6IFNldDxzdHJpbmc+KSB7XHJcbiAgICBpZiAobGV4ZW1lczEuc2l6ZSA9PT0gMCB8fCBsZXhlbWVzMi5zaXplID09PSAwKSByZXR1cm4gMDtcclxuICAgIGxldCBwb2ludHMxID0gMDtcclxuICAgIGxldCBwb2ludHMyID0gMDtcclxuICAgIGxleGVtZXMxLmZvckVhY2god29yZCA9PiB7XHJcbiAgICAgIGlmIChsZXhlbWVzMi5oYXMod29yZCkpICsrcG9pbnRzMTtcclxuICAgIH0pO1xyXG4gICAgbGV4ZW1lczIuZm9yRWFjaCh3b3JkID0+IHtcclxuICAgICAgaWYgKGxleGVtZXMxLmhhcyh3b3JkKSkgKytwb2ludHMyO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gTWF0aC5yb3VuZCgxMDAgKiBNYXRoLm1heChwb2ludHMxIC8gbGV4ZW1lczEuc2l6ZSwgcG9pbnRzMiAvIGxleGVtZXMyLnNpemUpKTtcclxuICB9XHJcblxyXG4gIC8qaWYgKGRiVGV4dHMubGVuZ3RoICE9PSB4bWxUZXh0cy5sZW5ndGgpIHtcclxuICAgIC8vIFdlIGNhbiBubyBsb25nZXIgYXNzdW1lIHRoYXQgdGhlIGNoYW5nZWQgdGV4dHMgcmVmZXIgdG8gZGlmZmVyZW50IGZvcm11bGF0aW9ucyBvZiB0aGUgc2FtZSBtZWFuaW5nLlxyXG4gICAgLy8gV2Ugbm90IG1hcCBvbGQgZm9ybXVsYXRpb25zIHRvIG5ldyBvbmVzLlxyXG4gICAgLy8gSW4gZnV0dXJlLCB3ZSBjb3VsZCBoYW5kbGUgdGhpcyBjYXNlIGJ5IGFzc3VtaW5nIGFsbCBvbGQgdGV4dHMgbm90IG9jY3VycmluZyBpbiBuZXcgZGF0YSwgaGF2ZSBiZWVuIHJlbW92ZWQgYW5kIGFsbCBuZXcgaGF2ZSBiZWVuIGFkZGVkLlxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTnVtYmVyIG9mIFwiICsgdGV4dFR5cGUgKyAoY291cnNlID8gYCBvbiBjb3Vyc2UgJHtjb3Vyc2V9YCA6IFwiXCIpICsgXCIgZGlmZmVycy4gQ2Fubm90IG1pZ3JhdGUuXCIpO1xyXG4gIH1cclxuICBkYlRleHRzLmZvckVhY2goKHtuYW1lOiBvbGRUZXh0LCBpZDogb2xkSWQsIGdyYWRlU3RlcH0sIGkpID0+IHtcclxuICAgIGNvbnN0IHhtbFRleHQgPSB4bWxUZXh0c1tpXS50cmltKCk7XHJcbiAgICBpZiAob2xkVGV4dC50cmltKCkgIT09IHhtbFRleHQpIHtcclxuICAgICAgaWRzVG9NaWdyYXRlLnNldChvbGRJZCwge25ld1RleHQ6IHhtbFRleHQsIG5ld0lkOiBuZXdUZXh0cy5nZXQoeG1sVGV4dCksIG9sZFRleHQsIGdyYWRlU3RlcH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIHJldHVybiBpZHNUb01pZ3JhdGU7Ki9cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1pZ3JhdGVTdWJqZWN0KGV4aXN0aW5nU3ViamVjdDogU3ViamVjdCwgY291cnNlU2V0czogQ291cnNlU2V0W10sIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0LCBjaGFuZ2VzOiBDaGFuZ2VbXSkge1xyXG4gIC8vIEdlbmVyYXRlIGRiVGV4dE1hcDpcclxuICAvLyBkYlRleHRNYXAgY29udGFpbnMgYSBtYXAgZnJvbSBvbGQgdGV4dHMgKEFiaWxpdGllcywgQ2VudHJhbCBDb250ZW50IG9yIEtub3dsZWRnZSBSZXF1aXJlbWVudHMpIHRvIGl0cyBJRCBpbiB0aGUgZGF0YWJhc2UuXHJcbiAgLy8gVGhlIG1hcCBzaG91bGQgYmUgdXNlZCB0byBsb29rdXAgSURzLCBnaXZlbiB0aGVpciB0cmltbWVkIHRleHQuXHJcbiAgY29uc3QgZGJUZXh0TWFwID0gbmV3IE1hcDxzdHJpbmcsIElEPigpO1xyXG4gIGNvbnN0IG9yZGVyZWRBYmlsaXRpZXMgPSBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgP1xyXG4gICAgZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllc09yZGVyLm1hcChpZCA9PiBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzLmZpbmQoYSA9PiBhLmlkID09PSBpZCkpIDpcclxuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXM7XHJcbiAgZm9yIChjb25zdCBhIG9mIG9yZGVyZWRBYmlsaXRpZXMpIHtcclxuICAgIGRiVGV4dE1hcC5zZXQoYS5uYW1lLnRyaW0oKSwgYS5pZCk7XHJcbiAgfVxyXG4gIGZvciAoY29uc3Qge3RlbXBsYXRlfSBvZiBjb3Vyc2VTZXRzKSB7XHJcbiAgICBmb3IgKGNvbnN0IGNjIG9mIHRlbXBsYXRlLmNlbnRyYWxDb250ZW50KSB7XHJcbiAgICAgIGRiVGV4dE1hcC5zZXQoY2MubmFtZS50cmltKCksIGNjLmlkKTtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3Qga3Igb2YgdGVtcGxhdGUua25vd2xlZGdlUmVxdWlyZW1lbnRzKSB7XHJcbiAgICAgIGRiVGV4dE1hcC5zZXQoa3IubmFtZS50cmltKCksIGtyLmlkKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEZpbmQgb3V0IHdoaWNoIG5ldyB0ZXh0cyAoaW4gdG90YWwpIHRoYXQgc2hvdWxkIGJlIGNyZWF0ZWQgaW4gdGhlIERCIG9uIG1pZ3JhdGluZy5cclxuICAvLyBNYXliZSBhbHNvIGZpbmQgb3V0IGlmIHRoZXJlIGFyZSBhbnkgb2xkIHRleHRzIHdobydzIG9iamVjdHMgYXJlIG5vIG1vcmUgdXNlZCBhbmQgY291bGQgYmUgcmVtb3ZlZCBmcm9tIHRoZSBEQlxyXG4gIC8vIG5ld1RleHRzOiBBIG1hcCBiZXR3ZWVuIGEgbmV3IHRleHQgYW5kIGl0cyBuZXcgSUQgaW4gdGhlIGRhdGFiYXNlIGFmdGVyIGNyZWF0aW5nIGl0LlxyXG4gIC8vIHJlbW92ZWRJZHM6IEEgc2V0IG9mIGV4aXN0aW5nIGlkcyB0aGF0IHdvdWxkIGJlIHNhZmUgdG8gcmVtb3ZlIG9uIG1pZ3JhdGluZyAod2lsbCBpZ25vcmUgdGhvc2UgZm9yIG5vdylcclxuICBjb25zdCB7bmV3VGV4dHM6IG5ld0FiaWxpdHlUZXh0cywgaWRzVG9BZGQ6IGFiaWxpdGllc1RvQWRkfSA9XHJcbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgc3ViamVjdFRvSW1wb3J0LmFiaWxpdGllcyk7XHJcbiAgY29uc3Qge25ld1RleHRzOiBuZXdDQ1RleHRzLCBpZHNUb0FkZDogY2NzVG9BZGR9ID1cclxuICAgIGRpZmZTdWJqZWN0R2xvYmFsVGV4dHMoZGJUZXh0TWFwLCBmbGF0dGVuKHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLm1hcChjID0+IGMuY2VudHJhbENvbnRlbnQubWFwKGNjID0+IGNjLmh0bWwpKSkpO1xyXG4gIGNvbnN0IHtuZXdUZXh0czogbmV3S1JUZXh0cywgaWRzVG9BZGQ6IGtyc1RvQWRkfSA9XHJcbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgZmxhdHRlbihzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5tYXAoYyA9PiBjLmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoa3IgPT4ga3IuaHRtbCkpKSk7XHJcbiAgXHJcbiAgY29uc29sZS5sb2coYEFiaWxpdGllcyB0byBhZGQ6ICR7YWJpbGl0aWVzVG9BZGQuc2l6ZX1gKTtcclxuICBjb25zb2xlLmxvZyhgQ0NzIHRvIGFkZDogJHtjY3NUb0FkZC5zaXplfWApO1xyXG4gIGNvbnNvbGUubG9nKGBLUnMgdG8gYWRkOiAke2tyc1RvQWRkLnNpemV9YCk7XHJcblxyXG4gIC8vIEZpbmQgb3V0IGFsbCBleGlzdGluZyBBYmlsaXR5IGlkcyB0aGF0IHdpbGwgYmUgbWlncmF0ZWQgdG8gbmV3IG9uZXNcclxuICBjb25zdCBhYmlsaXR5SWRzVG9NaWdyYXRlID0gZ2V0SWRzVG9NaWdyYXRlKFxyXG4gICAgb3JkZXJlZEFiaWxpdGllcyxcclxuICAgIHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKGh0bWwgPT4gKHtodG1sfSkpLFxyXG4gICAgbmV3QWJpbGl0eVRleHRzLFxyXG4gICAgXCJhYmlsaXRpZXNcIik7XHJcblxyXG4gIC8vIERvIHRoZSBzYW1lIGZvciBlYWNoIENlbnRyYWwgQ29udGVudCBhbmQgS25vd2xlZGdlIFJlcXVpcmVtZW50cyBvbiBlYWNoIGNvdXJzZTpcclxuICBjb25zdCBpZHNUb01pZ3JhdGVQZXJDb3Vyc2UgPSBjb3Vyc2VTZXRzLm1hcCgoe3RlbXBsYXRlfSwgaSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYENvdXJzZTogJHt0ZW1wbGF0ZS5uYW1lfWApO1xyXG4gICAgY29uc3QgeG1sQ291cnNlID0gc3ViamVjdFRvSW1wb3J0LmNvdXJzZXMuZmluZChjID0+IGMubmFtZSA9PT0gdGVtcGxhdGUubmFtZSkgfHxcclxuICAgICAgc3ViamVjdFRvSW1wb3J0LmNvdXJzZXMuZmluZChjID0+IGMuY29kZSA9PT0gdGVtcGxhdGUuY29kZSk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBjb3Vyc2VDb2RlOiB0ZW1wbGF0ZS5jb2RlLFxyXG4gICAgICBjY3NUb01pZ3JhdGU6IHhtbENvdXJzZSA/XHJcbiAgICAgICAgZ2V0SWRzVG9NaWdyYXRlKFxyXG4gICAgICAgICAgdGVtcGxhdGUuY2VudHJhbENvbnRlbnQsIC8vIEhhcyBhbHJlYWR5IGJlZW4gc29ydGVkIHdoZW4gcmV0cmlldmVkIHZpYSBsb2FkQ291cnNlKClcclxuICAgICAgICAgIHhtbENvdXJzZS5jZW50cmFsQ29udGVudC5tYXAoKHtodG1sfSkgPT4gKHtodG1sfSkpLFxyXG4gICAgICAgICAgbmV3Q0NUZXh0cyxcclxuICAgICAgICAgIFwiY2VudHJhbCBjb250ZW50XCIsXHJcbiAgICAgICAgICB0ZW1wbGF0ZS5uYW1lKSA6XHJcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGlzVHlwb0ZpeDogYm9vbGVhbn0+KCksXHJcbiAgICAgIGtyc1RvTWlncmF0ZTogeG1sQ291cnNlID9cclxuICAgICAgICBnZXRJZHNUb01pZ3JhdGUoXHJcbiAgICAgICAgICB0ZW1wbGF0ZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMsIC8vIEhhcyBhbHJlYWR5IGJlZW4gc29ydGVkIHdoZW4gcmV0cmlldmVkIHZpYSBsb2FkQ291cnNlKClcclxuICAgICAgICAgIHhtbENvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMsXHJcbiAgICAgICAgICBuZXdLUlRleHRzLFxyXG4gICAgICAgICAgXCJrbm93bGVkZ2UgcmVxdWlyZW1lbnRzXCIsXHJcbiAgICAgICAgICB0ZW1wbGF0ZS5uYW1lXHJcbiAgICAgICAgKSA6XHJcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGdyYWRlU3RlcDogc3RyaW5nLCBpc1R5cG9GaXg6IGJvb2xlYW59PigpXHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICAvLyBPSyBzbyBub3cgd2UgaGF2ZSBhbGwgaW5mby5cclxuICAvLyBOb3csIHdlIG5lZWQgdG86XHJcbiAgLy8gU3ViamVjdDpcclxuICAvLyAxLiBSZW1vdmUgbGlua3MgZnJvbSBzdWJqZWN0cyB0byBhYmlsaXRpZXNcclxuICAvLyAyLiBBZGQgbGlua3MgZnJvbSBzdWJqZWN0cyB0byBhYmlsaXRpZXNcclxuICBhYmlsaXR5SWRzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdUZXh0LCBuZXdJZCwgb2xkVGV4dCwgaXNUeXBvRml4fSwgb2xkSWQpID0+IHtcclxuICAgIC8vY29uc3Qgb2xkVGV4dCA9IGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXMuZmluZChhID0+IGEuaWQgPT09IG9sZElkKS5uYW1lO1xyXG4gICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgY2hhbmdlOiAoXHJcbiAgICAgICAgb2xkVGV4dCA/XHJcbiAgICAgICAgICBuZXdUZXh0ID9cclxuICAgICAgICAgICAgaXNUeXBvRml4ID9cclxuICAgICAgICAgICAgICBgVHJ5Y2tmZWxzcsOkdHRuaW5nIEbDtnJtw6VnYWAgOlxyXG4gICAgICAgICAgICAgIGBVcHBkYXRlcmFkIEbDtnJtw6VnYWAgOlxyXG4gICAgICAgICAgICBgQm9ydHRhZ2VuIEbDtnJtw6VnYWAgOlxyXG4gICAgICAgICAgYE55IEbDtnJtw6VnYWBcclxuICAgICAgKSxcclxuICAgICAgY29udGVudDogYDxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXHJcbiAgICAgIG11dGF0aW9uczogYnIgPT4ge1xyXG4gICAgICAgIGlmIChuZXdJZCAmJiBhYmlsaXRpZXNUb0FkZC5oYXMobmV3SWQpKSB7XHJcbiAgICAgICAgICBjb25zdCBhOiBBYmlsaXR5ID0ge1xyXG4gICAgICAgICAgICBpZDogbmV3SWQsXHJcbiAgICAgICAgICAgIG5hbWU6IG5ld1RleHQsXHJcbiAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXHJcbiAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgYnIuYWRkKFwiYWJpbGl0aWVzXCIsIGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2xkVGV4dCkgYnIudW5saW5rMihcInN1YmplY3RzXCIsIGV4aXN0aW5nU3ViamVjdC5pZCwgXCJhYmlsaXRpZXNcIiwgb2xkSWQpO1xyXG4gICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJzdWJqZWN0c1wiLCBleGlzdGluZ1N1YmplY3QuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0lkKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9KTtcclxuICAvLyAzLiBVcGRhdGUgYWJpbGl0aWVzT3JkZXIgb24gU3ViamVjdCBiYXNlZCBvbiBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzIChtYXBwZWQgdG8gaWRzIGluIG5ld1RleHRzKVxyXG4gIGlmICghZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllc09yZGVyIHx8IGFiaWxpdHlJZHNUb01pZ3JhdGUuc2l6ZSA+IDApIHtcclxuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA9IHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKHhtbCA9PiBuZXdBYmlsaXR5VGV4dHMuZ2V0KHhtbCkpO1xyXG4gICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgbXV0YXRpb25zOiBiciA9PiBici5wdXQoXCJzdWJqZWN0c1wiLCBleGlzdGluZ1N1YmplY3QpLFxyXG4gICAgICBjaGFuZ2U6IGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA/XHJcbiAgICAgICAgbnVsbCA6IC8vIMOEbmRyaW5nZW4gcmVkYW4gdmlzdWVsbCBzb20gXCJVcHBkYXRlcmFkIGbDtnIgZsO2cm3DpWdhXCIsIGV0Yywgb3ZhblxyXG4gICAgICAgIGBJbmbDtnIgZW4gb3JkbmFkIGxpc3RhIHDDpSBmw7ZybcOlZ29yIGkgZGF0YWJhc2VuYCxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgY3JlYXRlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XHJcbiAgY2hhbmdlcy5wdXNoKHttdXRhdGlvbnM6ICgpPT5jcmVhdGVkSWRzLmNsZWFyKCl9KTsgLy8gSW4gY2FzZSBtdXRhdGlvbnMgcnVuIHR3aWNlICh3aGljaCBpdCBkb2Vzbid0IGFzIG9mIGN1cnJlbnQgaW1wbC4pXHJcbiAgY29uc3Qgc2hvd25DaGFuZ2VzID0gbmV3IFNldDxzdHJpbmc+KCk7IC8vIFNldCBvZiBjb3Vyc2VOYW1lXHJcbiAgY2hhbmdlcy5wdXNoKHttdXRhdGlvbnM6ICgpPT5zaG93bkNoYW5nZXMuY2xlYXIoKX0pO1xyXG4gIFxyXG4gIC8vIENvdXJzZXM6XHJcbiAgLy8gMS4gR28gdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyBhbmQ6XHJcbiAgLy8gICAgICBBOiBSZW1vdmUgbGlua3MgZnJvbSBjb3Vyc2VzIHRvIGFiaWxpdGllcyBsaXN0ZWQgaW4gYWJpbGl0eUlkc1RvTWlncmF0ZS5rZXlzKClcclxuICAvLyAgICAgIEI6IEFkZCBsaW5rcyBmcm9tIGNvdXJzZXMgdG8gYWJpbGl0aWVzIGFiaWx0aXRpZXNUb01pZ3JhdGUudmFsdWVzKClcclxuICAvLyAgICAgIEM6IFVwZGF0ZSBhYmlsaXRpZXNPcmRlciBvbiBjb3Vyc2UgaW5zdGFuY2VzIGJhc2VkIG9uIHN1YmplY3RUb0ltcG9ydCAobWFwcGVkIHRvIGlkcyBpbiBuZXdUZXh0cylcclxuICAvLyAyLCAzOiBEbyB0aGUgc2FtZSBmb3IgY2VudHJhbC1jb250ZW50IGFuZCBrbm93bGVkZ2UtcmVxdWlyZW1lbnRlczpcclxuICAvLyAgICBGaW5kIGNjcyBhbmQga3JzIHRvIG1pZ3JhdGUgYmFzZWQgb24gY291cnNlSW5zdGFuY2UuY29kZVxyXG4gIC8vICAgIEZvciBib3RoIGNjcyBhbmQga3JzLCBkbzpcclxuICAvLyAgICAgIEE6IFVubGluayBjY3NUb01pZ3JhdGUua2V5cygpXHJcbiAgLy8gICAgICBCOiBMaW5rIGNjc1RvTWlncmF0ZS52YWx1ZXMoKVxyXG4gIC8vICAgICAgQzogVXBkYXRlIGNlbnRyYWxDb250ZW50T3JkZXIgYmFzZWQgb24gc3ViamVjdFRvSW1wb3J0LmNlbnRyYWxDb250ZW50IG1hcHBlZCB0byBuZXdUZXh0cyBpZHNcclxuICAvLyAgICAgIChzYW1lIGZvciBrcnNUb01pZ3JhdGUsIHdpdGgga25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgaW5zdGVhZClcclxuICBmb3IgKGNvbnN0IHt0ZW1wbGF0ZSwgaW5zdGFuY2VzfSBvZiBjb3Vyc2VTZXRzKSB7XHJcbiAgICAvLyBGaW5kIGNvdXJzZVRvSW1wb3J0XHJcbiAgICBjb25zdCBjb3Vyc2VUb0ltcG9ydDogQ291cnNlVG9JbXBvcnQgPSAoXHJcbiAgICAgIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLm5hbWUgPT09IHRlbXBsYXRlLm5hbWUpIHx8XHJcbiAgICAgIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLmNvZGUgPT09IHRlbXBsYXRlLmNvZGUpXHJcbiAgICApO1xyXG5cclxuICAgIC8vIEZpbmQgQ2VudHJhbCBDb250ZW50IGFuZCBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzIHRvIG1pZ3JhdGVcclxuICAgIGNvbnN0IHtjY3NUb01pZ3JhdGUsIGtyc1RvTWlncmF0ZX06IHtcclxuICAgICAgY2NzVG9NaWdyYXRlOiBNYXA8SUQsIHtuZXdUZXh0Pzogc3RyaW5nLCBuZXdJZD86IElELCBvbGRUZXh0Pzogc3RyaW5nfT4sXHJcbiAgICAgIGtyc1RvTWlncmF0ZTogTWFwPElELCB7bmV3VGV4dD86IHN0cmluZywgbmV3SWQ/OiBJRCwgb2xkVGV4dD86IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfT5cclxuICAgIH0gPSBpZHNUb01pZ3JhdGVQZXJDb3Vyc2UuZmluZCh4ID0+IHguY291cnNlQ29kZSA9PT0gdGVtcGxhdGUuY29kZSk7XHJcbiAgICBcclxuICAgIC8vIExvb3AgdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyAoaW5zdGFuY2VzIGFsc28gY29udGFpbnMgdGVtcGxhdGVzKVxyXG4gICAgLy8gYW5kIG1pZ3JhdGUgdGhlbS4gVGhpcyB3aWxsIGluY2x1ZGUgY3JlYXRpbmcgbWlzc2luZyBlbnRpdGllcyBpbiB0aGUgREIuXHJcbiAgICBmb3IgKGNvbnN0IGNvdXJzZSBvZiBpbnN0YW5jZXMpIHtcclxuICAgICAgbWlncmF0ZUNvdXJzZUluc3RhbmNlKGNvdXJzZSwgY291cnNlVG9JbXBvcnQsIHtjY3NUb01pZ3JhdGUsIGtyc1RvTWlncmF0ZX0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXdhaXQgbWlncmF0ZVRhc2tzKCk7XHJcbiAgcmV0dXJuO1xyXG5cclxuICBmdW5jdGlvbiBtaWdyYXRlQ291cnNlSW5zdGFuY2UoXHJcbiAgICBjb3Vyc2U6IENvdXJzZSxcclxuICAgIGNvdXJzZVRvSW1wb3J0OiBDb3Vyc2VUb0ltcG9ydCxcclxuICAgIGlkc1RvTWlncmF0ZToge1xyXG4gICAgICBjY3NUb01pZ3JhdGU6IE1hcDxJRCwge25ld1RleHQ/OiBzdHJpbmcsIG5ld0lkPzogSUQsIG9sZFRleHQ/OiBzdHJpbmcsIGlzVHlwb0ZpeD86IGJvb2xlYW59PixcclxuICAgICAga3JzVG9NaWdyYXRlOiBNYXA8SUQsIHtuZXdUZXh0Pzogc3RyaW5nLCBuZXdJZD86IElELCBvbGRUZXh0Pzogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmcsIGlzVHlwb0ZpeD86IGJvb2xlYW59PlxyXG4gICAgfSlcclxuICB7XHJcbiAgICBjb25zdCBzaG93Q2hhbmdlcyA9ICFzaG93bkNoYW5nZXMuaGFzKGNvdXJzZS5uYW1lKTtcclxuICAgIHNob3duQ2hhbmdlcy5hZGQoY291cnNlLm5hbWUpO1xyXG4gICAgYWJpbGl0eUlkc1RvTWlncmF0ZS5mb3JFYWNoKCh7bmV3SWQsIG9sZFRleHR9LCBvbGRJZCkgPT4ge1xyXG4gICAgICAvLyBSZWxpbmsgdGhlIGNvdXJzZSBpbnN0YW5jZSB3aXRoIGFiaWxpdGllcy4gVGhpcyBjaGFuZ2UgZG9lcyBub3QgbmVlZCB0byBiZSB2aXNpYmxlIGluIEdVSS5cclxuICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICBtdXRhdGlvbnM6IGJyID0+IHtcclxuICAgICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIG9sZElkKTtcclxuICAgICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJhYmlsaXRpZXNcIiwgbmV3SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7ICBcclxuICAgIH0pO1xyXG4gICAgY291cnNlLmFiaWxpdGllc09yZGVyID0gc3ViamVjdFRvSW1wb3J0LmFiaWxpdGllcy5tYXAoaHRtbCA9PiBuZXdBYmlsaXR5VGV4dHMuZ2V0KGh0bWwpKTtcclxuXHJcbiAgICBjb25zdCB7Y2NzVG9NaWdyYXRlLCBrcnNUb01pZ3JhdGV9ID0gaWRzVG9NaWdyYXRlO1xyXG5cclxuICAgIC8vIENlbnRyYWwgQ29udGVudFxyXG4gICAgY2NzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdJZCwgbmV3VGV4dCwgb2xkVGV4dCwgaXNUeXBvRml4fSwgb2xkSWQpID0+IHtcclxuICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICBjaGFuZ2U6IHNob3dDaGFuZ2VzICYmIChcclxuICAgICAgICAgIG9sZFRleHQgP1xyXG4gICAgICAgICAgICBuZXdUZXh0ID9cclxuICAgICAgICAgICAgICBpc1R5cG9GaXggP1xyXG4gICAgICAgICAgICAgICAgYFRyeWNrZmVsc3LDpHR0bmluZyBDZW50cmFsdCBJbm5laMOlbGxgIDpcclxuICAgICAgICAgICAgICAgIGBVcHBkYXRlcmF0IENlbnRyYWx0IElubmVow6VsbGAgOlxyXG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XHJcbiAgICAgICAgICAgIGBOeXR0IENlbnRyYWx0IElubmVow6VsbGApLFxyXG4gICAgICAgIGNvbnRlbnQ6IGA8aDQ+JHtjb3Vyc2UubmFtZX08L2g0PjxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXHJcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiB7XHJcbiAgICAgICAgICBpZiAobmV3SWQgJiYgY2NzVG9BZGQuaGFzKG5ld0lkKSAmJiAhY3JlYXRlZElkcy5oYXMobmV3SWQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNjOiBDZW50cmFsQ29udGVudCA9IHtcclxuICAgICAgICAgICAgICBpZDogbmV3SWQsXHJcbiAgICAgICAgICAgICAgbmFtZTogbmV3VGV4dCxcclxuICAgICAgICAgICAgICBhY2w6IFtcInJvbGU6VVNFUjpSXCJdLFxyXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGJyLmFkZChcImNlbnRyYWwtY29udGVudFwiLCBjYyk7XHJcbiAgICAgICAgICAgIGNyZWF0ZWRJZHMuYWRkKG5ld0lkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiY2VudHJhbENvbnRlbnRcIiwgb2xkSWQpO1xyXG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIG5ld0lkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9KTtcclxuICAgIGNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyID0gY291cnNlVG9JbXBvcnQuY2VudHJhbENvbnRlbnQubWFwKCh7aHRtbH0pID0+IG5ld0NDVGV4dHMuZ2V0KGh0bWwpKTtcclxuXHJcbiAgICAvLyBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzXHJcbiAgICBrcnNUb01pZ3JhdGUuZm9yRWFjaCgoe25ld0lkLCBuZXdUZXh0LCBncmFkZVN0ZXAsIG9sZFRleHQsIGlzVHlwb0ZpeH0sIG9sZElkKSA9PiB7XHJcbiAgICAgIGNoYW5nZXMucHVzaCh7XHJcbiAgICAgICAgY2hhbmdlOiBzaG93Q2hhbmdlcyAmJiAoXHJcbiAgICAgICAgICBvbGRUZXh0ID9cclxuICAgICAgICAgICAgbmV3VGV4dCA/XHJcbiAgICAgICAgICAgICAgaXNUeXBvRml4ID9cclxuICAgICAgICAgICAgICAgIGBUcnlja2ZlbHNyw6R0dG5pbmcgS3Vuc2thcHNrcmF2YDpcclxuICAgICAgICAgICAgICAgIGBVcHBkYXRlcmF0IEt1bnNrYXBza3JhdmAgOlxyXG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgS3Vuc2thcHNrcmF2YCA6XHJcbiAgICAgICAgICAgIGBOeXR0IEt1bnNrYXBza3JhdmBcclxuICAgICAgICApLFxyXG4gICAgICAgIGNvbnRlbnQ6IGA8aDQ+JHtjb3Vyc2UubmFtZX08L2g0PjxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXHJcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiB7XHJcbiAgICAgICAgICBpZiAobmV3SWQgJiYga3JzVG9BZGQuaGFzKG5ld0lkKSAmJiAhY3JlYXRlZElkcy5oYXMobmV3SWQpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtyOiBLbm93bGVkZ2VSZXF1aXJlbWVudCA9IHtcclxuICAgICAgICAgICAgICBpZDogbmV3SWQsXHJcbiAgICAgICAgICAgICAgbmFtZTogbmV3VGV4dCxcclxuICAgICAgICAgICAgICBncmFkZVN0ZXAsXHJcbiAgICAgICAgICAgICAgYWNsOiBbXCJyb2xlOlVTRVI6UlwiXSxcclxuICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQWRkaW5nIEtub3dsZWRnZS1SZXF1aXJlbWVudCAke25ld0lkfTogJHtuZXdUZXh0fWApO1xyXG4gICAgICAgICAgICBici5hZGQoXCJrbm93bGVkZ2UtcmVxdWlyZW1lbnRzXCIsIGtyKTtcclxuICAgICAgICAgICAgY3JlYXRlZElkcy5hZGQobmV3SWQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKG9sZFRleHQpIGJyLnVubGluazIoXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgb2xkSWQpO1xyXG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBuZXdJZCk7ICBcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgPVxyXG4gICAgICBjb3Vyc2VUb0ltcG9ydC5rbm93bGVkZ2VSZXF1aXJlbWVudHMubWFwKGtyID0+IG5ld0tSVGV4dHMuZ2V0KGtyLmh0bWwpKTtcclxuXHJcbiAgICAvLyBVcGRhdGVzIHRoZSBjb3Vyc2UgcHJvcGVydGllcyBjZW50cmFsQ29udGVudE9yZGVyIGFuZCBrbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlclxyXG4gICAgaWYgKGFiaWxpdHlJZHNUb01pZ3JhdGUuc2l6ZSA+IDAgfHwgY2NzVG9NaWdyYXRlLnNpemUgPiAwIHx8IGtyc1RvTWlncmF0ZS5zaXplID4gMCkge1xyXG4gICAgICBjaGFuZ2VzLnB1c2goe1xyXG4gICAgICAgIGNoYW5nZTogIWNvdXJzZS5pc1RlbXBsYXRlID8gYFVwcGRhdGVyYWQgS3Vyc2luc3RhbnNgIDogYFVwcGRhdGVyYWQgS3Vyc21hbGxgLFxyXG4gICAgICAgIGNvbnRlbnQ6ICFjb3Vyc2UuaXNUZW1wbGF0ZSA/XHJcbiAgICAgICAgICBgJHtjb3Vyc2UubmFtZX0uIFNrb2xhOiAke2NvdXJzZS5zY2hvb2wgfHwgXCJlaiBhbmdpdmVuXCJ9LiBCZXNrcml2bmluZzogJHtjb3Vyc2UuZGVzY3JpcHRpb24gfHwgJyd9YCA6XHJcbiAgICAgICAgICBgJHtjb3Vyc2UubmFtZX1gLFxyXG4gICAgICAgIG11dGF0aW9uczogYnIgPT4gYnIucHV0KFwiY291cnNlc1wiLCBjb3Vyc2UpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAvLyBUYXNrczpcclxuICAvLyAxLiBBU1lOQyBPUEVSQVRJT046IEdvIHRocm91Z2ggYWxsIHRhc2tzIHRoYXQgaGFzIGVkZ2VzIHRvIGFueSBvZiB0aGUgb2xkIGlkcy5cclxuICAvLyAyLiBGb3IgZWFjaCBmb3VuZCB0YXNrLCBkbzpcclxuICAvLyAgICBBOiBJdGVyYXRlIHRhZ3Mgc3RhcnRpbmcgd2l0aCBcImNvdXJzZTpcIi4gUGljayB0aGUgY291cnNlIGNvZGUuXHJcbiAgLy8gICAgQjogUG9wdWxhdGUgdGhlIG5ldyBwcm9wZXJ0eSBtaWdyYXRpb25UYXNrczoge1xyXG4gIC8vICAgICAgICAgYWJpbGl0aWVzOiB7W25ld0lkOiBzdHJpbmddOiB7b2xkVGV4dDogc3RyaW5nLCBvbGRJZDogc3RyaW5nLCBpbXBvcnREYXRlOiBudW1iZXJ9fSwgLy8gQmUgYWJsZSB0byBjcmVhdGUgYSBjaGFpbiBpbiB0aGUgR1VJICFcclxuICAvLyAgICAgICAgIGNlbnRyYWxDb250ZW50OiB7W25ld0lkOiBzdHJpbmddOiB7b2xkVGV4dDogc3RyaW5nLCAuLi5cIi4uLn19LFxyXG4gIC8vICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiB7W25ld0lkOiBzdHJpbmddOiB7b2xkVGV4dDogc3RyaW5nLCAuLi5cIi4uLn19LFxyXG4gIC8vICAgICAgIH1cclxuICAvLyAgICAgICBPQlMxISBNZXJnZWEgYWJpbGl0aWVzLCBjZW50cmFsQ29uZGVudCBvY2gga25vd2xlZGdlUmVxdWlyZW1lbnRzIG1lZCBldiB0aWRpZ2FyZSB2w6RyZGVuIChzw6UgbWFuIGthbiBpbXBvcnRlcmEgb20gb2NoIG9tIGlnZW4hKVxyXG4gIC8vICAgICAgIE9CUzIhIG9sZElkIGthbiBmw7ZyZWtvbW1hIHDDpSBmbGVyYSBuZXdJZCBvbSB0YXNrIGFudsOkbmRzIGF2IGZsZXJhIGt1cnNlci4gXHJcbiAgLy8gICAgQzogQ3JlYXRlIHNldHMgZm9yIHVubGlua3MgYW5kIGxpbmsgb3BlcmF0aW9ucyBwZXIgdHlwZS5cclxuICAvLyAgICBEOiBGb3IgYWxsIGNvdXJzZUNvZGVzIHRoYXQgdGhlIHRhc2sgaXMgdGFnZ2VuIG9uLFxyXG4gIC8vICAgICAgICAgKiByZWdpc3RlciBjY3NUb01pZ3JhdGUua2V5cygpIGluIHRoZSB1bmxpbmsgc2V0IG9mIGNlbnRyYWwgY29udGVudHNcclxuICAvLyAgICAgICAgICogcmVnaXN0ZXIgY2NzVG9NaWdyYXRlLnZhbHVlcygpIGluIHRoZSBsaW5rIHNldCBvZiBjZW50cmFsIGNvbnRlbnRzXHJcbiAgLy8gICAgICAgICAqIC0tXCItLSBmb3Iga25vd2xlZGdlUmVxdWlyZW1lbnRzXHJcbiAgLy8gICAgRTogdW5saW5rIGFuZCBsaW5rIHdpdGggcmVnYXJkcyB0byBhYmlsaXR5SWRzVG9NaWdyYXRlIChrZXlzKCkgYW5kIHZhbHVlcygpIHJlc3BlY3RpdmVseSkuXHJcbiAgLy8gICAgRjogdW5saW5rIGFuZCBsaW5rIGFjY29yZGluZyB0byB0aGUgY3JlYXRlZCBzZXRzIG9mIGxpbmsgLyB1bmxpbmsgb3BlcmF0aW9ucy5cclxuICAvLyAgICBOb3RlOiBVbmxpa2UgY291cnNlIGluc3RhbmNlcywgdGhlcmUncyBubyBvcmRlciBwcm9wZXJ0eSB0byB0YWtlIGNhcmUgb2YgaGVyZSFcclxuICAvL1xyXG5cclxuICBhc3luYyBmdW5jdGlvbiBtaWdyYXRlVGFza3MoKSB7XHJcbiAgICBjb25zdCBvbGRJZHMgPSBbXHJcbiAgICAgIC4uLmFiaWxpdHlJZHNUb01pZ3JhdGUua2V5cygpLFxyXG4gICAgICAuLi5mbGF0dGVuKGlkc1RvTWlncmF0ZVBlckNvdXJzZS5tYXAoYyA9PiBbXHJcbiAgICAgICAgLi4uYy5jY3NUb01pZ3JhdGUua2V5cygpLFxyXG4gICAgICAgIC4uLmMua3JzVG9NaWdyYXRlLmtleXMoKVxyXG4gICAgICBdKSlcclxuICAgIF0uZmlsdGVyKGlkID0+ICFpZC5zdGFydHNXaXRoKCdmaWN0aXZlT2xkSWQnKSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGltcG9ydERhdGUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZmV0Y2hUYXNrc0luQ2h1bmtzV2l0aEVkZ2VzVG8ob2xkSWRzLCB7XHJcbiAgICAgIGluY2x1ZGU6IFtcImFiaWxpdGllc1wiLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBcImNlbnRyYWxDb250ZW50XCJdLFxyXG4gICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cclxuICAgIH0pO1xyXG5cclxuICAgIGFzeW5jIGZ1bmN0aW9uIGZldGNoVGFza3NJbkNodW5rc1dpdGhFZGdlc1RvKGlkczogc3RyaW5nW10sIG9wdGlvbnM6IExpc3RPcHRpb25zKTogUHJvbWlzZTxUYXNrW10+IHtcclxuICAgICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgbWFrZSB3b3JrIGFyb3VuZCB0aGUgY2FzZSB3aGVuIGdpdmVuIFwiaWRzXCIgY29udGFpbnMgdG9vIG1hbnkgaXRlbXMsIGJ5XHJcbiAgICAgIC8vIGRpdmlkaW5nIHRoZSByZXF1ZXN0cyBpbnRvIHNldmVyYWwgYW5kIG1lcmdlIHRoZSByZXN1bHQgdXNpbmcgYSBNYXAuXHJcbiAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwKSByZXR1cm4gW107IC8vIE90aGVyd2lzZSB3ZSdsbCByZXF1ZXN0IGV2ZXJ5IHRhc2sgaW4gdGhlIHN5c3RlbS5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcDxJRCwgVGFzaz4oKTtcclxuICAgICAgY29uc29sZS5sb2coXCJOdW1iZXIgb2YgaWRzOiBcIiArIGlkcy5sZW5ndGgpO1xyXG4gICAgICAvL3JldHVybiByZXN1bHQudmFsdWVzKCk7XHJcbiAgICAgIHJldHVybiBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xyXG4gICAgICAgIC4uLm9wdGlvbnMsXHJcbiAgICAgICAgaGFzRWRnZXNUbzogaWRzXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qY29uc3QgdGFza3MgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xyXG4gICAgICBoYXNFZGdlc1RvOiBvbGRJZHMsXHJcbiAgICAgIGluY2x1ZGU6IFtcImFiaWxpdGllc1wiLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBcImNlbnRyYWxDb250ZW50XCJdLFxyXG4gICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cclxuICAgIH0pOyovXHJcblxyXG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzKSB7XHJcbiAgICAgIGNvbnN0IG9sZE1UID0gdGFzay5taWdyYXRlZFRleHRzIHx8IHtcclxuICAgICAgICBhYmlsaXRpZXM6IHt9LFxyXG4gICAgICAgIGNlbnRyYWxDb250ZW50OiB7fSxcclxuICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHt9XHJcbiAgICAgIH07XHJcbiAgICAgIHRhc2subWlncmF0ZWRUZXh0cyA9IHtcclxuICAgICAgICBhYmlsaXRpZXM6IHt9LFxyXG4gICAgICAgIGNlbnRyYWxDb250ZW50OiB7fSxcclxuICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHt9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCBtdXRhdGlvbnM6IEFycmF5PChicjogQmF0Y2hSdW5uZXIpPT52b2lkPiA9IFtdO1xyXG4gICAgICBjb25zdCBjaGFuZ2VEZXNjcmlwdGlvbnM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgIGZvciAoY29uc3Qge2lkfSBvZiB0YXNrLmFiaWxpdGllcykge1xyXG4gICAgICAgIGNvbnN0IG1pZ3JhdGlvbkluZm8gPSBhYmlsaXR5SWRzVG9NaWdyYXRlLmdldChpZCk7XHJcbiAgICAgICAgaWYgKG1pZ3JhdGlvbkluZm8pIHtcclxuICAgICAgICAgIGNvbnN0IHtuZXdJZCwgbmV3VGV4dCwgaXNUeXBvRml4fSA9IG1pZ3JhdGlvbkluZm87XHJcbiAgICAgICAgICBsZXQge29sZFRleHR9ID0gbWlncmF0aW9uSW5mbztcclxuICAgICAgICAgIGxldCBvbGRJZCA9IGlkO1xyXG4gICAgICAgICAgaWYgKG9sZE1ULmFiaWxpdGllc1tpZF0pIHtcclxuICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXHJcbiAgICAgICAgICAgIC8vIFdlIHNob3VsZCBwb2ludCBvdXQgdGhlIHZlcnkgb2xkIGlkIGFuZCB0ZXh0IGluc3RlYWQgb2YgdGhlIG5ldmVyLWFja25vd2xlZGdlZCBvbmUuXHJcbiAgICAgICAgICAgIG9sZFRleHQgPSBvbGRNVC5hYmlsaXRpZXNbaWRdLm9sZFRleHQ7XHJcbiAgICAgICAgICAgIG9sZElkID0gb2xkTVQuYWJpbGl0aWVzW2lkXS5vbGRJZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChuZXdJZCAmJiBvbGRUZXh0ICE9PSBuZXdUZXh0KSB7XHJcbiAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxyXG4gICAgICAgICAgICBpZiAoIWlzVHlwb0ZpeCkge1xyXG4gICAgICAgICAgICAgIC8vIElmIHRoaXMgd2Fzbid0IGp1c3QgYSB0eXBvIGZpeCAoY2hhbmdlcyBpbiBzdG9wIHdvcmRzLCBjYXNpbmcgb3Igc3BlY2lhbCBjaGFyYWN0ZXJzKVxyXG4gICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5hYmlsaXRpZXNbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbXV0YXRpb25zLnB1c2goYnIgPT4ge1xyXG4gICAgICAgICAgICBici51bmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJhYmlsaXRpZXNcIiwgaWQpO1xyXG4gICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJhYmlsaXRpZXNcIiwgbmV3SWQpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBjaGFuZ2VEZXNjcmlwdGlvbnMucHVzaChgPHN0cmlrZT4ke29sZFRleHR9PC9zdHJpa2U+YCk7XHJcbiAgICAgICAgICBpZiAobmV3SWQpIHtcclxuICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0YXNrQ291cnNlQ29kZXMgPSBuZXcgU2V0PHN0cmluZz4odGFzay50YWdzID8gXHJcbiAgICAgICAgdGFzay50YWdzLmZpbHRlcih0ID0+IHQuc3RhcnRzV2l0aCgnY291cnNlOicpKS5tYXAodCA9PiB0LnN1YnN0cihcImNvdXJzZTpcIi5sZW5ndGgpKSA6XHJcbiAgICAgICAgW10pO1xyXG5cclxuICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGxpbmtlZElkcyAoZm9yIHRoaXMgcGFydGljdWxhciB0YXNrKSBmb3IgdGhlIGZvbGxvd2luZyByZWFzb246XHJcbiAgICAgIC8vIExldCdzIHNheSB0aGUgdGFzayB3YXMgcmVmZXJyZWQgdG8gYnkgdHdvIGRpZmZlcmVudCBjb3Vyc2VzIChwb3NzaWJsZSBpbiBvbGQgdmVyc2lvbnMpLFxyXG4gICAgICAvLyBhbmQgaW4gb2xkIENlbnRyYWwgQ29udGVudCwgdGhlIHR3byBjb3Vyc2VzIGRpZCBoYXZlIHNsaWdodGx5IGRpZmZlcmVudCBmb3JtdWxhdGlvbnMgb2YgY2VudHJhbCBjb250ZW50LFxyXG4gICAgICAvLyBzbyB0aGUgdGFzayB3YXMgbWFwcGVkIHRvIGJvdGggb2YgdGhlbS4gVGhlbiwgaW4gbmV3IFhNTCwgdGhlIHNhbWUgY2VudHJhbCBjb250ZW50IHdhcyBmb3JtdWxhdGVkXHJcbiAgICAgIC8vIGluIGEgbmV3IHdheSB0aGF0IGlzIGlkZW50aWNhbCB0aGlzIHRpbWUgYmV0d2VlbiB0aGUgdHdvIGNvdXJzZXMuIFRoZW4gYm90aCBvbGQgSURzIHdpbGwgYmUgcmVwbGFjZWRcclxuICAgICAgLy8gYnkgYSBzaW5nbGUgbmV3IElELiBJdCB3b3VsZCB0aGVuIGJlIHVubmVzY2Vzc2FyeSB0byBsaW5rIHRvIHRoZSBuZXcgSUQgdHdpY2UuXHJcbiAgICAgIGNvbnN0IGxpbmtlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHtrcnNUb01pZ3JhdGUsIGNjc1RvTWlncmF0ZSwgY291cnNlQ29kZX0gb2YgaWRzVG9NaWdyYXRlUGVyQ291cnNlKSB7XHJcbiAgICAgICAgaWYgKHRhc2tDb3Vyc2VDb2Rlcy5zaXplID09PSAwIHx8IHRhc2tDb3Vyc2VDb2Rlcy5oYXMoY291cnNlQ29kZSkpIHtcclxuICAgICAgICAgIGZvciAoY29uc3Qge2lkfSBvZiB0YXNrLmNlbnRyYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1pZ3JhdGlvbkluZm8gPSBjY3NUb01pZ3JhdGUuZ2V0KGlkKTtcclxuICAgICAgICAgICAgaWYgKG1pZ3JhdGlvbkluZm8pIHtcclxuICAgICAgICAgICAgICBsZXQge25ld0lkLCBuZXdUZXh0LCBvbGRUZXh0LCBpc1R5cG9GaXh9ID0gbWlncmF0aW9uSW5mbztcclxuICAgICAgICAgICAgICBsZXQgb2xkSWQgPSBpZDtcclxuICAgICAgICAgICAgICBpZiAob2xkTVQuY2VudHJhbENvbnRlbnRbaWRdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBtaWdyYXRpbmcgc3R1ZmYgdGhhdCB3YXMgbmV2ZXIgYWNrbm93bGVkZ2VzIGJ5IGEgdGVhY2hlcixcclxuICAgICAgICAgICAgICAgIC8vIFdlIHNob3VsZCBwb2ludCBvdXQgdGhlIHZlcnkgb2xkIGlkIGFuZCB0ZXh0IGluc3RlYWQgb2YgdGhlIG5ldmVyLWFja25vd2xlZGdlZCBvbmUuXHJcbiAgICAgICAgICAgICAgICBvbGRUZXh0ID0gb2xkTVQuY2VudHJhbENvbnRlbnRbaWRdLm9sZFRleHQ7XHJcbiAgICAgICAgICAgICAgICBvbGRJZCA9IG9sZE1ULmNlbnRyYWxDb250ZW50W2lkXS5vbGRJZDtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgaWYgKG5ld0lkICYmIG9sZFRleHQgIT09IG5ld1RleHQpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxyXG4gICAgICAgICAgICAgICAgaWYgKCFpc1R5cG9GaXgpIHtcclxuICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXNuJ3QganVzdCBhIHR5cG8gZml4IChjaGFuZ2VzIGluIHN0b3Agd29yZHMsIGNhc2luZyBvciBzcGVjaWFsIGNoYXJhY3RlcnMpXHJcbiAgICAgICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5jZW50cmFsQ29udGVudFtuZXdJZF0gPSB7b2xkSWQsIG9sZFRleHQsIGltcG9ydERhdGV9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBpZiAoIW5ld0lkIHx8ICFsaW5rZWRJZHMuaGFzKG5ld0lkKSkge1xyXG4gICAgICAgICAgICAgICAgbXV0YXRpb25zLnB1c2goYnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBici51bmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBpZCk7XHJcbiAgICAgICAgICAgICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJ0YXNrc1wiLCB0YXNrLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIG5ld0lkKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2goYDxzdHJpa2U+JHtvbGRUZXh0fTwvc3RyaWtlPmApO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld0lkKSB7XHJcbiAgICAgICAgICAgICAgICAgIGNoYW5nZURlc2NyaXB0aW9ucy5wdXNoKG5ld1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICBsaW5rZWRJZHMuYWRkKG5ld0lkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGZvciAoY29uc3Qge2lkfSBvZiB0YXNrLmtub3dsZWRnZVJlcXVpcmVtZW50cykge1xyXG4gICAgICAgICAgICBjb25zdCBtaWdyYXRpb25JbmZvID0ga3JzVG9NaWdyYXRlLmdldChpZCk7XHJcbiAgICAgICAgICAgIGlmIChtaWdyYXRpb25JbmZvKSB7XHJcbiAgICAgICAgICAgICAgbGV0IHtuZXdJZCwgbmV3VGV4dCwgb2xkVGV4dCwgaXNUeXBvRml4fSA9IG1pZ3JhdGlvbkluZm87XHJcbiAgICAgICAgICAgICAgbGV0IG9sZElkID0gaWQ7XHJcbiAgICAgICAgICAgICAgaWYgKG9sZE1ULmtub3dsZWRnZVJlcXVpcmVtZW50c1tpZF0pIHtcclxuICAgICAgICAgICAgICAgIC8vIElmIG1pZ3JhdGluZyBzdHVmZiB0aGF0IHdhcyBuZXZlciBhY2tub3dsZWRnZXMgYnkgYSB0ZWFjaGVyLFxyXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHBvaW50IG91dCB0aGUgdmVyeSBvbGQgaWQgYW5kIHRleHQgaW5zdGVhZCBvZiB0aGUgbmV2ZXItYWNrbm93bGVkZ2VkIG9uZS5cclxuICAgICAgICAgICAgICAgIG9sZFRleHQgPSBvbGRNVC5rbm93bGVkZ2VSZXF1aXJlbWVudHNbaWRdLm9sZFRleHQ7XHJcbiAgICAgICAgICAgICAgICBvbGRJZCA9IG9sZE1ULmtub3dsZWRnZVJlcXVpcmVtZW50c1tpZF0ub2xkSWQ7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIGlmIChuZXdJZCAmJiBvbGRUZXh0ICE9PSBuZXdUZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2U6IElmIG9sZFRleHQgPT09IG5ld1RleHQsIHRoZW4gdGhpcyBpcyBhIHJlaW1wb3J0IG5ldyBYTUwgdGhhdCByZXZlcnRzIGJhY2sgdG8gb3JpZ2luIHRleHQuIERvbid0IHJlcXVpcmUgYWNrbm93bGVkZ2VtZW50IGZyb20gdGVhY2hlciFcclxuICAgICAgICAgICAgICAgIGlmICghaXNUeXBvRml4KSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgd2Fzbid0IGp1c3QgYSB0eXBvIGZpeCAoY2hhbmdlcyBpbiBzdG9wIHdvcmRzLCBjYXNpbmcgb3Igc3BlY2lhbCBjaGFyYWN0ZXJzKVxyXG4gICAgICAgICAgICAgICAgICB0YXNrLm1pZ3JhdGVkVGV4dHMua25vd2xlZGdlUmVxdWlyZW1lbnRzW25ld0lkXSA9IHtvbGRJZCwgb2xkVGV4dCwgaW1wb3J0RGF0ZX07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBpZiAoIW5ld0lkIHx8ICFsaW5rZWRJZHMuaGFzKG5ld0lkKSkge1xyXG4gICAgICAgICAgICAgICAgbXV0YXRpb25zLnB1c2goYnIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBici51bmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgaWQpO1xyXG4gICAgICAgICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgbmV3SWQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2VEZXNjcmlwdGlvbnMucHVzaChgPHN0cmlrZT4ke29sZFRleHR9PC9zdHJpa2U+YCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3SWQpIHtcclxuICAgICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgIGxpbmtlZElkcy5hZGQobmV3SWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICBjaGFuZ2U6IGBNaWdyZXJhZCBVcHBnaWZ0YCxcclxuICAgICAgICBjb250ZW50OiBgPGg0PiR7dGFzay5uYW1lfSAke3Rhc2suc2Nob29sID8gYCgke3Rhc2suc2Nob29sfSkgYCA6ICcoc2tvbGEgZWogYW5naXZlbiknfTwvaDQ+XHJcbiAgICAgICAgICA8cD5LdXJza29kOiAke1suLi50YXNrQ291cnNlQ29kZXNdLmpvaW4oJywnKX08L3A+XHJcbiAgICAgICAgICAke2NoYW5nZURlc2NyaXB0aW9ucy5tYXAodHh0ID0+IGA8cD4ke3R4dH08L3A+YCkuam9pbignJyl9YCxcclxuICAgICAgICBtdXRhdGlvbnM6IGJyID0+IHtcclxuICAgICAgICAgIGJyLnB1dChcInRhc2tzXCIsIHRhc2spO1xyXG4gICAgICAgICAgbXV0YXRpb25zLmZvckVhY2gobSA9PiBtKGJyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFRIRSBSRVNVTFQgV0lMTCBCRTpcclxuICAvLyAgRnVuY3Rpb24gcG9wdWxhdGVzIGEgY29tcGxldGUgc2V0IG9mIENoYW5nZXMgdG8gZGlzcGxheSB0byB1c2VyLlxyXG4gIC8vICBJZiB1c2VyIGNsaWNrcyBcImltcG9ydFwiLCB0aGVzZSBjaGFuZ2VzIHdpbGwgYmUgcGVyZm9ybWVkLlxyXG5cclxuICBcclxuICAvLyBOZXh0IHRoaW5nIHdpbGwgYmUgdG8gbWFrZSB0aGlzIHZpc2libGUgaW4gR1VJOlxyXG4gIC8vICBTaG93IE9wZW5DbG9zZUJveCB3aXRoIHdhcm5pbmcgYmVmb3JlIFwiSW5sw6RtbmluZ3N1cHBnaWZ0XCIgaW4gY2FzZSB0aGVyZSBhcmUgbWlncmF0aW9uVGFza3MuXHJcbiAgLy8gIExpc3Qga25vd2xlZGdlIHJlcXVpcmVtZW50cyBBLCBLUiBDLCBLUiBFLCBjZW50cmFsIGNvbnRlbnRzIGFuZCBhYmlsaXRpZXMgcmVzcGVjdGl2ZWx5IGluIHRvdGFsbHkgbWF4IDUgdGFibGVzLlxyXG4gIC8vICBTYW1lIEdVSSBhcyBrbm93bGVkZ2VSZXF1aXJlbWVudCBtYXRyaXggKGdyZWVuIGhlYWRlcikgcGVyIHRhYmxlLlxyXG4gIC8vICBIZWFkZXJzOiBcIlVyc3BydW5nbGlnIGZvcm11bGVyaW5nXCIsIFwiU2tvbHZlcmtldHMgbnlhIGZvcm11bGVyaW5nXCIsIFwiVMOkY2tlciB1cHBnaWZ0ZW4gZGVuIG55YSBmb3JtdWxlcmluZ2VuP1wiXHJcbiAgLy8gIEZvciBlYWNoIHJvdywgc2hvdyBzdHJpa2UgdGV4dCArIG5ldyB0ZXh0IHdpdGggZ3JlZW4gYmFja2dyb3VuZC4gVGhlbiBJbXBvcnQgRGF0ZS4gVGhlbiBcIkphIC8gTmVqXCIuXHJcbiAgLy8gIFRyeWNrZXIgbWFuIEpBIGVsbGVyIG5laiBzw6UgdGFzIHJhZGVuIGJvcnQuXHJcbiAgLy8gIFRyeWNrZXIgbWFuIE5laiBzw6UgdGFzIMOkdmVuIGtvcHBsaW5nZW4gYm9ydCBvY2gga3Vyc2VyIHNvbSBhbnbDpG5kZXIgdXBwZ2lmdGVuIGthbiBww6V2ZXJrYXMuXHJcbiAgLy9cclxuICAvLyBOw6RzdGEgc2FrIGF0dCBnw7ZyYTogUGlubmEvIHZpc2EgYmVyw7ZyZGEgdXBwZ2lmdGVyIG1lZCBueSBmw6RyZyBlbGxlciBpa29uLlxyXG4gIC8vIE9ja3PDpSwgaMO2Z3N0IHVwcCBww6Uga3Vycy1zaWRhbiAoa3Vyc2J5Z2cpOiBWaXNhIHNhbW1hIHZhcm5pbmdzdHJpYW5nZWwgT3BlbkNsb3NlQm94IG9jaCBsaXN0YVxyXG4gIC8vIMOkbmRyYWRlIGZvcm11bGVyaW5nYXIgKyBiZXLDtnJkYSB1cHBnaWZ0ZXIuIE9tIG1hbiBpbnRlIMOkciByZWRpZ2VyaW5nc2JlaMO2cmlnIGF2IGVuIHVwcGdpZnQgYsO2clxyXG4gIC8vIG1hbiBrb250YWt0YSB1cHBnaWZ0ZW5zIMOkZ2FyZSBmw7ZyIGF0dCBncmFuc2thIG1pZ3JlcmluZ2VuLlxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCwgc2hvd0luZm8sIGNvbXBhcmVQcm9wLCBhcnJheVRvTG9va3VwLCBmbGF0dGVuIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XHJcbmltcG9ydCB7IFNrb2x2ZXJrZXRTdWJqZWN0LCBTa29sdmVya2V0Q291cnNlLCBwYXJzZVNrb2x2ZXJrZXRZZWFycyB9IGZyb20gJy4vc2tvbHZlcmtldC1zdWJqZWN0JztcclxuaW1wb3J0IHsgVXBsb2FkZWRTdWJqZWN0IH0gZnJvbSAnLi91cGxvYWRlZC1zdWJqZWN0JztcclxuZXhwb3J0IHsgU2hvd1N1YmplY3QgfSBmcm9tICcuL3Nob3ctc3ViamVjdCc7XHJcbmltcG9ydCB7IEhhc2hSb3V0ZXIgYXMgUm91dGVyLCBSb3V0ZSwgTGluaywgUmVkaXJlY3QgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgcmVhZEJsb2JBc1RleHQsIGFsbG93Q29weSB9IGZyb20gXCIuLi91dGlsc1wiO1xyXG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xyXG5pbXBvcnQgeyBTdWJqZWN0c0lubmVyIH0gZnJvbSAnLi9zdWJqZWN0cy1pbm5lcic7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGZlZWRiYWNrVXJsOiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFN1YmplY3RzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBpc0xpc3RpbmdTdWJqZWN0czogdHJ1ZSxcclxuICAgICAgcHJpbWFyeVNjaG9vbFN1YmplY3RzOiBbXSxcclxuICAgICAgdXBsb2FkZWRTdWJqZWN0OiBudWxsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgcmV0dXJuIDxkaXY+PENvdXJzZUJhbm5lclxyXG4gICAgICB0aXRsZT17TGDDhG1uZW5gfVxyXG4gICAgICBhY3RpdmVQYWdlPVwic3ViamVjdHNcIlxyXG4gICAgICByb3V0ZXM9e3tmZWVkYmFjazogdGhpcy5wcm9wcy5mZWVkYmFja1VybH19XHJcbiAgICAgLz5cclxuICAgICA8U3ViamVjdHNJbm5lciBsaW5rUHJlZml4PVwiL3N1YmplY3RzL1wiIC8+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IEhhc2hSb3V0ZXIgYXMgUm91dGVyLCBSb3V0ZSwgTGluaywgUmVkaXJlY3QgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgaWQ6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIHN1YmplY3Q6IFN1YmplY3RcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNob3dTdWJqZWN0SW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7c3ViamVjdDogbnVsbH07XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWQoKSB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0PFN1YmplY3Q+KCdzdWJqZWN0cycsIHRoaXMucHJvcHMuaWQsIHsgaW5jbHVkZTogJ2NvdXJzZVRlbXBsYXRlcycgfSk7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgc3ViamVjdCB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGlmICghdGhpcy5zdGF0ZS5zdWJqZWN0KSByZXR1cm4gPHA+PFNwaW5uZXIgLz48L3A+O1xyXG4gICAgY29uc3QgeyBuYW1lLCBjb2RlLCBjb3Vyc2VUZW1wbGF0ZXMsIHNjaG9vbFR5cGUgfSA9IHRoaXMuc3RhdGUuc3ViamVjdDtcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICB7c2Nob29sVHlwZSA9PT0gJ3ByaW1hcnknID8gPD5cclxuICAgICAgICA8aDI+R3J1bmRza29sZcOkbW5ldCB7bmFtZX0gKHtjb2RlfSk8L2gyPlxyXG4gICAgICAgIDx1bCBjbGFzc05hbWU9XCJlbnRpdHktbGlzdFwiPlxyXG4gICAgICAgICAge2NvdXJzZVRlbXBsYXRlcy5tYXAoKHtpZCwgY29kZSwgcHVibGlzaGFibGUsIHBvaW50cywgc2Nob29sR3JhZGV9KSA9PlxyXG4gICAgICAgICAgPGxpIGtleT17aWR9IGNsYXNzTmFtZT1cImNvbXBsZXRlXCI+XHJcbiAgICAgICAgICAgIHtuYW1lfSBmw7ZyIMOlcnNrdXJzIHtzY2hvb2xHcmFkZX1cclxuICAgICAgICAgIDwvbGk+KX1cclxuICAgICAgICA8L3VsPlxyXG4gICAgICA8Lz4gIDogPD5cclxuICAgICAgICA8aDI+S3Vyc2VyIGbDtnIgw6RtbmV0IHtuYW1lfSAoe2NvZGV9KTwvaDI+XHJcbiAgICAgICAgPHVsIGNsYXNzTmFtZT1cImVudGl0eS1saXN0XCI+XHJcbiAgICAgICAgICB7Y291cnNlVGVtcGxhdGVzLm1hcCgoe2lkLCBuYW1lLCBjb2RlLCBwdWJsaXNoYWJsZSwgcG9pbnRzfSkgPT5cclxuICAgICAgICAgIDxsaSBrZXk9e2lkfSBjbGFzc05hbWU9XCJjb21wbGV0ZVwiPlxyXG4gICAgICAgICAgICB7bmFtZX0gLSB7cG9pbnRzfXBcclxuICAgICAgICAgIDwvbGk+KX1cclxuICAgICAgICA8L3VsPlxyXG4gICAgICA8Lz59XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBIYXNoUm91dGVyIGFzIFJvdXRlciwgUm91dGUsIExpbmssIFJlZGlyZWN0IH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XHJcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XHJcbmltcG9ydCB7IFNob3dTdWJqZWN0SW5uZXIgfSBmcm9tICcuL3Nob3ctc3ViamVjdC1pbm5lcic7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGlkOiBzdHJpbmdcclxuICBmZWVkYmFja1VybDogc3RyaW5nXHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgc3ViamVjdDogU3ViamVjdFxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2hvd1N1YmplY3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7c3ViamVjdDogbnVsbH07XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvYWQoKSB7XHJcbiAgICBjb25zdCBzdWJqZWN0ID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0PFN1YmplY3Q+KCdzdWJqZWN0cycsIHRoaXMucHJvcHMuaWQsIHsgaW5jbHVkZTogJ2NvdXJzZVRlbXBsYXRlcycgfSk7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgc3ViamVjdCB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGlmICghdGhpcy5zdGF0ZS5zdWJqZWN0KSByZXR1cm4gPHA+PFNwaW5uZXIgLz48L3A+O1xyXG4gICAgY29uc3QgeyBuYW1lLCBjb2RlLCBjb3Vyc2VUZW1wbGF0ZXMsIHNjaG9vbFR5cGUgfSA9IHRoaXMuc3RhdGUuc3ViamVjdDtcclxuICAgIHJldHVybiA8ZGl2PjxDb3Vyc2VCYW5uZXJcclxuICAgICAgdGl0bGU9e25hbWV9XHJcbiAgICAgIGFjdGl2ZVBhZ2U9XCJzdWJqZWN0c1wiXHJcbiAgICAgIHJvdXRlcz17e2ZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsfX1cclxuICAgICAgIC8+XHJcbiAgICAgICA8U2hvd1N1YmplY3RJbm5lciBpZD17dGhpcy5wcm9wcy5pZH0gLz5cclxuICAgIDwvZGl2PjtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGludGVyZmFjZSBTa29sdmVya2V0U3ViamVjdCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHNjaG9vbFR5cGU6ICdneW1uYXNpdW0nIHwgJ3ByaW1hcnknO1xyXG4gIGNvZGU6IHN0cmluZztcclxuICBwdXJwb3NlOiBzdHJpbmc7XHJcbiAgY291cnNlczogU2tvbHZlcmtldENvdXJzZVtdO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNrb2x2ZXJrZXRDb3Vyc2Uge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgY29kZTogc3RyaW5nO1xyXG4gICAgY2VudHJhbENvbnRlbnQ6IHN0cmluZztcclxuICAgIHllYXI/OiAnMS0zJyB8ICc0LTYnIHwgJzctOSc7XHJcbiAgICAvL2NlbnRyYWxDb250ZW50OiBBcnJheTx7eWVhcj86IHN0cmluZywgdGV4dDogc3RyaW5nfT47XHJcbiAgICBwb2ludHM6IG51bWJlcjtcclxuICAgIGtub3dubGVkZ2VSZXF1aXJlbWVudHM6IEFycmF5PHtncmFkZVN0ZXA6IHN0cmluZywgdGV4dDogc3RyaW5nfT47XHJcbiAgICAvL2tub3dubGVkZ2VSZXF1aXJlbWVudHM6IEFycmF5PHtncmFkZVN0ZXA6IHN0cmluZywgdGV4dDogc3RyaW5nLCB5ZWFyPzogbnVtYmVyfT47XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVNrb2x2ZXJrZXRZZWFycyAoaW5ZZWFyOiBzdHJpbmcpIDogQXJyYXk8JzEtMycgfCAnNC02JyB8ICc3LTknPiB7XHJcbiAgc3dpdGNoKGluWWVhci50cmltKCkpIHtcclxuICAgIGNhc2UgJzMnOlxyXG4gICAgY2FzZSAnMS0zJzpcclxuICAgICAgcmV0dXJuIFsnMS0zJ107XHJcbiAgICBjYXNlICc2JzpcclxuICAgIGNhc2UgJzQtNic6XHJcbiAgICAgIHJldHVybiBbJzQtNiddO1xyXG4gICAgY2FzZSAnNy05JzpcclxuICAgIGNhc2UgJzknOlxyXG4gICAgICByZXR1cm4gWyc3LTknXTtcclxuICAgIC8vIFNwZWNpYWxzXHJcbiAgICBjYXNlICcxJzogcmV0dXJuIFtcIjEtM1wiXTsgLy8gRsO2cmVrb21tZXIgaSDDpG1uZW5hIFwiU3ZlbnNrYVwiIG9jaCBcIlN2ZW5za2Egc29tIGFuZHJhc3Byw6VrXCJcclxuICAgIGNhc2UgJzFzJzogcmV0dXJuIFtcIjEtM1wiXTsgLy8gRsO2cmVrb21tZXIgaSDDpG1uZW5hIFwiU3ZlbnNrYVwiIG9jaCBcIlN2ZW5za2Egc29tIGFuZHJhc3Byw6VrXCJcclxuICAgIGNhc2UgJzEtNic6IHJldHVybiBbXCIxLTNcIiwgXCI0LTZcIl07IC8vIEbDtnJla29tbWVyIGkgw6RtbmV0IFwiSGVtLSBvY2gga29uc3VtZW50a3Vuc2thcFwiXHJcbiAgICBjYXNlICc0LTknOiByZXR1cm4gW1wiNC02XCIsIFwiNy05XCJdOyAvLyBGw7ZyZWtvbW1lciBpIMOkbW5ldCBcIk1vZGVybmEgc3Byw6VrXCJcclxuICAgIGRlZmF1bHQ6IHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHllYXIgaW4gU2tvbHZlcmtldCBYTUw6ICR7aW5ZZWFyfS4gRXhwZWN0aW5nIDMsNiw5IG9yIDEtMywgNC02LCA3LTlgKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMLCBzaG93SW5mbywgY29tcGFyZVByb3AsIGFycmF5VG9Mb29rdXAsIGZsYXR0ZW4gfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuaW1wb3J0IHsgU2tvbHZlcmtldFN1YmplY3QsIHBhcnNlU2tvbHZlcmtldFllYXJzLCBTa29sdmVya2V0Q291cnNlIH0gZnJvbSAnLi9za29sdmVya2V0LXN1YmplY3QnO1xyXG5pbXBvcnQgeyBVcGxvYWRlZFN1YmplY3QgfSBmcm9tICcuL3VwbG9hZGVkLXN1YmplY3QnO1xyXG5leHBvcnQgeyBTaG93U3ViamVjdCB9IGZyb20gJy4vc2hvdy1zdWJqZWN0JztcclxuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5pbXBvcnQgeyByZWFkQmxvYkFzVGV4dCwgYWxsb3dDb3B5IH0gZnJvbSBcIi4uL3V0aWxzXCI7XHJcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGxpbmtQcmVmaXg6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBneW1uYXNpdW1TdWJqZWN0czogU3ViamVjdFtdO1xyXG4gIHByaW1hcnlTY2hvb2xTdWJqZWN0czogU3ViamVjdFtdO1xyXG4gIGlzTGlzdGluZ1N1YmplY3RzOiBib29sZWFuO1xyXG4gIHVwbG9hZGVkU3ViamVjdDogU2tvbHZlcmtldFN1YmplY3QgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU3ViamVjdHNJbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaXNMaXN0aW5nU3ViamVjdHM6IHRydWUsXHJcbiAgICAgIGd5bW5hc2l1bVN1YmplY3RzOiBbXSxcclxuICAgICAgcHJpbWFyeVNjaG9vbFN1YmplY3RzOiBbXSxcclxuICAgICAgdXBsb2FkZWRTdWJqZWN0OiBudWxsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xyXG4gICAgdGhpcy5sb2FkKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkKCkge1xyXG4gICAgY29uc3Qgc3ViamVjdHMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFN1YmplY3Q+KFwic3ViamVjdHNcIik7XHJcbiAgICBzdWJqZWN0cy5zb3J0KGNvbXBhcmVQcm9wKFwibmFtZVwiKSk7XHJcbiAgICBjb25zdCBneW1uYXNpdW1TdWJqZWN0cyA9IHN1YmplY3RzLmZpbHRlcihzID0+IHMuc2Nob29sVHlwZSAhPT0gJ3ByaW1hcnknKTtcclxuICAgIGNvbnN0IHByaW1hcnlTY2hvb2xTdWJqZWN0cyA9IHN1YmplY3RzLmZpbHRlcihzID0+IHMuc2Nob29sVHlwZSA9PT0gJ3ByaW1hcnknKTtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyBneW1uYXNpdW1TdWJqZWN0cywgcHJpbWFyeVNjaG9vbFN1YmplY3RzLCBpc0xpc3RpbmdTdWJqZWN0czogZmFsc2UgfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBoYW5kbGVGaWxlU2VsZWN0KGV2OiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XHJcbiAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCBmaWxlcyA9IGV2LmRhdGFUcmFuc2Zlci5maWxlcztcclxuICAgIGNvbnN0IHhtbCA9IGF3YWl0IHJlYWRCbG9iQXNUZXh0KGZpbGVzWzBdKTtcclxuICAgIGNvbnN0IGRvYyA9ICQoJC5wYXJzZVhNTCh4bWwpKTtcclxuICAgIGNvbnN0IHR5cGVPZlNjaG9vbGluZyA9XHJcbiAgICAgIGRvYy5maW5kKFwic3ViamVjdD5vcmlnaW5hdG9yVHlwZU9mU2Nob29saW5nXCIpLnRleHQoKS50cmltKCkgfHxcclxuICAgICAgZG9jLmZpbmQoXCJzdWJqZWN0PnR5cGVPZlNjaG9vbGluZ1wiKS50ZXh0KCkudHJpbSgpO1xyXG4gICAgY29uc3Qgc2Nob29sVHlwZTogJ3ByaW1hcnknIHwgJ2d5bW5hc2l1bScgPSB0eXBlT2ZTY2hvb2xpbmcgPT09IFwiQ09NUFVMU09SWV9TQ0hPT0xcIiA/XHJcbiAgICAgICdwcmltYXJ5JyA6XHJcbiAgICAgIHR5cGVPZlNjaG9vbGluZyA9PT0gXCJVUFBFUl9TRUNPTkRBUllfRURVQ0FUSU9OXCIgP1xyXG4gICAgICAgICdneW1uYXNpdW0nIDpcclxuICAgICAgICBudWxsO1xyXG5cclxuICAgIGlmIChzY2hvb2xUeXBlID09PSAnZ3ltbmFzaXVtJykge1xyXG4gICAgICBjb25zdCBtb2RlbDogU2tvbHZlcmtldFN1YmplY3QgPSB7XHJcbiAgICAgICAgbmFtZTogZG9jLmZpbmQoXCJzdWJqZWN0Pm5hbWVcIikudGV4dCgpLnRyaW0oKSxcclxuICAgICAgICBjb2RlOiBkb2MuZmluZChcInN1YmplY3Q+Y29kZVwiKS50ZXh0KCkudHJpbSgpLFxyXG4gICAgICAgIHB1cnBvc2U6IGRvYy5maW5kKFwic3ViamVjdD5wdXJwb3NlXCIpLnRleHQoKS50cmltKCksXHJcbiAgICAgICAgY291cnNlczogW10sXHJcbiAgICAgICAgc2Nob29sVHlwZTogJ2d5bW5hc2l1bSdcclxuICAgICAgfTtcclxuICAgICAgY29uc3QgY291cnNlcyA9IGRvYy5maW5kKFwic3ViamVjdD5jb3Vyc2VzXCIpO1xyXG4gICAgICBmb3IgKGxldCBpPTA7IGk8Y291cnNlcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGNvbnN0IGNvdXJzZSA9ICQoY291cnNlc1tpXSk7XHJcbiAgICAgICAgY29uc3Qga25vd25sZWRnZVJlcXVpcmVtZW50cyA9IFtdLnNsaWNlLmNhbGwoY291cnNlLmZpbmQoXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIikpXHJcbiAgICAgICAgICAubWFwKHIgPT4gKHtcclxuICAgICAgICAgICAgZ3JhZGVTdGVwOiAkKHIpLmZpbmQoJ2dyYWRlU3RlcCcpLnRleHQoKS50cmltKCksXHJcbiAgICAgICAgICAgIHRleHQ6ICQocikuZmluZCgndGV4dCcpLnRleHQoKS50cmltKClcclxuICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbW9kZWwuY291cnNlcy5wdXNoKHtcclxuICAgICAgICAgIG5hbWU6IGNvdXJzZS5maW5kKFwibmFtZVwiKS50ZXh0KCkudHJpbSgpLFxyXG4gICAgICAgICAgY29kZTogY291cnNlLmZpbmQoXCJjb2RlXCIpLnRleHQoKS50cmltKCksXHJcbiAgICAgICAgICBjZW50cmFsQ29udGVudDogY291cnNlLmZpbmQoXCJjZW50cmFsQ29udGVudFwiKS50ZXh0KCkudHJpbSgpLFxyXG4gICAgICAgICAgcG9pbnRzOiBwYXJzZUludChjb3Vyc2UuZmluZChcInBvaW50XCIpLnRleHQoKS50cmltKCkpLFxyXG4gICAgICAgICAga25vd25sZWRnZVJlcXVpcmVtZW50cyxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNldFN0YXRlKHt1cGxvYWRlZFN1YmplY3Q6IG1vZGVsfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBjZW50cmFsQ29udGVudHMgPSBmbGF0dGVuKEFycmF5LmZyb20oZG9jLmZpbmQoXCJzdWJqZWN0PmNlbnRyYWxDb250ZW50XCIpKVxyXG4gICAgICAgIC5tYXAoY2MgPT4ge1xyXG4gICAgICAgICAgY29uc3QgeWVhciA9ICQoY2MpLmZpbmQoJ3llYXInKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZztcclxuICAgICAgICAgIGNvbnN0IHR5cGVPZkNlbnRyYWxDb250ZW50ID0gJChjYykuZmluZCgndHlwZU9mQ2VudHJhbENvbnRlbnQnKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZztcclxuXHJcbiAgICAgICAgICBpZiAodHlwZU9mQ2VudHJhbENvbnRlbnQpIHtcclxuICAgICAgICAgICAgLy8gRG8gbm90IHlldCBzdXBwb3J0IG11bHRpcGxlIHR5cGVzIG9mIGNlbnRyYWwgY29udGVudC5cclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yIChMYMOEbW5ldCBpbm5laMOlbGxlciBmbGVyYSBwYXJhbGxlbGxhIHR5cGVyIGF2IGNlbnRyYWx0IGlubmVow6VsbC4gRGV0dGEgc3TDtmRzIMOkbm51IGludGUuYCk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgY29uc3Qgc3RhZGl1bXMgPSBwYXJzZVNrb2x2ZXJrZXRZZWFycyh5ZWFyKTtcclxuICAgICAgICAgIGNvbnN0IGNlbnRyYWxDb250ZW50c0ZvckVhY2hTdGFkaXVtID0gc3RhZGl1bXMubWFwKCBzdGFkaXVtID0+ICh7XHJcbiAgICAgICAgICAgIHllYXI6IHN0YWRpdW0sXHJcbiAgICAgICAgICAgIHRleHQ6ICQoY2MpLmZpbmQoJ3RleHQnKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZ1xyXG4gICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgcmV0dXJuIGNlbnRyYWxDb250ZW50c0ZvckVhY2hTdGFkaXVtO1xyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgIGNvbnN0IGtub3dsZWRnZVJlcXVpcmVtZW50cyA9IGZsYXR0ZW4oQXJyYXkuZnJvbShkb2MuZmluZChcInN1YmplY3Q+a25vd2xlZGdlUmVxdWlyZW1lbnRcIikpXHJcbiAgICAgICAgLm1hcChrciA9PiB7XHJcbiAgICAgICAgICBjb25zdCB5ZWFyID0gJChrcikuZmluZCgneWVhcicpLnRleHQoKS50cmltKCk7XHJcblxyXG4gICAgICAgICAgY29uc3QgdHlwZU9mUmVxdWlyZW1lbnQgPSAkKGtyKS5maW5kKCd0eXBlT2ZSZXF1aXJlbWVudCcpLnRleHQoKS50cmltKCkgYXMgc3RyaW5nO1xyXG4gICAgICAgICAgaWYgKHR5cGVPZlJlcXVpcmVtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIERvIG5vdCB5ZXQgc3VwcG9ydCBtdWx0aXBsZSB0eXBlcyBvZiBrbm93bGVkZ2UgcmVxdWlyZW1lbnQuXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciAoTGDDhG1uZXQgaW5uZWjDpWxsZXIgZmxlcmEgcGFyYWxsZWxsYSB0eXBlciBhdiBrdW5za2Fwc2tyYXYuIERldHRhIHN0w7ZkcyDDpG5udSBpbnRlLmApO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIHJldHVybiBwYXJzZVNrb2x2ZXJrZXRZZWFycyh5ZWFyKS5tYXAoc3RhZGl1bSA9PiAoe1xyXG4gICAgICAgICAgICB5ZWFyOiBzdGFkaXVtLFxyXG4gICAgICAgICAgICB0ZXh0OiAkKGtyKS5maW5kKCd0ZXh0JykudGV4dCgpLnRyaW0oKSxcclxuICAgICAgICAgICAgZ3JhZGVTdGVwOiAkKGtyKS5maW5kKCdncmFkZVN0ZXAnKS50ZXh0KCkudHJpbSgpXHJcbiAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgY2VudHJhbENvbnRlbnRzQnlTdGFkaXVtID0gYXJyYXlUb0xvb2t1cChjZW50cmFsQ29udGVudHMsIGNjID0+IGNjLnllYXIpO1xyXG4gICAgICBjb25zdCBrbm93bGVkZ2VSZXF1aXJlbWVudHNCeVN0YWRpdW0gPSBhcnJheVRvTG9va3VwKGtub3dsZWRnZVJlcXVpcmVtZW50cywga3IgPT4ga3IueWVhcik7XHJcblxyXG4gICAgICBjb25zdCBzdWJqZWN0TmFtZSA9IGRvYy5maW5kKFwic3ViamVjdD5uYW1lXCIpLnRleHQoKS50cmltKCk7XHJcbiAgICAgIGNvbnN0IHN1YmplY3RDb2RlID0gZG9jLmZpbmQoXCJzdWJqZWN0PmNvZGVcIikudGV4dCgpLnRyaW0oKTtcclxuICAgICAgY29uc3Qgc3ViamVjdFB1cnBvc2UgPSBkb2MuZmluZChcInN1YmplY3Q+cHVycG9zZVwiKS50ZXh0KCkudHJpbSgpO1xyXG4gICAgICAvKlxyXG5cclxuICAgICAgICBQcm9ibGVtYXRpYyB3aGVuIHRoZSBmb2xsb3dpbmcgdGFncyBhcmUgcHJlc2VudDpcclxuXHJcbiAgICAgICAgPHR5cGVPZlJlcXVpcmVtZW50PlxyXG4gICAgICAgICAgV0lUSElOX1NUVURFTlRfQ0hPSUNFX0NISU5FU0VcclxuICAgICAgICA8L3R5cGVPZlJlcXVpcmVtZW50PlxyXG4gICAgICAgIDx0eXBlT2ZDZW50cmFsQ29udGVudD5cclxuICAgICAgICAgIFdJVEhJTl9MQU5HVUFHRV9DSE9JQ0VcclxuICAgICAgICA8L3R5cGVPZkNlbnRyYWxDb250ZW50PlxyXG4gICAgICAqL1xyXG5cclxuICAgICAgY29uc3QgY291cnNlc0J5U3RhZGl1bTogU2tvbHZlcmtldENvdXJzZVtdID0gKFsnMS0zJywnNC02JywnNy05J10gYXMgQXJyYXk8JzEtMycgfCAnNC02JyB8ICc3LTknPilcclxuICAgICAgICAubWFwKHN0YWRpdW0gPT4gKHtcclxuICAgICAgICAgIG5hbWU6IHN1YmplY3ROYW1lKycgJytzdGFkaXVtLFxyXG4gICAgICAgICAgY29kZTogc3ViamVjdENvZGUrJ3wnK3N0YWRpdW0sXHJcbiAgICAgICAgICBwb2ludHM6IDAsXHJcbiAgICAgICAgICB5ZWFyOiBzdGFkaXVtLFxyXG4gICAgICAgICAgY2VudHJhbENvbnRlbnQ6IChjZW50cmFsQ29udGVudHNCeVN0YWRpdW1bc3RhZGl1bV18fFtdKS5tYXAoY2MgPT4gY2MudGV4dCkuam9pbignXFxuJyksXHJcbiAgICAgICAgICBrbm93bmxlZGdlUmVxdWlyZW1lbnRzOiAoa25vd2xlZGdlUmVxdWlyZW1lbnRzQnlTdGFkaXVtW3N0YWRpdW1dfHxbXSkubWFwKCh7Z3JhZGVTdGVwLCB0ZXh0fSkgPT4gKHtncmFkZVN0ZXAsIHRleHR9KSlcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICBjb25zdCBtb2RlbDogU2tvbHZlcmtldFN1YmplY3QgPSB7XHJcbiAgICAgICAgbmFtZTogc3ViamVjdE5hbWUsXHJcbiAgICAgICAgY29kZTogc3ViamVjdENvZGUsXHJcbiAgICAgICAgcHVycG9zZTogc3ViamVjdFB1cnBvc2UsXHJcbiAgICAgICAgc2Nob29sVHlwZTogJ3ByaW1hcnknLFxyXG4gICAgICAgIGNvdXJzZXM6IGNvdXJzZXNCeVN0YWRpdW1cclxuICAgICAgfTtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBsb2FkZWRTdWJqZWN0OiBtb2RlbH0pO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gIH1cclxuXHJcbiAgb25JbXBvcnRTdWNjZXNzKHN1YmplY3QpIHtcclxuICAgICBzaG93SW5mbyhMYEltcG9ydGVuIGF2ICR7c3ViamVjdH0gbHlja2FkZXNgKTtcclxuICAgICB0aGlzLnNldFN0YXRlKHt1cGxvYWRlZFN1YmplY3Q6IG51bGx9KTtcclxuICAgICB0aGlzLmxvYWQoKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtsaW5rUHJlZml4fSA9IHRoaXMucHJvcHM7XHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAge3RoaXMuc3RhdGUudXBsb2FkZWRTdWJqZWN0ID9cclxuICAgICAgPFVwbG9hZGVkU3ViamVjdFxyXG4gICAgICAgIG9uQ2FuY2VsPXsoKT0+dGhpcy5zZXRTdGF0ZSh7dXBsb2FkZWRTdWJqZWN0OiBudWxsfSl9XHJcbiAgICAgICAgb25JbXBvcnRTdWNjZXNzPXtzdWJqZWN0ID0+IHRoaXMub25JbXBvcnRTdWNjZXNzKHN1YmplY3QpfVxyXG4gICAgICAgIHN1YmplY3Q9e3RoaXMuc3RhdGUudXBsb2FkZWRTdWJqZWN0fSAvPlxyXG4gICAgOiB0aGlzLnN0YXRlLmlzTGlzdGluZ1N1YmplY3RzID9cclxuICAgICAgPGRpdj48cD48U3Bpbm5lci8+VmFyIGdvZCB2w6RudGEgbWVkYW4gw6RtbmVuIGjDpG10YXMuLi48L3A+PC9kaXY+IDpcclxuICAgICAgPGRpdj5cclxuICAgICAgICA8aDI+e0xgR3ltbmFzaWXDpG1uZW5gfTwvaDI+XHJcbiAgICAgICAgPHVsPnt0aGlzLnN0YXRlLmd5bW5hc2l1bVN1YmplY3RzLm1hcChzID0+XHJcbiAgICAgICAgICA8bGkga2V5PXtzLmlkfSBjbGFzc05hbWU9e3MucHVibGlzaGFibGUgPyBcImNvbXBsZXRlXCIgOiBcImluY29tcGxldGVcIn0+XHJcbiAgICAgICAgICAgIDxMaW5rIHRvPXtsaW5rUHJlZml4ICsgcy5pZH0+e3MubmFtZX08L0xpbms+XHJcbiAgICAgICAgICA8L2xpPil9XHJcbiAgICAgICAgPC91bD5cclxuICAgICAgICA8aDI+e0xgR3J1bmRza29sZcOkbW5lbmB9PC9oMj5cclxuICAgICAgICA8dWw+e3RoaXMuc3RhdGUucHJpbWFyeVNjaG9vbFN1YmplY3RzLm1hcChzID0+XHJcbiAgICAgICAgICA8bGkga2V5PXtzLmlkfSBjbGFzc05hbWU9e3MucHVibGlzaGFibGUgPyBcImNvbXBsZXRlXCIgOiBcImluY29tcGxldGVcIn0+XHJcbiAgICAgICAgICAgIDxMaW5rIHRvPXtsaW5rUHJlZml4ICsgcy5pZH0+e3MubmFtZX08L0xpbms+XHJcbiAgICAgICAgICA8L2xpPil9XHJcbiAgICAgICAgPC91bD5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRyb3Atem9uZVwiIG9uRHJhZ092ZXI9e2FsbG93Q29weX0gb25Ecm9wPXtldj0+dGhpcy5oYW5kbGVGaWxlU2VsZWN0KGV2KX0+XHJcbiAgICAgICAgICBEcm9wcGEgU3ViamVjdC1maWwgaMOkciBmcsOlbiBza29sdmVya2V0IChIw6RtdGFzIGZyw6VuIDxhIGhyZWY9XCJodHRwOi8vb3BlbmRhdGEuc2tvbHZlcmtldC5zZVwiIHRhcmdldD1cInNrb2x2ZXJrZXRcIj5vcGVuZGF0YS5za29sdmVya2V0LnNlPC9hPilcclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICB9PC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgU2tvbHZlcmtldFN1YmplY3QsIFNrb2x2ZXJrZXRDb3Vyc2UgfSBmcm9tICcuL3Nrb2x2ZXJrZXQtc3ViamVjdCc7XHJcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgU3ViamVjdCwgQ291cnNlLCBBYmlsaXR5LCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQ2VudHJhbENvbnRlbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IE11dGF0aW9uUmVxdWVzdCwgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gJy4vZGlmZi9jaGFuZ2UnO1xyXG5pbXBvcnQgeyBTdWJqZWN0VG9JbXBvcnQsIENvdXJzZVRvSW1wb3J0IH0gZnJvbSAnLi9zdWJqZWN0LXRvLWltcG9ydCc7XHJcbmltcG9ydCB7IGRpZmZYbWxXaXRoRGF0YWJhc2UgfSBmcm9tICcuL2RpZmYvZGlmZi14bWwtd2l0aC1kYXRhYmFzZSc7XHJcbmltcG9ydCB7IGxvYWRDb3Vyc2UgfSBmcm9tICcuLi91dGlscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIG9uQ2FuY2VsOiAoKSA9PiB2b2lkO1xyXG4gIG9uSW1wb3J0U3VjY2VzczogKHN1YmplY3Q6IHN0cmluZykgPT4gdm9pZDtcclxuICBzdWJqZWN0OiBTa29sdmVya2V0U3ViamVjdDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBzaG93RnVsbFRleHQ6IGJvb2xlYW47XHJcbiAgY2hhbmdlczogQ2hhbmdlW107XHJcbiAgc3ViamVjdFRvSW1wb3J0PzogU3ViamVjdFRvSW1wb3J0O1xyXG4gIGlzV29ya2luZzogYm9vbGVhbjtcclxuICBpc0ltcG9ydGluZzogYm9vbGVhbjtcclxuICBlcnJvcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFVwbG9hZGVkU3ViamVjdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuICBwdXJwb3NlRWxlbTogSFRNTEVsZW1lbnQ7XHJcbiAgY291cnNlc0VsZW1zOiB7IFtjb3Vyc2VDb2RlOiBzdHJpbmddOiB7IGNvdXJzZTogU2tvbHZlcmtldENvdXJzZSwgZWxlbTogSFRNTEVsZW1lbnQgfSB9O1xyXG4gIGNlbnRyYWxDb250ZW50RWxlbXM6IEhUTUxFbGVtZW50W107XHJcbiAga25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtczogSFRNTEVsZW1lbnRbXTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLmNvdXJzZXNFbGVtcyA9IHt9O1xyXG4gICAgdGhpcy5jZW50cmFsQ29udGVudEVsZW1zID0gW107XHJcbiAgICB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMgPSBbXTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHNob3dGdWxsVGV4dDogZmFsc2UsXHJcbiAgICAgIGNoYW5nZXM6IFtdLFxyXG4gICAgICBpc1dvcmtpbmc6IHRydWUsXHJcbiAgICAgIGlzSW1wb3J0aW5nOiBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdGhpcy5hZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHtjaGFuZ2VzLCBzdWJqZWN0VG9JbXBvcnR9ID0gYXdhaXQgdGhpcy5kaWZmV2l0aEV4aXN0aW5nKCk7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBjaGFuZ2VzLCBzdWJqZWN0VG9JbXBvcnQgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHsgZXJyb3I6ICcnK2Vycm9yIH0pO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzV29ya2luZzogZmFsc2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKSB7XHJcbiAgICBjb25zdCBhYmlsaXRpZXMgPSAkKHRoaXMucHVycG9zZUVsZW0pLmZpbmQoJ2xpJykuZmlyc3QoKS5wYXJlbnQoKS5jaGlsZHJlbignbGknKTtcclxuICAgIGFiaWxpdGllcy5hZGRDbGFzcygnYWJpbGl0eScpO1xyXG4gICAgY29uc3QgY2VudHJhbENvbnRlbnRzID0gJCh0aGlzLmNlbnRyYWxDb250ZW50RWxlbXMpLmZpbmQoJ2xpJyk7XHJcbiAgICBjZW50cmFsQ29udGVudHMuYWRkQ2xhc3MoJ2NlbnRyYWwtY29udGVudCcpO1xyXG4gICAgY29uc3Qga25vd2xlZGdlUmVxdWlyZW1lbnRzID0gJCh0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMpLmZpbmQoJ3AnKTtcclxuICAgIGtub3dsZWRnZVJlcXVpcmVtZW50cy5hZGRDbGFzcygna25vd2xlZGdlLXJlcXVpcmVtZW50Jyk7XHJcbiAgICBjb25zdCBhbGwgPSAkKFthYmlsaXRpZXMsIGNlbnRyYWxDb250ZW50cywga25vd2xlZGdlUmVxdWlyZW1lbnRzXSk7XHJcbiAgICBhbGwuYWRkQ2xhc3MoJ21hcmtlZC1hcmVhJyk7XHJcbiAgfVxyXG5cclxuICBjaGVycnlQaWNrRGF0YSgpOiBTdWJqZWN0VG9JbXBvcnQge1xyXG4gICAgLy9cclxuICAgIC8vIFJlYWRzIGVsZW1lbnRzICh0YWdnZWQgYnkgY2xhc3NlcyBpbiBhZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKSkgYW5kIGNvbnZlcnRzIHRoZWlyIGlubmVyIEhUTUwgdG8gdGhlIGNvcnJlc3BvbmRpbmdcclxuICAgIC8vIG1vZGVsIFN1YmplY3RUb0ltcG9ydC4gTm90ZSB0aGF0IGlmIHdlIG5lZWQgdG8gYWRqdXN0IGhvdyB0byBwaWNrIHRoZSByaWdodCBMSSBvciBQIGVsZW1lbnRzLCB3ZVxyXG4gICAgLy8gd2lsbCBvbmx5IG5lZWQgdG8gY2hhbmdlIHRoZSBjb2RlIGluIGFkZENsYXNzZXNGb3JDaGVycnlQaWNrZWRFbGVtZW50cygpLCBub3QgdGhpcyBjb2RlLlxyXG4gICAgLy9cclxuICAgIGNvbnN0IHNrb2xTdWJqZWN0ID0gdGhpcy5wcm9wcy5zdWJqZWN0O1xyXG4gICAgY29uc3QgYWJpbGl0aWVzTGlzID0gQXJyYXkuZnJvbSgkKHRoaXMucHVycG9zZUVsZW0pLmZpbmQoJ2xpJykuZmlyc3QoKS5wYXJlbnQoKS5jaGlsZHJlbignbGknKSk7XHJcbiAgICBjb25zdCBhYmlsaXRpZXMgPSBhYmlsaXRpZXNMaXMubWFwKChhLCBpKSA9PiBgJHtpICsgMX0uICR7JChhKS5odG1sKCl9YC50cmltKCkpLmZpbHRlcihodG1sID0+ICEhaHRtbCk7XHJcblxyXG4gICAgY29uc3QgcmVzdWx0OiBTdWJqZWN0VG9JbXBvcnQgPSB7XHJcbiAgICAgIG5hbWU6IHNrb2xTdWJqZWN0Lm5hbWUsXHJcbiAgICAgIGNvZGU6IHNrb2xTdWJqZWN0LmNvZGUsXHJcbiAgICAgIHNjaG9vbFR5cGU6IHNrb2xTdWJqZWN0LnNjaG9vbFR5cGUsXHJcbiAgICAgIGFiaWxpdGllcyxcclxuICAgICAgY291cnNlczogT2JqZWN0LmtleXModGhpcy5jb3Vyc2VzRWxlbXMpXHJcbiAgICAgICAgLm1hcChjb3Vyc2VDb2RlID0+IHRoaXMuY291cnNlc0VsZW1zW2NvdXJzZUNvZGVdKVxyXG4gICAgICAgIC5tYXA8Q291cnNlVG9JbXBvcnQ+KCh7IGNvdXJzZSwgZWxlbSB9KSA9PiAoe1xyXG4gICAgICAgICAgbmFtZTogY291cnNlLm5hbWUsXHJcbiAgICAgICAgICB5ZWFyOiBjb3Vyc2UueWVhcixcclxuICAgICAgICAgIGNvZGU6IGNvdXJzZS5jb2RlLFxyXG4gICAgICAgICAgcG9pbnRzOiBjb3Vyc2UucG9pbnRzLFxyXG4gICAgICAgICAgY2VudHJhbENvbnRlbnQ6IEFycmF5LmZyb20oJChlbGVtKS5maW5kKCcuY2VudHJhbC1jb250ZW50JykpLm1hcChjID0+ICh7XHJcbiAgICAgICAgICAgIGh0bWw6ICQoYykuaHRtbCgpLnRyaW0oKSBhcyBzdHJpbmcsXHJcbiAgICAgICAgICAgIGdyb3VwOiAkKGMpLnBhcmVudCgndWwnKS5wcmV2KCdoNCcpLnRleHQoKS50cmltKClcclxuICAgICAgICAgIH0pKS5maWx0ZXIoKHtodG1sfSkgPT4gISFodG1sKSxcclxuICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50czpcclxuICAgICAgICAgICAgQXJyYXkuZnJvbSgkKGVsZW0pLmZpbmQoJy5ncmFkZS1zdGVwLW5vbmUgLmtub3dsZWRnZS1yZXF1aXJlbWVudCcpKS5tYXAociA9PiAkKHIpLmh0bWwoKS50cmltKCkpXHJcbiAgICAgICAgICAgICAgLmZpbHRlcihodG1sID0+ICEhaHRtbClcclxuICAgICAgICAgICAgICAubWFwKGh0bWwgPT4gKHtncmFkZVN0ZXA6IG51bGwsIGh0bWwgfSkpXHJcbiAgICAgICAgICAgICAgLmNvbmNhdChcclxuICAgICAgICAgICAgICAgIEFycmF5LmZyb20oJChlbGVtKS5maW5kKCcuZ3JhZGUtc3RlcC1FIC5rbm93bGVkZ2UtcmVxdWlyZW1lbnQnKSkubWFwKHIgPT4gJChyKS5odG1sKCkudHJpbSgpKVxyXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGh0bWwgPT4gISFodG1sKVxyXG4gICAgICAgICAgICAgICAgICAubWFwKGh0bWwgPT4gKHsgZ3JhZGVTdGVwOiBcIkVcIiwgaHRtbCB9KSlcclxuICAgICAgICAgICAgICAgICAgLmNvbmNhdChcclxuICAgICAgICAgICAgICAgICAgICBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmdyYWRlLXN0ZXAtQyAua25vd2xlZGdlLXJlcXVpcmVtZW50JykpLm1hcChyID0+ICQocikuaHRtbCgpLnRyaW0oKSlcclxuICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaHRtbCA9PiAhIWh0bWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAubWFwKGh0bWwgPT4gKHsgZ3JhZGVTdGVwOiBcIkNcIiwgaHRtbCB9KSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmdyYWRlLXN0ZXAtQSAua25vd2xlZGdlLXJlcXVpcmVtZW50JykpLm1hcChyID0+ICQocikuaHRtbCgpLnRyaW0oKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGh0bWwgPT4gISFodG1sKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoaHRtbCA9PiAoeyBncmFkZVN0ZXA6IFwiQVwiLCBodG1sIH0pKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxuICB9XHJcblxyXG4gIGFzeW5jIGRpZmZXaXRoRXhpc3RpbmcoKTogUHJvbWlzZTx7Y2hhbmdlczogQ2hhbmdlW10sIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0fT4ge1xyXG4gICAgY29uc3Qgc3ViamVjdFRvSW1wb3J0ID0gdGhpcy5jaGVycnlQaWNrRGF0YSgpO1xyXG4gICAgbGV0IGNoYW5nZXM6IENoYW5nZVtdID0gW107XHJcbiAgICAvLyBGaW5kIGV4aXN0aW5nIFN1YmplY3RcclxuICAgIGNvbnN0IGV4aXN0aW5nU3ViamVjdHMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFN1YmplY3Q+KFwic3ViamVjdHNcIik7XHJcbiAgICBsZXQgZXhpc3RpbmdTdWJqZWN0ID0gZXhpc3RpbmdTdWJqZWN0cy5maWx0ZXIocyA9PiBzLmNvZGUgPT09IHRoaXMucHJvcHMuc3ViamVjdC5jb2RlKVswXTtcclxuICAgIGxldCBjZW50cmFsQ29udGVudCA9IFtdIGFzIENlbnRyYWxDb250ZW50W10sXHJcbiAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50cyA9IFtdIGFzIEtub3dsZWRnZVJlcXVpcmVtZW50W107XHJcblxyXG4gICAgbGV0IGNyZWF0ZVRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgZnVuY3Rpb24gY3QoKSB7XHJcbiAgICAgIGNvbnN0IHJ2ID0gY3JlYXRlVGltZTtcclxuICAgICAgY3JlYXRlVGltZSArPSAyO1xyXG4gICAgICByZXR1cm4gcnY7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV4aXN0aW5nU3ViamVjdCkge1xyXG4gICAgICAvLyBJbmNsdWRlIGFiaWxpdGllcyBhbmQgc3RhbmRhcmRDb3Vyc2VzIHdpdGggdGhlIGZvdW5kIFN1YmplY3Q6XHJcbiAgICAgIGF3YWl0IGRpZmZYbWxXaXRoRGF0YWJhc2UoZXhpc3RpbmdTdWJqZWN0LCBzdWJqZWN0VG9JbXBvcnQsIGNoYW5nZXMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gU3ViamVjdCBub3QgaW1wb3J0ZWQgYmVmb3JlLiBBZGQgaXQhXHJcbiAgICAgIGNvbnN0IG5ld1N1YmplY3Q6IFN1YmplY3QgPSBleGlzdGluZ1N1YmplY3QgPSB7XHJcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICBzY2hvb2xUeXBlOiBzdWJqZWN0VG9JbXBvcnQuc2Nob29sVHlwZSxcclxuICAgICAgICB0YWdzOiBbXCJzY2hvb2xUeXBlOlwiICsgc3ViamVjdFRvSW1wb3J0LnNjaG9vbFR5cGVdLFxyXG4gICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXHJcbiAgICAgICAgY29kZTogc3ViamVjdFRvSW1wb3J0LmNvZGUsXHJcbiAgICAgICAgbmFtZTogc3ViamVjdFRvSW1wb3J0Lm5hbWUsXHJcbiAgICAgICAgYWJpbGl0aWVzT3JkZXI6IFtdLCAvLyBVcGRhdGUgbGF0ZXIgb24hXHJcbiAgICAgICAgcHVibGlzaGFibGU6IGZhbHNlLFxyXG4gICAgICAgIGRhdGVUaW1lOiBjdCgpXHJcbiAgICAgIH07XHJcbiAgICAgIGNoYW5nZXMucHVzaCh7XHJcbiAgICAgICAgY2hhbmdlOiBcIk55dHQgw6RtbmVcIixcclxuICAgICAgICBjb250ZW50OiBgJHtzdWJqZWN0VG9JbXBvcnQubmFtZX0gKCR7c3ViamVjdFRvSW1wb3J0LmNvZGV9KWAsXHJcbiAgICAgICAgbXV0YXRpb25zOiByID0+IHIuYWRkKFwic3ViamVjdHNcIiwgbmV3U3ViamVjdClcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBzdWJqZWN0QWJpbGl0aWVzID0gW107XHJcblxyXG4gICAgICBmb3IgKGxldCBhIG9mIHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMpIHtcclxuICAgICAgICBjb25zdCBuZXdBYmlsaXR5OiBBYmlsaXR5ID0ge1xyXG4gICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICAgIG5hbWU6IGEsXHJcbiAgICAgICAgICBhY2w6IFtcInJvbGU6VVNFUjpSXCJdLFxyXG4gICAgICAgICAgZGF0ZVRpbWU6IGN0KClcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzdWJqZWN0QWJpbGl0aWVzLnB1c2gobmV3QWJpbGl0eSk7IC8vIFRvIHJlZmVyIGZyb20gaW4gY291cnNlcyBsYXRlciBvbiFcclxuXHJcbiAgICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICAgIGNoYW5nZTogXCJOeSBmw7ZybcOlZ2FcIixcclxuICAgICAgICAgIGNvbnRlbnQ6IGEsXHJcbiAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xyXG4gICAgICAgICAgICByLmFkZChcImFiaWxpdGllc1wiLCBuZXdBYmlsaXR5KTtcclxuICAgICAgICAgICAgci5saW5rKFwic3ViamVjdHNcIiwgbmV3U3ViamVjdC5pZCwgXCJhYmlsaXRpZXNcIiwgbmV3QWJpbGl0eS5pZCwgXCJhYmlsaXRpZXNcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFVwZGF0ZSBub3cgd2hlbiB3ZSBoYXZlIGFiaWxpdGllcyBvcmRlcjpcclxuICAgICAgbmV3U3ViamVjdC5hYmlsaXRpZXNPcmRlciA9IHN1YmplY3RBYmlsaXRpZXMubWFwKCh7aWR9KSA9PiBpZCk7XHJcblxyXG4gICAgICBmb3IgKGxldCBjIG9mIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzKSB7XHJcbiAgICAgICAgY29uc3QgbmV3Q291cnNlOiBDb3Vyc2UgPSB7XHJcbiAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgICAgc3ViamVjdENvZGU6IG5ld1N1YmplY3QuY29kZSxcclxuICAgICAgICAgIHNjaG9vbFR5cGU6IG5ld1N1YmplY3Quc2Nob29sVHlwZSxcclxuICAgICAgICAgIHRhZ3M6IFtcclxuICAgICAgICAgICAgXCJzdWI6XCIgKyBuZXdTdWJqZWN0LmNvZGUsXHJcbiAgICAgICAgICAgIFwiY291cnNlOlwiICsgYy5jb2RlLFxyXG4gICAgICAgICAgICBcInNjaG9vbFR5cGU6XCIgKyBuZXdTdWJqZWN0LnNjaG9vbFR5cGVcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBkYXRlVGltZTogY3QoKSxcclxuICAgICAgICAgIGlzVGVtcGxhdGU6IHRydWUsXHJcbiAgICAgICAgICBhY2w6IFtcInJvbGU6RU1QTE9ZRUU6UlwiXSwgLy8gU3RhbmRhcmRrdXJzZXIgZW5kYXN0IHN5bmxpZ2EgZsO2ciBsw6RyYXJlXHJcbiAgICAgICAgICBuYW1lOiBjLm5hbWUsXHJcbiAgICAgICAgICBjb2RlOiBjLmNvZGUsXHJcbiAgICAgICAgICBwb2ludHM6IGMucG9pbnRzLFxyXG4gICAgICAgICAgbW9kdWxlczogW10sXHJcbiAgICAgICAgICBzdWJqZWN0SWQ6IG5ld1N1YmplY3QuaWQsXHJcbiAgICAgICAgICByZXNvdXJjZXM6IFtdLFxyXG4gICAgICAgICAgY3JlYXRlZEJ5OiB7IG5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZSwgdXJsOiBcIm1haWx0bzpcIiArIGVudi5jdXJyZW50VXNlci5tYWlsIH0sXHJcbiAgICAgICAgICBjcmVhdGVkRGF0ZTogRGF0ZS5ub3coKSxcclxuICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyOiBbXSxcclxuICAgICAgICAgIGNlbnRyYWxDb250ZW50T3JkZXI6IFtdLFxyXG4gICAgICAgICAgYWJpbGl0aWVzT3JkZXI6IHN1YmplY3RBYmlsaXRpZXMubWFwKCh7aWR9KSA9PiBpZClcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChjLnllYXIpIG5ld0NvdXJzZS5zY2hvb2xHcmFkZSA9IGMueWVhcjtcclxuXHJcbiAgICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICAgIGNoYW5nZTogXCJOeSBrdXJzXCIsXHJcbiAgICAgICAgICBjb250ZW50OiBjLm5hbWUsXHJcbiAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xyXG4gICAgICAgICAgICByLmFkZChcImNvdXJzZXNcIiwgbmV3Q291cnNlKTtcclxuICAgICAgICAgICAgci5saW5rKFwic3ViamVjdHNcIiwgbmV3U3ViamVjdC5pZCwgXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJjb3Vyc2VUZW1wbGF0ZXNcIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IHtncm91cDogY2NHcm91cCwgaHRtbH0gb2YgYy5jZW50cmFsQ29udGVudCkge1xyXG4gICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgZXhpc3RzIGFuIGlkZW50aWNhbCBjZW50cmFsIGNvbnRlbnQgb24gcHJldmlvdXMgY291cnNlIGZpcnN0XHJcbiAgICAgICAgICBsZXQgbmV3Q2VudHJhbENvbnRlbnQgPSBjZW50cmFsQ29udGVudC5maWx0ZXIoY2MgPT4gY2MubmFtZSA9PT0gaHRtbClbMF07XHJcbiAgICAgICAgICBpZiAoIW5ld0NlbnRyYWxDb250ZW50KSB7XHJcbiAgICAgICAgICAgIG5ld0NlbnRyYWxDb250ZW50ID0ge1xyXG4gICAgICAgICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXHJcbiAgICAgICAgICAgICAgZGF0ZVRpbWU6IGN0KCksXHJcbiAgICAgICAgICAgICAgbmFtZTogaHRtbCxcclxuICAgICAgICAgICAgICBhY2w6IFtcInJvbGU6VVNFUjpSXCJdXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChjY0dyb3VwKSBuZXdDZW50cmFsQ29udGVudC5ncm91cCA9IGNjR3JvdXA7XHJcbiAgICAgICAgICAgIGNlbnRyYWxDb250ZW50LnB1c2gobmV3Q2VudHJhbENvbnRlbnQpO1xyXG5cclxuICAgICAgICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICAgICAgICBjaGFuZ2U6IFwiTnl0dCBjZW50cmFsdCBpbm5laMOlbGxcIixcclxuICAgICAgICAgICAgICBjb250ZW50OiBgPGg0PiR7Y2NHcm91cH08L2g0PiR7aHRtbH1gLFxyXG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XHJcbiAgICAgICAgICAgICAgICByLmFkZChcImNlbnRyYWwtY29udGVudFwiLCBuZXdDZW50cmFsQ29udGVudCk7XHJcbiAgICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJjZW50cmFsLWNvbnRlbnRcIiwgbmV3Q2VudHJhbENvbnRlbnQuaWQsIFwiY2VudHJhbENvbnRlbnRcIik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XHJcbiAgICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJjZW50cmFsLWNvbnRlbnRcIiwgbmV3Q2VudHJhbENvbnRlbnQuaWQsIFwiY2VudHJhbENvbnRlbnRcIik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBvcmRlciBpbiB3aGljaCB0aGlzIGNlbnRyYWwgY29udGVudCBhcHBlYXJlZCBpbiB0aGUgWE1MOlxyXG4gICAgICAgICAgbmV3Q291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIucHVzaChuZXdDZW50cmFsQ29udGVudC5pZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBjciBvZiBjLmtub3dsZWRnZVJlcXVpcmVtZW50cykge1xyXG4gICAgICAgICAgbGV0IG5ld0tub3dsZWRnZVJlcXVpcmVtZW50ID0ga25vd2xlZGdlUmVxdWlyZW1lbnRzLmZpbHRlcihrciA9PiBrci5uYW1lID09PSBjci5odG1sICYmIGtyLmdyYWRlU3RlcCA9PT0gY3IuZ3JhZGVTdGVwKVswXTtcclxuICAgICAgICAgIGlmICghbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQpIHtcclxuICAgICAgICAgICAgbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQgPSB7XHJcbiAgICAgICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICAgICAgICBkYXRlVGltZTogY3QoKSxcclxuICAgICAgICAgICAgICBuYW1lOiBjci5odG1sLFxyXG4gICAgICAgICAgICAgIGdyYWRlU3RlcDogY3IuZ3JhZGVTdGVwLFxyXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl1cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50cy5wdXNoKG5ld0tub3dsZWRnZVJlcXVpcmVtZW50KTtcclxuXHJcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgY2hhbmdlOiBcIk55dHQga3Vuc2thcHNrcmF2IGbDtnIgYmV0eWdldCBcIiArIGNyLmdyYWRlU3RlcCxcclxuICAgICAgICAgICAgICBjb250ZW50OiBjci5odG1sLFxyXG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XHJcbiAgICAgICAgICAgICAgICByLmFkZChcImtub3dsZWRnZS1yZXF1aXJlbWVudHNcIiwgbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgci5saW5rKFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwia25vd2xlZGdlLXJlcXVpcmVtZW50c1wiLCBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudC5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIik7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgbXV0YXRpb25zOiByID0+IHtcclxuICAgICAgICAgICAgICAgIHIubGluayhcImNvdXJzZXNcIiwgbmV3Q291cnNlLmlkLCBcImtub3dsZWRnZS1yZXF1aXJlbWVudHNcIiwgbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQuaWQsIFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBvcmRlciBpbiB3aGljaCB0aGlzIGtub3dsZWRnZSByZXF1aXJlbWVudCBhcHBlYXJlZCBpbiB0aGUgWE1MOlxyXG4gICAgICAgICAgbmV3Q291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyLnB1c2gobmV3S25vd2xlZGdlUmVxdWlyZW1lbnQuaWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBCdWlsZCBrbm93bGVkZ2UgbWF0cml4XHJcblxyXG4gICAgICAgIC8vIExpbmsgZGlyZWN0bHkgZnJvbSBjb3Vyc2UgdGVtcGxhdGUgdG8gYWxsIGFiaWxpdGllcyB0aGF0IHRoZSBzdWJqZWN0IGhhczpcclxuICAgICAgICBmb3IgKGNvbnN0IGEgb2Ygc3ViamVjdEFiaWxpdGllcykge1xyXG4gICAgICAgICAgY2hhbmdlcy5wdXNoKHtcclxuICAgICAgICAgICAgbXV0YXRpb25zOiByID0+IHtcclxuICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJhYmlsaXRpZXNcIiwgYS5pZCwgXCJhYmlsaXRpZXNcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge2NoYW5nZXMsIHN1YmplY3RUb0ltcG9ydH07XHJcbiAgfVxyXG5cclxuICBjYW5jZWwoKSB7XHJcbiAgICB0aGlzLnByb3BzLm9uQ2FuY2VsKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbXBvcnQoKSB7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgaXNXb3JraW5nOiB0cnVlLCBpc0ltcG9ydGluZzogdHJ1ZSB9KTtcclxuICAgIGNvbnN0IGFsbE11dGF0aW9ucyA9IHRoaXMuc3RhdGUuY2hhbmdlcy5tYXAoY2hhbmdlID0+IGNoYW5nZS5tdXRhdGlvbnMpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZG8ociA9PiB7XHJcbiAgICAgICAgYWxsTXV0YXRpb25zLmZvckVhY2gobXV0ID0+IG11dChyKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7IGlzV29ya2luZzogZmFsc2UsIGlzSW1wb3J0aW5nOiBmYWxzZSB9KTtcclxuICAgIH1cclxuICAgIHRoaXMucHJvcHMub25JbXBvcnRTdWNjZXNzKHRoaXMucHJvcHMuc3ViamVjdC5uYW1lKTtcclxuICB9XHJcblxyXG4gIGZpeEwoaHRtbDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gaHRtbDsvLy5yZXBsYWNlKCc8bCBmcm9tYXQ9XCJPTFwiPicpXHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7c3ViamVjdFRvSW1wb3J0fSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCB7c3ViamVjdH0gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIDxkaXY+PGgxPntMYFVwcGxhZGRhdCDDhG1uZSAke3N1YmplY3RUb0ltcG9ydCA/IHN1YmplY3RUb0ltcG9ydC5uYW1lIDogJyd9YH08L2gxPlxyXG4gICAgICB7dGhpcy5zdGF0ZS5lcnJvciA/IDxwPkZlbDoge3RoaXMuc3RhdGUuZXJyb3J9PC9wPiA6XHJcbiAgICAgICB0aGlzLnN0YXRlLmlzV29ya2luZyA/IDxwPkFyYmV0YXIuLi48L3A+IDpcclxuICAgICAgIHRoaXMuc3RhdGUuaXNJbXBvcnRpbmcgPyA8cD5JbXBvcnRlcmFyLi4uPC9wPiA6XHJcbiAgICAgICB0aGlzLnN0YXRlLmNoYW5nZXMuZXZlcnkoYyA9PiAhYy5jaGFuZ2UpID8gLy8gSW5nYSDDpG5kcmluZ2FyIGF0dCB2aXNhIChiYXJhIHBzZXVkby3DpG5kcmluZ2FyKVxyXG4gICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgIDxwPkt1bmRlIGludGUgZmlubmEgbsOlZ3JhIGbDtnLDpG5kcmluZ2FyIGZyw6VuIGJlZmludGxpZ3QgZGF0YS4gS2xpY2thIE9LIGbDtnIgYXR0IGF2YnJ5dGEgb2NoIMOldGVyZ8OlLjwvcD5cclxuICAgICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHRoaXMuY2FuY2VsKCl9PiBPSyA8L2J1dHRvbj5cclxuICAgICAgICAgICAgPC9kaXY+IDpcclxuICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgPHRhYmxlIHN0eWxlPXt7Ym9yZGVyOiBcIjFweCBzb2xpZCBncmF5XCIsIHBhZGRpbmc6IFwiMnB4XCIgfX0+PHRoZWFkPjx0cj5cclxuICAgICAgICAgIDx0aCBjb2xTcGFuPXsyfT5HcmFuc2tuaW5nIGF2IMOkbmRyaW5nYXIgaSBncnVuZC1kYXRhPC90aD5cclxuICAgICAgICA8L3RyPjx0cj5cclxuICAgICAgICAgICAgPHRoPsOEbmRyaW5nPC90aD5cclxuICAgICAgICAgICAgPHRoPklubmVow6VsbDwvdGg+XHJcbiAgICAgICAgICA8L3RyPjwvdGhlYWQ+PHRib2R5PlxyXG4gICAgICAgICAgICB7dGhpcy5zdGF0ZS5jaGFuZ2VzLmZpbHRlcihjaGFuZ2UgPT4gY2hhbmdlLmNoYW5nZSkubWFwKChjaGFuZ2UsaSkgPT4gPHRyIGtleT17aX0+XHJcbiAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7cGFkZGluZzogXCIycHhcIn19PntjaGFuZ2UuY2hhbmdlfTwvdGQ+XHJcbiAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7cGFkZGluZzogXCIycHhcIn19IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogY2hhbmdlLmNvbnRlbnQgfX0gLz5cclxuICAgICAgICAgICAgPC90cj4pfVxyXG4gICAgICAgICAgPC90Ym9keT48L3RhYmxlPlxyXG4gICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5jYW5jZWwoKX0gZGlzYWJsZWQ9e3RoaXMuc3RhdGUuaXNJbXBvcnRpbmd9PkF2YnJ5dDwvYnV0dG9uPlxyXG4gICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5pbXBvcnQoKX0gZGlzYWJsZWQ9e3RoaXMuc3RhdGUuaXNJbXBvcnRpbmd9PkltcG9ydGVyYTwvYnV0dG9uPlxyXG4gICAgICAgIDxiciAvPlxyXG4gICAgICAgIDwvZGl2Pn0gXHJcbiAgICAgIDxidXR0b25cclxuICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgc2hvd0Z1bGxUZXh0OiAhdGhpcy5zdGF0ZS5zaG93RnVsbFRleHQgfSl9PlxyXG4gICAgICAgIHt0aGlzLnN0YXRlLnNob3dGdWxsVGV4dCA/XHJcbiAgICAgICAgICBMYETDtmxqIG5lZGFuYCA6XHJcbiAgICAgICAgICBMYFZpc2EgaGVsYSB0ZXh0ZW4gZnLDpW4gU2tvbHZlcmtldGB9XHJcbiAgICAgIDwvYnV0dG9uPlxyXG5cclxuICAgICAgey8qIFRoZSB0YWJsZSBiZWxvdyBpcyBOT1QganVzdCBmb3Igc2hvdyFcclxuICAgICAgICAgIEZ1bmN0aW9uYWxpdHkgaXMgZGVwZW5kZW50IG9uIGl0cyBleGlzdGVuY2UgZm9yIGltcG9ydGluZyBzdHVmZiB1c2luZyBqUXVlcnkgdG8gY2hlcnJ5LXBpY2sgZGF0YS4gKi99ICAgICAgICAgIFxyXG4gICAgICA8dGFibGUgc3R5bGU9e3sgZGlzcGxheTogdGhpcy5zdGF0ZS5zaG93RnVsbFRleHQgPyAnJyA6ICdub25lJyB9fT48dGJvZHk+PHRyPlxyXG4gICAgICAgIDx0aD5cclxuICAgICAgICAgIE5hbW5cclxuICAgICAgICA8L3RoPlxyXG4gICAgICAgIDx0ZD5cclxuICAgICAgICAgIHtzdWJqZWN0Lm5hbWV9XHJcbiAgICAgICAgPC90ZD5cclxuICAgICAgPC90cj48dHI+XHJcbiAgICAgICAgICA8dGg+XHJcbiAgICAgICAgICAgIMOEbW5lc2tvZFxyXG4gICAgICAgICAgPC90aD5cclxuICAgICAgICAgIDx0ZD5cclxuICAgICAgICAgICAge3N1YmplY3QuY29kZX1cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgPC90cj48dHI+XHJcbiAgICAgICAgICA8dGg+XHJcbiAgICAgICAgICAgIFN5ZnRlXHJcbiAgICAgICAgICA8L3RoPlxyXG4gICAgICAgICAgPHRkIHJlZj17ZWxlbSA9PiB0aGlzLnB1cnBvc2VFbGVtID0gZWxlbX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoc3ViamVjdC5wdXJwb3NlKSB9fSAvPlxyXG4gICAgICAgIDwvdHI+PHRyPlxyXG4gICAgICAgICAgPHRoPlxyXG4gICAgICAgICAgICBLdXJzZXJcclxuICAgICAgICAgIDwvdGg+XHJcbiAgICAgICAgICA8dGQ+XHJcbiAgICAgICAgICAgIHtzdWJqZWN0LmNvdXJzZXMubWFwKGNvdXJzZSA9PiA8dGFibGUga2V5PXtjb3Vyc2UuY29kZX0gcmVmPXtlbGVtID0+IHRoaXMuY291cnNlc0VsZW1zW2NvdXJzZS5jb2RlXSA9IHsgY291cnNlLCBlbGVtIH19Pjx0Ym9keT5cclxuICAgICAgICAgICAgICA8dHI+PHRoPkt1cnNlbnMgbmFtbjwvdGg+PHRkPntjb3Vyc2UubmFtZX08L3RkPjwvdHI+XHJcbiAgICAgICAgICAgICAgPHRyPjx0aD5LdXJza29kPC90aD48dGQ+e2NvdXJzZS5jb2RlfTwvdGQ+PC90cj5cclxuICAgICAgICAgICAgICA8dHI+PHRoPlBvw6RuZzwvdGg+PHRkPntjb3Vyc2UucG9pbnRzfTwvdGQ+PC90cj5cclxuICAgICAgICAgICAgICA8dHI+PHRoPkNlbnRyYWx0IGlubmVow6VsbDwvdGg+PHRkIHJlZj17ZWxlbSA9PiB0aGlzLmNlbnRyYWxDb250ZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmNlbnRyYWxDb250ZW50KSB9fSAvPjwvdHI+XHJcbiAgICAgICAgICAgICAge2NvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLnNvbWUoa3IgPT4gIWtyLmdyYWRlU3RlcCkgPyA8dHI+XHJcbiAgICAgICAgICAgICAgICA8dGg+S3Vuc2thcHNrcmF2IHV0YW4gYmV0eWdzw6R0dG5pbmc8L3RoPlxyXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImdyYWRlLXN0ZXAtbm9uZVwiIHJlZj17ZWxlbSA9PiB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuZmlsdGVyKHIgPT4gIXIuZ3JhZGVTdGVwKS5tYXAoa3IgPT4ga3IudGV4dCkuam9pbignJykpIH19IC8+XHJcbiAgICAgICAgICAgICAgPC90cj4gOiB1bmRlZmluZWR9XHJcblxyXG4gICAgICAgICAgICAgIHtjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5zb21lKGtyID0+IGtyLmdyYWRlU3RlcCA9PT0nRScpID8gPHRyPlxyXG4gICAgICAgICAgICAgICAgPHRoPkt1bnNrYXBza3JhdiBCZXR5ZyBFPC90aD5cclxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJncmFkZS1zdGVwLUVcIiByZWY9e2VsZW0gPT4gdGhpcy5rbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zLnB1c2goZWxlbSl9IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5maXhMKGNvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLmZpbHRlcihyID0+IHIuZ3JhZGVTdGVwID09PSAnRScpLm1hcChrciA9PiBrci50ZXh0KS5qb2luKCcnKSkgfX0gLz5cclxuICAgICAgICAgICAgICA8L3RyPiA6IHVuZGVmaW5lZH1cclxuXHJcbiAgICAgICAgICAgICAge2NvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLnNvbWUoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSdDJykgPyA8dHI+XHJcbiAgICAgICAgICAgICAgICA8dGg+S3Vuc2thcHNrcmF2IEJldHlnIEM8L3RoPlxyXG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImdyYWRlLXN0ZXAtQ1wiIHJlZj17ZWxlbSA9PiB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuZmlsdGVyKHIgPT4gci5ncmFkZVN0ZXAgPT09ICdDJykubWFwKGtyID0+IGtyLnRleHQpLmpvaW4oJycpKSB9fSAvPlxyXG4gICAgICAgICAgICAgIDwvdHI+IDogdW5kZWZpbmVkfVxyXG5cclxuICAgICAgICAgICAgICB7Y291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuc29tZShrciA9PiBrci5ncmFkZVN0ZXAgPT09J0EnKSA/IDx0cj5cclxuICAgICAgICAgICAgICAgIDx0aD5LdW5za2Fwc2tyYXYgQmV0eWcgQTwvdGg+XHJcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiZ3JhZGUtc3RlcC1BXCIgcmVmPXtlbGVtID0+IHRoaXMua25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtcy5wdXNoKGVsZW0pfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIociA9PiByLmdyYWRlU3RlcCA9PT0gJ0EnKS5tYXAoa3IgPT4ga3IudGV4dCkuam9pbignJykpIH19IC8+XHJcbiAgICAgICAgICAgICAgPC90cj4gOiB1bmRlZmluZWR9XHJcblxyXG4gICAgICAgICAgICA8L3Rib2R5PjwvdGFibGU+KX1cclxuICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgPC90cj5cclxuICAgICAgPC90Ym9keT48L3RhYmxlPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgRG9jdW1lbnQsIFJlc291cmNlLCBNb2RpZmljYXRpb25UcmFja2VkLCBDb3Vyc2UsIFRhc2ssIFNvZnREb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi8uLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSB9IGZyb20gJy4uLy4uL3V0aWxzL3NjaG9vbC1tb21lbnQnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZURvY3VtZW50R3JhcGhzKG9sZERvYywgbmV3RG9jLCB0YWJsZTogc3RyaW5nLCBncmFwaHM6IHsgW2xhYmVsOiBzdHJpbmddOiBzdHJpbmcgfSwgYmF0Y2g6IEJhdGNoUnVubmVyKSB7XHJcbiAgY29uc3QgZG9jVXBkYXRlcyA9IHt9O1xyXG4gIGNvbnN0IGRvY0lkID0gbmV3RG9jLmlkO1xyXG4gIGZvciAobGV0IG5hdlByb3Agb2YgT2JqZWN0LmtleXMoZ3JhcGhzKSkge1xyXG4gICAgY29uc3QgZm9yZWlnblRhYmxlID0gZ3JhcGhzW25hdlByb3BdO1xyXG4gICAgY29uc3Qgb2xkTGlzdDogRG9jdW1lbnRbXSA9IG9sZERvY1tuYXZQcm9wXSB8fCBbXTtcclxuICAgIGNvbnN0IG5ld0xpc3Q6IERvY3VtZW50W10gPSBuZXdEb2NbbmF2UHJvcF07XHJcbiAgICBpZiAoIW5ld0xpc3QpIGNvbnRpbnVlO1xyXG4gICAgY29uc3QgdHVwbGVzID0gbmV3TGlzdFxyXG4gICAgICAubWFwKChkb2MsIGlkeCk9Pih7ZG9jLCBpZHh9KSk7IC8vIENyZWF0ZSB0dWJsZXMgb2Yge2RvYywgYXJyYXktaW5kZXh9IHNvIHdlIGNhbiB1cGRhdGUgcmVzdWx0XHJcbiAgICBjb25zdCBhZGRlZCA9IHR1cGxlcy5maWx0ZXIodHVwbGUgPT4gIW9sZExpc3Quc29tZShvID0+IG8uaWQgPT09IHR1cGxlLmRvYy5pZCkpOyAvLyBGaW5kIGFkZGVkIGl0ZW1zXHJcblxyXG4gICAgZm9yIChsZXQgYSBvZiBhZGRlZCkge1xyXG4gICAgICBjb25zdCBtdXRhdGVkU3ViRG9jID0gey4uLmEuZG9jfTtcclxuICAgICAgY29uc3QgbWV0YSA9IG11dGF0ZWRTdWJEb2MuJG1ldGE7XHJcbiAgICAgIGRlbGV0ZSBtdXRhdGVkU3ViRG9jLiRtZXRhOyAvLyBEZWxldGUgJG1ldGEgc28gdGhhdCBcImFkZFwiIG9yIFwidXBkYXRlXCIgZG9lcyBub3QgcGVyc2lzdGUgdG8gbmV4dCBzdGF0ZS5cclxuICAgICAgaWYgKG1ldGEgPT09ICdhZGQnKSB7XHJcbiAgICAgICAgaWYgKCFtdXRhdGVkU3ViRG9jLmlkKSBtdXRhdGVkU3ViRG9jLmlkID0gY3JlYXRlVVVJRCgpOyAvLyBHZW5lcmF0ZSBJRCBpZiBub3QgZG9uZSB5ZXQuXHJcbiAgICAgICAgLy8gTm93IHB1dCBhbiAnYWRkJyBtdXRhdGlvbiBpbiB0aGUgYmF0Y2ggcXVldWUuXHJcbiAgICAgICAgYmF0Y2guYWRkKGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYyk7XHJcbiAgICAgIH0gZWxzZSBpZiAobWV0YSA9PT0gJ3VwZGF0ZScpIHtcclxuICAgICAgICBiYXRjaC5wdXQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcclxuICAgICAgfVxyXG4gICAgICBiYXRjaC5saW5rKHRhYmxlLCBkb2NJZCwgZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jLmlkLCBuYXZQcm9wKTtcclxuXHJcbiAgICAgIC8vIFVwZGF0ZSByZXN1bHQgc28gdGhhdCBzdGF0ZSBpcyByZWZsZWN0ZWQgYWZ0ZXIgc3VjY2VzZnVsIFBPU1QgdG8gc2VydmVyLlxyXG4gICAgICBpZiAoIWRvY1VwZGF0ZXNbbmF2UHJvcF0pIGRvY1VwZGF0ZXNbbmF2UHJvcF0gPSB7fTtcclxuICAgICAgZG9jVXBkYXRlc1tuYXZQcm9wXVthLmlkeF0gPSB7JHNldDogbXV0YXRlZFN1YkRvY307XHJcbiAgICB9XHJcbiAgICBjb25zdCByZW1vdmVkID0gb2xkTGlzdC5maWx0ZXIobyA9PiAhbmV3TGlzdC5zb21lKG4gPT4gbi5pZCA9PT0gby5pZCkpO1xyXG4gICAgZm9yIChsZXQgciBvZiByZW1vdmVkKSB7XHJcbiAgICAgIGJhdGNoLnVubGluayh0YWJsZSwgZG9jSWQsIGZvcmVpZ25UYWJsZSwgci5pZCwgbmF2UHJvcCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB1cGRhdGVkID0gdHVwbGVzLmZpbHRlcih0dXBsZSA9PiBvbGRMaXN0LnNvbWUobyA9PiBvLmlkID09PSB0dXBsZS5kb2MuaWQgJiYgdHVwbGUuZG9jLiRtZXRhID09PSAndXBkYXRlJykpO1xyXG4gICAgZm9yIChsZXQgdSBvZiB1cGRhdGVkKSB7XHJcbiAgICAgIGNvbnN0IG11dGF0ZWRTdWJEb2MgPSB7Li4udS5kb2N9O1xyXG4gICAgICBkZWxldGUgbXV0YXRlZFN1YkRvYy4kbWV0YTtcclxuICAgICAgYmF0Y2gucHV0KGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYyk7XHJcblxyXG4gICAgICAvLyBVcGRhdGUgcmVzdWx0IHNvIHRoYXQgJG1ldGEgaXMgcmVtb3ZlZCBmcm9tIG5hdmlnYXRpb24gcHJvcCBhZnRlciBzdWNjZXNzZnVsIFBPU1QgdG8gc2VydmVyLlxyXG4gICAgICBpZiAoIWRvY1VwZGF0ZXNbbmF2UHJvcF0pIGRvY1VwZGF0ZXNbbmF2UHJvcF0gPSB7fTtcclxuICAgICAgZG9jVXBkYXRlc1tuYXZQcm9wXVt1LmlkeF0gPSB7JHNldDogbXV0YXRlZFN1YkRvY307XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiB1cGRhdGUobmV3RG9jLCBkb2NVcGRhdGVzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGR0Rm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xyXG4gIHJldHVybiBtb21lbnQoZGF0ZVRpbWUpLmZvcm1hdCgnWVlNTUREIEhIOm1tJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG9ydERhdGVGb3JtYXQoZGF0ZVRpbWU6IG51bWJlciB8IERhdGUgfCBtb21lbnQuTW9tZW50KSB7XHJcbiAgcmV0dXJuIG1vbWVudChkYXRlVGltZSkuZm9ybWF0KCdZWU1NREQnKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3J0UGVyc29uTmFtZUZvcm1hdChuYW1lOiBzdHJpbmcpIHtcclxuICBpZiAoIW5hbWUpIHJldHVybiBcIlwiO1xyXG4gIGNvbnN0IG5hbWVzID0gbmFtZS5zcGxpdCgnICcpLmZpbHRlcihuID0+ICEhbik7XHJcbiAgY29uc3QgbGFzdE5hbWUgPSBuYW1lcy5wb3AoKTtcclxuICByZXR1cm4gbmFtZXMubWFwKG5hbWUgPT4gYCR7bmFtZVswXX0uYCkuY29uY2F0KGxhc3ROYW1lKS5qb2luKCcgJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNb2RpZmljYXRpb25TdGFtcCAobm93OiBudW1iZXIsIG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xyXG4gIHJldHVybiB1cGRhdGUob2JqLCB7XHJcbiAgICBkYXRlVGltZTogeyRzZXQ6IG5vd30sIC8vIEZvciBxdWVyaWVzLi4uXHJcbiAgICBtb2RpZmllZERhdGU6IHskc2V0OiBub3d9LFxyXG4gICAgbW9kaWZpZWRCeToge1xyXG4gICAgICAkc2V0OiB7XHJcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcclxuICAgICAgICB1cmw6IFwibWFpbHRvOlwiICsgdXNlci5tYWlsXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNyZWF0aW9uU3RhbXA8VCBleHRlbmRzIE1vZGlmaWNhdGlvblRyYWNrZWQ+IChub3c6IG51bWJlciwgb2JqOiBULCB1c2VyOiBVc2VyKTogVCB7XHJcbiAgcmV0dXJuIHVwZGF0ZShvYmosIHtcclxuICAgIGNyZWF0ZWREYXRlOiB7JHNldDogbm93fSxcclxuICAgIGNyZWF0ZWRCeToge1xyXG4gICAgICAkc2V0OiB7XHJcbiAgICAgICAgbmFtZTogdXNlci5kaXNwbGF5TmFtZSxcclxuICAgICAgICB1cmw6IFwibWFpbHRvOlwiICsgdXNlci5tYWlsXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEVtYWlsRnJvbURvY0FjY2VzcyAocmVzb3VyY2U6IFNvZnREb2N1bWVudEFjY2Vzcykge1xyXG4gIGlmIChyZXNvdXJjZS5lbWFpbCkgcmV0dXJuIHJlc291cmNlLmVtYWlsO1xyXG4gIHJldHVybiByZXNvdXJjZS51cmwgP1xyXG4gICAgcmVzb3VyY2UudXJsLnN0YXJ0c1dpdGgoJ21haWx0bzonKSA/XHJcbiAgICAgIHJlc291cmNlLnVybC5zdWJzdHJpbmcoJ21haWx0bzonLmxlbmd0aCkgOlxyXG4gICAgICByZXNvdXJjZS51cmwgOlxyXG4gICAgcmVzb3VyY2UudXJsO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMob2JqOiBNb2RpZmljYXRpb25UcmFja2VkLCB1c2VyOiBVc2VyKSB7XHJcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICBvYmogPSB1cGRhdGVNb2RpZmljYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XHJcbiAgaWYgKCFvYmouY3JlYXRlZEJ5KSBvYmogPSB1cGRhdGVDcmVhdGlvblN0YW1wKG5vdywgb2JqLCB1c2VyKTtcclxuICByZXR1cm4gb2JqO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlFdGFncyhkb2M6IERvY3VtZW50LCBuZXdFdGFnczoge1tpZDogc3RyaW5nXTogc3RyaW5nfSwgZ3JhcGhzOiBzdHJpbmdbXSkge1xyXG4gIGNvbnN0IHJlcyA9IHsuLi5kb2N9O1xyXG4gIGNvbnN0IGV0YWcgPSBuZXdFdGFnc1tkb2MuaWRdO1xyXG4gIGlmIChldGFnKVxyXG4gICAgcmVzLiRldGFnID0gZXRhZztcclxuICBmb3IgKGxldCBsYWJlbCBvZiBncmFwaHMpIHtcclxuICAgIGNvbnN0IG5ld0xpc3QgPSBkb2NbbGFiZWxdLm1hcChkID0+IGFwcGx5RXRhZ3MoZCwgbmV3RXRhZ3MsIFtdKSk7XHJcbiAgICByZXNbbGFiZWxdID0gbmV3TGlzdDtcclxuICB9XHJcbiAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iKGJsb2I6IEJsb2IsIG06IChyOkZpbGVSZWFkZXIpPT52b2lkKSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcbiAgICByZWFkZXIub25sb2FkID0gZXYgPT4gcmVzb2x2ZSgoZXYudGFyZ2V0IGFzIGFueSkucmVzdWx0KTtcclxuICAgIHJlYWRlci5vbmFib3J0ID0gZXYgPT4gcmVqZWN0KG5ldyBFcnJvcihcImZpbGUgcmVhZCBhYm9ydGVkXCIpKTtcclxuICAgIHJlYWRlci5vbmVycm9yID0gZXYgPT4gcmVqZWN0KChldi50YXJnZXQgYXMgYW55KS5lcnJvcik7XHJcbiAgICBtKHJlYWRlcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dCAoYmxvYjogQmxvYikge1xyXG4gIHJldHVybiByZWFkQmxvYihibG9iLCByPT5yLnJlYWRBc1RleHQoYmxvYikpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2JBc0RhdGFVcmwgKGJsb2I6IEJsb2IpIHtcclxuICByZXR1cm4gcmVhZEJsb2IoYmxvYiwgcj0+ci5yZWFkQXNEYXRhVVJMKGJsb2IpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFsbG93Q29weShlOiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XHJcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgZS5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5JztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNvdXJzZUJ1aWxkZXJTdGF0dXMoc3RhdHVzOiAndW5zYXZlZCcgfCAnc2F2ZWQnIHwgJ2Vycm9yJyB8ICcnKSB7XHJcbiAgY29uc3QgZGl2ID0gJCgnZGl2LmNvdXJzZS1idWlsZGVyJylbMF07XHJcbiAgaWYgKGRpdikgZGl2LmNsYXNzTmFtZSA9IFwiY291cnNlLWJ1aWxkZXJcIiArIChzdGF0dXMgPyBcIiBzdGF0dXMgXCIgKyBzdGF0dXMgOiBcIlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRDb3Vyc2UoaWQ6IHN0cmluZywgb3B0aW9ucz86IHtcclxuICAgIGluY2x1ZGVUZW1wbGF0ZUNoYWluPzogYm9vbGVhbixcclxuICAgIGluY2x1ZGU/OiBzdHJpbmdbXVxyXG4gIH0pOiBQcm9taXNlPENvdXJzZT5cclxue1xyXG4gIGNvbnN0IGNsaWVudCA9IGVudi5rZWRCYWNrZW5kQ2xpZW50O1xyXG4gIGNvbnN0IGluY2x1ZGVUZW1wbGF0ZUNoYWluID0gb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGVUZW1wbGF0ZUNoYWluO1xyXG4gIGNvbnN0IGluY2x1ZGVUYXNrcyA9ICFvcHRpb25zIHx8ICFvcHRpb25zLmluY2x1ZGUgfHwgb3B0aW9ucy5pbmNsdWRlLmluZGV4T2YoXCJ0YXNrc1wiKSAhPT0gLTE7XHJcbiAgY29uc3QgW2NvdXJzZSwgY291cnNlVGFza3MsIHRlbXBsYXRlQ2hhaW5dID0gKGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgIGNsaWVudC5nZXQoXCJjb3Vyc2VzXCIsIGlkLCB7XHJcbiAgICAgIGluY2x1ZGU6IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlID8gb3B0aW9ucy5pbmNsdWRlLmZpbHRlcihpID0+IGkgIT09IFwidGFza3NcIikgOiBbXHJcbiAgICAgICAgXCJjZW50cmFsQ29udGVudFwiLFxyXG4gICAgICAgIFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsXHJcbiAgICAgICAgXCJhYmlsaXRpZXNcIixcclxuICAgICAgICBcImltYWdlc1wiLFxyXG4gICAgICAgIFwiYWNsXCIgLy8gRG9uJ3QgaW5jbHVkZSB0YXNrcyBoZXJlLi4uXHJcbiAgICAgIF1cclxuICAgIH0pLFxyXG4gICAgLy8gLi4uIGJ1dCBpbmNsdWRlIHRhc2tzIGhlcmUgaW5zdGVhZCBzbyB0aGF0IHdlIGNhbiBsb2FkIHRoZSBncmFwaHMgZm9yIHRoZVxyXG4gICAgLy8gdGFza3MgYXMgd2VsbCFcclxuICAgIGluY2x1ZGVUYXNrcyAmJiBjbGllbnQubGlzdChcInRhc2tzXCIsIHtcclxuICAgICAgaGFzRWRnZXNGcm9tOiBpZCxcclxuICAgICAgaW5jbHVkZTogWydrbm93bGVkZ2VSZXF1aXJlbWVudHMnLCAnY2VudHJhbENvbnRlbnQnLCAnYWJpbGl0aWVzJywgJ2FjbCddLFxyXG4gICAgICBmbGFnczogWydpbmNsdWRlSWRzT25seSddIC8vIERvbid0IG5lZWQgcmVkdW5kYW50IGluZm8gdGhhdCdzIGFscmVhZHkgb24gY291cnNlXHJcbiAgICB9KSxcclxuICAgIGluY2x1ZGVUZW1wbGF0ZUNoYWluICYmIGNsaWVudC5saXN0KFwiY291cnNlc1wiLCB7XHJcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXHJcbiAgICAgIGZsYWdzOiBbJ2lkc09ubHknXVxyXG4gICAgfSlcclxuICBdKSkgYXMgW0NvdXJzZSwgVGFza1tdLCBDb3Vyc2VbXV07XHJcbiAgY291cnNlLnRhc2tzID0gY291cnNlVGFza3M7XHJcblxyXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEFiaWxpdGllc1xyXG4gIGlmIChjb3Vyc2UuYWJpbGl0aWVzICYmIGNvdXJzZS5hYmlsaXRpZXNPcmRlcikge1xyXG4gICAgY291cnNlLmFiaWxpdGllcyA9IGNvdXJzZS5hYmlsaXRpZXNPcmRlci5tYXAoaWQgPT5cclxuICAgICAgY291cnNlLmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpKTtcclxuICB9XHJcblxyXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEtub3dsZWRnZVJlcXVpcmVtZW50c1xyXG4gIGlmIChjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzICYmIGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlcikge1xyXG4gICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cyA9IGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHNPcmRlci5tYXAoaWQgPT5cclxuICAgICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5maW5kKGMgPT4gYy5pZCA9PT0gaWQpKTtcclxuICB9XHJcblxyXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIENlbnRyYWxDb250ZW50XHJcbiAgaWYgKGNvdXJzZS5jZW50cmFsQ29udGVudCAmJiBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlcikge1xyXG4gICAgY291cnNlLmNlbnRyYWxDb250ZW50ID0gY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIubWFwKGlkID0+XHJcbiAgICAgIGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09PSBpZCkpOy8vLmZpbHRlcih4ID0+ICEheCk7Ly8gRGVidWdnaW5nIHNvbXRoaW4nIC4gTm9ybWFsbHkgdGhlIGxhc3QgLmZpbHRlcigpLi4uIHBhcnQgc2hvdWxkIG5vdCBiZSBuZXNjZXNzYXJ5Li4uXHJcbiAgfVxyXG4gIFxyXG4gIC8vIEluY2x1ZGUgdGVtcGxhdGUgY2hhaW4gaWYgcmVxdWVzdGVkLlxyXG4gIGlmIChpbmNsdWRlVGVtcGxhdGVDaGFpbikgY291cnNlLnRlbXBsYXRlQ2hhaW4gPSB0ZW1wbGF0ZUNoYWluO1xyXG4gIHJldHVybiBjb3Vyc2U7XHJcbn1cclxuXHJcbi8vIENoZWNrIGRpZmZlcmVuY2VzIGJldHdlZW4gdHdvIGFycmF5IG9mIHR5cGUgVFxyXG5leHBvcnQgZnVuY3Rpb24gaGFzQ2hhbmdlcyhvcmlnaW5hbFZhbHVlczogQXJyYXk8YW55PiwgY3VycmVudFZhbHVlczogQXJyYXk8YW55Pik6IGJvb2xlYW57XHJcbiAgcmV0dXJuIGN1cnJlbnRWYWx1ZXMuZmlsdGVyKCh4KSA9PiAhb3JpZ2luYWxWYWx1ZXMuaW5jbHVkZXMoeCkpLmxlbmd0aCA+IDAgfHwgb3JpZ2luYWxWYWx1ZXMuZmlsdGVyKCh4KSA9PiAhY3VycmVudFZhbHVlcy5pbmNsdWRlcyh4KSkubGVuZ3RoID4gMDtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmV4cG9ydCBjb25zdCBMYW5ndWFnZUNvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0KHtpbnRsOiBudWxsfSk7IiwiaW1wb3J0IHtJbnRsUHJvdmlkZXIsIGFkZExvY2FsZURhdGF9IGZyb20gJ3JlYWN0LWludGwnO1xyXG5pbXBvcnQgbG9jYWxlX2VuIGZyb20gJ3JlYWN0LWludGwvbG9jYWxlLWRhdGEvZW4nO1xyXG5pbXBvcnQgbG9jYWxlX3N2IGZyb20gJ3JlYWN0LWludGwvbG9jYWxlLWRhdGEvc3YnO1xyXG5pbXBvcnQgbWVzc2FnZXNfc3YgZnJvbSBcIi4uLy4uL3RyYW5zbGF0aW9ucy9zdi5qc29uXCI7XHJcbmltcG9ydCBtZXNzYWdlc19lbiBmcm9tIFwiLi4vLi4vdHJhbnNsYXRpb25zL2VuLmpzb25cIjtcclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR1cEludGwgPSA8UCBleHRlbmRzIG9iamVjdD4oQ29tcG9uZW50OiBSZWFjdC5Db21wb25lbnRUeXBlPFA+KSA9PlxyXG4gICAgY2xhc3MgX1NldHVwTGFuZ3VhZ2VJbnRsIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFA+e1xyXG4gICAgICAgIG1lc3NhZ2VzIDogb2JqZWN0O1xyXG5cclxuICAgICAgICBjb25zdHJ1Y3Rvcihwcm9wcyl7XHJcbiAgICAgICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICAgICAgYWRkTG9jYWxlRGF0YShbLi4ubG9jYWxlX2VuLC4uLmxvY2FsZV9zdl0pO1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0ge1xyXG4gICAgICAgICAgICAnc3YnOiBtZXNzYWdlc19zdixcclxuICAgICAgICAgICAgJ2VuJzogbWVzc2FnZXNfZW5cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbW9tZW50KCkubG9jYWxlKGNmZy5LRURfTE9DQUxFKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlbmRlcigpe1xyXG4gICAgICAgICAgICByZXR1cm4gPEludGxQcm92aWRlciBsb2NhbGU9e2NmZy5LRURfTE9DQUxFfSBtZXNzYWdlcz17dGhpcy5tZXNzYWdlc1tjZmcuS0VEX0xPQ0FMRV19PlxyXG4gICAgICAgICAgICAgICAgPENvbXBvbmVudCB7Li4udGhpcy5wcm9wcyBhcyBQfSAvPlxyXG4gICAgICAgICAgICA8L0ludGxQcm92aWRlcj5cclxuICAgICAgICB9XHJcbiAgICB9IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuaW50ZXJmYWNlIENFUHJvcHMge1xyXG4gICAgdGV4dDogc3RyaW5nOyAvLyBUZXh0IHRvIGJlIHNob3duIGluIGZpZWxkXHJcbiAgICB0YWc/OiAndGQnIHwgJ3RoJyB8ICdkaXYnIHwgJ3NwYW4nIHwgJ3AnIHwgJ2gxJyB8ICdoMicgfCAnaDMnOyAvLyBhbGxvd2QgdGFncyAtLSBzaG91bGQgd2UgYWRkIG1vcmU/XHJcbiAgICBvbkNoYW5nZTogKG5ld05hbWU6IHN0cmluZykgPT4gdm9pZDtcclxuICAgIHBsYWNlaG9sZGVyPzogc3RyaW5nOyAvLyBJZiB0ZXh0IGlzIGVtcHR5LCB0aGlzIHdpbGwgYmUgdGhlIHBsYWNlaG9sZGVyXHJcbiAgICBtYXhDaGFycz86IG51bWJlcjtcclxuICAgIHJlYWRPbmx5PzogYm9vbGVhbjtcclxuICAgIGNsYXNzTmFtZT86IHN0cmluZztcclxuICAgIHBsYWNlSG9sZGVyPzogc3RyaW5nO1xyXG5cclxuICAgIHZhbGlkYXRlVmFsdWU/OiBSZWdFeHA7XHJcblxyXG4gICAgLy8gRm9yIG5hdmlnYXRpb25cclxuICAgIGFsbG93TmF2aWdhdGlvbj86IGJvb2xlYW47IC8vIHRvIGFjdGl2YXRlIG5hdmlnYXRpb25cclxuICAgIG9uTmF2aWdhdGU/OiAoZGlyZWN0aW9uOiBzdHJpbmcpID0+IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb250ZW50RWRpdGFibGVGaWVsZCBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8Q0VQcm9wcz4ge1xyXG4gICAgbXlzZWxmOiBSZWFjdC5SZWZPYmplY3Q8YW55PjtcclxuICAgIHByb3BhZ2F0ZWRPbkNoYW5nZTogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBDRVByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgIHRoaXMubXlzZWxmID0gUmVhY3QuY3JlYXRlUmVmPEhUTUxFbGVtZW50PigpO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgICAgIHRleHQ6IHByb3BzLnRleHQgfHwgJydcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHt0YWcsIHRleHQsIHJlYWRPbmx5fSA9IHRoaXMucHJvcHM7XHJcbiAgICAgICAgY29uc3QgVGFnVHlwZSA9IHRhZztcclxuICAgICAgICByZXR1cm4gPFRhZ1R5cGVcclxuICAgICAgICAgICAgY29udGVudEVkaXRhYmxlPXshcmVhZE9ubHl9XHJcbiAgICAgICAgICAgIGRhdGEtcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9XHJcbiAgICAgICAgICAgIHJlZj17dGhpcy5teXNlbGZ9XHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgIG9uS2V5RG93bj17dGhpcy5vbktleURvd24uYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgb25LZXlVcD17dGhpcy5vbktleVVwLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgIG9uQmx1cj17dGhpcy5vbkJsdXIuYmluZCh0aGlzKX1cclxuICAgICAgICAgICAgb25QYXN0ZT17dGhpcy5vblBhc3RlLmJpbmQodGhpcyl9XHJcbiAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiB0ZXh0fX0gLz5cclxuICAgIH1cclxuXHJcbiAgICBvbkNoYW5nZShlOiBFdmVudCkge1xyXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyB0ZXh0OiB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRha2UgYWN0aW9uIGRlcGVuZGluZyBvbiBrZXktZXZlbnRcclxuICAgICAqIEBwYXJhbSBlIGV2ZW50IGZyb20gZmllbGRcclxuICAgICAqIFxyXG4gICAgICogSWYgYWxsb3dOYXZpZ2F0aW9uIHRoZW4gbGlzdGVuIHRvIGFycm93LWtleXNcclxuICAgICAqIExpbWl0cyB0byBtYXhDaGFyc1xyXG4gICAgICovXHJcbiAgICBvbktleURvd24oZTogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dDtcclxuICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XHJcbiAgICAgICAgICAgIHRoaXMubXlzZWxmLmN1cnJlbnQuaW5uZXJUZXh0ID0gdGhpcy5wcm9wcy50ZXh0IHx8IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMubXlzZWxmLmN1cnJlbnQuYmx1cigpO1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0gZWxzZSBpZihlLmtleSA9PT0gJ0VudGVyJyl7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZSh0ZXh0LCAnZG93bicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09ICdUYWInKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvcGFnYXRlT25DaGFuZ2UodGV4dCk7XHJcbiAgICAgICAgfSAgZWxzZSBpZih0ZXh0Lmxlbmd0aCA+PSB0aGlzLnByb3BzLm1heENoYXJzICYmIChcclxuICAgICAgICAgICAgL15bXFxkXFx3XFxzXSQvLnRlc3QoZS5rZXkpICYmICEoZS5tZXRhS2V5IHx8IGUuY3RybEtleSlcclxuICAgICAgICApKSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuYWxsb3dOYXZpZ2F0aW9uID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hdkRpciA9IGUua2V5LnN0YXJ0c1dpdGgoJ0Fycm93JykgPyBlLmtleS5yZXBsYWNlKCdBcnJvdycsICcnKS50b0xvd2VyQ2FzZSgpIDogZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhcmV0ID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkuZ2V0UmFuZ2VBdCgwKS5lbmRPZmZzZXQ7IC8vIG9ubHkgd29ya3MgZm9yIHBsYWludGV4dFxyXG4gICAgICAgICAgICBpZiAobmF2RGlyICYmIHRleHQubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGUodGV4dCwgbmF2RGlyKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChuYXZEaXIgJiYgKG5hdkRpciA9PSAndXAnIHx8IG5hdkRpciA9PSAnZG93bicpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlKHRleHQsIG5hdkRpcik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmF2RGlyICYmIChcclxuICAgICAgICAgICAgICAgIChuYXZEaXIgPT0gJ2xlZnQnICYmIGNhcmV0ID09IDApIHx8XHJcbiAgICAgICAgICAgICAgICAobmF2RGlyID09ICdyaWdodCcgJiYgY2FyZXQgPT0gdGV4dC5sZW5ndGgpXHJcbiAgICAgICAgICAgICkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubmF2aWdhdGUodGV4dCwgbmF2RGlyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIGUgZXZlbnQgZnJvbSBmaWVsZFxyXG4gICAgICogU29sZWx5IHVzZWQgdG8gaGFuZGUgdmFsaWRhdGlvbnMtaXNzdWVzXHJcbiAgICAgKi9cclxuICAgIG9uS2V5VXAoZTogS2V5Ym9hcmRFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IHRleHQgPSB0aGlzLm15c2VsZi5jdXJyZW50LmlubmVyVGV4dDtcclxuICAgICAgICBpZiAodGhpcy5wcm9wcy52YWxpZGF0ZVZhbHVlICE9PSB1bmRlZmluZWQgJiYgIXRoaXMucHJvcHMudmFsaWRhdGVWYWx1ZS50ZXN0KHRleHQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubXlzZWxmLmN1cnJlbnQuaW5uZXJUZXh0ID0gdGhpcy5wcm9wcy50ZXh0IHx8IFwiXCI7XHJcbiAgICAgICAgICAgIHRoaXMubXlzZWxmLmN1cnJlbnQuYmx1cigpO1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIHZhbHVlIGFuZCBwYXNzIHRvIHBhcmVudHMgbmF2aWdhdGUtZnVuY2l0b25cclxuICAgICAqIEBwYXJhbSB0ZXh0IFxyXG4gICAgICogQHBhcmFtIGRpcmVjdGlvbiBcclxuICAgICAqL1xyXG4gICAgbmF2aWdhdGUodGV4dDogc3RyaW5nLCBkaXJlY3Rpb246IHN0cmluZykge1xyXG4gICAgICAgIC8vIGZpcnN0IHVwZGF0ZSBjZWxsXHJcbiAgICAgICAgdGhpcy5wcm9wYWdhdGVPbkNoYW5nZSh0ZXh0KTtcclxuICAgICAgICB0aGlzLnNldFN0YXRlKHsgdGV4dDogdGV4dH0gKTtcclxuICAgICAgICAvLyB0aGVuIG5hdmlnYXRlIGF3YXlcclxuICAgICAgICB0aGlzLnByb3BzLm9uTmF2aWdhdGUoZGlyZWN0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1ha2Ugc3VyZSBwYXN0ZWQgdGV4dCBpcyBwdXJlIHRleHRcclxuICAgICAqIEBwYXJhbSBlIHRoZSBwYXNldCBldmVudFxyXG4gICAgICovXHJcbiAgICBvblBhc3RlKGU6IENsaXBib2FyZEV2ZW50KSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IHRleHQgPSAoZS5jbGlwYm9hcmREYXRhICYmIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKT8gIGUuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSA6ICcnO1xyXG4gICAgICAgIGRvY3VtZW50LmV4ZWNDb21tYW5kKFwiaW5zZXJ0SFRNTFwiLCBmYWxzZSwgdGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGUgdmFsdWUgb24gZXhpdCBmcm9tIGZpZWxkXHJcbiAgICAgKiBAcGFyYW0gZSBcclxuICAgICAqL1xyXG4gICAgb25CbHVyKGU6IEV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMubXlzZWxmLmN1cnJlbnQuaW5uZXJUZXh0O1xyXG4gICAgICAgIHRoaXMucHJvcGFnYXRlT25DaGFuZ2UodGV4dCk7XHJcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRleHQ6IHRleHQgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPbmx5IHVwZGF0ZSB2YWx1ZSBpZiBpdCBoYXMgY2hhbmdlZFxyXG4gICAgICogQHBhcmFtIG5ld1ZhbHVlIFxyXG4gICAgICovXHJcbiAgICBwcm9wYWdhdGVPbkNoYW5nZShuZXdWYWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3BhZ2F0ZWRPbkNoYW5nZSAhPSBuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnByb3BhZ2F0ZWRPbkNoYW5nZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG5ld1ZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBGaWJlciwgRmliZXJDb250ZXh0LCBTdWJzY3JpcHRpb24gfSBmcm9tIFwia2VkYmFja2VuZC9vYnNlcnZhYmxlXCI7XHJcbmltcG9ydCBSZWFjdCwgeyBTdXNwZW5zZSwgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5cclxuY29uc3QgRmliZXJDb250ZXh0UmVhY3QgPSBSZWFjdC5jcmVhdGVDb250ZXh0PEZpYmVyIHwgbnVsbD4obnVsbCk7XHJcblxyXG5GaWJlckNvbnRleHQuYWRkUHJvdmlkZXIoKCk9PlxyXG4gIC8vIEhlcmUgd2UgYWN0dWFsbCBkbyB1c2VIb29rKEZpYmVyQ29udGV4dCkgYnV0IHdpdGhvdXQgbG9nZ2luZyB0byBpbnRlcm5hbCBkZWJ1ZyBsb2dzXHJcbiAgLy8gTm9ybWFsbHksIHJlYWN0IGhvb2tzIGFyZSBzZW5zaXRpdmUgaW4gd2hpY2ggb3JkZXIgdGhleSBhcmUgY2FsbGVkICh1c2VTdGF0ZSgpLCBldGMpXHJcbiAgLy8gYnV0IHVzZUNvbnRleHQoKSBpcyBub3Qgc2Vuc2l0aXZlIGFib3V0IHRoYXQgYXQgYWxsLlxyXG4gIC8vIFN0aWxsLCB0aGUgZGVidWcgdmVyc2lvbiBvZiByZWFjdCB3aWxsIGxvZyBjYWxscyB0byB1c2VIb29rKCkgYW5kIHRocm93IGlmIGEgcmVuZGVyXHJcbiAgLy8gZG9lc24ndCB1c2UgdGhlIHNhbWUgbnVtYmVyIG9mIGhvb2tzIGV2ZXJ5IHRpbWUuIFRoaXMgY2hlY2sgc2hvdWxkIG5vdCBhcHBseVxyXG4gIC8vIHRvIHVzZUhvb2soKSBzaW5jZSBpdCBpcyBub3Qgc2Vuc2l0aXZlIHRvIHRoZSBvcmRlciBpbiB3aGljaCBpdCB3YXMgY2FsbGVkLlxyXG4gIC8vIEFuZCB3ZSBuZWVkIHRvIGJlIGFibGUgdG8gY2FsbCBpdCBmcm9tIHdpdGhpbiBjb250aXRpb25hbCBleHByZXNzaW9ucyAvIHN0YXRlbWVudHMsXHJcbiAgLy8gc28gd2UgbXVzdCBieXBhc3MgdGhpcyBkZWJ1ZyBsb2dnaW5nIGhlcmUgYnkgYWNjZXNzaW5nIHRoZSBfY3VycmVudFZhbHVlIGRpcmVjdGx5LlxyXG4gIChGaWJlckNvbnRleHRSZWFjdCBhcyBhbnkpLl9jdXJyZW50VmFsdWUpOyBcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgZmFsbGJhY2s/OiBOb25OdWxsYWJsZTxSZWFjdE5vZGU+fG51bGw7XHJcbiAgZXJyb3JGYWxsYmFjaz86IE5vbk51bGxhYmxlPFJlYWN0Tm9kZT58bnVsbDtcclxuICBjaGlsZHJlbj86IFJlYWN0Tm9kZTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE9ic2VydmUgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIHtjb3VudGVyOiBudW1iZXIsIGVycm9yOiBudWxsIHwgRXJyb3IsIGluZm8/OiBzdHJpbmd9PiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBjb3VudGVyOiAwLFxyXG4gICAgICBlcnJvcjogbnVsbFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZENhdGNoKGVycm9yOiBhbnksIGluZm86IGFueSkge1xyXG4gICAgaWYgKCFlcnJvciB8fCAhZXJyb3IubmFtZSkgZXJyb3IgPSBuZXcgRXJyb3IoJycrZXJyb3IpO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3IsIGluZm99KTtcclxuICAgIGNvbnNvbGUubG9nKGVycm9yLCBpbmZvKTtcclxuICB9XHJcblxyXG4gIHN1YnNjcmlwdGlvbnM6IFN1YnNjcmlwdGlvbltdID0gW107XHJcblxyXG4gIG91dGVyU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb24gPSB7XHJcbiAgICB1bnN1YnNjcmliZTogKCk9PiB7XHJcbiAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKHMgPT4gcy51bnN1YnNjcmliZSgpKTtcclxuICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvYnNlcnZlciA9ICh2YWx1ZTogYW55LCBlcnJvcjogYW55LCBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbikgPT4ge1xyXG4gICAgaWYgKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2Vycm9yfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKCh7Y291bnRlcn0pID0+ICh7Y291bnRlcjogY291bnRlciArIDEsIGVycm9yfSkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xyXG4gICAgdGhpcy5vdXRlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgaWYgKHRoaXMuc3RhdGUuZXJyb3IpIHtcclxuICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZXJyb3JGYWxsYmFjayB8fCA8cD57TGBLdW5kZSBpbnRlIGxhZGRhIGlubmVow6VsbGV0YH08L3A+O1xyXG4gICAgfVxyXG4gICAgdGhpcy5vdXRlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgcmV0dXJuIDxTdXNwZW5zZSBmYWxsYmFjaz17dGhpcy5wcm9wcy5mYWxsYmFjayB8fCBudWxsfT5cclxuICAgICAgPEZpYmVyQ29udGV4dFJlYWN0LlByb3ZpZGVyIHZhbHVlPXt0aGlzfT57dGhpcy5wcm9wcy5jaGlsZHJlbn08L0ZpYmVyQ29udGV4dFJlYWN0LlByb3ZpZGVyPlxyXG4gICAgPC9TdXNwZW5zZT47XHJcbiAgfVxyXG59XHJcbiIsIi8qIFJFRkFDVE9SOiBNb3ZlIHRoaXMgY29tcG9uZW50IG91dHNpZGUgY291cnNlYnVpbGRlciFcclxuICAgVGhpcyBpcyBhIGdlbmVyYWwtcHVycG9zZSBjb21wb25lbnRcclxuKi9cclxuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgR29hbFByb2dyZXNzIH0gZnJvbSAnLi4vY2hhcnRzL2dvYWwtcHJvZ3Jlc3MnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0aXRsZTogc3RyaW5nIHwgSlNYLkVsZW1lbnQ7XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlckNsYXNzTmFtZT86IHN0cmluZztcclxuICBjb250ZW50Q2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG4gIGluYWN0aXZhdGVkPzogYm9vbGVhbjtcclxuICBpbmFjdGl2YXRlZFJlbmRlcj86ICdjaGlsZHJlbicgfCAndGl0bGVBbmRDaGlsZHJlbic7XHJcbiAgb25PcGVuQ2xvc2U/OiAoYmVjYW1lT3BlbjogYm9vbGVhbikgPT4gdm9pZDtcclxuICBkaXNwbGF5UHJvZ3Jlc3M/OiBib29sZWFuO1xyXG4gIHByb2dyZXNzRGF0YT86IHtjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiBudW1iZXIsIG51bWJlck9mVGFza3M6IG51bWJlcn07XHJcbiAgY2hpbGRyZW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgaGVhZGVyT3BlbjogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE9wZW5DbG9zZUJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMgKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgIGlmIChuZXh0UHJvcHMuaGVhZGVyT3BlbiAhPT0gdGhpcy5wcm9wcy5oZWFkZXJPcGVuKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2hlYWRlck9wZW46IG5leHRQcm9wcy5oZWFkZXJPcGVufSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IHRpdGxlLCBjbGFzc05hbWUsIGNoaWxkcmVuLCBoZWFkZXJDbGFzc05hbWUsIGNvbnRlbnRDbGFzc05hbWUsIGRpc3BsYXlQcm9ncmVzcywgcHJvZ3Jlc3NEYXRhLFxyXG4gICAgICBpbmFjdGl2YXRlZCwgaW5hY3RpdmF0ZWRSZW5kZXIgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgaWYgKGluYWN0aXZhdGVkKSByZXR1cm4gaW5hY3RpdmF0ZWRSZW5kZXIgPT09ICd0aXRsZUFuZENoaWxkcmVuJyA/IDw+XHJcbiAgICAgIDw+e3RpdGxlfTwvPlxyXG4gICAgICA8PntjaGlsZHJlbn08Lz5cclxuICAgIDwvPiA6IDw+XHJcbiAgICAgIHtjaGlsZHJlbn1cclxuICAgIDwvPjtcclxuXHJcbiAgICAvL3ZhciBjdXJyZW50UHJvZ3Jlc3NEYXRhID0gLy9wcm9ncmVzc0RhdGEoKTtcclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZXx8JycpICsgXCIgb3BlbkNsb3NlXCIgKyAoaGVhZGVyT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkhlYWRlclwiICsgKGhlYWRlckNsYXNzTmFtZSA/IFwiIFwiICsgaGVhZGVyQ2xhc3NOYW1lIDogXCJcIil9XHJcbiAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMucHJvcHMub25PcGVuQ2xvc2UpIHRoaXMucHJvcHMub25PcGVuQ2xvc2UoIXRoaXMuc3RhdGUuaGVhZGVyT3Blbik7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KTtcclxuICAgICAgICB9fSA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICA8ZGl2Pnt0aXRsZX08L2Rpdj5cclxuICAgICAgICAgIHtkaXNwbGF5UHJvZ3Jlc3MgJiYgPEdvYWxQcm9ncmVzcyB7Li4ucHJvZ3Jlc3NEYXRhfS8+fVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkNvbnRlbnRcIiArIChjb250ZW50Q2xhc3NOYW1lID8gXCIgXCIgKyBjb250ZW50Q2xhc3NOYW1lIDogXCJcIil9PlxyXG4gICAgICAgIHtjaGlsZHJlbn1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVGFza1dpdGhNZXRhZGF0YSB7XHJcbiAgdGFzazogVGFzaztcclxuICBpc1Rhc2tPd25lcjogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0YXNrTWV0YXM6IFRhc2tXaXRoTWV0YWRhdGFbXTtcclxuICBvblNvcnQ6IChzb3VyY2U6IFRhc2ssIHRhcmdldDogVGFzaywgcGxhY2VtZW50OiAnYmVmb3JlJyB8ICdhZnRlcicpID0+IHZvaWQ7XHJcbiAgcmVuZGVyRWRpdExpbms/OiAodGFza01ldGE6IFRhc2tXaXRoTWV0YWRhdGEpID0+IGFueTtcclxuICByZW5kZXJMaW5rOiAodGFza01ldGE6IFRhc2tXaXRoTWV0YWRhdGEpID0+IGFueTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRhc2tIYXNNaWdyYXRlZFRleHRzKHRhc2s6IFRhc2spIHtcclxuICByZXR1cm4gdGFzay5taWdyYXRlZFRleHRzICYmIE9iamVjdC5rZXlzKHRhc2subWlncmF0ZWRUZXh0cykuc29tZSh0eXBlID0+XHJcbiAgICBPYmplY3Qua2V5cyh0YXNrLm1pZ3JhdGVkVGV4dHNbdHlwZV0pLmxlbmd0aCA+IDApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gU29ydGFibGVUYXNrTGlzdCh7dGFza01ldGFzLCByZW5kZXJFZGl0TGluaywgcmVuZGVyTGluaywgb25Tb3J0fTogUHJvcHMpIHtcclxuICBjb25zdCBbZHJhZ1N0YXRlLCBzZXREcmFnU3RhdGVdID0gdXNlU3RhdGUoe1xyXG4gICAgdGFza0JlaW5nRHJhZ2dlZDogbnVsbCBhcyBUYXNrIHwgbnVsbCxcclxuICAgIHRhc2tCZWluZ0hvdmVyZWQ6IG51bGwgYXMgVGFzayB8IG51bGwsXHJcbiAgICBpbnNlcnRCZWZvcmU6IGZhbHNlLFxyXG4gICAgb3JpZ2luQ2xpZW50WTogLTFcclxuICB9KTtcclxuICBjb25zdCB7dGFza0JlaW5nRHJhZ2dlZCwgdGFza0JlaW5nSG92ZXJlZCwgaW5zZXJ0QmVmb3JlLCBvcmlnaW5DbGllbnRZfSA9IGRyYWdTdGF0ZTtcclxuXHJcbiAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lciBzb3J0YWJsZVwiXHJcbiAgICAgIG9uRHJvcD17ZXYgPT4ge1xyXG4gICAgICAgIGlmICh0YXNrQmVpbmdIb3ZlcmVkICYmIHRhc2tCZWluZ0RyYWdnZWQpIHtcclxuICAgICAgICAgIG9uU29ydCh0YXNrQmVpbmdEcmFnZ2VkLCB0YXNrQmVpbmdIb3ZlcmVkLCBpbnNlcnRCZWZvcmUgPyAnYmVmb3JlJyA6ICdhZnRlcicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZXREcmFnU3RhdGUoey4uLmRyYWdTdGF0ZSwgdGFza0JlaW5nSG92ZXJlZDogbnVsbCwgdGFza0JlaW5nRHJhZ2dlZDogbnVsbH0pO1xyXG4gICAgICB9fVxyXG4gICAgPlxyXG4gIHt0YXNrTWV0YXMubWFwKHRhc2tNZXRhID0+IHtcclxuICAgIGNvbnN0IHt0YXNrLCBpc1Rhc2tPd25lcn0gPSB0YXNrTWV0YTtcclxuICAgIGNvbnN0IGhhc01pZ3JhdGVkVGV4dHMgPSB0YXNrSGFzTWlncmF0ZWRUZXh0cyh0YXNrKTtcclxuICAgIGNvbnN0IHRhc2tJZCA9IHRhc2suaWQ7XHJcblxyXG4gICAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudCBrZXk9e3Rhc2tJZH0+XHJcblxyXG4gICAgICB7aW5zZXJ0QmVmb3JlICYmIHRhc2tCZWluZ0hvdmVyZWQgPT09IHRhc2sgP1xyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHJvcC10YXJnZXRcIiBvbkRyYWdPdmVyPXtldiA9PiBldi5wcmV2ZW50RGVmYXVsdCgpfT4mbmJzcDs8L2Rpdj4gOlxyXG4gICAgICAgIG51bGxcclxuICAgICAgfVxyXG5cclxuICAgICAgPGRpdlxyXG4gICAgICAgIGNsYXNzTmFtZT17W1wiYWxpZ24taG9yaXpvbnRhbFwiLCBcImRyYWdnYWJsZVwiLCB0YXNrID09PSB0YXNrQmVpbmdEcmFnZ2VkICYmIFwiZHJhZy1zb3VyY2VcIl0uZmlsdGVyKHg9PngpLmpvaW4oJyAnKX1cclxuICAgICAgICBkcmFnZ2FibGU9e3RydWV9XHJcbiAgICAgICAgb25EcmFnU3RhcnQ9e2V2ID0+IHtcclxuICAgICAgICAgIGV2LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gXCJtb3ZlXCI7XHJcbiAgICAgICAgICBzZXREcmFnU3RhdGUoey4uLmRyYWdTdGF0ZSwgb3JpZ2luQ2xpZW50WTogZXYuY2xpZW50WSwgdGFza0JlaW5nRHJhZ2dlZDogdGFza30pXHJcbiAgICAgICAgfX1cclxuICAgICAgICBvbkRyYWdPdmVyPXtldiA9PiB7XHJcbiAgICAgICAgICBpZiAoIXRhc2tCZWluZ0RyYWdnZWQpIHJldHVybjtcclxuICAgICAgICAgIGlmICh0YXNrQmVpbmdEcmFnZ2VkID09PSB0YXNrKSB7XHJcbiAgICAgICAgICAgIHNldERyYWdTdGF0ZSh7Li4uZHJhZ1N0YXRlLCB0YXNrQmVpbmdIb3ZlcmVkOiBudWxsfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBldi5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9IFwibW92ZVwiO1xyXG4gICAgICAgICAgc2V0RHJhZ1N0YXRlKHsuLi5kcmFnU3RhdGUsIHRhc2tCZWluZ0hvdmVyZWQ6IHRhc2ssIGluc2VydEJlZm9yZTogb3JpZ2luQ2xpZW50WSA+IGV2LmNsaWVudFl9KTtcclxuICAgICAgICB9fVxyXG4gICAgICAgIG9uRHJhZ0VuZD17ZXYgPT4ge1xyXG4gICAgICAgICAgc2V0RHJhZ1N0YXRlKHsuLi5kcmFnU3RhdGUsIHRhc2tCZWluZ0hvdmVyZWQ6IG51bGwsIHRhc2tCZWluZ0RyYWdnZWQ6IG51bGx9KTtcclxuICAgICAgICB9fT5cclxuICAgICAgICB7aXNUYXNrT3duZXIgJiYgaGFzTWlncmF0ZWRUZXh0cyAmJiA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgPGRpdiBzdHlsZT17e3Bvc2l0aW9uOidyZWxhdGl2ZScsIHRvcDonMC4yZW0nLCBsZWZ0OiAnLTAuN2VtJ319PlxyXG4gICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wYWdlbGluZXNcIiBzdHlsZT17e3Bvc2l0aW9uOidhYnNvbHV0ZScsIHRvcDogMCwgbGVmdDogMCwgY29sb3I6JyM0OWMzNWEnfX0gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAge3JlbmRlckVkaXRMaW5rKHRhc2tNZXRhKX1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAge3JlbmRlckxpbmsodGFza01ldGEpfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHshaW5zZXJ0QmVmb3JlICYmIHRhc2tCZWluZ0hvdmVyZWQgPT09IHRhc2sgP1xyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHJvcC10YXJnZXRcIiBvbkRyYWdPdmVyPXtldiA9PiBldi5wcmV2ZW50RGVmYXVsdCgpfT4mbmJzcDs8L2Rpdj4gOlxyXG4gICAgICAgIG51bGxcclxuICAgICAgfVxyXG5cclxuICAgIDwvUmVhY3QuRnJhZ21lbnQ+O1xyXG4gIH0pfVxyXG4gIDwvZGl2PjtcclxufVxyXG4iLCJpbXBvcnQgZXhlYyBmcm9tICcuL2V4ZWMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIGJvbGQ6IHtcclxuICAgIGljb246ICc8Yj5GPC9iPicsXHJcbiAgICB0aXRsZTogJ0ZldHN0aWwnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdib2xkJylcclxuICB9LFxyXG4gIGl0YWxpYzoge1xyXG4gICAgaWNvbjogJzxpPks8L2k+JyxcclxuICAgIHRpdGxlOiAnS3Vyc2l2JyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaXRhbGljJylcclxuICB9LFxyXG4gIHVuZGVybGluZToge1xyXG4gICAgaWNvbjogJzx1PlU8L3U+JyxcclxuICAgIHRpdGxlOiAnVW5kZXJzdHJ1a2VuJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygndW5kZXJsaW5lJylcclxuICB9LFxyXG4gIHN0cmlrZXRocm91Z2g6IHtcclxuICAgIGljb246ICc8c3RyaWtlPlM8L3N0cmlrZT4nLFxyXG4gICAgdGl0bGU6ICdTdHJ1a2VuJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnc3RyaWtlVGhyb3VnaCcpXHJcbiAgfSxcclxuICBoZWFkaW5nMToge1xyXG4gICAgaWNvbjogJzxiPkg8c3ViPjE8L3N1Yj48L2I+JyxcclxuICAgIHRpdGxlOiAnUnVicmlrIDEnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDE+JylcclxuICB9LFxyXG4gIGhlYWRpbmcyOiB7XHJcbiAgICBpY29uOiAnPGI+SDxzdWI+Mjwvc3ViPjwvYj4nLFxyXG4gICAgdGl0bGU6ICdSdWJyaWsgMicsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxIMj4nKVxyXG4gIH0sXHJcbiAgaGVhZGluZzM6IHtcclxuICAgIGljb246ICc8Yj5IPHN1Yj4zPC9zdWI+PC9iPicsXHJcbiAgICB0aXRsZTogJ1J1YnJpayAzJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEgzPicpXHJcbiAgfSxcclxuICBwYXJhZ3JhcGg6IHtcclxuICAgIGljb246ICcmIzE4MjsnLFxyXG4gICAgdGl0bGU6ICdQYXJhZ3JhZicsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxQPicpXHJcbiAgfSxcclxuICBxdW90ZToge1xyXG4gICAgaWNvbjogJyYjODIyMDsgJiM4MjIxOycsXHJcbiAgICB0aXRsZTogJ0NpdGF0JyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEJMT0NLUVVPVEU+JylcclxuICB9LFxyXG4gIG9saXN0OiB7XHJcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1saXN0LW9sXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXHJcbiAgICB0aXRsZTogJ09yZG5hZCBsaXN0YScsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydE9yZGVyZWRMaXN0JylcclxuICB9LFxyXG4gIHVsaXN0OiB7XHJcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1saXN0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXHJcbiAgICB0aXRsZTogJ1B1bmt0bGlzdGEnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRVbm9yZGVyZWRMaXN0JylcclxuICB9LFxyXG4gIGNvZGU6IHtcclxuICAgIGljb246ICcmbHQ7LyZndDsnLFxyXG4gICAgdGl0bGU6ICdQcm9ncmFta29kJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFBSRT4nKVxyXG4gIH0sXHJcbiAgbGluZToge1xyXG4gICAgaWNvbjogJyYjODIxMzsnLFxyXG4gICAgdGl0bGU6ICdWw6VncsOkdCBsaW5qZScsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydEhvcml6b250YWxSdWxlJylcclxuICB9LFxyXG4gIGxpbms6IHtcclxuICAgIGljb246ICc8aSBjbGFzcz1cImZhIGZhLWxpbmtcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+JyxcclxuICAgIHRpdGxlOiAnSW5mb2dhIGzDpG5rJyxcclxuICAgIHJlc3VsdDogKCkgPT4ge1xyXG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KCdBbmdlIGzDpG5rZW5zIFVSTCcpXHJcbiAgICAgIGlmICh1cmwpIGV4ZWMoJ2NyZWF0ZUxpbmsnLCB1cmwpXHJcbiAgICB9XHJcbiAgfSxcclxuICBpbWFnZToge1xyXG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtcGljdHVyZS1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXHJcbiAgICB0aXRsZTogJ0luZm9nYSBiaWxkJyxcclxuICAgIHByb21wdE1zZzogJ0FuZ2UgYmlsZGVucyBVUkwnLFxyXG4gICAgcmVzdWx0IChldiwgY29tcG9uZW50KSB7XHJcbiAgICAgIGNvbnN0IHVybCA9IHdpbmRvdy5wcm9tcHQodGhpcy5wcm9tcHRNc2cpO1xyXG4gICAgICBpZiAodXJsKSB7XHJcbiAgICAgICAgLy9leGVjKCdpbnNlcnRJbWFnZScsIHVybCk7XHJcbiAgICAgICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcclxuICAgICAgICBpbWcuc3JjID0gdXJsO1xyXG4gICAgICAgIGltZy50YWJJbmRleCA9IDE7XHJcbiAgICAgICAgaW5zZXJ0RWxlbWVudChpbWcpO1xyXG4gICAgICAgIGltZy5vbmZvY3VzID0gY29tcG9uZW50Lm9uRm9jdXM7XHJcbiAgICAgICAgaW1nLm9uYmx1ciA9IGNvbXBvbmVudC5vbkJsdXI7XHJcbiAgICAgICAgY29tcG9uZW50LnByb3BzLm9uQ2hhbmdlKGNvbXBvbmVudC5jb250ZW50RGl2LmlubmVySFRNTCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluc2VydEVsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcclxuICAgIHZhciBzZWwsIHJhbmdlO1xyXG4gICAgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24gJiYgKHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKSkucmFuZ2VDb3VudCkge1xyXG4gICAgICAgIHJhbmdlID0gc2VsLmdldFJhbmdlQXQoMCk7XHJcbiAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7XHJcbiAgICAgICAgcmFuZ2UuaW5zZXJ0Tm9kZShlbGVtZW50KTtcclxuICAgICAgICAvLyBNb3ZlIHRoZSBjYXJldCBpbW1lZGlhdGVseSBhZnRlciB0aGUgaW5zZXJ0ZWQgc3BhblxyXG4gICAgICAgIHJhbmdlLnNldFN0YXJ0QWZ0ZXIoZWxlbWVudCk7XHJcbiAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7XHJcbiAgICAgICAgc2VsLnJlbW92ZUFsbFJhbmdlcygpO1xyXG4gICAgICAgIHNlbC5hZGRSYW5nZShyYW5nZSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IGV4ZWMgZnJvbSAnLi9leGVjJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICBib2xkOiB7XHJcbiAgICBpY29uOiAnPGI+QjwvYj4nLFxyXG4gICAgdGl0bGU6ICdCb2xkJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnYm9sZCcpXHJcbiAgfSxcclxuICBpdGFsaWM6IHtcclxuICAgIGljb246ICc8aT5JPC9pPicsXHJcbiAgICB0aXRsZTogJ0l0YWxpYycsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2l0YWxpYycpXHJcbiAgfSxcclxuICB1bmRlcmxpbmU6IHtcclxuICAgIGljb246ICc8dT5VPC91PicsXHJcbiAgICB0aXRsZTogJ1VuZGVybGluZScsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ3VuZGVybGluZScpXHJcbiAgfSxcclxuICBzdHJpa2V0aHJvdWdoOiB7XHJcbiAgICBpY29uOiAnPHN0cmlrZT5TPC9zdHJpa2U+JyxcclxuICAgIHRpdGxlOiAnU3RyaWtlLXRocm91Z2gnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdzdHJpa2VUaHJvdWdoJylcclxuICB9LFxyXG4gIGhlYWRpbmcxOiB7XHJcbiAgICBpY29uOiAnPGI+SDxzdWI+MTwvc3ViPjwvYj4nLFxyXG4gICAgdGl0bGU6ICdIZWFkaW5nIDEnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDE+JylcclxuICB9LFxyXG4gIGhlYWRpbmcyOiB7XHJcbiAgICBpY29uOiAnPGI+SDxzdWI+Mjwvc3ViPjwvYj4nLFxyXG4gICAgdGl0bGU6ICdIZWFkaW5nIDInLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDI+JylcclxuICB9LFxyXG4gIGhlYWRpbmczOiB7XHJcbiAgICBpY29uOiAnPGI+SDxzdWI+Mzwvc3ViPjwvYj4nLFxyXG4gICAgdGl0bGU6ICdIZWFkaW5nIDMnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDM+JylcclxuICB9LFxyXG4gIHBhcmFncmFwaDoge1xyXG4gICAgaWNvbjogJyYjMTgyOycsXHJcbiAgICB0aXRsZTogJ1BhcmFncmFwaCcsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxQPicpXHJcbiAgfSxcclxuICBxdW90ZToge1xyXG4gICAgaWNvbjogJyYjODIyMDsgJiM4MjIxOycsXHJcbiAgICB0aXRsZTogJ1F1b3RlJyxcclxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEJMT0NLUVVPVEU+JylcclxuICB9LFxyXG4gIG9saXN0OiB7XHJcbiAgICBpY29uOiAnJiMzNTsnLFxyXG4gICAgdGl0bGU6ICdPcmRlcmVkIExpc3QnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRPcmRlcmVkTGlzdCcpXHJcbiAgfSxcclxuICB1bGlzdDoge1xyXG4gICAgaWNvbjogJyYjODIyNjsnLFxyXG4gICAgdGl0bGU6ICdVbm9yZGVyZWQgTGlzdCcsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydFVub3JkZXJlZExpc3QnKVxyXG4gIH0sXHJcbiAgY29kZToge1xyXG4gICAgaWNvbjogJyZsdDsvJmd0OycsXHJcbiAgICB0aXRsZTogJ0NvZGUnLFxyXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8UFJFPicpXHJcbiAgfSxcclxuICBsaW5lOiB7XHJcbiAgICBpY29uOiAnJiM4MjEzOycsXHJcbiAgICB0aXRsZTogJ0hvcml6b250YWwgTGluZScsXHJcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydEhvcml6b250YWxSdWxlJylcclxuICB9LFxyXG4gIGxpbms6IHtcclxuICAgIGljb246ICcmIzEyODI3OTsnLFxyXG4gICAgdGl0bGU6ICdMaW5rJyxcclxuICAgIHJlc3VsdDogKCkgPT4ge1xyXG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KCdFbnRlciB0aGUgbGluayBVUkwnKVxyXG4gICAgICBpZiAodXJsKSBleGVjKCdjcmVhdGVMaW5rJywgdXJsKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgaW1hZ2U6IHtcclxuICAgIGljb246ICcmIzEyODI0NzsnLFxyXG4gICAgdGl0bGU6ICdJbWFnZScsXHJcbiAgICBwcm9tcHRNc2c6ICdFbnRlciB0aGUgVVJMIG9mIHRoZSBpbWFnZScsXHJcbiAgICByZXN1bHQgKCkge1xyXG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KHRoaXMucHJvbXB0TXNnKVxyXG4gICAgICBpZiAodXJsKSBleGVjKCdpbnNlcnRJbWFnZScsIHVybClcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgKGNvbW1hbmQsIHZhbHVlID0gbnVsbCkgPT4ge1xyXG4gIGRvY3VtZW50LmV4ZWNDb21tYW5kKGNvbW1hbmQsIGZhbHNlLCB2YWx1ZSlcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbWFnZUVkaXRBY3Rpb25zKGNiKSB7XHJcbiAgcmV0dXJuIFt7XHJcbiAgICBuYW1lOiAnZmxvYXQtbGVmdCcsXHJcbiAgICBpY29uOiBgPGRpdiBzdHlsZT1cInBvc2l0aW9uOnJlbGF0aXZlXCI+XHJcbiAgICAgIDxpIGNsYXNzPVwiZmEgZmEtYWxpZ24tcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDotNHB4O3RvcDowOyB0cmFuc2Zvcm06IHNjYWxlKDAuNSk7IHRyYW5zZm9ybS1vcmlnaW46IGxlZnQgdG9wXCI+XHJcbiAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1waWN0dXJlLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+YCxcclxuICAgIHRpdGxlOiAnTMOldCBiaWxkZW4gZmx5dGEgdsOkbnN0ZXIgb20gdGV4dCcsXHJcbiAgICByZXN1bHQ6ICgpID0+IGNiKCdmbG9hdC1sZWZ0JylcclxuICB9LCB7XHJcbiAgICBuYW1lOiAnZmxvYXQtcmlnaHQnLFxyXG4gICAgaWNvbjogYDxkaXYgc3R5bGU9XCJwb3NpdGlvbjpyZWxhdGl2ZVwiPlxyXG4gICAgICA8aSBjbGFzcz1cImZhIGZhLWFsaWduLWxlZnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsgcmlnaHQ6LTRweDt0b3A6MDsgdHJhbnNmb3JtOiBzY2FsZSgwLjUpOyB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCB0b3BcIj5cclxuICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXBpY3R1cmUtb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5gLFxyXG4gICAgdGl0bGU6ICdMw6V0IGJpbGRlbiBmbHl0YSBow7ZnZXIgb20gdGV4dCcsXHJcbiAgICByZXN1bHQ6ICgpID0+IGNiKCdmbG9hdC1yaWdodCcpXHJcbiAgfSwge1xyXG4gICAgbmFtZTogJ3VuZmxvYXQnLFxyXG4gICAgaWNvbjogYDxkaXYgc3R5bGU9XCJwb3NpdGlvbjpyZWxhdGl2ZTtcIiBhcmlhLWhpZGRlbj1cInRydWVcIj5cclxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MFwiPiYjODI1NDs8L2Rpdj5cclxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowOmxlZnQ6MDt0cmFuc2Zvcm06IHNjYWxlKDAuNSk7IHRyYW5zZm9ybS1vcmlnaW46IGxlZnQgYm90dG9tXCI+XHJcbiAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1waWN0dXJlLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowXCI+XzwvZGl2PlxyXG4gICAgPC9kaXY+YCxcclxuICAgIHRpdGxlOiAnUGxhY2VyYSBiaWxkZW4gcMOlIGVnZW4gcmFkJyxcclxuICAgIHJlc3VsdDogKCkgPT4gY2IoJ3VuZmxvYXQnKVxyXG4gIH1dO1xyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBleGVjIGZyb20gJy4vZXhlYyc7XHJcbmltcG9ydCB7d2FzaEh0bWx9IGZyb20gJy4vd2FzaC1odG1sJztcclxuaW1wb3J0IGltYWdlRWRpdEFjdGlvbnMgZnJvbSAnLi9pbWFnZS1lZGl0LWFjdGlvbnMnO1xyXG5pbXBvcnQgYWN0aW9ucyBmcm9tICcuL2FjdGlvbnMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBY3Rpb24ge1xyXG4gIG5hbWU/OiBzdHJpbmc7XHJcbiAgaWNvbjogc3RyaW5nO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgcHJvbXB0TXNnPzogc3RyaW5nO1xyXG4gIHJlc3VsdDogKGV2OiBSZWFjdC5Nb3VzZUV2ZW50PEhUTUxCdXR0b25FbGVtZW50PiwgY29tcG9uZW50OiBXeXNpd3lnKSA9PiB2b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNsYXNzTmFtZT86IHN0cmluZztcclxuICBodG1sOiBzdHJpbmc7XHJcbiAgb25DaGFuZ2U/OiAoaHRtbDogc3RyaW5nKSA9PiB2b2lkO1xyXG4gIHJlcG9ydE51bUNoYXJzPzogKG51bUNoYXJzOiBudW1iZXIpID0+IHZvaWQ7XHJcbiAgbWF4Q2hhcnM/OiBudW1iZXI7XHJcbiAgZGVmYXVsdEFjdGlvbnM/OiB7W25hbWU6IHN0cmluZ106IEFjdGlvbn07XHJcbiAgYWN0aW9ucz86IChQYXJ0aWFsPEFjdGlvbj4gfCBzdHJpbmcpW107XHJcbiAgcmVhZE9ubHk/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGZvY3VzUmVjdDogQ2xpZW50UmVjdCB8IG51bGw7XHJcbn1cclxuXHJcbmNvbnN0IGNsYXNzZXMgPSB7XHJcbiAgYWN0aW9uYmFyOiAnd3lzaXd5Zy1hY3Rpb25iYXInLFxyXG4gIGJ1dHRvbjogJ3d5c2l3eWctYnV0dG9uJyxcclxuICBjb250ZW50OiAnd3lzaXd5Zy1jb250ZW50JyxcclxuICBmb2N1c3JlY3Q6ICd3eXNpd3lnLWZvY3VzcmVjdCcsXHJcbiAgZm9jdXNwb2ludDogJ3d5c2l3eWctZm9jdXNwb2ludCcsXHJcbiAgcmVhZG9ubHlDb250ZW50OiAnd3lzaXd5Zy1jb250ZW50IHJlYWRvbmx5J1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgV3lzaXd5ZyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnRlbnREaXY6IEhUTUxEaXZFbGVtZW50O1xyXG4gIGZvY3VzUmVjdERpdjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgZm9jdXNFbGVtOiBIVE1MRWxlbWVudCB8IG51bGw7XHJcbiAgY29ybmVyOiBzdHJpbmc7XHJcbiAgcmVzaXplU3RhcnRYOiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7Zm9jdXNSZWN0OiBudWxsfTtcclxuICAgIHRoaXMub25Gb2N1cyA9IHRoaXMub25Gb2N1cy5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5vbkJsdXIgPSB0aGlzLm9uQmx1ci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5vbk1vdXNlRG93biA9IHRoaXMub25Nb3VzZURvd24uYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25Nb3VzZU1vdmUgPSB0aGlzLm9uTW91c2VNb3ZlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLm9uTW91c2VVcCA9IHRoaXMub25Nb3VzZVVwLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgIGlmICghdGhpcy5wcm9wcy5yZWFkT25seSkge1xyXG4gICAgICBBcnJheS5mcm9tKHRoaXMuY29udGVudERpdi5xdWVyeVNlbGVjdG9yQWxsKFwiaW1nLGFcIikpLm1hcChlbGVtID0+IChlbGVtIGFzIChIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTEFuY2hvckVsZW1lbnQpKSlcclxuICAgICAgLmZvckVhY2goZWxlbSA9PiB7XHJcbiAgICAgICAgZWxlbS50YWJJbmRleCA9IDE7XHJcbiAgICAgICAgZWxlbS5vbmZvY3VzID0gdGhpcy5vbkZvY3VzO1xyXG4gICAgICAgIGVsZW0ub25ibHVyID0gdGhpcy5vbkJsdXIgYXMgYW55O1xyXG4gICAgICB9KTtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53eXNpd3lnLWNvbnRlbnRcIikuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93bik7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3lzaXd5Zy1jb250ZW50XCIpLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMub25Nb3VzZU1vdmUpO1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXApO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMucHJvcHMucmVwb3J0TnVtQ2hhcnMpIHtcclxuICAgICAgdGhpcy5wcm9wcy5yZXBvcnROdW1DaGFycygodGhpcy5jb250ZW50RGl2ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQgJiYgdGhpcy5jb250ZW50RGl2LmlubmVyVGV4dC5sZW5ndGgpIHx8IDApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xyXG4gICAgQXJyYXkuZnJvbSh0aGlzLmNvbnRlbnREaXYucXVlcnlTZWxlY3RvckFsbChcImltZyxhXCIpKS5tYXAoZWxlbSA9PiAoZWxlbSBhcyAoSFRNTEltYWdlRWxlbWVudCB8IEhUTUxBbmNob3JFbGVtZW50KSkpXHJcbiAgICAuZm9yRWFjaChlbGVtID0+IHtcclxuICAgICAgZWxlbS50YWJJbmRleCA9IDE7XHJcbiAgICAgIGVsZW0ub25mb2N1cyA9IHRoaXMub25Gb2N1cztcclxuICAgICAgZWxlbS5vbmJsdXIgPSB0aGlzLm9uQmx1ciBhcyBhbnk7XHJcbiAgICB9KTtcclxuICAgIGlmICh0aGlzLnByb3BzLnJlcG9ydE51bUNoYXJzKSB7XHJcbiAgICAgIHRoaXMucHJvcHMucmVwb3J0TnVtQ2hhcnMoKHRoaXMuY29udGVudERpdiAmJiB0aGlzLmNvbnRlbnREaXYuaW5uZXJUZXh0ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQubGVuZ3RoKSB8fCAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53eXNpd3lnLWNvbnRlbnRcIikucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93bik7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnd5c2l3eWctY29udGVudFwiKS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlKTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3lzaXd5Zy1jb250ZW50XCIpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm9uTW91c2VVcCk7XHJcbiAgfVxyXG5cclxuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzOiBQcm9wcywgbmV4dFN0YXRlOiBTdGF0ZSkge1xyXG4gICAgLy90aGlzLmNvbnRlbnREaXYub25mb2N1cyA9IHRoaXMub25Gb2N1cztcclxuICAgIC8vdGhpcy5jb250ZW50RGl2Lm9uYmx1ciA9IHRoaXMub25CbHVyO1xyXG4gICAgcmV0dXJuICF0aGlzLmNvbnRlbnREaXYgfHxcclxuICAgICAgbmV4dFN0YXRlICE9IHRoaXMuc3RhdGUgfHxcclxuICAgICAgbmV4dFByb3BzLnJlYWRPbmx5ICE9PSB0aGlzLnByb3BzLnJlYWRPbmx5IHx8XHJcbiAgICAgIHdhc2hIdG1sKG5leHRQcm9wcy5odG1sKSAhPT0gd2FzaEh0bWwodGhpcy5jb250ZW50RGl2LmlubmVySFRNTCk7XHJcbiAgfVxyXG5cclxuICB0cmlnZ2VyT25DaGFuZ2UoaHRtbDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlICYmIHRoaXMucHJvcHMub25DaGFuZ2Uod2FzaEh0bWwoaHRtbCkpO1xyXG4gIH1cclxuXHJcbiAgb25Gb2N1cyhldjogRm9jdXNFdmVudCkge1xyXG4gICAgY29uc3QgZWxlbSA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuICAgIGlmICghZWxlbSB8fCAhZWxlbS50YWdOYW1lKSByZXR1cm47XHJcbiAgICBpZiAoZWxlbS50YWdOYW1lICE9PSAnSU1HJyAmJiBlbGVtLnRhZ05hbWUgIT09ICdBJykgcmV0dXJuO1xyXG4gICAgY29uc3QgY29udGVudFBhcmVudCA9IHRoaXMuY29udGVudERpdi5wYXJlbnRFbGVtZW50O1xyXG4gICAgY29uc3QgbmV3U3RhdGUgPSB7XHJcbiAgICAgIGZvY3VzUmVjdDogZ2V0UmVsYXRhdGl2ZUNsaWVudFJlY3QoY29udGVudFBhcmVudCwgZWxlbSksXHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKGVsZW0udGFnTmFtZSkge1xyXG4gICAgICBjYXNlICdBJzpcclxuICAgICAgY2FzZSAnSU1HJzpcclxuXHJcbiAgICAgIGRlZmF1bHQ6IGJyZWFrO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSk7XHJcbiAgICB0aGlzLmZvY3VzRWxlbSA9IGVsZW07XHJcbiAgfVxyXG5cclxuICBvbkJsdXIoZXY6IFJlYWN0LkZvY3VzRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XHJcbiAgICAvKmlmIChldi5yZWxhdGVkVGFyZ2V0KSB7XHJcbiAgICAgIGNvbnN0IHJlbGF0ZWRUYXJnZXQgPSBldi5yZWxhdGVkVGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICBpZiAocmVsYXRlZFRhcmdldC5jbGFzc05hbWUgJiYgcmVsYXRlZFRhcmdldC5jbGFzc05hbWUuc3BsaXQoJyAnKS5pbmRleE9mKGNsYXNzZXMuYnV0dG9uKSA+PSAwKSB7XHJcbiAgICAgICAgLy8gQSBpbWFnZSBhY3Rpb24gYnV0dG9uIHdhcyBwcmVzc2VkXHJcbiAgICAgICAgc2V0XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICB9Ki9cclxuICAgIGlmICgoZXYudGFyZ2V0ID09PSB0aGlzLmZvY3VzRWxlbSAmJiBldi5yZWxhdGVkVGFyZ2V0ICE9PSB0aGlzLmZvY3VzUmVjdERpdikgfHxcclxuICAgICAgZXYudGFyZ2V0ID09PSB0aGlzLmZvY3VzUmVjdERpdilcclxuICAgIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7Zm9jdXNSZWN0OiBudWxsfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBtYWtlQ2xpY2thYmxlKGVsZW06IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgZWxlbS50YWJJbmRleCA9IDE7XHJcbiAgfVxyXG5cclxuICBvbk1vdXNlRG93bihldikge1xyXG4gICAgaWYgKChldi50YXJnZXQuY2xhc3NOYW1lIHx8IFwiXCIpLnNwbGl0KCcgJykuaW5kZXhPZihjbGFzc2VzLmZvY3VzcG9pbnQpID49IDApIHtcclxuICAgICAgY29uc3QgY29ybmVyID0gdGhpcy5nZXRSZWN0Q29ybmVyKGV2KTtcclxuICAgICAgdGhpcy5jb3JuZXIgPSBjb3JuZXI7XHJcbiAgICAgIHRoaXMucmVzaXplU3RhcnRYID0gZXYuY2xpZW50WDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uTW91c2VNb3ZlKGV2OiBNb3VzZUV2ZW50KSB7XHJcbiAgICBpZiAodGhpcy5jb3JuZXIgJiYgdGhpcy5zdGF0ZS5mb2N1c1JlY3QgJiYgdGhpcy5mb2N1c0VsZW0pIHtcclxuICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgLy8gVE9ETzogUsOka25hIHV0IGJhc2VyYXQgcMOlIHRoaXMuY29ybmVyIGh1ciBiaWxkZW5zIHN0b3JsZWsgYm9yZGUgw6RuZHJhcy5cclxuICAgICAgLy8gTGV0YSB1cHAgYmlsZGVuIHBlciBJRCBmcsOlbiB0aGlzLmNvbnRlbnREaXZcclxuICAgICAgLy8gU8OkdHQgRElWOmVucyBzdHlsZSBhdHRyaWJ1dCB3aWR0aCB0aWxsIG55IHdpZHRoLlxyXG4gICAgICAvLyBPbSBESVY6ZW4gcmVkYW4gaGFkZSBoZWlnaHQsIHPDpHR0IG55IGhlaWdodCBtZWQgc2FtbWEgYXNwZWN0IHJhdGlvIHNvbSBpbm5hbixcclxuICAgICAgLy8gYW5uYXJzLCBzw6R0dCBpbnRlIGhlaWdodCBhbGxzIChlbGxlciBtw7ZqbGlndHZpcyB0aWxsIGF1dG8pKVxyXG4gICAgICBjb25zdCBmb2N1c1JlY3QgPSB0aGlzLmZvY3VzUmVjdERpdi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgaWYgKGZvY3VzUmVjdC53aWR0aCA8IDMyKSByZXR1cm47XHJcbiAgICAgIC8vY29uc3QgY3VycmVudFdpZHRoID0gZm9jdXNSZWN0LndpZHRoO1xyXG4gICAgICAvL2NvbnN0IGN1cnJlbnRIZWlnaHQgPSBmb2N1c1JlY3QuaGVpZ2h0O1xyXG4gICAgICAvL2NvbnN0IGhhc0hlaWdodFN0eWxlID0gIXRoaXMuZm9jdXNFbGVtLnN0eWxlLmhlaWdodCB8fCB0aGlzLmZvY3VzRWxlbS5zdHlsZS5oZWlnaHQgPT09IFwiYXV0b1wiO1xyXG4gICAgICBjb25zdCBuZXdXaWR0aCA9IE1hdGgubWF4KDMyLCB0aGlzLmNvcm5lci5lbmRzV2l0aCgnbCcpID9cclxuICAgICAgICBmb2N1c1JlY3Qud2lkdGggKyAodGhpcy5yZXNpemVTdGFydFggLSBldi5jbGllbnRYKSA6XHJcbiAgICAgICAgLy9mb2N1c1JlY3QucmlnaHQgLSBldi5jbGllbnRYIDpcclxuICAgICAgICBmb2N1c1JlY3Qud2lkdGggLSAodGhpcy5yZXNpemVTdGFydFggLSBldi5jbGllbnRYKSk7XHJcbiAgICAgIHRoaXMucmVzaXplU3RhcnRYID0gZXYuY2xpZW50WDtcclxuICAgICAgICAvL2V2LmNsaWVudFggLSBmb2N1c1JlY3QubGVmdDtcclxuICAgICAgY29uc3QgZmFjdG9yID0gbmV3V2lkdGggLyBmb2N1c1JlY3Qud2lkdGg7XHJcbiAgICAgIGNvbnN0IG5ld0hlaWdodCA9IGZvY3VzUmVjdC5oZWlnaHQgKiBmYWN0b3I7XHJcbiAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLndpZHRoID0gbmV3V2lkdGggKyBcInB4XCI7XHJcbiAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLmhlaWdodCA9IG5ld0hlaWdodCArIFwicHhcIjtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgZm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCh0aGlzLmNvbnRlbnREaXYucGFyZW50RWxlbWVudCwgdGhpcy5mb2N1c0VsZW0pLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uTW91c2VVcChldikge1xyXG4gICAgaWYgKHRoaXMuY29ybmVyICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0ICYmIHRoaXMuZm9jdXNFbGVtKSB7XHJcbiAgICAgIHRoaXMuY29ybmVyID0gbnVsbDtcclxuICAgICAgdGhpcy50cmlnZ2VyT25DaGFuZ2UodGhpcy5jb250ZW50RGl2LmlubmVySFRNTCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRSZWN0Q29ybmVyKGV2KSB7XHJcbiAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiAoZXYudGFyZ2V0LmNsYXNzTmFtZSB8fCAnJykuc3BsaXQoJyAnKSkge1xyXG4gICAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xyXG4gICAgICAgIGNhc2UgJ2ZwdWwnOlxyXG4gICAgICAgICAgcmV0dXJuICd1bCc7XHJcbiAgICAgICAgY2FzZSAnZnB1cic6XHJcbiAgICAgICAgICByZXR1cm4gJ2ZwdXInO1xyXG4gICAgICAgIGNhc2UgJ2ZwbHInOlxyXG4gICAgICAgICAgcmV0dXJuICdscic7XHJcbiAgICAgICAgY2FzZSAnZnBsbCc6XHJcbiAgICAgICAgICByZXR1cm4gJ2xsJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBleGVjSW1hZ2VFZGl0QWN0aW9uIChjbWQ6IHN0cmluZykge1xyXG4gICAgLy9jb25zb2xlLmxvZyhjbWQpO1xyXG4gICAgaWYgKCF0aGlzLmZvY3VzRWxlbSkgcmV0dXJuO1xyXG4gICAgLy9jb25zb2xlLmxvZyhcImRvaW5nIGl0XCIpO1xyXG4gICAgc3dpdGNoIChjbWQpIHtcclxuICAgICAgY2FzZSAnZmxvYXQtbGVmdCc6XHJcbiAgICAgICAgdGhpcy5mb2N1c0VsZW0uc3R5bGUuY3NzRmxvYXQgPSAnbGVmdCc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ2Zsb2F0LXJpZ2h0JzpcclxuICAgICAgICB0aGlzLmZvY3VzRWxlbS5zdHlsZS5jc3NGbG9hdCA9ICdyaWdodCc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3VuZmxvYXQnOlxyXG4gICAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLmNzc0Zsb2F0ID0gJyc7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICB0aGlzLnRyaWdnZXJPbkNoYW5nZSh0aGlzLmNvbnRlbnREaXYuaW5uZXJIVE1MKTtcclxuICAgIHRoaXMuc2V0U3RhdGUoe2ZvY3VzUmVjdDogZ2V0UmVsYXRhdGl2ZUNsaWVudFJlY3QodGhpcy5jb250ZW50RGl2LnBhcmVudEVsZW1lbnQsIHRoaXMuZm9jdXNFbGVtKX0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgZGVmYXVsdEFjdGlvbnMgPSB0aGlzLnByb3BzLmRlZmF1bHRBY3Rpb25zIHx8IGFjdGlvbnM7XHJcbiAgICBsZXQgYWN0aW9uc1RvVXNlID0gdGhpcy5wcm9wcy5hY3Rpb25zID8gdGhpcy5wcm9wcy5hY3Rpb25zLm1hcChhY3Rpb24gPT5cclxuICAgICAgdHlwZW9mIGFjdGlvbiA9PT0gJ3N0cmluZycgP1xyXG4gICAgICAgIGRlZmF1bHRBY3Rpb25zW2FjdGlvbl0gOlxyXG4gICAgICAgIGRlZmF1bHRBY3Rpb25zW2FjdGlvbi5uYW1lXSA/XHJcbiAgICAgICAgICB7IC4uLmRlZmF1bHRBY3Rpb25zW2FjdGlvbi5uYW1lXSwgLi4uYWN0aW9uIH0gOlxyXG4gICAgICAgICAgYWN0aW9uKVxyXG4gICAgOiBPYmplY3Qua2V5cyhkZWZhdWx0QWN0aW9ucykubWFwKGFjdGlvbiA9PiBkZWZhdWx0QWN0aW9uc1thY3Rpb25dKTtcclxuXHJcbiAgICBpZiAodGhpcy5zdGF0ZS5mb2N1c1JlY3QpIHtcclxuICAgICAgYWN0aW9uc1RvVXNlID0gYWN0aW9uc1RvVXNlLmNvbmNhdChpbWFnZUVkaXRBY3Rpb25zKGNtZCA9PiB0aGlzLmV4ZWNJbWFnZUVkaXRBY3Rpb24oY21kKSkpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHtmb2N1c1JlY3R9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHtyZWFkT25seSwgcmVwb3J0TnVtQ2hhcnMsIG1heENoYXJzfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXt0aGlzLnByb3BzLmNsYXNzTmFtZX0+XHJcbiAgICAgIHshcmVhZE9ubHkgJiYgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuYWN0aW9uYmFyfT5cclxuICAgICAgICB7YWN0aW9uc1RvVXNlLm1hcCgoYWN0aW9uLCBpZHgpID0+XHJcbiAgICAgICAgICA8YnV0dG9uIGtleT17aWR4fSBjbGFzc05hbWU9e2NsYXNzZXMuYnV0dG9ufVxyXG4gICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogYWN0aW9uLmljb259fVxyXG4gICAgICAgICAgICB0aXRsZT17YWN0aW9uLnRpdGxlfVxyXG4gICAgICAgICAgICBvbk1vdXNlRG93bj17ZXY9PnthY3Rpb24ucmVzdWx0KGV2LCB0aGlzKX19XHJcbiAgICAgICAgICAgIG9uTW91c2VVcD17ZXY9PnNldFRpbWVvdXQoKCk9PnRoaXMuY29udGVudERpdi5mb2N1cygpLCAxMCl9XHJcbiAgICAgICAgICAvPil9XHJcbiAgICAgIDwvZGl2Pn1cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e3JlYWRPbmx5ID8gY2xhc3Nlcy5yZWFkb25seUNvbnRlbnQgOiBjbGFzc2VzLmNvbnRlbnR9IHN0eWxlPXt7cG9zaXRpb246ICdyZWxhdGl2ZScsIHRvcDogMCwgbGVmdDogMH19PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZWRpdG9yXCJcclxuICAgICAgICAgIHJlZj17ZGl2ID0+IHRoaXMuY29udGVudERpdiA9IGRpdn1cclxuICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiB3YXNoSHRtbCh0aGlzLnByb3BzLmh0bWwpfX1cclxuICAgICAgICAgIGNvbnRlbnRFZGl0YWJsZT17IXJlYWRPbmx5fVxyXG4gICAgICAgICAgb25QYXN0ZT17ZXYgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWlzTmFOKG1heENoYXJzKSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHt0YXJnZXQsIGN1cnJlbnRUYXJnZXR9ID0gZXY7XHJcbiAgICAgICAgICAgICAgLy9jb25zdCB0ZXh0QmVpbmdPdmVyd3JpdHRlbiA9ICh0YXJnZXQgYXMgYW55KS5pbm5lclRleHQgfHwgXCJcIjtcclxuICAgICAgICAgICAgICBjb25zdCBlZGl0b3JUZXh0ID0gKGN1cnJlbnRUYXJnZXQgJiYgY3VycmVudFRhcmdldC5pbm5lclRleHQpIHx8IFwiXCI7XHJcbiAgICAgICAgICAgICAgY29uc3QgdGV4dEJlaW5nUGFzdGVkID0gZXYuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSB8fCBcIlwiO1xyXG4gICAgICAgICAgICAgIGlmIChlZGl0b3JUZXh0Lmxlbmd0aCArIHRleHRCZWluZ1Bhc3RlZC5sZW5ndGggPiBtYXhDaGFycykge1xyXG4gICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH19XHJcbiAgICAgICAgICBvbktleVVwPXtyZXBvcnROdW1DaGFycyA/IGV2ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qge2lubmVyVGV4dH0gPSAoZXYudGFyZ2V0IGFzIGFueSk7XHJcbiAgICAgICAgICAgIHJlcG9ydE51bUNoYXJzKGlubmVyVGV4dCA/IGlubmVyVGV4dC5sZW5ndGggOiAwKTtcclxuICAgICAgICAgIH0gOiBudWxsfVxyXG4gICAgICAgICAgb25LZXlQcmVzcz17IWlzTmFOKG1heENoYXJzKSA/IGV2ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qge2lubmVyVGV4dH0gPSAoZXYudGFyZ2V0IGFzIGFueSk7XHJcbiAgICAgICAgICAgIGlmIChpbm5lclRleHQgJiYgaW5uZXJUZXh0Lmxlbmd0aCA+PSBtYXhDaGFycykge1xyXG4gICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gOiBudWxsfVxyXG4gICAgICAgICAgb25JbnB1dD17ZXYgPT4gdGhpcy50cmlnZ2VyT25DaGFuZ2UoKGV2LnRhcmdldCBhcyBhbnkpLmlubmVySFRNTCl9XHJcbiAgICAgICAgICBvbktleURvd249e2V2ID0+IHtcclxuICAgICAgICAgICAgaWYgKHJlYWRPbmx5KSByZXR1cm47XHJcbiAgICAgICAgICAgIGlmIChyZXBvcnROdW1DaGFycyAmJiBldi5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgcmVwb3J0TnVtQ2hhcnMoKGV2LmN1cnJlbnRUYXJnZXQuaW5uZXJUZXh0IHx8IFwiXCIpLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJLZXk6IFwiICsgZXYud2hpY2gpO1xyXG4gICAgICAgICAgICBpZiAoZXYud2hpY2ggPj0gMzUgJiYgZXYud2hpY2ggPD0gNDApIHsvLyBob21lL2VuZC91cC9kb3duL2xlZnQvcmlnaHRcclxuICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBlbnRpcmUgcGFnZSBmcm9tIHNjcm9sbGluZz8/XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGV2LndoaWNoID09PSA5KSB7XHJcbiAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsvLyBUQUJcclxuICAgICAgICAgICAgICBpZiAoZXYuc2hpZnRLZXkpIHtcclxuICAgICAgICAgICAgICAgIGV4ZWMoXCJvdXRkZW50XCIpO1xyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBleGVjKFwiaW5kZW50XCIpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgIChldi5rZXlDb2RlID09PSA4IHx8IGV2LmtleUNvZGUgPT09IDQ2KSAmJiAvLyBEZWxldGUgb3IgQmFjayBidXR0b25zXHJcbiAgICAgICAgICAgICAgdGhpcy5mb2N1c0VsZW0gJiYgdGhpcy5zdGF0ZS5mb2N1c1JlY3QpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBpZiAodGhpcy5mb2N1c0VsZW0gJiYgdGhpcy5mb2N1c0VsZW0ucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c0VsZW0ucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmZvY3VzRWxlbSk7IC8vIFJlbW92ZSBtYXJrZWQgaW1hZ2VcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgdGhpcy5mb2N1c0VsZW0gPSBudWxsO1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2ZvY3VzUmVjdDogbnVsbH0pO1xyXG4gICAgICAgICAgICAgIHRoaXMudHJpZ2dlck9uQ2hhbmdlKHRoaXMuY29udGVudERpdi5pbm5lckhUTUwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9fVxyXG4gICAgICAgIC8+XHJcbiAgICAgICAge2ZvY3VzUmVjdCAmJiA8ZGl2XHJcbiAgICAgICAgICByZWY9e2RpdiA9PiB0aGlzLmZvY3VzUmVjdERpdiA9IGRpdn1cclxuICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3Nlcy5mb2N1c3JlY3R9XHJcbiAgICAgICAgICBvbkJsdXI9e3RoaXMub25CbHVyfVxyXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICBvdXRsaW5lOiAwLFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgICAgICAgdG9wOiB0aGlzLnN0YXRlLmZvY3VzUmVjdC50b3AsXHJcbiAgICAgICAgICAgIGxlZnQ6IHRoaXMuc3RhdGUuZm9jdXNSZWN0LmxlZnQsXHJcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLnN0YXRlLmZvY3VzUmVjdC53aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLnN0YXRlLmZvY3VzUmVjdC5oZWlnaHR9fT5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcHVsXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgdG9wOjAsIGxlZnQ6MH19IC8+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5mb2N1c3BvaW50ICsgXCIgZnB1clwifSBzdHlsZT17e3Bvc2l0aW9uOidhYnNvbHV0ZScsIHRvcDowLCByaWdodDowfX0gLz5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcGxyXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgYm90dG9tOjAsIHJpZ2h0OjB9fSAvPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuZm9jdXNwb2ludCArIFwiIGZwbGxcIn0gc3R5bGU9e3twb3NpdGlvbjonYWJzb2x1dGUnLCBib3R0b206MCwgbGVmdDowfX0gLz5cclxuICAgICAgICA8L2Rpdj59XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCAocGFyZW50OiBIVE1MRWxlbWVudCwgY2hpbGQ6IEhUTUxFbGVtZW50KSA6IENsaWVudFJlY3Qge1xyXG4gIGNvbnN0IHBhcmVudFJlY3QgPSBwYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgY29uc3QgY2hpbGRSZWN0ID0gY2hpbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgcmV0dXJuIHtcclxuICAgIHRvcDogY2hpbGRSZWN0LnRvcCAtIHBhcmVudFJlY3QudG9wICsgcGFyZW50LnNjcm9sbFRvcCxcclxuICAgIGxlZnQ6IGNoaWxkUmVjdC5sZWZ0IC0gcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50LnNjcm9sbExlZnQsXHJcbiAgICBib3R0b206IGNoaWxkUmVjdC5ib3R0b20gLSBwYXJlbnRSZWN0LnRvcCArIHBhcmVudC5zY3JvbGxUb3AsXHJcbiAgICByaWdodDogY2hpbGRSZWN0LnJpZ2h0IC0gcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50LnNjcm9sbExlZnQsXHJcbiAgICB3aWR0aDogY2hpbGRSZWN0LndpZHRoLFxyXG4gICAgaGVpZ2h0OiBjaGlsZFJlY3QuaGVpZ2h0XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgJCBmcm9tICdqcXVlcnknO1xyXG5cclxuY29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG5cclxudHlwZSBIVE1MUG9saWN5ID0ge1t0YWdOYW1lTG93ZXI6IHN0cmluZ106IHtbYXR0cmlidXRlTG93ZXI6IHN0cmluZ106IGJvb2xlYW59fTtcclxuXHJcbi8qKiBUYWdzIC8gQXR0cmlidXRlcyBXaGl0ZWxpc3RcclxuICogXHJcbiAqL1xyXG5jb25zdCBIVE1MX1dBU0hfUE9MSUNZOiBIVE1MUG9saWN5ID0ge1xyXG4gIGI6IHt9LCAgLy8gYm9sZFxyXG4gIGk6IHt9LCAgLy8gaXRhbGljXHJcbiAgcDoge30sICAvLyBwYXJhZ3JhcGhcclxuICB1OiB7fSwgIC8vIHVuZGVybGluZVxyXG4gIHN0cmlrZToge30sIC8vIHN0cmlrZS10aHJvdWdoXHJcbiAgcHJlOiB7fSwgLy8gdW5mb3JtYXR0ZWRcclxuICBoMToge30sIC8vIGhlYWRpbmcgMVxyXG4gIGgyOiB7fSwgLy8gaGVhZGluZyAyXHJcbiAgaDM6IHt9LCAvLyBoZWFkaW5nIDNcclxuICBoNDoge30sIC8vIGhlYWRpbmcgNFxyXG4gIGg1OiB7fSwgLy8gaGVhZGluZyA1XHJcbiAgaW1nOiB7c3JjOiB0cnVlLCBjbGFzczogdHJ1ZSwgc3R5bGU6IHRydWUsIHRhYmluZGV4OiB0cnVlfSwgLy8gaW1hZ2UuIFdlIHNldCBzdHlsZSBhbmQgdGFiaW5kZXggb3Vyc2VsdmVzLiBBY2NlcHQgdGhhdC5cclxuICBhOiB7aHJlZjogdHJ1ZSwgdGFyZ2V0OiB0cnVlLCB0YWJpbmRleDogdHJ1ZX0sIC8vIGxpbmtcclxuICB1bDoge30sIC8vIFVub3JkZXJlZCBsaXN0XHJcbiAgb2w6IHt9LCAvLyBPcmRlcmVkIGxpc3RcclxuICBsaToge30sIC8vIGxpc3QgaXRlbVxyXG4gIGhyOiB7fSwgLy8gSG9yaXpvbnRhbCBydWxlXHJcbiAgYnI6IHt9LCAvLyBCcmVhayBsaW5lXHJcbiAgZGl2OiB7fSwvLyBPZiBzb21lIHJlYXNvbiwgZGl2cyBhcmUgc29tZXRpbWVzIGluc2VydGVkIHdoZW4gcHJlc3NpbmcgRU5URVIgaW4gdGhlIHd5c2l3eWcgZWRpdG9yLlxyXG4gIHNwYW46IHt9LC8vIFNwYW5zIGFyZSBoYXJtbGVzcywganVzdCByZW1vdmUgdGhlaXIgc3R5bGUgYW5kIG90aGVyIGF0dHJpYnV0ZXMgYW5kIEkgZmVlbCBncmVhdC5cclxuICAvLyB0YWJsZSB0YWdzOlxyXG4gIHRhYmxlOiB7Ym9yZGVyOiB0cnVlfSxcclxuICB0Ym9keToge30sXHJcbiAgdGhlYWQ6IHt9LFxyXG4gIHRmb290OiB7fSxcclxuICB0cjoge30sXHJcbiAgdGQ6IHtoZWFkZXJzOiB0cnVlLCBjb2xzcGFuOiB0cnVlLCByb3dzcGFuOiB0cnVlfSxcclxuICB0aDoge2FiYnI6IHRydWUsIGhlYWRlcnM6IHRydWUsIHNjb3BlOiB0cnVlLCBzb3J0ZWQ6IHRydWUsIGNvbHNwYW46IHRydWUsIHJvd3NwYW46IHRydWV9XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gd2FzaEh0bWwgKGh0bWw6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhodG1sLCBcInRleHQvaHRtbFwiKTtcclxuICBjb25zdCB7Y2hpbGROb2Rlc30gPSBkb2MuYm9keTtcclxuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcclxuICBmb3IgKGxldCBpPTA7IGk8Y2hpbGROb2Rlcy5sZW5ndGg7ICsraSkge1xyXG4gICAgaWYgKHdhc2hOb2RlKGNoaWxkTm9kZXMuaXRlbShpKSkpIHtcclxuICAgICAgbW9kaWZpZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gbW9kaWZpZWQgP1xyXG4gICAgZG9jLmJvZHkuaW5uZXJIVE1MIDpcclxuICAgIGh0bWw7IC8vIEJ5IHJldHVybmluZyB0aGUgb3JpZ2luYWwgSFRNTCBzdHJpbmcsIHdlIHNwYXJlIHRoZSB1c2VyIGZyb20gcmVmcmVzaGluZyB0aGUgZWRpdCBhcmVhLFxyXG4gICAgICAgICAgLy8gd2hpY2ggd291bGQgb3RoZXJ3aXNlIHB1dCB0aGUgY3Vyc29yIGF0IHRoZSB0b3AsIGxvc2luZyB0aGUgcG9zaXRpb24gd2hlcmUgdXNlciB3aGVyZS5cclxufVxyXG5cclxuZnVuY3Rpb24gd2FzaE5vZGUobm9kZTogTm9kZSB8IEVsZW1lbnQgfCBIVE1MRWxlbWVudCk6IGJvb2xlYW4ge1xyXG4gIGxldCBtb2RpZmllZCA9IGZhbHNlO1xyXG4gIGlmIChpc0VsZW1lbnQobm9kZSkpIHtcclxuICAgIGlmICh3YXNoRWxlbWVudChub2RlKSkge1xyXG4gICAgICBtb2RpZmllZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmICh3YXNoQ2hpbGROb2Rlcyhub2RlKSkge1xyXG4gICAgbW9kaWZpZWQgPSB0cnVlO1xyXG4gIH1cclxuICByZXR1cm4gbW9kaWZpZWQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdhc2hDaGlsZE5vZGVzKG5vZGU6IE5vZGUpIHtcclxuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcclxuICBjb25zdCB7Y2hpbGROb2Rlc30gPSBub2RlO1xyXG4gIGZvciAobGV0IGk9MDsgaTxjaGlsZE5vZGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICBpZiAod2FzaE5vZGUoY2hpbGROb2Rlcy5pdGVtKGkpKSkge1xyXG4gICAgICBtb2RpZmllZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiBtb2RpZmllZDtcclxufSBcclxuXHJcbi8qKiBSZXBsYWNlIGFuIGVsZW1lbnQgd2l0aCBpdHMgY2hpbGQgbm9kZXMuXHJcbiAqIFxyXG4gKi9cclxuZnVuY3Rpb24gcmVtb3ZlTWlkZGxlRWxlbWVudChlbGVtZW50OiBFbGVtZW50KSB7XHJcbiAgY29uc3Qge2NoaWxkTm9kZXN9ID0gZWxlbWVudDtcclxuICBmb3IgKGxldCBpPTA7IGk8Y2hpbGROb2Rlcy5sZW5ndGg7ICsraSkge1xyXG4gICAgZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShjaGlsZE5vZGVzLml0ZW0oaSksIGVsZW1lbnQpO1xyXG4gIH1cclxuICBlbGVtZW50LnJlbW92ZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB3YXNoRWxlbWVudChlbGVtZW50OiBFbGVtZW50KTogYm9vbGVhbiB7XHJcbiAgY29uc3QgcG9saWN5ID0gZWxlbWVudC50YWdOYW1lICYmIEhUTUxfV0FTSF9QT0xJQ1lbZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCldO1xyXG4gIGlmICghcG9saWN5KSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJXeXNpd3lnOiBub3QgYWxsb3dlZCB0YWdcIiwgZWxlbWVudC50YWdOYW1lKTtcclxuICAgIHdhc2hDaGlsZE5vZGVzKGVsZW1lbnQpO1xyXG4gICAgcmVtb3ZlTWlkZGxlRWxlbWVudChlbGVtZW50KTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcclxuICBmb3IgKGxldCBpPTA7IGk8ZWxlbWVudC5hdHRyaWJ1dGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICBjb25zdCBhdHRyID0gZWxlbWVudC5hdHRyaWJ1dGVzLml0ZW0oaSk7XHJcbiAgICBjb25zdCBhbGxvd2VkID0gYXR0ci5uYW1lICYmICEhcG9saWN5W2F0dHIubmFtZS50b0xvd2VyQ2FzZSgpXTtcclxuICAgIGlmICghYWxsb3dlZCkge1xyXG4gICAgICBtb2RpZmllZCA9IHRydWU7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIld5c2l3eWc6IG5vdCBhbGxvd2VkIGF0dHJpYnV0ZVwiLCBhdHRyLm5hbWUsIFwiVGFnOiBcIiwgZWxlbWVudC50YWdOYW1lKTtcclxuICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0ci5uYW1lKTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIG1vZGlmaWVkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZTogTm9kZSkgOiBub2RlIGlzIEVsZW1lbnQge1xyXG4gIHJldHVybiAhIShub2RlIGFzIEVsZW1lbnQpLnRhZ05hbWU7XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5cclxuZXhwb3J0IHR5cGUgVGVybSA9ICdBVCcgfCAnU1QnOyAvLyBzaG91bGQgYmUgY2hhbmdlZCBpbnRvIEZpcnN0IFRlcm0gLyBTZWNvbmQgVGVybVxyXG5leHBvcnQgdHlwZSBBY2FkZW1pY1llYXIgPSBzdHJpbmc7IC8vIFwiMjAxNi8yMDE3XCIsIFwiMjAxNy8yMDE4XCIsIC4uLlxyXG5leHBvcnQgdHlwZSBTY2hvb2xHcmFkZSA9IG51bWJlcjsgLy8gMC05IChncnVuZHNrb2xhKSwgMTAtMTMgKGd5bW5hc2l1bSlcclxuZXhwb3J0IHR5cGUgR3JhZGUgPSAnQScgfCAnQicgfCAnQycgfCAnRCcgfCAnRSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFVzZXIge1xyXG4gICAgdXNlcm5hbWU/OiBzdHJpbmc7XHJcbiAgICBtYWlsOiBzdHJpbmc7XHJcbiAgICBkaXNwbGF5TmFtZTogc3RyaW5nO1xyXG4gICAgcm9sZXM6IHN0cmluZ1tdO1xyXG4gICAgc2Nob29sR3JhZGU/OiBudW1iZXI7XHJcbiAgICBzY2hvb2w/OiBzdHJpbmc7XHJcbiAgICBzY2hvb2xUeXBlPzogc3RyaW5nO1xyXG4gICAgdHV0b3JGb3I/OiBzdHJpbmc7XHJcbiAgICBncm91cHM/OiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBY2FkZW1pY1llYXJTdHJ1Y3R1cmVcclxue1xyXG4gYWNhZGVtaWNZZWFyIDogQWNhZGVtaWNZZWFyO1xyXG4gc3RhcnREYXRlOiBtb21lbnQuTW9tZW50O1xyXG4gZW5kRGF0ZTogbW9tZW50Lk1vbWVudDtcclxuIGFjYWRlbWljU3RhcnRXZWVrOiBudW1iZXI7XHJcbiBhY2FkZW1pY0VuZFdlZWs6IG51bWJlcjtcclxuIGhvbGlkYXlzOiB7c3RhcnREYXRlOiBzdHJpbmcsIGVuZERhdGU6IHN0cmluZ31bXTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ01vZHVsZVRhc2tzIHtcclxuICAgIG1vZHVsZU5hbWU6IHN0cmluZztcclxuICAgIHVybD86IHN0cmluZztcclxuICAgIHN1YmplY3Q6IFNjaG9vbFN1YmplY3Q7XHJcbiAgICBjb21tb25UYXNrcz86IExlYXJuaW5nVGFza1tdO1xyXG4gICAgbGVhcm5pbmdHb2FsczogTGVhcm5pbmdHb2FsW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdHb2FsIHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHRhc2tzPzogTGVhcm5pbmdUYXNrW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tR29hbCB7XHJcbiAgbmFtZTogc3RyaW5nLFxyXG4gIHVybDogc3RyaW5nLFxyXG4gIGNvdXJzZTogc3RyaW5nLFxyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcclxufVxyXG5cclxuXHJcbi8qZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ0dvYWwge1xyXG4gICAgaWQ/OiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBjb3Vyc2VJZD86IHN0cmluZztcclxuICAgIHN1YmplY3RJZD86IHN0cmluZztcclxufSovXHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ1Rhc2sge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgdXJsPzogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbiAgICBkb25lPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ0NvdXJzZSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB1cmw/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2Nob29sU3ViamVjdCB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBjb3Vyc2U6IExlYXJuaW5nQ291cnNlO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ291cnNlIHtcclxuICAgIC8vU2NoZW1hOiBcIlt5ZWFyK3Rlcm0rc2Nob29sWWVhcituYW1lXSxzb3J0b3JkZXJcIjtcclxuICAgIGlkPzogc3RyaW5nO1xyXG4gICAgLy9hWWVhcjogc3RyaW5nOyAvLyBBY2FkZW1pYyBZZWFyIC8gTMOkc8OlciAvIFwiMjAxNi8yMDE3XCIsIFwiMjAxNy8yMDE4XCIsIC4uLlxyXG4gICAgLy9zY2hvb2xHcmFkZTogbnVtYmVyOyAvLyDDhXJza3VycyAoMC05IGdydW5kc2tvbGEsIDEwLTEzIGd5bW5hc2l1bSkuIDEwMCA9IGVqIGJ1bmRldCB0aWxsIMOlcnNrdXJzLlxyXG4gICAgLy90ZXJtPzogVGVybTsgLy8gQVQgKEF1dHVtbiBUZXJtKSAvIFNUIChTcHJpbmcgVGVybSlcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHBvaW50cz86IG51bWJlcjtcclxuICAgIG1vZHVsZXM/OiBDb3Vyc2VNb2R1bGVbXTtcclxuICAgIGxlYXJuaW5nR29hbHM/OiBMZWFybmluZ0dvYWxbXTtcclxuICAgIHVybD86IHN0cmluZztcclxufVxyXG5cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQ291cnNlTW9kdWxlIHtcclxuICAgIGlkPzogc3RyaW5nO1xyXG4gICAgY291cnNlSWQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHJlYWRvbmx5IHVybDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRhcmdldEdyYWRlIHtcclxuICAgIGlkPzogc3RyaW5nO1xyXG4gICAgdXNlcjogc3RyaW5nO1xyXG4gICAgY291cnNlSWQ/OiBzdHJpbmc7XHJcbiAgICBzdWJqZWN0SWQ/OiBzdHJpbmc7XHJcbiAgICBhWWVhcj86IEFjYWRlbWljWWVhcjsgLy8gTMOkc8OlciwgdGV4IFwiMjAxNi8yMDE3XCIuIG51bGwgbWVhbnMgZmluYWwgZ29hbC5cclxuICAgIHRlcm0/OiBUZXJtOyAvLyBudWxsIG1lYW5zIGZpbmFsIGdvYWwuXHJcbiAgICBncmFkZTogR3JhZGU7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY29uc3QgZnV0dXJlQWJpbGl0aWVzID0gW1xyXG4gICAgXCJMw6RyYSBhdHQgbMOkcmFcIixcclxuICAgIFwiU2FtYXJiZXRhXCIsXHJcbiAgICBcIkFnZXJhIGdsb2JhbHRcIixcclxuICAgIFwiVmlzYSBoYW5kbGluZ3NrcmFmdFwiLFxyXG4gICAgXCJWYXJhIGlubm92YXRpdlwiLFxyXG4gICAgXCJMZXZhIGRpZ2l0YWx0XCJdO1xyXG4iLCJpbXBvcnQgJy4uLy4uL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuY29uc3QgYmVhcmVyUHJvbWlzZSA9IGVudi5iZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKTsgLy8gU3RhcnQgZ2V0dGluZyBiZWFyZXIgYXMgc29vbiBhcyBwb3NzaWJsZS5cclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgKiBhcyBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQgeyBDb3Vyc2VCdWlsZGVyIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlcic7XHJcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XHJcbmltcG9ydCB7IHNob3dFcnJvciwgc2hvd0luZm8gfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi8uLi9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcclxuaW1wb3J0IHsgTGFuZ3VhZ2VDb250ZXh0IH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuaW1wb3J0IHsgSW5qZWN0ZWRJbnRsUHJvcHMsIGluamVjdEludGwgfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHsgc2V0dXBJbnRsIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvU2V0dXBMYW5ndWFnZUludGwnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIGV4dGVuZHMgSW5qZWN0ZWRJbnRsUHJvcHN7XHJcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBpc1Rva2VuTG9hZGVkOiBib29sZWFuO1xyXG59XHJcblxyXG5jbGFzcyBfS0VEQXBwQ291cnNlQnVpbGRlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaXNUb2tlbkxvYWRlZDogZmFsc2VcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcclxuICAgIGJlYXJlclByb21pc2UudGhlbigoKT0+e1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtpc1Rva2VuTG9hZGVkOiB0cnVlfSk7XHJcbiAgICB9KS5jYXRjaChlcnIgPT4ge1xyXG4gICAgICBzaG93RXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBpbnRsIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuaXNUb2tlbkxvYWRlZCA/XHJcbiAgICAgIDxMYW5ndWFnZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3sgaW50bCB9fT5cclxuICAgICAgICA8Q291cnNlQnVpbGRlclxyXG4gICAgICAgICAgdmlld0NvdXJzZVVybD17Y2ZnLktFRF9DT1VSU0VfVklFV0VSX1VSTH1cclxuICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPlxyXG4gICAgICA8L0xhbmd1YWdlQ29udGV4dC5Qcm92aWRlcj4gOlxyXG4gICAgICA8cD48U3Bpbm5lciAvPlYuZy4gdsOkbnRhLi4uIGF1dGVudGljZXJhci4uLjwvcD5cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBLRURBcHBDb3Vyc2VCdWlsZGVyID0gc2V0dXBJbnRsKGluamVjdEludGwoX0tFREFwcENvdXJzZUJ1aWxkZXIpKTtcclxuIiwiaW1wb3J0IEtFRCBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRCc7XHJcbmltcG9ydCB7S0VEQXBwQ291cnNlQnVpbGRlcn0gZnJvbSAnLi9hcHAuY291cnNlYnVpbGRlci5jbGllbnQnO1xyXG5cclxuLy8gQWRkIEtFREFwcENvdXJzZUJ1aWxkZXIgdG8gdGhlIHNldCBvZiBjb21wb25lbnRzIGluIEtFRC5jb21wb25lbnRzXHJcbktFRC5jb21wb25lbnRzID0gey4uLktFRC5jb21wb25lbnRzLCBLRURBcHBDb3Vyc2VCdWlsZGVyfTtcclxuIiwiaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJy4uL3V0aWxzL3F1ZXJ5LXN0cmluZyc7XHJcbmltcG9ydCBGZWF0dXJlRGVzY3JpcHRpb25zIGZyb20gJy4vZmVhdHVyZS1mbGFncy5qc29uJztcclxuaW1wb3J0IHsgY2ZnIH0gZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuXHJcbnR5cGUgRmVhdHVyZUZsYWdzID0ge3JlYWRvbmx5IFtQIGluIGtleW9mIHR5cGVvZiBGZWF0dXJlRGVzY3JpcHRpb25zXTogYm9vbGVhbn07XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVzIGV4dGVuZHMgRmVhdHVyZUZsYWdzIHt9XHJcblxyXG5leHBvcnQgY2xhc3MgRmVhdHVyZXMge1xyXG4gIHByaXZhdGUgX2ZlYXR1cmVzOiBGZWF0dXJlRmxhZ3M7XHJcbiAgcHJpdmF0ZSBfaW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIGlmICh0aGlzLl9pbml0aWFsaXplZCkgcmV0dXJuO1xyXG4gICAgbGV0IHR1cm5lZE9uRmVhdHVyZXMgPSAoY2ZnLktFRF9GRUFUVVJFUyB8fCBcIlwiKS5zcGxpdCgnLCcpLm1hcChuYW1lID0+IG5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCwge3RvTG93ZXI6IHRydWV9KTtcclxuXHJcbiAgICBpZiAocXVlcnkudGVzdHZlcnNpb24pIHtcclxuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IFtcIipcIl07XHJcbiAgICB9XHJcbiAgICBpZiAocXVlcnkuZmVhdHVyZXMpIHtcclxuICAgICAgdHVybmVkT25GZWF0dXJlcyA9IHF1ZXJ5LmZlYXR1cmVzXHJcbiAgICAgICAgLnNwbGl0KCcsJylcclxuICAgICAgICAubWFwKGZlYXR1cmUgPT4gZmVhdHVyZS50cmltKCkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCB0dXJuT25BbGwgPSB0dXJuZWRPbkZlYXR1cmVzLmluY2x1ZGVzKCcqJyk7XHJcbiAgICB0aGlzLl9mZWF0dXJlcyA9IHt9IGFzIEZlYXR1cmVGbGFncztcclxuICAgIGZvciAoY29uc3QgZmVhdHVyZU5hbWUgb2YgT2JqZWN0LmtleXMoRmVhdHVyZURlc2NyaXB0aW9ucykpIHtcclxuICAgICAgdGhpcy5fZmVhdHVyZXNbZmVhdHVyZU5hbWVdID0gdHVybk9uQWxsIHx8XHJcbiAgICAgICAgdHVybmVkT25GZWF0dXJlcy5pbmNsdWRlcyhmZWF0dXJlTmFtZS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgfVxyXG4gICAgdGhpcy5faW5pdGlhbGl6ZWQgPSB0cnVlOyAgICBcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yICgpIHtcclxuICAgIGZvciAoY29uc3QgZmVhdHVyZU5hbWUgb2YgT2JqZWN0LmtleXMoRmVhdHVyZURlc2NyaXB0aW9ucykpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGZlYXR1cmVOYW1lLCB7XHJcbiAgICAgICAgZ2V0KCkge1xyXG4gICAgICAgICAgaWYgKCF0aGlzLl9pbml0aWFsaXplZCkgdGhpcy5pbml0KCk7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZmVhdHVyZXNbZmVhdHVyZU5hbWVdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0KHZhbHVlKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZlYXR1cmUgZmxhZ3MgY2Fubm90IGJlIHNldCBoZXJlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGZlYXR1cmVzID0gbmV3IEZlYXR1cmVzKCk7XHJcbiIsImV4cG9ydCAqIGZyb20gJy4vZmVhdHVyZXMnO1xyXG4iLCJpbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcblxyXG5kZWNsYXJlIHZhciBwcm9jZXNzOiBhbnk7XHJcblxyXG5jZmcuRU5WSVJPTk1FTlQgPSBwcm9jZXNzLmVudi5FTlZJUk9OTUVOVCBhcyBcInByb2R1Y3Rpb25cIiB8IFwiZGV2ZWxvcG1lbnRcIiB8IFwidGVzdFwiO1xyXG5jZmcuS0VEX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5LRURfQVBJX1VSTDsgLy8gXCJodHRwczovL2tlZGJhY2tlbmR0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxyXG5jZmcuRURTX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5FRFNfQVBJX1VSTDsgLy8gXCJodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXHJcbmNmZy5LRURfVE9LRU5fVVJMID0gcHJvY2Vzcy5lbnYuS0VEX1RPS0VOX1VSTDsgLy8gXCJodHRwczovL2tlZGF1dGh0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L3Rva2VuXCJcclxuY2ZnLktFRF9DTElFTlRfSUQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX0lEOyAvLyBcImRldmNsaWVudFwiLCBcInRlc3RjbGllbnRcIiwgXCIuLi5cIlxyXG5jZmcuS0VEX0NMSUVOVF9TRUNSRVQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX1NFQ1JFVDtcclxuY2ZnLktFRF9SRUFMTSA9IHByb2Nlc3MuZW52LktFRF9SRUFMTTsgLy8gXCJTRTFcIlxyXG5jZmcuS0VEX0xPQ0FMRSA9IGNmZy5LRURfTE9DQUxFIHx8IHByb2Nlc3MuZW52LktFRF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlblwiLiBPbmx5IHNldCBmcm9tIHByb2Nlc3MuZW52IGlmIG5vdCBzZXQgZnJvbSBTaXRlVmlzaW9uIGVsZW1lbnQgY29uZmlnLlxyXG5jZmcuS0VEX1NDSE9PTF9MT0NBTEUgPSBjZmcuS0VEX1NDSE9PTF9MT0NBTEUgfHwgcHJvY2Vzcy5lbnYuS0VEX1NDSE9PTF9MT0NBTEU7IC8vIFwic3ZcIiwgXCJlbl9zaW5cIiwgXCJlbl9uaW5cIi4gT25seSBzZXQgZnJvbSBwcm9jZXNzLmVudiBpZiBub3Qgc2V0IGZyb20gU2l0ZVZpc2lvbiBlbGVtZW50IGNvbmZpZy5cclxuIiwiLyogVGhlc2Ugc2NyaXB0cyBhc3N1bWUgc29tZSBvZiB0aGUgZ2xvYmFsIHZhcnMgaGF2ZSBhbHJlYWR5IGJlZW4gc2V0OlxyXG4gICogS0VELmNmZ1xyXG4gICogS0VELmVudi5jdXJyZW50VXNlclxyXG5cclxuICBUaGUgcmVzdCB3aWxsIGJlIHNldCBoZXJlIChjbGllbnQgc2lkZSlcclxuKi9cclxuaW1wb3J0ICcuL2NvbmZpZ3VyZSc7XHJcbmltcG9ydCAnLi9zZXQtYmVhcmVyLXByb3ZpZGVycyc7XHJcbmltcG9ydCAnLi9zZXQta2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0ICcuL3NldC1lZHMtY2xpZW50JztcclxuIiwiaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZywgc3BsaXRVcmxBbmRRdWVyeSB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudFdlYiwgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIsIGlzb21vcnBoaWMsIHN0b3JhZ2UgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XHJcbmltcG9ydCB7IEJlYXJlclByb3ZpZGVyLCBLZWRCZWFyZXJQcm92aWRlciB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcclxuaW1wb3J0IHsgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMgfSBmcm9tIFwiLi4vYWNjZXNzLWNvbnRyb2wvaW5kZXhcIjtcclxuaW1wb3J0IHsgY2hlcnJ5UGlja1Byb3BzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XHJcblxyXG5mdW5jdGlvbiBnZXRNZXJnZWRUb2tlblBhdGgodG9rZW5QYXRoOiBzdHJpbmcsIGxvY2F0aW9uU2VhcmNoOiBzdHJpbmcsIHNjb3Blczogc3RyaW5nW10pIHtcclxuICAvLyBNZXJnZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtcyBvZiB0b2tlbiBwYXRoIHdpdGggcGFyYW1zIGdpdmVuIHRvIGN1cnJlbnQgcGFnZVxyXG4gIGNvbnN0IGN1cnJlbnRRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb25TZWFyY2gpO1xyXG4gIGNvbnN0IGltcGVyc29uYXRpb25Qcm9wcyA9IGNoZXJyeVBpY2tQcm9wcyhjdXJyZW50UXVlcnksIElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TKTtcclxuICBjb25zdCBbdG9rZW5QYXRoV2l0aG91dFF1ZXJ5LCB0b2tlblF1ZXJ5U3RyaW5nXSA9IHNwbGl0VXJsQW5kUXVlcnkodG9rZW5QYXRoKTtcclxuICBjb25zdCB0b2tlblBhdGhRdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcodG9rZW5RdWVyeVN0cmluZyk7XHJcbiAgcmV0dXJuIHRva2VuUGF0aFdpdGhvdXRRdWVyeSArIGdlbmVyYXRlUXVlcnlTdHJpbmcoe1xyXG4gICAgLi4udG9rZW5QYXRoUXVlcnksXHJcbiAgICAuLi5pbXBlcnNvbmF0aW9uUHJvcHMsXHJcbiAgICBzY29wZXM6IHNjb3Blcy5qb2luKCcsJylcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcclxuICByZXR1cm4gbWVyZ2VkVG9rZW5QYXRoICsgXCIvXCIgKyB1c2VyRW1haWw7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVVc2VySW5mbyh1c2VyOiBVc2VyLCB0b2tlbklkOiBzdHJpbmcpIHtcclxuICBlbnYuY3VycmVudFVzZXIgPSB1c2VyO1xyXG4gIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCwgSlNPTi5zdHJpbmdpZnkodXNlcikpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsb2FkVXNlckluZm8odG9rZW5JZDogc3RyaW5nKSB7XHJcbiAgY29uc3Qgc3RvcmVkU2Vzc2lvblVzZXIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwidXNlckluZm9cIiArIHRva2VuSWQpO1xyXG4gIGlmIChzdG9yZWRTZXNzaW9uVXNlcikge1xyXG4gICAgZW52LmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRTZXNzaW9uVXNlcik7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcclxuICBjb25zdCB0b2tlbklkID0gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIHVzZXJFbWFpbCk7XHJcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XHJcbiAgICBjb25zdCByZXMgPSBKU09OLnBhcnNlKHJlc3BvbnNlVGV4dCkgYXMgeyBvazogYm9vbGVhbiwgZXJyb3I/OiBzdHJpbmcsIHRva2VuPzogc3RyaW5nLCB1c2VyPzogVXNlciB9O1xyXG4gICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihyZXMuZXJyb3IpO1xyXG4gICAgaWYgKHJlcy51c2VyKSB7XHJcbiAgICAgIHNhdmVVc2VySW5mbyhyZXMudXNlciwgdG9rZW5JZCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcclxuICB9LCB0b2tlbklkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlR29vZ2xlVG9rZW5Qcm92aWRlcihtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcclxuICBjb25zdCB0b2tlbklkID0gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIHVzZXJFbWFpbCk7XHJcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XHJcbiAgICBjb25zdCByZXMgPSBKU09OLnBhcnNlKHJlc3BvbnNlVGV4dCkgYXMgeyBvazogYm9vbGVhbiwgZXJyb3I/OiBzdHJpbmcsIHRva2VuPzogc3RyaW5nLCB1c2VyPzogVXNlciB9O1xyXG4gICAgaWYgKCFyZXMub2spIHRocm93IG5ldyBFcnJvcihyZXMuZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgdG9rZW46IHJlcy50b2tlbiwgZXhwaXJlczogRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwIH07XHJcbiAgfSwgdG9rZW5JZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVRlc3RUb2tlblByb3ZpZGVyKHRva2VuVXJsOiBzdHJpbmcsIHVzZXI6IFVzZXIsIHNjb3Blczogc3RyaW5nW10pIHtcclxuICByZXR1cm4gbmV3IEtlZEJlYXJlclByb3ZpZGVyKFxyXG4gICAgaXNvbW9ycGhpYyxcclxuICAgIHN0b3JhZ2UsXHJcbiAgICB0b2tlblVybCArIHVzZXIubWFpbCArIGxvY2F0aW9uLnNlYXJjaCxcclxuICAgIGNmZy5LRURfQ0xJRU5UX0lELFxyXG4gICAgY2ZnLktFRF9DTElFTlRfU0VDUkVULFxyXG4gICAgdG9rZW5VcmwsIHtcclxuICAgICAgZW1haWw6IHVzZXIubWFpbC50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICByb2xlczogdXNlci5yb2xlcyxcclxuICAgICAgc2Nob29sOiB1c2VyLnNjaG9vbCxcclxuICAgICAgc2Nob29sVHlwZTogdXNlci5zY2hvb2xUeXBlLFxyXG4gICAgICBzY29wZXNcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBlbnYuY3VycmVudFVzZXIubWFpbCBpcyBzZXQgYnkgU2l0ZVZpc2lvbiBzZXJ2ZXIgaW5pdGlhbGx5LlxyXG4vLyBBIHJlc3BvbnNlIGZyb20gL2FwaS90b2tlbiBtYXkgY2hhbmdlIHRoZSBtYWlsIGF0dHJpYnV0ZSBvZiB0aGUgY3VycmVudFxyXG4vLyB1c2VyLCBzbyBlbnYuY3VycmVudFVzZXIubWFpbCBtYXkgYmUgZGlmZmVyZW50IGFmdGVyIGdldHRpbmcgYSByZXNwb25zZS5cclxuLy8gSG93ZXZlciwgdGhlIGluaXRpYWwgdmFsdWUgaXMgdmFsdWFibGUgYWx3YXlzIGluIG9yZGVyIHRvIGRpc3Rpbmd1aXNoIHRoZSBjYXNlXHJcbi8vIHdoZW4gb25lIG5vcm1hbCB1c2VyIGxvZ3Mgb3V0IGFuZCBhbm90aGVyIHVzZXIgbG9ncyBpbi5cclxuY29uc3QgaW5pdGlhbFVzZXJFbWFpbCA9IGVudi5jdXJyZW50VXNlciAmJiBlbnYuY3VycmVudFVzZXIubWFpbDsgLy8gSW5pdGlhbCB2YWx1ZSBvZiBtYWlsLiBNYXkgY2hhbmdlLlxyXG5pZiAoaW5pdGlhbFVzZXJFbWFpbCkge1xyXG4gIC8vIEtFRFxyXG4gIGlmIChjZmcuS0VEX1RPS0VOX1BBVEgpIHtcclxuICAgIC8vXHJcbiAgICAvL1xyXG4gICAgLy8gUHJvZHVjdGlvbiAvIFNpdGVWaXNpb24gcHJveGllZCAvYXBpL3Rva2VuIHRvIHJlcXVlc3QgdG9rZW5zIGZyb206XHJcbiAgICAvL1xyXG4gICAgLy9cclxuICAgIGNvbnN0IG1lcmdlZFRva2VuUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcclxuICAgICAgY2ZnLktFRF9UT0tFTl9QQVRILFxyXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcclxuICAgICAgICBcImtlZGJhY2tlbmRcIixcclxuICAgICAgICBcIkVEU1wiLFxyXG4gICAgICBdKTtcclxuICAgIGVudi5iZWFyZXJQcm92aWRlciA9IGNyZWF0ZUJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCk7XHJcbiAgICBsb2FkVXNlckluZm8oZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGgsIGluaXRpYWxVc2VyRW1haWwpKTtcclxuXHJcbiAgICAvLyBHb29nbGVcclxuICAgIGNvbnN0IGdvb2dsZU1lcmdlZFBhdGggPSBnZXRNZXJnZWRUb2tlblBhdGgoXHJcbiAgICAgIGNmZy5LRURfVE9LRU5fUEFUSCxcclxuICAgICAgbG9jYXRpb24uc2VhcmNoLCBbXHJcbiAgICAgICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLnJlYWRvbmx5XCIsXHJcbiAgICAgIF0pO1xyXG4gICAgZW52Lmdvb2dsZVRva2VuUHJvdmlkZXIgPSBjcmVhdGVHb29nbGVUb2tlblByb3ZpZGVyKGdvb2dsZU1lcmdlZFBhdGgsIGluaXRpYWxVc2VyRW1haWwpO1xyXG4gIH0gZWxzZSBpZiAoY2ZnLktFRF9UT0tFTl9VUkwgJiYgY2ZnLktFRF9DTElFTlRfSUQgJiYgY2ZnLktFRF9DTElFTlRfU0VDUkVUKSB7XHJcbiAgICAvL1xyXG4gICAgLy9cclxuICAgIC8vIFRlc3QgLSBnbyBkaXJlY3RseSB0byBLRURBVVRIIHNlcnZlciB0byByZXRyaWV2ZSB0b2tlbnNcclxuICAgIC8vXHJcbiAgICAvL1xyXG4gICAgZW52LmJlYXJlclByb3ZpZGVyID0gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIoY2ZnLktFRF9UT0tFTl9VUkwsIGVudi5jdXJyZW50VXNlciwgW1xyXG4gICAgICBcImtlZGJhY2tlbmRcIixcclxuICAgICAgXCJFRFNcIixcclxuICAgIF0pO1xyXG4gICAgZW52Lmdvb2dsZVRva2VuUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCArIFwiL2dvb2dsZVwiLCBlbnYuY3VycmVudFVzZXIsIFtcclxuICAgICAgXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2NhbGVuZGFyLnJlYWRvbmx5XCIsXHJcbiAgICBdKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVyIEtFRF9UT0tFTl9QQVRIYCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5pbXBvcnQgeyBpc29tb3JwaGljIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xyXG5pbXBvcnQgeyBFZHNDbGllbnQgfSBmcm9tICcuLi9hcGlzL2Vkc2NsaWVudCc7XHJcblxyXG5lbnYuZWRzQ2xpZW50ID0gbmV3IEVkc0NsaWVudCAoXHJcbiAgaXNvbW9ycGhpYyxcclxuICBjZmcuRURTX0FQSV9VUkwsXHJcbiAgZW52LmJlYXJlclByb3ZpZGVyLFxyXG4gICgpPT5lbnYuY3VycmVudFVzZXIubWFpbCk7XHJcblxyXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudFdlYiB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50d2ViJztcclxuXHJcbmVudi5rZWRCYWNrZW5kQ2xpZW50ID0gbmV3IEtlZEJhY2tlbmRDbGllbnRXZWIgKFxyXG4gIGNmZy5LRURfQVBJX1VSTCxcclxuICBlbnYuYmVhcmVyUHJvdmlkZXIpO1xyXG5cclxuIiwiaW1wb3J0IEtFRCBmcm9tICcuL0tFRCc7XHJcblxyXG4vKiBUaGlzIGRlZmF1bHQgY29uZmlndXJhdGlvbiBpcyB1c2VkIGFzIGEgZmFsbGJhY2suXHJcbk5vcm1hbGx5IGJvdGggdGVzdCBwYWdlcyBhbmQgcHJvZHVjdGlvbiBwYWdlcyB3aWxsIG92ZXJyaWRlIHRoZXNlIGNvbmZpZ3JhdGlvbnNcclxuKi9cclxuLypjb25zdCBkZWZhdWx0Q29uZmlndXJhdGlvbiA9IHtcclxuICAvLyBFbnZpcm9ubWVudFxyXG4gIEVOVklST05NRU5UOiAnZGV2ZWxvcG1lbnQnIGFzICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCcsXHJcbiAgLy8gQXV0aGVudGljYXRpb24gU2VydmVyOlxyXG4gIEtFRF9UT0tFTl9VUkw6ICdodHRwczovL2tlZGF1dGh0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L3Rva2VuJyxcclxuICBLRURfVE9LRU5fUEFUSDogJy9hcGkvdG9rZW4uU2tyaXB0LnBvcnRsZXQ/c3YuY29udGVudHR5cGU9YXBwbGljYXRpb24vanNvbicsXHJcbiAgS0VEX0NMSUVOVF9JRDogJ2RldmNsaWVudCcsXHJcbiAgS0VEX0NMSUVOVF9TRUNSRVQ6ICc0ZlJkZlFwV3RKcWpUV2YnLFxyXG4gIC8vIFNlcnZpY2VzOlxyXG4gIEtFRF9BUElfVVJMOiAnaHR0cHM6Ly9rZWRiYWNrZW5kdGVzdC5henVyZXdlYnNpdGVzLm5ldC9hcGkvJywgIFxyXG4gIEVEU19BUElfVVJMOiAnaHR0cHM6Ly9lZHNwb3J0YWxvd2luYXBpLmF6dXJld2Vic2l0ZXMubmV0L2FwaS8nXHJcbn0qL1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJS2VkQ29uZmlndXJhdGlvbiB7XHJcbiAgRU5WSVJPTk1FTlQ6ICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCc7XHJcbiAgS0VEX1JFQUxNOiBzdHJpbmc7XHJcbiAgS0VEX1RPS0VOX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9UT0tFTl9QQVRIOiBzdHJpbmc7XHJcbiAgS0VEX0NMSUVOVF9JRDogc3RyaW5nO1xyXG4gIEtFRF9DTElFTlRfU0VDUkVUOiBzdHJpbmc7XHJcbiAgS0VEX0FQSV9VUkw6IHN0cmluZztcclxuICBFRFNfQVBJX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9MT0NBTEU6IHN0cmluZztcclxuICBLRURfU0NIT09MX0xPQ0FMRTogc3RyaW5nO1xyXG4gIEtFRF9DT1VSU0VfQlVJTERFUl9VUkw6IHN0cmluZztcclxuICBLRURfQ09VUlNFX1ZJRVdFUl9VUkw6IHN0cmluZztcclxuICBLRURfU1VCSkVDVF9QTEFOTkVSX0FETUlOX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9TVUJKRUNUX1BMQU5ORVJfVVJMOiBzdHJpbmc7XHJcbiAgS0VEX0ZFQVRVUkVTOiBzdHJpbmc7XHJcbiAgS0VEX0tFRVBfQUxJVkVfVVJMOiBzdHJpbmc7XHJcbiAgS0VEX0VOVU1fV09SREJBTktTX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9XT1JEQkFOS1NfVVJMOiBzdHJpbmc7XHJcbn07XHJcblxyXG5pZiAoIUtFRC5jZmcpIEtFRC5jZmcgPSB7fTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEtFRC5jZmcgYXMgSUtlZENvbmZpZ3VyYXRpb247XHJcbmV4cG9ydCBjb25zdCBjZmc6IElLZWRDb25maWd1cmF0aW9uID0gS0VELmNmZztcclxuIiwiaW1wb3J0IHtVc2VyLCBMZWFybmluZ01vZHVsZVRhc2tzfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQge1VzZXJUYXNrfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi4vcmVwb3Mva2VkLXJlcG8nO1xyXG5pbXBvcnQge0Vkc0NsaWVudH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xyXG5pbXBvcnQgS0VEIGZyb20gJy4va2VkJztcclxuaW1wb3J0IHsgS1NUZXJtUGxhbm5lclJlcG8gfSBmcm9tICcuLi9yZXBvcy9rcy10ZXJtcGxhbm5lci1yZXBvJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRW52IHtcclxuICAgIGN1cnJlbnRVc2VyPzogVXNlcjtcclxuICAgIGxlYXJuaW5nTW9kdWxlVGFza3M/OiBMZWFybmluZ01vZHVsZVRhc2tzO1xyXG4gICAgYmVhcmVyUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcclxuICAgIGdvb2dsZVRva2VuUHJvdmlkZXI/OiBCZWFyZXJQcm92aWRlcjtcclxuICAgIGtlZEJhY2tlbmRDbGllbnQ/OiBLZWRCYWNrZW5kQ2xpZW50O1xyXG4gICAgZWRzQ2xpZW50PzogRWRzQ2xpZW50O1xyXG4gICAgdXNlclRhc2tzUmVwbz87XHJcbiAgICBoaWRkZW5Db3Vyc2VzUmVwbz87XHJcbiAgICB3ZWVrTm90ZXNSZXBvPztcclxuICAgIGtnVGVybVBsYW5uZXJSZXBvPztcclxuICAgIGtzVGVybVBsYW5uZXJSZXBvPzogS1NUZXJtUGxhbm5lclJlcG9cclxuICAgIHR1dG9yZWQ6IGJvb2xlYW47XHJcbiAgICBlcnJvcj86IEVycm9yO1xyXG59XHJcblxyXG5pZiAoIUtFRC5lbnYpIEtFRC5lbnYgPSB7fTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IEtFRC5lbnYgYXMgRW52O1xyXG5leHBvcnQgY29uc3QgZW52OiBFbnYgPSBLRUQuZW52O1xyXG4iLCJcclxuZXhwb3J0IGNvbnN0IEtFRF9OQU1FU1BBQ0UgPSBcIktFRFwiO1xyXG5cclxuZGVjbGFyZSB2YXIgS0VEOiBhbnk7XHJcblxyXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XHJcbiIsImltcG9ydCBlbnYgZnJvbSAnLi9LRUQuZW52JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VXNlciAoKSB7XHJcbiAgcmV0dXJuIGVudi5jdXJyZW50VXNlcjtcclxufVxyXG4iLCJpbXBvcnQgZW52IGZyb20gJy4vS0VELmVudic7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRSZXBvIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcclxuaW1wb3J0IHsgZ2V0R2xvYmFsSWQsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi9LRUQuY2ZnJztcclxuaW1wb3J0IHsgU2Nob29sLCBCcmFuY2ggfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IFZhbHVlIH0gZnJvbSAna2VkYmFja2VuZC9vYnNlcnZhYmxlJztcclxuXHJcbmV4cG9ydCBjb25zdCBkYiA9IG5ldyBLZWRCYWNrZW5kUmVwbyhcclxuICAoKT0+ZW52LmtlZEJhY2tlbmRDbGllbnQsXHJcbiAgKCk9PmVudi5jdXJyZW50VXNlciA/XHJcbiAgICBlbnYuY3VycmVudFVzZXIubWFpbCA6XHJcbiAgICBcIlwiLFxyXG4gICgpPT5lbnYuY3VycmVudFVzZXIgP1xyXG4gICAgZW52LmN1cnJlbnRVc2VyLmRpc3BsYXlOYW1lIHx8IGVudi5jdXJyZW50VXNlci5tYWlsIDpcclxuICAgIFwiXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGdsb2JhbElkID0gZ2V0R2xvYmFsSWQoY2ZnLktFRF9SRUFMTSk7XHJcbmV4cG9ydCBjb25zdCBTY2hvb2xzID0ge1xyXG4gIHN0YW5kYXJkU2Nob29sOiBkYi5zY2hvb2xzLm5hbWUoXCJzdGFuZGFyZFwiKS5jYWNoZU9wdGltaXplZCgpLnNpbmdsZSgpLFxyXG4gIGdldCBteVNjaG9vbCAoKSB7IHJldHVybiBkYi5zY2hvb2xzLm5hbWUoZW52LmN1cnJlbnRVc2VyLnNjaG9vbCkuY2FjaGVPcHRpbWl6ZWQoKS5zaW5nbGUoKTsgfVxyXG59O1xyXG5leHBvcnQgY29uc3QgQ291cnNlSW5zdGFuY2VzID0ge1xyXG4gIGdldEJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHNjaG9vbC5zd2l0Y2hNYXAoc2Nob29sID0+XHJcbiAgICAgIGRiLmJyYW5jaGVzXHJcbiAgICAgICAgLmhhc0VkZ2VzRnJvbShbc2Nob29sLm9mZmljaWFsQnJhbmNoSWRdKVxyXG4gICAgICAgIC5uYW1lKFwiZHJhZnRcIilcclxuICAgICAgICAudGFncyhjb3Vyc2VJZClcclxuICAgICAgICAuaWRzT25seSgpXHJcbiAgICAgICAgLm1hcCgoe2lkfSkgPT4gaWQpXHJcbiAgICAgICAgLnRvVmFsdWUoKVxyXG4gICAgICAgIC5tYXAoaWRzID0+IGlkcy5sZW5ndGggPiAwID8gaWRzWzBdIDogdW5kZWZpbmVkKSk7XHJcbiAgfSxcclxuXHJcbiAgLyoqIEdldCBhIERSQUZUIGJyYW5jaCBmb3IgZ2l2ZW4gY291cnNlIElEIGFuZCBnaXZlbiBzY2hvb2wuXHJcbiAgICogSWYgdGhlcmUgaXMgbm90IHlldCBzdWNoIGEgYnJhbmNoLCBjcmVhdGUgaXQgdXNpbmcgbXV0YXRpb25zT25FbXB0eSgpIHdoaWNoIHdpbGxcclxuICAgKiBsZWFkIHRvIHRoZSBDIyBjb2RlIERvY3VtZW50UmVwb3NpdG9yeS5SZWFkT3JNdXRhdGUoKSB2aWEgRG9jdW1lbnRDb250cm9sbGVyLlxyXG4gICAqL1xyXG4gIGdldE9yQ3JlYXRlQnJhbmNoSWQoc2Nob29sOiBWYWx1ZTxTY2hvb2w+LCBjb3Vyc2VJZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gZGIuY291cnNlSW5zdGFuY2VzLmlkc09ubHkoKS5pZChjb3Vyc2VJZCkuc3dpdGNoTWFwKCgpPT4gLy8gVEhpcyBmaXJzdCBsaW5lIHZlcmlmaWVzIGNvdXJzZSBleGlzdHMuIElmIGRlbGV0ZWQsIGRvbid0IHRyeSB0byByZWNyZWF0ZSBpdHMgYnJhbmNoIVxyXG4gICAgICBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PiBcclxuICAgICAgZGIuYnJhbmNoZXNcclxuICAgICAgICAuaGFzRWRnZXNGcm9tKFtzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZF0pXHJcbiAgICAgICAgLm5hbWUoXCJkcmFmdFwiKVxyXG4gICAgICAgIC50YWdzKGNvdXJzZUlkKVxyXG4gICAgICAgIC5pZHNPbmx5KClcclxuICAgICAgICAubXV0YXRpb25zT25FbXB0eSh0eCA9PiB7XHJcbiAgICAgICAgICAvLyBUaGVzZSAyIG11dGF0aW9ucyB3aWxsIG9jY3VyIHNlcnZlciBzaWRlLCBhdG9taWNhbGx5LlxyXG4gICAgICAgICAgLy8gV2lsbCBiZSBzZW50IG9uIGVhY2ggcmVxdWVzdCBpbiB0aGUgcXVlcnksIGJ1dCB3aWxsIG9ubHkgZXhlY3V0ZSBpZiBxdWVyeSByZXN1bHRzIGluIHplcm8gaXRlbXMuXHJcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiU2Nob29sOlwiLCBzY2hvb2wpO1xyXG4gICAgICAgICAgY29uc3QgaWQgPSBjcmVhdGVVVUlEKCk7XHJcbiAgICAgICAgICB0eC5hZGQoXCJicmFuY2hlc1wiLCB7XHJcbiAgICAgICAgICAgIGlkLFxyXG4gICAgICAgICAgICBhY2w6IFtcclxuICAgICAgICAgICAgICBcInJvbGU6VVNFUjpSXCIsXHJcbiAgICAgICAgICAgICAgYHNjaG9vbFJvbGU6JHtzY2hvb2wubmFtZX0vRU1QTE9ZRUU6U2BcclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgbmFtZTogJ2RyYWZ0JyxcclxuICAgICAgICAgICAgc2Nob29sSWQ6IHNjaG9vbC5pZCxcclxuICAgICAgICAgICAgdHJlZVBhcmVudElkOiBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCxcclxuICAgICAgICAgICAgdGFnczogW2NvdXJzZUlkXVxyXG4gICAgICAgICAgfSBhcyBCcmFuY2gpO1xyXG4gICAgICAgICAgLy8gQXBwcm92aW5nIHRoZSBicmFuY2ggbWFrZXMgc3VyZSB0aGF0IGl0IHdhcyBjcmVhdGVkIGJ5IGFuIEVNUExPWUVFIG9uIGdpdmVuIHNjaG9vbC5cclxuICAgICAgICAgIHR4LmxpbmsyKFwiYnJhbmNoZXNcIiwgc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsIFwiYXBwcm92ZWRDaGlsZHJlblwiLCBpZCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuc2luZ2xlKClcclxuICAgICAgICAubWFwKCh7aWR9KSA9PiBpZCkpKTtcclxuICB9LFxyXG5cclxuICBnZXRBbGxEZXNjZW5kYW50SWRzKGNvdXJzZUlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBkYi5jb3Vyc2VCbG9ja3MudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpLmNvbmNhdChcclxuICAgICAgZGIuY291cnNlQ29udGVudHMudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKS5jb25jYXQoXHJcbiAgICAgIGRiLmNvdXJzZVRhYnMudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKS5jb25jYXQoXHJcbiAgICAgIGRiLnRhc2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSlcclxuICAgICAgLm1hcCh4ID0+IHguaWQpO1xyXG4gIH1cclxufVxyXG4iLCJcclxuZXhwb3J0IGNvbnN0IEtFRF9OQU1FU1BBQ0UgPSBcIktFRFwiO1xyXG5cclxuZGVjbGFyZSB2YXIgS0VEOiBhbnk7XHJcblxyXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcclxuXHJcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XHJcbiIsIlxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZXBvQ29tbXVuaWNhdG9yPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcclxuICBxdWVyeSgpOiBQcm9taXNlPFRbXT47XHJcbn1cclxuXHJcbnR5cGUgU3Vic2NyaWJlcjxUPiA9IChpdGVtczpUW10sIGVycm9yOiB1bmRlZmluZWQgfCBFcnJvcikgPT4gYW55O1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlcG88VCBleHRlbmRzIHtpZDogc3RyaW5nfT4ge1xyXG4gIGxpc3RQcm9taXNlOiBQcm9taXNlPHZvaWQ+O1xyXG4gIGl0ZW1zOiBUW107XHJcbiAgZXJyb3I/OiBFcnJvcjtcclxuICBzdWJzY3JpYmVyczogU3Vic2NyaWJlcjxUPltdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgY29tbTogUmVwb0NvbW11bmljYXRvcjxUPikge1xyXG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aGlzLml0ZW1zID0gbnVsbDtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcclxuICB9XHJcblxyXG4gIHN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XHJcbiAgICByZXR1cm4gdGhpcy5lbnN1cmVIYXNEYXRhKCkudGhlbigoKT0+e1xyXG4gICAgICBzdWJzY3JpYmVyKHRoaXMuaXRlbXMsIHRoaXMuZXJyb3IpO1xyXG4gICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVuc3Vic2NyaWJlKHN1YnNjcmliZXI6IFN1YnNjcmliZXI8VD4pIHtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlciAocyA9PiBzICE9PSBzdWJzY3JpYmVyKTtcclxuICB9XHJcblxyXG4gIG5vdGlmeVN1YnNjcmliZXJzKCkge1xyXG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHMgPT4gcyh0aGlzLml0ZW1zLCB0aGlzLmVycm9yKSk7XHJcbiAgfVxyXG5cclxuICBlbnN1cmVIYXNEYXRhKCkge1xyXG4gICAgaWYgKCF0aGlzLmxpc3RQcm9taXNlKSB0aGlzLnJlZnJlc2hGcm9tU2VydmVyKCk7XHJcbiAgICByZXR1cm4gdGhpcy5saXN0UHJvbWlzZTtcclxuICB9XHJcblxyXG4gIHJlZnJlc2hGcm9tU2VydmVyKCkge1xyXG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IHRoaXMuY29tbS5xdWVyeSgpLnRoZW4oaXRlbXMgPT4ge1xyXG4gICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xyXG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMgfHwgW107XHJcbiAgICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMubGlzdFByb21pc2U7XHJcbiAgfVxyXG4gIFxyXG4gIGFzeW5jIHVwZGF0ZShpdGVtOiBUIHwgVFtdKSB7XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUhhc0RhdGEoKTtcclxuICAgIGNvbnN0IHVwZGF0ZWRJdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbSkgPyBpdGVtIDogW2l0ZW1dO1xyXG4gICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMubWFwKGl0ID0+IHtcclxuICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSB1cGRhdGVkSXRlbXMuZmluZCgoe2lkfSkgPT4gaXQuaWQgPT09IGlkKTtcclxuICAgICAgcmV0dXJuIHVwZGF0ZWRJdGVtID9cclxuICAgICAgICBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkSXRlbSkgOlxyXG4gICAgICAgIGl0O1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgfVxyXG5cclxuICBpbnNlcnQoaXRlbTogVCB8IFRbXSkge1xyXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuY29uY2F0KGl0ZW0pO1xyXG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZShpZDogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IGlkcyA9IEFycmF5LmlzQXJyYXkoaWQpID8gaWQgOiBbaWRdO1xyXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGl0ID0+ICFpZHMuc29tZShpZCA9PiBpdC5pZCA9PT0gaWQpKTtcclxuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFJlcG8sIFJlcG9Db21tdW5pY2F0b3IgfSBmcm9tICcuL3JlcG8nO1xyXG5pbXBvcnQgeyBDb3Vyc2UsIFNjaG9vbCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBmbGF0dGVuLCBMIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XHJcblxyXG5jbGFzcyBTY2hvb2xDb3Vyc2VzUmVwbyBleHRlbmRzIFJlcG88Q291cnNlPiB7XHJcbiAgcHJpdmF0ZSBfc2Nob29sSWQ6IHN0cmluZztcclxuICBnZXRTY2hvb2xJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT50aGlzLl9zY2hvb2xJZCk7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihnZXRTY2hvb2xOYW1lOiAoKT0+c3RyaW5nKSB7XHJcbiAgICBzdXBlcih7XHJcbiAgICAgIHF1ZXJ5OiBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc2Nob29sTmFtZSA9IGdldFNjaG9vbE5hbWUoKTtcclxuICAgICAgICBjb25zdCBzY2hvb2xzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTY2hvb2w+KFxyXG4gICAgICAgICAgXCJzY2hvb2xzXCIsIHtcclxuICAgICAgICAgICAgbmFtZTogc2Nob29sTmFtZSxcclxuICAgICAgICAgICAgaW5jbHVkZTogW1wiY291cnNlc1wiXVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fc2Nob29sSWQgPSBzY2hvb2xzLmxlbmd0aCA+IDAgJiYgc2Nob29sc1swXS5pZDtcclxuICAgICAgICBpZiAoIXRoaXMuX3NjaG9vbElkKSB0aHJvdyBuZXcgRXJyb3IoTGBTa29sYW4gJHtzY2hvb2xOYW1lfSBmaW5ucyBpbnRlIHJlZ2lzdHJlcmFkIGkgc3lzdGVtZXQuXHJcbiAgICAgICAgICBLb250YWt0YSBlbiBhZG1pbmlzdHJhdMO2ciBmw7ZyIEt1cnNieWdnYXJ2ZXJrdHlnZXQgb2NoIGJlIG9tIGF0dCBsw6RnZ2EgdGlsbCBza29sYW4gbWVkIG5hbW5ldCBcIiR7c2Nob29sTmFtZX1cImApO1xyXG4gICAgICAgIHJldHVybiBmbGF0dGVuKHNjaG9vbHMubWFwKHNjaG9vbCA9PiBzY2hvb2wuY291cnNlcykpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG15U2Nob29sQ291cnNlc1JlcG8gPSBuZXcgU2Nob29sQ291cnNlc1JlcG8oKCk9PmVudi5jdXJyZW50VXNlci5zY2hvb2wpO1xyXG4iLCJcclxuZXhwb3J0IGNsYXNzIENhY2hlZFJlc3BvbnNlPFQ+IHtcclxuICAgIHByb21pc2U6IFByb21pc2U8VD4gfCBudWxsO1xyXG4gICAgcmVzdWx0OiBUIHwgbnVsbDtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBxdWVyeWVyOiAoKT0+UHJvbWlzZTxUPikge1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yZXN1bHQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHF1ZXJ5KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21pc2UgP1xyXG4gICAgICAgICAgICB0aGlzLnByb21pc2UgOlxyXG4gICAgICAgICAgICAodGhpcy5wcm9taXNlID0gdGhpcy5xdWVyeWVyKCkudGhlbih4ID0+IHRoaXMucmVzdWx0ID0geCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQge0x9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQge2RifSBmcm9tICcuLi9nbG9iYWxzL2RiJztcclxuaW1wb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XHJcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcclxuXHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGVycm9yczogRXJyb3JTdHJ1Y3RbXTtcclxuICBpbmZvczogc3RyaW5nW107XHJcbiAgLy9kYldyaXRlclJldHJ5YWJsZUVycm9yPzogRXJyb3I7XHJcbiAgZGJXcml0ZXJJc1NhdmluZz86IGJvb2xlYW47XHJcbiAgZGJXcml0ZXJJc0VkaXRlZD86IGJvb2xlYW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBFcnJvclN0cnVjdCB7XHJcbiAgbWVzc2FnZTogc3RyaW5nO1xyXG4gIHJldHJ5YWJsZT86IGJvb2xlYW47XHJcbiAgZGV0YWlscz86IEVycm9yO1xyXG4gIHNob3dEZXRhaWxzPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVycm9yU3VjY2Vzc0ZlZWRiYWNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZT17XHJcbiAgICAgIGVycm9yczogW10sXHJcbiAgICAgIGluZm9zOiBbXVxyXG4gICAgfTtcclxuICAgIHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbiA9IHRoaXMuX3VuaGFuZGxlZFJlamVjdGlvbi5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fZXJyb3IgPSB0aGlzLl9lcnJvci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fY3VzdG9tRXJyb3IgPSB0aGlzLl9jdXN0b21FcnJvci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fb25JbmZvID0gdGhpcy5fb25JbmZvLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9kYldyaXRlckVycm9yID0gdGhpcy5fZGJXcml0ZXJFcnJvci5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQgPSB0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfYWRkRXJyb3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogRXJyb3IsIHJldHJ5YWJsZT86IGJvb2xlYW4pIHtcclxuICAgIC8vY29uc29sZS5lcnJvcihtZXNzYWdlLCB7cmV0cnlhYmxlOiAhIXJldHJ5YWJsZSwgZGV0YWlsc30pO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+IHtcclxuICAgICAgaWYgKGVycm9ycy5zb21lKGUgPT4gZS5tZXNzYWdlID09PSBtZXNzYWdlKSkgcmV0dXJuIHtlcnJvcnN9O1xyXG4gICAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDIpIGVycm9ycyA9IGVycm9ycy5zbGljZSgxKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBlcnJvcnM6IGVycm9ycy5jb25jYXQoW3ttZXNzYWdlLCBkZXRhaWxzLCByZXRyeWFibGV9XSlcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgLy8gUmVtb3ZlIG5vbi1yZXRyeWFibGUgZXJyb3JzIGFmdGVyIDMwIHNlY29uZHM6XHJcbiAgICBpZiAoIXJldHJ5YWJsZSkgc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtcclxuICAgICAgICBlcnJvcnM6IGVycm9ycy5maWx0ZXIoZSA9PiBlLm1lc3NhZ2UgIT09IG1lc3NhZ2UpXHJcbiAgICAgIH0pKTtcclxuICAgIH0sIDMwMDAwKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2FkZEluZm8obWVzc2FnZTogc3RyaW5nKSB7XHJcbiAgICBpZiAobWVzc2FnZSA9PT0gXCJcIikge1xyXG4gICAgICAvLyBUdXJuIG9mZiBjdXJyZW50IGluZm8gbWVzc2FnZXNcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7aW5mb3M6IFtdfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuc2V0U3RhdGUoKHtpbmZvc30pID0+IHtcclxuICAgICAgaWYgKGluZm9zLnNvbWUoaW5mbyA9PiBpbmZvID09PSBtZXNzYWdlKSkgcmV0dXJuIHtpbmZvc307XHJcbiAgICAgIGlmIChpbmZvcy5sZW5ndGggPiAxKSBpbmZvcyA9IGluZm9zLnNsaWNlKDEpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGluZm9zOiBbbWVzc2FnZV0gLy8gd2FzOiBpbmZvcy5jb25jYXQobWVzc2FnZSkuIEJ1dCBpdCBzdWNrcyFcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgLy8gUmVtb3ZlIGluZm8gbWVzc2FnZSBhZnRlciAxMCBzZWNvbmRzOlxyXG4gICAgc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICB0aGlzLnNldFN0YXRlKCh7aW5mb3N9KSA9PiAoe1xyXG4gICAgICAgIGluZm9zOiBpbmZvcy5maWx0ZXIobXNnID0+IG1zZyAhPT0gbWVzc2FnZSlcclxuICAgICAgfSkpO1xyXG4gICAgfSwgMTAwMDApO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfZGJXcml0ZXJFcnJvciAoZXJyb3I6IEVycm9yLCByZXRyeWFibGU6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuX2FkZEVycm9yKGBEZXQgZ8OlciBpbnRlIGF0dCBzcGFyYSB0aWxsIHNlcnZlcm5gLCBlcnJvciwgcmV0cnlhYmxlKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2RiV3JpdGVyU3RhdGVDaGFuZ2VkICh7aXNFZGl0ZWQsIGlzU2F2aW5nfTogS2VkQmFja2VuZFdyaXRlcikge1xyXG4gICAgaWYgKCFpc0VkaXRlZCkge1xyXG4gICAgICAvLyBJZiBpc0VkaXRlZCBpcyBmYWxzZSwgYSBzdWNjZXNzZnVsIHdyaXRlIG11c3QgaGF2ZSBoYXBwZW5lZCwgYW5kXHJcbiAgICAgIC8vIHRoZXJlIGNhbm5vdCBiZSBhbnkgcmV0cnlhYmxlIGVycm9yIGFueW1vcmVcclxuICAgICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+IHtcclxuICAgICAgICBlcnJvcnMgPSBlcnJvcnMuZmlsdGVyKGUgPT4gIWUucmV0cnlhYmxlKTtcclxuICAgICAgICByZXR1cm4ge2Vycm9yc307XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgIGRiV3JpdGVySXNFZGl0ZWQ6IGlzRWRpdGVkLFxyXG4gICAgICBkYldyaXRlcklzU2F2aW5nOiBpc1NhdmluZ1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnREaWRNb3VudCgpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmhhbmRsZWRyZWplY3Rpb24nLCB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24pO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fZXJyb3IpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2luZm8nLCB0aGlzLl9vbkluZm8pO1xyXG4gICAgZGIud3JpdGVyLm9uRXJyb3IodGhpcy5fZGJXcml0ZXJFcnJvcik7XHJcbiAgICBkYi53cml0ZXIub25TdGF0ZUNoYW5nZSh0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZCk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd1bmhhbmRsZWRyZWplY3Rpb24nLCB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24pO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5fZXJyb3IpO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2luZm8nLCB0aGlzLl9vbkluZm8pO1xyXG4gICAgZGIud3JpdGVyLm9mZih0aGlzLl9kYldyaXRlckVycm9yKTtcclxuICAgIGRiLndyaXRlci5vZmYodGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQpO1xyXG4gIH1cclxuXHJcbiAgX3VuaGFuZGxlZFJlamVjdGlvbiAoZXY6IEV2ZW50ICYge3JlYXNvbjogRXJyb3J9KSB7XHJcbiAgICB0aGlzLl9hZGRFcnJvcihgRXR0IG9rw6RudCBmZWwgaW50csOkZmZhZGUuLi5gLCBldi5yZWFzb24pO1xyXG4gIH1cclxuXHJcbiAgX2Vycm9yIChldjogRXZlbnQgJiB7ZXJyb3I6IEVycm9yfSkge1xyXG4gICAgdGhpcy5fYWRkRXJyb3IoZXYuZXJyb3IgPyBldi5lcnJvci5tZXNzYWdlIDogYEV0dCBva8OkbnQgZmVsIGludHLDpGZmYWRlLi4uYCwgZXYuZXJyb3IpO1xyXG4gIH1cclxuXHJcbiAgX2N1c3RvbUVycm9yIChldjogQ3VzdG9tRXZlbnQpIHtcclxuICAgIHRoaXMuX2FkZEVycm9yKGV2LmRldGFpbCk7XHJcbiAgfVxyXG5cclxuICBfb25JbmZvKGV2OiBDdXN0b21FdmVudCkge1xyXG4gICAgdGhpcy5fYWRkSW5mbyhldi5kZXRhaWwpO1xyXG4gIH0gXHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtlcnJvcnMsIGluZm9zLCBkYldyaXRlcklzU2F2aW5nfSA9IHRoaXMuc3RhdGU7XHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJlcnJvci1zdWNjZXNzLWZlZWRiYWNrXCIgc3R5bGU9e3tcclxuICAgICAgcG9zaXRpb246IFwiZml4ZWRcIixcclxuICAgICAgbGVmdDogMCxcclxuICAgICAgdG9wOiAwLFxyXG4gICAgICB3aWR0aDogXCIxMDAlXCIsXHJcbiAgICAgIHBvaW50ZXJFdmVudHM6ICdub25lJ1xyXG4gICAgfX0+XHJcbiAgICAgIDxkaXYgc3R5bGU9e3tkaXNwbGF5OiAndGFibGUnLCBtYXJnaW46IFwiMCBhdXRvXCJ9fT5cclxuICAgICAgICB7ZXJyb3JzLmZpbHRlcihlID0+ICFlLnJldHJ5YWJsZSB8fCAhZGJXcml0ZXJJc1NhdmluZylcclxuICAgICAgICAubWFwKCh7bWVzc2FnZSwgZGV0YWlscywgcmV0cnlhYmxlLCBzaG93RGV0YWlsc30pID0+IChcclxuICAgICAgICAgIDxkaXYga2V5PXttZXNzYWdlfSBjbGFzc05hbWU9XCJlcnJvclwiPlxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7ZmxvYXQ6J2xlZnQnfX0+e21lc3NhZ2V9PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cclxuICAgICAgICAgICAgICA8UmVtb3ZlSXRlbSBvbkNsaWNrPXsoKT0+dGhpcy5yZW1vdmVFcnJvcihtZXNzYWdlKX0gLz5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIHtkZXRhaWxzIHx8IHJldHJ5YWJsZSA/IDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cclxuICAgICAgICAgICAgICB7ZGV0YWlscyA/IDw+PGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCk9PnRoaXMudG9nZ2xlRGV0YWlscyhtZXNzYWdlKX0+e3Nob3dEZXRhaWxzID8gXCJEw7ZsaiBkZXRhaWxlclwiIDogXCJWaXNhIGRldGFpbGplclwifTwvYT4mbmJzcDs8Lz4gOiB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgICAge3Nob3dEZXRhaWxzID8gPHA+eycnK2RldGFpbHN9PC9wPjogPD4mbmJzcDs8Lz59XHJcbiAgICAgICAgICAgICAge3JldHJ5YWJsZSA/IDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnJldHJ5U2F2ZSgpfT5Gw7Zyc8O2ayBzcGFyYSBudTwvYT4gOiB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgIDwvZGl2PjogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgKSl9XHJcbiAgICAgICAge2luZm9zLm1hcChtZXNzYWdlID0+IFxyXG4gICAgICAgICAgPHAga2V5PXttZXNzYWdlfSBjbGFzc05hbWU9XCJpbmZvXCI+e21lc3NhZ2V9PC9wPlxyXG4gICAgICAgICl9XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+O1xyXG4gIH1cclxuICByZW1vdmVFcnJvcihtZXNzYWdlOiBzdHJpbmcpOiBhbnkge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+ICh7XHJcbiAgICAgIGVycm9yczogZXJyb3JzLmZpbHRlcihlID0+IGUubWVzc2FnZSAhPT0gbWVzc2FnZSlcclxuICAgIH0pKTtcclxuICB9XHJcblxyXG4gIHJldHJ5U2F2ZSgpIHtcclxuICAgIGRiLndyaXRlci5yZXRyeVNhdmUoKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZURldGFpbHMobWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtlcnJvcnM6IGVycm9ycy5tYXAoZXJyb3IgPT4gZXJyb3IubWVzc2FnZSA9PT0gbWVzc2FnZSA/XHJcbiAgICAgIHtcclxuICAgICAgICAuLi5lcnJvcixcclxuICAgICAgICBzaG93RGV0YWlsczogIWVycm9yLnNob3dEZXRhaWxzXHJcbiAgICAgIH0gOlxyXG4gICAgICBlcnJvcilcclxuICAgIH0pKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuaW1wb3J0IHsgY2ZnIH0gZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuXHJcbmNvbnN0IEhFQVJUQkVBVF9JTlRFUlZBTCA9IDUgKiA2MCAqIDEwMDA7IC8vIDUgbWludXRlcy5cclxuY29uc3QgSEVBUlRCRUFUX1VSTCA9IGNmZy5LRURfS0VFUF9BTElWRV9VUkw7XHJcblxyXG5sZXQgbGFzdEFjdGl2aXR5ID0gRGF0ZS5ub3coKTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBrZWVwU2Vzc2lvbkFsaXZlKCkge1xyXG4gIHNldEludGVydmFsKG9uVGltZW91dCwgSEVBUlRCRUFUX0lOVEVSVkFMKTtcclxuICBzZXRUaW1lb3V0KCgpPT4kKCdib2R5JylcclxuICAgIC5tb3VzZW1vdmUob25Vc2VyQWN0aXZlKVxyXG4gICAgLmtleXByZXNzKG9uVXNlckFjdGl2ZSlcclxuICAgIC5zY3JvbGwob25Vc2VyQWN0aXZlKSwgMTAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb25Vc2VyQWN0aXZlKCkge1xyXG4gIGxhc3RBY3Rpdml0eSA9IERhdGUubm93KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9uVGltZW91dCgpIHtcclxuICBjb25zdCBpbmFjdGl2aXR5VGltZSA9IERhdGUubm93KCkgLSBsYXN0QWN0aXZpdHk7XHJcbiAgaWYgKGluYWN0aXZpdHlUaW1lIDwgSEVBUlRCRUFUX0lOVEVSVkFMKSB7XHJcbiAgICBoZWFydGJlYXQoKTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhlYXJ0YmVhdCgpIHtcclxuICBjb25zb2xlLmxvZyhgU2VuZGluZyBoZWFydGJlYXQgcmVxdWVzdCB0byAke0hFQVJUQkVBVF9VUkx9YCk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEhFQVJUQkVBVF9VUkwsIHtcclxuICAgICAgY2FjaGU6ICduby1jYWNoZScsXHJcbiAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBSZXNwb25zZSBmcm9tICR7SEVBUlRCRUFUX1VSTH06ICR7cmVzLnN0YXR1c30gJHtyZXMuc3RhdHVzVGV4dH1gKTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUud2FybihgUmVxdWVzdCB0byAke0hFQVJUQkVBVF9VUkx9IGZhaWxlZDogJHtlcnJ9YCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTiA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzLlxyXG5cclxudHlwZSBQcm9taXNlUmV0dXJuaW5nTWV0aG9kTmFtZXM8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIEFQSV06IEFQSVtNRVRIT0RdIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBQcm9taXNlPGFueT4gPyBNRVRIT0QgOiBuZXZlclxyXG59XHJcblxyXG50eXBlIENvbnZlcnRNZXRob2RUb1N1c3BlbnNlPEY+ID0gRiBleHRlbmRzICguLi5hcmdzOiBpbmZlciBBKSA9PiBQcm9taXNlPGluZmVyIFI+ID9cclxuICAoLi4uYXJnczogQSkgPT4gUiA6XHJcbiAgRjtcclxuXHJcbmV4cG9ydCB0eXBlIFN1c3BlbnNlQmFzZWRBUEk8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIFByb21pc2VSZXR1cm5pbmdNZXRob2ROYW1lczxBUEk+XTogQ29udmVydE1ldGhvZFRvU3VzcGVuc2U8QVBJW01FVEhPRF0+XHJcbn1cclxuXHJcbnR5cGUgT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZD86IChwcm9wOiBzdHJpbmcpPT5ib29sZWFuLFxyXG4gIGNhY2hlRXhwaXJhdGlvbj86IG51bWJlclxyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0T3B0aW9uczogT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZDogZiA9PiB0eXBlb2YgZiA9PT0gJ2Z1bmN0aW9uJyxcclxuICBjYWNoZUV4cGlyYXRpb246IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTlxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VTdXNwZW5zZUFwaTxBUEk+KGFwaTogQVBJLCBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnMpOiBTdXNwZW5zZUJhc2VkQVBJPEFQST5cclxue1xyXG4gIG9wdGlvbnMgPSB7Li4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnN9O1xyXG4gIGNvbnN0IHtpc0FwaU1ldGhvZCwgY2FjaGVFeHBpcmF0aW9ufSA9IG9wdGlvbnM7XHJcblxyXG4gIGNvbnN0IHJ2OiBTdXNwZW5zZUJhc2VkQVBJPEFQST4gPSBPYmplY3QuY3JlYXRlKGFwaSBhcyBhbnkpIGFzIFN1c3BlbnNlQmFzZWRBUEk8QVBJPjtcclxuICBjb25zdCBjYWNoZToge1trZXk6IHN0cmluZ106IHt0aW1lb3V0OiBudW1iZXIsIHZhbHVlPzogYW55LCBlcnJvcj86IGFueSwgcHJvbWlzZT86IFByb21pc2U8YW55Pn19ID0ge307XHJcblxyXG4gIC8vIFdhbGsgdGhlIGluc3RhbmNlICsgcHJvdG90eXBlIGNoYWluIHRvIGdlbmVyYXRlIHN1c3BlbnNlIHZlcnNpb24gb2YgZWFjaCBwcm9taXNlIHJldHVybmluZyBtZXRob2RcclxuICBmb3IgKGxldCBwcm90byA9IGFwaTsgcHJvdG8gJiYgcHJvdG8gIT09IE9iamVjdC5wcm90b3R5cGU7IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSkge1xyXG4gICAgc3VzcGVuZGlmeShwcm90byk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzdXNwZW5kaWZ5KHByb3RvKSB7XHJcbiAgICBPYmplY3Qua2V5cyhwcm90bykuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgaWYgKCFydi5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiBpc0FwaU1ldGhvZChwcm9wKSkge1xyXG4gICAgICAgIHJ2W3Byb3BdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KFtwcm9wLCAuLi5hcmdzXSk7XHJcbiAgICAgICAgICBjb25zdCBjYWNoZWRFbnRyeSA9IGNhY2hlW2tleV07XHJcbiAgICAgICAgICBpZiAoY2FjaGVkRW50cnkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoY2FjaGVkRW50cnkucHJvbWlzZSkgdGhyb3cgY2FjaGVkRW50cnkucHJvbWlzZTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LmVycm9yKSB0aHJvdyBjYWNoZWRFbnRyeS5lcnJvcjtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LnRpbWVvdXQgPiBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZEVudHJ5LnZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlID0gcHJvdG9bcHJvcF0uYXBwbHkoYXBpLCBhcmdzKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCB2YWx1ZTogcmVzdWx0fTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgZXJyb3J9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBwcm9taXNlfTtcclxuICAgICAgICAgICAgdGhyb3cgcHJvbWlzZTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci50aGVuKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBlcnJvcn07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJ2O1xyXG59XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMge1xyXG4gIHRvTG93ZXI/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9IHtcclxuICBjb25zdCB7dG9Mb3dlcn0gPSAob3B0aW9ucyB8fMKge30pIGFzIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zO1xyXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gIGlmIChsb2NhdGlvblNlYXJjaCAmJiBsb2NhdGlvblNlYXJjaC5sZW5ndGggPiAxKVxyXG4gICAgbG9jYXRpb25TZWFyY2guc3Vic3RyKDEpXHJcbiAgICAgIC5zcGxpdCgnJicpXHJcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnNwbGl0KCc9JykubWFwKHMgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMudHJpbSgpKSkpXHJcbiAgICAgIC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHJlc3VsdFt0b0xvd2VyID8ga2V5LnRvTG93ZXJDYXNlKCkgOiBrZXldID0gdmFsdWUpO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuY29kZVBhcmFtcyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5maWx0ZXIoa2V5ID0+IHBhcmFtc1trZXldICE9PSB1bmRlZmluZWQpLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trZXldKX1gKS5qb2luKCcmJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xyXG4gIHJldHVybiBcIj9cIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VIYXNoUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucykge1xyXG4gIHJldHVybiBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uSGFzaCwgb3B0aW9ucyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUhhc2hRdWVyeVN0cmluZyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gXCIjXCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0VXJsQW5kUXVlcnkgKHVybFdpdGhQb3NzaWJsZVF1ZXJ5OiBzdHJpbmcpIHtcclxuICBjb25zdCBwUXVlcnkgPSB1cmxXaXRoUG9zc2libGVRdWVyeS5pbmRleE9mKCc/Jyk7XHJcbiAgcmV0dXJuIHBRdWVyeSA+PSAwID9cclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIoMCwgcFF1ZXJ5KSwgdXJsV2l0aFBvc3NpYmxlUXVlcnkuc3Vic3RyKHBRdWVyeSldIDpcclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeSwgXCJcIl07XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBUZXJtLCBBY2FkZW1pY1llYXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XHJcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XHJcbiAgdGVybTogVGVybTtcclxuICB3ZWVrPzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XHJcbiAgcmV0dXJuIHRlcm0gPT09ICdBVCcgP1xyXG4gICAgWzMyLCA1MV0gOlxyXG4gICAgWzEsIDI1XTtcclxufVxyXG5cclxuLy9Ob3QgdXNlZCBhbnltb3JlXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBnZXRUZXJtU3RhcnRBbmRFbmQobm93OiBtb21lbnQuTW9tZW50KSA6IG1vbWVudC5Nb21lbnRbXSB7XHJcbi8vICAgICByZXR1cm4gbm93Lm1vbnRoKCkgPj0gNiA/IC8vIDYgPSBKdWx5IGluIEpTIERhdGVzIGFuZCBpbiBtb21lbnQgYXMgd2VsbCFcclxuLy8gICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNywgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMTEsIDMxKSldIDogLy8gYXVnMSAtIGRlYzMxXHJcbi8vICAgICBbbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDAsIDEpKSwgbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDYsIDMxKSldOyAvLyBqYW4xIC0ganVseTMxXHJcbi8vIH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRUZXJtU3RhckVuZERhdGUoZGF0ZTogRGF0ZSwgaXNGaXJzdFRlcm06IGJvb2xlYW4pOiBtb21lbnQuTW9tZW50W10ge1xyXG4gIHZhciBhZGRZZWFyID0gZGF0ZS5nZXRNb250aCgpID49IDc7XHJcbiAgdmFyIHRlcm1ZZWFyID0gbnVsbDtcclxuXHJcbiAgaWYgKGFkZFllYXIpIHtcclxuICAgIHRlcm1ZZWFyID0gaXNGaXJzdFRlcm0gPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiBkYXRlLmdldEZ1bGxZZWFyKCkgKyAxO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0ZXJtWWVhciA9IGlzRmlyc3RUZXJtID8gZGF0ZS5nZXRGdWxsWWVhcigpIC0gMSA6IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuICB9XHJcblxyXG4gIHZhciB0ZXJtWWVhck1vbWVudCA9IG1vbWVudCh0ZXJtWWVhci50b1N0cmluZygpLCBcIllZWVlcIik7XHJcblxyXG4gIGlmICh0ZXJtWWVhck1vbWVudC53ZWVrKCkgIT0gMSkge1xyXG4gICAgdGVybVllYXJNb21lbnQgPSB0ZXJtWWVhck1vbWVudC5jbG9uZSgpLmFkZCgxLCAnd2VlaycpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGlzRmlyc3RUZXJtID8gW21vbWVudCh0ZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDMyKS5zdGFydE9mKCd3ZWVrJyksIG1vbWVudCh0ZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDUxKS5lbmRPZignd2VlaycpXSA6XHJcbiAgICBbbW9tZW50KHRlcm1ZZWFyTW9tZW50LmNsb25lKCkpLCBtb21lbnQodGVybVllYXJNb21lbnQuY2xvbmUoKSkud2VlaygyNSkuZW5kT2YoJ3dlZWsnKV07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xNb21lbnQobTogbW9tZW50Lk1vbWVudCk6IFNjaG9vbE1vbWVudCB7XHJcbiAgY29uc3QgdGhpc1llYXIgPSBtLnllYXIoKTtcclxuICBjb25zdCBpc0F1dHVtbiA9IG0ubW9udGgoKSA+PSA2OyAvLyBkZXRlcm1pbmUgXHJcbiAgY29uc3QgW2F1dHVtblllYXIsIHNwcmluZ1llYXJdID0gaXNBdXR1bW4gP1xyXG4gICAgW3RoaXNZZWFyLCB0aGlzWWVhciArIDFdIDpcclxuICAgIFt0aGlzWWVhciAtIDEsIHRoaXNZZWFyXTtcclxuICBjb25zdCBhY2FkZW1pY1llYXIgPSAnJyArIGF1dHVtblllYXIgKyAnLycgKyBzcHJpbmdZZWFyO1xyXG4gIGNvbnN0IHRlcm0gPSBpc0F1dHVtbiA/ICdBVCcgOiAnU1QnO1xyXG4gIGNvbnN0IHdlZWsgPSBtLndlZWsoKTtcclxuICByZXR1cm4geyBhY2FkZW1pY1llYXIsIHRlcm0sIHdlZWsgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZFllYXIoYVllYXI6IEFjYWRlbWljWWVhciwgbnVtWWVhcnNUb0FkZDogbnVtYmVyKTogQWNhZGVtaWNZZWFyIHtcclxuICByZXR1cm4gYVllYXIuc3BsaXQoJy8nKVxyXG4gICAgLm1hcCh5ZWFyU3RyID0+IHBhcnNlSW50KHllYXJTdHIpICsgbnVtWWVhcnNUb0FkZClcclxuICAgIC5tYXAoeWVhciA9PiAnJyArIHllYXIpXHJcbiAgICAuam9pbignLycpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbmV4dEFjYWRlbWljWWVhcihhWWVhcjogQWNhZGVtaWNZZWFyKTogQWNhZGVtaWNZZWFyIHtcclxuICByZXR1cm4gYWRkWWVhcihhWWVhciwgMSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBwcmV2QWNhZGVtaWNZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIpOiBBY2FkZW1pY1llYXIge1xyXG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAtMSk7XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBTY2hvb2xNb21lbnQsIGdldFNjaG9vbE1vbWVudCwgYWRkWWVhciB9IGZyb20gJy4vc2Nob29sLW1vbWVudCc7XHJcbmltcG9ydCB7IEFjYWRlbWljWWVhciwgVGVybSB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuaW1wb3J0IHtJbmplY3RlZEludGx9IGZyb20gJ3JlYWN0LWludGwnO1xyXG5cclxudHlwZSBNb21lbnQgPSBtb21lbnQuTW9tZW50O1xyXG5cclxuZnVuY3Rpb24gaXNTY2hvb2xNb21lbnQob2JqOiBEYXRlIHwgU2Nob29sTW9tZW50KTogb2JqIGlzIFNjaG9vbE1vbWVudCB7XHJcbiAgcmV0dXJuICdhY2FkZW1pY1llYXInIGluIG9iajtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNjaG9vbFRlcm0ge1xyXG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xyXG4gIHRlcm06IFRlcm07XHJcblxyXG4gIGNvbnN0cnVjdG9yKGRhdGVPclNjaG9vbE1vbWVudDogRGF0ZSB8IFNjaG9vbE1vbWVudCkge1xyXG4gICAgY29uc3Qgc2Nob29sTW9tZW50ID0gaXNTY2hvb2xNb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSA/XHJcbiAgICAgIGRhdGVPclNjaG9vbE1vbWVudCA6IGdldFNjaG9vbE1vbWVudChtb21lbnQoZGF0ZU9yU2Nob29sTW9tZW50KSk7XHJcbiAgICB0aGlzLmFjYWRlbWljWWVhciA9IHNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXI7XHJcbiAgICB0aGlzLnRlcm0gPSBzY2hvb2xNb21lbnQudGVybTtcclxuICB9XHJcblxyXG4gIGdldCB5ZWFyKCkge1xyXG4gICAgcmV0dXJuIHBhcnNlSW50KHRoaXMuYWNhZGVtaWNZZWFyXHJcbiAgICAgICAgLnNwbGl0KCcvJylbdGhpcy50ZXJtID09PSAnQVQnID8gMCA6IDFdKTtcclxuICB9XHJcblxyXG4gIG5leHRUZXJtKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgIHtcclxuICAgICAgICB0ZXJtOiAnU1QnLFxyXG4gICAgICAgIGFjYWRlbWljWWVhcjogdGhpcy5hY2FkZW1pY1llYXJcclxuICAgICAgfSA6XHJcbiAgICAgIHtcclxuICAgICAgICB0ZXJtOiAnQVQnLFxyXG4gICAgICAgIGFjYWRlbWljWWVhcjogYWRkWWVhcih0aGlzLmFjYWRlbWljWWVhciwgMSlcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBwcmV2VGVybSgpIHtcclxuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xyXG4gICAgICB7XHJcbiAgICAgICAgdGVybTogJ1NUJyxcclxuICAgICAgICBhY2FkZW1pY1llYXI6IGFkZFllYXIodGhpcy5hY2FkZW1pY1llYXIsIC0xKVxyXG4gICAgICB9IDpcclxuICAgICAge1xyXG4gICAgICAgIHRlcm06ICdBVCcsXHJcbiAgICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLmFjYWRlbWljWWVhclxyXG4gICAgICB9KTtcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgdG9Mb2NhbGVTdHJpbmcoaW50bDogSW5qZWN0ZWRJbnRsLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XHJcbiAgICBsZXQgeWVhciA9IHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMF06XHJcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMV07XHJcblxyXG4gICAgaWYgKHNob3J0WWVhcilcclxuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLnRlcm0gPT09ICdBVCcgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5zZWNvbmRUZXJtJywgZGVmYXVsdE1lc3NhZ2U6J0hUIHt5ZWFyfSd9LCB7eWVhcjogeWVhcn0pIDogXHJcbiAgICBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOid0ZXJtcGxhbm5lci5maXJzdFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonVlQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0IChzdHIpIHtcclxuICAgIGZvciAobGV0IGk9MCwgbD1zdHIubGVuZ3RoOyBpPGw7ICsraSkge1xyXG4gICAgICAgIGlmIChzdHIuY2hhckNvZGVBdChpKSA8IDB4MjAwMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyLnN1YnN0cigwLCBpKSArIHN0cltpXS50b0xvY2FsZVVwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cihpICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0cjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChvYmosIGV4dGVuc2lvbikge1xyXG4gICAgaWYgKHR5cGVvZiBleHRlbnNpb24gIT09ICdvYmplY3QnKSByZXR1cm4gb2JqO1xyXG4gICAgT2JqZWN0LmtleXMoZXh0ZW5zaW9uKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgb2JqW2tleV0gPSBleHRlbnNpb25ba2V5XTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIG9iajtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lPFQsRT4gKG9iaiA6IFQsIGV4dGVuc2lvbj86IEUpIHtcclxuICAgIGxldCBjbG9uZSA9IHt9O1xyXG4gICAgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKS5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNsb25lLCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpKTtcclxuICAgIH0pO1xyXG4gICAgaWYgKGV4dGVuc2lvbikgZXh0ZW5kKGNsb25lLCBleHRlbnNpb24pO1xyXG4gICAgcmV0dXJuIGNsb25lIGFzIChUICYgRSk7XHJcbn1cclxuXHJcbmNvbnN0IGNvbmNhdCA9IFtdLmNvbmNhdDtcclxuZXhwb3J0IGZ1bmN0aW9uIGZsYXR0ZW48VD4gKGEgOiAoVCB8IFRbXSlbXSkge1xyXG4gICAgcmV0dXJuIGNvbmNhdC5hcHBseShbXSwgYSkgYXMgVFtdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVByb3A8VD4ocHJvcDprZXlvZiBUKSB7XHJcbiAgICByZXR1cm4gKGE6IFQsYjogVCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFQcm9wID0gYVtwcm9wXSwgYlByb3AgPSBiW3Byb3BdO1xyXG4gICAgICAgIHJldHVybiBhUHJvcCA+IGJQcm9wID8gMSA6IGFQcm9wIDwgYlByb3AgPyAtMSA6IDA7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcHMoXHJcbiAgICBwcm9wczogc3RyaW5nIHwgc3RyaW5nW10sXHJcbiAgICBsb2NhbGVzPzogc3RyaW5nIHwgc3RyaW5nW10sXHJcbiAgICBvcHRpb25zPzogSW50bC5Db2xsYXRvck9wdGlvbnMpOiAoYTogYW55LCBiOiBhbnkpID0+IG51bWJlclxyXG57XHJcbiAgICBwcm9wcyA9IEFycmF5LmlzQXJyYXkocHJvcHMpID8gcHJvcHMgOiBbcHJvcHNdO1xyXG5cclxuICAgIGNvbnN0IGxvY2FsZUNvbXBhcmUgPSAoYSxiKSA9PlxyXG4gICAgICAgIHR5cGVvZiBhID09PSAnc3RyaW5nJyA/XHJcbiAgICAgICAgICAgIGEubG9jYWxlQ29tcGFyZShiLCBsb2NhbGVzLCBvcHRpb25zKSA6XHJcbiAgICAgICAgICAgIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNtcFBhcnQgKGEsYixmaXJzdFBhcnQ6IHN0cmluZyxyZXN0OiBzdHJpbmdbXSkge1xyXG4gICAgICAgIGNvbnN0IGZpcnN0QSA9IGFbZmlyc3RQYXJ0XTtcclxuICAgICAgICBpZiAoZmlyc3RBID09IG51bGwpIHJldHVybiAtMTtcclxuICAgICAgICBjb25zdCBmaXJzdEIgPSBiW2ZpcnN0UGFydF07XHJcbiAgICAgICAgaWYgKGZpcnN0QiA9PSBudWxsKSByZXR1cm4gMTtcclxuICAgICAgICByZXR1cm4gcmVzdC5sZW5ndGggPT09IDAgP1xyXG4gICAgICAgICAgICBsb2NhbGVDb21wYXJlKGZpcnN0QSwgZmlyc3RCKSA6XHJcbiAgICAgICAgICAgIGNtcFBhcnQoZmlyc3RBLCBmaXJzdEIsIHJlc3RbMF0sIHJlc3Quc2xpY2UoMSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwcm9wc1xyXG4gICAgICAgIC5tYXAocHJvcCA9PiBwcm9wLnNwbGl0KCcuJykpXHJcbiAgICAgICAgLm1hcCgoW2ZpcnN0UGFydCwgLi4ucmVzdF0pID0+IChhLGIpID0+IGNtcFBhcnQoYSxiLCBmaXJzdFBhcnQsIHJlc3QpKVxyXG4gICAgICAgIC5yZWR1Y2UoKGNtcDEsIGNtcDIpID0+XHJcbiAgICAgICAgICAgIChhLGIpID0+IGNtcDEoYSxiKSB8fCBjbXAyKGEsYikpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gTCh0ZXh0LCAuLi5hcmdzKSB7XHJcbiAgICBsZXQgZmlyc3QgPSB0ZXh0WzBdO1xyXG4gICAgcmV0dXJuIGJ1aWxkTWVzc2FnZSh0ZXh0LCBhcmdzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYnVpbGRNZXNzYWdlICh0ZXh0LCBhcmdzKSB7XHJcbiAgICBsZXQgcnYgPSB0ZXh0WzBdO1xyXG4gICAgZm9yIChsZXQgaT0xLCBsPXRleHQubGVuZ3RoOyBpPGw7ICsraSkge1xyXG4gICAgICAgIHJ2ICs9IGFyZ3NbaS0xXSArIHRleHRbaV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcnY7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUQzxUPiB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZTogVCkge1xyXG4gICAgICAgIGV4dGVuZCh0aGlzLCB0ZW1wbGF0ZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkYXRlVGltZVJldml2ZXIgKGtleSwgdmFsdWUpIHtcclxuICAgIHZhciBhO1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBhID0gL1xcL0RhdGVcXCgoXFxkKilcXClcXC8vLmV4ZWModmFsdWUpO1xyXG4gICAgICAgIGlmIChhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgrYVsxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG4vL2xldCBpbmZvU2VyaWFsID0gMTtcclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dJbmZvIChtc2cpIHtcclxuICAgIHZhciBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnaW5mbycsIHsgJ2RldGFpbCc6IG1zZyB9KTtcclxuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dFcnJvciAoZXJyTXNnOiBzdHJpbmcgfCBFcnJvcikge1xyXG4gICAgY29uc3QgbXNnID0gdHlwZW9mIGVyck1zZyA9PT0gJ3N0cmluZycgPyBlcnJNc2cgOiBlcnJNc2cubWVzc2FnZTtcclxuICAgIHZhciBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnY3VzdG9tZXJyb3InLCB7ICdkZXRhaWwnOiBtc2cgfSk7XHJcbiAgICBjb25zb2xlLmVycm9yKGVyck1zZyk7XHJcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYXhMZW5ndGgoc3RyOiBzdHJpbmcsIG1heExlbjogbnVtYmVyKSB7XHJcbiAgICByZXR1cm4gc3RyLmxlbmd0aCA+IG1heExlbiA/XHJcbiAgICAgICAgc3RyLnN1YnN0cigwLCBtYXhMZW4gLSAzKSArIFwiLi4uXCIgOlxyXG4gICAgICAgIHN0cjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5VG9Mb29rdXA8VD4oYTogVFtdLCBrZXlBY2Nlc3NvcjogKGl0ZW06IFQpID0+IHN0cmluZyB8IG51bWJlcikge1xyXG4gICAgY29uc3QgcmVzdWx0IDoge1trZXk6IHN0cmluZ10gOiBUW119ID0ge307XHJcbiAgICBmb3IgKGxldCBpPTAsIGw9YS5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XHJcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5QWNjZXNzb3IoaXRlbSk7XHJcbiAgICAgICAgbGV0IGFycmF5ID0gcmVzdWx0W2tleV07XHJcbiAgICAgICAgaWYgKGFycmF5KSBhcnJheS5wdXNoKGl0ZW0pO1xyXG4gICAgICAgIGVsc2UgcmVzdWx0W2tleV0gPSBbaXRlbV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb01hcDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICBjb25zdCByZXN1bHQgOiB7W2tleTogc3RyaW5nXSA6IFR9ID0ge307XHJcbiAgICBmb3IgKGxldCBpPTAsIGw9YS5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbSA9IGFbaV07XHJcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5QWNjZXNzb3IoaXRlbSk7XHJcbiAgICAgICAgcmVzdWx0W2tleV0gPSBpdGVtO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNoZXJyeVBpY2tQcm9wczxUPiAob2JqOiBULCBwcm9wc1RvUGljazogc3RyaW5nW10pOiBQYXJ0aWFsPFQ+IHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gICAgZm9yIChjb25zdCBwYXJhbSBvZiBwcm9wc1RvUGljaykge1xyXG4gICAgICBpZiAocGFyYW0gaW4gb2JqKSByZXN1bHRbcGFyYW1dID0gb2JqW3BhcmFtXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQgYXMgUGFydGlhbDxUPjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RpbmN0PFQ+IChhOiBUW10sIGtleUFjY2Vzc29yPzogKGl0ZW06IFQpID0+IGFueSkge1xyXG4gICAgY29uc3QgbWFwID0gYXJyYXlUb01hcChhLCBrZXlBY2Nlc3NvciB8fCAoeCA9PiB4KSk7XHJcbiAgICByZXR1cm4gT2JqZWN0LmtleXMobWFwKS5tYXAoa2V5ID0+IG1hcFtrZXldKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNoYWxsb3dFcXVhbHMoYTogYW55LCBiOiBhbnkpIHtcclxuICAgIGlmIChhID09PSBiKSByZXR1cm4gdHJ1ZTtcclxuICAgIGlmICghYSB8fCAhYikgcmV0dXJuIGZhbHNlO1xyXG4gICAgaWYgKHR5cGVvZiBhICE9PSAnb2JqZWN0JyB8fCB0eXBlb2YgYiAhPT0gJ29iamVjdCcpIHJldHVybiBmYWxzZTtcclxuICAgIGNvbnN0IGtleXNBID0gT2JqZWN0LmtleXMoYSk7XHJcbiAgICBjb25zdCBrZXlzQiA9IE9iamVjdC5rZXlzKGIpO1xyXG4gICAgaWYgKGtleXNBLmxlbmd0aCAhPT0ga2V5c0IubGVuZ3RoKSByZXR1cm4gZmFsc2U7XHJcbiAgICBmb3IgKGxldCBpPTAsIGw9a2V5c0EubGVuZ3RoOyBpPGw7ICsraSkge1xyXG4gICAgICAgIGNvbnN0IGtleSA9IGtleXNBW2ldO1xyXG4gICAgICAgIGlmIChrZXlzQltpXSAhPT0ga2V5KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKGFba2V5XSAhPT0gYltrZXldKSByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG4iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCIvKiAoaWdub3JlZCkgKi8iLCJtb2R1bGUuZXhwb3J0cyA9IGpRdWVyeTsiLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3RET007Il0sInNvdXJjZVJvb3QiOiIifQ==