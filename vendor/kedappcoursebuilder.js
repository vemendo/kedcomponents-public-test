var kedappcoursebuilder =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"kedappcoursebuilder": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/elements/KEDAppCourseBuilder/webpack-entry.ts","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "../kedbackend/KED.Backend.API/schema.json":
/*!*************************************************!*\
  !*** ../kedbackend/KED.Backend.API/schema.json ***!
  \*************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"autoDelete":true,"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "../kedbackend/client.js":
/*!*******************************!*\
  !*** ../kedbackend/client.js ***!
  \*******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "../kedbackend/clientweb.js":
/*!**********************************!*\
  !*** ../kedbackend/clientweb.js ***!
  \**********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "../kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!****************************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \****************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \************************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \****************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "../kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \*********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \*****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \************************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "../kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "../kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \**************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \*****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \************************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!***************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \***************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \****************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
function mergeDeltas(delta1, delta2) {
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_2 = metaInstructions; _a < metaInstructions_2.length; _a++) {
                    var mi = metaInstructions_2[_a];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \**********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "../kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \**************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "../kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return options && options.includeDeltaEdges ?
            hef.addFlags("includeDeltaEdges") :
            hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return options && options.includeDeltaEdges ?
            het.addFlags("includeDeltaEdges") :
            het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (id, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                deltaDoc: changes
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedId) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedId ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedId; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedId ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedId; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \********************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");






var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
    }
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!****************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \****************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!**********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \**********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "../kedbackend/js/dist/js/observable/index.js");






var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] }
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \*******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \**************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \**********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \************************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/collection.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/collection.js ***!
  \*********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/emitter.js":
/*!******************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/emitter.js ***!
  \******************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/index.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/index.js ***!
  \****************************************************/
/*! exports provided: Observable, Value, Collection, Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });





//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/map.js":
/*!**************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/map.js ***!
  \**************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/mixin.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/mixin.js ***!
  \****************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/observable.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/observable.js ***!
  \*********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/value.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/value.js ***!
  \****************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");




var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "../kedbackend/repo.js":
/*!*****************************!*\
  !*** ../kedbackend/repo.js ***!
  \*****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) { // check for number or string
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return id;
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = ["user", "role", "school", "debug", "testVersion", "testversion", "schoolType", "schooltype"];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");





var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        this.getActiveCourses = avoidSimultanousCalls(this.getActiveCourses);
        this.getLatestAssessments = avoidSimultanousCalls(this.getLatestAssessments);
        this.getStudentGoals = avoidSimultanousCalls(this.getStudentGoals);
        this.getStudentFutureAbilities = avoidSimultanousCalls(this.getStudentFutureAbilities);
        this.getTeacherTutorStudents = avoidSimultanousCalls(this.getTeacherTutorStudents);
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/courses/business-logic.ts":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/business-logic.ts ***!
  \*****************************************************************/
/*! exports provided: getUncoveredKnowledgeRequirements, getIdsNotCoveredByTasks, getIdsNotCoveredByReqReferencingDocs, sanityCheck, getTasksPerId */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUncoveredKnowledgeRequirements", function() { return getUncoveredKnowledgeRequirements; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByTasks", function() { return getIdsNotCoveredByTasks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getIdsNotCoveredByReqReferencingDocs", function() { return getIdsNotCoveredByReqReferencingDocs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sanityCheck", function() { return sanityCheck; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTasksPerId", function() { return getTasksPerId; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");


function getUncoveredKnowledgeRequirements(course) {
    var uncoveredRequirements = course.knowledgeRequirements.reduce(function (result, item) {
        result[item.id] = item;
        return result;
    }, {});
    course.tasks.forEach(function (task) {
        task.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredRequirements[kr.id];
        });
    });
    return Object.keys(uncoveredRequirements).map(function (id) { return uncoveredRequirements[id]; });
}
function getIdsNotCoveredByTasks(course) {
    return getIdsNotCoveredByReqReferencingDocs([course], course.tasks);
}
function getIdsNotCoveredByReqReferencingDocs(templates, docsBeingChecked) {
    var uncoveredIds = {};
    // 1. Mark the ids of all knowledge requirements, abilities and central content for this course:
    templates.forEach(function (course) {
        course.knowledgeRequirements.forEach(function (r) {
            uncoveredIds[r.id] = true;
        });
        course.abilities.forEach(function (a) {
            uncoveredIds[a.id] = true;
        });
        course.centralContent.forEach(function (cc) {
            uncoveredIds[cc.id] = true;
        });
    });
    // 2. List all tasks and unmark all ids that they refer to
    docsBeingChecked.forEach(function (doc) {
        doc.knowledgeRequirements.forEach(function (kr) {
            delete uncoveredIds[kr.id];
        });
        doc.abilities.forEach(function (a) {
            delete uncoveredIds[a.id];
        });
        doc.centralContent.forEach(function (cc) {
            delete uncoveredIds[cc.id];
        });
    });
    return uncoveredIds;
}
function sanityCheck(course) {
    function hasDuplicateTasks(course) {
        var taskIds = {};
        return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])(course.modules.map(function (module) { return module.taskIds.map(function (taskId) {
            if (taskIds[taskId]) {
                var task = course.tasks.find(function (t) { return t.id === taskId; });
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""], ["Samma uppgift f\u00F6rekommer flera g\u00E5nger: \"", "\""])), task.name);
            }
            taskIds[taskId] = true;
        }).filter(function (x) { return x; }); }));
    }
    function tasksWithSameUrl(course) {
        var taskUrls = {};
        return course.tasks.map(function (task) {
            if (task.url) {
                if (taskUrls[task.url]) {
                    return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""], ["Tv\u00E5 uppgifter pekar p\u00E5 samma URL: \"", "\" samt \"", "\""])), taskUrls[task.url].name, task.name);
                }
                taskUrls[task.url] = task;
            }
        }).filter(function (x) { return x; });
    }
    function hasEmptyModuleNames(course) {
        return course.modules.some(function (module) { return module.name === ""; }) && Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Det finns minst en modul utan angivet namn"], ["Det finns minst en modul utan angivet namn"])));
    }
    function hasDuplicateModuleNames(course) {
        var moduleNames = {};
        return course.modules.map(function (module) {
            if (module.name && moduleNames[module.name]) {
                return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"], ["Modulen med namn ", " f\u00F6rekommer flera g\u00E5nger"])), module.name);
            }
            if (module.name)
                moduleNames[module.name] = true;
        });
    }
    var checks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["flatten"])([
        hasDuplicateTasks(course),
        tasksWithSameUrl(course),
        hasEmptyModuleNames(course),
        hasDuplicateModuleNames(course)
    ]);
    return checks.filter(function (result) { return result; });
}
function getTasksPerId(course) {
    var result = {};
    function add(id, task) {
        var list = result[id] || (result[id] = []);
        list.push(task);
    }
    course.tasks.forEach(function (task) {
        task.abilities.forEach(function (a) { return add(a.id, task); });
        task.centralContent.forEach(function (c) { return add(c.id, task); });
        task.futureAbilities.forEach(function (fa) { return add(fa, task); });
    });
    return result;
}
var templateObject_1, templateObject_2, templateObject_3, templateObject_4;


/***/ }),

/***/ "./src/components/course-builder/courses/course-banner.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/course-banner.tsx ***!
  \*****************************************************************/
/*! exports provided: setCourseImage, CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setCourseImage", function() { return setCourseImage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");







var AdminMenuItems = [
    { name: "schools", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolor"], ["Skolor"]))), route: "/schools" },
    { name: "subjects", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnen"], ["\u00C4mnen"]))), route: "/subjects" },
];
var NonAdminMenuItems = [
    { name: "courseBuilder", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursbyggaren"], ["Kursbyggaren"]))), route: "/courses/new" },
    { name: "studentPage", text: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Elevsida"], ["Elevsida"]))), route: "" },
    { name: "feedback", text: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-commenting-o", "aria-hidden": "true" }),
            " Feedback"), route: "https://kg.kunskapsporten.se/kursbyggaren/" }
];
function onDropImage(ev, host, course, origCourse) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var files, url, items, file, form, res, _loop_1, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    ev.stopPropagation();
                    ev.preventDefault();
                    files = ev.dataTransfer.files;
                    url = null;
                    items = Array.from(ev.dataTransfer.items);
                    if (!(files.length > 0)) return [3 /*break*/, 3];
                    file = files[0];
                    if (file.size > 2 * 1024 * 1024) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"], ["Kan inte ladda upp bilder st\u00F6rre \u00E4n 2 MB"]))));
                        return [2 /*return*/];
                    }
                    form = new FormData();
                    form.append("files", file);
                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].kedBackendClient.http.fetch('web-upload', 'put', {}, {}, {
                            body: form
                        })];
                case 1:
                    res = _a.sent();
                    if (res.status !== 200) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte ladda upp filen till Google Storage"], ["Kunde inte ladda upp filen till Google Storage"]))));
                        return [2 /*return*/];
                    }
                    return [4 /*yield*/, res.text()];
                case 2:
                    url = _a.sent();
                    return [3 /*break*/, 7];
                case 3:
                    _loop_1 = function (i) {
                        var item;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    item = items[i];
                                    if (!item.type.match('^text/uri-list')) return [3 /*break*/, 2];
                                    return [4 /*yield*/, new Promise(function (resolve) { return item.getAsString(resolve); })];
                                case 1:
                                    // URI
                                    url = _a.sent();
                                    _a.label = 2;
                                case 2: return [2 /*return*/];
                            }
                        });
                    };
                    i = 0;
                    _a.label = 4;
                case 4:
                    if (!(i < items.length)) return [3 /*break*/, 7];
                    return [5 /*yield**/, _loop_1(i)];
                case 5:
                    _a.sent();
                    _a.label = 6;
                case 6:
                    ++i;
                    return [3 /*break*/, 4];
                case 7:
                    if (url == null) {
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_4__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"], ["Kunde inte hitta n\u00E5gon bild i inneh\u00E5llet"]))));
                        return [2 /*return*/];
                    }
                    setCourseImage(course, origCourse, host, url);
                    return [2 /*return*/];
            }
        });
    });
}
function setCourseImage(course, origCourse, host, url) {
    var imageId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
    host.update({
        imageId: { $set: imageId },
        images: {
            $set: [{
                    id: imageId,
                    url: url,
                    acl: [
                        "role:USER:R",
                        "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.school + "/EMPLOYEE:S"
                    ],
                    $meta: 'add'
                }]
        }
    });
}
/* This version had the bug that old images were not replaced.
One course at Uppsala contained 12 images.


export function setCourseImageOld(
  course: Course,
  origCourse: Course,
  host: ICourseEditorHost,
  url: string)
{
  if (!origCourse || !origCourse.imageId) {
    const imageId = createUUID();
    host.update({
      imageId: { $set: imageId },
      images: {
        $push: [{
          id: imageId,
          url,
          acl: course.isTemplate ? ["role:USER:R"] : ["role:USER:R", `schoolRole:${env.currentUser.school}/EMPLOYEE:S`],
          $meta: 'add'
        }]
      }
    });
  } else {
    // Update existing image:
    const imgIdx = course.images.findIndex(img => img.id === course.imageId);
    if (imgIdx >= 0) {
      const imageEntity = course.images[imgIdx];
      if (course.isTemplate) {
        // Templates: Update the template image content:
        host.update({
          images: {
            $splice: [[imgIdx, 1, {
              ...imageEntity,
              url,
              $meta: 'update'
            }]]
          }
        })
      } else {
        // Real courses: Replace with a new image
        const imageId = createUUID();
        host.update({
          imageId: { $set: imageId },
          images: {
            $splice: [[imgIdx, 1, {
              id: imageId,
              url,
              acl: [
                `role:USER:R`,
                `schoolRole:${env.currentUser.school}/EMPLOYEE:S`
              ],
              $meta: 'add'
            }]]
          }
        })
      }
    } else {
      showError(L`Kunde inte uppdatera bilden.`);
    }
  }
}
*/
var CourseBanner = function (props) {
    var title = props.title, isTemplate = props.isTemplate, host = props.host, course = props.course, origCourse = props.origCourse, backgroundImage = props.backgroundImage, activePage = props.activePage;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_6__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    var menuItems = NonAdminMenuItems;
    if (isAdmin)
        menuItems = AdminMenuItems.concat(menuItems);
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pageHeader", onDragOver: course && _utils__WEBPACK_IMPORTED_MODULE_3__["allowCopy"], onDrop: course && (function (ev) { return onDropImage(ev, host, course, origCourse); }) },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, menuItems.map(function (item) { return ({
                                    item: item,
                                    isActive: activePage === item.name,
                                    callback: props.callbacks && props.callbacks[item.name],
                                    givenRoute: (props.routes && props.routes[item.name]),
                                    defaultRoute: item.route
                                }); }).filter(function (x) { return x.callback || x.defaultRoute || x.givenRoute; }).map(function (_a) {
                                    var item = _a.item, isActive = _a.isActive, callback = _a.callback, defaultRoute = _a.defaultRoute, givenRoute = _a.givenRoute;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: item.name, className: isActive ? "activePage" : "", onClick: callback }, callback ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text) :
                                        defaultRoute || givenRoute ?
                                            givenRoute || /^http[s]\:\/\//i.test(defaultRoute) ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: givenRoute || defaultRoute }, item.text) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_2__["Link"], { to: defaultRoute }, item.text) :
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", null, item.text));
                                })))))))));
};
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7;


/***/ }),

/***/ "./src/components/course-builder/courses/course-module-list.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/courses/course-module-list.tsx ***!
  \**********************************************************************/
/*! exports provided: CourseModuleList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModuleList", function() { return CourseModuleList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _course_module__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./course-module */ "./src/components/course-builder/courses/course-module.tsx");





var CourseModuleList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModuleList, _super);
    function CourseModuleList(props) {
        var _this = _super.call(this, props) || this;
        _this._moduleRefs = {};
        _this.state = {};
        return _this;
    }
    CourseModuleList.prototype.addModule = function () {
        this.props.host.update({ modules: { $push: [{
                        name: "Ny kursmodul",
                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                        resources: [],
                        taskIds: []
                    }
                ] } });
    };
    CourseModuleList.prototype.getOrderedModules = function () {
        var course = this.props.course;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        return moduleOrder
            // Map ordered id to module
            .map(function (id) { return course.modules.find(function (m) { return m.id === id; }); })
            // Ignore entries that only exists in moduleOrder but not in modules
            .filter(function (m) { return !!m; })
            // Append modules at end that are not listed in moduleOrder
            .concat(course.modules.filter(function (m) { return !moduleOrder.find(function (id) { return m.id === id; }); }));
    };
    CourseModuleList.prototype.reorder = function (moduleId, direction) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var course, orderedModules, moduleIndex, newModuleIndex, currentModuleAtPosition, moduleOrder, origScrollPos, elemModule;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        course = this.props.course;
                        orderedModules = this.getOrderedModules();
                        moduleIndex = orderedModules.findIndex(function (m) { return m.id === moduleId; });
                        newModuleIndex = moduleIndex + direction;
                        if (newModuleIndex < 0 || newModuleIndex >= orderedModules.length) {
                            // Cannot order outside limits.
                            return [2 /*return*/];
                        }
                        currentModuleAtPosition = orderedModules[newModuleIndex];
                        moduleOrder = orderedModules.map(function (m) { return m.id; });
                        moduleOrder[newModuleIndex] = moduleId;
                        moduleOrder[moduleIndex] = currentModuleAtPosition.id;
                        origScrollPos = document.documentElement.scrollTop;
                        return [4 /*yield*/, this.props.host.update({
                                moduleOrder: { $set: moduleOrder }
                            })];
                    case 1:
                        _a.sent();
                        elemModule = Object(react_dom__WEBPACK_IMPORTED_MODULE_2__["findDOMNode"])(this._moduleRefs[moduleId]);
                        if (elemModule) {
                            try {
                                window.scrollTo({ top: origScrollPos }); // Prohibit default scrolling directly upwards on move up.
                                elemModule.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                            catch (e) {
                                // Only Chrome beta supports the arguments given above. Default for older browsers.
                                window.scrollTo(null, origScrollPos);
                                elemModule.scrollIntoView(true);
                            }
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    CourseModuleList.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, host = _a.host, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        var orderedModules = this.getOrderedModules();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet", ref: function (elem) { return _this._elem = elem; } },
            orderedModules.map(function (module) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module__WEBPACK_IMPORTED_MODULE_4__["CourseModuleComponent"], { ref: function (elem) { return _this._moduleRefs[module.id] = elem; }, key: module.id, course: course, module: module, onReorder: function (direction) { return _this.reorder(module.id, direction); }, getOrderedModules: function () { return _this.getOrderedModules(); }, host: host, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask }); }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large", onClick: function () { return _this.addModule(); } }, "L\u00E4gg till kursmodul"));
    };
    return CourseModuleList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/courses/course-module.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/courses/course-module.tsx ***!
  \*****************************************************************/
/*! exports provided: CourseModuleComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModuleComponent", function() { return CourseModuleComponent; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _sub_components_editable_task_list__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sub-components/editable-task-list */ "./src/components/course-builder/sub-components/editable-task-list.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _utility_components_renameable_text__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utility-components/renameable-text */ "./src/components/utility-components/renameable-text.tsx");
/* harmony import */ var _sub_components_remove_item__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../utility-components/wysiwyg */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");










var DEFAULT_KNOWLEDGE_MATRIX = [{
        abilityIds: [],
        EIds: [],
        CIds: [],
        AIds: []
    }];
var CourseModuleComponent = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModuleComponent, _super);
    function CourseModuleComponent(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            editMandatoryContent: false
        };
        return _this;
    }
    CourseModuleComponent.prototype.getModuleIndex = function () {
        var _a = this.props, course = _a.course, module = _a.module;
        return course.modules.findIndex(function (m) { return m.id === module.id; });
    };
    CourseModuleComponent.prototype.getModuleOrderIndex = function () {
        var _a = this.props, course = _a.course, module = _a.module;
        var orderedModules = this.props.getOrderedModules();
        return orderedModules.findIndex(function (m) { return m.id === module.id; });
    };
    CourseModuleComponent.prototype.updateModule = function (moduleUpdates) {
        var module = this.props.module;
        var updatedModule = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(module, moduleUpdates);
        var moduleIndex = this.getModuleIndex();
        this.props.host.update({ modules: { $splice: [[moduleIndex, 1, updatedModule]] } });
    };
    /* This method works for both adding new tasks to the task table
    and adding references to existing tasks. The magic of that has to do with
    whether task.$meta = 'add' or not and is done in EditCourse.save()
    */
    CourseModuleComponent.prototype.onTaskAdded = function (task, taskCustomization) {
        // Add task ID to module taskIds list:
        var courseUpdates = {};
        var taskIds = this.props.module.taskIds.slice();
        taskIds.push(task.id);
        // Add physical Task to Course.tasks.
        if (!this.props.course.tasks.some(function (t) { return t.id === task.id; })) {
            courseUpdates.tasks = { $push: [task] };
        }
        var customizations = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, (this.props.module.taskCustomizations || {}));
        if (taskCustomization)
            customizations[task.id] = taskCustomization;
        var moduleIndex = this.getModuleIndex();
        courseUpdates.modules = {};
        courseUpdates.modules[moduleIndex] = {
            taskIds: { $set: taskIds },
            taskCustomizations: { $set: customizations }
        };
        // Update module
        this.props.host.update(courseUpdates);
    };
    CourseModuleComponent.prototype.onTaskUpdated = function (task) {
        if (!task.$meta)
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Hoppsan, blev lite knas. Fel ID: ", ""], ["Hoppsan, blev lite knas. Fel ID: ", ""])), 'Pa7Dq'));
        var taskIndex = this.props.course.tasks.findIndex(function (t) { return t.id === task.id; });
        if (taskIndex >= 0) {
            this.props.host.update({ tasks: { $splice: [[taskIndex, 1, task]] } });
        }
    };
    CourseModuleComponent.prototype.onTaskCustomized = function (taskId, customization) {
        var customizations = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, (this.props.module.taskCustomizations || {}));
        customizations[taskId] = customization;
        this.updateModule({ taskCustomizations: { $set: customizations } });
    };
    CourseModuleComponent.prototype.onTaskDeleted = function (id) {
        // Remove task ID from module taskIds list.
        // This depends on the fact that EditCourse._setState() maintains
        // removed Task links (which it actually does (or should do at least)).
        this.updateModule({
            taskIds: { $set: this.props.module.taskIds.filter(function (tid) { return tid !== id; }) },
            taskCustomizations: {
                $apply: function (customizations) {
                    var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, customizations);
                    delete copy[id];
                    return copy;
                }
            }
        });
    };
    CourseModuleComponent.prototype.onTaskReplaced = function (id, task) {
        var idxTask = this.props.module.taskIds.indexOf(id);
        if (idxTask < 0) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["showError"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde inte spara uppgift. Felkod d72kQ"], ["Kunde inte spara uppgift. Felkod d72kQ"]))));
            return;
        }
        var moduleUpdates = {
            // Replace old id with new id:
            taskIds: { $splice: [[idxTask, 1, task.id]] },
            taskCustomizations: {
                $apply: function (customizations) {
                    var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, customizations);
                    delete copy[id];
                    return copy;
                }
            }
        };
        var updatedModule = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(this.props.module, moduleUpdates);
        var moduleIndex = this.getModuleIndex();
        this.props.host.update({
            // Apply moduleUpdates from above:
            modules: { $splice: [[moduleIndex, 1, updatedModule]] },
            // Add the new task to Course.tasks.
            // Don't remove the old one! Why? Because it may be referenced
            // by another module in same course! Let EditCourse._setState()
            // do the "garbage collection" instead.
            tasks: { $set: this.props.course.tasks.concat(task) }
        });
    };
    CourseModuleComponent.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, host = _a.host, module = _a.module, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
        var moduleIndex = this.getModuleIndex();
        var moduleOrderedIndex = this.getModuleOrderIndex();
        var knowledgeMatrixDiv;
        var updateModule = this.updateModule.bind(this);
        var week = 1;
        var startWeekOptions = ["--"];
        var endWeekOptions = ["--"];
        for (var i = 0; i < 51; ++i) {
            startWeekOptions.push('' + week);
            endWeekOptions.push('' + ++week);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-module ked_boxed", style: { position: 'relative' } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_renameable_text__WEBPACK_IMPORTED_MODULE_5__["RenameableText"], { eager: true, clickAdvertiseText: "Namnl\u00F6s modul", maxChars: 100, text: module.name, onChange: function (newName) { return updateModule({ name: { $set: newName } }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Startvecka")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: module.startWeek || "--", onChange: function (ev) { return updateModule({ startWeek: {
                                $set: ev.target.value === '--' ?
                                    undefined :
                                    parseInt(ev.target.value)
                            }
                        }); } }, startWeekOptions.map(function (o) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: o, value: o }, o); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Slutvecka")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem center" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: module.endWeek || "--", onChange: function (ev) { return updateModule({ endWeek: {
                                $set: ev.target.value === '--' ?
                                    undefined :
                                    parseInt(ev.target.value)
                            }
                        }); } }, endWeekOptions.map(function (o) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: o, value: o }, o); })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Kursmodulens introduktion"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_8__["Wysiwyg"], { actions: [
                    "bold",
                    "italic",
                    "underline",
                    "strikethrough",
                    "heading2",
                    "heading3",
                    "olist",
                    "ulist",
                    "line",
                    "link",
                    "image"
                ], defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_9__["default"], html: module.mandatoryContent, onChange: function (html) {
                    updateModule({ mandatoryContent: { $set: html } });
                } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Uppgifter"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_task_list__WEBPACK_IMPORTED_MODULE_3__["EditableTaskList"], { taskIds: module.taskIds, taskCustomizations: module.taskCustomizations, course: course, module: module, host: host, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask, onTaskAdded: function (task, taskCustomization) { return _this.onTaskAdded(task, taskCustomization); }, onTaskUpdated: function (task) { return _this.onTaskUpdated(task); }, onTaskCustomizationUpdated: function (taskId, customization) {
                    return _this.onTaskCustomized(taskId, customization);
                }, onTaskDeleted: function (id) { return _this.onTaskDeleted(id); }, onTaskReplaced: function (id, task) { return _this.onTaskReplaced(id, task); } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Modulresurser"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Eventuella resuser f\u00F6r redovisning av modulen samt f\u00F6r modulen som helhet)"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: module.resources, onUpdate: function (resourcesUpdates) { return updateModule({ resources: resourcesUpdates }); }, host: host }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { position: 'absolute', top: 0, right: 0 } },
                moduleOrderedIndex > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-up selectable", "aria-hidden": "true", onClick: function () { return _this.props.onReorder(-1); } }),
                    " "),
                moduleOrderedIndex < course.modules.length - 1 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-arrow-circle-down selectable", "aria-hidden": "true", onClick: function () { return _this.props.onReorder(1); } }),
                    " "),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_6__["RemoveItem"], { title: "Ta bort modulen", style: { display: 'inline-block' }, onClick: function () { return confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort modul ", "?"], ["Ta bort modul ", "?"])), module.name)) && host.update({ modules: { $splice: [[moduleIndex, 1]] } }); } })));
    };
    return CourseModuleComponent;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/courses/create-new.tsx":
/*!**************************************************************!*\
  !*** ./src/components/course-builder/courses/create-new.tsx ***!
  \**************************************************************/
/*! exports provided: CreateNewCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CreateNewCourse", function() { return CreateNewCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _sub_components_school_courses__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../sub-components/school-courses */ "./src/components/course-builder/sub-components/school-courses.tsx");








var CreateNewCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CreateNewCourse, _super);
    function CreateNewCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            courseOptions: null,
            selectedTemplateId: "--",
            courses: null,
            selectedCourseId: ""
        };
        return _this;
    }
    CreateNewCourse.prototype.componentDidMount = function () {
        this.load().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
    };
    CreateNewCourse.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subjects, courses, courseOptions;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar kurser");
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("subjects", {
                                tags: ["schoolType:gymnasium"],
                                include: "courseTemplates"
                            })];
                    case 1:
                        subjects = _a.sent();
                        courses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(subjects.map(function (s) { return s.courseTemplates; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        courseOptions = [{ id: "--", name: "--" }].concat(courses);
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        this.setState({ courseOptions: courseOptions });
                        return [2 /*return*/];
                }
            });
        });
    };
    CreateNewCourse.prototype.onSelectCourse = function (id) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var derivedCourses, courseOptions, kedStandardOptions, teacherMade, courses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("courses", { hasEdgesTo: [id] })];
                    case 1:
                        derivedCourses = _a.sent();
                        courseOptions = derivedCourses
                            .filter(function (course) { return course.active; })
                            .map(function (_a) {
                            var id = _a.id, school = _a.school, description = _a.description, createdBy = _a.createdBy, modifiedBy = _a.modifiedBy;
                            if (description)
                                description = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["maxLength"])(description, 80);
                            var descriptionOrAuthor = description ||
                                (createdBy ? createdBy.name + "s version" :
                                    modifiedBy && modifiedBy.name + "s version");
                            return {
                                id: id,
                                name: school === 'standard' ?
                                    description ? "Standard - " + description : "Standard" :
                                    school + " - " + Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["maxLength"])(descriptionOrAuthor, 90),
                                school: school
                            };
                        }).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        kedStandardOptions = courseOptions.filter(function (option) { return option.school === "standard"; });
                        teacherMade = courseOptions.filter(function (option) { return option.school !== "standard"; });
                        courses = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](kedStandardOptions, [
                            { id: id, name: "Tom" }
                        ], teacherMade);
                        this.setState({
                            courses: courses,
                            selectedTemplateId: id,
                            selectedCourseId: courses[0].id
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    CreateNewCourse.prototype.render = function () {
        var _this = this;
        var _a = this.state, courseOptions = _a.courseOptions, selectedTemplateId = _a.selectedTemplateId, courses = _a.courses, selectedCourseId = _a.selectedCourseId;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursbyggaren"], ["Kursbyggaren"]))), activePage: "courseBuilder", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Skapa ny kurs"),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "V\u00E4lj gymnasiekurs :"))),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, !courseOptions ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { disabled: true, value: "" },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", null, "--"))) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: this.state.selectedTemplateId, onChange: function (ev) { return _this.onSelectCourse(ev.target.value).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]); } }, courseOptions.map(function (course) {
                                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: course.id, value: course.id }, course.name);
                                                })))),
                                        courses && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Utg\u00E5 fr\u00E5n version: "))),
                                        courses && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("select", { value: selectedCourseId, onChange: function (ev) { return _this.setState({
                                                        selectedCourseId: ev.target.value
                                                    }); } }, courses.map(function (course) {
                                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("option", { key: course.id, value: course.id }, course.name);
                                                })))),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                        courses && selectedCourseId && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/create-from-template/" + this.state.selectedCourseId, className: "btn btn-large" }, "Skapa"))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_school_courses__WEBPACK_IMPORTED_MODULE_7__["SchoolCourses"], null))))))));
    };
    return CreateNewCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/courses/edit-course.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder/courses/edit-course.tsx ***!
  \***************************************************************/
/*! exports provided: EditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditCourse", function() { return EditCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _inner_edit_course__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./inner-edit-course */ "./src/components/course-builder/courses/inner-edit-course.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _sub_components_remove_item__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var _business_logic__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../repos/school-courses */ "./src/repos/school-courses.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
















var catcher = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_12__["default"].ENVIRONMENT === 'production' ?
    _utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"] : null;
var CONFIRM_NAVIGATE_MESSAGE = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Du har osparat data. V\u00E4lj avbryt och tryck CTRL+S om du vill spara f\u00F6rst."], ["Du har osparat data. V\u00E4lj avbryt och tryck CTRL+S om du vill spara f\u00F6rst."])));
var DEFAULT_STATE = {
    origCourse: null,
    origTemplate: null,
    course: null,
    dialogContainers: [],
    hasUnsavedData: false,
    view: 'courseBuilder'
};
var EditCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditCourse, _super);
    function EditCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, DEFAULT_STATE);
        _this.update = _this.update.bind(_this);
        _this.refDialog = _this.refDialog.bind(_this);
        _this.contentYPos = 0;
        _this.onKeyDown = _this.onKeyDown.bind(_this);
        _this.beforeUnload = _this.beforeUnload.bind(_this);
        _this.onClickPreventUnload = _this.onClickPreventUnload.bind(_this);
        _this.isSaving = false;
        _this.dialogs = [];
        if (props.view)
            _this.state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _this.state, { view: props.view });
        return _this;
    }
    EditCourse.prototype.setStatePromised = function (state) {
        return this._setState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ hasUnsavedData: true }, state));
    };
    EditCourse.prototype.setNonSaveableDataState = function (state) {
        return this._setState(state);
    };
    EditCourse.prototype._setState = function (state) {
        var _this = this;
        if (state.course) {
            {
                //
                // Maintain course task links (remove links to tasks that are not used
                // by any module)
                //
                var _a = state.course, tasks = _a.tasks, modules = _a.modules;
                var usedTaskIds_1 = {};
                modules.forEach(function (module) { return module.taskIds.forEach(function (id) { return usedTaskIds_1[id] = true; }); });
                var filteredCourseTasks = tasks.filter(function (t) { return usedTaskIds_1[t.id]; });
                var modifiedCourse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state.course);
                modifiedCourse.tasks = filteredCourseTasks;
                state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state, { course: modifiedCourse });
            }
        }
        // Invoke our course into state property allCourses so that the
        // right-hand side list of courses gets update immediately with
        // the publishable state of this course.
        var allCourses = state.allCourses || this.state.allCourses;
        var course = state.course || this.state.course;
        if (allCourses) {
            var idxOurCourse = allCourses.findIndex(function (c) { return c.id === _this.props.id; });
            allCourses = react_addons_update__WEBPACK_IMPORTED_MODULE_8___default()(allCourses, { $splice: [[idxOurCourse, 1, course]] });
            state = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, state);
            state.allCourses = allCourses;
        }
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, function () { return state; }, resolve); });
    };
    EditCourse.prototype.componentWillMount = function () {
        this.load().catch(catcher);
        window.addEventListener('keydown', this.onKeyDown);
        window.addEventListener('beforeunload', this.beforeUnload);
        document.body.addEventListener('click', this.onClickPreventUnload);
    };
    EditCourse.prototype.componentWillUnmount = function () {
        window.removeEventListener('keydown', this.onKeyDown);
        window.removeEventListener('beforeunload', this.beforeUnload);
        document.body.removeEventListener('click', this.onClickPreventUnload);
        Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCourseBuilderStatus"])('');
    };
    EditCourse.prototype.componentWillReceiveProps = function (nextProps) {
        if (this.state && this.state.course) {
            if (nextProps.id !== this.props.id || nextProps.templateId !== this.props.templateId) {
                this.setStatePromised(DEFAULT_STATE);
            }
        }
        if (nextProps.view !== this.props.view) {
            this.setNonSaveableDataState({ view: nextProps.view });
        }
    };
    EditCourse.prototype.componentDidUpdate = function (prevProps, prevState) {
        if (this.contentDiv) {
            var contentDiv = Object(react_dom__WEBPACK_IMPORTED_MODULE_2__["findDOMNode"])(this.contentDiv);
            if (contentDiv) {
                this.contentYPos = contentDiv.getBoundingClientRect().top;
            }
        }
        if (prevState && prevState.course) {
            // This was not the initial update.
            // If props have been updated to point out another course or template, reset component:
            if (this.props.id !== prevProps.id || this.props.templateId !== prevProps.templateId) {
                this.load().catch(catcher);
            }
        }
        if (!prevState.hasUnsavedData && this.state.hasUnsavedData) {
            Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCourseBuilderStatus"])('unsaved');
        }
    };
    EditCourse.prototype.loadFromTemplate = function (templateId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var template, course, mySchool;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar data från mall...");
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_9__["loadCourse"])(templateId, { includeTemplateChain: true })];
                    case 1:
                        template = _a.sent();
                        course = Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCreationStamp"])(Date.now(), template, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser);
                        course.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])();
                        course.parentId = templateId;
                        course.active = false;
                        course.isTemplate = false;
                        course.templateChain = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](course.templateChain);
                        course.templateChain.push({ id: templateId, $meta: 'ref' });
                        mySchool = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.school;
                        course.school = mySchool;
                        course.description = "";
                        course.responsibleTeachers = [];
                        course.acl = [
                            "role:USER:R",
                            "schoolRole:" + mySchool + "/EMPLOYEE:S" // Other teachers at same school should be able to modify the course.
                        ];
                        delete course.$etag;
                        delete course.createdBy;
                        delete course.createdDate;
                        delete course.modifiedBy;
                        delete course.modifiedDate;
                        delete course.activatedBy;
                        delete course.activatedDate;
                        delete course.googleClassRoomCode;
                        delete course.googleClassRoomURL;
                        return [4 /*yield*/, this.setStatePromised({ course: course, origCourse: null, origTemplate: template })];
                    case 2:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCourseBuilderStatus"])('');
                        if (!this.props.id) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadExistingCourse(this.props.id)];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 5];
                    case 2:
                        if (!this.props.templateId) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.loadFromTemplate(this.props.templateId)];
                    case 3:
                        _a.sent();
                        return [3 /*break*/, 5];
                    case 4: throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ogiltig parameter. id eller templateId m\u00E5ste anges"], ["Ogiltig parameter. id eller templateId m\u00E5ste anges"]))));
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.loadExistingCourse = function (courseId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var course;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Laddar kurs");
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_9__["loadCourse"])(courseId)];
                    case 1:
                        course = _a.sent();
                        if (!course.responsibleTeachers)
                            course.responsibleTeachers = [];
                        return [4 /*yield*/, this.setNonSaveableDataState({ course: course, origCourse: course })];
                    case 2:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.update = function (courseUpdates) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.setStatePromised({ course: react_addons_update__WEBPACK_IMPORTED_MODULE_8___default()(this.state.course, courseUpdates) })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.deleteCourse = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_1, _a, courseSchool, parentId, courseId, children, br, children_1, children_1_1, childCourse;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("Raderar kursen...");
                        courseSchool = this.state.course.school;
                        parentId = this.state.course.parentId;
                        courseId = this.props.id;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient.list("courses", {
                                hasEdgesTo: [this.props.id]
                            })];
                    case 1:
                        children = _b.sent();
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["BatchRunner"]();
                        try {
                            for (children_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](children), children_1_1 = children_1.next(); !children_1_1.done; children_1_1 = children_1.next()) {
                                childCourse = children_1_1.value;
                                /* CANNOT DO THIS. MAY NOT HAVE ACCESS! if (childCourse.parentId === courseId) {
                                  // Reconnect child with my parent instead, as I will be disappearing...
                                  childCourse.parentId = parentId;
                                  br.put("courses", childCourse);
                                }*/
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (children_1_1 && !children_1_1.done && (_a = children_1.return)) _a.call(children_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        br.delete("courses", courseId);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient.batch(br.mutationRequests)];
                    case 2:
                        _b.sent();
                        if (courseSchool === _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.school) {
                            _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].delete(courseId);
                        }
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        location.hash = "#/courses/new";
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1, errorMessage;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.isSaving)
                            return [2 /*return*/];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, 4, 5]);
                        this.isSaving = true;
                        return [4 /*yield*/, this._save()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 5];
                    case 3:
                        err_1 = _a.sent();
                        errorMessage = err_1 && err_1.message ? err_1.message : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ett ok\u00E4nt fel har intr\u00E4ffat..."], ["Ett ok\u00E4nt fel har intr\u00E4ffat..."])));
                        if (err_1) {
                            if (err_1.name === 'http409' || err_1.name === 'http412' || err_1.name === 'http404') {
                                // Conflict. Show a nicer error message:
                                errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursen har redigerad av annan anv\u00E4ndare. Ladda om sidan och g\u00F6r om \u00E4ndrinarna."], ["Kursen har redigerad av annan anv\u00E4ndare. Ladda om sidan och g\u00F6r om \u00E4ndrinarna."])));
                            }
                            else if (err_1.name === 'http403') {
                                if (this.state.course.isTemplate)
                                    errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ingen beh\u00F6righet att spara kursmallen. Endast administrat\u00F6rer kan redigera kursmallar."], ["Ingen beh\u00F6righet att spara kursmallen. Endast administrat\u00F6rer kan redigera kursmallar."])));
                                else if (this.state.course.school)
                                    errorMessage = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ingen beh\u00F6righet att spara kursen ", ". Kursen kan bara redigeras av anst\u00E4llda p\u00E5 ", ""], ["Ingen beh\u00F6righet att spara kursen ", ". Kursen kan bara redigeras av anst\u00E4llda p\u00E5 ", ""])), this.state.course.name, this.state.course.school);
                            }
                        }
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(errorMessage);
                        Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCourseBuilderStatus"])('error');
                        return [3 /*break*/, 5];
                    case 4:
                        this.isSaving = false;
                        return [7 /*endfinally*/];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, course, origCourse, origTemplate, doesAllTasksCoverAllRequirements, modifiedCourse, batch, orig, newCourseTasks, tags, schoolId, schoolId, schoolId, res;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, course = _a.course, origCourse = _a.origCourse, origTemplate = _a.origTemplate;
                        doesAllTasksCoverAllRequirements = Object(_business_logic__WEBPACK_IMPORTED_MODULE_11__["getUncoveredKnowledgeRequirements"])(course).length === 0;
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateModificationStamp"])(Date.now(), course, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser);
                        batch = new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["BatchRunner"]();
                        orig = origCourse || origTemplate;
                        newCourseTasks = modifiedCourse.tasks.map(function (task) {
                            if (task.$meta === 'add' || task.$meta === 'update') {
                                var origTask = orig.tasks.find(function (t) { return t.id === task.id; });
                                return Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateDocumentGraphs"])(origTask || {}, task, "tasks", {
                                    knowledgeRequirements: 'knowledge-requirements',
                                    centralContent: 'central-content',
                                    abilities: 'abilities'
                                }, batch);
                            }
                            else {
                                var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                                delete updatedTask.$meta;
                                return updatedTask;
                            }
                        });
                        modifiedCourse = react_addons_update__WEBPACK_IMPORTED_MODULE_8___default()(modifiedCourse, { tasks: { $set: newCourseTasks } });
                        modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateDocumentGraphs"])(origCourse || {}, modifiedCourse, 'courses', {
                            templateChain: 'courses',
                            centralContent: 'central-content',
                            knowledgeRequirements: 'knowledge-requirements',
                            abilities: 'abilities',
                            images: 'images',
                            tasks: 'tasks'
                        }, batch);
                        modifiedCourse = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, modifiedCourse);
                        modifiedCourse.publishable = doesAllTasksCoverAllRequirements;
                        tags = (modifiedCourse.tags || []).filter(function (tag) { return tag !== 'incomplete'; });
                        modifiedCourse.tags = modifiedCourse.publishable ?
                            tags : tags.concat("incomplete");
                        if (!!origCourse) return [3 /*break*/, 3];
                        // A new course should be added:
                        batch.add('courses', modifiedCourse);
                        if (!course.school) return [3 /*break*/, 2];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 1:
                        schoolId = _b.sent();
                        batch.link("schools", schoolId, "courses", course.id, "courses");
                        if (course.active) {
                            batch.link("schools", schoolId, "courses", course.id, "activeCourses");
                        }
                        _b.label = 2;
                    case 2: return [3 /*break*/, 7];
                    case 3:
                        // An existing course should be updated:
                        batch.put('courses', modifiedCourse);
                        if (!(!origCourse.active && course.active)) return [3 /*break*/, 5];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 4:
                        schoolId = _b.sent();
                        batch.link("schools", schoolId, "courses", course.id, "activeCourses");
                        return [3 /*break*/, 7];
                    case 5:
                        if (!(origCourse.active && !course.active)) return [3 /*break*/, 7];
                        return [4 /*yield*/, _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].getSchoolId()];
                    case 6:
                        schoolId = _b.sent();
                        batch.unlink("schools", schoolId, "courses", course.id, "activeCourses");
                        _b.label = 7;
                    case 7: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient.batch(batch.mutationRequests)];
                    case 8:
                        res = _b.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(origCourse ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4ndringarna har sparats"], ["\u00C4ndringarna har sparats"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_9 || (templateObject_9 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kursen har skapats"], ["Kursen har skapats"]))));
                        // Update state to reflect what has been posted:
                        if (res && res.newEtags)
                            modifiedCourse = Object(_utils__WEBPACK_IMPORTED_MODULE_9__["applyEtags"])(modifiedCourse, res.newEtags, ["images", "tasks"]);
                        if (course.school === _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.school) {
                            // Update mySchoolCoursesRepo
                            if (!origCourse) {
                                _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].insert(modifiedCourse);
                            }
                            else {
                                _repos_school_courses__WEBPACK_IMPORTED_MODULE_14__["mySchoolCoursesRepo"].update(modifiedCourse);
                            }
                        }
                        return [4 /*yield*/, this.setNonSaveableDataState({ course: modifiedCourse, origCourse: modifiedCourse, hasUnsavedData: false })];
                    case 9:
                        _b.sent();
                        Object(_utils__WEBPACK_IMPORTED_MODULE_9__["updateCourseBuilderStatus"])('');
                        if (!origCourse) {
                            // This was the creation of a new course. Correct the route now when the user enters an edit state:
                            location.hash = "#/courses/" + modifiedCourse.id + "/edit";
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    EditCourse.prototype.activateAndSave = function () {
        var _this = this;
        var course = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.course);
        if (!course.active) {
            /*const uncoveredRequirements = getUncoveredKnowledgeRequirements(course);
            if (uncoveredRequirements.length > 0)
              return showError (L`Det finns kunskapskrav som inte uppfylls av någon modul. Kan inte aktivera kursen förrän alla kunskapskrav finns med.`);
            */
            course.active = true;
            course.activatedBy = {
                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.displayName,
                url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail
            };
            course.activatedDate = Date.now();
            this.setStatePromised({ course: course })
                .then(function () { return _this.save(); })
                .catch(catcher);
        }
    };
    EditCourse.prototype.inactivateAndSave = function () {
        var _this = this;
        var course = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.course);
        if (course.active) {
            course.active = false;
            course.inactivatedBy = {
                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.displayName,
                url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail
            };
            course.inactivatedDate = Date.now();
            this.setStatePromised({ course: course })
                .then(function () { return _this.save(); })
                .catch(catcher);
        }
    };
    EditCourse.prototype.openDialog = function (dialogContainer) {
        this.setNonSaveableDataState({ dialogContainers: this.state.dialogContainers.concat(dialogContainer) });
    };
    EditCourse.prototype.closeDialog = function () {
        var dialogContainers = this.state.dialogContainers;
        var length = dialogContainers.length;
        length && this.setNonSaveableDataState({ dialogContainers: dialogContainers.slice(0, length - 1) });
        // Now sync the direct 'dialogs' property with the new state:
        while (this.dialogs.length >= length)
            this.dialogs.pop();
    };
    EditCourse.prototype.refDialog = function (dialog, index) {
        this.dialogs[index] = dialog; // Setting per index instead of push(). Works even if the ref attribute could be invoked multiple times.
    };
    EditCourse.prototype.onKeyDown = function (ev) {
        if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
            ev.preventDefault();
            if (this.state.dialogContainers.length > 0) {
                this.saveDialog();
                return;
            }
            this.save();
        }
        else if (ev.which === 27 && this.state.dialogContainers.length > 0) {
            this.closeDialog();
            ev.preventDefault();
        }
        else if (ev.which === 13) {
            var targetElem = ev.target;
            if (this.state.dialogContainers.length > 0 &&
                targetElem.tagName !== 'TEXTAREA' &&
                targetElem.tagName !== 'INPUT' &&
                targetElem.tagName !== 'SELECT' &&
                targetElem.tagName !== 'OPTION' &&
                !targetElem.contentEditable) {
                this.saveDialog();
            }
        }
    };
    EditCourse.prototype.beforeUnload = function (ev) {
        if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {
            if (!_globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient.http.bearerProvider.wantsRedirect) {
                ev.returnValue = CONFIRM_NAVIGATE_MESSAGE;
                return ev.returnValue;
            }
        }
    };
    EditCourse.prototype.onClickPreventUnload = function (ev) {
        if (ev.target && ('' + ev.target.tagName).toLowerCase() === 'a') {
            var a = ev.target;
            if (a.href && a.getAttribute('href') !== '#' && !a.target) {
                if (this.state.dialogContainers.length > 0 || this.state.hasUnsavedData) {
                    if (!confirm(CONFIRM_NAVIGATE_MESSAGE)) {
                        ev.preventDefault();
                        ev.stopPropagation();
                        return false;
                    }
                }
            }
        }
    };
    EditCourse.prototype.saveDialog = function () {
        if (this.state.dialogContainers.length > 0) {
            var dialog = this.dialogs[this.state.dialogContainers.length - 1]; // YES, should reference this.dialogs by length of dialogContainers. Strange yes, but leave it so!
            dialog && dialog.save();
        }
    };
    EditCourse.prototype.render = function () {
        var _this = this;
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.roles.indexOf("ADMIN") >= 0;
        var course = this.state.course;
        return !this.state.course ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_6__["CourseBanner"], { title: "", activePage: this.state.view, routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_13__["Spinner"], null),
                "V.g. v\u00E4nta medan kursen laddas...")) :
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_6__["CourseBanner"], { title: course.name + " - " + course.points + "p", activePage: this.state.view, routes: {
                        studentPage: Object(_access_control__WEBPACK_IMPORTED_MODULE_15__["preserveImpersonationQuery"])(this.props.viewCourseUrl, { courseId: this.props.id }),
                        feedback: this.props.feedbackUrl
                    }, host: this, course: course, origCourse: this.state.origCourse, backgroundImage: course.images.filter(function (img) { return img.id === course.imageId; }).map(function (img) { return img.url; })[0], isTemplate: course.isTemplate }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer", ref: function (div) { return _this.contentDiv = div; } },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_inner_edit_course__WEBPACK_IMPORTED_MODULE_7__["InnerEditCourse"], { course: this.state.course, origCourse: this.state.origCourse, host: this }),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                                this.state.dialogContainers.map(function (_a, i) {
                                    var Component = _a.Component, props = _a.props;
                                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: i },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ ref: function (dialog) { return _this.refDialog(dialog, i); } }, props)),
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_10__["RemoveItem"], { onClick: function () { return _this.closeDialog(); } }))));
                                }))))));
    };
    return EditCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9;


/***/ }),

/***/ "./src/components/course-builder/courses/index.tsx":
/*!*********************************************************!*\
  !*** ./src/components/course-builder/courses/index.tsx ***!
  \*********************************************************/
/*! exports provided: EditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _edit_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./edit-course */ "./src/components/course-builder/courses/edit-course.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EditCourse", function() { return _edit_course__WEBPACK_IMPORTED_MODULE_0__["EditCourse"]; });




/***/ }),

/***/ "./src/components/course-builder/courses/inner-edit-course.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/courses/inner-edit-course.tsx ***!
  \*********************************************************************/
/*! exports provided: InnerEditCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InnerEditCourse", function() { return InnerEditCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _course_module_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./course-module-list */ "./src/components/course-builder/courses/course-module-list.tsx");
/* harmony import */ var _sub_components_school_courses__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../sub-components/school-courses */ "./src/components/course-builder/sub-components/school-courses.tsx");
/* harmony import */ var _business_logic__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _sub_components_editable_teacher_list__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../sub-components/editable-teacher-list */ "./src/components/course-builder/sub-components/editable-teacher-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _sub_components_weighted_items_table__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/weighted-items-table */ "./src/components/course-builder/sub-components/weighted-items-table.tsx");
/* harmony import */ var _utility_components_wysiwyg_index__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../utility-components/wysiwyg/index */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");
/* harmony import */ var _sub_components_editable_workflow_link__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../sub-components/editable-workflow-link */ "./src/components/course-builder/sub-components/editable-workflow-link.tsx");














;
var InnerEditCourse = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](InnerEditCourse, _super);
    function InnerEditCourse(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            changeImageUrl: false
        };
        return _this;
    }
    InnerEditCourse.prototype.setImageUrl = function (imageUrl) {
        var course = this.props.course;
        if (!course.imageId) {
        }
    };
    InnerEditCourse.prototype.render = function () {
        var _a = this.props, course = _a.course, origCourse = _a.origCourse, host = _a.host;
        var uncoveredKnowledgeRequirements = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["getUncoveredKnowledgeRequirements"])(course);
        var idsNotCoveredByAnyTask = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["getIdsNotCoveredByTasks"])(course);
        var sanityCheckWarnings = Object(_business_logic__WEBPACK_IMPORTED_MODULE_6__["sanityCheck"])(course);
        var courseImage = course.images.find(function (img) { return img.id === course.imageId; });
        var courseImageIsDataUrl = courseImage && courseImage.url.startsWith('data:');
        var courseIsUploaded = courseImage && courseImage.url.indexOf('storage.googleapis.com') > 0;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                    course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, "Kursmall"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kurs\u00F6vergripande"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Kursens bild"),
                            courseImageIsDataUrl ?
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens bild ligger i databasen. F\u00F6r att \u00E4ndra bild m\u00E5ste du dra och sl\u00E4ppa en ny bild ovanp\u00E5 den gamla h\u00F6gst upp p\u00E5 denna sida. Bilden kan antingen vara fr\u00E5n en annan webbsida. Lokala bildfiler g\u00E5r ocks\u00E5 bra att dra och sl\u00E4ppa.")
                                : courseIsUploaded ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens bild ligger i Kunskapsskolans Google moln. F\u00F6r att \u00E4ndra bild m\u00E5ste du dra och sl\u00E4ppa en ny bild ovanp\u00E5 den gamla h\u00F6gst upp p\u00E5 denna sida. Bilden kan antingen vara fr\u00E5n en annan webbsida. Lokala bildfiler g\u00E5r ocks\u00E5 bra att dra och sl\u00E4ppa.") : courseImage ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { value: courseImage.url, style: { width: '100%', height: '30px' }, onChange: function (ev) { return Object(_course_banner__WEBPACK_IMPORTED_MODULE_7__["setCourseImage"])(course, origCourse, host, ev.target.value); } }),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Bilden som visas h\u00F6gst upp h\u00E4mtas fr\u00E5n angiven URL. F\u00F6r att \u00E4ndra bild kan du redigera URL ovan. Ett annat s\u00E4tt att \u00E4ndra bild \u00E4r att dra och sl\u00E4ppa en ny bild \u00F6ver den gamla h\u00F6gst upp p\u00E5 sidan.")) :
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursen saknar egen bild. L\u00E4gg till en bild genom att dra och sl\u00E4ppa en bild p\u00E5 kurs-bannern h\u00F6gst upp p\u00E5 den h\u00E4r sidan."),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                        !course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Beskrivning"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Beskrivning av kursen. F\u00F6r att skilja mellan olika varianter av samma gymnasiekurs)"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "inputTextBox inputTextSmall", value: course.description, onChange: function (ev) { return host.update({ description: { $set: ev.target.value } }); } }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Upptaktstext"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(texten ska visas p\u00E5 kursens upptaktssektion)"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg_index__WEBPACK_IMPORTED_MODULE_11__["Wysiwyg"], { html: course.runUpText, defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_12__["default"], actions: [
                                    "bold",
                                    "italic",
                                    "underline",
                                    "strikethrough",
                                    "heading2",
                                    "heading3",
                                    "olist",
                                    "ulist",
                                    "line",
                                    "link",
                                    "image"
                                ], onChange: function (newHtml) { return host.update({ runUpText: { $set: newHtml } }); } }),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Kursresurser"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Resurser f\u00F6r upptakt och kursen som helhet)"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: course.resources, onUpdate: function (resourcesUpdates) { return host.update({ resources: resourcesUpdates }); }, host: host }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Arbetsg\u00E5ng"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "subHeader" }, "(Eventuell l\u00E4nk till arbetsg\u00E5ng f\u00F6r kursen)"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_workflow_link__WEBPACK_IMPORTED_MODULE_13__["EditableWorkFlowLink"], { url: course.workFlowLink, onUpdate: function (updates) { return host.update({ workFlowLink: updates }); }, host: host }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        !course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Google Classroom"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal spaced" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { placeholder: "Google classroom URL", type: "text", size: 30, value: course.googleClassRoomURL, onChange: function (ev) { return host.update({ googleClassRoomURL: { $set: ev.target.value } }); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { placeholder: "kod", type: "text", size: 8, value: course.googleClassRoomCode, onChange: function (ev) { return host.update({ googleClassRoomCode: { $set: ev.target.value } }); } })))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        !course.isTemplate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_teacher_list__WEBPACK_IMPORTED_MODULE_8__["EditableTeacherList"], { teachers: course.responsibleTeachers, onUpdate: function (teachersUpdate) {
                                    host.update({ responsibleTeachers: teachersUpdate });
                                } }))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet", id: "svid12_6ab4811f15b13c706b43bb47" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { id: "Kursensmoduler" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kursens moduler"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module_list__WEBPACK_IMPORTED_MODULE_4__["CourseModuleList"], { host: host, course: course, idsNotCoveredByAnyTask: idsNotCoveredByAnyTask }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_weighted_items_table__WEBPACK_IMPORTED_MODULE_10__["WeightedItemsTable"], { course: course })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Kursens status"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        course.createdBy && course.createdDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen skapades ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.createdDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.createdBy.name),
                            "."),
                        course.modifiedBy && course.modifiedDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen redigerades senast ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.modifiedDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.modifiedBy.name),
                            "."),
                        course.active ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen \u00E4r ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, "AKTIV"),
                            " sedan ",
                            Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.activatedDate),
                            " av ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.activatedBy.name),
                            ".") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            "Kursen \u00E4r ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, "INAKTIV"),
                            course.inactivatedBy ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                                "sedan ",
                                Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(course.inactivatedDate),
                                " av ",
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, course.inactivatedBy.name),
                                ".") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null, ".")),
                        (uncoveredKnowledgeRequirements.length === 0 ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "markedGreen" }, "Modulernas kunskapskrav t\u00E4cker skolverkets krav f\u00F6r denna kurs") :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "markedRed warning-box" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Modulernas kunskapskrav t\u00E4cker inte skolverkets krav f\u00F6r denna kurs."))),
                        sanityCheckWarnings.map(function (warning) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: warning, className: "markedRed warning-box" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, warning)); }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                        !course.isTemplate && (origCourse ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () {
                                if (confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_9__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Bekr\u00E4fta borttagning av kursen \"", " - ", "\" f\u00F6r skolan ", "\n\nKursen kommar att raderas helt!\n\n\u00C4r du s\u00E4ker?"], ["Bekr\u00E4fta borttagning av kursen \"", " - ", "\" f\u00F6r skolan ", "\\n\\nKursen kommar att raderas helt!\\n\\n\u00C4r du s\u00E4ker?"])), course.name, course.description, course.school)))
                                    host.deleteCourse().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_9__["showError"]);
                            } }, "Ta bort kurs") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return history.go(-1); } }, "Avbryt")),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-large", onClick: function () { return host.save(); } }, "Spara"),
                        course.active ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-info btn-large", onClick: function () { return host.inactivateAndSave(); } }, "Inaktivera och spara") :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn btn-info btn-large", onClick: function () { return host.activateAndSave(); } }, "Aktivera och spara")))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_school_courses__WEBPACK_IMPORTED_MODULE_5__["SchoolCourses"], null)));
    };
    return InnerEditCourse;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/index.tsx":
/*!*************************************************!*\
  !*** ./src/components/course-builder/index.tsx ***!
  \*************************************************/
/*! exports provided: CourseBuilder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBuilder", function() { return CourseBuilder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _schools__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./schools */ "./src/components/course-builder/schools/index.tsx");
/* harmony import */ var _schools_new_school__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./schools/new-school */ "./src/components/course-builder/schools/new-school.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _subjects__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./subjects */ "./src/components/course-builder/subjects/index.tsx");
/* harmony import */ var _courses__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./courses */ "./src/components/course-builder/courses/index.tsx");
/* harmony import */ var _schools_edit_school__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./schools/edit-school */ "./src/components/course-builder/schools/edit-school.tsx");
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _courses_create_new__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./courses/create-new */ "./src/components/course-builder/courses/create-new.tsx");
/* harmony import */ var _utils_keep_session_alive__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/keep-session-alive */ "./src/utils/keep-session-alive.ts");








// Views





// Keep Session Alive

Object(_utils_keep_session_alive__WEBPACK_IMPORTED_MODULE_13__["keepSessionAlive"])();
var CourseBuilder = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseBuilder, _super);
    function CourseBuilder(props) {
        return _super.call(this, props) || this;
    }
    CourseBuilder.prototype.render = function () {
        var _this = this;
        var isAuthorized = _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser.roles.some(function (role) { return role === "ADMIN" || role === "EMPLOYEE"; });
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-builder" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["HashRouter"], null, isAuthorized ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/", render: function (_a) {
                        var match = _a.match;
                        return isAdmin ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools__WEBPACK_IMPORTED_MODULE_5__["Schools"], { viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl }) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_create_new__WEBPACK_IMPORTED_MODULE_12__["CreateNewCourse"], { feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools__WEBPACK_IMPORTED_MODULE_5__["Schools"], { viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/new/gymnasium", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_new_school__WEBPACK_IMPORTED_MODULE_6__["NewSchool"], { type: "gymnasium", feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/new/primary", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_new_school__WEBPACK_IMPORTED_MODULE_6__["NewSchool"], { type: "primary", feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/schools/:id/edit", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_schools_edit_school__WEBPACK_IMPORTED_MODULE_10__["EditSchool"], { id: match.params.id, title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Editera skola"], ["Editera skola"]))), feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/subjects", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects__WEBPACK_IMPORTED_MODULE_8__["Subjects"], { feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/subjects/:id", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects__WEBPACK_IMPORTED_MODULE_8__["ShowSubject"], { id: match.params.id, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { exact: true, path: "/courses/new", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_create_new__WEBPACK_IMPORTED_MODULE_12__["CreateNewCourse"], { feedbackUrl: _this.props.feedbackUrl }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/courses/create-from-template/:templateId", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses__WEBPACK_IMPORTED_MODULE_9__["EditCourse"], { templateId: match.params.templateId, view: "courseBuilder", viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/courses/:id/edit", render: function (_a) {
                        var match = _a.match;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses__WEBPACK_IMPORTED_MODULE_9__["EditCourse"], { id: match.params.id, view: "courseBuilder", viewCourseUrl: _this.props.viewCourseUrl, feedbackUrl: _this.props.feedbackUrl });
                    } })) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_3__["Route"], { path: "/", render: function () { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_11__["CourseBanner"], { title: "Kursbyggaren", activePage: "courseBuilder", routes: { feedback: _this.props.feedbackUrl } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Beh\u00F6righet saknas"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Detta verktyg \u00E4r endast till f\u00F6r anst\u00E4llda p\u00E5 Kunskapsskolan."),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Anv\u00E4ndarattribut"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "ked_boxed", style: { border: "1px solid #eee" } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Attribut"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "V\u00E4rde"))),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, Object.keys(_globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser).map(function (attr) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: attr },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, attr),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, _globals_KED_env__WEBPACK_IMPORTED_MODULE_7__["default"].currentUser[attr])); })))); } }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_4__["ErrorSuccessFeedback"], null));
    };
    return CourseBuilder;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-resource.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-resource.tsx ***!
  \*********************************************************************/
/*! exports provided: EditResource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditResource", function() { return EditResource; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_4__);





var EditResource = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditResource, _super);
    function EditResource(props) {
        var _this = _super.call(this, props) || this;
        _this.state = _this.props.resource || { name: '', url: '' };
        return _this;
    }
    EditResource.prototype.save = function () {
        var resource = this.state;
        if (!valid_url__WEBPACK_IMPORTED_MODULE_4___default.a.isUri(resource.url))
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med exempelvis http:, https: eller mailto:"], ["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med exempelvis http:, https: eller mailto:"])), resource.url));
        this.props.onSave(resource);
    };
    EditResource.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, onSave = _a.onSave, onDelete = _a.onDelete;
        var resource = this.state;
        var isValidUrl = valid_url__WEBPACK_IMPORTED_MODULE_4___default.a.isUri(this.state.url);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Namn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: true, tabIndex: 1, size: 50, value: resource.name, onChange: function (ev) { return _this.setState({ name: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "L\u00E4nk:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top " },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, value: resource.url, onChange: function (ev) { return _this.setState({ url: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                (resource.createdDate || resource.modifiedDate) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    resource.createdDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        "Resursen/L\u00E4nken skapades ",
                        Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(resource.createdDate),
                        " av ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, resource.createdBy.name),
                        "."),
                    resource.modifiedDate && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        "Resursen/L\u00E4nken redigerades senast ",
                        Object(_utils__WEBPACK_IMPORTED_MODULE_3__["dtFormat"])(resource.modifiedDate),
                        " av ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("strong", null, resource.modifiedBy.name),
                        "."),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                onDelete && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () { return onDelete(); } }, "Ta bort resurs/l\u00E4nk"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large" + (isValidUrl ? "" : " btn-inactive"), onClick: isValidUrl && (function () { return onSave(resource); }) }, "Spara")));
    };
    return EditResource;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx":
/*!********************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx ***!
  \********************************************************************************************/
/*! exports provided: BasicEditableTaskFields */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicEditableTaskFields", function() { return BasicEditableTaskFields; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _task_migration_box__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./task-migration-box */ "./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx");





function BasicEditableTaskFields(_a) {
    var task = _a.task, course = _a.course, writeAccess = _a.writeAccess, features = _a.features, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", null,
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("h2", null, "Uppgiftens namn och l\u00E4nk"),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal spaced" },
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Uppgiftens namn:")),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("input", { autoFocus: true, type: "text", size: 35, value: task.name, disabled: !writeAccess, readOnly: !writeAccess, onChange: function (ev) {
                        var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                        newTask.name = ev.target.value;
                        editTask.setStatePromised({ task: newTask });
                    } }))),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal spaced" },
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "URL:")),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("input", { type: "text", size: 35, value: task.url, disabled: !writeAccess, readOnly: !writeAccess, onChange: function (ev) {
                        var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                        newTask.url = ev.target.value;
                        editTask.setStatePromised({ task: newTask });
                    } }))),
        task.migratedTexts && writeAccess && react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_task_migration_box__WEBPACK_IMPORTED_MODULE_4__["TaskMigrationBox"], { task: task, course: course, updateLink: function (id, linkOrUnlink) { return editTask.updateLink(id, linkOrUnlink); } }),
        react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("h2", null, "Inl\u00E4mningsuppgift"),
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "checkBox" + (editTask.getTaskProp("assignment") ? " checked" : ""), onClick: function () {
                            editTask.updateTaskOrCustomization("assignment", { $set: !editTask.getTaskProp("assignment") });
                        } })),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Den h\u00E4r uppgiften \u00E4r en inl\u00E4mningsuppgift"))),
            editTask.getTaskProp("assignment") && react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react__WEBPACK_IMPORTED_MODULE_3__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null, "Inl\u00E4mningsdatum"),
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_3__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_1__["default"], { selected: editTask.getTaskProp("deadline") && moment__WEBPACK_IMPORTED_MODULE_2___default()(editTask.getTaskProp("deadline")), dateFormat: "YYYY-MM-DD", locale: "sv", popperPlacement: "bottom-start", onChange: function (value) {
                                editTask.updateTaskOrCustomization("deadline", { $set: value.format("YYYY-MM-DD") });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("div", { className: "horizontalItem top" }, editTask.getTaskProp("deadline") && react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("a", { className: "deleteDate", href: "#", title: "Ta bort inl\u00E4mningsdatum", onClick: function (ev) {
                            ev.preventDefault();
                            editTask.updateTaskOrCustomization("deadline", { $set: null });
                        } }))))));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/edit-task.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/edit-task.tsx ***!
  \***************************************************************************/
/*! exports provided: EditTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditTask", function() { return EditTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../sub-components/knowledge-matrix */ "./src/components/course-builder/sub-components/knowledge-matrix.tsx");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../sub-components/select-related-docs */ "./src/components/course-builder/sub-components/select-related-docs.tsx");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_cached_response__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../utils/cached-response */ "./src/utils/cached-response.ts");
/* harmony import */ var _contracts_ked_models__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../../contracts/ked-models */ "./src/contracts/ked-models.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../../features */ "./src/features/index.ts");
/* harmony import */ var _search_results__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./search-results */ "./src/components/course-builder/modal-pages/edit-task/search-results.tsx");
/* harmony import */ var _basic_editable_task_fields__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./basic-editable-task-fields */ "./src/components/course-builder/modal-pages/edit-task/basic-editable-task-fields.tsx");
/* harmony import */ var _task_status_fragment__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./task-status-fragment */ "./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx");
/* harmony import */ var _save_or_cancel_buttons__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./save-or-cancel-buttons */ "./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx");
/* harmony import */ var _previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./previewable-task-fields */ "./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx");



















var EditTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditTask, _super);
    function EditTask(props) {
        var _this = _super.call(this, props) || this;
        _this.features = new _features__WEBPACK_IMPORTED_MODULE_13__["Features"]();
        var writeAccess = !props.task || Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, props.task);
        _this.state = {
            title: props.task ?
                writeAccess ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera uppgift till \"", "\""], ["Redigera uppgift till \"", "\""])), props.module.name) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Visa uppgift till \"", "\""], ["Visa uppgift till \"", "\""])), props.module.name) :
                props.searchMode ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["S\u00F6k ny uppgift till \"", "\""], ["S\u00F6k ny uppgift till \"", "\""])), props.module.name) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till egen uppgift till \"", "\""], ["L\u00E4gg till egen uppgift till \"", "\""])), props.module.name),
            futureAbilitiesOpen: false,
            taskCustomization: props.taskCustomization || {},
            task: props.task ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ $meta: props.task.$meta || 'update' }, props.task) : props.searchMode ? null :
                // No task was given. Set $meta = 'add' to inform EditCourse.save()
                // to add the task to the tasks table.
                {
                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(),
                    $meta: 'add',
                    tags: [
                        "sub:" + props.course.subjectCode,
                        "course:" + props.course.code
                    ],
                    school: !props.course.isTemplate && _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school,
                    resources: [],
                    abilities: [],
                    centralContent: [],
                    futureAbilities: [],
                    knowledgeRequirements: [],
                    name: "",
                    url: "",
                    acl: props.course.isTemplate ? [
                        "role:USER:R" // (OK to keep after kursbygg-changes). Templates (which will be empty!) will not have tasks. If they had, might not tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)
                    ] : [
                        "role:USER:R",
                        "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school + "/EMPLOYEE:S"
                    ]
                },
            searchMarkedIds: props.searchMode && [],
            searchResult: props.searchMode && [],
            isSearching: props.searchMode
        };
        if (props.searchMode) {
            _this.searchResponse = new _utils_cached_response__WEBPACK_IMPORTED_MODULE_9__["CachedResponse"](function () {
                return _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].kedBackendClient.list("tasks", {
                    tags: "course:" + props.course.code,
                    include: ['knowledgeRequirements', 'abilities', 'centralContent'],
                    flags: ['includeIdsOnly']
                });
            });
        }
        return _this;
    }
    EditTask.prototype.setStatePromised = function (state) {
        var _this = this;
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, function () { return state; }, resolve); });
    };
    EditTask.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.props.searchMode) return [3 /*break*/, 8];
                        this.setStatePromised({ isSearching: true });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 5, 6, 8]);
                        return [4 /*yield*/, this.searchResponse.query()];
                    case 2:
                        _a.sent();
                        if (!(this.state.searchMarkedIds && this.state.searchMarkedIds.length === 0)) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.updateSearchResult(this.state.searchMarkedIds)];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [3 /*break*/, 8];
                    case 5:
                        err_1 = _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["showError"])(err_1);
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.setStatePromised({ isSearching: false })];
                    case 7:
                        _a.sent();
                        return [7 /*endfinally*/];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.updateSearchMarkedIds = function (searchMarkedIds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var setStatePromise;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        setStatePromise = this.setStatePromised({ task: null, searchMarkedIds: searchMarkedIds, previewTaskContent: null });
                        if (!!this.searchResponse.result) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.searchResponse.promise];
                    case 1:
                        _a.sent();
                        // Refresh searchMarkedIds now as user might have clicked around while waiting for
                        // tasks to load...
                        return [4 /*yield*/, setStatePromise];
                    case 2:
                        // Refresh searchMarkedIds now as user might have clicked around while waiting for
                        // tasks to load...
                        _a.sent(); // So we know state has been reflected...
                        searchMarkedIds = this.state.searchMarkedIds;
                        _a.label = 3;
                    case 3: return [4 /*yield*/, this.updateSearchResult(searchMarkedIds)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.updateSearchResult = function (searchMarkedIds) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var allTasksForSubject, searchResult;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.searchResponse.query()];
                    case 1:
                        allTasksForSubject = _a.sent();
                        searchResult = allTasksForSubject.filter(function (t) {
                            return searchMarkedIds.every(function (id) {
                                return t.knowledgeRequirements.some(function (kr) { return kr.id === id; }) ||
                                    t.abilities.some(function (a) { return a.id === id; }) ||
                                    t.centralContent.some(function (c) { return c.id === id; });
                            });
                        });
                        this.setStatePromised({
                            searchResult: searchResult
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.onMarkChanged = function (id, isMarked) {
        var searchMode = this.props.searchMode;
        if (searchMode) {
            var searchMarkedIds = this.state.searchMarkedIds;
            this.updateSearchMarkedIds(isMarked ?
                searchMarkedIds.concat(id) :
                searchMarkedIds.filter(function (x) { return x !== id; })).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["showError"]);
            return;
        }
        this.updateLink(id, isMarked);
    };
    EditTask.prototype.updateLink = function (id, linkOrUnlink) {
        var course = this.props.course;
        var task = this.state.task;
        // One of the following three will be found:
        var ability = course.abilities.find(function (a) { return a.id === id; });
        var knowledgeRequirement = course.knowledgeRequirements.find(function (r) { return r.id === id; });
        var centralContent = course.centralContent.find(function (cc) { return cc.id === id; });
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](ability ?
            ["abilities", ability] :
            knowledgeRequirement ?
                ["knowledgeRequirements", knowledgeRequirement] :
                centralContent ?
                    ["centralContent", centralContent] :
                    [null, null], 2), collectionProp = _a[0], item = _a[1];
        if (!collectionProp) {
            console.error("Could not find marked id " + id);
            return;
        }
        var updatedCollection = task[collectionProp].slice();
        var currentPos = updatedCollection.findIndex(function (doc) { return doc.id === id; });
        if (linkOrUnlink) {
            if (currentPos < 0) {
                updatedCollection.push(item);
            }
        }
        else {
            if (currentPos >= 0) {
                updatedCollection.splice(currentPos, 1);
            }
        }
        var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
        updatedTask[collectionProp] = updatedCollection;
        // Clear migratedTexts from task.
        // First deep clone:
        if (task && task.migratedTexts) {
            updatedTask.migratedTexts = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task.migratedTexts);
            if (task.migratedTexts[collectionProp]) {
                updatedTask.migratedTexts[collectionProp] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task.migratedTexts[collectionProp]);
                // Delete the id within the deep clone:
                delete updatedTask.migratedTexts[collectionProp][id];
            }
        }
        this.setStatePromised({
            task: updatedTask
        });
    };
    EditTask.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, task, taskCustomization, writeAccess;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
                        writeAccess = Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
                        if (!writeAccess) return [3 /*break*/, 5];
                        if (!task.url && !task.content)
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Uppgiften m\u00E5ste antingen ha en URL eller ett inneh\u00E5ll"], ["Uppgiften m\u00E5ste antingen ha en URL eller ett inneh\u00E5ll"]))));
                        if (task.url && !valid_url__WEBPACK_IMPORTED_MODULE_7___default.a.isUri(task.url))
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_6 || (templateObject_6 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Den ska b\u00F6rja med http: eller https:"], ["Angiven URL '", "' \u00E4r ogiltig. Den ska b\u00F6rja med http: eller https:"])), task.url));
                        if (!(this.props.task && this.props.task.id !== task.id)) return [3 /*break*/, 2];
                        // Replace existing task with copy
                        return [4 /*yield*/, this.props.onReplace(this.props.task.id, task)];
                    case 1:
                        // Replace existing task with copy
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Update existing task
                    return [4 /*yield*/, this.props.onSave(task, null)];
                    case 3:
                        // Update existing task
                        _b.sent();
                        _b.label = 4;
                    case 4: return [3 /*break*/, 9];
                    case 5:
                        if (!this.props.searchMode) return [3 /*break*/, 7];
                        return [4 /*yield*/, this.props.onSave(task, taskCustomization)];
                    case 6:
                        _b.sent();
                        return [3 /*break*/, 9];
                    case 7:
                        if (this.props.course.isTemplate && task.$meta === 'add')
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_7 || (templateObject_7 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Du saknar beh\u00F6righet f\u00F6r att spara nya versioner av uppgifter i kursmallen"], ["Du saknar beh\u00F6righet f\u00F6r att spara nya versioner av uppgifter i kursmallen"]))));
                        return [4 /*yield*/, this.props.onSaveCustomization(taskCustomization)];
                    case 8:
                        _b.sent();
                        _b.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.copyTask = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var taskCopy;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        taskCopy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.task, (this.state.taskCustomization || {}), { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(), acl: this.props.course.isTemplate ? [
                                "role:USER:R" // (OK to keep but this check might become unnescesary if we totally remove the possibility to edit templates) Template tasks should not be possible to modify. (An ADMIN could belong to a school! Other non-admins at that school should not be able to edit it)
                            ] : [
                                "role:USER:R",
                                "schoolRole:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser.school + "/EMPLOYEE:S"
                            ], school: this.props.course.school });
                        taskCopy.$meta = 'add';
                        return [4 /*yield*/, this.setStatePromised({
                                task: taskCopy,
                                title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_8__["L"])(templateObject_8 || (templateObject_8 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Redigera kopierad uppgift till \"", "\""], ["Redigera kopierad uppgift till \"", "\""])), this.props.module.name),
                                taskCustomization: undefined
                            })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    EditTask.prototype.getTaskProp = function (taskProp) {
        var _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
        var customization = taskCustomization && taskCustomization[taskProp];
        return customization !== undefined ?
            customization :
            task[taskProp];
    };
    EditTask.prototype.updateTaskOrCustomization = function (taskProp, updates) {
        var _a = this.state, task = _a.task, taskCustomization = _a.taskCustomization;
        var writeAccess = task && Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
        if (writeAccess && (!taskCustomization || taskCustomization[taskProp] === undefined)) {
            var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
            newTask[taskProp] = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(task[taskProp], updates);
            this.setStatePromised({ task: newTask });
        }
        else {
            var newCustomization = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, taskCustomization);
            newCustomization[taskProp] = react_addons_update__WEBPACK_IMPORTED_MODULE_4___default()(newCustomization[taskProp] || task[taskProp], updates);
            this.setStatePromised({ taskCustomization: newCustomization });
        }
    };
    EditTask.prototype.render = function () {
        var _this = this;
        var _a = this.props, course = _a.course, module = _a.module, onCancel = _a.onCancel, onDelete = _a.onDelete, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, searchMode = _a.searchMode;
        var _b = this.state, task = _b.task, taskCustomization = _b.taskCustomization, title = _b.title, searchResult = _b.searchResult, searchMarkedIds = _b.searchMarkedIds, isSearching = _b.isSearching;
        var markedIds = searchMode ?
            searchMarkedIds :
            task.centralContent.map(function (x) { return x.id; })
                .concat(task.abilities.map(function (x) { return x.id; }))
                .concat(task.knowledgeRequirements.map(function (x) { return x.id; }));
        var writeAccess = task && Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_11__["default"].currentUser, task);
        var taskUrlValid = task && valid_url__WEBPACK_IMPORTED_MODULE_7___default.a.isUri(task.url);
        var features = this.features;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, title))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-fluid-grid sv-grid-ksgs12 sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-6" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, searchMode ?
                                    "Filtrera på kunskapskrav" : writeAccess ?
                                    "Välj kunskapskrav" :
                                    "Kunskapskrav"),
                                searchMode ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Markera de kunskapskrav som uppgiften m\u00E5ste t\u00E4cka.") : writeAccess &&
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Markera de kunskapskrav som din uppgift t\u00E4cker."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_knowledge_matrix__WEBPACK_IMPORTED_MODULE_3__["KnowledgeMatrix"], { knowledgeRequirements: course.knowledgeRequirements, markedIds: markedIds, idsToMarkNotOk: idsNotCoveredByAnyTask, markMode: searchMode || writeAccess, migratedIds: task && task.migratedTexts && task.migratedTexts.knowledgeRequirements, onMarkChanged: this.onMarkChanged.bind(this) }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__["SelectRelatedDocs"], { options: course.abilities, title: writeAccess || searchMode ? "Välj förmågor" : "Förmågor", markedIds: markedIds, markMode: writeAccess || searchMode, migratedIds: task && task.migratedTexts && task.migratedTexts.abilities, onMarkChanged: this.onMarkChanged.bind(this) })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_select_related_docs__WEBPACK_IMPORTED_MODULE_6__["SelectRelatedDocs"], { options: course.centralContent, title: writeAccess || searchMode ? "Välj centralt innehåll" : "Centralt innehåll", markedIds: markedIds, markMode: writeAccess || searchMode, migratedIds: task && task.migratedTexts && task.migratedTexts.centralContent, onMarkChanged: this.onMarkChanged.bind(this) })),
                        !searchMode && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose larger" + (this.state.futureAbilitiesOpen ? " open" : "") },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setStatePromised({ futureAbilitiesOpen: !_this.state.futureAbilitiesOpen }); } }, writeAccess ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "V\u00E4lj ytterligare alternativ") :
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Ytterligare alternativ")),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null, "Framtidsf\u00F6rm\u00E5gor"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, _contracts_ked_models__WEBPACK_IMPORTED_MODULE_10__["futureAbilities"].map(function (fa) {
                                        var selected = task.futureAbilities.indexOf(fa) >= 0;
                                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: fa },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (selected ? " checked" : ""), onClick: writeAccess ? function () {
                                                        var updatedTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                                                        updatedTask.futureAbilities =
                                                            selected ?
                                                                task.futureAbilities.filter(function (a) { return a != fa; }) :
                                                                task.futureAbilities.concat(fa);
                                                        _this.setStatePromised({ task: updatedTask });
                                                    } : undefined })),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, fa));
                                    })))))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-6" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                            isSearching && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_12__["Spinner"], null),
                                " Laddar uppgifter..."),
                            searchResult ?
                                /*
                                 *
                                 * Search Results Fragent
                                 *
                                 *
                                 */
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_search_results__WEBPACK_IMPORTED_MODULE_14__["SearchResults"], { searchMarkedIds: searchMarkedIds, searchResult: searchResult, task: task, writeAccess: writeAccess, taskCustomization: taskCustomization, editTask: this }),
                                    this.state.previewTaskContent ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: this.state.previewTaskContent } })
                                        : task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__["PreviewableTaskFields"], { writeAccess: writeAccess, task: task, taskCustomization: taskCustomization, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_status_fragment__WEBPACK_IMPORTED_MODULE_16__["TaskStatusFragment"], { task: task })) :
                                /*
                                 *
                                 * Edit Tasks Fragment
                                 *
                                 *
                                 */
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_basic_editable_task_fields__WEBPACK_IMPORTED_MODULE_15__["BasicEditableTaskFields"], { task: task, course: course, writeAccess: writeAccess, features: features, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_previewable_task_fields__WEBPACK_IMPORTED_MODULE_18__["PreviewableTaskFields"], { writeAccess: writeAccess, task: task, taskCustomization: taskCustomization, editTask: this }),
                                    task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_status_fragment__WEBPACK_IMPORTED_MODULE_16__["TaskStatusFragment"], { task: task }))),
                        task && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_save_or_cancel_buttons__WEBPACK_IMPORTED_MODULE_17__["SaveOrCancelButtons"], { writeAccess: writeAccess, editTask: this })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" }))));
    };
    return EditTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8;


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/index.ts":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/index.ts ***!
  \**********************************************************************/
/*! exports provided: EditTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _edit_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./edit-task */ "./src/components/course-builder/modal-pages/edit-task/edit-task.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EditTask", function() { return _edit_task__WEBPACK_IMPORTED_MODULE_0__["EditTask"]; });




/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx":
/*!*****************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/previewable-task-fields.tsx ***!
  \*****************************************************************************************/
/*! exports provided: PreviewableTaskFields */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreviewableTaskFields", function() { return PreviewableTaskFields; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../sub-components/editable-resource-list */ "./src/components/course-builder/sub-components/editable-resource-list.tsx");
/* harmony import */ var _task_content_fragment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./task-content-fragment */ "./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx");




function PreviewableTaskFields(_a) {
    var writeAccess = _a.writeAccess, task = _a.task, taskCustomization = _a.taskCustomization, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Uppgiftens l\u00E4randem\u00E5l"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "inputTextBox learning-goal-box", disabled: !writeAccess, value: task.learningGoal, onChange: function (ev) {
                        var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                        newTask.learningGoal = ev.target.value;
                        editTask.setStatePromised({ task: newTask });
                    } }))),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, (writeAccess || !!task.content) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_content_fragment__WEBPACK_IMPORTED_MODULE_3__["TaskContentFragment"], { writeAccess: writeAccess, task: task, editTask: editTask })),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            taskCustomization && taskCustomization.resources ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Resurser f\u00F6r uppgiften (modifierad f\u00F6r denna kursinstans)") :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Resurser kopplade till uppgiften"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_editable_resource_list__WEBPACK_IMPORTED_MODULE_2__["EditableResourceList"], { resources: (taskCustomization && taskCustomization.resources) || task.resources, host: editTask.props.host, onUpdate: function (resourceUpdates) {
                    editTask.updateTaskOrCustomization("resources", resourceUpdates);
                } })));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx":
/*!****************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/save-or-cancel-buttons.tsx ***!
  \****************************************************************************************/
/*! exports provided: SaveOrCancelButtons */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SaveOrCancelButtons", function() { return SaveOrCancelButtons; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");


function SaveOrCancelButtons(_a) {
    var writeAccess = _a.writeAccess, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
        !!editTask.props.onDelete && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return editTask.props.onDelete(); } }, "Ta bort fr\u00E5n kursmodul"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pull-right" }, "\u00A0"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-warning btn-large pull-right", onClick: function () { return editTask.props.onCancel(); } }, "Avbryt"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-large", onClick: function () { return editTask.save().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["showError"]); } }, "Spara"),
        !writeAccess && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "btn btn-large", onClick: function () { return editTask.copyTask().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["showError"]); } }, "Skapa kopia av den h\u00E4r uppgiften"));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/search-results.tsx":
/*!********************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/search-results.tsx ***!
  \********************************************************************************/
/*! exports provided: SearchResults */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SearchResults", function() { return SearchResults; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");



function SearchResults(_a) {
    var searchMarkedIds = _a.searchMarkedIds, searchResult = _a.searchResult, task = _a.task, editTask = _a.editTask, writeAccess = _a.writeAccess, taskCustomization = _a.taskCustomization;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "task-search-result" + (!editTask.state.task && !editTask.state.previewTaskContent ? " fixed" : "") },
        searchMarkedIds.length === 0 ?
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "Samtliga uppgifter f\u00F6r kursen") :
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h2", null, "Uppgifter som t\u00E4cker valda filter"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tbody", null, searchResult
                .filter(task ?
                function (foundTask) { return foundTask.id === task.id; } :
                function () { return true; })
                .map(function (foundTask) { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], { key: foundTask.id },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("tr", null,
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { tabIndex: 1, className: "checkBox" + (task && task.id === foundTask.id ? " checked" : ""), onClick: function () { return toggleChooseTask(foundTask); } })),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, foundTask.content ?
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: "#", onClick: function (ev) {
                                toggleChooseTask(foundTask);
                                ev.preventDefault();
                                ev.stopPropagation();
                            } }, foundTask.name) :
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: foundTask.url, target: "_blank" }, foundTask.name)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, Object(_utils__WEBPACK_IMPORTED_MODULE_2__["shortPersonNameFormat"])(foundTask.modifiedBy.name)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, foundTask.school || "Standard"),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("td", null, Object(_utils__WEBPACK_IMPORTED_MODULE_2__["shortDateFormat"])(foundTask.modifiedDate)))); }))),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("br", null),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("hr", null));
    function toggleChooseTask(foundTask) {
        if (task && task.id === foundTask.id) {
            editTask.updateSearchMarkedIds(searchMarkedIds);
        }
        else {
            Object(react_dom__WEBPACK_IMPORTED_MODULE_1__["findDOMNode"])(editTask).parentElement.scrollTop = 0;
            editTask.setStatePromised({ task: foundTask, previewTaskContent: null });
        }
    }
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx":
/*!***************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-content-fragment.tsx ***!
  \***************************************************************************************/
/*! exports provided: TaskContentFragment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskContentFragment", function() { return TaskContentFragment; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utility-components/wysiwyg */ "./src/components/utility-components/wysiwyg/index.tsx");
/* harmony import */ var _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utility-components/wysiwyg/actions-sv */ "./src/components/utility-components/wysiwyg/actions-sv.ts");




function TaskContentFragment(_a) {
    var writeAccess = _a.writeAccess, task = _a.task, editTask = _a.editTask;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Uppgiftens inneh\u00E5ll"),
        writeAccess && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Om uppgiften inte l\u00E4nkar till n\u00E5got dokument kan du l\u00E4gga inneh\u00E5ll h\u00E4r."),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_wysiwyg__WEBPACK_IMPORTED_MODULE_2__["Wysiwyg"], { actions: [
                "bold",
                "italic",
                "underline",
                "strikethrough",
                "heading2",
                "heading3",
                "olist",
                "ulist",
                "line",
                "link",
                "image"
            ], defaultActions: _utility_components_wysiwyg_actions_sv__WEBPACK_IMPORTED_MODULE_3__["default"], readOnly: !writeAccess, html: task.content, onChange: function (html) {
                var newTask = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task);
                newTask.content = html;
                editTask.setState({ task: newTask });
            } }));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx":
/*!************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-migration-box.tsx ***!
  \************************************************************************************/
/*! exports provided: TaskMigrationBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskMigrationBox", function() { return TaskMigrationBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");



var TaskMigrationBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskMigrationBox, _super);
    function TaskMigrationBox(props) {
        return _super.call(this, props) || this;
    }
    TaskMigrationBox.prototype.render = function () {
        var _a = this.props, task = _a.task, course = _a.course, updateLink = _a.updateLink;
        if (!task.migratedTexts)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0");
        var _b = task.migratedTexts, abilities = _b.abilities, centralContent = _b.centralContent, knowledgeRequirements = _b.knowledgeRequirements;
        var krs = Object.keys(knowledgeRequirements || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.knowledgeRequirements.find(function (t) { return t.id === id; }), knowledgeRequirements[id])); }); //.filter(({name}) => !!name);
        var krA = { title: "Uppdaterat kunskapskrav för betyget A", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'A'; }) };
        var krC = { title: "Uppdaterat Kunskapskrav för betyget C", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'C'; }) };
        var krE = { title: "Uppdaterat kunskapskrav för betyget E", type: "knowledgeRequirements", items: krs.filter(function (kr) { return kr.gradeStep === 'E'; }) };
        var abs = { title: "Uppdaterade förmågor", type: "abilities", items: Object.keys(abilities || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.abilities.find(function (t) { return t.id === id; }), abilities[id])); }) }; //.filter(({name}) => !!name)};
        var ccs = { title: "Uppdaterat centralt innehåll", type: "centralContent", items: Object.keys(centralContent || {}).map(function (id) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, course.centralContent.find(function (cc) { return cc.id == id; }), centralContent[id])); }) }; //.filter(({name}) => !!name)};
        var tablesToShow = [krA, krC, krE, ccs, abs].filter(function (boxInfo) { return boxInfo.items.length > 0; });
        if (tablesToShow.length === 0)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0");
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { className: "larger", title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "warningFlag" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-exclamation-triangle", "aria-hidden": "true" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Uppdaterade formuleringar fr\u00E5n Skolverket")) }, tablesToShow.map(function (_a) {
            var title = _a.title, type = _a.type, items = _a.items;
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: title },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { style: { width: "40%" } }, "Ursprunglig formulering"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { style: { width: "40%" } }, "Skolverkets nya formulering"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "T\u00E4cker uppgiften den nya formuleringen?"))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, items.map(function (item) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: item.id },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { dangerouslySetInnerHTML: { __html: item.oldText } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { dangerouslySetInnerHTML: { __html: item.name } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return updateLink(item.id, true); } }, "Ja - beh\u00E5ll kopplingen"),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return updateLink(item.id, false); } }, "Nej - ta bort kopplingen"))); }))));
        })));
    };
    return TaskMigrationBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx":
/*!**************************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-task/task-status-fragment.tsx ***!
  \**************************************************************************************/
/*! exports provided: TaskStatusFragment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskStatusFragment", function() { return TaskStatusFragment; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");


function TaskStatusFragment(_a) {
    var task = _a.task;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"](react__WEBPACK_IMPORTED_MODULE_0__["Fragment"], null,
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h3", null, "Uppgiftens status"),
        task.createdBy && task.createdDate && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null,
            "Uppgiften skapades ",
            Object(_utils__WEBPACK_IMPORTED_MODULE_1__["dtFormat"])(task.createdDate),
            " av ",
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("strong", null, task.createdBy.name),
            "."),
        task.modifiedBy && task.modifiedDate && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null,
            "Uppgiften redigerades senast ",
            Object(_utils__WEBPACK_IMPORTED_MODULE_1__["dtFormat"])(task.modifiedDate),
            " av ",
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("strong", null, task.modifiedBy.name),
            "."));
}


/***/ }),

/***/ "./src/components/course-builder/modal-pages/edit-workflow-link.tsx":
/*!**************************************************************************!*\
  !*** ./src/components/course-builder/modal-pages/edit-workflow-link.tsx ***!
  \**************************************************************************/
/*! exports provided: EditWorkflowLink */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditWorkflowLink", function() { return EditWorkflowLink; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! valid-url */ "./node_modules/valid-url/index.js");
/* harmony import */ var valid_url__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(valid_url__WEBPACK_IMPORTED_MODULE_3__);




var EditWorkflowLink = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditWorkflowLink, _super);
    function EditWorkflowLink(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { url: _this.props.url || '' };
        return _this;
    }
    EditWorkflowLink.prototype.save = function () {
        var url = this.state.url;
        if (!valid_url__WEBPACK_IMPORTED_MODULE_3___default.a.isUri(url))
            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med http: eller https:"], ["Angiven URL '", "' \u00E4r ogiltig. Ska b\u00F6rja med http: eller https:"])), url));
        this.props.onSave(url);
    };
    EditWorkflowLink.prototype.render = function () {
        var _this = this;
        var _a = this.props, onSave = _a.onSave, onDelete = _a.onDelete;
        var state = this.state;
        var isValidUrl = valid_url__WEBPACK_IMPORTED_MODULE_3___default.a.isUri(this.state.url);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Koppla en arbetsg\u00E5ng till kursen"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Det g\u00E5r bara att l\u00E4gga in en arbetsg\u00E5ng per kurs."),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "L\u00E4nk:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top " },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, value: state.url, onChange: function (ev) { return _this.setState({ url: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet", id: "svid12_492422d515badf36646e4ff1" },
                onDelete && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () { return onDelete(); } }, "Ta bort arbetsg\u00E5ng"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large" + (isValidUrl ? "" : " btn-inactive"), onClick: isValidUrl && (function () { return onSave(state.url); }) }, "Spara")));
    };
    return EditWorkflowLink;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/schools/edit-school.tsx":
/*!***************************************************************!*\
  !*** ./src/components/course-builder/schools/edit-school.tsx ***!
  \***************************************************************/
/*! exports provided: EditSchool, EditSchoolNoBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchool", function() { return EditSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditSchoolNoBanner", function() { return EditSchoolNoBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");







var EditSchool = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", callbacks: { schools: function () { return location.hash = "#/schools"; } }, routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](EditSchoolNoBanner, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, props))); };
var EditSchoolNoBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditSchoolNoBanner, _super);
    function EditSchoolNoBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = null;
        return _this;
    }
    EditSchoolNoBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    };
    EditSchoolNoBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var id, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.props.id) return [3 /*break*/, 2];
                        id = this.props.id;
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.get("schools", id)];
                    case 1:
                        school = _a.sent();
                        this.origSchool = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school);
                        this.setState(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, school));
                        return [3 /*break*/, 3];
                    case 2:
                        // No id, create new instead.
                        this.setState({
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            officialBranchId: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            isGymnasium: this.props.type === 'gymnasium',
                            isPrimarySchool: this.props.type === 'primary'
                        });
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var r, school;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        r = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        school = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state, { tags: (this.state.tags || [])
                                .filter(function (tag) { return ["primary", "gymnasium"].indexOf(tag) < 0; }) });
                        if (school.isPrimarySchool)
                            school.tags.push("primary");
                        if (school.isGymnasium)
                            school.tags.push("gymnasium");
                        if (!(school.isGymnasium || school.isPrimarySchool)) {
                            throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"], ["Skolan m\u00E5ste antingen vara gymnasium eller grundskola"]))));
                        }
                        if (!this.origSchool) {
                            school.acl = ["role:USER:R"];
                            school.acl.push(new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString());
                            r.add("schools", school);
                            this.addSchoolBranch(school, r);
                        }
                        else if (this.origSchool.name !== this.state.name) {
                            throw new Error("Skolans namn får inte ändras. Kontakta Vemendo AB.");
                        }
                        else {
                            if (!school.officialBranchId) {
                                school.officialBranchId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])();
                                this.addSchoolBranch(school, r);
                            }
                            r.put("schools", school);
                        }
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(r.mutationRequests)];
                    case 1:
                        _a.sent();
                        location.hash = "#/schools";
                        return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.addSchoolBranch = function (school, r) {
        var branch = {
            id: school.officialBranchId,
            name: school.name,
            schoolId: school.id,
            acl: [
                "role:USER:R",
                new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", school.name + "/EMPLOYEE", "W").toString()
            ]
        };
        r.add("branches", branch);
    };
    EditSchoolNoBanner.prototype.deleteSchool = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schoolBranch, br_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(prompt(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"], ["\u00C4r du s\u00E4ker p\u00E5 att ta bort skolan \"", "\"? Skriv skolans exakta namn f\u00F6r att bekr\u00E4fta"])), this.state.name)) === this.state.name)) return [3 /*break*/, 3];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("branches", {
                                ids: [this.state.officialBranchId],
                                include: "approvedChildren",
                                flags: ["includeIdsOnly"]
                            })];
                    case 1:
                        schoolBranch = _a.sent();
                        br_1 = new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["BatchRunner"]();
                        br_1.delete("schools", this.state.id);
                        schoolBranch[0].approvedChildren.forEach(function (_a) {
                            var id = _a.id;
                            br_1.delete("branches", id);
                        });
                        br_1.delete("branches", this.state.officialBranchId);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.batch(br_1.mutationRequests)];
                    case 2:
                        _a.sent();
                        location.hash = "#/schools";
                        return [3 /*break*/, 4];
                    case 3:
                        alert("Skolan togs inte bort eftersom det namn du angav inte stämmer.");
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    EditSchoolNoBanner.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, id = _a.id;
        var editExisting = !!id;
        var school = this.state;
        var origSchool = this.origSchool;
        var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, title),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Namn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: !school || !school.name, disabled: !isAdmin || editExisting, tabIndex: 1, size: 50, value: school ? school.name : "", onChange: function (ev) { return _this.setState({ name: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Visningsnamn:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: school && !school.displayName, disabled: !isAdmin, tabIndex: 1, size: 50, value: school ? school.displayName : "", onChange: function (ev) { return _this.setState({ displayName: ev.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, "Typ:"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypePrimary", disabled: !isAdmin, checked: school && school.isPrimarySchool, tabIndex: 1, value: "primary", onChange: function (ev) { return _this.setState({ isPrimarySchool: ev.target.checked }); } }),
                        "\u00A0Grundskola"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "checkbox", name: "schoolTypeGymnasium", disabled: !isAdmin, checked: school && school.isGymnasium, tabIndex: 1, value: "gymnasium", onChange: function (ev) { return _this.setState({ isGymnasium: ev.target.checked }); } }),
                        "\u00A0Gymnasium"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                isAdmin && editExisting && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { tabIndex: 2, className: "btn btn-warning btn-large pull-right", onClick: function () {
                        return _this.deleteSchool().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Ta bort skola"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pull-right" }, "\u00A0"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_6__["Link"], { className: "btn btn-warning btn-large pull-right", to: "/schools" }, "Avbryt"),
                isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { tabIndex: 1, className: "btn btn-large", onClick: function () {
                        if (origSchool && origSchool.name !== school.name) {
                            if (!confirm(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."], ["\u00C4r du s\u00E4ker p\u00E5 att du vill d\u00F6pa om skolan? Detta p\u00E5verkar portalens funktion f\u00F6r l\u00E4rare och elever som tillh\u00F6r skolan. Namnet m\u00E5ste st\u00E4mma exakt \u00F6verens med namngivningen av skolan p\u00E5 anv\u00E4ndarobjekten.\n\nDet som h\u00E4nder annars \u00E4r att elever och l\u00E4rare p\u00E5 skolan inte l\u00E4ngre hittar n\u00E5gra kurser.\n\nBlir det fel kan du dock alltid bara d\u00F6pa tillbaka skolans namn."]))))) {
                                return;
                            }
                        }
                        _this.save().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"]);
                    } }, "Spara")));
    };
    return EditSchoolNoBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/editable-school-list.tsx":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/schools/editable-school-list.tsx ***!
  \************************************************************************/
/*! exports provided: EditableSchoolList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableSchoolList", function() { return EditableSchoolList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var EditableSchoolList = function (props) {
    var schools = props.schools, viewCourseUrl = props.viewCourseUrl;
    var isAdmin = _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.roles.some(function (role) { return role === "ADMIN"; });
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editable-school-list" },
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, schools.map(function (school) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { className: "align-horizontal", key: school.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { className: "editItem", to: "/schools/" + school.id + "/edit" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, school.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "EMPLOYEE", school: school.name }); } }, "Agera som l\u00E4rare p\u00E5 denna skola"))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { style: { cursor: 'pointer' }, onClick: function () { return Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["actAs"])({ role: "STUDENT", school: school.name, url: viewCourseUrl }); } }, "Agera som elev p\u00E5 denna skola"))));
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
            "V.g. v\u00E4nta medan skolor laddas")),
        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
        schools && isAdmin && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_4__["Link"], { to: "/schools/new/" + props.type, className: "btn" }, props.type == 'gymnasium' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till gymnasieskola"], ["L\u00E4gg till gymnasieskola"]))) :
            props.type == 'primary' ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till grundskola"], ["L\u00E4gg till grundskola"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"])))));
};
var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/schools/index.tsx":
/*!*********************************************************!*\
  !*** ./src/components/course-builder/schools/index.tsx ***!
  \*********************************************************/
/*! exports provided: Schools, SchoolsWithoutBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolsWithoutBanner", function() { return SchoolsWithoutBanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _editable_school_list__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./editable-school-list */ "./src/components/course-builder/schools/editable-school-list.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");







var Schools = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { outline: 0 } },
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: "Skolor", activePage: "schools", routes: { feedback: props.feedbackUrl } }),
    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](SchoolsWithoutBanner, { viewCourseUrl: props.viewCourseUrl })); };
var SchoolsWithoutBanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolsWithoutBanner, _super);
    function SchoolsWithoutBanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            schools: null
        };
        return _this;
    }
    SchoolsWithoutBanner.prototype.componentDidMount = function () {
        this.load().catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["showError"])(err.message || err); });
    };
    SchoolsWithoutBanner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var schools;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("schools")];
                    case 1:
                        schools = _a.sent();
                        this.setState({ schools: schools });
                        return [2 /*return*/];
                }
            });
        });
    };
    SchoolsWithoutBanner.prototype.render = function () {
        var schools = this.state.schools;
        schools && schools.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("name"));
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" }, schools ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Gymnasieskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isGymnasium; }), viewCourseUrl: this.props.viewCourseUrl, type: "gymnasium" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Grundskolor"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_editable_school_list__WEBPACK_IMPORTED_MODULE_4__["EditableSchoolList"], { schools: schools.filter(function (school) { return school.isPrimarySchool; }), viewCourseUrl: this.props.viewCourseUrl, type: "primary" }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null)));
    };
    return SchoolsWithoutBanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/schools/new-school.tsx":
/*!**************************************************************!*\
  !*** ./src/components/course-builder/schools/new-school.tsx ***!
  \**************************************************************/
/*! exports provided: NewSchool */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NewSchool", function() { return NewSchool; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _edit_school__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./edit-school */ "./src/components/course-builder/schools/edit-school.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var NewSchool = function (props) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_school__WEBPACK_IMPORTED_MODULE_2__["EditSchool"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till skola"], ["L\u00E4gg till skola"]))), type: props.type, feedbackUrl: props.feedbackUrl }); };
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-resource-list.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-resource-list.tsx ***!
  \*********************************************************************************/
/*! exports provided: EditableResourceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableResourceList", function() { return EditableResourceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-resource */ "./src/components/course-builder/modal-pages/edit-resource.tsx");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");





var EditableResourceList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableResourceList, _super);
    function EditableResourceList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableResourceList.prototype.render = function () {
        var _a = this.props, host = _a.host, onUpdate = _a.onUpdate, resources = _a.resources;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, resources.map(function (resource, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return host.openDialog({
                                Component: _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__["EditResource"],
                                props: {
                                    title: "Redigera resurs",
                                    resource: resource,
                                    onSave: function (editedResource) {
                                        var updatedResource = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(editedResource, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                        onUpdate({ $splice: [[idx, 1, updatedResource]] });
                                        host.closeDialog();
                                    },
                                    onDelete: function () {
                                        onUpdate({ $splice: [[idx, 1]] });
                                        host.closeDialog();
                                    }
                                }
                            }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: resource.url, target: "_blank" }, resource.name)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return host.openDialog({
                    Component: _modal_pages_edit_resource__WEBPACK_IMPORTED_MODULE_2__["EditResource"],
                    props: {
                        title: "Lägg till resurs",
                        onSave: function (newResource) {
                            var updatedResource = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(newResource, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                            onUpdate({ $push: [updatedResource] });
                            host.closeDialog();
                        }
                    }
                }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-paperclip", "aria-hidden": true }),
                " L\u00E4gg till resurs"));
    };
    return EditableResourceList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-task-list.tsx":
/*!*****************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-task-list.tsx ***!
  \*****************************************************************************/
/*! exports provided: EditableTaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableTaskList", function() { return EditableTaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-task */ "./src/components/course-builder/modal-pages/edit-task/index.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");






var EditableTaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableTaskList, _super);
    function EditableTaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableTaskList.prototype.openTaskDialog = function (task) {
        var _a = this.props, taskCustomizations = _a.taskCustomizations, course = _a.course, host = _a.host, module = _a.module, taskIds = _a.taskIds, onTaskAdded = _a.onTaskAdded, onTaskUpdated = _a.onTaskUpdated, onTaskCustomizationUpdated = _a.onTaskCustomizationUpdated, onTaskDeleted = _a.onTaskDeleted, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, onTaskReplaced = _a.onTaskReplaced;
        host.openDialog({
            Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
            props: {
                task: task,
                taskCustomization: taskCustomizations && taskCustomizations[task.id],
                module: module,
                course: course,
                host: host,
                idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                onSave: function (task) {
                    var updatedTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(task, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                    onTaskUpdated(updatedTask);
                    host.closeDialog();
                },
                onSaveCustomization: function (customization) {
                    onTaskCustomizationUpdated(task.id, customization);
                    host.closeDialog();
                },
                onDelete: function () {
                    onTaskDeleted(task.id);
                    host.closeDialog();
                },
                onReplace: function (taskId, newTask) {
                    onTaskReplaced(taskId, newTask);
                    host.closeDialog();
                },
                onCancel: function () { return host.closeDialog(); }
            }
        });
    };
    EditableTaskList.prototype.render = function () {
        var _this = this;
        var props = this.props;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, props.taskIds.map(function (id) { return props.course.tasks.find(function (t) { return t.id === id; }); }).map(function (task) {
                var canUpdateTask = Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser, task);
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: task.id },
                    Object(_access_control__WEBPACK_IMPORTED_MODULE_5__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser, task) && Object(_utils__WEBPACK_IMPORTED_MODULE_3__["hasMigratedTexts"])(task) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { position: 'relative', top: '0.2em', left: '-0.7em' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-pagelines", style: { position: 'absolute', top: 0, left: 0, color: '#49c35a' } }))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: canUpdateTask ? "editItem" : "viewItem", onClick: function () {
                                return _this.openTaskDialog(task);
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, task.content ?
                        // Rather than linking to url, show the task's content (by opening
                        // the task dialog)
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                ev.preventDefault();
                                _this.openTaskDialog(task);
                            } }, task.name) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: task.url, target: "_blank" }, task.name)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () {
                    var _a = _this.props, course = _a.course, host = _a.host, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask, module = _a.module, onTaskAdded = _a.onTaskAdded, onTaskCustomizationUpdated = _a.onTaskCustomizationUpdated;
                    props.host.openDialog({
                        Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
                        props: {
                            searchMode: true,
                            module: module,
                            course: course,
                            host: host,
                            idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                            onSave: function (choosenTask, taskCustomization) {
                                choosenTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(choosenTask, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                onTaskAdded(choosenTask, taskCustomization);
                                host.closeDialog();
                            },
                            onCancel: function () { return host.closeDialog(); }
                        }
                    });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-search", "aria-hidden": true }),
                " S\u00F6k uppgift"),
            "\u00A0",
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () {
                    var _a = _this.props, course = _a.course, host = _a.host, module = _a.module, taskIds = _a.taskIds, onTaskAdded = _a.onTaskAdded, onTaskUpdated = _a.onTaskUpdated, onTaskDeleted = _a.onTaskDeleted, idsNotCoveredByAnyTask = _a.idsNotCoveredByAnyTask;
                    host.openDialog({
                        Component: _modal_pages_edit_task__WEBPACK_IMPORTED_MODULE_2__["EditTask"],
                        props: {
                            module: module,
                            course: course,
                            host: host,
                            idsNotCoveredByAnyTask: idsNotCoveredByAnyTask,
                            onSave: function (newTask) {
                                newTask = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["updateModificationAndCreationStamps"])(newTask, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser);
                                onTaskAdded(newTask);
                                host.closeDialog();
                            },
                            onCancel: function () { return host.closeDialog(); }
                        }
                    });
                }, className: "btn" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": true }),
                " L\u00E4gg till egen uppgift"));
    };
    return EditableTaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-teacher-list.tsx":
/*!********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-teacher-list.tsx ***!
  \********************************************************************************/
/*! exports provided: EditableTeacherList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableTeacherList", function() { return EditableTeacherList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var EditableTeacherList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableTeacherList, _super);
    function EditableTeacherList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { addEmtpyRow: props.teachers.length === 0 };
        return _this;
    }
    EditableTeacherList.prototype.render = function () {
        var _this = this;
        var _a = this.props, teachers = _a.teachers, onUpdate = _a.onUpdate;
        var addEmtpyRow = this.state.addEmtpyRow;
        if (addEmtpyRow)
            teachers = teachers.concat({ name: "", url: "" });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "teachers-list" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Ansvariga l\u00E4rare"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { tabIndex: 1, style: { width: "100%" }, onBlur: function (ev) {
                    return (!ev.relatedTarget ||
                        ev.relatedTarget.tagName !== 'INPUT') &&
                        _this.props.teachers.length > 0 &&
                        _this.setState({ addEmtpyRow: false });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null, teachers.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { style: { width: "20%" } }, "Namn"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "L\u00E4nk eller E-postadress"))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, teachers.map(function (teacher, idx) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: idx },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", ref: function (elem) { return _this.nameElem = elem; }, value: teacher.name, autoFocus: !teacher.name && idx > 0, onChange: function (ev) {
                                    if (addEmtpyRow && idx == teachers.length - 1) {
                                        onUpdate({ $push: [tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { name: ev.target.value })] });
                                        _this.setState({ addEmtpyRow: false });
                                    }
                                    else if (ev.target.value || teacher.url) {
                                        onUpdate({ $splice: [[idx, 1, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { name: ev.target.value })]] });
                                    }
                                    else {
                                        if (_this.props.teachers.length === 1)
                                            _this.setState({ addEmtpyRow: true });
                                        onUpdate({ $splice: [[idx, 1]] });
                                    }
                                } })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", style: { width: "100%" }, value: teacher.url, onKeyDown: function (ev) {
                                    return ev.which === 9 &&
                                        !ev.shiftKey &&
                                        idx === teachers.length - 1 &&
                                        (teachers.length < 1 || !!teachers[teachers.length - 1].name &&
                                            (_this.setState({ addEmtpyRow: true }), ev.preventDefault()));
                                }, onChange: function (ev) {
                                    if (addEmtpyRow && idx == teachers.length - 1) {
                                        onUpdate({ $push: [tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { url: ev.target.value })] });
                                        _this.setState({ addEmtpyRow: false });
                                    }
                                    else if (ev.target.value || teacher.name) {
                                        onUpdate({ $splice: [[idx, 1, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, teacher, { url: ev.target.value })]] });
                                    }
                                    else {
                                        if (_this.props.teachers.length === 1)
                                            _this.setState({ addEmtpyRow: true });
                                        onUpdate({ $splice: [[idx, 1]] });
                                    }
                                } })));
                }))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () {
                    return _this.state.addEmtpyRow ?
                        _this.nameElem.focus() :
                        _this.setState({ addEmtpyRow: true });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-user-plus", "aria-hidden": true }),
                " L\u00E4gg till ansvarig l\u00E4rare"));
    };
    return EditableTeacherList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/editable-workflow-link.tsx":
/*!*********************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/editable-workflow-link.tsx ***!
  \*********************************************************************************/
/*! exports provided: EditableWorkFlowLink */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditableWorkFlowLink", function() { return EditableWorkFlowLink; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../modal-pages/edit-workflow-link */ "./src/components/course-builder/modal-pages/edit-workflow-link.tsx");



var EditableWorkFlowLink = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditableWorkFlowLink, _super);
    function EditableWorkFlowLink(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    EditableWorkFlowLink.prototype.render = function () {
        var _a = this.props, host = _a.host, onUpdate = _a.onUpdate, url = _a.url;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, url &&
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return host.openDialog({
                                Component: _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__["EditWorkflowLink"],
                                props: {
                                    url: url,
                                    onSave: function (newUrl) {
                                        onUpdate({ $set: newUrl });
                                        host.closeDialog();
                                    },
                                    onDelete: function () {
                                        onUpdate({ $set: undefined });
                                        host.closeDialog();
                                    }
                                }
                            }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: url, target: "_blank" }, "Nuvarande arbetsg\u00E5ng")))),
            !url && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return host.openDialog({
                    Component: _modal_pages_edit_workflow_link__WEBPACK_IMPORTED_MODULE_2__["EditWorkflowLink"],
                    props: {
                        onSave: function (newUrl) {
                            onUpdate({ $set: newUrl });
                            host.closeDialog();
                        }
                    }
                }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-paperclip", "aria-hidden": true }),
                " Koppla en arbetsg\u00E5ng till kursen"));
    };
    return EditableWorkFlowLink;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/knowledge-matrix.tsx":
/*!***************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/knowledge-matrix.tsx ***!
  \***************************************************************************/
/*! exports provided: KnowledgeMatrix */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeMatrix", function() { return KnowledgeMatrix; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



var KnowledgeMatrix = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KnowledgeMatrix, _super);
    function KnowledgeMatrix(props) {
        return _super.call(this, props) || this;
    }
    KnowledgeMatrix.prototype.render = function () {
        var _a = this.props, knowledgeRequirements = _a.knowledgeRequirements, markedIds = _a.markedIds, migratedIds = _a.migratedIds, explainedRequirements = _a.explainedRequirements;
        var _b = this.props, idsToMarkNotOk = _b.idsToMarkNotOk, markMode = _b.markMode, onMarkChanged = _b.onMarkChanged, onExplainedRequirementsChanged = _b.onExplainedRequirementsChanged;
        var columns = ["E", "C", "A"];
        var rows = [];
        var reqs = knowledgeRequirements.slice();
        var row = null;
        while (true) {
            row = columns.map(function (grade) {
                var pNext = reqs.findIndex(function (r) { return r.gradeStep && r.gradeStep.toUpperCase() === grade; });
                if (pNext < 0)
                    return null;
                var rv = reqs[pNext];
                reqs.splice(pNext, 1);
                return rv;
            });
            if (row.every(function (r) { return r === null; }))
                break;
            rows.push(row);
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                        var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;
                        var isMarkedNotOK = requirement && idsToMarkNotOk && idsToMarkNotOk[requirement.id];
                        var isMigrated = requirement && migratedIds && !!migratedIds[requirement.id];
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: requirement ? requirement.name : "" }, className: (markMode ? "selectable" : "") +
                                (isMigrated ? " migrated" : "") +
                                (isMarkedOK ?
                                    " markedGreen" :
                                    (isMarkedNotOK ?
                                        " markedRed" :
                                        "")), onClick: markMode && requirement ?
                                function () { return onMarkChanged(requirement.id, !isMarkedOK); } :
                                undefined, title: isMigrated ?
                                markMode ?
                                    "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
                                    "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
                                undefined });
                    })),
                    explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (requirement, j) {
                        var isMarkedOK = requirement && markedIds && markedIds.indexOf(requirement.id) >= 0;
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j }, isMarkedOK ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { placeholder: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Beskriv kravet"], ["Beskriv kravet"]))), className: "inputTextBox inputTextLarge", style: { width: "100%" }, readOnly: !markMode, value: explainedRequirements[requirement.id] || "", onChange: onExplainedRequirementsChanged && (function (ev) { return onExplainedRequirementsChanged(requirement.id, ev.target.value); }) }) : undefined);
                    }))); }))));
        { /*return <div>
          <table>
            <thead>
              <tr>
                <th>E</th>
                <th>C</th>
                <th>A</th>
              </tr>
            </thead>
            <tbody>
              {tbody.map((row, i) =>
              <tr key={i}>{row.map((cell, j) => {
                const isMarkedOK = props.markedIds && props.markedIds.indexOf(cell.id) >= 0;
                const isMarkedNotOK = props.idsToMarkNotOk && props.idsToMarkNotOk[cell.id];
                return <td
                  key={j}
                  rowSpan={cell.rowSpan}
                  className={(props.markMode ? "selectable" : "") +
                    (isMarkedOK ?
                      " markedGreen" :
                      (isMarkedNotOK ?
                        " markedRed":
                        ""))}
                  onClick={props.markMode && (()=>props.onMarkChanged(cell.id, !isMarkedOK))}>
                  {cell.html && <div style={{position: 'relative'}}>
                    <p
                      className={cell.type === 'ability' ? 'abilityText' : 'criteriaText'}
                      dangerouslySetInnerHTML={{__html: cell.html}} />
                    {props.editMode && <RemoveItem className="upperRight" onClick={()=>
                      this.setCellIds(
                        cell.type,
                        cell.rowIndex,
                        this.getCellIds(
                          cell.type,
                          cell.rowIndex).filter(id => id != cell.id) )} /> }
                  </div>}
                </td>})}
              </tr>)}
            </tbody>
          </table>
        </div>*/
        }
    };
    return KnowledgeMatrix;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/school-courses.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/school-courses.tsx ***!
  \*************************************************************************/
/*! exports provided: SchoolCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolCourses", function() { return SchoolCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../repos/school-courses */ "./src/repos/school-courses.ts");
/* harmony import */ var _spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");







var SchoolCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolCourses, _super);
    function SchoolCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            schoolCourses: null
        };
        _this.onSchoolCoursesUpdated = _this.onSchoolCoursesUpdated.bind(_this);
        return _this;
    }
    SchoolCourses.prototype.componentDidMount = function () {
        _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__["mySchoolCoursesRepo"].subscribe(this.onSchoolCoursesUpdated).catch(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showError"]);
    };
    SchoolCourses.prototype.componentWillUnmount = function () {
        _repos_school_courses__WEBPACK_IMPORTED_MODULE_3__["mySchoolCoursesRepo"].unsubscribe(this.onSchoolCoursesUpdated);
    };
    SchoolCourses.prototype.onSchoolCoursesUpdated = function (schoolCourses) {
        var compareName = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("name");
        var compareCreatedDate = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("createdDate");
        schoolCourses.sort(function (a, b) { return compareName(a, b) || compareCreatedDate(a, b); });
        this.setState({ schoolCourses: schoolCourses });
    };
    SchoolCourses.prototype.render = function () {
        var schoolCourses = this.state.schoolCourses;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, !schoolCourses ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                        " Laddar skolans kurser") :
                    schoolCourses.map(function (course) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "schoolCourse", key: course.id },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/" + course.id + "/edit", className: "editItem" })),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { to: "/courses/" + course.id + "/edit" }, course.name)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, course.active && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pill active" }, "Aktiv")),
                            course.active && !course.publishable && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pill incomplete" }, "Inkomplett"))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, course.description)),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, course.modifiedBy ?
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" },
                                "Redigerad av ",
                                course.modifiedBy.name,
                                " / ",
                                Object(_utils__WEBPACK_IMPORTED_MODULE_6__["shortDateFormat"])(course.modifiedDate)) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small", style: { fontStyle: 'italic' } }, " "))); })),
                location.hash !== "#/courses/new" && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_5__["Link"], { className: "btn", to: "/courses/new", onClick: function () { return window.scroll(0, 0); } }, "Skapa ny kurs")));
    };
    return SchoolCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/select-related-docs.tsx":
/*!******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/select-related-docs.tsx ***!
  \******************************************************************************/
/*! exports provided: SelectRelatedDocs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SelectRelatedDocs", function() { return SelectRelatedDocs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");




var SelectRelatedDocs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SelectRelatedDocs, _super);
    function SelectRelatedDocs(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    SelectRelatedDocs.prototype.render = function () {
        var _this = this;
        var _a = this.props, options = _a.options, title = _a.title, markedIds = _a.markedIds, markMode = _a.markMode, migratedIds = _a.migratedIds, uncoveredIds = _a.uncoveredIds;
        var groupedOptions = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToLookup"])(options, function (d) { return d.group || "default"; });
        var groups = Object.keys(groupedOptions);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: "larger" }, groups.map(function (group) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: group },
            groups.length === 1 ? null : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, group),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null)),
            groupedOptions[group].map(function (option) {
                var isMarked = markedIds.some(function (x) { return x === option.id; });
                var isMigrated = migratedIds && !!migratedIds[option.id];
                var isUncovered = uncoveredIds && uncoveredIds[option.id];
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: option.id, onClick: function () {
                        return markMode && _this.props.onMarkChanged(option.id, !isMarked);
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" +
                            (markMode ? " selectable" : "") +
                            (isMarked ? " markedGreen" : (isUncovered ?
                                " markedRed" :
                                "")) +
                            (isMigrated ? " migrated" : ""), title: isMigrated ?
                            markMode ?
                                "Skolverket har uppdaterat textens formulering. Du kan granska \u00E4ndringen genom att f\u00E4lla ut varningsboxen till h\u00F6ger, med titel \"Uppdaterade formuleringar fr\u00E5n Skolverket\"" :
                                "Skolverket har uppdaterat textens formulering, men detta har \u00E4nnu inte granskats av uppgiftens redigeringsbeh\u00F6rige" :
                            undefined },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: option.name } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)));
            })); }));
    };
    return SelectRelatedDocs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/sub-components/weighted-items-table.tsx":
/*!*******************************************************************************!*\
  !*** ./src/components/course-builder/sub-components/weighted-items-table.tsx ***!
  \*******************************************************************************/
/*! exports provided: WeightedItemsTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeightedItemsTable", function() { return WeightedItemsTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _courses_business_logic__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../courses/business-logic */ "./src/components/course-builder/courses/business-logic.ts");
/* harmony import */ var _contracts_ked_models__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../contracts/ked-models */ "./src/contracts/ked-models.ts");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");





var WeightedItemsTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeightedItemsTable, _super);
    function WeightedItemsTable(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isOpen: false
        };
        return _this;
    }
    WeightedItemsTable.prototype.render = function () {
        var course = this.props.course;
        var isOpen = this.state.isOpen;
        var rows = [];
        var tasksPerId = Object(_courses_business_logic__WEBPACK_IMPORTED_MODULE_2__["getTasksPerId"])(course);
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "centralContent", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "Centralt inneh\u00E5ll")));
        course.centralContent.forEach(function (cc, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: cc.id, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "criteriaText", dangerouslySetInnerHTML: { __html: cc.name } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[cc.id] || []).length)))); });
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "abilities", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "F\u00F6rm\u00E5gor")));
        course.abilities.forEach(function (ability, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: ability.id, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "abilityText", dangerouslySetInnerHTML: { __html: ability.name } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[ability.id] || []).length)))); });
        rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: "futureAbilities", className: "covered-item-label" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 }, "Framtidsf\u00F6rm\u00E5gor")));
        _contracts_ked_models__WEBPACK_IMPORTED_MODULE_3__["futureAbilities"].forEach(function (futureAbilityText, idx) { return rows.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: futureAbilityText, className: idx % 2 ? "tableOdd" : "" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "abilityText" }, futureAbilityText)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, (tasksPerId[futureAbilityText] || []).length)))); });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_4__["OpenCloseBox"], { className: "larger", title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kursens t\u00E4ckningstabell"), contentClassName: "weighted-items-table" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Tabellen anger hur m\u00E5nga uppgifter som ber\u00F6r varje del."),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows)));
    };
    return WeightedItemsTable;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts":
/*!*******************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/diff-xml-with-database.ts ***!
  \*******************************************************************************/
/*! exports provided: diffXmlWithDatabase */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "diffXmlWithDatabase", function() { return diffXmlWithDatabase; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _migrate_subject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./migrate-subject */ "./src/components/course-builder/subjects/diff/migrate-subject.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils */ "./src/components/course-builder/utils.ts");




function diffXmlWithDatabase(existingSubject, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var expandedCourseTemplates, courseSets;
        var _this = this;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.get('subjects', existingSubject.id, { include: ["courseTemplates", "abilities"] })];
                case 1:
                    // Expand graphs of existing Subject
                    existingSubject = _a.sent();
                    return [4 /*yield*/, Promise.all(existingSubject.courseTemplates.map(function (ct) { return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["loadCourse"])(ct.id, {
                            include: [
                                'centralContent',
                                'knowledgeRequirements'
                            ]
                        }); }))];
                case 2:
                    expandedCourseTemplates = _a.sent();
                    console.log("Subject: " + existingSubject.name + ". Courses: " + expandedCourseTemplates.map(function (_a) {
                        var name = _a.name;
                        return name;
                    }));
                    return [4 /*yield*/, Promise.all(expandedCourseTemplates.map(function (courseTemplate) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                switch (_b.label) {
                                    case 0:
                                        _a = {
                                            template: courseTemplate
                                        };
                                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].kedBackendClient.list("courses", { name: courseTemplate.name, include: ['abilities'], flags: ['includeIdsOnly'] })];
                                    case 1: return [2 /*return*/, (_a.instances = _b.sent(),
                                            _a)];
                                }
                            });
                        }); }))];
                case 3:
                    courseSets = _a.sent();
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    return [4 /*yield*/, Object(_migrate_subject__WEBPACK_IMPORTED_MODULE_2__["migrateSubject"])(existingSubject, courseSets, subjectToImport, changes)];
                case 4:
                    /*if (expandedCourseTemplates.some (course => !course.centralContentOrder || !course.knowledgeRequirementsOrder || !course.abilitiesOrder)) {
                      migrateOrderListsOfCourseInstances(courseSets, subjectToImport, changes);
                      // In future, as abilities may be added or removed, we will have to maintain the order of abilities on the course instances,
                      // the same way we do it with central content and knowledge requirements. TODO respect abilities order on every place abilities are enumerated,
                      // such as on course viewer, course builder, etc.
                      migrateAbilitiesOrderOnSubject(existingSubject, courseSets, changes);
                    } else {*/
                    _a.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/diff/migrate-subject.ts":
/*!************************************************************************!*\
  !*** ./src/components/course-builder/subjects/diff/migrate-subject.ts ***!
  \************************************************************************/
/*! exports provided: migrateSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "migrateSubject", function() { return migrateSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../globals/KED.env */ "./src/globals/KED.env.ts");




function diffSubjectGlobalTexts(dbTextMap, xmlTexts) {
    var e_1, _a;
    var removedIds = new Set();
    var newTexts = new Map();
    var idsToAdd = new Set();
    xmlTexts.forEach(function (newText) {
        newText = newText.trim();
        if (!dbTextMap.has(newText)) {
            var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["createUUID"])();
            console.log("New id: " + id + ". Text: " + newText);
            newTexts.set(newText, id);
            idsToAdd.add(id);
        }
        else {
            newTexts.set(newText, dbTextMap.get(newText));
        }
    });
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](dbTextMap.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {
            var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_c.value, 2), oldText = _d[0], oldId = _d[1];
            if (xmlTexts.indexOf(oldText) === -1) {
                removedIds.add(oldId);
            }
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return {
        removedIds: removedIds,
        newTexts: newTexts,
        idsToAdd: idsToAdd
    };
}
var _fictiveOldId = 1;
function fictiveOldId() {
    return "fictiveOldId" + (++_fictiveOldId);
}
var stopWords = new Set(
// From https://github.com/MihaiValentin/lunr-languages/blob/master/lunr.sv.js#L252
('alla allt att av blev bli blir blivit de dem den denna deras dess dessa det detta dig din dina ditt du där då efter ej eller en er era ert ett från för ha hade han hans har henne hennes hon honom hur här i icke ingen inom inte jag ju kan kunde man med mellan men mig min mina mitt mot mycket ni nu när någon något några och om oss på samma sedan sig sin sina sitta själv skulle som så sådan sådana sådant till under upp ut utan vad var vara varför varit varje vars vart vem vi vid vilka vilkas vilken vilket vår våra vårt än är åt över' +
    ' kring') // This line contains additional stop-words missing in lunr.sv.
    .split(' '));
function getLexemes(html) {
    return new Set(removeTags(html).replace(/[^\w\såäö]/gi, '').toLowerCase().split(/\s/)
        .map(function (lexeme) { return lexeme.trim(); })
        .filter(function (lexeme) { return !!lexeme; })
        .filter(function (lexeme) { return !stopWords.has(lexeme); }));
}
function removeTags(html) {
    var div = document.createElement('div');
    div.innerHTML = html;
    return '' + div.innerText;
}
function getIdsToMigrate(dbTexts, xmlTexts, newTexts, textType, course) {
    var idsToMigrate = new Map();
    dbTexts = dbTexts.map(function (entity) { return (tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, entity, { name: entity.name.trim() })); }).filter(function (_a) {
        var name = _a.name;
        return !!name;
    });
    var xmlSet = new Map();
    xmlTexts.forEach(function (item) { return xmlSet.set(item.html, item); });
    var dbSet = new Map();
    dbTexts.forEach(function (entity) { return dbSet.set(entity.name, entity); });
    // Remove those who already exists identically
    dbTexts = dbTexts.filter(function (entity) { return !xmlSet.has(entity.name); });
    xmlTexts = xmlTexts.filter(function (item) { return !dbSet.has(item.html); });
    // Now, for the remainder, try the best to map old texts to new texts, and when done, check if there are new texts that never got mapped.
    // Start by putting all dbText into the result, without a paired xml text yet:
    dbTexts.forEach(function (dbText) { return idsToMigrate.set(dbText.id, {
        gradeStep: dbText.gradeStep,
        oldText: dbText.name,
        lexemes: getLexemes(dbText.name),
        matchLevel: 0
    }); });
    // Then try to pair each xmlText to an item in idsToMigrate
    var xmlSpinsters = [];
    while (xmlTexts.length > 0) {
        var xmlText = xmlTexts[0];
        var bestMatch = findBestMatch(xmlText);
        if (!bestMatch) {
            xmlSpinsters.push(xmlText);
        }
        else {
            if (bestMatch.newText) {
                // Throw out existing match
                xmlTexts.push({ html: bestMatch.newText, gradeStep: bestMatch.gradeStep });
            }
            var pair = idsToMigrate.get(bestMatch.id);
            // Pair myself with this match:
            pair.newText = xmlText.html;
            pair.matchLevel = bestMatch.myMatchLevel;
            pair.newId = newTexts.get(xmlText.html);
        }
        xmlTexts.shift();
    }
    // For each spinster (new texts that couldn't find any match in old texts),
    // Add them with an fictive old ID but omit oldText to mark it as a newcomer
    xmlSpinsters.forEach(function (spinster) {
        idsToMigrate.set(fictiveOldId(), {
            newId: newTexts.get(spinster.html),
            newText: spinster.html,
            gradeStep: spinster.gradeStep,
            matchLevel: 0,
            lexemes: new Set()
        });
    });
    // Mark typo-fixes
    idsToMigrate.forEach(function (match) {
        var oldText = match.oldText, newText = match.newText;
        if (oldText && newText) {
            if (tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(oldText)).join(' ') === tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](getLexemes(newText)).join(' ')) {
                match.isTypoFix = true;
            }
        }
    });
    console.log("IdsToMigrate", tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.values()).map(function (_a) {
        var oldText = _a.oldText, lexemes = _a.lexemes;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](lexemes).join(' ') + ": " + oldText;
    }));
    return idsToMigrate;
    function findBestMatch(xmlText) {
        var xmlLexemes = getLexemes(xmlText.html);
        var possiblePartners = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](idsToMigrate.entries()).filter(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], x = _b[1];
            return x.gradeStep === xmlText.gradeStep;
        })
            .map(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), id = _b[0], _c = _b[1], gradeStep = _c.gradeStep, matchLevel = _c.matchLevel, newText = _c.newText, lexemes = _c.lexemes;
            return ({
                id: id,
                gradeStep: gradeStep,
                matchLevel: matchLevel,
                newText: newText,
                myMatchLevel: getMatchLevel(xmlLexemes, lexemes)
            });
        }).filter(function (pp) { return pp.myMatchLevel >= 50 && (!pp.matchLevel || pp.matchLevel < pp.myMatchLevel); });
        return possiblePartners.sort(function (a, b) { return b.myMatchLevel - a.myMatchLevel; })[0]; // highest first.
    }
    function getMatchLevel(lexemes1, lexemes2) {
        if (lexemes1.size === 0 || lexemes2.size === 0)
            return 0;
        var points1 = 0;
        var points2 = 0;
        lexemes1.forEach(function (word) {
            if (lexemes2.has(word))
                ++points1;
        });
        lexemes2.forEach(function (word) {
            if (lexemes1.has(word))
                ++points2;
        });
        return Math.round(100 * Math.max(points1 / lexemes1.size, points2 / lexemes2.size));
    }
    /*if (dbTexts.length !== xmlTexts.length) {
      // We can no longer assume that the changed texts refer to different formulations of the same meaning.
      // We not map old formulations to new ones.
      // In future, we could handle this case by assuming all old texts not occurring in new data, have been removed and all new have been added.
      throw new Error("Number of " + textType + (course ? ` on course ${course}` : "") + " differs. Cannot migrate.");
    }
    dbTexts.forEach(({name: oldText, id: oldId, gradeStep}, i) => {
      const xmlText = xmlTexts[i].trim();
      if (oldText.trim() !== xmlText) {
        idsToMigrate.set(oldId, {newText: xmlText, newId: newTexts.get(xmlText), oldText, gradeStep});
      }
    });
    return idsToMigrate;*/
}
function migrateSubject(existingSubject, courseSets, subjectToImport, changes) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        function migrateCourseInstance(course, courseToImport, idsToMigrate) {
            var showChanges = !shownChanges.has(course.name);
            shownChanges.add(course.name);
            abilityIdsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, oldText = _a.oldText;
                // Relink the course instance with abilities. This change does not need to be visible in GUI.
                changes.push({
                    mutations: function (br) {
                        if (oldText)
                            br.unlink2("courses", course.id, "abilities", oldId);
                        if (newId)
                            br.link2("courses", course.id, "abilities", newId);
                    }
                });
            });
            course.abilitiesOrder = subjectToImport.abilities.map(function (html) { return newAbilityTexts.get(html); });
            var ccsToMigrate = idsToMigrate.ccsToMigrate, krsToMigrate = idsToMigrate.krsToMigrate;
            // Central Content
            ccsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Centralt Inneh\u00E5ll" :
                                "Uppdaterat Centralt Inneh\u00E5ll" :
                            "Borttaget Centralt Inneh\u00E5ll" :
                        "Nytt Centralt Inneh\u00E5ll"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && ccsToAdd.has(newId) && !createdIds.has(newId)) {
                            var cc = {
                                id: newId,
                                name: newText,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            br.add("central-content", cc);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "centralContent", oldId);
                        if (newId)
                            br.link2("courses", course.id, "centralContent", newId);
                    }
                });
            });
            course.centralContentOrder = courseToImport.centralContent.map(function (_a) {
                var html = _a.html;
                return newCCTexts.get(html);
            });
            // Knowledge Requirements
            krsToMigrate.forEach(function (_a, oldId) {
                var newId = _a.newId, newText = _a.newText, gradeStep = _a.gradeStep, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                changes.push({
                    change: showChanges && (oldText ?
                        newText ?
                            isTypoFix ?
                                "Tryckfelsr\u00E4ttning Kunskapskrav" :
                                "Uppdaterat Kunskapskrav" :
                            "Borttaget Kunskapskrav" :
                        "Nytt Kunskapskrav"),
                    content: "<h4>" + course.name + "</h4><strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                    mutations: function (br) {
                        if (newId && krsToAdd.has(newId) && !createdIds.has(newId)) {
                            var kr = {
                                id: newId,
                                name: newText,
                                gradeStep: gradeStep,
                                acl: ["role:USER:R"],
                                dateTime: Date.now()
                            };
                            console.log("Adding Knowledge-Requirement " + newId + ": " + newText);
                            br.add("knowledge-requirements", kr);
                            createdIds.add(newId);
                        }
                        if (oldText)
                            br.unlink2("courses", course.id, "knowledgeRequirements", oldId);
                        if (newId)
                            br.link2("courses", course.id, "knowledgeRequirements", newId);
                    }
                });
            });
            course.knowledgeRequirementsOrder =
                courseToImport.knowledgeRequirements.map(function (kr) { return newKRTexts.get(kr.html); });
            // Updates the course properties centralContentOrder and knowledgeRequirementsOrder
            if (abilityIdsToMigrate.size > 0 || ccsToMigrate.size > 0 || krsToMigrate.size > 0) {
                changes.push({
                    change: !course.isTemplate ? "Uppdaterad Kursinstans" : "Uppdaterad Kursmall",
                    content: !course.isTemplate ?
                        course.name + ". Skola: " + (course.school || "ej angiven") + ". Beskrivning: " + (course.description || '') :
                        "" + course.name,
                    mutations: function (br) { return br.put("courses", course); }
                });
            }
        }
        // Tasks:
        // 1. ASYNC OPERATION: Go through all tasks that has edges to any of the old ids.
        // 2. For each found task, do:
        //    A: Iterate tags starting with "course:". Pick the course code.
        //    B: Populate the new property migrationTasks: {
        //         abilities: {[newId: string]: {oldText: string, oldId: string, importDate: number}}, // Be able to create a chain in the GUI !
        //         centralContent: {[newId: string]: {oldText: string, ..."...}},
        //         knowledgeRequirements: {[newId: string]: {oldText: string, ..."...}},
        //       }
        //       OBS1! Mergea abilities, centralCondent och knowledgeRequirements med ev tidigare värden (så man kan importera om och om igen!)
        //       OBS2! oldId kan förekomma på flera newId om task används av flera kurser. 
        //    C: Create sets for unlinks and link operations per type.
        //    D: For all courseCodes that the task is taggen on,
        //         * register ccsToMigrate.keys() in the unlink set of central contents
        //         * register ccsToMigrate.values() in the link set of central contents
        //         * --"-- for knowledgeRequirements
        //    E: unlink and link with regards to abilityIdsToMigrate (keys() and values() respectively).
        //    F: unlink and link according to the created sets of link / unlink operations.
        //    Note: Unlike course instances, there's no order property to take care of here!
        //
        function migrateTasks() {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                function fetchTasksInChunksWithEdgesTo(ids, options) {
                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
                        var result;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                            switch (_a.label) {
                                case 0:
                                    // This function should make work around the case when given "ids" contains too many items, by
                                    // dividing the requests into several and merge the result using a Map.
                                    if (ids.length === 0)
                                        return [2 /*return*/, []]; // Otherwise we'll request every task in the system.
                                    result = new Map();
                                    console.log("Number of ids: " + ids.length);
                                    return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("tasks", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options, { hasEdgesTo: ids }))];
                                case 1: 
                                //return result.values();
                                return [2 /*return*/, _a.sent()];
                            }
                        });
                    });
                }
                var e_7, _a, oldIds, importDate, tasks, _loop_2, tasks_1, tasks_1_1, task;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            oldIds = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](abilityIdsToMigrate.keys(), Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(idsToMigratePerCourse.map(function (c) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](c.ccsToMigrate.keys(), c.krsToMigrate.keys()); }))).filter(function (id) { return !id.startsWith('fictiveOldId'); });
                            importDate = Date.now();
                            return [4 /*yield*/, fetchTasksInChunksWithEdgesTo(oldIds, {
                                    include: ["abilities", "knowledgeRequirements", "centralContent"],
                                    flags: ["includeIdsOnly"]
                                })];
                        case 1:
                            tasks = _b.sent();
                            _loop_2 = function (task) {
                                var e_8, _a, e_9, _b, e_10, _c, e_11, _d;
                                var oldMT = task.migratedTexts || {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                task.migratedTexts = {
                                    abilities: {},
                                    centralContent: {},
                                    knowledgeRequirements: {}
                                };
                                var mutations = [];
                                var changeDescriptions = [];
                                var _loop_3 = function (id) {
                                    var migrationInfo = abilityIdsToMigrate.get(id);
                                    if (migrationInfo) {
                                        var newId_1 = migrationInfo.newId, newText = migrationInfo.newText, isTypoFix = migrationInfo.isTypoFix;
                                        var oldText = migrationInfo.oldText;
                                        var oldId = id;
                                        if (oldMT.abilities[id]) {
                                            // If migrating stuff that was never acknowledges by a teacher,
                                            // We should point out the very old id and text instead of the never-acknowledged one.
                                            oldText = oldMT.abilities[id].oldText;
                                            oldId = oldMT.abilities[id].oldId;
                                        }
                                        if (newId_1 && oldText !== newText) {
                                            // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                            if (!isTypoFix) {
                                                // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                task.migratedTexts.abilities[newId_1] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                            }
                                        }
                                        mutations.push(function (br) {
                                            br.unlink2("tasks", task.id, "abilities", id);
                                            if (newId_1)
                                                br.link2("tasks", task.id, "abilities", newId_1);
                                        });
                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                        if (newId_1) {
                                            changeDescriptions.push(newText);
                                        }
                                    }
                                };
                                try {
                                    for (var _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.abilities), _f = _e.next(); !_f.done; _f = _e.next()) {
                                        var id = _f.value.id;
                                        _loop_3(id);
                                    }
                                }
                                catch (e_8_1) { e_8 = { error: e_8_1 }; }
                                finally {
                                    try {
                                        if (_f && !_f.done && (_a = _e.return)) _a.call(_e);
                                    }
                                    finally { if (e_8) throw e_8.error; }
                                }
                                var taskCourseCodes = new Set(task.tags ?
                                    task.tags.filter(function (t) { return t.startsWith('course:'); }).map(function (t) { return t.substr("course:".length); }) :
                                    []);
                                // We need to keep track of linkedIds (for this particular task) for the following reason:
                                // Let's say the task was referred to by two different courses (possible in old versions),
                                // and in old Central Content, the two courses did have slightly different formulations of central content,
                                // so the task was mapped to both of them. Then, in new XML, the same central content was formulated
                                // in a new way that is identical this time between the two courses. Then both old IDs will be replaced
                                // by a single new ID. It would then be unnescessary to link to the new ID twice.
                                var linkedIds = new Set();
                                try {
                                    for (var idsToMigratePerCourse_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](idsToMigratePerCourse), idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next(); !idsToMigratePerCourse_1_1.done; idsToMigratePerCourse_1_1 = idsToMigratePerCourse_1.next()) {
                                        var _g = idsToMigratePerCourse_1_1.value, krsToMigrate = _g.krsToMigrate, ccsToMigrate = _g.ccsToMigrate, courseCode = _g.courseCode;
                                        if (taskCourseCodes.size === 0 || taskCourseCodes.has(courseCode)) {
                                            var _loop_4 = function (id) {
                                                var migrationInfo = ccsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_2 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.centralContent[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.centralContent[id].oldText;
                                                        oldId = oldMT.centralContent[id].oldId;
                                                    }
                                                    if (newId_2 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.centralContent[newId_2] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_2 || !linkedIds.has(newId_2)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "centralContent", id);
                                                            if (newId_2)
                                                                br.link2("tasks", task.id, "centralContent", newId_2);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_2) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_2);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _h = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.centralContent), _j = _h.next(); !_j.done; _j = _h.next()) {
                                                    var id = _j.value.id;
                                                    _loop_4(id);
                                                }
                                            }
                                            catch (e_10_1) { e_10 = { error: e_10_1 }; }
                                            finally {
                                                try {
                                                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                                                }
                                                finally { if (e_10) throw e_10.error; }
                                            }
                                            var _loop_5 = function (id) {
                                                var migrationInfo = krsToMigrate.get(id);
                                                if (migrationInfo) {
                                                    var newId_3 = migrationInfo.newId, newText = migrationInfo.newText, oldText = migrationInfo.oldText, isTypoFix = migrationInfo.isTypoFix;
                                                    var oldId = id;
                                                    if (oldMT.knowledgeRequirements[id]) {
                                                        // If migrating stuff that was never acknowledges by a teacher,
                                                        // We should point out the very old id and text instead of the never-acknowledged one.
                                                        oldText = oldMT.knowledgeRequirements[id].oldText;
                                                        oldId = oldMT.knowledgeRequirements[id].oldId;
                                                    }
                                                    if (newId_3 && oldText !== newText) {
                                                        // Special case: If oldText === newText, then this is a reimport new XML that reverts back to origin text. Don't require acknowledgement from teacher!
                                                        if (!isTypoFix) {
                                                            // If this wasn't just a typo fix (changes in stop words, casing or special characters)
                                                            task.migratedTexts.knowledgeRequirements[newId_3] = { oldId: oldId, oldText: oldText, importDate: importDate };
                                                        }
                                                    }
                                                    if (!newId_3 || !linkedIds.has(newId_3)) {
                                                        mutations.push(function (br) {
                                                            br.unlink2("tasks", task.id, "knowledgeRequirements", id);
                                                            if (newId_3)
                                                                br.link2("tasks", task.id, "knowledgeRequirements", newId_3);
                                                        });
                                                        changeDescriptions.push("<strike>" + oldText + "</strike>");
                                                        if (newId_3) {
                                                            changeDescriptions.push(newText);
                                                            linkedIds.add(newId_3);
                                                        }
                                                    }
                                                }
                                            };
                                            try {
                                                for (var _k = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](task.knowledgeRequirements), _l = _k.next(); !_l.done; _l = _k.next()) {
                                                    var id = _l.value.id;
                                                    _loop_5(id);
                                                }
                                            }
                                            catch (e_11_1) { e_11 = { error: e_11_1 }; }
                                            finally {
                                                try {
                                                    if (_l && !_l.done && (_d = _k.return)) _d.call(_k);
                                                }
                                                finally { if (e_11) throw e_11.error; }
                                            }
                                        }
                                    }
                                }
                                catch (e_9_1) { e_9 = { error: e_9_1 }; }
                                finally {
                                    try {
                                        if (idsToMigratePerCourse_1_1 && !idsToMigratePerCourse_1_1.done && (_b = idsToMigratePerCourse_1.return)) _b.call(idsToMigratePerCourse_1);
                                    }
                                    finally { if (e_9) throw e_9.error; }
                                }
                                changes.push({
                                    change: "Migrerad Uppgift",
                                    content: "<h4>" + task.name + " " + (task.school ? "(" + task.school + ") " : '(skola ej angiven)') + "</h4>\n          <p>Kurskod: " + tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](taskCourseCodes).join(',') + "</p>\n          " + changeDescriptions.map(function (txt) { return "<p>" + txt + "</p>"; }).join(''),
                                    mutations: function (br) {
                                        br.put("tasks", task);
                                        mutations.forEach(function (m) { return m(br); });
                                    }
                                });
                            };
                            try {
                                /*const tasks = await env.kedBackendClient.list<Task>("tasks", {
                                  hasEdgesTo: oldIds,
                                  include: ["abilities", "knowledgeRequirements", "centralContent"],
                                  flags: ["includeIdsOnly"]
                                });*/
                                for (tasks_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](tasks), tasks_1_1 = tasks_1.next(); !tasks_1_1.done; tasks_1_1 = tasks_1.next()) {
                                    task = tasks_1_1.value;
                                    _loop_2(task);
                                }
                            }
                            catch (e_7_1) { e_7 = { error: e_7_1 }; }
                            finally {
                                try {
                                    if (tasks_1_1 && !tasks_1_1.done && (_a = tasks_1.return)) _a.call(tasks_1);
                                }
                                finally { if (e_7) throw e_7.error; }
                            }
                            return [2 /*return*/];
                    }
                });
            });
        }
        var e_2, _a, e_3, _b, e_4, _c, e_5, _d, e_6, _e, dbTextMap, orderedAbilities, orderedAbilities_1, orderedAbilities_1_1, a, courseSets_1, courseSets_1_1, template, _f, _g, cc, _h, _j, kr, _k, newAbilityTexts, abilitiesToAdd, _l, newCCTexts, ccsToAdd, _m, newKRTexts, krsToAdd, abilityIdsToMigrate, idsToMigratePerCourse, createdIds, shownChanges, _loop_1, courseSets_2, courseSets_2_1, _o, template, instances;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_p) {
            switch (_p.label) {
                case 0:
                    dbTextMap = new Map();
                    orderedAbilities = existingSubject.abilitiesOrder ?
                        existingSubject.abilitiesOrder.map(function (id) { return existingSubject.abilities.find(function (a) { return a.id === id; }); }) :
                        existingSubject.abilities;
                    try {
                        for (orderedAbilities_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](orderedAbilities), orderedAbilities_1_1 = orderedAbilities_1.next(); !orderedAbilities_1_1.done; orderedAbilities_1_1 = orderedAbilities_1.next()) {
                            a = orderedAbilities_1_1.value;
                            dbTextMap.set(a.name.trim(), a.id);
                        }
                    }
                    catch (e_2_1) { e_2 = { error: e_2_1 }; }
                    finally {
                        try {
                            if (orderedAbilities_1_1 && !orderedAbilities_1_1.done && (_a = orderedAbilities_1.return)) _a.call(orderedAbilities_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                    }
                    try {
                        for (courseSets_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_1_1 = courseSets_1.next(); !courseSets_1_1.done; courseSets_1_1 = courseSets_1.next()) {
                            template = courseSets_1_1.value.template;
                            try {
                                for (_f = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.centralContent), _g = _f.next(); !_g.done; _g = _f.next()) {
                                    cc = _g.value;
                                    dbTextMap.set(cc.name.trim(), cc.id);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_g && !_g.done && (_c = _f.return)) _c.call(_f);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            try {
                                for (_h = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](template.knowledgeRequirements), _j = _h.next(); !_j.done; _j = _h.next()) {
                                    kr = _j.value;
                                    dbTextMap.set(kr.name.trim(), kr.id);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (_j && !_j.done && (_d = _h.return)) _d.call(_h);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        }
                    }
                    catch (e_3_1) { e_3 = { error: e_3_1 }; }
                    finally {
                        try {
                            if (courseSets_1_1 && !courseSets_1_1.done && (_b = courseSets_1.return)) _b.call(courseSets_1);
                        }
                        finally { if (e_3) throw e_3.error; }
                    }
                    _k = diffSubjectGlobalTexts(dbTextMap, subjectToImport.abilities), newAbilityTexts = _k.newTexts, abilitiesToAdd = _k.idsToAdd;
                    _l = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.centralContent.map(function (cc) { return cc.html; }); }))), newCCTexts = _l.newTexts, ccsToAdd = _l.idsToAdd;
                    _m = diffSubjectGlobalTexts(dbTextMap, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(subjectToImport.courses.map(function (c) { return c.knowledgeRequirements.map(function (kr) { return kr.html; }); }))), newKRTexts = _m.newTexts, krsToAdd = _m.idsToAdd;
                    console.log("Abilities to add: " + abilitiesToAdd.size);
                    console.log("CCs to add: " + ccsToAdd.size);
                    console.log("KRs to add: " + krsToAdd.size);
                    abilityIdsToMigrate = getIdsToMigrate(orderedAbilities, subjectToImport.abilities.map(function (html) { return ({ html: html }); }), newAbilityTexts, "abilities");
                    idsToMigratePerCourse = courseSets.map(function (_a, i) {
                        var template = _a.template;
                        console.log("Course: " + template.name);
                        var xmlCourse = subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; });
                        return {
                            courseCode: template.code,
                            ccsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.centralContent, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.centralContent.map(function (_a) {
                                    var html = _a.html;
                                    return ({ html: html });
                                }), newCCTexts, "central content", template.name) :
                                new Map(),
                            krsToMigrate: xmlCourse ?
                                getIdsToMigrate(template.knowledgeRequirements, // Has already been sorted when retrieved via loadCourse()
                                xmlCourse.knowledgeRequirements, newKRTexts, "knowledge requirements", template.name) :
                                new Map()
                        };
                    });
                    // OK so now we have all info.
                    // Now, we need to:
                    // Subject:
                    // 1. Remove links from subjects to abilities
                    // 2. Add links from subjects to abilities
                    abilityIdsToMigrate.forEach(function (_a, oldId) {
                        var newText = _a.newText, newId = _a.newId, oldText = _a.oldText, isTypoFix = _a.isTypoFix;
                        //const oldText = existingSubject.abilities.find(a => a.id === oldId).name;
                        changes.push({
                            change: (oldText ?
                                newText ?
                                    isTypoFix ?
                                        "Tryckfelsr\u00E4ttning F\u00F6rm\u00E5ga" :
                                        "Uppdaterad F\u00F6rm\u00E5ga" :
                                    "Borttagen F\u00F6rm\u00E5ga" :
                                "Ny F\u00F6rm\u00E5ga"),
                            content: "<strike>" + (oldText || '') + "</strike><br/>" + (newText || ''),
                            mutations: function (br) {
                                if (newId && abilitiesToAdd.has(newId)) {
                                    var a = {
                                        id: newId,
                                        name: newText,
                                        acl: ["role:USER:R"],
                                        dateTime: Date.now()
                                    };
                                    br.add("abilities", a);
                                }
                                if (oldText)
                                    br.unlink2("subjects", existingSubject.id, "abilities", oldId);
                                if (newId)
                                    br.link2("subjects", existingSubject.id, "abilities", newId);
                            }
                        });
                    });
                    // 3. Update abilitiesOrder on Subject based on subjectToImport.abilities (mapped to ids in newTexts)
                    if (!existingSubject.abilitiesOrder || abilityIdsToMigrate.size > 0) {
                        existingSubject.abilitiesOrder = subjectToImport.abilities.map(function (xml) { return newAbilityTexts.get(xml); });
                        changes.push({
                            mutations: function (br) { return br.put("subjects", existingSubject); },
                            change: existingSubject.abilitiesOrder ?
                                null : // Ändringen redan visuell som "Uppdaterad för förmåga", etc, ovan
                                "Inf\u00F6r en ordnad lista p\u00E5 f\u00F6rm\u00E5gor i databasen",
                        });
                    }
                    createdIds = new Set();
                    changes.push({ mutations: function () { return createdIds.clear(); } }); // In case mutations run twice (which it doesn't as of current impl.)
                    shownChanges = new Set();
                    changes.push({ mutations: function () { return shownChanges.clear(); } });
                    _loop_1 = function (template, instances) {
                        var e_12, _a;
                        // Find courseToImport
                        var courseToImport = (subjectToImport.courses.find(function (c) { return c.name === template.name; }) ||
                            subjectToImport.courses.find(function (c) { return c.code === template.code; }));
                        // Find Central Content and Knowledge Requirements to migrate
                        var _b = idsToMigratePerCourse.find(function (x) { return x.courseCode === template.code; }), ccsToMigrate = _b.ccsToMigrate, krsToMigrate = _b.krsToMigrate;
                        try {
                            // Loop through all course instances (instances also contains templates)
                            // and migrate them. This will include creating missing entities in the DB.
                            for (var instances_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](instances), instances_1_1 = instances_1.next(); !instances_1_1.done; instances_1_1 = instances_1.next()) {
                                var course = instances_1_1.value;
                                migrateCourseInstance(course, courseToImport, { ccsToMigrate: ccsToMigrate, krsToMigrate: krsToMigrate });
                            }
                        }
                        catch (e_12_1) { e_12 = { error: e_12_1 }; }
                        finally {
                            try {
                                if (instances_1_1 && !instances_1_1.done && (_a = instances_1.return)) _a.call(instances_1);
                            }
                            finally { if (e_12) throw e_12.error; }
                        }
                    };
                    try {
                        // Courses:
                        // 1. Go through all course instances and:
                        //      A: Remove links from courses to abilities listed in abilityIdsToMigrate.keys()
                        //      B: Add links from courses to abilities abiltitiesToMigrate.values()
                        //      C: Update abilitiesOrder on course instances based on subjectToImport (mapped to ids in newTexts)
                        // 2, 3: Do the same for central-content and knowledge-requirementes:
                        //    Find ccs and krs to migrate based on courseInstance.code
                        //    For both ccs and krs, do:
                        //      A: Unlink ccsToMigrate.keys()
                        //      B: Link ccsToMigrate.values()
                        //      C: Update centralContentOrder based on subjectToImport.centralContent mapped to newTexts ids
                        //      (same for krsToMigrate, with knowledgeRequirementsOrder instead)
                        for (courseSets_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](courseSets), courseSets_2_1 = courseSets_2.next(); !courseSets_2_1.done; courseSets_2_1 = courseSets_2.next()) {
                            _o = courseSets_2_1.value, template = _o.template, instances = _o.instances;
                            _loop_1(template, instances);
                        }
                    }
                    catch (e_6_1) { e_6 = { error: e_6_1 }; }
                    finally {
                        try {
                            if (courseSets_2_1 && !courseSets_2_1.done && (_e = courseSets_2.return)) _e.call(courseSets_2);
                        }
                        finally { if (e_6) throw e_6.error; }
                    }
                    return [4 /*yield*/, migrateTasks()];
                case 1:
                    _p.sent();
                    return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-builder/subjects/index.tsx":
/*!**********************************************************!*\
  !*** ./src/components/course-builder/subjects/index.tsx ***!
  \**********************************************************/
/*! exports provided: ShowSubject, Subjects */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subjects", function() { return Subjects; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _show_subject__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./show-subject */ "./src/components/course-builder/subjects/show-subject.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return _show_subject__WEBPACK_IMPORTED_MODULE_3__["ShowSubject"]; });

/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _subjects_inner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./subjects-inner */ "./src/components/course-builder/subjects/subjects-inner.tsx");






var Subjects = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Subjects, _super);
    function Subjects(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isListingSubjects: true,
            primarySchoolSubjects: [],
            uploadedSubject: null
        };
        return _this;
    }
    Subjects.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_4__["CourseBanner"], { title: Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnen"], ["\u00C4mnen"]))), activePage: "subjects", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subjects_inner__WEBPACK_IMPORTED_MODULE_5__["SubjectsInner"], { linkPrefix: "/subjects/" }));
    };
    return Subjects;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject-inner.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject-inner.tsx ***!
  \***********************************************************************/
/*! exports provided: ShowSubjectInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubjectInner", function() { return ShowSubjectInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");




var ShowSubjectInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubjectInner, _super);
    function ShowSubjectInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubjectInner.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubjectInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubjectInner.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_3__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, schoolType === 'primary' ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Grundskole\u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, code = _a.code, publishable = _a.publishable, points = _a.points, schoolGrade = _a.schoolGrade;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " f\u00F6r \u00E5rskurs ",
                    schoolGrade);
            }))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                "Kurser f\u00F6r \u00E4mnet ",
                name,
                " (",
                code,
                ")"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", { className: "entity-list" }, courseTemplates.map(function (_a) {
                var id = _a.id, name = _a.name, code = _a.code, publishable = _a.publishable, points = _a.points;
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: id, className: "complete" },
                    name,
                    " - ",
                    points,
                    "p");
            }))));
    };
    return ShowSubjectInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/show-subject.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/course-builder/subjects/show-subject.tsx ***!
  \*****************************************************************/
/*! exports provided: ShowSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return ShowSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _courses_course_banner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../courses/course-banner */ "./src/components/course-builder/courses/course-banner.tsx");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _show_subject_inner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./show-subject-inner */ "./src/components/course-builder/subjects/show-subject-inner.tsx");






var ShowSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ShowSubject, _super);
    function ShowSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { subject: null };
        return _this;
    }
    ShowSubject.prototype.componentWillMount = function () {
        this.load();
    };
    ShowSubject.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subject;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.get('subjects', this.props.id, { include: 'courseTemplates' })];
                    case 1:
                        subject = _a.sent();
                        this.setState({ subject: subject });
                        return [2 /*return*/];
                }
            });
        });
    };
    ShowSubject.prototype.render = function () {
        if (!this.state.subject)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null));
        var _a = this.state.subject, name = _a.name, code = _a.code, courseTemplates = _a.courseTemplates, schoolType = _a.schoolType;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_courses_course_banner__WEBPACK_IMPORTED_MODULE_3__["CourseBanner"], { title: name, activePage: "subjects", routes: { feedback: this.props.feedbackUrl } }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_show_subject_inner__WEBPACK_IMPORTED_MODULE_5__["ShowSubjectInner"], { id: this.props.id }));
    };
    return ShowSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder/subjects/skolverket-subject.ts":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/subjects/skolverket-subject.ts ***!
  \**********************************************************************/
/*! exports provided: parseSkolverketYears */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseSkolverketYears", function() { return parseSkolverketYears; });
function parseSkolverketYears(inYear) {
    switch (inYear.trim()) {
        case '3':
        case '1-3':
            return ['1-3'];
        case '6':
        case '4-6':
            return ['4-6'];
        case '7-9':
        case '9':
            return ['7-9'];
        // Specials
        case '1': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1s': return ["1-3"]; // Förekommer i ämnena "Svenska" och "Svenska som andraspråk"
        case '1-6': return ["1-3", "4-6"]; // Förekommer i ämnet "Hem- och konsumentkunskap"
        case '4-9': return ["4-6", "7-9"]; // Förekommer i ämnet "Moderna språk"
        default: {
            throw new Error("Unexpected year in Skolverket XML: " + inYear + ". Expecting 3,6,9 or 1-3, 4-6, 7-9");
        }
    }
}


/***/ }),

/***/ "./src/components/course-builder/subjects/subjects-inner.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/course-builder/subjects/subjects-inner.tsx ***!
  \*******************************************************************/
/*! exports provided: ShowSubject, SubjectsInner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubjectsInner", function() { return SubjectsInner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _skolverket_subject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./skolverket-subject */ "./src/components/course-builder/subjects/skolverket-subject.ts");
/* harmony import */ var _uploaded_subject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./uploaded-subject */ "./src/components/course-builder/subjects/uploaded-subject.tsx");
/* harmony import */ var _show_subject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./show-subject */ "./src/components/course-builder/subjects/show-subject.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ShowSubject", function() { return _show_subject__WEBPACK_IMPORTED_MODULE_7__["ShowSubject"]; });

/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-router-dom */ "./node_modules/react-router-dom/es/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");











var SubjectsInner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SubjectsInner, _super);
    function SubjectsInner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isListingSubjects: true,
            gymnasiumSubjects: [],
            primarySchoolSubjects: [],
            uploadedSubject: null
        };
        return _this;
    }
    SubjectsInner.prototype.componentWillMount = function () {
        this.load();
    };
    SubjectsInner.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var subjects, gymnasiumSubjects, primarySchoolSubjects;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        subjects = _a.sent();
                        subjects.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["compareProp"])("name"));
                        gymnasiumSubjects = subjects.filter(function (s) { return s.schoolType !== 'primary'; });
                        primarySchoolSubjects = subjects.filter(function (s) { return s.schoolType === 'primary'; });
                        this.setState({ gymnasiumSubjects: gymnasiumSubjects, primarySchoolSubjects: primarySchoolSubjects, isListingSubjects: false });
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.handleFileSelect = function (ev) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var files, xml, doc, typeOfSchooling, schoolType, model, courses, i, course, knownledgeRequirements, centralContents, knowledgeRequirements, centralContentsByStadium_1, knowledgeRequirementsByStadium_1, subjectName_1, subjectCode_1, subjectPurpose, coursesByStadium, model;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        ev.stopPropagation();
                        ev.preventDefault();
                        files = ev.dataTransfer.files;
                        return [4 /*yield*/, Object(_utils__WEBPACK_IMPORTED_MODULE_9__["readBlobAsText"])(files[0])];
                    case 1:
                        xml = _a.sent();
                        doc = jquery__WEBPACK_IMPORTED_MODULE_4___default()(jquery__WEBPACK_IMPORTED_MODULE_4___default.a.parseXML(xml));
                        typeOfSchooling = doc.find("subject>originatorTypeOfSchooling").text().trim() ||
                            doc.find("subject>typeOfSchooling").text().trim();
                        schoolType = typeOfSchooling === "COMPULSORY_SCHOOL" ?
                            'primary' :
                            typeOfSchooling === "UPPER_SECONDARY_EDUCATION" ?
                                'gymnasium' :
                                null;
                        if (schoolType === 'gymnasium') {
                            model = {
                                name: doc.find("subject>name").text().trim(),
                                code: doc.find("subject>code").text().trim(),
                                purpose: doc.find("subject>purpose").text().trim(),
                                courses: [],
                                schoolType: 'gymnasium'
                            };
                            courses = doc.find("subject>courses");
                            for (i = 0; i < courses.length; ++i) {
                                course = jquery__WEBPACK_IMPORTED_MODULE_4___default()(courses[i]);
                                knownledgeRequirements = [].slice.call(course.find("knowledgeRequirements"))
                                    .map(function (r) { return ({
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('gradeStep').text().trim(),
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(r).find('text').text().trim()
                                }); });
                                model.courses.push({
                                    name: course.find("name").text().trim(),
                                    code: course.find("code").text().trim(),
                                    centralContent: course.find("centralContent").text().trim(),
                                    points: parseInt(course.find("point").text().trim()),
                                    knownledgeRequirements: knownledgeRequirements,
                                });
                            }
                            this.setState({ uploadedSubject: model });
                        }
                        else {
                            centralContents = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>centralContent"))
                                .map(function (cc) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('year').text().trim();
                                var typeOfCentralContent = jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('typeOfCentralContent').text().trim();
                                if (typeOfCentralContent) {
                                    // Do not yet support multiple types of central content.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av centralt inneh\u00E5ll. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                var stadiums = Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year);
                                var centralContentsForEachStadium = stadiums.map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(cc).find('text').text().trim()
                                }); });
                                return centralContentsForEachStadium;
                            }));
                            knowledgeRequirements = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["flatten"])(Array.from(doc.find("subject>knowledgeRequirement"))
                                .map(function (kr) {
                                var year = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('year').text().trim();
                                var typeOfRequirement = jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('typeOfRequirement').text().trim();
                                if (typeOfRequirement) {
                                    // Do not yet support multiple types of knowledge requirement.
                                    throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."], ["\u00C4mnet inneh\u00E5ller flera parallella typer av kunskapskrav. Detta st\u00F6ds \u00E4nnu inte."]))));
                                }
                                return Object(_skolverket_subject__WEBPACK_IMPORTED_MODULE_5__["parseSkolverketYears"])(year).map(function (stadium) { return ({
                                    year: stadium,
                                    text: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('text').text().trim(),
                                    gradeStep: jquery__WEBPACK_IMPORTED_MODULE_4___default()(kr).find('gradeStep').text().trim()
                                }); });
                            }));
                            centralContentsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(centralContents, function (cc) { return cc.year; });
                            knowledgeRequirementsByStadium_1 = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(knowledgeRequirements, function (kr) { return kr.year; });
                            subjectName_1 = doc.find("subject>name").text().trim();
                            subjectCode_1 = doc.find("subject>code").text().trim();
                            subjectPurpose = doc.find("subject>purpose").text().trim();
                            coursesByStadium = ['1-3', '4-6', '7-9']
                                .map(function (stadium) { return ({
                                name: subjectName_1 + ' ' + stadium,
                                code: subjectCode_1 + '|' + stadium,
                                points: 0,
                                year: stadium,
                                centralContent: (centralContentsByStadium_1[stadium] || []).map(function (cc) { return cc.text; }).join('\n'),
                                knownledgeRequirements: (knowledgeRequirementsByStadium_1[stadium] || []).map(function (_a) {
                                    var gradeStep = _a.gradeStep, text = _a.text;
                                    return ({ gradeStep: gradeStep, text: text });
                                })
                            }); });
                            model = {
                                name: subjectName_1,
                                code: subjectCode_1,
                                purpose: subjectPurpose,
                                schoolType: 'primary',
                                courses: coursesByStadium
                            };
                            this.setState({ uploadedSubject: model });
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    SubjectsInner.prototype.onImportSuccess = function (subject) {
        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Importen av ", " lyckades"], ["Importen av ", " lyckades"])), subject));
        this.setState({ uploadedSubject: null });
        this.load();
    };
    SubjectsInner.prototype.render = function () {
        var _this = this;
        var linkPrefix = this.props.linkPrefix;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, this.state.uploadedSubject ?
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_uploaded_subject__WEBPACK_IMPORTED_MODULE_6__["UploadedSubject"], { onCancel: function () { return _this.setState({ uploadedSubject: null }); }, onImportSuccess: function (subject) { return _this.onImportSuccess(subject); }, subject: this.state.uploadedSubject })
            : this.state.isListingSubjects ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_sub_components_spinner__WEBPACK_IMPORTED_MODULE_10__["Spinner"], null),
                        "Var god v\u00E4nta medan \u00E4mnen h\u00E4mtas...")) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Gymnasie\u00E4mnen"], ["Gymnasie\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.gymnasiumSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Grundskole\u00E4mnen"], ["Grundskole\u00E4mnen"])))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("ul", null, this.state.primarySchoolSubjects.map(function (s) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("li", { key: s.id, className: s.publishable ? "complete" : "incomplete" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_router_dom__WEBPACK_IMPORTED_MODULE_8__["Link"], { to: linkPrefix + s.id }, s.name));
                    })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone", onDragOver: _utils__WEBPACK_IMPORTED_MODULE_9__["allowCopy"], onDrop: function (ev) { return _this.handleFileSelect(ev); } },
                        "Droppa Subject-fil h\u00E4r fr\u00E5n skolverket (H\u00E4mtas fr\u00E5n ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "http://opendata.skolverket.se", target: "skolverket" }, "opendata.skolverket.se"),
                        ")")));
    };
    return SubjectsInner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-builder/subjects/uploaded-subject.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-builder/subjects/uploaded-subject.tsx ***!
  \*********************************************************************/
/*! exports provided: UploadedSubject */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UploadedSubject", function() { return UploadedSubject; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./diff/diff-xml-with-database */ "./src/components/course-builder/subjects/diff/diff-xml-with-database.ts");







var UploadedSubject = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UploadedSubject, _super);
    function UploadedSubject(props) {
        var _this = _super.call(this, props) || this;
        _this.coursesElems = {};
        _this.centralContentElems = [];
        _this.knowledgeRequirementElems = [];
        _this.state = {
            showFullText: false,
            changes: [],
            isWorking: true,
            isImporting: false
        };
        return _this;
    }
    UploadedSubject.prototype.componentDidMount = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, changes, subjectToImport, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        this.addClassesForCherryPickedElements();
                        _b.label = 1;
                    case 1:
                        _b.trys.push([1, 3, 4, 5]);
                        return [4 /*yield*/, this.diffWithExisting()];
                    case 2:
                        _a = _b.sent(), changes = _a.changes, subjectToImport = _a.subjectToImport;
                        this.setState({ changes: changes, subjectToImport: subjectToImport });
                        return [3 /*break*/, 5];
                    case 3:
                        error_1 = _b.sent();
                        this.setState({ error: '' + error_1 });
                        return [3 /*break*/, 5];
                    case 4:
                        this.setState({ isWorking: false });
                        return [7 /*endfinally*/];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.addClassesForCherryPickedElements = function () {
        var abilities = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li');
        abilities.addClass('ability');
        var centralContents = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.centralContentElems).find('li');
        centralContents.addClass('central-content');
        var knowledgeRequirements = jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.knowledgeRequirementElems).find('p');
        knowledgeRequirements.addClass('knowledge-requirement');
        var all = jquery__WEBPACK_IMPORTED_MODULE_3___default()([abilities, centralContents, knowledgeRequirements]);
        all.addClass('marked-area');
    };
    UploadedSubject.prototype.cherryPickData = function () {
        var _this = this;
        //
        // Reads elements (tagged by classes in addClassesForCherryPickedElements()) and converts their inner HTML to the corresponding
        // model SubjectToImport. Note that if we need to adjust how to pick the right LI or P elements, we
        // will only need to change the code in addClassesForCherryPickedElements(), not this code.
        //
        var skolSubject = this.props.subject;
        var abilitiesLis = Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(this.purposeElem).find('li').first().parent().children('li'));
        var abilities = abilitiesLis.map(function (a, i) { return (i + 1 + ". " + jquery__WEBPACK_IMPORTED_MODULE_3___default()(a).html()).trim(); }).filter(function (html) { return !!html; });
        var result = {
            name: skolSubject.name,
            code: skolSubject.code,
            schoolType: skolSubject.schoolType,
            abilities: abilities,
            courses: Object.keys(this.coursesElems)
                .map(function (courseCode) { return _this.coursesElems[courseCode]; })
                .map(function (_a) {
                var course = _a.course, elem = _a.elem;
                return ({
                    name: course.name,
                    year: course.year,
                    code: course.code,
                    points: course.points,
                    centralContent: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.central-content')).map(function (c) { return ({
                        html: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).html().trim(),
                        group: jquery__WEBPACK_IMPORTED_MODULE_3___default()(c).parent('ul').prev('h4').text().trim()
                    }); }).filter(function (_a) {
                        var html = _a.html;
                        return !!html;
                    }),
                    knowledgeRequirements: Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-none .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: null, html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-E .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "E", html: html }); })
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-C .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "C", html: html }); }))
                        .concat(Array.from(jquery__WEBPACK_IMPORTED_MODULE_3___default()(elem).find('.grade-step-A .knowledge-requirement')).map(function (r) { return jquery__WEBPACK_IMPORTED_MODULE_3___default()(r).html().trim(); })
                        .filter(function (html) { return !!html; })
                        .map(function (html) { return ({ gradeStep: "A", html: html }); })))
                });
            })
        };
        return result;
    };
    UploadedSubject.prototype.diffWithExisting = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            function ct() {
                var rv = createTime;
                createTime += 2;
                return rv;
            }
            var e_1, _a, e_2, _b, subjectToImport, changes, existingSubjects, existingSubject, centralContent, knowledgeRequirements, createTime, newSubject_1, subjectAbilities, _loop_1, _c, _d, a, _loop_2, _e, _f, c;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_g) {
                switch (_g.label) {
                    case 0:
                        subjectToImport = this.cherryPickData();
                        changes = [];
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.list("subjects")];
                    case 1:
                        existingSubjects = _g.sent();
                        existingSubject = existingSubjects.filter(function (s) { return s.code === _this.props.subject.code; })[0];
                        centralContent = [], knowledgeRequirements = [];
                        createTime = Date.now();
                        if (!existingSubject) return [3 /*break*/, 3];
                        // Include abilities and standardCourses with the found Subject:
                        return [4 /*yield*/, Object(_diff_diff_xml_with_database__WEBPACK_IMPORTED_MODULE_6__["diffXmlWithDatabase"])(existingSubject, subjectToImport, changes)];
                    case 2:
                        // Include abilities and standardCourses with the found Subject:
                        _g.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        newSubject_1 = existingSubject = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                            schoolType: subjectToImport.schoolType,
                            tags: ["schoolType:" + subjectToImport.schoolType],
                            acl: ["role:USER:R"],
                            code: subjectToImport.code,
                            name: subjectToImport.name,
                            abilitiesOrder: [],
                            publishable: false,
                            dateTime: ct()
                        };
                        changes.push({
                            change: "Nytt ämne",
                            content: subjectToImport.name + " (" + subjectToImport.code + ")",
                            mutations: function (r) { return r.add("subjects", newSubject_1); }
                        });
                        subjectAbilities = [];
                        _loop_1 = function (a) {
                            var newAbility = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                name: a,
                                acl: ["role:USER:R"],
                                dateTime: ct()
                            };
                            subjectAbilities.push(newAbility); // To refer from in courses later on!
                            changes.push({
                                change: "Ny förmåga",
                                content: a,
                                mutations: function (r) {
                                    r.add("abilities", newAbility);
                                    r.link("subjects", newSubject_1.id, "abilities", newAbility.id, "abilities");
                                }
                            });
                        };
                        try {
                            for (_c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.abilities), _d = _c.next(); !_d.done; _d = _c.next()) {
                                a = _d.value;
                                _loop_1(a);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        // Update now when we have abilities order:
                        newSubject_1.abilitiesOrder = subjectAbilities.map(function (_a) {
                            var id = _a.id;
                            return id;
                        });
                        _loop_2 = function (c) {
                            var e_3, _a, e_4, _b, e_5, _c;
                            var newCourse = {
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                subjectCode: newSubject_1.code,
                                schoolType: newSubject_1.schoolType,
                                tags: [
                                    "sub:" + newSubject_1.code,
                                    "course:" + c.code,
                                    "schoolType:" + newSubject_1.schoolType
                                ],
                                dateTime: ct(),
                                isTemplate: true,
                                acl: ["role:EMPLOYEE:R"],
                                name: c.name,
                                code: c.code,
                                points: c.points,
                                modules: [],
                                subjectId: newSubject_1.id,
                                resources: [],
                                createdBy: { name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.displayName, url: "mailto:" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].currentUser.mail },
                                createdDate: Date.now(),
                                knowledgeRequirementsOrder: [],
                                centralContentOrder: [],
                                abilitiesOrder: subjectAbilities.map(function (_a) {
                                    var id = _a.id;
                                    return id;
                                })
                            };
                            if (c.year)
                                newCourse.schoolGrade = c.year;
                            changes.push({
                                change: "Ny kurs",
                                content: c.name,
                                mutations: function (r) {
                                    r.add("courses", newCourse);
                                    r.link("subjects", newSubject_1.id, "courses", newCourse.id, "courseTemplates");
                                }
                            });
                            var _loop_3 = function (ccGroup, html) {
                                // Check if there exists an identical central content on previous course first
                                var newCentralContent = centralContent.filter(function (cc) { return cc.name === html; })[0];
                                if (!newCentralContent) {
                                    newCentralContent = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: html,
                                        acl: ["role:USER:R"]
                                    };
                                    if (ccGroup)
                                        newCentralContent.group = ccGroup;
                                    centralContent.push(newCentralContent);
                                    changes.push({
                                        change: "Nytt centralt innehåll",
                                        content: "<h4>" + ccGroup + "</h4>" + html,
                                        mutations: function (r) {
                                            r.add("central-content", newCentralContent);
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "central-content", newCentralContent.id, "centralContent");
                                        }
                                    });
                                }
                                // Register the order in which this central content appeared in the XML:
                                newCourse.centralContentOrder.push(newCentralContent.id);
                            };
                            try {
                                for (var _d = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.centralContent), _e = _d.next(); !_e.done; _e = _d.next()) {
                                    var _f = _e.value, ccGroup = _f.group, html = _f.html;
                                    _loop_3(ccGroup, html);
                                }
                            }
                            catch (e_3_1) { e_3 = { error: e_3_1 }; }
                            finally {
                                try {
                                    if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
                                }
                                finally { if (e_3) throw e_3.error; }
                            }
                            var _loop_4 = function (cr) {
                                var newKnowledgeRequirement = knowledgeRequirements.filter(function (kr) { return kr.name === cr.html && kr.gradeStep === cr.gradeStep; })[0];
                                if (!newKnowledgeRequirement) {
                                    newKnowledgeRequirement = {
                                        id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                                        dateTime: ct(),
                                        name: cr.html,
                                        gradeStep: cr.gradeStep,
                                        acl: ["role:USER:R"]
                                    };
                                    knowledgeRequirements.push(newKnowledgeRequirement);
                                    changes.push({
                                        change: "Nytt kunskapskrav för betyget " + cr.gradeStep,
                                        content: cr.html,
                                        mutations: function (r) {
                                            r.add("knowledge-requirements", newKnowledgeRequirement);
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                else {
                                    changes.push({
                                        mutations: function (r) {
                                            r.link("courses", newCourse.id, "knowledge-requirements", newKnowledgeRequirement.id, "knowledgeRequirements");
                                        }
                                    });
                                }
                                // Register the order in which this knowledge requirement appeared in the XML:
                                newCourse.knowledgeRequirementsOrder.push(newKnowledgeRequirement.id);
                            };
                            try {
                                for (var _g = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](c.knowledgeRequirements), _h = _g.next(); !_h.done; _h = _g.next()) {
                                    var cr = _h.value;
                                    _loop_4(cr);
                                }
                            }
                            catch (e_4_1) { e_4 = { error: e_4_1 }; }
                            finally {
                                try {
                                    if (_h && !_h.done && (_b = _g.return)) _b.call(_g);
                                }
                                finally { if (e_4) throw e_4.error; }
                            }
                            var _loop_5 = function (a) {
                                changes.push({
                                    mutations: function (r) {
                                        r.link("courses", newCourse.id, "abilities", a.id, "abilities");
                                    }
                                });
                            };
                            try {
                                // Build knowledge matrix
                                // Link directly from course template to all abilities that the subject has:
                                for (var subjectAbilities_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectAbilities), subjectAbilities_1_1 = subjectAbilities_1.next(); !subjectAbilities_1_1.done; subjectAbilities_1_1 = subjectAbilities_1.next()) {
                                    var a = subjectAbilities_1_1.value;
                                    _loop_5(a);
                                }
                            }
                            catch (e_5_1) { e_5 = { error: e_5_1 }; }
                            finally {
                                try {
                                    if (subjectAbilities_1_1 && !subjectAbilities_1_1.done && (_c = subjectAbilities_1.return)) _c.call(subjectAbilities_1);
                                }
                                finally { if (e_5) throw e_5.error; }
                            }
                        };
                        try {
                            for (_e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](subjectToImport.courses), _f = _e.next(); !_f.done; _f = _e.next()) {
                                c = _f.value;
                                _loop_2(c);
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        _g.label = 4;
                    case 4: return [2 /*return*/, { changes: changes, subjectToImport: subjectToImport }];
                }
            });
        });
    };
    UploadedSubject.prototype.cancel = function () {
        this.props.onCancel();
    };
    UploadedSubject.prototype.import = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var allMutations;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.setState({ isWorking: true, isImporting: true });
                        allMutations = this.state.changes.map(function (change) { return change.mutations; });
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_4__["default"].kedBackendClient.do(function (r) {
                                allMutations.forEach(function (mut) { return mut(r); });
                            })];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.setState({ isWorking: false, isImporting: false });
                        return [7 /*endfinally*/];
                    case 4:
                        this.props.onImportSuccess(this.props.subject.name);
                        return [2 /*return*/];
                }
            });
        });
    };
    UploadedSubject.prototype.fixL = function (html) {
        return html; //.replace('<l fromat="OL">')
    };
    UploadedSubject.prototype.render = function () {
        var _this = this;
        var subjectToImport = this.state.subjectToImport;
        var subject = this.props.subject;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Uppladdat \u00C4mne ", ""], ["Uppladdat \u00C4mne ", ""])), subjectToImport ? subjectToImport.name : '')),
            this.state.error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                "Fel: ",
                this.state.error) :
                this.state.isWorking ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Arbetar...") :
                    this.state.isImporting ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Importerar...") :
                        this.state.changes.every(function (c) { return !c.change; }) ? // Inga ändringar att visa (bara pseudo-ändringar)
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Kunde inte finna n\u00E5gra f\u00F6r\u00E4ndringar fr\u00E5n befintligt data. Klicka OK f\u00F6r att avbryta och \u00E5terg\u00E5."),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); } }, " OK ")) :
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { border: "1px solid gray", padding: "2px" } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { colSpan: 2 }, "Granskning av \u00E4ndringar i grund-data")),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4ndring"),
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inneh\u00E5ll"))),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, this.state.changes.filter(function (change) { return change.change; }).map(function (change, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" } }, change.change),
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { style: { padding: "2px" }, dangerouslySetInnerHTML: { __html: change.content } })); }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.cancel(); }, disabled: this.state.isImporting }, "Avbryt"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.import(); }, disabled: this.state.isImporting }, "Importera"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { onClick: function () { return _this.setState({ showFullText: !_this.state.showFullText }); } }, this.state.showFullText ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["D\u00F6lj nedan"], ["D\u00F6lj nedan"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Visa hela texten fr\u00E5n Skolverket"], ["Visa hela texten fr\u00E5n Skolverket"])))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { style: { display: this.state.showFullText ? '' : 'none' } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Namn"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.name)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "\u00C4mneskod"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.code)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Syfte"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.purposeElem = elem; }, dangerouslySetInnerHTML: { __html: this.fixL(subject.purpose) } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurser"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, subject.courses.map(function (course) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { key: course.code, ref: function (elem) { return _this.coursesElems[course.code] = { course: course, elem: elem }; } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kursens namn"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.name)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kurskod"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.code)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Po\u00E4ng"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, course.points)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Centralt inneh\u00E5ll"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { ref: function (elem) { return _this.centralContentElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.centralContent) } })),
                                course.knownledgeRequirements.some(function (kr) { return !kr.gradeStep; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav utan betygs\u00E4ttning"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-none", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return !r.gradeStep; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'E'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg E"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-E", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'E'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'C'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg C"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-C", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'C'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined,
                                course.knownledgeRequirements.some(function (kr) { return kr.gradeStep === 'A'; }) ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Kunskapskrav Betyg A"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "grade-step-A", ref: function (elem) { return _this.knowledgeRequirementElems.push(elem); }, dangerouslySetInnerHTML: { __html: _this.fixL(course.knownledgeRequirements.filter(function (r) { return r.gradeStep === 'A'; }).map(function (kr) { return kr.text; }).join('')) } })) : undefined)); }))))));
    };
    return UploadedSubject;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3;


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse, hasMigratedTexts */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasMigratedTexts", function() { return hasMigratedTexts; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: Date.now() },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}
function hasMigratedTexts(task) {
    return task.migratedTexts && Object.keys(task.migratedTexts).some(function (type) {
        return Object.keys(task.migratedTexts[type]).length > 0;
    });
}


/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/


var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } }, title),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/renameable-text.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/renameable-text.tsx ***!
  \***************************************************************/
/*! exports provided: RenameableText */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenameableText", function() { return RenameableText; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_2__);



/**
 * Makes a text element (such as an A or P tag) possible to replace with an input element of the same CSS style, for example by clicking on it.
 *
*/
var RenameableText = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RenameableText, _super);
    function RenameableText(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            editMode: false,
            runtimeStyle: null,
            text: props.text || ""
        };
        return _this;
    }
    RenameableText.prototype.componentWillReceiveProps = function (nextProps) {
        if (this.props.text !== nextProps.text) {
            this.setState({ text: nextProps.text || "" });
        }
    };
    RenameableText.prototype.render = function () {
        var _this = this;
        var text = this.state.text || "";
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "renameable-text" + (text ? "" : " unnamed") + (this.props.readOnly ? " disabled" : ""), tabIndex: this.state.editMode ? undefined : 0, onFocus: function (e) { _this.rename(); }, style: { width: "100%" } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { ref: function (label) { return _this.label = label; }, style: {
                    display: this.state.editMode ? 'none' : ''
                } }, text || this.props.clickAdvertiseText),
            this.props.tag === 'textarea' ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { ref: function (input) { return _this.input = input; }, maxLength: this.props.maxChars, style: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.runtimeStyle, { display: this.state.editMode ? '' : 'none' }), onFocus: function (ev) { return jquery__WEBPACK_IMPORTED_MODULE_2___default()(ev.target).select(); }, onBlur: this.onBlur.bind(this), value: text, onKeyDown: this.onKeyDown.bind(this), onChange: this.onChange.bind(this), tabIndex: this.state.editMode ? 0 : undefined, placeholder: this.props.placeholder }) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { ref: function (input) { return _this.input = input; }, type: "text", maxLength: this.props.maxChars, style: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.state.runtimeStyle, { display: this.state.editMode ? '' : 'none' }), onFocus: function (ev) { return jquery__WEBPACK_IMPORTED_MODULE_2___default()(ev.target).select(); }, onBlur: this.onBlur.bind(this), value: text, onKeyDown: this.onKeyDown.bind(this), onChange: this.onChange.bind(this), tabIndex: this.state.editMode ? 0 : undefined, placeholder: this.props.placeholder }));
    };
    RenameableText.prototype.onKeyDown = function (e) {
        if (e.keyCode === 27) { // ESC
            this.input.value = this.props.text || "";
            this.input.blur();
            e.stopPropagation();
        }
        else if (e.keyCode === 13) { // ENTER
            this.propagateOnChange(this.input.value);
            this.setState({ editMode: false, text: this.input.value });
        }
    };
    RenameableText.prototype.onBlur = function (e) {
        this.propagateOnChange(this.input.value);
        this.setState({ editMode: false, text: this.input.value });
    };
    RenameableText.prototype.propagateOnChange = function (newValue) {
        if (this.propagatedOnChange != newValue) {
            this.propagatedOnChange = newValue;
            this.props.onChange(newValue);
        }
    };
    RenameableText.prototype.onChange = function (e) {
        this.setState({ text: this.input.value });
        if (this.props.eager)
            this.propagateOnChange(this.input.value);
    };
    RenameableText.prototype.rename = function (txt) {
        var _this = this;
        if (this.state.editMode || this.props.readOnly)
            return;
        txt = txt || this.state.text || "";
        var label = jquery__WEBPACK_IMPORTED_MODULE_2___default()(this.label);
        this.setState({
            text: txt,
            editMode: true,
            runtimeStyle: {
                textAlign: label.css('textAlign'),
                fontSize: label.css('font-size'),
                paddingTop: label.css('paddingTop'),
                paddingBottom: label.css('paddingBottom'),
                paddingLeft: label.css('paddingLeft'),
                paddingRight: label.css('paddingRight'),
                marginTop: label.css('marginTop'),
                marginBottom: label.css('marginBottom'),
                marginLeft: label.css('marginLeft'),
                marginRight: label.css('marginRight'),
                borderRadius: label.css('borderRadius'),
                backgroundColor: label.css('backgroundColor'),
                lineHeight: label.css('lineHeight'),
                fontWeight: label.css('fontWeight'),
                outLine: 0,
                borderStyle: 'none',
                height: "100%",
                width: "100%",
                boxSizing: "border-box",
            }
        }, function () { return jquery__WEBPACK_IMPORTED_MODULE_2___default()(_this.input).focus(); });
    };
    return RenameableText;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions-sv.ts":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions-sv.ts ***!
  \*****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>F</b>',
        title: 'Fetstil',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>K</i>',
        title: 'Kursiv',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Understruken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Struken',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Rubrik 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Rubrik 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Rubrik 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraf',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Citat',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '<i class="fa fa-list-ol" aria-hidden="true"></i>',
        title: 'Ordnad lista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '<i class="fa fa-list" aria-hidden="true"></i>',
        title: 'Punktlista',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Programkod',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Vågrät linje',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '<i class="fa fa-link" aria-hidden="true"></i>',
        title: 'Infoga länk',
        result: function () {
            var url = window.prompt('Ange länkens URL');
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('createLink', url);
        }
    },
    image: {
        icon: '<i class="fa fa-picture-o" aria-hidden="true"></i>',
        title: 'Infoga bild',
        result: function (ev, component) {
            var url = window.prompt('Ange bildens URL');
            if (url) {
                //exec('insertImage', url);
                var img = document.createElement("img");
                img.src = url;
                img.tabIndex = 1;
                insertElement(img);
                img.onfocus = component.onFocus;
                img.onblur = component.onBlur;
                component.props.onChange(component.contentDiv.innerHTML);
            }
        }
    }
});
function insertElement(element) {
    var sel, range;
    if (window.getSelection && (sel = window.getSelection()).rangeCount) {
        range = sel.getRangeAt(0);
        range.collapse(true);
        range.insertNode(element);
        // Move the caret immediately after the inserted span
        range.setStartAfter(element);
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
    }
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/actions.ts":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/actions.ts ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");

/* harmony default export */ __webpack_exports__["default"] = ({
    bold: {
        icon: '<b>B</b>',
        title: 'Bold',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('bold'); }
    },
    italic: {
        icon: '<i>I</i>',
        title: 'Italic',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('italic'); }
    },
    underline: {
        icon: '<u>U</u>',
        title: 'Underline',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('underline'); }
    },
    strikethrough: {
        icon: '<strike>S</strike>',
        title: 'Strike-through',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('strikeThrough'); }
    },
    heading1: {
        icon: '<b>H<sub>1</sub></b>',
        title: 'Heading 1',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H1>'); }
    },
    heading2: {
        icon: '<b>H<sub>2</sub></b>',
        title: 'Heading 2',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H2>'); }
    },
    heading3: {
        icon: '<b>H<sub>3</sub></b>',
        title: 'Heading 3',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<H3>'); }
    },
    paragraph: {
        icon: '&#182;',
        title: 'Paragraph',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<P>'); }
    },
    quote: {
        icon: '&#8220; &#8221;',
        title: 'Quote',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<BLOCKQUOTE>'); }
    },
    olist: {
        icon: '&#35;',
        title: 'Ordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertOrderedList'); }
    },
    ulist: {
        icon: '&#8226;',
        title: 'Unordered List',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertUnorderedList'); }
    },
    code: {
        icon: '&lt;/&gt;',
        title: 'Code',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('formatBlock', '<PRE>'); }
    },
    line: {
        icon: '&#8213;',
        title: 'Horizontal Line',
        result: function () { return Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertHorizontalRule'); }
    },
    link: {
        icon: '&#128279;',
        title: 'Link',
        result: function () {
            var url = window.prompt('Enter the link URL');
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('createLink', url);
        }
    },
    image: {
        icon: '&#128247;',
        title: 'Image',
        result: function () {
            var url = window.prompt('Enter the image URL');
            if (url)
                Object(_exec__WEBPACK_IMPORTED_MODULE_0__["default"])('insertImage', url);
        }
    }
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/exec.ts":
/*!***********************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/exec.ts ***!
  \***********************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (function (command, value) {
    if (value === void 0) { value = null; }
    document.execCommand(command, false, value);
});


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/image-edit-actions.ts":
/*!*************************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/image-edit-actions.ts ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return imageEditActions; });
function imageEditActions(cb) {
    return [{
            name: 'float-left',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-right\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; left:-4px;top:0; transform: scale(0.5); transform-origin: left top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Låt bilden flyta vänster om text',
            result: function () { return cb('float-left'); }
        }, {
            name: 'float-right',
            icon: "<div style=\"position:relative\">\n      <i class=\"fa fa-align-left\" aria-hidden=\"true\"></i>\n      <div style=\"position:absolute; right:-4px;top:0; transform: scale(0.5); transform-origin: right top\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n    </div>",
            title: 'Låt bilden flyta höger om text',
            result: function () { return cb('float-right'); }
        }, {
            name: 'unfloat',
            icon: "<div style=\"position:relative;\" aria-hidden=\"true\">\n      <div style=\"position:absolute;top:0;left:0\">&#8254;</div>\n      <div style=\"position:absolute;top:0:left:0;transform: scale(0.5); transform-origin: left bottom\">\n        <i class=\"fa fa-picture-o\" aria-hidden=\"true\"></i>\n      </div>\n      <div style=\"position:absolute;top:0;left:0\">_</div>\n    </div>",
            title: 'Placera bilden på egen rad',
            result: function () { return cb('unfloat'); }
        }];
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/index.tsx":
/*!*************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/index.tsx ***!
  \*************************************************************/
/*! exports provided: Wysiwyg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Wysiwyg", function() { return Wysiwyg; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _exec__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./exec */ "./src/components/utility-components/wysiwyg/exec.ts");
/* harmony import */ var _wash_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./wash-html */ "./src/components/utility-components/wysiwyg/wash-html.ts");
/* harmony import */ var _image_edit_actions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./image-edit-actions */ "./src/components/utility-components/wysiwyg/image-edit-actions.ts");
/* harmony import */ var _actions__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./actions */ "./src/components/utility-components/wysiwyg/actions.ts");






var classes = {
    actionbar: 'wysiwyg-actionbar',
    button: 'wysiwyg-button',
    content: 'wysiwyg-content',
    focusrect: 'wysiwyg-focusrect',
    focuspoint: 'wysiwyg-focuspoint',
    readonlyContent: 'wysiwyg-content readonly'
};
var Wysiwyg = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Wysiwyg, _super);
    function Wysiwyg(props) {
        var _this = _super.call(this, props) || this;
        _this.state = { focusRect: null };
        _this.onFocus = _this.onFocus.bind(_this);
        _this.onBlur = _this.onBlur.bind(_this);
        _this.onMouseDown = _this.onMouseDown.bind(_this);
        _this.onMouseMove = _this.onMouseMove.bind(_this);
        _this.onMouseUp = _this.onMouseUp.bind(_this);
        return _this;
    }
    Wysiwyg.prototype.componentDidMount = function () {
        var _this = this;
        if (!this.props.readOnly) {
            Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
                .forEach(function (elem) {
                elem.tabIndex = 1;
                elem.onfocus = _this.onFocus;
                elem.onblur = _this.onBlur;
            });
            document.addEventListener('mousedown', this.onMouseDown);
            document.addEventListener('mousemove', this.onMouseMove);
            document.addEventListener('mouseup', this.onMouseUp);
        }
        if (this.props.reportNumChars) {
            this.props.reportNumChars(this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length);
        }
    };
    Wysiwyg.prototype.componentDidUpdate = function () {
        var _this = this;
        Array.from(this.contentDiv.querySelectorAll("img,a")).map(function (elem) { return elem; })
            .forEach(function (elem) {
            elem.tabIndex = 1;
            elem.onfocus = _this.onFocus;
            elem.onblur = _this.onBlur;
        });
        if (this.props.reportNumChars) {
            this.props.reportNumChars(this.contentDiv && this.contentDiv.innerText && this.contentDiv.innerText.length);
        }
    };
    Wysiwyg.prototype.componentWillUnmount = function () {
        document.removeEventListener('mousedown', this.onMouseDown);
        document.removeEventListener('mousemove', this.onMouseMove);
        document.removeEventListener('mouseup', this.onMouseUp);
    };
    Wysiwyg.prototype.shouldComponentUpdate = function (nextProps, nextState) {
        //this.contentDiv.onfocus = this.onFocus;
        //this.contentDiv.onblur = this.onBlur;
        return !this.contentDiv ||
            nextState != this.state ||
            nextProps.readOnly !== this.props.readOnly ||
            Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(nextProps.html) !== Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.contentDiv.innerHTML);
    };
    Wysiwyg.prototype.triggerOnChange = function (html) {
        this.props.onChange && this.props.onChange(Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(html));
    };
    Wysiwyg.prototype.onFocus = function (ev) {
        var elem = ev.target;
        if (!elem || !elem.tagName)
            return;
        if (elem.tagName !== 'IMG' && elem.tagName !== 'A')
            return;
        var contentParent = this.contentDiv.parentElement;
        var newState = {
            focusRect: getRelatativeClientRect(contentParent, elem),
        };
        switch (elem.tagName) {
            case 'A':
            case 'IMG':
            default: break;
        }
        this.setState(newState);
        this.focusElem = elem;
    };
    Wysiwyg.prototype.onBlur = function (ev) {
        /*if (ev.relatedTarget) {
          const relatedTarget = ev.relatedTarget as HTMLElement;
          if (relatedTarget.className && relatedTarget.className.split(' ').indexOf(classes.button) >= 0) {
            // A image action button was pressed
            set
            return;
          }
        }*/
        if ((ev.target === this.focusElem && ev.relatedTarget !== this.focusRectDiv) ||
            ev.target === this.focusRectDiv) {
            this.setState({ focusRect: null });
        }
    };
    Wysiwyg.prototype.makeClickable = function (elem) {
        elem.tabIndex = 1;
    };
    Wysiwyg.prototype.onMouseDown = function (ev) {
        if ((ev.target.className || "").split(' ').indexOf(classes.focuspoint) >= 0) {
            var corner = this.getRectCorner(ev);
            this.corner = corner;
            this.resizeStartX = ev.clientX;
        }
    };
    Wysiwyg.prototype.onMouseMove = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            ev.preventDefault();
            // TODO: Räkna ut baserat på this.corner hur bildens storlek borde ändras.
            // Leta upp bilden per ID från this.contentDiv
            // Sätt DIV:ens style attribut width till ny width.
            // Om DIV:en redan hade height, sätt ny height med samma aspect ratio som innan,
            // annars, sätt inte height alls (eller möjligtvis till auto))
            var focusRect = this.focusRectDiv.getBoundingClientRect();
            if (focusRect.width < 32)
                return;
            //const currentWidth = focusRect.width;
            //const currentHeight = focusRect.height;
            //const hasHeightStyle = !this.focusElem.style.height || this.focusElem.style.height === "auto";
            var newWidth = Math.max(32, this.corner.endsWith('l') ?
                focusRect.width + (this.resizeStartX - ev.clientX) :
                //focusRect.right - ev.clientX :
                focusRect.width - (this.resizeStartX - ev.clientX));
            this.resizeStartX = ev.clientX;
            //ev.clientX - focusRect.left;
            var factor = newWidth / focusRect.width;
            var newHeight = focusRect.height * factor;
            this.focusElem.style.width = newWidth + "px";
            this.focusElem.style.height = newHeight + "px";
            this.setState({
                focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem),
            });
        }
    };
    Wysiwyg.prototype.onMouseUp = function (ev) {
        if (this.corner && this.state.focusRect && this.focusElem) {
            this.corner = null;
            this.triggerOnChange(this.contentDiv.innerHTML);
        }
    };
    Wysiwyg.prototype.getRectCorner = function (ev) {
        var e_1, _a;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"]((ev.target.className || '').split(' ')), _c = _b.next(); !_c.done; _c = _b.next()) {
                var className = _c.value;
                switch (className) {
                    case 'fpul':
                        return 'ul';
                    case 'fpur':
                        return 'fpur';
                    case 'fplr':
                        return 'lr';
                    case 'fpll':
                        return 'll';
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return null;
    };
    Wysiwyg.prototype.execImageEditAction = function (cmd) {
        //console.log(cmd);
        if (!this.focusElem)
            return;
        //console.log("doing it");
        switch (cmd) {
            case 'float-left':
                this.focusElem.style.cssFloat = 'left';
                break;
            case 'float-right':
                this.focusElem.style.cssFloat = 'right';
                break;
            case 'unfloat':
                this.focusElem.style.cssFloat = '';
                break;
        }
        this.triggerOnChange(this.contentDiv.innerHTML);
        this.setState({ focusRect: getRelatativeClientRect(this.contentDiv.parentElement, this.focusElem) });
    };
    Wysiwyg.prototype.render = function () {
        var _this = this;
        var defaultActions = this.props.defaultActions || _actions__WEBPACK_IMPORTED_MODULE_5__["default"];
        var actionsToUse = this.props.actions ? this.props.actions.map(function (action) {
            return typeof action === 'string' ?
                defaultActions[action] :
                defaultActions[action.name] ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultActions[action.name], action) :
                    action;
        })
            : Object.keys(defaultActions).map(function (action) { return defaultActions[action]; });
        if (this.state.focusRect) {
            actionsToUse = actionsToUse.concat(Object(_image_edit_actions__WEBPACK_IMPORTED_MODULE_4__["default"])(function (cmd) { return _this.execImageEditAction(cmd); }));
        }
        var focusRect = this.state.focusRect;
        var _a = this.props, readOnly = _a.readOnly, reportNumChars = _a.reportNumChars, maxChars = _a.maxChars;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: this.props.className },
            !readOnly && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.actionbar }, actionsToUse.map(function (action, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { key: idx, className: classes.button, dangerouslySetInnerHTML: { __html: action.icon }, title: action.title, onMouseDown: function (ev) { action.result(ev, _this); }, onMouseUp: function (ev) { return setTimeout(function () { return _this.contentDiv.focus(); }, 10); } });
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: readOnly ? classes.readonlyContent : classes.content, style: { position: 'relative', top: 0, left: 0 } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editor", ref: function (div) { return _this.contentDiv = div; }, dangerouslySetInnerHTML: { __html: Object(_wash_html__WEBPACK_IMPORTED_MODULE_3__["washHtml"])(this.props.html) }, contentEditable: !readOnly, onPaste: function (ev) {
                        if (!isNaN(maxChars)) {
                            var target = ev.target, currentTarget = ev.currentTarget;
                            //const textBeingOverwritten = (target as any).innerText || "";
                            var editorText = (currentTarget && currentTarget.innerText) || "";
                            var textBeingPasted = ev.clipboardData.getData("text/plain") || "";
                            if (editorText.length + textBeingPasted.length > maxChars) {
                                ev.preventDefault();
                            }
                        }
                    }, onKeyUp: reportNumChars ? function (ev) {
                        var innerText = ev.target.innerText;
                        reportNumChars(innerText ? innerText.length : NaN);
                    } : null, onKeyPress: !isNaN(maxChars) ? function (ev) {
                        var innerText = ev.target.innerText;
                        if (innerText && innerText.length >= maxChars) {
                            ev.preventDefault();
                        }
                    } : null, onInput: function (ev) { return _this.triggerOnChange(ev.target.innerHTML); }, onKeyDown: function (ev) {
                        if (readOnly)
                            return;
                        if (reportNumChars && ev.currentTarget) {
                            reportNumChars((ev.currentTarget.innerText || "").length);
                        }
                        //console.log("Key: " + ev.which);
                        if (ev.which >= 35 && ev.which <= 40) { // home/end/up/down/left/right
                            ev.stopPropagation(); // Prevent entire page from scrolling??
                        }
                        if (ev.which === 9) {
                            ev.preventDefault(); // TAB
                            if (ev.shiftKey) {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("outdent");
                            }
                            else {
                                Object(_exec__WEBPACK_IMPORTED_MODULE_2__["default"])("indent");
                            }
                        }
                        if ((ev.keyCode === 8 || ev.keyCode === 46) && // Delete or Back buttons
                            _this.focusElem && _this.state.focusRect) {
                            if (_this.focusElem && _this.focusElem.parentElement) {
                                _this.focusElem.parentElement.removeChild(_this.focusElem); // Remove marked image
                            }
                            _this.focusElem = null;
                            _this.setState({ focusRect: null });
                            _this.triggerOnChange(_this.contentDiv.innerHTML);
                        }
                    } }),
                focusRect && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { ref: function (div) { return _this.focusRectDiv = div; }, className: classes.focusrect, onBlur: this.onBlur, tabIndex: 1, style: {
                        outline: 0,
                        position: 'absolute',
                        top: this.state.focusRect.top,
                        left: this.state.focusRect.left,
                        width: this.state.focusRect.width,
                        height: this.state.focusRect.height
                    } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpul", style: { position: 'absolute', top: 0, left: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpur", style: { position: 'absolute', top: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fplr", style: { position: 'absolute', bottom: 0, right: 0 } }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: classes.focuspoint + " fpll", style: { position: 'absolute', bottom: 0, left: 0 } }))));
    };
    return Wysiwyg;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getRelatativeClientRect(parent, child) {
    var parentRect = parent.getBoundingClientRect();
    var childRect = child.getBoundingClientRect();
    return {
        top: childRect.top - parentRect.top + parent.scrollTop,
        left: childRect.left - parentRect.left + parent.scrollLeft,
        bottom: childRect.bottom - parentRect.top + parent.scrollTop,
        right: childRect.right - parentRect.left + parent.scrollLeft,
        width: childRect.width,
        height: childRect.height
    };
}


/***/ }),

/***/ "./src/components/utility-components/wysiwyg/wash-html.ts":
/*!****************************************************************!*\
  !*** ./src/components/utility-components/wysiwyg/wash-html.ts ***!
  \****************************************************************/
/*! exports provided: washHtml */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "washHtml", function() { return washHtml; });
var parser = new DOMParser();
/** Tags / Attributes Whitelist
 *
 */
var HTML_WASH_POLICY = {
    b: {},
    i: {},
    p: {},
    u: {},
    strike: {},
    pre: {},
    h1: {},
    h2: {},
    h3: {},
    h4: {},
    h5: {},
    img: { src: true, class: true, style: true, tabindex: true },
    a: { href: true, target: true, tabindex: true },
    ul: {},
    ol: {},
    li: {},
    hr: {},
    br: {},
    div: {},
    span: {},
    // table tags:
    table: { border: true },
    tbody: {},
    thead: {},
    tfoot: {},
    tr: {},
    td: { headers: true, colspan: true, rowspan: true },
    th: { abbr: true, headers: true, scope: true, sorted: true, colspan: true, rowspan: true }
};
function washHtml(html) {
    var doc = parser.parseFromString(html, "text/html");
    var childNodes = doc.body.childNodes;
    var modified = false;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified ?
        doc.body.innerHTML :
        html; // By returning the original HTML string, we spare the user from refreshing the edit area,
    // which would otherwise put the cursor at the top, losing the position where user where.
}
function washNode(node) {
    var modified = false;
    if (isElement(node)) {
        if (washElement(node)) {
            modified = true;
        }
    }
    if (washChildNodes(node)) {
        modified = true;
    }
    return modified;
}
function washChildNodes(node) {
    var modified = false;
    var childNodes = node.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        if (washNode(childNodes.item(i))) {
            modified = true;
        }
    }
    return modified;
}
/** Replace an element with its child nodes.
 *
 */
function removeMiddleElement(element) {
    var childNodes = element.childNodes;
    for (var i = 0; i < childNodes.length; ++i) {
        element.parentNode.insertBefore(childNodes.item(i), element);
    }
    element.remove();
}
function washElement(element) {
    var policy = element.tagName && HTML_WASH_POLICY[element.tagName.toLowerCase()];
    if (!policy) {
        console.warn("Wysiwyg: not allowed tag", element.tagName);
        washChildNodes(element);
        removeMiddleElement(element);
        return true;
    }
    var modified = false;
    for (var i = 0; i < element.attributes.length; ++i) {
        var attr = element.attributes.item(i);
        var allowed = attr.name && !!policy[attr.name.toLowerCase()];
        if (!allowed) {
            modified = true;
            console.warn("Wysiwyg: not allowed attribute", attr.name, "Tag: ", element.tagName);
            element.removeAttribute(attr.name);
        }
    }
    return modified;
}
function isElement(node) {
    return !!node.tagName;
}


/***/ }),

/***/ "./src/contracts/ked-models.ts":
/*!*************************************!*\
  !*** ./src/contracts/ked-models.ts ***!
  \*************************************/
/*! exports provided: Course, futureAbilities */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Course", function() { return Course; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "futureAbilities", function() { return futureAbilities; });
var Course = /** @class */ (function () {
    function Course() {
    }
    return Course;
}());

var futureAbilities = [
    "Lära att lära",
    "Samarbeta",
    "Agera globalt",
    "Visa handlingskraft",
    "Vara innovativ",
    "Leva digitalt"
];


/***/ }),

/***/ "./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx":
/*!***********************************************************************!*\
  !*** ./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx ***!
  \***********************************************************************/
/*! exports provided: KEDAppCourseBuilder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDAppCourseBuilder", function() { return KEDAppCourseBuilder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _components_course_builder__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/course-builder */ "./src/components/course-builder/index.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../components/course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");



var bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer(); // Start getting bearer as soon as possible.




var KEDAppCourseBuilder = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KEDAppCourseBuilder, _super);
    function KEDAppCourseBuilder(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isTokenLoaded: false
        };
        return _this;
    }
    KEDAppCourseBuilder.prototype.componentWillMount = function () {
        var _this = this;
        bearerPromise.then(function () {
            _this.setState({ isTokenLoaded: true });
        }).catch(function (err) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["showError"])(err);
        });
    };
    KEDAppCourseBuilder.prototype.render = function () {
        return this.state.isTokenLoaded ?
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_components_course_builder__WEBPACK_IMPORTED_MODULE_4__["CourseBuilder"], { viewCourseUrl: this.props.viewCourseUrl, feedbackUrl: this.props.feedbackUrl }) :
            react__WEBPACK_IMPORTED_MODULE_3__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_3__["createElement"](_components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_6__["Spinner"], null),
                "V.g. v\u00E4nta... autenticerar...");
    };
    return KEDAppCourseBuilder;
}(react__WEBPACK_IMPORTED_MODULE_3__["Component"]));



/***/ }),

/***/ "./src/elements/KEDAppCourseBuilder/webpack-entry.ts":
/*!***********************************************************!*\
  !*** ./src/elements/KEDAppCourseBuilder/webpack-entry.ts ***!
  \***********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED */ "./src/globals/KED.ts");
/* harmony import */ var _app_coursebuilder_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app.coursebuilder.client */ "./src/elements/KEDAppCourseBuilder/app.coursebuilder.client.tsx");



_globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components, _app_coursebuilder_client__WEBPACK_IMPORTED_MODULE_2__);


/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


var Features = /** @class */ (function () {
    //EditUserTasksViaPenOnly?: boolean;
    //SubTasks?: boolean;
    function Features() {
        var user = _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].currentUser;
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_0__["parseQueryString"])(location.search, { toLower: true });
        var features = (query.features || '').split(',')
            .map(function (feature) { return feature.toLowerCase(); }); // Can be used on forwards...
        /*this.EditUserTasksViaPenOnly =
          user.schoolType !== 'Grundskolor' && query.schooltype !== "Grundskolor";*/
        /*this.SubTasks =
          user.schoolType !== 'Grundskolor' && query.schooltype !== "Grundskolor";*/
        //this.AssignmentTasks = !!query.testversion;
    }
    return Features;
}());



/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://kedbackend.azurewebsites.net/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = "en"; // "SE1"


/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "../kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ? _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail : ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/school-courses.ts":
/*!*************************************!*\
  !*** ./src/repos/school-courses.ts ***!
  \*************************************/
/*! exports provided: mySchoolCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mySchoolCoursesRepo", function() { return mySchoolCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");




var SchoolCoursesRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](SchoolCoursesRepo, _super);
    function SchoolCoursesRepo(getSchoolName) {
        var _this = _super.call(this, {
            query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var schoolName, schools;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            schoolName = getSchoolName();
                            return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list("schools", {
                                    name: schoolName,
                                    include: ["courses"]
                                })];
                        case 1:
                            schools = _a.sent();
                            this._schoolId = schools.length > 0 && schools[0].id;
                            if (!this._schoolId)
                                throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Skolan ", " finns inte registrerad i systemet.\n          Kontakta en administrat\u00F6r f\u00F6r Kursbyggarverktyget och be om att l\u00E4gga till skolan med namnet \"", "\""], ["Skolan ", " finns inte registrerad i systemet.\n          Kontakta en administrat\u00F6r f\u00F6r Kursbyggarverktyget och be om att l\u00E4gga till skolan med namnet \"", "\""])), schoolName, schoolName));
                            return [2 /*return*/, Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.courses; }))];
                    }
                });
            }); }
        }) || this;
        return _this;
    }
    SchoolCoursesRepo.prototype.getSchoolId = function () {
        var _this = this;
        return this.ensureHasData().then(function () { return _this._schoolId; });
    };
    return SchoolCoursesRepo;
}(_repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]));
var mySchoolCoursesRepo = new SchoolCoursesRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school; });
var templateObject_1;


/***/ }),

/***/ "./src/utils/cached-response.ts":
/*!**************************************!*\
  !*** ./src/utils/cached-response.ts ***!
  \**************************************/
/*! exports provided: CachedResponse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CachedResponse", function() { return CachedResponse; });
var CachedResponse = /** @class */ (function () {
    function CachedResponse(queryer) {
        this.queryer = queryer;
        this.promise = null;
        this.result = null;
    }
    CachedResponse.prototype.query = function () {
        var _this = this;
        return this.promise ?
            this.promise :
            (this.promise = this.queryer().then(function (x) { return _this.result = x; }));
    };
    CachedResponse.prototype.reset = function () {
        this.promise = null;
    };
    return CachedResponse;
}());



/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 2)
                infos = infos.slice(1);
            return {
                infos: infos.concat(message)
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/keep-session-alive.ts":
/*!*****************************************!*\
  !*** ./src/utils/keep-session-alive.ts ***!
  \*****************************************/
/*! exports provided: keepSessionAlive */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "keepSessionAlive", function() { return keepSessionAlive; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);


var HEARTBEAT_INTERVAL = 5 * 60 * 1000; // 5 minutes.
var HEARTBEAT_URL = "/4.4b4cce2a160e445593f16043.html"; // Could be any protected resource. BUGBUG: Configurable.
var lastActivity = Date.now();
function keepSessionAlive() {
    setInterval(onTimeout, HEARTBEAT_INTERVAL);
    setTimeout(function () { return jquery__WEBPACK_IMPORTED_MODULE_1___default()('body')
        .mousemove(onUserActive)
        .keypress(onUserActive)
        .scroll(onUserActive); }, 100);
}
function onUserActive() {
    lastActivity = Date.now();
}
function onTimeout() {
    var inactivityTime = Date.now() - lastActivity;
    if (inactivityTime < HEARTBEAT_INTERVAL) {
        heartbeat();
    }
}
function heartbeat() {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var res, err_1;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
            switch (_a.label) {
                case 0:
                    console.log("Sending heartbeat request to " + HEARTBEAT_URL);
                    _a.label = 1;
                case 1:
                    _a.trys.push([1, 3, , 4]);
                    return [4 /*yield*/, fetch(HEARTBEAT_URL, {
                            cache: 'no-cache',
                            credentials: 'same-origin'
                        })];
                case 2:
                    res = _a.sent();
                    console.log("Response from " + HEARTBEAT_URL + ": " + res.status + " " + res.statusText);
                    return [3 /*break*/, 4];
                case 3:
                    err_1 = _a.sent();
                    console.warn("Request to " + HEARTBEAT_URL + " failed: " + err_1);
                    return [3 /*break*/, 4];
                case 4: return [2 /*return*/];
            }
        });
    });
}


/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStartAndEnd, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStartAndEnd", function() { return getTermStartAndEnd; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
function getTermStartAndEnd(now) {
    return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 7, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 11, 31))] : // aug1 - dec31
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 0, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 6, 31))]; // jan1 - july31
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6;
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");



function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_1___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_2__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (locales, shortYear) {
        var e_1, _a;
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        try {
            for (var locales_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](locales), locales_1_1 = locales_1.next(); !locales_1_1.done; locales_1_1 = locales_1.next()) {
                var locale = locales_1_1.value;
                switch (locale.split('-')[0].split('_')[0].toLowerCase()) {
                    case 'en':
                        return (this.term === 'AT' ? "AT" : "ST") + " " + year;
                    case 'sv':
                        return (this.term === 'AT' ? "HT" : "VT") + " " + year;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (locales_1_1 && !locales_1_1.done && (_a = locales_1.return)) _a.call(locales_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        if (firstA == null)
            return -1;
        var firstB = b[firstPart];
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvY2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2NsaWVudHdlYi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2hhc2gtcmVzdG9yZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2h0dHAtZXJyb3IuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC9yZXN0Y2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1tZXJnZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2tlZGJhY2tlbmQtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1xdWVyeS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1yZXBvLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC13cml0ZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL211dGF0aW9uLXF1ZXVlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9xdWVyeS1zZXQuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtY291cnNlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLW1vZGVsLW1pZ3JhdG9yL21pZ3JhdGUtdGFzay5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9jb2xsZWN0aW9uLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9lbWl0dGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWFwLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMvb2JzZXJ2YWJsZS9taXhpbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvb2JzZXJ2YWJsZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvdmFsdWUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHN2fGVuIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9nZXQtdXNlci1jbGFpbXMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FjY2Vzcy1jb250cm9sL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hcGlzL2Vkc2NsaWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2J1c2luZXNzLWxvZ2ljLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL2NvdXJzZXMvY291cnNlLWJhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvY291cnNlcy9jb3Vyc2UtbW9kdWxlLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL2NvdXJzZXMvY291cnNlLW1vZHVsZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvY291cnNlcy9jcmVhdGUtbmV3LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2VkaXQtY291cnNlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9jb3Vyc2VzL2lubmVyLWVkaXQtY291cnNlLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC1yZXNvdXJjZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL2Jhc2ljLWVkaXRhYmxlLXRhc2stZmllbGRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svZWRpdC10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL3ByZXZpZXdhYmxlLXRhc2stZmllbGRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svc2F2ZS1vci1jYW5jZWwtYnV0dG9ucy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvbW9kYWwtcGFnZXMvZWRpdC10YXNrL3NlYXJjaC1yZXN1bHRzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1jb250ZW50LWZyYWdtZW50LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1taWdyYXRpb24tYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9tb2RhbC1wYWdlcy9lZGl0LXRhc2svdGFzay1zdGF0dXMtZnJhZ21lbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL21vZGFsLXBhZ2VzL2VkaXQtd29ya2Zsb3ctbGluay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9lZGl0LXNjaG9vbC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9lZGl0YWJsZS1zY2hvb2wtbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc2Nob29scy9uZXctc2Nob29sLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lZGl0YWJsZS1yZXNvdXJjZS1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9lZGl0YWJsZS10YXNrLWxpc3QudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXRlYWNoZXItbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtd29ya2Zsb3ctbGluay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMva25vd2xlZGdlLW1hdHJpeC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0udHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NjaG9vbC1jb3Vyc2VzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zZWxlY3QtcmVsYXRlZC1kb2NzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy93ZWlnaHRlZC1pdGVtcy10YWJsZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvZGlmZi9kaWZmLXhtbC13aXRoLWRhdGFiYXNlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL2RpZmYvbWlncmF0ZS1zdWJqZWN0LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL2luZGV4LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy9zaG93LXN1YmplY3QtaW5uZXIudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL3Nob3ctc3ViamVjdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViamVjdHMvc2tvbHZlcmtldC1zdWJqZWN0LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1YmplY3RzL3N1YmplY3RzLWlubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWJqZWN0cy91cGxvYWRlZC1zdWJqZWN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci91dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9yZW5hbWVhYmxlLXRleHQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2FjdGlvbnMtc3YudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9leGVjLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2ltYWdlLWVkaXQtYWN0aW9ucy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9pbmRleC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvd2FzaC1odG1sLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb250cmFjdHMva2VkLW1vZGVscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZWxlbWVudHMvS0VEQXBwQ291cnNlQnVpbGRlci9hcHAuY291cnNlYnVpbGRlci5jbGllbnQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9lbGVtZW50cy9LRURBcHBDb3Vyc2VCdWlsZGVyL3dlYnBhY2stZW50cnkudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2ZlYXR1cmVzL2ZlYXR1cmVzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9mZWF0dXJlcy9pbmRleC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvY29uZmlndXJlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtYWxsLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQtYmVhcmVyLXByb3ZpZGVycy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWVkcy1jbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1rZWQtYmFja2VuZC1jbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELmNmZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQuZW52LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9kYi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9rZWQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3JlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL3NjaG9vbC1jb3Vyc2VzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9jYWNoZWQtcmVzcG9uc2UudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9rZWVwLXNlc3Npb24tYWxpdmUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3F1ZXJ5LXN0cmluZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLW1vbWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLXRlcm0udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcImpRdWVyeVwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0XCIiLCJ3ZWJwYWNrOi8vW25hbWVdL2V4dGVybmFsIFwiUmVhY3RET01cIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0JBQVEsb0JBQW9CO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQWlCLDRCQUE0QjtBQUM3QztBQUNBO0FBQ0EsMEJBQWtCLDJCQUEyQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxrREFBMEMsZ0NBQWdDO0FBQzFFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsZ0VBQXdELGtCQUFrQjtBQUMxRTtBQUNBLHlEQUFpRCxjQUFjO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBeUMsaUNBQWlDO0FBQzFFLHdIQUFnSCxtQkFBbUIsRUFBRTtBQUNySTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEy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QUksQ0FBQztJQUN6QixJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUFFLE9BQU8sS0FBSyxDQUFDO0lBQzNCLElBQUksT0FBTyxDQUFDLEtBQUssUUFBUSxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVE7UUFBRSxPQUFPLEtBQUssQ0FBQztJQUNqRSxJQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzdCLElBQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDN0IsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLEtBQUssQ0FBQyxNQUFNO1FBQUUsT0FBTyxLQUFLLENBQUM7SUFDaEQsS0FBSyxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRTtRQUNwQyxJQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckIsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRztZQUFFLE9BQU8sS0FBSyxDQUFDO1FBQ25DLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUM7WUFBRSxPQUFPLEtBQUssQ0FBQztLQUN2QztJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2hCLENBQUM7Ozs7Ozs7Ozs7OztBQ3JLRCx3Qjs7Ozs7Ozs7Ozs7QUNBQSx1Qjs7Ozs7Ozs7Ozs7QUNBQSwwQiIsImZpbGUiOiJrZWRhcHBjb3Vyc2VidWlsZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJrZWRhcHBjb3Vyc2VidWlsZGVyXCI6IDBcbiBcdH07XG5cbiBcdHZhciBkZWZlcnJlZE1vZHVsZXMgPSBbXTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBfbmFtZV9cIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goW1wiLi9zcmMvZWxlbWVudHMvS0VEQXBwQ291cnNlQnVpbGRlci93ZWJwYWNrLWVudHJ5LnRzXCIsXCJ2ZW5kb3JzXCJdKTtcbiBcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gcmVhZHlcbiBcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudCc7IiwiZXhwb3J0ICogZnJvbSAnLi9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWInOyIsInZhciBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCkge1xuICAgIH1cbiAgICBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoaWQsIHRva2VuSW5mbykge1xuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQsIEpTT04uc3RyaW5naWZ5KHRva2VuSW5mbykpO1xuICAgIH07XG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIganNvbiA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJiZWFyZXItXCIgKyBpZCk7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGpzb24gPyBKU09OLnBhcnNlKGpzb24pIDogeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyB0b2tlbjogbnVsbCwgZXhwaXJlczogMCB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZTtcbn0oKSk7XG5leHBvcnQgeyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlLmpzLm1hcCIsInZhciByZWRpckhhc2ggPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwicmVkaXItaGFzaFwiKTtcbmlmIChyZWRpckhhc2gpXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIF9hID0gSlNPTi5wYXJzZShyZWRpckhhc2gpLCB0aW1lID0gX2EudGltZSwgaGFzaCA9IF9hLmhhc2g7XG4gICAgICAgIGlmICh0aW1lICYmIHRpbWUgPiBEYXRlLm5vdygpIC0gNjAwMDApIHtcbiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oXCJyZWRpci1oYXNoXCIpO1xuICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKF8pIHsgfVxuZXhwb3J0IGZ1bmN0aW9uIHJlbWVtYmVySGFzaExvY2F0aW9uKCkge1xuICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJyZWRpci1oYXNoXCIsIEpTT04uc3RyaW5naWZ5KHsgdGltZTogRGF0ZS5ub3coKSwgaGFzaDogbG9jYXRpb24uaGFzaCB9KSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXNoLXJlc3RvcmVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBIdHRwRXJyb3IgfSBmcm9tICcuLi9rZWQtYmFja2VuZC1jbGllbnQnO1xuaW1wb3J0IHsgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlIH0gZnJvbSBcIi4vYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2VcIjtcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscyc7XG5pbXBvcnQgeyBLZWRNb2RlbE1pZ3JhdG9yTWl4aW4gfSBmcm9tICcuLi9rZWQtbW9kZWwtbWlncmF0b3InO1xuaW1wb3J0ICcuL2hhc2gtcmVzdG9yZXInO1xuaW1wb3J0IHsgcmVtZW1iZXJIYXNoTG9jYXRpb24gfSBmcm9tICcuL2hhc2gtcmVzdG9yZXInO1xuS2VkTW9kZWxNaWdyYXRvck1peGluKEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlKTtcbmV4cG9ydCB2YXIgc3RvcmFnZSA9IG5ldyBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2UoKTtcbnZhciB0aW1lT2ZQYWdlTG9hZCA9IERhdGUubm93KCk7XG52YXIgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIodG9rZW5QYXRoLCB0b2tlblJlc3BvbnNlTWFwcGVyLCB0b2tlbklkKSB7XG4gICAgICAgIHRoaXMudG9rZW5QYXRoID0gdG9rZW5QYXRoO1xuICAgICAgICB0aGlzLnRva2VuUmVzcG9uc2VNYXBwZXIgPSB0b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICB0aGlzLnRva2VuSWQgPSB0b2tlbklkO1xuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcbiAgICAgICAgdGhpcy5nZXRCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMucmVmcmVzaEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLnJlZnJlc2hCZWFyZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyLnByb3RvdHlwZS5nZXRCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLnRva2VuSW5mby50b2tlbikgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMudG9rZW5JZCkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBzdG9yYWdlLmxvYWQodGhpcy50b2tlbklkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IF9iLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy50b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLnJlZnJlc2hCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2UpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2godGhpcy50b2tlblBhdGgsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IEFjY2VwdDogXCJ0ZXh0L3BsYWluOyBhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDogJ21hbnVhbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHM6IFwic2FtZS1vcmlnaW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMzAyIHx8ICghcmVzLnN0YXR1cyAmJiByZXMudHlwZSA9PT0gXCJvcGFxdWVyZWRpcmVjdFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgc2Vzc2lvbiB0aW1lZCBvdXQgYW5kIHNlcnZlciB3YW50cyB0byByZWRpcmVjdCBlbnRpcmUgcGFnZSB0byBsb2dpbiBwYWdlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGltZSB0byByZWxvYWQgY3VycmVudCBwYWdlIHRvIGZvcmNlIGEgcmVkaXJlY3Qgb2YgdGhlIGVudGlyZSBwYWdlIGluc3RlYWQgZm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8ganVzdCByZWRpcmVjdGluZyB0byAvYXBpL3Rva2VuIG9yIHdoYXRldmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGltZU9mUGFnZUxvYWQgPiA2MDAwMCkgeyAvLyBwcm9oaWJpdCBlbmRsZXNzIGxvb3Agb2YgcmVsb2FkaW5nIHNlbGYuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud2FudHNSZWRpcmVjdCA9IHRydWU7IC8vIFNvIHRoYXQgbGlzdGVuZXJzIHRvIG9uYmVmb3JldW5sb2FkIGNvdWxkIHNob3cgYWx0ZXJuYXRlIG1lc3NhZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUmVkaXJlY3Qgd2FudGVkLiBSZWxvYWQgcGFnZS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWVtYmVySGFzaExvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IoMzAyLCBcIlJlZGlyZWN0ZWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gXCJIVFRQXCIgKyByZXMuc3RhdHVzICsgXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEVycm9yLCBbdm9pZCAwLCBfYiArIChfZS5zZW50KCkpXSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IF9kLmFwcGx5KHRoaXMsIFtfZS5zZW50KCldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2Uuc2F2ZSh0aGlzLnRva2VuSWQsIHRoaXMudG9rZW5JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyIH07XG5leHBvcnQgdmFyIGlzb21vcnBoaWMgPSB7IGZldGNoOiBmZXRjaC5iaW5kKHNlbGYpLCBidG9hOiBidG9hLmJpbmQoc2VsZikgfTtcbnZhciBLZWRCYWNrZW5kQ2xpZW50V2ViID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDbGllbnRXZWIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZENsaWVudFdlYihhcGlCYXNlVXJsLCBwcm92aWRlck9yVG9rZW5QYXRoLCBvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBiZWFyZXJQcm92aWRlciA9IHR5cGVvZiBwcm92aWRlck9yVG9rZW5QYXRoICE9PSAnc3RyaW5nJyA/XG4gICAgICAgICAgICBwcm92aWRlck9yVG9rZW5QYXRoIDpcbiAgICAgICAgICAgIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihwcm92aWRlck9yVG9rZW5QYXRoLCAob3B0aW9ucyAmJiBvcHRpb25zLnRva2VuUmVzcG9uc2VNYXBwZXIpIHx8IChmdW5jdGlvbiAoeCkgeyByZXR1cm4gKHsgdG9rZW46IHgsIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogNjAgfSk7IH0pLCBvcHRpb25zICYmIG9wdGlvbnMudG9rZW5JZCk7XG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGFwaUJhc2VVcmwpIHx8IHRoaXM7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnRXZWI7XG59KEtlZEJhY2tlbmRDbGllbnQpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDbGllbnRXZWIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsInZhciBEb2N1bWVudEFjY2VzcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEb2N1bWVudEFjY2VzcyhhY2Nlc3NDbGFpbVR5cGUsIGFjY2Vzc0NsYWltVmFsdWUsIHJpZ2h0KSB7XG4gICAgICAgIHRoaXMuYWNjZXNzQ2xhaW1UeXBlID0gYWNjZXNzQ2xhaW1UeXBlO1xuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVmFsdWUgPSBhY2Nlc3NDbGFpbVZhbHVlO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gcmlnaHQ7XG4gICAgfVxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAoYWMpIHtcbiAgICAgICAgaWYgKCFhYylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgc3BsaXQgPSBhYy5zcGxpdCgnOicpO1xuICAgICAgICBpZiAoc3BsaXQubGVuZ3RoIDwgMylcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgYWNjZXNzIHN0cmluZzogXCIgKyBhYyk7XG4gICAgICAgIHZhciBjbGFpbVR5cGUgPSBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZShzcGxpdFswXSk7XG4gICAgICAgIHZhciBjbGFpbVZhbHVlID0gRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUoc3BsaXRbMV0pO1xuICAgICAgICB2YXIgcmlnaHQgPSBzcGxpdFsyXTtcbiAgICAgICAgaWYgKHJpZ2h0ICE9PSAnUicgJiYgcmlnaHQgIT09ICdXJyAmJiByaWdodCAhPT0gJ1MnKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhY2Nlc3Mgc3RyaW5nOiBcIiArIGFjKTtcbiAgICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudEFjY2VzcyhjbGFpbVR5cGUsIGNsYWltVmFsdWUsIHJpZ2h0KTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLmVzY2FwZSA9IGZ1bmN0aW9uIChhY2Nlc3NDb21wb25lbnQpIHtcbiAgICAgICAgcmV0dXJuIGFjY2Vzc0NvbXBvbmVudC5yZXBsYWNlKC9cXCUvZywgXCIlMjVcIikucmVwbGFjZSgvXFw6L2csIFwiJTNBXCIpO1xuICAgIH07XG4gICAgRG9jdW1lbnRBY2Nlc3MudW5lc2NhcGUgPSBmdW5jdGlvbiAoYWNjZXNzQ29tcG9uZW50KSB7XG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlM0EvZywgXCI6XCIpLnJlcGxhY2UoL1xcJTI1L2csIFwiJVwiKTtcbiAgICB9O1xuICAgIERvY3VtZW50QWNjZXNzLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIERvY3VtZW50QWNjZXNzLmVzY2FwZSh0aGlzLmFjY2Vzc0NsYWltVHlwZSkgKyBcIjpcIiArXG4gICAgICAgICAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVZhbHVlKSArIFwiOlwiICtcbiAgICAgICAgICAgIHRoaXMucmlnaHQ7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAoYWNsKSB7XG4gICAgICAgIHJldHVybiBhY2xcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nKGFjKTsgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBhYzsgfSk7XG4gICAgfTtcbiAgICBEb2N1bWVudEFjY2Vzcy50b1N0cmluZ0FycmF5ID0gZnVuY3Rpb24gKGFjbCkge1xuICAgICAgICByZXR1cm4gYWNsLm1hcChmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjLnRvU3RyaW5nKCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIERvY3VtZW50QWNjZXNzO1xufSgpKTtcbmV4cG9ydCB7IERvY3VtZW50QWNjZXNzIH07XG5leHBvcnQgZnVuY3Rpb24gaGFzQWNjZXNzKGFjbCwgdXNlckNsYWltcywgcmVxdWVzdGVkUmlnaHQpIHtcbiAgICBpZiAodXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjbGFpbSkgeyByZXR1cm4gY2xhaW0udHlwZSA9PT0gJ3JvbGUnICYmIGNsYWltLnZhbHVlID09PSBcIkFETUlOXCI7IH0pKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gYWNsLnNvbWUoZnVuY3Rpb24gKGEpIHtcbiAgICAgICAgcmV0dXJuIHVzZXJDbGFpbXMuc29tZShmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuIGEuYWNjZXNzQ2xhaW1UeXBlID09PSBjLnR5cGUgJiZcbiAgICAgICAgICAgICAgICBhLmFjY2Vzc0NsYWltVmFsdWUgPT09IGMudmFsdWUgJiYgKChhLnJpZ2h0ID09PSAnUicgJiYgcmVxdWVzdGVkUmlnaHQgPT09ICdSJykgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1cnICYmIFsnUicsICdXJ10uaW5kZXhPZihyZXF1ZXN0ZWRSaWdodCkgPj0gMCkgfHxcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1MnKSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWNjZXNzLWNvbnRyb2wuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbnZhciBIdHRwRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoSHR0cEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEh0dHBFcnJvcihjb2RlLCBtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29kZSA9IGNvZGU7XG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgICAgICBfdGhpcy5uYW1lID0gXCJodHRwXCIgKyBjb2RlO1xuICAgICAgICBfdGhpcy5tZXNzYWdlID0gXCJIVFRQXCIgKyBjb2RlICsgXCIgXCIgKyBtZXNzYWdlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBIdHRwRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAtZXJyb3IuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7XG5leHBvcnQgeyBLZWRCZWFyZXJQcm92aWRlciB9IGZyb20gJy4va2VkLWJlYXJlci1wcm92aWRlcic7XG5leHBvcnQgKiBmcm9tICcuL2FjY2Vzcy1jb250cm9sJztcbmV4cG9ydCB7IFJlc3RDbGllbnQgfTtcbmltcG9ydCB7IEh0dHBFcnJvciB9IGZyb20gJy4vaHR0cC1lcnJvcic7XG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcbmV4cG9ydCAqIGZyb20gJy4vcmVzdGNsaWVudCc7XG47XG52YXIgS2VkQmFja2VuZENsaWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ2xpZW50KGlzb21vcnBoaWMsIGJlYXJlclByb3ZpZGVyLCBiYXNlVXJsKSB7XG4gICAgICAgIHRoaXMuaHR0cCA9IG5ldyBSZXN0Q2xpZW50KGlzb21vcnBoaWMsIGJhc2VVcmwsIHsgYmVhcmVyUHJvdmlkZXI6IGJlYXJlclByb3ZpZGVyIH0pO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5nZXRNeUNsYWltcyA9IGZ1bmN0aW9uICh0YWJsZSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQoXCJtZS9jbGFpbXMvXCIgKyAodGFibGUgfHwgXCJcIiksIG51bGwsIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQodGFibGUgKyBcIi9cIiArIGlkLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IFt2b2lkIDAsIHJlcy5zdGF0dXNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy5qc29uKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpc3QgPSBmdW5jdGlvbiAodGFibGUsIG9wdGlvbnMsIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSwgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkubXV0YXRpb25zT25FbXB0eSA9IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMubXV0YXRpb25zT25FbXB0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwiXCIgKyB0YWJsZSwgcXVlcnksIGZldGNoT3B0aW9ucyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzICE9IDIwMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9jLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYmF0Y2ggPSBmdW5jdGlvbiAocmVxcywgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW9yZGVyIG9wZXJhdGlvbnMgc28gdGhhdCAnYWRkJ3MgY29tZSBmaXJzdCBhbmQgJ2RlbGV0ZSdzIGNvbWUgbGFzdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXMgPSByZXFzLnNsaWNlKCkuc29ydChmdW5jdGlvbiAocmVxMSwgcmVxMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXExLm9wID09PSAnYWRkJyA/IC0xIDogcmVxMi5vcCA9PT0gJ2FkZCcgPyAxIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxMS5vcCA9PT0gJ2RlbGV0ZScgPyAxIDogcmVxMi5vcCA9PT0gJ2RlbGV0ZScgPyAtMSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5wb3N0KFwiYmF0Y2hcIiwgcmVxcywgZmV0Y2hPcHRpb25zKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kbyA9IGZ1bmN0aW9uIChzY29wZUZuKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJ1bm5lcjtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmVyID0gbmV3IEJhdGNoUnVubmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUZuKHJ1bm5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmJhdGNoKHJ1bm5lci5tdXRhdGlvblJlcXVlc3RzKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlUmVhbG0gPSBmdW5jdGlvbiAocmVhbG0pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmRlbGV0ZShcInJlYWxtcy9cIiArIHJlYWxtKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IEh0dHBFcnJvci5iaW5kO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHRocm93IG5ldyAoX2EuYXBwbHkoSHR0cEVycm9yLCBfYi5jb25jYXQoW19jLnNlbnQoKV0pKSkoKTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAodGFibGUsIGRvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuYWRkKHRhYmxlLCBkb2MpOyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnB1dCh0YWJsZSwgZG9jKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudXBkYXRlKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5tZXJnZSA9IGZ1bmN0aW9uIChicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubWVyZ2UoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5jbGVhckJyYW5jaChicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5kZWxldGUodGFibGUsIGlkKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bnNoYXJlKHRhYmxlLCBpZCwgYWNsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRJZCwgbGFiZWwsIGJyYW5jaElkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKTsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS51bmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnQ7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZENsaWVudCB9O1xudmFyIEJhdGNoUnVubmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJhdGNoUnVubmVyKCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMgPSBbXTtcbiAgICB9XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jLCBicmFuY2hJZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnYWRkJywgdGFibGU6IHRhYmxlLCBkb2M6IGRvYywgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xuICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICBkZWxldGUgZG9jLmFjbDsgLy8gRm9yYmlkZGVuIHRvIHNlbmQgYWNsIHdpdGggcHV0KCkgY2FsbHMuXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdwdXQnLCB0YWJsZTogdGFibGUsIGRvYzogZG9jIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBkZWx0YURvYywgYnJhbmNoSWQpIHtcbiAgICAgICAgZGVsdGFEb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkZWx0YURvYyk7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1cGRhdGUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgZGVsdGFEb2M6IGRlbHRhRG9jLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdtZXJnZScsIGJyYW5jaElkOiBicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQ6IHRhcmdldEJyYW5jaElkIH0pO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdzaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5zaGFyZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGFjbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5zaGFyZScsIHRhYmxlOiB0YWJsZSwgaWQ6IGlkLCBhY2w6IGFjbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2xpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0VGFibGU6IHRhcmdldFRhYmxlLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdsaW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldFRhYmxlOiB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICByZXR1cm4gQmF0Y2hSdW5uZXI7XG59KCkpO1xuZXhwb3J0IHsgQmF0Y2hSdW5uZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAnLi9yZXN0Y2xpZW50JztcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4vdXRpbHMnO1xudmFyIEtlZEJlYXJlclByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtlZEJlYXJlclByb3ZpZGVyKGlzb21vcnBoaWMsIHN0b3JhZ2UsIHRva2VuSWQsIGNsaWVudElkLCBjbGllbnRTZWNyZXQsIHRva2VuVXJsLCB0b2tlblF1ZXJ5KSB7XG4gICAgICAgIHRoaXMuaXNvbW9ycGhpYyA9IGlzb21vcnBoaWM7XG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XG4gICAgICAgIHRoaXMudG9rZW5JZCA9IHRva2VuSWQ7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcbiAgICAgICAgdGhpcy5jbGllbnRTZWNyZXQgPSBjbGllbnRTZWNyZXQ7XG4gICAgICAgIHRoaXMudG9rZW5VcmwgPSB0b2tlblVybDtcbiAgICAgICAgdGhpcy50b2tlblF1ZXJ5ID0gdG9rZW5RdWVyeTtcbiAgICAgICAgdGhpcy50b2tlbkluZm8gPSB7IHRva2VuOiBudWxsLCBleHBpcmVzOiAwIH07XG4gICAgICAgIHRoaXMuY2xpZW50ID0gbmV3IFJlc3RDbGllbnQoaXNvbW9ycGhpYywgXCJcIiwge1xuICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgICBwYXNzd29yZDogdGhpcy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2V0QmVhcmVyID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXMuZ2V0QmVhcmVyLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLnJlZnJlc2hCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5yZWZyZXNoQmVhcmVyLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBLZWRCZWFyZXJQcm92aWRlci5wcm90b3R5cGUuZ2V0QmVhcmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfYSwgdG9rZW4sIGV4cGlyZXMsIF9iLCBlXzE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy50b2tlbkluZm8sIHRva2VuID0gX2EudG9rZW4sIGV4cGlyZXMgPSBfYS5leHBpcmVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuICYmIGV4cGlyZXMgPj0gRGF0ZS5ub3coKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy50cnlzLnB1c2goWzEsIDQsICwgNl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zdG9yYWdlLmxvYWQodGhpcy5jbGllbnRJZCArIFwiL1wiICsgdGhpcy50b2tlbklkKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRva2VuSW5mbyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRva2VuSW5mby50b2tlbiAmJiB0aGlzLnRva2VuSW5mby5leHBpcmVzID49IERhdGUubm93KCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCZWFyZXJQcm92aWRlci5wcm90b3R5cGUucmVmcmVzaEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzLCByZXRyaWVzLCBfYSwgX2I7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHJpZXMgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXRyaWVzIDwgNikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXRyaWV2aW5nIHRva2VuIGZvciBcIiArIHRoaXMudG9rZW5JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsaWVudC5nZXQodGhpcy50b2tlblVybCwgdGhpcy50b2tlblF1ZXJ5LCB7IGNhY2hlOiAncmVsb2FkJyB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJHb3QgXCIgKyByZXMuc3RhdHVzICsgXCIgXCIgKyByZXMuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IChfYi50b2tlbiA9IF9jLnNlbnQoKSwgX2IuZXhwaXJlcyA9IERhdGUubm93KCkgKyA1OSAqIDYwICogMTAwMCwgX2IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJHb3QgdG9rZW4gZm9yIFwiICsgdGhpcy50b2tlbklkICsgXCI6IFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50b2tlbkluZm8pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmFnZS5zYXZlKHRoaXMuY2xpZW50SWQgKyBcIi9cIiArIHRoaXMudG9rZW5JZCwgdGhpcy50b2tlbkluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgKytyZXRyaWVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogdGhyb3cgbmV3IEVycm9yKFwiRmFpbGVkIHRvIHJldHJpZXZlIHRva2VuIGZvciBcIiArIEpTT04uc3RyaW5naWZ5KHRoaXMudG9rZW5JZCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCZWFyZXJQcm92aWRlcjtcbn0oKSk7XG5leHBvcnQgeyBLZWRCZWFyZXJQcm92aWRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkLWJlYXJlci1wcm92aWRlci5qcy5tYXAiLCIvKlxuZGVjbGFyZSB2YXIgQnVmZmVyOyAvLyBub2RlIGJ1aWx0LWluXG5cblxuZnVuY3Rpb24gYmFzaWNBdXRoSGVhZGVyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgIHJldHVybiBcIkJhc2ljIFwiICsgbmV3IEJ1ZmZlcih1c2VybmFtZSArIFwiOlwiICsgcGFzc3dvcmQpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xufVxuKi9cbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IEVtaXR0ZXIgfSBmcm9tICcuLi9vYnNlcnZhYmxlL2VtaXR0ZXInO1xudmFyIFJlc3RDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVzdENsaWVudChpc29tb3JwaGljLCBiYXNlVXJsLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuaXNvbW9ycGhpYyA9IGlzb21vcnBoaWM7XG4gICAgICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy5fc3RhdHVzID0gbmV3IEVtaXR0ZXIodGhpcyk7XG4gICAgICAgIHRoaXMuZmV0Y2hPcHRpb25zID0geyBtb2RlOiAnY29ycycgfTtcbiAgICAgICAgdGhpcy5hdXRoSGVhZGVyID0gb3B0aW9ucy5iZWFyZXIgP1xuICAgICAgICAgICAgXCJCZWFyZXIgXCIgKyBvcHRpb25zLmJlYXJlciA6XG4gICAgICAgICAgICBvcHRpb25zLnVzZXJuYW1lID9cbiAgICAgICAgICAgICAgICBcIkJhc2ljIFwiICsgaXNvbW9ycGhpYy5idG9hKG9wdGlvbnMudXNlcm5hbWUgKyBcIjpcIiArIChvcHRpb25zLnBhc3N3b3JkIHx8IFwiXCIpKSA6XG4gICAgICAgICAgICAgICAgbnVsbDtcbiAgICAgICAgdGhpcy5iZWFyZXJQcm92aWRlciA9IG9wdGlvbnMuYmVhcmVyUHJvdmlkZXIgfHwgbnVsbDtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlc3RDbGllbnQucHJvdG90eXBlLCBcInN0YXR1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICsrdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnM7XG4gICAgICAgIHRoaXMuX3N0YXR1cy5kaXNwYXRjaCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZldGNoKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgIC0tX3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xuICAgICAgICAgICAgX3RoaXMuX3N0YXR1cy5kaXNwYXRjaChfdGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAtLV90aGlzLm51bU91dHN0YW5kaW5nT3BlcmF0aW9ucztcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMuZGlzcGF0Y2goX3RoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuX2ZldGNoID0gZnVuY3Rpb24gKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucykge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeVN0ciwgX2EsIGF1dGhIZWFkZXIsIHRva2VuSW5mbywgYmVhcmVyUHJvdmlkZXIsIF9iLCBfYywgdXJsLCByZXMsIHd3d2F1dGgsIF9kO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmV0Y2hPcHRpb25zICYmIGZldGNoT3B0aW9ucy5jYWNoZSA9PT0gJ25vLWNhY2hlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGJhY2stYnV0dG9uIG5vdCByZXNwZWN0aW5nIGNhY2hlIGNvbnRyb2wgaW4gQ2hyb21lL09wZXJhLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGVuZCBhIHF1ZXJ5IHBhcmFtZXRlciB0byBmb3JjZSBhIGNhY2hlIGVudHJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBxdWVyeSwgeyBub2NhY2hlOiBjcmVhdGVVVUlEKCkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVN0ciA9IHF1ZXJ5ICYmIE9iamVjdC5rZXlzKHF1ZXJ5KS5maWx0ZXIoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gcXVlcnlba2V5XSAhPT0gdW5kZWZpbmVkOyB9KS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPVwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5W2tleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbignJicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzLCBhdXRoSGVhZGVyID0gX2EuYXV0aEhlYWRlciwgdG9rZW5JbmZvID0gX2EudG9rZW5JbmZvLCBiZWFyZXJQcm92aWRlciA9IF9hLmJlYXJlclByb3ZpZGVyO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIWF1dGhIZWFkZXIgJiYgIXRva2VuSW5mbyAmJiBiZWFyZXJQcm92aWRlcikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50b2tlbkluZm8gPSB0b2tlbkluZm8gPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdG9rZW5JbmZvKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRva2VuSW5mby5leHBpcmVzIDwgRGF0ZS5ub3coKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUb2tlbiBleHBpcmVkLiBSZWZyZXNoIGl0OlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGJlYXJlclByb3ZpZGVyLnJlZnJlc2hCZWFyZXIoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IHRva2VuSW5mbyA9IF9lLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aEhlYWRlciA9IFwiQmVhcmVyIFwiICsgdG9rZW5JbmZvLnRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSA1O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBvbmUgd2F5IG9yIGFub3RoZXIsIHdlJ3ZlIGNvbmNsdWRlZCBhbiBBdXRob3JpemF0aW9uIGhlYWRlciB0byB1c2U6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aEhlYWRlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGF1dGhIZWFkZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB0aGlzLmJhc2VVcmwgKyBwYXRoICsgKHF1ZXJ5U3RyID8gXCI/XCIgKyBxdWVyeVN0ciA6IFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pc29tb3JwaGljLmZldGNoKHVybCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5mZXRjaE9wdGlvbnMsIHsgaGVhZGVyczogaGVhZGVycywgbWV0aG9kOiBtZXRob2QgfSwgZmV0Y2hPcHRpb25zKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzID09IDQwMSAmJiB0aGlzLmJlYXJlclByb3ZpZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICB3d3dhdXRoID0gcmVzLmhlYWRlcnMuZ2V0KFwid3d3LWF1dGhlbnRpY2F0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR290IFwiICsgcmVzLnN0YXR1cyArIFwiIGZyb20gXCIgKyAodGhpcy5iYXNlVXJsICsgcGF0aCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEod3d3YXV0aCAmJiAvQmVhcmVyL2kudGVzdCh3d3dhdXRoKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2QgPSB0aGlzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5iZWFyZXJQcm92aWRlci5yZWZyZXNoQmVhcmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBfZC50b2tlbkluZm8gPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLkF1dGhvcml6YXRpb24gPSBcIkJlYXJlciBcIiArIHRoaXMudG9rZW5JbmZvLnRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pc29tb3JwaGljLmZldGNoKHVybCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5mZXRjaE9wdGlvbnMsIHsgaGVhZGVyczogaGVhZGVycywgbWV0aG9kOiBtZXRob2QgfSwgZmV0Y2hPcHRpb25zKSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfZS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDk7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHJlc107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHBhdGgsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJHRVRcIiwgeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvbjsgdGV4dC9wbGFpblwiIH0sIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpO1xuICAgIH07XG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUucG9zdCA9IGZ1bmN0aW9uIChwYXRoLCBkYXRhLCBmZXRjaE9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJQT1NUXCIsIHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgXCJBY2NlcHRcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgfSwgbnVsbCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpIH0pKTtcbiAgICB9O1xuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXRoLCBxdWVyeSwgYm9keSwgZmV0Y2hPcHRpb25zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZldGNoKHBhdGgsIFwiREVMRVRFXCIsIHsgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb247IHRleHQvcGxhaW5cIiB9LCBxdWVyeSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZmV0Y2hPcHRpb25zLCB7IGJvZHk6IGJvZHkgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFJlc3RDbGllbnQ7XG59KCkpO1xuZXhwb3J0IHsgUmVzdENsaWVudCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzdGNsaWVudC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVVSUQoKSB7XG4gICAgLy8gRGVjZW50IHNvbHV0aW9uIGZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMDUwMzQvaG93LXRvLWNyZWF0ZS1hLWd1aWQtdXVpZC1pbi1qYXZhc2NyaXB0XG4gICAgdmFyIGQgPSBEYXRlLm5vdygpO1xuICAgIHZhciB1dWlkID0gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICB2YXIgciA9IChkICsgTWF0aC5yYW5kb20oKSAqIDE2KSAlIDE2IHwgMDtcbiAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTtcbiAgICAgICAgcmV0dXJuIChjID09PSAneCcgPyByIDogKHIgJiAweDcgfCAweDgpKS50b1N0cmluZygxNik7XG4gICAgfSk7XG4gICAgcmV0dXJuIHV1aWQ7XG59XG5leHBvcnQgZnVuY3Rpb24gYXZvaWRTaW11bHRhbm91c0NhbGxzKG1ldGhvZCkge1xuICAgIHZhciBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFvbmdvaW5nUHJvbWlzZSkge1xuICAgICAgICAgICAgb25nb2luZ1Byb21pc2UgPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvbmdvaW5nUHJvbWlzZTtcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbElkKHJlYWxtKSB7XG4gICAgdmFyIHByZWZpeCA9ICdlYzk2YjNiZS00NWZjLTQxZDMtYjY5ZS0nO1xuICAgIHZhciBwYWQgPSBbJzUwJywgJzA4JywgJ2UxJywgJzQwJywgJ2U0JywgJ2U3J107XG4gICAgaWYgKHJlYWxtLmxlbmd0aCA+IDYpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRvbyBsb25nIHJlYWxtXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVhbG0ubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgdmFyIGhleCA9IHJlYWxtLmNoYXJDb2RlQXQoaSkudG9TdHJpbmcoMTYpO1xuICAgICAgICBwYWRbaV0gPSBoZXgubGVuZ3RoID09PSAyID9cbiAgICAgICAgICAgIGhleCA6XG4gICAgICAgICAgICAnMCcgKyBoZXg7XG4gICAgfVxuICAgIHJldHVybiBwcmVmaXggKyBwYWQuam9pbignJyk7XG59XG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVByZWRlc3RpbmF0ZWRJZChpbnB1dCkge1xuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZW5jb2RlciwgZGF0YSwgZGlnZXN0LCBfYSwgaTtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlbmNvZGVyLmVuY29kZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgICAgIF9hID0gVWludDhBcnJheS5iaW5kO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGRhdGEpXTtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGRpZ2VzdCA9IG5ldyAoX2EuYXBwbHkoVWludDhBcnJheSwgW3ZvaWQgMCwgX2Iuc2VudCgpXSkpKCk7XG4gICAgICAgICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuaWJibGUgPSBkaWdlc3RbaSsrXSAlIDE2IHwgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2FzaGVkTmliYmxlID0gYyA9PT0gJ3gnID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmliYmxlICYgMHg3IHwgMHg4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXNoZWROaWJibGUudG9TdHJpbmcoMTYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn1cbi8qZXhwb3J0IGZ1bmN0aW9uIGJ1ZjJoZXgoYnVmZmVyOiBBcnJheUJ1ZmZlcikge1xuICByZXR1cm4gQXJyYXkucHJvdG90eXBlLm1hcC5jYWxsKFxuICAgIG5ldyBVaW50OEFycmF5KGJ1ZmZlciksXG4gICAgKHg6IG51bWJlcikgPT4gKCcwMCcgKyB4LnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpKS5qb2luKCcnKTtcbn0qL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5KGEsIG1hcHBlcikge1xuICAgIHZhciByZXR2YWwgPSBhO1xuICAgIGZvciAodmFyIGkgPSAwLCBsID0gYS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgdmFyIHQgPSBhW2ldO1xuICAgICAgICB2YXIgbWFwcGVkID0gbWFwcGVyKHQpO1xuICAgICAgICBpZiAobWFwcGVkICE9PSB0KSB7XG4gICAgICAgICAgICBpZiAocmV0dmFsID09PSBhKVxuICAgICAgICAgICAgICAgIHJldHZhbCA9IGEuc2xpY2UoKTtcbiAgICAgICAgICAgIHJldHZhbFtpXSA9IG1hcHBlZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0dmFsO1xufVxuLypcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBcnJheTxUPihhOiBUW10sIG1hcHBlcjogKHQ6IFQpID0+IFQgfCBmYWxzZSk6IFRbXSB7XG4gIGxldCByZXR2YWwgPSBhO1xuICBsZXQgaiA9IDA7XG4gIGZvciAobGV0IGk9MCxsPWEubGVuZ3RoOyBpPGw7ICsraSwgKytqKSB7XG4gICAgY29uc3QgdCA9IGFbaV07XG4gICAgY29uc3QgbWFwcGVkID0gbWFwcGVyKHQpO1xuICAgIGlmIChtYXBwZWQgPT09IGZhbHNlKSB7XG4gICAgICAvLyBNYXBwZXIgd2FudHMgdG8gZGVsZXRlIHRoaXMgZG9jLlxuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xuICAgICAgcmV0dmFsLnNwbGljZShqLCAxKTtcbiAgICAgIC0tajsgLy8gY29tcGVuc2F0ZSBmb3IgKytqXG4gICAgfSBlbHNlIGlmIChtYXBwZWQgIT09IHQpIHtcbiAgICAgIGlmIChyZXR2YWwgPT09IGEpIHJldHZhbCA9IGEuc2xpY2UoKTtcbiAgICAgIHJldHZhbFtqXSA9IG1hcHBlZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJldHZhbDtcbn1cbiovIFxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMuanMubWFwIiwiaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tIFwia2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb25cIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsIH0gZnJvbSBcIi4vdXRpbHNcIjtcbnZhciBDYWNoZUJ1c3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FjaGVCdXN0KCkge1xuICAgIH1cbiAgICBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgdXNlciwgaW5jbHVkZXMpIHtcbiAgICAgICAgdmFyIGludm9sdmVkSXRlbXMgPSBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKTtcbiAgICAgICAgcmV0dXJuIGludm9sdmVkSXRlbXNcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY2FjaGUtYnVzdC1cIiArIHVzZXIgKyBcIi1cIiArIGl0ZW0pOyB9KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICEhdmFsdWU7IH0pXG4gICAgICAgICAgICAuam9pbignLycpIHx8ICdzdGF0aWMnO1xuICAgIH07XG4gICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZSA9IGZ1bmN0aW9uIChyZXFzLCB1c2VyKSB7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBDYWNoZUJ1c3QuZ2V0Q2FjaGVJbnZhbGlkYXRpb25zKHJlcXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBfYVtfaV07XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImNhY2hlLWJ1c3QtXCIgKyB1c2VyICsgXCItXCIgKyBpdGVtLCAnJyArIERhdGUubm93KCkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDYWNoZUJ1c3QuZ2V0SW52b2x2ZWRJdGVtcyA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnksIGluY2x1ZGVzKSB7XG4gICAgICAgIHZhciBoYXNFZGdlc0Zyb20gPSBxdWVyeS5oYXNFZGdlc0Zyb207XG4gICAgICAgIHZhciByZWxhdGVkVGFibGVzID0gaW5jbHVkZXNcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBKc29uU2NoZW1hLnRhYmxlc1t0YWJsZV0ucmVsYXRpb25zaGlwc1tsYWJlbF07IH0pXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh0YWJsZSkgeyByZXR1cm4gISF0YWJsZTsgfSk7XG4gICAgICAgIGlmIChoYXNFZGdlc0Zyb20pXG4gICAgICAgICAgICByZWxhdGVkVGFibGVzLnB1c2goXCJoZWZcIiArIHRhYmxlKTtcbiAgICAgICAgcmV0dXJuIFt0YWJsZSwgJ21hc3RlcicsIHF1ZXJ5LmJyYW5jaElkXS5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuICEheDsgfSkuY29uY2F0KHJlbGF0ZWRUYWJsZXMpLnNvcnQoKTtcbiAgICB9O1xuICAgIENhY2hlQnVzdC5nZXRDYWNoZUludmFsaWRhdGlvbnMgPSBmdW5jdGlvbiAocmVxcykge1xuICAgICAgICB2YXIgaW52YWxpZGF0aW9uU2V0ID0ge307XG4gICAgICAgIHJlcXMuZm9yRWFjaChmdW5jdGlvbiAocmVxKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHJlcS5vcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XG4gICAgICAgICAgICAgICAgY2FzZSAncHV0JzpcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEudGFibGVdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGluayc6XG4gICAgICAgICAgICAgICAgY2FzZSAndW5saW5rJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5zb3VyY2VUYWJsZV0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbXCJoZWYtXCIgKyBnZXRUYWJsZUZyb21MYWJlbChyZXEuc291cmNlVGFibGUsIHJlcS5sYWJlbCldID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS5icmFuY2hJZF0gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YXJnZXRCcmFuY2hJZCB8fCBcIm1hc3RlclwiXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGludmFsaWRhdGlvblNldCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FjaGVCdXN0O1xufSgpKTtcbmV4cG9ydCB7IENhY2hlQnVzdCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2FjaGUtYnVzdC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGVsdGEoZG9jLCBkZWx0YSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEpO1xuICAgIHZhciB0YXJnZXREb2MgPSBkb2M7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMVtfaV07XG4gICAgICAgIGlmICh0YXJnZXREb2MgPT09IGRvYylcbiAgICAgICAgICAgIHRhcmdldERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YVtrZXldO1xuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIGtleS5zdGFydHNXaXRoKCckJyk7IH0pO1xuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG1pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaVZhbHVlID0gdmFsW21pXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRhZGRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNUb0FkZCA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkYWRkIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHRhcmdldEFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSB0YXJnZXRBcnJheS5zbGljZSgpOyAvLyBPbiBKUyBzaWRlLCB3ZSBtdXN0IGJlIGltbXV0YWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHRhcmdldEFycmF5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVzVG9BZGRfMSA9IHZhbHVlc1RvQWRkOyBfaSA8IHZhbHVlc1RvQWRkXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ID0gdmFsdWVzVG9BZGRfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0QXJyYXkuaW5jbHVkZXModikpIHsgLy8gYXZvaWQgZHVwc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkucHVzaCh2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkcmVtb3ZlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMSA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRyZW1vdmUgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QXJyYXkgPSB0YXJnZXREb2Nba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFyZ2V0QXJyYXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvY1trZXldID0gdGFyZ2V0QXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh0KSB7IHJldHVybiAhdmFsdWVzVG9SZW1vdmVfMS5pbmNsdWRlcyh0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgbWV0YUluc3RydWN0aW9uc18xID0gbWV0YUluc3RydWN0aW9uczsgX2EgPCBtZXRhSW5zdHJ1Y3Rpb25zXzEubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMVtfYV07XG4gICAgICAgICAgICAgICAgICAgIF9sb29wXzEobWkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0YXJnZXREb2Nba2V5XSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldERvYztcbn1cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZURlbHRhcyhkZWx0YTEsIGRlbHRhMikge1xuICAgIC8vcmV0dXJuIHsuLi5kZWx0YTEsIC4uLmRlbHRhMn07XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YTIpO1xuICAgIHZhciB0YXJnZXREZWx0YSA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhMSk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzIgPSBrZXlzOyBfaSA8IGtleXNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNfMltfaV07XG4gICAgICAgIHZhciB2YWwgPSBkZWx0YTJba2V5XTtcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdmFyIG1ldGFJbnN0cnVjdGlvbnMgPSBPYmplY3Qua2V5cyh2YWwpXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgX2xvb3BfMiA9IGZ1bmN0aW9uIChtaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIkYWRkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGRfMiA9IG1pVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkXzIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRhZGQgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YVByb3AgPSB0YXJnZXREZWx0YVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0TWV0YVByb3AgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCB0YXJnZXRNZXRhUHJvcCkgOiB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QsIGp1c3QgY2hlY2sgaWYgdGFyZ2V0IG1ldGFQcm9wIGhhcyB7JHJlbW92ZTogWy4uLml0ZW1zXX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzbywgcmVtb3ZlIGFueSBlcXVhbCBpdGVtcyBmcm9tIHRoZXJlIGJlZm9yZSBtZXJnaW5nIHRoZSB7JGFkZDogWy4uLl19IGFycmF5cy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFJlbW92ZUFycmF5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvQWRkXzIuaW5jbHVkZXModCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0TWV0YVByb3AuJHJlbW92ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmICRyZW1vdmUgYXJyYXkgYmVjYW1lIGVtdHB5LiBSZW1vdmUgdGhlICRyZW1vdmUgcHJvcC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkYWRkIGFycmF5LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRBZGRBcnJheSA9IHRhcmdldE1ldGFQcm9wLiRhZGQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRBZGRBcnJheSA/IHRhcmdldEFkZEFycmF5LmNvbmNhdCh2YWx1ZXNUb0FkZF8yKSA6IHZhbHVlc1RvQWRkXzIuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID0gdGFyZ2V0QWRkQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzIgPSBtaVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZXNUb1JlbW92ZV8yKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldE1ldGFQcm9wID0gdGFyZ2V0RGVsdGFba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldE1ldGFQcm9wID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGFyZ2V0TWV0YVByb3ApIDoge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHRhcmdldE1ldGFQcm9wO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBqdXN0IGNoZWNrIGlmIHRhcmdldCBtZXRhUHJvcCBoYXMgeyRhZGQ6IFsuLi5pdGVtc119XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHJlbW92ZSBhbnkgZXF1YWwgaXRlbXMgZnJvbSB0aGVyZSBiZWZvcmUgbWVyZ2luZyB0aGUgeyRyZW1vdmU6IFsuLi5dfSBhcnJheXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0YXJnZXRBZGRBcnJheSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJGFkZCA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBZGRBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsgcmV0dXJuICF2YWx1ZXNUb1JlbW92ZV8yLmluY2x1ZGVzKHQpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFQcm9wLiRhZGQubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiAkYWRkIGFycmF5IGJlY2FtZSBlbXRweS4gUmVtb3ZlIHRoZSAkYWRkIHByb3AuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0TWV0YVByb3AuJGFkZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3cgaXQncyB0aW1lIHRvIG1lcmdlIG9yIGNyZWF0ZSB0YXJnZXQgJHJlbW92ZSBhcnJheS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5ID0gdGFyZ2V0UmVtb3ZlQXJyYXkgPyB0YXJnZXRSZW1vdmVBcnJheS5jb25jYXQodmFsdWVzVG9SZW1vdmVfMikgOiB2YWx1ZXNUb1JlbW92ZV8yLnNsaWNlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJHJlbW92ZSA9IHRhcmdldFJlbW92ZUFycmF5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMiA9IG1ldGFJbnN0cnVjdGlvbnM7IF9hIDwgbWV0YUluc3RydWN0aW9uc18yLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSBtZXRhSW5zdHJ1Y3Rpb25zXzJbX2FdO1xuICAgICAgICAgICAgICAgICAgICBfbG9vcF8yKG1pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHZhbDtcbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldERlbHRhO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVsdGEtbWVyZ2UuanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLWNvbGxlY3Rpb24nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1yZXBvJztcbmV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1zdWJzY3JpcHRpb24nO1xuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXdyaXRlcic7XG5leHBvcnQgKiBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmV4cG9ydCAqIGZyb20gJy4vcXVlcnktc2V0JztcbmV4cG9ydCAqIGZyb20gJy4uL29ic2VydmFibGUvbWl4aW4nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvblwiO1xuaW1wb3J0IHsgQ2FjaGVCdXN0IH0gZnJvbSAnLi9jYWNoZS1idXN0JztcbmltcG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9IGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9jb2xsZWN0aW9uJztcbi8qKlxuICogUmVwcmVzZW50cyBhIFwibGl2ZVwiIHF1ZXJ5IGFnYWluc3QgYSB0YWJsZSBvciBmaWx0ZXJlZCB0YWJsZS5cbiAqL1xudmFyIEtlZEJhY2tlbmRDb2xsZWN0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDb2xsZWN0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDb2xsZWN0aW9uKHJlcG8sIHRhYmxlLCBxdWVyeSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgS2VkQmFja2VuZFN1YnNjcmlwdGlvbihvYnNlcnZlciwgX3RoaXMpO1xuICAgICAgICAgICAgX3RoaXMucmVwby5xdWVyeVNldC5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJlcG8gPSByZXBvO1xuICAgICAgICBfdGhpcy50YWJsZSA9IHRhYmxlO1xuICAgICAgICBfdGhpcy5xdWVyeSA9IHF1ZXJ5O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwicXVlcnlLZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwiaW5jbHVkZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmNsdWRlcyB8fCAodGhpcy5faW5jbHVkZXMgPSBbXS5jb25jYXQodGhpcy5xdWVyeS5pbmNsdWRlIHx8IFtdKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hcHBseVF1ZXJ5ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgIHJldHVybiBuZXcgS2VkQmFja2VuZENvbGxlY3Rpb24odGhpcy5yZXBvLCB0aGlzLnRhYmxlLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLnF1ZXJ5LCBxdWVyeSkpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFRvUXVlcnlBcnJheVByb3AgPSBmdW5jdGlvbiAoYXJyYXlQcm9wLCBlbnRyaWVzKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSgoX2EgPSB7fSwgX2FbYXJyYXlQcm9wXSA9ICh0aGlzLnF1ZXJ5W2FycmF5UHJvcF0gfHwgW10pLmNvbmNhdChlbnRyaWVzKSwgX2EpKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRGbGFncyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZsYWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBmbGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJmbGFnc1wiLCBmbGFncyk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBkZWJ1ZzogdHJ1ZSB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc09ubHlcIik7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImlkc0FuZE5hbWVzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzT25seSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkRmxhZ3MoXCJpbmNsdWRlSWRzT25seVwiKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNBbmROYW1lc09ubHlcIik7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYmV0d2VlbiA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgZnJvbTogZnJvbSwgdG86IHRvIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgcm9sZTogcm9sZSB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5oYXNFZGdlc0Zyb20gPSBmdW5jdGlvbiAoaWRzLCBvcHRpb25zKSB7XG4gICAgICAgIGlmIChpZHMubGVuZ3RoID09PSAwIHx8IGlkcy5zb21lKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gIWlkOyB9KSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaWQgbGlzdCBnaXZlbiB0byBDb2xsZWN0aW9uLmhhc0VkZ2VzRnJvbShcIiArIEpTT04uc3RyaW5naWZ5KGlkcykgKyBcIilcIik7XG4gICAgICAgIHZhciBoZWYgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc0Zyb21cIiwgaWRzKTtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlRGVsdGFFZGdlcyA/XG4gICAgICAgICAgICBoZWYuYWRkRmxhZ3MoXCJpbmNsdWRlRGVsdGFFZGdlc1wiKSA6XG4gICAgICAgICAgICBoZWY7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaGFzRWRnZXNUbyA9IGZ1bmN0aW9uIChpZHMsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBpZCBsaXN0IGdpdmVuIHRvIENvbGxlY3Rpb24uaGFzRWRnZXNUbyhcIiArIEpTT04uc3RyaW5naWZ5KGlkcykgKyBcIilcIik7XG4gICAgICAgIHZhciBoZXQgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc1RvXCIsIGlkcyk7XG4gICAgICAgIHJldHVybiBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZURlbHRhRWRnZXMgP1xuICAgICAgICAgICAgaGV0LmFkZEZsYWdzKFwiaW5jbHVkZURlbHRhRWRnZXNcIikgOlxuICAgICAgICAgICAgaGV0O1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcbiAgICAgICAgICAgIG9uWmVybzogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZCBub3QgZmluZCBlbnRpdHkgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXG4gICAgICAgICAgICBvbk1hbnk6IGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKFwiTXVsdGlwbGUgZW50cmllcyBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzID0gZnVuY3Rpb24gKGlkcykge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YWdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IHRhZ3M6IHRhZ3MgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGJyYW5jaElkOiBicmFuY2hJZCB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JhcGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaW5jbHVkZVwiLCBncmFwaHMpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmNhY2hlT3B0aW1pemVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgY2FjaGVCdXN0OiBDYWNoZUJ1c3QuZ2V0Q2FjaGVCdXN0KHRoaXMudGFibGUsIHRoaXMucXVlcnksIHRoaXMucmVwby5nZXRVc2VyKCksIHRoaXMuaW5jbHVkZXMpIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm11dGF0aW9uc09uRW1wdHkgPSBmdW5jdGlvbiAobXV0YXRpb25GYWN0b3J5KSB7XG4gICAgICAgIHZhciB0eCA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgbXV0YXRpb25zT25FbXB0eTogdHgubXV0YXRpb25SZXF1ZXN0cyB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIF9hID0gdGhyb3dlcnMgfHwge30sIG9uWmVybyA9IF9hLm9uWmVybywgb25NYW55ID0gX2Eub25NYW55O1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChvblplcm8pXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiU2luZ2xlIGl0ZW0gb2YgXCIgKyBfdGhpcy50YWJsZSArIFwiIGV4cGVjdGVkIHRvIGJlIHJldHVybmVkIGJ5IHF1ZXJ5IFwiICsgSlNPTi5zdHJpbmdpZnkoX3RoaXMucXVlcnkpICsgXCIgYnV0IG5vbmUgd2FzIGZvdW5kLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpdGVtcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgZGVidWdnZXI7XG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcbiAgICAgICAgICAgICAgICAgICAgb25NYW55KCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbXNbMF07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLypjb21iaW5lTGF0ZXN0PFRPdGhlcj4ob3RoZXI6IFF1ZXJ5T2JzZXJ2YWJsZTxUT3RoZXI+KSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcbiAgICB9Ki9cbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGlkLCBjaGFuZ2VzLCBkZWJvdW5jZSkge1xuICAgICAgICBpZiAoZGVib3VuY2UgPT09IHZvaWQgMCkgeyBkZWJvdW5jZSA9IDEwMDA7IH1cbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIGRlbHRhRG9jOiBjaGFuZ2VzXG4gICAgICAgICAgICB9XSwgZGVib3VuY2UpO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFkZFJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkRG9jKSB7XG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XG4gICAgICAgICAgICAgICAgb3A6ICdhZGQtcmVsYXRlZCcsXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIGdyYXBoUHJvcDogbGFiZWwsXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvYzogcmVsYXRlZERvY1xuICAgICAgICAgICAgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZVJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcbiAgICAgICAgICAgICAgICBvcDogJ3JlbW92ZS1yZWxhdGVkJyxcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcbiAgICAgICAgICAgICAgICBpZDogaWQsXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcbiAgICAgICAgICAgICAgICByZWxhdGVkSWQ6IHJlbGF0ZWRJZFxuICAgICAgICAgICAgfV0sIDApO1xuICAgIH07XG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGlkcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgaWRzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoaWRzLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICBvcDogJ2RlbGV0ZScsXG4gICAgICAgICAgICB0YWJsZTogX3RoaXMudGFibGUsXG4gICAgICAgICAgICBpZDogaWRcbiAgICAgICAgfSk7IH0pLCAwKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgdGhpcy5yZXBvLnF1ZXJ5U2V0LnVuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZENvbGxlY3Rpb247XG59KENvbGxlY3Rpb24pKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH07XG4vKm1peGluKFxuICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsXG4gIE1hcHBlZENvbGxlY3Rpb24ucHJvdG90eXBlLFxuICBcIm1hcFwiLCBcImZsYXRcIiwgXCJjb25jYXRcIiwgXCJyZW5kZXJcIiwgXCJsb2FkXCIpOyovXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IHVwZGF0ZUFycmF5IH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcbmltcG9ydCB7IGJyYW5jaFNlbnNpdGl2ZSwgZ2V0VGFibGVGcm9tTGFiZWwgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGFwcGx5RGVsdGEgfSBmcm9tICcuL2RlbHRhLW1lcmdlJztcbnZhciBLZWRCYWNrZW5kUXVlcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgdXNlciwgcmVwbywgbXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7XG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcbiAgICAgICAgdGhpcy51c2VyID0gdXNlcjtcbiAgICAgICAgdGhpcy5yZXBvID0gcmVwbztcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zID0gW107XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLmdvdEluaXRpYWxSZXNwb25zZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmludmFsaWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2FkZWRWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xuICAgICAgICB0aGlzLmluY2x1ZGVzID0gcXVlcnkuaW5jbHVkZSA/XG4gICAgICAgICAgICB0eXBlb2YgcXVlcnkuaW5jbHVkZSA9PT0gJ3N0cmluZycgP1xuICAgICAgICAgICAgICAgIFtxdWVyeS5pbmNsdWRlXSA6XG4gICAgICAgICAgICAgICAgcXVlcnkuaW5jbHVkZSA6XG4gICAgICAgICAgICBbXTtcbiAgICB9XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSkge1xuICAgICAgICB2YXIgbXV0YXRpb25zT25FbXB0eSA9IHF1ZXJ5Lm11dGF0aW9uc09uRW1wdHksIGNvbXBhcmFibGVQcm9wcyA9IHRzbGliXzEuX19yZXN0KHF1ZXJ5LCBbXCJtdXRhdGlvbnNPbkVtcHR5XCJdKTtcbiAgICAgICAgcmV0dXJuIHRhYmxlICsgSlNPTi5zdHJpbmdpZnkoY29tcGFyYWJsZVByb3BzKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLCBcInF1ZXJ5S2V5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5KHRoaXMudGFibGUsIHRoaXMucXVlcnkpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSwgZGF0YTtcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlICYmICF0aGlzLmludmFsaWQpKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCksIHRydWUsIHRoaXMuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5xdWVyeUxvY2FsbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCgpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBsb2FkUHJvbWlzZTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmdvdEluaXRpYWxSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG11dGF0aW9uc09uRW1wdHkgc2hvdWxkIG5ldmVyIGJlIHVzZWQgdHdpY2UuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucXVlcnkubXV0YXRpb25zT25FbXB0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKCF2ZXJzaW9uICYmIHRoaXMuX2xvYWRQcm9taXNlKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9sb2FkUHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTogXG4gICAgICAgICAgICAgICAgICAgIC8vIGxvYWRpbmcgaXMgb25nb2luZywgYW5kIGNhbGxlciBkb2VzIG5vdCByZXF1aXJlIGEgcmVjZW50IHJlZnJlc2guXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBvbmdvaW5nIGxvYWQgdG8gY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IHRoaXMucmVwby53cml0ZXIucGVyc2lzdGVkVmVyc2lvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRQcm9taXNlID0gdGhpcy5fbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkKHZlcnNpb24pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX2xvYWRQcm9taXNlID09PSBsb2FkUHJvbWlzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9hZGVkVmVyc2lvbiA9IE1hdGgubWF4KF90aGlzLmxvYWRlZFZlcnNpb24sIHZlcnNpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5fbG9hZFByb21pc2UgPT09IGxvYWRQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vb25lIGhhcyByZWZyZXNoZWQgb3VyIGxvYWQuIFRoZSBlcnJvciBpcyB0aGUgZmluYWwgcmVzdWx0LiBTZXQgaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9vbmUgaGFzIHJlZnJlc2hlZCBvdXIgbG9hZC4gV2UncmUgZmluaXNoZWQuIERhdGEgb3IgZXJyb3IgaXMgYWxyZWFkeSBzZXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgZ290SW5pdGlhbFJlc3BvbnNlIHRvIHRydWUgYW5kIG5vdGlmeSBzdWJzY3JpYmVycy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRQcm9taXNlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZ290SW5pdGlhbFJlc3BvbnNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubm90aWZ5U3Vic2NyaWJlcnMoX3RoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBIG1vcmUgcmVjZW50IGNhbGwgdG8gbG9hZCgpIGlzIG9uZ29pbmcsIE9SIHdhcyBvbmdvaW5nIGJ1dCByZXNwb25kZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVmb3JlIHVzLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbnkgY2FzZSByZXR1cm4gdGhpcy5fbG9hZFByb21pc2UuIElmIGl0J3Mgb25nb2luZyB3ZSdsbCB3YWl0IGZvciBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBmaW5pc2guIElmIGl0J3MgbnVsbCwgd2UnbGwgYmUgcmV0dXJuaW5nIGZpbmFsbHkgaGVyZSB3aXRob3V0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFueSBhY3Rpb24sIGJlY2F1c2UgdGhlIGFjdGlvbiB3YXMgdGFrZW4gYnkgdGhlIHJlZnJlc2hlci5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLl9sb2FkUHJvbWlzZTsgLy8gV2FpdCBmb3IgdGhlIHJlZnJlc2hlZCBsb2FkIHRvIGNvbXBsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBsb2FkUHJvbWlzZV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLl9sb2FkID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5tdXRhdGlvblF1ZXVlLmFmZmVjdHNRdWVyeSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlci4gT3RoZXJ3aXNlLCB3ZSBtYXkgZ2V0IGluYWNjdXJhdGUgZGF0YSBmcm9tIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVwby53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlci4gT3RoZXJ3aXNlLCB3ZSBtYXkgZ2V0IGluYWNjdXJhdGUgZGF0YSBmcm9tIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2VydmVyKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9ucy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IHN1YnNjcmlwdGlvbjsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX2ksIG11dGF0aW9uc18xLCBtLCBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZGF0YSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShfaSA8IG11dGF0aW9uc18xLmxlbmd0aCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG11dGF0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdjbGVhci1icmFuY2gnICYmIChtLmJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAnbWVyZ2UnICYmICghbS50YXJnZXRCcmFuY2hJZCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRhcmdldEJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAndXBkYXRlJyAmJiAoKG0uZGVsdGFEb2MudGFncyAmJiB0aGlzLnF1ZXJ5LnRhZ3MpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKG0uZGVsdGFEb2MubmFtZSAmJiB0aGlzLnF1ZXJ5Lm5hbWUpKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHF1ZXJ5IG11c3QgYmUgcmVmcmVzaGVkIGZyb20gc2VydmVyIGFzIHdlIGNhbm5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSB0YWcgbWF5IGhhdmUgYmVlbiBhZGRlZCwgb3IgcmVuYW1lZCwgYW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHF1ZXJ5IG11c3QgYmUgcmVmcmVzaGVkIGZyb20gc2VydmVyIGFzIHdlIGNhbm5vdFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IHRoZSBtdXRhdGlvbnMgbG9jYWxseSBhcyB3ZSBkb24ndCBoYXZlIGFsbCBpbmZvLlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChtdXRhdGlvbnMsIGZhbHNlLCB0aGlzLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gOTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5yZWZyZXNoT3JJbnZhbGlkYXRlID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmxvYWQodmVyc2lvbildO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlcnMgPSBmdW5jdGlvbiAob3B0aW1pc3RpY011dGF0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YV8xID0gdGhpcy5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQob3B0aW1pc3RpY011dGF0aW9ucywgdHJ1ZSwgdGhpcy5kYXRhKTtcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaXB0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgICAgICAgcy5ub3RpZnlTdWJzY3JpYmVyKGRhdGFfMSwgX3RoaXMuZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXBvLnF1ZXJ5U2V0LnF1ZXJ5TG9jYWxseSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLmluY2x1ZGVzKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucXVlcnlTZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLmdldENsaWVudCgpLmxpc3QodGhpcy50YWJsZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBkYXRhXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIG9wdGltaXN0aWMsIGRhdGEpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7XG4gICAgICAgICAgICBkYXRhID0gX3RoaXMuYXBwbHlNdXRhdGlvbnNPbkRhdGEoZGF0YSwgbXV0YXRpb24sIG9wdGltaXN0aWMpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zT25EYXRhID0gZnVuY3Rpb24gKGRhdGEsIG0sIG9wdGltaXN0aWMpIHtcbiAgICAgICAgaWYgKGJyYW5jaFNlbnNpdGl2ZShtKSAmJiBtLmJyYW5jaElkICE9IHRoaXMucXVlcnkuYnJhbmNoSWQpXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgdmFyIF9hID0gdGhpcywgdGFibGUgPSBfYS50YWJsZSwgaW5jbHVkZXMgPSBfYS5pbmNsdWRlcywgbGlzdE9wdGlvbnMgPSBfYS5xdWVyeTtcbiAgICAgICAgdmFyIHNvdXJjZUlkcyA9IGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSA/IFtdLmNvbmNhdChsaXN0T3B0aW9ucy5oYXNFZGdlc0Zyb20gfHwgW10pIDogW107XG4gICAgICAgIHZhciByZXF1ZXN0ZWRUYWdzID0gbGlzdE9wdGlvbnMudGFncyA/IFtdLmNvbmNhdChsaXN0T3B0aW9ucy50YWdzIHx8IFtdKSA6IFtdO1xuICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcbiAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkID09PSBtLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSBkZWx0YSBvbiB1cGRhdGVkIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZERvYyA9IGFwcGx5RGVsdGEoZG9jLCBtLmRlbHRhRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWREb2MuJG1ldGEgPSAndXBkYXRpbmcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWREb2M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgaWQgZG9lcyBub3QgYXBwbHkgdG8gdGhpcyBkb2MsIHNlYXJjaCBpbiBncmFwaHMgdGhlIGlkIGlzIGZvdW5kXG4gICAgICAgICAgICAgICAgICAgIC8vIGFtb25nIGdyYXBoIGluY2x1ZGVkIGRvY3MsIGFuZCBpZiBzbywgdXBkYXRlIHRoYXQgb25lOlxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkRG9jcyA9IGRvY1tsYWJlbF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRBcnJheSA9IHVwZGF0ZUFycmF5KGluY2x1ZGVkRG9jcywgZnVuY3Rpb24gKHJlbGF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWQuaWQgIT09IG0uaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWRSZWxhdGVkID0gYXBwbHlEZWx0YShyZWxhdGVkLCBtLmRlbHRhRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUmVsYXRlZC4kbWV0YSA9ICd1cGRhdGluZyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkUmVsYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZEFycmF5ICE9PSBpbmNsdWRlZERvY3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2EgPSB7fSwgX2FbbGFiZWxdID0gdXBkYXRlZEFycmF5LCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdhZGQtcmVsYXRlZCc6XG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzIGBkYi5jb3Vyc2VCbG9ja3MuLi4ud2hhdGV2ZXIuLiAuaW5jbHVkZShcImFiaWxpdGllc1wiKWAsIGRldGVjdDogZGIuY291cnNlQmxvY2tzLmFkZFJlbGF0ZWQoYmxvY2tJZCwgJ2FiaWxpdGllcycsIC4uLilcbiAgICAgICAgICAgICAgICAgICAgLy8gLi4uYmVjYXVzZSB0YWJsZSA9ICdjb3Vyc2VCbG9ja3MnIGFuZCBpbmNsdWRlcyBoYXMgXCJhYmlsaXRpZXNcIi5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuaWQgIT09IG0uaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWxhdGVkRG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgbS5yZWxhdGVkRG9jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2MuJG1ldGEgPSAnYWRkaW5nJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVttLmdyYXBoUHJvcF0gPSBkb2NbbS5ncmFwaFByb3BdLmNvbmNhdChbcmVsYXRlZERvY10pLCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlSWRzLmluY2x1ZGVzKG0uaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gICBgZGIuY291cnNlQmxvY2tzLmhhc0VkZ2VzRnJvbShbY291cnNlSWRdKWAgIChtZWFuaW5nIHRhYmxlPSdjb3Vyc2VCbG9ja3MnIGFuZCBzb3VyY2VJZHMgaW5jbHVkZXMgY291cnNlSWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAsIGRldGVjdDogZGIuY291cnNlSW5zdGFuY2VzLmFkZFJlbGF0ZWQoY291cnNlSWQsICdjb3Vyc2VCbG9ja3MnLCAuLi4uKSAvLyBtLmdyYXBoUHJvcCA9PT0gJ2Jsb2NrcyctLT4gZ2V0VGFibGVGcm9tTGFiZWwgLS0+ICdjb3Vyc2VCbG9ja3MnXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IGdldFRhYmxlRnJvbUxhYmVsKG0udGFibGUsIG0uZ3JhcGhQcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGlzdE9wdGlvbnMudGFncylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5yZWxhdGVkRG9jLnRhZ3MgJiYgcmVxdWVzdGVkVGFncy5zb21lKGZ1bmN0aW9uICh0YWcpIHsgcmV0dXJuIG0ucmVsYXRlZERvYy50YWdzLmluY2x1ZGVzKHRhZyk7IH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvbmNhdCh0aGlzLnNldEdyYXBoUHJvcHMobS5yZWxhdGVkRG9jKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5pZHMgJiYgbGlzdE9wdGlvbnMuaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiBpZCA9PT0gbS5yZWxhdGVkRG9jLmlkOyB9KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBIGNlcnRhaW4gSUQgaXMgb2JzZXJ2ZWQuIEEgZG9jIHdpdGggdGhpcyBpZCBpcyBiZWluZyBhZGRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBkb2MgdG8gdGhlIHJlc3VsdC4gRXhhY3RseSB0aGlzIFdJTEwgaGFwcGVuIGluIHRoZSBmb2xsb3dpbmcgdHlwaWNhbCBzY2VuYXJpbzpcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gVXNlciBhZGRzIGEgcmVsYXRlZCBkb2N1bWVudCB0byBhIGxpc3QuXG4gICAgICAgICAgICAgICAgICAgIC8vIDIuIERvY3VtZW50IHJlbWFpbnMgd2l0aGluIHRoZSBNdXRhdGlvblF1ZXVlIHdoaWxlIGJhdGNoLXJlcXVlc3QgaXMgYmVpbmcgcHJvY2Vzc2VkIGJ5IHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gVXNlciBjbGlja3MgdGhlIGFkZGVkIGl0ZW0gdG8gZWRpdCBvciB2aWV3IGl0IChvciBvdXIgY29tcG9uZW50IHJlZGlyZWN0cyB0byBpdHMgZWRpdG9yKVxuICAgICAgICAgICAgICAgICAgICAvLyA0LiBBIG5ldyBxdWVyeSBvZiB0aGF0IHBhcnRpY3VsYXIgSUQgaXMgc3Vic2NyaWJlZCB0byB7aWRzPVt0aGVJZF19XG4gICAgICAgICAgICAgICAgICAgIC8vICAgIEtlZEJhY2tlbmRRdWVyeS5zdWJzY3JpYmUgdGhlbiBkb2VzIHRoaXM6XG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMS4gQ2FsbCBxdWVyeUxvY2FsbHkoKSBiZWZvcmUgcXVlcnlpbmcgc2VydmVyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMi4gcXVlcnlMb2NhbGx5KCkgaW5zcGVjdHMgbXV0YXRpb25zIGFuZCBmaW5kcyBhIG1hdGNoLCByZXR1cm5pbmcgYW4gZW1wdHkgbGlzdFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIChhc3N1bWVzIGFzIHdlIGFyZSBhZGRpbmcgaXQsIGl0IGNhbid0IGV4aXN0IG9uIHRoZSBzZXJ2ZXIgYW55d2F5KVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDMuIEtlZEJhY2tlbmRRVWVyeSBhcHBsaWVzIG11dGF0aW9ucyBvbnRvIHRoZSBlbXB0eSBsaXN0LCBhbmQgZW5kcyB1cCBoZXJlIHRvIGFkZFxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGl0IG9wdGltaXN0aWNhbGx5LlxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDQuIFdoZW4gc2VydmVyIHJlc3BvbmRzIHdpdGggMjAwIE9LLCBjYWxscyB1cyBoZXJlIGFnYWluIHdpdGggb3B0aW1pc3RpYz1mYWxzZVxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIHRvIFwicGVyc2lzdFwiIGl0IGluIHRoZSBxdWVyeSdzIGRhdGEgYXJyYXkuXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNEI6IElmIG5vdCAyMDAgT0ssIG11dGF0aW9uIG1heSBiZSBnb25lIGFuZCB0aGUgc3Vic2NyaWJlciB3aWxsIHNlIGFuIGVycm9yIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBcIkNvdWxkIG5vdCBmaW5kIGVudGl0eSB3aXRoIGlkIFguXCIgYWxvbmcgd2l0aCBhIHJlZCBlcnJvciBtZXNzYWdlIG9uIHRoZSBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICBhYm91dCB0aGF0IGl0IGZhaWxlZCB0byBzYXZlIG9uIHNlcnZlci5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkRG9jcyA9IGRvY1ttLmdyYXBoUHJvcF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluY2x1ZGVkRG9jcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5pZCAhPT0gbS5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IG9wdGltaXN0aWMgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgcmVsYXRlZC1kb2MtdG8tcmVtb3ZlIHdpdGggJG1ldGE6ICdkZWxldGluZydcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZERvY3MubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLnJlbGF0ZWRJZCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgOiB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkSWQ7IH0pLCBfYSkpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlSWRzLmluY2x1ZGVzKG0uaWQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9wdGltaXN0aWMgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkID09PSBtLnJlbGF0ZWRJZCA/IHRzbGliXzEuX19hc3NpZ24oe30sIGQsIHsgJG1ldGE6ICdkZWxldGluZycgfSkgOiBkOyB9KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZElkOyB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0uaWQ7IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZFRhYmxlcyA9IGluY2x1ZGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gKHsgbGFiZWw6IGxhYmVsLCB0YWJsZTogZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKSB9KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZSA9IF9hLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhYmxlID09PSBtLnRhYmxlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhYmVsc18xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVBcnJheShkYXRhLCBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gX2EubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWREb2NzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYiA9IHt9LCBfYltsYWJlbF0gPSBvcHRpbWlzdGljID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2NzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gX2EuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgX2IpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb2M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuc2V0R3JhcGhQcm9wcyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgdmFyIGNvcHkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MpO1xuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfTtcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xufSgpKTtcbmV4cG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xuaW1wb3J0IHsgS2VkQmFja2VuZENvbGxlY3Rpb24gfSBmcm9tICcuL2tlZGJhY2tlbmQtY29sbGVjdGlvbic7XG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICcuL2tlZGJhY2tlbmQtd3JpdGVyJztcbnZhciBLZWRCYWNrZW5kUmVwbyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUmVwbyhnZXRDbGllbnQsIGdldFVzZXIsIGRlZmF1bHRRdWVyeU9wdGlvbnMsIG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCB3cml0ZXIsIGNhY2hlT3B0aW1pemVkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuZ2V0Q2xpZW50ID0gZ2V0Q2xpZW50O1xuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xuICAgICAgICB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMgPSBkZWZhdWx0UXVlcnlPcHRpb25zO1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XG4gICAgICAgIHRoaXMud3JpdGVyID0gd3JpdGVyO1xuICAgICAgICB0aGlzLmNhY2hlT3B0aW1pemVkID0gY2FjaGVPcHRpbWl6ZWQ7XG4gICAgICAgIGlmICghbXV0YXRpb25RdWV1ZSlcbiAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZSA9IG5ldyBNdXRhdGlvblF1ZXVlKCk7XG4gICAgICAgIGlmICghcXVlcnlTZXQpXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gbmV3IFF1ZXJ5U2V0KHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgIGlmICghd3JpdGVyKVxuICAgICAgICAgICAgdGhpcy53cml0ZXIgPSBuZXcgS2VkQmFja2VuZFdyaXRlcih0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlcik7XG4gICAgICAgIE9iamVjdC5rZXlzKHRhYmxlcykuZm9yRWFjaChmdW5jdGlvbiAodGFibGUpIHtcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XG4gICAgICAgICAgICBpZiAoY2FjaGVPcHRpbWl6ZWQpIHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gY29sbGVjdGlvbi5jYWNoZU9wdGltaXplZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXNbdGFibGVdID0gY29sbGVjdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5fY2xvbmUgPSBmdW5jdGlvbiAocXVlcnlPcHRpb25zLCBjYWNoZU9wdGltaXplZCkge1xuICAgICAgICB2YXIgY2xvbmUgPSBuZXcgS2VkQmFja2VuZFJlcG8odGhpcy5nZXRDbGllbnQsIHRoaXMuZ2V0VXNlciwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLCBxdWVyeU9wdGlvbnMpLCB0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIHRoaXMud3JpdGVyLCBjYWNoZU9wdGltaXplZCA9PT0gdW5kZWZpbmVkID8gdGhpcy5jYWNoZU9wdGltaXplZCA6IGNhY2hlT3B0aW1pemVkKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLmJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyBicmFuY2hJZDogYnJhbmNoSWQgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUucm9sZSA9IGZ1bmN0aW9uIChyb2xlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7IHJvbGU6IHJvbGUgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUub3B0aW1pemVDYWNoZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHt9LCB0cnVlKTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgY2xlYXIgbWFzdGVyIGJyYW5jaFwiKTtcbiAgICAgICAgdGhpcy53cml0ZXIubXV0YXRlKFt7IG9wOiAnY2xlYXItYnJhbmNoJywgYnJhbmNoSWQ6IHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZCB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAodGFyZ2V0QnJhbmNoSWQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgbWVyZ2UgZnJvbSBtYXN0ZXIgYnJhbmNoXCIpO1xuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdtZXJnZScsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9XSwgMCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuc2F2ZU5vdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodGhpcy53cml0ZXIuY3VycmVudFZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBLZWRCYWNrZW5kUmVwbztcbn0oKSk7XG5leHBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1yZXBvLmpzLm1hcCIsInZhciBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24oc3Vic2NyaWJlciwgY29sbGVjdGlvbikge1xuICAgICAgICB0aGlzLnN1YnNjcmliZXIgPSBzdWJzY3JpYmVyO1xuICAgICAgICB0aGlzLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuICAgIH1cbiAgICBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVyID0gZnVuY3Rpb24gKGRhdGEsIGVycm9yKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoZXJyb3IpXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyKFtdLCBlcnJvciwgdGhpcyk7XG4gICAgICAgICAgICBlbHNlIGlmIChkYXRhICE9PSB0aGlzLmxhc3ROb3RpZmllZERhdGEpIHsgLy8gV2lsbCBpbi1mYWN0IGJlIGVxdWFsIGJ5IHJlZmVyZW5jZSBpZiBkYXRhIGlzIHNhbWUgYXMgbGFzdCBub3RpZmljYXRpb24gKGFzIHdlIHVzZSBhbiBpbW11dGFibGUgYXBwcm9hY2ggb24gZGF0YSlcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZERhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihkYXRhLCBlcnJvciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXgsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4Mikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBub3RpZnlpbmcgS2VkQmFja2VuZFN1YnNjcmliZXI6XCIsIGV4MiwgJ29yaWdpbmFsbHkgbm90aWZpZWQgZXJyb3I6JywgZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kU3Vic2NyaXB0aW9uLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uLnVuc3Vic2NyaWJlKHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRTdWJzY3JpcHRpb247XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE11dGF0aW9uUXVldWUgfSBmcm9tICcuL211dGF0aW9uLXF1ZXVlJztcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmltcG9ydCB7IENhY2hlQnVzdCB9IGZyb20gJy4vY2FjaGUtYnVzdCc7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZSc7XG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kV3JpdGVyKG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCBnZXRDbGllbnQsIGdldFVzZXIpIHtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcbiAgICAgICAgdGhpcy5xdWVyeVNldCA9IHF1ZXJ5U2V0O1xuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMucGVyc2lzdGVkVmVyc2lvbiA9IG5ldyBFbWl0dGVyKDApO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaWJlcnMgPSBbXTtcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc1NhdmluZ1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISF0aGlzLl9pc1NhdmluZ1Byb21pc2U7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc0VkaXRlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLmxlbmd0aCA+IDA7IH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLnB1c2goY2FsbGJhY2spO1xuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub25TdGF0ZUNoYW5nZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gdGhpcy5lcnJvclN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gY2FsbGJhY2s7IH0pO1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMgPSB0aGlzLnN0YXRlU3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBjYWxsYmFjazsgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yLCByZXRyeWFibGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCByZXRyeWFibGUsIF90aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfKSB7IH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaFN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soX3RoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm11dGF0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIGRlYm91bmNlKSB7XG4gICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5hZGQobXV0YXRpb25zKTtcbiAgICAgICAgKyt0aGlzLmN1cnJlbnRWZXJzaW9uO1xuICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgdGhpcy5xdWVyeVNldC5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgICAgICBpZiAoIXRoaXMuX2lzU2F2aW5nUHJvbWlzZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWVvdXRJZClcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVvdXRJZCA9IHNldFRpbWVvdXQodGhpcy5zYXZlLmJpbmQodGhpcyksIGRlYm91bmNlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiBpc1NhdmluZywgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZywgYmVjYXNlIGl0IHdpbGwgcmUtY2hlY2sgaWYgYWRkaXRpb25hbFxuICAgICAgICAvLyBtdXRhdGlvbnMgaGF2ZSBjb21lLCB3aGVuIHNhdmluZyBpcyBkb25lLlxuICAgIH07XG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUucmV0cnlTYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZlKCk7XG4gICAgfTtcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHBlcnNpc3RlZFZlcnNpb247XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmxvYWQoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RlZFZlcnNpb24gPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShwZXJzaXN0ZWRWZXJzaW9uIDwgdmVyc2lvbikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7IC8vIEJlIG1vcmUgZWFnZXIgdG8gc2F2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmZpbHRlcihmdW5jdGlvbiAocGVyc2lzdGVkVmVyc2lvbikgeyByZXR1cm4gcGVyc2lzdGVkVmVyc2lvbiA+PSB2ZXJzaW9uOyB9KS5sb2FkKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzU2F2aW5nUHJvbWlzZSlcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XG4gICAgICAgIGlmICghdGhpcy5pc0VkaXRlZClcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlID0gdGhpcy5fc2F2ZSgpO1xuICAgICAgICB0aGlzLl9pc1NhdmluZ1Byb21pc2UuY2F0Y2goZnVuY3Rpb24gKCkgeyB9KS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9pc1NhdmluZ1Byb21pc2UgPSBudWxsOyB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2F2aW5nUHJvbWlzZTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLl9zYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtdXRhdGlvbnMsIHZlcnNpb24sIG11dGF0aW9uUmVxdWVzdHMsIHJlc18xLCBldGFnTXV0YXRpb25zLCBlcnJvcl8xO1xuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB0aGlzLmN1cnJlbnRWZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLm1vdmVUb1NhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvblJlcXVlc3RzID0gdGhpcy5tYXBNdXRhdGlvbnMobXV0YXRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCAxMSwgMTJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZ2V0Q2xpZW50KCkuYmF0Y2gobXV0YXRpb25SZXF1ZXN0cyldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNfMSA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGV0YWdNdXRhdGlvbnMgPSBPYmplY3Qua2V5cyhyZXNfMS5uZXdFdGFncykubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcDogJ3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhRG9jOiB7ICRldGFnOiByZXNfMS5uZXdFdGFnc1tpZF0gfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW52YWxpZGF0ZSBjYWNoZVxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZShtdXRhdGlvblJlcXVlc3RzLCB0aGlzLmdldFVzZXIoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDb21tbWl0IG11dGF0aW9ucyBhbG9uZyB3aXRoIGV0YWdNdXRhdGlvbnMgaW50byBxdWVyaWVzIGNhY2hlZCBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZGlzcGF0Y2godmVyc2lvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2V0LmNvbW1pdE11dGF0aW9ucyhNdXRhdGlvblF1ZXVlLm1lcmdlKG11dGF0aW9ucywgZXRhZ011dGF0aW9ucyksIHZlcnNpb24pXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT24gc3VjY2VzcywgY2xlYXIgc2F2aW5nIHF1ZXVlIGFzIHRoZSBtdXRhdGlvbnMgd2lsbCBub3cgYmUgY29tbWl0dGVkIHRvIGFsbCBxdWVyeSdzIGRhdGEgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5jbGVhclNhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBub3RpZnkgc3Vic2NyaWJlcnMgc28gdGhhdCB2aWV3cyBnZXQgdXBkYXRlZCB3aXRoIGNvbW1pdHRlZCByZXN1bHRzXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuX3NhdmUoKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFzIHdlbGwuXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlcnJvcl8xICYmIGVycm9yXzEubmFtZSAmJiBlcnJvcl8xLm5hbWUuc3RhcnRzV2l0aChcImh0dHA0XCIpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBY2Nlc3MgQ29udHJvbCBkZW5pZWQsIGJhZCByZXF1ZXN0IG9yIHNpbWlsYXIuIFRocm93IG11dGF0aW9ucyBhd2F5LlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5jbGVhclNhdmluZ1F1ZXVlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTsgLy8gaXNFZGl0ZWQgbWF5IGhhdmUgdHVybmVkIHRvIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG8gaG8hIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFsb25lLiBUSGV5IG1pZ2h0IGJlIG1vcmUgbHVja3kuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zYXZlKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIbyBobyEgQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYWxvbmUuIFRIZXkgbWlnaHQgYmUgbW9yZSBsdWNreS5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gODtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OiByZXR1cm4gWzMgLypicmVhayovLCAxMF07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFcnJvcihlcnJvcl8xLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTA7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEyXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hTdGF0ZUNoYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm1hcE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdmFyIGJyID0gbmV3IEJhdGNoUnVubmVyKCk7XG4gICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcbiAgICAgICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxuICAgICAgICAgICAgICAgICAgICBici51cGRhdGUobS50YWJsZSwgbS5pZCwgbS5kZWx0YURvYywgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZC1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtLnJlbGF0ZWREb2MuJGV0YWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vICRldGFnIG1lYW5zIHRoaXMgaXMgYSBuZXcgZG9jdW1lbnQuIEFkZCBpdCBiZWZvcmUgbGlua2luZyB0byBpdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyLmFkZCh0YWJsZXNbbS50YWJsZV0ucmVsYXRpb25zaGlwc1ttLmdyYXBoUHJvcF0sIG0ucmVsYXRlZERvYywgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnIubGluazIobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZERvYy5pZCwgbS5icmFuY2hJZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3JlbW92ZS1yZWxhdGVkJzpcbiAgICAgICAgICAgICAgICAgICAgYnIudW5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkSWQsIG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxuICAgICAgICAgICAgICAgICAgICBici5kZWxldGUobS50YWJsZSwgbS5pZCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyLWJyYW5jaCc6XG4gICAgICAgICAgICAgICAgICAgIGJyLmNsZWFyQnJhbmNoKG0uYnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdtZXJnZSc6XG4gICAgICAgICAgICAgICAgICAgIGJyLm1lcmdlKG0uYnJhbmNoSWQsIG0udGFyZ2V0QnJhbmNoSWQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xuICAgIH07XG4gICAgcmV0dXJuIEtlZEJhY2tlbmRXcml0ZXI7XG59KCkpO1xuZXhwb3J0IHsgS2VkQmFja2VuZFdyaXRlciB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC13cml0ZXIuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBtZXJnZURlbHRhcyB9IGZyb20gJy4vZGVsdGEtbWVyZ2UnO1xudmFyIE11dGF0aW9uUXVldWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gW107XG4gICAgfVxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5xdWV1ZSwgbXV0YXRpb25zKTtcbiAgICB9O1xuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLm1vdmVUb1NhdmluZ1F1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnNhdmluZ1F1ZXVlID0gTXV0YXRpb25RdWV1ZS5tZXJnZSh0aGlzLnNhdmluZ1F1ZXVlLCB0aGlzLnF1ZXVlKTtcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuY2xlYXJTYXZpbmdRdWV1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xuICAgIH07XG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLnByb3RvdHlwZS5hZmZlY3RzUXVlcnkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcbiAgICAgICAgaWYgKG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBtLm9wID09PSAnbWVyZ2UnIHx8IG0ub3AgPT09ICdjbGVhci1icmFuY2gnOyB9KSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XG4gICAgICAgICAgICAvLyBBIHF1ZXJ5IHdpdGggXCJpZHNcIiBmaWx0ZXIgd2lsbCBiZSBlYXN5IHRvIGRldGVjdCBhIG5vLW1hdGNoIG9uOlxuICAgICAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7IHJldHVybiBnbG9iYWxPcChtKSB8fCAoIWJyYW5jaFNlbnNpdGl2ZShtKSB8fCBtLmJyYW5jaElkID09PSBxdWVyeS5icmFuY2hJZCkgJiZcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIC8vIE90aGVyd2lzZSwgY2hlY2sgaWYgbXV0YXRpb25zIGFmZmVjdCBzYW1lIGJyYW5jaCBhbmQgdGFibGUuIENvdWxkIGJlIGRvbmUgbW9yZSBmaW5lIGdyYWluZWQsXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXG4gICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkge1xuICAgICAgICAgICAgcmV0dXJuIG0ub3AgPT09ICdkZWxldGUnID9cbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XG4gICAgICAgICAgICAgICAgZ2xvYmFsT3AobSkgPyB0cnVlIDpcbiAgICAgICAgICAgICAgICAgICAgbS5icmFuY2hJZCA9PSBxdWVyeS5icmFuY2hJZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUxID0gcXVldWUxLnNsaWNlKCk7XG4gICAgICAgIHZhciBtdXRhYmxlUXVldWUyID0gcXVldWUyLnNsaWNlKCk7XG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XG4gICAgICAgIHZhciBsZW4gPSBxdWV1ZTEubGVuZ3RoO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcbiAgICAgICAgICAgIGlmIChtLm9wID09PSAndXBkYXRlJykge1xuICAgICAgICAgICAgICAgIHZhciBvdmVybGFwcGluZ0lkT3BJZHggPSBtdXRhYmxlUXVldWUyLmZpbmRJbmRleChmdW5jdGlvbiAobmV3TXV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuYnJhbmNoSWQgPT09IG0uYnJhbmNoSWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5pZCA9PT0gbS5pZDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAob3ZlcmxhcHBpbmdJZE9wSWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YWJsZVF1ZXVlMVtpXSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG0sIHsgZGVsdGFEb2M6IG1lcmdlRGVsdGFzKG0uZGVsdGFEb2MsIG11dGFibGVRdWV1ZTJbb3ZlcmxhcHBpbmdJZE9wSWR4XS5kZWx0YURvYykgfSk7XG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgKytpKSB7XG4gICAgICAgICAgICBfbG9vcF8xKGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtdXRhYmxlUXVldWUxLmNvbmNhdChtdXRhYmxlUXVldWUyKTtcbiAgICB9O1xuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xufSgpKTtcbmV4cG9ydCB7IE11dGF0aW9uUXVldWUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfSBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xuaW1wb3J0ICogYXMgSnNvblNjaGVtYSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG52YXIgUXVlcnlTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUXVlcnlTZXQobXV0YXRpb25RdWV1ZSkge1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSBbXTtcbiAgICB9XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwodGhpcy5xdWVyaWVzLm1hcChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5jb21taXRNdXRhdGlvbnMobXV0YXRpb25zLCB2ZXJzaW9uKTsgfSkpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhbnVwSW52YWxpZFF1ZXJpZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuY2xlYW51cEludmFsaWRRdWVyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnF1ZXJpZXMgPSB0aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7XG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHEudGltZW91dEhhbmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQocS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3B0aW1pc3RpY011dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIHEubm90aWZ5U3Vic2NyaWJlcnMob3B0aW1pc3RpY011dGF0aW9ucyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmZpbmRRdWVyeSA9IGZ1bmN0aW9uICh0YWJsZSwgcXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlcmllcy5maW5kKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLnF1ZXJ5S2V5ID09PSBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGFibGUsIHF1ZXJ5KTsgfSk7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUucXVlcnlMb2NhbGx5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcbiAgICAgICAgLy8gRm9yIG5vdywgb25seSBoYW5kbGUgdGhpcyB2ZXJ5IGNvbW1vbiBhbmQgc3BlY2lhbCBjYXNlICh3aGljaFxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpO1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgcXVlcnkgd2FudHMgdG8gZ2V0IGEgc2luZ2xlIGVudGl0eSBieSBpdHMgSUQ6XG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgLy8gQW5kIGlmIHNvLCBpZiB3ZSBoYXZlIGFuIG91dGdvaW5nIG11dGF0aW9uIHRvIGNyZWF0ZSB0aGF0IGVudGl0eTpcbiAgICAgICAgICAgIGlmIChtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gbS5vcCA9PT0gJ2FkZC1yZWxhdGVkJyAmJiBtLnJlbGF0ZWREb2MuaWQgPT09IHF1ZXJ5Lmlkc1swXTsgfSkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcbiAgICAgICAgICAgICAgICAvLyBidXQgbGV0IHRoZSBvcHRpc3RpYyBmZWF0dXJlIG9mIEtlZEJhY2tlbmRRdWVyeSBhcHBseSB0aGUgbXV0YXRpb24gYmVmb3JlXG4gICAgICAgICAgICAgICAgLy8gbm90aWZ5aW5nIHN1YnNjcmliZXJzICh3ZSBkb24ndCB3YW50IGl0IHRvIGJlIHBlcnNpc3RlbnQgYmVmb3JlIHRoZSBzZXJ2ZXJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPSywgYW5vdGhlciBxdWl0ZSBjb21tb24gY2FzZSBpcyB3aGVuIHdlIGFzayBmb3IgYSBjZXJ0YWluIElEIGFuZCB0aGF0IElEIHJlcGxpZXNcbiAgICAgICAgLy8gd2l0aGluIGFub3RoZXIgcXVlcnlcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIE5vdCBwb3NzaWJsZSB0byBoYW5kbGVcbiAgICAgICAgaWYgKCFxdWVyeS5pZHMpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHEpIHtcbiAgICAgICAgICAgIGlmICghcS5nb3RJbml0aWFsUmVzcG9uc2UpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgIGlmIChxLnF1ZXJ5LmJyYW5jaElkICE9PSBxdWVyeS5icmFuY2hJZClcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjsgLy8gSXQgd291bGQgYmUgY29tcGxleCB0byBzdXBwb3J0IHZhcmlvdXMgZmxhZ3MuIFF1ZXJ5J3MgZGF0YSBtYXkgaW5jbHVkZSBpZHMgb25seS4gQ2FuJ3QgcmVseSBvbiB0aGUgcXVlcnkuXG4gICAgICAgICAgICB2YXIgcUluY2x1ZGVzID0gcS5pbmNsdWRlcztcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3QgaW5jbHVkZSwgYnV0IHRoaXMgcXVlcnkgZG9lcy4gQ2hlY2sgaWYgd2UgY2FuIGZpbmQgb3VyIHJlc3VsdCB3aXRoaW4gaXQuXG4gICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gcUluY2x1ZGVzLmZpbmQoZnVuY3Rpb24gKGwpIHsgcmV0dXJuIEpzb25TY2hlbWEudGFibGVzW3EudGFibGVdW1wicmVsYXRpb25zaGlwc1wiXVtsXSA9PT0gdGFibGU7IH0pO1xuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHEuZGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViRGF0YSA9IHF1ZXJ5QXJyYXkocXVlcnksIGVudGl0eVtsYWJlbF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IHJldHVybiByZXNfMVtyLmlkXSA9IHI7IH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMSA9IE9iamVjdC5rZXlzKHJlc18xKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXNfMVtpZF07IH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaW5jbHVkZXMuZXZlcnkoZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBxSW5jbHVkZXMuaW5jbHVkZXMobGFiZWwpOyB9KSlcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgLy8gTGFzdGx5LCBpZiB0aGUgcXVlcnkgaW5jbHVkZXMgYWxsIGdyYXBocyB0aGF0IHdlIGRvLCBwaWNrIHRoZSBzdWJzZXQgZnJvbSB0aGF0IHF1ZXJ5LlxuICAgICAgICAgICAgLy8gQ29uY3JldGUgZXhhbXBsZTogV2Ugb2JzZXJ2ZSBhIGNlcnRhaW4gVGFzayBieSBJRCBhbmQgd2FudCBpdHMga25vd2xlZGdlUmVxdWlyZW1lbnRzIGFsb25nIHdpdGggaXQsXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxuICAgICAgICAgICAgaWYgKHEudGFibGUgPT09IHRhYmxlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8yID0gcXVlcnlBcnJheShxdWVyeSwgcS5kYXRhKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XG4gICAgICAgICAgICAgICAgaWYgKCFxdWVyeS5pZHMuZXZlcnkoZnVuY3Rpb24gKGlkKSB7IHJldHVybiByZXN1bHRfMi5zb21lKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmlkID09PSBpZDsgfSk7IH0pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHEgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocSk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlXzEudmFsdWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoIWtiUXVlcnkpIHtcbiAgICAgICAgICAgIGtiUXVlcnkgPSBuZXcgS2VkQmFja2VuZFF1ZXJ5KHRhYmxlLCBxdWVyeSwgcmVwby5nZXRVc2VyKCksIHJlcG8sIHRoaXMubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoa2JRdWVyeS50aW1lb3V0SGFuZGxlKTtcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGtiUXVlcnkuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XG4gICAgfTtcbiAgICBRdWVyeVNldC5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xuICAgICAgICBpZiAoa2JRdWVyeSkge1xuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxuICAgICAgICAgICAga2JRdWVyeS51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgLy8gUmVsZWFzZSB1bm5lc2Nlc3NhcnkgbWVtb3J5IHdoZW4gdGhlcmUgYXJlIG5vIG1vcmUgc3Vic2NyaXB0aW9ucyBvZiB0aGlzIHF1ZXJ5LCBieSByZW1vdmluZyB0aGUgcXVlcnkgaXRzZWxmXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxuICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBTY2hlZHVsZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGluIDUgbWludXRlczpcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYga2JRdWVyeSBzdGlsbCBoYXMgbm8gc3Vic2NyaXB0aW9ucyAobm90IGNlcnRhaW4hIEEgbmV3IHN1YnNjcmliZXIgbWF5IGhhdmUgY29tZSBhbG9uZy4uLilcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtiUXVlcnkuc3Vic2NyaXB0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlcmllcyA9IF90aGlzLnF1ZXJpZXMuZmlsdGVyKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxICE9PSBrYlF1ZXJ5OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XG4gICAgICAgICAgICAgICAgICAgIDUwMCA6IC8vIERvbid0IGhvc3QgdG9vIG1hbnkgcXVlcmllcy4gR2FyYmFnZSBjb2xsZWN0IHRoaXMgd2l0aGluIDUwMCBtc1xuICAgICAgICAgICAgICAgICAgICA1ICogNjAwMDApOyAvLyBBbGxvdyBxdWVyeSBpbiBtZW1vcnkgZm9yIGFub3RoZXIgNSBtaW51dGVzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBRdWVyeVNldDtcbn0oKSk7XG5leHBvcnQgeyBRdWVyeVNldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWJsZUZyb21MYWJlbCh0YWJsZSwgbGFiZWwpIHtcbiAgICByZXR1cm4gdGFibGVzW3RhYmxlXS5yZWxhdGlvbnNoaXBzW2xhYmVsXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeUFycmF5KHF1ZXJ5LCBkYXRhKSB7XG4gICAgdmFyIGZpbHRlciA9IGdldEZpbHRlckZyb21RdWVyeShxdWVyeSk7XG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XG59XG5leHBvcnQgZnVuY3Rpb24gQU5EKGZpbHRlcjEsIGZpbHRlcjIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpIHtcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgaWYgKHF1ZXJ5LmZyb20pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA+PSBxdWVyeS5mcm9tOyB9KTtcbiAgICBpZiAocXVlcnkudG8pXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5kYXRlVGltZSA8IHF1ZXJ5LnRvOyB9KTtcbiAgICBpZiAocXVlcnkuaWRzKVxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XG4gICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgIHJldHVybiBBTkQoZmlsdGVyLCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5uYW1lID09PSBxdWVyeS5uYW1lOyB9KTtcbiAgICBpZiAocXVlcnkudGFncylcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRhZ3MgJiYgW10uY29uY2F0KHF1ZXJ5LnRhZ3MgfHwgW10pLnNvbWUoZnVuY3Rpb24gKHRhZykgeyByZXR1cm4geC50YWdzLmluY2x1ZGVzKHRhZyk7IH0pOyB9KTtcbiAgICAvLyBxdWVyeS5oYXNFZGdlc0Zyb20gYW5kIHF1ZXJ5Lmhhc0VkZ2VzVG8gY2Fubm90IGJ5IGZpbHRlcmVkIGhlcmVcbiAgICByZXR1cm4gZmlsdGVyO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGJyYW5jaFNlbnNpdGl2ZShtKSB7XG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdsb2JhbE9wKG0pIHtcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCBtaWdyYXRlIGZyb20gJy4vbWlncmF0ZSc7XG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcbiAgICBpZiAoY2xpZW50Ll9fbWlncmF0b3JfbWl4ZWRfaW4pXG4gICAgICAgIHJldHVybjtcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XG4gICAgdmFyIGdldCA9IGNsaWVudC5nZXQ7XG4gICAgdmFyIGxpc3QgPSBjbGllbnQubGlzdDtcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBjbGllbnQubGlzdCA9IGZ1bmN0aW9uICh0YWJsZSwgb3B0aW9ucykge1xuICAgICAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlO1xuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgcmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGRvYykgeyByZXR1cm4gbWlncmF0ZShkb2MsIHRhYmxlLCBpbmNsdWRlICYmIGluY2x1ZGUudG9TdHJpbmcoKS5zcGxpdCgnLCcpKTsgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBjbGllbnQ7XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVUYXNrIGZyb20gJy4vbWlncmF0ZS10YXNrJztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVDb3Vyc2UoY291cnNlLCBncmFwaHMpIHtcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxuICAgICAgICBjb3Vyc2UubW9kdWxlcyA9IFtdO1xuICAgIGNvdXJzZS5tb2R1bGVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZSkge1xuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcbiAgICAgICAgICAgIG1vZHVsZS5yZXNvdXJjZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XG4gICAgICAgICAgICBtb2R1bGUudGFza0lkcyA9IFtdO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykge1xuICAgICAgICBjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycyA9IFtdO1xuICAgIH1cbiAgICAvLyBFYXJsaWVyIHdyb25nIHNwZWxsaW5nIG9mIHJlc291cmNlc1xuICAgIGlmICgncmVzb3Vyc2VzJyBpbiBjb3Vyc2UgJiYgISgncmVzb3VyY2VzJyBpbiBjb3Vyc2UpKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xuICAgICAgICBkZWxldGUgY291cnNlLnJlc291cnNlcztcbiAgICB9XG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBbXTtcbiAgICB9XG4gICAgaWYgKGdyYXBocykge1xuICAgICAgICBncmFwaHMuZm9yRWFjaChmdW5jdGlvbiAobGFiZWwpIHtcbiAgICAgICAgICAgIHN3aXRjaCAobGFiZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XG4gICAgICAgICAgICAgICAgICAgIGNvdXJzZS50YXNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0YXNrKSB7IHJldHVybiBtaWdyYXRlVGFzayh0YXNrKTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLWNvdXJzZS5qcy5tYXAiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlVGFzayh0YXNrKSB7XG4gICAgaWYgKCF0YXNrLnJlc291cmNlcylcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtdGFzay5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZUNvdXJzZSBmcm9tICcuL21pZ3JhdGUtY291cnNlJztcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlKGRvYywgdGFibGUsIGdyYXBocykge1xuICAgIHN3aXRjaCAodGFibGUpIHtcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcbiAgICAgICAgICAgIG1pZ3JhdGVDb3Vyc2UoZG9jLCBncmFwaHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxuICAgICAgICAgICAgbWlncmF0ZVRhc2soZG9jKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xudmFyIENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29sbGVjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xuICAgICAgICB0aHJvdyBcIm1peGVkaW5cIjtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xuICAgICAgICAgICAgdmFyIGVtaXR0ZXJfMSA9IG5ldyBFbWl0dGVyKHgpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb2xsZWN0aW9uKGZ1bmN0aW9uIChzKSB7IHJldHVybiBlbWl0dGVyXzEuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPYnNlcnZhYmxlQ29sbGVjdGlvbi5mcm9tKCkgY2FuIG9ubHkgdGFrZSBhcnJheXMgb3Igb2JzZXJ2YWJsZXNcIik7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tYXAoZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIG1hcHBlcihpdGVtKTsgfSk7IH0pO1xuICAgIH07XG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgaXRlbXMpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLmZpbHRlcihmaWx0ZXIpOyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICByZXR1cm4gQ29sbGVjdGlvbi5mcm9tKHRoaXMudG9WYWx1ZSgpLmNvbWJpbmVMYXRlc3Qob3RoZXIpLm1hcChmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IF9hWzBdLCBvdGhlciA9IF9hWzFdO1xuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnJheSkgeyByZXR1cm4gYXJyYXkuc2xpY2UoKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICB2YXIgYVByb3AgPSBhICYmIGFbcHJvcF07XG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XG4gICAgICAgICAgICByZXR1cm4gYVByb3AgPiBiUHJvcCA/IDEgOiBhUHJvcCA8IGJQcm9wID8gLTEgOiAwO1xuICAgICAgICB9KTsgfSkudG9Db2xsZWN0aW9uKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLnRvVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XG4gICAgfTtcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5ncm91cEJ5ID0gZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcbiAgICAgICAgICAgIHZhciBydiA9IHt9O1xuICAgICAgICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xuICAgICAgICAgICAgICAgIGxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJ2O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChhcnIpIHsgcmV0dXJuIGFyclswXTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcbn0oT2JzZXJ2YWJsZSkpO1xuZXhwb3J0IHsgQ29sbGVjdGlvbiB9O1xuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gXCIuL3ZhbHVlXCI7XG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhFbWl0dGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEVtaXR0ZXIoaW5pdGlhbFZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB1bnN1YnNjcmliZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuc3Vic2NyaWJlcnMgPSBfdGhpcy5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzICE9PSBvYnNlcnZlcjtcbiAgICAgICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmVycy5wdXNoKFtvYnNlcnZlciwgc3Vic2NyaXB0aW9uXSk7XG4gICAgICAgICAgICBpZiAoX3RoaXMuZXJyb3IpXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIoX3RoaXMudmFsdWUsIHVuZGVmaW5lZCwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICAgIH0pIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN1YnNjcmliZXJzID0gW107XG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcbiAgICB9O1xuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaCgpO1xuICAgIH07XG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCBfdGhpcy5lcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEVtaXR0ZXI7XG59KFZhbHVlKSk7XG5leHBvcnQgeyBFbWl0dGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4vb2JzZXJ2YWJsZSc7XG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcbmV4cG9ydCAqIGZyb20gJy4vY29sbGVjdGlvbic7XG5leHBvcnQgKiBmcm9tICcuL2VtaXR0ZXInO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIGluaXRNYXBNZXRob2QoY3Rvcikge1xuICAgIHJldHVybiBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgY3RvcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihtYXBwZXIodmFsdWUpLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9KTsgfSk7XG4gICAgfTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1hcC5qcy5tYXAiLCJleHBvcnQgZnVuY3Rpb24gbWl4aW4odGFyZ2V0UHJvdG8sIG1peGluUHJvdG8pIHtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBwcm9wc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcHJvcHMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkgeyByZXR1cm4gdGFyZ2V0UHJvdG9bcHJvcF0gPSBtaXhpblByb3RvW3Byb3BdOyB9KTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1peGluLmpzLm1hcCIsInZhciBPYnNlcnZhYmxlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8vc3RhdGljIGdldCBbU3ltYm9sLnNwZWNpZXNdKCkgeyByZXR1cm4gdGhpczsgfVxuICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoX3N1YnNjcmliZSkge1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBfc3Vic2NyaWJlO1xuICAgIH1cbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIoaXRlbXMsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVyciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCB7IHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7IH0gfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZhYmxlO1xufSgpKTtcbmV4cG9ydCB7IE9ic2VydmFibGUgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUuanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSBcIi4vY29sbGVjdGlvblwiO1xudmFyIFZhbHVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRzbGliXzEuX19leHRlbmRzKFZhbHVlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZhbHVlKHN1YnNjcmliZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc3Vic2NyaWJlKSB8fCB0aGlzO1xuICAgIH1cbiAgICBWYWx1ZS5mcm9tID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKHguc3Vic2NyaWJlKVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZS5mcm9tKCkgY2FuIG9ubHkgdGFrZSBvYnNlcnZhYmxlc1wiKTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHN1YnNjaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgc3Vic2NpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIGlmIChlcnJvcilcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGZuKHZhbHVlKSlcbiAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgIH0pOyB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAocHJlZml4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocHJlZml4LCB4KTtcbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS50b0NvbGxlY3Rpb24gPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gX3RoaXMubWFwKG1hcHBlcikuc3Vic2NyaWJlKHMpOyB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW251bGwsIG51bGxdO1xuICAgICAgICAgICAgdmFyIG15U3Vic2NyaXB0aW9uLCBvdGhlclN1YnNjcmlwdGlvbjtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24gPSBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBzLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSBpdGVtcztcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzWzFdICE9PSBudWxsKVxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZXMsIG51bGwsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG90aGVyU3Vic2NyaXB0aW9uID0gb3RoZXIuc3Vic2NyaWJlKGZ1bmN0aW9uICh2YWx1ZSwgZXJyb3IsIHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlc1swXSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFZhbHVlLnByb3RvdHlwZS5zd2l0Y2hNYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgICAgICB2YXIgbWFwcGVkU3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBudWxsO1xuICAgICAgICAgICAgdmFyIHJldHVybmVkU3Vic2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGVkU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbiA9IHM7XG4gICAgICAgICAgICAgICAgaWYgKG1hcHBlZFN1YnNjcmlwdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgICAgbWFwcGVkU3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgcmV0dXJuZWRTdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGVPclZhbHVlID0gbWFwcGVyKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmFibGVPclZhbHVlICYmIHR5cGVvZiBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcih2YWx1ZSwgZXJyb3IsIHJldHVybmVkU3Vic2NyaXB0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG9ic2VydmFibGVPclZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiByZXR1cm5lZFN1YnNjcmlwdGlvbjtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gVmFsdWU7XG59KE9ic2VydmFibGUpKTtcbmV4cG9ydCB7IFZhbHVlIH07XG5WYWx1ZS5wcm90b3R5cGUubWFwID0gaW5pdE1hcE1ldGhvZChWYWx1ZSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWx1ZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwbyc7XG4iLCJ2YXIgbWFwID0ge1xuXHRcIi4vZW4tYXVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWF1LmpzXCIsXG5cdFwiLi9lbi1hdS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWNhXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1jYS5qc1wiLFxuXHRcIi4vZW4tY2EuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1nYlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tZ2IuanNcIixcblx0XCIuL2VuLWdiLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4taWVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWllLmpzXCIsXG5cdFwiLi9lbi1pZS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLW56XCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vZW4tbnouanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLW56LmpzXCIsXG5cdFwiLi9zdlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIixcblx0XCIuL3N2LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9zdi5qc1wiXG59O1xuXG5cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0KHJlcSkge1xuXHR2YXIgaWQgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmUocmVxKTtcblx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oaWQpO1xufVxuZnVuY3Rpb24gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSkge1xuXHR2YXIgaWQgPSBtYXBbcmVxXTtcblx0aWYoIShpZCArIDEpKSB7IC8vIGNoZWNrIGZvciBudW1iZXIgb3Igc3RyaW5nXG5cdFx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRcdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0XHR0aHJvdyBlO1xuXHR9XG5cdHJldHVybiBpZDtcbn1cbndlYnBhY2tDb250ZXh0LmtleXMgPSBmdW5jdGlvbiB3ZWJwYWNrQ29udGV4dEtleXMoKSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyhtYXApO1xufTtcbndlYnBhY2tDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrQ29udGV4dFJlc29sdmU7XG5tb2R1bGUuZXhwb3J0cyA9IHdlYnBhY2tDb250ZXh0O1xud2VicGFja0NvbnRleHQuaWQgPSBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUgc3luYyByZWN1cnNpdmUgc3Z8ZW5cIjsiLCJpbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVzZXJDbGFpbXMgKHVzZXI6IFVzZXIpIHtcbiAgcmV0dXJuIFt7XG4gICAgdHlwZTogXCJlbWFpbFwiLFxuICAgIHZhbHVlOiB1c2VyLm1haWxcbiAgfSx7XG4gICAgdHlwZTogXCJzY2hvb2xcIixcbiAgICB2YWx1ZTogdXNlci5zY2hvb2xcbiAgfV0uY29uY2F0KHVzZXIucm9sZXMubWFwKHJvbGUgPT4gKHtcbiAgICB0eXBlOiBcInJvbGVcIixcbiAgICB2YWx1ZTogcm9sZVxuICB9KSkpLmNvbmNhdCh1c2VyLnJvbGVzLm1hcChyb2xlID0+ICh7XG4gICAgdHlwZTogXCJzY2hvb2xSb2xlXCIsXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sICsgXCIvXCIgKyByb2xlXG4gIH0pKSk7XG59XG4iLCJpbXBvcnQgeyBBY2Nlc3NDbGFpbSwgRG9jdW1lbnRBY2Nlc3MsIGhhc0FjY2VzcyBhcyBfaGFzQWNjZXNzLCBBY2Nlc3NSaWdodCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IERvY3VtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGdldFVzZXJDbGFpbXMgZnJvbSAnLi9nZXQtdXNlci1jbGFpbXMnO1xuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZyB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XG5leHBvcnQgeyBnZXRVc2VyQ2xhaW1zIH07XG5cbmV4cG9ydCBjb25zdCBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyA9IFtcInVzZXJcIixcInJvbGVcIixcInNjaG9vbFwiLFwiZGVidWdcIixcInRlc3RWZXJzaW9uXCIsXCJ0ZXN0dmVyc2lvblwiLFwic2Nob29sVHlwZVwiLFwic2Nob29sdHlwZVwiXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0FjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50LCByZXF1ZXN0ZWRSaWdodDogQWNjZXNzUmlnaHQpIHtcbiAgdmFyIGNsYWltcyA9IGdldFVzZXJDbGFpbXModXNlcik7XG4gIGlmIChyZXF1ZXN0ZWRSaWdodCAhPT0gJ1InICYmIHVzZXIudHV0b3JGb3IpIHtcbiAgICBjbGFpbXMgPSBjbGFpbXMuZmlsdGVyKGNsYWltID0+IGNsYWltLnR5cGUgIT09ICdlbWFpbCcpO1xuICB9XG4gIHZhciByZXN1bHQgPSBfaGFzQWNjZXNzKERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmdBcnJheShkb2MuYWNsIHx8IFtdKSwgY2xhaW1zLCByZXF1ZXN0ZWRSaWdodCk7XG4gIC8vY29uc29sZS5sb2coYEhhcyAke3JlcXVlc3RlZFJpZ2h0fSBhY2Nlc3MgdG8gJHtkb2MubmFtZX0vJHtkb2MuaWR9OiAke3Jlc3VsdH1gKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1JlYWRBY2Nlc3ModXNlcjogVXNlciwgZG9jOiBEb2N1bWVudCkge1xuICByZXR1cm4gaGFzQWNjZXNzKHVzZXIsIGRvYywgJ1InKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc1dyaXRlQWNjZXNzKHVzZXI6IFVzZXIsIGRvYzogRG9jdW1lbnQpIHtcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdXJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNTaGFyZUFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XG4gIHJldHVybiBoYXNBY2Nlc3ModXNlciwgZG9jLCAnUycpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNUZWFjaGVyQXRTY2hvb2wodXNlcjogVXNlciwgc2Nob29sOiBzdHJpbmcpIHtcbiAgY29uc3QgaXNUZWFjaGVyID0gdXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gJ0VNUExPWUVFJyB8fCByb2xlID09PSAnQURNSU4nKTtcbiAgY29uc3QgYmVsb25nc1RvU2Nob29sID0gKHNjaG9vbHx8XCJcIikudG9Mb3dlckNhc2UoKSA9PT0gdXNlci5zY2hvb2wudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIChpc1RlYWNoZXIgJiYgYmVsb25nc1RvU2Nob29sKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQWRtaW5PclRlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xuICByZXR1cm4gdXNlci5yb2xlcy5pbmNsdWRlcyhcIkFETUlOXCIpIHx8IGlzVGVhY2hlckF0U2Nob29sKHVzZXIsIHNjaG9vbCk7XG59XG5cbmV4cG9ydCBjb25zdCBpbXBlcnNvbmF0aW9uRW52ID0ge1xuICBhY3RBcyAob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcbiAgICBjb25zdCB7cm9sZSwgc2Nob29sLCB1cmx9ID0gb3B0aW9ucztcbiAgICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XG4gICAgY29uc3QgbmV3UXVlcnkgPSB7Li4uY3VycmVudFF1ZXJ5LCByb2xlLCBzY2hvb2x9O1xuICAgIGNvbnN0IG5ld1F1ZXJ5U3RyaW5nID0gZ2VuZXJhdGVRdWVyeVN0cmluZyhuZXdRdWVyeSk7XG4gICAgaWYgKHVybCkge1xuICAgICAgbG9jYXRpb24uaHJlZiA9IGAke3VybH0ke25ld1F1ZXJ5U3RyaW5nfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLmhhc2ggPSBcIiNcIjtcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCA9IG5ld1F1ZXJ5U3RyaW5nO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWN0QXMob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcbiAgaW1wZXJzb25hdGlvbkVudi5hY3RBcyhvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5ICh1cmw6IHN0cmluZywgcXVlcnk6IHtbbmFtZTogc3RyaW5nXSA6IHN0cmluZ30pIHtcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xuICBjb25zdCBwcmVzZXJ2ZWRRdWVyeSA9IHt9O1xuICBmb3IgKGNvbnN0IHBhcmFtIG9mIElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TKSB7XG4gICAgaWYgKGN1cnJlbnRRdWVyeVtwYXJhbV0pIHByZXNlcnZlZFF1ZXJ5W3BhcmFtXSA9IGN1cnJlbnRRdWVyeVtwYXJhbV07XG4gIH1cbiAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHsuLi5wcmVzZXJ2ZWRRdWVyeSwgLi4ucXVlcnl9KTtcbiAgY29uc3QgcEhhc2ggPSB1cmwuaW5kZXhPZignIycpO1xuICByZXR1cm4gcEhhc2ggPj0gMCA/XG4gICAgYCR7dXJsLnN1YnN0cigwLHBIYXNoKX0ke25ld1F1ZXJ5U3RyaW5nfSR7dXJsLnN1YnN0cihwSGFzaCl9YCA6XG4gICAgYCR7dXJsfSR7bmV3UXVlcnlTdHJpbmd9YDtcbn1cbiIsImltcG9ydCB7IEVEU0NvdXJzZSwgRURTQXNzZXNzbWVudCwgRURTU3R1ZHlQbGFuLCBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eSwgRURTU3R1ZGVudCB9IGZyb20gJy4uL2NvbnRyYWN0cy9lZHMnO1xuaW1wb3J0IHsgUmVzdENsaWVudCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IElzb21vcnBoaWNFbnYsIEJlYXJlclByb3ZpZGVyLCBIdHRwRXJyb3IgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgeyBTY2hvb2xNb21lbnQgfSBmcm9tICcuLi91dGlscy9zY2hvb2wtbW9tZW50JztcbmltcG9ydCB7IFNjaG9vbFRlcm0gfSBmcm9tICcuLi91dGlscy9zY2hvb2wtdGVybSc7XG5pbXBvcnQgeyBkYXRlVGltZVJldml2ZXIsIEwgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBFZHNDbGllbnQge1xuICBodHRwOiBSZXN0Q2xpZW50O1xuICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmc7XG5cbiAgY29uc3RydWN0b3IgKFxuICAgIGlzb21vcnBoaWM6IElzb21vcnBoaWNFbnYsXG4gICAgYmFzZVVybDogc3RyaW5nLFxuICAgIGJlYXJlclByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcixcbiAgICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmdcbiAgKSB7XG4gICAgdGhpcy5odHRwID0gbmV3IFJlc3RDbGllbnQgKGlzb21vcnBoaWMsIGJhc2VVcmwsIHtiZWFyZXJQcm92aWRlcn0pO1xuICAgIHRoaXMudXNlckVtYWlsR2V0dGVyID0gdXNlckVtYWlsR2V0dGVyO1xuICAgIHRoaXMuZ2V0QWN0aXZlQ291cnNlcyA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldEFjdGl2ZUNvdXJzZXMpO1xuICAgIHRoaXMuZ2V0TGF0ZXN0QXNzZXNzbWVudHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRMYXRlc3RBc3Nlc3NtZW50cyk7XG4gICAgdGhpcy5nZXRTdHVkZW50R29hbHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRTdHVkZW50R29hbHMpO1xuICAgIHRoaXMuZ2V0U3R1ZGVudEZ1dHVyZUFiaWxpdGllcyA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMpO1xuICAgIHRoaXMuZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5nZXRUZWFjaGVyVHV0b3JTdHVkZW50cyk7XG4gIH1cblxuICBwcml2YXRlIHByaXZhdGl6aW5nQ2FjaGVCdXN0KCkge1xuICAgIHJldHVybiB7dXNlcjogdGhpcy51c2VyRW1haWxHZXR0ZXIoKX07XG4gIH1cblxuLyoqXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxuICAgKlxuICAgKiBAcGFyYW0gY291cnNlQ29kZSBTaG9ydC1uYW1lIG9mIHRoZSBjb3Vyc2UuIE9wdGlvbmFsLlxuICAgKi9cbiAgYXN5bmMgZ2V0QWN0aXZlQ291cnNlcyhxOiB7Y291cnNlQ29kZT86IHN0cmluZywgcGVyaW9kTmFtZTogc3RyaW5nfSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgICBpZiAocSkge1xuICAgICAgICBpZiAocS5jb3Vyc2VDb2RlKSBxdWVyeS5Db3Vyc2VDb2RlID0gcS5jb3Vyc2VDb2RlO1xuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhY3RpdmVjb3Vyc2VzXCIsIHF1ZXJ5KTtcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcbiAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgcmV0dXJuIGpzb24uY291cnNlcyBhcyBFRFNDb3Vyc2VbXTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZyb20gRURTOiBcIiArIGV4KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihMYEt1bmRlIHR5dsOkcnIgaW50ZSBsYWRkYSB0ZXJtaW5zbcOlbCBlbGxlciBhdmtsYXJhZGUgc3RlZyBmcsOlbiBFRFMuIEbDtnJzw7ZrIGlnZW4gc2VuYXJlLi4uYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlIGxhdGVzdCBhc3Nlc3NtZW50cyBmb3IgY3VycmVudCBsb2dnZWQgaW4gdXNlci5cbiAgICogXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxuICAgKi9cbiAgYXN5bmMgZ2V0TGF0ZXN0QXNzZXNzbWVudHMobGltaXQ/OiBudW1iZXIpIHtcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XG4gICAgaWYgKCFpc05hTihsaW1pdCkpIHF1ZXJ5LkNvdW50ID0gbGltaXQ7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRhc3Nlc3NtZW50c1wiLCBxdWVyeSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLmFzc2Vzc21lbnRzIGFzIEVEU0Fzc2Vzc21lbnRbXTsgICAgXG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxuICAgKi9cbiAgYXN5bmMgZ2V0U3R1ZGVudEdvYWxzKCkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcbiAgfVxuXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInN0dWRlbnRGdXR1cmVBYmlsaXRpZXNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEZ1dHVyZUFiaWxpdGllcyBhcyBFRFNTdHVkZW50RnV0dXJlQWJpbGl0eVtdO1xuICB9XG5cbiAgYXN5bmMgZ2V0VGVhY2hlclR1dG9yU3R1ZGVudHMoKSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy5odHRwLmdldChcInRlYWNoZXJ0dXRvcnN0dWRlbnRzXCIsIHRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgIHJldHVybiBqc29uLnN0dWRlbnRzIGFzIEVEU1N0dWRlbnRbXTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRURTUGVyaW9kIHtcbiAgcGVyaW9kOiBzdHJpbmc7XG4gIHRlcm06ICdBVCcgfCAnU1QnO1xuICB5ZWFyOiBudW1iZXI7XG4gIGNvbnN0cnVjdG9yIChwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm06IHN0cmluZyB8IFNjaG9vbE1vbWVudCkge1xuICAgIGlmICh0eXBlb2YgcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy5wZXJpb2QgPSBwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm07XG4gICAgICB0aGlzLnRlcm0gPSB0aGlzLnBlcmlvZC5zdGFydHNXaXRoKCdIVCcpID8gJ0FUJyA6ICdTVCc7XG4gICAgICB0aGlzLnllYXIgPSBwYXJzZUludCh0aGlzLnBlcmlvZC5zdWJzdHIoMikpO1xuICAgICAgaWYgKGlzTmFOKHRoaXMueWVhcikpIHRocm93IG5ldyBFcnJvciAoYEludmFsaWQgcGVyaW9kOiAke3RoaXMucGVyaW9kfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzY2hvb2xUZXJtID0gbmV3IFNjaG9vbFRlcm0ocGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtKTtcbiAgICAgIHRoaXMucGVyaW9kID0gKHNjaG9vbFRlcm0udGVybSA9PT0gJ0FUJyA/IFwiSFRcIiA6IFwiVlRcIikgKyBzY2hvb2xUZXJtLnllYXI7XG4gICAgICB0aGlzLnRlcm0gPSBzY2hvb2xUZXJtLnRlcm07XG4gICAgICB0aGlzLnllYXIgPSBzY2hvb2xUZXJtLnllYXI7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNjaG9vbFRlcm0gKCkgOiBTY2hvb2xUZXJtIHtcbiAgICByZXR1cm4gbmV3IFNjaG9vbFRlcm0oe1xuICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAgICBgJHt0aGlzLnllYXJ9LyR7dGhpcy55ZWFyICsgMX1gIDpcbiAgICAgICAgYCR7dGhpcy55ZWFyLTF9LyR7dGhpcy55ZWFyfWAsXG4gICAgICB0ZXJtOiB0aGlzLnRlcm1cbiAgICB9KTtcbiAgfVxuXG4gIHRvU3RyaW5nKCkge1xuICAgIHJldHVybiB0aGlzLnBlcmlvZDtcbiAgfVxuXG4gIHZhbHVlT2YoKSB7XG4gICAgcmV0dXJuIHRoaXMueWVhciArIFwiOlwiICsgKHRoaXMudGVybSA9PT0gJ1NUJyA/IFwiMVwiIDogXCIyXCIpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25EYXRlX29sZCAoanNvbkRhdGVTdHI6IHN0cmluZykgOiBEYXRlIHtcbiAgY29uc3QgZGF0ZSA9IGRhdGVUaW1lUmV2aXZlcihcIlwiLCBqc29uRGF0ZVN0cik7XG4gIGlmICghKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBKU09OIGRhdGUgc3RyaW5nOiBcIiArIGpzb25EYXRlU3RyKTtcbiAgcmV0dXJuIGRhdGU7XG59XG5cbmZ1bmN0aW9uIGF2b2lkU2ltdWx0YW5vdXNDYWxsczxULEE+KG1ldGhvZDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPikgOiAoLi4uYXJnczpBW10pPT5Qcm9taXNlPFQ+IHtcbiAgbGV0IG9uZ29pbmdQcm9taXNlczoge1thcmdzSnNvbjogc3RyaW5nXTogUHJvbWlzZTxUPn0gPSB7fTtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3NKc29uID0gSlNPTi5zdHJpbmdpZnkoW10uc2xpY2UuY2FsbChhcmd1bWVudHMpKTtcbiAgICBpZiAoIW9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0pIHtcbiAgICAgIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0gPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKHJlc3VsdD0+e1xuICAgICAgICBkZWxldGUgb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgRG9jdW1lbnQsIENvdXJzZSwgS25vd2xlZGdlUmVxdWlyZW1lbnQsIENvdXJzZU1vZHVsZSwgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGZsYXR0ZW4sIEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IFdpdGhHcmFwaHMgfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzKGNvdXJzZTogQ291cnNlKSB7XG4gIGNvbnN0IHVuY292ZXJlZFJlcXVpcmVtZW50cyA9IGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMucmVkdWNlKChyZXN1bHQsIGl0ZW0pID0+IHtcbiAgICByZXN1bHRbaXRlbS5pZF0gPSBpdGVtO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH0sIHt9IGFzIHsgW2lkOiBzdHJpbmddOiBLbm93bGVkZ2VSZXF1aXJlbWVudCB9KTtcblxuICBjb3Vyc2UudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICB0YXNrLmtub3dsZWRnZVJlcXVpcmVtZW50cy5mb3JFYWNoKGtyID0+IHtcbiAgICAgIGRlbGV0ZSB1bmNvdmVyZWRSZXF1aXJlbWVudHNba3IuaWRdO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gT2JqZWN0LmtleXModW5jb3ZlcmVkUmVxdWlyZW1lbnRzKS5tYXAoaWQgPT4gdW5jb3ZlcmVkUmVxdWlyZW1lbnRzW2lkXSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVxc1JlZmVyZW5jaW5nRG9jIHtcbiAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiBBcnJheTx7aWQ6IHN0cmluZ30+XG4gIGFiaWxpdGllczogQXJyYXk8e2lkOiBzdHJpbmd9PlxuICBjZW50cmFsQ29udGVudDogQXJyYXk8e2lkOiBzdHJpbmd9PlxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWRzTm90Q292ZXJlZEJ5VGFza3MoY291cnNlOiBDb3Vyc2UpIDoge1tpZDogc3RyaW5nXTogdHJ1ZX0ge1xuICByZXR1cm4gZ2V0SWRzTm90Q292ZXJlZEJ5UmVxUmVmZXJlbmNpbmdEb2NzKFxuICAgIFtjb3Vyc2UgYXMgV2l0aEdyYXBoczxDb3Vyc2UsIFwiYWJpbGl0aWVzXCIgfCBcImNlbnRyYWxDb250ZW50XCIgfCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiPl0sXG4gICAgY291cnNlLnRhc2tzIGFzIFdpdGhHcmFwaHM8VGFzaywgXCJhYmlsaXRpZXNcIiB8IFwiY2VudHJhbENvbnRlbnRcIiB8IFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCI+W10pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWRzTm90Q292ZXJlZEJ5UmVxUmVmZXJlbmNpbmdEb2NzKFxuICB0ZW1wbGF0ZXM6IFJlcXNSZWZlcmVuY2luZ0RvY1tdLFxuICBkb2NzQmVpbmdDaGVja2VkOiBSZXFzUmVmZXJlbmNpbmdEb2NbXSkgOiB7W2lkOiBzdHJpbmddOiB0cnVlfVxue1xuICBjb25zdCB1bmNvdmVyZWRJZHMgPSB7fTtcbiAgLy8gMS4gTWFyayB0aGUgaWRzIG9mIGFsbCBrbm93bGVkZ2UgcmVxdWlyZW1lbnRzLCBhYmlsaXRpZXMgYW5kIGNlbnRyYWwgY29udGVudCBmb3IgdGhpcyBjb3Vyc2U6XG4gIHRlbXBsYXRlcy5mb3JFYWNoKGNvdXJzZSA9PiB7XG4gICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5mb3JFYWNoKHIgPT4ge1xuICAgICAgdW5jb3ZlcmVkSWRzW3IuaWRdID0gdHJ1ZTtcbiAgICB9KTtcbiAgICBjb3Vyc2UuYWJpbGl0aWVzLmZvckVhY2goYSA9PiB7XG4gICAgICB1bmNvdmVyZWRJZHNbYS5pZF0gPSB0cnVlO1xuICAgIH0pO1xuICAgIGNvdXJzZS5jZW50cmFsQ29udGVudC5mb3JFYWNoKGNjID0+IHtcbiAgICAgIHVuY292ZXJlZElkc1tjYy5pZF0gPSB0cnVlO1xuICAgIH0pO1xuICB9KTtcbiAgLy8gMi4gTGlzdCBhbGwgdGFza3MgYW5kIHVubWFyayBhbGwgaWRzIHRoYXQgdGhleSByZWZlciB0b1xuICBkb2NzQmVpbmdDaGVja2VkLmZvckVhY2goZG9jID0+IHtcbiAgICBkb2Mua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZvckVhY2goa3IgPT4ge1xuICAgICAgZGVsZXRlIHVuY292ZXJlZElkc1trci5pZF07XG4gICAgfSk7XG4gICAgZG9jLmFiaWxpdGllcy5mb3JFYWNoKGEgPT4ge1xuICAgICAgZGVsZXRlIHVuY292ZXJlZElkc1thLmlkXTtcbiAgICB9KTtcbiAgICBkb2MuY2VudHJhbENvbnRlbnQuZm9yRWFjaChjYyA9PiB7XG4gICAgICBkZWxldGUgdW5jb3ZlcmVkSWRzW2NjLmlkXTtcbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiB1bmNvdmVyZWRJZHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdHlDaGVjayAoY291cnNlOiBDb3Vyc2UpIHtcbiAgZnVuY3Rpb24gaGFzRHVwbGljYXRlVGFza3MoY291cnNlOiBDb3Vyc2UpIHtcbiAgICBjb25zdCB0YXNrSWRzOiB7W2lkOnN0cmluZ106IGJvb2xlYW59ID0ge307XG4gICAgcmV0dXJuIGZsYXR0ZW4oY291cnNlLm1vZHVsZXMubWFwKG1vZHVsZSA9PiBtb2R1bGUudGFza0lkcy5tYXAodGFza0lkID0+IHtcbiAgICAgIGlmICh0YXNrSWRzW3Rhc2tJZF0pIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGNvdXJzZS50YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKTtcbiAgICAgICAgcmV0dXJuIExgU2FtbWEgdXBwZ2lmdCBmw7ZyZWtvbW1lciBmbGVyYSBnw6VuZ2VyOiBcIiR7dGFzay5uYW1lfVwiYDtcbiAgICAgIH1cbiAgICAgIHRhc2tJZHNbdGFza0lkXSA9IHRydWU7XG4gICAgfSkuZmlsdGVyKHggPT4geCkpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHRhc2tzV2l0aFNhbWVVcmwoY291cnNlOiBDb3Vyc2UpIHtcbiAgICBjb25zdCB0YXNrVXJsczoge1t1cmw6c3RyaW5nXTogVGFza30gPSB7fTtcbiAgICByZXR1cm4gY291cnNlLnRhc2tzLm1hcCh0YXNrID0+IHtcbiAgICAgIGlmICh0YXNrLnVybCkge1xuICAgICAgICBpZiAodGFza1VybHNbdGFzay51cmxdKSB7XG4gICAgICAgICAgcmV0dXJuIExgVHbDpSB1cHBnaWZ0ZXIgcGVrYXIgcMOlIHNhbW1hIFVSTDogXCIke3Rhc2tVcmxzW3Rhc2sudXJsXS5uYW1lfVwiIHNhbXQgXCIke3Rhc2submFtZX1cImA7XG4gICAgICAgIH1cbiAgICAgICAgdGFza1VybHNbdGFzay51cmxdID0gdGFzaztcbiAgICAgIH1cbiAgICB9KS5maWx0ZXIoeCA9PiB4KTsgIFxuICB9XG5cbiAgZnVuY3Rpb24gaGFzRW1wdHlNb2R1bGVOYW1lcyhjb3Vyc2U6IENvdXJzZSkge1xuICAgIHJldHVybiBjb3Vyc2UubW9kdWxlcy5zb21lIChtb2R1bGUgPT4gbW9kdWxlLm5hbWUgPT09IFwiXCIpICYmXG4gICAgICBMYERldCBmaW5ucyBtaW5zdCBlbiBtb2R1bCB1dGFuIGFuZ2l2ZXQgbmFtbmA7XG4gIH1cblxuICBmdW5jdGlvbiBoYXNEdXBsaWNhdGVNb2R1bGVOYW1lcyhjb3Vyc2U6IENvdXJzZSkge1xuICAgIGNvbnN0IG1vZHVsZU5hbWVzOiB7W25hbWU6IHN0cmluZ106IHRydWV9ID0ge307XG4gICAgcmV0dXJuIGNvdXJzZS5tb2R1bGVzLm1hcChtb2R1bGUgPT4ge1xuICAgICAgaWYgKG1vZHVsZS5uYW1lICYmIG1vZHVsZU5hbWVzW21vZHVsZS5uYW1lXSkge1xuICAgICAgICByZXR1cm4gTGBNb2R1bGVuIG1lZCBuYW1uICR7bW9kdWxlLm5hbWV9IGbDtnJla29tbWVyIGZsZXJhIGfDpW5nZXJgO1xuICAgICAgfVxuICAgICAgaWYgKG1vZHVsZS5uYW1lKSBtb2R1bGVOYW1lc1ttb2R1bGUubmFtZV0gPSB0cnVlO1xuICAgIH0pXG4gIH1cblxuICBjb25zdCBjaGVja3MgPSBmbGF0dGVuKFtcbiAgICBoYXNEdXBsaWNhdGVUYXNrcyhjb3Vyc2UpLFxuICAgIHRhc2tzV2l0aFNhbWVVcmwoY291cnNlKSxcbiAgICBoYXNFbXB0eU1vZHVsZU5hbWVzKGNvdXJzZSksXG4gICAgaGFzRHVwbGljYXRlTW9kdWxlTmFtZXMoY291cnNlKVxuICBdKTtcblxuICByZXR1cm4gY2hlY2tzLmZpbHRlciAocmVzdWx0ID0+IHJlc3VsdCk7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhc2tzUGVySWQgKGNvdXJzZTogQ291cnNlKSB7XG4gIGNvbnN0IHJlc3VsdDoge1tpZDogc3RyaW5nXTogVGFza1tdfSA9IHt9O1xuICBmdW5jdGlvbiBhZGQoaWQ6IHN0cmluZywgdGFzazogVGFzaykge1xuICAgIGNvbnN0IGxpc3QgPSByZXN1bHRbaWRdIHx8IChyZXN1bHRbaWRdID0gW10pO1xuICAgIGxpc3QucHVzaCh0YXNrKTtcbiAgfVxuICBjb3Vyc2UudGFza3MuZm9yRWFjaCh0YXNrID0+IHtcbiAgICB0YXNrLmFiaWxpdGllcy5mb3JFYWNoKGEgPT4gYWRkKGEuaWQsIHRhc2spKTtcbiAgICB0YXNrLmNlbnRyYWxDb250ZW50LmZvckVhY2goYyA9PiBhZGQoYy5pZCwgdGFzaykpO1xuICAgIHRhc2suZnV0dXJlQWJpbGl0aWVzLmZvckVhY2goZmEgPT4gYWRkKGZhLCB0YXNrKSk7XG4gIH0pO1xuICByZXR1cm4gcmVzdWx0O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3RcIjtcbmltcG9ydCB7IENvdXJzZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IHJlYWRCbG9iQXNUZXh0LCBhbGxvd0NvcHksIHJlYWRCbG9iQXNEYXRhVXJsIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQgeyBzaG93RXJyb3IsIEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tIFwia2VkYmFja2VuZC9jbGllbnRcIjtcbmltcG9ydCB7IGhhc0FjY2VzcyB9IGZyb20gXCIuLi8uLi8uLi9hY2Nlc3MtY29udHJvbFwiO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG50eXBlIENhbGxiYWNrID0gKCkgPT4gdm9pZDtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGl0bGU6IHN0cmluZyxcbiAgYWN0aXZlUGFnZTogQmFubmVyTWVudUl0ZW0sXG4gIGNhbGxiYWNrcz86IHsgW21lbnVOYW1lOiBzdHJpbmddOiBDYWxsYmFjayB9LFxuICByb3V0ZXM6IHsgW21lbnVOYW1lOiBzdHJpbmddOiBzdHJpbmcgfSAmIHsgZmVlZGJhY2s6IHN0cmluZyB9LFxuICBiYWNrZ3JvdW5kSW1hZ2U/OiBzdHJpbmcsXG4gIGlzVGVtcGxhdGU/LFxuICBob3N0PzogSUNvdXJzZUVkaXRvckhvc3QsXG4gIGNvdXJzZT86IENvdXJzZSxcbiAgb3JpZ0NvdXJzZT86IENvdXJzZVxufVxuXG50eXBlIEJhbm5lck1lbnVJdGVtID1cbiAgXCJjb3Vyc2VCdWlsZGVyXCIgfFxuICBcInN0dWRlbnRQYWdlXCIgfFxuICBcInRlbXBsYXRlQnVpbGRlclwiIHxcbiAgXCJzdWJqZWN0c1wiIHxcbiAgXCJzY2hvb2xzXCI7XG5cbmNvbnN0IEFkbWluTWVudUl0ZW1zID0gW1xuICB7IG5hbWU6IFwic2Nob29sc1wiLCB0ZXh0OiBMYFNrb2xvcmAsIHJvdXRlOiBcIi9zY2hvb2xzXCIgfSxcbiAgeyBuYW1lOiBcInN1YmplY3RzXCIsIHRleHQ6IExgw4RtbmVuYCwgcm91dGU6IFwiL3N1YmplY3RzXCIgfSxcbiAgLy97bmFtZTogXCJ0ZW1wbGF0ZUJ1aWxkZXJcIiwgdGV4dDogTGBNYWxsYnlnZ2FyZW5gLCByb3V0ZTogXCIvY291cnNlLXRlbXBsYXRlc1wifSxcbl1cblxuY29uc3QgTm9uQWRtaW5NZW51SXRlbXMgPSBbXG4gIHsgbmFtZTogXCJjb3Vyc2VCdWlsZGVyXCIsIHRleHQ6IExgS3Vyc2J5Z2dhcmVuYCwgcm91dGU6IFwiL2NvdXJzZXMvbmV3XCIgfSxcbiAgeyBuYW1lOiBcInN0dWRlbnRQYWdlXCIsIHRleHQ6IExgRWxldnNpZGFgLCByb3V0ZTogXCJcIiB9LFxuICB7IG5hbWU6IFwiZmVlZGJhY2tcIiwgdGV4dDogPHNwYW4+PGkgY2xhc3NOYW1lPVwiZmEgZmEtY29tbWVudGluZy1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiBGZWVkYmFjazwvc3Bhbj4sIHJvdXRlOiBcImh0dHBzOi8va2cua3Vuc2thcHNwb3J0ZW4uc2Uva3Vyc2J5Z2dhcmVuL1wiIH1cbl1cblxuXG5hc3luYyBmdW5jdGlvbiBvbkRyb3BJbWFnZShldjogUmVhY3QuRHJhZ0V2ZW50PEhUTUxEaXZFbGVtZW50PiwgaG9zdDogSUNvdXJzZUVkaXRvckhvc3QsIGNvdXJzZTogQ291cnNlLCBvcmlnQ291cnNlOiBDb3Vyc2UpIHtcbiAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGZpbGVzID0gZXYuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICBsZXQgdXJsID0gbnVsbDtcbiAgY29uc3QgaXRlbXMgPSBBcnJheS5mcm9tKGV2LmRhdGFUcmFuc2Zlci5pdGVtcyk7XG4gIGlmIChmaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmlsZSA9IGZpbGVzWzBdO1xuICAgIGlmIChmaWxlLnNpemUgPiAyICogMTAyNCAqIDEwMjQpIHtcbiAgICAgIHNob3dFcnJvcihMYEthbiBpbnRlIGxhZGRhIHVwcCBiaWxkZXIgc3TDtnJyZSDDpG4gMiBNQmApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvL3VybCA9IGF3YWl0IHJlYWRCbG9iQXNEYXRhVXJsKGZpbGUpO1xuICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcbiAgICBmb3JtLmFwcGVuZChcImZpbGVzXCIsIGZpbGUpO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHAuZmV0Y2goXG4gICAgICAnd2ViLXVwbG9hZCcsXG4gICAgICAncHV0JyxcbiAgICAgIHt9LFxuICAgICAge30sXG4gICAgICB7XG4gICAgICAgIGJvZHk6IGZvcm1cbiAgICAgIH0pO1xuICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHtcbiAgICAgIHNob3dFcnJvcihMYEt1bmRlIGludGUgbGFkZGEgdXBwIGZpbGVuIHRpbGwgR29vZ2xlIFN0b3JhZ2VgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdXJsID0gYXdhaXQgcmVzLnRleHQoKTtcbiAgfSBlbHNlIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgKytpKSB7XG4gICAgICBjb25zdCBpdGVtID0gaXRlbXNbaV07XG4gICAgICBpZiAoaXRlbS50eXBlLm1hdGNoKCdedGV4dC91cmktbGlzdCcpKSB7XG4gICAgICAgIC8vIFVSSVxuICAgICAgICB1cmwgPSBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IGl0ZW0uZ2V0QXNTdHJpbmcocmVzb2x2ZSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAodXJsID09IG51bGwpIHtcbiAgICBzaG93RXJyb3IoTGBLdW5kZSBpbnRlIGhpdHRhIG7DpWdvbiBiaWxkIGkgaW5uZWjDpWxsZXRgKTtcbiAgICByZXR1cm47XG4gIH1cbiAgc2V0Q291cnNlSW1hZ2UoY291cnNlLCBvcmlnQ291cnNlLCBob3N0LCB1cmwpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0Q291cnNlSW1hZ2UoXG4gIGNvdXJzZTogQ291cnNlLFxuICBvcmlnQ291cnNlOiBDb3Vyc2UsXG4gIGhvc3Q6IElDb3Vyc2VFZGl0b3JIb3N0LFxuICB1cmw6IHN0cmluZ1xuKSB7XG4gIGNvbnN0IGltYWdlSWQgPSBjcmVhdGVVVUlEKCk7XG4gIGhvc3QudXBkYXRlKHtcbiAgICBpbWFnZUlkOiB7ICRzZXQ6IGltYWdlSWQgfSxcbiAgICBpbWFnZXM6IHtcbiAgICAgICRzZXQ6IFt7XG4gICAgICAgIGlkOiBpbWFnZUlkLFxuICAgICAgICB1cmwsXG4gICAgICAgIGFjbDogW1xuICAgICAgICAgIGByb2xlOlVTRVI6UmAsXG4gICAgICAgICAgYHNjaG9vbFJvbGU6JHtlbnYuY3VycmVudFVzZXIuc2Nob29sfS9FTVBMT1lFRTpTYFxuICAgICAgICBdLFxuICAgICAgICAkbWV0YTogJ2FkZCdcbiAgICAgIH1dXG4gICAgfVxuICB9KTtcbn1cblxuLyogVGhpcyB2ZXJzaW9uIGhhZCB0aGUgYnVnIHRoYXQgb2xkIGltYWdlcyB3ZXJlIG5vdCByZXBsYWNlZC5cbk9uZSBjb3Vyc2UgYXQgVXBwc2FsYSBjb250YWluZWQgMTIgaW1hZ2VzLlxuXG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRDb3Vyc2VJbWFnZU9sZChcbiAgY291cnNlOiBDb3Vyc2UsXG4gIG9yaWdDb3Vyc2U6IENvdXJzZSxcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3QsXG4gIHVybDogc3RyaW5nKVxue1xuICBpZiAoIW9yaWdDb3Vyc2UgfHwgIW9yaWdDb3Vyc2UuaW1hZ2VJZCkge1xuICAgIGNvbnN0IGltYWdlSWQgPSBjcmVhdGVVVUlEKCk7XG4gICAgaG9zdC51cGRhdGUoe1xuICAgICAgaW1hZ2VJZDogeyAkc2V0OiBpbWFnZUlkIH0sXG4gICAgICBpbWFnZXM6IHtcbiAgICAgICAgJHB1c2g6IFt7XG4gICAgICAgICAgaWQ6IGltYWdlSWQsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIGFjbDogY291cnNlLmlzVGVtcGxhdGUgPyBbXCJyb2xlOlVTRVI6UlwiXSA6IFtcInJvbGU6VVNFUjpSXCIsIGBzY2hvb2xSb2xlOiR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUU6U2BdLFxuICAgICAgICAgICRtZXRhOiAnYWRkJ1xuICAgICAgICB9XVxuICAgICAgfVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIC8vIFVwZGF0ZSBleGlzdGluZyBpbWFnZTpcbiAgICBjb25zdCBpbWdJZHggPSBjb3Vyc2UuaW1hZ2VzLmZpbmRJbmRleChpbWcgPT4gaW1nLmlkID09PSBjb3Vyc2UuaW1hZ2VJZCk7XG4gICAgaWYgKGltZ0lkeCA+PSAwKSB7XG4gICAgICBjb25zdCBpbWFnZUVudGl0eSA9IGNvdXJzZS5pbWFnZXNbaW1nSWR4XTtcbiAgICAgIGlmIChjb3Vyc2UuaXNUZW1wbGF0ZSkge1xuICAgICAgICAvLyBUZW1wbGF0ZXM6IFVwZGF0ZSB0aGUgdGVtcGxhdGUgaW1hZ2UgY29udGVudDpcbiAgICAgICAgaG9zdC51cGRhdGUoe1xuICAgICAgICAgIGltYWdlczoge1xuICAgICAgICAgICAgJHNwbGljZTogW1tpbWdJZHgsIDEsIHtcbiAgICAgICAgICAgICAgLi4uaW1hZ2VFbnRpdHksXG4gICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgJG1ldGE6ICd1cGRhdGUnXG4gICAgICAgICAgICB9XV1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBSZWFsIGNvdXJzZXM6IFJlcGxhY2Ugd2l0aCBhIG5ldyBpbWFnZVxuICAgICAgICBjb25zdCBpbWFnZUlkID0gY3JlYXRlVVVJRCgpO1xuICAgICAgICBob3N0LnVwZGF0ZSh7XG4gICAgICAgICAgaW1hZ2VJZDogeyAkc2V0OiBpbWFnZUlkIH0sXG4gICAgICAgICAgaW1hZ2VzOiB7XG4gICAgICAgICAgICAkc3BsaWNlOiBbW2ltZ0lkeCwgMSwge1xuICAgICAgICAgICAgICBpZDogaW1hZ2VJZCxcbiAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICBhY2w6IFtcbiAgICAgICAgICAgICAgICBgcm9sZTpVU0VSOlJgLFxuICAgICAgICAgICAgICAgIGBzY2hvb2xSb2xlOiR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUU6U2BcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgJG1ldGE6ICdhZGQnXG4gICAgICAgICAgICB9XV1cbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNob3dFcnJvcihMYEt1bmRlIGludGUgdXBwZGF0ZXJhIGJpbGRlbi5gKTtcbiAgICB9XG4gIH1cbn1cbiovXG5cbmV4cG9ydCBjb25zdCBDb3Vyc2VCYW5uZXIgPSAocHJvcHM6IFByb3BzKSA9PiB7XG4gIGNvbnN0IHsgdGl0bGUsIGlzVGVtcGxhdGUsIGhvc3QsIGNvdXJzZSwgb3JpZ0NvdXJzZSwgYmFja2dyb3VuZEltYWdlLCBhY3RpdmVQYWdlIH0gPSBwcm9wcztcbiAgY29uc3QgaXNBZG1pbiA9IGVudi5jdXJyZW50VXNlci5yb2xlcy5zb21lKHJvbGUgPT4gcm9sZSA9PT0gXCJBRE1JTlwiKTtcbiAgbGV0IG1lbnVJdGVtcyA9IE5vbkFkbWluTWVudUl0ZW1zO1xuICBpZiAoaXNBZG1pbikgbWVudUl0ZW1zID0gQWRtaW5NZW51SXRlbXMuY29uY2F0KG1lbnVJdGVtcyk7XG5cbiAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zY3JpcHQtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgIHtiYWNrZ3JvdW5kSW1hZ2UgJiYgPHN0eWxlPntgXG4gICAgICAgIC5wYWdlSGVhZGVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJyR7YmFja2dyb3VuZEltYWdlfScpICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT59XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZUhlYWRlclwiXG4gICAgICAgICAgb25EcmFnT3Zlcj17Y291cnNlICYmIGFsbG93Q29weX1cbiAgICAgICAgICBvbkRyb3A9e2NvdXJzZSAmJiAoZXYgPT4gb25Ecm9wSW1hZ2UoZXYsIGhvc3QsIGNvdXJzZSwgb3JpZ0NvdXJzZSkpfT5cbiAgICAgICAgICA8YT5cbiAgICAgICAgICAgIDxoMT57dGl0bGV9PC9oMT5cbiAgICAgICAgICA8L2E+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zRmllbGRcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnV0dG9uc0NvbnRhaW5lclwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj48L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2hvcml6b250YWxNZW51Jz5cbiAgICAgICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgICB7bWVudUl0ZW1zLm1hcChpdGVtID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0sXG4gICAgICAgICAgICAgICAgICAgIGlzQWN0aXZlOiBhY3RpdmVQYWdlID09PSBpdGVtLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBwcm9wcy5jYWxsYmFja3MgJiYgcHJvcHMuY2FsbGJhY2tzW2l0ZW0ubmFtZV0sXG4gICAgICAgICAgICAgICAgICAgIGdpdmVuUm91dGU6IChwcm9wcy5yb3V0ZXMgJiYgcHJvcHMucm91dGVzW2l0ZW0ubmFtZV0pLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Um91dGU6IGl0ZW0ucm91dGVcbiAgICAgICAgICAgICAgICAgIH0pKS5maWx0ZXIoeCA9PiB4LmNhbGxiYWNrIHx8IHguZGVmYXVsdFJvdXRlIHx8IHguZ2l2ZW5Sb3V0ZSkubWFwKCh7IGl0ZW0sIGlzQWN0aXZlLCBjYWxsYmFjaywgZGVmYXVsdFJvdXRlLCBnaXZlblJvdXRlIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxsaVxuICAgICAgICAgICAgICAgICAgICAgIGtleT17aXRlbS5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17aXNBY3RpdmUgPyBcImFjdGl2ZVBhZ2VcIiA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17Y2FsbGJhY2t9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICB7Y2FsbGJhY2sgP1xuICAgICAgICAgICAgICAgICAgICAgICAgPGE+e2l0ZW0udGV4dH08L2E+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRSb3V0ZSB8fCBnaXZlblJvdXRlID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgZ2l2ZW5Sb3V0ZSB8fCAvXmh0dHBbc11cXDpcXC9cXC8vaS50ZXN0KGRlZmF1bHRSb3V0ZSkgP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dpdmVuUm91dGUgfHwgZGVmYXVsdFJvdXRlfT57aXRlbS50ZXh0fTwvYT4gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtkZWZhdWx0Um91dGV9PntpdGVtLnRleHR9PC9MaW5rPiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxhPntpdGVtLnRleHR9PC9hPn1cbiAgICAgICAgICAgICAgICAgICAgPC9saT47XG4gICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGZpbmRET01Ob2RlIH0gZnJvbSAncmVhY3QtZG9tJztcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBJbWFnZSwgVGFzaywgRG9jdW1lbnQsIEFiaWxpdHkgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCB9IGZyb20gJy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0JztcbmltcG9ydCB7IENvdXJzZU1vZHVsZUNvbXBvbmVudCB9IGZyb20gJy4vY291cnNlLW1vZHVsZSc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGNvdXJzZTogQ291cnNlO1xuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcbiAgaWRzTm90Q292ZXJlZEJ5QW55VGFzazoge1tpZDogc3RyaW5nXTogdHJ1ZX07XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG59XG5cbmV4cG9ydCBjbGFzcyBDb3Vyc2VNb2R1bGVMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIF9lbGVtOiBIVE1MRGl2RWxlbWVudDtcbiAgX21vZHVsZVJlZnM6IHtbbW9kdWxlSWQ6IHN0cmluZ106IENvdXJzZU1vZHVsZUNvbXBvbmVudH07XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuX21vZHVsZVJlZnMgPSB7fTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgIH1cbiAgfVxuXG4gIGFkZE1vZHVsZSgpIHtcbiAgICB0aGlzLnByb3BzLmhvc3QudXBkYXRlKHttb2R1bGVzOiB7JHB1c2g6IFt7XG4gICAgICBuYW1lOiBcIk55IGt1cnNtb2R1bFwiLFxuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgIHJlc291cmNlczogW10sXG4gICAgICB0YXNrSWRzOiBbXVxuICAgICB9IGFzIENvdXJzZU1vZHVsZVxuICAgIF19fSk7XG4gIH1cblxuICBnZXRPcmRlcmVkTW9kdWxlcygpIHtcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBtb2R1bGVPcmRlciA9IGNvdXJzZS5tb2R1bGVPcmRlciB8fCBjb3Vyc2UubW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcbiAgICByZXR1cm4gbW9kdWxlT3JkZXJcbiAgICAgIC8vIE1hcCBvcmRlcmVkIGlkIHRvIG1vZHVsZVxuICAgICAgLm1hcChpZCA9PiBjb3Vyc2UubW9kdWxlcy5maW5kKG0gPT4gbS5pZCA9PT0gaWQpKVxuICAgICAgLy8gSWdub3JlIGVudHJpZXMgdGhhdCBvbmx5IGV4aXN0cyBpbiBtb2R1bGVPcmRlciBidXQgbm90IGluIG1vZHVsZXNcbiAgICAgIC5maWx0ZXIobSA9PiAhIW0pXG4gICAgICAvLyBBcHBlbmQgbW9kdWxlcyBhdCBlbmQgdGhhdCBhcmUgbm90IGxpc3RlZCBpbiBtb2R1bGVPcmRlclxuICAgICAgLmNvbmNhdCAoY291cnNlLm1vZHVsZXMuZmlsdGVyKG0gPT4gIW1vZHVsZU9yZGVyLmZpbmQoaWQgPT4gbS5pZCA9PT0gaWQpKSk7XG4gIH1cblxuICBhc3luYyByZW9yZGVyIChtb2R1bGVJZDogc3RyaW5nLCBkaXJlY3Rpb246IC0xIHwgMSkge1xuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IG9yZGVyZWRNb2R1bGVzID0gdGhpcy5nZXRPcmRlcmVkTW9kdWxlcygpO1xuICAgIGNvbnN0IG1vZHVsZUluZGV4ID0gb3JkZXJlZE1vZHVsZXMuZmluZEluZGV4KG0gPT4gbS5pZCA9PT0gbW9kdWxlSWQpO1xuICAgIGNvbnN0IG5ld01vZHVsZUluZGV4ID0gbW9kdWxlSW5kZXggKyBkaXJlY3Rpb247XG4gICAgaWYgKG5ld01vZHVsZUluZGV4IDwgMCB8fCBuZXdNb2R1bGVJbmRleCA+PSBvcmRlcmVkTW9kdWxlcy5sZW5ndGgpIHtcbiAgICAgIC8vIENhbm5vdCBvcmRlciBvdXRzaWRlIGxpbWl0cy5cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY3VycmVudE1vZHVsZUF0UG9zaXRpb24gPSBvcmRlcmVkTW9kdWxlc1tuZXdNb2R1bGVJbmRleF07XG4gICAgY29uc3QgbW9kdWxlT3JkZXIgPSBvcmRlcmVkTW9kdWxlcy5tYXAobSA9PiBtLmlkKTtcbiAgICBtb2R1bGVPcmRlcltuZXdNb2R1bGVJbmRleF0gPSBtb2R1bGVJZDtcbiAgICBtb2R1bGVPcmRlclttb2R1bGVJbmRleF0gPSBjdXJyZW50TW9kdWxlQXRQb3NpdGlvbi5pZDtcbiAgICBjb25zdCBvcmlnU2Nyb2xsUG9zID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDtcbiAgICBhd2FpdCB0aGlzLnByb3BzLmhvc3QudXBkYXRlKHtcbiAgICAgIG1vZHVsZU9yZGVyOiB7JHNldDogbW9kdWxlT3JkZXJ9XG4gICAgfSk7XG4gICAgLy8gTm93LCBzY3JvbGwgc21vb3RobHkgaW50byB2aWV3IGFmdGVyIHJlb3JkZXJpbmc6XG4gICAgY29uc3QgZWxlbU1vZHVsZTogSFRNTEVsZW1lbnQgPSBmaW5kRE9NTm9kZSh0aGlzLl9tb2R1bGVSZWZzW21vZHVsZUlkXSk7XG4gICAgaWYgKGVsZW1Nb2R1bGUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7dG9wOiBvcmlnU2Nyb2xsUG9zfSk7IC8vIFByb2hpYml0IGRlZmF1bHQgc2Nyb2xsaW5nIGRpcmVjdGx5IHVwd2FyZHMgb24gbW92ZSB1cC5cbiAgICAgICAgZWxlbU1vZHVsZS5zY3JvbGxJbnRvVmlldyh7YmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ3N0YXJ0J30pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBPbmx5IENocm9tZSBiZXRhIHN1cHBvcnRzIHRoZSBhcmd1bWVudHMgZ2l2ZW4gYWJvdmUuIERlZmF1bHQgZm9yIG9sZGVyIGJyb3dzZXJzLlxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8obnVsbCwgb3JpZ1Njcm9sbFBvcyk7XG4gICAgICAgIGVsZW1Nb2R1bGUuc2Nyb2xsSW50b1ZpZXcodHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgY291cnNlLCBob3N0LCBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgbW9kdWxlT3JkZXIgPSBjb3Vyc2UubW9kdWxlT3JkZXIgfHwgY291cnNlLm1vZHVsZXMubWFwKG0gPT4gbS5pZCk7XG4gICAgY29uc3Qgb3JkZXJlZE1vZHVsZXMgPSB0aGlzLmdldE9yZGVyZWRNb2R1bGVzKCk7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiIHJlZj17ZWxlbSA9PiB0aGlzLl9lbGVtID0gZWxlbX0+XG4gICAgICB7b3JkZXJlZE1vZHVsZXMubWFwKG1vZHVsZSA9PiA8Q291cnNlTW9kdWxlQ29tcG9uZW50XG4gICAgICAgIHJlZj17ZWxlbSA9PiB0aGlzLl9tb2R1bGVSZWZzW21vZHVsZS5pZF0gPSBlbGVtfVxuICAgICAgICBrZXk9e21vZHVsZS5pZH1cbiAgICAgICAgY291cnNlPXtjb3Vyc2V9XG4gICAgICAgIG1vZHVsZT17bW9kdWxlfVxuICAgICAgICBvblJlb3JkZXI9e2RpcmVjdGlvbiA9PiB0aGlzLnJlb3JkZXIobW9kdWxlLmlkLCBkaXJlY3Rpb24pfVxuICAgICAgICBnZXRPcmRlcmVkTW9kdWxlcz17KCk9PnRoaXMuZ2V0T3JkZXJlZE1vZHVsZXMoKX1cbiAgICAgICAgaG9zdD17aG9zdH1cbiAgICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzaz17aWRzTm90Q292ZXJlZEJ5QW55VGFza31cbiAgICAgICAvPil9XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKT0+dGhpcy5hZGRNb2R1bGUoKX0+XG4gICAgICAgIEzDpGdnIHRpbGwga3Vyc21vZHVsXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfVxufVxuXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBmaW5kRE9NTm9kZSB9IGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgSW1hZ2UsIFRhc2ssIERvY3VtZW50LCBBYmlsaXR5IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCB7IEVkaXRhYmxlUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtcmVzb3VyY2UtbGlzdCc7XG5pbXBvcnQgeyBFZGl0YWJsZVRhc2tMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtdGFzay1saXN0JztcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCB9IGZyb20gJy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0JztcbmltcG9ydCB7IFJlbmFtZWFibGVUZXh0IH0gZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3JlbmFtZWFibGUtdGV4dCc7XG5pbXBvcnQgeyBSZW1vdmVJdGVtIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvcmVtb3ZlLWl0ZW0nO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IEwsIHNob3dFcnJvciB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgV3lzaXd5ZyB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnJztcbmltcG9ydCBhY3Rpb25zX3N3ZWRpc2ggZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy1zdic7XG5pbXBvcnQgeyBPcGVuQ2xvc2VCb3ggfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3gnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjb3Vyc2U6IENvdXJzZTtcbiAgbW9kdWxlOiBDb3Vyc2VNb2R1bGU7XG4gIGhvc3Q6IElDb3Vyc2VFZGl0b3JIb3N0O1xuICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrOiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcbiAgb25SZW9yZGVyOiAoZGlyZWN0aW9uOiAxIHwgLTEpID0+IHZvaWQ7XG4gIGdldE9yZGVyZWRNb2R1bGVzOiAoKT0+Q291cnNlTW9kdWxlW107XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGVkaXRNYW5kYXRvcnlDb250ZW50OiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX0tOT1dMRURHRV9NQVRSSVggPSBbe1xuICBhYmlsaXR5SWRzOiBbXSxcbiAgRUlkczogW10sXG4gIENJZHM6IFtdLFxuICBBSWRzOiBbXVxufV07XG5cbmV4cG9ydCBjbGFzcyBDb3Vyc2VNb2R1bGVDb21wb25lbnQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBlZGl0TWFuZGF0b3J5Q29udGVudDogZmFsc2VcbiAgICB9XG4gIH1cblxuICBnZXRNb2R1bGVJbmRleCgpIHtcbiAgICBjb25zdCB7Y291cnNlLCBtb2R1bGV9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gY291cnNlLm1vZHVsZXMuZmluZEluZGV4KG0gPT4gbS5pZCA9PT0gbW9kdWxlLmlkKTtcbiAgfVxuXG4gIGdldE1vZHVsZU9yZGVySW5kZXgoKSB7XG4gICAgY29uc3Qge2NvdXJzZSwgbW9kdWxlfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qgb3JkZXJlZE1vZHVsZXMgPSB0aGlzLnByb3BzLmdldE9yZGVyZWRNb2R1bGVzKCk7XG4gICAgcmV0dXJuIG9yZGVyZWRNb2R1bGVzLmZpbmRJbmRleChtID0+IG0uaWQgPT09IG1vZHVsZS5pZCk7XG4gIH1cblxuICB1cGRhdGVNb2R1bGUobW9kdWxlVXBkYXRlcykge1xuICAgIGNvbnN0IHttb2R1bGV9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB1cGRhdGVkTW9kdWxlID0gdXBkYXRlKG1vZHVsZSwgbW9kdWxlVXBkYXRlcyk7XG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XG4gICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZSh7IG1vZHVsZXM6IHsgJHNwbGljZTogW1ttb2R1bGVJbmRleCwgMSwgdXBkYXRlZE1vZHVsZV1dIH0gfSk7XG4gIH1cblxuICAvKiBUaGlzIG1ldGhvZCB3b3JrcyBmb3IgYm90aCBhZGRpbmcgbmV3IHRhc2tzIHRvIHRoZSB0YXNrIHRhYmxlXG4gIGFuZCBhZGRpbmcgcmVmZXJlbmNlcyB0byBleGlzdGluZyB0YXNrcy4gVGhlIG1hZ2ljIG9mIHRoYXQgaGFzIHRvIGRvIHdpdGhcbiAgd2hldGhlciB0YXNrLiRtZXRhID0gJ2FkZCcgb3Igbm90IGFuZCBpcyBkb25lIGluIEVkaXRDb3Vyc2Uuc2F2ZSgpXG4gICovXG4gIG9uVGFza0FkZGVkICh0YXNrOiBUYXNrLCB0YXNrQ3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPiB8IG51bGwpIHtcbiAgICAvLyBBZGQgdGFzayBJRCB0byBtb2R1bGUgdGFza0lkcyBsaXN0OlxuICAgIGNvbnN0IGNvdXJzZVVwZGF0ZXM6YW55ID0ge307XG4gICAgY29uc3QgdGFza0lkcyA9IHRoaXMucHJvcHMubW9kdWxlLnRhc2tJZHMuc2xpY2UoKTtcbiAgICB0YXNrSWRzLnB1c2godGFzay5pZCk7XG4gICAgLy8gQWRkIHBoeXNpY2FsIFRhc2sgdG8gQ291cnNlLnRhc2tzLlxuICAgIGlmICghdGhpcy5wcm9wcy5jb3Vyc2UudGFza3Muc29tZSh0ID0+IHQuaWQgPT09dGFzay5pZCkpIHtcbiAgICAgIGNvdXJzZVVwZGF0ZXMudGFza3MgPSB7JHB1c2g6IFt0YXNrXX07XG4gICAgfVxuICAgIGNvbnN0IGN1c3RvbWl6YXRpb25zID0gey4uLih0aGlzLnByb3BzLm1vZHVsZS50YXNrQ3VzdG9taXphdGlvbnMgfHwge30pfTtcbiAgICBpZiAodGFza0N1c3RvbWl6YXRpb24pIGN1c3RvbWl6YXRpb25zW3Rhc2suaWRdID0gdGFza0N1c3RvbWl6YXRpb247XG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XG4gICAgY291cnNlVXBkYXRlcy5tb2R1bGVzID0ge307XG4gICAgY291cnNlVXBkYXRlcy5tb2R1bGVzW21vZHVsZUluZGV4XSA9IHtcbiAgICAgIHRhc2tJZHM6IHskc2V0OiB0YXNrSWRzfSxcbiAgICAgIHRhc2tDdXN0b21pemF0aW9uczogeyRzZXQ6IGN1c3RvbWl6YXRpb25zfVxuICAgIH07XG4gICAgLy8gVXBkYXRlIG1vZHVsZVxuICAgIHRoaXMucHJvcHMuaG9zdC51cGRhdGUoY291cnNlVXBkYXRlcyk7XG4gIH1cblxuICBvblRhc2tVcGRhdGVkICh0YXNrOiBUYXNrKSB7XG4gICAgaWYgKCF0YXNrLiRtZXRhKSB0aHJvdyBuZXcgRXJyb3IoTGBIb3Bwc2FuLCBibGV2IGxpdGUga25hcy4gRmVsIElEOiAkeydQYTdEcSd9YCk7XG4gICAgY29uc3QgdGFza0luZGV4ID0gdGhpcy5wcm9wcy5jb3Vyc2UudGFza3MuZmluZEluZGV4KHQgPT4gdC5pZCA9PT0gdGFzay5pZCk7XG4gICAgaWYgKHRhc2tJbmRleCA+PSAwKSB7XG4gICAgICB0aGlzLnByb3BzLmhvc3QudXBkYXRlKHt0YXNrczogeyRzcGxpY2U6IFtbdGFza0luZGV4LCAxLCB0YXNrXV19fSk7XG4gICAgfVxuICB9XG5cbiAgb25UYXNrQ3VzdG9taXplZCAodGFza0lkOiBzdHJpbmcsIGN1c3RvbWl6YXRpb246IFBhcnRpYWw8VGFzaz4pIHtcbiAgICBjb25zdCBjdXN0b21pemF0aW9ucyA9IHsuLi4odGhpcy5wcm9wcy5tb2R1bGUudGFza0N1c3RvbWl6YXRpb25zIHx8IHt9KX07XG4gICAgY3VzdG9taXphdGlvbnNbdGFza0lkXSA9IGN1c3RvbWl6YXRpb247XG4gICAgdGhpcy51cGRhdGVNb2R1bGUoe3Rhc2tDdXN0b21pemF0aW9uczogeyRzZXQ6IGN1c3RvbWl6YXRpb25zfX0pO1xuICB9XG5cbiAgb25UYXNrRGVsZXRlZCAoaWQ6IHN0cmluZykge1xuICAgIC8vIFJlbW92ZSB0YXNrIElEIGZyb20gbW9kdWxlIHRhc2tJZHMgbGlzdC5cbiAgICAvLyBUaGlzIGRlcGVuZHMgb24gdGhlIGZhY3QgdGhhdCBFZGl0Q291cnNlLl9zZXRTdGF0ZSgpIG1haW50YWluc1xuICAgIC8vIHJlbW92ZWQgVGFzayBsaW5rcyAod2hpY2ggaXQgYWN0dWFsbHkgZG9lcyAob3Igc2hvdWxkIGRvIGF0IGxlYXN0KSkuXG4gICAgdGhpcy51cGRhdGVNb2R1bGUoe1xuICAgICAgdGFza0lkczogeyRzZXQ6IHRoaXMucHJvcHMubW9kdWxlLnRhc2tJZHMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IGlkKX0sXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbnM6IHtcbiAgICAgICAgJGFwcGx5OiBjdXN0b21pemF0aW9ucyA9PiB7XG4gICAgICAgICAgY29uc3QgY29weSA9IHsuLi5jdXN0b21pemF0aW9uc307XG4gICAgICAgICAgZGVsZXRlIGNvcHlbaWRdO1xuICAgICAgICAgIHJldHVybiBjb3B5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBvblRhc2tSZXBsYWNlZCAoaWQ6IHN0cmluZywgdGFzazogVGFzaykge1xuICAgIGNvbnN0IGlkeFRhc2sgPSB0aGlzLnByb3BzLm1vZHVsZS50YXNrSWRzLmluZGV4T2YoaWQpO1xuICAgIGlmIChpZHhUYXNrIDwgMCkge1xuICAgICAgc2hvd0Vycm9yKExgS3VuZGUgaW50ZSBzcGFyYSB1cHBnaWZ0LiBGZWxrb2QgZDcya1FgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbW9kdWxlVXBkYXRlcyA9IHtcbiAgICAgIC8vIFJlcGxhY2Ugb2xkIGlkIHdpdGggbmV3IGlkOlxuICAgICAgdGFza0lkczogeyRzcGxpY2U6IFtbaWR4VGFzaywgMSwgdGFzay5pZF1dfSxcbiAgICAgIHRhc2tDdXN0b21pemF0aW9uczoge1xuICAgICAgICAkYXBwbHk6IGN1c3RvbWl6YXRpb25zID0+IHtcbiAgICAgICAgICBjb25zdCBjb3B5ID0gey4uLmN1c3RvbWl6YXRpb25zfTtcbiAgICAgICAgICBkZWxldGUgY29weVtpZF07XG4gICAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZE1vZHVsZSA9IHVwZGF0ZSh0aGlzLnByb3BzLm1vZHVsZSwgbW9kdWxlVXBkYXRlcyk7XG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XG4gICAgdGhpcy5wcm9wcy5ob3N0LnVwZGF0ZSh7XG4gICAgICAvLyBBcHBseSBtb2R1bGVVcGRhdGVzIGZyb20gYWJvdmU6XG4gICAgICBtb2R1bGVzOiB7ICRzcGxpY2U6IFtbbW9kdWxlSW5kZXgsIDEsIHVwZGF0ZWRNb2R1bGVdXSB9LFxuICAgICAgLy8gQWRkIHRoZSBuZXcgdGFzayB0byBDb3Vyc2UudGFza3MuXG4gICAgICAvLyBEb24ndCByZW1vdmUgdGhlIG9sZCBvbmUhIFdoeT8gQmVjYXVzZSBpdCBtYXkgYmUgcmVmZXJlbmNlZFxuICAgICAgLy8gYnkgYW5vdGhlciBtb2R1bGUgaW4gc2FtZSBjb3Vyc2UhIExldCBFZGl0Q291cnNlLl9zZXRTdGF0ZSgpXG4gICAgICAvLyBkbyB0aGUgXCJnYXJiYWdlIGNvbGxlY3Rpb25cIiBpbnN0ZWFkLlxuICAgICAgdGFza3M6IHsgJHNldDogdGhpcy5wcm9wcy5jb3Vyc2UudGFza3MuY29uY2F0KHRhc2spfVxuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgY291cnNlLCBob3N0LCBtb2R1bGUsIGlkc05vdENvdmVyZWRCeUFueVRhc2sgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgbW9kdWxlSW5kZXggPSB0aGlzLmdldE1vZHVsZUluZGV4KCk7XG4gICAgY29uc3QgbW9kdWxlT3JkZXJlZEluZGV4ID0gdGhpcy5nZXRNb2R1bGVPcmRlckluZGV4KCk7XG4gICAgbGV0IGtub3dsZWRnZU1hdHJpeERpdjtcblxuICAgIGNvbnN0IHVwZGF0ZU1vZHVsZSA9IHRoaXMudXBkYXRlTW9kdWxlLmJpbmQodGhpcyk7XG4gICAgbGV0IHdlZWsgPSAxO1xuICAgIGNvbnN0IHN0YXJ0V2Vla09wdGlvbnMgPSBbXCItLVwiXTtcbiAgICBjb25zdCBlbmRXZWVrT3B0aW9ucyA9IFtcIi0tXCJdO1xuICAgIGZvciAobGV0IGk9MDsgaTw1MTsgKytpKSB7XG4gICAgICBzdGFydFdlZWtPcHRpb25zLnB1c2goJycrIHdlZWspO1xuICAgICAgZW5kV2Vla09wdGlvbnMucHVzaCgnJysgKyt3ZWVrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJjb3Vyc2UtbW9kdWxlIGtlZF9ib3hlZFwiIHN0eWxlPXt7cG9zaXRpb246ICdyZWxhdGl2ZSd9fT5cbiAgICAgIDxoMz48UmVuYW1lYWJsZVRleHQgZWFnZXI9e3RydWV9XG4gICAgICAgIGNsaWNrQWR2ZXJ0aXNlVGV4dD1cIk5hbW5sw7ZzIG1vZHVsXCJcbiAgICAgICAgbWF4Q2hhcnM9ezEwMH1cbiAgICAgICAgdGV4dD17bW9kdWxlLm5hbWV9XG4gICAgICAgIG9uQ2hhbmdlPXtuZXdOYW1lID0+IHVwZGF0ZU1vZHVsZSh7bmFtZTogeyRzZXQ6IG5ld05hbWV9fSl9IC8+XG4gICAgICA8L2gzPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIGNlbnRlclwiPlxuICAgICAgICAgIDxwPlN0YXJ0dmVja2E8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIGNlbnRlclwiPlxuICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e21vZHVsZS5zdGFydFdlZWsgfHwgXCItLVwifVxuICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHVwZGF0ZU1vZHVsZSh7c3RhcnRXZWVrOiB7XG4gICAgICAgICAgICAgICRzZXQ6IGV2LnRhcmdldC52YWx1ZSA9PT0gJy0tJyA/XG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkIDpcbiAgICAgICAgICAgICAgICBwYXJzZUludChldi50YXJnZXQudmFsdWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSl9PlxuICAgICAgICAgICAge3N0YXJ0V2Vla09wdGlvbnMubWFwKG8gPT4gPG9wdGlvbiBrZXk9e299IHZhbHVlPXtvfT57b308L29wdGlvbj4pfVxuICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSBjZW50ZXJcIj5cbiAgICAgICAgICA8cD5TbHV0dmVja2E8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIGNlbnRlclwiPlxuICAgICAgICAgIDxzZWxlY3QgdmFsdWU9e21vZHVsZS5lbmRXZWVrIHx8IFwiLS1cIn1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB1cGRhdGVNb2R1bGUoe2VuZFdlZWs6IHtcbiAgICAgICAgICAgICAgJHNldDogZXYudGFyZ2V0LnZhbHVlID09PSAnLS0nID9cbiAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxuICAgICAgICAgICAgICAgIHBhcnNlSW50KGV2LnRhcmdldC52YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KX0+XG4gICAgICAgICAgICB7ZW5kV2Vla09wdGlvbnMubWFwKG8gPT4gPG9wdGlvbiBrZXk9e299IHZhbHVlPXtvfT57b308L29wdGlvbj4pfVxuICAgICAgICAgIDwvc2VsZWN0PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGg0Pkt1cnNtb2R1bGVucyBpbnRyb2R1a3Rpb248L2g0PlxuICAgICAgPFd5c2l3eWdcbiAgICAgICAgYWN0aW9ucz17W1xuICAgICAgICAgIFwiYm9sZFwiLFxuICAgICAgICAgIFwiaXRhbGljXCIsXG4gICAgICAgICAgXCJ1bmRlcmxpbmVcIixcbiAgICAgICAgICBcInN0cmlrZXRocm91Z2hcIixcbiAgICAgICAgICBcImhlYWRpbmcyXCIsXG4gICAgICAgICAgXCJoZWFkaW5nM1wiLFxuICAgICAgICAgIFwib2xpc3RcIixcbiAgICAgICAgICBcInVsaXN0XCIsXG4gICAgICAgICAgXCJsaW5lXCIsXG4gICAgICAgICAgXCJsaW5rXCIsXG4gICAgICAgICAgXCJpbWFnZVwiXX1cbiAgICAgICAgZGVmYXVsdEFjdGlvbnM9e2FjdGlvbnNfc3dlZGlzaH1cbiAgICAgICAgaHRtbD17bW9kdWxlLm1hbmRhdG9yeUNvbnRlbnR9XG4gICAgICAgIG9uQ2hhbmdlPXtodG1sID0+IHtcbiAgICAgICAgICB1cGRhdGVNb2R1bGUoe21hbmRhdG9yeUNvbnRlbnQ6IHskc2V0OiBodG1sfX0pXG4gICAgICAgIH19IC8+XG5cbiAgICAgIDxoND5VcHBnaWZ0ZXI8L2g0PlxuICAgICAgPEVkaXRhYmxlVGFza0xpc3RcbiAgICAgICAgdGFza0lkcz17bW9kdWxlLnRhc2tJZHN9XG4gICAgICAgIHRhc2tDdXN0b21pemF0aW9ucz17bW9kdWxlLnRhc2tDdXN0b21pemF0aW9uc31cbiAgICAgICAgY291cnNlPXtjb3Vyc2V9XG4gICAgICAgIG1vZHVsZT17bW9kdWxlfVxuICAgICAgICBob3N0PXtob3N0fVxuICAgICAgICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrPXtpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfVxuICAgICAgICBvblRhc2tBZGRlZD17KHRhc2s6IFRhc2ssIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+KSA9PiB0aGlzLm9uVGFza0FkZGVkKHRhc2ssIHRhc2tDdXN0b21pemF0aW9uKX1cbiAgICAgICAgb25UYXNrVXBkYXRlZD17KHRhc2s6IFRhc2spID0+IHRoaXMub25UYXNrVXBkYXRlZCh0YXNrKX1cbiAgICAgICAgb25UYXNrQ3VzdG9taXphdGlvblVwZGF0ZWQ9eyh0YXNrSWQ6IHN0cmluZywgY3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPikgPT5cbiAgICAgICAgICB0aGlzLm9uVGFza0N1c3RvbWl6ZWQodGFza0lkLCBjdXN0b21pemF0aW9uKX1cbiAgICAgICAgb25UYXNrRGVsZXRlZD17KGlkOiBzdHJpbmcpID0+IHRoaXMub25UYXNrRGVsZXRlZChpZCl9XG4gICAgICAgIG9uVGFza1JlcGxhY2VkPXsoaWQ6IHN0cmluZywgdGFzazogVGFzaykgPT4gdGhpcy5vblRhc2tSZXBsYWNlZChpZCwgdGFzayl9IC8+XG5cbiAgICAgIDxoND5Nb2R1bHJlc3Vyc2VyPC9oND5cbiAgICAgIDxwIGNsYXNzTmFtZT1cInN1YkhlYWRlclwiPihFdmVudHVlbGxhIHJlc3VzZXIgZsO2ciByZWRvdmlzbmluZyBhdiBtb2R1bGVuIHNhbXQgZsO2ciBtb2R1bGVuIHNvbSBoZWxoZXQpPC9wPlxuICAgICAgPEVkaXRhYmxlUmVzb3VyY2VMaXN0XG4gICAgICAgIHJlc291cmNlcz17bW9kdWxlLnJlc291cmNlc31cbiAgICAgICAgb25VcGRhdGU9e3Jlc291cmNlc1VwZGF0ZXMgPT4gdXBkYXRlTW9kdWxlKHsgcmVzb3VyY2VzOiByZXNvdXJjZXNVcGRhdGVzIH0pfVxuICAgICAgICBob3N0PXtob3N0fSAvPlxuICAgICAgPGRpdiBzdHlsZT17e3Bvc2l0aW9uOiAnYWJzb2x1dGUnLCB0b3A6IDAsIHJpZ2h0OiAwfX0+XG4gICAgICAgIHttb2R1bGVPcmRlcmVkSW5kZXggPiAwICYmIDxzcGFuPlxuICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWFycm93LWNpcmNsZS11cCBzZWxlY3RhYmxlXCJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5wcm9wcy5vblJlb3JkZXIoLTEpfSAvPiA8L3NwYW4+fVxuICAgICAgICB7bW9kdWxlT3JkZXJlZEluZGV4IDwgY291cnNlLm1vZHVsZXMubGVuZ3RoIC0gMSAmJiA8c3Bhbj5cbiAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hcnJvdy1jaXJjbGUtZG93biBzZWxlY3RhYmxlXCJcbiAgICAgICAgICAgIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5wcm9wcy5vblJlb3JkZXIoMSl9IC8+IDwvc3Bhbj59XG4gICAgICAgIDxSZW1vdmVJdGVtXG4gICAgICAgICAgdGl0bGU9XCJUYSBib3J0IG1vZHVsZW5cIlxuICAgICAgICAgIHN0eWxlPXt7ZGlzcGxheTogJ2lubGluZS1ibG9jayd9fVxuICAgICAgICAgIG9uQ2xpY2s9eygpPT5jb25maXJtKExgVGEgYm9ydCBtb2R1bCAke21vZHVsZS5uYW1lfT9gKSAmJiBob3N0LnVwZGF0ZSh7bW9kdWxlczogeyRzcGxpY2U6IFtbbW9kdWxlSW5kZXgsIDFdXX19KX0gLz5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuL2NvdXJzZS1iYW5uZXJcIjtcbmltcG9ydCB7IEwsIHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AsIHNob3dJbmZvLCBtYXhMZW5ndGgsIGNhcGl0YWxpemVGaXJzdCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgQ291cnNlLCBTdWJqZWN0IH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcbmltcG9ydCB7IFNjaG9vbENvdXJzZXMgfSBmcm9tIFwiLi4vc3ViLWNvbXBvbmVudHMvc2Nob29sLWNvdXJzZXNcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgY291cnNlT3B0aW9uczogQ291cnNlT3B0aW9uW107XG4gIHNlbGVjdGVkVGVtcGxhdGVJZDogc3RyaW5nO1xuICBjb3Vyc2VzOiBDb3Vyc2VPcHRpb25bXSB8IG51bGw7XG4gIHNlbGVjdGVkQ291cnNlSWQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIENvdXJzZU9wdGlvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIENyZWF0ZU5ld0NvdXJzZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNvdXJzZU9wdGlvbnM6IG51bGwsXG4gICAgICBzZWxlY3RlZFRlbXBsYXRlSWQ6IFwiLS1cIixcbiAgICAgIGNvdXJzZXM6IG51bGwsXG4gICAgICBzZWxlY3RlZENvdXJzZUlkOiBcIlwiXG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCkuY2F0Y2goc2hvd0Vycm9yKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgc2hvd0luZm8oXCJMYWRkYXIga3Vyc2VyXCIpO1xuICAgIGNvbnN0IHN1YmplY3RzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTdWJqZWN0PihcInN1YmplY3RzXCIsIHtcbiAgICAgIHRhZ3M6IFtcInNjaG9vbFR5cGU6Z3ltbmFzaXVtXCJdLFxuICAgICAgaW5jbHVkZTogXCJjb3Vyc2VUZW1wbGF0ZXNcIlxuICAgIH0pO1xuICAgIGNvbnN0IGNvdXJzZXMgPSBmbGF0dGVuKHN1YmplY3RzLm1hcChzID0+IHMuY291cnNlVGVtcGxhdGVzKSkuc29ydChjb21wYXJlUHJvcChcIm5hbWVcIikpO1xuICAgIGNvbnN0IGNvdXJzZU9wdGlvbnM6IENvdXJzZU9wdGlvbltdID1cbiAgICAgIFt7IGlkOiBcIi0tXCIsIG5hbWU6IFwiLS1cIiB9XS5jb25jYXQoY291cnNlcyk7XG4gICAgc2hvd0luZm8oXCJcIik7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IGNvdXJzZU9wdGlvbnMgfSk7XG4gIH1cblxuICBhc3luYyBvblNlbGVjdENvdXJzZShpZDogc3RyaW5nKSB7XG4gICAgY29uc3QgZGVyaXZlZENvdXJzZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PENvdXJzZT4oXCJjb3Vyc2VzXCIsIHsgaGFzRWRnZXNUbzogW2lkXSB9KTtcbiAgICBjb25zdCBjb3Vyc2VPcHRpb25zID0gZGVyaXZlZENvdXJzZXNcbiAgICAgIC5maWx0ZXIoY291cnNlID0+IGNvdXJzZS5hY3RpdmUpXG4gICAgICAubWFwKCh7IGlkLCBzY2hvb2wsIGRlc2NyaXB0aW9uLCBjcmVhdGVkQnksIG1vZGlmaWVkQnkgfSkgPT4ge1xuICAgICAgICBpZiAoZGVzY3JpcHRpb24pIGRlc2NyaXB0aW9uID0gbWF4TGVuZ3RoKGRlc2NyaXB0aW9uLCA4MCk7XG4gICAgICAgIGxldCBkZXNjcmlwdGlvbk9yQXV0aG9yID0gZGVzY3JpcHRpb24gfHxcbiAgICAgICAgICAoY3JlYXRlZEJ5ID8gYCR7Y3JlYXRlZEJ5Lm5hbWV9cyB2ZXJzaW9uYCA6XG4gICAgICAgICAgbW9kaWZpZWRCeSAmJiBgJHttb2RpZmllZEJ5Lm5hbWV9cyB2ZXJzaW9uYCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgbmFtZTogc2Nob29sID09PSAnc3RhbmRhcmQnID9cbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID8gYFN0YW5kYXJkIC0gJHtkZXNjcmlwdGlvbn1gIDogXCJTdGFuZGFyZFwiIDpcbiAgICAgICAgICAgIGAke3NjaG9vbH0gLSAke21heExlbmd0aChkZXNjcmlwdGlvbk9yQXV0aG9yLCA5MCl9YCxcbiAgICAgICAgICBzY2hvb2xcbiAgICAgICAgfTtcbiAgICAgIH0pLnNvcnQoY29tcGFyZVByb3AoXCJuYW1lXCIpKTtcbiAgICBjb25zdCBrZWRTdGFuZGFyZE9wdGlvbnMgPSBjb3Vyc2VPcHRpb25zLmZpbHRlcihvcHRpb24gPT4gb3B0aW9uLnNjaG9vbCA9PT0gXCJzdGFuZGFyZFwiKTtcbiAgICBjb25zdCB0ZWFjaGVyTWFkZSA9IGNvdXJzZU9wdGlvbnMuZmlsdGVyKG9wdGlvbiA9PiBvcHRpb24uc2Nob29sICE9PSBcInN0YW5kYXJkXCIpO1xuICAgIGNvbnN0IGNvdXJzZXMgPSBbXG4gICAgICAuLi5rZWRTdGFuZGFyZE9wdGlvbnMsXG4gICAgICB7IGlkLCBuYW1lOiBcIlRvbVwiIH0sXG4gICAgICAuLi50ZWFjaGVyTWFkZV07XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBjb3Vyc2VzLFxuICAgICAgc2VsZWN0ZWRUZW1wbGF0ZUlkOiBpZCxcbiAgICAgIHNlbGVjdGVkQ291cnNlSWQ6IGNvdXJzZXNbMF0uaWRcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNvdXJzZU9wdGlvbnMsIHNlbGVjdGVkVGVtcGxhdGVJZCwgY291cnNlcywgc2VsZWN0ZWRDb3Vyc2VJZCB9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gPGRpdiBzdHlsZT17eyBvdXRsaW5lOiAwIH19PlxuICAgICAgPENvdXJzZUJhbm5lclxuICAgICAgICB0aXRsZT17TGBLdXJzYnlnZ2FyZW5gfVxuICAgICAgICBhY3RpdmVQYWdlPVwiY291cnNlQnVpbGRlclwiXG4gICAgICAgIHJvdXRlcz17e2ZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsfX1cbiAgICAgIC8+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zcGFjZXItMjBweHZ0IHN2LXZlcnRpY2FsIHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxuXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tN1wifT5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgPGgyPlNrYXBhIG55IGt1cnM8L2gyPlxuICAgICAgICAgICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5Ww6RsaiBneW1uYXNpZWt1cnMgOjwvcD5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbCBzcGFjZWRcIj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgeyFjb3Vyc2VPcHRpb25zID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj48U3Bpbm5lciAvPjxzZWxlY3QgZGlzYWJsZWQgdmFsdWU9XCJcIj48b3B0aW9uPi0tPC9vcHRpb24+PC9zZWxlY3Q+PC9kaXY+IDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPHNlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnNlbGVjdGVkVGVtcGxhdGVJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5vblNlbGVjdENvdXJzZShldi50YXJnZXQudmFsdWUpLmNhdGNoKHNob3dFcnJvcil9XG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291cnNlT3B0aW9ucy5tYXAoY291cnNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIGtleT17Y291cnNlLmlkfSB2YWx1ZT17Y291cnNlLmlkfT57Y291cnNlLm5hbWV9PC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+fVxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge2NvdXJzZXMgJiYgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5VdGfDpSBmcsOlbiB2ZXJzaW9uOiA8L3A+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICAgICAgICAgICAge2NvdXJzZXMgJiYgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IHZhbHVlPXtzZWxlY3RlZENvdXJzZUlkfSBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291cnNlSWQ6IGV2LnRhcmdldC52YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSl9PlxuICAgICAgICAgICAgICAgICAgICAgICAgICB7Y291cnNlcy5tYXAoY291cnNlID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiBrZXk9e2NvdXJzZS5pZH0gdmFsdWU9e2NvdXJzZS5pZH0+e2NvdXJzZS5uYW1lfTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICAgICAgICAgICAgPGJyIC8+PGJyIC8+XG4gICAgICAgICAgICAgICAgICAgIHtjb3Vyc2VzICYmIHNlbGVjdGVkQ291cnNlSWQgJiYgPExpbmtcbiAgICAgICAgICAgICAgICAgICAgICB0bz17YC9jb3Vyc2VzL2NyZWF0ZS1mcm9tLXRlbXBsYXRlLyR7dGhpcy5zdGF0ZS5zZWxlY3RlZENvdXJzZUlkfWB9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1sYXJnZVwiXG4gICAgICAgICAgICAgICAgICAgID5Ta2FwYTwvTGluaz59XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1jb2x1bW4tNVwiPlxuICAgICAgICAgICAgICAgICAgPFNjaG9vbENvdXJzZXMgLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgTCwgc2hvd0luZm8sIHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2UsIFJlc291cmNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgU3ViamVjdCwgQWJpbGl0eSwgVGFzaywgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgQmF0Y2hSdW5uZXIsIEh0dHBFcnJvciwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gJy4vY291cnNlLWJhbm5lcic7XG5pbXBvcnQgeyBJbm5lckVkaXRDb3Vyc2UgfSBmcm9tICcuL2lubmVyLWVkaXQtY291cnNlJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XG5pbXBvcnQgeyB1cGRhdGVEb2N1bWVudEdyYXBocywgYXBwbHlFdGFncywgdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cywgbG9hZENvdXJzZSwgdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMsIHVwZGF0ZUNyZWF0aW9uU3RhbXAsIHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wIH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QsIERpYWxvZywgRGlhbG9nQ29udGFpbmVyIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3QnO1xuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5pbXBvcnQgeyBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMsIGdldElkc05vdENvdmVyZWRCeVRhc2tzIH0gZnJvbSAnLi9idXNpbmVzcy1sb2dpYyc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcbmltcG9ydCB7IG15U2Nob29sQ291cnNlc1JlcG8gfSBmcm9tICcuLi8uLi8uLi9yZXBvcy9zY2hvb2wtY291cnNlcyc7XG5pbXBvcnQgeyBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gXCIuLi8uLi8uLi9hY2Nlc3MtY29udHJvbFwiO1xuXG5jb25zdCBjYXRjaGVyID0gY2ZnLkVOVklST05NRU5UID09PSAncHJvZHVjdGlvbicgP1xuICBzaG93RXJyb3IgOiBudWxsO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpZD86IHN0cmluZztcbiAgc3ViamVjdElkPzogc3RyaW5nO1xuICBpc1RlbXBsYXRlPzogYm9vbGVhbjtcbiAgdGVtcGxhdGVJZD86IHN0cmluZztcbiAgdmlldz86ICdzdHVkZW50UGFnZScgfCAnY291cnNlQnVpbGRlcicgfCAndGVtcGxhdGVCdWlsZGVyJztcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nO1xuICBmZWVkYmFja1VybDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBvcmlnQ291cnNlOiBDb3Vyc2UgfCBudWxsO1xuICBvcmlnVGVtcGxhdGU6IENvdXJzZSB8IG51bGw7XG4gIGNvdXJzZTogQ291cnNlO1xuICBhbGxDb3Vyc2VzPzogQ291cnNlW107XG4gIGRpYWxvZ0NvbnRhaW5lcnM6IERpYWxvZ0NvbnRhaW5lcltdOyAvLyBXaGVuIGVkaXRpbmcgaXRlbXMsIGl0IG1heSBzaG93IGFzIGEgZGlhbG9nXG4gIGhhc1Vuc2F2ZWREYXRhOiBib29sZWFuO1xuICB2aWV3OiAnc3R1ZGVudFBhZ2UnIHwgJ2NvdXJzZUJ1aWxkZXInIHwgJ3RlbXBsYXRlQnVpbGRlcic7XG59XG5cbmNvbnN0IENPTkZJUk1fTkFWSUdBVEVfTUVTU0FHRSA9XG4gIExgRHUgaGFyIG9zcGFyYXQgZGF0YS4gVsOkbGogYXZicnl0IG9jaCB0cnljayBDVFJMK1Mgb20gZHUgdmlsbCBzcGFyYSBmw7Zyc3QuYDtcbiAgXG5jb25zdCBERUZBVUxUX1NUQVRFOiBTdGF0ZSA9IHtcbiAgb3JpZ0NvdXJzZTogbnVsbCxcbiAgb3JpZ1RlbXBsYXRlOiBudWxsLFxuICBjb3Vyc2U6IG51bGwsXG4gIGRpYWxvZ0NvbnRhaW5lcnM6IFtdLFxuICBoYXNVbnNhdmVkRGF0YTogZmFsc2UsXG4gIHZpZXc6ICdjb3Vyc2VCdWlsZGVyJ1xufTtcblxuZXhwb3J0IGNsYXNzIEVkaXRDb3Vyc2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IGltcGxlbWVudHMgSUNvdXJzZUVkaXRvckhvc3Qge1xuICBwYWdlWU9mZnNldDogbnVtYmVyO1xuICBjb250ZW50RGl2OiBIVE1MRGl2RWxlbWVudDtcbiAgY29udGVudFlQb3M6IG51bWJlcjtcbiAgaXNTYXZpbmc6IGJvb2xlYW47XG4gIGRpYWxvZ3M6IERpYWxvZ1tdO1xuXG4gIHNldFN0YXRlUHJvbWlzZWQgKHN0YXRlOiBQYXJ0aWFsPFN0YXRlPikgOiBQcm9taXNlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLl9zZXRTdGF0ZSh7aGFzVW5zYXZlZERhdGE6IHRydWUsIC4uLnN0YXRlfSk7XG4gIH1cblxuICBzZXROb25TYXZlYWJsZURhdGFTdGF0ZSAoc3RhdGU6IFBhcnRpYWw8U3RhdGU+KSA6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuX3NldFN0YXRlKHN0YXRlKTtcbiAgfVxuXG4gIF9zZXRTdGF0ZSAoc3RhdGU6IFBhcnRpYWw8U3RhdGU+KSA6IFByb21pc2U8YW55PiB7XG4gICAgaWYgKHN0YXRlLmNvdXJzZSkge1xuICAgICAge1xuICAgICAgICAvL1xuICAgICAgICAvLyBNYWludGFpbiBjb3Vyc2UgdGFzayBsaW5rcyAocmVtb3ZlIGxpbmtzIHRvIHRhc2tzIHRoYXQgYXJlIG5vdCB1c2VkXG4gICAgICAgIC8vIGJ5IGFueSBtb2R1bGUpXG4gICAgICAgIC8vXG4gICAgICAgIGNvbnN0IHt0YXNrcywgbW9kdWxlc30gPSBzdGF0ZS5jb3Vyc2U7XG4gICAgICAgIGNvbnN0IHVzZWRUYXNrSWRzID0ge307XG4gICAgICAgIG1vZHVsZXMuZm9yRWFjaChtb2R1bGUgPT4gbW9kdWxlLnRhc2tJZHMuZm9yRWFjaChpZCA9PiB1c2VkVGFza0lkc1tpZF0gPSB0cnVlKSk7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQ291cnNlVGFza3MgPSB0YXNrcy5maWx0ZXIodCA9PiB1c2VkVGFza0lkc1t0LmlkXSk7XG4gICAgICAgIGNvbnN0IG1vZGlmaWVkQ291cnNlID0gey4uLnN0YXRlLmNvdXJzZX07XG4gICAgICAgIG1vZGlmaWVkQ291cnNlLnRhc2tzID0gZmlsdGVyZWRDb3Vyc2VUYXNrcztcbiAgICAgICAgc3RhdGUgPSB7Li4uc3RhdGUsIGNvdXJzZTogbW9kaWZpZWRDb3Vyc2V9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEludm9rZSBvdXIgY291cnNlIGludG8gc3RhdGUgcHJvcGVydHkgYWxsQ291cnNlcyBzbyB0aGF0IHRoZVxuICAgIC8vIHJpZ2h0LWhhbmQgc2lkZSBsaXN0IG9mIGNvdXJzZXMgZ2V0cyB1cGRhdGUgaW1tZWRpYXRlbHkgd2l0aFxuICAgIC8vIHRoZSBwdWJsaXNoYWJsZSBzdGF0ZSBvZiB0aGlzIGNvdXJzZS5cbiAgICBsZXQgYWxsQ291cnNlcyA9IHN0YXRlLmFsbENvdXJzZXMgfHwgdGhpcy5zdGF0ZS5hbGxDb3Vyc2VzO1xuICAgIGNvbnN0IGNvdXJzZSA9IHN0YXRlLmNvdXJzZSB8fCB0aGlzLnN0YXRlLmNvdXJzZTtcbiAgICBpZiAoYWxsQ291cnNlcykge1xuICAgICAgY29uc3QgaWR4T3VyQ291cnNlID0gYWxsQ291cnNlcy5maW5kSW5kZXgoYyA9PiBjLmlkID09PSB0aGlzLnByb3BzLmlkKTtcbiAgICAgIGFsbENvdXJzZXMgPSB1cGRhdGUoYWxsQ291cnNlcywgeyRzcGxpY2U6IFtbaWR4T3VyQ291cnNlLCAxLCBjb3Vyc2VdXX0pO1xuICAgICAgc3RhdGUgPSB7Li4uc3RhdGV9O1xuICAgICAgc3RhdGUuYWxsQ291cnNlcyA9IGFsbENvdXJzZXM7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3VwZXIuc2V0U3RhdGUoKCk9PnN0YXRlIGFzIFN0YXRlLCByZXNvbHZlKSk7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHsuLi5ERUZBVUxUX1NUQVRFfTtcbiAgICB0aGlzLnVwZGF0ZSA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5yZWZEaWFsb2cgPSB0aGlzLnJlZkRpYWxvZy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuY29udGVudFlQb3MgPSAwO1xuICAgIHRoaXMub25LZXlEb3duID0gdGhpcy5vbktleURvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLmJlZm9yZVVubG9hZCA9IHRoaXMuYmVmb3JlVW5sb2FkLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkNsaWNrUHJldmVudFVubG9hZCA9IHRoaXMub25DbGlja1ByZXZlbnRVbmxvYWQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgdGhpcy5kaWFsb2dzID0gW107XG4gICAgaWYgKHByb3BzLnZpZXcpIHRoaXMuc3RhdGUgPSB7XG4gICAgICAuLi50aGlzLnN0YXRlLFxuICAgICAgdmlldzogcHJvcHMudmlld1xuICAgIH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCkuY2F0Y2goY2F0Y2hlcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMuYmVmb3JlVW5sb2FkKTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkNsaWNrUHJldmVudFVubG9hZCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMub25LZXlEb3duKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5iZWZvcmVVbmxvYWQpO1xuICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uQ2xpY2tQcmV2ZW50VW5sb2FkKTtcbiAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCcnKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBQcm9wcykge1xuICAgIGlmICh0aGlzLnN0YXRlICYmIHRoaXMuc3RhdGUuY291cnNlKSB7XG4gICAgICBpZiAobmV4dFByb3BzLmlkICE9PSB0aGlzLnByb3BzLmlkIHx8IG5leHRQcm9wcy50ZW1wbGF0ZUlkICE9PSB0aGlzLnByb3BzLnRlbXBsYXRlSWQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZVByb21pc2VkKERFRkFVTFRfU1RBVEUpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAobmV4dFByb3BzLnZpZXcgIT09IHRoaXMucHJvcHMudmlldykge1xuICAgICAgdGhpcy5zZXROb25TYXZlYWJsZURhdGFTdGF0ZSh7dmlldzogbmV4dFByb3BzLnZpZXd9KTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzOiBQcm9wcywgcHJldlN0YXRlOiBTdGF0ZSkge1xuICAgIGlmICh0aGlzLmNvbnRlbnREaXYpIHtcbiAgICAgIGNvbnN0IGNvbnRlbnREaXY6IEhUTUxEaXZFbGVtZW50ID0gZmluZERPTU5vZGUodGhpcy5jb250ZW50RGl2KTtcbiAgICAgIGlmIChjb250ZW50RGl2KSB7XG4gICAgICAgIHRoaXMuY29udGVudFlQb3MgPSBjb250ZW50RGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocHJldlN0YXRlICYmIHByZXZTdGF0ZS5jb3Vyc2UpIHtcbiAgICAgIC8vIFRoaXMgd2FzIG5vdCB0aGUgaW5pdGlhbCB1cGRhdGUuXG4gICAgICAvLyBJZiBwcm9wcyBoYXZlIGJlZW4gdXBkYXRlZCB0byBwb2ludCBvdXQgYW5vdGhlciBjb3Vyc2Ugb3IgdGVtcGxhdGUsIHJlc2V0IGNvbXBvbmVudDpcbiAgICAgIGlmICh0aGlzLnByb3BzLmlkICE9PSBwcmV2UHJvcHMuaWQgfHwgdGhpcy5wcm9wcy50ZW1wbGF0ZUlkICE9PSBwcmV2UHJvcHMudGVtcGxhdGVJZCkge1xuICAgICAgICB0aGlzLmxvYWQoKS5jYXRjaChjYXRjaGVyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXByZXZTdGF0ZS5oYXNVbnNhdmVkRGF0YSAmJiB0aGlzLnN0YXRlLmhhc1Vuc2F2ZWREYXRhKSB7XG4gICAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCd1bnNhdmVkJyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9hZEZyb21UZW1wbGF0ZSh0ZW1wbGF0ZUlkOiBzdHJpbmcpIHtcbiAgICBzaG93SW5mbyhcIkxhZGRhciBkYXRhIGZyw6VuIG1hbGwuLi5cIik7XG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBsb2FkQ291cnNlKHRlbXBsYXRlSWQsIHtpbmNsdWRlVGVtcGxhdGVDaGFpbjogdHJ1ZX0pO1xuICAgIGNvbnN0IGNvdXJzZSA9IHVwZGF0ZUNyZWF0aW9uU3RhbXAoRGF0ZS5ub3coKSwgdGVtcGxhdGUsIGVudi5jdXJyZW50VXNlcik7XG4gICAgY291cnNlLmlkID0gY3JlYXRlVVVJRCgpO1xuICAgIGNvdXJzZS5wYXJlbnRJZCA9IHRlbXBsYXRlSWQ7XG4gICAgY291cnNlLmFjdGl2ZSA9IGZhbHNlO1xuICAgIGNvdXJzZS5pc1RlbXBsYXRlID0gZmFsc2U7XG4gICAgY291cnNlLnRlbXBsYXRlQ2hhaW4gPSBbLi4uY291cnNlLnRlbXBsYXRlQ2hhaW5dO1xuICAgIGNvdXJzZS50ZW1wbGF0ZUNoYWluLnB1c2goe2lkOiB0ZW1wbGF0ZUlkLCAkbWV0YTogJ3JlZid9IGFzIENvdXJzZSk7XG4gICAgY29uc3QgbXlTY2hvb2wgPSBlbnYuY3VycmVudFVzZXIuc2Nob29sO1xuICAgIGNvdXJzZS5zY2hvb2wgPSBteVNjaG9vbDtcbiAgICBjb3Vyc2UuZGVzY3JpcHRpb24gPSBcIlwiO1xuICAgIGNvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzID0gW107XG4gICAgY291cnNlLmFjbCA9IFtcbiAgICAgIFwicm9sZTpVU0VSOlJcIiwgLy8gQWxsIHVzZXJzIG1heSB2aWV3IGl0LiAoQ291bGQgaGF2ZSByZXN0cmljdGVkIGl0IHRvIHNjaG9vbCwgYnV0IG5vdCBuZXNjZXNzYXJ5ISlcbiAgICAgIGBzY2hvb2xSb2xlOiR7bXlTY2hvb2x9L0VNUExPWUVFOlNgIC8vIE90aGVyIHRlYWNoZXJzIGF0IHNhbWUgc2Nob29sIHNob3VsZCBiZSBhYmxlIHRvIG1vZGlmeSB0aGUgY291cnNlLlxuICAgIF07XG4gICAgZGVsZXRlIGNvdXJzZS4kZXRhZztcbiAgICBkZWxldGUgY291cnNlLmNyZWF0ZWRCeTtcbiAgICBkZWxldGUgY291cnNlLmNyZWF0ZWREYXRlO1xuICAgIGRlbGV0ZSBjb3Vyc2UubW9kaWZpZWRCeTtcbiAgICBkZWxldGUgY291cnNlLm1vZGlmaWVkRGF0ZTtcbiAgICBkZWxldGUgY291cnNlLmFjdGl2YXRlZEJ5O1xuICAgIGRlbGV0ZSBjb3Vyc2UuYWN0aXZhdGVkRGF0ZTtcbiAgICBkZWxldGUgY291cnNlLmdvb2dsZUNsYXNzUm9vbUNvZGU7XG4gICAgZGVsZXRlIGNvdXJzZS5nb29nbGVDbGFzc1Jvb21VUkw7XG4gICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKHsgY291cnNlLCBvcmlnQ291cnNlOiBudWxsLCBvcmlnVGVtcGxhdGU6IHRlbXBsYXRlIH0pO1xuICAgIHNob3dJbmZvKFwiXCIpO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCcnKTtcbiAgICBpZiAodGhpcy5wcm9wcy5pZCkge1xuICAgICAgYXdhaXQgdGhpcy5sb2FkRXhpc3RpbmdDb3Vyc2UodGhpcy5wcm9wcy5pZCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLnRlbXBsYXRlSWQpIHtcbiAgICAgIGF3YWl0IHRoaXMubG9hZEZyb21UZW1wbGF0ZSh0aGlzLnByb3BzLnRlbXBsYXRlSWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoTGBPZ2lsdGlnIHBhcmFtZXRlci4gaWQgZWxsZXIgdGVtcGxhdGVJZCBtw6VzdGUgYW5nZXNgKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBsb2FkRXhpc3RpbmdDb3Vyc2UoY291cnNlSWQ6IHN0cmluZykge1xuICAgIHNob3dJbmZvKFwiTGFkZGFyIGt1cnNcIik7XG4gICAgY29uc3QgY291cnNlID0gYXdhaXQgbG9hZENvdXJzZShjb3Vyc2VJZCk7XG4gICAgaWYgKCFjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVycykgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMgPSBbXTtcbiAgICBhd2FpdCB0aGlzLnNldE5vblNhdmVhYmxlRGF0YVN0YXRlKHsgY291cnNlLCBvcmlnQ291cnNlOiBjb3Vyc2UgfSk7XG4gICAgc2hvd0luZm8oXCJcIik7XG4gIH1cblxuICBhc3luYyB1cGRhdGUoY291cnNlVXBkYXRlcykge1xuICAgIGF3YWl0IHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7IGNvdXJzZTogdXBkYXRlKHRoaXMuc3RhdGUuY291cnNlLCBjb3Vyc2VVcGRhdGVzKSB9KTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUNvdXJzZSgpIHtcbiAgICBzaG93SW5mbyhcIlJhZGVyYXIga3Vyc2VuLi4uXCIpO1xuICAgIGNvbnN0IGNvdXJzZVNjaG9vbCA9IHRoaXMuc3RhdGUuY291cnNlLnNjaG9vbDtcbiAgICBjb25zdCBwYXJlbnRJZCA9IHRoaXMuc3RhdGUuY291cnNlLnBhcmVudElkO1xuICAgIGNvbnN0IGNvdXJzZUlkID0gdGhpcy5wcm9wcy5pZDtcblxuICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxDb3Vyc2U+KFwiY291cnNlc1wiLCB7XG4gICAgICBoYXNFZGdlc1RvOiBbdGhpcy5wcm9wcy5pZF1cbiAgICB9KTtcbiAgICBjb25zdCBiciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xuICAgIGZvciAoY29uc3QgY2hpbGRDb3Vyc2Ugb2YgY2hpbGRyZW4pIHtcbiAgICAgIC8qIENBTk5PVCBETyBUSElTLiBNQVkgTk9UIEhBVkUgQUNDRVNTISBpZiAoY2hpbGRDb3Vyc2UucGFyZW50SWQgPT09IGNvdXJzZUlkKSB7XG4gICAgICAgIC8vIFJlY29ubmVjdCBjaGlsZCB3aXRoIG15IHBhcmVudCBpbnN0ZWFkLCBhcyBJIHdpbGwgYmUgZGlzYXBwZWFyaW5nLi4uXG4gICAgICAgIGNoaWxkQ291cnNlLnBhcmVudElkID0gcGFyZW50SWQ7XG4gICAgICAgIGJyLnB1dChcImNvdXJzZXNcIiwgY2hpbGRDb3Vyc2UpO1xuICAgICAgfSovXG4gICAgfVxuXG4gICAgYnIuZGVsZXRlKFwiY291cnNlc1wiLCBjb3Vyc2VJZCk7XG4gICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuYmF0Y2goYnIubXV0YXRpb25SZXF1ZXN0cyk7XG4gICAgaWYgKGNvdXJzZVNjaG9vbCA9PT0gZW52LmN1cnJlbnRVc2VyLnNjaG9vbCkge1xuICAgICAgbXlTY2hvb2xDb3Vyc2VzUmVwby5kZWxldGUoY291cnNlSWQpO1xuICAgIH1cbiAgICBzaG93SW5mbyhcIlwiKTtcbiAgICBsb2NhdGlvbi5oYXNoID0gXCIjL2NvdXJzZXMvbmV3XCI7XG4gIH1cblxuICBhc3luYyBzYXZlICgpIHtcbiAgICBpZiAodGhpcy5pc1NhdmluZykgcmV0dXJuO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmlzU2F2aW5nID0gdHJ1ZTtcbiAgICAgIGF3YWl0IHRoaXMuX3NhdmUoKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBlcnIgJiYgZXJyLm1lc3NhZ2UgPyBlcnIubWVzc2FnZSA6IExgRXR0IG9rw6RudCBmZWwgaGFyIGludHLDpGZmYXQuLi5gO1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBpZiAoZXJyLm5hbWUgPT09ICdodHRwNDA5JyB8fCBlcnIubmFtZSA9PT0gJ2h0dHA0MTInIHx8IGVyci5uYW1lID09PSAnaHR0cDQwNCcpIHtcbiAgICAgICAgICAvLyBDb25mbGljdC4gU2hvdyBhIG5pY2VyIGVycm9yIG1lc3NhZ2U6XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gTGBLdXJzZW4gaGFyIHJlZGlnZXJhZCBhdiBhbm5hbiBhbnbDpG5kYXJlLiBMYWRkYSBvbSBzaWRhbiBvY2ggZ8O2ciBvbSDDpG5kcmluYXJuYS5gO1xuICAgICAgICB9IGVsc2UgaWYgKGVyci5uYW1lID09PSAnaHR0cDQwMycpIHtcbiAgICAgICAgICBpZiAodGhpcy5zdGF0ZS5jb3Vyc2UuaXNUZW1wbGF0ZSlcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSA9IExgSW5nZW4gYmVow7ZyaWdoZXQgYXR0IHNwYXJhIGt1cnNtYWxsZW4uIEVuZGFzdCBhZG1pbmlzdHJhdMO2cmVyIGthbiByZWRpZ2VyYSBrdXJzbWFsbGFyLmA7XG4gICAgICAgICAgZWxzZSBpZiAodGhpcy5zdGF0ZS5jb3Vyc2Uuc2Nob29sKVxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gTGBJbmdlbiBiZWjDtnJpZ2hldCBhdHQgc3BhcmEga3Vyc2VuICR7dGhpcy5zdGF0ZS5jb3Vyc2UubmFtZX0uIEt1cnNlbiBrYW4gYmFyYSByZWRpZ2VyYXMgYXYgYW5zdMOkbGxkYSBww6UgJHt0aGlzLnN0YXRlLmNvdXJzZS5zY2hvb2x9YDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgc2hvd0Vycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCdlcnJvcicpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBfc2F2ZSgpIHtcbiAgICBjb25zdCB7IGNvdXJzZSwgb3JpZ0NvdXJzZSwgb3JpZ1RlbXBsYXRlIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IGRvZXNBbGxUYXNrc0NvdmVyQWxsUmVxdWlyZW1lbnRzID0gZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzKGNvdXJzZSkubGVuZ3RoID09PSAwO1xuXG4gICAgc2hvd0luZm8oTGBTcGFyYXIuLi5gKTtcbiAgICBsZXQgbW9kaWZpZWRDb3Vyc2U6IENvdXJzZSA9IHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wKERhdGUubm93KCksIGNvdXJzZSwgZW52LmN1cnJlbnRVc2VyKTtcblxuICAgIGNvbnN0IGJhdGNoID0gbmV3IEJhdGNoUnVubmVyKCk7XG5cbiAgICAvLyBSZXNvbHZlIG1hbmlwdWxhdGVkIGdyYXBocyBvZiBlYWNoIHRhc2sgYW5kIHJlbW92ZSAkbWV0YSwgZ2VuZXJhdGUgVVVJRCBldGMgZm9yXG4gICAgLy8gZWFjaCBhZGRlZCAvIHVwZGF0ZWQgdGFzay5cbiAgICAvLyBUaGUgcmVzdWx0IG9mIHRoaXMgb3BlcmF0aW9uIGlzIHR3by1mb2xkOlxuICAgIC8vICAxKSBSZW1vdmUgJG1ldGEgYW5kIGNyZWF0ZSBpZCBmb3IgZWFjaCB0YXNrLiBUbyBiZSByZWZsZWN0ZWQgaW50byBuZXh0IHN0YXRlLlxuICAgIC8vICAyKSBHZW5lcmF0ZSBtdXRhdGlvbiByZXF1ZXN0cyBpbnRvICdiYXRjaCcgdG8gaW5jbHVkZSBpbiB0aGUgc2luZ2xlIGJhdGNoIHJlcXVlc3QgdG8gdGhlIHNlcnZlci5cbiAgICBjb25zdCBvcmlnID0gb3JpZ0NvdXJzZSB8fCBvcmlnVGVtcGxhdGU7XG4gICAgY29uc3QgbmV3Q291cnNlVGFza3MgPSBtb2RpZmllZENvdXJzZS50YXNrcy5tYXAodGFzayA9PiB7XG4gICAgICBpZiAodGFzay4kbWV0YSA9PT0gJ2FkZCcgfHwgdGFzay4kbWV0YSA9PT0gJ3VwZGF0ZScpIHtcbiAgICAgICAgY29uc3Qgb3JpZ1Rhc2sgPSBvcmlnLnRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrLmlkKTtcbiAgICAgICAgcmV0dXJuIHVwZGF0ZURvY3VtZW50R3JhcGhzKG9yaWdUYXNrIHx8IHt9LCB0YXNrLCBcInRhc2tzXCIsIHtcbiAgICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6ICdrbm93bGVkZ2UtcmVxdWlyZW1lbnRzJyxcbiAgICAgICAgICBjZW50cmFsQ29udGVudDogJ2NlbnRyYWwtY29udGVudCcsXG4gICAgICAgICAgYWJpbGl0aWVzOiAnYWJpbGl0aWVzJ1xuICAgICAgICB9LCBiYXRjaCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHsuLi50YXNrfTtcbiAgICAgICAgZGVsZXRlIHVwZGF0ZWRUYXNrLiRtZXRhO1xuICAgICAgICByZXR1cm4gdXBkYXRlZFRhc2s7XG4gICAgICB9XG4gICAgfSk7XG4gICAgbW9kaWZpZWRDb3Vyc2UgPSB1cGRhdGUobW9kaWZpZWRDb3Vyc2UsIHt0YXNrczogeyRzZXQ6IG5ld0NvdXJzZVRhc2tzfX0pO1xuXG4gICAgbW9kaWZpZWRDb3Vyc2UgPSB1cGRhdGVEb2N1bWVudEdyYXBocyhvcmlnQ291cnNlIHx8IHt9LCBtb2RpZmllZENvdXJzZSwgJ2NvdXJzZXMnLCB7XG4gICAgICB0ZW1wbGF0ZUNoYWluOiAnY291cnNlcycsXG4gICAgICBjZW50cmFsQ29udGVudDogJ2NlbnRyYWwtY29udGVudCcsXG4gICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6ICdrbm93bGVkZ2UtcmVxdWlyZW1lbnRzJyxcbiAgICAgIGFiaWxpdGllczogJ2FiaWxpdGllcycsXG4gICAgICBpbWFnZXM6ICdpbWFnZXMnLFxuICAgICAgdGFza3M6ICd0YXNrcydcbiAgICB9LCBiYXRjaCk7XG5cbiAgICBtb2RpZmllZENvdXJzZSA9IHsuLi5tb2RpZmllZENvdXJzZSB9O1xuICAgIG1vZGlmaWVkQ291cnNlLnB1Ymxpc2hhYmxlID0gZG9lc0FsbFRhc2tzQ292ZXJBbGxSZXF1aXJlbWVudHM7XG4gICAgY29uc3QgdGFncyA9IChtb2RpZmllZENvdXJzZS50YWdzIHx8IFtdKS5maWx0ZXIodGFnID0+IHRhZyAhPT0gJ2luY29tcGxldGUnKTtcbiAgICBtb2RpZmllZENvdXJzZS50YWdzID0gbW9kaWZpZWRDb3Vyc2UucHVibGlzaGFibGUgP1xuICAgICAgdGFncyA6IHRhZ3MuY29uY2F0KFwiaW5jb21wbGV0ZVwiKTtcblxuICAgIGlmICghb3JpZ0NvdXJzZSkge1xuICAgICAgLy8gQSBuZXcgY291cnNlIHNob3VsZCBiZSBhZGRlZDpcbiAgICAgIGJhdGNoLmFkZCgnY291cnNlcycsIG1vZGlmaWVkQ291cnNlKTtcbiAgICAgIGlmIChjb3Vyc2Uuc2Nob29sKSB7XG4gICAgICAgIGNvbnN0IHNjaG9vbElkID0gYXdhaXQgbXlTY2hvb2xDb3Vyc2VzUmVwby5nZXRTY2hvb2xJZCgpO1xuICAgICAgICBiYXRjaC5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJjb3Vyc2VzXCIpO1xuICAgICAgICBpZiAoY291cnNlLmFjdGl2ZSkge1xuICAgICAgICAgIGJhdGNoLmxpbmsoXCJzY2hvb2xzXCIsIHNjaG9vbElkLCBcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImFjdGl2ZUNvdXJzZXNcIik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gQW4gZXhpc3RpbmcgY291cnNlIHNob3VsZCBiZSB1cGRhdGVkOlxuICAgICAgYmF0Y2gucHV0KCdjb3Vyc2VzJywgbW9kaWZpZWRDb3Vyc2UpO1xuICAgICAgaWYgKCFvcmlnQ291cnNlLmFjdGl2ZSAmJiBjb3Vyc2UuYWN0aXZlKSB7XG4gICAgICAgIC8vIENvdXJzZSB3YXMgYWN0aXZhdGVkLiBBZGQgYSByZWZlcmVuY2UgdG8gdGhlIGNvdXJzZSBvbiBzY2hvb2wuYWN0aXZlQ291cnNlcy5cbiAgICAgICAgY29uc3Qgc2Nob29sSWQgPSBhd2FpdCBteVNjaG9vbENvdXJzZXNSZXBvLmdldFNjaG9vbElkKCk7XG4gICAgICAgIGJhdGNoLmxpbmsoXCJzY2hvb2xzXCIsIHNjaG9vbElkLCBcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImFjdGl2ZUNvdXJzZXNcIik7XG4gICAgICB9IGVsc2UgaWYgKG9yaWdDb3Vyc2UuYWN0aXZlICYmICFjb3Vyc2UuYWN0aXZlKSB7XG4gICAgICAgIC8vIENvdXJzZSB3YXMgaW5hY3RpdmF0ZWQuIFJlbW92ZSBmcm9tIHNjaG9vbC5hY3RpdmVDb3Vyc2VzLlxuICAgICAgICBjb25zdCBzY2hvb2xJZCA9IGF3YWl0IG15U2Nob29sQ291cnNlc1JlcG8uZ2V0U2Nob29sSWQoKTtcbiAgICAgICAgYmF0Y2gudW5saW5rKFwic2Nob29sc1wiLCBzY2hvb2xJZCwgXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJhY3RpdmVDb3Vyc2VzXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFBlcmZvcm0gdGhlIGVudGlyZSBiYXRjaCB0aHJvdWdoIGEgc2luZ2xlIFBPU1QgcmVxdWVzdDpcbiAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5iYXRjaChiYXRjaC5tdXRhdGlvblJlcXVlc3RzKTtcbiAgICBzaG93SW5mbyAob3JpZ0NvdXJzZSA/XG4gICAgICBMYMOEbmRyaW5nYXJuYSBoYXIgc3BhcmF0c2AgOlxuICAgICAgTGBLdXJzZW4gaGFyIHNrYXBhdHNgKTtcbiAgICAvLyBVcGRhdGUgc3RhdGUgdG8gcmVmbGVjdCB3aGF0IGhhcyBiZWVuIHBvc3RlZDpcbiAgICBpZiAocmVzICYmIHJlcy5uZXdFdGFncylcbiAgICAgICAgbW9kaWZpZWRDb3Vyc2UgPSBhcHBseUV0YWdzKG1vZGlmaWVkQ291cnNlLCByZXMubmV3RXRhZ3MsIFtcImltYWdlc1wiLCBcInRhc2tzXCJdKSBhcyBDb3Vyc2U7XG4gICAgXG4gICAgaWYgKGNvdXJzZS5zY2hvb2wgPT09IGVudi5jdXJyZW50VXNlci5zY2hvb2wpIHtcbiAgICAgIC8vIFVwZGF0ZSBteVNjaG9vbENvdXJzZXNSZXBvXG4gICAgICBpZiAoIW9yaWdDb3Vyc2UpIHtcbiAgICAgICAgbXlTY2hvb2xDb3Vyc2VzUmVwby5pbnNlcnQobW9kaWZpZWRDb3Vyc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbXlTY2hvb2xDb3Vyc2VzUmVwby51cGRhdGUobW9kaWZpZWRDb3Vyc2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMuc2V0Tm9uU2F2ZWFibGVEYXRhU3RhdGUoe2NvdXJzZTogbW9kaWZpZWRDb3Vyc2UsIG9yaWdDb3Vyc2U6IG1vZGlmaWVkQ291cnNlLCBoYXNVbnNhdmVkRGF0YTogZmFsc2V9KTtcbiAgICB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKCcnKTtcbiAgICBpZiAoIW9yaWdDb3Vyc2UpIHtcbiAgICAgIC8vIFRoaXMgd2FzIHRoZSBjcmVhdGlvbiBvZiBhIG5ldyBjb3Vyc2UuIENvcnJlY3QgdGhlIHJvdXRlIG5vdyB3aGVuIHRoZSB1c2VyIGVudGVycyBhbiBlZGl0IHN0YXRlOlxuICAgICAgbG9jYXRpb24uaGFzaCA9IGAjL2NvdXJzZXMvJHttb2RpZmllZENvdXJzZS5pZH0vZWRpdGA7XG4gICAgfVxuICB9XG5cbiAgYWN0aXZhdGVBbmRTYXZlKCkge1xuICAgIGNvbnN0IGNvdXJzZSA9IHsuLi50aGlzLnN0YXRlLmNvdXJzZX07XG4gICAgaWYgKCFjb3Vyc2UuYWN0aXZlKSB7XG4gICAgICAvKmNvbnN0IHVuY292ZXJlZFJlcXVpcmVtZW50cyA9IGdldFVuY292ZXJlZEtub3dsZWRnZVJlcXVpcmVtZW50cyhjb3Vyc2UpO1xuICAgICAgaWYgKHVuY292ZXJlZFJlcXVpcmVtZW50cy5sZW5ndGggPiAwKSBcbiAgICAgICAgcmV0dXJuIHNob3dFcnJvciAoTGBEZXQgZmlubnMga3Vuc2thcHNrcmF2IHNvbSBpbnRlIHVwcGZ5bGxzIGF2IG7DpWdvbiBtb2R1bC4gS2FuIGludGUgYWt0aXZlcmEga3Vyc2VuIGbDtnJyw6RuIGFsbGEga3Vuc2thcHNrcmF2IGZpbm5zIG1lZC5gKTtcbiAgICAgICovXG5cbiAgICAgIGNvdXJzZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgY291cnNlLmFjdGl2YXRlZEJ5ID0ge1xuICAgICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgIHVybDogXCJtYWlsdG86XCIgKyAgZW52LmN1cnJlbnRVc2VyLm1haWxcbiAgICAgIH07XG4gICAgICBjb3Vyc2UuYWN0aXZhdGVkRGF0ZSA9IERhdGUubm93KCk7XG4gICAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoe2NvdXJzZX0pXG4gICAgICAgIC50aGVuKCgpPT50aGlzLnNhdmUoKSlcbiAgICAgICAgLmNhdGNoKGNhdGNoZXIpO1xuICAgIH1cbiAgfVxuXG4gIGluYWN0aXZhdGVBbmRTYXZlKCkge1xuICAgIGNvbnN0IGNvdXJzZSA9IHsuLi50aGlzLnN0YXRlLmNvdXJzZX07XG4gICAgaWYgKGNvdXJzZS5hY3RpdmUpIHtcbiAgICAgIGNvdXJzZS5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIGNvdXJzZS5pbmFjdGl2YXRlZEJ5ID0ge1xuICAgICAgICBuYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsXG4gICAgICAgIHVybDogXCJtYWlsdG86XCIgKyAgZW52LmN1cnJlbnRVc2VyLm1haWxcbiAgICAgIH07XG4gICAgICBjb3Vyc2UuaW5hY3RpdmF0ZWREYXRlID0gRGF0ZS5ub3coKTtcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7Y291cnNlfSlcbiAgICAgICAgLnRoZW4oKCk9PnRoaXMuc2F2ZSgpKVxuICAgICAgICAuY2F0Y2goY2F0Y2hlcik7XG4gICAgfVxuICB9XG5cbiAgb3BlbkRpYWxvZyhkaWFsb2dDb250YWluZXI6IERpYWxvZ0NvbnRhaW5lcikge1xuICAgIHRoaXMuc2V0Tm9uU2F2ZWFibGVEYXRhU3RhdGUoe2RpYWxvZ0NvbnRhaW5lcnM6IHRoaXMuc3RhdGUuZGlhbG9nQ29udGFpbmVycy5jb25jYXQoZGlhbG9nQ29udGFpbmVyKX0pO1xuICB9XG5cbiAgY2xvc2VEaWFsb2coKSB7XG4gICAgY29uc3Qge2RpYWxvZ0NvbnRhaW5lcnN9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7bGVuZ3RofSA9IGRpYWxvZ0NvbnRhaW5lcnM7XG4gICAgbGVuZ3RoICYmIHRoaXMuc2V0Tm9uU2F2ZWFibGVEYXRhU3RhdGUoe2RpYWxvZ0NvbnRhaW5lcnM6IGRpYWxvZ0NvbnRhaW5lcnMuc2xpY2UoMCwgbGVuZ3RoIC0gMSl9KTtcbiAgICAvLyBOb3cgc3luYyB0aGUgZGlyZWN0ICdkaWFsb2dzJyBwcm9wZXJ0eSB3aXRoIHRoZSBuZXcgc3RhdGU6XG4gICAgd2hpbGUgKHRoaXMuZGlhbG9ncy5sZW5ndGggPj0gbGVuZ3RoKSB0aGlzLmRpYWxvZ3MucG9wKCk7XG4gIH1cblxuICByZWZEaWFsb2coZGlhbG9nOiBEaWFsb2cgJiBSZWFjdC5Db21wb25lbnQsIGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmRpYWxvZ3NbaW5kZXhdID0gZGlhbG9nOyAvLyBTZXR0aW5nIHBlciBpbmRleCBpbnN0ZWFkIG9mIHB1c2goKS4gV29ya3MgZXZlbiBpZiB0aGUgcmVmIGF0dHJpYnV0ZSBjb3VsZCBiZSBpbnZva2VkIG11bHRpcGxlIHRpbWVzLlxuICB9XG5cbiAgb25LZXlEb3duIChldjogS2V5Ym9hcmRFdmVudCkge1xuICAgIGlmIChldi53aGljaCA9PT0gODMgJiYgKGV2LmN0cmxLZXkgfHwgZXYubWV0YUtleSkpIHsgLy8gQ1RSTC1TXG4gICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgaWYgKHRoaXMuc3RhdGUuZGlhbG9nQ29udGFpbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRoaXMuc2F2ZURpYWxvZygpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLnNhdmUoKTtcbiAgICB9IGVsc2UgaWYgKGV2LndoaWNoID09PSAyNyAmJiB0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xuICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICB9IGVsc2UgaWYgKGV2LndoaWNoID09PSAxMykge1xuICAgICAgY29uc3QgdGFyZ2V0RWxlbSA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGlmICh0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoID4gMCAmJlxuICAgICAgICB0YXJnZXRFbGVtLnRhZ05hbWUgIT09ICdURVhUQVJFQScgJiZcbiAgICAgICAgdGFyZ2V0RWxlbS50YWdOYW1lICE9PSAnSU5QVVQnICYmXG4gICAgICAgIHRhcmdldEVsZW0udGFnTmFtZSAhPT0gJ1NFTEVDVCcgJiZcbiAgICAgICAgdGFyZ2V0RWxlbS50YWdOYW1lICE9PSAnT1BUSU9OJyAmJlxuICAgICAgICAhdGFyZ2V0RWxlbS5jb250ZW50RWRpdGFibGUpXG4gICAgICB7XG4gICAgICAgIHRoaXMuc2F2ZURpYWxvZygpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGJlZm9yZVVubG9hZChldjogRXZlbnQpIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5kaWFsb2dDb250YWluZXJzLmxlbmd0aCA+IDAgfHwgdGhpcy5zdGF0ZS5oYXNVbnNhdmVkRGF0YSkge1xuICAgICAgaWYgKCFlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmJlYXJlclByb3ZpZGVyLndhbnRzUmVkaXJlY3QpIHtcbiAgICAgICAgZXYucmV0dXJuVmFsdWUgPSBDT05GSVJNX05BVklHQVRFX01FU1NBR0U7XG4gICAgICAgIHJldHVybiBldi5yZXR1cm5WYWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbkNsaWNrUHJldmVudFVubG9hZChldjogRXZlbnQpIHtcbiAgICBpZiAoZXYudGFyZ2V0ICYmICgnJysoZXYudGFyZ2V0IGFzIGFueSkudGFnTmFtZSkudG9Mb3dlckNhc2UoKSA9PT0gJ2EnKSB7XG4gICAgICBjb25zdCBhOiBIVE1MQW5jaG9yRWxlbWVudCA9IGV2LnRhcmdldCBhcyBIVE1MQW5jaG9yRWxlbWVudDtcbiAgICAgIGlmIChhLmhyZWYgJiYgYS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSAhPT0gJyMnICYmICFhLnRhcmdldCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5kaWFsb2dDb250YWluZXJzLmxlbmd0aCA+IDAgfHwgdGhpcy5zdGF0ZS5oYXNVbnNhdmVkRGF0YSkge1xuICAgICAgICAgIGlmICghY29uZmlybShDT05GSVJNX05BVklHQVRFX01FU1NBR0UpKSB7XG4gICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc2F2ZURpYWxvZygpIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5kaWFsb2dDb250YWluZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGRpYWxvZyA9IHRoaXMuZGlhbG9nc1t0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubGVuZ3RoLTFdOyAvLyBZRVMsIHNob3VsZCByZWZlcmVuY2UgdGhpcy5kaWFsb2dzIGJ5IGxlbmd0aCBvZiBkaWFsb2dDb250YWluZXJzLiBTdHJhbmdlIHllcywgYnV0IGxlYXZlIGl0IHNvIVxuICAgICAgZGlhbG9nICYmIGRpYWxvZy5zYXZlKCk7IFxuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBpc0FkbWluID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2YoXCJBRE1JTlwiKSA+PSAwO1xuICAgIGNvbnN0IGNvdXJzZSA9IHRoaXMuc3RhdGUuY291cnNlO1xuICAgIHJldHVybiAhdGhpcy5zdGF0ZS5jb3Vyc2UgPyA8ZGl2IHN0eWxlPXt7b3V0bGluZTogMH19PlxuICAgICAgPENvdXJzZUJhbm5lclxuICAgICAgICB0aXRsZT1cIlwiXG4gICAgICAgIGFjdGl2ZVBhZ2U9e3RoaXMuc3RhdGUudmlld31cbiAgICAgICAgcm91dGVzPXt7ZmVlZGJhY2s6IHRoaXMucHJvcHMuZmVlZGJhY2tVcmx9fVxuICAgICAgLz48cD48U3Bpbm5lci8+Vi5nLiB2w6RudGEgbWVkYW4ga3Vyc2VuIGxhZGRhcy4uLjwvcD5cbiAgICAgIDwvZGl2PiA6XG4gICAgICA8ZGl2IHN0eWxlPXt7b3V0bGluZTogMH19PlxuICAgICAgPENvdXJzZUJhbm5lclxuICAgICAgICB0aXRsZT17Y291cnNlLm5hbWUgKyBcIiAtIFwiICsgY291cnNlLnBvaW50cyArIFwicFwifVxuICAgICAgICBhY3RpdmVQYWdlPXt0aGlzLnN0YXRlLnZpZXd9XG4gICAgICAgIHJvdXRlcz17e1xuICAgICAgICAgIHN0dWRlbnRQYWdlOiBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSh0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmwsIHtjb3Vyc2VJZDogdGhpcy5wcm9wcy5pZH0pLFxuICAgICAgICAgIGZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsXG4gICAgICAgIH19XG4gICAgICAgIGhvc3Q9e3RoaXN9XG4gICAgICAgIGNvdXJzZT17Y291cnNlfVxuICAgICAgICBvcmlnQ291cnNlPXt0aGlzLnN0YXRlLm9yaWdDb3Vyc2V9XG4gICAgICAgIGJhY2tncm91bmRJbWFnZT17Y291cnNlLmltYWdlcy5maWx0ZXIoaW1nID0+IGltZy5pZCA9PT0gY291cnNlLmltYWdlSWQpLm1hcChpbWc9PmltZy51cmwpWzBdfVxuICAgICAgICBpc1RlbXBsYXRlPXtjb3Vyc2UuaXNUZW1wbGF0ZX1cbiAgICAgICAvPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0XCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytc3BhY2VyLTIwcHh2dCBzdi12ZXJ0aWNhbCBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZWNvbnRlbnQgc3YtbGF5b3V0IHN2LXNwYWNlci0yMHB4dnQgc3Ytc2tpcC1zcGFjZXJcIiByZWY9e1xuICAgICAgICAgICAgICBkaXYgPT4gdGhpcy5jb250ZW50RGl2ID0gZGl2fT5cbiAgICAgICAgICAgICAgPElubmVyRWRpdENvdXJzZVxuICAgICAgICAgICAgICAgIGNvdXJzZT17dGhpcy5zdGF0ZS5jb3Vyc2V9XG4gICAgICAgICAgICAgICAgb3JpZ0NvdXJzZT17dGhpcy5zdGF0ZS5vcmlnQ291cnNlfVxuICAgICAgICAgICAgICAgIGhvc3Q9e3RoaXN9IC8+XG4gICAgICAgICAgICAgIDxici8+XG4gICAgICAgICAgICAgIHt0aGlzLnN0YXRlLmRpYWxvZ0NvbnRhaW5lcnMubWFwKCh7Q29tcG9uZW50LCBwcm9wc30sIGkpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPGRpdiBrZXk9e2l9PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJkYXJrZW5cIj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlLXdyYXBcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtb2RhbC1wYWdlXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPENvbXBvbmVudCByZWY9e2RpYWxvZz0+dGhpcy5yZWZEaWFsb2coZGlhbG9nLCBpKX0gey4uLnByb3BzfSAvPlxuICAgICAgICAgICAgICAgICAgICAgIDxSZW1vdmVJdGVtIG9uQ2xpY2s9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn1cbiIsImV4cG9ydCB7IEVkaXRDb3Vyc2UgfSBmcm9tICcuL2VkaXQtY291cnNlJztcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IENvdXJzZSwgQWJpbGl0eSwgU3ViamVjdCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IEVkaXRhYmxlUmVzb3VyY2VMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtcmVzb3VyY2UtbGlzdCc7XG5pbXBvcnQgeyBkdEZvcm1hdCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IENvdXJzZU1vZHVsZUxpc3QgfSBmcm9tICcuL2NvdXJzZS1tb2R1bGUtbGlzdCc7XG5pbXBvcnQgeyBTY2hvb2xDb3Vyc2VzIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvc2Nob29sLWNvdXJzZXMnO1xuaW1wb3J0IHsgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XG5pbXBvcnQgeyBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMsIHNhbml0eUNoZWNrLCBnZXRJZHNOb3RDb3ZlcmVkQnlUYXNrcyB9IGZyb20gJy4vYnVzaW5lc3MtbG9naWMnO1xuaW1wb3J0IHsgc2V0Q291cnNlSW1hZ2UgfSBmcm9tIFwiLi9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lcic7XG5pbXBvcnQgeyBFZGl0YWJsZVRlYWNoZXJMaXN0IH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvZWRpdGFibGUtdGVhY2hlci1saXN0JztcbmltcG9ydCB7IHNob3dFcnJvciwgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgV2VpZ2h0ZWRJdGVtc1RhYmxlIH0gZnJvbSAnLi4vc3ViLWNvbXBvbmVudHMvd2VpZ2h0ZWQtaXRlbXMtdGFibGUnO1xuaW1wb3J0IHsgV3lzaXd5ZyB9IGZyb20gJy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2luZGV4JztcbmltcG9ydCBhY3Rpb25zX3N3ZWRpc2ggZnJvbSAnLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcvYWN0aW9ucy1zdic7XG5pbXBvcnQgeyBFZGl0YWJsZVdvcmtGbG93TGluayB9IGZyb20gJy4uL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXdvcmtmbG93LWxpbmsnO1xuaW1wb3J0IHsgUmVuYW1lYWJsZVRleHQgfSBmcm9tICcuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvcmVuYW1lYWJsZS10ZXh0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY291cnNlOiBDb3Vyc2U7XG4gIG9yaWdDb3Vyc2U6IENvdXJzZTtcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3Q7XG59O1xuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBjaGFuZ2VJbWFnZVVybDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIElubmVyRWRpdENvdXJzZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBwcm9wczogUHJvcHM7XG4gIHN0YXRlOiBTdGF0ZTtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBjaGFuZ2VJbWFnZVVybDogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgc2V0SW1hZ2VVcmwoaW1hZ2VVcmw6IHN0cmluZykge1xuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmICghY291cnNlLmltYWdlSWQpIHtcblxuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNvdXJzZSwgb3JpZ0NvdXJzZSwgaG9zdCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB1bmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMgPSBnZXRVbmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMoY291cnNlKTtcbiAgICBjb25zdCBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrID0gZ2V0SWRzTm90Q292ZXJlZEJ5VGFza3MoY291cnNlKTtcbiAgICBjb25zdCBzYW5pdHlDaGVja1dhcm5pbmdzID0gc2FuaXR5Q2hlY2soY291cnNlKTtcbiAgICBjb25zdCBjb3Vyc2VJbWFnZSA9IGNvdXJzZS5pbWFnZXMuZmluZChpbWcgPT4gaW1nLmlkID09PSBjb3Vyc2UuaW1hZ2VJZCk7XG4gICAgY29uc3QgY291cnNlSW1hZ2VJc0RhdGFVcmwgPSBjb3Vyc2VJbWFnZSAmJiBjb3Vyc2VJbWFnZS51cmwuc3RhcnRzV2l0aCgnZGF0YTonKTtcbiAgICBjb25zdCBjb3Vyc2VJc1VwbG9hZGVkID0gY291cnNlSW1hZ2UgJiYgY291cnNlSW1hZ2UudXJsLmluZGV4T2YoJ3N0b3JhZ2UuZ29vZ2xlYXBpcy5jb20nKSA+IDA7XG5cbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1yb3cgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT17XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTdcIn0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICB7Y291cnNlLmlzVGVtcGxhdGUgJiYgPGgxPkt1cnNtYWxsPC9oMT4gfVxuICAgICAgICAgIDxoMj5LdXJzw7Z2ZXJncmlwYW5kZTwvaDI+XG4gICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIDxoMz5LdXJzZW5zIGJpbGQ8L2gzPlxuICAgICAgICAgICAgICB7Y291cnNlSW1hZ2VJc0RhdGFVcmwgP1xuICAgICAgICAgICAgICAgIDxwPkt1cnNlbnMgYmlsZCBsaWdnZXIgaSBkYXRhYmFzZW4uIEbDtnIgYXR0IMOkbmRyYSBiaWxkIG3DpXN0ZSBkdSBkcmEgb2NoIHNsw6RwcGEgZW4gbnkgYmlsZCBvdmFucMOlIGRlbiBnYW1sYSBow7Znc3QgdXBwIHDDpSBkZW5uYSBzaWRhLlxuICAgICAgICAgICAgICAgICAgQmlsZGVuIGthbiBhbnRpbmdlbiB2YXJhIGZyw6VuIGVuIGFubmFuIHdlYmJzaWRhLiBMb2thbGEgYmlsZGZpbGVyIGfDpXIgb2Nrc8OlIGJyYSBhdHQgZHJhIG9jaCBzbMOkcHBhLjwvcD5cbiAgICAgICAgICAgICAgICAgOiBjb3Vyc2VJc1VwbG9hZGVkID8gPHA+XG4gICAgICAgICAgICAgICAgICAgS3Vyc2VucyBiaWxkIGxpZ2dlciBpIEt1bnNrYXBzc2tvbGFucyBHb29nbGUgbW9sbi4gRsO2ciBhdHQgw6RuZHJhIGJpbGQgbcOlc3RlIGR1IGRyYSBvY2ggc2zDpHBwYSBlbiBueSBiaWxkIG92YW5ww6UgZGVuIGdhbWxhIGjDtmdzdCB1cHAgcMOlIGRlbm5hIHNpZGEuXG4gICAgICAgICAgICAgICAgICBCaWxkZW4ga2FuIGFudGluZ2VuIHZhcmEgZnLDpW4gZW4gYW5uYW4gd2ViYnNpZGEuIExva2FsYSBiaWxkZmlsZXIgZ8OlciBvY2tzw6UgYnJhIGF0dCBkcmEgb2NoIHNsw6RwcGEuXG4gICAgICAgICAgICAgICAgIDwvcD4gOiBjb3Vyc2VJbWFnZSA/IDxkaXY+PHRleHRhcmVhXG4gICAgICAgICAgICAgICAgICB2YWx1ZT17Y291cnNlSW1hZ2UudXJsfVxuICAgICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogJzEwMCUnLCBoZWlnaHQ6ICczMHB4J319XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17ZXY9PnNldENvdXJzZUltYWdlKGNvdXJzZSwgb3JpZ0NvdXJzZSwgaG9zdCwgZXYudGFyZ2V0LnZhbHVlKX0vPlxuICAgICAgICAgICAgICAgICAgPHA+QmlsZGVuIHNvbSB2aXNhcyBow7Znc3QgdXBwIGjDpG10YXMgZnLDpW4gYW5naXZlbiBVUkwuXG4gICAgICAgICAgICAgICAgICAgIEbDtnIgYXR0IMOkbmRyYSBiaWxkIGthbiBkdSByZWRpZ2VyYSBVUkwgb3Zhbi4gRXR0IGFubmF0IHPDpHR0IGF0dCDDpG5kcmEgYmlsZCDDpHIgYXR0IGRyYSBvY2ggc2zDpHBwYSBlbiBueSBiaWxkIMO2dmVyIGRlbiBnYW1sYSBow7Znc3QgdXBwIHDDpSBzaWRhbi48L3A+XG4gICAgICAgICAgICAgICAgPC9kaXY+IDpcbiAgICAgICAgICAgICAgICAgIDxwPkt1cnNlbiBzYWtuYXIgZWdlbiBiaWxkLlxuICAgICAgICAgICAgICAgICAgICBMw6RnZyB0aWxsIGVuIGJpbGQgZ2Vub20gYXR0IGRyYSBvY2ggc2zDpHBwYSBlbiBiaWxkIHDDpSBrdXJzLWJhbm5lcm4gaMO2Z3N0IHVwcCBww6UgZGVuIGjDpHIgc2lkYW4uPC9wPn1cbiAgICAgICAgICAgICAgPGJyLz5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICB7IWNvdXJzZS5pc1RlbXBsYXRlICYmIDxkaXY+XG4gICAgICAgICAgICAgIDxoMz5CZXNrcml2bmluZzwvaDM+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInN1YkhlYWRlclwiPihCZXNrcml2bmluZyBhdiBrdXJzZW4uIEbDtnIgYXR0IHNraWxqYSBtZWxsYW4gb2xpa2EgdmFyaWFudGVyIGF2IHNhbW1hIGd5bW5hc2lla3Vycyk8L3A+XG4gICAgICAgICAgICAgIDx0ZXh0YXJlYSBjbGFzc05hbWU9XCJpbnB1dFRleHRCb3ggaW5wdXRUZXh0U21hbGxcIlxuICAgICAgICAgICAgICAgIHZhbHVlPXtjb3Vyc2UuZGVzY3JpcHRpb259XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IGhvc3QudXBkYXRlKHsgZGVzY3JpcHRpb246IHsgJHNldDogZXYudGFyZ2V0LnZhbHVlIH0gfSl9IC8+XG4gICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgPC9kaXY+fSAgICAgICAgICAgIFxuXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8aDM+VXBwdGFrdHN0ZXh0PC9oMz5cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic3ViSGVhZGVyXCI+KHRleHRlbiBza2EgdmlzYXMgcMOlIGt1cnNlbnMgdXBwdGFrdHNzZWt0aW9uKTwvcD5cbiAgICAgICAgICAgICAgPFd5c2l3eWdcbiAgICAgICAgICAgICAgICBodG1sPXtjb3Vyc2UucnVuVXBUZXh0fVxuICAgICAgICAgICAgICAgIGRlZmF1bHRBY3Rpb25zPXthY3Rpb25zX3N3ZWRpc2h9XG4gICAgICAgICAgICAgICAgYWN0aW9ucz17W1xuICAgICAgICAgICAgICAgICAgXCJib2xkXCIsXG4gICAgICAgICAgICAgICAgICBcIml0YWxpY1wiLFxuICAgICAgICAgICAgICAgICAgXCJ1bmRlcmxpbmVcIixcbiAgICAgICAgICAgICAgICAgIFwic3RyaWtldGhyb3VnaFwiLFxuICAgICAgICAgICAgICAgICAgXCJoZWFkaW5nMlwiLFxuICAgICAgICAgICAgICAgICAgXCJoZWFkaW5nM1wiLFxuICAgICAgICAgICAgICAgICAgXCJvbGlzdFwiLFxuICAgICAgICAgICAgICAgICAgXCJ1bGlzdFwiLFxuICAgICAgICAgICAgICAgICAgXCJsaW5lXCIsXG4gICAgICAgICAgICAgICAgICBcImxpbmtcIixcbiAgICAgICAgICAgICAgICAgIFwiaW1hZ2VcIl19XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e25ld0h0bWwgPT4gaG9zdC51cGRhdGUoeyBydW5VcFRleHQ6IHskc2V0OiBuZXdIdG1sfX0pfSAvPlxuICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICA8aDM+S3Vyc3Jlc3Vyc2VyPC9oMz5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInN1YkhlYWRlclwiPihSZXN1cnNlciBmw7ZyIHVwcHRha3Qgb2NoIGt1cnNlbiBzb20gaGVsaGV0KTwvcD5cbiAgICAgICAgICAgIDxFZGl0YWJsZVJlc291cmNlTGlzdFxuICAgICAgICAgICAgICByZXNvdXJjZXM9e2NvdXJzZS5yZXNvdXJjZXN9XG4gICAgICAgICAgICAgIG9uVXBkYXRlPXtyZXNvdXJjZXNVcGRhdGVzID0+IGhvc3QudXBkYXRlKHsgcmVzb3VyY2VzOiByZXNvdXJjZXNVcGRhdGVzIH0pfVxuICAgICAgICAgICAgICBob3N0PXtob3N0fSAvPlxuICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICA8aDM+QXJiZXRzZ8Olbmc8L2gzPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwic3ViSGVhZGVyXCI+KEV2ZW50dWVsbCBsw6RuayB0aWxsIGFyYmV0c2fDpW5nIGbDtnIga3Vyc2VuKTwvcD5cbiAgICAgICAgICAgIDxFZGl0YWJsZVdvcmtGbG93TGlua1xuICAgICAgICAgICAgICB1cmw9e2NvdXJzZS53b3JrRmxvd0xpbmt9XG4gICAgICAgICAgICAgIG9uVXBkYXRlPXt1cGRhdGVzID0+IGhvc3QudXBkYXRlKHsgd29ya0Zsb3dMaW5rOiB1cGRhdGVzIH0pfVxuICAgICAgICAgICAgICBob3N0PXtob3N0fSAvPlxuICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICB7IWNvdXJzZS5pc1RlbXBsYXRlICYmIDxkaXY+XG4gICAgICAgICAgICAgIDxoMz5Hb29nbGUgQ2xhc3Nyb29tPC9oMz5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJHb29nbGUgY2xhc3Nyb29tIFVSTFwiXG4gICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZT17MzB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtjb3Vyc2UuZ29vZ2xlQ2xhc3NSb29tVVJMfVxuICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gaG9zdC51cGRhdGUoe2dvb2dsZUNsYXNzUm9vbVVSTDogeyRzZXQ6IGV2LnRhcmdldC52YWx1ZX19KX0vPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJrb2RcIlxuICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgIHNpemU9ezh9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtjb3Vyc2UuZ29vZ2xlQ2xhc3NSb29tQ29kZX1cbiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IGhvc3QudXBkYXRlKHtnb29nbGVDbGFzc1Jvb21Db2RlOiB7JHNldDogZXYudGFyZ2V0LnZhbHVlfX0pfSAvPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pn1cblxuICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICB7IWNvdXJzZS5pc1RlbXBsYXRlICYmIDw+PEVkaXRhYmxlVGVhY2hlckxpc3QgXG4gICAgICAgICAgICAgIHRlYWNoZXJzPXtjb3Vyc2UucmVzcG9uc2libGVUZWFjaGVyc31cbiAgICAgICAgICAgICAgb25VcGRhdGU9e3RlYWNoZXJzVXBkYXRlID0+IHtcbiAgICAgICAgICAgICAgICBob3N0LnVwZGF0ZSh7cmVzcG9uc2libGVUZWFjaGVyczogdGVhY2hlcnNVcGRhdGV9KTtcbiAgICAgICAgICAgICAgfX0gLz5cbiAgICAgICAgICAgIHsvKlxuICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICA8aDM+SW5sw6RtbmluZ3MgRS1wb3N0PC9oMz5cbiAgICAgICAgICAgIDx0YWJsZSB0YWJJbmRleD17MX0gc3R5bGU9e3t3aWR0aDogJzEwMCUnfX0+XG4gICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPlxuICAgICAgICAgICAgICAgIEUtcG9zdGFkZHJlc3NcbiAgICAgICAgICAgICAgPC90aD48L3RyPjwvdGhlYWQ+XG4gICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgIDxSZW5hbWVhYmxlVGV4dFxuICAgICAgICAgICAgICAgICAgICAgIGVhZ2VyPXt0cnVlfVxuICAgICAgICAgICAgICAgICAgICAgIGNsaWNrQWR2ZXJ0aXNlVGV4dD1cIktsaWNrYSBow6RyIGbDtnIgYXR0IGFuZ2UgdmVtIHNvbSB0YXIgZW1vdCBpbmzDpG1uaW5nc3VwcGdpZnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgdGV4dD17Y291cnNlLmFzc2lnbm1lbnRFbWFpbHMgPyBjb3Vyc2UuYXNzaWdubWVudEVtYWlsc1swXSA6IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJBbmdlIG1vdHRhZ2FyZSBhdiBpbmzDpG1uaW5nc3VwcGdpZnRlclwiXG4gICAgICAgICAgICAgICAgICAgICAgdGFnPVwiaW5wdXRcIlxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt2YWx1ZSA9PiBob3N0LnVwZGF0ZSh7YXNzaWdubWVudEVtYWlsczogeyRzZXQ6IFt2YWx1ZV19fSl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgIDwvdHI+XG4gICAgICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgICA8L3RhYmxlPiovfVxuICAgICAgICAgICAgPC8+fVxuXG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiIGlkPVwic3ZpZDEyXzZhYjQ4MTFmMTViMTNjNzA2YjQzYmI0N1wiPlxuICAgICAgICAgICAgPGRpdiBpZD1cIkt1cnNlbnNtb2R1bGVyXCI+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxoMj5LdXJzZW5zIG1vZHVsZXI8L2gyPlxuICAgICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPENvdXJzZU1vZHVsZUxpc3RcbiAgICAgICAgICAgIGhvc3Q9e2hvc3R9XG4gICAgICAgICAgICBjb3Vyc2U9e2NvdXJzZX1cbiAgICAgICAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2s9e2lkc05vdENvdmVyZWRCeUFueVRhc2t9IC8+XG4gICAgICAgICAgXG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIDxici8+XG4gICAgICAgICAgICA8V2VpZ2h0ZWRJdGVtc1RhYmxlIGNvdXJzZT17Y291cnNlfS8+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgICAgICA8aDI+S3Vyc2VucyBzdGF0dXM8L2gyPlxuICAgICAgICAgICAgPGhyIC8+XG4gICAgICAgICAgICB7Y291cnNlLmNyZWF0ZWRCeSAmJiBjb3Vyc2UuY3JlYXRlZERhdGUgJiYgPHA+XG4gICAgICAgICAgICAgIEt1cnNlbiBza2FwYWRlcyB7ZHRGb3JtYXQoY291cnNlLmNyZWF0ZWREYXRlKX0gYXYgPHN0cm9uZz57Y291cnNlLmNyZWF0ZWRCeS5uYW1lfTwvc3Ryb25nPi5cbiAgICAgICAgICAgIDwvcD59XG4gICAgICAgICAgICB7Y291cnNlLm1vZGlmaWVkQnkgJiYgY291cnNlLm1vZGlmaWVkRGF0ZSAmJiA8cD5cbiAgICAgICAgICAgICAgS3Vyc2VuIHJlZGlnZXJhZGVzIHNlbmFzdCB7ZHRGb3JtYXQoY291cnNlLm1vZGlmaWVkRGF0ZSl9IGF2IDxzdHJvbmc+e2NvdXJzZS5tb2RpZmllZEJ5Lm5hbWV9PC9zdHJvbmc+LlxuICAgICAgICAgICAgPC9wPn1cbiAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlID8gPHA+XG4gICAgICAgICAgICAgIEt1cnNlbiDDpHIgPHN0cm9uZz5BS1RJVjwvc3Ryb25nPiBzZWRhbiB7ZHRGb3JtYXQoY291cnNlLmFjdGl2YXRlZERhdGUpfSBhdiA8c3Ryb25nPntjb3Vyc2UuYWN0aXZhdGVkQnkubmFtZX08L3N0cm9uZz4uXG4gICAgICAgICAgICA8L3A+IDogPHA+XG4gICAgICAgICAgICAgICAgS3Vyc2VuIMOkciA8c3Ryb25nPklOQUtUSVY8L3N0cm9uZz57Y291cnNlLmluYWN0aXZhdGVkQnkgPyA8c3Bhbj5cbiAgICAgICAgICAgICAgICAgIHNlZGFuIHtkdEZvcm1hdChjb3Vyc2UuaW5hY3RpdmF0ZWREYXRlKX0gYXYgPHN0cm9uZz57Y291cnNlLmluYWN0aXZhdGVkQnkubmFtZX08L3N0cm9uZz4uPC9zcGFuPiA6IDxzcGFuPi48L3NwYW4+XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICA8L3A+fVxuICAgICAgICAgICAgeyh1bmNvdmVyZWRLbm93bGVkZ2VSZXF1aXJlbWVudHMubGVuZ3RoID09PSAwID9cbiAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwibWFya2VkR3JlZW5cIj5Nb2R1bGVybmFzIGt1bnNrYXBza3JhdiB0w6Rja2VyIHNrb2x2ZXJrZXRzIGtyYXYgZsO2ciBkZW5uYSBrdXJzPC9wPiA6XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibWFya2VkUmVkIHdhcm5pbmctYm94XCI+PGRpdiBjbGFzc05hbWU9XCJ3YXJuaW5nRmxhZ1wiPlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICA8L2Rpdj48cD5Nb2R1bGVybmFzIGt1bnNrYXBza3JhdiB0w6Rja2VyIGludGUgc2tvbHZlcmtldHMga3JhdiBmw7ZyIGRlbm5hIGt1cnMuPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICAgICAge3Nhbml0eUNoZWNrV2FybmluZ3MubWFwKHdhcm5pbmcgPT4gPGRpdiBrZXk9e3dhcm5pbmd9IGNsYXNzTmFtZT1cIm1hcmtlZFJlZCB3YXJuaW5nLWJveFwiPjxkaXYgY2xhc3NOYW1lPVwid2FybmluZ0ZsYWdcIj5cbiAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1leGNsYW1hdGlvbi10cmlhbmdsZVwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgICAgPC9kaXY+PHA+e3dhcm5pbmd9PC9wPjwvZGl2Pil9XG4gICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgIHshY291cnNlLmlzVGVtcGxhdGUgJiYgKG9yaWdDb3Vyc2UgPyA8ZGl2XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT57XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oTGBCZWtyw6RmdGEgYm9ydHRhZ25pbmcgYXYga3Vyc2VuIFwiJHtjb3Vyc2UubmFtZX0gLSAke2NvdXJzZS5kZXNjcmlwdGlvbn1cIiBmw7ZyIHNrb2xhbiAke2NvdXJzZS5zY2hvb2x9XFxuXFxuS3Vyc2VuIGtvbW1hciBhdHQgcmFkZXJhcyBoZWx0IVxcblxcbsOEciBkdSBzw6RrZXI/YCkpXG4gICAgICAgICAgICAgICAgICBob3N0LmRlbGV0ZUNvdXJzZSgpLmNhdGNoKHNob3dFcnJvcik7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICA+VGEgYm9ydCBrdXJzPC9kaXY+OjxkaXZcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCJcbiAgICAgICAgICAgICAgb25DbGljaz17KCk9Pmhpc3RvcnkuZ28oLTEpfVxuICAgICAgICAgICAgPkF2YnJ5dFxuICAgICAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlXCIgb25DbGljaz17KCkgPT4gaG9zdC5zYXZlKCl9PlxuICAgICAgICAgICAgICBTcGFyYVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7Y291cnNlLmFjdGl2ZSA/XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGJ0bi1pbmZvIGJ0bi1sYXJnZVwiXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaG9zdC5pbmFjdGl2YXRlQW5kU2F2ZSgpfT5cbiAgICAgICAgICAgICAgICBJbmFrdGl2ZXJhIG9jaCBzcGFyYVxuICAgICAgICAgICAgICA8L2Rpdj4gOlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4taW5mbyBidG4tbGFyZ2VcIlxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhvc3QuYWN0aXZhdGVBbmRTYXZlKCl9PlxuICAgICAgICAgICAgICAgIEFrdGl2ZXJhIG9jaCBzcGFyYVxuICAgICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1jb2x1bW4tNVwiPlxuICAgICAgICA8U2Nob29sQ291cnNlcyAvPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgRXJyb3JTdWNjZXNzRmVlZGJhY2sgfSBmcm9tICcuLi8uLi91dGlscy9lcnJvci1zdWNjZXNzLWZlZWRiYWNrJztcbmltcG9ydCB7IFNjaG9vbHMgfSBmcm9tICcuL3NjaG9vbHMnO1xuaW1wb3J0IHsgTmV3U2Nob29sIH0gZnJvbSAnLi9zY2hvb2xzL25ldy1zY2hvb2wnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuXG4vLyBWaWV3c1xuaW1wb3J0IHsgU3ViamVjdHMsIFNob3dTdWJqZWN0IH0gZnJvbSAnLi9zdWJqZWN0cyc7XG5pbXBvcnQgeyBFZGl0Q291cnNlIH0gZnJvbSAnLi9jb3Vyc2VzJztcbmltcG9ydCB7IEVkaXRTY2hvb2wgfSBmcm9tIFwiLi9zY2hvb2xzL2VkaXQtc2Nob29sXCI7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcbmltcG9ydCB7IENyZWF0ZU5ld0NvdXJzZSB9IGZyb20gXCIuL2NvdXJzZXMvY3JlYXRlLW5ld1wiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcblxuLy8gS2VlcCBTZXNzaW9uIEFsaXZlXG5pbXBvcnQgeyBrZWVwU2Vzc2lvbkFsaXZlIH0gZnJvbSAnLi4vLi4vdXRpbHMva2VlcC1zZXNzaW9uLWFsaXZlJztcbmtlZXBTZXNzaW9uQWxpdmUoKTtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nO1xuICBmZWVkYmFja1VybDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xufVxuXG5leHBvcnQgY2xhc3MgQ291cnNlQnVpbGRlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgaXNBdXRob3JpemVkID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSBcIkFETUlOXCIgfHwgcm9sZSA9PT0gXCJFTVBMT1lFRVwiKTtcbiAgICBjb25zdCBpc0FkbWluID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSBcIkFETUlOXCIpO1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImNvdXJzZS1idWlsZGVyXCI+XG4gICAgICA8Um91dGVyPlxuICAgICAgICB7aXNBdXRob3JpemVkID8gPGRpdj5cbiAgICAgICAgICA8Um91dGUgZXhhY3QgcGF0aD1cIi9cIiByZW5kZXI9eyh7IG1hdGNoIH0pID0+IGlzQWRtaW4gP1xuICAgICAgICAgICAgPFNjaG9vbHMgdmlld0NvdXJzZVVybD17dGhpcy5wcm9wcy52aWV3Q291cnNlVXJsfSBmZWVkYmFja1VybD17dGhpcy5wcm9wcy5mZWVkYmFja1VybH0gLz4gOlxuICAgICAgICAgICAgPENyZWF0ZU5ld0NvdXJzZSBmZWVkYmFja1VybD17dGhpcy5wcm9wcy5mZWVkYmFja1VybH0gLz59IC8+XG4gICAgICAgICAgPFJvdXRlIGV4YWN0IHBhdGg9XCIvc2Nob29sc1wiIHJlbmRlcj17KHsgbWF0Y2ggfSkgPT5cbiAgICAgICAgICAgIDxTY2hvb2xzXG4gICAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cbiAgICAgICAgICAgICAgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9IC8+fSAvPlxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3NjaG9vbHMvbmV3L2d5bW5hc2l1bVwiIHJlbmRlcj17KCk9PjxOZXdTY2hvb2wgdHlwZT1cImd5bW5hc2l1bVwiIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cbiAgICAgICAgICA8Um91dGUgZXhhY3QgcGF0aD1cIi9zY2hvb2xzL25ldy9wcmltYXJ5XCIgcmVuZGVyPXsoKT0+PE5ld1NjaG9vbCB0eXBlPVwicHJpbWFyeVwiIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cbiAgICAgICAgICA8Um91dGUgZXhhY3QgcGF0aD1cIi9zY2hvb2xzLzppZC9lZGl0XCIgcmVuZGVyPXsoeyBtYXRjaCB9KSA9PiA8RWRpdFNjaG9vbFxuICAgICAgICAgICAgaWQ9e21hdGNoLnBhcmFtcy5pZH1cbiAgICAgICAgICAgIHRpdGxlPXtMYEVkaXRlcmEgc2tvbGFgfVxuICAgICAgICAgICAgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9IC8+fSAvPlxuICAgICAgICAgIDxSb3V0ZSBleGFjdCBwYXRoPVwiL3N1YmplY3RzXCIgcmVuZGVyPXsoKT0+PFN1YmplY3RzIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cbiAgICAgICAgICA8Um91dGUgcGF0aD1cIi9zdWJqZWN0cy86aWRcIiByZW5kZXI9eyh7IG1hdGNoIH0pID0+IDxTaG93U3ViamVjdFxuICAgICAgICAgICAgaWQ9e21hdGNoLnBhcmFtcy5pZH1cbiAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfSAvPn0gLz5cbiAgICAgICAgICA8Um91dGUgZXhhY3QgcGF0aD1cIi9jb3Vyc2VzL25ld1wiIHJlbmRlcj17KCk9PiA8Q3JlYXRlTmV3Q291cnNlXG4gICAgICAgICAgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9IC8+fSAvPlxuICAgICAgICAgIDxSb3V0ZSBwYXRoPVwiL2NvdXJzZXMvY3JlYXRlLWZyb20tdGVtcGxhdGUvOnRlbXBsYXRlSWRcIiByZW5kZXI9eyh7bWF0Y2h9KSA9PiA8RWRpdENvdXJzZVxuICAgICAgICAgICAgdGVtcGxhdGVJZD17bWF0Y2gucGFyYW1zLnRlbXBsYXRlSWR9XG4gICAgICAgICAgICB2aWV3PVwiY291cnNlQnVpbGRlclwiXG4gICAgICAgICAgICB2aWV3Q291cnNlVXJsPXt0aGlzLnByb3BzLnZpZXdDb3Vyc2VVcmx9XG4gICAgICAgICAgICBmZWVkYmFja1VybD17dGhpcy5wcm9wcy5mZWVkYmFja1VybH1cbiAgICAgICAgICAvPn0vPlxuICAgICAgICAgIDxSb3V0ZSBwYXRoPVwiL2NvdXJzZXMvOmlkL2VkaXRcIiByZW5kZXI9eyh7bWF0Y2h9KSA9PiA8RWRpdENvdXJzZVxuICAgICAgICAgICAgaWQ9e21hdGNoLnBhcmFtcy5pZH1cbiAgICAgICAgICAgIHZpZXc9XCJjb3Vyc2VCdWlsZGVyXCJcbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cbiAgICAgICAgICAgIGZlZWRiYWNrVXJsPXt0aGlzLnByb3BzLmZlZWRiYWNrVXJsfVxuICAgICAgICAgIC8+fSAvPlxuICAgICAgICA8L2Rpdj4gOiA8ZGl2PlxuICAgICAgICAgICAgPFJvdXRlIHBhdGg9XCIvXCIgcmVuZGVyPXsoKSA9PiA8ZGl2PlxuICAgICAgICAgICAgICA8Q291cnNlQmFubmVyIHRpdGxlPVwiS3Vyc2J5Z2dhcmVuXCIgYWN0aXZlUGFnZT1cImNvdXJzZUJ1aWxkZXJcIiByb3V0ZXM9e3tmZWVkYmFjazogdGhpcy5wcm9wcy5mZWVkYmFja1VybH19IC8+XG4gICAgICAgICAgICAgIDxoMj5CZWjDtnJpZ2hldCBzYWtuYXM8L2gyPlxuICAgICAgICAgICAgICA8cD5EZXR0YSB2ZXJrdHlnIMOkciBlbmRhc3QgdGlsbCBmw7ZyIGFuc3TDpGxsZGEgcMOlIEt1bnNrYXBzc2tvbGFuLjwvcD5cbiAgICAgICAgICAgICAgPGgzPkFudsOkbmRhcmF0dHJpYnV0PC9oMz5cbiAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiIHN0eWxlPXt7Ym9yZGVyOiBcIjFweCBzb2xpZCAjZWVlXCJ9fT5cbiAgICAgICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgICAgICA8dHI+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5BdHRyaWJ1dDwvdGg+XG4gICAgICAgICAgICAgICAgICAgIDx0aD5Ww6RyZGU8L3RoPlxuICAgICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICA8L3RoZWFkPlxuICAgICAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAgICAgIHtPYmplY3Qua2V5cyhlbnYuY3VycmVudFVzZXIpLm1hcChhdHRyID0+IDx0ciBrZXk9e2F0dHJ9PlxuICAgICAgICAgICAgICAgICAgICA8dGQ+e2F0dHJ9PC90ZD5cbiAgICAgICAgICAgICAgICAgICAgPHRkPntlbnYuY3VycmVudFVzZXJbYXR0cl19PC90ZD5cbiAgICAgICAgICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgICAgICAgICA8L3Rib2R5PjwvdGFibGU+XG4gICAgICAgICAgICA8L2Rpdj59IC8+XG4gICAgICAgICAgPC9kaXY+fVxuICAgICAgPC9Sb3V0ZXI+XG4gICAgICA8RXJyb3JTdWNjZXNzRmVlZGJhY2sgLz5cbiAgICA8L2Rpdj5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IFNjaG9vbENvdXJzZXMgfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9zY2hvb2wtY291cnNlcyc7XG5pbXBvcnQgeyBSZXNvdXJjZSB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IGR0Rm9ybWF0IH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IHsgRGlhbG9nIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3QnO1xuaW1wb3J0IHZhbGlkVXJsIGZyb20gJ3ZhbGlkLXVybCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHJlc291cmNlPzogUmVzb3VyY2U7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIG9uU2F2ZTogKG5ld1Jlc291cmNlOiBSZXNvdXJjZSkgPT4gdm9pZDtcbiAgb25EZWxldGU/OiAoKT0+dm9pZDtcbn1cblxudHlwZSBTdGF0ZSA9IFJlc291cmNlO1xuXG5leHBvcnQgY2xhc3MgRWRpdFJlc291cmNlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiBpbXBsZW1lbnRzIERpYWxvZyB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0gdGhpcy5wcm9wcy5yZXNvdXJjZSB8fCB7bmFtZTogJycsIHVybDogJyd9O1xuICB9XG5cbiAgc2F2ZSgpIHtcbiAgICBjb25zdCByZXNvdXJjZSA9IHRoaXMuc3RhdGU7XG4gICAgaWYgKCF2YWxpZFVybC5pc1VyaShyZXNvdXJjZS51cmwpKSB0aHJvdyBuZXcgRXJyb3IoTGBBbmdpdmVuIFVSTCAnJHtyZXNvdXJjZS51cmx9JyDDpHIgb2dpbHRpZy4gU2thIGLDtnJqYSBtZWQgZXhlbXBlbHZpcyBodHRwOiwgaHR0cHM6IGVsbGVyIG1haWx0bzpgKTtcbiAgICB0aGlzLnByb3BzLm9uU2F2ZShyZXNvdXJjZSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge3RpdGxlLCBvblNhdmUsIG9uRGVsZXRlfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgcmVzb3VyY2UgPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IGlzVmFsaWRVcmwgPSB2YWxpZFVybC5pc1VyaSh0aGlzLnN0YXRlLnVybCk7XG5cbiAgICByZXR1cm4gPGRpdj48ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICA8aDI+e3RpdGxlfTwvaDI+XG4gICAgICA8aHIgLz5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPk5hbW46PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzXG4gICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgIHNpemU9ezUwfVxuICAgICAgICAgICAgdmFsdWU9e3Jlc291cmNlLm5hbWV9XG4gICAgICAgICAgICBvbkNoYW5nZT17ZXY9PnRoaXMuc2V0U3RhdGUoe25hbWU6IGV2LnRhcmdldC52YWx1ZX0pfSAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPkzDpG5rOjwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBcIj5cbiAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgdGFiSW5kZXg9ezF9XG4gICAgICAgICAgICBzaXplPXs1MH1cbiAgICAgICAgICAgIHZhbHVlPXtyZXNvdXJjZS51cmx9XG4gICAgICAgICAgICBvbkNoYW5nZT17ZXY9PnRoaXMuc2V0U3RhdGUoe3VybDogZXYudGFyZ2V0LnZhbHVlfSl9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBzcGFjZWRcIj48L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGJyIC8+PC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XG4gICAgICAgIHsocmVzb3VyY2UuY3JlYXRlZERhdGUgfHwgcmVzb3VyY2UubW9kaWZpZWREYXRlKSAmJiA8ZGl2PlxuICAgICAgICAgIHtyZXNvdXJjZS5jcmVhdGVkRGF0ZSAmJiA8cD5cbiAgICAgICAgICAgIFJlc3Vyc2VuL0zDpG5rZW4gc2thcGFkZXMge2R0Rm9ybWF0KHJlc291cmNlLmNyZWF0ZWREYXRlKX0gYXYgPHN0cm9uZz57cmVzb3VyY2UuY3JlYXRlZEJ5Lm5hbWV9PC9zdHJvbmc+LlxuICAgICAgICAgIDwvcD59XG4gICAgICAgICAge3Jlc291cmNlLm1vZGlmaWVkRGF0ZSAmJiA8cD5cbiAgICAgICAgICAgIFJlc3Vyc2VuL0zDpG5rZW4gcmVkaWdlcmFkZXMgc2VuYXN0IHtkdEZvcm1hdChyZXNvdXJjZS5tb2RpZmllZERhdGUpfSBhdiA8c3Ryb25nPntyZXNvdXJjZS5tb2RpZmllZEJ5Lm5hbWV9PC9zdHJvbmc+LlxuICAgICAgICAgIDwvcD59XG4gICAgICAgICAgPGJyIC8+PGJyLz5cbiAgICAgICAgPC9kaXY+fVxuICAgICAgICB7b25EZWxldGUgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCk9Pm9uRGVsZXRlKCl9PlxuICAgICAgICAgIFRhIGJvcnQgcmVzdXJzL2zDpG5rXG4gICAgICAgIDwvZGl2Pn1cbiAgICAgICAgPGEgdGFiSW5kZXg9ezF9IGNsYXNzTmFtZT17XCJidG4gYnRuLWxhcmdlXCIgKyAoaXNWYWxpZFVybCA/IFwiXCIgOiBcIiBidG4taW5hY3RpdmVcIil9IG9uQ2xpY2s9e2lzVmFsaWRVcmwgJiYgKCgpID0+IG9uU2F2ZShyZXNvdXJjZSkpfT5TcGFyYTwvYT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgeyBUYXNrLCBDb3Vyc2UgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcbmltcG9ydCB7IEZlYXR1cmVzIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2ZlYXR1cmVzXCI7XG5pbXBvcnQgeyBFZGl0VGFzayB9IGZyb20gXCIuL2VkaXQtdGFza1wiO1xuaW1wb3J0IFJlYWN0RGF0ZVBpY2tlciBmcm9tIFwicmVhY3QtZGF0ZXBpY2tlclwiO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtUYXNrTWlncmF0aW9uQm94fSBmcm9tIFwiLi90YXNrLW1pZ3JhdGlvbi1ib3hcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdGFzazogVGFzaztcbiAgY291cnNlOiBDb3Vyc2U7XG4gIHdyaXRlQWNjZXNzOiBib29sZWFuO1xuICBmZWF0dXJlczogRmVhdHVyZXM7XG4gIGVkaXRUYXNrOiBFZGl0VGFzaztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEJhc2ljRWRpdGFibGVUYXNrRmllbGRzKHtcbiAgdGFzayxcbiAgY291cnNlLFxuICB3cml0ZUFjY2VzcyxcbiAgZmVhdHVyZXMsXG4gIGVkaXRUYXNrXG59OiBQcm9wcykge1xuICByZXR1cm4gPGRpdj5cbiAgICA8aDI+VXBwZ2lmdGVucyBuYW1uIG9jaCBsw6RuazwvaDI+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgPHA+VXBwZ2lmdGVucyBuYW1uOjwvcD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgPGlucHV0IGF1dG9Gb2N1cyB0eXBlPVwidGV4dFwiIHNpemU9ezM1fSB2YWx1ZT17dGFzay5uYW1lfSBkaXNhYmxlZD17IXdyaXRlQWNjZXNzfSByZWFkT25seT17IXdyaXRlQWNjZXNzfSBvbkNoYW5nZT17ZXYgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcbiAgICAgICAgICBuZXdUYXNrLm5hbWUgPSBldi50YXJnZXQudmFsdWU7XG4gICAgICAgICAgZWRpdFRhc2suc2V0U3RhdGVQcm9taXNlZCh7IHRhc2s6IG5ld1Rhc2sgfSk7XG4gICAgICAgIH0gfSAvPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsIHNwYWNlZFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgPHA+VVJMOjwvcD5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wiaG9yaXpvbnRhbEl0ZW0gdG9wXCJ9PlxuICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBzaXplPXszNX0gdmFsdWU9e3Rhc2sudXJsfSBkaXNhYmxlZD17IXdyaXRlQWNjZXNzfSByZWFkT25seT17IXdyaXRlQWNjZXNzfSBvbkNoYW5nZT17ZXYgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcbiAgICAgICAgICBuZXdUYXNrLnVybCA9IGV2LnRhcmdldC52YWx1ZTtcbiAgICAgICAgICBlZGl0VGFzay5zZXRTdGF0ZVByb21pc2VkKHsgdGFzazogbmV3VGFzayB9KTtcbiAgICAgICAgfSB9IC8+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICB7dGFzay5taWdyYXRlZFRleHRzICYmIHdyaXRlQWNjZXNzICYmIDxUYXNrTWlncmF0aW9uQm94IHRhc2s9e3Rhc2t9IGNvdXJzZT17Y291cnNlfSB1cGRhdGVMaW5rPXsoaWQsIGxpbmtPclVubGluaykgPT4gZWRpdFRhc2sudXBkYXRlTGluayhpZCwgbGlua09yVW5saW5rKX0gLz59XG4gICAgPD48aDI+SW5sw6RtbmluZ3N1cHBnaWZ0PC9oMj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtcImNoZWNrQm94XCIgKyAoZWRpdFRhc2suZ2V0VGFza1Byb3AoXCJhc3NpZ25tZW50XCIpID8gXCIgY2hlY2tlZFwiIDogXCJcIil9IG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgIGVkaXRUYXNrLnVwZGF0ZVRhc2tPckN1c3RvbWl6YXRpb24oXCJhc3NpZ25tZW50XCIsIHsgJHNldDogIWVkaXRUYXNrLmdldFRhc2tQcm9wKFwiYXNzaWdubWVudFwiKSB9KTtcbiAgICAgICAgICB9IH0gLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgPHA+RGVuIGjDpHIgdXBwZ2lmdGVuIMOkciBlbiBpbmzDpG1uaW5nc3VwcGdpZnQ8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICB7ZWRpdFRhc2suZ2V0VGFza1Byb3AoXCJhc3NpZ25tZW50XCIpICYmIDw+XG4gICAgICAgIDxwPklubMOkbW5pbmdzZGF0dW08L3A+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICA8UmVhY3REYXRlUGlja2VyIHNlbGVjdGVkPXtlZGl0VGFzay5nZXRUYXNrUHJvcChcImRlYWRsaW5lXCIpICYmIG1vbWVudChlZGl0VGFzay5nZXRUYXNrUHJvcChcImRlYWRsaW5lXCIpKX0gZGF0ZUZvcm1hdD1cIllZWVktTU0tRERcIiBsb2NhbGU9e1wic3ZcIn0gcG9wcGVyUGxhY2VtZW50PVwiYm90dG9tLXN0YXJ0XCIgb25DaGFuZ2U9e3ZhbHVlID0+IHtcbiAgICAgICAgICAgICAgZWRpdFRhc2sudXBkYXRlVGFza09yQ3VzdG9taXphdGlvbihcImRlYWRsaW5lXCIsIHsgJHNldDogdmFsdWUuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKSB9KTtcbiAgICAgICAgICAgIH0gfSAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICB7ZWRpdFRhc2suZ2V0VGFza1Byb3AoXCJkZWFkbGluZVwiKSAmJiA8YSBjbGFzc05hbWU9XCJkZWxldGVEYXRlXCIgaHJlZj1cIiNcIiB0aXRsZT1cIlRhIGJvcnQgaW5sw6RtbmluZ3NkYXR1bVwiIG9uQ2xpY2s9e2V2ID0+IHtcbiAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZWRpdFRhc2sudXBkYXRlVGFza09yQ3VzdG9taXphdGlvbihcImRlYWRsaW5lXCIsIHsgJHNldDogbnVsbCB9KTtcbiAgICAgICAgICAgIH0gfT48L2E+fVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvPn1cbiAgICA8Lz5cbiAgPC9kaXY+O1xufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIEFiaWxpdHksIFRhc2ssIERvY3VtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB7IEtub3dsZWRnZU1hdHJpeCB9IGZyb20gJy4uLy4uL3N1Yi1jb21wb25lbnRzL2tub3dsZWRnZS1tYXRyaXgnO1xuaW1wb3J0IHVwZGF0ZSBmcm9tICdyZWFjdC1hZGRvbnMtdXBkYXRlJztcbmltcG9ydCB7IERpYWxvZywgSUNvdXJzZUVkaXRvckhvc3QgfSBmcm9tIFwiLi4vLi4vaW50ZXJmYWNlcy9jb3Vyc2UtZWRpdG9yLWhvc3RcIjtcbmltcG9ydCB7IGhhc1dyaXRlQWNjZXNzIH0gZnJvbSAnLi4vLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xuaW1wb3J0IHsgU2VsZWN0UmVsYXRlZERvY3MgfSBmcm9tICcuLi8uLi9zdWItY29tcG9uZW50cy9zZWxlY3QtcmVsYXRlZC1kb2NzJztcbmltcG9ydCB2YWxpZFVybCBmcm9tICd2YWxpZC11cmwnO1xuaW1wb3J0IHsgTCwgc2hvd0Vycm9yIH0gZnJvbSBcIi4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzXCI7XG5pbXBvcnQgeyBDYWNoZWRSZXNwb25zZSB9IGZyb20gXCIuLi8uLi8uLi8uLi91dGlscy9jYWNoZWQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IEVkaXRhYmxlUmVzb3VyY2VMaXN0IH0gZnJvbSBcIi4uLy4uL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXJlc291cmNlLWxpc3RcIjtcbmltcG9ydCB7IGR0Rm9ybWF0LCBzaG9ydERhdGVGb3JtYXQsIHNob3J0UGVyc29uTmFtZUZvcm1hdCB9IGZyb20gXCIuLi8uLi91dGlsc1wiO1xuaW1wb3J0IHsgZnV0dXJlQWJpbGl0aWVzIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uLy4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcbmltcG9ydCB7IFd5c2l3eWcgfSBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zyc7XG5pbXBvcnQgYWN0aW9uc19zd2VkaXNoIGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy93eXNpd3lnL2FjdGlvbnMtc3YnO1xuaW1wb3J0IFJlYWN0RGF0ZVBpY2tlciBmcm9tICdyZWFjdC1kYXRlcGlja2VyJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IEZlYXR1cmVzIH0gZnJvbSAnLi4vLi4vLi4vLi4vZmVhdHVyZXMnO1xuaW1wb3J0IHsgU2VhcmNoUmVzdWx0cyB9IGZyb20gJy4vc2VhcmNoLXJlc3VsdHMnO1xuaW1wb3J0IHsgQmFzaWNFZGl0YWJsZVRhc2tGaWVsZHMgfSBmcm9tICcuL2Jhc2ljLWVkaXRhYmxlLXRhc2stZmllbGRzJztcbmltcG9ydCB7IFRhc2tTdGF0dXNGcmFnbWVudCB9IGZyb20gJy4vdGFzay1zdGF0dXMtZnJhZ21lbnQnO1xuaW1wb3J0IHsgU2F2ZU9yQ2FuY2VsQnV0dG9ucyB9IGZyb20gJy4vc2F2ZS1vci1jYW5jZWwtYnV0dG9ucyc7XG5pbXBvcnQgeyBQcmV2aWV3YWJsZVRhc2tGaWVsZHMgfSBmcm9tICcuL3ByZXZpZXdhYmxlLXRhc2stZmllbGRzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgc2VhcmNoTW9kZT86IGJvb2xlYW47XG4gIHRhc2s/OiBUYXNrO1xuICB0YXNrQ3VzdG9taXphdGlvbj86IFBhcnRpYWw8VGFzaz47XG4gIG1vZHVsZTogQ291cnNlTW9kdWxlO1xuICBjb3Vyc2U6IENvdXJzZTtcbiAgaG9zdDogSUNvdXJzZUVkaXRvckhvc3Q7XG4gIGlkc05vdENvdmVyZWRCeUFueVRhc2s6IHsgW2lkOiBzdHJpbmddOiB0cnVlIH07XG4gIG9uU2F2ZTogKHRhc2s6IFRhc2ssIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+KSA9PiBQcm9taXNlPGFueT47XG4gIG9uU2F2ZUN1c3RvbWl6YXRpb246ICh0YXNrQ3VzdG9taXphdGlvbjogUGFydGlhbDxUYXNrPikgPT4gUHJvbWlzZTxhbnk+O1xuICBvblJlcGxhY2U6ICh0YXNrSWQ6IHN0cmluZywgdGFzazogVGFzaykgPT4gUHJvbWlzZTxhbnk+O1xuICBvbkNhbmNlbDogKCkgPT4gdm9pZDtcbiAgb25EZWxldGU6ICgpID0+IHZvaWQ7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIHRhc2s6IFRhc2s7XG4gIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+XG4gIGZ1dHVyZUFiaWxpdGllc09wZW46IGJvb2xlYW47XG4gIHNlYXJjaFJlc3VsdD86IFRhc2tbXTtcbiAgc2VhcmNoTWFya2VkSWRzPzogc3RyaW5nW107XG4gIGlzU2VhcmNoaW5nOiBib29sZWFuO1xuICBwcmV2aWV3VGFza0NvbnRlbnQ/OiBzdHJpbmc7IC8vIFRPRE86IFJlbW92ZSB0aGlzIHN0YXRlLiBQcmV2aWV3aW5nIGNvbnRlbnQgaXMgbm93IGVxdWl2YWxlbnQgdG8gY2hlY2tpbmcgYSBjaGVja2JveC5cbn1cblxuZXhwb3J0IGNsYXNzIEVkaXRUYXNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4gaW1wbGVtZW50cyBEaWFsb2cge1xuICBzZWFyY2hSZXNwb25zZT86IENhY2hlZFJlc3BvbnNlPFRhc2tbXT47XG4gIGRpYWxvZ0VsZW06IEhUTUxEaXZFbGVtZW50O1xuICBmZWF0dXJlcyA9IG5ldyBGZWF0dXJlcygpO1xuXG4gIHNldFN0YXRlUHJvbWlzZWQoc3RhdGU6IFBhcnRpYWw8U3RhdGU+KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3VwZXIuc2V0U3RhdGUoKCkgPT4gc3RhdGUgYXMgU3RhdGUsIHJlc29sdmUpKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICBjb25zdCB3cml0ZUFjY2VzcyA9ICFwcm9wcy50YXNrIHx8IGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgcHJvcHMudGFzayk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHRpdGxlOiBwcm9wcy50YXNrID9cbiAgICAgICAgd3JpdGVBY2Nlc3MgP1xuICAgICAgICAgIExgUmVkaWdlcmEgdXBwZ2lmdCB0aWxsIFwiJHtwcm9wcy5tb2R1bGUubmFtZX1cImAgOlxuICAgICAgICAgIExgVmlzYSB1cHBnaWZ0IHRpbGwgXCIke3Byb3BzLm1vZHVsZS5uYW1lfVwiYCA6XG4gICAgICAgIHByb3BzLnNlYXJjaE1vZGUgP1xuICAgICAgICAgIExgU8O2ayBueSB1cHBnaWZ0IHRpbGwgXCIke3Byb3BzLm1vZHVsZS5uYW1lfVwiYCA6XG4gICAgICAgICAgTGBMw6RnZyB0aWxsIGVnZW4gdXBwZ2lmdCB0aWxsIFwiJHtwcm9wcy5tb2R1bGUubmFtZX1cImAsXG4gICAgICBmdXR1cmVBYmlsaXRpZXNPcGVuOiBmYWxzZSxcbiAgICAgIHRhc2tDdXN0b21pemF0aW9uOiBwcm9wcy50YXNrQ3VzdG9taXphdGlvbiB8fCB7fSxcbiAgICAgIHRhc2s6IHByb3BzLnRhc2sgP1xuICAgICAgICAvLyBBIHRhc2sgd2FzIGdpdmVuLiBDbG9uZSBpdCBhbmQgYWRkICRtZXRhOiAndXBkYXRlJyB0byBpdFxuICAgICAgICAvLyB0byBpbmZvcm0gRWRpdENvdXJzZS5zYXZlKCkgdG8gdXBkYXRlIGl0IG9uIGl0cyBvd24gZW50aXR5LlxuICAgICAgICB7XG4gICAgICAgICAgJG1ldGE6IHByb3BzLnRhc2suJG1ldGEgfHwgJ3VwZGF0ZScsXG4gICAgICAgICAgLi4ucHJvcHMudGFza1xuICAgICAgICB9IDogcHJvcHMuc2VhcmNoTW9kZSA/IG51bGwgOlxuICAgICAgICAgIC8vIE5vIHRhc2sgd2FzIGdpdmVuLiBTZXQgJG1ldGEgPSAnYWRkJyB0byBpbmZvcm0gRWRpdENvdXJzZS5zYXZlKClcbiAgICAgICAgICAvLyB0byBhZGQgdGhlIHRhc2sgdG8gdGhlIHRhc2tzIHRhYmxlLlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgICAgICAkbWV0YTogJ2FkZCcsXG4gICAgICAgICAgICB0YWdzOiBbXG4gICAgICAgICAgICAgIGBzdWI6JHtwcm9wcy5jb3Vyc2Uuc3ViamVjdENvZGV9YCxcbiAgICAgICAgICAgICAgYGNvdXJzZToke3Byb3BzLmNvdXJzZS5jb2RlfWBcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBzY2hvb2w6ICFwcm9wcy5jb3Vyc2UuaXNUZW1wbGF0ZSAmJiBlbnYuY3VycmVudFVzZXIuc2Nob29sLFxuICAgICAgICAgICAgcmVzb3VyY2VzOiBbXSxcbiAgICAgICAgICAgIGFiaWxpdGllczogW10sXG4gICAgICAgICAgICBjZW50cmFsQ29udGVudDogW10sXG4gICAgICAgICAgICBmdXR1cmVBYmlsaXRpZXM6IFtdLFxuICAgICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiBbXSxcbiAgICAgICAgICAgIG5hbWU6IFwiXCIsXG4gICAgICAgICAgICB1cmw6IFwiXCIsXG4gICAgICAgICAgICBhY2w6IHByb3BzLmNvdXJzZS5pc1RlbXBsYXRlID8gW1xuICAgICAgICAgICAgICBgcm9sZTpVU0VSOlJgLy8gKE9LIHRvIGtlZXAgYWZ0ZXIga3Vyc2J5Z2ctY2hhbmdlcykuIFRlbXBsYXRlcyAod2hpY2ggd2lsbCBiZSBlbXB0eSEpIHdpbGwgbm90IGhhdmUgdGFza3MuIElmIHRoZXkgaGFkLCBtaWdodCBub3QgdGFza3Mgc2hvdWxkIG5vdCBiZSBwb3NzaWJsZSB0byBtb2RpZnkuIChBbiBBRE1JTiBjb3VsZCBiZWxvbmcgdG8gYSBzY2hvb2whIE90aGVyIG5vbi1hZG1pbnMgYXQgdGhhdCBzY2hvb2wgc2hvdWxkIG5vdCBiZSBhYmxlIHRvIGVkaXQgaXQpXG4gICAgICAgICAgICBdIDogW1xuICAgICAgICAgICAgICAgIGByb2xlOlVTRVI6UmAsXG4gICAgICAgICAgICAgICAgYHNjaG9vbFJvbGU6JHtlbnYuY3VycmVudFVzZXIuc2Nob29sfS9FTVBMT1lFRTpTYFxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgfSxcbiAgICAgIHNlYXJjaE1hcmtlZElkczogcHJvcHMuc2VhcmNoTW9kZSAmJiBbXSxcbiAgICAgIHNlYXJjaFJlc3VsdDogcHJvcHMuc2VhcmNoTW9kZSAmJiBbXSxcbiAgICAgIGlzU2VhcmNoaW5nOiBwcm9wcy5zZWFyY2hNb2RlXG4gICAgfTtcbiAgICBpZiAocHJvcHMuc2VhcmNoTW9kZSkge1xuICAgICAgdGhpcy5zZWFyY2hSZXNwb25zZSA9IG5ldyBDYWNoZWRSZXNwb25zZSgoKSA9PlxuICAgICAgICBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xuICAgICAgICAgIHRhZ3M6IGBjb3Vyc2U6JHtwcm9wcy5jb3Vyc2UuY29kZX1gLFxuICAgICAgICAgIGluY2x1ZGU6IFsna25vd2xlZGdlUmVxdWlyZW1lbnRzJywgJ2FiaWxpdGllcycsICdjZW50cmFsQ29udGVudCddLFxuICAgICAgICAgIGZsYWdzOiBbJ2luY2x1ZGVJZHNPbmx5J11cbiAgICAgICAgfSkpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGlmICh0aGlzLnByb3BzLnNlYXJjaE1vZGUpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7IGlzU2VhcmNoaW5nOiB0cnVlIH0pO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5zZWFyY2hSZXNwb25zZS5xdWVyeSgpO1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5zZWFyY2hNYXJrZWRJZHMgJiYgdGhpcy5zdGF0ZS5zZWFyY2hNYXJrZWRJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZWFyY2hSZXN1bHQodGhpcy5zdGF0ZS5zZWFyY2hNYXJrZWRJZHMpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgc2hvd0Vycm9yKGVycik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBhd2FpdCB0aGlzLnNldFN0YXRlUHJvbWlzZWQoeyBpc1NlYXJjaGluZzogZmFsc2UgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlU2VhcmNoTWFya2VkSWRzKHNlYXJjaE1hcmtlZElkczogc3RyaW5nW10pIHtcbiAgICBjb25zdCBzZXRTdGF0ZVByb21pc2UgPSB0aGlzLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiBudWxsLCBzZWFyY2hNYXJrZWRJZHMsIHByZXZpZXdUYXNrQ29udGVudDogbnVsbCB9KTtcbiAgICBpZiAoIXRoaXMuc2VhcmNoUmVzcG9uc2UucmVzdWx0KSB7XG4gICAgICBhd2FpdCB0aGlzLnNlYXJjaFJlc3BvbnNlLnByb21pc2U7XG4gICAgICAvLyBSZWZyZXNoIHNlYXJjaE1hcmtlZElkcyBub3cgYXMgdXNlciBtaWdodCBoYXZlIGNsaWNrZWQgYXJvdW5kIHdoaWxlIHdhaXRpbmcgZm9yXG4gICAgICAvLyB0YXNrcyB0byBsb2FkLi4uXG4gICAgICBhd2FpdCBzZXRTdGF0ZVByb21pc2U7IC8vIFNvIHdlIGtub3cgc3RhdGUgaGFzIGJlZW4gcmVmbGVjdGVkLi4uXG4gICAgICBzZWFyY2hNYXJrZWRJZHMgPSB0aGlzLnN0YXRlLnNlYXJjaE1hcmtlZElkcztcbiAgICB9XG4gICAgYXdhaXQgdGhpcy51cGRhdGVTZWFyY2hSZXN1bHQoc2VhcmNoTWFya2VkSWRzKTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVNlYXJjaFJlc3VsdChzZWFyY2hNYXJrZWRJZHM6IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgYWxsVGFza3NGb3JTdWJqZWN0ID0gYXdhaXQgdGhpcy5zZWFyY2hSZXNwb25zZS5xdWVyeSgpO1xuXG4gICAgY29uc3Qgc2VhcmNoUmVzdWx0ID0gYWxsVGFza3NGb3JTdWJqZWN0LmZpbHRlcih0ID0+XG4gICAgICBzZWFyY2hNYXJrZWRJZHMuZXZlcnkoaWQgPT5cbiAgICAgICAgdC5rbm93bGVkZ2VSZXF1aXJlbWVudHMuc29tZShrciA9PiBrci5pZCA9PT0gaWQpIHx8XG4gICAgICAgIHQuYWJpbGl0aWVzLnNvbWUoYSA9PiBhLmlkID09PSBpZCkgfHxcbiAgICAgICAgdC5jZW50cmFsQ29udGVudC5zb21lKGMgPT4gYy5pZCA9PT0gaWQpKSk7XG5cbiAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoe1xuICAgICAgc2VhcmNoUmVzdWx0XG4gICAgfSk7XG4gIH1cblxuICBvbk1hcmtDaGFuZ2VkKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSB7XG4gICAgY29uc3QgeyBzZWFyY2hNb2RlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmIChzZWFyY2hNb2RlKSB7XG4gICAgICBjb25zdCB7IHNlYXJjaE1hcmtlZElkcyB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoTWFya2VkSWRzKGlzTWFya2VkID9cbiAgICAgICAgc2VhcmNoTWFya2VkSWRzLmNvbmNhdChpZCkgOlxuICAgICAgICBzZWFyY2hNYXJrZWRJZHMuZmlsdGVyKHggPT4geCAhPT0gaWQpKS5jYXRjaChzaG93RXJyb3IpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZUxpbmsoaWQsIGlzTWFya2VkKTtcbiAgfVxuXG4gIHVwZGF0ZUxpbmsoaWQ6IHN0cmluZywgbGlua09yVW5saW5rOiBib29sZWFuKSB7XG4gICAgY29uc3QgeyBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyB0YXNrIH0gPSB0aGlzLnN0YXRlO1xuICAgIC8vIE9uZSBvZiB0aGUgZm9sbG93aW5nIHRocmVlIHdpbGwgYmUgZm91bmQ6XG4gICAgY29uc3QgYWJpbGl0eSA9IGNvdXJzZS5hYmlsaXRpZXMuZmluZChhID0+IGEuaWQgPT09IGlkKTtcbiAgICBjb25zdCBrbm93bGVkZ2VSZXF1aXJlbWVudCA9IGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZChyID0+IHIuaWQgPT09IGlkKTtcbiAgICBjb25zdCBjZW50cmFsQ29udGVudCA9IGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09PSBpZCk7XG5cbiAgICBjb25zdCBbY29sbGVjdGlvblByb3AsIGl0ZW1dID1cbiAgICAgIGFiaWxpdHkgP1xuICAgICAgICBbXCJhYmlsaXRpZXNcIiwgYWJpbGl0eV0gOlxuICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudCA/XG4gICAgICAgICAgW1wia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsIGtub3dsZWRnZVJlcXVpcmVtZW50XSA6XG4gICAgICAgICAgY2VudHJhbENvbnRlbnQgP1xuICAgICAgICAgICAgW1wiY2VudHJhbENvbnRlbnRcIiwgY2VudHJhbENvbnRlbnRdIDpcbiAgICAgICAgICAgIFtudWxsLCBudWxsXTtcblxuICAgIGlmICghY29sbGVjdGlvblByb3ApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZmluZCBtYXJrZWQgaWQgXCIgKyBpZCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgdXBkYXRlZENvbGxlY3Rpb246IERvY3VtZW50W10gPSB0YXNrW2NvbGxlY3Rpb25Qcm9wXS5zbGljZSgpO1xuICAgIGNvbnN0IGN1cnJlbnRQb3MgPSB1cGRhdGVkQ29sbGVjdGlvbi5maW5kSW5kZXgoZG9jID0+IGRvYy5pZCA9PT0gaWQpO1xuICAgIGlmIChsaW5rT3JVbmxpbmspIHtcbiAgICAgIGlmIChjdXJyZW50UG9zIDwgMCkge1xuICAgICAgICB1cGRhdGVkQ29sbGVjdGlvbi5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY3VycmVudFBvcyA+PSAwKSB7XG4gICAgICAgIHVwZGF0ZWRDb2xsZWN0aW9uLnNwbGljZShjdXJyZW50UG9zLCAxKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVkVGFzayA9IHsgLi4udGFzayB9O1xuICAgIHVwZGF0ZWRUYXNrW2NvbGxlY3Rpb25Qcm9wXSA9IHVwZGF0ZWRDb2xsZWN0aW9uO1xuXG4gICAgLy8gQ2xlYXIgbWlncmF0ZWRUZXh0cyBmcm9tIHRhc2suXG4gICAgLy8gRmlyc3QgZGVlcCBjbG9uZTpcbiAgICBpZiAodGFzayAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMpIHtcbiAgICAgIHVwZGF0ZWRUYXNrLm1pZ3JhdGVkVGV4dHMgPSB7Li4udGFzay5taWdyYXRlZFRleHRzfTtcbiAgICAgIGlmICh0YXNrLm1pZ3JhdGVkVGV4dHNbY29sbGVjdGlvblByb3BdKSB7XG4gICAgICAgIHVwZGF0ZWRUYXNrLm1pZ3JhdGVkVGV4dHNbY29sbGVjdGlvblByb3BdID0gey4uLnRhc2subWlncmF0ZWRUZXh0c1tjb2xsZWN0aW9uUHJvcF19O1xuICAgICAgICAvLyBEZWxldGUgdGhlIGlkIHdpdGhpbiB0aGUgZGVlcCBjbG9uZTpcbiAgICAgICAgZGVsZXRlIHVwZGF0ZWRUYXNrLm1pZ3JhdGVkVGV4dHNbY29sbGVjdGlvblByb3BdW2lkXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoe1xuICAgICAgdGFzazogdXBkYXRlZFRhc2tcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHNhdmUoKSB7XG4gICAgY29uc3QgeyB0YXNrLCB0YXNrQ3VzdG9taXphdGlvbiB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB3cml0ZUFjY2VzcyA9IGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgdGFzayk7XG4gICAgaWYgKHdyaXRlQWNjZXNzKSB7XG4gICAgICBpZiAoIXRhc2sudXJsICYmICF0YXNrLmNvbnRlbnQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihMYFVwcGdpZnRlbiBtw6VzdGUgYW50aW5nZW4gaGEgZW4gVVJMIGVsbGVyIGV0dCBpbm5laMOlbGxgKTtcbiAgICAgIGlmICh0YXNrLnVybCAmJiAhdmFsaWRVcmwuaXNVcmkodGFzay51cmwpKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTGBBbmdpdmVuIFVSTCAnJHt0YXNrLnVybH0nIMOkciBvZ2lsdGlnLiBEZW4gc2thIGLDtnJqYSBtZWQgaHR0cDogZWxsZXIgaHR0cHM6YCk7XG4gICAgICBpZiAodGhpcy5wcm9wcy50YXNrICYmIHRoaXMucHJvcHMudGFzay5pZCAhPT0gdGFzay5pZCkge1xuICAgICAgICAvLyBSZXBsYWNlIGV4aXN0aW5nIHRhc2sgd2l0aCBjb3B5XG4gICAgICAgIGF3YWl0IHRoaXMucHJvcHMub25SZXBsYWNlKHRoaXMucHJvcHMudGFzay5pZCwgdGFzayk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBVcGRhdGUgZXhpc3RpbmcgdGFza1xuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLm9uU2F2ZSh0YXNrLCBudWxsKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRoaXMucHJvcHMuc2VhcmNoTW9kZSkge1xuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5vblNhdmUodGFzaywgdGFza0N1c3RvbWl6YXRpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5wcm9wcy5jb3Vyc2UuaXNUZW1wbGF0ZSAmJiB0YXNrLiRtZXRhID09PSAnYWRkJylcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKExgRHUgc2FrbmFyIGJlaMO2cmlnaGV0IGbDtnIgYXR0IHNwYXJhIG55YSB2ZXJzaW9uZXIgYXYgdXBwZ2lmdGVyIGkga3Vyc21hbGxlbmApO1xuXG4gICAgICBhd2FpdCB0aGlzLnByb3BzLm9uU2F2ZUN1c3RvbWl6YXRpb24odGFza0N1c3RvbWl6YXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNvcHlUYXNrKCkge1xuICAgIGNvbnN0IHRhc2tDb3B5ID0ge1xuICAgICAgLi4udGhpcy5zdGF0ZS50YXNrLFxuICAgICAgLi4uKHRoaXMuc3RhdGUudGFza0N1c3RvbWl6YXRpb24gfHwge30pLFxuICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgIGFjbDogdGhpcy5wcm9wcy5jb3Vyc2UuaXNUZW1wbGF0ZSA/IFtcbiAgICAgICAgYHJvbGU6VVNFUjpSYCAvLyAoT0sgdG8ga2VlcCBidXQgdGhpcyBjaGVjayBtaWdodCBiZWNvbWUgdW5uZXNjZXNhcnkgaWYgd2UgdG90YWxseSByZW1vdmUgdGhlIHBvc3NpYmlsaXR5IHRvIGVkaXQgdGVtcGxhdGVzKSBUZW1wbGF0ZSB0YXNrcyBzaG91bGQgbm90IGJlIHBvc3NpYmxlIHRvIG1vZGlmeS4gKEFuIEFETUlOIGNvdWxkIGJlbG9uZyB0byBhIHNjaG9vbCEgT3RoZXIgbm9uLWFkbWlucyBhdCB0aGF0IHNjaG9vbCBzaG91bGQgbm90IGJlIGFibGUgdG8gZWRpdCBpdClcbiAgICAgIF0gOiBbXG4gICAgICAgIGByb2xlOlVTRVI6UmAsXG4gICAgICAgIGBzY2hvb2xSb2xlOiR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUU6U2BcbiAgICAgIF0sXG4gICAgICBzY2hvb2w6IHRoaXMucHJvcHMuY291cnNlLnNjaG9vbFxuICAgIH07XG4gICAgdGFza0NvcHkuJG1ldGEgPSAnYWRkJztcblxuICAgIGF3YWl0IHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7XG4gICAgICB0YXNrOiB0YXNrQ29weSxcbiAgICAgIHRpdGxlOiBMYFJlZGlnZXJhIGtvcGllcmFkIHVwcGdpZnQgdGlsbCBcIiR7dGhpcy5wcm9wcy5tb2R1bGUubmFtZX1cImAsXG4gICAgICB0YXNrQ3VzdG9taXphdGlvbjogdW5kZWZpbmVkXG4gICAgfSk7XG4gIH1cblxuICBnZXRUYXNrUHJvcDxUIGV4dGVuZHMga2V5b2YgVGFzaz4odGFza1Byb3A6IFQpIDogVGFza1tUXSB7XG4gICAgY29uc3Qge3Rhc2ssIHRhc2tDdXN0b21pemF0aW9ufSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgY3VzdG9taXphdGlvbiA9IHRhc2tDdXN0b21pemF0aW9uICYmIHRhc2tDdXN0b21pemF0aW9uW3Rhc2tQcm9wXTtcbiAgICByZXR1cm4gY3VzdG9taXphdGlvbiAhPT0gdW5kZWZpbmVkID9cbiAgICAgIGN1c3RvbWl6YXRpb24gOlxuICAgICAgdGFza1t0YXNrUHJvcF07XG4gIH1cblxuICB1cGRhdGVUYXNrT3JDdXN0b21pemF0aW9uICh0YXNrUHJvcDoga2V5b2YgVGFzaywgdXBkYXRlcykge1xuICAgIGNvbnN0IHt0YXNrLCB0YXNrQ3VzdG9taXphdGlvbn0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHdyaXRlQWNjZXNzID0gdGFzayAmJiBoYXNXcml0ZUFjY2VzcyhlbnYuY3VycmVudFVzZXIsIHRhc2spO1xuICAgIGlmICh3cml0ZUFjY2VzcyAmJiAoIXRhc2tDdXN0b21pemF0aW9uIHx8IHRhc2tDdXN0b21pemF0aW9uW3Rhc2tQcm9wXSA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgY29uc3QgbmV3VGFzayA9IHsuLi50YXNrfTtcbiAgICAgIG5ld1Rhc2tbdGFza1Byb3BdID0gdXBkYXRlKHRhc2tbdGFza1Byb3BdLCB1cGRhdGVzKTtcbiAgICAgIHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7dGFzazogbmV3VGFza30pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBuZXdDdXN0b21pemF0aW9uID0gey4uLnRhc2tDdXN0b21pemF0aW9ufTtcbiAgICAgIG5ld0N1c3RvbWl6YXRpb25bdGFza1Byb3BdID0gdXBkYXRlIChcbiAgICAgICAgbmV3Q3VzdG9taXphdGlvblt0YXNrUHJvcF0gfHwgdGFza1t0YXNrUHJvcF0sXG4gICAgICAgIHVwZGF0ZXNcbiAgICAgICk7XG4gICAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoe3Rhc2tDdXN0b21pemF0aW9uOiBuZXdDdXN0b21pemF0aW9ufSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgY291cnNlLCBtb2R1bGUsIG9uQ2FuY2VsLCBvbkRlbGV0ZSwgaWRzTm90Q292ZXJlZEJ5QW55VGFzaywgc2VhcmNoTW9kZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IHRhc2ssIHRhc2tDdXN0b21pemF0aW9uLCB0aXRsZSwgc2VhcmNoUmVzdWx0LCBzZWFyY2hNYXJrZWRJZHMsIGlzU2VhcmNoaW5nIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IG1hcmtlZElkcyA9IHNlYXJjaE1vZGUgP1xuICAgICAgc2VhcmNoTWFya2VkSWRzIDpcbiAgICAgIHRhc2suY2VudHJhbENvbnRlbnQubWFwKHggPT4geC5pZClcbiAgICAgICAgLmNvbmNhdCh0YXNrLmFiaWxpdGllcy5tYXAoeCA9PiB4LmlkKSlcbiAgICAgICAgLmNvbmNhdCh0YXNrLmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoeCA9PiB4LmlkKSk7XG5cbiAgICBjb25zdCB3cml0ZUFjY2VzcyA9IHRhc2sgJiYgaGFzV3JpdGVBY2Nlc3MoZW52LmN1cnJlbnRVc2VyLCB0YXNrKTtcbiAgICBjb25zdCB0YXNrVXJsVmFsaWQgPSB0YXNrICYmIHZhbGlkVXJsLmlzVXJpKHRhc2sudXJsKTtcbiAgICBjb25zdCB7ZmVhdHVyZXN9ID0gdGhpcztcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LXNwYWNlci0yMHB4dnQgc3YtdmVydGljYWwgc3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInBhZ2Vjb250ZW50IHN2LWxheW91dCBzdi1zcGFjZXItMjBweHZ0IHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdGV4dC1wb3J0bGV0IHN2LXVzZS1tYXJnaW5zIHN2LXNraXAtc3BhY2VyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxuICAgICAgICAgICAgPGgxIGNsYXNzTmFtZT1cImgxXCI+e3RpdGxlfTwvaDE+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWZsdWlkLWdyaWQgc3YtZ3JpZC1rc2dzMTIgc3YtbGF5b3V0XCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTZcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cbiAgICAgICAgICAgICAgICA8aDM+e3NlYXJjaE1vZGUgP1xuICAgICAgICAgICAgICAgICAgXCJGaWx0cmVyYSBww6Uga3Vuc2thcHNrcmF2XCIgOiB3cml0ZUFjY2VzcyA/XG4gICAgICAgICAgICAgICAgICAgIFwiVsOkbGoga3Vuc2thcHNrcmF2XCIgOlxuICAgICAgICAgICAgICAgICAgICBcIkt1bnNrYXBza3JhdlwifTwvaDM+XG4gICAgICAgICAgICAgICAge3NlYXJjaE1vZGUgP1xuICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgIE1hcmtlcmEgZGUga3Vuc2thcHNrcmF2IHNvbSB1cHBnaWZ0ZW4gbcOlc3RlIHTDpGNrYS5cbiAgICAgICAgICAgICAgICAgIDwvcD4gOiB3cml0ZUFjY2VzcyAmJlxuICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgIE1hcmtlcmEgZGUga3Vuc2thcHNrcmF2IHNvbSBkaW4gdXBwZ2lmdCB0w6Rja2VyLlxuICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICA8S25vd2xlZGdlTWF0cml4XG4gICAgICAgICAgICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM9e2NvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHN9XG4gICAgICAgICAgICAgICAgICBtYXJrZWRJZHM9e21hcmtlZElkc31cbiAgICAgICAgICAgICAgICAgIGlkc1RvTWFya05vdE9rPXtpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrfVxuICAgICAgICAgICAgICAgICAgbWFya01vZGU9e3NlYXJjaE1vZGUgfHwgd3JpdGVBY2Nlc3N9XG4gICAgICAgICAgICAgICAgICBtaWdyYXRlZElkcz17dGFzayAmJiB0YXNrLm1pZ3JhdGVkVGV4dHMgJiYgdGFzay5taWdyYXRlZFRleHRzLmtub3dsZWRnZVJlcXVpcmVtZW50c31cbiAgICAgICAgICAgICAgICAgIG9uTWFya0NoYW5nZWQ9e3RoaXMub25NYXJrQ2hhbmdlZC5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAgICAgICAgPFNlbGVjdFJlbGF0ZWREb2NzXG4gICAgICAgICAgICAgICAgb3B0aW9ucz17Y291cnNlLmFiaWxpdGllc31cbiAgICAgICAgICAgICAgICB0aXRsZT17d3JpdGVBY2Nlc3MgfHwgc2VhcmNoTW9kZSA/IFwiVsOkbGogZsO2cm3DpWdvclwiIDogXCJGw7ZybcOlZ29yXCJ9XG4gICAgICAgICAgICAgICAgbWFya2VkSWRzPXttYXJrZWRJZHN9XG4gICAgICAgICAgICAgICAgbWFya01vZGU9e3dyaXRlQWNjZXNzIHx8IHNlYXJjaE1vZGV9XG4gICAgICAgICAgICAgICAgbWlncmF0ZWRJZHM9e3Rhc2sgJiYgdGFzay5taWdyYXRlZFRleHRzICYmIHRhc2subWlncmF0ZWRUZXh0cy5hYmlsaXRpZXN9XG4gICAgICAgICAgICAgICAgb25NYXJrQ2hhbmdlZD17dGhpcy5vbk1hcmtDaGFuZ2VkLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cbiAgICAgICAgICAgICAgPFNlbGVjdFJlbGF0ZWREb2NzXG4gICAgICAgICAgICAgICAgb3B0aW9ucz17Y291cnNlLmNlbnRyYWxDb250ZW50fVxuICAgICAgICAgICAgICAgIHRpdGxlPXt3cml0ZUFjY2VzcyB8fCBzZWFyY2hNb2RlID8gXCJWw6RsaiBjZW50cmFsdCBpbm5laMOlbGxcIiA6IFwiQ2VudHJhbHQgaW5uZWjDpWxsXCJ9XG4gICAgICAgICAgICAgICAgbWFya2VkSWRzPXttYXJrZWRJZHN9XG4gICAgICAgICAgICAgICAgbWFya01vZGU9e3dyaXRlQWNjZXNzIHx8IHNlYXJjaE1vZGV9XG4gICAgICAgICAgICAgICAgbWlncmF0ZWRJZHM9e3Rhc2sgJiYgdGFzay5taWdyYXRlZFRleHRzICYmIHRhc2subWlncmF0ZWRUZXh0cy5jZW50cmFsQ29udGVudH1cbiAgICAgICAgICAgICAgICBvbk1hcmtDaGFuZ2VkPXt0aGlzLm9uTWFya0NoYW5nZWQuYmluZCh0aGlzKX0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuXG4gICAgICAgICAgICB7IXNlYXJjaE1vZGUgJiYgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPjxkaXYgY2xhc3NOYW1lPXtcIm9wZW5DbG9zZSBsYXJnZXJcIiArICh0aGlzLnN0YXRlLmZ1dHVyZUFiaWxpdGllc09wZW4gPyBcIiBvcGVuXCIgOiBcIlwiKX0+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkhlYWRlclwiIG9uQ2xpY2s9eygpID0+IHRoaXMuc2V0U3RhdGVQcm9taXNlZCh7IGZ1dHVyZUFiaWxpdGllc09wZW46ICF0aGlzLnN0YXRlLmZ1dHVyZUFiaWxpdGllc09wZW4gfSl9PlxuICAgICAgICAgICAgICAgIHt3cml0ZUFjY2VzcyA/XG4gICAgICAgICAgICAgICAgICA8cD5Ww6RsaiB5dHRlcmxpZ2FyZSBhbHRlcm5hdGl2PC9wPiA6XG4gICAgICAgICAgICAgICAgICA8cD5ZdHRlcmxpZ2FyZSBhbHRlcm5hdGl2PC9wPn1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cbiAgICAgICAgICAgICAgICA8aDQ+RnJhbXRpZHNmw7ZybcOlZ29yPC9oND5cblxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxuICAgICAgICAgICAgICAgICAge2Z1dHVyZUFiaWxpdGllcy5tYXAoZmEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRhc2suZnV0dXJlQWJpbGl0aWVzLmluZGV4T2YoZmEpID49IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2ZhfT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArIChzZWxlY3RlZCA/IFwiIGNoZWNrZWRcIiA6IFwiXCIpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXt3cml0ZUFjY2VzcyA/ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHsgLi4udGFzayB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUYXNrLmZ1dHVyZUFiaWxpdGllcyA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suZnV0dXJlQWJpbGl0aWVzLmZpbHRlcihhID0+IGEgIT0gZmEpIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5mdXR1cmVBYmlsaXRpZXMuY29uY2F0KGZhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiB1cGRhdGVkVGFzayB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHVuZGVmaW5lZH0gLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPntmYX1cbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgIDwvZGl2PjwvZGl2Pn1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1jb2x1bW4tNlwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICAgICAgICB7aXNTZWFyY2hpbmcgJiYgPHA+PFNwaW5uZXIgLz4gTGFkZGFyIHVwcGdpZnRlci4uLjwvcD59XG4gICAgICAgICAgICAgIHtzZWFyY2hSZXN1bHQgPyBcbiAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICogU2VhcmNoIFJlc3VsdHMgRnJhZ2VudFxuICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPFNlYXJjaFJlc3VsdHNcbiAgICAgICAgICAgICAgICAgIHNlYXJjaE1hcmtlZElkcz17c2VhcmNoTWFya2VkSWRzfVxuICAgICAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0PXtzZWFyY2hSZXN1bHR9XG4gICAgICAgICAgICAgICAgICB0YXNrPXt0YXNrfVxuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxuICAgICAgICAgICAgICAgICAgdGFza0N1c3RvbWl6YXRpb249e3Rhc2tDdXN0b21pemF0aW9ufVxuICAgICAgICAgICAgICAgICAgZWRpdFRhc2s9e3RoaXN9IC8+XG5cbiAgICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnQgPyBcbiAgICAgICAgICAgICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRoaXMuc3RhdGUucHJldmlld1Rhc2tDb250ZW50fX0gLz5cbiAgICAgICAgICAgICAgICA6IHRhc2sgJiYgPFByZXZpZXdhYmxlVGFza0ZpZWxkc1xuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxuICAgICAgICAgICAgICAgICAgdGFzaz17dGFza31cbiAgICAgICAgICAgICAgICAgIHRhc2tDdXN0b21pemF0aW9uPXt0YXNrQ3VzdG9taXphdGlvbn1cbiAgICAgICAgICAgICAgICAgIGVkaXRUYXNrPXt0aGlzfSAvPn1cblxuICAgICAgICAgICAgICAgIHt0YXNrICYmIDxUYXNrU3RhdHVzRnJhZ21lbnQgdGFzaz17dGFza30gLz59XG4gICAgICAgICAgICAgIDwvPiA6IFxuXG4gICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAqIEVkaXQgVGFza3MgRnJhZ21lbnRcbiAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICA8PlxuICAgICAgICAgICAgICAgIHt0YXNrICYmIDxCYXNpY0VkaXRhYmxlVGFza0ZpZWxkc1xuICAgICAgICAgICAgICAgICAgdGFzaz17dGFza31cbiAgICAgICAgICAgICAgICAgIGNvdXJzZT17Y291cnNlfVxuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxuICAgICAgICAgICAgICAgICAgZmVhdHVyZXM9e2ZlYXR1cmVzfVxuICAgICAgICAgICAgICAgICAgZWRpdFRhc2s9e3RoaXN9IC8+fVxuXG4gICAgICAgICAgICAgICAge3Rhc2sgJiYgPFByZXZpZXdhYmxlVGFza0ZpZWxkc1xuICAgICAgICAgICAgICAgICAgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfVxuICAgICAgICAgICAgICAgICAgdGFzaz17dGFza31cbiAgICAgICAgICAgICAgICAgIHRhc2tDdXN0b21pemF0aW9uPXt0YXNrQ3VzdG9taXphdGlvbn1cbiAgICAgICAgICAgICAgICAgIGVkaXRUYXNrPXt0aGlzfSAvPn1cblxuICAgICAgICAgICAgICAgIHt0YXNrICYmIDxUYXNrU3RhdHVzRnJhZ21lbnQgdGFzaz17dGFza30gLz59XG4gICAgICAgICAgICAgIDwvPn1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAge3Rhc2sgJiYgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxuICAgICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgIDxTYXZlT3JDYW5jZWxCdXR0b25zIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc30gZWRpdFRhc2s9e3RoaXN9IC8+XG4gICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj48L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj48L2Rpdj5cbiAgfVxufVxuXG4iLCJleHBvcnQgKiBmcm9tICcuL2VkaXQtdGFzayc7XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgRWRpdFRhc2sgfSBmcm9tICcuL2VkaXQtdGFzayc7XG5pbXBvcnQgeyBFZGl0YWJsZVJlc291cmNlTGlzdCB9IGZyb20gJy4uLy4uL3N1Yi1jb21wb25lbnRzL2VkaXRhYmxlLXJlc291cmNlLWxpc3QnO1xuaW1wb3J0IHsgVGFza0NvbnRlbnRGcmFnbWVudCB9IGZyb20gJy4vdGFzay1jb250ZW50LWZyYWdtZW50JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgd3JpdGVBY2Nlc3M6IGJvb2xlYW47XG4gIHRhc2s6IFRhc2s7XG4gIHRhc2tDdXN0b21pemF0aW9uOiBQYXJ0aWFsPFRhc2s+O1xuICBlZGl0VGFzazogRWRpdFRhc2s7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQcmV2aWV3YWJsZVRhc2tGaWVsZHMoe3dyaXRlQWNjZXNzLCB0YXNrLCB0YXNrQ3VzdG9taXphdGlvbiwgZWRpdFRhc2t9OiBQcm9wcykge1xuICByZXR1cm4gPD5cbiAgICA8PlxuICAgICAgPGgzPlVwcGdpZnRlbnMgbMOkcmFuZGVtw6VsPC9oMz5cbiAgICAgIDxkaXY+XG4gICAgICAgIDx0ZXh0YXJlYVxuICAgICAgICAgIGNsYXNzTmFtZT1cImlucHV0VGV4dEJveCBsZWFybmluZy1nb2FsLWJveFwiXG4gICAgICAgICAgZGlzYWJsZWQ9eyF3cml0ZUFjY2Vzc31cbiAgICAgICAgICB2YWx1ZT17dGFzay5sZWFybmluZ0dvYWx9XG4gICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcbiAgICAgICAgICAgIG5ld1Rhc2subGVhcm5pbmdHb2FsID0gZXYudGFyZ2V0LnZhbHVlO1xuICAgICAgICAgICAgZWRpdFRhc2suc2V0U3RhdGVQcm9taXNlZCh7IHRhc2s6IG5ld1Rhc2sgfSk7XG4gICAgICAgICAgfX1cbiAgICAgICAgLz5cbiAgICAgIDwvZGl2PlxuICAgIDwvPlxuICAgIDxiciAvPlxuICAgIDw+XG4gICAgICB7KHdyaXRlQWNjZXNzIHx8ICEhdGFzay5jb250ZW50KSAmJiA8VGFza0NvbnRlbnRGcmFnbWVudFxuICAgICAgICB3cml0ZUFjY2Vzcz17d3JpdGVBY2Nlc3N9XG4gICAgICAgIHRhc2s9e3Rhc2t9XG4gICAgICAgIGVkaXRUYXNrPXtlZGl0VGFza30gLz59XG4gICAgPC8+XG4gICAgPD5cbiAgICAgIHt0YXNrQ3VzdG9taXphdGlvbiAmJiB0YXNrQ3VzdG9taXphdGlvbi5yZXNvdXJjZXMgP1xuICAgICAgICA8aDM+UmVzdXJzZXIgZsO2ciB1cHBnaWZ0ZW4gKG1vZGlmaWVyYWQgZsO2ciBkZW5uYSBrdXJzaW5zdGFucyk8L2gzPiA6XG4gICAgICAgIDxoMz5SZXN1cnNlciBrb3BwbGFkZSB0aWxsIHVwcGdpZnRlbjwvaDM+fVxuXG4gICAgICA8RWRpdGFibGVSZXNvdXJjZUxpc3RcbiAgICAgICAgcmVzb3VyY2VzPXtcbiAgICAgICAgICAodGFza0N1c3RvbWl6YXRpb24gJiYgdGFza0N1c3RvbWl6YXRpb24ucmVzb3VyY2VzKSB8fCB0YXNrLnJlc291cmNlc31cbiAgICAgICAgaG9zdD17ZWRpdFRhc2sucHJvcHMuaG9zdH1cbiAgICAgICAgb25VcGRhdGU9e3Jlc291cmNlVXBkYXRlcyA9PiB7XG4gICAgICAgICAgZWRpdFRhc2sudXBkYXRlVGFza09yQ3VzdG9taXphdGlvbihcInJlc291cmNlc1wiLCByZXNvdXJjZVVwZGF0ZXMpO1xuICAgICAgICB9fSAvPlxuICAgIDwvPlxuICA8Lz47XG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRWRpdFRhc2sgfSBmcm9tICcuL2VkaXQtdGFzayc7XG5pbXBvcnQgeyBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy91dGlscyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBTYXZlT3JDYW5jZWxCdXR0b25zKHt3cml0ZUFjY2VzcywgZWRpdFRhc2t9OiB7d3JpdGVBY2Nlc3M6IGJvb2xlYW4sIGVkaXRUYXNrOiBFZGl0VGFza30pIHtcbiAgcmV0dXJuIDxSZWFjdC5GcmFnbWVudD5cbiAgICAgIHshIWVkaXRUYXNrLnByb3BzLm9uRGVsZXRlICYmIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCkgPT4gZWRpdFRhc2sucHJvcHMub25EZWxldGUoKX0+XG4gICAgICAgICAgVGEgYm9ydCBmcsOlbiBrdXJzbW9kdWxcbiAgICAgIDwvZGl2Pn1cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHVsbC1yaWdodFwiPiZuYnNwOzwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmcgYnRuLWxhcmdlIHB1bGwtcmlnaHRcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5wcm9wcy5vbkNhbmNlbCgpfT5cbiAgICAgICAgICBBdmJyeXRcbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5zYXZlKCkuY2F0Y2goc2hvd0Vycm9yKX0+XG4gICAgICAgICAgU3BhcmFcbiAgICAgIDwvZGl2PlxuICAgICAgeyF3cml0ZUFjY2VzcyAmJiA8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIiBvbkNsaWNrPXsoKSA9PiBlZGl0VGFzay5jb3B5VGFzaygpLmNhdGNoKHNob3dFcnJvcil9PlxuICAgICAgICAgIFNrYXBhIGtvcGlhIGF2IGRlbiBow6RyIHVwcGdpZnRlblxuICAgICAgPC9kaXY+fVxuICA8L1JlYWN0LkZyYWdtZW50Pjtcbn1cblxuIiwiaW1wb3J0IHsgVGFzayB9IGZyb20gXCJrZWRiYWNrZW5kL21vZGVsc1wiO1xuaW1wb3J0IHsgRWRpdFRhc2sgfSBmcm9tIFwiLi9lZGl0LXRhc2tcIjtcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgZmluZERPTU5vZGUgfSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IHsgc2hvcnRQZXJzb25OYW1lRm9ybWF0LCBzaG9ydERhdGVGb3JtYXQgfSBmcm9tIFwiLi4vLi4vdXRpbHNcIjtcbmltcG9ydCB7IFByZXZpZXdhYmxlVGFza0ZpZWxkcyB9IGZyb20gJy4vcHJldmlld2FibGUtdGFzay1maWVsZHMnO1xuaW1wb3J0IHsgU2F2ZU9yQ2FuY2VsQnV0dG9ucyB9IGZyb20gJy4vc2F2ZS1vci1jYW5jZWwtYnV0dG9ucyc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHNlYXJjaE1hcmtlZElkczogc3RyaW5nW107XG4gIHNlYXJjaFJlc3VsdDogVGFza1tdO1xuICB0YXNrOiBUYXNrO1xuICB3cml0ZUFjY2VzczogYm9vbGVhbjtcbiAgdGFza0N1c3RvbWl6YXRpb246IFBhcnRpYWw8VGFzaz47XG4gIGVkaXRUYXNrOiBFZGl0VGFzaztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFNlYXJjaFJlc3VsdHMgKHtzZWFyY2hNYXJrZWRJZHMsIHNlYXJjaFJlc3VsdCwgdGFzaywgZWRpdFRhc2ssIHdyaXRlQWNjZXNzLCB0YXNrQ3VzdG9taXphdGlvbn06IFByb3BzKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXtcInRhc2stc2VhcmNoLXJlc3VsdFwiICsgKCFlZGl0VGFzay5zdGF0ZS50YXNrICYmICFlZGl0VGFzay5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnQgPyBcIiBmaXhlZFwiIDogXCJcIil9PlxuICAgICAgICB7c2VhcmNoTWFya2VkSWRzLmxlbmd0aCA9PT0gMCA/XG4gICAgICAgICAgICA8aDI+U2FtdGxpZ2EgdXBwZ2lmdGVyIGbDtnIga3Vyc2VuPC9oMj4gOlxuICAgICAgICAgICAgPGgyPlVwcGdpZnRlciBzb20gdMOkY2tlciB2YWxkYSBmaWx0ZXI8L2gyPn1cbiAgICAgICAgPHRhYmxlPjx0Ym9keT5cbiAgICAgICAgICAgIHtzZWFyY2hSZXN1bHRcbiAgICAgICAgICAgICAgLmZpbHRlcih0YXNrID9cbiAgICAgICAgICAgICAgICBmb3VuZFRhc2sgPT4gZm91bmRUYXNrLmlkID09PSB0YXNrLmlkIDpcbiAgICAgICAgICAgICAgICAoKSA9PiB0cnVlKVxuICAgICAgICAgICAgICAubWFwKGZvdW5kVGFzayA9PiA8UmVhY3QuRnJhZ21lbnQga2V5PXtmb3VuZFRhc2suaWR9PlxuICAgICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImNoZWNrQm94XCIgKyAodGFzayAmJiB0YXNrLmlkID09PSBmb3VuZFRhc2suaWQgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCk9PnRvZ2dsZUNob29zZVRhc2soZm91bmRUYXNrKSB9IC8+XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+PHRkPlxuICAgICAgICAgICAgICAgICAgICAgICAge2ZvdW5kVGFzay5jb250ZW50ID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIG9uQ2xpY2s9e2V2ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlQ2hvb3NlVGFzayhmb3VuZFRhc2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IH0+e2ZvdW5kVGFzay5uYW1lfTwvYT4gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2ZvdW5kVGFzay51cmx9IHRhcmdldD1cIl9ibGFua1wiPntmb3VuZFRhc2submFtZX08L2E+fVxuICAgICAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgICAgICAge3Nob3J0UGVyc29uTmFtZUZvcm1hdChmb3VuZFRhc2subW9kaWZpZWRCeS5uYW1lKX1cbiAgICAgICAgICAgICAgICAgICAgPC90ZD48dGQ+XG4gICAgICAgICAgICAgICAgICAgICAge2ZvdW5kVGFzay5zY2hvb2wgfHwgXCJTdGFuZGFyZFwifVxuICAgICAgICAgICAgICAgICAgICA8L3RkPjx0ZD5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtzaG9ydERhdGVGb3JtYXQoZm91bmRUYXNrLm1vZGlmaWVkRGF0ZSl9XG4gICAgICAgICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgICAgICB7Lyp0YXNrICYmIHRhc2suaWQgPT09IGZvdW5kVGFzay5pZCAmJiA8dHI+PHRkIGNvbFNwYW49ezR9PlxuICAgICAgICAgICAgICAgICAge2VkaXRUYXNrLnN0YXRlLnByZXZpZXdUYXNrQ29udGVudCA/IFxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBlZGl0VGFzay5zdGF0ZS5wcmV2aWV3VGFza0NvbnRlbnR9fSAvPlxuICAgICAgICAgICAgICAgICAgOiA8UHJldmlld2FibGVUYXNrRmllbGRzXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlQWNjZXNzPXt3cml0ZUFjY2Vzc31cbiAgICAgICAgICAgICAgICAgICAgdGFzaz17dGFza31cbiAgICAgICAgICAgICAgICAgICAgdGFza0N1c3RvbWl6YXRpb249e3Rhc2tDdXN0b21pemF0aW9ufVxuICAgICAgICAgICAgICAgICAgICBlZGl0VGFzaz17ZWRpdFRhc2t9IC8+fVxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICA8aHIgLz5cbiAgICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICAgPFNhdmVPckNhbmNlbEJ1dHRvbnMgd3JpdGVBY2Nlc3M9e3dyaXRlQWNjZXNzfSBlZGl0VGFzaz17ZWRpdFRhc2t9IC8+XG4gICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICA8L3RkPjwvdHI+Ki99XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50Pil9XG4gICAgICAgIDwvdGJvZHk+PC90YWJsZT5cbiAgICAgICAgPGJyIC8+XG4gICAgICAgIDxociAvPlxuICAgIDwvZGl2PjtcblxuICBmdW5jdGlvbiB0b2dnbGVDaG9vc2VUYXNrKGZvdW5kVGFzazogVGFzaykge1xuICAgIGlmICh0YXNrICYmIHRhc2suaWQgPT09IGZvdW5kVGFzay5pZCkge1xuICAgICAgZWRpdFRhc2sudXBkYXRlU2VhcmNoTWFya2VkSWRzKHNlYXJjaE1hcmtlZElkcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgZmluZERPTU5vZGUoZWRpdFRhc2spLnBhcmVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgIGVkaXRUYXNrLnNldFN0YXRlUHJvbWlzZWQoeyB0YXNrOiBmb3VuZFRhc2ssIHByZXZpZXdUYXNrQ29udGVudDogbnVsbCB9KTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBXeXNpd3lnIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL3d5c2l3eWcnO1xuaW1wb3J0IGFjdGlvbnNfc3dlZGlzaCBmcm9tICcuLi8uLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvd3lzaXd5Zy9hY3Rpb25zLXN2JztcbmltcG9ydCB7IEVkaXRUYXNrIH0gZnJvbSAnLi9lZGl0LXRhc2snO1xuXG5leHBvcnQgZnVuY3Rpb24gVGFza0NvbnRlbnRGcmFnbWVudCh7d3JpdGVBY2Nlc3MsIHRhc2ssIGVkaXRUYXNrfToge3dyaXRlQWNjZXNzOiBib29sZWFuLCB0YXNrOiBUYXNrLCBlZGl0VGFzazogRWRpdFRhc2t9KSB7XG4gIHJldHVybiA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICA8aDM+VXBwZ2lmdGVucyBpbm5laMOlbGw8L2gzPlxuICAgICAge3dyaXRlQWNjZXNzICYmIDxwPlxuICAgICAgICAgIE9tIHVwcGdpZnRlbiBpbnRlIGzDpG5rYXIgdGlsbCBuw6Vnb3QgZG9rdW1lbnQga2FuIGR1IGzDpGdnYSBpbm5laMOlbGwgaMOkci5cbiAgICAgIDwvcD59XG4gICAgICA8V3lzaXd5ZyBhY3Rpb25zPXtbXG4gICAgICAgICAgXCJib2xkXCIsXG4gICAgICAgICAgXCJpdGFsaWNcIixcbiAgICAgICAgICBcInVuZGVybGluZVwiLFxuICAgICAgICAgIFwic3RyaWtldGhyb3VnaFwiLFxuICAgICAgICAgIFwiaGVhZGluZzJcIixcbiAgICAgICAgICBcImhlYWRpbmczXCIsXG4gICAgICAgICAgXCJvbGlzdFwiLFxuICAgICAgICAgIFwidWxpc3RcIixcbiAgICAgICAgICBcImxpbmVcIixcbiAgICAgICAgICBcImxpbmtcIixcbiAgICAgICAgICBcImltYWdlXCJcbiAgICAgIF19IGRlZmF1bHRBY3Rpb25zPXthY3Rpb25zX3N3ZWRpc2h9IHJlYWRPbmx5PXshd3JpdGVBY2Nlc3N9IGh0bWw9e3Rhc2suY29udGVudH0gb25DaGFuZ2U9e2h0bWwgPT4ge1xuICAgICAgICAgIGNvbnN0IG5ld1Rhc2sgPSB7IC4uLnRhc2sgfTtcbiAgICAgICAgICBuZXdUYXNrLmNvbnRlbnQgPSBodG1sO1xuICAgICAgICAgIGVkaXRUYXNrLnNldFN0YXRlKHsgdGFzazogbmV3VGFzayB9KTtcbiAgICAgIH0gfSAvPlxuICA8L1JlYWN0LkZyYWdtZW50Pjtcbn1cblxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtUYXNrLCBDb3Vyc2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHRhc2s6IFRhc2s7XG4gIGNvdXJzZTogQ291cnNlO1xuICB1cGRhdGVMaW5rOiAoaWQ6IHN0cmluZywgbGlua09yVW5saW5rOiBib29sZWFuKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgVGFza01pZ3JhdGlvbkJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge3Rhc2ssIGNvdXJzZSwgdXBkYXRlTGlua30gPSB0aGlzLnByb3BzO1xuICAgIGlmICghdGFzay5taWdyYXRlZFRleHRzKSByZXR1cm4gPD4mbmJzcDs8Lz47XG4gICAgY29uc3Qge2FiaWxpdGllcywgY2VudHJhbENvbnRlbnQsIGtub3dsZWRnZVJlcXVpcmVtZW50c30gPSB0YXNrLm1pZ3JhdGVkVGV4dHM7XG4gICAgY29uc3Qga3JzID0gT2JqZWN0LmtleXMoa25vd2xlZGdlUmVxdWlyZW1lbnRzIHx8IHt9KS5tYXAoaWQgPT4gKHtcbiAgICAgIC4uLmNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZCh0ID0+IHQuaWQgPT09IGlkKSxcbiAgICAgIC4uLmtub3dsZWRnZVJlcXVpcmVtZW50c1tpZF1cbiAgICB9KSkvLy5maWx0ZXIoKHtuYW1lfSkgPT4gISFuYW1lKTtcbiAgICBjb25zdCBrckEgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhdCBrdW5za2Fwc2tyYXYgZsO2ciBiZXR5Z2V0IEFcIiwgdHlwZTogXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgaXRlbXM6IGtycy5maWx0ZXIoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSAnQScpfTtcbiAgICBjb25zdCBrckMgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhdCBLdW5za2Fwc2tyYXYgZsO2ciBiZXR5Z2V0IENcIiwgdHlwZTogXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgaXRlbXM6IGtycy5maWx0ZXIoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSAnQycpfTtcbiAgICBjb25zdCBrckUgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhdCBrdW5za2Fwc2tyYXYgZsO2ciBiZXR5Z2V0IEVcIiwgdHlwZTogXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgaXRlbXM6IGtycy5maWx0ZXIoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSAnRScpfTtcbiAgICBjb25zdCBhYnMgPSB7dGl0bGU6IFwiVXBwZGF0ZXJhZGUgZsO2cm3DpWdvclwiLCB0eXBlOiBcImFiaWxpdGllc1wiLCBpdGVtczogT2JqZWN0LmtleXMoYWJpbGl0aWVzIHx8IHt9KS5tYXAoaWQgPT4gKHtcbiAgICAgIC4uLmNvdXJzZS5hYmlsaXRpZXMuZmluZCh0ID0+IHQuaWQgPT09IGlkKSxcbiAgICAgIC4uLmFiaWxpdGllc1tpZF19KVxuICAgICl9Ly8uZmlsdGVyKCh7bmFtZX0pID0+ICEhbmFtZSl9O1xuICAgIGNvbnN0IGNjcyA9IHt0aXRsZTogXCJVcHBkYXRlcmF0IGNlbnRyYWx0IGlubmVow6VsbFwiLCB0eXBlOiBcImNlbnRyYWxDb250ZW50XCIsIGl0ZW1zOiBPYmplY3Qua2V5cyhjZW50cmFsQ29udGVudCB8fCB7fSkubWFwKGlkID0+ICh7XG4gICAgICAuLi5jb3Vyc2UuY2VudHJhbENvbnRlbnQuZmluZChjYyA9PiBjYy5pZCA9PSBpZCksXG4gICAgICAuLi5jZW50cmFsQ29udGVudFtpZF1cbiAgICAgIH0pXG4gICAgKX0vLy5maWx0ZXIoKHtuYW1lfSkgPT4gISFuYW1lKX07XG4gICAgY29uc3QgdGFibGVzVG9TaG93ID0gW2tyQSwga3JDLCBrckUsIGNjcywgYWJzXS5maWx0ZXIoYm94SW5mbyA9PiBib3hJbmZvLml0ZW1zLmxlbmd0aCA+IDApO1xuICAgIGlmICh0YWJsZXNUb1Nob3cubGVuZ3RoID09PSAwKSByZXR1cm4gPD4mbmJzcDs8Lz47XG5cbiAgICByZXR1cm4gKFxuICAgICAgPE9wZW5DbG9zZUJveCBjbGFzc05hbWU9XCJsYXJnZXJcIiB0aXRsZT17PGRpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3YXJuaW5nRmxhZ1wiPlxuICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWV4Y2xhbWF0aW9uLXRyaWFuZ2xlXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHA+VXBwZGF0ZXJhZGUgZm9ybXVsZXJpbmdhciBmcsOlbiBTa29sdmVya2V0PC9wPlxuICAgICAgPC9kaXY+fT5cbiAgICAgICAge3RhYmxlc1RvU2hvdy5tYXAoKHt0aXRsZSwgdHlwZSwgaXRlbXN9KSA9PiA8ZGl2IGtleT17dGl0bGV9PlxuICAgICAgICAgIDxoNT57dGl0bGV9PC9oNT5cbiAgICAgICAgICA8dGFibGU+XG4gICAgICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t3aWR0aDogXCI0MCVcIn19PlVyc3BydW5nbGlnIGZvcm11bGVyaW5nPC90aD5cbiAgICAgICAgICAgICAgICA8dGggc3R5bGU9e3t3aWR0aDogXCI0MCVcIn19PlNrb2x2ZXJrZXRzIG55YSBmb3JtdWxlcmluZzwvdGg+XG4gICAgICAgICAgICAgICAgPHRoPlTDpGNrZXIgdXBwZ2lmdGVuIGRlbiBueWEgZm9ybXVsZXJpbmdlbj88L3RoPlxuICAgICAgICAgICAgICA8L3RyPlxuICAgICAgICAgICAgPC90aGVhZD5cbiAgICAgICAgICAgIDx0Ym9keT5cbiAgICAgICAgICAgICAge2l0ZW1zLm1hcChpdGVtID0+IDx0ciBrZXk9e2l0ZW0uaWR9PlxuICAgICAgICAgICAgICAgIDx0ZCBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogaXRlbS5vbGRUZXh0fX0gLz5cbiAgICAgICAgICAgICAgICA8dGQgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGl0ZW0ubmFtZX19IC8+XG4gICAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKT0+dXBkYXRlTGluayhpdGVtLmlkLCB0cnVlKX0+SmEgLSBiZWjDpWxsIGtvcHBsaW5nZW48L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCk9PnVwZGF0ZUxpbmsoaXRlbS5pZCwgZmFsc2UpfT5OZWogLSB0YSBib3J0IGtvcHBsaW5nZW48L2J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICA8L3RyPil9XG4gICAgICAgICAgICA8L3Rib2R5PlxuICAgICAgICAgIDwvdGFibGU+XG4gICAgICAgIDwvZGl2Pil9XG4gICAgICA8L09wZW5DbG9zZUJveD5cblxuICAgIClcbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGR0Rm9ybWF0IH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xuaW1wb3J0IHsgVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIFRhc2tTdGF0dXNGcmFnbWVudCh7dGFza306IHt0YXNrOiBUYXNrfSkge1xuICByZXR1cm4gPD5cbiAgICAgIDxoMz5VcHBnaWZ0ZW5zIHN0YXR1czwvaDM+XG5cbiAgICAgIHt0YXNrLmNyZWF0ZWRCeSAmJiB0YXNrLmNyZWF0ZWREYXRlICYmIDxwPlxuICAgICAgICAgIFVwcGdpZnRlbiBza2FwYWRlcyB7ZHRGb3JtYXQodGFzay5jcmVhdGVkRGF0ZSl9IGF2IDxzdHJvbmc+e3Rhc2suY3JlYXRlZEJ5Lm5hbWV9PC9zdHJvbmc+LlxuICAgICAgPC9wPn1cbiAgICAgIHt0YXNrLm1vZGlmaWVkQnkgJiYgdGFzay5tb2RpZmllZERhdGUgJiYgPHA+XG4gICAgICAgICAgVXBwZ2lmdGVuIHJlZGlnZXJhZGVzIHNlbmFzdCB7ZHRGb3JtYXQodGFzay5tb2RpZmllZERhdGUpfSBhdiA8c3Ryb25nPnt0YXNrLm1vZGlmaWVkQnkubmFtZX08L3N0cm9uZz4uXG4gICAgICA8L3A+fVxuICA8Lz47XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgUmVzb3VyY2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBEaWFsb2cgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XG5pbXBvcnQgdmFsaWRVcmwgZnJvbSAndmFsaWQtdXJsJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdXJsPzogc3RyaW5nO1xuICBvblNhdmU6IChuZXdVcmw6IHN0cmluZykgPT4gdm9pZDtcbiAgb25EZWxldGU/OiAoKT0+dm9pZDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgdXJsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0V29ya2Zsb3dMaW5rIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiBpbXBsZW1lbnRzIERpYWxvZyB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge3VybDogdGhpcy5wcm9wcy51cmwgfHwgJyd9O1xuICB9XG5cbiAgc2F2ZSgpIHtcbiAgICBjb25zdCB7dXJsfSA9IHRoaXMuc3RhdGU7XG4gICAgaWYgKCF2YWxpZFVybC5pc1VyaSh1cmwpKSB0aHJvdyBuZXcgRXJyb3IoTGBBbmdpdmVuIFVSTCAnJHt1cmx9JyDDpHIgb2dpbHRpZy4gU2thIGLDtnJqYSBtZWQgaHR0cDogZWxsZXIgaHR0cHM6YCk7XG4gICAgdGhpcy5wcm9wcy5vblNhdmUodXJsKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7b25TYXZlLCBvbkRlbGV0ZX0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBpc1ZhbGlkVXJsID0gdmFsaWRVcmwuaXNVcmkodGhpcy5zdGF0ZS51cmwpO1xuXG4gICAgcmV0dXJuIDxkaXY+PGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgPGgyPktvcHBsYSBlbiBhcmJldHNnw6VuZyB0aWxsIGt1cnNlbjwvaDI+XG4gICAgICA8cD5EZXQgZ8OlciBiYXJhIGF0dCBsw6RnZ2EgaW4gZW4gYXJiZXRzZ8OlbmcgcGVyIGt1cnMuPC9wPlxuICAgICAgPGJyIC8+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5Mw6Ruazo8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgXCI+XG4gICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgc2l6ZT17NTB9XG4gICAgICAgICAgICB2YWx1ZT17c3RhdGUudXJsfVxuICAgICAgICAgICAgb25DaGFuZ2U9e2V2PT50aGlzLnNldFN0YXRlKHt1cmw6IGV2LnRhcmdldC52YWx1ZX0pfSAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxiciAvPjwvZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiIGlkPVwic3ZpZDEyXzQ5MjQyMmQ1MTViYWRmMzY2NDZlNGZmMVwiPlxuICAgICAgICB7b25EZWxldGUgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCk9Pm9uRGVsZXRlKCl9PlxuICAgICAgICAgIFRhIGJvcnQgYXJiZXRzZ8OlbmdcbiAgICAgICAgPC9kaXY+fVxuICAgICAgICA8YVxuICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgIGNsYXNzTmFtZT17XCJidG4gYnRuLWxhcmdlXCIgKyAoaXNWYWxpZFVybCA/IFwiXCIgOiBcIiBidG4taW5hY3RpdmVcIil9XG4gICAgICAgICAgb25DbGljaz17aXNWYWxpZFVybCAmJiAoKCkgPT4gb25TYXZlKHN0YXRlLnVybCkpfT5TcGFyYTwvYT5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBTY2hvb2wsIEJyYW5jaCwgQ291cnNlIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgeyBzaG93RXJyb3IsIEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIERvY3VtZW50QWNjZXNzLCBCYXRjaFJ1bm5lciB9IGZyb20gXCJrZWRiYWNrZW5kL2NsaWVudFwiO1xuaW1wb3J0IHsgTGluayB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpZD86IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIHR5cGU/OiAnZ3ltbmFzaXVtJyB8ICdwcmltYXJ5J1xufVxuXG50eXBlIFN0YXRlID0gU2Nob29sO1xuXG5leHBvcnQgY29uc3QgRWRpdFNjaG9vbCA9IChwcm9wczogUHJvcHMgJiB7ZmVlZGJhY2tVcmw6IHN0cmluZ30pID0+IDxkaXYgc3R5bGU9e3sgb3V0bGluZTogMCB9fT5cbiAgPENvdXJzZUJhbm5lclxuICAgIHRpdGxlPVwiU2tvbG9yXCIgYWN0aXZlUGFnZT1cInNjaG9vbHNcIiBjYWxsYmFja3M9e3tzY2hvb2xzOiAoKT0+bG9jYXRpb24uaGFzaD1cIiMvc2Nob29sc1wifX1cbiAgICByb3V0ZXM9e3tmZWVkYmFjazogcHJvcHMuZmVlZGJhY2tVcmx9fSAvPlxuICA8RWRpdFNjaG9vbE5vQmFubmVyIHsuLi5wcm9wc30gLz5cbjwvZGl2PjtcblxuZXhwb3J0IGNsYXNzIEVkaXRTY2hvb2xOb0Jhbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBvcmlnU2Nob29sOiBTY2hvb2w7XG5cbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSBudWxsO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCkuY2F0Y2goZXJyID0+IHNob3dFcnJvcihlcnIpKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaWQpIHtcbiAgICAgIC8vIElEIGdpdmVuLCBsb2FkIGl0LlxuICAgICAgY29uc3QgeyBpZCB9ID0gdGhpcy5wcm9wcztcbiAgICAgIGNvbnN0IHNjaG9vbCA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmdldDxTY2hvb2w+KFwic2Nob29sc1wiLCBpZCk7XG4gICAgICB0aGlzLm9yaWdTY2hvb2wgPSB7IC4uLnNjaG9vbCB9O1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IC4uLnNjaG9vbCB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTm8gaWQsIGNyZWF0ZSBuZXcgaW5zdGVhZC5cbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxuICAgICAgICBvZmZpY2lhbEJyYW5jaElkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIGlzR3ltbmFzaXVtOiB0aGlzLnByb3BzLnR5cGUgPT09ICdneW1uYXNpdW0nLFxuICAgICAgICBpc1ByaW1hcnlTY2hvb2w6IHRoaXMucHJvcHMudHlwZSA9PT0gJ3ByaW1hcnknXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBzYXZlKCkge1xuICAgIGNvbnN0IHIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcbiAgICBsZXQgc2Nob29sID0geyAuLi50aGlzLnN0YXRlLCB0YWdzOiAodGhpcy5zdGF0ZS50YWdzIHx8IFtdKVxuICAgICAgLmZpbHRlcih0YWcgPT4gW1wicHJpbWFyeVwiLCBcImd5bW5hc2l1bVwiXS5pbmRleE9mKHRhZykgPCAwKVxuICAgIH07XG5cbiAgICBpZiAoc2Nob29sLmlzUHJpbWFyeVNjaG9vbCkgc2Nob29sLnRhZ3MucHVzaChcInByaW1hcnlcIik7XG4gICAgaWYgKHNjaG9vbC5pc0d5bW5hc2l1bSkgc2Nob29sLnRhZ3MucHVzaChcImd5bW5hc2l1bVwiKTtcbiAgICBpZiAoIShzY2hvb2wuaXNHeW1uYXNpdW0gfHwgc2Nob29sLmlzUHJpbWFyeVNjaG9vbCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvciAoTGBTa29sYW4gbcOlc3RlIGFudGluZ2VuIHZhcmEgZ3ltbmFzaXVtIGVsbGVyIGdydW5kc2tvbGFgKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMub3JpZ1NjaG9vbCkge1xuICAgICAgc2Nob29sLmFjbCA9IFtcInJvbGU6VVNFUjpSXCJdO1xuICAgICAgc2Nob29sLmFjbC5wdXNoKFxuICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXG4gICAgICAgICAgXCJzY2hvb2xSb2xlXCIsXG4gICAgICAgICAgYCR7c2Nob29sLm5hbWV9L0VNUExPWUVFYCwgXCJXXCIpLnRvU3RyaW5nKCkpO1xuICAgICAgci5hZGQoXCJzY2hvb2xzXCIsIHNjaG9vbCk7XG4gICAgICB0aGlzLmFkZFNjaG9vbEJyYW5jaChzY2hvb2wsIHIpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5vcmlnU2Nob29sLm5hbWUgIT09IHRoaXMuc3RhdGUubmFtZSkge1xuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTa29sYW5zIG5hbW4gZsOlciBpbnRlIMOkbmRyYXMuIEtvbnRha3RhIFZlbWVuZG8gQUIuXCIpXG5cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCkge1xuICAgICAgICBzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZCA9IGNyZWF0ZVVVSUQoKTtcbiAgICAgICAgdGhpcy5hZGRTY2hvb2xCcmFuY2goc2Nob29sLCByKTtcbiAgICAgIH1cbiAgICAgIHIucHV0KFwic2Nob29sc1wiLCBzY2hvb2wpO1xuICAgIH1cblxuICAgIGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmJhdGNoKHIubXV0YXRpb25SZXF1ZXN0cyk7XG5cbiAgICBsb2NhdGlvbi5oYXNoID0gXCIjL3NjaG9vbHNcIjtcbiAgfVxuXG4gIHByaXZhdGUgYWRkU2Nob29sQnJhbmNoKHNjaG9vbDogeyB0YWdzOiBzdHJpbmdbXTsgbmFtZTogc3RyaW5nOyBpc1ByaW1hcnlTY2hvb2w/OiBib29sZWFuOyBpc0d5bW5hc2l1bT86IGJvb2xlYW47IG9mZmljaWFsQnJhbmNoSWQ6IHN0cmluZzsgY291cnNlcz86IENvdXJzZVtdOyBhY3RpdmVDb3Vyc2VzPzogQ291cnNlW107IGlkOiBzdHJpbmc7IGFjbD86IHN0cmluZ1tdOyBkYXRlVGltZT86IG51bWJlcjsgdHJlZVBhcmVudElkPzogc3RyaW5nOyAkZXRhZz86IHN0cmluZzsgJG1ldGE/OiBcImFkZFwiIHwgXCJyZWZcIiB8IFwidXBkYXRlXCIgfCBcImFkZGluZ1wiIHwgXCJ1cGRhdGluZ1wiIHwgXCJkZWxldGluZ1wiIHwgXCJkZWxldGVkXCI7IH0sIHI6IEJhdGNoUnVubmVyKSB7XG4gICAgY29uc3QgYnJhbmNoOiBCcmFuY2ggPSB7XG4gICAgICBpZDogc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsXG4gICAgICBuYW1lOiBzY2hvb2wubmFtZSxcbiAgICAgIHNjaG9vbElkOiBzY2hvb2wuaWQsXG4gICAgICBhY2w6IFtcbiAgICAgICAgXCJyb2xlOlVTRVI6UlwiLFxuICAgICAgICBuZXcgRG9jdW1lbnRBY2Nlc3MoXCJzY2hvb2xSb2xlXCIsIGAke3NjaG9vbC5uYW1lfS9FTVBMT1lFRWAsIFwiV1wiKS50b1N0cmluZygpXG4gICAgICBdXG4gICAgfTtcbiAgICByLmFkZChcImJyYW5jaGVzXCIsIGJyYW5jaCk7XG4gIH1cblxuICBhc3luYyBkZWxldGVTY2hvb2woKSB7XG4gICAgaWYgKHByb21wdChMYMOEciBkdSBzw6RrZXIgcMOlIGF0dCB0YSBib3J0IHNrb2xhbiBcIiR7dGhpcy5zdGF0ZS5uYW1lfVwiPyBTa3JpdiBza29sYW5zIGV4YWt0YSBuYW1uIGbDtnIgYXR0IGJla3LDpGZ0YWApID09PSB0aGlzLnN0YXRlLm5hbWUgKSB7XG4gICAgICBjb25zdCBzY2hvb2xCcmFuY2ggPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PEJyYW5jaD4oXCJicmFuY2hlc1wiLCB7XG4gICAgICAgIGlkczogW3RoaXMuc3RhdGUub2ZmaWNpYWxCcmFuY2hJZF0sXG4gICAgICAgIGluY2x1ZGU6IFwiYXBwcm92ZWRDaGlsZHJlblwiLFxuICAgICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cbiAgICAgIH0pO1xuICAgICAgY29uc3QgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcbiAgICAgIGJyLmRlbGV0ZShcInNjaG9vbHNcIiwgdGhpcy5zdGF0ZS5pZCk7XG4gICAgICBzY2hvb2xCcmFuY2hbMF0uYXBwcm92ZWRDaGlsZHJlbi5mb3JFYWNoKCh7aWR9KSA9PiB7XG4gICAgICAgIGJyLmRlbGV0ZShcImJyYW5jaGVzXCIsIGlkKTtcbiAgICAgIH0pO1xuICAgICAgYnIuZGVsZXRlKFwiYnJhbmNoZXNcIiwgdGhpcy5zdGF0ZS5vZmZpY2lhbEJyYW5jaElkKTtcbiAgICAgIGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50LmJhdGNoKGJyLm11dGF0aW9uUmVxdWVzdHMpO1xuICAgICAgbG9jYXRpb24uaGFzaD0gXCIjL3NjaG9vbHNcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgYWxlcnQoXCJTa29sYW4gdG9ncyBpbnRlIGJvcnQgZWZ0ZXJzb20gZGV0IG5hbW4gZHUgYW5nYXYgaW50ZSBzdMOkbW1lci5cIik7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdGl0bGUsIGlkIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGVkaXRFeGlzdGluZyA9ICEhaWQ7XG4gICAgY29uc3Qgc2Nob29sID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCBvcmlnU2Nob29sID0gdGhpcy5vcmlnU2Nob29sO1xuICAgIGNvbnN0IGlzQWRtaW4gPSBlbnYuY3VycmVudFVzZXIucm9sZXMuc29tZShyb2xlID0+IHJvbGUgPT09IFwiQURNSU5cIik7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICA8aDI+e3RpdGxlfTwvaDI+XG4gICAgICAgIDxociAvPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPk5hbW46PC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGF1dG9Gb2N1cz17IXNjaG9vbCB8fCAhc2Nob29sLm5hbWV9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXshaXNBZG1pbiB8fCBlZGl0RXhpc3Rpbmd9XG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgICBzaXplPXs1MH1cbiAgICAgICAgICAgICAgdmFsdWU9e3NjaG9vbCA/IHNjaG9vbC5uYW1lIDogXCJcIn1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHRoaXMuc2V0U3RhdGUoeyBuYW1lOiBldi50YXJnZXQudmFsdWUgfSl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlZpc25pbmdzbmFtbjo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgYXV0b0ZvY3VzPXtzY2hvb2wgJiYgIXNjaG9vbC5kaXNwbGF5TmFtZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyFpc0FkbWlufVxuICAgICAgICAgICAgICB0YWJJbmRleD17MX1cbiAgICAgICAgICAgICAgc2l6ZT17NTB9XG4gICAgICAgICAgICAgIHZhbHVlPXtzY2hvb2wgPyBzY2hvb2wuZGlzcGxheU5hbWUgOiBcIlwifVxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IGRpc3BsYXlOYW1lOiBldi50YXJnZXQudmFsdWUgfSl9IC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlR5cDo8L2Rpdj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiXG4gICAgICAgICAgICAgIG5hbWU9XCJzY2hvb2xUeXBlUHJpbWFyeVwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXshaXNBZG1pbn1cbiAgICAgICAgICAgICAgY2hlY2tlZD17c2Nob29sICYmIHNjaG9vbC5pc1ByaW1hcnlTY2hvb2x9XG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgICB2YWx1ZT1cInByaW1hcnlcIlxuICAgICAgICAgICAgICBvbkNoYW5nZT17ZXYgPT4gdGhpcy5zZXRTdGF0ZSh7IGlzUHJpbWFyeVNjaG9vbDogZXYudGFyZ2V0LmNoZWNrZWQgfSl9IC8+XG4gICAgICAgICAgICAmbmJzcDtHcnVuZHNrb2xhXG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPjwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgbmFtZT1cInNjaG9vbFR5cGVHeW1uYXNpdW1cIlxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQWRtaW59XG4gICAgICAgICAgICAgIGNoZWNrZWQ9e3NjaG9vbCAmJiBzY2hvb2wuaXNHeW1uYXNpdW19XG4gICAgICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgICAgICB2YWx1ZT1cImd5bW5hc2l1bVwiXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnNldFN0YXRlKHsgaXNHeW1uYXNpdW06IGV2LnRhcmdldC5jaGVja2VkIH0pfSAvPlxuICAgICAgICAgICAgJm5ic3A7R3ltbmFzaXVtXG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCI+PC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8YnIvPlxuICAgICAgICB7aXNBZG1pbiAmJiBlZGl0RXhpc3RpbmcgJiYgPGRpdiB0YWJJbmRleD17Mn0gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgb25DbGljaz17KCkgPT5cbiAgICAgICAgICB0aGlzLmRlbGV0ZVNjaG9vbCgpLmNhdGNoKHNob3dFcnJvcil9PlxuICAgICAgICAgIFRhIGJvcnQgc2tvbGFcbiAgICAgICAgPC9kaXY+fVxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInB1bGwtcmlnaHRcIj4mbmJzcDs8L2Rpdj5cbiAgICAgICAgPExpbmsgY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCIgdG89XCIvc2Nob29sc1wiPlxuICAgICAgICAgIEF2YnJ5dFxuICAgICAgICA8L0xpbms+XG4gICAgICAgIFxuICAgICAgICB7aXNBZG1pbiAmJiA8YSB0YWJJbmRleD17MX0gY2xhc3NOYW1lPXtcImJ0biBidG4tbGFyZ2VcIn0gb25DbGljaz17KCkgPT4ge1xuICAgICAgICAgIGlmIChvcmlnU2Nob29sICYmIG9yaWdTY2hvb2wubmFtZSAhPT0gc2Nob29sLm5hbWUpIHtcbiAgICAgICAgICAgIGlmICghY29uZmlybShMYMOEciBkdSBzw6RrZXIgcMOlIGF0dCBkdSB2aWxsIGTDtnBhIG9tIHNrb2xhbj8gRGV0dGEgcMOldmVya2FyIHBvcnRhbGVucyBmdW5rdGlvbiBmw7ZyIGzDpHJhcmUgb2NoIGVsZXZlciBzb20gdGlsbGjDtnIgc2tvbGFuLiBOYW1uZXQgbcOlc3RlIHN0w6RtbWEgZXhha3Qgw7Z2ZXJlbnMgbWVkIG5hbW5naXZuaW5nZW4gYXYgc2tvbGFuIHDDpSBhbnbDpG5kYXJvYmpla3Rlbi5cblxuRGV0IHNvbSBow6RuZGVyIGFubmFycyDDpHIgYXR0IGVsZXZlciBvY2ggbMOkcmFyZSBww6Ugc2tvbGFuIGludGUgbMOkbmdyZSBoaXR0YXIgbsOlZ3JhIGt1cnNlci5cblxuQmxpciBkZXQgZmVsIGthbiBkdSBkb2NrIGFsbHRpZCBiYXJhIGTDtnBhIHRpbGxiYWthIHNrb2xhbnMgbmFtbi5gKSkge1xuICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuc2F2ZSgpLmNhdGNoKHNob3dFcnJvcik7XG4gICAgICAgIH19PlNwYXJhPC9hPn1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PjtcbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFNjaG9vbCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IERpYWxvZ0NvbnRhaW5lciB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdFwiO1xuaW1wb3J0IHsgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMgfSBmcm9tIFwiLi4vdXRpbHNcIjtcbmltcG9ydCB7IEVkaXRTY2hvb2wgfSBmcm9tICcuL2VkaXQtc2Nob29sJztcbmltcG9ydCB7IExpbmsgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcbmltcG9ydCB7IGFjdEFzIH0gZnJvbSBcIi4uLy4uLy4uL2FjY2Vzcy1jb250cm9sXCI7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgc2Nob29scz86IFNjaG9vbFtdXG4gIHZpZXdDb3Vyc2VVcmw6IHN0cmluZ1xuICB0eXBlOiAnZ3ltbmFzaXVtJyB8ICdwcmltYXJ5J1xufVxuXG5leHBvcnQgY29uc3QgRWRpdGFibGVTY2hvb2xMaXN0ID0gKHByb3BzOiBQcm9wcykgPT4ge1xuICBjb25zdCB7IHNjaG9vbHMsIHZpZXdDb3Vyc2VVcmwgfSA9IHByb3BzO1xuICBjb25zdCBpc0FkbWluID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSBcIkFETUlOXCIpO1xuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJlZGl0YWJsZS1zY2hvb2wtbGlzdFwiPlxuICAgIDxkaXY+XG4gICAgICB7c2Nob29scyA/IDx0YWJsZT5cbiAgICAgICAgPHRib2R5PlxuICAgICAgICAgIHtzY2hvb2xzLm1hcChzY2hvb2wgPT5cbiAgICAgICAgICAgIDx0ciBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCIga2V5PXtzY2hvb2wuaWR9PlxuICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgPExpbmsgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiB0bz17YC9zY2hvb2xzLyR7c2Nob29sLmlkfS9lZGl0YH0+PC9MaW5rPlxuICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgPHA+e3NjaG9vbC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgICAgPHRkPlxuICAgICAgICAgICAgICAgIDxwPjxhIHN0eWxlPXt7Y3Vyc29yOiAncG9pbnRlcid9fSBvbkNsaWNrPXsoKT0+YWN0QXMoe3JvbGU6IFwiRU1QTE9ZRUVcIiwgc2Nob29sOiBzY2hvb2wubmFtZX0pfT5BZ2VyYSBzb20gbMOkcmFyZSBww6UgZGVubmEgc2tvbGE8L2E+PC9wPlxuICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICAgICAgPHA+PGEgc3R5bGU9e3tjdXJzb3I6ICdwb2ludGVyJ319IG9uQ2xpY2s9eygpPT5hY3RBcyh7cm9sZTogXCJTVFVERU5UXCIsIHNjaG9vbDogc2Nob29sLm5hbWUsIHVybDogdmlld0NvdXJzZVVybH0pfT5BZ2VyYSBzb20gZWxldiBww6UgZGVubmEgc2tvbGE8L2E+PC9wPlxuICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC90cj4pfVxuICAgICAgICA8L3Rib2R5PlxuICAgICAgPC90YWJsZT4gOiA8cD48U3Bpbm5lciAvPlYuZy4gdsOkbnRhIG1lZGFuIHNrb2xvciBsYWRkYXM8L3A+fVxuICAgIDwvZGl2PlxuICAgIDxiciAvPlxuICAgIHtzY2hvb2xzICYmIGlzQWRtaW4gJiYgPExpbmsgdG89e2Avc2Nob29scy9uZXcvJHtwcm9wcy50eXBlfWB9IGNsYXNzTmFtZT1cImJ0blwiPntcbiAgICAgICAgcHJvcHMudHlwZSA9PSAnZ3ltbmFzaXVtJyA/IExgTMOkZ2cgdGlsbCBneW1uYXNpZXNrb2xhYCA6XG4gICAgICAgIHByb3BzLnR5cGUgPT0gJ3ByaW1hcnknID8gTGBMw6RnZyB0aWxsIGdydW5kc2tvbGFgIDpcbiAgICAgICAgTGBMw6RnZyB0aWxsIHNrb2xhYH08L0xpbms+fVxuICA8L2RpdiA+XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi4vY291cnNlcy9jb3Vyc2UtYmFubmVyXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBTY2hvb2wgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBFZGl0YWJsZVNjaG9vbExpc3QgfSBmcm9tICcuL2VkaXRhYmxlLXNjaG9vbC1saXN0JztcbmltcG9ydCB7IHNob3dFcnJvciwgY29tcGFyZVByb3AgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9zdWItY29tcG9uZW50cy9zcGlubmVyJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nO1xuICBmZWVkYmFja1VybDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBzY2hvb2xzOiBTY2hvb2xbXSB8IG51bGxcbn1cblxuZXhwb3J0IGNvbnN0IFNjaG9vbHMgPSAocHJvcHM6IFByb3BzKSA9PiA8ZGl2IHN0eWxlPXt7IG91dGxpbmU6IDAgfX0+XG4gIDxDb3Vyc2VCYW5uZXIgdGl0bGU9XCJTa29sb3JcIiBhY3RpdmVQYWdlPVwic2Nob29sc1wiIHJvdXRlcz17e2ZlZWRiYWNrOiBwcm9wcy5mZWVkYmFja1VybH19IC8+XG4gIDxTY2hvb2xzV2l0aG91dEJhbm5lciB2aWV3Q291cnNlVXJsPXtwcm9wcy52aWV3Q291cnNlVXJsfSAvPlxuPC9kaXY+XG5cbmV4cG9ydCBjbGFzcyBTY2hvb2xzV2l0aG91dEJhbm5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQaWNrPFByb3BzLCBcInZpZXdDb3Vyc2VVcmxcIj4sU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzY2hvb2xzOiBudWxsXG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCkuY2F0Y2goZXJyID0+IHNob3dFcnJvcihlcnIubWVzc2FnZSB8fCBlcnIpKTtcbiAgfVxuXG4gIGFzeW5jIGxvYWQoKSB7XG4gICAgY29uc3Qgc2Nob29scyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U2Nob29sPihcInNjaG9vbHNcIik7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHNjaG9vbHMgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBzY2hvb2xzIH0gPSB0aGlzLnN0YXRlO1xuICAgIHNjaG9vbHMgJiYgc2Nob29scy5zb3J0KGNvbXBhcmVQcm9wKFwibmFtZVwiKSk7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxuICAgICAgICB7c2Nob29scyA/IDw+XG4gICAgICAgIDxkaXY+XG4gICAgICAgICAgPGgyPkd5bW5hc2llc2tvbG9yPC9oMj5cbiAgICAgICAgICA8RWRpdGFibGVTY2hvb2xMaXN0XG4gICAgICAgICAgICBzY2hvb2xzPXtzY2hvb2xzLmZpbHRlcihzY2hvb2wgPT4gc2Nob29sLmlzR3ltbmFzaXVtKX1cbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cbiAgICAgICAgICAgIHR5cGU9XCJneW1uYXNpdW1cIiAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8aDI+R3J1bmRza29sb3I8L2gyPlxuICAgICAgICAgIDxFZGl0YWJsZVNjaG9vbExpc3RcbiAgICAgICAgICAgIHNjaG9vbHM9e3NjaG9vbHMuZmlsdGVyKHNjaG9vbCA9PiBzY2hvb2wuaXNQcmltYXJ5U2Nob29sKX1cbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cbiAgICAgICAgICAgIHR5cGU9XCJwcmltYXJ5XCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8Lz4gOiA8U3Bpbm5lciAvPn1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge0VkaXRTY2hvb2x9IGZyb20gJy4vZWRpdC1zY2hvb2wnO1xuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdHlwZTogJ2d5bW5hc2l1bScgfCAncHJpbWFyeSdcbiAgZmVlZGJhY2tVcmw6IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IE5ld1NjaG9vbCA9IChwcm9wczogUHJvcHMpPT48RWRpdFNjaG9vbFxuICB0aXRsZT17TGBMw6RnZyB0aWxsIHNrb2xhYH1cbiAgdHlwZT17cHJvcHMudHlwZX1cbiAgZmVlZGJhY2tVcmw9e3Byb3BzLmZlZWRiYWNrVXJsfSAvPjtcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7UmVzb3VyY2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7TGlua30gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQge0lDb3Vyc2VFZGl0b3JIb3N0fSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XG5pbXBvcnQge0VkaXRSZXNvdXJjZX0gZnJvbSAnLi4vbW9kYWwtcGFnZXMvZWRpdC1yZXNvdXJjZSc7XG5pbXBvcnQgeyB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgcmVzb3VyY2VzOiBSZXNvdXJjZVtdO1xuICBvblVwZGF0ZTogKHJlc291cmNlc1VwZGF0ZXMpID0+IHZvaWQ7XG4gIGhvc3Q6IElDb3Vyc2VFZGl0b3JIb3N0O1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuXG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0YWJsZVJlc291cmNlTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZT17fTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7aG9zdCwgb25VcGRhdGUsIHJlc291cmNlc30gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XG4gICAgICAgIHtyZXNvdXJjZXMubWFwKChyZXNvdXJjZSwgaWR4KSA9PiBcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIiBrZXk9e2lkeH0+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJlZGl0SXRlbVwiIG9uQ2xpY2s9eygpPT5ob3N0Lm9wZW5EaWFsb2coe1xuICAgICAgICAgICAgICAgIENvbXBvbmVudDogRWRpdFJlc291cmNlLFxuICAgICAgICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICAgICAgICB0aXRsZTogXCJSZWRpZ2VyYSByZXN1cnNcIixcbiAgICAgICAgICAgICAgICAgIHJlc291cmNlLFxuICAgICAgICAgICAgICAgICAgb25TYXZlOiBlZGl0ZWRSZXNvdXJjZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRSZXNvdXJjZSA9IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKGVkaXRlZFJlc291cmNlLCBlbnYuY3VycmVudFVzZXIpO1xuICAgICAgICAgICAgICAgICAgICBvblVwZGF0ZSh7JHNwbGljZTogW1tpZHgsIDEsIHVwZGF0ZWRSZXNvdXJjZV1dfSk7XG4gICAgICAgICAgICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBvbkRlbGV0ZTogKCk9PntcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzcGxpY2U6IFtbaWR4LCAxXV19KTtcbiAgICAgICAgICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSl9PjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGEgaHJlZj17cmVzb3VyY2UudXJsfSB0YXJnZXQ9XCJfYmxhbmtcIiA+e3Jlc291cmNlLm5hbWV9PC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+KX1cbiAgICAgPC9kaXY+XG4gICAgPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCk9Pmhvc3Qub3BlbkRpYWxvZyh7XG4gICAgICBDb21wb25lbnQ6IEVkaXRSZXNvdXJjZSxcbiAgICAgIHByb3BzOiB7XG4gICAgICAgIHRpdGxlOiBcIkzDpGdnIHRpbGwgcmVzdXJzXCIsXG4gICAgICAgIG9uU2F2ZTogbmV3UmVzb3VyY2UgPT4ge1xuICAgICAgICAgIGNvbnN0IHVwZGF0ZWRSZXNvdXJjZSA9IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKG5ld1Jlc291cmNlLCBlbnYuY3VycmVudFVzZXIpO1xuICAgICAgICAgIG9uVXBkYXRlKHskcHVzaDogW3VwZGF0ZWRSZXNvdXJjZV19KVxuICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pfT48aSBjbGFzc05hbWU9XCJmYSBmYS1wYXBlcmNsaXBcIiBhcmlhLWhpZGRlbj48L2k+IEzDpGdnIHRpbGwgcmVzdXJzPC9hPlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgVGFzaywgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIEFiaWxpdHkgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBFZGl0VGFzayB9IGZyb20gJy4uL21vZGFsLXBhZ2VzL2VkaXQtdGFzayc7XG5pbXBvcnQgeyBJQ291cnNlRWRpdG9ySG9zdCB9IGZyb20gJy4uL2ludGVyZmFjZXMvY291cnNlLWVkaXRvci1ob3N0JztcbmltcG9ydCB7IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzLCBoYXNNaWdyYXRlZFRleHRzIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBoYXNXcml0ZUFjY2VzcyB9IGZyb20gXCIuLi8uLi8uLi9hY2Nlc3MtY29udHJvbFwiO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB0YXNrSWRzOiBzdHJpbmdbXTtcbiAgdGFza0N1c3RvbWl6YXRpb25zPzogeyBbdGFza0lkOiBzdHJpbmddOiBQYXJ0aWFsPFRhc2s+IH1cbiAgY291cnNlOiBDb3Vyc2U7XG4gIG1vZHVsZTogQ291cnNlTW9kdWxlO1xuICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrOiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcbiAgb25UYXNrQWRkZWQ6ICh0YXNrOiBUYXNrLCB0YXNrQ3VzdG9taXphdGlvbj86IFBhcnRpYWw8VGFzaz4pID0+IHZvaWQ7XG4gIG9uVGFza1VwZGF0ZWQ6ICh0YXNrKSA9PiB2b2lkO1xuICBvblRhc2tDdXN0b21pemF0aW9uVXBkYXRlZDogKHRhc2tJZCwgY3VzdG9taXphdGlvbikgPT4gdm9pZDtcbiAgb25UYXNrRGVsZXRlZDogKGlkKSA9PiB2b2lkO1xuICBvblRhc2tSZXBsYWNlZDogKGlkLCB0YXNrKSA9PiB2b2lkO1xuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcblxufVxuXG5leHBvcnQgY2xhc3MgRWRpdGFibGVUYXNrTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xuICB9XG5cbiAgb3BlblRhc2tEaWFsb2codGFzazogVGFzaykge1xuICAgIGNvbnN0IHtcbiAgICAgIHRhc2tDdXN0b21pemF0aW9ucyxcbiAgICAgIGNvdXJzZSxcbiAgICAgIGhvc3QsXG4gICAgICBtb2R1bGUsXG4gICAgICB0YXNrSWRzLFxuICAgICAgb25UYXNrQWRkZWQsXG4gICAgICBvblRhc2tVcGRhdGVkLFxuICAgICAgb25UYXNrQ3VzdG9taXphdGlvblVwZGF0ZWQsXG4gICAgICBvblRhc2tEZWxldGVkLFxuICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzayxcbiAgICAgIG9uVGFza1JlcGxhY2VkXG4gICAgfSA9IHRoaXMucHJvcHM7XG5cbiAgICBob3N0Lm9wZW5EaWFsb2coe1xuICAgICAgQ29tcG9uZW50OiBFZGl0VGFzayxcbiAgICAgIHByb3BzOiB7XG4gICAgICAgIHRhc2ssXG4gICAgICAgIHRhc2tDdXN0b21pemF0aW9uOiB0YXNrQ3VzdG9taXphdGlvbnMgJiYgdGFza0N1c3RvbWl6YXRpb25zW3Rhc2suaWRdLFxuICAgICAgICBtb2R1bGUsXG4gICAgICAgIGNvdXJzZSxcbiAgICAgICAgaG9zdCxcbiAgICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzayxcbiAgICAgICAgb25TYXZlOiB0YXNrID0+IHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkVGFzayA9IHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKHRhc2ssIGVudi5jdXJyZW50VXNlcik7XG4gICAgICAgICAgb25UYXNrVXBkYXRlZCh1cGRhdGVkVGFzayk7XG4gICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xuICAgICAgICB9LFxuICAgICAgICBvblNhdmVDdXN0b21pemF0aW9uOiBjdXN0b21pemF0aW9uID0+IHtcbiAgICAgICAgICBvblRhc2tDdXN0b21pemF0aW9uVXBkYXRlZCh0YXNrLmlkLCBjdXN0b21pemF0aW9uKTtcbiAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uRGVsZXRlOiAoKSA9PiB7XG4gICAgICAgICAgb25UYXNrRGVsZXRlZCh0YXNrLmlkKTtcbiAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uUmVwbGFjZTogKHRhc2tJZDogc3RyaW5nLCBuZXdUYXNrOiBUYXNrKSA9PiB7XG4gICAgICAgICAgb25UYXNrUmVwbGFjZWQodGFza0lkLCBuZXdUYXNrKTtcbiAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQ2FuY2VsOiAoKSA9PiBob3N0LmNsb3NlRGlhbG9nKClcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cbiAgICAgICAge3Byb3BzLnRhc2tJZHMubWFwKGlkID0+IHByb3BzLmNvdXJzZS50YXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gaWQpKS5tYXAodGFzayA9PiB7XG4gICAgICAgICAgY29uc3QgY2FuVXBkYXRlVGFzayA9IGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgdGFzayk7XG5cbiAgICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCIga2V5PXt0YXNrLmlkfT5cbiAgICAgICAgICAgIHtoYXNXcml0ZUFjY2VzcyhlbnYuY3VycmVudFVzZXIsIHRhc2spICYmIGhhc01pZ3JhdGVkVGV4dHModGFzaykgJiYgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e3Bvc2l0aW9uOidyZWxhdGl2ZScsIHRvcDonMC4yZW0nLCBsZWZ0OiAnLTAuN2VtJ319PlxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBhZ2VsaW5lc1wiIHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgdG9wOiAwLCBsZWZ0OiAwLCBjb2xvcjonIzQ5YzM1YSd9fSAvPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2Pn1cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjYW5VcGRhdGVUYXNrID8gXCJlZGl0SXRlbVwiIDogXCJ2aWV3SXRlbVwifSBvbkNsaWNrPXsoKSA9PlxuICAgICAgICAgICAgICAgIHRoaXMub3BlblRhc2tEaWFsb2codGFzayl9IC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XG4gICAgICAgICAgICAgIHt0YXNrLmNvbnRlbnQgP1xuICAgICAgICAgICAgICAgIC8vIFJhdGhlciB0aGFuIGxpbmtpbmcgdG8gdXJsLCBzaG93IHRoZSB0YXNrJ3MgY29udGVudCAoYnkgb3BlbmluZ1xuICAgICAgICAgICAgICAgIC8vIHRoZSB0YXNrIGRpYWxvZylcbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIG9uQ2xpY2s9e2V2PT57XG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5vcGVuVGFza0RpYWxvZyh0YXNrKTtcbiAgICAgICAgICAgICAgICB9fT57dGFzay5uYW1lfTwvYT4gOlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3Rhc2sudXJsfSB0YXJnZXQ9XCJfYmxhbmtcIj57dGFzay5uYW1lfTwvYT59XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj47XG4gICAgICAgIH0pfVxuICAgICAgPC9kaXY+XG4gICAgICA8YnIgLz5cbiAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIGNvdXJzZSxcbiAgICAgICAgICBob3N0LFxuICAgICAgICAgIGlkc05vdENvdmVyZWRCeUFueVRhc2ssXG4gICAgICAgICAgbW9kdWxlLFxuICAgICAgICAgIG9uVGFza0FkZGVkLFxuICAgICAgICAgIG9uVGFza0N1c3RvbWl6YXRpb25VcGRhdGVkIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIHByb3BzLmhvc3Qub3BlbkRpYWxvZyh7XG4gICAgICAgICAgQ29tcG9uZW50OiBFZGl0VGFzayxcbiAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgc2VhcmNoTW9kZTogdHJ1ZSxcbiAgICAgICAgICAgIG1vZHVsZSxcbiAgICAgICAgICAgIGNvdXJzZSxcbiAgICAgICAgICAgIGhvc3QsXG4gICAgICAgICAgICBpZHNOb3RDb3ZlcmVkQnlBbnlUYXNrLFxuICAgICAgICAgICAgb25TYXZlOiAoY2hvb3NlblRhc2ssIHRhc2tDdXN0b21pemF0aW9uKSA9PiB7XG4gICAgICAgICAgICAgIGNob29zZW5UYXNrID0gdXBkYXRlTW9kaWZpY2F0aW9uQW5kQ3JlYXRpb25TdGFtcHMoY2hvb3NlblRhc2ssIGVudi5jdXJyZW50VXNlcik7XG4gICAgICAgICAgICAgIG9uVGFza0FkZGVkKGNob29zZW5UYXNrLCB0YXNrQ3VzdG9taXphdGlvbik7XG4gICAgICAgICAgICAgIGhvc3QuY2xvc2VEaWFsb2coKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4gaG9zdC5jbG9zZURpYWxvZygpXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH19PjxpIGNsYXNzTmFtZT1cImZhIGZhLXNlYXJjaFwiIGFyaWEtaGlkZGVuIC8+IFPDtmsgdXBwZ2lmdDwvYT5cbiAgICAgICZuYnNwO1xuICAgICAgPGEgb25DbGljaz17KCkgPT4ge1xuICAgICAgICBjb25zdCB7IGNvdXJzZSwgaG9zdCwgbW9kdWxlLCB0YXNrSWRzLCBvblRhc2tBZGRlZCwgb25UYXNrVXBkYXRlZCwgb25UYXNrRGVsZXRlZCwgaWRzTm90Q292ZXJlZEJ5QW55VGFzayB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgaG9zdC5vcGVuRGlhbG9nKHtcbiAgICAgICAgICBDb21wb25lbnQ6IEVkaXRUYXNrLFxuICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICBtb2R1bGUsXG4gICAgICAgICAgICBjb3Vyc2UsXG4gICAgICAgICAgICBob3N0LFxuICAgICAgICAgICAgaWRzTm90Q292ZXJlZEJ5QW55VGFzayxcbiAgICAgICAgICAgIG9uU2F2ZTogbmV3VGFzayA9PiB7XG4gICAgICAgICAgICAgIG5ld1Rhc2sgPSB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyhuZXdUYXNrLCBlbnYuY3VycmVudFVzZXIpO1xuICAgICAgICAgICAgICBvblRhc2tBZGRlZChuZXdUYXNrKTtcbiAgICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiBob3N0LmNsb3NlRGlhbG9nKClcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfX0gY2xhc3NOYW1lPVwiYnRuXCI+XG4gICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXBsdXNcIiBhcmlhLWhpZGRlbiAvPiBMw6RnZyB0aWxsIGVnZW4gdXBwZ2lmdFxuICAgICAgPC9hPlxuICAgIDwvZGl2ID5cbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFJlc291cmNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gXCIuL3JlbW92ZS1pdGVtXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHRlYWNoZXJzOiBSZXNvdXJjZVtdO1xuICBvblVwZGF0ZTogKHRlYWNoZXJzVXBkYXRlcykgPT4gdm9pZDtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgYWRkRW10cHlSb3c6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0YWJsZVRlYWNoZXJMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIG5hbWVFbGVtOiBIVE1MSW5wdXRFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlPXthZGRFbXRweVJvdzogcHJvcHMudGVhY2hlcnMubGVuZ3RoID09PSAwfTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBsZXQge3RlYWNoZXJzLCBvblVwZGF0ZX0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHthZGRFbXRweVJvd30gPSB0aGlzLnN0YXRlO1xuICAgIGlmIChhZGRFbXRweVJvdykgdGVhY2hlcnMgPSB0ZWFjaGVycy5jb25jYXQoe25hbWU6IFwiXCIsIHVybDogXCJcIn0pO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwidGVhY2hlcnMtbGlzdFwiPlxuICAgICAgPGgzPkFuc3ZhcmlnYSBsw6RyYXJlPC9oMz5cbiAgICAgIDx0YWJsZSB0YWJJbmRleD17MX0gc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fSBvbkJsdXI9e2V2PT5cbiAgICAgICAgKCFldi5yZWxhdGVkVGFyZ2V0IHx8XG4gICAgICAgIChldi5yZWxhdGVkVGFyZ2V0IGFzIGFueSkudGFnTmFtZSAhPT0gJ0lOUFVUJykgJiZcbiAgICAgICAgdGhpcy5wcm9wcy50ZWFjaGVycy5sZW5ndGggPiAwICYmXG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe2FkZEVtdHB5Um93OiBmYWxzZX0pXG4gICAgICB9PlxuICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAge3RlYWNoZXJzLmxlbmd0aCA+IDAgJiYgPHRyPlxuICAgICAgICAgICAgPHRoIHN0eWxlPXt7d2lkdGg6IFwiMjAlXCJ9fT5OYW1uPC90aD5cbiAgICAgICAgICAgIDx0aD5Mw6RuayBlbGxlciBFLXBvc3RhZHJlc3M8L3RoPlxuICAgICAgICAgIDwvdHI+fVxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAge3RlYWNoZXJzLm1hcCgodGVhY2hlciwgaWR4KSA9PiBcbiAgICAgICAgICA8dHIga2V5PXtpZHh9PlxuICAgICAgICAgICAgPHRkPjxpbnB1dCB0eXBlPVwidGV4dFwiIHJlZj17ZWxlbSA9PiB0aGlzLm5hbWVFbGVtID0gZWxlbX0gdmFsdWU9e3RlYWNoZXIubmFtZX0gYXV0b0ZvY3VzPXshdGVhY2hlci5uYW1lICYmIGlkeCA+IDB9IG9uQ2hhbmdlPXtcbiAgICAgICAgICAgICAgZXY9PntcbiAgICAgICAgICAgICAgICBpZiAoYWRkRW10cHlSb3cgJiYgaWR4ID09IHRlYWNoZXJzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgIG9uVXBkYXRlKHskcHVzaDogW3suLi50ZWFjaGVyLCBuYW1lOiBldi50YXJnZXQudmFsdWV9XSB9KTtcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2FkZEVtdHB5Um93OiBmYWxzZX0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXYudGFyZ2V0LnZhbHVlIHx8IHRlYWNoZXIudXJsKSB7XG4gICAgICAgICAgICAgICAgICBvblVwZGF0ZSh7JHNwbGljZTogW1tpZHgsIDEsIHsuLi50ZWFjaGVyLCBuYW1lOiBldi50YXJnZXQudmFsdWV9XV0gfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnRlYWNoZXJzLmxlbmd0aCA9PT0gMSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7YWRkRW10cHlSb3c6IHRydWV9KTtcbiAgICAgICAgICAgICAgICAgIG9uVXBkYXRlKHskc3BsaWNlOiBbW2lkeCwgMV1dfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9Lz48L3RkPlxuICAgICAgICAgICAgPHRkPjxpbnB1dFxuICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgIHN0eWxlPXt7d2lkdGg6IFwiMTAwJVwifX1cbiAgICAgICAgICAgICAgdmFsdWU9e3RlYWNoZXIudXJsfVxuICAgICAgICAgICAgICBvbktleURvd249e2V2ID0+XG4gICAgICAgICAgICAgICAgZXYud2hpY2ggPT09IDkgJiZcbiAgICAgICAgICAgICAgICAhZXYuc2hpZnRLZXkgJiZcbiAgICAgICAgICAgICAgICBpZHggPT09IHRlYWNoZXJzLmxlbmd0aCAtIDEgJiZcbiAgICAgICAgICAgICAgICAodGVhY2hlcnMubGVuZ3RoIDwgMSB8fCAhIXRlYWNoZXJzW3RlYWNoZXJzLmxlbmd0aCAtIDFdLm5hbWUgJiZcbiAgICAgICAgICAgICAgICAgICh0aGlzLnNldFN0YXRlKHthZGRFbXRweVJvdzogdHJ1ZX0pLGV2LnByZXZlbnREZWZhdWx0KCkpKX1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoYWRkRW10cHlSb3cgJiYgaWR4ID09IHRlYWNoZXJzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgIG9uVXBkYXRlKHskcHVzaDogW3suLi50ZWFjaGVyLCB1cmw6IGV2LnRhcmdldC52YWx1ZX1dfSlcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2FkZEVtdHB5Um93OiBmYWxzZX0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXYudGFyZ2V0LnZhbHVlIHx8IHRlYWNoZXIubmFtZSkge1xuICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzcGxpY2U6IFtbaWR4LCAxLCB7Li4udGVhY2hlciwgdXJsOiBldi50YXJnZXQudmFsdWV9XV19KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMudGVhY2hlcnMubGVuZ3RoID09PSAxKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHthZGRFbXRweVJvdzogdHJ1ZX0pO1xuICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzcGxpY2U6IFtbaWR4LCAxXV19KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9Lz48L3RkPlxuICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgICA8YnIvPlxuICAgICAgPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCkgPT5cbiAgICAgICAgdGhpcy5zdGF0ZS5hZGRFbXRweVJvdyA/XG4gICAgICAgICAgdGhpcy5uYW1lRWxlbS5mb2N1cygpIDpcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHthZGRFbXRweVJvdzogdHJ1ZX0pfT5cbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXVzZXItcGx1c1wiIGFyaWEtaGlkZGVuIC8+IEzDpGdnIHRpbGwgYW5zdmFyaWcgbMOkcmFyZTwvYT5cbiAgICA8L2Rpdj5cbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7UmVzb3VyY2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7TGlua30gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQge0lDb3Vyc2VFZGl0b3JIb3N0fSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvdXJzZS1lZGl0b3ItaG9zdCc7XG5pbXBvcnQge0VkaXRSZXNvdXJjZX0gZnJvbSAnLi4vbW9kYWwtcGFnZXMvZWRpdC1yZXNvdXJjZSc7XG5pbXBvcnQgeyB1cGRhdGVNb2RpZmljYXRpb25BbmRDcmVhdGlvblN0YW1wcyB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEVkaXRXb3JrZmxvd0xpbmsgfSBmcm9tICcuLi9tb2RhbC1wYWdlcy9lZGl0LXdvcmtmbG93LWxpbmsnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICB1cmw6IHN0cmluZztcbiAgb25VcGRhdGU6ICh1cGRhdGVzKSA9PiB2b2lkO1xuICBob3N0OiBJQ291cnNlRWRpdG9ySG9zdDtcbn1cblxuZXhwb3J0IGNsYXNzIEVkaXRhYmxlV29ya0Zsb3dMaW5rIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlPXt9O1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtob3N0LCBvblVwZGF0ZSwgdXJsfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIDxkaXY+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cbiAgICAgICAge3VybCAmJlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKT0+aG9zdC5vcGVuRGlhbG9nKHtcbiAgICAgICAgICAgICAgICBDb21wb25lbnQ6IEVkaXRXb3JrZmxvd0xpbmssXG4gICAgICAgICAgICAgICAgcHJvcHM6IHtcbiAgICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICAgIG9uU2F2ZTogbmV3VXJsID0+IHtcbiAgICAgICAgICAgICAgICAgICAgb25VcGRhdGUoeyRzZXQ6IG5ld1VybH0pO1xuICAgICAgICAgICAgICAgICAgICBob3N0LmNsb3NlRGlhbG9nKCk7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgb25EZWxldGU6ICgpPT57XG4gICAgICAgICAgICAgICAgICAgIG9uVXBkYXRlKHskc2V0OiB1bmRlZmluZWR9KTtcbiAgICAgICAgICAgICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSl9PjwvYT5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgPGEgaHJlZj17dXJsfSB0YXJnZXQ9XCJfYmxhbmtcIiA+TnV2YXJhbmRlIGFyYmV0c2fDpW5nPC9hPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIH1cbiAgICAgPC9kaXY+XG4gICAgeyF1cmwgJiYgPGEgY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCk9Pmhvc3Qub3BlbkRpYWxvZyh7XG4gICAgICBDb21wb25lbnQ6IEVkaXRXb3JrZmxvd0xpbmssXG4gICAgICBwcm9wczoge1xuICAgICAgICBvblNhdmU6IG5ld1VybCA9PiB7XG4gICAgICAgICAgb25VcGRhdGUoeyRzZXQ6IG5ld1VybH0pXG4gICAgICAgICAgaG9zdC5jbG9zZURpYWxvZygpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSl9PjxpIGNsYXNzTmFtZT1cImZhIGZhLXBhcGVyY2xpcFwiIGFyaWEtaGlkZGVuPjwvaT4gS29wcGxhIGVuIGFyYmV0c2fDpW5nIHRpbGwga3Vyc2VuPC9hPn1cbiAgICA8L2Rpdj5cbiAgfVxufVxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtBYmlsaXR5LCBLbm93bGVkZ2VSZXF1aXJlbWVudH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHtSZW1vdmVJdGVtfSBmcm9tICcuL3JlbW92ZS1pdGVtJztcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IEtub3dsZWRnZVJlcXVpcmVtZW50W107XG4gIGlkc1RvTWFya05vdE9rPzoge1tpZDogc3RyaW5nXTogdHJ1ZX07XG4gIGV4cGxhaW5lZFJlcXVpcmVtZW50cz86IHtbcmVxdWlyZW1lbnRJZDogc3RyaW5nXTogc3RyaW5nfVxuICAvLyBQcm9wcyB1c2VkIGluIGVkaXQgbW9kZSAoZWRpdGluZyBjb3Vyc2UgdGVtcGxhdGVzKVxuICAvL2NvdmVyZWRJZHM/OiBzdHJpbmdbXTtcbiAgLy8gUHJvcHMgdXNlZCBpbiBtYXJrIG1vZGUgKGVkaXRpbmcgdGFza3MpXG4gIG1hcmtNb2RlPzogYm9vbGVhbjtcbiAgbWFya2VkSWRzPzogc3RyaW5nW107XG4gIG1pZ3JhdGVkSWRzPzoge1tpZDogc3RyaW5nXTogYW55fTtcbiAgb25NYXJrQ2hhbmdlZDogKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSA9PiB2b2lkO1xuICBvbkV4cGxhaW5lZFJlcXVpcmVtZW50c0NoYW5nZWQ/OiAocmVxSWQ6IHN0cmluZywgdGV4dDogc3RyaW5nKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgS25vd2xlZGdlTWF0cml4IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCB7fT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBrbm93bGVkZ2VSZXF1aXJlbWVudHMsIG1hcmtlZElkcywgbWlncmF0ZWRJZHMsIGV4cGxhaW5lZFJlcXVpcmVtZW50cyB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IGlkc1RvTWFya05vdE9rLCBtYXJrTW9kZSwgb25NYXJrQ2hhbmdlZCwgb25FeHBsYWluZWRSZXF1aXJlbWVudHNDaGFuZ2VkIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgY29uc3QgY29sdW1ucyA9IFtcIkVcIiwgXCJDXCIsIFwiQVwiXTtcbiAgICBjb25zdCByb3dzOiBLbm93bGVkZ2VSZXF1aXJlbWVudFtdW10gPSBbXTtcbiAgICBjb25zdCByZXFzID0ga25vd2xlZGdlUmVxdWlyZW1lbnRzLnNsaWNlKCk7XG4gICAgbGV0IHJvdzogS25vd2xlZGdlUmVxdWlyZW1lbnRbXSB8IG51bGwgPSBudWxsO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICByb3cgPSBjb2x1bW5zLm1hcChncmFkZSA9PiB7XG4gICAgICAgIGNvbnN0IHBOZXh0ID0gcmVxcy5maW5kSW5kZXgociA9PiByLmdyYWRlU3RlcCAmJiByLmdyYWRlU3RlcC50b1VwcGVyQ2FzZSgpID09PSBncmFkZSk7XG4gICAgICAgIGlmIChwTmV4dCA8IDApIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCBydiA9IHJlcXNbcE5leHRdO1xuICAgICAgICByZXFzLnNwbGljZShwTmV4dCwgMSk7XG4gICAgICAgIHJldHVybiBydjtcbiAgICAgIH0pO1xuICAgICAgaWYgKHJvdy5ldmVyeShyID0+IHIgPT09IG51bGwpKVxuICAgICAgICBicmVhaztcbiAgICAgIHJvd3MucHVzaChyb3cpO1xuICAgIH1cblxuICAgIHJldHVybiA8ZGl2PlxuICAgICAgPHRhYmxlPlxuICAgICAgICA8dGhlYWQ+XG4gICAgICAgICAgPHRyPlxuICAgICAgICAgICAge2NvbHVtbnMubWFwKGMgPT4gPHRoIGtleT17Y30+e2N9PC90aD4pfVxuICAgICAgICAgIDwvdHI+XG4gICAgICAgIDwvdGhlYWQ+XG4gICAgICAgIDx0Ym9keT5cbiAgICAgICAgICB7cm93cy5tYXAoKHJvdyxpKSA9PiA8UmVhY3QuRnJhZ21lbnQga2V5PXtpfT5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAge3Jvdy5tYXAoKHJlcXVpcmVtZW50LGopID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc01hcmtlZE9LID0gcmVxdWlyZW1lbnQgJiYgbWFya2VkSWRzICYmIG1hcmtlZElkcy5pbmRleE9mKHJlcXVpcmVtZW50LmlkKSA+PSAwO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkTm90T0sgPSByZXF1aXJlbWVudCAmJiBpZHNUb01hcmtOb3RPayAmJiBpZHNUb01hcmtOb3RPa1tyZXF1aXJlbWVudC5pZF07XG4gICAgICAgICAgICAgICAgY29uc3QgaXNNaWdyYXRlZCA9IHJlcXVpcmVtZW50ICYmIG1pZ3JhdGVkSWRzICYmICEhbWlncmF0ZWRJZHNbcmVxdWlyZW1lbnQuaWRdO1xuICAgICAgICAgICAgICAgIHJldHVybiA8dGRcbiAgICAgICAgICAgICAgICAgIGtleT17an1cbiAgICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiByZXF1aXJlbWVudCA/IHJlcXVpcmVtZW50Lm5hbWUgOiBcIlwifX1cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17KG1hcmtNb2RlID8gXCJzZWxlY3RhYmxlXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAoaXNNaWdyYXRlZCA/IFwiIG1pZ3JhdGVkXCIgOiBcIlwiKSArXG4gICAgICAgICAgICAgICAgICAoaXNNYXJrZWRPSyA/XG4gICAgICAgICAgICAgICAgICAgIFwiIG1hcmtlZEdyZWVuXCIgOlxuICAgICAgICAgICAgICAgICAgICAoaXNNYXJrZWROb3RPSyA/XG4gICAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XG4gICAgICAgICAgICAgICAgICAgICAgXCJcIikpfVxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXttYXJrTW9kZSAmJiByZXF1aXJlbWVudCA/XG4gICAgICAgICAgICAgICAgICAgICAgKCk9Pm9uTWFya0NoYW5nZWQocmVxdWlyZW1lbnQuaWQsICFpc01hcmtlZE9LKSA6XG4gICAgICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkfVxuICAgICAgICAgICAgICAgICAgICB0aXRsZT17aXNNaWdyYXRlZCA/XG4gICAgICAgICAgICAgICAgICAgICAgbWFya01vZGUgP1xuICAgICAgICAgICAgICAgICAgICAgICAgYFNrb2x2ZXJrZXQgaGFyIHVwcGRhdGVyYXQgdGV4dGVucyBmb3JtdWxlcmluZy4gRHUga2FuIGdyYW5za2Egw6RuZHJpbmdlbiBnZW5vbSBhdHQgZsOkbGxhIHV0IHZhcm5pbmdzYm94ZW4gdGlsbCBow7ZnZXIsIG1lZCB0aXRlbCBcIlVwcGRhdGVyYWRlIGZvcm11bGVyaW5nYXIgZnLDpW4gU2tvbHZlcmtldFwiYCA6XG4gICAgICAgICAgICAgICAgICAgICAgICBgU2tvbHZlcmtldCBoYXIgdXBwZGF0ZXJhdCB0ZXh0ZW5zIGZvcm11bGVyaW5nLCBtZW4gZGV0dGEgaGFyIMOkbm51IGludGUgZ3JhbnNrYXRzIGF2IHVwcGdpZnRlbnMgcmVkaWdlcmluZ3NiZWjDtnJpZ2VgIDpcbiAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWR9IC8+XG4gICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICAgIHtleHBsYWluZWRSZXF1aXJlbWVudHMgJiYgPHRyPlxuICAgICAgICAgICAgICB7cm93Lm1hcCgocmVxdWlyZW1lbnQsaikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkT0sgPSByZXF1aXJlbWVudCAmJiBtYXJrZWRJZHMgJiYgbWFya2VkSWRzLmluZGV4T2YocmVxdWlyZW1lbnQuaWQpID49IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDx0ZCBrZXk9e2p9PlxuICAgICAgICAgICAgICAgICAge2lzTWFya2VkT0sgPyA8dGV4dGFyZWFcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e0xgQmVza3JpdiBrcmF2ZXRgfVxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJpbnB1dFRleHRCb3ggaW5wdXRUZXh0TGFyZ2VcIiBzdHlsZT17e3dpZHRoOiBcIjEwMCVcIn19XG4gICAgICAgICAgICAgICAgICAgIHJlYWRPbmx5PXshbWFya01vZGV9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXtleHBsYWluZWRSZXF1aXJlbWVudHNbcmVxdWlyZW1lbnQuaWRdIHx8IFwiXCJ9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkV4cGxhaW5lZFJlcXVpcmVtZW50c0NoYW5nZWQgJiYgKFxuICAgICAgICAgICAgICAgICAgICAgIGV2ID0+IG9uRXhwbGFpbmVkUmVxdWlyZW1lbnRzQ2hhbmdlZChyZXF1aXJlbWVudC5pZCwgZXYudGFyZ2V0LnZhbHVlKSl9XG4gICAgICAgICAgICAgICAgICAvPiA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgICAgIDwvdGQ+fSl9XG4gICAgICAgICAgICA8L3RyPn1cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+XG5cbiAgICB7LypyZXR1cm4gPGRpdj5cbiAgICAgIDx0YWJsZT5cbiAgICAgICAgPHRoZWFkPlxuICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgIDx0aD5FPC90aD5cbiAgICAgICAgICAgIDx0aD5DPC90aD5cbiAgICAgICAgICAgIDx0aD5BPC90aD5cbiAgICAgICAgICA8L3RyPlxuICAgICAgICA8L3RoZWFkPlxuICAgICAgICA8dGJvZHk+XG4gICAgICAgICAge3Rib2R5Lm1hcCgocm93LCBpKSA9PiBcbiAgICAgICAgICA8dHIga2V5PXtpfT57cm93Lm1hcCgoY2VsbCwgaikgPT4ge1xuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWRPSyA9IHByb3BzLm1hcmtlZElkcyAmJiBwcm9wcy5tYXJrZWRJZHMuaW5kZXhPZihjZWxsLmlkKSA+PSAwO1xuICAgICAgICAgICAgY29uc3QgaXNNYXJrZWROb3RPSyA9IHByb3BzLmlkc1RvTWFya05vdE9rICYmIHByb3BzLmlkc1RvTWFya05vdE9rW2NlbGwuaWRdO1xuICAgICAgICAgICAgcmV0dXJuIDx0ZFxuICAgICAgICAgICAgICBrZXk9e2p9XG4gICAgICAgICAgICAgIHJvd1NwYW49e2NlbGwucm93U3Bhbn1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXsocHJvcHMubWFya01vZGUgPyBcInNlbGVjdGFibGVcIiA6IFwiXCIpICtcbiAgICAgICAgICAgICAgICAoaXNNYXJrZWRPSyA/XG4gICAgICAgICAgICAgICAgICBcIiBtYXJrZWRHcmVlblwiIDpcbiAgICAgICAgICAgICAgICAgIChpc01hcmtlZE5vdE9LID9cbiAgICAgICAgICAgICAgICAgICAgXCIgbWFya2VkUmVkXCI6XG4gICAgICAgICAgICAgICAgICAgIFwiXCIpKX1cbiAgICAgICAgICAgICAgb25DbGljaz17cHJvcHMubWFya01vZGUgJiYgKCgpPT5wcm9wcy5vbk1hcmtDaGFuZ2VkKGNlbGwuaWQsICFpc01hcmtlZE9LKSl9PlxuICAgICAgICAgICAgICB7Y2VsbC5odG1sICYmIDxkaXYgc3R5bGU9e3twb3NpdGlvbjogJ3JlbGF0aXZlJ319PlxuICAgICAgICAgICAgICAgIDxwXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NlbGwudHlwZSA9PT0gJ2FiaWxpdHknID8gJ2FiaWxpdHlUZXh0JyA6ICdjcml0ZXJpYVRleHQnfVxuICAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGNlbGwuaHRtbH19IC8+XG4gICAgICAgICAgICAgICAge3Byb3BzLmVkaXRNb2RlICYmIDxSZW1vdmVJdGVtIGNsYXNzTmFtZT1cInVwcGVyUmlnaHRcIiBvbkNsaWNrPXsoKT0+XG4gICAgICAgICAgICAgICAgICB0aGlzLnNldENlbGxJZHMoXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5yb3dJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDZWxsSWRzKFxuICAgICAgICAgICAgICAgICAgICAgIGNlbGwudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICBjZWxsLnJvd0luZGV4KS5maWx0ZXIoaWQgPT4gaWQgIT0gY2VsbC5pZCkgKX0gLz4gfVxuICAgICAgICAgICAgICA8L2Rpdj59XG4gICAgICAgICAgICA8L3RkPn0pfVxuICAgICAgICAgIDwvdHI+KX1cbiAgICAgICAgPC90Ym9keT5cbiAgICAgIDwvdGFibGU+XG4gICAgPC9kaXY+Ki99XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvdXRpbHNcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgb25DbGljayxcbiAgY2xhc3NOYW1lPyxcbiAgc3R5bGU/LFxuICB0aXRsZT9cbn07XG5cbmV4cG9ydCBjb25zdCBSZW1vdmVJdGVtID0gKHsgb25DbGljaywgY2xhc3NOYW1lLCBzdHlsZSwgdGl0bGUgfTogUHJvcHMpID0+XG5cbiAgPGRpdlxuICAgIHRpdGxlPXt0aXRsZSB8fCBMYFJhZGVyYWB9XG4gICAgY2xhc3NOYW1lPXtcInJlbW92ZUl0ZW0gXCIgKyAoY2xhc3NOYW1lIHx8IFwiXCIpfVxuICAgIG9uQ2xpY2s9e29uQ2xpY2t9IHN0eWxlPXtzdHlsZX0gLz5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwsIHNob3dFcnJvciwgY29tcGFyZVByb3AgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2UgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcbmltcG9ydCB7IG15U2Nob29sQ291cnNlc1JlcG8gfSBmcm9tIFwiLi4vLi4vLi4vcmVwb3Mvc2Nob29sLWNvdXJzZXNcIjtcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi9zcGlubmVyXCI7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBzaG9ydERhdGVGb3JtYXQgfSBmcm9tIFwiLi4vdXRpbHNcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgc2Nob29sQ291cnNlczogQ291cnNlW10gfCBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgU2Nob29sQ291cnNlcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNjaG9vbENvdXJzZXM6IG51bGxcbiAgICB9XG4gICAgdGhpcy5vblNjaG9vbENvdXJzZXNVcGRhdGVkID0gdGhpcy5vblNjaG9vbENvdXJzZXNVcGRhdGVkLmJpbmQodGhpcyk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBteVNjaG9vbENvdXJzZXNSZXBvLnN1YnNjcmliZSh0aGlzLm9uU2Nob29sQ291cnNlc1VwZGF0ZWQpLmNhdGNoKHNob3dFcnJvcik7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBteVNjaG9vbENvdXJzZXNSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25TY2hvb2xDb3Vyc2VzVXBkYXRlZCk7XG4gIH1cblxuICBvblNjaG9vbENvdXJzZXNVcGRhdGVkKHNjaG9vbENvdXJzZXM6IENvdXJzZVtdKSB7XG4gICAgY29uc3QgY29tcGFyZU5hbWUgPSBjb21wYXJlUHJvcChcIm5hbWVcIik7XG4gICAgY29uc3QgY29tcGFyZUNyZWF0ZWREYXRlID0gY29tcGFyZVByb3AoXCJjcmVhdGVkRGF0ZVwiKTtcbiAgICBzY2hvb2xDb3Vyc2VzLnNvcnQoKGEsYikgPT4gY29tcGFyZU5hbWUoYSxiKSB8fCBjb21wYXJlQ3JlYXRlZERhdGUoYSxiKSk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7c2Nob29sQ291cnNlc30pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtzY2hvb2xDb3Vyc2VzfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XG4gICAgICAgIDxoMz5Ta29sYW5zIGt1cnNlcjwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lciBvZGQtZXZlblwiPlxuICAgICAgICAgIHshc2Nob29sQ291cnNlcyA/XG4gICAgICAgICAgICA8cD48U3Bpbm5lciAvPiBMYWRkYXIgc2tvbGFucyBrdXJzZXI8L3A+IDpcbiAgICAgICAgICAgIHNjaG9vbENvdXJzZXMubWFwKGNvdXJzZSA9PiA8ZGl2IGNsYXNzTmFtZT1cInNjaG9vbENvdXJzZVwiIGtleT17Y291cnNlLmlkfT5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcCBwdWxsLXJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAgICAgIHRvPXtgL2NvdXJzZXMvJHtjb3Vyc2UuaWR9L2VkaXRgfVxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIlxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIDxMaW5rIHRvPXtgL2NvdXJzZXMvJHtjb3Vyc2UuaWR9L2VkaXRgfT57Y291cnNlLm5hbWV9PC9MaW5rPjwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlICYmIDxkaXYgY2xhc3NOYW1lPVwicGlsbCBhY3RpdmVcIj5Ba3RpdjwvZGl2Pn1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIHtjb3Vyc2UuYWN0aXZlICYmICFjb3Vyc2UucHVibGlzaGFibGUgJiYgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInBpbGwgaW5jb21wbGV0ZVwiPklua29tcGxldHQ8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxuICAgICAgICAgICAgICA8cD57Y291cnNlLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cbiAgICAgICAgICAgICAge2NvdXJzZS5tb2RpZmllZEJ5ID9cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPlJlZGlnZXJhZCBhdiB7Y291cnNlLm1vZGlmaWVkQnkubmFtZX0gLyB7c2hvcnREYXRlRm9ybWF0KGNvdXJzZS5tb2RpZmllZERhdGUpfTwvcD4gOlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInNtYWxsXCIgc3R5bGU9e3tmb250U3R5bGU6ICdpdGFsaWMnfX0+IDwvcD59XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj4pfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2xvY2F0aW9uLmhhc2ggIT09IFwiIy9jb3Vyc2VzL25ld1wiICYmIDxMaW5rXG4gICAgICAgICAgY2xhc3NOYW1lPVwiYnRuXCJcbiAgICAgICAgICB0bz1cIi9jb3Vyc2VzL25ld1wiXG4gICAgICAgICAgb25DbGljaz17KCk9PndpbmRvdy5zY3JvbGwoMCwgMCl9PlxuICAgICAgICAgIFNrYXBhIG55IGt1cnNcbiAgICAgICAgPC9MaW5rPn1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBDb3Vyc2UsIENvdXJzZU1vZHVsZSwgVGFzaywgRG9jdW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBPcGVuQ2xvc2VCb3ggfSBmcm9tIFwiLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94XCI7XG5pbXBvcnQgeyBhcnJheVRvTG9va3VwIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgZ2V0VW5jb3ZlcmVkS25vd2xlZGdlUmVxdWlyZW1lbnRzIH0gZnJvbSAnLi4vY291cnNlcy9idXNpbmVzcy1sb2dpYyc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIG9wdGlvbnM6IChEb2N1bWVudCAmIHtncm91cD86IHN0cmluZ30pW107XG4gIHRpdGxlO1xuICBtYXJrTW9kZTogYm9vbGVhbjtcbiAgbWFya2VkSWRzOiBzdHJpbmdbXTtcbiAgbWlncmF0ZWRJZHM/OiB7W2lkOiBzdHJpbmddOiBhbnl9O1xuICB1bmNvdmVyZWRJZHM/OiB7W2lkOiBzdHJpbmddOiB0cnVlfTtcbiAgb25NYXJrQ2hhbmdlZDogKGlkOiBzdHJpbmcsIGlzTWFya2VkOiBib29sZWFuKSA9PiB2b2lkO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xufVxuXG5leHBvcnQgY2xhc3MgU2VsZWN0UmVsYXRlZERvY3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7fTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7b3B0aW9ucywgdGl0bGUsIG1hcmtlZElkcywgbWFya01vZGUsIG1pZ3JhdGVkSWRzLCB1bmNvdmVyZWRJZHN9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBncm91cGVkT3B0aW9ucyA9IGFycmF5VG9Mb29rdXAob3B0aW9ucywgZCA9PiBkLmdyb3VwIHx8IFwiZGVmYXVsdFwiKTtcbiAgICBjb25zdCBncm91cHMgPSBPYmplY3Qua2V5cyhncm91cGVkT3B0aW9ucyk7XG4gICAgcmV0dXJuIDxPcGVuQ2xvc2VCb3ggdGl0bGU9ezxwPnt0aXRsZX08L3A+fSBjbGFzc05hbWU9XCJsYXJnZXJcIj5cbiAgICAgICAge2dyb3Vwcy5tYXAoZ3JvdXAgPT4gPFJlYWN0LkZyYWdtZW50IGtleT17Z3JvdXB9PlxuICAgICAgICAgIHtncm91cHMubGVuZ3RoID09PSAxID8gbnVsbCA6IDw+PGJyLz48aDU+e2dyb3VwfTwvaDU+PGhyLz48Lz59XG4gICAgICAgICAge2dyb3VwZWRPcHRpb25zW2dyb3VwXS5tYXAob3B0aW9uID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzTWFya2VkID0gbWFya2VkSWRzLnNvbWUoeCA9PiB4ID09PSBvcHRpb24uaWQpO1xuICAgICAgICAgICAgY29uc3QgaXNNaWdyYXRlZCA9IG1pZ3JhdGVkSWRzICYmICEhbWlncmF0ZWRJZHNbb3B0aW9uLmlkXTtcbiAgICAgICAgICAgIGNvbnN0IGlzVW5jb3ZlcmVkID0gdW5jb3ZlcmVkSWRzICYmIHVuY292ZXJlZElkc1tvcHRpb24uaWRdO1xuICAgICAgICAgICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiIGtleT17b3B0aW9uLmlkfSBvbkNsaWNrPXsoKT0+XG4gICAgICAgICAgICAgIG1hcmtNb2RlICYmIHRoaXMucHJvcHMub25NYXJrQ2hhbmdlZChvcHRpb24uaWQsICFpc01hcmtlZCl9PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCIgK1xuICAgICAgICAgICAgICAgIChtYXJrTW9kZSA/IFwiIHNlbGVjdGFibGVcIiA6IFwiXCIpICtcbiAgICAgICAgICAgICAgICAoaXNNYXJrZWQgPyBcIiBtYXJrZWRHcmVlblwiIDogKGlzVW5jb3ZlcmVkID9cbiAgICAgICAgICAgICAgICAgIFwiIG1hcmtlZFJlZFwiOlxuICAgICAgICAgICAgICAgICAgXCJcIikpICtcbiAgICAgICAgICAgICAgICAoaXNNaWdyYXRlZCA/IFwiIG1pZ3JhdGVkXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICB0aXRsZT17aXNNaWdyYXRlZCA/XG4gICAgICAgICAgICAgICAgICBtYXJrTW9kZSA/XG4gICAgICAgICAgICAgICAgICAgIGBTa29sdmVya2V0IGhhciB1cHBkYXRlcmF0IHRleHRlbnMgZm9ybXVsZXJpbmcuIER1IGthbiBncmFuc2thIMOkbmRyaW5nZW4gZ2Vub20gYXR0IGbDpGxsYSB1dCB2YXJuaW5nc2JveGVuIHRpbGwgaMO2Z2VyLCBtZWQgdGl0ZWwgXCJVcHBkYXRlcmFkZSBmb3JtdWxlcmluZ2FyIGZyw6VuIFNrb2x2ZXJrZXRcImAgOlxuICAgICAgICAgICAgICAgICAgICBgU2tvbHZlcmtldCBoYXIgdXBwZGF0ZXJhdCB0ZXh0ZW5zIGZvcm11bGVyaW5nLCBtZW4gZGV0dGEgaGFyIMOkbm51IGludGUgZ3JhbnNrYXRzIGF2IHVwcGdpZnRlbnMgcmVkaWdlcmluZ3NiZWjDtnJpZ2VgIDpcbiAgICAgICAgICAgICAgICAgIHVuZGVmaW5lZH0+XG4gICAgICAgICAgICAgICAgPHAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IG9wdGlvbi5uYW1lfX0gLz5cbiAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj47XG4gICAgICAgICAgfSl9XG4gICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+KX1cbiAgICA8L09wZW5DbG9zZUJveD5cbiAgfVxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuZXhwb3J0IGNvbnN0IFNwaW5uZXIgPSAoKT0+IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4mbmJzcDs8L3NwYW4+O1xuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgZ2V0VGFza3NQZXJJZCB9IGZyb20gXCIuLi9jb3Vyc2VzL2J1c2luZXNzLWxvZ2ljXCI7XG5pbXBvcnQgeyBmdXR1cmVBYmlsaXRpZXMgfSBmcm9tIFwiLi4vLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gXCIuLi8uLi91dGlsaXR5LWNvbXBvbmVudHMvb3Blbi1jbG9zZS1ib3hcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY291cnNlOiBDb3Vyc2U7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIGlzT3BlbjogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIFdlaWdodGVkSXRlbXNUYWJsZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGlzT3BlbjogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgaXNPcGVuIH0gPSB0aGlzLnN0YXRlO1xuICAgIGNvbnN0IHJvd3MgPSBbXTtcbiAgICBjb25zdCB0YXNrc1BlcklkID0gZ2V0VGFza3NQZXJJZChjb3Vyc2UpO1xuXG4gICAgcm93cy5wdXNoKDx0ciBrZXk9XCJjZW50cmFsQ29udGVudFwiIGNsYXNzTmFtZT1cImNvdmVyZWQtaXRlbS1sYWJlbFwiPjx0ZCBjb2xTcGFuPXsyfT5DZW50cmFsdCBpbm5laMOlbGw8L3RkPjwvdHI+KTtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQuZm9yRWFjaCgoY2MsaWR4KSA9PiByb3dzLnB1c2goPHRyIGtleT17Y2MuaWR9IGNsYXNzTmFtZT17aWR4ICUgMiA/IFwidGFibGVPZGRcIiA6IFwiXCJ9PlxuICAgICAgPHRkPjxwIGNsYXNzTmFtZT1cImNyaXRlcmlhVGV4dFwiIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjYy5uYW1lfX0vPjwvdGQ+XG4gICAgICA8dGQ+PHA+eyh0YXNrc1BlcklkW2NjLmlkXSB8fCBbXSkubGVuZ3RofTwvcD48L3RkPlxuICAgIDwvdHI+KSk7XG5cbiAgICByb3dzLnB1c2goPHRyIGtleT1cImFiaWxpdGllc1wiIGNsYXNzTmFtZT1cImNvdmVyZWQtaXRlbS1sYWJlbFwiPjx0ZCBjb2xTcGFuPXsyfT5Gw7ZybcOlZ29yPC90ZD48L3RyPik7XG4gICAgY291cnNlLmFiaWxpdGllcy5mb3JFYWNoKChhYmlsaXR5LGlkeCkgPT4gcm93cy5wdXNoKDx0ciBrZXk9e2FiaWxpdHkuaWR9IGNsYXNzTmFtZT17aWR4ICUgMiA/IFwidGFibGVPZGRcIiA6IFwiXCJ9PlxuICAgICAgPHRkPjxwIGNsYXNzTmFtZT1cImFiaWxpdHlUZXh0XCIgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGFiaWxpdHkubmFtZX19Lz48L3RkPlxuICAgICAgPHRkPjxwPnsodGFza3NQZXJJZFthYmlsaXR5LmlkXSB8fCBbXSkubGVuZ3RofTwvcD48L3RkPlxuICAgIDwvdHI+KSk7XG5cbiAgICByb3dzLnB1c2goPHRyIGtleT1cImZ1dHVyZUFiaWxpdGllc1wiIGNsYXNzTmFtZT1cImNvdmVyZWQtaXRlbS1sYWJlbFwiPjx0ZCBjb2xTcGFuPXsyfT5GcmFtdGlkc2bDtnJtw6Vnb3I8L3RkPjwvdHI+KTtcbiAgICAgZnV0dXJlQWJpbGl0aWVzLmZvckVhY2goKGZ1dHVyZUFiaWxpdHlUZXh0LCBpZHgpID0+IHJvd3MucHVzaCg8dHIga2V5PXtmdXR1cmVBYmlsaXR5VGV4dH0gY2xhc3NOYW1lPXtpZHggJSAyID8gXCJ0YWJsZU9kZFwiIDogXCJcIn0+XG4gICAgICA8dGQ+PHAgY2xhc3NOYW1lPVwiYWJpbGl0eVRleHRcIj57ZnV0dXJlQWJpbGl0eVRleHR9PC9wPjwvdGQ+XG4gICAgICA8dGQ+PHA+eyh0YXNrc1BlcklkW2Z1dHVyZUFiaWxpdHlUZXh0XSB8fCBbXSkubGVuZ3RofTwvcD48L3RkPlxuICAgIDwvdHI+KSk7XG5cbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveFxuICAgICAgY2xhc3NOYW1lPVwibGFyZ2VyXCJcbiAgICAgIHRpdGxlPXs8cD5LdXJzZW5zIHTDpGNrbmluZ3N0YWJlbGw8L3A+fVxuICAgICAgY29udGVudENsYXNzTmFtZT1cIndlaWdodGVkLWl0ZW1zLXRhYmxlXCI+XG4gICAgICAgIDxwPlRhYmVsbGVuIGFuZ2VyIGh1ciBtw6VuZ2EgdXBwZ2lmdGVyIHNvbSBiZXLDtnIgdmFyamUgZGVsLjwvcD5cbiAgICAgICAgPHRhYmxlPjx0Ym9keT57cm93c308L3Rib2R5PjwvdGFibGU+XG4gICAgPC9PcGVuQ2xvc2VCb3g+XG4gIH1cbn0iLCJpbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBTdWJqZWN0LCBDb3Vyc2UsIEFiaWxpdHksIEtub3dsZWRnZVJlcXVpcmVtZW50LCBDZW50cmFsQ29udGVudCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCB7IFN1YmplY3RUb0ltcG9ydCB9IGZyb20gJy4uL3N1YmplY3QtdG8taW1wb3J0JztcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gJy4vY2hhbmdlJztcbmltcG9ydCB7IG1pZ3JhdGVPcmRlckxpc3RzT2ZDb3Vyc2VJbnN0YW5jZXMsIG1pZ3JhdGVBYmlsaXRpZXNPcmRlck9uU3ViamVjdCB9IGZyb20gJy4vbWlncmF0aW9ucyc7XG5pbXBvcnQgeyBtaWdyYXRlU3ViamVjdCB9IGZyb20gJy4vbWlncmF0ZS1zdWJqZWN0JztcbmltcG9ydCB7IGxvYWRDb3Vyc2UgfSBmcm9tICcuLi8uLi91dGlscyc7XG5pbXBvcnQgeyBDb3Vyc2VTZXQgfSBmcm9tICcuL2NvdXJzZS1zZXQnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGlmZlhtbFdpdGhEYXRhYmFzZShleGlzdGluZ1N1YmplY3Q6IFN1YmplY3QsIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0LCBjaGFuZ2VzOiBDaGFuZ2VbXSkge1xuICAvLyBFeHBhbmQgZ3JhcGhzIG9mIGV4aXN0aW5nIFN1YmplY3RcbiAgZXhpc3RpbmdTdWJqZWN0ID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZ2V0KCdzdWJqZWN0cycsIGV4aXN0aW5nU3ViamVjdC5pZCwgeyBpbmNsdWRlOiBbXCJjb3Vyc2VUZW1wbGF0ZXNcIiwgXCJhYmlsaXRpZXNcIl0gfSk7XG4gIC8vIExhemlseSBsb2FkIGFsbCBjZW50cmFsIGNvbnRlbnRzIGFuZCBrbm93bGVkZ2VSZXF1aXJlbWVudHMgb25cbiAgLy8gZWFjaCBjb3Vyc2UgdGVtcGxhdGVcbiAgY29uc3QgZXhwYW5kZWRDb3Vyc2VUZW1wbGF0ZXMgPSBhd2FpdCBQcm9taXNlLmFsbChleGlzdGluZ1N1YmplY3QuY291cnNlVGVtcGxhdGVzLm1hcChjdCA9PiBsb2FkQ291cnNlKGN0LmlkLCB7XG4gICAgaW5jbHVkZTogW1xuICAgICAgJ2NlbnRyYWxDb250ZW50JyxcbiAgICAgICdrbm93bGVkZ2VSZXF1aXJlbWVudHMnXG4gICAgXVxuICB9KSkpO1xuXG4gIGNvbnNvbGUubG9nKGBTdWJqZWN0OiAke2V4aXN0aW5nU3ViamVjdC5uYW1lfS4gQ291cnNlczogJHtleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5tYXAoKHtuYW1lfSkgPT4gbmFtZSl9YCk7XG5cbiAgY29uc3QgY291cnNlU2V0czogQ291cnNlU2V0W10gPSBhd2FpdCBQcm9taXNlLmFsbChleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5tYXAgKGFzeW5jIGNvdXJzZVRlbXBsYXRlID0+ICh7XG4gICAgdGVtcGxhdGU6IGNvdXJzZVRlbXBsYXRlLFxuICAgIGluc3RhbmNlczogYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxDb3Vyc2U+KFwiY291cnNlc1wiLCB7IG5hbWU6IGNvdXJzZVRlbXBsYXRlLm5hbWUsIGluY2x1ZGU6IFsnYWJpbGl0aWVzJ10sIGZsYWdzOiBbJ2luY2x1ZGVJZHNPbmx5J10gfSlcbiAgfSkpKTtcblxuICAvKmlmIChleHBhbmRlZENvdXJzZVRlbXBsYXRlcy5zb21lIChjb3Vyc2UgPT4gIWNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyIHx8ICFjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIgfHwgIWNvdXJzZS5hYmlsaXRpZXNPcmRlcikpIHtcbiAgICBtaWdyYXRlT3JkZXJMaXN0c09mQ291cnNlSW5zdGFuY2VzKGNvdXJzZVNldHMsIHN1YmplY3RUb0ltcG9ydCwgY2hhbmdlcyk7XG4gICAgLy8gSW4gZnV0dXJlLCBhcyBhYmlsaXRpZXMgbWF5IGJlIGFkZGVkIG9yIHJlbW92ZWQsIHdlIHdpbGwgaGF2ZSB0byBtYWludGFpbiB0aGUgb3JkZXIgb2YgYWJpbGl0aWVzIG9uIHRoZSBjb3Vyc2UgaW5zdGFuY2VzLFxuICAgIC8vIHRoZSBzYW1lIHdheSB3ZSBkbyBpdCB3aXRoIGNlbnRyYWwgY29udGVudCBhbmQga25vd2xlZGdlIHJlcXVpcmVtZW50cy4gVE9ETyByZXNwZWN0IGFiaWxpdGllcyBvcmRlciBvbiBldmVyeSBwbGFjZSBhYmlsaXRpZXMgYXJlIGVudW1lcmF0ZWQsXG4gICAgLy8gc3VjaCBhcyBvbiBjb3Vyc2Ugdmlld2VyLCBjb3Vyc2UgYnVpbGRlciwgZXRjLlxuICAgIG1pZ3JhdGVBYmlsaXRpZXNPcmRlck9uU3ViamVjdChleGlzdGluZ1N1YmplY3QsIGNvdXJzZVNldHMsIGNoYW5nZXMpO1xuICB9IGVsc2UgeyovXG4gICAgYXdhaXQgbWlncmF0ZVN1YmplY3QoZXhpc3RpbmdTdWJqZWN0LCBjb3Vyc2VTZXRzLCBzdWJqZWN0VG9JbXBvcnQsIGNoYW5nZXMpO1xuICAvL31cbn1cblxuIiwiaW1wb3J0IHsgU3ViamVjdCwgQ291cnNlLCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQWJpbGl0eSwgQ2VudHJhbENvbnRlbnQsIFRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcbmltcG9ydCB7IFN1YmplY3RUb0ltcG9ydCwgQ291cnNlVG9JbXBvcnQgfSBmcm9tIFwiLi4vc3ViamVjdC10by1pbXBvcnRcIjtcbmltcG9ydCB7IENoYW5nZSB9IGZyb20gXCIuL2NoYW5nZVwiO1xuaW1wb3J0IHsgQ291cnNlU2V0IH0gZnJvbSAnLi9jb3Vyc2Utc2V0JztcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEJhdGNoUnVubmVyLCBNdXRhdGlvblJlcXVlc3QsIExpc3RPcHRpb25zIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgQXV0b1ZhbHVlTWFwIH0gZnJvbSAnLi4vLi4vLi4vLi4vdXRpbHMvYXV0by12YWx1ZS1tYXAnO1xuaW1wb3J0IHsgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcblxudHlwZSBJRCA9IHN0cmluZztcblxuZnVuY3Rpb24gZGlmZlN1YmplY3RHbG9iYWxUZXh0cyhkYlRleHRNYXA6IE1hcDxzdHJpbmcsIElEPiwgeG1sVGV4dHM6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IHJlbW92ZWRJZHMgPSBuZXcgU2V0PElEPigpO1xuICBjb25zdCBuZXdUZXh0cyA9IG5ldyBNYXA8c3RyaW5nLCBJRD4oKTtcbiAgY29uc3QgaWRzVG9BZGQgPSBuZXcgU2V0PElEPigpO1xuXG4gIHhtbFRleHRzLmZvckVhY2gobmV3VGV4dCA9PiB7XG4gICAgbmV3VGV4dCA9IG5ld1RleHQudHJpbSgpO1xuICAgIGlmICghZGJUZXh0TWFwLmhhcyhuZXdUZXh0KSkge1xuICAgICAgY29uc3QgaWQgPSBjcmVhdGVVVUlEKCk7XG4gICAgICBjb25zb2xlLmxvZyhgTmV3IGlkOiAke2lkfS4gVGV4dDogJHtuZXdUZXh0fWApO1xuICAgICAgbmV3VGV4dHMuc2V0KG5ld1RleHQsIGlkKTtcbiAgICAgIGlkc1RvQWRkLmFkZChpZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld1RleHRzLnNldChuZXdUZXh0LCBkYlRleHRNYXAuZ2V0KG5ld1RleHQpKTtcbiAgICB9XG4gIH0pO1xuXG4gIGZvciAoY29uc3QgW29sZFRleHQsIG9sZElkXSBvZiBkYlRleHRNYXAuZW50cmllcygpKSB7XG4gICAgaWYgKHhtbFRleHRzLmluZGV4T2Yob2xkVGV4dCkgPT09IC0xKSB7XG4gICAgICByZW1vdmVkSWRzLmFkZChvbGRJZCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICByZW1vdmVkSWRzLFxuICAgIG5ld1RleHRzLFxuICAgIGlkc1RvQWRkXG4gIH1cbn1cblxubGV0IF9maWN0aXZlT2xkSWQgPSAxO1xuZnVuY3Rpb24gZmljdGl2ZU9sZElkKCkge1xuICByZXR1cm4gXCJmaWN0aXZlT2xkSWRcIiArICgrK19maWN0aXZlT2xkSWQpO1xufVxuXG5jb25zdCBzdG9wV29yZHMgPSBuZXcgU2V0KFxuICAvLyBGcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWhhaVZhbGVudGluL2x1bnItbGFuZ3VhZ2VzL2Jsb2IvbWFzdGVyL2x1bnIuc3YuanMjTDI1MlxuICAoJ2FsbGEgYWxsdCBhdHQgYXYgYmxldiBibGkgYmxpciBibGl2aXQgZGUgZGVtIGRlbiBkZW5uYSBkZXJhcyBkZXNzIGRlc3NhIGRldCBkZXR0YSBkaWcgZGluIGRpbmEgZGl0dCBkdSBkw6RyIGTDpSBlZnRlciBlaiBlbGxlciBlbiBlciBlcmEgZXJ0IGV0dCBmcsOlbiBmw7ZyIGhhIGhhZGUgaGFuIGhhbnMgaGFyIGhlbm5lIGhlbm5lcyBob24gaG9ub20gaHVyIGjDpHIgaSBpY2tlIGluZ2VuIGlub20gaW50ZSBqYWcganUga2FuIGt1bmRlIG1hbiBtZWQgbWVsbGFuIG1lbiBtaWcgbWluIG1pbmEgbWl0dCBtb3QgbXlja2V0IG5pIG51IG7DpHIgbsOlZ29uIG7DpWdvdCBuw6VncmEgb2NoIG9tIG9zcyBww6Ugc2FtbWEgc2VkYW4gc2lnIHNpbiBzaW5hIHNpdHRhIHNqw6RsdiBza3VsbGUgc29tIHPDpSBzw6VkYW4gc8OlZGFuYSBzw6VkYW50IHRpbGwgdW5kZXIgdXBwIHV0IHV0YW4gdmFkIHZhciB2YXJhIHZhcmbDtnIgdmFyaXQgdmFyamUgdmFycyB2YXJ0IHZlbSB2aSB2aWQgdmlsa2Egdmlsa2FzIHZpbGtlbiB2aWxrZXQgdsOlciB2w6VyYSB2w6VydCDDpG4gw6RyIMOldCDDtnZlcicgK1xuICAnIGtyaW5nJykgLy8gVGhpcyBsaW5lIGNvbnRhaW5zIGFkZGl0aW9uYWwgc3RvcC13b3JkcyBtaXNzaW5nIGluIGx1bnIuc3YuXG4gIC5zcGxpdCgnICcpKTtcblxuZnVuY3Rpb24gZ2V0TGV4ZW1lcyhodG1sOiBzdHJpbmcpOiBTZXQ8c3RyaW5nPiB7XG4gIHJldHVybiBuZXcgU2V0KHJlbW92ZVRhZ3MoaHRtbCkucmVwbGFjZSgvW15cXHdcXHPDpcOkw7ZdL2dpLCAnJykudG9Mb3dlckNhc2UoKS5zcGxpdCgvXFxzLylcbiAgICAubWFwKGxleGVtZSA9PiBsZXhlbWUudHJpbSgpKVxuICAgIC5maWx0ZXIobGV4ZW1lID0+ICEhbGV4ZW1lKVxuICAgIC5maWx0ZXIobGV4ZW1lID0+ICFzdG9wV29yZHMuaGFzKGxleGVtZSkpXG4gICk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVRhZ3MoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi5pbm5lckhUTUwgPSBodG1sO1xuICByZXR1cm4gJycrZGl2LmlubmVyVGV4dDtcbn1cblxuZnVuY3Rpb24gZ2V0SWRzVG9NaWdyYXRlKFxuICBkYlRleHRzOiB7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10sXG4gIHhtbFRleHRzOiB7aHRtbDogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10sXG4gIG5ld1RleHRzOiBNYXA8c3RyaW5nLCBJRD4sXG4gIHRleHRUeXBlOiBzdHJpbmcsXG4gIGNvdXJzZT86IHN0cmluZykgOiBNYXA8SUQsIHtcbiAgICBuZXdUZXh0Pzogc3RyaW5nLFxuICAgIG5ld0lkPzogSUQsXG4gICAgb2xkVGV4dD86IHN0cmluZyxcbiAgICBncmFkZVN0ZXA/OiBzdHJpbmcsXG4gICAgaXNUeXBvRml4PzogYm9vbGVhblxuICB9Plxue1xuICBjb25zdCBpZHNUb01pZ3JhdGUgPSBuZXcgTWFwPElELCB7XG4gICAgbmV3VGV4dD86IHN0cmluZyxcbiAgICBuZXdJZD86IElELFxuICAgIG9sZFRleHQ/OiBzdHJpbmcsXG4gICAgZ3JhZGVTdGVwPzogc3RyaW5nLFxuICAgIGlzVHlwb0ZpeD86IGJvb2xlYW4sXG4gICAgbWF0Y2hMZXZlbDogbnVtYmVyLFxuICAgIGxleGVtZXM6IFNldDxzdHJpbmc+XG4gIH0+KCk7XG4gIGRiVGV4dHMgPSBkYlRleHRzLm1hcChlbnRpdHkgPT4gKHsuLi5lbnRpdHksIG5hbWU6IGVudGl0eS5uYW1lLnRyaW0oKX0pKS5maWx0ZXIoKHtuYW1lfSkgPT4gISFuYW1lKTtcbiAgY29uc3QgeG1sU2V0ID0gbmV3IE1hcDxzdHJpbmcsIHtodG1sOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ30+KCk7XG4gIHhtbFRleHRzLmZvckVhY2goaXRlbSA9PiB4bWxTZXQuc2V0KGl0ZW0uaHRtbCwgaXRlbSkpO1xuICBjb25zdCBkYlNldCA9IG5ldyBNYXA8c3RyaW5nLCB7aWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9PigpO1xuICBkYlRleHRzLmZvckVhY2goZW50aXR5ID0+IGRiU2V0LnNldChlbnRpdHkubmFtZSwgZW50aXR5KSk7XG4gIC8vIFJlbW92ZSB0aG9zZSB3aG8gYWxyZWFkeSBleGlzdHMgaWRlbnRpY2FsbHlcbiAgZGJUZXh0cyA9IGRiVGV4dHMuZmlsdGVyKGVudGl0eSA9PiAheG1sU2V0LmhhcyhlbnRpdHkubmFtZSkpO1xuICB4bWxUZXh0cyA9IHhtbFRleHRzLmZpbHRlcihpdGVtID0+ICFkYlNldC5oYXMoaXRlbS5odG1sKSk7XG5cbiAgLy8gTm93LCBmb3IgdGhlIHJlbWFpbmRlciwgdHJ5IHRoZSBiZXN0IHRvIG1hcCBvbGQgdGV4dHMgdG8gbmV3IHRleHRzLCBhbmQgd2hlbiBkb25lLCBjaGVjayBpZiB0aGVyZSBhcmUgbmV3IHRleHRzIHRoYXQgbmV2ZXIgZ290IG1hcHBlZC5cblxuICAvLyBTdGFydCBieSBwdXR0aW5nIGFsbCBkYlRleHQgaW50byB0aGUgcmVzdWx0LCB3aXRob3V0IGEgcGFpcmVkIHhtbCB0ZXh0IHlldDpcbiAgZGJUZXh0cy5mb3JFYWNoKGRiVGV4dCA9PiBpZHNUb01pZ3JhdGUuc2V0KGRiVGV4dC5pZCwge1xuICAgIGdyYWRlU3RlcDogZGJUZXh0LmdyYWRlU3RlcCxcbiAgICBvbGRUZXh0OiBkYlRleHQubmFtZSxcbiAgICBsZXhlbWVzOiBnZXRMZXhlbWVzKGRiVGV4dC5uYW1lKSxcbiAgICBtYXRjaExldmVsOiAwXG4gIH0pKTtcbiAgLy8gVGhlbiB0cnkgdG8gcGFpciBlYWNoIHhtbFRleHQgdG8gYW4gaXRlbSBpbiBpZHNUb01pZ3JhdGVcbiAgY29uc3QgeG1sU3BpbnN0ZXJzOiB7aHRtbDogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmd9W10gPSBbXTtcbiAgd2hpbGUgKHhtbFRleHRzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCB4bWxUZXh0ID0geG1sVGV4dHNbMF07XG4gICAgY29uc3QgYmVzdE1hdGNoID0gZmluZEJlc3RNYXRjaCh4bWxUZXh0KTtcbiAgICBpZiAoIWJlc3RNYXRjaCkge1xuICAgICAgeG1sU3BpbnN0ZXJzLnB1c2goeG1sVGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChiZXN0TWF0Y2gubmV3VGV4dCkge1xuICAgICAgICAvLyBUaHJvdyBvdXQgZXhpc3RpbmcgbWF0Y2hcbiAgICAgICAgeG1sVGV4dHMucHVzaCh7aHRtbDogYmVzdE1hdGNoLm5ld1RleHQsIGdyYWRlU3RlcDogYmVzdE1hdGNoLmdyYWRlU3RlcH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFpciA9IGlkc1RvTWlncmF0ZS5nZXQoYmVzdE1hdGNoLmlkKTtcbiAgICAgIC8vIFBhaXIgbXlzZWxmIHdpdGggdGhpcyBtYXRjaDpcbiAgICAgIHBhaXIubmV3VGV4dCA9IHhtbFRleHQuaHRtbDtcbiAgICAgIHBhaXIubWF0Y2hMZXZlbCA9IGJlc3RNYXRjaC5teU1hdGNoTGV2ZWw7XG4gICAgICBwYWlyLm5ld0lkID0gbmV3VGV4dHMuZ2V0KHhtbFRleHQuaHRtbCk7XG4gICAgfVxuICAgIHhtbFRleHRzLnNoaWZ0KCk7XG4gIH1cbiAgLy8gRm9yIGVhY2ggc3BpbnN0ZXIgKG5ldyB0ZXh0cyB0aGF0IGNvdWxkbid0IGZpbmQgYW55IG1hdGNoIGluIG9sZCB0ZXh0cyksXG4gIC8vIEFkZCB0aGVtIHdpdGggYW4gZmljdGl2ZSBvbGQgSUQgYnV0IG9taXQgb2xkVGV4dCB0byBtYXJrIGl0IGFzIGEgbmV3Y29tZXJcbiAgeG1sU3BpbnN0ZXJzLmZvckVhY2goc3BpbnN0ZXIgPT4ge1xuICAgIGlkc1RvTWlncmF0ZS5zZXQoZmljdGl2ZU9sZElkKCksIHtcbiAgICAgIG5ld0lkOiBuZXdUZXh0cy5nZXQoc3BpbnN0ZXIuaHRtbCksXG4gICAgICBuZXdUZXh0OiBzcGluc3Rlci5odG1sLFxuICAgICAgZ3JhZGVTdGVwOiBzcGluc3Rlci5ncmFkZVN0ZXAsXG4gICAgICBtYXRjaExldmVsOiAwLFxuICAgICAgbGV4ZW1lczogbmV3IFNldDxzdHJpbmc+KCl9KVxuICB9KTtcblxuICAvLyBNYXJrIHR5cG8tZml4ZXNcbiAgaWRzVG9NaWdyYXRlLmZvckVhY2gobWF0Y2ggPT4ge1xuICAgIGNvbnN0IHtvbGRUZXh0LCBuZXdUZXh0fSA9IG1hdGNoO1xuICAgIGlmIChvbGRUZXh0ICYmIG5ld1RleHQpIHtcbiAgICAgIGlmIChbLi4uZ2V0TGV4ZW1lcyhvbGRUZXh0KV0uam9pbignICcpID09PSBbLi4uZ2V0TGV4ZW1lcyhuZXdUZXh0KV0uam9pbignICcpKSB7XG4gICAgICAgIG1hdGNoLmlzVHlwb0ZpeCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBjb25zb2xlLmxvZyhcIklkc1RvTWlncmF0ZVwiLCBbLi4uaWRzVG9NaWdyYXRlLnZhbHVlcygpXS5tYXAoKHtvbGRUZXh0LCBsZXhlbWVzfSkgPT4gYCR7Wy4uLmxleGVtZXNdLmpvaW4oJyAnKX06ICR7b2xkVGV4dH1gKSk7XG5cbiAgcmV0dXJuIGlkc1RvTWlncmF0ZTtcblxuICBmdW5jdGlvbiBmaW5kQmVzdE1hdGNoKHhtbFRleHQ6IHtodG1sOiBzdHJpbmcsIGdyYWRlU3RlcD86IHN0cmluZ30pIHtcbiAgICBjb25zdCB4bWxMZXhlbWVzID0gZ2V0TGV4ZW1lcyh4bWxUZXh0Lmh0bWwpO1xuICAgIGNvbnN0IHBvc3NpYmxlUGFydG5lcnMgPSBbLi4uaWRzVG9NaWdyYXRlLmVudHJpZXMoKV1cbiAgICAgIC5maWx0ZXIoKFtpZCwgeF0pID0+IHguZ3JhZGVTdGVwID09PSB4bWxUZXh0LmdyYWRlU3RlcClcbiAgICAgIC5tYXAoKFtpZCwge2dyYWRlU3RlcCwgbWF0Y2hMZXZlbCwgbmV3VGV4dCwgbGV4ZW1lc31dKSA9PiAoe1xuICAgICAgICBpZCxcbiAgICAgICAgZ3JhZGVTdGVwLFxuICAgICAgICBtYXRjaExldmVsLFxuICAgICAgICBuZXdUZXh0LFxuICAgICAgICBteU1hdGNoTGV2ZWw6IGdldE1hdGNoTGV2ZWwoeG1sTGV4ZW1lcywgbGV4ZW1lcylcbiAgICAgIH0pKS5maWx0ZXIocHAgPT4gcHAubXlNYXRjaExldmVsID49IDUwICYmICghcHAubWF0Y2hMZXZlbCB8fCBwcC5tYXRjaExldmVsIDwgcHAubXlNYXRjaExldmVsKSk7XG4gICAgcmV0dXJuIHBvc3NpYmxlUGFydG5lcnMuc29ydCgoYSwgYikgPT4gYi5teU1hdGNoTGV2ZWwgLSBhLm15TWF0Y2hMZXZlbClbMF07IC8vIGhpZ2hlc3QgZmlyc3QuXG4gIH1cblxuICBmdW5jdGlvbiBnZXRNYXRjaExldmVsKGxleGVtZXMxOiBTZXQ8c3RyaW5nPiwgbGV4ZW1lczI6IFNldDxzdHJpbmc+KSB7XG4gICAgaWYgKGxleGVtZXMxLnNpemUgPT09IDAgfHwgbGV4ZW1lczIuc2l6ZSA9PT0gMCkgcmV0dXJuIDA7XG4gICAgbGV0IHBvaW50czEgPSAwO1xuICAgIGxldCBwb2ludHMyID0gMDtcbiAgICBsZXhlbWVzMS5mb3JFYWNoKHdvcmQgPT4ge1xuICAgICAgaWYgKGxleGVtZXMyLmhhcyh3b3JkKSkgKytwb2ludHMxO1xuICAgIH0pO1xuICAgIGxleGVtZXMyLmZvckVhY2god29yZCA9PiB7XG4gICAgICBpZiAobGV4ZW1lczEuaGFzKHdvcmQpKSArK3BvaW50czI7XG4gICAgfSk7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoMTAwICogTWF0aC5tYXgocG9pbnRzMSAvIGxleGVtZXMxLnNpemUsIHBvaW50czIgLyBsZXhlbWVzMi5zaXplKSk7XG4gIH1cblxuICAvKmlmIChkYlRleHRzLmxlbmd0aCAhPT0geG1sVGV4dHMubGVuZ3RoKSB7XG4gICAgLy8gV2UgY2FuIG5vIGxvbmdlciBhc3N1bWUgdGhhdCB0aGUgY2hhbmdlZCB0ZXh0cyByZWZlciB0byBkaWZmZXJlbnQgZm9ybXVsYXRpb25zIG9mIHRoZSBzYW1lIG1lYW5pbmcuXG4gICAgLy8gV2Ugbm90IG1hcCBvbGQgZm9ybXVsYXRpb25zIHRvIG5ldyBvbmVzLlxuICAgIC8vIEluIGZ1dHVyZSwgd2UgY291bGQgaGFuZGxlIHRoaXMgY2FzZSBieSBhc3N1bWluZyBhbGwgb2xkIHRleHRzIG5vdCBvY2N1cnJpbmcgaW4gbmV3IGRhdGEsIGhhdmUgYmVlbiByZW1vdmVkIGFuZCBhbGwgbmV3IGhhdmUgYmVlbiBhZGRlZC5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJOdW1iZXIgb2YgXCIgKyB0ZXh0VHlwZSArIChjb3Vyc2UgPyBgIG9uIGNvdXJzZSAke2NvdXJzZX1gIDogXCJcIikgKyBcIiBkaWZmZXJzLiBDYW5ub3QgbWlncmF0ZS5cIik7XG4gIH1cbiAgZGJUZXh0cy5mb3JFYWNoKCh7bmFtZTogb2xkVGV4dCwgaWQ6IG9sZElkLCBncmFkZVN0ZXB9LCBpKSA9PiB7XG4gICAgY29uc3QgeG1sVGV4dCA9IHhtbFRleHRzW2ldLnRyaW0oKTtcbiAgICBpZiAob2xkVGV4dC50cmltKCkgIT09IHhtbFRleHQpIHtcbiAgICAgIGlkc1RvTWlncmF0ZS5zZXQob2xkSWQsIHtuZXdUZXh0OiB4bWxUZXh0LCBuZXdJZDogbmV3VGV4dHMuZ2V0KHhtbFRleHQpLCBvbGRUZXh0LCBncmFkZVN0ZXB9KTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gaWRzVG9NaWdyYXRlOyovXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWdyYXRlU3ViamVjdChleGlzdGluZ1N1YmplY3Q6IFN1YmplY3QsIGNvdXJzZVNldHM6IENvdXJzZVNldFtdLCBzdWJqZWN0VG9JbXBvcnQ6IFN1YmplY3RUb0ltcG9ydCwgY2hhbmdlczogQ2hhbmdlW10pIHtcbiAgLy8gR2VuZXJhdGUgZGJUZXh0TWFwOlxuICAvLyBkYlRleHRNYXAgY29udGFpbnMgYSBtYXAgZnJvbSBvbGQgdGV4dHMgKEFiaWxpdGllcywgQ2VudHJhbCBDb250ZW50IG9yIEtub3dsZWRnZSBSZXF1aXJlbWVudHMpIHRvIGl0cyBJRCBpbiB0aGUgZGF0YWJhc2UuXG4gIC8vIFRoZSBtYXAgc2hvdWxkIGJlIHVzZWQgdG8gbG9va3VwIElEcywgZ2l2ZW4gdGhlaXIgdHJpbW1lZCB0ZXh0LlxuICBjb25zdCBkYlRleHRNYXAgPSBuZXcgTWFwPHN0cmluZywgSUQ+KCk7XG4gIGNvbnN0IG9yZGVyZWRBYmlsaXRpZXMgPSBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgP1xuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlci5tYXAoaWQgPT4gZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpKSA6XG4gICAgZXhpc3RpbmdTdWJqZWN0LmFiaWxpdGllcztcbiAgZm9yIChjb25zdCBhIG9mIG9yZGVyZWRBYmlsaXRpZXMpIHtcbiAgICBkYlRleHRNYXAuc2V0KGEubmFtZS50cmltKCksIGEuaWQpO1xuICB9XG4gIGZvciAoY29uc3Qge3RlbXBsYXRlfSBvZiBjb3Vyc2VTZXRzKSB7XG4gICAgZm9yIChjb25zdCBjYyBvZiB0ZW1wbGF0ZS5jZW50cmFsQ29udGVudCkge1xuICAgICAgZGJUZXh0TWFwLnNldChjYy5uYW1lLnRyaW0oKSwgY2MuaWQpO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGtyIG9mIHRlbXBsYXRlLmtub3dsZWRnZVJlcXVpcmVtZW50cykge1xuICAgICAgZGJUZXh0TWFwLnNldChrci5uYW1lLnRyaW0oKSwga3IuaWQpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEZpbmQgb3V0IHdoaWNoIG5ldyB0ZXh0cyAoaW4gdG90YWwpIHRoYXQgc2hvdWxkIGJlIGNyZWF0ZWQgaW4gdGhlIERCIG9uIG1pZ3JhdGluZy5cbiAgLy8gTWF5YmUgYWxzbyBmaW5kIG91dCBpZiB0aGVyZSBhcmUgYW55IG9sZCB0ZXh0cyB3aG8ncyBvYmplY3RzIGFyZSBubyBtb3JlIHVzZWQgYW5kIGNvdWxkIGJlIHJlbW92ZWQgZnJvbSB0aGUgREJcbiAgLy8gbmV3VGV4dHM6IEEgbWFwIGJldHdlZW4gYSBuZXcgdGV4dCBhbmQgaXRzIG5ldyBJRCBpbiB0aGUgZGF0YWJhc2UgYWZ0ZXIgY3JlYXRpbmcgaXQuXG4gIC8vIHJlbW92ZWRJZHM6IEEgc2V0IG9mIGV4aXN0aW5nIGlkcyB0aGF0IHdvdWxkIGJlIHNhZmUgdG8gcmVtb3ZlIG9uIG1pZ3JhdGluZyAod2lsbCBpZ25vcmUgdGhvc2UgZm9yIG5vdylcbiAgY29uc3Qge25ld1RleHRzOiBuZXdBYmlsaXR5VGV4dHMsIGlkc1RvQWRkOiBhYmlsaXRpZXNUb0FkZH0gPVxuICAgIGRpZmZTdWJqZWN0R2xvYmFsVGV4dHMoZGJUZXh0TWFwLCBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzKTtcbiAgY29uc3Qge25ld1RleHRzOiBuZXdDQ1RleHRzLCBpZHNUb0FkZDogY2NzVG9BZGR9ID1cbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgZmxhdHRlbihzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5tYXAoYyA9PiBjLmNlbnRyYWxDb250ZW50Lm1hcChjYyA9PiBjYy5odG1sKSkpKTtcbiAgY29uc3Qge25ld1RleHRzOiBuZXdLUlRleHRzLCBpZHNUb0FkZDoga3JzVG9BZGR9ID1cbiAgICBkaWZmU3ViamVjdEdsb2JhbFRleHRzKGRiVGV4dE1hcCwgZmxhdHRlbihzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5tYXAoYyA9PiBjLmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoa3IgPT4ga3IuaHRtbCkpKSk7XG4gIFxuICBjb25zb2xlLmxvZyhgQWJpbGl0aWVzIHRvIGFkZDogJHthYmlsaXRpZXNUb0FkZC5zaXplfWApO1xuICBjb25zb2xlLmxvZyhgQ0NzIHRvIGFkZDogJHtjY3NUb0FkZC5zaXplfWApO1xuICBjb25zb2xlLmxvZyhgS1JzIHRvIGFkZDogJHtrcnNUb0FkZC5zaXplfWApO1xuXG4gIC8vIEZpbmQgb3V0IGFsbCBleGlzdGluZyBBYmlsaXR5IGlkcyB0aGF0IHdpbGwgYmUgbWlncmF0ZWQgdG8gbmV3IG9uZXNcbiAgY29uc3QgYWJpbGl0eUlkc1RvTWlncmF0ZSA9IGdldElkc1RvTWlncmF0ZShcbiAgICBvcmRlcmVkQWJpbGl0aWVzLFxuICAgIHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKGh0bWwgPT4gKHtodG1sfSkpLFxuICAgIG5ld0FiaWxpdHlUZXh0cyxcbiAgICBcImFiaWxpdGllc1wiKTtcblxuICAvLyBEbyB0aGUgc2FtZSBmb3IgZWFjaCBDZW50cmFsIENvbnRlbnQgYW5kIEtub3dsZWRnZSBSZXF1aXJlbWVudHMgb24gZWFjaCBjb3Vyc2U6XG4gIGNvbnN0IGlkc1RvTWlncmF0ZVBlckNvdXJzZSA9IGNvdXJzZVNldHMubWFwKCh7dGVtcGxhdGV9LCBpKSA9PiB7XG4gICAgY29uc29sZS5sb2coYENvdXJzZTogJHt0ZW1wbGF0ZS5uYW1lfWApO1xuICAgIGNvbnN0IHhtbENvdXJzZSA9IHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLm5hbWUgPT09IHRlbXBsYXRlLm5hbWUpIHx8XG4gICAgICBzdWJqZWN0VG9JbXBvcnQuY291cnNlcy5maW5kKGMgPT4gYy5jb2RlID09PSB0ZW1wbGF0ZS5jb2RlKTtcbiAgICByZXR1cm4ge1xuICAgICAgY291cnNlQ29kZTogdGVtcGxhdGUuY29kZSxcbiAgICAgIGNjc1RvTWlncmF0ZTogeG1sQ291cnNlID9cbiAgICAgICAgZ2V0SWRzVG9NaWdyYXRlKFxuICAgICAgICAgIHRlbXBsYXRlLmNlbnRyYWxDb250ZW50LCAvLyBIYXMgYWxyZWFkeSBiZWVuIHNvcnRlZCB3aGVuIHJldHJpZXZlZCB2aWEgbG9hZENvdXJzZSgpXG4gICAgICAgICAgeG1sQ291cnNlLmNlbnRyYWxDb250ZW50Lm1hcCgoe2h0bWx9KSA9PiAoe2h0bWx9KSksXG4gICAgICAgICAgbmV3Q0NUZXh0cyxcbiAgICAgICAgICBcImNlbnRyYWwgY29udGVudFwiLFxuICAgICAgICAgIHRlbXBsYXRlLm5hbWUpIDpcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGlzVHlwb0ZpeDogYm9vbGVhbn0+KCksXG4gICAgICBrcnNUb01pZ3JhdGU6IHhtbENvdXJzZSA/XG4gICAgICAgIGdldElkc1RvTWlncmF0ZShcbiAgICAgICAgICB0ZW1wbGF0ZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMsIC8vIEhhcyBhbHJlYWR5IGJlZW4gc29ydGVkIHdoZW4gcmV0cmlldmVkIHZpYSBsb2FkQ291cnNlKClcbiAgICAgICAgICB4bWxDb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzLFxuICAgICAgICAgIG5ld0tSVGV4dHMsXG4gICAgICAgICAgXCJrbm93bGVkZ2UgcmVxdWlyZW1lbnRzXCIsXG4gICAgICAgICAgdGVtcGxhdGUubmFtZVxuICAgICAgICApIDpcbiAgICAgICAgbmV3IE1hcDxJRCwge25ld1RleHQ6IHN0cmluZywgbmV3SWQ6IElELCBvbGRUZXh0OiBzdHJpbmcsIGdyYWRlU3RlcDogc3RyaW5nLCBpc1R5cG9GaXg6IGJvb2xlYW59PigpXG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gT0sgc28gbm93IHdlIGhhdmUgYWxsIGluZm8uXG4gIC8vIE5vdywgd2UgbmVlZCB0bzpcbiAgLy8gU3ViamVjdDpcbiAgLy8gMS4gUmVtb3ZlIGxpbmtzIGZyb20gc3ViamVjdHMgdG8gYWJpbGl0aWVzXG4gIC8vIDIuIEFkZCBsaW5rcyBmcm9tIHN1YmplY3RzIHRvIGFiaWxpdGllc1xuICBhYmlsaXR5SWRzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdUZXh0LCBuZXdJZCwgb2xkVGV4dCwgaXNUeXBvRml4fSwgb2xkSWQpID0+IHtcbiAgICAvL2NvbnN0IG9sZFRleHQgPSBleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzLmZpbmQoYSA9PiBhLmlkID09PSBvbGRJZCkubmFtZTtcbiAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgY2hhbmdlOiAoXG4gICAgICAgIG9sZFRleHQgP1xuICAgICAgICAgIG5ld1RleHQgP1xuICAgICAgICAgICAgaXNUeXBvRml4ID9cbiAgICAgICAgICAgICAgYFRyeWNrZmVsc3LDpHR0bmluZyBGw7ZybcOlZ2FgIDpcbiAgICAgICAgICAgICAgYFVwcGRhdGVyYWQgRsO2cm3DpWdhYCA6XG4gICAgICAgICAgICBgQm9ydHRhZ2VuIEbDtnJtw6VnYWAgOlxuICAgICAgICAgIGBOeSBGw7ZybcOlZ2FgXG4gICAgICApLFxuICAgICAgY29udGVudDogYDxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXG4gICAgICBtdXRhdGlvbnM6IGJyID0+IHtcbiAgICAgICAgaWYgKG5ld0lkICYmIGFiaWxpdGllc1RvQWRkLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICBjb25zdCBhOiBBYmlsaXR5ID0ge1xuICAgICAgICAgICAgaWQ6IG5ld0lkLFxuICAgICAgICAgICAgbmFtZTogbmV3VGV4dCxcbiAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKVxuICAgICAgICAgIH07XG4gICAgICAgICAgYnIuYWRkKFwiYWJpbGl0aWVzXCIsIGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwic3ViamVjdHNcIiwgZXhpc3RpbmdTdWJqZWN0LmlkLCBcImFiaWxpdGllc1wiLCBvbGRJZCk7XG4gICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJzdWJqZWN0c1wiLCBleGlzdGluZ1N1YmplY3QuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0lkKTtcbiAgICAgIH1cbiAgICB9KVxuICB9KTtcbiAgLy8gMy4gVXBkYXRlIGFiaWxpdGllc09yZGVyIG9uIFN1YmplY3QgYmFzZWQgb24gc3ViamVjdFRvSW1wb3J0LmFiaWxpdGllcyAobWFwcGVkIHRvIGlkcyBpbiBuZXdUZXh0cylcbiAgaWYgKCFleGlzdGluZ1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgfHwgYWJpbGl0eUlkc1RvTWlncmF0ZS5zaXplID4gMCkge1xuICAgIGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA9IHN1YmplY3RUb0ltcG9ydC5hYmlsaXRpZXMubWFwKHhtbCA9PiBuZXdBYmlsaXR5VGV4dHMuZ2V0KHhtbCkpO1xuICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICBtdXRhdGlvbnM6IGJyID0+IGJyLnB1dChcInN1YmplY3RzXCIsIGV4aXN0aW5nU3ViamVjdCksXG4gICAgICBjaGFuZ2U6IGV4aXN0aW5nU3ViamVjdC5hYmlsaXRpZXNPcmRlciA/XG4gICAgICAgIG51bGwgOiAvLyDDhG5kcmluZ2VuIHJlZGFuIHZpc3VlbGwgc29tIFwiVXBwZGF0ZXJhZCBmw7ZyIGbDtnJtw6VnYVwiLCBldGMsIG92YW5cbiAgICAgICAgYEluZsO2ciBlbiBvcmRuYWQgbGlzdGEgcMOlIGbDtnJtw6Vnb3IgaSBkYXRhYmFzZW5gLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgY3JlYXRlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XG4gIGNoYW5nZXMucHVzaCh7bXV0YXRpb25zOiAoKT0+Y3JlYXRlZElkcy5jbGVhcigpfSk7IC8vIEluIGNhc2UgbXV0YXRpb25zIHJ1biB0d2ljZSAod2hpY2ggaXQgZG9lc24ndCBhcyBvZiBjdXJyZW50IGltcGwuKVxuICBjb25zdCBzaG93bkNoYW5nZXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gU2V0IG9mIGNvdXJzZU5hbWVcbiAgY2hhbmdlcy5wdXNoKHttdXRhdGlvbnM6ICgpPT5zaG93bkNoYW5nZXMuY2xlYXIoKX0pO1xuICBcbiAgLy8gQ291cnNlczpcbiAgLy8gMS4gR28gdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyBhbmQ6XG4gIC8vICAgICAgQTogUmVtb3ZlIGxpbmtzIGZyb20gY291cnNlcyB0byBhYmlsaXRpZXMgbGlzdGVkIGluIGFiaWxpdHlJZHNUb01pZ3JhdGUua2V5cygpXG4gIC8vICAgICAgQjogQWRkIGxpbmtzIGZyb20gY291cnNlcyB0byBhYmlsaXRpZXMgYWJpbHRpdGllc1RvTWlncmF0ZS52YWx1ZXMoKVxuICAvLyAgICAgIEM6IFVwZGF0ZSBhYmlsaXRpZXNPcmRlciBvbiBjb3Vyc2UgaW5zdGFuY2VzIGJhc2VkIG9uIHN1YmplY3RUb0ltcG9ydCAobWFwcGVkIHRvIGlkcyBpbiBuZXdUZXh0cylcbiAgLy8gMiwgMzogRG8gdGhlIHNhbWUgZm9yIGNlbnRyYWwtY29udGVudCBhbmQga25vd2xlZGdlLXJlcXVpcmVtZW50ZXM6XG4gIC8vICAgIEZpbmQgY2NzIGFuZCBrcnMgdG8gbWlncmF0ZSBiYXNlZCBvbiBjb3Vyc2VJbnN0YW5jZS5jb2RlXG4gIC8vICAgIEZvciBib3RoIGNjcyBhbmQga3JzLCBkbzpcbiAgLy8gICAgICBBOiBVbmxpbmsgY2NzVG9NaWdyYXRlLmtleXMoKVxuICAvLyAgICAgIEI6IExpbmsgY2NzVG9NaWdyYXRlLnZhbHVlcygpXG4gIC8vICAgICAgQzogVXBkYXRlIGNlbnRyYWxDb250ZW50T3JkZXIgYmFzZWQgb24gc3ViamVjdFRvSW1wb3J0LmNlbnRyYWxDb250ZW50IG1hcHBlZCB0byBuZXdUZXh0cyBpZHNcbiAgLy8gICAgICAoc2FtZSBmb3Iga3JzVG9NaWdyYXRlLCB3aXRoIGtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyIGluc3RlYWQpXG4gIGZvciAoY29uc3Qge3RlbXBsYXRlLCBpbnN0YW5jZXN9IG9mIGNvdXJzZVNldHMpIHtcbiAgICAvLyBGaW5kIGNvdXJzZVRvSW1wb3J0XG4gICAgY29uc3QgY291cnNlVG9JbXBvcnQ6IENvdXJzZVRvSW1wb3J0ID0gKFxuICAgICAgc3ViamVjdFRvSW1wb3J0LmNvdXJzZXMuZmluZChjID0+IGMubmFtZSA9PT0gdGVtcGxhdGUubmFtZSkgfHxcbiAgICAgIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzLmZpbmQoYyA9PiBjLmNvZGUgPT09IHRlbXBsYXRlLmNvZGUpXG4gICAgKTtcblxuICAgIC8vIEZpbmQgQ2VudHJhbCBDb250ZW50IGFuZCBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzIHRvIG1pZ3JhdGVcbiAgICBjb25zdCB7Y2NzVG9NaWdyYXRlLCBrcnNUb01pZ3JhdGV9OiB7XG4gICAgICBjY3NUb01pZ3JhdGU6IE1hcDxJRCwge25ld1RleHQ/OiBzdHJpbmcsIG5ld0lkPzogSUQsIG9sZFRleHQ/OiBzdHJpbmd9PixcbiAgICAgIGtyc1RvTWlncmF0ZTogTWFwPElELCB7bmV3VGV4dD86IHN0cmluZywgbmV3SWQ/OiBJRCwgb2xkVGV4dD86IHN0cmluZywgZ3JhZGVTdGVwPzogc3RyaW5nfT5cbiAgICB9ID0gaWRzVG9NaWdyYXRlUGVyQ291cnNlLmZpbmQoeCA9PiB4LmNvdXJzZUNvZGUgPT09IHRlbXBsYXRlLmNvZGUpO1xuICAgIFxuICAgIC8vIExvb3AgdGhyb3VnaCBhbGwgY291cnNlIGluc3RhbmNlcyAoaW5zdGFuY2VzIGFsc28gY29udGFpbnMgdGVtcGxhdGVzKVxuICAgIC8vIGFuZCBtaWdyYXRlIHRoZW0uIFRoaXMgd2lsbCBpbmNsdWRlIGNyZWF0aW5nIG1pc3NpbmcgZW50aXRpZXMgaW4gdGhlIERCLlxuICAgIGZvciAoY29uc3QgY291cnNlIG9mIGluc3RhbmNlcykge1xuICAgICAgbWlncmF0ZUNvdXJzZUluc3RhbmNlKGNvdXJzZSwgY291cnNlVG9JbXBvcnQsIHtjY3NUb01pZ3JhdGUsIGtyc1RvTWlncmF0ZX0pO1xuICAgIH1cbiAgfVxuXG4gIGF3YWl0IG1pZ3JhdGVUYXNrcygpO1xuICByZXR1cm47XG5cbiAgZnVuY3Rpb24gbWlncmF0ZUNvdXJzZUluc3RhbmNlKFxuICAgIGNvdXJzZTogQ291cnNlLFxuICAgIGNvdXJzZVRvSW1wb3J0OiBDb3Vyc2VUb0ltcG9ydCxcbiAgICBpZHNUb01pZ3JhdGU6IHtcbiAgICAgIGNjc1RvTWlncmF0ZTogTWFwPElELCB7bmV3VGV4dD86IHN0cmluZywgbmV3SWQ/OiBJRCwgb2xkVGV4dD86IHN0cmluZywgaXNUeXBvRml4PzogYm9vbGVhbn0+LFxuICAgICAga3JzVG9NaWdyYXRlOiBNYXA8SUQsIHtuZXdUZXh0Pzogc3RyaW5nLCBuZXdJZD86IElELCBvbGRUZXh0Pzogc3RyaW5nLCBncmFkZVN0ZXA/OiBzdHJpbmcsIGlzVHlwb0ZpeD86IGJvb2xlYW59PlxuICAgIH0pXG4gIHtcbiAgICBjb25zdCBzaG93Q2hhbmdlcyA9ICFzaG93bkNoYW5nZXMuaGFzKGNvdXJzZS5uYW1lKTtcbiAgICBzaG93bkNoYW5nZXMuYWRkKGNvdXJzZS5uYW1lKTtcbiAgICBhYmlsaXR5SWRzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdJZCwgb2xkVGV4dH0sIG9sZElkKSA9PiB7XG4gICAgICAvLyBSZWxpbmsgdGhlIGNvdXJzZSBpbnN0YW5jZSB3aXRoIGFiaWxpdGllcy4gVGhpcyBjaGFuZ2UgZG9lcyBub3QgbmVlZCB0byBiZSB2aXNpYmxlIGluIEdVSS5cbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIG11dGF0aW9uczogYnIgPT4ge1xuICAgICAgICAgIGlmIChvbGRUZXh0KSBici51bmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIG9sZElkKTtcbiAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwiY291cnNlc1wiLCBjb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0lkKTtcbiAgICAgICAgfVxuICAgICAgfSk7ICBcbiAgICB9KTtcbiAgICBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIgPSBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzLm1hcChodG1sID0+IG5ld0FiaWxpdHlUZXh0cy5nZXQoaHRtbCkpO1xuXG4gICAgY29uc3Qge2Njc1RvTWlncmF0ZSwga3JzVG9NaWdyYXRlfSA9IGlkc1RvTWlncmF0ZTtcblxuICAgIC8vIENlbnRyYWwgQ29udGVudFxuICAgIGNjc1RvTWlncmF0ZS5mb3JFYWNoKCh7bmV3SWQsIG5ld1RleHQsIG9sZFRleHQsIGlzVHlwb0ZpeH0sIG9sZElkKSA9PiB7XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBjaGFuZ2U6IHNob3dDaGFuZ2VzICYmIChcbiAgICAgICAgICBvbGRUZXh0ID9cbiAgICAgICAgICAgIG5ld1RleHQgP1xuICAgICAgICAgICAgICBpc1R5cG9GaXggP1xuICAgICAgICAgICAgICAgIGBUcnlja2ZlbHNyw6R0dG5pbmcgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICAgICAgYFVwcGRhdGVyYXQgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgQ2VudHJhbHQgSW5uZWjDpWxsYCA6XG4gICAgICAgICAgICBgTnl0dCBDZW50cmFsdCBJbm5laMOlbGxgKSxcbiAgICAgICAgY29udGVudDogYDxoND4ke2NvdXJzZS5uYW1lfTwvaDQ+PHN0cmlrZT4ke29sZFRleHQgfHwgJyd9PC9zdHJpa2U+PGJyLz4ke25ld1RleHQgfHwgJyd9YCxcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiB7XG4gICAgICAgICAgaWYgKG5ld0lkICYmIGNjc1RvQWRkLmhhcyhuZXdJZCkgJiYgIWNyZWF0ZWRJZHMuaGFzKG5ld0lkKSkge1xuICAgICAgICAgICAgY29uc3QgY2M6IENlbnRyYWxDb250ZW50ID0ge1xuICAgICAgICAgICAgICBpZDogbmV3SWQsXG4gICAgICAgICAgICAgIG5hbWU6IG5ld1RleHQsXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYnIuYWRkKFwiY2VudHJhbC1jb250ZW50XCIsIGNjKTtcbiAgICAgICAgICAgIGNyZWF0ZWRJZHMuYWRkKG5ld0lkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9sZFRleHQpIGJyLnVubGluazIoXCJjb3Vyc2VzXCIsIGNvdXJzZS5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBvbGRJZCk7XG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImNlbnRyYWxDb250ZW50XCIsIG5ld0lkKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KTtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlciA9IGNvdXJzZVRvSW1wb3J0LmNlbnRyYWxDb250ZW50Lm1hcCgoe2h0bWx9KSA9PiBuZXdDQ1RleHRzLmdldChodG1sKSk7XG5cbiAgICAvLyBLbm93bGVkZ2UgUmVxdWlyZW1lbnRzXG4gICAga3JzVG9NaWdyYXRlLmZvckVhY2goKHtuZXdJZCwgbmV3VGV4dCwgZ3JhZGVTdGVwLCBvbGRUZXh0LCBpc1R5cG9GaXh9LCBvbGRJZCkgPT4ge1xuICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgY2hhbmdlOiBzaG93Q2hhbmdlcyAmJiAoXG4gICAgICAgICAgb2xkVGV4dCA/XG4gICAgICAgICAgICBuZXdUZXh0ID9cbiAgICAgICAgICAgICAgaXNUeXBvRml4ID9cbiAgICAgICAgICAgICAgICBgVHJ5Y2tmZWxzcsOkdHRuaW5nIEt1bnNrYXBza3JhdmA6XG4gICAgICAgICAgICAgICAgYFVwcGRhdGVyYXQgS3Vuc2thcHNrcmF2YCA6XG4gICAgICAgICAgICAgIGBCb3J0dGFnZXQgS3Vuc2thcHNrcmF2YCA6XG4gICAgICAgICAgICBgTnl0dCBLdW5za2Fwc2tyYXZgXG4gICAgICAgICksXG4gICAgICAgIGNvbnRlbnQ6IGA8aDQ+JHtjb3Vyc2UubmFtZX08L2g0PjxzdHJpa2U+JHtvbGRUZXh0IHx8ICcnfTwvc3RyaWtlPjxici8+JHtuZXdUZXh0IHx8ICcnfWAsXG4gICAgICAgIG11dGF0aW9uczogYnIgPT4ge1xuICAgICAgICAgIGlmIChuZXdJZCAmJiBrcnNUb0FkZC5oYXMobmV3SWQpICYmICFjcmVhdGVkSWRzLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGtyOiBLbm93bGVkZ2VSZXF1aXJlbWVudCA9IHtcbiAgICAgICAgICAgICAgaWQ6IG5ld0lkLFxuICAgICAgICAgICAgICBuYW1lOiBuZXdUZXh0LFxuICAgICAgICAgICAgICBncmFkZVN0ZXAsXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEFkZGluZyBLbm93bGVkZ2UtUmVxdWlyZW1lbnQgJHtuZXdJZH06ICR7bmV3VGV4dH1gKTtcbiAgICAgICAgICAgIGJyLmFkZChcImtub3dsZWRnZS1yZXF1aXJlbWVudHNcIiwga3IpO1xuICAgICAgICAgICAgY3JlYXRlZElkcy5hZGQobmV3SWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob2xkVGV4dCkgYnIudW5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBvbGRJZCk7XG4gICAgICAgICAgaWYgKG5ld0lkKSBici5saW5rMihcImNvdXJzZXNcIiwgY291cnNlLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBuZXdJZCk7ICBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyID1cbiAgICAgIGNvdXJzZVRvSW1wb3J0Lmtub3dsZWRnZVJlcXVpcmVtZW50cy5tYXAoa3IgPT4gbmV3S1JUZXh0cy5nZXQoa3IuaHRtbCkpO1xuXG4gICAgLy8gVXBkYXRlcyB0aGUgY291cnNlIHByb3BlcnRpZXMgY2VudHJhbENvbnRlbnRPcmRlciBhbmQga25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXJcbiAgICBpZiAoYWJpbGl0eUlkc1RvTWlncmF0ZS5zaXplID4gMCB8fCBjY3NUb01pZ3JhdGUuc2l6ZSA+IDAgfHwga3JzVG9NaWdyYXRlLnNpemUgPiAwKSB7XG4gICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICBjaGFuZ2U6ICFjb3Vyc2UuaXNUZW1wbGF0ZSA/IGBVcHBkYXRlcmFkIEt1cnNpbnN0YW5zYCA6IGBVcHBkYXRlcmFkIEt1cnNtYWxsYCxcbiAgICAgICAgY29udGVudDogIWNvdXJzZS5pc1RlbXBsYXRlID9cbiAgICAgICAgICBgJHtjb3Vyc2UubmFtZX0uIFNrb2xhOiAke2NvdXJzZS5zY2hvb2wgfHwgXCJlaiBhbmdpdmVuXCJ9LiBCZXNrcml2bmluZzogJHtjb3Vyc2UuZGVzY3JpcHRpb24gfHwgJyd9YCA6XG4gICAgICAgICAgYCR7Y291cnNlLm5hbWV9YCxcbiAgICAgICAgbXV0YXRpb25zOiBiciA9PiBici5wdXQoXCJjb3Vyc2VzXCIsIGNvdXJzZSlcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gVGFza3M6XG4gIC8vIDEuIEFTWU5DIE9QRVJBVElPTjogR28gdGhyb3VnaCBhbGwgdGFza3MgdGhhdCBoYXMgZWRnZXMgdG8gYW55IG9mIHRoZSBvbGQgaWRzLlxuICAvLyAyLiBGb3IgZWFjaCBmb3VuZCB0YXNrLCBkbzpcbiAgLy8gICAgQTogSXRlcmF0ZSB0YWdzIHN0YXJ0aW5nIHdpdGggXCJjb3Vyc2U6XCIuIFBpY2sgdGhlIGNvdXJzZSBjb2RlLlxuICAvLyAgICBCOiBQb3B1bGF0ZSB0aGUgbmV3IHByb3BlcnR5IG1pZ3JhdGlvblRhc2tzOiB7XG4gIC8vICAgICAgICAgYWJpbGl0aWVzOiB7W25ld0lkOiBzdHJpbmddOiB7b2xkVGV4dDogc3RyaW5nLCBvbGRJZDogc3RyaW5nLCBpbXBvcnREYXRlOiBudW1iZXJ9fSwgLy8gQmUgYWJsZSB0byBjcmVhdGUgYSBjaGFpbiBpbiB0aGUgR1VJICFcbiAgLy8gICAgICAgICBjZW50cmFsQ29udGVudDoge1tuZXdJZDogc3RyaW5nXToge29sZFRleHQ6IHN0cmluZywgLi4uXCIuLi59fSxcbiAgLy8gICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHtbbmV3SWQ6IHN0cmluZ106IHtvbGRUZXh0OiBzdHJpbmcsIC4uLlwiLi4ufX0sXG4gIC8vICAgICAgIH1cbiAgLy8gICAgICAgT0JTMSEgTWVyZ2VhIGFiaWxpdGllcywgY2VudHJhbENvbmRlbnQgb2NoIGtub3dsZWRnZVJlcXVpcmVtZW50cyBtZWQgZXYgdGlkaWdhcmUgdsOkcmRlbiAoc8OlIG1hbiBrYW4gaW1wb3J0ZXJhIG9tIG9jaCBvbSBpZ2VuISlcbiAgLy8gICAgICAgT0JTMiEgb2xkSWQga2FuIGbDtnJla29tbWEgcMOlIGZsZXJhIG5ld0lkIG9tIHRhc2sgYW52w6RuZHMgYXYgZmxlcmEga3Vyc2VyLiBcbiAgLy8gICAgQzogQ3JlYXRlIHNldHMgZm9yIHVubGlua3MgYW5kIGxpbmsgb3BlcmF0aW9ucyBwZXIgdHlwZS5cbiAgLy8gICAgRDogRm9yIGFsbCBjb3Vyc2VDb2RlcyB0aGF0IHRoZSB0YXNrIGlzIHRhZ2dlbiBvbixcbiAgLy8gICAgICAgICAqIHJlZ2lzdGVyIGNjc1RvTWlncmF0ZS5rZXlzKCkgaW4gdGhlIHVubGluayBzZXQgb2YgY2VudHJhbCBjb250ZW50c1xuICAvLyAgICAgICAgICogcmVnaXN0ZXIgY2NzVG9NaWdyYXRlLnZhbHVlcygpIGluIHRoZSBsaW5rIHNldCBvZiBjZW50cmFsIGNvbnRlbnRzXG4gIC8vICAgICAgICAgKiAtLVwiLS0gZm9yIGtub3dsZWRnZVJlcXVpcmVtZW50c1xuICAvLyAgICBFOiB1bmxpbmsgYW5kIGxpbmsgd2l0aCByZWdhcmRzIHRvIGFiaWxpdHlJZHNUb01pZ3JhdGUgKGtleXMoKSBhbmQgdmFsdWVzKCkgcmVzcGVjdGl2ZWx5KS5cbiAgLy8gICAgRjogdW5saW5rIGFuZCBsaW5rIGFjY29yZGluZyB0byB0aGUgY3JlYXRlZCBzZXRzIG9mIGxpbmsgLyB1bmxpbmsgb3BlcmF0aW9ucy5cbiAgLy8gICAgTm90ZTogVW5saWtlIGNvdXJzZSBpbnN0YW5jZXMsIHRoZXJlJ3Mgbm8gb3JkZXIgcHJvcGVydHkgdG8gdGFrZSBjYXJlIG9mIGhlcmUhXG4gIC8vXG5cbiAgYXN5bmMgZnVuY3Rpb24gbWlncmF0ZVRhc2tzKCkge1xuICAgIGNvbnN0IG9sZElkcyA9IFtcbiAgICAgIC4uLmFiaWxpdHlJZHNUb01pZ3JhdGUua2V5cygpLFxuICAgICAgLi4uZmxhdHRlbihpZHNUb01pZ3JhdGVQZXJDb3Vyc2UubWFwKGMgPT4gW1xuICAgICAgICAuLi5jLmNjc1RvTWlncmF0ZS5rZXlzKCksXG4gICAgICAgIC4uLmMua3JzVG9NaWdyYXRlLmtleXMoKVxuICAgICAgXSkpXG4gICAgXS5maWx0ZXIoaWQgPT4gIWlkLnN0YXJ0c1dpdGgoJ2ZpY3RpdmVPbGRJZCcpKTtcbiAgICBcbiAgICBjb25zdCBpbXBvcnREYXRlID0gRGF0ZS5ub3coKTtcblxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgZmV0Y2hUYXNrc0luQ2h1bmtzV2l0aEVkZ2VzVG8ob2xkSWRzLCB7XG4gICAgICBpbmNsdWRlOiBbXCJhYmlsaXRpZXNcIiwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgXCJjZW50cmFsQ29udGVudFwiXSxcbiAgICAgIGZsYWdzOiBbXCJpbmNsdWRlSWRzT25seVwiXVxuICAgIH0pO1xuXG4gICAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hUYXNrc0luQ2h1bmtzV2l0aEVkZ2VzVG8oaWRzOiBzdHJpbmdbXSwgb3B0aW9uczogTGlzdE9wdGlvbnMpOiBQcm9taXNlPFRhc2tbXT4ge1xuICAgICAgLy8gVGhpcyBmdW5jdGlvbiBzaG91bGQgbWFrZSB3b3JrIGFyb3VuZCB0aGUgY2FzZSB3aGVuIGdpdmVuIFwiaWRzXCIgY29udGFpbnMgdG9vIG1hbnkgaXRlbXMsIGJ5XG4gICAgICAvLyBkaXZpZGluZyB0aGUgcmVxdWVzdHMgaW50byBzZXZlcmFsIGFuZCBtZXJnZSB0aGUgcmVzdWx0IHVzaW5nIGEgTWFwLlxuICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDApIHJldHVybiBbXTsgLy8gT3RoZXJ3aXNlIHdlJ2xsIHJlcXVlc3QgZXZlcnkgdGFzayBpbiB0aGUgc3lzdGVtLlxuICAgICAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcDxJRCwgVGFzaz4oKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiTnVtYmVyIG9mIGlkczogXCIgKyBpZHMubGVuZ3RoKTtcbiAgICAgIC8vcmV0dXJuIHJlc3VsdC52YWx1ZXMoKTtcbiAgICAgIHJldHVybiBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICBoYXNFZGdlc1RvOiBpZHNcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qY29uc3QgdGFza3MgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5saXN0PFRhc2s+KFwidGFza3NcIiwge1xuICAgICAgaGFzRWRnZXNUbzogb2xkSWRzLFxuICAgICAgaW5jbHVkZTogW1wiYWJpbGl0aWVzXCIsIFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIsIFwiY2VudHJhbENvbnRlbnRcIl0sXG4gICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cbiAgICB9KTsqL1xuXG4gICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzKSB7XG4gICAgICBjb25zdCBvbGRNVCA9IHRhc2subWlncmF0ZWRUZXh0cyB8fCB7XG4gICAgICAgIGFiaWxpdGllczoge30sXG4gICAgICAgIGNlbnRyYWxDb250ZW50OiB7fSxcbiAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzOiB7fVxuICAgICAgfTtcbiAgICAgIHRhc2subWlncmF0ZWRUZXh0cyA9IHtcbiAgICAgICAgYWJpbGl0aWVzOiB7fSxcbiAgICAgICAgY2VudHJhbENvbnRlbnQ6IHt9LFxuICAgICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHM6IHt9XG4gICAgICB9O1xuXG4gICAgICBjb25zdCBtdXRhdGlvbnM6IEFycmF5PChicjogQmF0Y2hSdW5uZXIpPT52b2lkPiA9IFtdO1xuICAgICAgY29uc3QgY2hhbmdlRGVzY3JpcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgZm9yIChjb25zdCB7aWR9IG9mIHRhc2suYWJpbGl0aWVzKSB7XG4gICAgICAgIGNvbnN0IG1pZ3JhdGlvbkluZm8gPSBhYmlsaXR5SWRzVG9NaWdyYXRlLmdldChpZCk7XG4gICAgICAgIGlmIChtaWdyYXRpb25JbmZvKSB7XG4gICAgICAgICAgY29uc3Qge25ld0lkLCBuZXdUZXh0LCBpc1R5cG9GaXh9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICBsZXQge29sZFRleHR9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICBsZXQgb2xkSWQgPSBpZDtcbiAgICAgICAgICBpZiAob2xkTVQuYWJpbGl0aWVzW2lkXSkge1xuICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAvLyBXZSBzaG91bGQgcG9pbnQgb3V0IHRoZSB2ZXJ5IG9sZCBpZCBhbmQgdGV4dCBpbnN0ZWFkIG9mIHRoZSBuZXZlci1hY2tub3dsZWRnZWQgb25lLlxuICAgICAgICAgICAgb2xkVGV4dCA9IG9sZE1ULmFiaWxpdGllc1tpZF0ub2xkVGV4dDtcbiAgICAgICAgICAgIG9sZElkID0gb2xkTVQuYWJpbGl0aWVzW2lkXS5vbGRJZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG5ld0lkICYmIG9sZFRleHQgIT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxuICAgICAgICAgICAgaWYgKCFpc1R5cG9GaXgpIHtcbiAgICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXNuJ3QganVzdCBhIHR5cG8gZml4IChjaGFuZ2VzIGluIHN0b3Agd29yZHMsIGNhc2luZyBvciBzcGVjaWFsIGNoYXJhY3RlcnMpXG4gICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5hYmlsaXRpZXNbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgbXV0YXRpb25zLnB1c2goYnIgPT4ge1xuICAgICAgICAgICAgYnIudW5saW5rMihcInRhc2tzXCIsIHRhc2suaWQsIFwiYWJpbGl0aWVzXCIsIGlkKTtcbiAgICAgICAgICAgIGlmIChuZXdJZCkgYnIubGluazIoXCJ0YXNrc1wiLCB0YXNrLmlkLCBcImFiaWxpdGllc1wiLCBuZXdJZCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2goYDxzdHJpa2U+JHtvbGRUZXh0fTwvc3RyaWtlPmApO1xuICAgICAgICAgIGlmIChuZXdJZCkge1xuICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRhc2tDb3Vyc2VDb2RlcyA9IG5ldyBTZXQ8c3RyaW5nPih0YXNrLnRhZ3MgPyBcbiAgICAgICAgdGFzay50YWdzLmZpbHRlcih0ID0+IHQuc3RhcnRzV2l0aCgnY291cnNlOicpKS5tYXAodCA9PiB0LnN1YnN0cihcImNvdXJzZTpcIi5sZW5ndGgpKSA6XG4gICAgICAgIFtdKTtcblxuICAgICAgLy8gV2UgbmVlZCB0byBrZWVwIHRyYWNrIG9mIGxpbmtlZElkcyAoZm9yIHRoaXMgcGFydGljdWxhciB0YXNrKSBmb3IgdGhlIGZvbGxvd2luZyByZWFzb246XG4gICAgICAvLyBMZXQncyBzYXkgdGhlIHRhc2sgd2FzIHJlZmVycmVkIHRvIGJ5IHR3byBkaWZmZXJlbnQgY291cnNlcyAocG9zc2libGUgaW4gb2xkIHZlcnNpb25zKSxcbiAgICAgIC8vIGFuZCBpbiBvbGQgQ2VudHJhbCBDb250ZW50LCB0aGUgdHdvIGNvdXJzZXMgZGlkIGhhdmUgc2xpZ2h0bHkgZGlmZmVyZW50IGZvcm11bGF0aW9ucyBvZiBjZW50cmFsIGNvbnRlbnQsXG4gICAgICAvLyBzbyB0aGUgdGFzayB3YXMgbWFwcGVkIHRvIGJvdGggb2YgdGhlbS4gVGhlbiwgaW4gbmV3IFhNTCwgdGhlIHNhbWUgY2VudHJhbCBjb250ZW50IHdhcyBmb3JtdWxhdGVkXG4gICAgICAvLyBpbiBhIG5ldyB3YXkgdGhhdCBpcyBpZGVudGljYWwgdGhpcyB0aW1lIGJldHdlZW4gdGhlIHR3byBjb3Vyc2VzLiBUaGVuIGJvdGggb2xkIElEcyB3aWxsIGJlIHJlcGxhY2VkXG4gICAgICAvLyBieSBhIHNpbmdsZSBuZXcgSUQuIEl0IHdvdWxkIHRoZW4gYmUgdW5uZXNjZXNzYXJ5IHRvIGxpbmsgdG8gdGhlIG5ldyBJRCB0d2ljZS5cbiAgICAgIGNvbnN0IGxpbmtlZElkcyA9IG5ldyBTZXQ8SUQ+KCk7XG5cbiAgICAgIGZvciAoY29uc3Qge2tyc1RvTWlncmF0ZSwgY2NzVG9NaWdyYXRlLCBjb3Vyc2VDb2RlfSBvZiBpZHNUb01pZ3JhdGVQZXJDb3Vyc2UpIHtcbiAgICAgICAgaWYgKHRhc2tDb3Vyc2VDb2Rlcy5zaXplID09PSAwIHx8IHRhc2tDb3Vyc2VDb2Rlcy5oYXMoY291cnNlQ29kZSkpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHtpZH0gb2YgdGFzay5jZW50cmFsQ29udGVudCkge1xuICAgICAgICAgICAgY29uc3QgbWlncmF0aW9uSW5mbyA9IGNjc1RvTWlncmF0ZS5nZXQoaWQpO1xuICAgICAgICAgICAgaWYgKG1pZ3JhdGlvbkluZm8pIHtcbiAgICAgICAgICAgICAgbGV0IHtuZXdJZCwgbmV3VGV4dCwgb2xkVGV4dCwgaXNUeXBvRml4fSA9IG1pZ3JhdGlvbkluZm87XG4gICAgICAgICAgICAgIGxldCBvbGRJZCA9IGlkO1xuICAgICAgICAgICAgICBpZiAob2xkTVQuY2VudHJhbENvbnRlbnRbaWRdKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHBvaW50IG91dCB0aGUgdmVyeSBvbGQgaWQgYW5kIHRleHQgaW5zdGVhZCBvZiB0aGUgbmV2ZXItYWNrbm93bGVkZ2VkIG9uZS5cbiAgICAgICAgICAgICAgICBvbGRUZXh0ID0gb2xkTVQuY2VudHJhbENvbnRlbnRbaWRdLm9sZFRleHQ7XG4gICAgICAgICAgICAgICAgb2xkSWQgPSBvbGRNVC5jZW50cmFsQ29udGVudFtpZF0ub2xkSWQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKG5ld0lkICYmIG9sZFRleHQgIT09IG5ld1RleHQpIHtcbiAgICAgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2U6IElmIG9sZFRleHQgPT09IG5ld1RleHQsIHRoZW4gdGhpcyBpcyBhIHJlaW1wb3J0IG5ldyBYTUwgdGhhdCByZXZlcnRzIGJhY2sgdG8gb3JpZ2luIHRleHQuIERvbid0IHJlcXVpcmUgYWNrbm93bGVkZ2VtZW50IGZyb20gdGVhY2hlciFcbiAgICAgICAgICAgICAgICBpZiAoIWlzVHlwb0ZpeCkge1xuICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyB3YXNuJ3QganVzdCBhIHR5cG8gZml4IChjaGFuZ2VzIGluIHN0b3Agd29yZHMsIGNhc2luZyBvciBzcGVjaWFsIGNoYXJhY3RlcnMpXG4gICAgICAgICAgICAgICAgICB0YXNrLm1pZ3JhdGVkVGV4dHMuY2VudHJhbENvbnRlbnRbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKCFuZXdJZCB8fCAhbGlua2VkSWRzLmhhcyhuZXdJZCkpIHtcbiAgICAgICAgICAgICAgICBtdXRhdGlvbnMucHVzaChiciA9PiB7XG4gICAgICAgICAgICAgICAgICBici51bmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBpZCk7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJjZW50cmFsQ29udGVudFwiLCBuZXdJZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2goYDxzdHJpa2U+JHtvbGRUZXh0fTwvc3RyaWtlPmApO1xuICAgICAgICAgICAgICAgIGlmIChuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgY2hhbmdlRGVzY3JpcHRpb25zLnB1c2gobmV3VGV4dCk7XG4gICAgICAgICAgICAgICAgICBsaW5rZWRJZHMuYWRkKG5ld0lkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgZm9yIChjb25zdCB7aWR9IG9mIHRhc2sua25vd2xlZGdlUmVxdWlyZW1lbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBtaWdyYXRpb25JbmZvID0ga3JzVG9NaWdyYXRlLmdldChpZCk7XG4gICAgICAgICAgICBpZiAobWlncmF0aW9uSW5mbykge1xuICAgICAgICAgICAgICBsZXQge25ld0lkLCBuZXdUZXh0LCBvbGRUZXh0LCBpc1R5cG9GaXh9ID0gbWlncmF0aW9uSW5mbztcbiAgICAgICAgICAgICAgbGV0IG9sZElkID0gaWQ7XG4gICAgICAgICAgICAgIGlmIChvbGRNVC5rbm93bGVkZ2VSZXF1aXJlbWVudHNbaWRdKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgbWlncmF0aW5nIHN0dWZmIHRoYXQgd2FzIG5ldmVyIGFja25vd2xlZGdlcyBieSBhIHRlYWNoZXIsXG4gICAgICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIHBvaW50IG91dCB0aGUgdmVyeSBvbGQgaWQgYW5kIHRleHQgaW5zdGVhZCBvZiB0aGUgbmV2ZXItYWNrbm93bGVkZ2VkIG9uZS5cbiAgICAgICAgICAgICAgICBvbGRUZXh0ID0gb2xkTVQua25vd2xlZGdlUmVxdWlyZW1lbnRzW2lkXS5vbGRUZXh0O1xuICAgICAgICAgICAgICAgIG9sZElkID0gb2xkTVQua25vd2xlZGdlUmVxdWlyZW1lbnRzW2lkXS5vbGRJZDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBpZiAobmV3SWQgJiYgb2xkVGV4dCAhPT0gbmV3VGV4dCkge1xuICAgICAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZTogSWYgb2xkVGV4dCA9PT0gbmV3VGV4dCwgdGhlbiB0aGlzIGlzIGEgcmVpbXBvcnQgbmV3IFhNTCB0aGF0IHJldmVydHMgYmFjayB0byBvcmlnaW4gdGV4dC4gRG9uJ3QgcmVxdWlyZSBhY2tub3dsZWRnZW1lbnQgZnJvbSB0ZWFjaGVyIVxuICAgICAgICAgICAgICAgIGlmICghaXNUeXBvRml4KSB7XG4gICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIHdhc24ndCBqdXN0IGEgdHlwbyBmaXggKGNoYW5nZXMgaW4gc3RvcCB3b3JkcywgY2FzaW5nIG9yIHNwZWNpYWwgY2hhcmFjdGVycylcbiAgICAgICAgICAgICAgICAgIHRhc2subWlncmF0ZWRUZXh0cy5rbm93bGVkZ2VSZXF1aXJlbWVudHNbbmV3SWRdID0ge29sZElkLCBvbGRUZXh0LCBpbXBvcnREYXRlfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAoIW5ld0lkIHx8ICFsaW5rZWRJZHMuaGFzKG5ld0lkKSkge1xuICAgICAgICAgICAgICAgIG11dGF0aW9ucy5wdXNoKGJyID0+IHtcbiAgICAgICAgICAgICAgICAgIGJyLnVubGluazIoXCJ0YXNrc1wiLCB0YXNrLmlkLCBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLCBpZCk7XG4gICAgICAgICAgICAgICAgICBpZiAobmV3SWQpIGJyLmxpbmsyKFwidGFza3NcIiwgdGFzay5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIiwgbmV3SWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNoYW5nZURlc2NyaXB0aW9ucy5wdXNoKGA8c3RyaWtlPiR7b2xkVGV4dH08L3N0cmlrZT5gKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgIGNoYW5nZURlc2NyaXB0aW9ucy5wdXNoKG5ld1RleHQpO1xuICAgICAgICAgICAgICAgICAgbGlua2VkSWRzLmFkZChuZXdJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgIGNoYW5nZTogYE1pZ3JlcmFkIFVwcGdpZnRgLFxuICAgICAgICBjb250ZW50OiBgPGg0PiR7dGFzay5uYW1lfSAke3Rhc2suc2Nob29sID8gYCgke3Rhc2suc2Nob29sfSkgYCA6ICcoc2tvbGEgZWogYW5naXZlbiknfTwvaDQ+XG4gICAgICAgICAgPHA+S3Vyc2tvZDogJHtbLi4udGFza0NvdXJzZUNvZGVzXS5qb2luKCcsJyl9PC9wPlxuICAgICAgICAgICR7Y2hhbmdlRGVzY3JpcHRpb25zLm1hcCh0eHQgPT4gYDxwPiR7dHh0fTwvcD5gKS5qb2luKCcnKX1gLFxuICAgICAgICBtdXRhdGlvbnM6IGJyID0+IHtcbiAgICAgICAgICBici5wdXQoXCJ0YXNrc1wiLCB0YXNrKTtcbiAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChtID0+IG0oYnIpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gVEhFIFJFU1VMVCBXSUxMIEJFOlxuICAvLyAgRnVuY3Rpb24gcG9wdWxhdGVzIGEgY29tcGxldGUgc2V0IG9mIENoYW5nZXMgdG8gZGlzcGxheSB0byB1c2VyLlxuICAvLyAgSWYgdXNlciBjbGlja3MgXCJpbXBvcnRcIiwgdGhlc2UgY2hhbmdlcyB3aWxsIGJlIHBlcmZvcm1lZC5cblxuICBcbiAgLy8gTmV4dCB0aGluZyB3aWxsIGJlIHRvIG1ha2UgdGhpcyB2aXNpYmxlIGluIEdVSTpcbiAgLy8gIFNob3cgT3BlbkNsb3NlQm94IHdpdGggd2FybmluZyBiZWZvcmUgXCJJbmzDpG1uaW5nc3VwcGdpZnRcIiBpbiBjYXNlIHRoZXJlIGFyZSBtaWdyYXRpb25UYXNrcy5cbiAgLy8gIExpc3Qga25vd2xlZGdlIHJlcXVpcmVtZW50cyBBLCBLUiBDLCBLUiBFLCBjZW50cmFsIGNvbnRlbnRzIGFuZCBhYmlsaXRpZXMgcmVzcGVjdGl2ZWx5IGluIHRvdGFsbHkgbWF4IDUgdGFibGVzLlxuICAvLyAgU2FtZSBHVUkgYXMga25vd2xlZGdlUmVxdWlyZW1lbnQgbWF0cml4IChncmVlbiBoZWFkZXIpIHBlciB0YWJsZS5cbiAgLy8gIEhlYWRlcnM6IFwiVXJzcHJ1bmdsaWcgZm9ybXVsZXJpbmdcIiwgXCJTa29sdmVya2V0cyBueWEgZm9ybXVsZXJpbmdcIiwgXCJUw6Rja2VyIHVwcGdpZnRlbiBkZW4gbnlhIGZvcm11bGVyaW5nZW4/XCJcbiAgLy8gIEZvciBlYWNoIHJvdywgc2hvdyBzdHJpa2UgdGV4dCArIG5ldyB0ZXh0IHdpdGggZ3JlZW4gYmFja2dyb3VuZC4gVGhlbiBJbXBvcnQgRGF0ZS4gVGhlbiBcIkphIC8gTmVqXCIuXG4gIC8vICBUcnlja2VyIG1hbiBKQSBlbGxlciBuZWogc8OlIHRhcyByYWRlbiBib3J0LlxuICAvLyAgVHJ5Y2tlciBtYW4gTmVqIHPDpSB0YXMgw6R2ZW4ga29wcGxpbmdlbiBib3J0IG9jaCBrdXJzZXIgc29tIGFudsOkbmRlciB1cHBnaWZ0ZW4ga2FuIHDDpXZlcmthcy5cbiAgLy9cbiAgLy8gTsOkc3RhIHNhayBhdHQgZ8O2cmE6IFBpbm5hLyB2aXNhIGJlcsO2cmRhIHVwcGdpZnRlciBtZWQgbnkgZsOkcmcgZWxsZXIgaWtvbi5cbiAgLy8gT2Nrc8OlLCBow7Znc3QgdXBwIHDDpSBrdXJzLXNpZGFuIChrdXJzYnlnZyk6IFZpc2Egc2FtbWEgdmFybmluZ3N0cmlhbmdlbCBPcGVuQ2xvc2VCb3ggb2NoIGxpc3RhXG4gIC8vIMOkbmRyYWRlIGZvcm11bGVyaW5nYXIgKyBiZXLDtnJkYSB1cHBnaWZ0ZXIuIE9tIG1hbiBpbnRlIMOkciByZWRpZ2VyaW5nc2JlaMO2cmlnIGF2IGVuIHVwcGdpZnQgYsO2clxuICAvLyBtYW4ga29udGFrdGEgdXBwZ2lmdGVucyDDpGdhcmUgZsO2ciBhdHQgZ3JhbnNrYSBtaWdyZXJpbmdlbi5cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwsIHNob3dJbmZvLCBjb21wYXJlUHJvcCwgYXJyYXlUb0xvb2t1cCwgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IHsgU2tvbHZlcmtldFN1YmplY3QsIFNrb2x2ZXJrZXRDb3Vyc2UsIHBhcnNlU2tvbHZlcmtldFllYXJzIH0gZnJvbSAnLi9za29sdmVya2V0LXN1YmplY3QnO1xuaW1wb3J0IHsgVXBsb2FkZWRTdWJqZWN0IH0gZnJvbSAnLi91cGxvYWRlZC1zdWJqZWN0JztcbmV4cG9ydCB7IFNob3dTdWJqZWN0IH0gZnJvbSAnLi9zaG93LXN1YmplY3QnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgcmVhZEJsb2JBc1RleHQsIGFsbG93Q29weSB9IGZyb20gXCIuLi91dGlsc1wiO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5pbXBvcnQgeyBTdWJqZWN0c0lubmVyIH0gZnJvbSAnLi9zdWJqZWN0cy1pbm5lcic7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGZlZWRiYWNrVXJsOiBzdHJpbmdcbn1cblxuZXhwb3J0IGNsYXNzIFN1YmplY3RzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgaXNMaXN0aW5nU3ViamVjdHM6IHRydWUsXG4gICAgICBwcmltYXJ5U2Nob29sU3ViamVjdHM6IFtdLFxuICAgICAgdXBsb2FkZWRTdWJqZWN0OiBudWxsXG4gICAgfTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gPGRpdj48Q291cnNlQmFubmVyXG4gICAgICB0aXRsZT17TGDDhG1uZW5gfVxuICAgICAgYWN0aXZlUGFnZT1cInN1YmplY3RzXCJcbiAgICAgIHJvdXRlcz17e2ZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsfX1cbiAgICAgLz5cbiAgICAgPFN1YmplY3RzSW5uZXIgbGlua1ByZWZpeD1cIi9zdWJqZWN0cy9cIiAvPlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IEhhc2hSb3V0ZXIgYXMgUm91dGVyLCBSb3V0ZSwgTGluaywgUmVkaXJlY3QgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2VzL2NvdXJzZS1iYW5uZXJcIjtcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpZDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHN1YmplY3Q6IFN1YmplY3Rcbn1cblxuZXhwb3J0IGNsYXNzIFNob3dTdWJqZWN0SW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7c3ViamVjdDogbnVsbH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIGNvbnN0IHN1YmplY3QgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5nZXQ8U3ViamVjdD4oJ3N1YmplY3RzJywgdGhpcy5wcm9wcy5pZCwgeyBpbmNsdWRlOiAnY291cnNlVGVtcGxhdGVzJyB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHsgc3ViamVjdCB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZiAoIXRoaXMuc3RhdGUuc3ViamVjdCkgcmV0dXJuIDxwPjxTcGlubmVyIC8+PC9wPjtcbiAgICBjb25zdCB7IG5hbWUsIGNvZGUsIGNvdXJzZVRlbXBsYXRlcywgc2Nob29sVHlwZSB9ID0gdGhpcy5zdGF0ZS5zdWJqZWN0O1xuICAgIHJldHVybiA8ZGl2PlxuICAgICAge3NjaG9vbFR5cGUgPT09ICdwcmltYXJ5JyA/IDw+XG4gICAgICAgIDxoMj5HcnVuZHNrb2xlw6RtbmV0IHtuYW1lfSAoe2NvZGV9KTwvaDI+XG4gICAgICAgIDx1bCBjbGFzc05hbWU9XCJlbnRpdHktbGlzdFwiPlxuICAgICAgICAgIHtjb3Vyc2VUZW1wbGF0ZXMubWFwKCh7aWQsIGNvZGUsIHB1Ymxpc2hhYmxlLCBwb2ludHMsIHNjaG9vbEdyYWRlfSkgPT5cbiAgICAgICAgICA8bGkga2V5PXtpZH0gY2xhc3NOYW1lPVwiY29tcGxldGVcIj5cbiAgICAgICAgICAgIHtuYW1lfSBmw7ZyIMOlcnNrdXJzIHtzY2hvb2xHcmFkZX1cbiAgICAgICAgICA8L2xpPil9XG4gICAgICAgIDwvdWw+XG4gICAgICA8Lz4gIDogPD5cbiAgICAgICAgPGgyPkt1cnNlciBmw7ZyIMOkbW5ldCB7bmFtZX0gKHtjb2RlfSk8L2gyPlxuICAgICAgICA8dWwgY2xhc3NOYW1lPVwiZW50aXR5LWxpc3RcIj5cbiAgICAgICAgICB7Y291cnNlVGVtcGxhdGVzLm1hcCgoe2lkLCBuYW1lLCBjb2RlLCBwdWJsaXNoYWJsZSwgcG9pbnRzfSkgPT5cbiAgICAgICAgICA8bGkga2V5PXtpZH0gY2xhc3NOYW1lPVwiY29tcGxldGVcIj5cbiAgICAgICAgICAgIHtuYW1lfSAtIHtwb2ludHN9cFxuICAgICAgICAgIDwvbGk+KX1cbiAgICAgICAgPC91bD5cbiAgICAgIDwvPn1cbiAgICA8L2Rpdj47XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5pbXBvcnQgeyBTaG93U3ViamVjdElubmVyIH0gZnJvbSAnLi9zaG93LXN1YmplY3QtaW5uZXInO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBpZDogc3RyaW5nXG4gIGZlZWRiYWNrVXJsOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgc3ViamVjdDogU3ViamVjdFxufVxuXG5leHBvcnQgY2xhc3MgU2hvd1N1YmplY3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7c3ViamVjdDogbnVsbH07XG4gIH1cblxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICBhc3luYyBsb2FkKCkge1xuICAgIGNvbnN0IHN1YmplY3QgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5nZXQ8U3ViamVjdD4oJ3N1YmplY3RzJywgdGhpcy5wcm9wcy5pZCwgeyBpbmNsdWRlOiAnY291cnNlVGVtcGxhdGVzJyB9KTtcbiAgICB0aGlzLnNldFN0YXRlKHsgc3ViamVjdCB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZiAoIXRoaXMuc3RhdGUuc3ViamVjdCkgcmV0dXJuIDxwPjxTcGlubmVyIC8+PC9wPjtcbiAgICBjb25zdCB7IG5hbWUsIGNvZGUsIGNvdXJzZVRlbXBsYXRlcywgc2Nob29sVHlwZSB9ID0gdGhpcy5zdGF0ZS5zdWJqZWN0O1xuICAgIHJldHVybiA8ZGl2PjxDb3Vyc2VCYW5uZXJcbiAgICAgIHRpdGxlPXtuYW1lfVxuICAgICAgYWN0aXZlUGFnZT1cInN1YmplY3RzXCJcbiAgICAgIHJvdXRlcz17e2ZlZWRiYWNrOiB0aGlzLnByb3BzLmZlZWRiYWNrVXJsfX1cbiAgICAgICAvPlxuICAgICAgIDxTaG93U3ViamVjdElubmVyIGlkPXt0aGlzLnByb3BzLmlkfSAvPlxuICAgIDwvZGl2PjtcbiAgfVxufVxuIiwiZXhwb3J0IGludGVyZmFjZSBTa29sdmVya2V0U3ViamVjdCB7XG4gIG5hbWU6IHN0cmluZztcbiAgc2Nob29sVHlwZTogJ2d5bW5hc2l1bScgfCAncHJpbWFyeSc7XG4gIGNvZGU6IHN0cmluZztcbiAgcHVycG9zZTogc3RyaW5nO1xuICBjb3Vyc2VzOiBTa29sdmVya2V0Q291cnNlW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2tvbHZlcmtldENvdXJzZSB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvZGU6IHN0cmluZztcbiAgICBjZW50cmFsQ29udGVudDogc3RyaW5nO1xuICAgIHllYXI/OiAnMS0zJyB8ICc0LTYnIHwgJzctOSc7XG4gICAgLy9jZW50cmFsQ29udGVudDogQXJyYXk8e3llYXI/OiBzdHJpbmcsIHRleHQ6IHN0cmluZ30+O1xuICAgIHBvaW50czogbnVtYmVyO1xuICAgIGtub3dubGVkZ2VSZXF1aXJlbWVudHM6IEFycmF5PHtncmFkZVN0ZXA6IHN0cmluZywgdGV4dDogc3RyaW5nfT47XG4gICAgLy9rbm93bmxlZGdlUmVxdWlyZW1lbnRzOiBBcnJheTx7Z3JhZGVTdGVwOiBzdHJpbmcsIHRleHQ6IHN0cmluZywgeWVhcj86IG51bWJlcn0+O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTa29sdmVya2V0WWVhcnMgKGluWWVhcjogc3RyaW5nKSA6IEFycmF5PCcxLTMnIHwgJzQtNicgfCAnNy05Jz4ge1xuICBzd2l0Y2goaW5ZZWFyLnRyaW0oKSkge1xuICAgIGNhc2UgJzMnOlxuICAgIGNhc2UgJzEtMyc6XG4gICAgICByZXR1cm4gWycxLTMnXTtcbiAgICBjYXNlICc2JzpcbiAgICBjYXNlICc0LTYnOlxuICAgICAgcmV0dXJuIFsnNC02J107XG4gICAgY2FzZSAnNy05JzpcbiAgICBjYXNlICc5JzpcbiAgICAgIHJldHVybiBbJzctOSddO1xuICAgIC8vIFNwZWNpYWxzXG4gICAgY2FzZSAnMSc6IHJldHVybiBbXCIxLTNcIl07IC8vIEbDtnJla29tbWVyIGkgw6RtbmVuYSBcIlN2ZW5za2FcIiBvY2ggXCJTdmVuc2thIHNvbSBhbmRyYXNwcsOla1wiXG4gICAgY2FzZSAnMXMnOiByZXR1cm4gW1wiMS0zXCJdOyAvLyBGw7ZyZWtvbW1lciBpIMOkbW5lbmEgXCJTdmVuc2thXCIgb2NoIFwiU3ZlbnNrYSBzb20gYW5kcmFzcHLDpWtcIlxuICAgIGNhc2UgJzEtNic6IHJldHVybiBbXCIxLTNcIiwgXCI0LTZcIl07IC8vIEbDtnJla29tbWVyIGkgw6RtbmV0IFwiSGVtLSBvY2gga29uc3VtZW50a3Vuc2thcFwiXG4gICAgY2FzZSAnNC05JzogcmV0dXJuIFtcIjQtNlwiLCBcIjctOVwiXTsgLy8gRsO2cmVrb21tZXIgaSDDpG1uZXQgXCJNb2Rlcm5hIHNwcsOla1wiXG4gICAgZGVmYXVsdDoge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIHllYXIgaW4gU2tvbHZlcmtldCBYTUw6ICR7aW5ZZWFyfS4gRXhwZWN0aW5nIDMsNiw5IG9yIDEtMywgNC02LCA3LTlgKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEwsIHNob3dJbmZvLCBjb21wYXJlUHJvcCwgYXJyYXlUb0xvb2t1cCwgZmxhdHRlbiB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IHsgU2tvbHZlcmtldFN1YmplY3QsIHBhcnNlU2tvbHZlcmtldFllYXJzLCBTa29sdmVya2V0Q291cnNlIH0gZnJvbSAnLi9za29sdmVya2V0LXN1YmplY3QnO1xuaW1wb3J0IHsgVXBsb2FkZWRTdWJqZWN0IH0gZnJvbSAnLi91cGxvYWRlZC1zdWJqZWN0JztcbmV4cG9ydCB7IFNob3dTdWJqZWN0IH0gZnJvbSAnLi9zaG93LXN1YmplY3QnO1xuaW1wb3J0IHsgSGFzaFJvdXRlciBhcyBSb3V0ZXIsIFJvdXRlLCBMaW5rLCBSZWRpcmVjdCB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xuaW1wb3J0IHsgcmVhZEJsb2JBc1RleHQsIGFsbG93Q29weSB9IGZyb20gXCIuLi91dGlsc1wiO1xuaW1wb3J0IHsgQ291cnNlQmFubmVyIH0gZnJvbSBcIi4uL2NvdXJzZXMvY291cnNlLWJhbm5lclwiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi9zdWItY29tcG9uZW50cy9zcGlubmVyXCI7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGxpbmtQcmVmaXg6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgZ3ltbmFzaXVtU3ViamVjdHM6IFN1YmplY3RbXTtcbiAgcHJpbWFyeVNjaG9vbFN1YmplY3RzOiBTdWJqZWN0W107XG4gIGlzTGlzdGluZ1N1YmplY3RzOiBib29sZWFuO1xuICB1cGxvYWRlZFN1YmplY3Q6IFNrb2x2ZXJrZXRTdWJqZWN0IHwgbnVsbDtcbn1cblxuZXhwb3J0IGNsYXNzIFN1YmplY3RzSW5uZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0xpc3RpbmdTdWJqZWN0czogdHJ1ZSxcbiAgICAgIGd5bW5hc2l1bVN1YmplY3RzOiBbXSxcbiAgICAgIHByaW1hcnlTY2hvb2xTdWJqZWN0czogW10sXG4gICAgICB1cGxvYWRlZFN1YmplY3Q6IG51bGxcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMubG9hZCgpO1xuICB9XG5cbiAgYXN5bmMgbG9hZCgpIHtcbiAgICBjb25zdCBzdWJqZWN0cyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U3ViamVjdD4oXCJzdWJqZWN0c1wiKTtcbiAgICBzdWJqZWN0cy5zb3J0KGNvbXBhcmVQcm9wKFwibmFtZVwiKSk7XG4gICAgY29uc3QgZ3ltbmFzaXVtU3ViamVjdHMgPSBzdWJqZWN0cy5maWx0ZXIocyA9PiBzLnNjaG9vbFR5cGUgIT09ICdwcmltYXJ5Jyk7XG4gICAgY29uc3QgcHJpbWFyeVNjaG9vbFN1YmplY3RzID0gc3ViamVjdHMuZmlsdGVyKHMgPT4gcy5zY2hvb2xUeXBlID09PSAncHJpbWFyeScpO1xuICAgIHRoaXMuc2V0U3RhdGUoeyBneW1uYXNpdW1TdWJqZWN0cywgcHJpbWFyeVNjaG9vbFN1YmplY3RzLCBpc0xpc3RpbmdTdWJqZWN0czogZmFsc2UgfSk7XG4gIH1cblxuICBhc3luYyBoYW5kbGVGaWxlU2VsZWN0KGV2OiBSZWFjdC5EcmFnRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSB7XG4gICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBmaWxlcyA9IGV2LmRhdGFUcmFuc2Zlci5maWxlcztcbiAgICBjb25zdCB4bWwgPSBhd2FpdCByZWFkQmxvYkFzVGV4dChmaWxlc1swXSk7XG4gICAgY29uc3QgZG9jID0gJCgkLnBhcnNlWE1MKHhtbCkpO1xuICAgIGNvbnN0IHR5cGVPZlNjaG9vbGluZyA9XG4gICAgICBkb2MuZmluZChcInN1YmplY3Q+b3JpZ2luYXRvclR5cGVPZlNjaG9vbGluZ1wiKS50ZXh0KCkudHJpbSgpIHx8XG4gICAgICBkb2MuZmluZChcInN1YmplY3Q+dHlwZU9mU2Nob29saW5nXCIpLnRleHQoKS50cmltKCk7XG4gICAgY29uc3Qgc2Nob29sVHlwZTogJ3ByaW1hcnknIHwgJ2d5bW5hc2l1bScgPSB0eXBlT2ZTY2hvb2xpbmcgPT09IFwiQ09NUFVMU09SWV9TQ0hPT0xcIiA/XG4gICAgICAncHJpbWFyeScgOlxuICAgICAgdHlwZU9mU2Nob29saW5nID09PSBcIlVQUEVSX1NFQ09OREFSWV9FRFVDQVRJT05cIiA/XG4gICAgICAgICdneW1uYXNpdW0nIDpcbiAgICAgICAgbnVsbDtcblxuICAgIGlmIChzY2hvb2xUeXBlID09PSAnZ3ltbmFzaXVtJykge1xuICAgICAgY29uc3QgbW9kZWw6IFNrb2x2ZXJrZXRTdWJqZWN0ID0ge1xuICAgICAgICBuYW1lOiBkb2MuZmluZChcInN1YmplY3Q+bmFtZVwiKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICBjb2RlOiBkb2MuZmluZChcInN1YmplY3Q+Y29kZVwiKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICBwdXJwb3NlOiBkb2MuZmluZChcInN1YmplY3Q+cHVycG9zZVwiKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICBjb3Vyc2VzOiBbXSxcbiAgICAgICAgc2Nob29sVHlwZTogJ2d5bW5hc2l1bSdcbiAgICAgIH07XG4gICAgICBjb25zdCBjb3Vyc2VzID0gZG9jLmZpbmQoXCJzdWJqZWN0PmNvdXJzZXNcIik7XG4gICAgICBmb3IgKGxldCBpPTA7IGk8Y291cnNlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICBjb25zdCBjb3Vyc2UgPSAkKGNvdXJzZXNbaV0pO1xuICAgICAgICBjb25zdCBrbm93bmxlZGdlUmVxdWlyZW1lbnRzID0gW10uc2xpY2UuY2FsbChjb3Vyc2UuZmluZChcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiKSlcbiAgICAgICAgICAubWFwKHIgPT4gKHtcbiAgICAgICAgICAgIGdyYWRlU3RlcDogJChyKS5maW5kKCdncmFkZVN0ZXAnKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICAgICAgdGV4dDogJChyKS5maW5kKCd0ZXh0JykudGV4dCgpLnRyaW0oKVxuICAgICAgICAgIH0pKTtcblxuICAgICAgICBtb2RlbC5jb3Vyc2VzLnB1c2goe1xuICAgICAgICAgIG5hbWU6IGNvdXJzZS5maW5kKFwibmFtZVwiKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICAgIGNvZGU6IGNvdXJzZS5maW5kKFwiY29kZVwiKS50ZXh0KCkudHJpbSgpLFxuICAgICAgICAgIGNlbnRyYWxDb250ZW50OiBjb3Vyc2UuZmluZChcImNlbnRyYWxDb250ZW50XCIpLnRleHQoKS50cmltKCksXG4gICAgICAgICAgcG9pbnRzOiBwYXJzZUludChjb3Vyc2UuZmluZChcInBvaW50XCIpLnRleHQoKS50cmltKCkpLFxuICAgICAgICAgIGtub3dubGVkZ2VSZXF1aXJlbWVudHMsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy5zZXRTdGF0ZSh7dXBsb2FkZWRTdWJqZWN0OiBtb2RlbH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBjZW50cmFsQ29udGVudHMgPSBmbGF0dGVuKEFycmF5LmZyb20oZG9jLmZpbmQoXCJzdWJqZWN0PmNlbnRyYWxDb250ZW50XCIpKVxuICAgICAgICAubWFwKGNjID0+IHtcbiAgICAgICAgICBjb25zdCB5ZWFyID0gJChjYykuZmluZCgneWVhcicpLnRleHQoKS50cmltKCkgYXMgc3RyaW5nO1xuICAgICAgICAgIGNvbnN0IHR5cGVPZkNlbnRyYWxDb250ZW50ID0gJChjYykuZmluZCgndHlwZU9mQ2VudHJhbENvbnRlbnQnKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZztcblxuICAgICAgICAgIGlmICh0eXBlT2ZDZW50cmFsQ29udGVudCkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHlldCBzdXBwb3J0IG11bHRpcGxlIHR5cGVzIG9mIGNlbnRyYWwgY29udGVudC5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciAoTGDDhG1uZXQgaW5uZWjDpWxsZXIgZmxlcmEgcGFyYWxsZWxsYSB0eXBlciBhdiBjZW50cmFsdCBpbm5laMOlbGwuIERldHRhIHN0w7ZkcyDDpG5udSBpbnRlLmApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHN0YWRpdW1zID0gcGFyc2VTa29sdmVya2V0WWVhcnMoeWVhcik7XG4gICAgICAgICAgY29uc3QgY2VudHJhbENvbnRlbnRzRm9yRWFjaFN0YWRpdW0gPSBzdGFkaXVtcy5tYXAoIHN0YWRpdW0gPT4gKHtcbiAgICAgICAgICAgIHllYXI6IHN0YWRpdW0sXG4gICAgICAgICAgICB0ZXh0OiAkKGNjKS5maW5kKCd0ZXh0JykudGV4dCgpLnRyaW0oKSBhcyBzdHJpbmdcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgcmV0dXJuIGNlbnRyYWxDb250ZW50c0ZvckVhY2hTdGFkaXVtO1xuICAgICAgICB9KSk7XG5cbiAgICAgIGNvbnN0IGtub3dsZWRnZVJlcXVpcmVtZW50cyA9IGZsYXR0ZW4oQXJyYXkuZnJvbShkb2MuZmluZChcInN1YmplY3Q+a25vd2xlZGdlUmVxdWlyZW1lbnRcIikpXG4gICAgICAgIC5tYXAoa3IgPT4ge1xuICAgICAgICAgIGNvbnN0IHllYXIgPSAkKGtyKS5maW5kKCd5ZWFyJykudGV4dCgpLnRyaW0oKTtcblxuICAgICAgICAgIGNvbnN0IHR5cGVPZlJlcXVpcmVtZW50ID0gJChrcikuZmluZCgndHlwZU9mUmVxdWlyZW1lbnQnKS50ZXh0KCkudHJpbSgpIGFzIHN0cmluZztcbiAgICAgICAgICBpZiAodHlwZU9mUmVxdWlyZW1lbnQpIHtcbiAgICAgICAgICAgIC8vIERvIG5vdCB5ZXQgc3VwcG9ydCBtdWx0aXBsZSB0eXBlcyBvZiBrbm93bGVkZ2UgcmVxdWlyZW1lbnQuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IgKExgw4RtbmV0IGlubmVow6VsbGVyIGZsZXJhIHBhcmFsbGVsbGEgdHlwZXIgYXYga3Vuc2thcHNrcmF2LiBEZXR0YSBzdMO2ZHMgw6RubnUgaW50ZS5gKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gcGFyc2VTa29sdmVya2V0WWVhcnMoeWVhcikubWFwKHN0YWRpdW0gPT4gKHtcbiAgICAgICAgICAgIHllYXI6IHN0YWRpdW0sXG4gICAgICAgICAgICB0ZXh0OiAkKGtyKS5maW5kKCd0ZXh0JykudGV4dCgpLnRyaW0oKSxcbiAgICAgICAgICAgIGdyYWRlU3RlcDogJChrcikuZmluZCgnZ3JhZGVTdGVwJykudGV4dCgpLnRyaW0oKVxuICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgICAgXG4gICAgICBjb25zdCBjZW50cmFsQ29udGVudHNCeVN0YWRpdW0gPSBhcnJheVRvTG9va3VwKGNlbnRyYWxDb250ZW50cywgY2MgPT4gY2MueWVhcik7XG4gICAgICBjb25zdCBrbm93bGVkZ2VSZXF1aXJlbWVudHNCeVN0YWRpdW0gPSBhcnJheVRvTG9va3VwKGtub3dsZWRnZVJlcXVpcmVtZW50cywga3IgPT4ga3IueWVhcik7XG5cbiAgICAgIGNvbnN0IHN1YmplY3ROYW1lID0gZG9jLmZpbmQoXCJzdWJqZWN0Pm5hbWVcIikudGV4dCgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IHN1YmplY3RDb2RlID0gZG9jLmZpbmQoXCJzdWJqZWN0PmNvZGVcIikudGV4dCgpLnRyaW0oKTtcbiAgICAgIGNvbnN0IHN1YmplY3RQdXJwb3NlID0gZG9jLmZpbmQoXCJzdWJqZWN0PnB1cnBvc2VcIikudGV4dCgpLnRyaW0oKTtcbiAgICAgIC8qXG5cbiAgICAgICAgUHJvYmxlbWF0aWMgd2hlbiB0aGUgZm9sbG93aW5nIHRhZ3MgYXJlIHByZXNlbnQ6XG5cbiAgICAgICAgPHR5cGVPZlJlcXVpcmVtZW50PlxuICAgICAgICAgIFdJVEhJTl9TVFVERU5UX0NIT0lDRV9DSElORVNFXG4gICAgICAgIDwvdHlwZU9mUmVxdWlyZW1lbnQ+XG4gICAgICAgIDx0eXBlT2ZDZW50cmFsQ29udGVudD5cbiAgICAgICAgICBXSVRISU5fTEFOR1VBR0VfQ0hPSUNFXG4gICAgICAgIDwvdHlwZU9mQ2VudHJhbENvbnRlbnQ+XG4gICAgICAqL1xuXG4gICAgICBjb25zdCBjb3Vyc2VzQnlTdGFkaXVtOiBTa29sdmVya2V0Q291cnNlW10gPSAoWycxLTMnLCc0LTYnLCc3LTknXSBhcyBBcnJheTwnMS0zJyB8ICc0LTYnIHwgJzctOSc+KVxuICAgICAgICAubWFwKHN0YWRpdW0gPT4gKHtcbiAgICAgICAgICBuYW1lOiBzdWJqZWN0TmFtZSsnICcrc3RhZGl1bSxcbiAgICAgICAgICBjb2RlOiBzdWJqZWN0Q29kZSsnfCcrc3RhZGl1bSxcbiAgICAgICAgICBwb2ludHM6IDAsXG4gICAgICAgICAgeWVhcjogc3RhZGl1bSxcbiAgICAgICAgICBjZW50cmFsQ29udGVudDogKGNlbnRyYWxDb250ZW50c0J5U3RhZGl1bVtzdGFkaXVtXXx8W10pLm1hcChjYyA9PiBjYy50ZXh0KS5qb2luKCdcXG4nKSxcbiAgICAgICAgICBrbm93bmxlZGdlUmVxdWlyZW1lbnRzOiAoa25vd2xlZGdlUmVxdWlyZW1lbnRzQnlTdGFkaXVtW3N0YWRpdW1dfHxbXSkubWFwKCh7Z3JhZGVTdGVwLCB0ZXh0fSkgPT4gKHtncmFkZVN0ZXAsIHRleHR9KSlcbiAgICAgICAgfSkpO1xuXG4gICAgICBjb25zdCBtb2RlbDogU2tvbHZlcmtldFN1YmplY3QgPSB7XG4gICAgICAgIG5hbWU6IHN1YmplY3ROYW1lLFxuICAgICAgICBjb2RlOiBzdWJqZWN0Q29kZSxcbiAgICAgICAgcHVycG9zZTogc3ViamVjdFB1cnBvc2UsXG4gICAgICAgIHNjaG9vbFR5cGU6ICdwcmltYXJ5JyxcbiAgICAgICAgY291cnNlczogY291cnNlc0J5U3RhZGl1bVxuICAgICAgfTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe3VwbG9hZGVkU3ViamVjdDogbW9kZWx9KTtcbiAgICB9XG5cbiAgICBcbiAgfVxuXG4gIG9uSW1wb3J0U3VjY2VzcyhzdWJqZWN0KSB7XG4gICAgIHNob3dJbmZvKExgSW1wb3J0ZW4gYXYgJHtzdWJqZWN0fSBseWNrYWRlc2ApO1xuICAgICB0aGlzLnNldFN0YXRlKHt1cGxvYWRlZFN1YmplY3Q6IG51bGx9KTtcbiAgICAgdGhpcy5sb2FkKCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2xpbmtQcmVmaXh9ID0gdGhpcy5wcm9wcztcbiAgICByZXR1cm4gPGRpdj5cbiAgICAgIHt0aGlzLnN0YXRlLnVwbG9hZGVkU3ViamVjdCA/XG4gICAgICA8VXBsb2FkZWRTdWJqZWN0XG4gICAgICAgIG9uQ2FuY2VsPXsoKT0+dGhpcy5zZXRTdGF0ZSh7dXBsb2FkZWRTdWJqZWN0OiBudWxsfSl9XG4gICAgICAgIG9uSW1wb3J0U3VjY2Vzcz17c3ViamVjdCA9PiB0aGlzLm9uSW1wb3J0U3VjY2VzcyhzdWJqZWN0KX1cbiAgICAgICAgc3ViamVjdD17dGhpcy5zdGF0ZS51cGxvYWRlZFN1YmplY3R9IC8+XG4gICAgOiB0aGlzLnN0YXRlLmlzTGlzdGluZ1N1YmplY3RzID9cbiAgICAgIDxkaXY+PHA+PFNwaW5uZXIvPlZhciBnb2QgdsOkbnRhIG1lZGFuIMOkbW5lbiBow6RtdGFzLi4uPC9wPjwvZGl2PiA6XG4gICAgICA8ZGl2PlxuICAgICAgICA8aDI+e0xgR3ltbmFzaWXDpG1uZW5gfTwvaDI+XG4gICAgICAgIDx1bD57dGhpcy5zdGF0ZS5neW1uYXNpdW1TdWJqZWN0cy5tYXAocyA9PlxuICAgICAgICAgIDxsaSBrZXk9e3MuaWR9IGNsYXNzTmFtZT17cy5wdWJsaXNoYWJsZSA/IFwiY29tcGxldGVcIiA6IFwiaW5jb21wbGV0ZVwifT5cbiAgICAgICAgICAgIDxMaW5rIHRvPXtsaW5rUHJlZml4ICsgcy5pZH0+e3MubmFtZX08L0xpbms+XG4gICAgICAgICAgPC9saT4pfVxuICAgICAgICA8L3VsPlxuICAgICAgICA8aDI+e0xgR3J1bmRza29sZcOkbW5lbmB9PC9oMj5cbiAgICAgICAgPHVsPnt0aGlzLnN0YXRlLnByaW1hcnlTY2hvb2xTdWJqZWN0cy5tYXAocyA9PlxuICAgICAgICAgIDxsaSBrZXk9e3MuaWR9IGNsYXNzTmFtZT17cy5wdWJsaXNoYWJsZSA/IFwiY29tcGxldGVcIiA6IFwiaW5jb21wbGV0ZVwifT5cbiAgICAgICAgICAgIDxMaW5rIHRvPXtsaW5rUHJlZml4ICsgcy5pZH0+e3MubmFtZX08L0xpbms+XG4gICAgICAgICAgPC9saT4pfVxuICAgICAgICA8L3VsPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImRyb3Atem9uZVwiIG9uRHJhZ092ZXI9e2FsbG93Q29weX0gb25Ecm9wPXtldj0+dGhpcy5oYW5kbGVGaWxlU2VsZWN0KGV2KX0+XG4gICAgICAgICAgRHJvcHBhIFN1YmplY3QtZmlsIGjDpHIgZnLDpW4gc2tvbHZlcmtldCAoSMOkbXRhcyBmcsOlbiA8YSBocmVmPVwiaHR0cDovL29wZW5kYXRhLnNrb2x2ZXJrZXQuc2VcIiB0YXJnZXQ9XCJza29sdmVya2V0XCI+b3BlbmRhdGEuc2tvbHZlcmtldC5zZTwvYT4pXG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgfTwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgU2tvbHZlcmtldFN1YmplY3QsIFNrb2x2ZXJrZXRDb3Vyc2UgfSBmcm9tICcuL3Nrb2x2ZXJrZXQtc3ViamVjdCc7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgU3ViamVjdCwgQ291cnNlLCBBYmlsaXR5LCBLbm93bGVkZ2VSZXF1aXJlbWVudCwgQ2VudHJhbENvbnRlbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBNdXRhdGlvblJlcXVlc3QsIEJhdGNoUnVubmVyLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHsgQ2hhbmdlIH0gZnJvbSAnLi9kaWZmL2NoYW5nZSc7XG5pbXBvcnQgeyBTdWJqZWN0VG9JbXBvcnQsIENvdXJzZVRvSW1wb3J0IH0gZnJvbSAnLi9zdWJqZWN0LXRvLWltcG9ydCc7XG5pbXBvcnQgeyBkaWZmWG1sV2l0aERhdGFiYXNlIH0gZnJvbSAnLi9kaWZmL2RpZmYteG1sLXdpdGgtZGF0YWJhc2UnO1xuaW1wb3J0IHsgbG9hZENvdXJzZSB9IGZyb20gJy4uL3V0aWxzJztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgb25DYW5jZWw6ICgpID0+IHZvaWQ7XG4gIG9uSW1wb3J0U3VjY2VzczogKHN1YmplY3Q6IHN0cmluZykgPT4gdm9pZDtcbiAgc3ViamVjdDogU2tvbHZlcmtldFN1YmplY3Q7XG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHNob3dGdWxsVGV4dDogYm9vbGVhbjtcbiAgY2hhbmdlczogQ2hhbmdlW107XG4gIHN1YmplY3RUb0ltcG9ydD86IFN1YmplY3RUb0ltcG9ydDtcbiAgaXNXb3JraW5nOiBib29sZWFuO1xuICBpc0ltcG9ydGluZzogYm9vbGVhbjtcbiAgZXJyb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBVcGxvYWRlZFN1YmplY3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIHB1cnBvc2VFbGVtOiBIVE1MRWxlbWVudDtcbiAgY291cnNlc0VsZW1zOiB7IFtjb3Vyc2VDb2RlOiBzdHJpbmddOiB7IGNvdXJzZTogU2tvbHZlcmtldENvdXJzZSwgZWxlbTogSFRNTEVsZW1lbnQgfSB9O1xuICBjZW50cmFsQ29udGVudEVsZW1zOiBIVE1MRWxlbWVudFtdO1xuICBrbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zOiBIVE1MRWxlbWVudFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLmNvdXJzZXNFbGVtcyA9IHt9O1xuICAgIHRoaXMuY2VudHJhbENvbnRlbnRFbGVtcyA9IFtdO1xuICAgIHRoaXMua25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtcyA9IFtdO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzaG93RnVsbFRleHQ6IGZhbHNlLFxuICAgICAgY2hhbmdlczogW10sXG4gICAgICBpc1dvcmtpbmc6IHRydWUsXG4gICAgICBpc0ltcG9ydGluZzogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5hZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qge2NoYW5nZXMsIHN1YmplY3RUb0ltcG9ydH0gPSBhd2FpdCB0aGlzLmRpZmZXaXRoRXhpc3RpbmcoKTtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBjaGFuZ2VzLCBzdWJqZWN0VG9JbXBvcnQgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvcjogJycrZXJyb3IgfSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc1dvcmtpbmc6IGZhbHNlIH0pO1xuICAgIH1cbiAgfVxuXG4gIGFkZENsYXNzZXNGb3JDaGVycnlQaWNrZWRFbGVtZW50cygpIHtcbiAgICBjb25zdCBhYmlsaXRpZXMgPSAkKHRoaXMucHVycG9zZUVsZW0pLmZpbmQoJ2xpJykuZmlyc3QoKS5wYXJlbnQoKS5jaGlsZHJlbignbGknKTtcbiAgICBhYmlsaXRpZXMuYWRkQ2xhc3MoJ2FiaWxpdHknKTtcbiAgICBjb25zdCBjZW50cmFsQ29udGVudHMgPSAkKHRoaXMuY2VudHJhbENvbnRlbnRFbGVtcykuZmluZCgnbGknKTtcbiAgICBjZW50cmFsQ29udGVudHMuYWRkQ2xhc3MoJ2NlbnRyYWwtY29udGVudCcpO1xuICAgIGNvbnN0IGtub3dsZWRnZVJlcXVpcmVtZW50cyA9ICQodGhpcy5rbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zKS5maW5kKCdwJyk7XG4gICAga25vd2xlZGdlUmVxdWlyZW1lbnRzLmFkZENsYXNzKCdrbm93bGVkZ2UtcmVxdWlyZW1lbnQnKTtcbiAgICBjb25zdCBhbGwgPSAkKFthYmlsaXRpZXMsIGNlbnRyYWxDb250ZW50cywga25vd2xlZGdlUmVxdWlyZW1lbnRzXSk7XG4gICAgYWxsLmFkZENsYXNzKCdtYXJrZWQtYXJlYScpO1xuICB9XG5cbiAgY2hlcnJ5UGlja0RhdGEoKTogU3ViamVjdFRvSW1wb3J0IHtcbiAgICAvL1xuICAgIC8vIFJlYWRzIGVsZW1lbnRzICh0YWdnZWQgYnkgY2xhc3NlcyBpbiBhZGRDbGFzc2VzRm9yQ2hlcnJ5UGlja2VkRWxlbWVudHMoKSkgYW5kIGNvbnZlcnRzIHRoZWlyIGlubmVyIEhUTUwgdG8gdGhlIGNvcnJlc3BvbmRpbmdcbiAgICAvLyBtb2RlbCBTdWJqZWN0VG9JbXBvcnQuIE5vdGUgdGhhdCBpZiB3ZSBuZWVkIHRvIGFkanVzdCBob3cgdG8gcGljayB0aGUgcmlnaHQgTEkgb3IgUCBlbGVtZW50cywgd2VcbiAgICAvLyB3aWxsIG9ubHkgbmVlZCB0byBjaGFuZ2UgdGhlIGNvZGUgaW4gYWRkQ2xhc3Nlc0ZvckNoZXJyeVBpY2tlZEVsZW1lbnRzKCksIG5vdCB0aGlzIGNvZGUuXG4gICAgLy9cbiAgICBjb25zdCBza29sU3ViamVjdCA9IHRoaXMucHJvcHMuc3ViamVjdDtcbiAgICBjb25zdCBhYmlsaXRpZXNMaXMgPSBBcnJheS5mcm9tKCQodGhpcy5wdXJwb3NlRWxlbSkuZmluZCgnbGknKS5maXJzdCgpLnBhcmVudCgpLmNoaWxkcmVuKCdsaScpKTtcbiAgICBjb25zdCBhYmlsaXRpZXMgPSBhYmlsaXRpZXNMaXMubWFwKChhLCBpKSA9PiBgJHtpICsgMX0uICR7JChhKS5odG1sKCl9YC50cmltKCkpLmZpbHRlcihodG1sID0+ICEhaHRtbCk7XG5cbiAgICBjb25zdCByZXN1bHQ6IFN1YmplY3RUb0ltcG9ydCA9IHtcbiAgICAgIG5hbWU6IHNrb2xTdWJqZWN0Lm5hbWUsXG4gICAgICBjb2RlOiBza29sU3ViamVjdC5jb2RlLFxuICAgICAgc2Nob29sVHlwZTogc2tvbFN1YmplY3Quc2Nob29sVHlwZSxcbiAgICAgIGFiaWxpdGllcyxcbiAgICAgIGNvdXJzZXM6IE9iamVjdC5rZXlzKHRoaXMuY291cnNlc0VsZW1zKVxuICAgICAgICAubWFwKGNvdXJzZUNvZGUgPT4gdGhpcy5jb3Vyc2VzRWxlbXNbY291cnNlQ29kZV0pXG4gICAgICAgIC5tYXA8Q291cnNlVG9JbXBvcnQ+KCh7IGNvdXJzZSwgZWxlbSB9KSA9PiAoe1xuICAgICAgICAgIG5hbWU6IGNvdXJzZS5uYW1lLFxuICAgICAgICAgIHllYXI6IGNvdXJzZS55ZWFyLFxuICAgICAgICAgIGNvZGU6IGNvdXJzZS5jb2RlLFxuICAgICAgICAgIHBvaW50czogY291cnNlLnBvaW50cyxcbiAgICAgICAgICBjZW50cmFsQ29udGVudDogQXJyYXkuZnJvbSgkKGVsZW0pLmZpbmQoJy5jZW50cmFsLWNvbnRlbnQnKSkubWFwKGMgPT4gKHtcbiAgICAgICAgICAgIGh0bWw6ICQoYykuaHRtbCgpLnRyaW0oKSBhcyBzdHJpbmcsXG4gICAgICAgICAgICBncm91cDogJChjKS5wYXJlbnQoJ3VsJykucHJldignaDQnKS50ZXh0KCkudHJpbSgpXG4gICAgICAgICAgfSkpLmZpbHRlcigoe2h0bWx9KSA9PiAhIWh0bWwpLFxuICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50czpcbiAgICAgICAgICAgIEFycmF5LmZyb20oJChlbGVtKS5maW5kKCcuZ3JhZGUtc3RlcC1ub25lIC5rbm93bGVkZ2UtcmVxdWlyZW1lbnQnKSkubWFwKHIgPT4gJChyKS5odG1sKCkudHJpbSgpKVxuICAgICAgICAgICAgICAuZmlsdGVyKGh0bWwgPT4gISFodG1sKVxuICAgICAgICAgICAgICAubWFwKGh0bWwgPT4gKHtncmFkZVN0ZXA6IG51bGwsIGh0bWwgfSkpXG4gICAgICAgICAgICAgIC5jb25jYXQoXG4gICAgICAgICAgICAgICAgQXJyYXkuZnJvbSgkKGVsZW0pLmZpbmQoJy5ncmFkZS1zdGVwLUUgLmtub3dsZWRnZS1yZXF1aXJlbWVudCcpKS5tYXAociA9PiAkKHIpLmh0bWwoKS50cmltKCkpXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKGh0bWwgPT4gISFodG1sKVxuICAgICAgICAgICAgICAgICAgLm1hcChodG1sID0+ICh7IGdyYWRlU3RlcDogXCJFXCIsIGh0bWwgfSkpXG4gICAgICAgICAgICAgICAgICAuY29uY2F0KFxuICAgICAgICAgICAgICAgICAgICBBcnJheS5mcm9tKCQoZWxlbSkuZmluZCgnLmdyYWRlLXN0ZXAtQyAua25vd2xlZGdlLXJlcXVpcmVtZW50JykpLm1hcChyID0+ICQocikuaHRtbCgpLnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGh0bWwgPT4gISFodG1sKVxuICAgICAgICAgICAgICAgICAgICAgIC5tYXAoaHRtbCA9PiAoeyBncmFkZVN0ZXA6IFwiQ1wiLCBodG1sIH0pKSlcbiAgICAgICAgICAgICAgICAgICAgICAuY29uY2F0KFxuICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkuZnJvbSgkKGVsZW0pLmZpbmQoJy5ncmFkZS1zdGVwLUEgLmtub3dsZWRnZS1yZXF1aXJlbWVudCcpKS5tYXAociA9PiAkKHIpLmh0bWwoKS50cmltKCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoaHRtbCA9PiAhIWh0bWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoaHRtbCA9PiAoeyBncmFkZVN0ZXA6IFwiQVwiLCBodG1sIH0pKSkpXG4gICAgICAgICAgICAgICAgICAgIH0pKVxuICAgIH07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGFzeW5jIGRpZmZXaXRoRXhpc3RpbmcoKTogUHJvbWlzZTx7Y2hhbmdlczogQ2hhbmdlW10sIHN1YmplY3RUb0ltcG9ydDogU3ViamVjdFRvSW1wb3J0fT4ge1xuICAgIGNvbnN0IHN1YmplY3RUb0ltcG9ydCA9IHRoaXMuY2hlcnJ5UGlja0RhdGEoKTtcbiAgICBsZXQgY2hhbmdlczogQ2hhbmdlW10gPSBbXTtcbiAgICAvLyBGaW5kIGV4aXN0aW5nIFN1YmplY3RcbiAgICBjb25zdCBleGlzdGluZ1N1YmplY3RzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxTdWJqZWN0PihcInN1YmplY3RzXCIpO1xuICAgIGxldCBleGlzdGluZ1N1YmplY3QgPSBleGlzdGluZ1N1YmplY3RzLmZpbHRlcihzID0+IHMuY29kZSA9PT0gdGhpcy5wcm9wcy5zdWJqZWN0LmNvZGUpWzBdO1xuICAgIGxldCBjZW50cmFsQ29udGVudCA9IFtdIGFzIENlbnRyYWxDb250ZW50W10sXG4gICAgICBrbm93bGVkZ2VSZXF1aXJlbWVudHMgPSBbXSBhcyBLbm93bGVkZ2VSZXF1aXJlbWVudFtdO1xuXG4gICAgbGV0IGNyZWF0ZVRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGZ1bmN0aW9uIGN0KCkge1xuICAgICAgY29uc3QgcnYgPSBjcmVhdGVUaW1lO1xuICAgICAgY3JlYXRlVGltZSArPSAyO1xuICAgICAgcmV0dXJuIHJ2O1xuICAgIH1cblxuICAgIGlmIChleGlzdGluZ1N1YmplY3QpIHtcbiAgICAgIC8vIEluY2x1ZGUgYWJpbGl0aWVzIGFuZCBzdGFuZGFyZENvdXJzZXMgd2l0aCB0aGUgZm91bmQgU3ViamVjdDpcbiAgICAgIGF3YWl0IGRpZmZYbWxXaXRoRGF0YWJhc2UoZXhpc3RpbmdTdWJqZWN0LCBzdWJqZWN0VG9JbXBvcnQsIGNoYW5nZXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBTdWJqZWN0IG5vdCBpbXBvcnRlZCBiZWZvcmUuIEFkZCBpdCFcbiAgICAgIGNvbnN0IG5ld1N1YmplY3Q6IFN1YmplY3QgPSBleGlzdGluZ1N1YmplY3QgPSB7XG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgIHNjaG9vbFR5cGU6IHN1YmplY3RUb0ltcG9ydC5zY2hvb2xUeXBlLFxuICAgICAgICB0YWdzOiBbXCJzY2hvb2xUeXBlOlwiICsgc3ViamVjdFRvSW1wb3J0LnNjaG9vbFR5cGVdLFxuICAgICAgICBhY2w6IFtcInJvbGU6VVNFUjpSXCJdLFxuICAgICAgICBjb2RlOiBzdWJqZWN0VG9JbXBvcnQuY29kZSxcbiAgICAgICAgbmFtZTogc3ViamVjdFRvSW1wb3J0Lm5hbWUsXG4gICAgICAgIGFiaWxpdGllc09yZGVyOiBbXSwgLy8gVXBkYXRlIGxhdGVyIG9uIVxuICAgICAgICBwdWJsaXNoYWJsZTogZmFsc2UsXG4gICAgICAgIGRhdGVUaW1lOiBjdCgpXG4gICAgICB9O1xuICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgY2hhbmdlOiBcIk55dHQgw6RtbmVcIixcbiAgICAgICAgY29udGVudDogYCR7c3ViamVjdFRvSW1wb3J0Lm5hbWV9ICgke3N1YmplY3RUb0ltcG9ydC5jb2RlfSlgLFxuICAgICAgICBtdXRhdGlvbnM6IHIgPT4gci5hZGQoXCJzdWJqZWN0c1wiLCBuZXdTdWJqZWN0KVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHN1YmplY3RBYmlsaXRpZXMgPSBbXTtcblxuICAgICAgZm9yIChsZXQgYSBvZiBzdWJqZWN0VG9JbXBvcnQuYWJpbGl0aWVzKSB7XG4gICAgICAgIGNvbnN0IG5ld0FiaWxpdHk6IEFiaWxpdHkgPSB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICBuYW1lOiBhLFxuICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl0sXG4gICAgICAgICAgZGF0ZVRpbWU6IGN0KClcbiAgICAgICAgfTtcblxuICAgICAgICBzdWJqZWN0QWJpbGl0aWVzLnB1c2gobmV3QWJpbGl0eSk7IC8vIFRvIHJlZmVyIGZyb20gaW4gY291cnNlcyBsYXRlciBvbiFcblxuICAgICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICAgIGNoYW5nZTogXCJOeSBmw7ZybcOlZ2FcIixcbiAgICAgICAgICBjb250ZW50OiBhLFxuICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICByLmFkZChcImFiaWxpdGllc1wiLCBuZXdBYmlsaXR5KTtcbiAgICAgICAgICAgIHIubGluayhcInN1YmplY3RzXCIsIG5ld1N1YmplY3QuaWQsIFwiYWJpbGl0aWVzXCIsIG5ld0FiaWxpdHkuaWQsIFwiYWJpbGl0aWVzXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFVwZGF0ZSBub3cgd2hlbiB3ZSBoYXZlIGFiaWxpdGllcyBvcmRlcjpcbiAgICAgIG5ld1N1YmplY3QuYWJpbGl0aWVzT3JkZXIgPSBzdWJqZWN0QWJpbGl0aWVzLm1hcCgoe2lkfSkgPT4gaWQpO1xuXG4gICAgICBmb3IgKGxldCBjIG9mIHN1YmplY3RUb0ltcG9ydC5jb3Vyc2VzKSB7XG4gICAgICAgIGNvbnN0IG5ld0NvdXJzZTogQ291cnNlID0ge1xuICAgICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgICAgc3ViamVjdENvZGU6IG5ld1N1YmplY3QuY29kZSxcbiAgICAgICAgICBzY2hvb2xUeXBlOiBuZXdTdWJqZWN0LnNjaG9vbFR5cGUsXG4gICAgICAgICAgdGFnczogW1xuICAgICAgICAgICAgXCJzdWI6XCIgKyBuZXdTdWJqZWN0LmNvZGUsXG4gICAgICAgICAgICBcImNvdXJzZTpcIiArIGMuY29kZSxcbiAgICAgICAgICAgIFwic2Nob29sVHlwZTpcIiArIG5ld1N1YmplY3Quc2Nob29sVHlwZVxuICAgICAgICAgIF0sXG4gICAgICAgICAgZGF0ZVRpbWU6IGN0KCksXG4gICAgICAgICAgaXNUZW1wbGF0ZTogdHJ1ZSxcbiAgICAgICAgICBhY2w6IFtcInJvbGU6RU1QTE9ZRUU6UlwiXSwgLy8gU3RhbmRhcmRrdXJzZXIgZW5kYXN0IHN5bmxpZ2EgZsO2ciBsw6RyYXJlXG4gICAgICAgICAgbmFtZTogYy5uYW1lLFxuICAgICAgICAgIGNvZGU6IGMuY29kZSxcbiAgICAgICAgICBwb2ludHM6IGMucG9pbnRzLFxuICAgICAgICAgIG1vZHVsZXM6IFtdLFxuICAgICAgICAgIHN1YmplY3RJZDogbmV3U3ViamVjdC5pZCxcbiAgICAgICAgICByZXNvdXJjZXM6IFtdLFxuICAgICAgICAgIGNyZWF0ZWRCeTogeyBuYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWUsIHVybDogXCJtYWlsdG86XCIgKyBlbnYuY3VycmVudFVzZXIubWFpbCB9LFxuICAgICAgICAgIGNyZWF0ZWREYXRlOiBEYXRlLm5vdygpLFxuICAgICAgICAgIGtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyOiBbXSxcbiAgICAgICAgICBjZW50cmFsQ29udGVudE9yZGVyOiBbXSxcbiAgICAgICAgICBhYmlsaXRpZXNPcmRlcjogc3ViamVjdEFiaWxpdGllcy5tYXAoKHtpZH0pID0+IGlkKVxuICAgICAgICB9O1xuICAgICAgICBpZiAoYy55ZWFyKSBuZXdDb3Vyc2Uuc2Nob29sR3JhZGUgPSBjLnllYXI7XG5cbiAgICAgICAgY2hhbmdlcy5wdXNoKHtcbiAgICAgICAgICBjaGFuZ2U6IFwiTnkga3Vyc1wiLFxuICAgICAgICAgIGNvbnRlbnQ6IGMubmFtZSxcbiAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xuICAgICAgICAgICAgci5hZGQoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZSk7XG4gICAgICAgICAgICByLmxpbmsoXCJzdWJqZWN0c1wiLCBuZXdTdWJqZWN0LmlkLCBcImNvdXJzZXNcIiwgbmV3Q291cnNlLmlkLCBcImNvdXJzZVRlbXBsYXRlc1wiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAobGV0IHtncm91cDogY2NHcm91cCwgaHRtbH0gb2YgYy5jZW50cmFsQ29udGVudCkge1xuICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGV4aXN0cyBhbiBpZGVudGljYWwgY2VudHJhbCBjb250ZW50IG9uIHByZXZpb3VzIGNvdXJzZSBmaXJzdFxuICAgICAgICAgIGxldCBuZXdDZW50cmFsQ29udGVudCA9IGNlbnRyYWxDb250ZW50LmZpbHRlcihjYyA9PiBjYy5uYW1lID09PSBodG1sKVswXTtcbiAgICAgICAgICBpZiAoIW5ld0NlbnRyYWxDb250ZW50KSB7XG4gICAgICAgICAgICBuZXdDZW50cmFsQ29udGVudCA9IHtcbiAgICAgICAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcbiAgICAgICAgICAgICAgZGF0ZVRpbWU6IGN0KCksXG4gICAgICAgICAgICAgIG5hbWU6IGh0bWwsXG4gICAgICAgICAgICAgIGFjbDogW1wicm9sZTpVU0VSOlJcIl1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoY2NHcm91cCkgbmV3Q2VudHJhbENvbnRlbnQuZ3JvdXAgPSBjY0dyb3VwO1xuICAgICAgICAgICAgY2VudHJhbENvbnRlbnQucHVzaChuZXdDZW50cmFsQ29udGVudCk7XG5cbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgICAgIGNoYW5nZTogXCJOeXR0IGNlbnRyYWx0IGlubmVow6VsbFwiLFxuICAgICAgICAgICAgICBjb250ZW50OiBgPGg0PiR7Y2NHcm91cH08L2g0PiR7aHRtbH1gLFxuICAgICAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xuICAgICAgICAgICAgICAgIHIuYWRkKFwiY2VudHJhbC1jb250ZW50XCIsIG5ld0NlbnRyYWxDb250ZW50KTtcbiAgICAgICAgICAgICAgICByLmxpbmsoXCJjb3Vyc2VzXCIsIG5ld0NvdXJzZS5pZCwgXCJjZW50cmFsLWNvbnRlbnRcIiwgbmV3Q2VudHJhbENvbnRlbnQuaWQsIFwiY2VudHJhbENvbnRlbnRcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGNoYW5nZXMucHVzaCh7XG4gICAgICAgICAgICAgIG11dGF0aW9uczogciA9PiB7XG4gICAgICAgICAgICAgICAgci5saW5rKFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwiY2VudHJhbC1jb250ZW50XCIsIG5ld0NlbnRyYWxDb250ZW50LmlkLCBcImNlbnRyYWxDb250ZW50XCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIG9yZGVyIGluIHdoaWNoIHRoaXMgY2VudHJhbCBjb250ZW50IGFwcGVhcmVkIGluIHRoZSBYTUw6XG4gICAgICAgICAgbmV3Q291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIucHVzaChuZXdDZW50cmFsQ29udGVudC5pZCk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBjciBvZiBjLmtub3dsZWRnZVJlcXVpcmVtZW50cykge1xuICAgICAgICAgIGxldCBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudCA9IGtub3dsZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIoa3IgPT4ga3IubmFtZSA9PT0gY3IuaHRtbCAmJiBrci5ncmFkZVN0ZXAgPT09IGNyLmdyYWRlU3RlcClbMF07XG4gICAgICAgICAgaWYgKCFuZXdLbm93bGVkZ2VSZXF1aXJlbWVudCkge1xuICAgICAgICAgICAgbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQgPSB7XG4gICAgICAgICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXG4gICAgICAgICAgICAgIGRhdGVUaW1lOiBjdCgpLFxuICAgICAgICAgICAgICBuYW1lOiBjci5odG1sLFxuICAgICAgICAgICAgICBncmFkZVN0ZXA6IGNyLmdyYWRlU3RlcCxcbiAgICAgICAgICAgICAgYWNsOiBbXCJyb2xlOlVTRVI6UlwiXVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAga25vd2xlZGdlUmVxdWlyZW1lbnRzLnB1c2gobmV3S25vd2xlZGdlUmVxdWlyZW1lbnQpO1xuXG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICAgICAgICBjaGFuZ2U6IFwiTnl0dCBrdW5za2Fwc2tyYXYgZsO2ciBiZXR5Z2V0IFwiICsgY3IuZ3JhZGVTdGVwLFxuICAgICAgICAgICAgICBjb250ZW50OiBjci5odG1sLFxuICAgICAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xuICAgICAgICAgICAgICAgIHIuYWRkKFwia25vd2xlZGdlLXJlcXVpcmVtZW50c1wiLCBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudCk7XG4gICAgICAgICAgICAgICAgci5saW5rKFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwia25vd2xlZGdlLXJlcXVpcmVtZW50c1wiLCBuZXdLbm93bGVkZ2VSZXF1aXJlbWVudC5pZCwgXCJrbm93bGVkZ2VSZXF1aXJlbWVudHNcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICAgICAgICBtdXRhdGlvbnM6IHIgPT4ge1xuICAgICAgICAgICAgICAgIHIubGluayhcImNvdXJzZXNcIiwgbmV3Q291cnNlLmlkLCBcImtub3dsZWRnZS1yZXF1aXJlbWVudHNcIiwgbmV3S25vd2xlZGdlUmVxdWlyZW1lbnQuaWQsIFwia25vd2xlZGdlUmVxdWlyZW1lbnRzXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBSZWdpc3RlciB0aGUgb3JkZXIgaW4gd2hpY2ggdGhpcyBrbm93bGVkZ2UgcmVxdWlyZW1lbnQgYXBwZWFyZWQgaW4gdGhlIFhNTDpcbiAgICAgICAgICBuZXdDb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIucHVzaChuZXdLbm93bGVkZ2VSZXF1aXJlbWVudC5pZCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQnVpbGQga25vd2xlZGdlIG1hdHJpeFxuXG4gICAgICAgIC8vIExpbmsgZGlyZWN0bHkgZnJvbSBjb3Vyc2UgdGVtcGxhdGUgdG8gYWxsIGFiaWxpdGllcyB0aGF0IHRoZSBzdWJqZWN0IGhhczpcbiAgICAgICAgZm9yIChjb25zdCBhIG9mIHN1YmplY3RBYmlsaXRpZXMpIHtcbiAgICAgICAgICBjaGFuZ2VzLnB1c2goe1xuICAgICAgICAgICAgbXV0YXRpb25zOiByID0+IHtcbiAgICAgICAgICAgICAgci5saW5rKFwiY291cnNlc1wiLCBuZXdDb3Vyc2UuaWQsIFwiYWJpbGl0aWVzXCIsIGEuaWQsIFwiYWJpbGl0aWVzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtjaGFuZ2VzLCBzdWJqZWN0VG9JbXBvcnR9O1xuICB9XG5cbiAgY2FuY2VsKCkge1xuICAgIHRoaXMucHJvcHMub25DYW5jZWwoKTtcbiAgfVxuXG4gIGFzeW5jIGltcG9ydCgpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgaXNXb3JraW5nOiB0cnVlLCBpc0ltcG9ydGluZzogdHJ1ZSB9KTtcbiAgICBjb25zdCBhbGxNdXRhdGlvbnMgPSB0aGlzLnN0YXRlLmNoYW5nZXMubWFwKGNoYW5nZSA9PiBjaGFuZ2UubXV0YXRpb25zKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuZG8ociA9PiB7XG4gICAgICAgIGFsbE11dGF0aW9ucy5mb3JFYWNoKG11dCA9PiBtdXQocikpO1xuICAgICAgfSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBpc1dvcmtpbmc6IGZhbHNlLCBpc0ltcG9ydGluZzogZmFsc2UgfSk7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25JbXBvcnRTdWNjZXNzKHRoaXMucHJvcHMuc3ViamVjdC5uYW1lKTtcbiAgfVxuXG4gIGZpeEwoaHRtbDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGh0bWw7Ly8ucmVwbGFjZSgnPGwgZnJvbWF0PVwiT0xcIj4nKVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtzdWJqZWN0VG9JbXBvcnR9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7c3ViamVjdH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiA8ZGl2PjxoMT57TGBVcHBsYWRkYXQgw4RtbmUgJHtzdWJqZWN0VG9JbXBvcnQgPyBzdWJqZWN0VG9JbXBvcnQubmFtZSA6ICcnfWB9PC9oMT5cbiAgICAgIHt0aGlzLnN0YXRlLmVycm9yID8gPHA+RmVsOiB7dGhpcy5zdGF0ZS5lcnJvcn08L3A+IDpcbiAgICAgICB0aGlzLnN0YXRlLmlzV29ya2luZyA/IDxwPkFyYmV0YXIuLi48L3A+IDpcbiAgICAgICB0aGlzLnN0YXRlLmlzSW1wb3J0aW5nID8gPHA+SW1wb3J0ZXJhci4uLjwvcD4gOlxuICAgICAgIHRoaXMuc3RhdGUuY2hhbmdlcy5ldmVyeShjID0+ICFjLmNoYW5nZSkgPyAvLyBJbmdhIMOkbmRyaW5nYXIgYXR0IHZpc2EgKGJhcmEgcHNldWRvLcOkbmRyaW5nYXIpXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8cD5LdW5kZSBpbnRlIGZpbm5hIG7DpWdyYSBmw7Zyw6RuZHJpbmdhciBmcsOlbiBiZWZpbnRsaWd0IGRhdGEuIEtsaWNrYSBPSyBmw7ZyIGF0dCBhdmJyeXRhIG9jaCDDpXRlcmfDpS48L3A+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gdGhpcy5jYW5jZWwoKX0+IE9LIDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+IDpcbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8dGFibGUgc3R5bGU9e3tib3JkZXI6IFwiMXB4IHNvbGlkIGdyYXlcIiwgcGFkZGluZzogXCIycHhcIiB9fT48dGhlYWQ+PHRyPlxuICAgICAgICAgIDx0aCBjb2xTcGFuPXsyfT5HcmFuc2tuaW5nIGF2IMOkbmRyaW5nYXIgaSBncnVuZC1kYXRhPC90aD5cbiAgICAgICAgPC90cj48dHI+XG4gICAgICAgICAgICA8dGg+w4RuZHJpbmc8L3RoPlxuICAgICAgICAgICAgPHRoPklubmVow6VsbDwvdGg+XG4gICAgICAgICAgPC90cj48L3RoZWFkPjx0Ym9keT5cbiAgICAgICAgICAgIHt0aGlzLnN0YXRlLmNoYW5nZXMuZmlsdGVyKGNoYW5nZSA9PiBjaGFuZ2UuY2hhbmdlKS5tYXAoKGNoYW5nZSxpKSA9PiA8dHIga2V5PXtpfT5cbiAgICAgICAgICAgICAgPHRkIHN0eWxlPXt7cGFkZGluZzogXCIycHhcIn19PntjaGFuZ2UuY2hhbmdlfTwvdGQ+XG4gICAgICAgICAgICAgIDx0ZCBzdHlsZT17e3BhZGRpbmc6IFwiMnB4XCJ9fSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IGNoYW5nZS5jb250ZW50IH19IC8+XG4gICAgICAgICAgICA8L3RyPil9XG4gICAgICAgICAgPC90Ym9keT48L3RhYmxlPlxuICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHRoaXMuY2FuY2VsKCl9IGRpc2FibGVkPXt0aGlzLnN0YXRlLmlzSW1wb3J0aW5nfT5BdmJyeXQ8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXsoKSA9PiB0aGlzLmltcG9ydCgpfSBkaXNhYmxlZD17dGhpcy5zdGF0ZS5pc0ltcG9ydGluZ30+SW1wb3J0ZXJhPC9idXR0b24+XG4gICAgICAgIDxiciAvPlxuICAgICAgICA8L2Rpdj59IFxuICAgICAgPGJ1dHRvblxuICAgICAgICBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgc2hvd0Z1bGxUZXh0OiAhdGhpcy5zdGF0ZS5zaG93RnVsbFRleHQgfSl9PlxuICAgICAgICB7dGhpcy5zdGF0ZS5zaG93RnVsbFRleHQgP1xuICAgICAgICAgIExgRMO2bGogbmVkYW5gIDpcbiAgICAgICAgICBMYFZpc2EgaGVsYSB0ZXh0ZW4gZnLDpW4gU2tvbHZlcmtldGB9XG4gICAgICA8L2J1dHRvbj5cblxuICAgICAgey8qIFRoZSB0YWJsZSBiZWxvdyBpcyBOT1QganVzdCBmb3Igc2hvdyFcbiAgICAgICAgICBGdW5jdGlvbmFsaXR5IGlzIGRlcGVuZGVudCBvbiBpdHMgZXhpc3RlbmNlIGZvciBpbXBvcnRpbmcgc3R1ZmYgdXNpbmcgalF1ZXJ5IHRvIGNoZXJyeS1waWNrIGRhdGEuICovfSAgICAgICAgICBcbiAgICAgIDx0YWJsZSBzdHlsZT17eyBkaXNwbGF5OiB0aGlzLnN0YXRlLnNob3dGdWxsVGV4dCA/ICcnIDogJ25vbmUnIH19Pjx0Ym9keT48dHI+XG4gICAgICAgIDx0aD5cbiAgICAgICAgICBOYW1uXG4gICAgICAgIDwvdGg+XG4gICAgICAgIDx0ZD5cbiAgICAgICAgICB7c3ViamVjdC5uYW1lfVxuICAgICAgICA8L3RkPlxuICAgICAgPC90cj48dHI+XG4gICAgICAgICAgPHRoPlxuICAgICAgICAgICAgw4RtbmVza29kXG4gICAgICAgICAgPC90aD5cbiAgICAgICAgICA8dGQ+XG4gICAgICAgICAgICB7c3ViamVjdC5jb2RlfVxuICAgICAgICAgIDwvdGQ+XG4gICAgICAgIDwvdHI+PHRyPlxuICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgIFN5ZnRlXG4gICAgICAgICAgPC90aD5cbiAgICAgICAgICA8dGQgcmVmPXtlbGVtID0+IHRoaXMucHVycG9zZUVsZW0gPSBlbGVtfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChzdWJqZWN0LnB1cnBvc2UpIH19IC8+XG4gICAgICAgIDwvdHI+PHRyPlxuICAgICAgICAgIDx0aD5cbiAgICAgICAgICAgIEt1cnNlclxuICAgICAgICAgIDwvdGg+XG4gICAgICAgICAgPHRkPlxuICAgICAgICAgICAge3N1YmplY3QuY291cnNlcy5tYXAoY291cnNlID0+IDx0YWJsZSBrZXk9e2NvdXJzZS5jb2RlfSByZWY9e2VsZW0gPT4gdGhpcy5jb3Vyc2VzRWxlbXNbY291cnNlLmNvZGVdID0geyBjb3Vyc2UsIGVsZW0gfX0+PHRib2R5PlxuICAgICAgICAgICAgICA8dHI+PHRoPkt1cnNlbnMgbmFtbjwvdGg+PHRkPntjb3Vyc2UubmFtZX08L3RkPjwvdHI+XG4gICAgICAgICAgICAgIDx0cj48dGg+S3Vyc2tvZDwvdGg+PHRkPntjb3Vyc2UuY29kZX08L3RkPjwvdHI+XG4gICAgICAgICAgICAgIDx0cj48dGg+UG/DpG5nPC90aD48dGQ+e2NvdXJzZS5wb2ludHN9PC90ZD48L3RyPlxuICAgICAgICAgICAgICA8dHI+PHRoPkNlbnRyYWx0IGlubmVow6VsbDwvdGg+PHRkIHJlZj17ZWxlbSA9PiB0aGlzLmNlbnRyYWxDb250ZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmNlbnRyYWxDb250ZW50KSB9fSAvPjwvdHI+XG4gICAgICAgICAgICAgIHtjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5zb21lKGtyID0+ICFrci5ncmFkZVN0ZXApID8gPHRyPlxuICAgICAgICAgICAgICAgIDx0aD5LdW5za2Fwc2tyYXYgdXRhbiBiZXR5Z3PDpHR0bmluZzwvdGg+XG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImdyYWRlLXN0ZXAtbm9uZVwiIHJlZj17ZWxlbSA9PiB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuZmlsdGVyKHIgPT4gIXIuZ3JhZGVTdGVwKS5tYXAoa3IgPT4ga3IudGV4dCkuam9pbignJykpIH19IC8+XG4gICAgICAgICAgICAgIDwvdHI+IDogdW5kZWZpbmVkfVxuXG4gICAgICAgICAgICAgIHtjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5zb21lKGtyID0+IGtyLmdyYWRlU3RlcCA9PT0nRScpID8gPHRyPlxuICAgICAgICAgICAgICAgIDx0aD5LdW5za2Fwc2tyYXYgQmV0eWcgRTwvdGg+XG4gICAgICAgICAgICAgICAgPHRkIGNsYXNzTmFtZT1cImdyYWRlLXN0ZXAtRVwiIHJlZj17ZWxlbSA9PiB0aGlzLmtub3dsZWRnZVJlcXVpcmVtZW50RWxlbXMucHVzaChlbGVtKX0gZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiB0aGlzLmZpeEwoY291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuZmlsdGVyKHIgPT4gci5ncmFkZVN0ZXAgPT09ICdFJykubWFwKGtyID0+IGtyLnRleHQpLmpvaW4oJycpKSB9fSAvPlxuICAgICAgICAgICAgICA8L3RyPiA6IHVuZGVmaW5lZH1cblxuICAgICAgICAgICAgICB7Y291cnNlLmtub3dubGVkZ2VSZXF1aXJlbWVudHMuc29tZShrciA9PiBrci5ncmFkZVN0ZXAgPT09J0MnKSA/IDx0cj5cbiAgICAgICAgICAgICAgICA8dGg+S3Vuc2thcHNrcmF2IEJldHlnIEM8L3RoPlxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJncmFkZS1zdGVwLUNcIiByZWY9e2VsZW0gPT4gdGhpcy5rbm93bGVkZ2VSZXF1aXJlbWVudEVsZW1zLnB1c2goZWxlbSl9IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7IF9faHRtbDogdGhpcy5maXhMKGNvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLmZpbHRlcihyID0+IHIuZ3JhZGVTdGVwID09PSAnQycpLm1hcChrciA9PiBrci50ZXh0KS5qb2luKCcnKSkgfX0gLz5cbiAgICAgICAgICAgICAgPC90cj4gOiB1bmRlZmluZWR9XG5cbiAgICAgICAgICAgICAge2NvdXJzZS5rbm93bmxlZGdlUmVxdWlyZW1lbnRzLnNvbWUoa3IgPT4ga3IuZ3JhZGVTdGVwID09PSdBJykgPyA8dHI+XG4gICAgICAgICAgICAgICAgPHRoPkt1bnNrYXBza3JhdiBCZXR5ZyBBPC90aD5cbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiZ3JhZGUtc3RlcC1BXCIgcmVmPXtlbGVtID0+IHRoaXMua25vd2xlZGdlUmVxdWlyZW1lbnRFbGVtcy5wdXNoKGVsZW0pfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17eyBfX2h0bWw6IHRoaXMuZml4TChjb3Vyc2Uua25vd25sZWRnZVJlcXVpcmVtZW50cy5maWx0ZXIociA9PiByLmdyYWRlU3RlcCA9PT0gJ0EnKS5tYXAoa3IgPT4ga3IudGV4dCkuam9pbignJykpIH19IC8+XG4gICAgICAgICAgICAgIDwvdHI+IDogdW5kZWZpbmVkfVxuXG4gICAgICAgICAgICA8L3Rib2R5PjwvdGFibGU+KX1cbiAgICAgICAgICA8L3RkPlxuICAgICAgICA8L3RyPlxuICAgICAgPC90Ym9keT48L3RhYmxlPlxuICAgIDwvZGl2PlxuICB9XG59XG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0IHsgRG9jdW1lbnQsIFJlc291cmNlLCBNb2RpZmljYXRpb25UcmFja2VkLCBDb3Vyc2UsIFRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XG5pbXBvcnQgeyBCYXRjaFJ1bm5lciwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCB1cGRhdGUgZnJvbSAncmVhY3QtYWRkb25zLXVwZGF0ZSc7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcbmltcG9ydCB7IGdldEZpcnN0QW5kTGFzdFdlZWtPZlRlcm0gfSBmcm9tICcuLi8uLi91dGlscy9zY2hvb2wtbW9tZW50JztcblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZURvY3VtZW50R3JhcGhzKG9sZERvYywgbmV3RG9jLCB0YWJsZTogc3RyaW5nLCBncmFwaHM6IHsgW2xhYmVsOiBzdHJpbmddOiBzdHJpbmcgfSwgYmF0Y2g6IEJhdGNoUnVubmVyKSB7XG4gIGNvbnN0IGRvY1VwZGF0ZXMgPSB7fTtcbiAgY29uc3QgZG9jSWQgPSBuZXdEb2MuaWQ7XG4gIGZvciAobGV0IG5hdlByb3Agb2YgT2JqZWN0LmtleXMoZ3JhcGhzKSkge1xuICAgIGNvbnN0IGZvcmVpZ25UYWJsZSA9IGdyYXBoc1tuYXZQcm9wXTtcbiAgICBjb25zdCBvbGRMaXN0OiBEb2N1bWVudFtdID0gb2xkRG9jW25hdlByb3BdIHx8IFtdO1xuICAgIGNvbnN0IG5ld0xpc3Q6IERvY3VtZW50W10gPSBuZXdEb2NbbmF2UHJvcF07XG4gICAgaWYgKCFuZXdMaXN0KSBjb250aW51ZTtcbiAgICBjb25zdCB0dXBsZXMgPSBuZXdMaXN0XG4gICAgICAubWFwKChkb2MsIGlkeCk9Pih7ZG9jLCBpZHh9KSk7IC8vIENyZWF0ZSB0dWJsZXMgb2Yge2RvYywgYXJyYXktaW5kZXh9IHNvIHdlIGNhbiB1cGRhdGUgcmVzdWx0XG4gICAgY29uc3QgYWRkZWQgPSB0dXBsZXMuZmlsdGVyKHR1cGxlID0+ICFvbGRMaXN0LnNvbWUobyA9PiBvLmlkID09PSB0dXBsZS5kb2MuaWQpKTsgLy8gRmluZCBhZGRlZCBpdGVtc1xuXG4gICAgZm9yIChsZXQgYSBvZiBhZGRlZCkge1xuICAgICAgY29uc3QgbXV0YXRlZFN1YkRvYyA9IHsuLi5hLmRvY307XG4gICAgICBjb25zdCBtZXRhID0gbXV0YXRlZFN1YkRvYy4kbWV0YTtcbiAgICAgIGRlbGV0ZSBtdXRhdGVkU3ViRG9jLiRtZXRhOyAvLyBEZWxldGUgJG1ldGEgc28gdGhhdCBcImFkZFwiIG9yIFwidXBkYXRlXCIgZG9lcyBub3QgcGVyc2lzdGUgdG8gbmV4dCBzdGF0ZS5cbiAgICAgIGlmIChtZXRhID09PSAnYWRkJykge1xuICAgICAgICBpZiAoIW11dGF0ZWRTdWJEb2MuaWQpIG11dGF0ZWRTdWJEb2MuaWQgPSBjcmVhdGVVVUlEKCk7IC8vIEdlbmVyYXRlIElEIGlmIG5vdCBkb25lIHlldC5cbiAgICAgICAgLy8gTm93IHB1dCBhbiAnYWRkJyBtdXRhdGlvbiBpbiB0aGUgYmF0Y2ggcXVldWUuXG4gICAgICAgIGJhdGNoLmFkZChmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MpO1xuICAgICAgfSBlbHNlIGlmIChtZXRhID09PSAndXBkYXRlJykge1xuICAgICAgICBiYXRjaC5wdXQoZm9yZWlnblRhYmxlLCBtdXRhdGVkU3ViRG9jKTtcbiAgICAgIH1cbiAgICAgIGJhdGNoLmxpbmsodGFibGUsIGRvY0lkLCBmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MuaWQsIG5hdlByb3ApO1xuXG4gICAgICAvLyBVcGRhdGUgcmVzdWx0IHNvIHRoYXQgc3RhdGUgaXMgcmVmbGVjdGVkIGFmdGVyIHN1Y2Nlc2Z1bCBQT1NUIHRvIHNlcnZlci5cbiAgICAgIGlmICghZG9jVXBkYXRlc1tuYXZQcm9wXSkgZG9jVXBkYXRlc1tuYXZQcm9wXSA9IHt9O1xuICAgICAgZG9jVXBkYXRlc1tuYXZQcm9wXVthLmlkeF0gPSB7JHNldDogbXV0YXRlZFN1YkRvY307XG4gICAgfVxuICAgIGNvbnN0IHJlbW92ZWQgPSBvbGRMaXN0LmZpbHRlcihvID0+ICFuZXdMaXN0LnNvbWUobiA9PiBuLmlkID09PSBvLmlkKSk7XG4gICAgZm9yIChsZXQgciBvZiByZW1vdmVkKSB7XG4gICAgICBiYXRjaC51bmxpbmsodGFibGUsIGRvY0lkLCBmb3JlaWduVGFibGUsIHIuaWQsIG5hdlByb3ApO1xuICAgIH1cbiAgICBjb25zdCB1cGRhdGVkID0gdHVwbGVzLmZpbHRlcih0dXBsZSA9PiBvbGRMaXN0LnNvbWUobyA9PiBvLmlkID09PSB0dXBsZS5kb2MuaWQgJiYgdHVwbGUuZG9jLiRtZXRhID09PSAndXBkYXRlJykpO1xuICAgIGZvciAobGV0IHUgb2YgdXBkYXRlZCkge1xuICAgICAgY29uc3QgbXV0YXRlZFN1YkRvYyA9IHsuLi51LmRvY307XG4gICAgICBkZWxldGUgbXV0YXRlZFN1YkRvYy4kbWV0YTtcbiAgICAgIGJhdGNoLnB1dChmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MpO1xuXG4gICAgICAvLyBVcGRhdGUgcmVzdWx0IHNvIHRoYXQgJG1ldGEgaXMgcmVtb3ZlZCBmcm9tIG5hdmlnYXRpb24gcHJvcCBhZnRlciBzdWNjZXNzZnVsIFBPU1QgdG8gc2VydmVyLlxuICAgICAgaWYgKCFkb2NVcGRhdGVzW25hdlByb3BdKSBkb2NVcGRhdGVzW25hdlByb3BdID0ge307XG4gICAgICBkb2NVcGRhdGVzW25hdlByb3BdW3UuaWR4XSA9IHskc2V0OiBtdXRhdGVkU3ViRG9jfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVwZGF0ZShuZXdEb2MsIGRvY1VwZGF0ZXMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZHRGb3JtYXQoZGF0ZVRpbWU6IG51bWJlciB8IERhdGUgfCBtb21lbnQuTW9tZW50KSB7XG4gIHJldHVybiBtb21lbnQoZGF0ZVRpbWUpLmZvcm1hdCgnWVlNTUREIEhIOm1tJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG9ydERhdGVGb3JtYXQoZGF0ZVRpbWU6IG51bWJlciB8IERhdGUgfCBtb21lbnQuTW9tZW50KSB7XG4gIHJldHVybiBtb21lbnQoZGF0ZVRpbWUpLmZvcm1hdCgnWVlNTUREJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG9ydFBlcnNvbk5hbWVGb3JtYXQobmFtZTogc3RyaW5nKSB7XG4gIGlmICghbmFtZSkgcmV0dXJuIFwiXCI7XG4gIGNvbnN0IG5hbWVzID0gbmFtZS5zcGxpdCgnICcpLmZpbHRlcihuID0+ICEhbik7XG4gIGNvbnN0IGxhc3ROYW1lID0gbmFtZXMucG9wKCk7XG4gIHJldHVybiBuYW1lcy5tYXAobmFtZSA9PiBgJHtuYW1lWzBdfS5gKS5jb25jYXQobGFzdE5hbWUpLmpvaW4oJyAnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vZGlmaWNhdGlvblN0YW1wIChub3c6IG51bWJlciwgb2JqOiBNb2RpZmljYXRpb25UcmFja2VkLCB1c2VyOiBVc2VyKSB7XG4gIHJldHVybiB1cGRhdGUob2JqLCB7XG4gICAgZGF0ZVRpbWU6IHskc2V0OiBub3d9LCAvLyBGb3IgcXVlcmllcy4uLlxuICAgIG1vZGlmaWVkRGF0ZTogeyRzZXQ6IG5vd30sXG4gICAgbW9kaWZpZWRCeToge1xuICAgICAgJHNldDoge1xuICAgICAgICBuYW1lOiB1c2VyLmRpc3BsYXlOYW1lLFxuICAgICAgICB1cmw6IFwibWFpbHRvOlwiICsgdXNlci5tYWlsXG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNyZWF0aW9uU3RhbXAgKG5vdzogbnVtYmVyLCBvYmo6IE1vZGlmaWNhdGlvblRyYWNrZWQsIHVzZXI6IFVzZXIpIHtcbiAgcmV0dXJuIHVwZGF0ZShvYmosIHtcbiAgICBjcmVhdGVkRGF0ZTogeyRzZXQ6IERhdGUubm93KCl9LFxuICAgIGNyZWF0ZWRCeToge1xuICAgICAgJHNldDoge1xuICAgICAgICBuYW1lOiB1c2VyLmRpc3BsYXlOYW1lLFxuICAgICAgICB1cmw6IFwibWFpbHRvOlwiICsgdXNlci5tYWlsXG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBvYmogPSB1cGRhdGVNb2RpZmljYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XG4gIGlmICghb2JqLmNyZWF0ZWRCeSkgb2JqID0gdXBkYXRlQ3JlYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XG4gIHJldHVybiBvYmo7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseUV0YWdzKGRvYzogRG9jdW1lbnQsIG5ld0V0YWdzOiB7W2lkOiBzdHJpbmddOiBzdHJpbmd9LCBncmFwaHM6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IHJlcyA9IHsuLi5kb2N9O1xuICBjb25zdCBldGFnID0gbmV3RXRhZ3NbZG9jLmlkXTtcbiAgaWYgKGV0YWcpXG4gICAgcmVzLiRldGFnID0gZXRhZztcbiAgZm9yIChsZXQgbGFiZWwgb2YgZ3JhcGhzKSB7XG4gICAgY29uc3QgbmV3TGlzdCA9IGRvY1tsYWJlbF0ubWFwKGQgPT4gYXBwbHlFdGFncyhkLCBuZXdFdGFncywgW10pKTtcbiAgICByZXNbbGFiZWxdID0gbmV3TGlzdDtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2IoYmxvYjogQmxvYiwgbTogKHI6RmlsZVJlYWRlcik9PnZvaWQpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgIHJlYWRlci5vbmxvYWQgPSBldiA9PiByZXNvbHZlKChldi50YXJnZXQgYXMgYW55KS5yZXN1bHQpO1xuICAgIHJlYWRlci5vbmFib3J0ID0gZXYgPT4gcmVqZWN0KG5ldyBFcnJvcihcImZpbGUgcmVhZCBhYm9ydGVkXCIpKTtcbiAgICByZWFkZXIub25lcnJvciA9IGV2ID0+IHJlamVjdCgoZXYudGFyZ2V0IGFzIGFueSkuZXJyb3IpO1xuICAgIG0ocmVhZGVyKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYkFzVGV4dCAoYmxvYjogQmxvYikge1xuICByZXR1cm4gcmVhZEJsb2IoYmxvYiwgcj0+ci5yZWFkQXNUZXh0KGJsb2IpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iQXNEYXRhVXJsIChibG9iOiBCbG9iKSB7XG4gIHJldHVybiByZWFkQmxvYihibG9iLCByPT5yLnJlYWRBc0RhdGFVUkwoYmxvYikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWxsb3dDb3B5KGU6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ291cnNlQnVpbGRlclN0YXR1cyhzdGF0dXM6ICd1bnNhdmVkJyB8ICdzYXZlZCcgfCAnZXJyb3InIHwgJycpIHtcbiAgY29uc3QgZGl2ID0gJCgnZGl2LmNvdXJzZS1idWlsZGVyJylbMF07XG4gIGlmIChkaXYpIGRpdi5jbGFzc05hbWUgPSBcImNvdXJzZS1idWlsZGVyXCIgKyAoc3RhdHVzID8gXCIgc3RhdHVzIFwiICsgc3RhdHVzIDogXCJcIik7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkQ291cnNlKGlkOiBzdHJpbmcsIG9wdGlvbnM/OiB7XG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4/OiBib29sZWFuLFxuICAgIGluY2x1ZGU/OiBzdHJpbmdbXVxuICB9KTogUHJvbWlzZTxDb3Vyc2U+XG57XG4gIGNvbnN0IGNsaWVudCA9IGVudi5rZWRCYWNrZW5kQ2xpZW50O1xuICBjb25zdCBpbmNsdWRlVGVtcGxhdGVDaGFpbiA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlVGVtcGxhdGVDaGFpbjtcbiAgY29uc3QgaW5jbHVkZVRhc2tzID0gIW9wdGlvbnMgfHwgIW9wdGlvbnMuaW5jbHVkZSB8fCBvcHRpb25zLmluY2x1ZGUuaW5kZXhPZihcInRhc2tzXCIpICE9PSAtMTtcbiAgY29uc3QgW2NvdXJzZSwgY291cnNlVGFza3MsIHRlbXBsYXRlQ2hhaW5dID0gKGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBjbGllbnQuZ2V0KFwiY291cnNlc1wiLCBpZCwge1xuICAgICAgaW5jbHVkZTogb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGUgPyBvcHRpb25zLmluY2x1ZGUuZmlsdGVyKGkgPT4gaSAhPT0gXCJ0YXNrc1wiKSA6IFtcbiAgICAgICAgXCJjZW50cmFsQ29udGVudFwiLFxuICAgICAgICBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLFxuICAgICAgICBcImFiaWxpdGllc1wiLFxuICAgICAgICBcImltYWdlc1wiLFxuICAgICAgICBcImFjbFwiIC8vIERvbid0IGluY2x1ZGUgdGFza3MgaGVyZS4uLlxuICAgICAgXVxuICAgIH0pLFxuICAgIC8vIC4uLiBidXQgaW5jbHVkZSB0YXNrcyBoZXJlIGluc3RlYWQgc28gdGhhdCB3ZSBjYW4gbG9hZCB0aGUgZ3JhcGhzIGZvciB0aGVcbiAgICAvLyB0YXNrcyBhcyB3ZWxsIVxuICAgIGluY2x1ZGVUYXNrcyAmJiBjbGllbnQubGlzdChcInRhc2tzXCIsIHtcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXG4gICAgICBpbmNsdWRlOiBbJ2tub3dsZWRnZVJlcXVpcmVtZW50cycsICdjZW50cmFsQ29udGVudCcsICdhYmlsaXRpZXMnLCAnYWNsJ10sXG4gICAgICBmbGFnczogWydpbmNsdWRlSWRzT25seSddIC8vIERvbid0IG5lZWQgcmVkdW5kYW50IGluZm8gdGhhdCdzIGFscmVhZHkgb24gY291cnNlXG4gICAgfSksXG4gICAgaW5jbHVkZVRlbXBsYXRlQ2hhaW4gJiYgY2xpZW50Lmxpc3QoXCJjb3Vyc2VzXCIsIHtcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXG4gICAgICBmbGFnczogWydpZHNPbmx5J11cbiAgICB9KVxuICBdKSkgYXMgW0NvdXJzZSwgVGFza1tdLCBDb3Vyc2VbXV07XG4gIGNvdXJzZS50YXNrcyA9IGNvdXJzZVRhc2tzO1xuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEFiaWxpdGllc1xuICBpZiAoY291cnNlLmFiaWxpdGllcyAmJiBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIpIHtcbiAgICBjb3Vyc2UuYWJpbGl0aWVzID0gY291cnNlLmFiaWxpdGllc09yZGVyLm1hcChpZCA9PlxuICAgICAgY291cnNlLmFiaWxpdGllcy5maW5kKGEgPT4gYS5pZCA9PT0gaWQpKTtcbiAgfVxuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIEtub3dsZWRnZVJlcXVpcmVtZW50c1xuICBpZiAoY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cyAmJiBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIpIHtcbiAgICBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzID0gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50c09yZGVyLm1hcChpZCA9PlxuICAgICAgY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5maW5kKGMgPT4gYy5pZCA9PT0gaWQpKTtcbiAgfVxuXG4gIC8vIENvcnJlY3QgdGhlIG9yZGVyIG9mIENlbnRyYWxDb250ZW50XG4gIGlmIChjb3Vyc2UuY2VudHJhbENvbnRlbnQgJiYgY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIpIHtcbiAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQgPSBjb3Vyc2UuY2VudHJhbENvbnRlbnRPcmRlci5tYXAoaWQgPT5cbiAgICAgIGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09PSBpZCkpOy8vLmZpbHRlcih4ID0+ICEheCk7Ly8gRGVidWdnaW5nIHNvbXRoaW4nIC4gTm9ybWFsbHkgdGhlIGxhc3QgLmZpbHRlcigpLi4uIHBhcnQgc2hvdWxkIG5vdCBiZSBuZXNjZXNzYXJ5Li4uXG4gIH1cbiAgXG4gIC8vIEluY2x1ZGUgdGVtcGxhdGUgY2hhaW4gaWYgcmVxdWVzdGVkLlxuICBpZiAoaW5jbHVkZVRlbXBsYXRlQ2hhaW4pIGNvdXJzZS50ZW1wbGF0ZUNoYWluID0gdGVtcGxhdGVDaGFpbjtcbiAgcmV0dXJuIGNvdXJzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc01pZ3JhdGVkVGV4dHModGFzazogVGFzaykge1xuICByZXR1cm4gdGFzay5taWdyYXRlZFRleHRzICYmIE9iamVjdC5rZXlzKHRhc2subWlncmF0ZWRUZXh0cykuc29tZSh0eXBlID0+XG4gICAgT2JqZWN0LmtleXModGFzay5taWdyYXRlZFRleHRzW3R5cGVdKS5sZW5ndGggPiAwKTtcbn1cbiIsIi8qIFJFRkFDVE9SOiBNb3ZlIHRoaXMgY29tcG9uZW50IG91dHNpZGUgY291cnNlYnVpbGRlciFcbiAgIFRoaXMgaXMgYSBnZW5lcmFsLXB1cnBvc2UgY29tcG9uZW50XG4qL1xuXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHRpdGxlOiBzdHJpbmcgfCBKU1guRWxlbWVudDtcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xuICBoZWFkZXJDbGFzc05hbWU/OiBzdHJpbmc7XG4gIGNvbnRlbnRDbGFzc05hbWU/OiBzdHJpbmc7XG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xuICBvbk9wZW5DbG9zZT86IChiZWNhbWVPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xuICBjaGlsZHJlbjtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgaGVhZGVyT3BlbjogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIE9wZW5DbG9zZUJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGhlYWRlck9wZW46IHByb3BzLmhlYWRlck9wZW4gfHwgZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyAobmV4dFByb3BzOiBQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMuaGVhZGVyT3BlbiAhPT0gdGhpcy5wcm9wcy5oZWFkZXJPcGVuKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtoZWFkZXJPcGVuOiBuZXh0UHJvcHMuaGVhZGVyT3Blbn0pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHRpdGxlLCBjbGFzc05hbWUsIGNoaWxkcmVuLCBoZWFkZXJDbGFzc05hbWUsIGNvbnRlbnRDbGFzc05hbWUgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBoZWFkZXJPcGVuIH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXsoY2xhc3NOYW1lfHwnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkhlYWRlclwiICsgKGhlYWRlckNsYXNzTmFtZSA/IFwiIFwiICsgaGVhZGVyQ2xhc3NOYW1lIDogXCJcIil9XG4gICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICBpZiAodGhpcy5wcm9wcy5vbk9wZW5DbG9zZSkgdGhpcy5wcm9wcy5vbk9wZW5DbG9zZSghdGhpcy5zdGF0ZS5oZWFkZXJPcGVuKTtcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KTtcbiAgICAgICAgfX0gPlxuICAgICAgICB7dGl0bGV9XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtcIm9wZW5Db250ZW50XCIgKyAoY29udGVudENsYXNzTmFtZSA/IFwiIFwiICsgY29udGVudENsYXNzTmFtZSA6IFwiXCIpfT5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+O1xuICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbHMnO1xuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgdGFnPzogJ2lucHV0JyB8ICd0ZXh0YXJlYSdcbiAgICBlYWdlcj86IGJvb2xlYW47XG4gICAgb25DaGFuZ2U6IChuZXdOYW1lOiBzdHJpbmcpID0+IHZvaWQ7XG4gICAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7IC8vIElmIHRleHQgaXMgZW1wdHksIHRoaXMgd2lsbCBiZSB0aGUgcGxhY2Vob2xkZXJcbiAgICBjbGlja0FkdmVydGlzZVRleHQ/OiBzdHJpbmc7XG4gICAgbWF4Q2hhcnM/OiBudW1iZXI7XG4gICAgcmVhZE9ubHk/OiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICAgIGVkaXRNb2RlOiBib29sZWFuO1xuICAgIHJ1bnRpbWVTdHlsZTogT2JqZWN0O1xuICAgIHRleHQ6IHN0cmluZyB8IG51bGw7XG59XG5cbi8qKiBcbiAqIE1ha2VzIGEgdGV4dCBlbGVtZW50IChzdWNoIGFzIGFuIEEgb3IgUCB0YWcpIHBvc3NpYmxlIHRvIHJlcGxhY2Ugd2l0aCBhbiBpbnB1dCBlbGVtZW50IG9mIHRoZSBzYW1lIENTUyBzdHlsZSwgZm9yIGV4YW1wbGUgYnkgY2xpY2tpbmcgb24gaXQuXG4gKiBcbiovXG5leHBvcnQgY2xhc3MgUmVuYW1lYWJsZVRleHQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcbiAgICBsYWJlbDogSFRNTEVsZW1lbnQ7XG4gICAgaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGVkaXRNb2RlOiBmYWxzZSxcbiAgICAgICAgICAgIHJ1bnRpbWVTdHlsZTogbnVsbCxcbiAgICAgICAgICAgIHRleHQ6IHByb3BzLnRleHQgfHwgXCJcIlxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMudGV4dCAhPT0gbmV4dFByb3BzLnRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3RleHQ6IG5leHRQcm9wcy50ZXh0IHx8IFwiXCJ9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRoaXMuc3RhdGUudGV4dCB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gPGRpdlxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJyZW5hbWVhYmxlLXRleHRcIiArICh0ZXh0ID8gXCJcIiA6IFwiIHVubmFtZWRcIikgKyAodGhpcy5wcm9wcy5yZWFkT25seSA/IFwiIGRpc2FibGVkXCIgOiBcIlwiKX1cbiAgICAgICAgICAgICAgICB0YWJJbmRleD17dGhpcy5zdGF0ZS5lZGl0TW9kZSA/IHVuZGVmaW5lZCA6IDB9XG4gICAgICAgICAgICAgICAgb25Gb2N1cz17KGUpPT57dGhpcy5yZW5hbWUoKX19XG4gICAgICAgICAgICAgICAgc3R5bGU9e3t3aWR0aDogXCIxMDAlXCJ9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgIHJlZj17bGFiZWwgPT4gdGhpcy5sYWJlbCA9IGxhYmVsfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiB0aGlzLnN0YXRlLmVkaXRNb2RlID8gJ25vbmUnIDogJydcbiAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt0ZXh0IHx8IHRoaXMucHJvcHMuY2xpY2tBZHZlcnRpc2VUZXh0fVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7dGhpcy5wcm9wcy50YWcgPT09ICd0ZXh0YXJlYScgP1xuICAgICAgICAgICAgICAgIDx0ZXh0YXJlYSByZWY9e2lucHV0ID0+IHRoaXMuaW5wdXQgPSBpbnB1dH1cbiAgICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoPXt0aGlzLnByb3BzLm1heENoYXJzfVxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17ey4uLnRoaXMuc3RhdGUucnVudGltZVN0eWxlLCBkaXNwbGF5OiB0aGlzLnN0YXRlLmVkaXRNb2RlID8gJycgOiAnbm9uZSd9fVxuICAgICAgICAgICAgICAgICAgICBvbkZvY3VzPXtldj0+JChldi50YXJnZXQpLnNlbGVjdCgpfVxuICAgICAgICAgICAgICAgICAgICBvbkJsdXI9e3RoaXMub25CbHVyLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0ZXh0fVxuICAgICAgICAgICAgICAgICAgICBvbktleURvd249e3RoaXMub25LZXlEb3duLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0aGlzLnN0YXRlLmVkaXRNb2RlID8gMCA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9XG4gICAgICAgICAgICAgICAgLz4gOiBcbiAgICAgICAgICAgICAgICA8aW5wdXQgcmVmPXtpbnB1dCA9PiB0aGlzLmlucHV0ID0gaW5wdXR9XG4gICAgICAgICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoPXt0aGlzLnByb3BzLm1heENoYXJzfVxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17ey4uLnRoaXMuc3RhdGUucnVudGltZVN0eWxlLCBkaXNwbGF5OiB0aGlzLnN0YXRlLmVkaXRNb2RlID8gJycgOiAnbm9uZSd9fVxuICAgICAgICAgICAgICAgICAgICBvbkZvY3VzPXtldj0+JChldi50YXJnZXQpLnNlbGVjdCgpfVxuICAgICAgICAgICAgICAgICAgICBvbkJsdXI9e3RoaXMub25CbHVyLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt0ZXh0fVxuICAgICAgICAgICAgICAgICAgICBvbktleURvd249e3RoaXMub25LZXlEb3duLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgICAgICAgICAgICAgIHRhYkluZGV4PXt0aGlzLnN0YXRlLmVkaXRNb2RlID8gMCA6IHVuZGVmaW5lZH1cbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIH1cbiAgICAgICAgPC9kaXY+XG4gICAgfVxuXG4gICAgb25LZXlEb3duKGU6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIHsgLy8gRVNDXG4gICAgICAgICAgICB0aGlzLmlucHV0LnZhbHVlID0gdGhpcy5wcm9wcy50ZXh0IHx8IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmlucHV0LmJsdXIoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZS5rZXlDb2RlID09PSAxMykgeyAvLyBFTlRFUlxuICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGVPbkNoYW5nZSh0aGlzLmlucHV0LnZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoeyBlZGl0TW9kZTogZmFsc2UsIHRleHQ6IHRoaXMuaW5wdXQudmFsdWUgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkJsdXIoZTogRXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcm9wYWdhdGVPbkNoYW5nZSh0aGlzLmlucHV0LnZhbHVlKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGVkaXRNb2RlOiBmYWxzZSwgdGV4dDogdGhpcy5pbnB1dC52YWx1ZSB9KTtcbiAgICB9XG5cbiAgICBwcm9wYWdhdGVkT25DaGFuZ2U6IHN0cmluZztcblxuICAgIHByb3BhZ2F0ZU9uQ2hhbmdlKG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BhZ2F0ZWRPbkNoYW5nZSAhPSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGVkT25DaGFuZ2UgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DaGFuZ2UoZTogRXZlbnQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHRleHQ6IHRoaXMuaW5wdXQudmFsdWUgfSk7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmVhZ2VyKSB0aGlzLnByb3BhZ2F0ZU9uQ2hhbmdlKHRoaXMuaW5wdXQudmFsdWUpO1xuICAgIH1cblxuICAgIHJlbmFtZSh0eHQ/OiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuZWRpdE1vZGUgfHwgdGhpcy5wcm9wcy5yZWFkT25seSkgcmV0dXJuO1xuICAgICAgICB0eHQgPSB0eHQgfHwgdGhpcy5zdGF0ZS50ZXh0IHx8IFwiXCI7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gJCh0aGlzLmxhYmVsKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICB0ZXh0OiB0eHQsXG4gICAgICAgICAgICBlZGl0TW9kZTogdHJ1ZSxcbiAgICAgICAgICAgIHJ1bnRpbWVTdHlsZToge1xuICAgICAgICAgICAgICAgIHRleHRBbGlnbjogbGFiZWwuY3NzKCd0ZXh0QWxpZ24nKSxcbiAgICAgICAgICAgICAgICBmb250U2l6ZTogbGFiZWwuY3NzKCdmb250LXNpemUnKSxcbiAgICAgICAgICAgICAgICBwYWRkaW5nVG9wOiBsYWJlbC5jc3MoJ3BhZGRpbmdUb3AnKSxcbiAgICAgICAgICAgICAgICBwYWRkaW5nQm90dG9tOiBsYWJlbC5jc3MoJ3BhZGRpbmdCb3R0b20nKSxcbiAgICAgICAgICAgICAgICBwYWRkaW5nTGVmdDogbGFiZWwuY3NzKCdwYWRkaW5nTGVmdCcpLFxuICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogbGFiZWwuY3NzKCdwYWRkaW5nUmlnaHQnKSxcbiAgICAgICAgICAgICAgICBtYXJnaW5Ub3A6IGxhYmVsLmNzcygnbWFyZ2luVG9wJyksXG4gICAgICAgICAgICAgICAgbWFyZ2luQm90dG9tOiBsYWJlbC5jc3MoJ21hcmdpbkJvdHRvbScpLFxuICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6IGxhYmVsLmNzcygnbWFyZ2luTGVmdCcpLFxuICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiBsYWJlbC5jc3MoJ21hcmdpblJpZ2h0JyksXG4gICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiBsYWJlbC5jc3MoJ2JvcmRlclJhZGl1cycpLFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogbGFiZWwuY3NzKCdiYWNrZ3JvdW5kQ29sb3InKSxcbiAgICAgICAgICAgICAgICBsaW5lSGVpZ2h0OiBsYWJlbC5jc3MoJ2xpbmVIZWlnaHQnKSxcbiAgICAgICAgICAgICAgICBmb250V2VpZ2h0OiBsYWJlbC5jc3MoJ2ZvbnRXZWlnaHQnKSxcbiAgICAgICAgICAgICAgICBvdXRMaW5lOiAwLFxuICAgICAgICAgICAgICAgIGJvcmRlclN0eWxlOiAnbm9uZScsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBcIjEwMCVcIixcbiAgICAgICAgICAgICAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgICAgICAgICAgICAgYm94U2l6aW5nOiBcImJvcmRlci1ib3hcIixcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgKCk9PiQodGhpcy5pbnB1dCkuZm9jdXMoKSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGV4ZWMgZnJvbSAnLi9leGVjJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBib2xkOiB7XG4gICAgaWNvbjogJzxiPkY8L2I+JyxcbiAgICB0aXRsZTogJ0ZldHN0aWwnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnYm9sZCcpXG4gIH0sXG4gIGl0YWxpYzoge1xuICAgIGljb246ICc8aT5LPC9pPicsXG4gICAgdGl0bGU6ICdLdXJzaXYnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaXRhbGljJylcbiAgfSxcbiAgdW5kZXJsaW5lOiB7XG4gICAgaWNvbjogJzx1PlU8L3U+JyxcbiAgICB0aXRsZTogJ1VuZGVyc3RydWtlbicsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCd1bmRlcmxpbmUnKVxuICB9LFxuICBzdHJpa2V0aHJvdWdoOiB7XG4gICAgaWNvbjogJzxzdHJpa2U+Uzwvc3RyaWtlPicsXG4gICAgdGl0bGU6ICdTdHJ1a2VuJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ3N0cmlrZVRocm91Z2gnKVxuICB9LFxuICBoZWFkaW5nMToge1xuICAgIGljb246ICc8Yj5IPHN1Yj4xPC9zdWI+PC9iPicsXG4gICAgdGl0bGU6ICdSdWJyaWsgMScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDE+JylcbiAgfSxcbiAgaGVhZGluZzI6IHtcbiAgICBpY29uOiAnPGI+SDxzdWI+Mjwvc3ViPjwvYj4nLFxuICAgIHRpdGxlOiAnUnVicmlrIDInLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEgyPicpXG4gIH0sXG4gIGhlYWRpbmczOiB7XG4gICAgaWNvbjogJzxiPkg8c3ViPjM8L3N1Yj48L2I+JyxcbiAgICB0aXRsZTogJ1J1YnJpayAzJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxIMz4nKVxuICB9LFxuICBwYXJhZ3JhcGg6IHtcbiAgICBpY29uOiAnJiMxODI7JyxcbiAgICB0aXRsZTogJ1BhcmFncmFmJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxQPicpXG4gIH0sXG4gIHF1b3RlOiB7XG4gICAgaWNvbjogJyYjODIyMDsgJiM4MjIxOycsXG4gICAgdGl0bGU6ICdDaXRhdCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8QkxPQ0tRVU9URT4nKVxuICB9LFxuICBvbGlzdDoge1xuICAgIGljb246ICc8aSBjbGFzcz1cImZhIGZhLWxpc3Qtb2xcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+JyxcbiAgICB0aXRsZTogJ09yZG5hZCBsaXN0YScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRPcmRlcmVkTGlzdCcpXG4gIH0sXG4gIHVsaXN0OiB7XG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtbGlzdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4nLFxuICAgIHRpdGxlOiAnUHVua3RsaXN0YScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRVbm9yZGVyZWRMaXN0JylcbiAgfSxcbiAgY29kZToge1xuICAgIGljb246ICcmbHQ7LyZndDsnLFxuICAgIHRpdGxlOiAnUHJvZ3JhbWtvZCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8UFJFPicpXG4gIH0sXG4gIGxpbmU6IHtcbiAgICBpY29uOiAnJiM4MjEzOycsXG4gICAgdGl0bGU6ICdWw6VncsOkdCBsaW5qZScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRIb3Jpem9udGFsUnVsZScpXG4gIH0sXG4gIGxpbms6IHtcbiAgICBpY29uOiAnPGkgY2xhc3M9XCJmYSBmYS1saW5rXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXG4gICAgdGl0bGU6ICdJbmZvZ2EgbMOkbmsnLFxuICAgIHJlc3VsdDogKCkgPT4ge1xuICAgICAgY29uc3QgdXJsID0gd2luZG93LnByb21wdCgnQW5nZSBsw6Rua2VucyBVUkwnKVxuICAgICAgaWYgKHVybCkgZXhlYygnY3JlYXRlTGluaycsIHVybClcbiAgICB9XG4gIH0sXG4gIGltYWdlOiB7XG4gICAgaWNvbjogJzxpIGNsYXNzPVwiZmEgZmEtcGljdHVyZS1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPicsXG4gICAgdGl0bGU6ICdJbmZvZ2EgYmlsZCcsXG4gICAgcmVzdWx0OiAoZXYsIGNvbXBvbmVudCkgPT4ge1xuICAgICAgY29uc3QgdXJsID0gd2luZG93LnByb21wdCgnQW5nZSBiaWxkZW5zIFVSTCcpXG4gICAgICBpZiAodXJsKSB7XG4gICAgICAgIC8vZXhlYygnaW5zZXJ0SW1hZ2UnLCB1cmwpO1xuICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgICAgICBpbWcuc3JjID0gdXJsO1xuICAgICAgICBpbWcudGFiSW5kZXggPSAxO1xuICAgICAgICBpbnNlcnRFbGVtZW50KGltZyk7XG4gICAgICAgIGltZy5vbmZvY3VzID0gY29tcG9uZW50Lm9uRm9jdXM7XG4gICAgICAgIGltZy5vbmJsdXIgPSBjb21wb25lbnQub25CbHVyO1xuICAgICAgICBjb21wb25lbnQucHJvcHMub25DaGFuZ2UoY29tcG9uZW50LmNvbnRlbnREaXYuaW5uZXJIVE1MKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5zZXJ0RWxlbWVudChlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgIHZhciBzZWwsIHJhbmdlO1xuICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uICYmIChzZWwgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkpLnJhbmdlQ291bnQpIHtcbiAgICAgICAgcmFuZ2UgPSBzZWwuZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgcmFuZ2UuY29sbGFwc2UodHJ1ZSk7XG4gICAgICAgIHJhbmdlLmluc2VydE5vZGUoZWxlbWVudCk7XG4gICAgICAgIC8vIE1vdmUgdGhlIGNhcmV0IGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBpbnNlcnRlZCBzcGFuXG4gICAgICAgIHJhbmdlLnNldFN0YXJ0QWZ0ZXIoZWxlbWVudCk7XG4gICAgICAgIHJhbmdlLmNvbGxhcHNlKHRydWUpO1xuICAgICAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgICAgIHNlbC5hZGRSYW5nZShyYW5nZSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IGV4ZWMgZnJvbSAnLi9leGVjJztcblxuZXhwb3J0IGRlZmF1bHQge1xuICBib2xkOiB7XG4gICAgaWNvbjogJzxiPkI8L2I+JyxcbiAgICB0aXRsZTogJ0JvbGQnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnYm9sZCcpXG4gIH0sXG4gIGl0YWxpYzoge1xuICAgIGljb246ICc8aT5JPC9pPicsXG4gICAgdGl0bGU6ICdJdGFsaWMnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaXRhbGljJylcbiAgfSxcbiAgdW5kZXJsaW5lOiB7XG4gICAgaWNvbjogJzx1PlU8L3U+JyxcbiAgICB0aXRsZTogJ1VuZGVybGluZScsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCd1bmRlcmxpbmUnKVxuICB9LFxuICBzdHJpa2V0aHJvdWdoOiB7XG4gICAgaWNvbjogJzxzdHJpa2U+Uzwvc3RyaWtlPicsXG4gICAgdGl0bGU6ICdTdHJpa2UtdGhyb3VnaCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdzdHJpa2VUaHJvdWdoJylcbiAgfSxcbiAgaGVhZGluZzE6IHtcbiAgICBpY29uOiAnPGI+SDxzdWI+MTwvc3ViPjwvYj4nLFxuICAgIHRpdGxlOiAnSGVhZGluZyAxJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxIMT4nKVxuICB9LFxuICBoZWFkaW5nMjoge1xuICAgIGljb246ICc8Yj5IPHN1Yj4yPC9zdWI+PC9iPicsXG4gICAgdGl0bGU6ICdIZWFkaW5nIDInLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPEgyPicpXG4gIH0sXG4gIGhlYWRpbmczOiB7XG4gICAgaWNvbjogJzxiPkg8c3ViPjM8L3N1Yj48L2I+JyxcbiAgICB0aXRsZTogJ0hlYWRpbmcgMycsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdmb3JtYXRCbG9jaycsICc8SDM+JylcbiAgfSxcbiAgcGFyYWdyYXBoOiB7XG4gICAgaWNvbjogJyYjMTgyOycsXG4gICAgdGl0bGU6ICdQYXJhZ3JhcGgnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFA+JylcbiAgfSxcbiAgcXVvdGU6IHtcbiAgICBpY29uOiAnJiM4MjIwOyAmIzgyMjE7JyxcbiAgICB0aXRsZTogJ1F1b3RlJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2Zvcm1hdEJsb2NrJywgJzxCTE9DS1FVT1RFPicpXG4gIH0sXG4gIG9saXN0OiB7XG4gICAgaWNvbjogJyYjMzU7JyxcbiAgICB0aXRsZTogJ09yZGVyZWQgTGlzdCcsXG4gICAgcmVzdWx0OiAoKSA9PiBleGVjKCdpbnNlcnRPcmRlcmVkTGlzdCcpXG4gIH0sXG4gIHVsaXN0OiB7XG4gICAgaWNvbjogJyYjODIyNjsnLFxuICAgIHRpdGxlOiAnVW5vcmRlcmVkIExpc3QnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnaW5zZXJ0VW5vcmRlcmVkTGlzdCcpXG4gIH0sXG4gIGNvZGU6IHtcbiAgICBpY29uOiAnJmx0Oy8mZ3Q7JyxcbiAgICB0aXRsZTogJ0NvZGUnLFxuICAgIHJlc3VsdDogKCkgPT4gZXhlYygnZm9ybWF0QmxvY2snLCAnPFBSRT4nKVxuICB9LFxuICBsaW5lOiB7XG4gICAgaWNvbjogJyYjODIxMzsnLFxuICAgIHRpdGxlOiAnSG9yaXpvbnRhbCBMaW5lJyxcbiAgICByZXN1bHQ6ICgpID0+IGV4ZWMoJ2luc2VydEhvcml6b250YWxSdWxlJylcbiAgfSxcbiAgbGluazoge1xuICAgIGljb246ICcmIzEyODI3OTsnLFxuICAgIHRpdGxlOiAnTGluaycsXG4gICAgcmVzdWx0OiAoKSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KCdFbnRlciB0aGUgbGluayBVUkwnKVxuICAgICAgaWYgKHVybCkgZXhlYygnY3JlYXRlTGluaycsIHVybClcbiAgICB9XG4gIH0sXG4gIGltYWdlOiB7XG4gICAgaWNvbjogJyYjMTI4MjQ3OycsXG4gICAgdGl0bGU6ICdJbWFnZScsXG4gICAgcmVzdWx0OiAoKSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSB3aW5kb3cucHJvbXB0KCdFbnRlciB0aGUgaW1hZ2UgVVJMJylcbiAgICAgIGlmICh1cmwpIGV4ZWMoJ2luc2VydEltYWdlJywgdXJsKVxuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgKGNvbW1hbmQsIHZhbHVlID0gbnVsbCkgPT4ge1xuICBkb2N1bWVudC5leGVjQ29tbWFuZChjb21tYW5kLCBmYWxzZSwgdmFsdWUpXG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpbWFnZUVkaXRBY3Rpb25zKGNiKSB7XG4gIHJldHVybiBbe1xuICAgIG5hbWU6ICdmbG9hdC1sZWZ0JyxcbiAgICBpY29uOiBgPGRpdiBzdHlsZT1cInBvc2l0aW9uOnJlbGF0aXZlXCI+XG4gICAgICA8aSBjbGFzcz1cImZhIGZhLWFsaWduLXJpZ2h0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlOyBsZWZ0Oi00cHg7dG9wOjA7IHRyYW5zZm9ybTogc2NhbGUoMC41KTsgdHJhbnNmb3JtLW9yaWdpbjogbGVmdCB0b3BcIj5cbiAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1waWN0dXJlLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gLFxuICAgIHRpdGxlOiAnTMOldCBiaWxkZW4gZmx5dGEgdsOkbnN0ZXIgb20gdGV4dCcsXG4gICAgcmVzdWx0OiAoKSA9PiBjYignZmxvYXQtbGVmdCcpXG4gIH0sIHtcbiAgICBuYW1lOiAnZmxvYXQtcmlnaHQnLFxuICAgIGljb246IGA8ZGl2IHN0eWxlPVwicG9zaXRpb246cmVsYXRpdmVcIj5cbiAgICAgIDxpIGNsYXNzPVwiZmEgZmEtYWxpZ24tbGVmdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTsgcmlnaHQ6LTRweDt0b3A6MDsgdHJhbnNmb3JtOiBzY2FsZSgwLjUpOyB0cmFuc2Zvcm0tb3JpZ2luOiByaWdodCB0b3BcIj5cbiAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1waWN0dXJlLW9cIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gLFxuICAgIHRpdGxlOiAnTMOldCBiaWxkZW4gZmx5dGEgaMO2Z2VyIG9tIHRleHQnLFxuICAgIHJlc3VsdDogKCkgPT4gY2IoJ2Zsb2F0LXJpZ2h0JylcbiAgfSwge1xuICAgIG5hbWU6ICd1bmZsb2F0JyxcbiAgICBpY29uOiBgPGRpdiBzdHlsZT1cInBvc2l0aW9uOnJlbGF0aXZlO1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPlxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MFwiPiYjODI1NDs8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDpsZWZ0OjA7dHJhbnNmb3JtOiBzY2FsZSgwLjUpOyB0cmFuc2Zvcm0tb3JpZ2luOiBsZWZ0IGJvdHRvbVwiPlxuICAgICAgICA8aSBjbGFzcz1cImZhIGZhLXBpY3R1cmUtb1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cInBvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MFwiPl88L2Rpdj5cbiAgICA8L2Rpdj5gLFxuICAgIHRpdGxlOiAnUGxhY2VyYSBiaWxkZW4gcMOlIGVnZW4gcmFkJyxcbiAgICByZXN1bHQ6ICgpID0+IGNiKCd1bmZsb2F0JylcbiAgfV07XG59XG5cbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBleGVjIGZyb20gJy4vZXhlYyc7XG5pbXBvcnQge3dhc2hIdG1sfSBmcm9tICcuL3dhc2gtaHRtbCc7XG5pbXBvcnQgaW1hZ2VFZGl0QWN0aW9ucyBmcm9tICcuL2ltYWdlLWVkaXQtYWN0aW9ucyc7XG5pbXBvcnQgYWN0aW9ucyBmcm9tICcuL2FjdGlvbnMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFjdGlvbiB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIGljb246IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgcmVzdWx0OiAoZXY6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTEJ1dHRvbkVsZW1lbnQ+LCBjb21wb25lbnQ6IFd5c2l3eWcpID0+IHZvaWQ7XG59XG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIGNsYXNzTmFtZT86IHN0cmluZztcbiAgaHRtbDogc3RyaW5nO1xuICBvbkNoYW5nZT86IChodG1sOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHJlcG9ydE51bUNoYXJzPzogKG51bUNoYXJzOiBudW1iZXIpID0+IHZvaWQ7XG4gIG1heENoYXJzPzogbnVtYmVyO1xuICBkZWZhdWx0QWN0aW9ucz86IHtbbmFtZTogc3RyaW5nXTogQWN0aW9ufTtcbiAgYWN0aW9ucz86IChQYXJ0aWFsPEFjdGlvbj4gfCBzdHJpbmcpW107XG4gIHJlYWRPbmx5PzogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgZm9jdXNSZWN0OiBDbGllbnRSZWN0IHwgbnVsbDtcbn1cblxuY29uc3QgY2xhc3NlcyA9IHtcbiAgYWN0aW9uYmFyOiAnd3lzaXd5Zy1hY3Rpb25iYXInLFxuICBidXR0b246ICd3eXNpd3lnLWJ1dHRvbicsXG4gIGNvbnRlbnQ6ICd3eXNpd3lnLWNvbnRlbnQnLFxuICBmb2N1c3JlY3Q6ICd3eXNpd3lnLWZvY3VzcmVjdCcsXG4gIGZvY3VzcG9pbnQ6ICd3eXNpd3lnLWZvY3VzcG9pbnQnLFxuICByZWFkb25seUNvbnRlbnQ6ICd3eXNpd3lnLWNvbnRlbnQgcmVhZG9ubHknXG59XG5cbmV4cG9ydCBjbGFzcyBXeXNpd3lnIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnRlbnREaXY6IEhUTUxEaXZFbGVtZW50O1xuICBmb2N1c1JlY3REaXY6IEhUTUxEaXZFbGVtZW50O1xuICBmb2N1c0VsZW06IEhUTUxFbGVtZW50IHwgbnVsbDtcbiAgY29ybmVyOiBzdHJpbmc7XG4gIHJlc2l6ZVN0YXJ0WDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtmb2N1c1JlY3Q6IG51bGx9O1xuICAgIHRoaXMub25Gb2N1cyA9IHRoaXMub25Gb2N1cy5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25CbHVyID0gdGhpcy5vbkJsdXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uTW91c2VEb3duID0gdGhpcy5vbk1vdXNlRG93bi5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Nb3VzZU1vdmUgPSB0aGlzLm9uTW91c2VNb3ZlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbk1vdXNlVXAgPSB0aGlzLm9uTW91c2VVcC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgaWYgKCF0aGlzLnByb3BzLnJlYWRPbmx5KSB7XG4gICAgICBBcnJheS5mcm9tKHRoaXMuY29udGVudERpdi5xdWVyeVNlbGVjdG9yQWxsKFwiaW1nLGFcIikpLm1hcChlbGVtID0+IChlbGVtIGFzIChIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTEFuY2hvckVsZW1lbnQpKSlcbiAgICAgIC5mb3JFYWNoKGVsZW0gPT4ge1xuICAgICAgICBlbGVtLnRhYkluZGV4ID0gMTtcbiAgICAgICAgZWxlbS5vbmZvY3VzID0gdGhpcy5vbkZvY3VzO1xuICAgICAgICBlbGVtLm9uYmx1ciA9IHRoaXMub25CbHVyIGFzIGFueTtcbiAgICAgIH0pO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93bik7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLm9uTW91c2VVcCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnByb3BzLnJlcG9ydE51bUNoYXJzKSB7XG4gICAgICB0aGlzLnByb3BzLnJlcG9ydE51bUNoYXJzKHRoaXMuY29udGVudERpdiAmJiB0aGlzLmNvbnRlbnREaXYuaW5uZXJUZXh0ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQubGVuZ3RoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgQXJyYXkuZnJvbSh0aGlzLmNvbnRlbnREaXYucXVlcnlTZWxlY3RvckFsbChcImltZyxhXCIpKS5tYXAoZWxlbSA9PiAoZWxlbSBhcyAoSFRNTEltYWdlRWxlbWVudCB8IEhUTUxBbmNob3JFbGVtZW50KSkpXG4gICAgLmZvckVhY2goZWxlbSA9PiB7XG4gICAgICBlbGVtLnRhYkluZGV4ID0gMTtcbiAgICAgIGVsZW0ub25mb2N1cyA9IHRoaXMub25Gb2N1cztcbiAgICAgIGVsZW0ub25ibHVyID0gdGhpcy5vbkJsdXIgYXMgYW55O1xuICAgIH0pO1xuICAgIGlmICh0aGlzLnByb3BzLnJlcG9ydE51bUNoYXJzKSB7XG4gICAgICB0aGlzLnByb3BzLnJlcG9ydE51bUNoYXJzKHRoaXMuY29udGVudERpdiAmJiB0aGlzLmNvbnRlbnREaXYuaW5uZXJUZXh0ICYmIHRoaXMuY29udGVudERpdi5pbm5lclRleHQubGVuZ3RoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLm9uTW91c2VEb3duKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uTW91c2VNb3ZlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5vbk1vdXNlVXApO1xuICB9XG5cbiAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wczogUHJvcHMsIG5leHRTdGF0ZTogU3RhdGUpIHtcbiAgICAvL3RoaXMuY29udGVudERpdi5vbmZvY3VzID0gdGhpcy5vbkZvY3VzO1xuICAgIC8vdGhpcy5jb250ZW50RGl2Lm9uYmx1ciA9IHRoaXMub25CbHVyO1xuICAgIHJldHVybiAhdGhpcy5jb250ZW50RGl2IHx8XG4gICAgICBuZXh0U3RhdGUgIT0gdGhpcy5zdGF0ZSB8fFxuICAgICAgbmV4dFByb3BzLnJlYWRPbmx5ICE9PSB0aGlzLnByb3BzLnJlYWRPbmx5IHx8XG4gICAgICB3YXNoSHRtbChuZXh0UHJvcHMuaHRtbCkgIT09IHdhc2hIdG1sKHRoaXMuY29udGVudERpdi5pbm5lckhUTUwpO1xuICB9XG5cbiAgdHJpZ2dlck9uQ2hhbmdlKGh0bWw6IHN0cmluZykge1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UgJiYgdGhpcy5wcm9wcy5vbkNoYW5nZSh3YXNoSHRtbChodG1sKSk7XG4gIH1cblxuICBvbkZvY3VzKGV2OiBGb2N1c0V2ZW50KSB7XG4gICAgY29uc3QgZWxlbSA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICBpZiAoIWVsZW0gfHwgIWVsZW0udGFnTmFtZSkgcmV0dXJuO1xuICAgIGlmIChlbGVtLnRhZ05hbWUgIT09ICdJTUcnICYmIGVsZW0udGFnTmFtZSAhPT0gJ0EnKSByZXR1cm47XG4gICAgY29uc3QgY29udGVudFBhcmVudCA9IHRoaXMuY29udGVudERpdi5wYXJlbnRFbGVtZW50O1xuICAgIGNvbnN0IG5ld1N0YXRlID0ge1xuICAgICAgZm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdChjb250ZW50UGFyZW50LCBlbGVtKSxcbiAgICB9XG4gICAgc3dpdGNoIChlbGVtLnRhZ05hbWUpIHtcbiAgICAgIGNhc2UgJ0EnOlxuICAgICAgY2FzZSAnSU1HJzpcblxuICAgICAgZGVmYXVsdDogYnJlYWs7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xuICAgIHRoaXMuZm9jdXNFbGVtID0gZWxlbTtcbiAgfVxuXG4gIG9uQmx1cihldjogUmVhY3QuRm9jdXNFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcbiAgICAvKmlmIChldi5yZWxhdGVkVGFyZ2V0KSB7XG4gICAgICBjb25zdCByZWxhdGVkVGFyZ2V0ID0gZXYucmVsYXRlZFRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgIGlmIChyZWxhdGVkVGFyZ2V0LmNsYXNzTmFtZSAmJiByZWxhdGVkVGFyZ2V0LmNsYXNzTmFtZS5zcGxpdCgnICcpLmluZGV4T2YoY2xhc3Nlcy5idXR0b24pID49IDApIHtcbiAgICAgICAgLy8gQSBpbWFnZSBhY3Rpb24gYnV0dG9uIHdhcyBwcmVzc2VkXG4gICAgICAgIHNldFxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSovXG4gICAgaWYgKChldi50YXJnZXQgPT09IHRoaXMuZm9jdXNFbGVtICYmIGV2LnJlbGF0ZWRUYXJnZXQgIT09IHRoaXMuZm9jdXNSZWN0RGl2KSB8fFxuICAgICAgZXYudGFyZ2V0ID09PSB0aGlzLmZvY3VzUmVjdERpdilcbiAgICB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtmb2N1c1JlY3Q6IG51bGx9KTtcbiAgICB9XG4gIH1cblxuICBtYWtlQ2xpY2thYmxlKGVsZW06IEhUTUxFbGVtZW50KSB7XG4gICAgIGVsZW0udGFiSW5kZXggPSAxO1xuICB9XG5cbiAgb25Nb3VzZURvd24oZXYpIHtcbiAgICBpZiAoKGV2LnRhcmdldC5jbGFzc05hbWUgfHwgXCJcIikuc3BsaXQoJyAnKS5pbmRleE9mKGNsYXNzZXMuZm9jdXNwb2ludCkgPj0gMCkge1xuICAgICAgY29uc3QgY29ybmVyID0gdGhpcy5nZXRSZWN0Q29ybmVyKGV2KTtcbiAgICAgIHRoaXMuY29ybmVyID0gY29ybmVyO1xuICAgICAgdGhpcy5yZXNpemVTdGFydFggPSBldi5jbGllbnRYO1xuICAgIH1cbiAgfVxuXG4gIG9uTW91c2VNb3ZlKGV2OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKHRoaXMuY29ybmVyICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0ICYmIHRoaXMuZm9jdXNFbGVtKSB7XG4gICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gVE9ETzogUsOka25hIHV0IGJhc2VyYXQgcMOlIHRoaXMuY29ybmVyIGh1ciBiaWxkZW5zIHN0b3JsZWsgYm9yZGUgw6RuZHJhcy5cbiAgICAgIC8vIExldGEgdXBwIGJpbGRlbiBwZXIgSUQgZnLDpW4gdGhpcy5jb250ZW50RGl2XG4gICAgICAvLyBTw6R0dCBESVY6ZW5zIHN0eWxlIGF0dHJpYnV0IHdpZHRoIHRpbGwgbnkgd2lkdGguXG4gICAgICAvLyBPbSBESVY6ZW4gcmVkYW4gaGFkZSBoZWlnaHQsIHPDpHR0IG55IGhlaWdodCBtZWQgc2FtbWEgYXNwZWN0IHJhdGlvIHNvbSBpbm5hbixcbiAgICAgIC8vIGFubmFycywgc8OkdHQgaW50ZSBoZWlnaHQgYWxscyAoZWxsZXIgbcO2amxpZ3R2aXMgdGlsbCBhdXRvKSlcbiAgICAgIGNvbnN0IGZvY3VzUmVjdCA9IHRoaXMuZm9jdXNSZWN0RGl2LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgaWYgKGZvY3VzUmVjdC53aWR0aCA8IDMyKSByZXR1cm47XG4gICAgICAvL2NvbnN0IGN1cnJlbnRXaWR0aCA9IGZvY3VzUmVjdC53aWR0aDtcbiAgICAgIC8vY29uc3QgY3VycmVudEhlaWdodCA9IGZvY3VzUmVjdC5oZWlnaHQ7XG4gICAgICAvL2NvbnN0IGhhc0hlaWdodFN0eWxlID0gIXRoaXMuZm9jdXNFbGVtLnN0eWxlLmhlaWdodCB8fCB0aGlzLmZvY3VzRWxlbS5zdHlsZS5oZWlnaHQgPT09IFwiYXV0b1wiO1xuICAgICAgY29uc3QgbmV3V2lkdGggPSBNYXRoLm1heCgzMiwgdGhpcy5jb3JuZXIuZW5kc1dpdGgoJ2wnKSA/XG4gICAgICAgIGZvY3VzUmVjdC53aWR0aCArICh0aGlzLnJlc2l6ZVN0YXJ0WCAtIGV2LmNsaWVudFgpIDpcbiAgICAgICAgLy9mb2N1c1JlY3QucmlnaHQgLSBldi5jbGllbnRYIDpcbiAgICAgICAgZm9jdXNSZWN0LndpZHRoIC0gKHRoaXMucmVzaXplU3RhcnRYIC0gZXYuY2xpZW50WCkpO1xuICAgICAgdGhpcy5yZXNpemVTdGFydFggPSBldi5jbGllbnRYO1xuICAgICAgICAvL2V2LmNsaWVudFggLSBmb2N1c1JlY3QubGVmdDtcbiAgICAgIGNvbnN0IGZhY3RvciA9IG5ld1dpZHRoIC8gZm9jdXNSZWN0LndpZHRoO1xuICAgICAgY29uc3QgbmV3SGVpZ2h0ID0gZm9jdXNSZWN0LmhlaWdodCAqIGZhY3RvcjtcbiAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLndpZHRoID0gbmV3V2lkdGggKyBcInB4XCI7XG4gICAgICB0aGlzLmZvY3VzRWxlbS5zdHlsZS5oZWlnaHQgPSBuZXdIZWlnaHQgKyBcInB4XCI7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCh0aGlzLmNvbnRlbnREaXYucGFyZW50RWxlbWVudCwgdGhpcy5mb2N1c0VsZW0pLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgb25Nb3VzZVVwKGV2KSB7XG4gICAgaWYgKHRoaXMuY29ybmVyICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0ICYmIHRoaXMuZm9jdXNFbGVtKSB7XG4gICAgICB0aGlzLmNvcm5lciA9IG51bGw7XG4gICAgICB0aGlzLnRyaWdnZXJPbkNoYW5nZSh0aGlzLmNvbnRlbnREaXYuaW5uZXJIVE1MKTtcbiAgICB9XG4gIH1cblxuICBnZXRSZWN0Q29ybmVyKGV2KSB7XG4gICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgKGV2LnRhcmdldC5jbGFzc05hbWUgfHwgJycpLnNwbGl0KCcgJykpIHtcbiAgICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICAgIGNhc2UgJ2ZwdWwnOlxuICAgICAgICAgIHJldHVybiAndWwnO1xuICAgICAgICBjYXNlICdmcHVyJzpcbiAgICAgICAgICByZXR1cm4gJ2ZwdXInO1xuICAgICAgICBjYXNlICdmcGxyJzpcbiAgICAgICAgICByZXR1cm4gJ2xyJztcbiAgICAgICAgY2FzZSAnZnBsbCc6XG4gICAgICAgICAgcmV0dXJuICdsbCc7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZXhlY0ltYWdlRWRpdEFjdGlvbiAoY21kOiBzdHJpbmcpIHtcbiAgICAvL2NvbnNvbGUubG9nKGNtZCk7XG4gICAgaWYgKCF0aGlzLmZvY3VzRWxlbSkgcmV0dXJuO1xuICAgIC8vY29uc29sZS5sb2coXCJkb2luZyBpdFwiKTtcbiAgICBzd2l0Y2ggKGNtZCkge1xuICAgICAgY2FzZSAnZmxvYXQtbGVmdCc6XG4gICAgICAgIHRoaXMuZm9jdXNFbGVtLnN0eWxlLmNzc0Zsb2F0ID0gJ2xlZnQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Zsb2F0LXJpZ2h0JzpcbiAgICAgICAgdGhpcy5mb2N1c0VsZW0uc3R5bGUuY3NzRmxvYXQgPSAncmlnaHQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3VuZmxvYXQnOlxuICAgICAgICB0aGlzLmZvY3VzRWxlbS5zdHlsZS5jc3NGbG9hdCA9ICcnO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgdGhpcy50cmlnZ2VyT25DaGFuZ2UodGhpcy5jb250ZW50RGl2LmlubmVySFRNTCk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7Zm9jdXNSZWN0OiBnZXRSZWxhdGF0aXZlQ2xpZW50UmVjdCh0aGlzLmNvbnRlbnREaXYucGFyZW50RWxlbWVudCwgdGhpcy5mb2N1c0VsZW0pfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgZGVmYXVsdEFjdGlvbnMgPSB0aGlzLnByb3BzLmRlZmF1bHRBY3Rpb25zIHx8IGFjdGlvbnM7XG4gICAgbGV0IGFjdGlvbnNUb1VzZSA9IHRoaXMucHJvcHMuYWN0aW9ucyA/IHRoaXMucHJvcHMuYWN0aW9ucy5tYXAoYWN0aW9uID0+XG4gICAgICB0eXBlb2YgYWN0aW9uID09PSAnc3RyaW5nJyA/XG4gICAgICAgIGRlZmF1bHRBY3Rpb25zW2FjdGlvbl0gOlxuICAgICAgICBkZWZhdWx0QWN0aW9uc1thY3Rpb24ubmFtZV0gP1xuICAgICAgICAgIHsgLi4uZGVmYXVsdEFjdGlvbnNbYWN0aW9uLm5hbWVdLCAuLi5hY3Rpb24gfSA6XG4gICAgICAgICAgYWN0aW9uKVxuICAgIDogT2JqZWN0LmtleXMoZGVmYXVsdEFjdGlvbnMpLm1hcChhY3Rpb24gPT4gZGVmYXVsdEFjdGlvbnNbYWN0aW9uXSk7XG5cbiAgICBpZiAodGhpcy5zdGF0ZS5mb2N1c1JlY3QpIHtcbiAgICAgIGFjdGlvbnNUb1VzZSA9IGFjdGlvbnNUb1VzZS5jb25jYXQoaW1hZ2VFZGl0QWN0aW9ucyhjbWQgPT4gdGhpcy5leGVjSW1hZ2VFZGl0QWN0aW9uKGNtZCkpKTtcbiAgICB9XG5cbiAgICBjb25zdCB7Zm9jdXNSZWN0fSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3Qge3JlYWRPbmx5LCByZXBvcnROdW1DaGFycywgbWF4Q2hhcnN9ID0gdGhpcy5wcm9wcztcblxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17dGhpcy5wcm9wcy5jbGFzc05hbWV9PlxuICAgICAgeyFyZWFkT25seSAmJiA8ZGl2IGNsYXNzTmFtZT17Y2xhc3Nlcy5hY3Rpb25iYXJ9PlxuICAgICAgICB7YWN0aW9uc1RvVXNlLm1hcCgoYWN0aW9uLCBpZHgpID0+XG4gICAgICAgICAgPGJ1dHRvbiBrZXk9e2lkeH0gY2xhc3NOYW1lPXtjbGFzc2VzLmJ1dHRvbn1cbiAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBhY3Rpb24uaWNvbn19XG4gICAgICAgICAgICB0aXRsZT17YWN0aW9uLnRpdGxlfVxuICAgICAgICAgICAgb25Nb3VzZURvd249e2V2PT57YWN0aW9uLnJlc3VsdChldiwgdGhpcyl9fVxuICAgICAgICAgICAgb25Nb3VzZVVwPXtldj0+c2V0VGltZW91dCgoKT0+dGhpcy5jb250ZW50RGl2LmZvY3VzKCksIDEwKX1cbiAgICAgICAgICAvPil9XG4gICAgICA8L2Rpdj59XG4gICAgICA8ZGl2IGNsYXNzTmFtZT17cmVhZE9ubHkgPyBjbGFzc2VzLnJlYWRvbmx5Q29udGVudCA6IGNsYXNzZXMuY29udGVudH0gc3R5bGU9e3twb3NpdGlvbjogJ3JlbGF0aXZlJywgdG9wOiAwLCBsZWZ0OiAwfX0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZWRpdG9yXCJcbiAgICAgICAgICByZWY9e2RpdiA9PiB0aGlzLmNvbnRlbnREaXYgPSBkaXZ9XG4gICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHdhc2hIdG1sKHRoaXMucHJvcHMuaHRtbCl9fVxuICAgICAgICAgIGNvbnRlbnRFZGl0YWJsZT17IXJlYWRPbmx5fVxuICAgICAgICAgIG9uUGFzdGU9e2V2ID0+IHtcbiAgICAgICAgICAgIGlmICghaXNOYU4obWF4Q2hhcnMpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHt0YXJnZXQsIGN1cnJlbnRUYXJnZXR9ID0gZXY7XG4gICAgICAgICAgICAgIC8vY29uc3QgdGV4dEJlaW5nT3ZlcndyaXR0ZW4gPSAodGFyZ2V0IGFzIGFueSkuaW5uZXJUZXh0IHx8IFwiXCI7XG4gICAgICAgICAgICAgIGNvbnN0IGVkaXRvclRleHQgPSAoY3VycmVudFRhcmdldCAmJiBjdXJyZW50VGFyZ2V0LmlubmVyVGV4dCkgfHwgXCJcIjtcbiAgICAgICAgICAgICAgY29uc3QgdGV4dEJlaW5nUGFzdGVkID0gZXYuY2xpcGJvYXJkRGF0YS5nZXREYXRhKFwidGV4dC9wbGFpblwiKSB8fCBcIlwiO1xuICAgICAgICAgICAgICBpZiAoZWRpdG9yVGV4dC5sZW5ndGggKyB0ZXh0QmVpbmdQYXN0ZWQubGVuZ3RoID4gbWF4Q2hhcnMpIHtcbiAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfX1cbiAgICAgICAgICBvbktleVVwPXtyZXBvcnROdW1DaGFycyA/IGV2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtpbm5lclRleHR9ID0gKGV2LnRhcmdldCBhcyBhbnkpO1xuICAgICAgICAgICAgcmVwb3J0TnVtQ2hhcnMoaW5uZXJUZXh0ID8gaW5uZXJUZXh0Lmxlbmd0aCA6IE5hTik7XG4gICAgICAgICAgfSA6IG51bGx9XG4gICAgICAgICAgb25LZXlQcmVzcz17IWlzTmFOKG1heENoYXJzKSA/IGV2ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtpbm5lclRleHR9ID0gKGV2LnRhcmdldCBhcyBhbnkpO1xuICAgICAgICAgICAgaWYgKGlubmVyVGV4dCAmJiBpbm5lclRleHQubGVuZ3RoID49IG1heENoYXJzKSB7XG4gICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSA6IG51bGx9XG4gICAgICAgICAgb25JbnB1dD17ZXYgPT4gdGhpcy50cmlnZ2VyT25DaGFuZ2UoKGV2LnRhcmdldCBhcyBhbnkpLmlubmVySFRNTCl9XG4gICAgICAgICAgb25LZXlEb3duPXtldiA9PiB7XG4gICAgICAgICAgICBpZiAocmVhZE9ubHkpIHJldHVybjtcbiAgICAgICAgICAgIGlmIChyZXBvcnROdW1DaGFycyAmJiBldi5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgIHJlcG9ydE51bUNoYXJzKChldi5jdXJyZW50VGFyZ2V0LmlubmVyVGV4dCB8fCBcIlwiKS5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiS2V5OiBcIiArIGV2LndoaWNoKTtcbiAgICAgICAgICAgIGlmIChldi53aGljaCA+PSAzNSAmJiBldi53aGljaCA8PSA0MCkgey8vIGhvbWUvZW5kL3VwL2Rvd24vbGVmdC9yaWdodFxuICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsgLy8gUHJldmVudCBlbnRpcmUgcGFnZSBmcm9tIHNjcm9sbGluZz8/XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDkpIHtcbiAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTsvLyBUQUJcbiAgICAgICAgICAgICAgaWYgKGV2LnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgZXhlYyhcIm91dGRlbnRcIik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXhlYyhcImluZGVudFwiKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIChldi5rZXlDb2RlID09PSA4IHx8IGV2LmtleUNvZGUgPT09IDQ2KSAmJiAvLyBEZWxldGUgb3IgQmFjayBidXR0b25zXG4gICAgICAgICAgICAgIHRoaXMuZm9jdXNFbGVtICYmIHRoaXMuc3RhdGUuZm9jdXNSZWN0KVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBpZiAodGhpcy5mb2N1c0VsZW0gJiYgdGhpcy5mb2N1c0VsZW0ucGFyZW50RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNFbGVtLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5mb2N1c0VsZW0pOyAvLyBSZW1vdmUgbWFya2VkIGltYWdlXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5mb2N1c0VsZW0gPSBudWxsO1xuICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtmb2N1c1JlY3Q6IG51bGx9KTtcbiAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyT25DaGFuZ2UodGhpcy5jb250ZW50RGl2LmlubmVySFRNTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfX1cbiAgICAgICAgLz5cbiAgICAgICAge2ZvY3VzUmVjdCAmJiA8ZGl2XG4gICAgICAgICAgcmVmPXtkaXYgPT4gdGhpcy5mb2N1c1JlY3REaXYgPSBkaXZ9XG4gICAgICAgICAgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcmVjdH1cbiAgICAgICAgICBvbkJsdXI9e3RoaXMub25CbHVyfVxuICAgICAgICAgIHRhYkluZGV4PXsxfVxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICBvdXRsaW5lOiAwLFxuICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgICAgICB0b3A6IHRoaXMuc3RhdGUuZm9jdXNSZWN0LnRvcCxcbiAgICAgICAgICAgIGxlZnQ6IHRoaXMuc3RhdGUuZm9jdXNSZWN0LmxlZnQsXG4gICAgICAgICAgICB3aWR0aDogdGhpcy5zdGF0ZS5mb2N1c1JlY3Qud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IHRoaXMuc3RhdGUuZm9jdXNSZWN0LmhlaWdodH19PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc2VzLmZvY3VzcG9pbnQgKyBcIiBmcHVsXCJ9IHN0eWxlPXt7cG9zaXRpb246J2Fic29sdXRlJywgdG9wOjAsIGxlZnQ6MH19IC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuZm9jdXNwb2ludCArIFwiIGZwdXJcIn0gc3R5bGU9e3twb3NpdGlvbjonYWJzb2x1dGUnLCB0b3A6MCwgcmlnaHQ6MH19IC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuZm9jdXNwb2ludCArIFwiIGZwbHJcIn0gc3R5bGU9e3twb3NpdGlvbjonYWJzb2x1dGUnLCBib3R0b206MCwgcmlnaHQ6MH19IC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzZXMuZm9jdXNwb2ludCArIFwiIGZwbGxcIn0gc3R5bGU9e3twb3NpdGlvbjonYWJzb2x1dGUnLCBib3R0b206MCwgbGVmdDowfX0gLz5cbiAgICAgICAgPC9kaXY+fVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0UmVsYXRhdGl2ZUNsaWVudFJlY3QgKHBhcmVudDogSFRNTEVsZW1lbnQsIGNoaWxkOiBIVE1MRWxlbWVudCkgOiBDbGllbnRSZWN0IHtcbiAgY29uc3QgcGFyZW50UmVjdCA9IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgY29uc3QgY2hpbGRSZWN0ID0gY2hpbGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHJldHVybiB7XG4gICAgdG9wOiBjaGlsZFJlY3QudG9wIC0gcGFyZW50UmVjdC50b3AgKyBwYXJlbnQuc2Nyb2xsVG9wLFxuICAgIGxlZnQ6IGNoaWxkUmVjdC5sZWZ0IC0gcGFyZW50UmVjdC5sZWZ0ICsgcGFyZW50LnNjcm9sbExlZnQsXG4gICAgYm90dG9tOiBjaGlsZFJlY3QuYm90dG9tIC0gcGFyZW50UmVjdC50b3AgKyBwYXJlbnQuc2Nyb2xsVG9wLFxuICAgIHJpZ2h0OiBjaGlsZFJlY3QucmlnaHQgLSBwYXJlbnRSZWN0LmxlZnQgKyBwYXJlbnQuc2Nyb2xsTGVmdCxcbiAgICB3aWR0aDogY2hpbGRSZWN0LndpZHRoLFxuICAgIGhlaWdodDogY2hpbGRSZWN0LmhlaWdodFxuICB9O1xufVxuIiwiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuY29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXG50eXBlIEhUTUxQb2xpY3kgPSB7W3RhZ05hbWVMb3dlcjogc3RyaW5nXToge1thdHRyaWJ1dGVMb3dlcjogc3RyaW5nXTogYm9vbGVhbn19O1xuXG4vKiogVGFncyAvIEF0dHJpYnV0ZXMgV2hpdGVsaXN0XG4gKiBcbiAqL1xuY29uc3QgSFRNTF9XQVNIX1BPTElDWTogSFRNTFBvbGljeSA9IHtcbiAgYjoge30sICAvLyBib2xkXG4gIGk6IHt9LCAgLy8gaXRhbGljXG4gIHA6IHt9LCAgLy8gcGFyYWdyYXBoXG4gIHU6IHt9LCAgLy8gdW5kZXJsaW5lXG4gIHN0cmlrZToge30sIC8vIHN0cmlrZS10aHJvdWdoXG4gIHByZToge30sIC8vIHVuZm9ybWF0dGVkXG4gIGgxOiB7fSwgLy8gaGVhZGluZyAxXG4gIGgyOiB7fSwgLy8gaGVhZGluZyAyXG4gIGgzOiB7fSwgLy8gaGVhZGluZyAzXG4gIGg0OiB7fSwgLy8gaGVhZGluZyA0XG4gIGg1OiB7fSwgLy8gaGVhZGluZyA1XG4gIGltZzoge3NyYzogdHJ1ZSwgY2xhc3M6IHRydWUsIHN0eWxlOiB0cnVlLCB0YWJpbmRleDogdHJ1ZX0sIC8vIGltYWdlLiBXZSBzZXQgc3R5bGUgYW5kIHRhYmluZGV4IG91cnNlbHZlcy4gQWNjZXB0IHRoYXQuXG4gIGE6IHtocmVmOiB0cnVlLCB0YXJnZXQ6IHRydWUsIHRhYmluZGV4OiB0cnVlfSwgLy8gbGlua1xuICB1bDoge30sIC8vIFVub3JkZXJlZCBsaXN0XG4gIG9sOiB7fSwgLy8gT3JkZXJlZCBsaXN0XG4gIGxpOiB7fSwgLy8gbGlzdCBpdGVtXG4gIGhyOiB7fSwgLy8gSG9yaXpvbnRhbCBydWxlXG4gIGJyOiB7fSwgLy8gQnJlYWsgbGluZVxuICBkaXY6IHt9LC8vIE9mIHNvbWUgcmVhc29uLCBkaXZzIGFyZSBzb21ldGltZXMgaW5zZXJ0ZWQgd2hlbiBwcmVzc2luZyBFTlRFUiBpbiB0aGUgd3lzaXd5ZyBlZGl0b3IuXG4gIHNwYW46IHt9LC8vIFNwYW5zIGFyZSBoYXJtbGVzcywganVzdCByZW1vdmUgdGhlaXIgc3R5bGUgYW5kIG90aGVyIGF0dHJpYnV0ZXMgYW5kIEkgZmVlbCBncmVhdC5cbiAgLy8gdGFibGUgdGFnczpcbiAgdGFibGU6IHtib3JkZXI6IHRydWV9LFxuICB0Ym9keToge30sXG4gIHRoZWFkOiB7fSxcbiAgdGZvb3Q6IHt9LFxuICB0cjoge30sXG4gIHRkOiB7aGVhZGVyczogdHJ1ZSwgY29sc3BhbjogdHJ1ZSwgcm93c3BhbjogdHJ1ZX0sXG4gIHRoOiB7YWJicjogdHJ1ZSwgaGVhZGVyczogdHJ1ZSwgc2NvcGU6IHRydWUsIHNvcnRlZDogdHJ1ZSwgY29sc3BhbjogdHJ1ZSwgcm93c3BhbjogdHJ1ZX1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiB3YXNoSHRtbCAoaHRtbDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhodG1sLCBcInRleHQvaHRtbFwiKTtcbiAgY29uc3Qge2NoaWxkTm9kZXN9ID0gZG9jLmJvZHk7XG4gIGxldCBtb2RpZmllZCA9IGZhbHNlO1xuICBmb3IgKGxldCBpPTA7IGk8Y2hpbGROb2Rlcy5sZW5ndGg7ICsraSkge1xuICAgIGlmICh3YXNoTm9kZShjaGlsZE5vZGVzLml0ZW0oaSkpKSB7XG4gICAgICBtb2RpZmllZCA9IHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBtb2RpZmllZCA/XG4gICAgZG9jLmJvZHkuaW5uZXJIVE1MIDpcbiAgICBodG1sOyAvLyBCeSByZXR1cm5pbmcgdGhlIG9yaWdpbmFsIEhUTUwgc3RyaW5nLCB3ZSBzcGFyZSB0aGUgdXNlciBmcm9tIHJlZnJlc2hpbmcgdGhlIGVkaXQgYXJlYSxcbiAgICAgICAgICAvLyB3aGljaCB3b3VsZCBvdGhlcndpc2UgcHV0IHRoZSBjdXJzb3IgYXQgdGhlIHRvcCwgbG9zaW5nIHRoZSBwb3NpdGlvbiB3aGVyZSB1c2VyIHdoZXJlLlxufVxuXG5mdW5jdGlvbiB3YXNoTm9kZShub2RlOiBOb2RlIHwgRWxlbWVudCB8IEhUTUxFbGVtZW50KTogYm9vbGVhbiB7XG4gIGxldCBtb2RpZmllZCA9IGZhbHNlO1xuICBpZiAoaXNFbGVtZW50KG5vZGUpKSB7XG4gICAgaWYgKHdhc2hFbGVtZW50KG5vZGUpKSB7XG4gICAgICBtb2RpZmllZCA9IHRydWU7XG4gICAgfVxuICB9XG4gIGlmICh3YXNoQ2hpbGROb2Rlcyhub2RlKSkge1xuICAgIG1vZGlmaWVkID0gdHJ1ZTtcbiAgfVxuICByZXR1cm4gbW9kaWZpZWQ7XG59XG5cbmZ1bmN0aW9uIHdhc2hDaGlsZE5vZGVzKG5vZGU6IE5vZGUpIHtcbiAgbGV0IG1vZGlmaWVkID0gZmFsc2U7XG4gIGNvbnN0IHtjaGlsZE5vZGVzfSA9IG5vZGU7XG4gIGZvciAobGV0IGk9MDsgaTxjaGlsZE5vZGVzLmxlbmd0aDsgKytpKSB7XG4gICAgaWYgKHdhc2hOb2RlKGNoaWxkTm9kZXMuaXRlbShpKSkpIHtcbiAgICAgIG1vZGlmaWVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1vZGlmaWVkO1xufSBcblxuLyoqIFJlcGxhY2UgYW4gZWxlbWVudCB3aXRoIGl0cyBjaGlsZCBub2Rlcy5cbiAqIFxuICovXG5mdW5jdGlvbiByZW1vdmVNaWRkbGVFbGVtZW50KGVsZW1lbnQ6IEVsZW1lbnQpIHtcbiAgY29uc3Qge2NoaWxkTm9kZXN9ID0gZWxlbWVudDtcbiAgZm9yIChsZXQgaT0wOyBpPGNoaWxkTm9kZXMubGVuZ3RoOyArK2kpIHtcbiAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNoaWxkTm9kZXMuaXRlbShpKSwgZWxlbWVudCk7XG4gIH1cbiAgZWxlbWVudC5yZW1vdmUoKTtcbn1cblxuZnVuY3Rpb24gd2FzaEVsZW1lbnQoZWxlbWVudDogRWxlbWVudCk6IGJvb2xlYW4ge1xuICBjb25zdCBwb2xpY3kgPSBlbGVtZW50LnRhZ05hbWUgJiYgSFRNTF9XQVNIX1BPTElDWVtlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKV07XG4gIGlmICghcG9saWN5KSB7XG4gICAgY29uc29sZS53YXJuKFwiV3lzaXd5Zzogbm90IGFsbG93ZWQgdGFnXCIsIGVsZW1lbnQudGFnTmFtZSk7XG4gICAgd2FzaENoaWxkTm9kZXMoZWxlbWVudCk7XG4gICAgcmVtb3ZlTWlkZGxlRWxlbWVudChlbGVtZW50KTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBsZXQgbW9kaWZpZWQgPSBmYWxzZTtcbiAgZm9yIChsZXQgaT0wOyBpPGVsZW1lbnQuYXR0cmlidXRlcy5sZW5ndGg7ICsraSkge1xuICAgIGNvbnN0IGF0dHIgPSBlbGVtZW50LmF0dHJpYnV0ZXMuaXRlbShpKTtcbiAgICBjb25zdCBhbGxvd2VkID0gYXR0ci5uYW1lICYmICEhcG9saWN5W2F0dHIubmFtZS50b0xvd2VyQ2FzZSgpXTtcbiAgICBpZiAoIWFsbG93ZWQpIHtcbiAgICAgIG1vZGlmaWVkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUud2FybihcIld5c2l3eWc6IG5vdCBhbGxvd2VkIGF0dHJpYnV0ZVwiLCBhdHRyLm5hbWUsIFwiVGFnOiBcIiwgZWxlbWVudC50YWdOYW1lKTtcbiAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKGF0dHIubmFtZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBtb2RpZmllZDtcbn1cblxuZnVuY3Rpb24gaXNFbGVtZW50KG5vZGU6IE5vZGUpIDogbm9kZSBpcyBFbGVtZW50IHtcbiAgcmV0dXJuICEhKG5vZGUgYXMgRWxlbWVudCkudGFnTmFtZTtcbn1cbiIsImltcG9ydCB7VEN9IGZyb20gJy4uL3V0aWxzL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgVGVybSA9ICdBVCcgfCAnU1QnO1xuZXhwb3J0IHR5cGUgQWNhZGVtaWNZZWFyID0gc3RyaW5nOyAvLyBcIjIwMTYvMjAxN1wiLCBcIjIwMTcvMjAxOFwiLCAuLi5cbmV4cG9ydCB0eXBlIFNjaG9vbEdyYWRlID0gbnVtYmVyOyAvLyAwLTkgKGdydW5kc2tvbGEpLCAxMC0xMyAoZ3ltbmFzaXVtKVxuZXhwb3J0IHR5cGUgR3JhZGUgPSAnQScgfCAnQicgfCAnQycgfCAnRCcgfCAnRSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XG4gICAgdXNlcm5hbWU/OiBzdHJpbmc7XG4gICAgbWFpbDogc3RyaW5nO1xuICAgIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG4gICAgcm9sZXM6IHN0cmluZ1tdO1xuICAgIHNjaG9vbEdyYWRlPzogbnVtYmVyO1xuICAgIHNjaG9vbD86IHN0cmluZztcbiAgICBzY2hvb2xUeXBlPzogc3RyaW5nO1xuICAgIHR1dG9yRm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExlYXJuaW5nTW9kdWxlVGFza3Mge1xuICAgIG1vZHVsZU5hbWU6IHN0cmluZztcbiAgICB1cmw/OiBzdHJpbmc7XG4gICAgc3ViamVjdDogU2Nob29sU3ViamVjdDtcbiAgICBjb21tb25UYXNrcz86IExlYXJuaW5nVGFza1tdO1xuICAgIGxlYXJuaW5nR29hbHM6IExlYXJuaW5nR29hbFtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExlYXJuaW5nR29hbCB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHRhc2tzPzogTGVhcm5pbmdUYXNrW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tR29hbCB7XG4gIG5hbWU6IHN0cmluZyxcbiAgdXJsOiBzdHJpbmcsXG4gIGNvdXJzZTogc3RyaW5nLFxuICBkZXNjcmlwdGlvbjogc3RyaW5nXG59XG5cblxuLypleHBvcnQgaW50ZXJmYWNlIExlYXJuaW5nR29hbCB7XG4gICAgaWQ/OiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvdXJzZUlkPzogc3RyaW5nO1xuICAgIHN1YmplY3RJZD86IHN0cmluZztcbn0qL1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdUYXNrIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdXJsPzogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAgIGRvbmU/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExlYXJuaW5nQ291cnNlIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdXJsPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbFN1YmplY3Qge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBjb3Vyc2U6IExlYXJuaW5nQ291cnNlO1xufVxuXG5leHBvcnQgY2xhc3MgQ291cnNlIHtcbiAgICAvL1NjaGVtYTogXCJbeWVhcit0ZXJtK3NjaG9vbFllYXIrbmFtZV0sc29ydG9yZGVyXCI7XG4gICAgaWQ/OiBzdHJpbmc7XG4gICAgLy9hWWVhcjogc3RyaW5nOyAvLyBBY2FkZW1pYyBZZWFyIC8gTMOkc8OlciAvIFwiMjAxNi8yMDE3XCIsIFwiMjAxNy8yMDE4XCIsIC4uLlxuICAgIC8vc2Nob29sR3JhZGU6IG51bWJlcjsgLy8gw4Vyc2t1cnMgKDAtOSBncnVuZHNrb2xhLCAxMC0xMyBneW1uYXNpdW0pLiAxMDAgPSBlaiBidW5kZXQgdGlsbCDDpXJza3Vycy5cbiAgICAvL3Rlcm0/OiBUZXJtOyAvLyBBVCAoQXV0dW1uIFRlcm0pIC8gU1QgKFNwcmluZyBUZXJtKVxuICAgIG5hbWU6IHN0cmluZztcbiAgICBwb2ludHM/OiBudW1iZXI7XG4gICAgbW9kdWxlcz86IENvdXJzZU1vZHVsZVtdO1xuICAgIGxlYXJuaW5nR29hbHM/OiBMZWFybmluZ0dvYWxbXTtcbiAgICB1cmw/OiBzdHJpbmc7XG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBDb3Vyc2VNb2R1bGUge1xuICAgIGlkPzogc3RyaW5nO1xuICAgIGNvdXJzZUlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHJlYWRvbmx5IHVybDogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRhcmdldEdyYWRlIHtcbiAgICBpZD86IHN0cmluZztcbiAgICB1c2VyOiBzdHJpbmc7XG4gICAgY291cnNlSWQ/OiBzdHJpbmc7XG4gICAgc3ViamVjdElkPzogc3RyaW5nO1xuICAgIGFZZWFyPzogQWNhZGVtaWNZZWFyOyAvLyBMw6Rzw6VyLCB0ZXggXCIyMDE2LzIwMTdcIi4gbnVsbCBtZWFucyBmaW5hbCBnb2FsLlxuICAgIHRlcm0/OiBUZXJtOyAvLyBudWxsIG1lYW5zIGZpbmFsIGdvYWwuXG4gICAgZ3JhZGU6IEdyYWRlO1xufVxuXG5cbmV4cG9ydCBjb25zdCBmdXR1cmVBYmlsaXRpZXMgPSBbXG4gICAgXCJMw6RyYSBhdHQgbMOkcmFcIixcbiAgICBcIlNhbWFyYmV0YVwiLFxuICAgIFwiQWdlcmEgZ2xvYmFsdFwiLFxuICAgIFwiVmlzYSBoYW5kbGluZ3NrcmFmdFwiLFxuICAgIFwiVmFyYSBpbm5vdmF0aXZcIixcbiAgICBcIkxldmEgZGlnaXRhbHRcIl07XG4iLCJpbXBvcnQgJy4uLy4uL2dsb2JhbC1zZXR0ZXJzL3NldC1hbGwnO1xuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xuY29uc3QgYmVhcmVyUHJvbWlzZSA9IGVudi5iZWFyZXJQcm92aWRlci5nZXRCZWFyZXIoKTsgLy8gU3RhcnQgZ2V0dGluZyBiZWFyZXIgYXMgc29vbiBhcyBwb3NzaWJsZS5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCAqIGFzIFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgeyBDb3Vyc2VCdWlsZGVyIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlcic7XG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IHsgc2hvd0Vycm9yLCBzaG93SW5mbyB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsc1wiO1xuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLi8uLi9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXJcIjtcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nO1xuICBmZWVkYmFja1VybDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBpc1Rva2VuTG9hZGVkOiBib29sZWFuO1xufVxuXG5leHBvcnQgY2xhc3MgS0VEQXBwQ291cnNlQnVpbGRlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGlzVG9rZW5Mb2FkZWQ6IGZhbHNlXG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIGJlYXJlclByb21pc2UudGhlbigoKT0+e1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNUb2tlbkxvYWRlZDogdHJ1ZX0pO1xuICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICBzaG93RXJyb3IoZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pc1Rva2VuTG9hZGVkID9cbiAgICAgIDxDb3Vyc2VCdWlsZGVyXG4gICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cbiAgICAgICAgZmVlZGJhY2tVcmw9e3RoaXMucHJvcHMuZmVlZGJhY2tVcmx9IC8+IDpcbiAgICAgIDxwPjxTcGlubmVyLz5WLmcuIHbDpG50YS4uLiBhdXRlbnRpY2VyYXIuLi48L3A+XG4gIH1cbn1cbiIsImltcG9ydCBLRUQgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQnO1xuaW1wb3J0ICogYXMgY29tcG9uZW50cyBmcm9tICcuL2FwcC5jb3Vyc2VidWlsZGVyLmNsaWVudCc7XG5LRUQuY29tcG9uZW50cyA9IHsuLi5LRUQuY29tcG9uZW50cywgLi4uY29tcG9uZW50c307XG4iLCJpbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gJy4uL3V0aWxzL3F1ZXJ5LXN0cmluZyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlcyB7XG4gIC8vRWRpdFVzZXJUYXNrc1ZpYVBlbk9ubHk/OiBib29sZWFuO1xuICAvL1N1YlRhc2tzPzogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgY29uc3QgdXNlciA9IGVudi5jdXJyZW50VXNlciE7XG4gICAgY29uc3QgcXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCwge3RvTG93ZXI6IHRydWV9KTtcbiAgICBjb25zdCBmZWF0dXJlcyA9ICgocXVlcnkuZmVhdHVyZXN8fCcnKS5zcGxpdCgnLCcpIGFzIHN0cmluZ1tdKVxuICAgICAgLm1hcChmZWF0dXJlID0+IGZlYXR1cmUudG9Mb3dlckNhc2UoKSk7IC8vIENhbiBiZSB1c2VkIG9uIGZvcndhcmRzLi4uXG5cbiAgICAvKnRoaXMuRWRpdFVzZXJUYXNrc1ZpYVBlbk9ubHkgPVxuICAgICAgdXNlci5zY2hvb2xUeXBlICE9PSAnR3J1bmRza29sb3InICYmIHF1ZXJ5LnNjaG9vbHR5cGUgIT09IFwiR3J1bmRza29sb3JcIjsqL1xuICAgIC8qdGhpcy5TdWJUYXNrcyA9XG4gICAgICB1c2VyLnNjaG9vbFR5cGUgIT09ICdHcnVuZHNrb2xvcicgJiYgcXVlcnkuc2Nob29sdHlwZSAhPT0gXCJHcnVuZHNrb2xvclwiOyovXG4gICAgLy90aGlzLkFzc2lnbm1lbnRUYXNrcyA9ICEhcXVlcnkudGVzdHZlcnNpb247XG4gIH1cbn1cbiIsImV4cG9ydCAqIGZyb20gJy4vZmVhdHVyZXMnO1xuIiwiaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xuXG5kZWNsYXJlIHZhciBwcm9jZXNzOiBhbnk7XG5cbmNmZy5FTlZJUk9OTUVOVCA9IHByb2Nlc3MuZW52LkVOVklST05NRU5UIGFzIFwicHJvZHVjdGlvblwiIHwgXCJkZXZlbG9wbWVudFwiIHwgXCJ0ZXN0XCI7XG5jZmcuS0VEX0FQSV9VUkwgPSBwcm9jZXNzLmVudi5LRURfQVBJX1VSTDsgLy8gXCJodHRwczovL2tlZGJhY2tlbmR0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxuY2ZnLkVEU19BUElfVVJMID0gcHJvY2Vzcy5lbnYuRURTX0FQSV9VUkw7IC8vIFwiaHR0cHM6Ly9lZHNwb3J0YWxvd2luYXBpLmF6dXJld2Vic2l0ZXMubmV0L2FwaS9cIlxuY2ZnLktFRF9UT0tFTl9VUkwgPSBwcm9jZXNzLmVudi5LRURfVE9LRU5fVVJMOyAvLyBcImh0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW5cIlxuY2ZnLktFRF9DTElFTlRfSUQgPSBwcm9jZXNzLmVudi5LRURfQ0xJRU5UX0lEOyAvLyBcImRldmNsaWVudFwiLCBcInRlc3RjbGllbnRcIiwgXCIuLi5cIlxuY2ZnLktFRF9DTElFTlRfU0VDUkVUID0gcHJvY2Vzcy5lbnYuS0VEX0NMSUVOVF9TRUNSRVQ7XG5jZmcuS0VEX1JFQUxNID0gcHJvY2Vzcy5lbnYuS0VEX1JFQUxNOyAvLyBcIlNFMVwiXG5jZmcuS0VEX0xPQ0FMRSA9IHByb2Nlc3MuZW52LktFRF9MT0NBTEU7IC8vIFwiU0UxXCJcbiIsIi8qIFRoZXNlIHNjcmlwdHMgYXNzdW1lIHNvbWUgb2YgdGhlIGdsb2JhbCB2YXJzIGhhdmUgYWxyZWFkeSBiZWVuIHNldDpcbiAgKiBLRUQuY2ZnXG4gICogS0VELmVudi5jdXJyZW50VXNlclxuXG4gIFRoZSByZXN0IHdpbGwgYmUgc2V0IGhlcmUgKGNsaWVudCBzaWRlKVxuKi9cbmltcG9ydCAnLi9jb25maWd1cmUnO1xuaW1wb3J0ICcuL3NldC1iZWFyZXItcHJvdmlkZXJzJztcbmltcG9ydCAnLi9zZXQta2VkLWJhY2tlbmQtY2xpZW50JztcbmltcG9ydCAnLi9zZXQtZWRzLWNsaWVudCc7XG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nLCBzcGxpdFVybEFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudFdlYiwgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIsIGlzb21vcnBoaWMsIHN0b3JhZ2UgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XG5pbXBvcnQgeyBCZWFyZXJQcm92aWRlciwgS2VkQmVhcmVyUHJvdmlkZXIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSBcIi4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzXCI7XG5pbXBvcnQgeyBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyB9IGZyb20gXCIuLi9hY2Nlc3MtY29udHJvbC9pbmRleFwiO1xuaW1wb3J0IHsgY2hlcnJ5UGlja1Byb3BzIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzXCI7XG5cbmZ1bmN0aW9uIGdldE1lcmdlZFRva2VuUGF0aCh0b2tlblBhdGg6IHN0cmluZywgbG9jYXRpb25TZWFyY2g6IHN0cmluZywgc2NvcGVzOiBzdHJpbmdbXSkge1xuICAvLyBNZXJnZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtcyBvZiB0b2tlbiBwYXRoIHdpdGggcGFyYW1zIGdpdmVuIHRvIGN1cnJlbnQgcGFnZVxuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uU2VhcmNoKTtcbiAgY29uc3QgaW1wZXJzb25hdGlvblByb3BzID0gY2hlcnJ5UGlja1Byb3BzKGN1cnJlbnRRdWVyeSwgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpO1xuICBjb25zdCBbdG9rZW5QYXRoV2l0aG91dFF1ZXJ5LCB0b2tlblF1ZXJ5U3RyaW5nXSA9IHNwbGl0VXJsQW5kUXVlcnkodG9rZW5QYXRoKTtcbiAgY29uc3QgdG9rZW5QYXRoUXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKHRva2VuUXVlcnlTdHJpbmcpO1xuICByZXR1cm4gdG9rZW5QYXRoV2l0aG91dFF1ZXJ5ICsgZ2VuZXJhdGVRdWVyeVN0cmluZyh7XG4gICAgLi4udG9rZW5QYXRoUXVlcnksXG4gICAgLi4uaW1wZXJzb25hdGlvblByb3BzLFxuICAgIHNjb3Blczogc2NvcGVzLmpvaW4oJywnKVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0VG9rZW5JZChtZXJnZWRUb2tlblBhdGg6IHN0cmluZywgdXNlckVtYWlsOiBzdHJpbmcpIHtcbiAgcmV0dXJuIG1lcmdlZFRva2VuUGF0aCArIFwiL1wiICsgdXNlckVtYWlsO1xufVxuXG5mdW5jdGlvbiBzYXZlVXNlckluZm8odXNlcjogVXNlciwgdG9rZW5JZDogc3RyaW5nKSB7XG4gIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XG4gIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCwgSlNPTi5zdHJpbmdpZnkodXNlcikpO1xufVxuXG5mdW5jdGlvbiBsb2FkVXNlckluZm8odG9rZW5JZDogc3RyaW5nKSB7XG4gIGNvbnN0IHN0b3JlZFNlc3Npb25Vc2VyID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInVzZXJJbmZvXCIgKyB0b2tlbklkKTtcbiAgaWYgKHN0b3JlZFNlc3Npb25Vc2VyKSB7XG4gICAgZW52LmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShzdG9yZWRTZXNzaW9uVXNlcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgaWYgKHJlcy51c2VyKSB7XG4gICAgICBzYXZlVXNlckluZm8ocmVzLnVzZXIsIHRva2VuSWQpO1xuICAgIH1cbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcbiAgfSwgdG9rZW5JZCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUdvb2dsZVRva2VuUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoOiBzdHJpbmcsIHVzZXJFbWFpbDogc3RyaW5nKSB7XG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcbiAgcmV0dXJuIG5ldyBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIHJlc3BvbnNlVGV4dCA9PiB7XG4gICAgY29uc3QgcmVzID0gSlNPTi5wYXJzZShyZXNwb25zZVRleHQpIGFzIHsgb2s6IGJvb2xlYW4sIGVycm9yPzogc3RyaW5nLCB0b2tlbj86IHN0cmluZywgdXNlcj86IFVzZXIgfTtcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XG4gICAgcmV0dXJuIHsgdG9rZW46IHJlcy50b2tlbiwgZXhwaXJlczogRGF0ZS5ub3coKSArIDU5ICogNjAgKiAxMDAwIH07XG4gIH0sIHRva2VuSWQpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcih0b2tlblVybDogc3RyaW5nLCB1c2VyOiBVc2VyLCBzY29wZXM6IHN0cmluZ1tdKSB7XG4gIHJldHVybiBuZXcgS2VkQmVhcmVyUHJvdmlkZXIoXG4gICAgaXNvbW9ycGhpYyxcbiAgICBzdG9yYWdlLFxuICAgIHRva2VuVXJsICsgdXNlci5tYWlsICsgbG9jYXRpb24uc2VhcmNoLFxuICAgIGNmZy5LRURfQ0xJRU5UX0lELFxuICAgIGNmZy5LRURfQ0xJRU5UX1NFQ1JFVCxcbiAgICB0b2tlblVybCwge1xuICAgICAgZW1haWw6IHVzZXIubWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgcm9sZXM6IHVzZXIucm9sZXMsXG4gICAgICBzY2hvb2w6IHVzZXIuc2Nob29sLFxuICAgICAgc2Nob29sVHlwZTogdXNlci5zY2hvb2xUeXBlLFxuICAgICAgc2NvcGVzXG4gICAgfSk7XG59XG5cbi8vIGVudi5jdXJyZW50VXNlci5tYWlsIGlzIHNldCBieSBTaXRlVmlzaW9uIHNlcnZlciBpbml0aWFsbHkuXG4vLyBBIHJlc3BvbnNlIGZyb20gL2FwaS90b2tlbiBtYXkgY2hhbmdlIHRoZSBtYWlsIGF0dHJpYnV0ZSBvZiB0aGUgY3VycmVudFxuLy8gdXNlciwgc28gZW52LmN1cnJlbnRVc2VyLm1haWwgbWF5IGJlIGRpZmZlcmVudCBhZnRlciBnZXR0aW5nIGEgcmVzcG9uc2UuXG4vLyBIb3dldmVyLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB2YWx1YWJsZSBhbHdheXMgaW4gb3JkZXIgdG8gZGlzdGluZ3Vpc2ggdGhlIGNhc2Vcbi8vIHdoZW4gb25lIG5vcm1hbCB1c2VyIGxvZ3Mgb3V0IGFuZCBhbm90aGVyIHVzZXIgbG9ncyBpbi5cbmNvbnN0IGluaXRpYWxVc2VyRW1haWwgPSBlbnYuY3VycmVudFVzZXIgJiYgZW52LmN1cnJlbnRVc2VyLm1haWw7IC8vIEluaXRpYWwgdmFsdWUgb2YgbWFpbC4gTWF5IGNoYW5nZS5cbmlmIChpbml0aWFsVXNlckVtYWlsKSB7XG4gIC8vIEtFRFxuICBpZiAoY2ZnLktFRF9UT0tFTl9QQVRIKSB7XG4gICAgLy9cbiAgICAvL1xuICAgIC8vIFByb2R1Y3Rpb24gLyBTaXRlVmlzaW9uIHByb3hpZWQgL2FwaS90b2tlbiB0byByZXF1ZXN0IHRva2VucyBmcm9tOlxuICAgIC8vXG4gICAgLy9cbiAgICBjb25zdCBtZXJnZWRUb2tlblBhdGggPSBnZXRNZXJnZWRUb2tlblBhdGgoXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcbiAgICAgICAgXCJrZWRiYWNrZW5kXCIsXG4gICAgICAgIFwiRURTXCIsXG4gICAgICBdKTtcbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVCZWFyZXJQcm92aWRlcihtZXJnZWRUb2tlblBhdGgsIGluaXRpYWxVc2VyRW1haWwpO1xuICAgIGxvYWRVc2VySW5mbyhnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCkpO1xuXG4gICAgLy8gR29vZ2xlXG4gICAgY29uc3QgZ29vZ2xlTWVyZ2VkUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcbiAgICAgIGNmZy5LRURfVE9LRU5fUEFUSCxcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCwgW1xuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcbiAgICAgIF0pO1xuICAgIGVudi5nb29nbGVUb2tlblByb3ZpZGVyID0gY3JlYXRlR29vZ2xlVG9rZW5Qcm92aWRlcihnb29nbGVNZXJnZWRQYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcbiAgfSBlbHNlIGlmIChjZmcuS0VEX1RPS0VOX1VSTCAmJiBjZmcuS0VEX0NMSUVOVF9JRCAmJiBjZmcuS0VEX0NMSUVOVF9TRUNSRVQpIHtcbiAgICAvL1xuICAgIC8vXG4gICAgLy8gVGVzdCAtIGdvIGRpcmVjdGx5IHRvIEtFREFVVEggc2VydmVyIHRvIHJldHJpZXZlIHRva2Vuc1xuICAgIC8vXG4gICAgLy9cbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCwgZW52LmN1cnJlbnRVc2VyLCBbXG4gICAgICBcImtlZGJhY2tlbmRcIixcbiAgICAgIFwiRURTXCIsXG4gICAgXSk7XG4gICAgZW52Lmdvb2dsZVRva2VuUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCArIFwiL2dvb2dsZVwiLCBlbnYuY3VycmVudFVzZXIsIFtcbiAgICAgIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9jYWxlbmRhci5yZWFkb25seVwiLFxuICAgIF0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBjb25maWd1cmF0aW9uIHBhcmFtZXRlciBLRURfVE9LRU5fUEFUSGApO1xuICB9XG59XG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBpc29tb3JwaGljIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuaW1wb3J0IHsgRWRzQ2xpZW50IH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuXG5lbnYuZWRzQ2xpZW50ID0gbmV3IEVkc0NsaWVudCAoXG4gIGlzb21vcnBoaWMsXG4gIGNmZy5FRFNfQVBJX1VSTCxcbiAgZW52LmJlYXJlclByb3ZpZGVyLFxuICAoKT0+ZW52LmN1cnJlbnRVc2VyLm1haWwpO1xuXG4iLCJpbXBvcnQgZW52IGZyb20gJy4uL2dsb2JhbHMvS0VELmVudic7XG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xuXG5lbnYua2VkQmFja2VuZENsaWVudCA9IG5ldyBLZWRCYWNrZW5kQ2xpZW50V2ViIChcbiAgY2ZnLktFRF9BUElfVVJMLFxuICBlbnYuYmVhcmVyUHJvdmlkZXIpO1xuXG4iLCJpbXBvcnQgS0VEIGZyb20gJy4vS0VEJztcblxuLyogVGhpcyBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaXMgdXNlZCBhcyBhIGZhbGxiYWNrLlxuTm9ybWFsbHkgYm90aCB0ZXN0IHBhZ2VzIGFuZCBwcm9kdWN0aW9uIHBhZ2VzIHdpbGwgb3ZlcnJpZGUgdGhlc2UgY29uZmlncmF0aW9uc1xuKi9cbi8qY29uc3QgZGVmYXVsdENvbmZpZ3VyYXRpb24gPSB7XG4gIC8vIEVudmlyb25tZW50XG4gIEVOVklST05NRU5UOiAnZGV2ZWxvcG1lbnQnIGFzICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCcsXG4gIC8vIEF1dGhlbnRpY2F0aW9uIFNlcnZlcjpcbiAgS0VEX1RPS0VOX1VSTDogJ2h0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW4nLFxuICBLRURfVE9LRU5fUEFUSDogJy9hcGkvdG9rZW4uU2tyaXB0LnBvcnRsZXQ/c3YuY29udGVudHR5cGU9YXBwbGljYXRpb24vanNvbicsXG4gIEtFRF9DTElFTlRfSUQ6ICdkZXZjbGllbnQnLFxuICBLRURfQ0xJRU5UX1NFQ1JFVDogJzRmUmRmUXBXdEpxalRXZicsXG4gIC8vIFNlcnZpY2VzOlxuICBLRURfQVBJX1VSTDogJ2h0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLycsICBcbiAgRURTX0FQSV9VUkw6ICdodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLydcbn0qL1xuXG5leHBvcnQgaW50ZXJmYWNlIElLZWRDb25maWd1cmF0aW9uIHtcbiAgRU5WSVJPTk1FTlQ6ICdwcm9kdWN0aW9uJyB8ICdkZXZlbG9wbWVudCcgfCAndGVzdCc7XG4gIEtFRF9SRUFMTTogc3RyaW5nO1xuICBLRURfVE9LRU5fVVJMOiBzdHJpbmc7XG4gIEtFRF9UT0tFTl9QQVRIOiBzdHJpbmc7XG4gIEtFRF9DTElFTlRfSUQ6IHN0cmluZztcbiAgS0VEX0NMSUVOVF9TRUNSRVQ6IHN0cmluZztcbiAgS0VEX0FQSV9VUkw6IHN0cmluZztcbiAgRURTX0FQSV9VUkw6IHN0cmluZztcbiAgS0VEX0xPQ0FMRTogc3RyaW5nO1xufTtcblxuaWYgKCFLRUQuY2ZnKSBLRUQuY2ZnID0ge307XG5cbmV4cG9ydCBkZWZhdWx0IEtFRC5jZmcgYXMgSUtlZENvbmZpZ3VyYXRpb247XG4iLCJpbXBvcnQge1VzZXIsIExlYXJuaW5nTW9kdWxlVGFza3N9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xuaW1wb3J0IHtVc2VyVGFza30gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHtLZWRSZXBvfSBmcm9tICcuLi9yZXBvcy9rZWQtcmVwbyc7XG5pbXBvcnQge0Vkc0NsaWVudH0gZnJvbSAnLi4vYXBpcy9lZHNjbGllbnQnO1xuaW1wb3J0IEtFRCBmcm9tICcuL2tlZCc7XG5pbXBvcnQgeyBLU1Rlcm1QbGFubmVyUmVwbyB9IGZyb20gJy4uL3JlcG9zL2tzLXRlcm1wbGFubmVyLXJlcG8nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEVudiB7XG4gICAgY3VycmVudFVzZXI/OiBVc2VyO1xuICAgIGxlYXJuaW5nTW9kdWxlVGFza3M/OiBMZWFybmluZ01vZHVsZVRhc2tzO1xuICAgIGJlYXJlclByb3ZpZGVyPzogQmVhcmVyUHJvdmlkZXI7XG4gICAgZ29vZ2xlVG9rZW5Qcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xuICAgIGtlZEJhY2tlbmRDbGllbnQ/OiBLZWRCYWNrZW5kQ2xpZW50O1xuICAgIGVkc0NsaWVudD86IEVkc0NsaWVudDtcbiAgICB1c2VyVGFza3NSZXBvPztcbiAgICBoaWRkZW5Db3Vyc2VzUmVwbz87XG4gICAgd2Vla05vdGVzUmVwbz87XG4gICAga2dUZXJtUGxhbm5lclJlcG8/O1xuICAgIGtzVGVybVBsYW5uZXJSZXBvPzogS1NUZXJtUGxhbm5lclJlcG9cbiAgICB0dXRvcmVkOiBib29sZWFuO1xuICAgIGVycm9yPzogRXJyb3I7XG4gICAgLy8gVGhlIHZhcnMgYmVsb3cgc2hvdWxkIGJlIG1vdmVkIHRvIEtFRC5jZmc6XG4gICAgY291cnNlQWRtaW5VcmxLUz86IHN0cmluZztcbiAgICBjb3Vyc2VWaWV3ZXJVcmxLUz86IHN0cmluZztcbiAgICBjb3Vyc2VCdWlsZGVyVXJsPzogc3RyaW5nO1xuICAgIGNvdXJzZVZpZXdlclVybD86IHN0cmluZztcbn1cblxuaWYgKCFLRUQuZW52KSBLRUQuZW52ID0ge307XG5cbmV4cG9ydCBkZWZhdWx0IEtFRC5lbnYgYXMgRW52O1xuIiwiXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XG5cbmRlY2xhcmUgdmFyIEtFRDogYW55O1xuXG52YXIgcmVzdWx0ID0gdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IEtFRDtcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93W0tFRF9OQU1FU1BBQ0VdID0gcmVzdWx0O1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXN1bHQ7XG4iLCJpbXBvcnQgZW52IGZyb20gJy4vS0VELmVudic7XG5pbXBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XG5pbXBvcnQgeyBnZXRHbG9iYWxJZCwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcbmltcG9ydCBjZmcgZnJvbSAnLi9LRUQuY2ZnJztcbmltcG9ydCB7IFNjaG9vbCwgQnJhbmNoIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IHsgVmFsdWUgfSBmcm9tICdrZWRiYWNrZW5kL29ic2VydmFibGUnO1xuXG5leHBvcnQgY29uc3QgZGIgPSBuZXcgS2VkQmFja2VuZFJlcG8oKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LCAoKT0+ZW52LmN1cnJlbnRVc2VyID8gZW52LmN1cnJlbnRVc2VyLm1haWwgOiBcIlwiKTtcbmV4cG9ydCBjb25zdCBnbG9iYWxJZCA9IGdldEdsb2JhbElkKGNmZy5LRURfUkVBTE0pO1xuZXhwb3J0IGNvbnN0IFNjaG9vbHMgPSB7XG4gIHN0YW5kYXJkU2Nob29sOiBkYi5zY2hvb2xzLm5hbWUoXCJzdGFuZGFyZFwiKS5jYWNoZU9wdGltaXplZCgpLnNpbmdsZSgpLFxuICBnZXQgbXlTY2hvb2wgKCkgeyByZXR1cm4gZGIuc2Nob29scy5uYW1lKGVudi5jdXJyZW50VXNlci5zY2hvb2wpLmNhY2hlT3B0aW1pemVkKCkuc2luZ2xlKCk7IH1cbn07XG5leHBvcnQgY29uc3QgQ291cnNlSW5zdGFuY2VzID0ge1xuICBnZXRCcmFuY2hJZChzY2hvb2w6IFZhbHVlPFNjaG9vbD4sIGNvdXJzZUlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gc2Nob29sLnN3aXRjaE1hcChzY2hvb2wgPT5cbiAgICAgIGRiLmJyYW5jaGVzXG4gICAgICAgIC5oYXNFZGdlc0Zyb20oW3NjaG9vbC5vZmZpY2lhbEJyYW5jaElkXSlcbiAgICAgICAgLm5hbWUoXCJkcmFmdFwiKVxuICAgICAgICAudGFncyhjb3Vyc2VJZClcbiAgICAgICAgLmlkc09ubHkoKVxuICAgICAgICAubWFwKCh7aWR9KSA9PiBpZClcbiAgICAgICAgLnRvVmFsdWUoKVxuICAgICAgICAubWFwKGlkcyA9PiBpZHMubGVuZ3RoID4gMCA/IGlkc1swXSA6IHVuZGVmaW5lZCkpO1xuICB9LFxuXG4gIC8qKiBHZXQgYSBEUkFGVCBicmFuY2ggZm9yIGdpdmVuIGNvdXJzZSBJRCBhbmQgZ2l2ZW4gc2Nob29sLlxuICAgKiBJZiB0aGVyZSBpcyBub3QgeWV0IHN1Y2ggYSBicmFuY2gsIGNyZWF0ZSBpdCB1c2luZyBtdXRhdGlvbnNPbkVtcHR5KCkgd2hpY2ggd2lsbFxuICAgKiBsZWFkIHRvIHRoZSBDIyBjb2RlIERvY3VtZW50UmVwb3NpdG9yeS5SZWFkT3JNdXRhdGUoKSB2aWEgRG9jdW1lbnRDb250cm9sbGVyLlxuICAgKi9cbiAgZ2V0T3JDcmVhdGVCcmFuY2hJZChzY2hvb2w6IFZhbHVlPFNjaG9vbD4sIGNvdXJzZUlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gZGIuY291cnNlSW5zdGFuY2VzLmlkc09ubHkoKS5pZChjb3Vyc2VJZCkuc3dpdGNoTWFwKCgpPT4gLy8gVEhpcyBmaXJzdCBsaW5lIHZlcmlmaWVzIGNvdXJzZSBleGlzdHMuIElmIGRlbGV0ZWQsIGRvbid0IHRyeSB0byByZWNyZWF0ZSBpdHMgYnJhbmNoIVxuICAgICAgc2Nob29sLnN3aXRjaE1hcChzY2hvb2wgPT4gXG4gICAgICBkYi5icmFuY2hlc1xuICAgICAgICAuaGFzRWRnZXNGcm9tKFtzY2hvb2wub2ZmaWNpYWxCcmFuY2hJZF0pXG4gICAgICAgIC5uYW1lKFwiZHJhZnRcIilcbiAgICAgICAgLnRhZ3MoY291cnNlSWQpXG4gICAgICAgIC5pZHNPbmx5KClcbiAgICAgICAgLm11dGF0aW9uc09uRW1wdHkodHggPT4ge1xuICAgICAgICAgIC8vIFRoZXNlIDIgbXV0YXRpb25zIHdpbGwgb2NjdXIgc2VydmVyIHNpZGUsIGF0b21pY2FsbHkuXG4gICAgICAgICAgLy8gV2lsbCBiZSBzZW50IG9uIGVhY2ggcmVxdWVzdCBpbiB0aGUgcXVlcnksIGJ1dCB3aWxsIG9ubHkgZXhlY3V0ZSBpZiBxdWVyeSByZXN1bHRzIGluIHplcm8gaXRlbXMuXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlNjaG9vbDpcIiwgc2Nob29sKTtcbiAgICAgICAgICBjb25zdCBpZCA9IGNyZWF0ZVVVSUQoKTtcbiAgICAgICAgICB0eC5hZGQoXCJicmFuY2hlc1wiLCB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIGFjbDogW1xuICAgICAgICAgICAgICBcInJvbGU6VVNFUjpSXCIsXG4gICAgICAgICAgICAgIGBzY2hvb2xSb2xlOiR7c2Nob29sLm5hbWV9L0VNUExPWUVFOlNgXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgbmFtZTogJ2RyYWZ0JyxcbiAgICAgICAgICAgIHNjaG9vbElkOiBzY2hvb2wuaWQsXG4gICAgICAgICAgICB0cmVlUGFyZW50SWQ6IHNjaG9vbC5vZmZpY2lhbEJyYW5jaElkLFxuICAgICAgICAgICAgdGFnczogW2NvdXJzZUlkXVxuICAgICAgICAgIH0gYXMgQnJhbmNoKTtcbiAgICAgICAgICAvLyBBcHByb3ZpbmcgdGhlIGJyYW5jaCBtYWtlcyBzdXJlIHRoYXQgaXQgd2FzIGNyZWF0ZWQgYnkgYW4gRU1QTE9ZRUUgb24gZ2l2ZW4gc2Nob29sLlxuICAgICAgICAgIHR4LmxpbmsyKFwiYnJhbmNoZXNcIiwgc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsIFwiYXBwcm92ZWRDaGlsZHJlblwiLCBpZCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgICAubWFwKCh7aWR9KSA9PiBpZCkpKTtcbiAgfSxcblxuICBnZXRBbGxEZXNjZW5kYW50SWRzKGNvdXJzZUlkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gZGIuY291cnNlQmxvY2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKS5jb25jYXQoXG4gICAgICBkYi5jb3Vyc2VDb250ZW50cy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpLmNvbmNhdChcbiAgICAgIGRiLmNvdXJzZVRhYnMudGFncyhjb3Vyc2VJZCkuaWRzT25seSgpKS5jb25jYXQoXG4gICAgICBkYi50YXNrcy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpXG4gICAgICAubWFwKHggPT4geC5pZCk7XG4gIH1cbn1cbiIsIlxuZXhwb3J0IGNvbnN0IEtFRF9OQU1FU1BBQ0UgPSBcIktFRFwiO1xuXG5kZWNsYXJlIHZhciBLRUQ6IGFueTtcblxudmFyIHJlc3VsdCA9IHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnID8ge30gOiBLRUQ7XG5cbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvd1tLRURfTkFNRVNQQUNFXSA9IHJlc3VsdDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcmVzdWx0O1xuIiwiXG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb0NvbW11bmljYXRvcjxUIGV4dGVuZHMge2lkOiBzdHJpbmd9PiB7XG4gIHF1ZXJ5KCk6IFByb21pc2U8VFtdPjtcbn1cblxudHlwZSBTdWJzY3JpYmVyPFQ+ID0gKGl0ZW1zOlRbXSwgZXJyb3I6IHVuZGVmaW5lZCB8IEVycm9yKSA9PiBhbnk7XG5cbmV4cG9ydCBjbGFzcyBSZXBvPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcbiAgbGlzdFByb21pc2U6IFByb21pc2U8dm9pZD47XG4gIGl0ZW1zOiBUW107XG4gIGVycm9yPzogRXJyb3I7XG4gIHN1YnNjcmliZXJzOiBTdWJzY3JpYmVyPFQ+W107XG5cbiAgY29uc3RydWN0b3IocHVibGljIGNvbW06IFJlcG9Db21tdW5pY2F0b3I8VD4pIHtcbiAgICB0aGlzLmxpc3RQcm9taXNlID0gbnVsbDtcbiAgICB0aGlzLml0ZW1zID0gbnVsbDtcbiAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG4gIH1cblxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikge1xuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XG4gICAgICBzdWJzY3JpYmVyKHRoaXMuaXRlbXMsIHRoaXMuZXJyb3IpO1xuICAgICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHN1YnNjcmliZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgdW5zdWJzY3JpYmUoc3Vic2NyaWJlcjogU3Vic2NyaWJlcjxUPikge1xuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlciAocyA9PiBzICE9PSBzdWJzY3JpYmVyKTtcbiAgfVxuXG4gIG5vdGlmeVN1YnNjcmliZXJzKCkge1xuICAgIHRoaXMuc3Vic2NyaWJlcnMuZm9yRWFjaChzID0+IHModGhpcy5pdGVtcywgdGhpcy5lcnJvcikpO1xuICB9XG5cbiAgZW5zdXJlSGFzRGF0YSgpIHtcbiAgICBpZiAoIXRoaXMubGlzdFByb21pc2UpIHRoaXMucmVmcmVzaEZyb21TZXJ2ZXIoKTtcbiAgICByZXR1cm4gdGhpcy5saXN0UHJvbWlzZTtcbiAgfVxuXG4gIHJlZnJlc2hGcm9tU2VydmVyKCkge1xuICAgIHRoaXMubGlzdFByb21pc2UgPSB0aGlzLmNvbW0ucXVlcnkoKS50aGVuKGl0ZW1zID0+IHtcbiAgICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcbiAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zIHx8IFtdO1xuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmxpc3RQcm9taXNlO1xuICB9XG4gIFxuICBhc3luYyB1cGRhdGUoaXRlbTogVCB8IFRbXSkge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSGFzRGF0YSgpO1xuICAgIGNvbnN0IHVwZGF0ZWRJdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbSkgPyBpdGVtIDogW2l0ZW1dO1xuICAgIHRoaXMuaXRlbXMgPSB0aGlzLml0ZW1zLm1hcChpdCA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IHVwZGF0ZWRJdGVtcy5maW5kKCh7aWR9KSA9PiBpdC5pZCA9PT0gaWQpO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRJdGVtID9cbiAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgdXBkYXRlZEl0ZW0pIDpcbiAgICAgICAgaXQ7XG4gICAgfSk7XG4gICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xuICB9XG5cbiAgaW5zZXJ0KGl0ZW06IFQgfCBUW10pIHtcbiAgICByZXR1cm4gdGhpcy5lbnN1cmVIYXNEYXRhKCkudGhlbigoKT0+e1xuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuY29uY2F0KGl0ZW0pO1xuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlKGlkOiBzdHJpbmcgfCBzdHJpbmdbXSkge1xuICAgIGNvbnN0IGlkcyA9IEFycmF5LmlzQXJyYXkoaWQpID8gaWQgOiBbaWRdO1xuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT57XG4gICAgICB0aGlzLml0ZW1zID0gdGhpcy5pdGVtcy5maWx0ZXIoaXQgPT4gIWlkcy5zb21lKGlkID0+IGl0LmlkID09PSBpZCkpO1xuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgeyBSZXBvLCBSZXBvQ29tbXVuaWNhdG9yIH0gZnJvbSAnLi9yZXBvJztcbmltcG9ydCB7IENvdXJzZSwgU2Nob29sIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xuaW1wb3J0IHsgZmxhdHRlbiwgTCB9IGZyb20gXCIuLi91dGlscy91dGlsc1wiO1xuXG5jbGFzcyBTY2hvb2xDb3Vyc2VzUmVwbyBleHRlbmRzIFJlcG88Q291cnNlPiB7XG4gIHByaXZhdGUgX3NjaG9vbElkOiBzdHJpbmc7XG4gIGdldFNjaG9vbElkKCkge1xuICAgIHJldHVybiB0aGlzLmVuc3VyZUhhc0RhdGEoKS50aGVuKCgpPT50aGlzLl9zY2hvb2xJZCk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihnZXRTY2hvb2xOYW1lOiAoKT0+c3RyaW5nKSB7XG4gICAgc3VwZXIoe1xuICAgICAgcXVlcnk6IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2Nob29sTmFtZSA9IGdldFNjaG9vbE5hbWUoKTtcbiAgICAgICAgY29uc3Qgc2Nob29scyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U2Nob29sPihcbiAgICAgICAgICBcInNjaG9vbHNcIiwge1xuICAgICAgICAgICAgbmFtZTogc2Nob29sTmFtZSxcbiAgICAgICAgICAgIGluY2x1ZGU6IFtcImNvdXJzZXNcIl1cbiAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fc2Nob29sSWQgPSBzY2hvb2xzLmxlbmd0aCA+IDAgJiYgc2Nob29sc1swXS5pZDtcbiAgICAgICAgaWYgKCF0aGlzLl9zY2hvb2xJZCkgdGhyb3cgbmV3IEVycm9yKExgU2tvbGFuICR7c2Nob29sTmFtZX0gZmlubnMgaW50ZSByZWdpc3RyZXJhZCBpIHN5c3RlbWV0LlxuICAgICAgICAgIEtvbnRha3RhIGVuIGFkbWluaXN0cmF0w7ZyIGbDtnIgS3Vyc2J5Z2dhcnZlcmt0eWdldCBvY2ggYmUgb20gYXR0IGzDpGdnYSB0aWxsIHNrb2xhbiBtZWQgbmFtbmV0IFwiJHtzY2hvb2xOYW1lfVwiYCk7XG4gICAgICAgIHJldHVybiBmbGF0dGVuKHNjaG9vbHMubWFwKHNjaG9vbCA9PiBzY2hvb2wuY291cnNlcykpO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IG15U2Nob29sQ291cnNlc1JlcG8gPSBuZXcgU2Nob29sQ291cnNlc1JlcG8oKCk9PmVudi5jdXJyZW50VXNlci5zY2hvb2wpO1xuIiwiXG5leHBvcnQgY2xhc3MgQ2FjaGVkUmVzcG9uc2U8VD4ge1xuICAgIHByb21pc2U6IFByb21pc2U8VD4gfCBudWxsO1xuICAgIHJlc3VsdDogVCB8IG51bGw7XG4gICAgY29uc3RydWN0b3IocHVibGljIHF1ZXJ5ZXI6ICgpPT5Qcm9taXNlPFQ+KSB7XG4gICAgICAgIHRoaXMucHJvbWlzZSA9IG51bGw7XG4gICAgICAgIHRoaXMucmVzdWx0ID0gbnVsbDtcbiAgICB9XG5cbiAgICBxdWVyeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZSA/XG4gICAgICAgICAgICB0aGlzLnByb21pc2UgOlxuICAgICAgICAgICAgKHRoaXMucHJvbWlzZSA9IHRoaXMucXVlcnllcigpLnRoZW4oeCA9PiB0aGlzLnJlc3VsdCA9IHgpKTtcbiAgICB9XG5cbiAgICByZXNldCgpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbnVsbDtcbiAgICB9XG59XG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge0x9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHtkYn0gZnJvbSAnLi4vZ2xvYmFscy9kYic7XG5pbXBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH0gZnJvbSAna2VkYmFja2VuZC9yZXBvJztcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb21wb25lbnRzL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcblxuXG5pbnRlcmZhY2UgUHJvcHMge1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBlcnJvcnM6IEVycm9yU3RydWN0W107XG4gIGluZm9zOiBzdHJpbmdbXTtcbiAgLy9kYldyaXRlclJldHJ5YWJsZUVycm9yPzogRXJyb3I7XG4gIGRiV3JpdGVySXNTYXZpbmc/OiBib29sZWFuO1xuICBkYldyaXRlcklzRWRpdGVkPzogYm9vbGVhbjtcbn1cblxuaW50ZXJmYWNlIEVycm9yU3RydWN0IHtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICByZXRyeWFibGU/OiBib29sZWFuO1xuICBkZXRhaWxzPzogRXJyb3I7XG4gIHNob3dEZXRhaWxzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIEVycm9yU3VjY2Vzc0ZlZWRiYWNrIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZT17XG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgaW5mb3M6IFtdXG4gICAgfTtcbiAgICB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24gPSB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9lcnJvciA9IHRoaXMuX2Vycm9yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fY3VzdG9tRXJyb3IgPSB0aGlzLl9jdXN0b21FcnJvci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uSW5mbyA9IHRoaXMuX29uSW5mby5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2RiV3JpdGVyRXJyb3IgPSB0aGlzLl9kYldyaXRlckVycm9yLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQgPSB0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgcHJpdmF0ZSBfYWRkRXJyb3IobWVzc2FnZTogc3RyaW5nLCBkZXRhaWxzPzogRXJyb3IsIHJldHJ5YWJsZT86IGJvb2xlYW4pIHtcbiAgICAvL2NvbnNvbGUuZXJyb3IobWVzc2FnZSwge3JldHJ5YWJsZTogISFyZXRyeWFibGUsIGRldGFpbHN9KTtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4ge1xuICAgICAgaWYgKGVycm9ycy5zb21lKGUgPT4gZS5tZXNzYWdlID09PSBtZXNzYWdlKSkgcmV0dXJuIHtlcnJvcnN9O1xuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAyKSBlcnJvcnMgPSBlcnJvcnMuc2xpY2UoMSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlcnJvcnM6IGVycm9ycy5jb25jYXQoW3ttZXNzYWdlLCBkZXRhaWxzLCByZXRyeWFibGV9XSlcbiAgICAgIH07XG4gICAgfSk7XG4gICAgLy8gUmVtb3ZlIG5vbi1yZXRyeWFibGUgZXJyb3JzIGFmdGVyIDMwIHNlY29uZHM6XG4gICAgaWYgKCFyZXRyeWFibGUpIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiAoe1xuICAgICAgICBlcnJvcnM6IGVycm9ycy5maWx0ZXIoZSA9PiBlLm1lc3NhZ2UgIT09IG1lc3NhZ2UpXG4gICAgICB9KSk7XG4gICAgfSwgMzAwMDApO1xuICB9XG5cbiAgcHJpdmF0ZSBfYWRkSW5mbyhtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBpZiAobWVzc2FnZSA9PT0gXCJcIikge1xuICAgICAgLy8gVHVybiBvZmYgY3VycmVudCBpbmZvIG1lc3NhZ2VzXG4gICAgICB0aGlzLnNldFN0YXRlKHtpbmZvczogW119KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSgoe2luZm9zfSkgPT4ge1xuICAgICAgaWYgKGluZm9zLnNvbWUoaW5mbyA9PiBpbmZvID09PSBtZXNzYWdlKSkgcmV0dXJuIHtpbmZvc307XG4gICAgICBpZiAoaW5mb3MubGVuZ3RoID4gMikgaW5mb3MgPSBpbmZvcy5zbGljZSgxKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZm9zOiBpbmZvcy5jb25jYXQobWVzc2FnZSlcbiAgICAgIH07XG4gICAgfSk7XG4gICAgLy8gUmVtb3ZlIGluZm8gbWVzc2FnZSBhZnRlciAxMCBzZWNvbmRzOlxuICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtpbmZvc30pID0+ICh7XG4gICAgICAgIGluZm9zOiBpbmZvcy5maWx0ZXIobXNnID0+IG1zZyAhPT0gbWVzc2FnZSlcbiAgICAgIH0pKTtcbiAgICB9LCAxMDAwMCk7XG4gIH1cblxuICBwcml2YXRlIF9kYldyaXRlckVycm9yIChlcnJvcjogRXJyb3IsIHJldHJ5YWJsZTogYm9vbGVhbikge1xuICAgIHRoaXMuX2FkZEVycm9yKGBEZXQgZ8OlciBpbnRlIGF0dCBzcGFyYSB0aWxsIHNlcnZlcm5gLCBlcnJvciwgcmV0cnlhYmxlKTtcbiAgfVxuXG4gIHByaXZhdGUgX2RiV3JpdGVyU3RhdGVDaGFuZ2VkICh7aXNFZGl0ZWQsIGlzU2F2aW5nfTogS2VkQmFja2VuZFdyaXRlcikge1xuICAgIGlmICghaXNFZGl0ZWQpIHtcbiAgICAgIC8vIElmIGlzRWRpdGVkIGlzIGZhbHNlLCBhIHN1Y2Nlc3NmdWwgd3JpdGUgbXVzdCBoYXZlIGhhcHBlbmVkLCBhbmRcbiAgICAgIC8vIHRoZXJlIGNhbm5vdCBiZSBhbnkgcmV0cnlhYmxlIGVycm9yIGFueW1vcmVcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiB7XG4gICAgICAgIGVycm9ycyA9IGVycm9ycy5maWx0ZXIoZSA9PiAhZS5yZXRyeWFibGUpO1xuICAgICAgICByZXR1cm4ge2Vycm9yc307XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBkYldyaXRlcklzRWRpdGVkOiBpc0VkaXRlZCxcbiAgICAgIGRiV3JpdGVySXNTYXZpbmc6IGlzU2F2aW5nXG4gICAgfSk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcbiAgICBkYi53cml0ZXIub25FcnJvcih0aGlzLl9kYldyaXRlckVycm9yKTtcbiAgICBkYi53cml0ZXIub25TdGF0ZUNoYW5nZSh0aGlzLl9kYldyaXRlclN0YXRlQ2hhbmdlZCk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLl9lcnJvcik7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2N1c3RvbWVycm9yJywgdGhpcy5fY3VzdG9tRXJyb3IpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcbiAgICBkYi53cml0ZXIub2ZmKHRoaXMuX2RiV3JpdGVyRXJyb3IpO1xuICAgIGRiLndyaXRlci5vZmYodGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQpO1xuICB9XG5cbiAgX3VuaGFuZGxlZFJlamVjdGlvbiAoZXY6IEV2ZW50ICYge3JlYXNvbjogRXJyb3J9KSB7XG4gICAgdGhpcy5fYWRkRXJyb3IoYEV0dCBva8OkbnQgZmVsIGludHLDpGZmYWRlLi4uYCwgZXYucmVhc29uKTtcbiAgfVxuXG4gIF9lcnJvciAoZXY6IEV2ZW50ICYge2Vycm9yOiBFcnJvcn0pIHtcbiAgICB0aGlzLl9hZGRFcnJvcihldi5lcnJvciA/IGV2LmVycm9yLm1lc3NhZ2UgOiBgRXR0IG9rw6RudCBmZWwgaW50csOkZmZhZGUuLi5gLCBldi5lcnJvcik7XG4gIH1cblxuICBfY3VzdG9tRXJyb3IgKGV2OiBDdXN0b21FdmVudCkge1xuICAgIHRoaXMuX2FkZEVycm9yKGV2LmRldGFpbCk7XG4gIH1cblxuICBfb25JbmZvKGV2OiBDdXN0b21FdmVudCkge1xuICAgIHRoaXMuX2FkZEluZm8oZXYuZGV0YWlsKTtcbiAgfSBcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge2Vycm9ycywgaW5mb3MsIGRiV3JpdGVySXNTYXZpbmd9ID0gdGhpcy5zdGF0ZTtcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJlcnJvci1zdWNjZXNzLWZlZWRiYWNrXCIgc3R5bGU9e3tcbiAgICAgIHBvc2l0aW9uOiBcImZpeGVkXCIsXG4gICAgICBsZWZ0OiAwLFxuICAgICAgdG9wOiAwLFxuICAgICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnXG4gICAgfX0+XG4gICAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogJ3RhYmxlJywgbWFyZ2luOiBcIjAgYXV0b1wifX0+XG4gICAgICAgIHtlcnJvcnMuZmlsdGVyKGUgPT4gIWUucmV0cnlhYmxlIHx8ICFkYldyaXRlcklzU2F2aW5nKVxuICAgICAgICAubWFwKCh7bWVzc2FnZSwgZGV0YWlscywgcmV0cnlhYmxlLCBzaG93RGV0YWlsc30pID0+IChcbiAgICAgICAgICA8ZGl2IGtleT17bWVzc2FnZX0gY2xhc3NOYW1lPVwiZXJyb3JcIj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3tmbG9hdDonbGVmdCd9fT57bWVzc2FnZX08L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cbiAgICAgICAgICAgICAgPFJlbW92ZUl0ZW0gb25DbGljaz17KCk9PnRoaXMucmVtb3ZlRXJyb3IobWVzc2FnZSl9IC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIHtkZXRhaWxzIHx8IHJldHJ5YWJsZSA/IDxkaXYgc3R5bGU9e3twb2ludGVyRXZlbnRzOiAnYXV0byd9fT5cbiAgICAgICAgICAgICAge2RldGFpbHMgPyA8PjxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnRvZ2dsZURldGFpbHMobWVzc2FnZSl9PntzaG93RGV0YWlscyA/IFwiRMO2bGogZGV0YWlsZXJcIiA6IFwiVmlzYSBkZXRhaWxqZXJcIn08L2E+Jm5ic3A7PC8+IDogdW5kZWZpbmVkfVxuICAgICAgICAgICAgICB7c2hvd0RldGFpbHMgPyA8cD57JycrZGV0YWlsc308L3A+OiA8PiZuYnNwOzwvPn1cbiAgICAgICAgICAgICAge3JldHJ5YWJsZSA/IDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnJldHJ5U2F2ZSgpfT5Gw7Zyc8O2ayBzcGFyYSBudTwvYT4gOiB1bmRlZmluZWR9XG4gICAgICAgICAgICA8L2Rpdj46IHVuZGVmaW5lZH1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICAgIHtpbmZvcy5tYXAobWVzc2FnZSA9PiBcbiAgICAgICAgICA8cCBrZXk9e21lc3NhZ2V9IGNsYXNzTmFtZT1cImluZm9cIj57bWVzc2FnZX08L3A+XG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj47XG4gIH1cbiAgcmVtb3ZlRXJyb3IobWVzc2FnZTogc3RyaW5nKTogYW55IHtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtcbiAgICAgIGVycm9yczogZXJyb3JzLmZpbHRlcihlID0+IGUubWVzc2FnZSAhPT0gbWVzc2FnZSlcbiAgICB9KSk7XG4gIH1cblxuICByZXRyeVNhdmUoKSB7XG4gICAgZGIud3JpdGVyLnJldHJ5U2F2ZSgpO1xuICB9XG5cbiAgdG9nZ2xlRGV0YWlscyhtZXNzYWdlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnNldFN0YXRlKCh7ZXJyb3JzfSkgPT4gKHtlcnJvcnM6IGVycm9ycy5tYXAoZXJyb3IgPT4gZXJyb3IubWVzc2FnZSA9PT0gbWVzc2FnZSA/XG4gICAgICB7XG4gICAgICAgIC4uLmVycm9yLFxuICAgICAgICBzaG93RGV0YWlsczogIWVycm9yLnNob3dEZXRhaWxzXG4gICAgICB9IDpcbiAgICAgIGVycm9yKVxuICAgIH0pKTtcbiAgfVxufVxuIiwiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuY29uc3QgSEVBUlRCRUFUX0lOVEVSVkFMID0gNSAqIDYwICogMTAwMDsgLy8gNSBtaW51dGVzLlxuY29uc3QgSEVBUlRCRUFUX1VSTCA9IFwiLzQuNGI0Y2NlMmExNjBlNDQ1NTkzZjE2MDQzLmh0bWxcIjsgLy8gQ291bGQgYmUgYW55IHByb3RlY3RlZCByZXNvdXJjZS4gQlVHQlVHOiBDb25maWd1cmFibGUuXG5cbmxldCBsYXN0QWN0aXZpdHkgPSBEYXRlLm5vdygpO1xuXG5leHBvcnQgZnVuY3Rpb24ga2VlcFNlc3Npb25BbGl2ZSgpIHtcbiAgc2V0SW50ZXJ2YWwob25UaW1lb3V0LCBIRUFSVEJFQVRfSU5URVJWQUwpO1xuICBzZXRUaW1lb3V0KCgpPT4kKCdib2R5JylcbiAgICAubW91c2Vtb3ZlKG9uVXNlckFjdGl2ZSlcbiAgICAua2V5cHJlc3Mob25Vc2VyQWN0aXZlKVxuICAgIC5zY3JvbGwob25Vc2VyQWN0aXZlKSwgMTAwKTtcbn1cblxuZnVuY3Rpb24gb25Vc2VyQWN0aXZlKCkge1xuICBsYXN0QWN0aXZpdHkgPSBEYXRlLm5vdygpO1xufVxuXG5mdW5jdGlvbiBvblRpbWVvdXQoKSB7XG4gIGNvbnN0IGluYWN0aXZpdHlUaW1lID0gRGF0ZS5ub3coKSAtIGxhc3RBY3Rpdml0eTtcbiAgaWYgKGluYWN0aXZpdHlUaW1lIDwgSEVBUlRCRUFUX0lOVEVSVkFMKSB7XG4gICAgaGVhcnRiZWF0KCk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaGVhcnRiZWF0KCkge1xuICBjb25zb2xlLmxvZyhgU2VuZGluZyBoZWFydGJlYXQgcmVxdWVzdCB0byAke0hFQVJUQkVBVF9VUkx9YCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goSEVBUlRCRUFUX1VSTCwge1xuICAgICAgY2FjaGU6ICduby1jYWNoZScsXG4gICAgICBjcmVkZW50aWFsczogJ3NhbWUtb3JpZ2luJ1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKGBSZXNwb25zZSBmcm9tICR7SEVBUlRCRUFUX1VSTH06ICR7cmVzLnN0YXR1c30gJHtyZXMuc3RhdHVzVGV4dH1gKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS53YXJuKGBSZXF1ZXN0IHRvICR7SEVBUlRCRUFUX1VSTH0gZmFpbGVkOiAke2Vycn1gKTtcbiAgfVxufVxuIiwiZXhwb3J0IGludGVyZmFjZSBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucyB7XG4gIHRvTG93ZXI/OiBib29sZWFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9IHtcbiAgY29uc3Qge3RvTG93ZXJ9ID0gKG9wdGlvbnMgfHzCoHt9KSBhcyBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucztcbiAgY29uc3QgcmVzdWx0ID0ge307XG4gIGlmIChsb2NhdGlvblNlYXJjaCAmJiBsb2NhdGlvblNlYXJjaC5sZW5ndGggPiAxKVxuICAgIGxvY2F0aW9uU2VhcmNoLnN1YnN0cigxKVxuICAgICAgLnNwbGl0KCcmJylcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnNwbGl0KCc9JykubWFwKHMgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMudHJpbSgpKSkpXG4gICAgICAuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiByZXN1bHRbdG9Mb3dlciA/IGtleS50b0xvd2VyQ2FzZSgpIDoga2V5XSA9IHZhbHVlKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gZW5jb2RlUGFyYW1zKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5maWx0ZXIoa2V5ID0+IHBhcmFtc1trZXldICE9PSB1bmRlZmluZWQpLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trZXldKX1gKS5qb2luKCcmJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gXCI/XCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSGFzaFF1ZXJ5U3RyaW5nKGxvY2F0aW9uSGFzaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpIHtcbiAgcmV0dXJuIHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlSGFzaFF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xuICByZXR1cm4gXCIjXCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0VXJsQW5kUXVlcnkgKHVybFdpdGhQb3NzaWJsZVF1ZXJ5OiBzdHJpbmcpIHtcbiAgY29uc3QgcFF1ZXJ5ID0gdXJsV2l0aFBvc3NpYmxlUXVlcnkuaW5kZXhPZignPycpO1xuICByZXR1cm4gcFF1ZXJ5ID49IDAgP1xuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIoMCwgcFF1ZXJ5KSwgdXJsV2l0aFBvc3NpYmxlUXVlcnkuc3Vic3RyKHBRdWVyeSldIDpcbiAgICBbdXJsV2l0aFBvc3NpYmxlUXVlcnksIFwiXCJdO1xufVxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgVGVybSwgQWNhZGVtaWNZZWFyIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xuICB0ZXJtOiBUZXJtO1xuICB3ZWVrPzogbnVtYmVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XG4gIHJldHVybiB0ZXJtID09PSAnQVQnID9cbiAgICBbMzIsIDUxXSA6XG4gICAgWzEsIDI1XTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRlcm1TdGFydEFuZEVuZChub3c6IG1vbWVudC5Nb21lbnQpIDogbW9tZW50Lk1vbWVudFtdIHtcbiAgcmV0dXJuIG5vdy5tb250aCgpID49IDYgPyAvLyA2ID0gSnVseSBpbiBKUyBEYXRlcyBhbmQgaW4gbW9tZW50IGFzIHdlbGwhXG4gICAgW21vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCA3LCAxKSksIG1vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCAxMSwgMzEpKV0gOiAvLyBhdWcxIC0gZGVjMzFcbiAgICBbbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDAsIDEpKSwgbW9tZW50KG5ldyBEYXRlKG5vdy55ZWFyKCksIDYsIDMxKSldOyAvLyBqYW4xIC0ganVseTMxXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTY2hvb2xNb21lbnQobTogbW9tZW50Lk1vbWVudCk6IFNjaG9vbE1vbWVudCB7XG4gIGNvbnN0IHRoaXNZZWFyID0gbS55ZWFyKCk7XG4gIGNvbnN0IGlzQXV0dW1uID0gbS5tb250aCgpID49IDY7XG4gIGNvbnN0IFthdXR1bW5ZZWFyLCBzcHJpbmdZZWFyXSA9IGlzQXV0dW1uID9cbiAgICBbdGhpc1llYXIsIHRoaXNZZWFyICsgMV0gOlxuICAgIFt0aGlzWWVhciAtIDEsIHRoaXNZZWFyXTtcbiAgY29uc3QgYWNhZGVtaWNZZWFyID0gJycgKyBhdXR1bW5ZZWFyICsgJy8nICsgc3ByaW5nWWVhcjtcbiAgY29uc3QgdGVybSA9IGlzQXV0dW1uID8gJ0FUJyA6ICdTVCc7XG4gIGNvbnN0IHdlZWsgPSBtLndlZWsoKTtcbiAgcmV0dXJuIHsgYWNhZGVtaWNZZWFyLCB0ZXJtLCB3ZWVrIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIsIG51bVllYXJzVG9BZGQ6IG51bWJlcik6IEFjYWRlbWljWWVhciB7XG4gIHJldHVybiBhWWVhci5zcGxpdCgnLycpXG4gICAgLm1hcCh5ZWFyU3RyID0+IHBhcnNlSW50KHllYXJTdHIpICsgbnVtWWVhcnNUb0FkZClcbiAgICAubWFwKHllYXIgPT4gJycgKyB5ZWFyKVxuICAgIC5qb2luKCcvJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXh0QWNhZGVtaWNZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIpOiBBY2FkZW1pY1llYXIge1xuICByZXR1cm4gYWRkWWVhcihhWWVhciwgMSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmV2QWNhZGVtaWNZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIpOiBBY2FkZW1pY1llYXIge1xuICByZXR1cm4gYWRkWWVhcihhWWVhciwgLTEpO1xufVxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgU2Nob29sTW9tZW50LCBnZXRTY2hvb2xNb21lbnQsIGFkZFllYXIgfSBmcm9tICcuL3NjaG9vbC1tb21lbnQnO1xuaW1wb3J0IHsgQWNhZGVtaWNZZWFyLCBUZXJtIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xuXG50eXBlIE1vbWVudCA9IG1vbWVudC5Nb21lbnQ7XG5cbmZ1bmN0aW9uIGlzU2Nob29sTW9tZW50KG9iajogRGF0ZSB8IFNjaG9vbE1vbWVudCk6IG9iaiBpcyBTY2hvb2xNb21lbnQge1xuICByZXR1cm4gJ2FjYWRlbWljWWVhcicgaW4gb2JqO1xufVxuXG5leHBvcnQgY2xhc3MgU2Nob29sVGVybSB7XG4gIGFjYWRlbWljWWVhcjogQWNhZGVtaWNZZWFyO1xuICB0ZXJtOiBUZXJtO1xuXG4gIGNvbnN0cnVjdG9yKGRhdGVPclNjaG9vbE1vbWVudDogRGF0ZSB8IFNjaG9vbE1vbWVudCkge1xuICAgIGNvbnN0IHNjaG9vbE1vbWVudCA9IGlzU2Nob29sTW9tZW50KGRhdGVPclNjaG9vbE1vbWVudCkgP1xuICAgICAgZGF0ZU9yU2Nob29sTW9tZW50IDogZ2V0U2Nob29sTW9tZW50KG1vbWVudChkYXRlT3JTY2hvb2xNb21lbnQpKTtcbiAgICB0aGlzLmFjYWRlbWljWWVhciA9IHNjaG9vbE1vbWVudC5hY2FkZW1pY1llYXI7XG4gICAgdGhpcy50ZXJtID0gc2Nob29sTW9tZW50LnRlcm07XG4gIH1cblxuICBnZXQgeWVhcigpIHtcbiAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5hY2FkZW1pY1llYXJcbiAgICAgICAgLnNwbGl0KCcvJylbdGhpcy50ZXJtID09PSAnQVQnID8gMCA6IDFdKTtcbiAgfVxuXG4gIG5leHRUZXJtKCkge1xuICAgIHJldHVybiBuZXcgU2Nob29sVGVybSh0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAge1xuICAgICAgICB0ZXJtOiAnU1QnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IHRoaXMuYWNhZGVtaWNZZWFyXG4gICAgICB9IDpcbiAgICAgIHtcbiAgICAgICAgdGVybTogJ0FUJyxcbiAgICAgICAgYWNhZGVtaWNZZWFyOiBhZGRZZWFyKHRoaXMuYWNhZGVtaWNZZWFyLCAxKVxuICAgICAgfSk7XG4gIH1cblxuICBwcmV2VGVybSgpIHtcbiAgICByZXR1cm4gbmV3IFNjaG9vbFRlcm0odGhpcy50ZXJtID09PSAnQVQnID9cbiAgICAgIHtcbiAgICAgICAgdGVybTogJ1NUJyxcbiAgICAgICAgYWNhZGVtaWNZZWFyOiBhZGRZZWFyKHRoaXMuYWNhZGVtaWNZZWFyLCAtMSlcbiAgICAgIH0gOlxuICAgICAge1xuICAgICAgICB0ZXJtOiAnQVQnLFxuICAgICAgICBhY2FkZW1pY1llYXI6IHRoaXMuYWNhZGVtaWNZZWFyXG4gICAgICB9KTtcbiAgICBcbiAgfVxuXG4gIHRvTG9jYWxlU3RyaW5nKGxvY2FsZXM6IHN0cmluZ1tdLCBzaG9ydFllYXI/OiBib29sZWFuKSB7XG4gICAgbGV0IHllYXIgPSB0aGlzLnRlcm0gPT09ICdBVCcgP1xuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVswXTpcbiAgICAgIHRoaXMuYWNhZGVtaWNZZWFyLnNwbGl0KCcvJylbMV07XG5cbiAgICBpZiAoc2hvcnRZZWFyKVxuICAgICAgeWVhciA9IHllYXIuc3Vic3RyKDIpO1xuXG4gICAgZm9yIChsZXQgbG9jYWxlIG9mIGxvY2FsZXMpIHtcbiAgICAgIHN3aXRjaCAobG9jYWxlLnNwbGl0KCctJylbMF0uc3BsaXQoJ18nKVswXS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgJ2VuJzpcbiAgICAgICAgICByZXR1cm4gYCR7dGhpcy50ZXJtID09PSAnQVQnID8gXCJBVFwiIDogXCJTVFwifSAke3llYXJ9YDtcbiAgICAgICAgY2FzZSAnc3YnOlxuICAgICAgICAgIHJldHVybiBgJHt0aGlzLnRlcm0gPT09ICdBVCcgPyBcIkhUXCIgOiBcIlZUXCJ9ICR7eWVhcn1gO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiXG5leHBvcnQgZnVuY3Rpb24gY2FwaXRhbGl6ZUZpcnN0IChzdHIpIHtcbiAgICBmb3IgKGxldCBpPTAsIGw9c3RyLmxlbmd0aDsgaTxsOyArK2kpIHtcbiAgICAgICAgaWYgKHN0ci5jaGFyQ29kZUF0KGkpIDwgMHgyMDAwKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLnN1YnN0cigwLCBpKSArIHN0cltpXS50b0xvY2FsZVVwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cihpICsgMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZChvYmosIGV4dGVuc2lvbikge1xuICAgIGlmICh0eXBlb2YgZXh0ZW5zaW9uICE9PSAnb2JqZWN0JykgcmV0dXJuIG9iajtcbiAgICBPYmplY3Qua2V5cyhleHRlbnNpb24pLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgb2JqW2tleV0gPSBleHRlbnNpb25ba2V5XTtcbiAgICB9KTtcbiAgICByZXR1cm4gb2JqO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvbmU8VCxFPiAob2JqIDogVCwgZXh0ZW5zaW9uPzogRSkge1xuICAgIGxldCBjbG9uZSA9IHt9O1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xvbmUsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkpO1xuICAgIH0pO1xuICAgIGlmIChleHRlbnNpb24pIGV4dGVuZChjbG9uZSwgZXh0ZW5zaW9uKTtcbiAgICByZXR1cm4gY2xvbmUgYXMgKFQgJiBFKTtcbn1cblxuY29uc3QgY29uY2F0ID0gW10uY29uY2F0O1xuZXhwb3J0IGZ1bmN0aW9uIGZsYXR0ZW48VD4gKGEgOiAoVCB8IFRbXSlbXSkge1xuICAgIHJldHVybiBjb25jYXQuYXBwbHkoW10sIGEpIGFzIFRbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVQcm9wPFQ+KHByb3A6a2V5b2YgVCkge1xuICAgIHJldHVybiAoYTogVCxiOiBUKSA9PiB7XG4gICAgICAgIGNvbnN0IGFQcm9wID0gYVtwcm9wXSwgYlByb3AgPSBiW3Byb3BdO1xuICAgICAgICByZXR1cm4gYVByb3AgPiBiUHJvcCA/IDEgOiBhUHJvcCA8IGJQcm9wID8gLTEgOiAwO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVQcm9wcyhcbiAgICBwcm9wczogc3RyaW5nIHwgc3RyaW5nW10sXG4gICAgbG9jYWxlcz86IHN0cmluZyB8IHN0cmluZ1tdLFxuICAgIG9wdGlvbnM/OiBJbnRsLkNvbGxhdG9yT3B0aW9ucyk6IChhOiBhbnksIGI6IGFueSkgPT4gbnVtYmVyXG57XG4gICAgcHJvcHMgPSBBcnJheS5pc0FycmF5KHByb3BzKSA/IHByb3BzIDogW3Byb3BzXTtcblxuICAgIGNvbnN0IGxvY2FsZUNvbXBhcmUgPSAoYSxiKSA9PlxuICAgICAgICB0eXBlb2YgYSA9PT0gJ3N0cmluZycgP1xuICAgICAgICAgICAgYS5sb2NhbGVDb21wYXJlKGIsIGxvY2FsZXMsIG9wdGlvbnMpIDpcbiAgICAgICAgICAgIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwO1xuXG4gICAgZnVuY3Rpb24gY21wUGFydCAoYSxiLGZpcnN0UGFydDogc3RyaW5nLHJlc3Q6IHN0cmluZ1tdKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0QSA9IGFbZmlyc3RQYXJ0XTtcbiAgICAgICAgaWYgKGZpcnN0QSA9PSBudWxsKSByZXR1cm4gLTE7XG4gICAgICAgIGNvbnN0IGZpcnN0QiA9IGJbZmlyc3RQYXJ0XTtcbiAgICAgICAgaWYgKGZpcnN0QiA9PSBudWxsKSByZXR1cm4gMTtcbiAgICAgICAgcmV0dXJuIHJlc3QubGVuZ3RoID09PSAwID9cbiAgICAgICAgICAgIGxvY2FsZUNvbXBhcmUoZmlyc3RBLCBmaXJzdEIpIDpcbiAgICAgICAgICAgIGNtcFBhcnQoZmlyc3RBLCBmaXJzdEIsIHJlc3RbMF0sIHJlc3Quc2xpY2UoMSkpO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9wc1xuICAgICAgICAubWFwKHByb3AgPT4gcHJvcC5zcGxpdCgnLicpKVxuICAgICAgICAubWFwKChbZmlyc3RQYXJ0LCAuLi5yZXN0XSkgPT4gKGEsYikgPT4gY21wUGFydChhLGIsIGZpcnN0UGFydCwgcmVzdCkpXG4gICAgICAgIC5yZWR1Y2UoKGNtcDEsIGNtcDIpID0+XG4gICAgICAgICAgICAoYSxiKSA9PiBjbXAxKGEsYikgfHwgY21wMihhLGIpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIEwodGV4dCwgLi4uYXJncykge1xuICAgIGxldCBmaXJzdCA9IHRleHRbMF07XG4gICAgcmV0dXJuIGJ1aWxkTWVzc2FnZSh0ZXh0LCBhcmdzKTtcbn1cblxuZnVuY3Rpb24gYnVpbGRNZXNzYWdlICh0ZXh0LCBhcmdzKSB7XG4gICAgbGV0IHJ2ID0gdGV4dFswXTtcbiAgICBmb3IgKGxldCBpPTEsIGw9dGV4dC5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIHJ2ICs9IGFyZ3NbaS0xXSArIHRleHRbaV07XG4gICAgfVxuICAgIHJldHVybiBydjtcbn1cblxuZXhwb3J0IGNsYXNzIFRDPFQ+IHtcbiAgICBjb25zdHJ1Y3Rvcih0ZW1wbGF0ZTogVCkge1xuICAgICAgICBleHRlbmQodGhpcywgdGVtcGxhdGUpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVUaW1lUmV2aXZlciAoa2V5LCB2YWx1ZSkge1xuICAgIHZhciBhO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGEgPSAvXFwvRGF0ZVxcKChcXGQqKVxcKVxcLy8uZXhlYyh2YWx1ZSk7XG4gICAgICAgIGlmIChhKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoK2FbMV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn1cblxuLy9sZXQgaW5mb1NlcmlhbCA9IDE7XG5leHBvcnQgZnVuY3Rpb24gc2hvd0luZm8gKG1zZykge1xuICAgIHZhciBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnaW5mbycsIHsgJ2RldGFpbCc6IG1zZyB9KTtcbiAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaG93RXJyb3IgKGVyck1zZzogc3RyaW5nIHwgRXJyb3IpIHtcbiAgICBjb25zdCBtc2cgPSB0eXBlb2YgZXJyTXNnID09PSAnc3RyaW5nJyA/IGVyck1zZyA6IGVyck1zZy5tZXNzYWdlO1xuICAgIHZhciBldmVudCA9IG5ldyBDdXN0b21FdmVudCgnY3VzdG9tZXJyb3InLCB7ICdkZXRhaWwnOiBtc2cgfSk7XG4gICAgY29uc29sZS5lcnJvcihlcnJNc2cpO1xuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1heExlbmd0aChzdHI6IHN0cmluZywgbWF4TGVuOiBudW1iZXIpIHtcbiAgICByZXR1cm4gc3RyLmxlbmd0aCA+IG1heExlbiA/XG4gICAgICAgIHN0ci5zdWJzdHIoMCwgbWF4TGVuIC0gMykgKyBcIi4uLlwiIDpcbiAgICAgICAgc3RyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb0xvb2t1cDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XG4gICAgY29uc3QgcmVzdWx0IDoge1trZXk6IHN0cmluZ10gOiBUW119ID0ge307XG4gICAgZm9yIChsZXQgaT0wLCBsPWEubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5QWNjZXNzb3IoaXRlbSk7XG4gICAgICAgIGxldCBhcnJheSA9IHJlc3VsdFtrZXldO1xuICAgICAgICBpZiAoYXJyYXkpIGFycmF5LnB1c2goaXRlbSk7XG4gICAgICAgIGVsc2UgcmVzdWx0W2tleV0gPSBbaXRlbV07XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcnJheVRvTWFwPFQ+KGE6IFRbXSwga2V5QWNjZXNzb3I6IChpdGVtOiBUKSA9PiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgICBjb25zdCByZXN1bHQgOiB7W2tleTogc3RyaW5nXSA6IFR9ID0ge307XG4gICAgZm9yIChsZXQgaT0wLCBsPWEubGVuZ3RoOyBpPGw7ICsraSkge1xuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5QWNjZXNzb3IoaXRlbSk7XG4gICAgICAgIHJlc3VsdFtrZXldID0gaXRlbTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZXJyeVBpY2tQcm9wczxUPiAob2JqOiBULCBwcm9wc1RvUGljazogc3RyaW5nW10pOiBQYXJ0aWFsPFQ+IHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHByb3BzVG9QaWNrKSB7XG4gICAgICBpZiAocGFyYW0gaW4gb2JqKSByZXN1bHRbcGFyYW1dID0gb2JqW3BhcmFtXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdCBhcyBQYXJ0aWFsPFQ+O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzdGluY3Q8VD4gKGE6IFRbXSwga2V5QWNjZXNzb3I/OiAoaXRlbTogVCkgPT4gYW55KSB7XG4gICAgY29uc3QgbWFwID0gYXJyYXlUb01hcChhLCBrZXlBY2Nlc3NvciB8fCAoeCA9PiB4KSk7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcCkubWFwKGtleSA9PiBtYXBba2V5XSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaGFsbG93RXF1YWxzKGE6IGFueSwgYjogYW55KSB7XG4gICAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlO1xuICAgIGlmICghYSB8fCAhYikgcmV0dXJuIGZhbHNlO1xuICAgIGlmICh0eXBlb2YgYSAhPT0gJ29iamVjdCcgfHwgdHlwZW9mIGIgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XG4gICAgY29uc3Qga2V5c0EgPSBPYmplY3Qua2V5cyhhKTtcbiAgICBjb25zdCBrZXlzQiA9IE9iamVjdC5rZXlzKGIpO1xuICAgIGlmIChrZXlzQS5sZW5ndGggIT09IGtleXNCLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAobGV0IGk9MCwgbD1rZXlzQS5sZW5ndGg7IGk8bDsgKytpKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGtleXNBW2ldO1xuICAgICAgICBpZiAoa2V5c0JbaV0gIT09IGtleSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAoYVtrZXldICE9PSBiW2tleV0pIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGpRdWVyeTsiLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3RET007Il0sInNvdXJjZVJvb3QiOiIifQ==