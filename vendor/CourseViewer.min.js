(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[6],{306:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(3),s=n(6),i=n(113),l=n(91),o=n(20),c=function(e){var t=e.title,n=e.backgroundImage,r=e.tabs,s=e.activeTab;return a.createElement("div",{className:"sv-row sv-layout sv-skip-spacer"},a.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},a.createElement("div",{className:"sv-script-portlet sv-portlet sv-skip-spacer"},n&&a.createElement("style",null,"\n        .pageHeader {\n          background-image: url('"+n+"') !important;\n        }\n      "),a.createElement("div",{className:"pageHeader"},a.createElement("a",null,a.createElement("h1",null,t)),a.createElement("div",{className:"buttonsField"},a.createElement("div",{className:"buttonsContainer"},a.createElement("div",{className:"align-horizontal"}),a.createElement("div",{className:"horizontalMenu"},a.createElement("ul",null,r.map((function(e,t){var n=e.name,r=e.key,i=e.link,l=s===i;return a.createElement("li",{key:r||("string"==typeof n?n:t),className:l?"activePage":""},a.createElement("a",{href:i},n))}))))))))))},u=n(132);var d=n(133),m=n(134),p=n(182),h=n(138);function f(e,t){return e.taskCustomizations?Object(r.a)(Object(r.a)({},t),e.taskCustomizations[t.id]):t}var b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(r.c)(t,e),t.prototype.render=function(){var e=this.props,t=e.module,n=e.course,r=function(e,t){var n={};return t.tasks.filter((function(t){return-1!==e.taskIds.indexOf(t.id)})).forEach((function(e){e.abilities.forEach((function(e){var t=e.id;return n[t]=!0})),e.centralContent.forEach((function(e){var t=e.id;return n[t]=!0})),e.knowledgeRequirements.forEach((function(e){var t=e.id;return n[t]=!0}))})),n}(t,n),i=t.taskIds.map((function(e){return n.tasks.find((function(t){return t.id===e}))})).filter((function(e){return!!e})).map((function(e){return{id:e.id,task:f(t,e),course:n,name:e.name,url:"#"+encodeURIComponent(t.name.trim())+"/"+e.id,courseName:n.name,learningGoal:e.learningGoal||t.name}})),l=i.filter((function(e){return e.task&&e.task.assignment})),o=i.filter((function(e){return!e.task||!e.task.assignment})),c=o.filter((function(e){return!e.task.learningGoal})),b=Object(s.b)(o.filter((function(e){return!!e.task.learningGoal})),(function(e){return e.learningGoal})),v=n.abilities.filter((function(e){return r[e.id]})),g=n.centralContent.filter((function(e){return r[e.id]}));return a.createElement("div",null,a.createElement("div",{className:"sv-text-portlet sv-use-margins sv-skip-spacer"},a.createElement("div",{className:"sv-text-portlet-content"},a.createElement("h1",{className:"h1"},t.name))),a.createElement("div",{className:"sv-vertical sv-layout"},a.createElement("div",{dangerouslySetInnerHTML:{__html:t.mandatoryContent}})),(!!t.startWeek||!!t.endWeek)&&a.createElement(a.Fragment,null,a.createElement("br",null),a.createElement("div",{className:"ked_boxed"},a.createElement("h3",null,"Modulens period"),a.createElement("div",{className:"week-period-div"},a.createElement("div",null,"Startvecka"),a.createElement("div",null,t.startWeek||"--"),a.createElement("div",null,"Slutvecka"),a.createElement("div",null,t.endWeek||"--")),a.createElement("br",null))),Object.keys(r).length>0&&a.createElement("div",{className:"sv-html-portlet sv-portlet"},a.createElement("div",{className:"ked_boxed"},a.createElement("h3",null,"Modulens kunskapskrav, förmågor och centrala innehåll"),a.createElement("hr",null),Object.keys(r).length>0&&a.createElement(u.a,{title:"I den här modulen bedöms följande kunskapskrav",requirements:n.knowledgeRequirements,includedIds:r}),v.length>0&&a.createElement(d.a,{title:"Den här modulen behandlar följande förmågor",abilities:v}),g.length>0&&a.createElement(m.a,{title:"Den här modulen behandlar följande centrala innehåll",centralContent:g}))),t.taskIds.length>0&&a.createElement("div",{className:"sv-script-portlet sv-portlet"},a.createElement("div",{className:"ked_boxed"},0===l.length?void 0:a.createElement(a.Fragment,null,a.createElement("h2",null,"Inlämningsuppgifter"),a.createElement("hr",null),a.createElement(h.a,{learningTasks:l})),0===o.length?void 0:a.createElement(a.Fragment,null,a.createElement("h2",null,"Uppgifter"),a.createElement("hr",null),a.createElement(p.a,{commonTasks:c,learningGoals:Object.keys(b).map((function(e){return{name:e,learningTasks:b[e]}}))})))),t.resources.length>0&&a.createElement("div",{className:"sv-html-portlet sv-portlet"},a.createElement("div",{className:"ked_boxed"},a.createElement("h2",null,"Resurser"),a.createElement("hr",null),a.createElement("div",{className:"taskContainer"},t.resources.map((function(e,t){return a.createElement("div",{className:"align-horizontal",key:t},a.createElement("div",{className:"horizontalItem top"},a.createElement("a",{href:e.url},e.name)))}))))))},t}(a.Component),v=function(e){function t(t){return e.call(this,t)||this}return Object(r.c)(t,e),t.prototype.render=function(){var e=this.props.resources;return a.createElement("div",null,a.createElement("div",{className:"taskContainer"},e.map((function(e,t){return a.createElement("div",{className:"align-horizontal",key:t},a.createElement("div",{className:"horizontalItem top"},a.createElement("a",{href:e.url},e.name)))}))))},t}(a.Component),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(r.c)(t,e),t.prototype.render=function(){var e=this.props.course;return a.createElement("div",null,a.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},e.runUpText&&a.createElement("div",null,a.createElement("h1",null,"Upptakt"),a.createElement("p",{className:"normal",dangerouslySetInnerHTML:{__html:e.runUpText}})),e.responsibleTeachers&&e.responsibleTeachers.length>0&&a.createElement("div",null,a.createElement("h2",null,"Lärare"),e.responsibleTeachers.map((function(e,t){return a.createElement("p",{key:t},a.createElement("a",{href:k(e.email||e.url||"")},e.name))}))),e.workFlowLink&&a.createElement("a",{className:"btn",href:e.workFlowLink},"Arbetsgång"),a.createElement("br",null),a.createElement("br",null),e.abilities.length>0&&a.createElement(d.a,{title:"Ämnets förmågor",subTitle:"Förmågor",abilities:e.abilities,className:"larger"}),e.centralContent.length>0&&a.createElement(m.a,{title:"Kursens centrala innehåll",subTitle:"Centralt innehåll",centralContent:e.centralContent,className:"larger"}),e.knowledgeRequirements.length>0&&a.createElement(u.a,{title:"Kursens kunskapskrav",requirements:e.knowledgeRequirements,className:"larger"})),e.resources.length>0&&a.createElement("div",{className:"sv-html-portlet sv-portlet"},a.createElement("div",{className:"ked_boxed"},a.createElement("h2",null,"Resurser"),a.createElement("hr",null),a.createElement(v,{resources:e.resources}))))},t}(a.Component);function k(e){return-1===e.indexOf(":")&&e.indexOf("@")>=0?"mailto:"+e:e}var E=!1;var O,j,y,N,I,w=n(23),S=n(106),T=n(137),C=n(2),U=n(4),F=n(5),R=n.n(F),W=n(213),D=n(155),L=n(127),x=n(107),M=n(128),_=function(e){function t(){return e.call(this,{discoveryDocs:"https://classroom.googleapis.com/$discovery/rest?version=v1"})||this}return Object(r.c)(t,e),t.prototype.reclaimSubmission=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.ensureInited()];case 1:return t.sent(),[4,gapi.client.classroom.courses.courseWork.studentSubmissions.reclaim({courseId:e.courseId,courseWorkId:e.courseWorkId,id:e.id}).then((function(e){return e.result}))];case 2:return[2,t.sent()]}}))}))},t.prototype.handInSubmission=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.ensureInited()];case 1:return t.sent(),[4,gapi.client.classroom.courses.courseWork.studentSubmissions.turnIn({courseId:e.courseId,courseWorkId:e.courseWorkId,id:e.id}).then((function(e){return e.result}))];case 2:return[2,t.sent()]}}))}))},t.prototype.returnSubmission=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.ensureInited()];case 1:return t.sent(),[4,gapi.client.classroom.courses.courseWork.studentSubmissions.return({courseId:e.courseId,courseWorkId:e.courseWorkId,id:e.id}).then((function(e){return e.result}))];case 2:return[2,t.sent()]}}))}))},t.prototype.getSubmissions=function(e,t,n,a){return Object(r.b)(this,void 0,void 0,(function(){var s,i,l,o,c,u,d,m=this;return Object(r.d)(this,(function(p){switch(p.label){case 0:return[4,this.ensureInited()];case 1:return p.sent(),[4,this.getClassrooms(e)];case 2:return s=p.sent(),i=[],n?[4,Promise.all(s.map((function(e,n){return Object(r.b)(m,void 0,void 0,(function(){var a,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.getCourseWork(e.id,t,!1)];case 1:return a=r.sent(),[4,this.getStudents(e.id)];case 2:return i=r.sent(),s[n].courseWork=a,s[n].students=i,[2]}}))}))})))]:[3,5];case 3:return p.sent(),s=s.filter((function(e){return!!e.courseWork})),[4,Promise.all(s.map((function(e,t){return Object(r.b)(m,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.getStudentSubmissions(e.id,e.courseWork.id,!1)];case 1:return[2,t.sent()]}}))}))})))];case 4:return l=p.sent(),o=[],l.map((function(e,t){var n=s[t].room.split("|")[1],a=s[t].courseWork.alternateLink,i=s[t].students,l=e.map((function(e){var t=i.filter((function(t){return t.userId==e.userId}))[0];return console.log(t),t||(t.name={firstName:"Förnamn",lastName:"Efternamn"}),Object(r.a)(Object(r.a)(Object(r.a)({},t),e),{group:n,crLink:a})}));o.push.apply(o,Object(r.h)(l))})),i.push.apply(i,Object(r.h)(o)),console.table(i),[3,8];case 5:return[4,this.getCourseWork(s[0].id,t)];case 6:return c=p.sent(),[4,this.getStudentSubmissions(c.courseId,c.id,!0)];case 7:u=p.sent(),i.push.apply(i,Object(r.h)(u.map((function(e){return e.userEmail=U.b.currentUser.mail,e})))),p.label=8;case 8:return a?(d=n?s[0].courseWork.materials[0].driveFile.driveFile:i[0].assignmentSubmission.attachments[0].driveFile,[2,{submissions:i,templateFile:d.alternateLink,templateThumbnail:d.thumbnailUrl,templateTitle:d.title}]):[2,{submissions:i}]}}))}))},t.prototype.addFilesToSubmission=function(e,t,n,a){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.ensureInited()];case 1:return r.sent(),[4,gapi.client.classroom.courses.courseWork.studentSubmissions.modifyAttachments({courseId:e,courseWorkId:t,id:n,addAttachments:a.map((function(e){return{driveFile:{id:e.fileId}}}))}).then((function(e){return console.log(e)}))];case 2:return r.sent(),[2]}}))}))},t.prototype.getUser=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,gapi.client.classroom.userProfiles.get({userId:e}).then((function(e){var t=e.result.name;return{name:{firstName:t.givenName,lastName:t.familyName},userEmail:e.result.emailAddress}}))];case 1:if((t=n.sent()).name)return[2,t];throw"Användare inte hittad"}}))}))},t.prototype.getClassrooms=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return[4,gapi.client.classroom.courses.list({fields:"courses.id,courses.room,courses.descriptionHeading",courseStates:"ACTIVE"}).then((function(t){return t.result.courses.filter((function(t){return t.room&&t.room.indexOf(e)>-1}))}))];case 1:if((t=n.sent()).length>0)return[2,t];throw"Inte registrerad på kurs"}}))}))},t.prototype.getStudents=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,gapi.client.classroom.courses.students.list({courseId:e,fields:"students.userId,students.profile.name,students.profile.emailAddress"}).then((function(e){return e.result.students.map((function(e){return{userId:e.userId,name:{firstName:e.profile.name.givenName,lastName:e.profile.name.familyName},userEmail:e.profile.emailAddress}}))}))];case 1:return[2,t.sent()]}}))}))},t.prototype.getCourseWork=function(e,t,n){return void 0===n&&(n=!0),Object(r.b)(this,void 0,void 0,(function(){var a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,gapi.client.classroom.courses.courseWork.list({courseId:e,fields:"courseWork.courseId,courseWork.alternateLink,courseWork.id,courseWork.materials,courseWork.description,courseWork.workType,courseWork.dueDate,courseWork.dueTime"}).then((function(e){return e.result.courseWork?e.result.courseWork.filter((function(e){return e.description.indexOf(t)>-1})):[]}))];case 1:if(1==(a=r.sent()).length)return[2,a[0]];if(n)throw"Hittar ingen matchad inlämningsuppgift";return[2]}}))}))},t.prototype.getStudentSubmissions=function(e,t,n){return void 0===n&&(n=!0),Object(r.b)(this,void 0,void 0,(function(){var a;return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,gapi.client.classroom.courses.courseWork.studentSubmissions.list({courseId:e,courseWorkId:t}).then((function(e){return e.result.studentSubmissions}))];case 1:if(a=r.sent())return[2,a];if(n)throw"Hittar ingen matchad inlämning";return[2]}}))}))},t}(n(143).a),A=n(90),P=n(114),H=n(204),B={TURNED_IN:"inlämnad",RECLAIMED_BY_STUDENT:"återtagen",RETURNED:"återlämnad",CREATED:"ej inlämnad",NEW:"ej inlämnad"},z=function(e){var t=e.submissions,n=e.assignments,r=e.sendToKedbackend,s=e.hasTemplate,i=e.sendToUrkund,l=e.courseId,o=e.taskId,c={},u={};t.forEach((function(e){c[e.group]?c[e.group].push(e):c[e.group]=[e]})),n.forEach((function(e){var n=t.find((function(t){return t.id==e.submissionId}));n&&(u[n.group]?u[n.group].push(e):u[n.group]=[e])}));var d=t.length>0?t[0].crLink.replace("details","submissions/by-status/and-sort-last-name/all"):"";return a.createElement("div",{className:"stopFloats"},Object.keys(c).sort().map((function(e,t){return a.createElement(A.a,{key:t,title:e,children:a.createElement(a.Fragment,null,""!==d&&a.createElement("div",{className:"pullRight"},a.createElement(x.a,{url:d,label:"Visa i Classroom",faIcon:"fas fa-graduation-cap"})),a.createElement(K,{assignments:u[e]?u[e]:[],submissions:c[e],hasTemplate:s,sendToKedbackend:r,sendToUrkund:i,courseId:l,taskId:o}))})})))},K=function(e){function t(t){var n=e.call(this,t)||this;return n.state={submissions:n.props.submissions,assignments:n.props.assignments},n}return Object(r.c)(t,e),t.prototype.render=function(){var e=this,t=function(e,t){var n=e.name.lastName.localeCompare(t.name.lastName);return 0==n?e.name.firstName.localeCompare(t.name.firstName):n},n=this.state,r=n.submissions,s=n.assignments,i=r.filter((function(e){return"TURNED_IN"===e.state||"RETURNED"===e.state})).sort(t),l=r.filter((function(e){return!("TURNED_IN"===e.state||"RETURNED"===e.state)})).sort(t);return a.createElement(a.Fragment,null," ",i.length>0&&a.createElement(a.Fragment,null,a.createElement("p",null,"Inlämnade uppgifter:"),a.createElement("table",{className:"task-assignments-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Elev"),a.createElement("th",null,"Inlämingsdatum"),a.createElement("th",null,"Inlämning"),a.createElement("th",{className:"actions"},a.createElement("i",{className:"fas fa-cogs"})))),a.createElement("tbody",null,i.map((function(t,n){return a.createElement(G,{key:n,submission:t,files:s.filter((function(e){return e.submissionId===t.id})),hasTemplate:e.props.hasTemplate,sendToKedbackend:e.props.sendToKedbackend,sendToUrkund:e.props.sendToUrkund,courseId:e.props.courseId,taskId:e.props.taskId})}))))),l.length>0&&a.createElement(a.Fragment,null,a.createElement("p",null,"Ej inlämnade:"),a.createElement("table",{className:"task-assignments-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Elev"),a.createElement("th",null,"Status"),a.createElement("th",null,"Inlämning"),a.createElement("th",{className:"actions"},a.createElement("i",{className:"fas fa-cogs"})))),a.createElement("tbody",null,l.map((function(t,n){return a.createElement(G,{key:n,submission:t,files:s.filter((function(e){return e.submissionId===t.id})),hasTemplate:e.props.hasTemplate,sendToKedbackend:e.props.sendToKedbackend,sendToUrkund:!1})}))))))},t}(a.Component),G=function(e){function t(t){var n=e.call(this,t)||this;return n.classroom=new _,n.state={files:n.props.files,submission:n.props.submission,loading:!1,loadingMessage:"Laddar inlämning..."},n}return Object(r.c)(t,e),t.prototype.transformUrl=function(e){var t=e.split("/");return t.splice(3,1,"u","0","g","tg"),t[8]=t[9]+"?authuser=0#u="+t[12],t.slice(0,9).join("/")},t.prototype.sendToKedbackend=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return this.setState({loading:!0,loadingMessage:"Skickar filer..."}),[4,this.props.sendToKedbackend(e)];case 1:return n.sent(),[4,U.b.kedBackendClient.http.get("assignments/"+U.b.currentUser.school+"/"+this.props.courseId+"/"+this.props.taskId+"/"+e.userEmail).then((function(e){return e.ok?e.json():[]})).then((function(t){return t.map((function(t){return t.metadata&&t.metadata.driveFileId&&e.assignmentSubmission.attachments?(e.assignmentSubmission.attachments.forEach((function(n){n.driveFile.id==t.metadata.driveFileId&&(t.submissionId=e.id)})),t):t}))}))];case 2:return t=n.sent(),this.setState({loading:!1,files:t}),[2]}}))}))},t.prototype.refreshAssignment=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,a,s,i;return Object(r.d)(this,(function(r){switch(r.label){case 0:return this.setState({loading:!0,loadingMessage:"Väntar på svar..."}),[4,U.b.kedBackendClient.http.get("assignments/urkund/"+U.b.currentUser.school+"/"+this.props.courseId+"/"+this.props.taskId+"/"+e.user+"/"+e.filename)];case 1:return(t=r.sent()).status>=400?(n=C.c.bind,a=[void 0,t.status],[4,t.text()]):[3,3];case 2:throw new(n.apply(C.c,a.concat([r.sent()])));case 3:return[4,t.text()];case 4:return s=r.sent(),i=this.state.files.map((function(t){return t.metadata.driveFileId==e.metadata.driveFileId&&(t.metadata.urkundResponse=s),t})),this.setState({loading:!1,files:i}),[2]}}))}))},t.prototype.returnSubmission=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return this.setState({loading:!0,loadingMessage:"Returnerar inlämning..."}),[4,this.classroom.returnSubmission(e)];case 1:return t.sent(),this.setState({loading:!1,submission:Object(r.a)(Object(r.a)({},e),{state:"RETURNED"})}),[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props,n=t.hasTemplate,r=t.sendToUrkund;if(this.state.loading)return a.createElement("tr",null,a.createElement("td",{colSpan:4},this.state.loadingMessage));var s=this.state,i=s.files,l=s.submission,o=l.assignmentSubmission.attachments?l.assignmentSubmission.attachments[0].driveFile:void 0,c=l.name,u=l.state,d=l.userEmail,m=l.late,p=l.updateTime,h="TURNED_IN"==u,f="RETURNED"==u,b=h?this.transformUrl(l.alternateLink):"";o&&n&&""!==b&&(o.alternateLink=b);var v=o?n?l.assignmentSubmission.attachments.slice(1):l.assignmentSubmission.attachments:[],g=r&&o&&(0==i.length||0==i.filter((function(e){return e.metadata.driveFileId==o.id})).length);return a.createElement("tr",{className:m&&h?"late":void 0},a.createElement("td",null,a.createElement("a",{href:"mailto:"+d},c.firstName," ",c.lastName)),a.createElement("td",null,h||f?new Date(p).toLocaleString().split(" ").join(" kl. "):B[u],f?" (återlämnad)":""),a.createElement("td",null,o&&(h||f)?[!n&&v.length>1&&a.createElement("p",null,a.createElement(x.a,{label:"Bedöm i Classroom",url:b,faIcon:"fas fa-highlighter"})),(n||!n&&1==v.length)&&a.createElement(Y,{key:0,file:o,data:i.find((function(e){return e.metadata.driveFileId===o.id})),refreshAssignment:this.refreshAssignment.bind(this)}),!n&&v.length>1||n&&v.length?a.createElement(A.a,{key:1,title:"Bifogade filer ("+v.length+")"},v.map((function(t,n){return a.createElement(Y,{key:n,file:t.driveFile,data:i.find((function(e){return e.metadata.driveFileId===t.driveFile.id})),refreshAssignment:e.refreshAssignment.bind(e)})}))):void 0]:o&&[n&&a.createElement(P.a,{key:0,thumbnail:o.thumbnailUrl,url:o.alternateLink,title:o.title}),v.length?a.createElement(A.a,{key:1,title:"Bifogade filer ("+v.length+")"},v.map((function(e,t){i.find((function(t){return t.metadata.driveFileId===e.driveFile.id}));return a.createElement(P.a,{key:t,thumbnail:e.driveFile.thumbnailUrl,url:e.driveFile.alternateLink,title:e.driveFile.title})}))):void 0]),a.createElement("td",{className:"actions"},g&&a.createElement(x.a,{label:"Skicka till Urkund",action:function(){console.table(l),e.sendToKedbackend(l)}}),h&&a.createElement(x.a,{label:"Återlämna",action:function(){e.returnSubmission(l),console.log("return submission")}})))},t}(a.Component),Y=function(e){var t=e.file,n=e.data,r=e.refreshAssignment,s=!!n&&n.metadata.urkundExternalId,i=!(!n||!n.metadata.urkundResponse)&&JSON.parse(n.metadata.urkundResponse)[0];return a.createElement("div",{className:"stats-view"},a.createElement(P.a,{thumbnail:t.thumbnailUrl,url:t.alternateLink,title:t.title}),a.createElement("div",{className:"urkund-stats urkund-status-col"},i?a.createElement(a.Fragment,null,a.createElement("p",null,"Urkund"),a.createElement("a",{href:i.Report&&i.Report.ReportUrl,onClick:function(e){-1!==["Accepted","Submitted"].indexOf(i.Status.State)&&(e.preventDefault(),e.stopPropagation(),r(n))},target:"_blank",title:Object(H.a)(i)},a.createElement("div",{className:Object(H.c)(i)})),a.createElement("div",{className:Object(H.b)(i)},i.Report&&"number"==typeof i.Report.Significance?i.Report.Significance.toFixed()+"%":" ")):s?a.createElement(a.Fragment,null,a.createElement("p",null,"Urkund"),a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),e.stopPropagation(),r(n)},target:"_blank",title:"Filen är uppladdad till Urkund. Klicka för att uppdatera status."},a.createElement("div",{className:"urkund-status urkund-status-submitted"}))):a.createElement("p",null,"Ej skickad till Urkund")))},V=function(e){function t(t){var n=e.call(this,t)||this;return n.drive=new M.a,n.classroom=new _,n.state={assignment:null,assignments:null,loading:!0,loadingMessage:"Laddar inlämning..."},n}return Object(r.c)(t,e),t.prototype.setStatePromised=function(t){var n=this;return new Promise((function(r){return e.prototype.setState.call(n,t,r)}))},t.prototype.componentDidMount=function(){this.load()},t.prototype.componentWillReceiveProps=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t;return Object(r.d)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e.task.id===this.props.task.id&&e.course.id===this.props.course.id?[3,3]:[4,this.setStatePromised((function(){return{assignment:null,loading:!0}}))];case 1:return n.sent(),[4,this.load()];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:return t=n.sent(),Object(s.n)(t),[3,5];case 5:return[2]}}))}))},t.prototype.update=function(e,t){return Object(r.h)([t],e.filter((function(e){var n=e.user,r=e.filename;return n!==t.user||r!==t.filename})))},t.prototype.load=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,a,s,i,l,o,c,u,d,m,p=this;return Object(r.d)(this,(function(h){switch(h.label){case 0:return h.trys.push([0,5,,6]),e=this.props.task,t=e.id,n=e.templateFile,a=this.props.course,s=a.id,i=a.school,l=Object(w.e)(U.a.currentUser,i),[4,this.classroom.getSubmissions(s,t,l,!!n)];case 1:return o=h.sent(),c=o.submissions,u=[],[4,(l?U.a.kedBackendClient.http.get("assignments/"+i+"/"+s+"/"+t):U.a.kedBackendClient.http.get("assignments/"+i+"/"+s+"/"+t+"/"+U.a.currentUser.mail)).then((function(e){return e.ok?e.json():[]})).then((function(e){return e.map((function(e){var t,n;if(!e.metadata||!e.metadata.driveFileId)return e;var a=!!e.metadata.urkundResponse&&JSON.parse(e.metadata.urkundResponse);e.metadata.urkundUploadError||e.metadata.urkundLastPoll&&!(a&&a[0].Status.State&&["Accepted","Submitted"].indexOf(a[0].Status.State)>=0&&parseInt(e.metadata.urkundLastPoll)<R()().add(-15,"seconds").toDate().getTime())||u.push(e);var s=c.filter((function(t){return t.userEmail==e.user})),i=function(t){if(!t.assignmentSubmission.attachments)return"continue";t.assignmentSubmission.attachments.forEach((function(n){n.driveFile.id==e.metadata.driveFileId&&(e.inClassroom=!0,e.submissionId=t.id)}))};try{for(var l=Object(r.j)(s),o=l.next();!o.done;o=l.next()){i(o.value)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return e}))}))];case 2:return d=h.sent(),o.submissions=c,this.setState({error:null,loading:!1,assignments:d,assignment:o}),l?[4,Promise.all(u.map((function(e){return Object(r.b)(p,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.refreshAssignment(e)];case 1:return[2,t.sent()]}}))}))})))]:[3,4];case 3:h.sent(),h.label=4;case 4:return[3,6];case 5:return m=h.sent(),this.setState({loading:!1,error:"Kunde inte ladda inlämningsuppgifter",assignment:null}),console.error(m),[3,6];case 6:return[2]}}))}))},t.prototype.verifyAndUpload=function(e,t,n,a){return Object(r.b)(this,void 0,void 0,(function(){var s;return Object(r.d)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),e?[4,this.upload(e,t,n,a)]:[2];case 1:return r.sent(),[4,this.load()];case 2:return r.sent(),[3,4];case 3:return s=r.sent(),console.error(s),[3,4];case 4:return[2]}}))}))},t.prototype.upload=function(e,t,n,a){return Object(r.b)(this,void 0,void 0,(function(){var s,i,l,o,c,u,d,m,p,h,f;return Object(r.d)(this,(function(b){switch(b.label){case 0:return s=this.props.task,i=s.id,l=s.sendToUrkund,o=this.props.course,c=o.id,u=o.school,(d=new FormData).append("files",e),m={userDisplayName:a,verifyWithUrkund:void 0===l||l},t&&(m=Object(r.a)(Object(r.a)({},m),{driveFileId:t.fileId,driveFileUrl:t.url,driveFileIconUrl:t.iconUrl})),[4,U.a.kedBackendClient.http.fetch("assignments/"+u+"/"+c+"/"+i+"/"+n,"put",{},m,{body:d})];case 1:return 200===(p=b.sent()).status?[3,3]:(h=C.c.bind,f=[void 0,p.status],[4,p.text()]);case 2:throw new(h.apply(C.c,f.concat([b.sent()])));case 3:return[2]}}))}))},t.prototype.reclaimSubmission=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return confirm("Är du säker på att du vill återta uppgiften?")?(this.setState({loading:!0,loadingMessage:"Återtar inlämning..."}),[4,this.classroom.reclaimSubmission(e)]):[2];case 1:return t.sent(),[4,this.load()];case 2:return t.sent(),[2]}}))}))},t.prototype.handInSubmission=function(e,t){return void 0===t&&(t=!1),Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(n){switch(n.label){case 0:return confirm("Är du säker på att du vill lämna in?")?(this.setState({loading:!0,loadingMessage:"Lämnar in uppgiften..."}),this.props.task.sendToUrkund&&this.sendSubmissionToKedBackend(e,U.a.currentUser.displayName),t?[3,2]:[4,this.classroom.handInSubmission(e)]):[2];case 1:n.sent(),n.label=2;case 2:return[4,this.load()];case 3:return n.sent(),[2]}}))}))},t.prototype.sendSubmissionToKedBackend=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n,a,s,i=this;return Object(r.d)(this,(function(l){switch(l.label){case 0:return n=e.assignmentSubmission.attachments.map((function(e){return e.driveFile})),[4,Promise.all(n.map((function(e){return Object(r.b)(i,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return[4,this.drive.getFile(e.id)];case 1:return[2,t.sent()]}}))}))})))];case 1:return a=l.sent(),[4,Promise.all(a.map((function(e){return Object(r.b)(i,void 0,void 0,(function(){var t,n;return Object(r.d)(this,(function(a){switch(a.label){case 0:return t=Object(r.a)(Object(r.a)({},e),{canExport:e.mimeType.includes("google-apps")}),[4,this.drive.downloadFile({file:t,mimeType:"text/plain"})];case 1:return n=a.sent(),[2,{file:t,data:n}]}}))}))})))];case 2:return s=l.sent(),[4,Promise.all(s.map((function(n){return Object(r.b)(i,void 0,void 0,(function(){return Object(r.d)(this,(function(r){switch(r.label){case 0:return[4,this.verifyAndUpload(n.data,n.file,e.userEmail,t)];case 1:return r.sent(),[2]}}))}))})))];case 3:return l.sent(),[2]}}))}))},t.prototype.addFilesToSubmission=function(e,t){return Object(r.b)(this,void 0,void 0,(function(){var n;return Object(r.d)(this,(function(r){switch(r.label){case 0:this.setState({loading:!0,loadingMessage:"Uppdaterar inlämning med nya filer..."}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.classroom.addFilesToSubmission(e.courseId,e.courseWorkId,e.id,t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.log(n),Object(s.n)("Du försökte lämna in en fil som du inte äger."),[3,4];case 4:return[4,this.load()];case 5:return r.sent(),[2]}}))}))},t.prototype.refreshAssignment=function(e){return Object(r.b)(this,void 0,void 0,(function(){var t,n,a,s,i,l,o,c,u,d,m,p,h=this;return Object(r.d)(this,(function(f){switch(f.label){case 0:return t=U.a.kedBackendClient.http,n=this.props.course,a=n.id,s=n.school,i=this.props.task.id,l=e.user,o=e.filename,[4,this.setState((function(t){var n=t.assignments;return{assignments:h.update(n,Object(r.a)(Object(r.a)({},e),{isRefreshing:!0}))}}))];case 1:f.sent(),f.label=2;case 2:return f.trys.push([2,8,,10]),[4,t.get("assignments/urkund/"+s+"/"+a+"/"+i+"/"+l+"/"+o)];case 3:return(c=f.sent()).status>=400?(u=C.c.bind,d=[void 0,c.status],[4,c.text()]):[3,5];case 4:throw new(u.apply(C.c,d.concat([f.sent()])));case 5:return[4,c.text()];case 6:return m=f.sent(),[4,this.setState((function(t){var n=t.assignments;return{assignments:h.update(n,Object(r.a)(Object(r.a)({},e),{isRefreshing:!1,metadata:Object(r.a)(Object(r.a)({},e.metadata),{urkundResponse:m})}))}}))];case 7:return f.sent(),[3,10];case 8:return p=f.sent(),[4,this.setState((function(t){var n=t.assignments;return{assignments:h.update(n,Object(r.a)(Object(r.a)({},e),{isRefreshing:!1,refreshError:p}))}}))];case 9:return f.sent(),[3,10];case 10:return[2]}}))}))},t.prototype.teacherView=function(){var e=this.state,t=e.assignment,n=e.assignments,r=this.props.task,s=r.sendToUrkund,i=r.templateFile;return a.createElement(a.Fragment,null,a.createElement("p",null,"Här kan du som lärare se inlämnade arbeten"),a.createElement(z,{sendToKedbackend:this.sendSubmissionToKedBackend.bind(this),assignments:n||[],submissions:t?t.submissions:[],hasTemplate:!!i,sendToUrkund:s,courseId:this.props.course.id,taskId:this.props.task.id}))},t.prototype.studentView=function(){var e=this,t=this.props.task,n=t.sendToUrkund,r=t.additionalUploads,s=t.templateFile,i=this.state,l=i.assignment,o=i.assignments,c=i.error;if(null==l||null==l.submissions||0==l.submissions.length)return a.createElement("p",null,"Uppgift inte skapad i Classroom ännu. Prova igen om några minuter.");var u=l?l.submissions[0]:null,d=!!s,m=u&&u.assignmentSubmission.attachments&&u.assignmentSubmission.attachments.length>0,p=u&&"TURNED_IN"==u.state,h=u&&"RETURNED"==u.state,f=!(!p||!m)&&!!o.find((function(e){return e.submissionId==u.id}));return a.createElement(a.Fragment,null,p?!n||f&&n?a.createElement("p",null,"Uppgiften är inlämnad."):a.createElement("p",null,"Uppgiften är inlämnad men måste även skickas till Urkund"):h?a.createElement("p",null,"Uppgiften är återlämnad av din lärare."):a.createElement("p",null,"Uppgiften är inte inlämnad",u&&"RECLAIMED_BY_STUDENT"==u.state?" (återtagen)":void 0,"."),d?a.createElement(a.Fragment,null,a.createElement("p",null,"Dokumentet nedan ska användas till inlämningen."),a.createElement(P.a,{size:"large",thumbnail:l.templateThumbnail,url:l.templateFile,label:l.templateTitle,title:l.templateTitle})):void 0,a.createElement(a.Fragment,null,a.createElement("div",{className:"btn-group"},d||m?p?a.createElement(x.a,{action:function(){return e.reclaimSubmission(u)},faIcon:"fas fa-thumbs-down",label:"Återta"}):a.createElement(x.a,{addClass:"red",action:function(){return e.handInSubmission(u)},faIcon:"fas fa-thumbs-up",label:"Lämna in"}):void 0,p&&!f&&n&&a.createElement(x.a,{action:function(){return e.handInSubmission(u,!0)},label:"Skicka till urkund"}),(!d||r)&&!p&&a.createElement(x.b,{label:r?"Bifoga filer":"Välj filer",action:function(){var t=new L.a({upload:!0,multiple:!0,onlyMine:!0});t.show().then((function(n){e.addFilesToSubmission(u,n),t.close()}))}})),n&&a.createElement("p",null,"Uppgiften ",r?"och alla bifagde filer ":"","skickas till Urkund."),(r&&u.assignmentSubmission.attachments.length>1||!d&&m)&&a.createElement(a.Fragment,null,a.createElement("table",{className:"task-assignments-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Bifogade filer"))),a.createElement("tbody",null,u.assignmentSubmission.attachments.map((function(e,t){if(!d||0!=t)return a.createElement("tr",{key:t},a.createElement("td",null,a.createElement(P.a,{size:"small",label:e.driveFile.title,title:e.driveFile.title,thumbnail:e.driveFile.thumbnailUrl,url:e.driveFile.alternateLink})))})))),a.createElement("p",null,a.createElement("em",null,"De bifogade filerna lämnas in samtidigt som uppgiften lämnas in. För att ta bort bifogade filer måste du gå via ",a.createElement("a",{href:u.alternateLink,target:"_blank"},"Classroom"),". Obs! Ta inte bort själva uppgiftsfilen.")))),c&&a.createElement("p",{className:"error"},c))},t.prototype.render=function(){return this.state.loading?a.createElement(o.b,{label:this.state.loadingMessage}):Object(w.e)(U.a.currentUser,this.props.course.school)?this.teacherView():this.studentView()},t}(a.Component),q=function(e){function t(t){var n=e.call(this,t)||this;return n.state={userTask:void 0,weekPlannerWeek:R()().week()},n.onUserTasksChanged=n.onUserTasksChanged.bind(n),n}return Object(r.c)(t,e),t.prototype.componentDidMount=function(){T.b.subscribe(this.onUserTasksChanged)},t.prototype.componentWillUnmount=function(){T.b.unsubscribe(this.onUserTasksChanged)},t.prototype.componentWillReceiveProps=function(e){if(e.task.id!==this.props.task.id){var t=T.b.mem.items.find((function(t){return t.task&&t.task.length>0&&t.task[0].id===e.task.id}))||null;this.setState({userTask:t,weekPlannerWeek:R()(T.b.persistedState.weekDate).week()})}},t.prototype.onUserTasksChanged=function(e){var t=this,n=e.find((function(e){return e.task&&e.task.length>0&&e.task[0].id===t.props.task.id}))||null;this.setState({userTask:n,weekPlannerWeek:R()(T.b.persistedState.weekDate).week()})},t.prototype.toggleTask=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,a,s,i,l,o;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e=T.b.persistedState.weekDate,t=this.state.userTask,n=this.props,a=n.course,s=n.task,(i=a.modules.find((function(e){return e.taskIds.some((function(e){return e===s.id}))})))?void 0===t?[2]:t?[3,2]:(l=Math.max.apply(Math.max,[e].concat(T.b.mem.items.map((function(e){return e.dateTime})))),o={id:Object(C.i)(),courseName:a.name,dateTime:l+2e3,learningGoal:s.learningGoal||i.name,name:s.name,url:s.url,task:[s],course:[a],acl:[new C.b("email",U.a.currentUser.mail,"S")].map((function(e){return e.toString()}))},s.deadline&&(o.deadline=s.deadline),[4,Promise.all([T.b.setWeekPlannerBoxOpen(this.props.course.name,!0),T.b.insert([o])])]):[2];case 1:return r.sent(),[3,4];case 2:return[4,T.b.delete([t.id])];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},t.prototype.render=function(){var e=this,t=this.props,n=t.task,i=t.course,l=this.state,o=l.userTask,c=l.weekPlannerWeek,p=n.abilities.map((function(e){return i.abilities.find((function(t){return t.id===e.id}))})).filter((function(e){return!!e})),h=n.centralContent.map((function(e){return i.centralContent.find((function(t){return t.id==e.id}))})).filter((function(e){return!!e})),f=n.knowledgeRequirements.map((function(e){return i.knowledgeRequirements.find((function(t){return t.id===e.id}))})).filter((function(e){return!!e})),b=o&&("adding"===o.$meta||"deleting"===o.$meta),v=R()().week(),g=c===v?"loggboken":c===v+1?Object(s.a)(O||(O=Object(r.e)(["vald vecka (nästa vecka)"],["vald vecka (nästa vecka)"]))):c===v-1?Object(s.a)(j||(j=Object(r.e)(["vald vecka (förra veckan)"],["vald vecka (förra veckan)"]))):Object(s.a)(y||(y=Object(r.e)(["vald vecka (v ",")"],["vald vecka (v ",")"])),c),k=n.deadline&&R()(n.deadline).endOf("day")<R()();return i.googleCreateClassrooms&&n.templateFile&&n.templateFile.mimeType.includes("google-apps"),a.createElement(a.Fragment,null,a.createElement("h1",null,n.name),n.content&&a.createElement(a.Fragment,null,a.createElement("div",{dangerouslySetInnerHTML:{__html:n.content}})),n.learningGoal&&a.createElement("div",null,a.createElement("h2",null,"Uppgiftens lärandemål"),a.createElement("p",null,n.learningGoal)),n.url&&a.createElement("a",{href:n.url,className:"btn btn-large"},"Gå till uppgiften"),a.createElement("br",null),n.assignment&&a.createElement("div",{className:"card"+(k?" warning":"")},a.createElement("div",{className:"card-icon"},a.createElement("i",{className:"fas fa-file-alt"}),a.createElement("p",{className:"card-icon-info"},n.deadline?n.deadline:"Ingen deadline")),a.createElement("h2",null,"Inlämningsuppgift"),i.googleCreateClassrooms?a.createElement(a.Fragment,null,a.createElement(V,{course:i,task:n})):a.createElement(a.Fragment,null,Object(w.e)(U.a.currentUser,i.school)?a.createElement("p",null,"Här kan du som lärare se elevernas inlämnade arbeten."):n.templateFile?a.createElement(a.Fragment,null,a.createElement("p",null,"Till den här uppgiften ska du anvädna följande mall:"),a.createElement(P.a,{thumbnail:n.templateFile.iconUrl,title:n.templateFile.name,url:n.templateFile.url.substr(0,n.templateFile.url.lastIndexOf("/"))+"/copy"})):a.createElement(a.Fragment,null,a.createElement("p",null,"Det här är en inlämningsuppgift. Lämna in ditt arbete som en pdf, doc eller odt fil genom att dra det till fältet under. Du kan även ladda up en fil eller välja en fil från din Google Drive."),n.deadline?a.createElement("p",null,a.createElement("b",null,"Den här uppgiften ",k?"skulle ha lämnats in ":"ska vara inlämnad ",R()(n.deadline).format("YYYY-MM-DD"))):void 0),a.createElement(W.a,{courseId:i.id,taskId:n.id,school:i.school,sendToUrkund:void 0===n.sendToUrkund||n.sendToUrkund,courseStudyGroups:i.studyGroups,taskDeadline:n.deadline}),a.createElement("br",null))),p.length>0&&a.createElement(d.a,{title:"Den här uppgiften behandlar följande förmågor",className:"larger",headerOpen:!1,abilities:p}),h.length>0&&a.createElement(m.a,{title:"Den här uppgiften behandlar följande centrala innehåll",className:"larger",headerOpen:!1,centralContent:h}),f.length>0&&a.createElement(u.a,{title:"I den här uppgiften bedöms följande kunskapskrav",className:"larger",headerOpen:!1,requirements:f}),a.createElement("hr",null),void 0!==o&&a.createElement("div",{className:"taskContainer",style:b?{opacity:.5}:{}},a.createElement(D.a,{state:o&&"deleting"!==o.$meta?"checked":"",label:o?Object(s.a)(N||(N=Object(r.e)(["Ta bort uppgiften från ",""],["Ta bort uppgiften från ",""])),g):Object(s.a)(I||(I=Object(r.e)(["Lägg till uppgiften i ",""],["Lägg till uppgiften i ",""])),g),onChange:function(){return!b&&e.toggleTask()}})),a.createElement("hr",null),n.resources&&n.resources.length>0&&a.createElement(a.Fragment,null,a.createElement("h2",null,"Resurser kopplade till uppgiften"),a.createElement("div",{className:"taskContainer"},n.resources.map((function(e,t){return a.createElement("div",{key:t,className:"align-horizontal"},a.createElement("div",{className:"horizontalItem top"},a.createElement("a",{href:e.url},e.name)))}))),a.createElement("br",null)),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null),a.createElement("br",null))},t}(a.Component),J=n(136);E||(E=!0,document.documentElement.addEventListener("click",(function(e){var t=e.target;t&&"A"===t.tagName&&history.replaceState({pageYOffset:window.pageYOffset},null,null)})),history.scrollRestoration&&(history.scrollRestoration="manual"));var $,Q,X=function(e){function t(t){var n=e.call(this,t)||this;n.onHashChange=n.onHashChange.bind(n);var r=n.getModuleAndTaskFromHash(),a=r.module,s=r.task;return n.state={module:a,task:s},n}return Object(r.c)(t,e),t.prototype.getModuleAndTaskFromHash=function(){var e=(location.hash.substr(1)||"").split("/");e.length>0&&!e[0]&&(e=e.slice(1));var t=Object(r.f)(e.map((function(e){return decodeURIComponent(e)})),2),n=t[0],a=t[1],s=this.props.course.modules.filter((function(e){return(e.name||"").trim().toLowerCase()===(n||"").trim().toLowerCase()}))[0]||null,i=a&&this.props.course.tasks.find((function(e){return e.id===a}))||null;return i&&!s&&(s=this.getOrderedModules().filter((function(e){return e.taskIds.some((function(e){return i.id===e}))}))[0]),i&&s&&(i=f(s,i)),{module:s,task:i}},t.prototype.componentDidMount=function(){window.addEventListener("hashchange",this.onHashChange)},t.prototype.componentWillUnmount=function(){window.removeEventListener("hashchange",this.onHashChange)},t.prototype.onHashChange=function(){var e=this.getModuleAndTaskFromHash(),t=e.module,n=e.task;this.setState({module:t,task:n},(function(){var e=void 0;if(n){var t=document.getElementById("ked-task-anchor");e=t?window.pageYOffset+t.getBoundingClientRect().top:0}!function(e){var t=e.fallbackScrollPosition;history.state&&void 0!==history.state.pageYOffset?window.scrollTo(0,history.state.pageYOffset):void 0!==t&&window.scrollTo(0,t)}({fallbackScrollPosition:e})}))},t.prototype.getOrderedModules=function(){var e=this.props.course,t=e.moduleOrder||e.modules.map((function(e){return e.id}));return t.map((function(t){return e.modules.find((function(e){return e.id===t&&!e.inactive}))})).filter((function(e){return!!e})).concat(e.modules.filter((function(e){return!t.find((function(t){return e.id===t}))})))},t.prototype.render=function(){var e=this.props,t=e.course,n=e.courseBuilderUrl,r=this.state,s=r.module,i=r.task,l=this.getOrderedModules();return a.createElement("div",null,a.createElement(c,{title:t.name+" - "+t.points+"p",backgroundImage:(t.images.find((function(e){return e.id===t.imageId}))||{url:""}).url,tabs:[{name:"Upptakt",link:"#",key:"Upptakt"}].concat(l.map((function(e){var t=e.name;return{name:t,link:"#"+encodeURIComponent(t),key:t}}))).concat(t.workFlowLink?[{name:"Arbetsgång",key:"workflow",link:t.workFlowLink}]:[]).concat(Object(w.c)(U.a.currentUser,t)?[{name:a.createElement("span",null,a.createElement("i",{className:"fas fa-pencil-alt","aria-hidden":"true"})," Redigera denna kurs"),key:"edit",link:Object(w.f)(n,{})+"#/courses/"+t.id+"/edit"}]:[]),activeTab:s?"#"+encodeURIComponent(s.name):"#"}),a.createElement("div",{className:"sv-row sv-layout"},a.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},a.createElement("div",{className:"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer"},a.createElement("div",{className:"pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer"},a.createElement("div",{className:"sv-row sv-layout sv-skip-spacer"},a.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-7"},a.createElement(J.a,null),i?a.createElement(q,{task:i,course:t}):s?a.createElement(b,{course:t,module:s}):a.createElement(g,{course:t})),a.createElement("div",{className:"sv-layout sv-column-5"},a.createElement("div",{className:"sv-vertical sv-layout sv-skip-spacer"},a.createElement("div",{className:"sv-html-portlet sv-portlet sv-skip-spacer"},a.createElement(S.a,{viewCourseUrl:"",env:U.a}))))))))))},t}(a.Component),Z=n(8),ee=n(1),te=n(188),ne=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isLoading:!0,courses:[],headerOpen:!1},n.updateHiddenCourses=n.updateHiddenCourses.bind(n),n}return Object(r.c)(t,e),t.prototype.componentWillMount=function(){te.a.subscribe(this.updateHiddenCourses,{fullCourse:!0})},t.prototype.componentWillUnmount=function(){te.a.unsubscribe(this.updateHiddenCourses)},t.prototype.updateHiddenCourses=function(e){this.setState({courses:e,isLoading:!1})},t.prototype.hideCourse=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return Object(s.o)(Object(s.a)($||($=Object(r.e)(["Sparar..."],["Sparar..."])))),[4,te.a.hideCourse(e)];case 1:return t.sent(),Object(s.o)(""),[2]}}))}))},t.prototype.showCourse=function(e){return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(t){switch(t.label){case 0:return Object(s.o)(Object(s.a)(Q||(Q=Object(r.e)(["Sparar..."],["Sparar..."])))),[4,te.a.showCourse(e)];case 1:return t.sent(),Object(s.o)(""),[2]}}))}))},t.prototype.render=function(){var e=this;if(this.state.isLoading)return a.createElement(o.b,null);var t=this.state.courses,n=t.filter((function(e){return e.visible})),s=t.filter((function(e){return!e.visible})),i=Object(Z.b)(location.search),l=ee.b.KED_COURSE_VIEWER_URL;return a.createElement("div",{className:"ked_boxed"},a.createElement("h3",null,"Skolans kurser"),a.createElement("div",{className:"taskContainer odd-even"},n.map((function(t){return a.createElement("div",{className:"studentCourse",key:t.id},a.createElement("div",{className:"align-horizontal"},a.createElement("div",{className:"horizontalItem top pull-right"},a.createElement("a",{className:"hideItem",onClick:function(){return e.hideCourse(t)}})),a.createElement("div",{className:"horizontalItem top"},a.createElement("a",{href:Object(w.f)(l,{courseId:t.id})},t.name))),a.createElement("div",{className:"horizontalItem top"},a.createElement("p",{className:"small"},t.description)))}))),a.createElement("div",{className:"openClose"+(this.state.headerOpen?" open":"")},a.createElement("div",{className:"openHeader",onClick:function(){return e.setState({headerOpen:!e.state.headerOpen})}},a.createElement("h5",null,"Dolda kurser")),a.createElement("div",{className:"openContent"},a.createElement("div",{className:"taskContainer odd-even"},s.map((function(t){return a.createElement("div",{className:"studentCourse",key:t.id},a.createElement("div",{className:"align-horizontal"},a.createElement("div",{className:"horizontalItem top pull-right"},a.createElement("a",{className:"showItem",onClick:function(){return e.showCourse(t)}})),a.createElement("a",{href:Object(Z.a)(Object(r.a)(Object(r.a)({},i),{courseId:t.id}))},t.name)),a.createElement("div",{className:"horizontalItem top"},a.createElement("p",{className:"small"},t.description)))}))))))},t}(a.Component);function re(){return a.createElement("div",{className:"sv-html-portlet sv-portlet"},a.createElement(c,{title:U.a.currentUser.school,backgroundImage:"",tabs:[{name:"Skolans kurser",link:"#"}],activeTab:"#"}),a.createElement("div",{className:"sv-row sv-layout"},a.createElement("div",{className:"sv-layout sv-skip-spacer sv-column-12"},a.createElement("div",{className:"sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer"},a.createElement(ne,null)))))}n.d(t,"CourseViewer",(function(){return ae}));var ae=function(e){function t(t){var n=e.call(this,t)||this;return n.state={course:null,isLoading:!0},n}return Object(r.c)(t,e),t.prototype.componentWillMount=function(){var e=this;this.load().catch(s.n).then((function(){return e.setState({isLoading:!1})}))},t.prototype.load=function(){return Object(r.b)(this,void 0,void 0,(function(){var e,t,n,a,s,i,o,c,u,d;return Object(r.d)(this,(function(r){switch(r.label){case 0:return e=Object(Z.b)(location.search),t=e.courseId,n=e.taskId,a=e.module,n&&a&&(s=encodeURIComponent(a),i=encodeURIComponent(n),o=location.protocol+"//"+location.host+location.pathname+"#"+s+"/"+i,c=Object(w.f)(o,{courseId:t}),location.replace(c)),t?[4,Object(l.f)(t)]:[3,2];case 1:return d=r.sent(),[3,3];case 2:d=null,r.label=3;case 3:return u=d,this.setState({course:u}),document.title=u?u.name+" - "+u.points+"p":"Kurser",[2]}}))}))},t.prototype.render=function(){return a.createElement("div",{className:"course-viewer"},this.state.isLoading?a.createElement(o.b,null):this.state.course?a.createElement(X,{course:this.state.course,courseBuilderUrl:this.props.courseBuilderUrl}):a.createElement(re,null),a.createElement(i.a,null))},t}(a.Component)}}]);
//# sourceMappingURL=CourseViewer.min.js.map