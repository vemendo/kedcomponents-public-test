{"version":3,"file":"KSGoals.js","sources":["webpack://[name]/./src/components/ks-goals/future-abilities-table.tsx","webpack://[name]/./src/components/ks-goals/future-abilities-viewmodel.ts","webpack://[name]/./src/components/ks-goals/goals-viewmodel.ts","webpack://[name]/./src/components/ks-goals/goals.tsx"],"sourcesContent":["import { __awaiter, __extends, __generator } from \"tslib\";\nimport * as React from 'react';\nimport env from '../../globals/KED.env';\nimport { FutureAbilitiesViewModel } from './future-abilities-viewmodel';\nvar FutureAbilitiesTable = /** @class */ (function (_super) {\n    __extends(FutureAbilitiesTable, _super);\n    function FutureAbilitiesTable(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            loading: false,\n            data: [],\n            error: null\n        };\n        return _this;\n    }\n    FutureAbilitiesTable.prototype.componentWillMount = function () {\n        this.load();\n    };\n    FutureAbilitiesTable.prototype.load = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.setState({ loading: true });\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, env.edsClient.getStudentFutureAbilities()];\n                    case 2:\n                        data = _a.sent();\n                        this.setState({ data: data });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_1 = _a.sent();\n                        this.setState({ error: error_1 });\n                        return [3 /*break*/, 4];\n                    case 4:\n                        this.setState({ loading: false });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    FutureAbilitiesTable.prototype.render = function () {\n        var viewModel = new FutureAbilitiesViewModel(this.state.data);\n        var columnHeaders = viewModel.columnHeaders, vtHts = viewModel.vtHts, capabRows = viewModel.capabRows;\n        return React.createElement(\"div\", null,\n            React.createElement(\"h5\", null, \"Framtidsf\\u00F6rm\\u00E5gor\"),\n            React.createElement(\"div\", { className: \"partialEditStudyPlanViewMode\" },\n                React.createElement(\"table\", { style: { width: '100%' }, className: \"smallFont\" },\n                    React.createElement(\"thead\", null,\n                        React.createElement(\"tr\", null, columnHeaders.map(function (_a, i) {\n                            var name = _a.name, type = _a.type;\n                            return type === 'header' ?\n                                React.createElement(\"th\", { key: i, rowSpan: 2 }, name) :\n                                React.createElement(\"th\", { key: i, colSpan: 2 }, name);\n                        })),\n                        React.createElement(\"tr\", { className: \"header\" }, vtHts.map(function (vtHt, i) { return React.createElement(\"th\", { key: i }, vtHt); }))),\n                    React.createElement(\"tbody\", null, capabRows.map(function (row, i) { return React.createElement(\"tr\", { key: i, className: (Math.floor(i / 3) % 2) && 'tableOdd' }, row.map(function (col, i) { return col.type === 'ability' ?\n                        React.createElement(\"td\", { key: i, rowSpan: 3, className: \"goalsSubject\" }, col.name) :\n                        col.type === 'capability' ?\n                            React.createElement(\"td\", { key: i, className: \"goalsSubject\" }, col.name) :\n                            col.selected ?\n                                React.createElement(\"td\", { key: i, className: \"edsSelected\" },\n                                    React.createElement(\"div\", { className: \"markedItem\" })) :\n                                React.createElement(\"td\", { key: i }); })); })))));\n    };\n    return FutureAbilitiesTable;\n}(React.Component));\nexport { FutureAbilitiesTable };\n","import { flatten } from '../../utils/utils';\nvar FutureAbilitiesViewModel = /** @class */ (function () {\n    function FutureAbilitiesViewModel(data) {\n        // Will build the total years\n        var formNames = {};\n        data.forEach(function (a) { return a.capabilities.forEach(function (c) { return formNames[c.formName] = true; }); });\n        var years = Object.keys(formNames);\n        // columnHeaders\n        this.columnHeaders = [{\n                name: \"Framtidsförmåga\",\n                type: \"header\"\n            }, {\n                name: \"Område\",\n                type: \"header\"\n            }].concat(years.map(function (year) { return ({\n            name: year,\n            type: 'year'\n        }); }));\n        // vtHts\n        this.vtHts = flatten(years.map(function (year) { return [\"HT\", \"VT\"]; }));\n        // cababRows\n        var rows = [];\n        data.forEach(function (a) {\n            var row = [{ type: 'ability', name: a.abilityName }];\n            var addedCapabs = {};\n            a.capabilities.forEach(function (c) {\n                var cells = [\n                    { type: 'term', selected: c.htHasValue !== false },\n                    { type: 'term', selected: c.vtHasValue !== false }\n                ];\n                //if (c.htHasValue || c.vtHasValue) debugger;\n                if (!addedCapabs[c.capabilityName]) {\n                    //if (!isFirstCapability) rows.push(row);\n                    if (row.length > 1) {\n                        rows.push(row);\n                        row = [];\n                    }\n                    addedCapabs[c.capabilityName] = true;\n                    row.push({ type: 'capability', name: c.capabilityName });\n                    cells.forEach(function (cell) { return row.push(cell); });\n                }\n                else if (row) {\n                    //addedCapabs[c.capabilityName].concat(cells);\n                    cells.forEach(function (cell) { return row.push(cell); });\n                }\n            });\n            if (row)\n                rows.push(row);\n        });\n        this.capabRows = rows;\n    }\n    return FutureAbilitiesViewModel;\n}());\nexport { FutureAbilitiesViewModel };\n","import { EDSPeriod } from '../../apis/edsclient';\nvar ViewModel = /** @class */ (function () {\n    function ViewModel(studyPlans) {\n        this.subjects = studyPlans.map(function (sp) {\n            var periodGoals = sp.periodGoals\n                .map(function (g) { return ({ period: new EDSPeriod(g.periodName), goal: g.gradeName }); });\n            return {\n                name: sp.courseUnitName,\n                atGoal: periodGoals.filter(function (_a) {\n                    var period = _a.period;\n                    return period.term === 'AT';\n                }).map(function (_a) {\n                    var goal = _a.goal;\n                    return goal;\n                })[0],\n                stGoal: periodGoals.filter(function (_a) {\n                    var period = _a.period;\n                    return period.term === 'ST';\n                }).map(function (_a) {\n                    var goal = _a.goal;\n                    return goal;\n                })[0],\n                finalGoal: sp.finalGoalGrade,\n                strategies: sp.strategyText\n            };\n        });\n    }\n    return ViewModel;\n}());\nexport { ViewModel };\n","import { __awaiter, __extends, __generator, __makeTemplateObject } from \"tslib\";\nimport * as React from 'react';\nimport { L } from '../../utils/utils';\nimport { ViewModel } from './goals-viewmodel';\nimport env from '../../globals/KED.env';\nimport { FutureAbilitiesTable } from './future-abilities-table';\nvar KSGoals = /** @class */ (function (_super) {\n    __extends(KSGoals, _super);\n    function KSGoals(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            loadingStudyPlans: false,\n            studyPlans: [],\n            error: null\n        };\n        return _this;\n    }\n    KSGoals.prototype.componentWillMount = function () {\n        this.load();\n    };\n    KSGoals.prototype.load = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var studyPlans, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.setState({ loadingStudyPlans: true });\n                        _a.label = 1;\n                    case 1:\n                        _a.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, env.edsClient.getStudentGoals()];\n                    case 2:\n                        studyPlans = _a.sent();\n                        this.setState({ studyPlans: studyPlans });\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_1 = _a.sent();\n                        this.setState({ error: error_1 });\n                        return [3 /*break*/, 4];\n                    case 4:\n                        this.setState({ loadingStudyPlans: false });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    KSGoals.prototype.render = function () {\n        var viewModel = new ViewModel(this.state.studyPlans);\n        var showTermGoals = ('' + env.currentUser.schoolType).toLowerCase() !== \"gymnasium\";\n        return React.createElement(\"div\", { className: \"ked_boxed\" },\n            React.createElement(\"h4\", null, L(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"M\\u00E5l\"], [\"M\\u00E5l\"])))),\n            React.createElement(\"hr\", null),\n            React.createElement(\"table\", { className: \"smallFont\" },\n                React.createElement(\"thead\", null,\n                    React.createElement(\"tr\", null,\n                        React.createElement(\"th\", null, L(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\u00C4mne\"], [\"\\u00C4mne\"])))),\n                        showTermGoals && React.createElement(\"th\", null, L(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"HT\"], [\"HT\"])))),\n                        showTermGoals && React.createElement(\"th\", null, L(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"VT\"], [\"VT\"])))),\n                        React.createElement(\"th\", null, L(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"Slutm\\u00E5l\"], [\"Slutm\\u00E5l\"])))),\n                        React.createElement(\"th\", null, L(templateObject_6 || (templateObject_6 = __makeTemplateObject([\"Strategier\"], [\"Strategier\"])))))),\n                React.createElement(\"tbody\", null, viewModel.subjects.map(function (s, i) {\n                    return React.createElement(\"tr\", { key: s.name, className: i % 2 && \"tableOdd\" },\n                        React.createElement(\"td\", { className: \"goalsSubject\" }, s.name),\n                        showTermGoals && React.createElement(\"td\", { className: \"goalsTerm\" }, s.atGoal),\n                        showTermGoals && React.createElement(\"td\", { className: \"goalsTerm\" }, s.stGoal),\n                        React.createElement(\"td\", { className: \"goalsEnd\" }, s.finalGoal),\n                        React.createElement(\"td\", null, s.strategies));\n                }))),\n            React.createElement(\"div\", { className: \"divider\" }),\n            React.createElement(FutureAbilitiesTable, null));\n    };\n    return KSGoals;\n}(React.Component));\nexport { KSGoals };\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6;\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACtEA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrDA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AC7BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;A","sourceRoot":""}