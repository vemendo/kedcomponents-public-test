var kedappcourseviewer =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/ 		var executeModules = data[2];
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 		// add entry modules from loaded chunk to deferred list
/******/ 		deferredModules.push.apply(deferredModules, executeModules || []);
/******/
/******/ 		// run deferred modules when all chunks ready
/******/ 		return checkDeferredModules();
/******/ 	};
/******/ 	function checkDeferredModules() {
/******/ 		var result;
/******/ 		for(var i = 0; i < deferredModules.length; i++) {
/******/ 			var deferredModule = deferredModules[i];
/******/ 			var fulfilled = true;
/******/ 			for(var j = 1; j < deferredModule.length; j++) {
/******/ 				var depId = deferredModule[j];
/******/ 				if(installedChunks[depId] !== 0) fulfilled = false;
/******/ 			}
/******/ 			if(fulfilled) {
/******/ 				deferredModules.splice(i--, 1);
/******/ 				result = __webpack_require__(__webpack_require__.s = deferredModule[0]);
/******/ 			}
/******/ 		}
/******/ 		return result;
/******/ 	}
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"kedappcourseviewer": 0
/******/ 	};
/******/
/******/ 	var deferredModules = [];
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	var jsonpArray = window["webpackJsonp_name_"] = window["webpackJsonp_name_"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// add entry module to deferred list
/******/ 	deferredModules.push(["./src/elements/KEDAppCourseViewer/webpack-entry.ts","vendors"]);
/******/ 	// run deferred modules when ready
/******/ 	return checkDeferredModules();
/******/ })
/************************************************************************/
/******/ ({

/***/ "../kedbackend/KED.Backend.API/schema.json":
/*!*************************************************!*\
  !*** ../kedbackend/KED.Backend.API/schema.json ***!
  \*************************************************/
/*! exports provided: accessClaimDefinitions, realmClaim, specialRoles, defaultAccessClaimTypes, defaultAcl, tables, default */
/***/ (function(module) {

module.exports = {"accessClaimDefinitions":{"email":"{http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress}","role":"{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","school":"{school}","schoolRole":"{school}/{http://schemas.microsoft.com/ws/2008/06/identity/claims/role}","tutorFor":"{tutorFor}"},"realmClaim":"realm","specialRoles":{"userRole":"USER","adminRole":"ADMIN"},"defaultAccessClaimTypes":["role"],"defaultAcl":["role:USER:R"],"tables":{"branches":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"USER":{"email":["*"],"schoolRole":["*"],"role":["*"]}},"relationships":{"parents":"branches","approvedChildren":"branches"}},"global":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courseInstances":"courseInstances"}},"courseInstances":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","blocks":"courseBlocks","tabs":"courseTabs"}},"courseBlocks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","tabs":"courseTabs","tasks":"tasks"}},"courseTabs":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"abilities":"abilities","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","contents":"courseContents"}},"courseContents":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"USER":{"schoolRole":["*"],"role":["*"]}},"defaultAcl":["role:USER:R","schoolRole:{school}/EMPLOYEE:S"],"relationships":{"tasks":"tasks"}},"weekplans":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"weekplans-ks":{"accessClaimTypes":["email","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"]},"usertasks":{"accessClaimTypes":["email","schoolRole","tutorFor"],"sharingAccessPerRole":{"USER":{"email":["{email}:*","{tutorFor}:*"],"schoolRole":["{school}/EMPLOYEE:*"],"tutorFor":["{tutorFor}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{"task":"tasks","course":"courses"}},"userhiddencourses":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"usercalendarvisibility":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}},"subjects":{"relationships":{"courseTemplates":"courses","abilities":"abilities"}},"schools":{"accessClaimTypes":["role","schoolRole"],"relationships":{"courses":"courses","activeCourses":"courses"}},"courses":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:*"],"relationships":{"templateChain":"courses","centralContent":"central-content","knowledgeRequirements":"knowledge-requirements","abilities":"abilities","images":"images","tasks":"tasks"}},"tasks":{"accessClaimTypes":["role","schoolRole"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]}},"defaultAcl":["schoolRole:{school}/EMPLOYEE:S","role:USER:R"],"relationships":{"knowledgeRequirements":"knowledge-requirements","centralContent":"central-content","abilities":"abilities"}},"images":{"accessClaimTypes":["role","schoolRole","email"],"sharingAccessPerRole":{"EMPLOYEE":{"schoolRole":["{school}/EMPLOYEE:*"],"role":["USER:R"]},"USER":{"email":["{email}:*"]}}},"central-content":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"knowledge-requirements":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"abilities":{"accessClaimTypes":["role"],"defaultAcl":["role:USER:R"]},"notes":{"accessClaimTypes":["email"],"sharingAccessPerRole":{"USER":{"email":["{email}:*"]}},"defaultAcl":["email:{email}:S"],"relationships":{}}}};

/***/ }),

/***/ "../kedbackend/client.js":
/*!*******************************!*\
  !*** ../kedbackend/client.js ***!
  \*******************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["RestClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["HttpError"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["KedBackendClient"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["BatchRunner"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["updateArray"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _js_dist_js_ked_backend_client__WEBPACK_IMPORTED_MODULE_0__["hasAccess"]; });



/***/ }),

/***/ "../kedbackend/clientweb.js":
/*!**********************************!*\
  !*** ../kedbackend/clientweb.js ***!
  \**********************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-client-web */ "../kedbackend/js/dist/js/ked-backend-client-web/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["storage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["WebServerBearerProvider"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["isomorphic"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return _js_dist_js_ked_backend_client_web__WEBPACK_IMPORTED_MODULE_0__["KedBackendClientWeb"]; });



/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js":
/*!****************************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js ***!
  \****************************************************************************************/
/*! exports provided: BearerStorageSessionStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BearerStorageSessionStorage", function() { return BearerStorageSessionStorage; });
var BearerStorageSessionStorage = /** @class */ (function () {
    function BearerStorageSessionStorage() {
    }
    BearerStorageSessionStorage.prototype.save = function (id, tokenInfo) {
        sessionStorage.setItem("bearer-" + id, JSON.stringify(tokenInfo));
    };
    BearerStorageSessionStorage.prototype.load = function (id) {
        try {
            var json = sessionStorage.getItem("bearer-" + id);
            return Promise.resolve(json ? JSON.parse(json) : { token: null, expires: 0 });
        }
        catch (ex) {
            return Promise.resolve({ token: null, expires: 0 });
        }
    };
    return BearerStorageSessionStorage;
}());

//# sourceMappingURL=bearer-storage-sessionstorage.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js":
/*!************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js ***!
  \************************************************************************/
/*! exports provided: rememberHashLocation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "rememberHashLocation", function() { return rememberHashLocation; });
var redirHash = sessionStorage.getItem("redir-hash");
if (redirHash)
    try {
        var _a = JSON.parse(redirHash), time = _a.time, hash = _a.hash;
        if (time && time > Date.now() - 60000) {
            sessionStorage.removeItem("redir-hash");
            location.hash = hash;
        }
    }
    catch (_) { }
function rememberHashLocation() {
    sessionStorage.setItem("redir-hash", JSON.stringify({ time: Date.now(), hash: location.hash }));
}
//# sourceMappingURL=hash-restorer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client-web/index.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client-web/index.js ***!
  \****************************************************************/
/*! exports provided: storage, WebServerBearerProvider, isomorphic, KedBackendClientWeb */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "storage", function() { return storage; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WebServerBearerProvider", function() { return WebServerBearerProvider; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isomorphic", function() { return isomorphic; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClientWeb", function() { return KedBackendClientWeb; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./bearer-storage-sessionstorage */ "../kedbackend/js/dist/js/ked-backend-client-web/bearer-storage-sessionstorage.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../ked-model-migrator */ "../kedbackend/js/dist/js/ked-model-migrator/index.js");
/* harmony import */ var _hash_restorer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./hash-restorer */ "../kedbackend/js/dist/js/ked-backend-client-web/hash-restorer.js");







Object(_ked_model_migrator__WEBPACK_IMPORTED_MODULE_4__["KedModelMigratorMixin"])(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"].prototype);
var storage = new _bearer_storage_sessionstorage__WEBPACK_IMPORTED_MODULE_2__["BearerStorageSessionStorage"]();
var timeOfPageLoad = Date.now();
var WebServerBearerProvider = /** @class */ (function () {
    function WebServerBearerProvider(tokenPath, tokenResponseMapper, tokenId) {
        this.tokenPath = tokenPath;
        this.tokenResponseMapper = tokenResponseMapper;
        this.tokenId = tokenId;
        this.tokenInfo = { token: null, expires: 0 };
        this.getBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_3__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    WebServerBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        if (!!this.tokenInfo.token) return [3 /*break*/, 2];
                        if (!this.tokenId) return [3 /*break*/, 2];
                        _a = this;
                        return [4 /*yield*/, storage.load(this.tokenId)];
                    case 1:
                        _a.tokenInfo = _b.sent();
                        _b.label = 2;
                    case 2:
                        if (!(this.tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    WebServerBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, _c, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0: return [4 /*yield*/, fetch(this.tokenPath, {
                            headers: { Accept: "text/plain; application/json" },
                            redirect: 'manual',
                            cache: 'no-cache',
                            credentials: "same-origin"
                        })];
                    case 1:
                        res = _e.sent();
                        if (res.status === 302 || (!res.status && res.type === "opaqueredirect")) {
                            // User session timed out and server wants to redirect entire page to login page
                            // Time to reload current page to force a redirect of the entire page instead for
                            // just redirecting to /api/token or whatever.
                            if (Date.now() - timeOfPageLoad > 60000) { // prohibit endless loop of reloading self.
                                this.wantsRedirect = true; // So that listeners to onbeforeunload could show alternate message.
                                console.log("Redirect wanted. Reload page.");
                                Object(_hash_restorer__WEBPACK_IMPORTED_MODULE_5__["rememberHashLocation"])();
                                window.location.reload(true);
                                throw new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"](302, "Redirected");
                            }
                        }
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = Error.bind;
                        _b = "HTTP" + res.status + " ";
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(Error, [void 0, _b + (_e.sent())]))();
                    case 3:
                        _c = this;
                        _d = this.tokenResponseMapper;
                        return [4 /*yield*/, res.text()];
                    case 4:
                        _c.tokenInfo = _d.apply(this, [_e.sent()]);
                        storage.save(this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                }
            });
        });
    };
    return WebServerBearerProvider;
}());

var isomorphic = { fetch: fetch.bind(self), btoa: btoa.bind(self) };
var KedBackendClientWeb = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendClientWeb, _super);
    function KedBackendClientWeb(apiBaseUrl, providerOrTokenPath, options) {
        var _this = this;
        var bearerProvider = typeof providerOrTokenPath !== 'string' ?
            providerOrTokenPath :
            new WebServerBearerProvider(providerOrTokenPath, (options && options.tokenResponseMapper) || (function (x) { return ({ token: x, expires: Date.now() + 59 * 60 * 60 }); }), options && options.tokenId);
        _this = _super.call(this, isomorphic, bearerProvider, apiBaseUrl) || this;
        return _this;
    }
    return KedBackendClientWeb;
}(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["KedBackendClient"]));

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/access-control.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/access-control.js ***!
  \*********************************************************************/
/*! exports provided: DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return DocumentAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
var DocumentAccess = /** @class */ (function () {
    function DocumentAccess(accessClaimType, accessClaimValue, right) {
        this.accessClaimType = accessClaimType;
        this.accessClaimValue = accessClaimValue;
        this.right = right;
    }
    DocumentAccess.fromString = function (ac) {
        if (!ac)
            return null;
        var split = ac.split(':');
        if (split.length < 3)
            throw new Error("Invalid access string: " + ac);
        var claimType = DocumentAccess.unescape(split[0]);
        var claimValue = DocumentAccess.unescape(split[1]);
        var right = split[2];
        if (right !== 'R' && right !== 'W' && right !== 'S')
            throw new Error("Invalid access string: " + ac);
        return new DocumentAccess(claimType, claimValue, right);
    };
    DocumentAccess.escape = function (accessComponent) {
        return accessComponent.replace(/\%/g, "%25").replace(/\:/g, "%3A");
    };
    DocumentAccess.unescape = function (accessComponent) {
        return accessComponent.replace(/\%3A/g, ":").replace(/\%25/g, "%");
    };
    DocumentAccess.prototype.toString = function () {
        return DocumentAccess.escape(this.accessClaimType) + ":" +
            DocumentAccess.escape(this.accessClaimValue) + ":" +
            this.right;
    };
    DocumentAccess.fromStringArray = function (acl) {
        return acl
            .map(function (ac) { return DocumentAccess.fromString(ac); })
            .filter(function (ac) { return ac; });
    };
    DocumentAccess.toStringArray = function (acl) {
        return acl.map(function (ac) { return ac.toString(); });
    };
    return DocumentAccess;
}());

function hasAccess(acl, userClaims, requestedRight) {
    if (userClaims.some(function (claim) { return claim.type === 'role' && claim.value === "ADMIN"; }))
        return true;
    return acl.some(function (a) {
        return userClaims.some(function (c) {
            return a.accessClaimType === c.type &&
                a.accessClaimValue === c.value && ((a.right === 'R' && requestedRight === 'R') ||
                (a.right === 'W' && ['R', 'W'].indexOf(requestedRight) >= 0) ||
                (a.right === 'S'));
        });
    });
}
//# sourceMappingURL=access-control.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/http-error.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/http-error.js ***!
  \*****************************************************************/
/*! exports provided: HttpError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return HttpError; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

var HttpError = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](HttpError, _super);
    function HttpError(code, message) {
        var _this = _super.call(this, "HTTP" + code + " " + message) || this;
        _this.code = code;
        _this.message = message;
        _this.name = "http" + code;
        _this.message = "HTTP" + code + " " + message;
        return _this;
    }
    return HttpError;
}(Error));

//# sourceMappingURL=http-error.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/index.js ***!
  \************************************************************/
/*! exports provided: KedBearerProvider, RestClient, HttpError, KedBackendClient, BatchRunner, createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray, DocumentAccess, hasAccess */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendClient", function() { return KedBackendClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BatchRunner", function() { return BatchRunner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["createUUID"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["computePredestinatedId"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return _utils__WEBPACK_IMPORTED_MODULE_2__["updateArray"]; });

/* harmony import */ var _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ked-bearer-provider */ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return _ked_bearer_provider__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"]; });

/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./access-control */ "../kedbackend/js/dist/js/ked-backend-client/access-control.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DocumentAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return _access_control__WEBPACK_IMPORTED_MODULE_4__["hasAccess"]; });

/* harmony import */ var _http_error__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./http-error */ "../kedbackend/js/dist/js/ked-backend-client/http-error.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HttpError", function() { return _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"]; });

/* empty/unused harmony star reexport */








;
var KedBackendClient = /** @class */ (function () {
    function KedBackendClient(isomorphic, bearerProvider, baseUrl) {
        this.http = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
    }
    KedBackendClient.prototype.getMyClaims = function (table, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("me/claims/" + (table || ""), null, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.get = function (table, id, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get(table + "/" + id, options, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.list = function (table, options, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, options);
                        if (options && options.mutationsOnEmpty)
                            query.mutationsOnEmpty = JSON.stringify(options.mutationsOnEmpty);
                        return [4 /*yield*/, this.http.get("" + table, query, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.batch = function (reqs, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        // Reorder operations so that 'add's come first and 'delete's come last:
                        reqs = reqs.slice().sort(function (req1, req2) {
                            return req1.op === 'add' ? -1 : req2.op === 'add' ? 1 :
                                req1.op === 'delete' ? 1 : req2.op === 'delete' ? -1 : 0;
                        });
                        return [4 /*yield*/, this.http.post("batch", reqs, fetchOptions)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.do = function (scopeFn) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var runner;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        runner = new BatchRunner();
                        scopeFn(runner);
                        return [4 /*yield*/, this.batch(runner.mutationRequests)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.deleteRealm = function (realm) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.delete("realms/" + realm)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = _http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_http_error__WEBPACK_IMPORTED_MODULE_5__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    KedBackendClient.prototype.add = function (table, doc, branchId) {
        return this.do(function (r) { return r.add(table, doc); });
    };
    KedBackendClient.prototype.put = function (table, doc) {
        return this.do(function (r) { return r.put(table, doc); });
    };
    KedBackendClient.prototype.update = function (table, id, deltaDoc, branchId) {
        return this.do(function (r) { return r.update(table, id, deltaDoc, branchId); });
    };
    KedBackendClient.prototype.merge = function (branchId, targetBranchId) {
        return this.do(function (r) { return r.merge(branchId, targetBranchId); });
    };
    KedBackendClient.prototype.clearBranch = function (branchId) {
        return this.do(function (r) { return r.clearBranch(branchId); });
    };
    KedBackendClient.prototype.delete = function (table, id) {
        return this.do(function (r) { return r.delete(table, id); });
    };
    KedBackendClient.prototype.share = function (table, id, acl) {
        return this.do(function (r) { return r.share(table, id, acl); });
    };
    KedBackendClient.prototype.unshare = function (table, id, acl) {
        return this.do(function (r) { return r.unshare(table, id, acl); });
    };
    KedBackendClient.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.link(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.link2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.link2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        return this.do(function (r) { return r.unlink(sourceTable, sourceId, targetTable, targetId, label); });
    };
    KedBackendClient.prototype.unlink2 = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.unlink2(sourceTable, sourceId, label, targetId, branchId); });
    };
    KedBackendClient.prototype.undoLink = function (sourceTable, sourceId, targetId, label, branchId) {
        return this.do(function (r) { return r.undoLink(sourceTable, sourceId, label, targetId, branchId); });
    };
    return KedBackendClient;
}());

var BatchRunner = /** @class */ (function () {
    function BatchRunner() {
        this.mutationRequests = [];
    }
    BatchRunner.prototype.add = function (table, doc, branchId) {
        this.mutationRequests.push({ op: 'add', table: table, doc: doc, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.put = function (table, doc) {
        doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        delete doc.acl; // Forbidden to send acl with put() calls.
        this.mutationRequests.push({ op: 'put', table: table, doc: doc });
        return this;
    };
    BatchRunner.prototype.update = function (table, id, deltaDoc, branchId) {
        deltaDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaDoc);
        this.mutationRequests.push({ op: 'update', table: table, id: id, deltaDoc: deltaDoc, branchId: branchId });
    };
    BatchRunner.prototype.merge = function (branchId, targetBranchId) {
        this.mutationRequests.push({ op: 'merge', branchId: branchId, targetBranchId: targetBranchId });
    };
    BatchRunner.prototype.clearBranch = function (branchId) {
        this.mutationRequests.push({ op: 'clear-branch', branchId: branchId });
    };
    BatchRunner.prototype.delete = function (table, id) {
        this.mutationRequests.push({ op: 'delete', table: table, id: id });
        return this;
    };
    BatchRunner.prototype.share = function (table, id, acl) {
        this.mutationRequests.push({ op: 'share', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.unshare = function (table, id, acl) {
        this.mutationRequests.push({ op: 'unshare', table: table, id: id, acl: acl });
        return this;
    };
    BatchRunner.prototype.link = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.link2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    BatchRunner.prototype.unlink = function (sourceTable, sourceId, targetTable, targetId, label) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetTable: targetTable, targetId: targetId, label: label });
        return this;
    };
    BatchRunner.prototype.unlink2 = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'unlink', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
        return this;
    };
    BatchRunner.prototype.undoLink = function (sourceTable, sourceId, label, targetId, branchId) {
        this.mutationRequests.push({ op: 'undo-link', sourceTable: sourceTable, sourceId: sourceId, targetId: targetId, label: label, branchId: branchId });
    };
    return BatchRunner;
}());

//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/ked-bearer-provider.js ***!
  \**************************************************************************/
/*! exports provided: KedBearerProvider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBearerProvider", function() { return KedBearerProvider; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _restclient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./restclient */ "../kedbackend/js/dist/js/ked-backend-client/restclient.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");



var KedBearerProvider = /** @class */ (function () {
    function KedBearerProvider(isomorphic, storage, tokenId, clientId, clientSecret, tokenUrl, tokenQuery) {
        this.isomorphic = isomorphic;
        this.storage = storage;
        this.tokenId = tokenId;
        this.clientId = clientId;
        this.clientSecret = clientSecret;
        this.tokenUrl = tokenUrl;
        this.tokenQuery = tokenQuery;
        this.tokenInfo = { token: null, expires: 0 };
        this.client = new _restclient__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, "", {
            username: this.clientId,
            password: this.clientSecret
        });
        this.getBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.getBearer.bind(this));
        this.refreshBearer = Object(_utils__WEBPACK_IMPORTED_MODULE_2__["avoidSimultanousCalls"])(this.refreshBearer.bind(this));
    }
    KedBearerProvider.prototype.getBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, token, expires, _b, e_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _a = this.tokenInfo, token = _a.token, expires = _a.expires;
                        if (token && expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        _c.label = 1;
                    case 1:
                        _c.trys.push([1, 4, , 6]);
                        _b = this;
                        return [4 /*yield*/, this.storage.load(this.clientId + "/" + this.tokenId)];
                    case 2:
                        _b.tokenInfo = _c.sent();
                        if (this.tokenInfo.token && this.tokenInfo.expires >= Date.now())
                            return [2 /*return*/, this.tokenInfo];
                        return [4 /*yield*/, this.refreshBearer()];
                    case 3:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        e_1 = _c.sent();
                        return [4 /*yield*/, this.refreshBearer()];
                    case 5:
                        _c.sent();
                        return [2 /*return*/, this.tokenInfo];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    KedBearerProvider.prototype.refreshBearer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, retries, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        retries = 0;
                        _c.label = 1;
                    case 1:
                        if (!(retries < 6)) return [3 /*break*/, 5];
                        console.log("Retrieving token for " + this.tokenId);
                        return [4 /*yield*/, this.client.get(this.tokenUrl, this.tokenQuery, { cache: 'reload' })];
                    case 2:
                        res = _c.sent();
                        if (res.status !== 200) {
                            console.warn("Got " + res.status + " " + res.statusText);
                            return [3 /*break*/, 4];
                        }
                        _a = this;
                        _b = {};
                        return [4 /*yield*/, res.text()];
                    case 3:
                        _a.tokenInfo = (_b.token = _c.sent(), _b.expires = Date.now() + 59 * 60 * 1000, _b);
                        console.log("Got token for " + this.tokenId + ": " + JSON.stringify(this.tokenInfo));
                        this.storage.save(this.clientId + "/" + this.tokenId, this.tokenInfo);
                        return [2 /*return*/, this.tokenInfo];
                    case 4:
                        ++retries;
                        return [3 /*break*/, 1];
                    case 5: throw new Error("Failed to retrieve token for " + JSON.stringify(this.tokenId));
                }
            });
        });
    };
    return KedBearerProvider;
}());

//# sourceMappingURL=ked-bearer-provider.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/restclient.js":
/*!*****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/restclient.js ***!
  \*****************************************************************/
/*! exports provided: RestClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestClient", function() { return RestClient; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _observable_emitter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../observable/emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/*
declare var Buffer; // node built-in


function basicAuthHeader(username, password) {
    return "Basic " + new Buffer(username + ":" + password).toString("base64");
}
*/



var RestClient = /** @class */ (function () {
    function RestClient(isomorphic, baseUrl, options) {
        this.isomorphic = isomorphic;
        this.baseUrl = baseUrl;
        this.options = options;
        this.numOutstandingOperations = 0;
        this._status = new _observable_emitter__WEBPACK_IMPORTED_MODULE_2__["Emitter"](this);
        this.fetchOptions = { mode: 'cors' };
        this.authHeader = options.bearer ?
            "Bearer " + options.bearer :
            options.username ?
                "Basic " + isomorphic.btoa(options.username + ":" + (options.password || "")) :
                null;
        this.bearerProvider = options.bearerProvider || null;
    }
    Object.defineProperty(RestClient.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    RestClient.prototype.fetch = function (path, method, headers, query, fetchOptions) {
        var _this = this;
        ++this.numOutstandingOperations;
        this._status.dispatch(this);
        return this._fetch(path, method, headers, query, fetchOptions)
            .then(function (res) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return res;
        }).catch(function (err) {
            --_this.numOutstandingOperations;
            _this._status.dispatch(_this);
            return Promise.reject(err);
        });
    };
    RestClient.prototype._fetch = function (path, method, headers, query, fetchOptions) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var queryStr, _a, authHeader, tokenInfo, bearerProvider, _b, _c, url, res, wwwauth, _d;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        if (fetchOptions && fetchOptions.cache === 'no-cache') {
                            // Workaround for back-button not respecting cache control in Chrome/Opera.
                            // Append a query parameter to force a cache entry
                            query = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { nocache: Object(_utils__WEBPACK_IMPORTED_MODULE_1__["createUUID"])() });
                        }
                        queryStr = query && Object.keys(query).filter(function (key) { return query[key] !== undefined; }).map(function (key) {
                            return encodeURIComponent(key) +
                                "=" +
                                encodeURIComponent(query[key]);
                        })
                            .join('&');
                        _a = this, authHeader = _a.authHeader, tokenInfo = _a.tokenInfo, bearerProvider = _a.bearerProvider;
                        if (!(!authHeader && !tokenInfo && bearerProvider)) return [3 /*break*/, 2];
                        _b = this;
                        return [4 /*yield*/, bearerProvider.getBearer()];
                    case 1:
                        _b.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 2;
                    case 2:
                        if (!tokenInfo) return [3 /*break*/, 5];
                        if (!(tokenInfo.expires < Date.now())) return [3 /*break*/, 4];
                        console.log("Token expired. Refresh it:");
                        _c = this;
                        return [4 /*yield*/, bearerProvider.refreshBearer()];
                    case 3:
                        _c.tokenInfo = tokenInfo = _e.sent();
                        _e.label = 4;
                    case 4:
                        authHeader = "Bearer " + tokenInfo.token;
                        _e.label = 5;
                    case 5:
                        // In one way or another, we've concluded an Authorization header to use:
                        if (authHeader) {
                            headers.Authorization = authHeader;
                        }
                        url = this.baseUrl + path + (queryStr ? "?" + queryStr : "");
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 6:
                        res = _e.sent();
                        if (!(res.status == 401 && this.bearerProvider)) return [3 /*break*/, 9];
                        wwwauth = res.headers.get("www-authenticate");
                        console.log("Got " + res.status + " from " + (this.baseUrl + path));
                        if (!(wwwauth && /Bearer/i.test(wwwauth))) return [3 /*break*/, 9];
                        _d = this;
                        return [4 /*yield*/, this.bearerProvider.refreshBearer()];
                    case 7:
                        _d.tokenInfo = _e.sent();
                        headers.Authorization = "Bearer " + this.tokenInfo.token;
                        return [4 /*yield*/, this.isomorphic.fetch(url, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.fetchOptions, { headers: headers, method: method }, fetchOptions))];
                    case 8:
                        res = _e.sent();
                        _e.label = 9;
                    case 9: return [2 /*return*/, res];
                }
            });
        });
    };
    RestClient.prototype.get = function (path, query, fetchOptions) {
        return this.fetch(path, "GET", { Accept: "application/json; text/plain" }, query, fetchOptions);
    };
    RestClient.prototype.post = function (path, data, fetchOptions) {
        return this.fetch(path, "POST", {
            "Content-Type": "application/json",
            "Accept": "application/json"
        }, null, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: JSON.stringify(data) }));
    };
    RestClient.prototype.delete = function (path, query, body, fetchOptions) {
        return this.fetch(path, "DELETE", { Accept: "application/json; text/plain" }, query, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, fetchOptions, { body: body }));
    };
    return RestClient;
}());

//# sourceMappingURL=restclient.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-client/utils.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-client/utils.js ***!
  \************************************************************/
/*! exports provided: createUUID, avoidSimultanousCalls, getGlobalId, computePredestinatedId, updateArray */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createUUID", function() { return createUUID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "avoidSimultanousCalls", function() { return avoidSimultanousCalls; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getGlobalId", function() { return getGlobalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "computePredestinatedId", function() { return computePredestinatedId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateArray", function() { return updateArray; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function createUUID() {
    // Decent solution from http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript
    var d = Date.now();
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);
    });
    return uuid;
}
function avoidSimultanousCalls(method) {
    var ongoingPromise = null;
    return function () {
        if (!ongoingPromise) {
            ongoingPromise = method.apply(this, arguments).then(function (result) {
                ongoingPromise = null;
                return result;
            });
        }
        return ongoingPromise;
    };
}
function getGlobalId(realm) {
    var prefix = 'ec96b3be-45fc-41d3-b69e-';
    var pad = ['50', '08', 'e1', '40', 'e4', 'e7'];
    if (realm.length > 6)
        throw new Error("Too long realm");
    for (var i = 0; i < realm.length; ++i) {
        var hex = realm.charCodeAt(i).toString(16);
        pad[i] = hex.length === 2 ?
            hex :
            '0' + hex;
    }
    return prefix + pad.join('');
}
function computePredestinatedId(input) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var encoder, data, digest, _a, i;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    encoder = new TextEncoder();
                    data = encoder.encode(input);
                    _a = Uint8Array.bind;
                    return [4 /*yield*/, crypto.subtle.digest('SHA-256', data)];
                case 1:
                    digest = new (_a.apply(Uint8Array, [void 0, _b.sent()]))();
                    i = 0;
                    return [2 /*return*/, 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                            var nibble = digest[i++] % 16 | 0;
                            var washedNibble = c === 'x' ?
                                nibble :
                                nibble & 0x7 | 0x8;
                            return washedNibble.toString(16);
                        })];
            }
        });
    });
}
/*export function buf2hex(buffer: ArrayBuffer) {
  return Array.prototype.map.call(
    new Uint8Array(buffer),
    (x: number) => ('00' + x.toString(16)).slice(-2)).join('');
}*/
function updateArray(a, mapper) {
    var retval = a;
    for (var i = 0, l = a.length; i < l; ++i) {
        var t = a[i];
        var mapped = mapper(t);
        if (mapped !== t) {
            if (retval === a)
                retval = a.slice();
            retval[i] = mapped;
        }
    }
    return retval;
}
/*
export function updateArray<T>(a: T[], mapper: (t: T) => T | false): T[] {
  let retval = a;
  let j = 0;
  for (let i=0,l=a.length; i<l; ++i, ++j) {
    const t = a[i];
    const mapped = mapper(t);
    if (mapped === false) {
      // Mapper wants to delete this doc.
      if (retval === a) retval = a.slice();
      retval.splice(j, 1);
      --j; // compensate for ++j
    } else if (mapped !== t) {
      if (retval === a) retval = a.slice();
      retval[j] = mapped;
    }
  }
  return retval;
}
*/ 
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js":
/*!***************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js ***!
  \***************************************************************/
/*! exports provided: CacheBust */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CacheBust", function() { return CacheBust; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");


var CacheBust = /** @class */ (function () {
    function CacheBust() {
    }
    CacheBust.getCacheBust = function (table, query, user, includes) {
        var involvedItems = CacheBust.getInvolvedItems(table, query, includes);
        return involvedItems
            .map(function (item) { return localStorage.getItem("cache-bust-" + user + "-" + item); })
            .filter(function (value) { return !!value; })
            .join('/') || 'static';
    };
    CacheBust.invalidateCache = function (reqs, user) {
        for (var _i = 0, _a = CacheBust.getCacheInvalidations(reqs); _i < _a.length; _i++) {
            var item = _a[_i];
            localStorage.setItem("cache-bust-" + user + "-" + item, '' + Date.now());
        }
    };
    CacheBust.getInvolvedItems = function (table, query, includes) {
        var hasEdgesFrom = query.hasEdgesFrom;
        var relatedTables = includes
            .map(function (label) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label]; })
            .filter(function (table) { return !!table; });
        if (hasEdgesFrom)
            relatedTables.push("hef" + table);
        return [table, 'master', query.branchId].filter(function (x) { return !!x; }).concat(relatedTables).sort();
    };
    CacheBust.getCacheInvalidations = function (reqs) {
        var invalidationSet = {};
        reqs.forEach(function (req) {
            switch (req.op) {
                case 'add':
                case 'put':
                case 'delete':
                case 'update':
                    invalidationSet[req.table] = true;
                    break;
                case 'link':
                case 'unlink':
                case 'undo-link':
                    invalidationSet[req.sourceTable] = true;
                    invalidationSet["hef-" + Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(req.sourceTable, req.label)] = true;
                    break;
                case 'clear-branch':
                    invalidationSet[req.branchId] = true;
                    break;
                case 'merge':
                    invalidationSet[req.branchId] = true;
                    invalidationSet[req.targetBranchId || "master"] = true;
                    break;
            }
        });
        return Object.keys(invalidationSet);
    };
    return CacheBust;
}());

//# sourceMappingURL=cache-bust.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js":
/*!***********************************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js ***!
  \***********************************************************************************************/
/*! exports provided: applyMutationsOnDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyMutationsOnDeltas", function() { return applyMutationsOnDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");


function applyMutationsOnDeltas(branchId, deltas, mutations, optimistic, userDisplayName, hasAdditionalFilter) {
    var _loop_1 = function (m) {
        switch (m.op) {
            case 'add-related':
                //
                // AddRelated RepoMutation
                //
                if (!hasAdditionalFilter && m.branchId === branchId) {
                    deltas = [{
                            type: 'add',
                            sourceId: m.id,
                            targetId: m.relatedDoc.id,
                            label: m.graphProp,
                            sourceTable: m.table,
                            $meta: optimistic ? 'adding' : 'persisted',
                            dateTime: Date.now(),
                            targetName: m.relatedDoc.name,
                            contributor: userDisplayName
                        }].concat(deltas);
                }
                break;
            case 'clear-branch':
                //
                // ClearBranch RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                break;
            case 'delete':
                //
                // Delete RepoMutation
                //
                // This type of mutation can not be performed onto branches. There's no branchId property on m.
                break;
            case 'merge':
                //
                // Merge RepoMutation
                //
                if (m.branchId === branchId) {
                    deltas = [];
                }
                else if (m.targetBranchId === branchId) {
                    // This change will append new deltas to our deltas array but we don't know what would come.
                    // Need to refetch from server.
                    if (!optimistic)
                        return { value: null }; // Caller should check for null and re-fetch data from server.
                }
                break;
            case 'remove-related':
                //
                // Remove-Related RepoMutation
                //
                if (hasAdditionalFilter || m.branchId !== branchId)
                    return "continue";
                deltas = [{
                        type: 'remove',
                        sourceId: m.id,
                        targetId: m.relatedDoc.id,
                        targetName: m.relatedDoc.name,
                        label: m.graphProp,
                        sourceTable: m.table,
                        contributor: userDisplayName,
                        dateTime: Date.now(),
                        $meta: optimistic ? 'adding' : 'persisted'
                    }].concat(deltas);
                break;
            case 'undo-link':
                //
                // Undo-Link RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (d) {
                        return (d.type === 'add' || d.type === 'remove' || d.type === 'undo-link') &&
                            d.sourceId === m.id &&
                            d.targetId === m.relatedId;
                    });
                    if (idx < 0)
                        return "continue";
                    // Found an "add" or "remove" delta to change:
                    if (optimistic) {
                        var deltaRelation = deltas[idx];
                        // Mark the existing add/remove delta as currenlty being deleted
                        deltas = deltas.slice(0, idx).concat([
                            tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, deltaRelation, { $meta: optimistic ? 'removing' : 'persisted' })
                        ], deltas.slice(idx + 1));
                    }
                    else {
                        // Persisted. Just remove it:
                        deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                    }
                }
                break;
            case 'update':
                //
                // Update RepoMutation
                //
                if (m.branchId !== branchId)
                    return "continue";
                {
                    var idx = deltas.findIndex(function (delta) {
                        return delta.type === 'modify' &&
                            delta.targetId === m.id;
                    });
                    if (idx < 0 && !hasAdditionalFilter) {
                        deltas = [{
                                type: 'modify',
                                table: m.table,
                                targetId: m.id,
                                targetName: m.targetName,
                                data: m.deltaDoc,
                                dateTime: Date.now(),
                                contributors: [userDisplayName],
                                $meta: optimistic ? 'adding' : 'persisted',
                            }].concat(deltas);
                    }
                    else {
                        var existingDeltaDoc = deltas[idx];
                        var contributors = existingDeltaDoc.contributors.slice();
                        if (!contributors.includes(userDisplayName)) {
                            contributors.push(userDisplayName);
                        }
                        var newData = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_1__["mergeDeltas"])(existingDeltaDoc.data, m.deltaDoc, { removeUnsetProps: true });
                        if (!optimistic && Object.keys(newData).length === 0) {
                            // Committed mutation that resets a deltaDoc. Remove the deltaDoc entirely:
                            deltas = deltas.slice(0, idx).concat(deltas.slice(idx + 1));
                        }
                        else {
                            // 
                            deltas = [
                                {
                                    type: 'modify',
                                    table: m.table,
                                    targetId: m.id,
                                    targetName: m.targetName,
                                    data: newData,
                                    dateTime: Date.now(),
                                    contributors: contributors,
                                    $meta: optimistic ? 'updating' : 'persisted',
                                }
                            ].concat(deltas.slice(0, idx), deltas.slice(idx + 1));
                        }
                    }
                }
                break;
        }
    };
    for (var _i = 0, mutations_1 = mutations; _i < mutations_1.length; _i++) {
        var m = mutations_1[_i];
        var state_1 = _loop_1(m);
        if (typeof state_1 === "object")
            return state_1.value;
    }
    return deltas;
}
//# sourceMappingURL=apply-mutations-on-deltas.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js":
/*!*********************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js ***!
  \*********************************************************************************/
/*! exports provided: DeltaCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCache", function() { return DeltaCache; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./apply-mutations-on-deltas */ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/apply-mutations-on-deltas.js");



var DeltaCache = /** @class */ (function () {
    function DeltaCache(getClient, getUser, getUserDisplayName) {
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.lookup = {};
    }
    DeltaCache.prototype.applyMutations = function (mutations, _a) {
        var optimistic = (_a === void 0 ? { optimistic: false } : _a).optimistic;
        // Apply mutations locally onto the DeltaCache and notify their subscribers
        for (var _i = 0, _b = Object.keys(this.lookup); _i < _b.length; _i++) {
            var queryKey = _b[_i];
            var cacheEntry = this.lookup[queryKey];
            if (cacheEntry.value) {
                // Instead here: Store the mutations on cacheEntry. No matter if it yet has value or not.
                // Then apply mutation whenever subscribing! (Better handling of mutations that arrives before fetch() is done)
                // (See how I handle this in query-set.ts)
                var newValue = Object(_apply_mutations_on_deltas__WEBPACK_IMPORTED_MODULE_2__["applyMutationsOnDeltas"])(cacheEntry.query.branchId, cacheEntry.value, mutations, optimistic, this.getUserDisplayName(), !!cacheEntry.query.tags);
                if (newValue === null) {
                    // The mutation requires cacheEntry to be refetched from server
                    if (!optimistic) {
                        // Caller has successfully performed the mutations and got success back from server.
                        // It's ok to refetch the deltas from server now:
                        cacheEntry.fetch();
                        // After fetch completes, it will notify the subscribers.
                    }
                }
                if (newValue !== cacheEntry.value) {
                    cacheEntry.optimisticValue = newValue;
                    if (!optimistic)
                        cacheEntry.value = newValue;
                    cacheEntry.notify(newValue);
                }
            }
        }
    };
    DeltaCache.prototype.subscribe = function (query, observer) {
        var _this = this;
        var cacheEntry = this.lookup[query.branchId + query.tags];
        if (!cacheEntry) {
            cacheEntry = new DeltaCacheEntry(this.getClient(), query);
            this.lookup[query.branchId + query.tags] = cacheEntry;
        }
        if (cacheEntry.cleanupTimer) {
            clearTimeout(cacheEntry.cleanupTimer);
            cacheEntry.cleanupTimer = null;
        }
        var subscription = {
            unsubscribe: function () {
                cacheEntry.subscribers = cacheEntry.subscribers.filter(function (_a) {
                    var o = _a.observer;
                    return o !== observer;
                });
                if (cacheEntry.subscribers.length === 0) {
                    cacheEntry.cleanupTimer = setTimeout(function () {
                        if (cacheEntry.subscribers.length === 0) {
                            delete _this.lookup[query.branchId + query.tags];
                        }
                    }, 100);
                }
            }
        };
        cacheEntry.subscribers.push({ observer: observer, subscription: subscription });
        if (cacheEntry.value) {
            // Value has been successfully retrieved already. Pick from cache.
            observer(cacheEntry.optimisticValue || cacheEntry.value, null, subscription);
        }
        else if (cacheEntry.isFetching) {
            // A value is on its way. Sit back and relax. All registered
            // observers (including this one) will be notified when data arrives
            // or fails.
        }
        else if (cacheEntry.error) {
            observer(null, cacheEntry.error, subscription);
        }
        else {
            cacheEntry.fetch();
        }
        return subscription;
    };
    return DeltaCache;
}());

var DeltaCacheEntry = /** @class */ (function () {
    function DeltaCacheEntry(client, query) {
        this.fetchOperationId = 0; // Makes sure a re-fetch will discard the result from any ongoing fetch.
        this.client = client;
        this.query = query;
        this.value = null;
        this.error = null;
        this.optimisticValue = null;
        this.subscribers = [];
        this.isFetching = false;
        this.cleanupTimer = null;
    }
    DeltaCacheEntry.prototype.fetch = function () {
        var _this = this;
        var fetchOperationId = ++this.fetchOperationId;
        this.isFetching = true;
        this.fetchFromServer().then(function (value) {
            // Success
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                value.sort(function (a, b) { return b.dateTime - a.dateTime; }); // Latest first
                _this.value = value;
                _this.optimisticValue = value;
                _this.notify(value);
            }
        }).catch(function (error) {
            // Fail
            if (fetchOperationId === _this.fetchOperationId) {
                _this.isFetching = false;
                _this.error = error;
                _this.fail(error);
            }
        });
    };
    DeltaCacheEntry.prototype.fetchFromServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!this.query.branchId)
                            throw new Error('Deltas only available on branches');
                        return [4 /*yield*/, this.client.http.get('deltas', this.query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 300 || res.status < 200)) return [3 /*break*/, 3];
                        _a = _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(_ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4: return [2 /*return*/, _c.sent()];
                }
            });
        });
    };
    DeltaCacheEntry.prototype.notify = function (value) {
        for (var _i = 0, _a = this.subscribers; _i < _a.length; _i++) {
            var _b = _a[_i], observer = _b.observer, subscription = _b.subscription;
            observer(value, null, subscription);
        }
    };
    DeltaCacheEntry.prototype.fail = function (error) {
        var copy = this.subscribers.slice();
        this.subscribers = [];
        for (var _i = 0, copy_1 = copy; _i < copy_1.length; _i++) {
            var _a = copy_1[_i], observer = _a.observer, subscription = _a.subscription;
            observer(null, error, subscription);
        }
    };
    return DeltaCacheEntry;
}());
//# sourceMappingURL=delta-cache.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js":
/*!**************************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js ***!
  \**************************************************************************************/
/*! exports provided: DeltaCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DeltaCollection", function() { return DeltaCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../observable */ "../kedbackend/js/dist/js/observable/index.js");


var DeltaCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](DeltaCollection, _super);
    function DeltaCollection(deltaCache, query) {
        var _this = _super.call(this, function (observer) { return _this.deltaCache.subscribe(query, observer); }) || this;
        _this.deltaCache = deltaCache;
        _this.query = query;
        return _this;
    }
    DeltaCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return new DeltaCollection(this.deltaCache, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, { tags: tags }));
    };
    return DeltaCollection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Collection"]));

//# sourceMappingURL=delta-collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js":
/*!****************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js ***!
  \****************************************************************/
/*! exports provided: applyDelta, mergeDeltas */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyDelta", function() { return applyDelta; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mergeDeltas", function() { return mergeDeltas; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");

function applyDelta(doc, delta) {
    var keys = Object.keys(delta);
    var targetDoc = doc;
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (targetDoc === doc)
            targetDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        var val = delta[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_1 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            // Do nothing on target doc!
                            targetDoc.$wasUnset = true; // Just mark it for re-retrieval after successful posting changes.
                            break;
                        }
                        case "$add": {
                            var valuesToAdd = miValue;
                            if (!Array.isArray(valuesToAdd)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            else {
                                targetArray = targetArray.slice(); // On JS side, we must be immutable
                            }
                            targetDoc[key] = targetArray;
                            for (var _i = 0, valuesToAdd_1 = valuesToAdd; _i < valuesToAdd_1.length; _i++) {
                                var v = valuesToAdd_1[_i];
                                if (!targetArray.includes(v)) { // avoid dups
                                    targetArray.push(v);
                                }
                            }
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_1 = miValue;
                            if (!Array.isArray(valuesToRemove_1)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetArray = targetDoc[key];
                            if (!Array.isArray(targetArray)) {
                                targetArray = [];
                            }
                            targetDoc[key] = targetArray.filter(function (t) { return !valuesToRemove_1.includes(t); });
                            break;
                        }
                    }
                };
                for (var _a = 0, metaInstructions_1 = metaInstructions; _a < metaInstructions_1.length; _a++) {
                    var mi = metaInstructions_1[_a];
                    _loop_1(mi);
                }
                continue;
            }
        }
        targetDoc[key] = val;
    }
    return targetDoc;
}
// {name: "Ulla"}, {name: {$unset:0}
// {tags: {$add: "hej"}}, {tags: {$unset:0}"}
function mergeDeltas(delta1, delta2, _a) {
    var removeUnsetProps = (_a === void 0 ? { removeUnsetProps: false } : _a).removeUnsetProps;
    //return {...delta1, ...delta2};
    var keys = Object.keys(delta2);
    var targetDelta = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, delta1);
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        var val = delta2[key];
        if (val && typeof val === 'object') {
            var metaInstructions = Object.keys(val)
                .filter(function (key) { return key.startsWith('$'); });
            if (metaInstructions.length > 0) {
                var _loop_2 = function (mi) {
                    var miValue = val[mi];
                    switch (mi) {
                        case "$unset": {
                            if (removeUnsetProps) {
                                delete targetDelta[key];
                            }
                            else {
                                // No matter if targetDelta is empty or has value. Set it to {$unset:0}
                                // to make sure the very end result will have {$unset:0}
                                targetDelta[key] = { $unset: 0 };
                            }
                            break;
                        }
                        case "$add": {
                            var valuesToAdd_2 = miValue;
                            if (!Array.isArray(valuesToAdd_2)) {
                                throw new Error("$add instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$remove: [...items]}
                            // If so, remove any equal items from there before merging the {$add: [...]} arrays.
                            var targetRemoveArray = targetMetaProp.$remove;
                            if (Array.isArray(targetRemoveArray)) {
                                targetMetaProp.$remove =
                                    targetRemoveArray.filter(function (t) { return !valuesToAdd_2.includes(t); });
                                if (targetMetaProp.$remove.length === 0) {
                                    // If $remove array became emtpy. Remove the $remove prop.
                                    delete targetMetaProp.$remove;
                                }
                            }
                            // Now it's time to merge or create target $add array.
                            var targetAddArray = targetMetaProp.$add;
                            targetAddArray = targetAddArray ? targetAddArray.concat(valuesToAdd_2) : valuesToAdd_2.slice();
                            targetMetaProp.$add = targetAddArray;
                            break;
                        }
                        case "$remove": {
                            var valuesToRemove_2 = miValue;
                            if (!Array.isArray(valuesToRemove_2)) {
                                throw new Error("$remove instruction must contain array");
                            }
                            var targetMetaProp = targetDelta[key];
                            targetMetaProp = targetMetaProp ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, targetMetaProp) : {};
                            targetDelta[key] = targetMetaProp;
                            // First, just check if target metaProp has {$add: [...items]}
                            // If so, remove any equal items from there before merging the {$remove: [...]} arrays.
                            var targetAddArray = targetMetaProp.$remove;
                            if (Array.isArray(targetAddArray)) {
                                targetMetaProp.$add =
                                    targetAddArray.filter(function (t) { return !valuesToRemove_2.includes(t); });
                                if (targetMetaProp.$add.length === 0) {
                                    // If $add array became emtpy. Remove the $add prop.
                                    delete targetMetaProp.$add;
                                }
                            }
                            // Now it's time to merge or create target $remove array.
                            var targetRemoveArray = targetMetaProp.$remove;
                            targetRemoveArray = targetRemoveArray ? targetRemoveArray.concat(valuesToRemove_2) : valuesToRemove_2.slice();
                            targetMetaProp.$remove = targetRemoveArray;
                            break;
                        }
                    }
                };
                for (var _b = 0, metaInstructions_2 = metaInstructions; _b < metaInstructions_2.length; _b++) {
                    var mi = metaInstructions_2[_b];
                    _loop_2(mi);
                }
                continue;
            }
        }
        targetDelta[key] = val;
    }
    return targetDelta;
}
//# sourceMappingURL=delta-merge.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/index.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/index.js ***!
  \**********************************************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _kedbackend_collection__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"]; });

/* harmony import */ var _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _kedbackend_repo__WEBPACK_IMPORTED_MODULE_2__["KedBackendRepo"]; });

/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_3__["KedBackendSubscription"]; });

/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _kedbackend_writer__WEBPACK_IMPORTED_MODULE_4__["KedBackendWriter"]; });

/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _mutation_queue__WEBPACK_IMPORTED_MODULE_5__["MutationQueue"]; });

/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _query_set__WEBPACK_IMPORTED_MODULE_6__["QuerySet"]; });

/* harmony import */ var _observable_mixin__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../observable/mixin */ "../kedbackend/js/dist/js/observable/mixin.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _observable_mixin__WEBPACK_IMPORTED_MODULE_7__["mixin"]; });









//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js":
/*!**************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js ***!
  \**************************************************************************/
/*! exports provided: KedBackendCollection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return KedBackendCollection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-subscription */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js");
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var _observable_collection__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable/collection */ "../kedbackend/js/dist/js/observable/collection.js");






/**
 * Represents a "live" query against a table or filtered table.
 */
var KedBackendCollection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KedBackendCollection, _super);
    function KedBackendCollection(repo, table, query) {
        var _this = _super.call(this, function (observer) {
            var subscription = new _kedbackend_subscription__WEBPACK_IMPORTED_MODULE_2__["KedBackendSubscription"](observer, _this);
            _this.repo.querySet.subscribe(subscription);
            return subscription;
        }) || this;
        _this.repo = repo;
        _this.table = table;
        _this.query = query;
        return _this;
    }
    Object.defineProperty(KedBackendCollection.prototype, "queryKey", {
        get: function () {
            return _kedbackend_query__WEBPACK_IMPORTED_MODULE_4__["KedBackendQuery"].queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendCollection.prototype, "includes", {
        get: function () {
            return this._includes || (this._includes = [].concat(this.query.include || []));
        },
        enumerable: true,
        configurable: true
    });
    KedBackendCollection.prototype.applyQuery = function (query) {
        return new KedBackendCollection(this.repo, this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query, query));
    };
    KedBackendCollection.prototype.addToQueryArrayProp = function (arrayProp, entries) {
        var _a;
        return this.applyQuery((_a = {}, _a[arrayProp] = (this.query[arrayProp] || []).concat(entries), _a));
    };
    KedBackendCollection.prototype.addFlags = function () {
        var flags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            flags[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("flags", flags);
    };
    KedBackendCollection.prototype.debug = function () {
        return this.applyQuery({ debug: true });
    };
    KedBackendCollection.prototype.idsOnly = function () {
        return this.addFlags("idsOnly");
    };
    KedBackendCollection.prototype.idsAndNamesOnly = function () {
        return this.addFlags("idsAndNamesOnly");
    };
    KedBackendCollection.prototype.includeIdsOnly = function () {
        return this.addFlags("includeIdsOnly");
    };
    KedBackendCollection.prototype.includeIdsAndNamesOnly = function () {
        return this.addFlags("includeIdsAndNamesOnly");
    };
    KedBackendCollection.prototype.between = function (from, to) {
        return this.applyQuery({ from: from, to: to });
    };
    KedBackendCollection.prototype.role = function (role) {
        return this.applyQuery({ role: role });
    };
    KedBackendCollection.prototype.hasEdgesFrom = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesFrom(" + JSON.stringify(ids) + ")");
        var hef = this.addToQueryArrayProp("hasEdgesFrom", ids);
        return options && options.includeDeltaEdges ?
            hef.addFlags("includeDeltaEdges") :
            hef;
    };
    KedBackendCollection.prototype.hasEdgesTo = function (ids, options) {
        if (ids.length === 0 || ids.some(function (id) { return !id; }))
            throw new Error("Invalid id list given to Collection.hasEdgesTo(" + JSON.stringify(ids) + ")");
        var het = this.addToQueryArrayProp("hasEdgesTo", ids);
        return options && options.includeDeltaEdges ?
            het.addFlags("includeDeltaEdges") :
            het;
    };
    KedBackendCollection.prototype.id = function (id) {
        var _this = this;
        return this.applyQuery({ ids: [id] }).single({
            onZero: function () { throw new Error("Could not find entity in " + _this.table + " with id " + id); },
            onMany: function () { throw new Error("Multiple entries in " + _this.table + " with id " + id); },
        });
    };
    KedBackendCollection.prototype.ids = function (ids) {
        return this.applyQuery({ ids: ids });
    };
    KedBackendCollection.prototype.name = function (name) {
        return this.applyQuery({ name: name });
    };
    KedBackendCollection.prototype.tags = function () {
        var tags = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            tags[_i] = arguments[_i];
        }
        return this.applyQuery({ tags: tags });
    };
    KedBackendCollection.prototype.branchId = function (branchId) {
        return this.applyQuery({ branchId: branchId });
    };
    KedBackendCollection.prototype.include = function () {
        var graphs = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            graphs[_i] = arguments[_i];
        }
        return this.addToQueryArrayProp("include", graphs);
    };
    KedBackendCollection.prototype.cacheOptimized = function () {
        return this.applyQuery({ cacheBust: _cache_bust__WEBPACK_IMPORTED_MODULE_3__["CacheBust"].getCacheBust(this.table, this.query, this.repo.getUser(), this.includes) });
    };
    KedBackendCollection.prototype.mutationsOnEmpty = function (mutationFactory) {
        var tx = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_1__["BatchRunner"]();
        mutationFactory(tx);
        return this.applyQuery({ mutationsOnEmpty: tx.mutationRequests });
    };
    KedBackendCollection.prototype.single = function (throwers) {
        var _this = this;
        var _a = throwers || {}, onZero = _a.onZero, onMany = _a.onMany;
        return this.toValue().map(function (items) {
            if (items.length === 0) {
                if (onZero)
                    onZero();
                else
                    throw new Error("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but none was found.");
            }
            if (items.length > 1) {
                debugger;
                if (onMany)
                    onMany();
                else
                    console.log("Single item of " + _this.table + " expected to be returned by query " + JSON.stringify(_this.query) + " but " + items.length + " was found.");
            }
            return items[0];
        });
    };
    /*combineLatest<TOther>(other: QueryObservable<TOther>) {
      return this.render(x => x).combineLatest(other);
    }*/
    KedBackendCollection.prototype.update = function (doc, changes, debounce) {
        if (debounce === void 0) { debounce = 1000; }
        this.repo.writer.mutate([{
                op: 'update',
                table: this.table,
                branchId: this.query.branchId,
                id: doc.id,
                deltaDoc: changes,
                targetName: doc.name
            }], debounce);
    };
    KedBackendCollection.prototype.addRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'add-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.removeRelated = function (id, label, relatedDoc) {
        this.repo.writer.mutate([{
                op: 'remove-related',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedDoc: relatedDoc
            }], 0);
    };
    KedBackendCollection.prototype.undoLink = function (id, label, relatedId) {
        if (!this.query.branchId)
            throw new Error("undo links can only be performed on branches");
        this.repo.writer.mutate([{
                op: 'undo-link',
                table: this.table,
                branchId: this.query.branchId,
                id: id,
                graphProp: label,
                relatedId: relatedId
            }], 0);
    };
    KedBackendCollection.prototype.delete = function () {
        var _this = this;
        var ids = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            ids[_i] = arguments[_i];
        }
        this.repo.writer.mutate(ids.map(function (id) { return ({
            op: 'delete',
            table: _this.table,
            id: id
        }); }), 0);
    };
    KedBackendCollection.prototype.unsubscribe = function (subscription) {
        this.repo.querySet.unsubscribe(subscription);
    };
    return KedBackendCollection;
}(_observable_collection__WEBPACK_IMPORTED_MODULE_5__["Collection"]));

/*mixin(
  KedBackendCollection.prototype,
  MappedCollection.prototype,
  "map", "flat", "concat", "render", "load");*/
//# sourceMappingURL=kedbackend-collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js ***!
  \*********************************************************************/
/*! exports provided: KedBackendQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return KedBackendQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ked-backend-client/utils */ "../kedbackend/js/dist/js/ked-backend-client/utils.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");




var KedBackendQuery = /** @class */ (function () {
    function KedBackendQuery(table, query, user, repo, mutationQueue) {
        this.table = table;
        this.query = query;
        this.user = user;
        this.repo = repo;
        this.mutationQueue = mutationQueue;
        this.subscriptions = [];
        this.data = [];
        this.gotInitialResponse = false;
        this.invalid = false;
        this.loadedVersion = 0;
        this._loadPromise = null;
        this.includes = query.include ?
            typeof query.include === 'string' ?
                [query.include] :
                query.include :
            [];
    }
    KedBackendQuery.queryKey = function (table, query) {
        var mutationsOnEmpty = query.mutationsOnEmpty, comparableProps = tslib__WEBPACK_IMPORTED_MODULE_0__["__rest"](query, ["mutationsOnEmpty"]);
        return table + JSON.stringify(comparableProps);
    };
    Object.defineProperty(KedBackendQuery.prototype, "queryKey", {
        get: function () {
            return KedBackendQuery.queryKey(this.table, this.query);
        },
        enumerable: true,
        configurable: true
    });
    KedBackendQuery.prototype.subscribe = function (subscription) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.subscriptions.push(subscription);
                        if (!(this.gotInitialResponse && !this.invalid)) return [3 /*break*/, 1];
                        data = this.getDataWithMutationsApplied(this.mutationQueue.get(), true, this.data);
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 1:
                        data = this.queryLocally();
                        if (!data) return [3 /*break*/, 2];
                        this.data = data;
                        this.error = null;
                        subscription.notifySubscriber(data, this.error);
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.load()];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var loadPromise;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.gotInitialResponse) {
                            // mutationsOnEmpty should never be used twice.
                            delete this.query.mutationsOnEmpty;
                        }
                        if (!(!version && this._loadPromise)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this._loadPromise];
                    case 1: 
                    // loading is ongoing, and caller does not require a recent refresh.
                    // wait for the ongoing load to complete
                    return [2 /*return*/, _a.sent()];
                    case 2:
                        version = version || this.repo.writer.persistedVersion.value;
                        loadPromise = this._loadPromise = this._load(version).then(function (data) {
                            if (_this._loadPromise === loadPromise) {
                                _this.data = data;
                                _this.loadedVersion = Math.max(_this.loadedVersion, version);
                            }
                        }).catch(function (error) {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. The error is the final result. Set it.
                                _this.error = error;
                            }
                        }).then(function () {
                            if (_this._loadPromise === loadPromise) {
                                // Noone has refreshed our load. We're finished. Data or error is already set.
                                // Mark gotInitialResponse to true and notify subscribers.
                                _this._loadPromise = null;
                                _this.gotInitialResponse = true;
                                _this.notifySubscribers(_this.mutationQueue.get());
                            }
                            else {
                                // A more recent call to load() is ongoing, OR was ongoing but responded
                                // before us.
                                // In any case return this._loadPromise. If it's ongoing we'll wait for it
                                // to finish. If it's null, we'll be returning finally here without
                                // any action, because the action was taken by the refresher.
                                return _this._loadPromise; // Wait for the refreshed load to complete
                            }
                        });
                        return [4 /*yield*/, loadPromise];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype._load = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.mutationQueue.affectsQuery(this.table, this.query, this.includes)) return [3 /*break*/, 2];
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        return [4 /*yield*/, this.repo.writer.waitForVersionToPersist(version)];
                    case 1:
                        // There are outgoing mutations that affects this query.
                        // Need to wait till they reach server and server responds with OK before querying
                        // the server. Otherwise, we may get inaccurate data from server.
                        _a.sent();
                        _a.label = 2;
                    case 2: return [4 /*yield*/, this.queryServer()];
                    case 3: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    KedBackendQuery.prototype.unsubscribe = function (subscription) {
        this.subscriptions = this.subscriptions.filter(function (s) { return s !== subscription; });
    };
    KedBackendQuery.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _i, mutations_1, m, data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.data) return [3 /*break*/, 9];
                        _i = 0, mutations_1 = mutations;
                        _a.label = 1;
                    case 1:
                        if (!(_i < mutations_1.length)) return [3 /*break*/, 8];
                        m = mutations_1[_i];
                        if (!(m.op === 'clear-branch' && (m.branchId === this.query.branchId))) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                    case 3:
                        if (!(m.op === 'merge' && (!m.targetBranchId ||
                            m.branchId === this.query.branchId ||
                            m.targetBranchId === this.query.branchId))) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 4:
                        _a.sent();
                        return [2 /*return*/];
                    case 5:
                        if (!(m.op === 'update' && ((m.deltaDoc.tags && this.query.tags) ||
                            (m.deltaDoc.name && this.query.name)))) return [3 /*break*/, 7];
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        return [4 /*yield*/, this.refreshOrInvalidate(version)];
                    case 6:
                        // A tag may have been added, or renamed, and
                        // the query is dependent on the same property.
                        // The query must be refreshed from server as we cannot
                        // commit the mutations locally as we don't have all info.
                        _a.sent();
                        return [2 /*return*/];
                    case 7:
                        _i++;
                        return [3 /*break*/, 1];
                    case 8:
                        data = this.getDataWithMutationsApplied(mutations, false, this.data);
                        this.data = data;
                        _a.label = 9;
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.refreshOrInvalidate = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.subscriptions.length === 0)) return [3 /*break*/, 1];
                        this.invalid = true;
                        return [3 /*break*/, 3];
                    case 1: return [4 /*yield*/, this.load(version)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendQuery.prototype.notifySubscribers = function (optimisticMutations) {
        var _this = this;
        if (this.data && this.gotInitialResponse) {
            var data_1 = this.getDataWithMutationsApplied(optimisticMutations, true, this.data);
            this.subscriptions.forEach(function (s) {
                s.notifySubscriber(data_1, _this.error);
            });
        }
    };
    KedBackendQuery.prototype.queryLocally = function () {
        return this.repo.querySet.queryLocally(this.table, this.query, this.includes);
    };
    KedBackendQuery.prototype.queryServer = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var data;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.repo.getClient().list(this.table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.query))];
                    case 1:
                        data = _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    KedBackendQuery.prototype.getDataWithMutationsApplied = function (mutations, optimistic, data) {
        var _this = this;
        mutations.forEach(function (mutation) {
            data = _this.applyMutationsOnData(data, mutation, optimistic);
        });
        return data;
    };
    KedBackendQuery.prototype.applyMutationsOnData = function (data, m, optimistic) {
        if (Object(_utils__WEBPACK_IMPORTED_MODULE_2__["branchSensitive"])(m) && m.branchId != this.query.branchId)
            return data;
        var _a = this, table = _a.table, includes = _a.includes, listOptions = _a.query;
        var sourceIds = listOptions.hasEdgesFrom ? [].concat(listOptions.hasEdgesFrom || []) : [];
        var requestedTags = listOptions.tags ? [].concat(listOptions.tags || []) : [];
        switch (m.op) {
            case 'update': {
                return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                    if (doc.id === m.id) {
                        // Apply delta on updated document
                        var updatedDoc = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(doc, m.deltaDoc);
                        if (optimistic)
                            updatedDoc.$meta = 'updating';
                        return updatedDoc;
                    }
                    // If id does not apply to this doc, search in graphs the id is found
                    // among graph included docs, and if so, update that one:
                    includes.forEach(function (label) {
                        var _a;
                        var includedDocs = doc[label];
                        if (includedDocs) {
                            var updatedArray = Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(includedDocs, function (related) {
                                if (related.id !== m.id)
                                    return related;
                                var updatedRelated = Object(_delta_merge__WEBPACK_IMPORTED_MODULE_3__["applyDelta"])(related, m.deltaDoc);
                                if (optimistic)
                                    updatedRelated.$meta = 'updating';
                                return updatedRelated;
                            });
                            if (updatedArray !== includedDocs) {
                                doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[label] = updatedArray, _a));
                            }
                        }
                    });
                    return doc;
                });
            }
            case 'add-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    // If expression is `db.courseBlocks....whatever.. .include("abilities")`, detect: db.courseBlocks.addRelated(blockId, 'abilities', ...)
                    // ...because table = 'courseBlocks' and includes has "abilities".
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        if (doc.id !== m.id)
                            return doc;
                        var relatedDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m.relatedDoc);
                        if (optimistic)
                            relatedDoc.$meta = 'adding';
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = doc[m.graphProp].concat([relatedDoc]), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id)) {
                        // If expression is:
                        //   `db.courseBlocks.hasEdgesFrom([courseId])`  (meaning table='courseBlocks' and sourceIds includes courseId)
                        // , detect: db.courseInstances.addRelated(courseId, 'courseBlocks', ....) // m.graphProp === 'blocks'--> getTableFromLabel --> 'courseBlocks'
                        if (table === Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(m.table, m.graphProp)) {
                            if (!listOptions.tags)
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            if (m.relatedDoc.tags && requestedTags.some(function (tag) { return m.relatedDoc.tags.includes(tag); })) {
                                return data.concat(this.setGraphProps(m.relatedDoc));
                            }
                        }
                    }
                }
                if (listOptions.ids && listOptions.ids.some(function (id) { return id === m.relatedDoc.id; })) {
                    // A certain ID is observed. A doc with this id is being added.
                    // Add the doc to the result. Exactly this WILL happen in the following typical scenario:
                    // 1. User adds a related document to a list.
                    // 2. Document remains within the MutationQueue while batch-request is being processed by server.
                    // 3. User clicks the added item to edit or view it (or our component redirects to its editor)
                    // 4. A new query of that particular ID is subscribed to {ids=[theId]}
                    //    KedBackendQuery.subscribe then does this:
                    //      1. Call queryLocally() before querying server
                    //      2. queryLocally() inspects mutations and finds a match, returning an empty list
                    //         (assumes as we are adding it, it can't exist on the server anyway)
                    //      3. KedBackendQUery applies mutations onto the empty list, and ends up here to add
                    //         it optimistically.
                    //      4. When server responds with 200 OK, calls us here again with optimistic=false
                    //         to "persist" it in the query's data array.
                    //      4B: If not 200 OK, mutation may be gone and the subscriber will se an error page
                    //         "Could not find entity with id X." along with a red error message on the screen
                    //         about that it failed to save on server.
                    return data.concat(this.setGraphProps(m.relatedDoc));
                }
                return data;
            case 'remove-related':
                if (table === m.table && includes.indexOf(m.graphProp) !== -1) {
                    return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                        var _a;
                        var includedDocs = doc[m.graphProp];
                        if (!includedDocs)
                            return doc;
                        if (doc.id !== m.id)
                            return doc;
                        return tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_a = {}, _a[m.graphProp] = optimistic ?
                            // Mark related-doc-to-remove with $meta: 'deleting'
                            includedDocs.map(function (d) { return d.id !== m.relatedDoc.id ?
                                d : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }); }) :
                            // Delete related-doc-to-remove from doc[grapProp]:
                            includedDocs.filter(function (d) { return d.id !== m.relatedDoc.id; }), _a));
                    });
                }
                if (listOptions.hasEdgesFrom) {
                    if (sourceIds.includes(m.id))
                        return optimistic ?
                            data.map(function (d) { return d.id === m.relatedDoc.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                            data.filter(function (d) { return d.id !== m.relatedDoc.id; });
                }
                return data;
            case 'delete':
                if (table === m.table) {
                    return data.filter(function (d) { return d.id !== m.id; });
                }
                else if (listOptions.include) {
                    var includedTables = includes
                        .map(function (label) { return ({ label: label, table: Object(_utils__WEBPACK_IMPORTED_MODULE_2__["getTableFromLabel"])(table, label) }); });
                    var labels_1 = includedTables.filter(function (_a) {
                        var table = _a.table;
                        return table === m.table;
                    });
                    if (labels_1.length > 0) {
                        return Object(_ked_backend_client_utils__WEBPACK_IMPORTED_MODULE_1__["updateArray"])(data, function (doc) {
                            labels_1.forEach(function (_a) {
                                var label = _a.label;
                                var _b;
                                var relatedDocs = doc[label];
                                if (relatedDocs) {
                                    doc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc, (_b = {}, _b[label] = optimistic ?
                                        relatedDocs.map(function (d) { return d.id === m.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, d, { $meta: 'deleting' }) : d; }) :
                                        relatedDocs.filter(function (_a) {
                                            var id = _a.id;
                                            return id !== m.id;
                                        }), _b));
                                }
                            });
                            return doc;
                        });
                    }
                }
                return data;
            default:
                return data;
        }
    };
    KedBackendQuery.prototype.setGraphProps = function (doc) {
        var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
        this.includes.forEach(function (label) { return copy[label] = copy[label] || []; });
        return copy;
    };
    return KedBackendQuery;
}());

//# sourceMappingURL=kedbackend-query.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js":
/*!********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-repo.js ***!
  \********************************************************************/
/*! exports provided: KedBackendRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return KedBackendRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./kedbackend-collection */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-collection.js");
/* harmony import */ var _query_set__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./query-set */ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./kedbackend-writer */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js");
/* harmony import */ var _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-collection */ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-collection.js");







var KedBackendRepo = /** @class */ (function () {
    function KedBackendRepo(getClient, getUser, getUserDisplayName, defaultQueryOptions, mutationQueue, querySet, writer, cacheOptimized) {
        var _this = this;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this.defaultQueryOptions = defaultQueryOptions;
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.writer = writer;
        this.cacheOptimized = cacheOptimized;
        if (!defaultQueryOptions)
            this.defaultQueryOptions = {};
        if (!mutationQueue)
            this.mutationQueue = new _mutation_queue__WEBPACK_IMPORTED_MODULE_4__["MutationQueue"]();
        if (!querySet)
            this.querySet = new _query_set__WEBPACK_IMPORTED_MODULE_3__["QuerySet"](this.mutationQueue);
        if (!writer)
            this.writer = new _kedbackend_writer__WEBPACK_IMPORTED_MODULE_5__["KedBackendWriter"](this.mutationQueue, this.querySet, getClient, getUser, getUserDisplayName);
        Object.keys(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_1__["tables"]).forEach(function (table) {
            var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](_this, table, defaultQueryOptions || {});
            if (cacheOptimized) {
                collection = collection.cacheOptimized();
            }
            _this[table] = collection;
        });
        this.deltas = new _delta_collection_delta_collection__WEBPACK_IMPORTED_MODULE_6__["DeltaCollection"](this.writer.deltaCache, {
            branchId: this.defaultQueryOptions.branchId // If branchId is undefined. DeltaCollection will respond with Error on subscribe()
        });
    }
    KedBackendRepo.prototype.table = function (tableName) {
        var collection = new _kedbackend_collection__WEBPACK_IMPORTED_MODULE_2__["KedBackendCollection"](this, tableName, this.defaultQueryOptions);
        if (this.cacheOptimized)
            collection = collection.cacheOptimized();
        return collection;
    };
    KedBackendRepo.prototype._clone = function (queryOptions, cacheOptimized) {
        var clone = new KedBackendRepo(this.getClient, this.getUser, this.getUserDisplayName, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.defaultQueryOptions, queryOptions), this.mutationQueue, this.querySet, this.writer, cacheOptimized === undefined ? this.cacheOptimized : cacheOptimized);
        return clone;
    };
    KedBackendRepo.prototype.branch = function (branchId) {
        return this._clone({ branchId: branchId });
    };
    KedBackendRepo.prototype.role = function (role) {
        return this._clone({ role: role });
    };
    KedBackendRepo.prototype.optimizeCache = function () {
        return this._clone({}, true);
    };
    KedBackendRepo.prototype.clearBranch = function () {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot clear master branch");
        this.writer.mutate([{ op: 'clear-branch', branchId: this.defaultQueryOptions.branchId }], 0);
    };
    KedBackendRepo.prototype.merge = function (targetBranchId) {
        if (!this.defaultQueryOptions.branchId)
            throw new Error("Cannot merge from master branch");
        this.writer.mutate([{ op: 'merge', branchId: this.defaultQueryOptions.branchId, targetBranchId: targetBranchId }], 0);
    };
    KedBackendRepo.prototype.saveNow = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.writer.waitForVersionToPersist(this.writer.currentVersion)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedBackendRepo;
}());

//# sourceMappingURL=kedbackend-repo.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js":
/*!****************************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-subscription.js ***!
  \****************************************************************************/
/*! exports provided: KedBackendSubscription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return KedBackendSubscription; });
var KedBackendSubscription = /** @class */ (function () {
    function KedBackendSubscription(subscriber, collection) {
        this.subscriber = subscriber;
        this.collection = collection;
    }
    KedBackendSubscription.prototype.notifySubscriber = function (data, error) {
        try {
            if (error)
                this.subscriber([], error, this);
            else if (data !== this.lastNotifiedData) { // Will in-fact be equal by reference if data is same as last notification (as we use an immutable approach on data)
                this.lastNotifiedData = data;
                this.subscriber(data, error, this);
            }
        }
        catch (ex) {
            try {
                this.subscriber([], ex, this);
            }
            catch (ex2) {
                console.error("Error while notifying KedBackendSubscriber:", ex2, 'originally notified error:', ex);
            }
        }
    };
    KedBackendSubscription.prototype.unsubscribe = function () {
        this.collection.unsubscribe(this);
    };
    return KedBackendSubscription;
}());

//# sourceMappingURL=kedbackend-subscription.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js":
/*!**********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/kedbackend-writer.js ***!
  \**********************************************************************/
/*! exports provided: KedBackendWriter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return KedBackendWriter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _mutation_queue__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-queue */ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js");
/* harmony import */ var _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ked-backend-client */ "../kedbackend/js/dist/js/ked-backend-client/index.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _cache_bust__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache-bust */ "../kedbackend/js/dist/js/ked-backend-repo/cache-bust.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../observable */ "../kedbackend/js/dist/js/observable/index.js");
/* harmony import */ var _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./delta-collection/delta-cache */ "../kedbackend/js/dist/js/ked-backend-repo/delta-collection/delta-cache.js");







var KedBackendWriter = /** @class */ (function () {
    function KedBackendWriter(mutationQueue, querySet, getClient, getUser, getUserDisplayName) {
        this.mutationQueue = mutationQueue;
        this.querySet = querySet;
        this.getClient = getClient;
        this.getUser = getUser;
        this.getUserDisplayName = getUserDisplayName;
        this._timeoutId = null;
        this._isSavingPromise = null;
        this.currentVersion = 0;
        this.persistedVersion = new _observable__WEBPACK_IMPORTED_MODULE_5__["Emitter"](0);
        this.errorSubscribers = [];
        this.stateSubscribers = [];
        this.deltaCache = new _delta_collection_delta_cache__WEBPACK_IMPORTED_MODULE_6__["DeltaCache"](getClient, getUser, getUserDisplayName);
    }
    Object.defineProperty(KedBackendWriter.prototype, "isSaving", {
        get: function () { return !!this._isSavingPromise; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(KedBackendWriter.prototype, "isEdited", {
        get: function () { return this.mutationQueue.get().length > 0; },
        enumerable: true,
        configurable: true
    });
    KedBackendWriter.prototype.onError = function (callback) {
        this.errorSubscribers.push(callback);
    };
    KedBackendWriter.prototype.onStateChange = function (callback) {
        this.stateSubscribers.push(callback);
    };
    KedBackendWriter.prototype.off = function (callback) {
        this.errorSubscribers = this.errorSubscribers.filter(function (s) { return s !== callback; });
        this.stateSubscribers = this.stateSubscribers.filter(function (s) { return s !== callback; });
    };
    KedBackendWriter.prototype.dispatchError = function (error, retryable) {
        var _this = this;
        this.errorSubscribers.forEach(function (callback) {
            try {
                callback(error, retryable, _this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.dispatchStateChange = function () {
        var _this = this;
        this.stateSubscribers.forEach(function (callback) {
            try {
                callback(_this);
            }
            catch (_) { }
        });
    };
    KedBackendWriter.prototype.mutate = function (mutations, debounce) {
        this.mutationQueue.add(mutations);
        ++this.currentVersion;
        this.dispatchStateChange();
        this.querySet.notifySubscribers();
        this.deltaCache.applyMutations(this.mutationQueue.get(), { optimistic: true });
        if (!this._isSavingPromise) {
            if (this._timeoutId)
                clearTimeout(this._timeoutId);
            this._timeoutId = setTimeout(this.save.bind(this), debounce);
        }
        // If isSaving, we don't need to do anything, becase it will re-check if additional
        // mutations have come, when saving is done.
    };
    KedBackendWriter.prototype.retrySave = function () {
        return this.save();
    };
    KedBackendWriter.prototype.waitForVersionToPersist = function (version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedVersion;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.persistedVersion.load()];
                    case 1:
                        persistedVersion = _a.sent();
                        if (!(persistedVersion < version)) return [3 /*break*/, 3];
                        this.save(); // Be more eager to save
                        return [4 /*yield*/, this.persistedVersion.filter(function (persistedVersion) { return persistedVersion >= version; }).load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.save = function () {
        var _this = this;
        if (this._timeoutId)
            clearTimeout(this._timeoutId);
        if (this._isSavingPromise)
            return this._isSavingPromise;
        if (!this.isEdited)
            return Promise.resolve();
        this._timeoutId = null;
        this._isSavingPromise = this._save();
        this._isSavingPromise.catch(function () { }).then(function () { return _this._isSavingPromise = null; });
        return this._isSavingPromise;
    };
    KedBackendWriter.prototype._save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var mutations, version, mutationRequests, res_1, etagMutations, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.dispatchStateChange();
                        mutations = this.mutationQueue.get();
                        version = this.currentVersion;
                        this.mutationQueue.moveToSavingQueue();
                        mutationRequests = this.mapMutations(mutations);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 6, 11, 12]);
                        return [4 /*yield*/, this.getClient().batch(mutationRequests)];
                    case 2:
                        res_1 = _a.sent();
                        etagMutations = Object.keys(res_1.newEtags).map(function (id) { return ({
                            op: 'update',
                            table: null,
                            id: id,
                            deltaDoc: { $etag: res_1.newEtags[id] },
                            targetName: null // We don't have the target name. But this mutation won't be visible in a DeltaCollection anyway, so it wont be used.
                        }); });
                        // Invalidate cache
                        _cache_bust__WEBPACK_IMPORTED_MODULE_4__["CacheBust"].invalidateCache(mutationRequests, this.getUser());
                        // Commmit mutations along with etagMutations into queries cached data
                        this.persistedVersion.dispatch(version);
                        this.deltaCache.applyMutations(mutations, { optimistic: false });
                        return [4 /*yield*/, this.querySet.commitMutations(_mutation_queue__WEBPACK_IMPORTED_MODULE_1__["MutationQueue"].merge(mutations, etagMutations), version)];
                    case 3:
                        _a.sent();
                        // On success, clear saving queue as the mutations will now be committed to all query's data instead.
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        // Finally, notify subscribers so that views get updated with committed results
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 5];
                        // Additional mutations happend while we were saving. Handle them as well.
                        return [4 /*yield*/, this._save()];
                    case 4:
                        // Additional mutations happend while we were saving. Handle them as well.
                        _a.sent();
                        _a.label = 5;
                    case 5: return [3 /*break*/, 12];
                    case 6:
                        error_1 = _a.sent();
                        this.persistedVersion.dispatchError(error_1);
                        if (!(error_1 && error_1.name && error_1.name.startsWith("http4"))) return [3 /*break*/, 9];
                        // Access Control denied, bad request or similar. Throw mutations away.
                        this.dispatchError(error_1, false);
                        this.mutationQueue.clearSavingQueue();
                        this.dispatchStateChange(); // isEdited may have turned to false
                        this.querySet.notifySubscribers();
                        if (!(this.mutationQueue.get().length > 0)) return [3 /*break*/, 8];
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        return [4 /*yield*/, this._save()];
                    case 7:
                        // Ho ho! Additional mutations happend while we were saving. Handle them alone. THey might be more lucky.
                        _a.sent();
                        _a.label = 8;
                    case 8: return [3 /*break*/, 10];
                    case 9:
                        this.dispatchError(error_1, true);
                        _a.label = 10;
                    case 10: return [3 /*break*/, 12];
                    case 11:
                        this.dispatchStateChange();
                        return [7 /*endfinally*/];
                    case 12: return [2 /*return*/];
                }
            });
        });
    };
    KedBackendWriter.prototype.mapMutations = function (mutations) {
        var br = new _ked_backend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
        mutations.forEach(function (m) {
            switch (m.op) {
                case 'update':
                    br.update(m.table, m.id, m.deltaDoc, m.branchId);
                    break;
                case 'add-related':
                    if (!m.relatedDoc.$etag) {
                        // No $etag means this is a new document. Add it before linking to it:
                        br.add(kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_3__["tables"][m.table].relationships[m.graphProp], m.relatedDoc, m.branchId);
                    }
                    br.link2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'remove-related':
                    br.unlink2(m.table, m.id, m.graphProp, m.relatedDoc.id, m.branchId);
                    break;
                case 'undo-link':
                    br.undoLink(m.table, m.id, m.graphProp, m.relatedId, m.branchId);
                    break;
                case 'delete':
                    br.delete(m.table, m.id);
                    break;
                case 'clear-branch':
                    br.clearBranch(m.branchId);
                    break;
                case 'merge':
                    br.merge(m.branchId, m.targetBranchId);
                    break;
            }
        });
        return br.mutationRequests;
    };
    return KedBackendWriter;
}());

//# sourceMappingURL=kedbackend-writer.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/mutation-queue.js ***!
  \*******************************************************************/
/*! exports provided: MutationQueue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return MutationQueue; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");
/* harmony import */ var _delta_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./delta-merge */ "../kedbackend/js/dist/js/ked-backend-repo/delta-merge.js");



var MutationQueue = /** @class */ (function () {
    function MutationQueue() {
        this.queue = [];
        this.savingQueue = [];
    }
    MutationQueue.prototype.add = function (mutations) {
        this.queue = MutationQueue.merge(this.queue, mutations);
    };
    MutationQueue.prototype.moveToSavingQueue = function () {
        this.savingQueue = MutationQueue.merge(this.savingQueue, this.queue);
        this.queue = [];
    };
    MutationQueue.prototype.clearSavingQueue = function () {
        this.savingQueue = [];
    };
    MutationQueue.prototype.get = function () {
        return this.savingQueue.concat(this.queue);
    };
    MutationQueue.prototype.affectsQuery = function (table, query, includes) {
        var mutations = this.get();
        if (mutations.some(function (m) { return m.op === 'merge' || m.op === 'clear-branch'; }))
            return true;
        if (query.ids) {
            // A query with "ids" filter will be easy to detect a no-match on:
            return mutations.some(function (m) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) || (!Object(_utils__WEBPACK_IMPORTED_MODULE_1__["branchSensitive"])(m) || m.branchId === query.branchId) &&
                query.ids.includes(m.id); });
        }
        // Otherwise, check if mutations affect same branch and table. Could be done more fine grained,
        // but that would only be a suboptimization.
        return mutations.some(function (m) {
            return m.op === 'delete' ?
                m.table === table || (includes.some(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label) === m.table; })) :
                Object(_utils__WEBPACK_IMPORTED_MODULE_1__["globalOp"])(m) ? true :
                    m.branchId == query.branchId &&
                        (m.table === table || (m.op !== 'update' && ([table].concat(includes.map(function (label) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(table, label); })).some(function (table) { return Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getTableFromLabel"])(m.table, m.graphProp) === table; }))));
        });
    };
    MutationQueue.merge = function (queue1, queue2) {
        var mutableQueue1 = queue1.slice();
        var mutableQueue2 = queue2.slice();
        //if (mutableQueue1.length > 0) debugger;
        var len = queue1.length;
        var _loop_1 = function (i) {
            var m = queue1[i];
            if (m.op === 'update') {
                var overlappingIdOpIdx = mutableQueue2.findIndex(function (newMut) {
                    return newMut.op === 'update' &&
                        newMut.branchId === m.branchId &&
                        newMut.id === m.id;
                });
                if (overlappingIdOpIdx >= 0) {
                    mutableQueue1[i] = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, m, { deltaDoc: Object(_delta_merge__WEBPACK_IMPORTED_MODULE_2__["mergeDeltas"])(m.deltaDoc, mutableQueue2[overlappingIdOpIdx].deltaDoc) });
                    mutableQueue2.splice(overlappingIdOpIdx, 1);
                }
            }
        };
        for (var i = 0; i < len; ++i) {
            _loop_1(i);
        }
        return mutableQueue1.concat(mutableQueue2);
    };
    return MutationQueue;
}());

//# sourceMappingURL=mutation-queue.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/query-set.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/query-set.js ***!
  \**************************************************************/
/*! exports provided: QuerySet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return QuerySet; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./kedbackend-query */ "../kedbackend/js/dist/js/ked-backend-repo/kedbackend-query.js");
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./utils */ "../kedbackend/js/dist/js/ked-backend-repo/utils.js");




var QuerySet = /** @class */ (function () {
    function QuerySet(mutationQueue) {
        this.mutationQueue = mutationQueue;
        this.queries = [];
    }
    QuerySet.prototype.commitMutations = function (mutations, version) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this.queries.map(function (q) { return q.commitMutations(mutations, version); }))];
                    case 1:
                        _a.sent();
                        this.cleanupInvalidQueries();
                        return [2 /*return*/];
                }
            });
        });
    };
    QuerySet.prototype.cleanupInvalidQueries = function () {
        this.queries = this.queries.filter(function (q) {
            if (q.invalid) {
                if (q.timeoutHandle) {
                    clearTimeout(q.timeoutHandle);
                    q.timeoutHandle = null;
                }
                return false;
            }
            return true;
        });
    };
    QuerySet.prototype.notifySubscribers = function () {
        var optimisticMutations = this.mutationQueue.get();
        this.queries.forEach(function (q) {
            q.notifySubscribers(optimisticMutations);
        });
    };
    QuerySet.prototype.findQuery = function (table, query) {
        return this.queries.find(function (q) { return q.queryKey === _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"].queryKey(table, query); });
    };
    QuerySet.prototype.queryLocally = function (table, query, includes) {
        // For now, only handle this very common and special case (which
        // will save a lot of unnescessary network traffic if I am thinking right...)
        var mutations = this.mutationQueue.get();
        // Check if the query wants to get a single entity by its ID:
        if (query.ids && query.ids.length === 1) {
            // And if so, if we have an outgoing mutation to create that entity:
            if (mutations.some(function (m) { return m.op === 'add-related' && m.relatedDoc.id === query.ids[0]; })) {
                // Then return an EMPTY response, signalling that we can resolve this locally,
                // but let the optistic feature of KedBackendQuery apply the mutation before
                // notifying subscribers (we don't want it to be persistent before the server
                // has accepted the mutation)
                return [];
            }
        }
        // OK, another quite common case is when we ask for a certain ID and that ID replies
        // within another query
        if (query.hasEdgesFrom || query.hasEdgesTo)
            return null; // Not possible to handle
        if (!query.ids)
            return null; // For now, just take hight for this particular and most common case!
        var _loop_1 = function (q) {
            if (!q.gotInitialResponse)
                return "continue";
            if (q.query.branchId !== query.branchId)
                return "continue";
            if (q.query.flags)
                return "continue"; // It would be complex to support various flags. Query's data may include ids only. Can't rely on the query.
            var qIncludes = q.includes;
            if (qIncludes.length > 0 && (!query.include || query.include.length === 0)) {
                // We don't include, but this query does. Check if we can find our result within it.
                var label = qIncludes.find(function (l) { return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_2__["tables"][q.table]["relationships"][l] === table; });
                if (label) {
                    var res_1 = {};
                    for (var _i = 0, _a = q.data; _i < _a.length; _i++) {
                        var entity = _a[_i];
                        var subData = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, entity[label]);
                        subData.forEach(function (r) { return res_1[r.id] = r; });
                    }
                    var result_1 = Object.keys(res_1).map(function (id) { return res_1[id]; });
                    // Only return result if we could look up every requested ID:
                    if (!query.ids.every(function (id) { return result_1.some(function (x) { return x.id === id; }); }))
                        return "continue";
                    return { value: result_1 };
                }
            }
            if (!includes.every(function (label) { return qIncludes.includes(label); }))
                return "continue";
            // Lastly, if the query includes all graphs that we do, pick the subset from that query.
            // Concrete example: We observe a certain Task by ID and want its knowledgeRequirements along with it,
            // and there's another query of all tasks that also includes knowledgeRequirements. Use it. 
            if (q.table === table) {
                var result_2 = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["queryArray"])(query, q.data);
                // Only return result if we could look up every requested ID:
                if (!query.ids.every(function (id) { return result_2.some(function (x) { return x.id === id; }); }))
                    return "continue";
                return { value: result_2 };
            }
        };
        for (var _i = 0, _a = this.queries; _i < _a.length; _i++) {
            var q = _a[_i];
            var state_1 = _loop_1(q);
            if (typeof state_1 === "object")
                return state_1.value;
        }
    };
    QuerySet.prototype.subscribe = function (subscription) {
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (!kbQuery) {
            kbQuery = new _kedbackend_query__WEBPACK_IMPORTED_MODULE_1__["KedBackendQuery"](table, query, repo.getUser(), repo, this.mutationQueue);
            this.queries.push(kbQuery);
        }
        else {
            if (kbQuery.timeoutHandle) {
                clearTimeout(kbQuery.timeoutHandle);
                kbQuery.timeoutHandle = null;
            }
        }
        kbQuery.subscribe(subscription);
    };
    QuerySet.prototype.unsubscribe = function (subscription) {
        var _this = this;
        var _a = subscription.collection, table = _a.table, query = _a.query, repo = _a.repo;
        var kbQuery = this.findQuery(table, query);
        if (kbQuery) {
            // Prohibit further notifications to this subscription:
            kbQuery.unsubscribe(subscription);
            // Release unnescessary memory when there are no more subscriptions of this query, by removing the query itself
            // To that in a delayed manner, so that an unsubscribe() followed by an immediate subscribe() don't have to re-query the server:
            if (kbQuery.subscriptions.length === 0) {
                // Schedule for garbage collection in 5 minutes:
                kbQuery.timeoutHandle = setTimeout(function () {
                    // Check if kbQuery still has no subscriptions (not certain! A new subscriber may have come along...)
                    if (kbQuery.subscriptions.length === 0) {
                        // Still no subscriptions on it, time to release some memory and forget the in-memory cache of the query result
                        _this.queries = _this.queries.filter(function (q) { return q !== kbQuery; });
                    }
                }, this.queries.length > 50 ?
                    500 : // Don't host too many queries. Garbage collect this within 500 ms
                    5 * 60000); // Allow query in memory for another 5 minutes
            }
        }
    };
    return QuerySet;
}());

//# sourceMappingURL=query-set.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-backend-repo/utils.js":
/*!**********************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-backend-repo/utils.js ***!
  \**********************************************************/
/*! exports provided: getTableFromLabel, queryArray, AND, getFilterFromQuery, branchSensitive, globalOp */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTableFromLabel", function() { return getTableFromLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "queryArray", function() { return queryArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AND", function() { return AND; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilterFromQuery", function() { return getFilterFromQuery; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "branchSensitive", function() { return branchSensitive; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalOp", function() { return globalOp; });
/* harmony import */ var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json");
var kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0___namespace = /*#__PURE__*/__webpack_require__.t(/*! kedbackend-schema/schema.json */ "../kedbackend/KED.Backend.API/schema.json", 1);

function getTableFromLabel(table, label) {
    return kedbackend_schema_schema_json__WEBPACK_IMPORTED_MODULE_0__["tables"][table].relationships[label];
}
function queryArray(query, data) {
    var filter = getFilterFromQuery(query);
    return data.filter(filter);
}
function AND(filter1, filter2) {
    return function (x) { return filter1(x) && filter2(x); };
}
function getFilterFromQuery(query) {
    var filter = function (x) { return true; };
    if (query.from)
        return AND(filter, function (x) { return x.dateTime >= query.from; });
    if (query.to)
        return AND(filter, function (x) { return x.dateTime < query.to; });
    if (query.ids)
        return AND(filter, function (x) { return query.ids.includes(x.id); });
    if (query.name)
        return AND(filter, function (x) { return x.name === query.name; });
    if (query.tags)
        return AND(filter, function (x) { return x.tags && [].concat(query.tags || []).some(function (tag) { return x.tags.includes(tag); }); });
    // query.hasEdgesFrom and query.hasEdgesTo cannot by filtered here
    return filter;
}
function branchSensitive(m) {
    return m.op !== 'delete';
}
function globalOp(m) {
    return m.op === 'clear-branch' || m.op === 'merge';
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/index.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/index.js ***!
  \************************************************************/
/*! exports provided: KedModelMigratorMixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedModelMigratorMixin", function() { return KedModelMigratorMixin; });
/* harmony import */ var _migrate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate */ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js");

var KedModelMigratorMixin = function (client) {
    if (client.__migrator_mixed_in)
        return;
    client.__migrator_mixed_in = true;
    var get = client.get;
    var list = client.list;
    client.get = function (table, id, options) {
        var include = options && options.include;
        return get.apply(this, arguments).then(function (result) {
            Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(result, table, include && include.toString().split(','));
            return result;
        });
    };
    client.list = function (table, options) {
        var include = options && options.include;
        return list.apply(this, arguments).then(function (result) {
            result.forEach(function (doc) { return Object(_migrate__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, table, include && include.toString().split(',')); });
            return result;
        });
    };
    return client;
};
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js":
/*!*********************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateCourse; });
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");

function migrateCourse(course, graphs) {
    if (!course.modules)
        course.modules = [];
    course.modules.forEach(function (module) {
        if (!module.resources) {
            module.resources = [];
        }
        if (!module.taskIds) {
            module.taskIds = [];
        }
    });
    if (!course.responsibleTeachers) {
        course.responsibleTeachers = [];
    }
    // Earlier wrong spelling of resources
    if ('resourses' in course && !('resources' in course)) {
        course.resources = course.resourses;
        delete course.resourses;
    }
    if (!course.resources) {
        course.resources = [];
    }
    if (graphs) {
        graphs.forEach(function (label) {
            switch (label) {
                case 'tasks':
                    course.tasks.forEach(function (task) { return Object(_migrate_task__WEBPACK_IMPORTED_MODULE_0__["default"])(task); });
                    break;
            }
        });
    }
}
//# sourceMappingURL=migrate-course.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js":
/*!*******************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js ***!
  \*******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrateTask; });
function migrateTask(task) {
    if (!task.resources)
        task.resources = [];
}
//# sourceMappingURL=migrate-task.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/ked-model-migrator/migrate.js":
/*!**************************************************************!*\
  !*** ../kedbackend/js/dist/js/ked-model-migrator/migrate.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return migrate; });
/* harmony import */ var _migrate_course__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./migrate-course */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-course.js");
/* harmony import */ var _migrate_task__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./migrate-task */ "../kedbackend/js/dist/js/ked-model-migrator/migrate-task.js");


function migrate(doc, table, graphs) {
    switch (table) {
        case "courses":
            Object(_migrate_course__WEBPACK_IMPORTED_MODULE_0__["default"])(doc, graphs);
            break;
        case "tasks":
            Object(_migrate_task__WEBPACK_IMPORTED_MODULE_1__["default"])(doc);
            break;
    }
}
//# sourceMappingURL=migrate.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/collection.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/collection.js ***!
  \*********************************************************/
/*! exports provided: Collection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return Collection; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");





var Collection = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Collection, _super);
    function Collection(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Collection.prototype._map = function (mapper) {
        throw "mixedin";
    };
    Collection.from = function (x) {
        if (x.subscribe)
            return new Collection(function (s) { return x.subscribe(s); });
        if (Array.isArray(x)) {
            var emitter_1 = new _emitter__WEBPACK_IMPORTED_MODULE_4__["Emitter"](x);
            return new Collection(function (s) { return emitter_1.subscribe(s); });
        }
        throw new Error("ObservableCollection.from() can only take arrays or observables");
    };
    Collection.prototype.map = function (mapper) {
        return this._map(function (items) { return items.map(function (item) { return mapper(item); }); });
    };
    Collection.prototype.flat = function () {
        return this._map(function (items) { return [].concat.apply([], items); });
    };
    Collection.prototype.filter = function (filter) {
        return this._map(function (items) { return items.filter(filter); });
    };
    Collection.prototype.concat = function (other) {
        return Collection.from(this.toValue().combineLatest(other).map(function (_a) {
            var me = _a[0], other = _a[1];
            return me.concat(other);
        }));
    };
    Collection.prototype.orderBy = function (prop) {
        return this.toValue().map(function (array) { return array.slice().sort(function (a, b) {
            var aProp = a && a[prop];
            var bProp = b && b[prop];
            return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
        }); }).toCollection(function (x) { return x; });
    };
    Collection.prototype.toValue = function () {
        var _this = this;
        return new _value__WEBPACK_IMPORTED_MODULE_3__["Value"](function (s) { return _this.subscribe(s); });
    };
    Collection.prototype.groupBy = function (prop) {
        return this.toValue().map(function (items) {
            var rv = {};
            items.forEach(function (item) {
                var list = rv[item[prop]] || (rv[item[prop]] = []);
                list.push(item);
            });
            return rv;
        });
    };
    Collection.prototype.first = function () {
        return this.toValue().map(function (arr) { return arr[0]; });
    };
    return Collection;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Collection.prototype._map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Collection);
//# sourceMappingURL=collection.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/emitter.js":
/*!******************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/emitter.js ***!
  \******************************************************/
/*! exports provided: Emitter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return Emitter; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");


var Emitter = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Emitter, _super);
    function Emitter(initialValue) {
        var _this = _super.call(this, function (observer) {
            var subscription = {
                unsubscribe: function () { return _this.subscribers = _this.subscribers.filter(function (_a) {
                    var s = _a[0];
                    return s !== observer;
                }); },
            };
            _this.subscribers.push([observer, subscription]);
            if (_this.error)
                observer(null, _this.error, subscription);
            else
                observer(_this.value, undefined, subscription);
            return subscription;
        }) || this;
        _this.subscribers = [];
        _this.value = initialValue;
        return _this;
    }
    Emitter.prototype.dispatch = function (value) {
        this.value = value;
        this.error = undefined;
        this._dispatch();
    };
    Emitter.prototype.dispatchError = function (error) {
        this.error = error;
        this._dispatch();
    };
    Emitter.prototype._dispatch = function () {
        var _this = this;
        this.subscribers.forEach(function (_a) {
            var observer = _a[0], subscription = _a[1];
            try {
                observer(_this.value, _this.error, subscription);
            }
            catch (err) {
                observer(null, err, subscription);
            }
        });
    };
    return Emitter;
}(_value__WEBPACK_IMPORTED_MODULE_1__["Value"]));

//# sourceMappingURL=emitter.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/fiber-context.js":
/*!************************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/fiber-context.js ***!
  \************************************************************/
/*! exports provided: FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return FiberContext; });
var stack = [];
var currentFiber = null;
var providers = [function () { return currentFiber; }];
function pushFiber(fiber) {
    stack.push(currentFiber);
    currentFiber = fiber;
}
function popFiber() {
    currentFiber = stack.pop();
}
var FiberContext = {
    get current() { return currentFiber; },
    /*run: function rerun<R>(fiber: Fiber, fn: ()=>R): R | Promise<R> {
      pushFiber(fiber);
      try {
        return Promise.resolve(fn());
      } catch (p) {
        if (p && typeof p.then === 'function') {
          return p.then(()=>rerun(fiber, fn));
        } else {
          return Promise.reject(p);
        }
      } finally {
        popFiber();
      }
    },*/
    addProvider: function (getCurrentFiber) {
        providers.push(getCurrentFiber);
        setCurrentGetterFromProviders();
    },
    removeProvider: function (getCurrentFiber) {
        providers = providers.filter(function (p) { return p !== getCurrentFiber; });
        setCurrentGetterFromProviders();
    }
};
function setCurrentGetterFromProviders() {
    Object.defineProperty(FiberContext, "current", {
        get: providers.reduce(function (p, c) { return function () { return p() || c(); }; }),
        set: function () { throw new Error("Use FiberContext.push() to change current fiber"); }
    });
}
//# sourceMappingURL=fiber-context.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/index.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/index.js ***!
  \****************************************************/
/*! exports provided: Observable, Value, Collection, Emitter, FiberContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return _observable__WEBPACK_IMPORTED_MODULE_0__["Observable"]; });

/* harmony import */ var _value__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./value */ "../kedbackend/js/dist/js/observable/value.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return _value__WEBPACK_IMPORTED_MODULE_1__["Value"]; });

/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Collection", function() { return _collection__WEBPACK_IMPORTED_MODULE_2__["Collection"]; });

/* harmony import */ var _emitter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./emitter */ "../kedbackend/js/dist/js/observable/emitter.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Emitter", function() { return _emitter__WEBPACK_IMPORTED_MODULE_3__["Emitter"]; });

/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "../kedbackend/js/dist/js/observable/fiber-context.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "FiberContext", function() { return _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"]; });






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/map.js":
/*!**************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/map.js ***!
  \**************************************************/
/*! exports provided: initMapMethod */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initMapMethod", function() { return initMapMethod; });
function initMapMethod(ctor) {
    return function (mapper) {
        var _this = this;
        return new ctor(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else
                try {
                    observer(mapper(value), error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
        }); });
    };
}
//# sourceMappingURL=map.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/mixin.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/mixin.js ***!
  \****************************************************/
/*! exports provided: mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return mixin; });
function mixin(targetProto, mixinProto) {
    var props = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        props[_i - 2] = arguments[_i];
    }
    props.forEach(function (prop) { return targetProto[prop] = mixinProto[prop]; });
}
//# sourceMappingURL=mixin.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/observable.js":
/*!*********************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/observable.js ***!
  \*********************************************************/
/*! exports provided: Observable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Observable", function() { return Observable; });
var Observable = /** @class */ (function () {
    //static get [Symbol.species]() { return this; }
    function Observable(_subscribe) {
        this._subscribe = _subscribe;
    }
    Observable.prototype.subscribe = function (observer) {
        try {
            return this._subscribe(function (items, error, subscription) {
                try {
                    observer(items, error, subscription);
                }
                catch (err) {
                    observer(null, err, subscription);
                }
            });
        }
        catch (error) {
            observer(null, error, { unsubscribe: function () { } });
        }
    };
    return Observable;
}());

//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../kedbackend/js/dist/js/observable/value.js":
/*!****************************************************!*\
  !*** ../kedbackend/js/dist/js/observable/value.js ***!
  \****************************************************/
/*! exports provided: Value */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Value", function() { return Value; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../kedbackend/node_modules/tslib/tslib.es6.js");
/* harmony import */ var _observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./observable */ "../kedbackend/js/dist/js/observable/observable.js");
/* harmony import */ var _map__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./map */ "../kedbackend/js/dist/js/observable/map.js");
/* harmony import */ var _collection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./collection */ "../kedbackend/js/dist/js/observable/collection.js");
/* harmony import */ var _fiber_context__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./fiber-context */ "../kedbackend/js/dist/js/observable/fiber-context.js");





var Value = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Value, _super);
    function Value(subscribe) {
        return _super.call(this, subscribe) || this;
    }
    Value.from = function (x) {
        if (x.subscribe)
            return new Value(function (s) { return x.subscribe(s); });
        throw new Error("Value.from() can only take observables");
    };
    Value.prototype.read = function () {
        var resolved = false, result, err, notify;
        var subscription = this.subscribe(function (value, error, subsciption) {
            resolved = true;
            result = value;
            err = error;
            if (error && notify)
                notify(null, error, subsciption);
            else if (notify)
                notify(value, null, subsciption);
        });
        if (resolved) {
            var currentFiber = _fiber_context__WEBPACK_IMPORTED_MODULE_4__["FiberContext"].current;
            if (!currentFiber) {
                subscription.unsubscribe();
                throw new Error("Invalid Fiber Context");
            }
            if (err) {
                subscription.unsubscribe();
                throw err;
            }
            var subscriptions = currentFiber.subscriptions, observer = currentFiber.observer;
            subscriptions.push(subscription);
            notify = observer;
            return result;
        }
        throw new Promise(function (resolve, reject) {
            notify = function (value, error, subscription) {
                subscription.unsubscribe();
                if (error)
                    reject(error);
                else
                    resolve(value);
            };
        });
    };
    Value.prototype.load = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            _this.subscribe(function (value, error, subsciption) {
                if (error)
                    reject(error);
                else
                    resolve(value);
                subsciption.unsubscribe();
            });
        });
    };
    Value.prototype.filter = function (fn) {
        var _this = this;
        return new Value(function (observer) { return _this.subscribe(function (value, error, subscription) {
            if (error)
                observer(null, error, subscription);
            else if (fn(value))
                observer(value, error, subscription);
        }); });
    };
    Value.prototype.log = function (prefix) {
        return this.map(function (x) {
            console.log(prefix, x);
            return x;
        });
    };
    Value.prototype.toCollection = function (mapper) {
        var _this = this;
        return new _collection__WEBPACK_IMPORTED_MODULE_3__["Collection"](function (s) { return _this.map(mapper).subscribe(s); });
    };
    Value.prototype.combineLatest = function (other) {
        var _this = this;
        return new Value(function (observer) {
            var values = [null, null];
            var mySubscription, otherSubscription;
            var subscription = {
                unsubscribe: function () {
                    mySubscription.unsubscribe();
                    otherSubscription.unsubscribe();
                }
            };
            mySubscription = _this.subscribe(function (items, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[0] = items;
                if (values[1] !== null)
                    observer(values, null, subscription);
            });
            otherSubscription = other.subscribe(function (value, error, s) {
                if (error) {
                    s.unsubscribe();
                    observer(null, error, subscription);
                }
                values[1] = value;
                if (values[0] !== null)
                    observer(values, null, subscription);
            });
            return subscription;
        });
    };
    Value.prototype.switchMap = function (mapper) {
        var _this = this;
        return new Value(function (observer) {
            var mappedSubscription = null;
            var subscription = null;
            var returnedSubscription = {
                unsubscribe: function () {
                    subscription.unsubscribe();
                    if (mappedSubscription) {
                        mappedSubscription.unsubscribe();
                        mappedSubscription = null;
                    }
                }
            };
            subscription = _this.subscribe(function (item, error, s) {
                subscription = s;
                if (mappedSubscription) {
                    mappedSubscription.unsubscribe();
                    mappedSubscription = null;
                }
                if (error)
                    observer(null, error, returnedSubscription);
                else {
                    try {
                        var observableOrValue = mapper(item);
                        if (observableOrValue && typeof observableOrValue.subscribe === 'function') {
                            mappedSubscription = observableOrValue.subscribe(function (value, error, s) {
                                mappedSubscription = s;
                                observer(value, error, returnedSubscription);
                            });
                        }
                        else {
                            observer(observableOrValue, null, subscription);
                        }
                    }
                    catch (error) {
                        observer(null, error, subscription);
                    }
                }
            });
            return returnedSubscription;
        });
    };
    return Value;
}(_observable__WEBPACK_IMPORTED_MODULE_1__["Observable"]));

Value.prototype.map = Object(_map__WEBPACK_IMPORTED_MODULE_2__["initMapMethod"])(Value);
//# sourceMappingURL=value.js.map

/***/ }),

/***/ "../kedbackend/repo.js":
/*!*****************************!*\
  !*** ../kedbackend/repo.js ***!
  \*****************************/
/*! exports provided: KedBackendCollection, KedBackendQuery, KedBackendRepo, KedBackendSubscription, KedBackendWriter, MutationQueue, QuerySet, mixin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/dist/js/ked-backend-repo */ "../kedbackend/js/dist/js/ked-backend-repo/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendCollection", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendCollection"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendQuery", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendQuery"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendRepo", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendRepo"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendSubscription", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendSubscription"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "KedBackendWriter", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["KedBackendWriter"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MutationQueue", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["MutationQueue"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "QuerySet", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["QuerySet"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mixin", function() { return _js_dist_js_ked_backend_repo__WEBPACK_IMPORTED_MODULE_0__["mixin"]; });




/***/ }),

/***/ "./node_modules/moment/locale sync recursive sv|en":
/*!***********************************************!*\
  !*** ./node_modules/moment/locale sync sv|en ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive sv|en";

/***/ }),

/***/ "./src/access-control/get-user-claims.ts":
/*!***********************************************!*\
  !*** ./src/access-control/get-user-claims.ts ***!
  \***********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getUserClaims; });
function getUserClaims(user) {
    return [{
            type: "email",
            value: user.mail
        }, {
            type: "school",
            value: user.school
        }].concat(user.roles.map(function (role) { return ({
        type: "role",
        value: role
    }); })).concat(user.roles.map(function (role) { return ({
        type: "schoolRole",
        value: user.school + "/" + role
    }); }));
}


/***/ }),

/***/ "./src/access-control/index.ts":
/*!*************************************!*\
  !*** ./src/access-control/index.ts ***!
  \*************************************/
/*! exports provided: getUserClaims, IMPERSONATION_QUERY_PARAMS, hasAccess, hasReadAccess, hasWriteAccess, hasShareAccess, isTeacherAtSchool, isAdminOrTeacherAtSchool, impersonationEnv, actAs, preserveImpersonationQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IMPERSONATION_QUERY_PARAMS", function() { return IMPERSONATION_QUERY_PARAMS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasAccess", function() { return hasAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasReadAccess", function() { return hasReadAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasWriteAccess", function() { return hasWriteAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hasShareAccess", function() { return hasShareAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isTeacherAtSchool", function() { return isTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isAdminOrTeacherAtSchool", function() { return isAdminOrTeacherAtSchool; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "impersonationEnv", function() { return impersonationEnv; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "actAs", function() { return actAs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "preserveImpersonationQuery", function() { return preserveImpersonationQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _get_user_claims__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-user-claims */ "./src/access-control/get-user-claims.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "getUserClaims", function() { return _get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"]; });

/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");





var IMPERSONATION_QUERY_PARAMS = ["user", "role", "school", "debug", "testVersion", "testversion", "schoolType", "schooltype"];
function hasAccess(user, doc, requestedRight) {
    var claims = Object(_get_user_claims__WEBPACK_IMPORTED_MODULE_2__["default"])(user);
    if (requestedRight !== 'R' && user.tutorFor) {
        claims = claims.filter(function (claim) { return claim.type !== 'email'; });
    }
    var result = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["hasAccess"])(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["DocumentAccess"].fromStringArray(doc.acl || []), claims, requestedRight);
    //console.log(`Has ${requestedRight} access to ${doc.name}/${doc.id}: ${result}`);
    return result;
}
function hasReadAccess(user, doc) {
    return hasAccess(user, doc, 'R');
}
function hasWriteAccess(user, doc) {
    return hasAccess(user, doc, 'W');
}
function hasShareAccess(user, doc) {
    return hasAccess(user, doc, 'S');
}
function isTeacherAtSchool(user, school) {
    var isTeacher = user.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
    var belongsToSchool = (school || "").toLowerCase() === user.school.toLowerCase();
    return (isTeacher && belongsToSchool);
}
function isAdminOrTeacherAtSchool(user, school) {
    return user.roles.includes("ADMIN") || isTeacherAtSchool(user, school);
}
var impersonationEnv = {
    actAs: function (options) {
        var role = options.role, school = options.school, url = options.url;
        var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
        var newQuery = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, currentQuery, { role: role, school: school });
        var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(newQuery);
        if (url) {
            location.href = "" + url + newQueryString;
        }
        else {
            location.hash = "#";
            location.search = newQueryString;
        }
    }
};
function actAs(options) {
    impersonationEnv.actAs(options);
}
function preserveImpersonationQuery(url, query) {
    var e_1, _a;
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["parseQueryString"])(location.search);
    var preservedQuery = {};
    try {
        for (var IMPERSONATION_QUERY_PARAMS_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](IMPERSONATION_QUERY_PARAMS), IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next(); !IMPERSONATION_QUERY_PARAMS_1_1.done; IMPERSONATION_QUERY_PARAMS_1_1 = IMPERSONATION_QUERY_PARAMS_1.next()) {
            var param = IMPERSONATION_QUERY_PARAMS_1_1.value;
            if (currentQuery[param])
                preservedQuery[param] = currentQuery[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (IMPERSONATION_QUERY_PARAMS_1_1 && !IMPERSONATION_QUERY_PARAMS_1_1.done && (_a = IMPERSONATION_QUERY_PARAMS_1.return)) _a.call(IMPERSONATION_QUERY_PARAMS_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    var newQueryString = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_3__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, preservedQuery, query));
    var pHash = url.indexOf('#');
    return pHash >= 0 ?
        "" + url.substr(0, pHash) + newQueryString + url.substr(pHash) :
        "" + url + newQueryString;
}


/***/ }),

/***/ "./src/apis/buttons.tsx":
/*!******************************!*\
  !*** ./src/apis/buttons.tsx ***!
  \******************************/
/*! exports provided: DriveButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DriveButton", function() { return DriveButton; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var IconDrive = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, version: "1.1", xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 508.52 508.52", fill: "#ffffff", style: { verticalAlign: "middle", marginRight: "4px" } },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "484.492,284.58 339.024,32.577 169.496,32.577 314.996,284.58" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "145.437,74.276 0,326.279 84.764,473.05 230.169,221.143" }),
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("polygon", { points: "234.396,316.363 143.371,475.943 423.756,475.943 508.52,316.36" })));
};
var IconClassroom = function (_a) {
    var _b = _a.size, size = _b === void 0 ? 30 : _b;
    return (react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("svg", { width: size, xmlns: "http://www.w3.org/2000/svg", xmlnsXlink: "http://www.w3.org/1999/xlink", viewBox: "0 0 24 24", version: "1.1" },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("path", { d: "M5 2C3.348 2 2 3.348 2 5v14c0 1.652 1.348 3 3 3h14c1.652 0 3-1.348 3-3V5c0-1.652-1.348-3-3-3zm0 2h14c.55 0 1 .45 1 1v14c0 .55-.45 1-1 1h-1v-2h-5v2H5c-.55 0-1-.45-1-1V5c0-.55.45-1 1-1zm7 2a1.999 1.999 0 1 0 0 4 1.999 1.999 0 1 0 0-4zM7.5 8a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm9 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 11c-2.66 0-3.5 2.5-3.5 2.5 0-.848.5-1.5.5-1.5-.3-.188-1.07-.313-1.438-.313-1.214 0-2.562 1.192-2.562 2V16h14v-2.313c0-.808-1.512-2-2.563-2-.367 0-1.136.126-1.437.313 0 0 .5.652.5 1.5 0 0-.84-2.5-3.5-2.5z" })));
};
var DriveButton = function (_a) {
    var _b = _a.label, label = _b === void 0 ? 'Google Drive' : _b, action = _a.action;
    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("a", { className: "btn", onClick: action },
        react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(IconDrive, { size: 16 }),
        " ",
        label);
};


/***/ }),

/***/ "./src/apis/edsclient.ts":
/*!*******************************!*\
  !*** ./src/apis/edsclient.ts ***!
  \*******************************/
/*! exports provided: EdsClient, EDSPeriod, parseJsonDate_old */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EdsClient", function() { return EdsClient; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EDSPeriod", function() { return EDSPeriod; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseJsonDate_old", function() { return parseJsonDate_old; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_school_term__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/school-term */ "./src/utils/school-term.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json");
var _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./mock/mock-eds-data.json */ "./src/apis/mock/mock-eds-data.json", 1);
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/make-suspense-api */ "./src/utils/make-suspense-api.ts");








var EdsClient = /** @class */ (function () {
    function EdsClient(isomorphic, baseUrl, bearerProvider, userEmailGetter) {
        var _this = this;
        this.http = new kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["RestClient"](isomorphic, baseUrl, { bearerProvider: bearerProvider });
        this.userEmailGetter = userEmailGetter;
        var isApiMethod = function (m) {
            return typeof _this[m] === 'function' &&
                m !== 'constructor' && // Since makeSuspenseApi() walks prototype chain
                m !== 'privatizingCacheBust' &&
                m !== 'userEmailGetter';
        } // List non-API methods here...
        ;
        Object.keys(EdsClient.prototype).forEach(function (method) {
            if (isApiMethod(method)) {
                _this[method] = avoidSimultanousCalls(_this[method]);
            }
        });
        this.suspense = Object(_utils_make_suspense_api__WEBPACK_IMPORTED_MODULE_6__["makeSuspenseApi"])(this, { isApiMethod: isApiMethod });
    }
    EdsClient.prototype.privatizingCacheBust = function () {
        return { user: this.userEmailGetter() };
    };
    /**
       * Retrieve active courses for current logged in student.
       *
       * @param courseCode Short-name of the course. Optional.
       */
    EdsClient.prototype.getActiveCourses = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json, ex_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        query = this.privatizingCacheBust();
                        if (q) {
                            if (q.courseCode)
                                query.CourseCode = q.courseCode;
                            if (q.periodName)
                                query.PeriodName = q.periodName;
                        }
                        return [4 /*yield*/, this.http.get("studentactivecourses", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.courses];
                    case 5:
                        ex_1 = _c.sent();
                        console.error("Error from EDS: " + ex_1);
                        throw new Error(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."], ["Kunde tyv\u00E4rr inte ladda terminsm\u00E5l eller avklarade steg fr\u00E5n EDS. F\u00F6rs\u00F6k igen senare..."]))));
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve latest assessments for current logged in user.
     *
     * @param limit Optional limit
     */
    EdsClient.prototype.getLatestAssessments = function (limit) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var query, res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        query = this.privatizingCacheBust();
                        if (!isNaN(limit))
                            query.Count = limit;
                        return [4 /*yield*/, this.http.get("studentassessments", query)];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.assessments];
                }
            });
        });
    };
    /**
     * Retrieve studyplans for current logged-in user
     */
    EdsClient.prototype.getStudentGoals = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentgoals", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentGoals];
                }
            });
        });
    };
    EdsClient.prototype.getStudentFutureAbilities = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("studentFutureAbilities", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.studentFutureAbilities];
                }
            });
        });
    };
    EdsClient.prototype.getTeacherTutorStudents = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("teachertutorstudents", this.privatizingCacheBust())];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.students];
                }
            });
        });
    };
    /**
     * getSchoolTuitionGroups()
     *
     * Return tuitiongroups for school
     *
     * @param schoolName - name of school
     * @param courseCode - Skolverkets code for course
     */
    EdsClient.prototype.getSchoolTuitionGroups = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTuitionGroups", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTuitionGroups];
                }
            });
        });
    };
    /**
     * getTuitionGroupStudents()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     * @param tuitionGroupName - tuition gruop name in EDS
     */
    EdsClient.prototype.getTuitionGroupStudents = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("TuitionGroupStudents", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.tuitionGroupStudents];
                }
            });
        });
    };
    /**
     * getSchoolTeachers()
     *
     * Return name and mailadresses for tutitiongroups in schools
     *
     * @param schoolName - name of school
     */
    EdsClient.prototype.getSchoolTeachers = function (q) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0: return [4 /*yield*/, this.http.get("SchoolTeachers", tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.privatizingCacheBust(), q))];
                    case 1:
                        res = _c.sent();
                        if (!(res.status != 200)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_1__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        json = _c.sent();
                        return [2 /*return*/, json.schoolTeachers];
                }
            });
        });
    };
    // we assume that the EDS will return the current academic year dates determined by the current date
    EdsClient.prototype.getAcademicYearTerms = function (schoolLocale, date) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var holidays, addYear, firstTermYear, secondTermYear, firstTermYearMoment, secondTermYearMoment, startFirstTermDate, endFirstTermDate, startSecondTermDate, endSecondTermDate, firstTerm, secondTerm;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                // mock data
                switch (schoolLocale) {
                    case 'en_sin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_4__.SouthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_5___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_5___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'en_nin':
                        return [2 /*return*/, _mock_mock_eds_data_json__WEBPACK_IMPORTED_MODULE_4__.NorthIndia.filter(function (f) { return moment__WEBPACK_IMPORTED_MODULE_5___default()(date).isSameOrAfter(f.firstTerm.startDate) && moment__WEBPACK_IMPORTED_MODULE_5___default()(date).isSameOrBefore(f.secondTerm.endDate); })[0]];
                    case 'sv':
                        {
                            holidays = [];
                            addYear = date.getMonth() >= 6;
                            firstTermYear = addYear ? date.getFullYear() : date.getFullYear() - 1;
                            secondTermYear = addYear ? date.getFullYear() + 1 : date.getFullYear();
                            firstTermYearMoment = moment__WEBPACK_IMPORTED_MODULE_5___default()(firstTermYear.toString(), "YYYY");
                            secondTermYearMoment = moment__WEBPACK_IMPORTED_MODULE_5___default()(secondTermYear.toString(), "YYYY");
                            if (firstTermYearMoment.week() != 1) {
                                firstTermYearMoment = firstTermYearMoment.clone().add(1, 'week');
                            }
                            if (secondTermYearMoment.week() != 1) {
                                secondTermYearMoment = secondTermYearMoment.clone().add(1, 'week');
                            }
                            startFirstTermDate = moment__WEBPACK_IMPORTED_MODULE_5___default()(firstTermYearMoment.clone()).week(32).startOf('week');
                            endFirstTermDate = moment__WEBPACK_IMPORTED_MODULE_5___default()(firstTermYearMoment.clone()).week(51).endOf('week');
                            startSecondTermDate = moment__WEBPACK_IMPORTED_MODULE_5___default()(secondTermYearMoment.clone());
                            endSecondTermDate = moment__WEBPACK_IMPORTED_MODULE_5___default()(secondTermYearMoment.clone()).week(25).endOf('week');
                            firstTerm = { startDate: new Date(firstTermYear, startFirstTermDate.month(), startFirstTermDate.date()).toDateString(), endDate: new Date(firstTermYear, endFirstTermDate.month(), endFirstTermDate.date()).toDateString() };
                            secondTerm = { startDate: new Date(secondTermYear, startSecondTermDate.month(), startSecondTermDate.date()).toDateString(), endDate: new Date(secondTermYear, endSecondTermDate.month(), endSecondTermDate.date()).toDateString() };
                            return [2 /*return*/, { firstTerm: firstTerm, secondTerm: secondTerm, holidays: holidays }];
                        }
                }
                return [2 /*return*/];
            });
        });
    };
    return EdsClient;
}());

var EDSPeriod = /** @class */ (function () {
    function EDSPeriod(periodStringOrSchoolTerm) {
        if (typeof periodStringOrSchoolTerm === 'string') {
            this.period = periodStringOrSchoolTerm;
            this.term = this.period.startsWith('HT') ? 'AT' : 'ST';
            this.year = parseInt(this.period.substr(2));
            if (isNaN(this.year))
                throw new Error("Invalid period: " + this.period);
        }
        else {
            var schoolTerm = new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"](periodStringOrSchoolTerm);
            this.period = (schoolTerm.term === 'AT' ? "HT" : "VT") + schoolTerm.year;
            this.term = schoolTerm.term;
            this.year = schoolTerm.year;
        }
    }
    Object.defineProperty(EDSPeriod.prototype, "schoolTerm", {
        get: function () {
            return new _utils_school_term__WEBPACK_IMPORTED_MODULE_2__["SchoolTerm"]({
                academicYear: this.term === 'AT' ?
                    this.year + "/" + (this.year + 1) :
                    this.year - 1 + "/" + this.year,
                term: this.term
            });
        },
        enumerable: true,
        configurable: true
    });
    EDSPeriod.prototype.toString = function () {
        return this.period;
    };
    EDSPeriod.prototype.valueOf = function () {
        return this.year + ":" + (this.term === 'ST' ? "1" : "2");
    };
    return EDSPeriod;
}());

function parseJsonDate_old(jsonDateStr) {
    var date = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["dateTimeReviver"])("", jsonDateStr);
    if (!(date instanceof Date))
        throw new Error("Invalid JSON date string: " + jsonDateStr);
    return date;
}
function avoidSimultanousCalls(method) {
    var ongoingPromises = {};
    return function () {
        var argsJson = JSON.stringify([].slice.call(arguments));
        if (!ongoingPromises[argsJson]) {
            ongoingPromises[argsJson] = method.apply(this, arguments).then(function (result) {
                delete ongoingPromises[argsJson];
                return result;
            });
        }
        return ongoingPromises[argsJson];
    };
}
var templateObject_1;


/***/ }),

/***/ "./src/apis/google-picker.ts":
/*!***********************************!*\
  !*** ./src/apis/google-picker.ts ***!
  \***********************************/
/*! exports provided: GooglePicker */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GooglePicker", function() { return GooglePicker; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");


/**
 * GooglePicker
 * Includes the initiation of the correct api:s.
 * Certain options can be passed to the constructor
 * and there could be others worth incorporating (i.e. Team Drive-support).
 *
 * Right now two options are handled:
 * - upload: if a user can upload to Drive in the Google Drive Picker
 * - multiple: if a user can select multiple files
 *
 * Compared to GoogleCalendar the tokenProvider is set in the constructor
 * and is not passed as an argument. We could probably do the same in GoogleCalendar
 * because the env is globally available at all times.
 *
 * We could probably split this into google-picker and google-drive where google-drive
 * handles the explicit calls to the google drive api.
 */
var GooglePicker = /** @class */ (function () {
    function GooglePicker(options) {
        this.googleTokenProvider = _globals_KED_env__WEBPACK_IMPORTED_MODULE_1__["default"].googleTokenProvider;
        this.options = options || { upload: false, multiple: false };
    }
    GooglePicker.prototype.ensureInited = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var CLIENT_ID;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(typeof gapi === "undefined")) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.loadGapi()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        CLIENT_ID = "421572262269-u68v5lf5o8ss5t68l8gkq3pfarh6dbkv.apps.googleusercontent.com";
                        return [4 /*yield*/, new Promise(function (resolve, reject) {
                                gapi.load("client:auth2", function () {
                                    // Calls authorize without prompting the user. If authorization hasn't been given by
                                    // the user an error is returned and we call authorize again with consent-screen
                                    return gapi.auth2.authorize({
                                        client_id: CLIENT_ID,
                                        scope: 'https://www.googleapis.com/auth/drive',
                                        response_type: 'id_token permission',
                                        prompt: 'none'
                                    }, function (resp) {
                                        if (resp.error) {
                                            return gapi.auth2.authorize({
                                                client_id: CLIENT_ID,
                                                scope: 'https://www.googleapis.com/auth/drive',
                                                response_type: 'id_token permission',
                                                prompt: 'consent'
                                            }, function (resp) {
                                                if (resp.error) {
                                                    reject('Picker: No access token');
                                                }
                                                else {
                                                    _this.authToken = resp.access_token;
                                                    resolve();
                                                }
                                            });
                                        }
                                        else {
                                            _this.authToken = resp.access_token;
                                            resolve();
                                        }
                                    });
                                });
                            })];
                    case 3:
                        _a.sent();
                        if (!(typeof google === "undefined" || typeof google.picker === "undefined")) return [3 /*break*/, 5];
                        return [4 /*yield*/, new Promise(function (resolve) {
                                gapi.load("picker", function () { resolve(); });
                            })];
                    case 4:
                        _a.sent();
                        _a.label = 5;
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    GooglePicker.prototype.loadGapi = function () {
        return new Promise(function (resolve, reject) {
            if (typeof gapi !== "undefined")
                return resolve();
            var script = document.createElement("script");
            script.src = "https://apis.google.com/js/client.js?onload=gaapi_loaded";
            document.getElementsByTagName("head")[0].appendChild(script);
            window.gaapi_loaded = resolve;
        });
    };
    /**
     * show()
     *
     * If a single file is requested from the picker a list of files with one element is returned.
     * It is up to the caller to handle the list in a relevant manner.
     *
     * More data from the file could be extracted if it is deemed necessary.
     *
     */
    GooglePicker.prototype.show = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureInited()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/, new Promise(function (resolve, reject) {
                                var callback = function (response) {
                                    if (response['action'] == google.picker.Action.CANCEL) {
                                        reject();
                                    }
                                    else if (response['action'] == google.picker.Action.PICKED) {
                                        var selected_1 = [];
                                        response.docs.forEach(function (doc) {
                                            var fileId = doc.id, mimeType = doc.mimeType, name = doc.name, modifiedTime = doc.modifiedTime, iconUrl = doc.iconUrl, url = doc.url;
                                            var canExport = mimeType.includes('google-apps');
                                            selected_1.push({ fileId: fileId, mimeType: mimeType, name: name, modifiedTime: modifiedTime, canExport: canExport, iconUrl: iconUrl, url: url });
                                            // update permissions to read by all in domain
                                            _this.updatePermissions(fileId);
                                        });
                                        console.log(selected_1);
                                        resolve(selected_1);
                                    }
                                };
                                var pickerbuilder = new google.picker.PickerBuilder()
                                    .addView(new google.picker.DocsView()
                                    .setOwnedByMe(true) // should this be an option?
                                    .setIncludeFolders(true))
                                    .setLocale("sv") // should this be an option?
                                    .setSize(1051, 650) // should this be an option?
                                    .setOAuthToken(_this.authToken) // temp
                                    .setCallback(callback);
                                if (_this.options.upload) {
                                    pickerbuilder.addView(new google.picker.DocsUploadView().setIncludeFolders(true));
                                }
                                if (_this.options.multiple) {
                                    pickerbuilder.enableFeature(google.picker.Feature.MULTISELECT_ENABLED);
                                }
                                _this.picker = pickerbuilder.build();
                                _this.picker.setVisible(true);
                            })];
                }
            });
        });
    };
    /**
     * updatePermissions()
     *
     * @param fileId
     *
     * Make the file accessible to all in the domain. Should be unnecessary but some
     * teachers have changed their default permissions.
     * We don't care right now if this fails because this is just an extra precaution.
     * If we plan on using this on other domains the domain-attribute needs to be dynamic.
     *
     */
    GooglePicker.prototype.updatePermissions = function (fileId) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]
                        })];
                    case 1:
                        _a.sent();
                        gapi.client.drive.permissions.create({
                            fileId: fileId,
                            sendNotificationEmail: false,
                            role: 'reader',
                            type: 'domain',
                            domain: 'kunskapsskolan.se'
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * downloadFile()
     * @param file
     *
     * When Classroom has been integrated we will want to handle only the fileId:s
     * so that editing capabilities are peserved on the file (if it is a google-apps file)
     * Right now google-apps files are converted to pdf and passed into the current flow.
     *
     * TODO: error handling
     */
    GooglePicker.prototype.downloadFile = function (_a) {
        var file = _a.file, limitSize = _a.limitSize;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var xhrDownload_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: 
                    // A file that can be exported to PDF is retreived with
                    // file.export() from Drive, converted to a blob and then
                    // to a File.
                    // A file that can not be exported to PDF is retrieved
                    // through XHR and converted to a File.
                    // If we don't need to handle the physical files on the client
                    // we could save only the fileId:s and display filename and mimeType
                    // for the file in our listings. When/if we use Google Classroom for
                    // our task-handling that would be the preferred approach to keep
                    // the file as an editable Google file
                    // Init the drive-api (only needed for download so not loaded initially)
                    return [4 /*yield*/, gapi.client.init({
                            discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]
                        })];
                    case 1:
                        // A file that can be exported to PDF is retreived with
                        // file.export() from Drive, converted to a blob and then
                        // to a File.
                        // A file that can not be exported to PDF is retrieved
                        // through XHR and converted to a File.
                        // If we don't need to handle the physical files on the client
                        // we could save only the fileId:s and display filename and mimeType
                        // for the file in our listings. When/if we use Google Classroom for
                        // our task-handling that would be the preferred approach to keep
                        // the file as an editable Google file
                        // Init the drive-api (only needed for download so not loaded initially)
                        _b.sent();
                        if (file.canExport) {
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    gapi.client.drive.files.export({
                                        fileId: file.fileId,
                                        mimeType: 'application/pdf'
                                    }).then(function (resp) {
                                        var len = resp.body.length;
                                        var data = new Uint8Array(new ArrayBuffer(len));
                                        for (var i = 0; i < len; i++) {
                                            data[i] = resp.body.charCodeAt(i);
                                        }
                                        var blob = new Blob([data], { type: 'application/pdf' });
                                        var filename = file.name + '.pdf';
                                        resolve(new File([blob], filename, { type: 'application/pdf', lastModified: file.modifiedTime }));
                                    });
                                })];
                        }
                        else {
                            xhrDownload_1 = function (file) {
                                return new Promise(function (resolve, reject) {
                                    var xhr = new XMLHttpRequest();
                                    xhr.open("GET", "https://www.googleapis.com/drive/v3/files/" + file.fileId + '?alt=media', true);
                                    xhr.setRequestHeader('Authorization', 'Bearer ' + _this.authToken);
                                    xhr.responseType = 'blob';
                                    xhr.onload = function () {
                                        resolve(new File([xhr.response], file.name, { type: file.mimeType, lastModified: file.modifiedTime }));
                                    };
                                    xhr.send();
                                });
                            };
                            return [2 /*return*/, new Promise(function (resolve, reject) {
                                    if (limitSize !== undefined) {
                                        gapi.client.drive.files.get({
                                            fileId: file.fileId,
                                            fields: 'size'
                                        }).then(function (resp) {
                                            var size = Number(resp.result.size);
                                            if (size > limitSize * 1024 * 1024) {
                                                reject('GooglePickerError: Filsize is too laarge');
                                            }
                                        }).then(function () {
                                            xhrDownload_1(file).then(function (resp) {
                                                resolve(resp);
                                            });
                                        });
                                    }
                                    else {
                                        xhrDownload_1(file).then(function (resp) {
                                            resolve(resp);
                                        });
                                    }
                                })];
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    return GooglePicker;
}());



/***/ }),

/***/ "./src/apis/mock/mock-eds-data.json":
/*!******************************************!*\
  !*** ./src/apis/mock/mock-eds-data.json ***!
  \******************************************/
/*! exports provided: SouthIndia, NorthIndia, default */
/***/ (function(module) {

module.exports = {"SouthIndia":[{"firstTerm":{"startDate":"2015-06-01T00:00:00.000Z","endDate":"2015-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2015-11-01T00:00:00.000Z","endDate":"2016-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-06-23T00:00:00.000Z","endDate":"2016-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2016-11-01T00:00:00.000Z","endDate":"2017-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-06-05T00:00:00.000Z","endDate":"2017-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2017-11-01T00:00:00.000Z","endDate":"2018-03-30T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2018-06-04T00:00:00.000Z","endDate":"2018-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2018-11-01T00:00:00.000Z","endDate":"2019-04-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2019-06-03T00:00:00.000Z","endDate":"2019-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2019-11-01T00:00:00.000Z","endDate":"2020-03-27T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-06-01T00:00:00.000Z","endDate":"2020-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2020-11-01T00:00:00.000Z","endDate":"2021-03-26T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-06-06T00:00:00.000Z","endDate":"2021-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2021-11-01T00:00:00.000Z","endDate":"2022-03-25T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-06-05T00:00:00.000Z","endDate":"2022-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2022-11-01T00:00:00.000Z","endDate":"2023-03-31T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-06-04T00:00:00.000Z","endDate":"2023-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2023-11-01T00:00:00.000Z","endDate":"2024-03-29T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2024-06-03T00:00:00.000Z","endDate":"2024-10-31T00:00:00.000Z"},"secondTerm":{"startDate":"2024-11-01T00:00:00.000Z","endDate":"2025-03-28T00:00:00.000Z"},"holidays":[]}],"NorthIndia":[{"firstTerm":{"startDate":"2024-04-03T00:00:00.000Z","endDate":"2024-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2024-10-01T00:00:00.000Z","endDate":"2025-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2023-04-05T00:00:00.000Z","endDate":"2023-10-01T00:00:00.000Z"},"secondTerm":{"startDate":"2023-10-02T00:00:00.000Z","endDate":"2024-04-02T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2022-04-06T00:00:00.000Z","endDate":"2022-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2022-10-04T00:00:00.000Z","endDate":"2023-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2021-04-01T00:00:00.000Z","endDate":"2021-10-04T00:00:00.000Z"},"secondTerm":{"startDate":"2021-10-05T00:00:00.000Z","endDate":"2022-04-05T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2020-04-01T00:00:00.000Z","endDate":"2020-09-28T00:00:00.000Z"},"secondTerm":{"startDate":"2020-09-29T00:00:00.000Z","endDate":"2021-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2020-05-17","endDate":"2020-06-28"}]},{"firstTerm":{"startDate":"2019-04-04T00:00:00.000Z","endDate":"2019-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2019-10-01T00:00:00.000Z","endDate":"2020-03-31T00:00:00.000Z"},"holidays":[{"startDate":"2019-05-19","endDate":"2019-06-29"}]},{"firstTerm":{"startDate":"2018-04-04T00:00:00.000Z","endDate":"2018-09-30T00:00:00.000Z"},"secondTerm":{"startDate":"2018-10-01T00:00:00.000Z","endDate":"2019-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2017-04-05T00:00:00.000Z","endDate":"2017-10-02T00:00:00.000Z"},"secondTerm":{"startDate":"2017-10-03T00:00:00.000Z","endDate":"2018-04-03T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2016-04-06T00:00:00.000Z","endDate":"2016-10-03T00:00:00.000Z"},"secondTerm":{"startDate":"2016-10-04T00:00:00.000Z","endDate":"2017-04-04T00:00:00.000Z"},"holidays":[]},{"firstTerm":{"startDate":"2015-04-01T00:00:00.000Z","endDate":"2015-10-05T00:00:00.000Z"},"secondTerm":{"startDate":"2015-10-06T00:00:00.000Z","endDate":"2016-04-05T00:00:00.000Z"},"holidays":[]}]};

/***/ }),

/***/ "./src/components/calendar/course-name-to-css-class.ts":
/*!*************************************************************!*\
  !*** ./src/components/calendar/course-name-to-css-class.ts ***!
  \*************************************************************/
/*! exports provided: courseNameToCssClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "courseNameToCssClass", function() { return courseNameToCssClass; });
function courseNameToCssClass(cssPrefix, courseName) {
    return "" + cssPrefix + courseName.substr(0, 3).toLowerCase();
}


/***/ }),

/***/ "./src/components/charts/charts-utils.ts":
/*!***********************************************!*\
  !*** ./src/components/charts/charts-utils.ts ***!
  \***********************************************/
/*! exports provided: getWeekplannerProgressData */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getWeekplannerProgressData", function() { return getWeekplannerProgressData; });
function getWeekplannerProgressData(taskSets) {
    var chartTasks = { completedTasks: 0, totalNumberOfTasks: 0, subjectData: {} };
    taskSets.forEach(function (elem) { return elem.learningGoals.forEach(function (x) {
        var subjectCompletedTasks = x.tasks.filter(function (t) { return t.done; }).length;
        chartTasks.subjectData[elem.courseName] = { completedNumberOfTasks: subjectCompletedTasks, numberOfTasks: x.tasks.length };
        chartTasks.completedTasks += subjectCompletedTasks;
        chartTasks.totalNumberOfTasks += x.tasks.length;
    }); });
    return chartTasks;
}


/***/ }),

/***/ "./src/components/charts/goal-progress.tsx":
/*!*************************************************!*\
  !*** ./src/components/charts/goal-progress.tsx ***!
  \*************************************************/
/*! exports provided: GoalProgress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GoalProgress", function() { return GoalProgress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var GoalProgress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](GoalProgress, _super);
    function GoalProgress() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.createProgress = function () {
            var _a = _this.props, numberOfTasks = _a.numberOfTasks, completedNumberOfTasks = _a.completedNumberOfTasks, maximumTasksDisplayed = _a.maximumTasksDisplayed, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
            var progress = [];
            if (numberOfTasks > maximumTasksDisplayed) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    " ",
                    completedNumberOfTasks,
                    " / ",
                    numberOfTasks,
                    " ");
            }
            for (var taskNo = 1; taskNo <= numberOfTasks; taskNo++) {
                progress.push(react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { key: taskNo },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("circle", { className: "circle-chart-background", fill: taskNo > completedNumberOfTasks ? backgroundColor : progressColor, cx: "8", cy: "8", r: "8" })));
            }
            return progress;
        };
        return _this;
    }
    GoalProgress.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "goals-progress" }, this.createProgress());
    };
    GoalProgress.defaultProps = {
        numberofTasks: 0,
        completedNumberOfTasks: 0,
        maximumTasksDisplayed: 10,
        backgroundColor: "lightgrey",
        progressColor: "#3dbca2",
    };
    return GoalProgress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/charts/progress.tsx":
/*!********************************************!*\
  !*** ./src/components/charts/progress.tsx ***!
  \********************************************/
/*! exports provided: Progress */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Progress", function() { return Progress; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var Progress = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Progress, _super);
    function Progress() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Progress.prototype.render = function () {
        var _a = this.props, percentage = _a.percentage, backgroundColor = _a.backgroundColor, progressColor = _a.progressColor;
        var roundedPercentage = Math.round(percentage);
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("svg", { className: "progress-chart", width: "100%", height: "25" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { fill: backgroundColor, width: "100%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("rect", { className: "fill", fill: progressColor, width: roundedPercentage + "%", height: "100%", rx: "4" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("text", { className: "filled-text", textAnchor: "middle", x: "50%", y: "50%", dy: ".3em" }, roundedPercentage + "%")));
    };
    Progress.defaultProps = {
        percentage: 0,
        backgroundColor: "#F1F5F4",
        progressColor: "#3dbca2",
    };
    return Progress;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-builder-ks/logic/is-employee.ts":
/*!***************************************************************!*\
  !*** ./src/components/course-builder-ks/logic/is-employee.ts ***!
  \***************************************************************/
/*! exports provided: isEmployee */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isEmployee", function() { return isEmployee; });
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");


function isEmployee(atSchool) {
    return atSchool ?
        Object(_access_control__WEBPACK_IMPORTED_MODULE_1__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser, atSchool) || _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.includes("ADMIN") :
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.roles.some(function (role) { return role === 'EMPLOYEE' || role === 'ADMIN'; });
}


/***/ }),

/***/ "./src/components/course-builder/sub-components/remove-item.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-builder/sub-components/remove-item.tsx ***!
  \**********************************************************************/
/*! exports provided: RemoveItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RemoveItem", function() { return RemoveItem; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");



;
var RemoveItem = function (_a) {
    var onClick = _a.onClick, className = _a.className, style = _a.style, title = _a.title;
    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { title: title || Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Radera"], ["Radera"]))), className: "removeItem " + (className || ""), onClick: onClick, style: style });
};
var templateObject_1;


/***/ }),

/***/ "./src/components/course-builder/sub-components/spinner.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-builder/sub-components/spinner.tsx ***!
  \******************************************************************/
/*! exports provided: Spinner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Spinner", function() { return Spinner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var Spinner = function () { return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("span", null,
    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("i", { className: "fa fa-spinner fa-spin", "aria-hidden": "true" }),
    "\u00A0"); };


/***/ }),

/***/ "./src/components/course-builder/utils.ts":
/*!************************************************!*\
  !*** ./src/components/course-builder/utils.ts ***!
  \************************************************/
/*! exports provided: updateDocumentGraphs, dtFormat, shortDateFormat, shortPersonNameFormat, updateModificationStamp, updateCreationStamp, getEmailFromDocAccess, updateModificationAndCreationStamps, applyEtags, readBlob, readBlobAsText, readBlobAsDataUrl, allowCopy, updateCourseBuilderStatus, loadCourse */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateDocumentGraphs", function() { return updateDocumentGraphs; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dtFormat", function() { return dtFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortDateFormat", function() { return shortDateFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shortPersonNameFormat", function() { return shortPersonNameFormat; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationStamp", function() { return updateModificationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCreationStamp", function() { return updateCreationStamp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getEmailFromDocAccess", function() { return getEmailFromDocAccess; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateModificationAndCreationStamps", function() { return updateModificationAndCreationStamps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "applyEtags", function() { return applyEtags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlob", function() { return readBlob; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsText", function() { return readBlobAsText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "readBlobAsDataUrl", function() { return readBlobAsDataUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "allowCopy", function() { return allowCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateCourseBuilderStatus", function() { return updateCourseBuilderStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "loadCourse", function() { return loadCourse; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-addons-update */ "./node_modules/react-addons-update/index.js");
/* harmony import */ var react_addons_update__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_addons_update__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");






function updateDocumentGraphs(oldDoc, newDoc, table, graphs, batch) {
    var e_1, _a;
    var docUpdates = {};
    var docId = newDoc.id;
    var _loop_1 = function (navProp) {
        var e_2, _a, e_3, _b, e_4, _c;
        var foreignTable = graphs[navProp];
        var oldList = oldDoc[navProp] || [];
        var newList = newDoc[navProp];
        if (!newList)
            return "continue";
        var tuples = newList
            .map(function (doc, idx) { return ({ doc: doc, idx: idx }); }); // Create tubles of {doc, array-index} so we can update result
        var added = tuples.filter(function (tuple) { return !oldList.some(function (o) { return o.id === tuple.doc.id; }); }); // Find added items
        try {
            for (var added_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](added), added_1_1 = added_1.next(); !added_1_1.done; added_1_1 = added_1.next()) {
                var a = added_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.doc);
                var meta = mutatedSubDoc.$meta;
                delete mutatedSubDoc.$meta; // Delete $meta so that "add" or "update" does not persiste to next state.
                if (meta === 'add') {
                    if (!mutatedSubDoc.id)
                        mutatedSubDoc.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])(); // Generate ID if not done yet.
                    // Now put an 'add' mutation in the batch queue.
                    batch.add(foreignTable, mutatedSubDoc);
                }
                else if (meta === 'update') {
                    batch.put(foreignTable, mutatedSubDoc);
                }
                batch.link(table, docId, foreignTable, mutatedSubDoc.id, navProp);
                // Update result so that state is reflected after succesful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][a.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (added_1_1 && !added_1_1.done && (_a = added_1.return)) _a.call(added_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
        var removed = oldList.filter(function (o) { return !newList.some(function (n) { return n.id === o.id; }); });
        try {
            for (var removed_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](removed), removed_1_1 = removed_1.next(); !removed_1_1.done; removed_1_1 = removed_1.next()) {
                var r = removed_1_1.value;
                batch.unlink(table, docId, foreignTable, r.id, navProp);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (removed_1_1 && !removed_1_1.done && (_b = removed_1.return)) _b.call(removed_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
        var updated = tuples.filter(function (tuple) { return oldList.some(function (o) { return o.id === tuple.doc.id && tuple.doc.$meta === 'update'; }); });
        try {
            for (var updated_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](updated), updated_1_1 = updated_1.next(); !updated_1_1.done; updated_1_1 = updated_1.next()) {
                var u = updated_1_1.value;
                var mutatedSubDoc = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, u.doc);
                delete mutatedSubDoc.$meta;
                batch.put(foreignTable, mutatedSubDoc);
                // Update result so that $meta is removed from navigation prop after successful POST to server.
                if (!docUpdates[navProp])
                    docUpdates[navProp] = {};
                docUpdates[navProp][u.idx] = { $set: mutatedSubDoc };
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (updated_1_1 && !updated_1_1.done && (_c = updated_1.return)) _c.call(updated_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    try {
        for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(graphs)), _c = _b.next(); !_c.done; _c = _b.next()) {
            var navProp = _c.value;
            _loop_1(navProp);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(newDoc, docUpdates);
}
function dtFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD HH:mm');
}
function shortDateFormat(dateTime) {
    return moment__WEBPACK_IMPORTED_MODULE_1___default()(dateTime).format('YYMMDD');
}
function shortPersonNameFormat(name) {
    if (!name)
        return "";
    var names = name.split(' ').filter(function (n) { return !!n; });
    var lastName = names.pop();
    return names.map(function (name) { return name[0] + "."; }).concat(lastName).join(' ');
}
function updateModificationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        dateTime: { $set: now },
        modifiedDate: { $set: now },
        modifiedBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function updateCreationStamp(now, obj, user) {
    return react_addons_update__WEBPACK_IMPORTED_MODULE_3___default()(obj, {
        createdDate: { $set: now },
        createdBy: {
            $set: {
                name: user.displayName,
                url: "mailto:" + user.mail
            }
        }
    });
}
function getEmailFromDocAccess(resource) {
    if (resource.email)
        return resource.email;
    return resource.url ?
        resource.url.startsWith('mailto:') ?
            resource.url.substring('mailto:'.length) :
            resource.url :
        resource.url;
}
function updateModificationAndCreationStamps(obj, user) {
    var now = Date.now();
    obj = updateModificationStamp(now, obj, user);
    if (!obj.createdBy)
        obj = updateCreationStamp(now, obj, user);
    return obj;
}
function applyEtags(doc, newEtags, graphs) {
    var e_5, _a;
    var res = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, doc);
    var etag = newEtags[doc.id];
    if (etag)
        res.$etag = etag;
    try {
        for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
            var label = graphs_1_1.value;
            var newList = doc[label].map(function (d) { return applyEtags(d, newEtags, []); });
            res[label] = newList;
        }
    }
    catch (e_5_1) { e_5 = { error: e_5_1 }; }
    finally {
        try {
            if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
        }
        finally { if (e_5) throw e_5.error; }
    }
    return res;
}
function readBlob(blob, m) {
    return new Promise(function (resolve, reject) {
        var reader = new FileReader();
        reader.onload = function (ev) { return resolve(ev.target.result); };
        reader.onabort = function (ev) { return reject(new Error("file read aborted")); };
        reader.onerror = function (ev) { return reject(ev.target.error); };
        m(reader);
    });
}
function readBlobAsText(blob) {
    return readBlob(blob, function (r) { return r.readAsText(blob); });
}
function readBlobAsDataUrl(blob) {
    return readBlob(blob, function (r) { return r.readAsDataURL(blob); });
}
function allowCopy(e) {
    e.stopPropagation();
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
}
function updateCourseBuilderStatus(status) {
    var div = jquery__WEBPACK_IMPORTED_MODULE_4___default()('div.course-builder')[0];
    if (div)
        div.className = "course-builder" + (status ? " status " + status : "");
}
function loadCourse(id, options) {
    return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
        var client, includeTemplateChain, includeTasks, _a, course, courseTasks, templateChain;
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
            switch (_b.label) {
                case 0:
                    client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].kedBackendClient;
                    includeTemplateChain = options && options.includeTemplateChain;
                    includeTasks = !options || !options.include || options.include.indexOf("tasks") !== -1;
                    return [4 /*yield*/, Promise.all([
                            client.get("courses", id, {
                                include: options && options.include ? options.include.filter(function (i) { return i !== "tasks"; }) : [
                                    "centralContent",
                                    "knowledgeRequirements",
                                    "abilities",
                                    "images",
                                    "acl" // Don't include tasks here...
                                ]
                            }),
                            // ... but include tasks here instead so that we can load the graphs for the
                            // tasks as well!
                            includeTasks && client.list("tasks", {
                                hasEdgesFrom: id,
                                include: ['knowledgeRequirements', 'centralContent', 'abilities', 'acl'],
                                flags: ['includeIdsOnly'] // Don't need redundant info that's already on course
                            }),
                            includeTemplateChain && client.list("courses", {
                                hasEdgesFrom: id,
                                flags: ['idsOnly']
                            })
                        ])];
                case 1:
                    _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [(_b.sent()), 3]), course = _a[0], courseTasks = _a[1], templateChain = _a[2];
                    course.tasks = courseTasks;
                    // Correct the order of Abilities
                    if (course.abilities && course.abilitiesOrder) {
                        course.abilities = course.abilitiesOrder.map(function (id) {
                            return course.abilities.find(function (a) { return a.id === id; });
                        });
                    }
                    // Correct the order of KnowledgeRequirements
                    if (course.knowledgeRequirements && course.knowledgeRequirementsOrder) {
                        course.knowledgeRequirements = course.knowledgeRequirementsOrder.map(function (id) {
                            return course.knowledgeRequirements.find(function (c) { return c.id === id; });
                        });
                    }
                    // Correct the order of CentralContent
                    if (course.centralContent && course.centralContentOrder) {
                        course.centralContent = course.centralContentOrder.map(function (id) {
                            return course.centralContent.find(function (cc) { return cc.id === id; });
                        }); //.filter(x => !!x);// Debugging somthin' . Normally the last .filter()... part should not be nescessary...
                    }
                    // Include template chain if requested.
                    if (includeTemplateChain)
                        course.templateChain = templateChain;
                    return [2 /*return*/, course];
            }
        });
    });
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-banner.tsx":
/*!********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-banner.tsx ***!
  \********************************************************************/
/*! exports provided: CourseBanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseBanner", function() { return CourseBanner; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var CourseBanner = function (props) {
    var title = props.title, backgroundImage = props.backgroundImage, tabs = props.tabs, activeTab = props.activeTab;
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-script-portlet sv-portlet sv-skip-spacer" },
                backgroundImage && react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("style", null, "\n        .pageHeader {\n          background-image: url('" + backgroundImage + "') !important;\n        }\n      "),
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "pageHeader" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", null,
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("h1", null, title)),
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsField" },
                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "buttonsContainer" },
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "align-horizontal" }),
                            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: 'horizontalMenu' },
                                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("ul", null, tabs.map(function (_a, idx) {
                                    var name = _a.name, key = _a.key, link = _a.link;
                                    var isActive = activeTab === link;
                                    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("li", { key: key || (typeof name === 'string' ? name : idx), className: isActive ? "activePage" : "" },
                                        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("a", { href: link }, name));
                                })))))))));
};


/***/ }),

/***/ "./src/components/course-viewer/course-page/course-module-page.tsx":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/course-module-page.tsx ***!
  \*************************************************************************/
/*! exports provided: CourseModulePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseModulePage", function() { return CourseModulePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/get-included-ids */ "./src/components/course-viewer/utils/get-included-ids.ts");
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../subcomponents/learning-goals-list */ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx");
/* harmony import */ var _subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../subcomponents/task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");










var CourseModulePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseModulePage, _super);
    function CourseModulePage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    CourseModulePage.prototype.render = function () {
        var _a = this.props, module = _a.module, course = _a.course;
        var incluedIds = Object(_utils_get_included_ids__WEBPACK_IMPORTED_MODULE_4__["default"])(module, course);
        var learningTasks = module.taskIds
            .map(function (id) { return course.tasks.find(function (t) { return t.id === id; }); })
            .filter(function (task) { return !!task; })
            .map(function (task) { return ({
            id: task.id,
            task: Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task),
            course: course,
            name: task.name,
            url: "#" + encodeURIComponent(module.name.trim()) + "/" + task.id,
            courseName: course.name,
            learningGoal: task.learningGoal || module.name,
        }); });
        var assignmentTasks = learningTasks.filter(function (t) { return t.task && t.task.assignment; });
        var nonAssignmentTasks = learningTasks.filter(function (t) { return !t.task || !t.task.assignment; });
        var commonTasks = nonAssignmentTasks.filter(function (t) { return !t.task.learningGoal; });
        var learningGoals = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["arrayToLookup"])(nonAssignmentTasks.filter(function (t) { return !!t.task.learningGoal; }), function (t) { return t.learningGoal; });
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, module.name))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: module.mandatoryContent } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Modulens kunskapskrav, f\u00F6rm\u00E5gor och centrala inneh\u00E5ll"),
                    (!!module.startWeek || !!module.endWeek) && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "week-period-div" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Startvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.startWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, "Slutvecka"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, module.endWeek || "--"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_3__["KnowledgeRequirementsTable"], { title: "I den h\u00E4r modulen bed\u00F6ms f\u00F6ljande kunskapskrav", requirements: course.knowledgeRequirements, includedIds: incluedIds }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_5__["AbilitiesBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande f\u00F6rm\u00E5gor", abilities: course.abilities.filter(function (a) { return incluedIds[a.id]; }) }),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_6__["CentralContentBox"], { title: "Den h\u00E4r modulen behandlar f\u00F6ljande centrala inneh\u00E5ll", centralContent: course.centralContent.filter(function (c) { return incluedIds[c.id]; }) }))),
            module.taskIds.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-script-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    assignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_task_list__WEBPACK_IMPORTED_MODULE_8__["TaskList"], { learningTasks: assignmentTasks })),
                    nonAssignmentTasks.length === 0 ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgifter"),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_learning_goals_list__WEBPACK_IMPORTED_MODULE_7__["LearningGoalsList"], { commonTasks: commonTasks, learningGoals: Object.keys(learningGoals).map(function (learningGoal) { return ({
                                name: learningGoal,
                                learningTasks: learningGoals[learningGoal]
                            }); }) })))),
            module.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, module.resources.map(function (r, idx) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                    })))));
    };
    return CourseModulePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/get-customized-task.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/course-page/get-customized-task.ts ***!
  \*************************************************************************/
/*! exports provided: getCustomizedTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getCustomizedTask", function() { return getCustomizedTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function getCustomizedTask(module, task) {
    return module.taskCustomizations ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, module.taskCustomizations[task.id]) :
        task;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/index.tsx":
/*!************************************************************!*\
  !*** ./src/components/course-viewer/course-page/index.tsx ***!
  \************************************************************/
/*! exports provided: CoursePage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CoursePage", function() { return CoursePage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_banner__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _course_module_page__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./course-module-page */ "./src/components/course-viewer/course-page/course-module-page.tsx");
/* harmony import */ var _run_up_page__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./run-up-page */ "./src/components/course-viewer/course-page/run-up-page.tsx");
/* harmony import */ var _utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/manual-scroll-restoration */ "./src/components/course-viewer/utils/manual-scroll-restoration.ts");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../weekplanner */ "./src/components/weekplanner/index.ts");
/* harmony import */ var _task_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./task-page */ "./src/components/course-viewer/course-page/task-page.tsx");
/* harmony import */ var _get_customized_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./get-customized-task */ "./src/components/course-viewer/course-page/get-customized-task.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");











Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["initManualScrollRestoration"])();
var CoursePage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CoursePage, _super);
    function CoursePage(props) {
        var _this = _super.call(this, props) || this;
        _this.onHashChange = _this.onHashChange.bind(_this);
        var _a = _this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        _this.state = {
            module: module,
            task: task
        };
        return _this;
    }
    CoursePage.prototype.getModuleAndTaskFromHash = function () {
        var split = (location.hash.substr(1) || "").split('/');
        if (split.length > 0 && !split[0])
            split = split.slice(1); // Allow leading slash #/module/task
        var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](split.map(function (part) { return decodeURIComponent(part); }), 2), moduleName = _a[0], taskId = _a[1];
        var module = this.props.course.modules
            .filter(function (m) { return (m.name || "")
            .trim().toLowerCase() === (moduleName || "").trim().toLowerCase(); })[0] || null;
        var task = taskId ?
            this.props.course.tasks.find(function (t) { return t.id === taskId; }) || null :
            null;
        if (task && !module) {
            // Resolve module by finding the module that holds the task:
            module = this.getOrderedModules()
                .filter(function (m) { return m.taskIds
                .some(function (taskId) { return task.id === taskId; }); })[0];
        }
        if (task && module) {
            task = Object(_get_customized_task__WEBPACK_IMPORTED_MODULE_9__["getCustomizedTask"])(module, task);
        }
        return { module: module, task: task };
    };
    CoursePage.prototype.componentDidMount = function () {
        window.addEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.componentWillUnmount = function () {
        window.removeEventListener('hashchange', this.onHashChange);
    };
    CoursePage.prototype.onHashChange = function () {
        var _a = this.getModuleAndTaskFromHash(), module = _a.module, task = _a.task;
        this.setState({
            module: module,
            task: task
        }, function () {
            var fallbackScrollPosition = undefined;
            if (task) {
                var taskAnchor = document.getElementById('ked-task-anchor');
                if (taskAnchor)
                    fallbackScrollPosition = (window.pageYOffset + taskAnchor.getBoundingClientRect().top);
                else
                    fallbackScrollPosition = 0;
            }
            Object(_utils_manual_scroll_restoration__WEBPACK_IMPORTED_MODULE_5__["restoreScrollPosition"])({ fallbackScrollPosition: fallbackScrollPosition });
        });
    };
    CoursePage.prototype.getOrderedModules = function () {
        var course = this.props.course;
        var moduleOrder = course.moduleOrder || course.modules.map(function (m) { return m.id; });
        return moduleOrder
            // Map ordered id to module
            .map(function (id) { return course.modules.find(function (m) { return m.id === id && !m.inactive; }); })
            // Ignore entries that only exists in moduleOrder but not in modules
            .filter(function (m) { return !!m; })
            // Append modules at end that are not listed in moduleOrder
            .concat(course.modules.filter(function (m) { return !moduleOrder.find(function (id) { return m.id === id; }); }));
    };
    CoursePage.prototype.render = function () {
        var _a = this.props, course = _a.course, courseBuilderUrl = _a.courseBuilderUrl;
        var _b = this.state, module = _b.module, task = _b.task;
        var orderedModules = this.getOrderedModules();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_banner__WEBPACK_IMPORTED_MODULE_2__["CourseBanner"], { title: course.name + " - " + course.points + "p", backgroundImage: (course.images.find(function (img) { return img.id === course.imageId; }) || { url: '' }).url, tabs: [{ name: "Upptakt", link: "#", key: "Upptakt" }]
                    .concat(orderedModules.map(function (_a) {
                    var name = _a.name;
                    return ({ name: name, link: "#" + encodeURIComponent(name), key: name });
                }))
                    .concat(course.workFlowLink ? [{
                        name: "Arbetsgång",
                        key: "workflow",
                        link: course.workFlowLink
                    }] : [])
                    .concat(Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["hasWriteAccess"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"].currentUser, course) ? [{
                        name: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("span", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-pencil", "aria-hidden": "true" }),
                            " Redigera denna kurs"),
                        key: "edit",
                        link: Object(_access_control__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(courseBuilderUrl, {}) + "#/courses/" + course.id + "/edit"
                    }] : []), activeTab: module ? "#" + encodeURIComponent(module.name) : "#" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "pagecontent sv-layout sv-spacer-20pxvt sv-skip-spacer" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-row sv-layout sv-skip-spacer" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-7" }, task ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_page__WEBPACK_IMPORTED_MODULE_8__["TaskPage"], { task: task, course: course }) :
                                    module ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_module_page__WEBPACK_IMPORTED_MODULE_3__["CourseModulePage"], { course: course, module: module }) :
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_run_up_page__WEBPACK_IMPORTED_MODULE_4__["RunUpPage"], { course: course })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-layout sv-column-5" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-vertical sv-layout sv-skip-spacer" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_weekplanner__WEBPACK_IMPORTED_MODULE_7__["WeekPlanner"], { viewCourseUrl: '', env: _globals_KED_env__WEBPACK_IMPORTED_MODULE_10__["default"] }))))))))));
    };
    return CoursePage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/run-up-page.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/run-up-page.tsx ***!
  \******************************************************************/
/*! exports provided: RunUpPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RunUpPage", function() { return RunUpPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../subcomponents/resource-list */ "./src/components/course-viewer/subcomponents/resource-list.tsx");


// Views




var RunUpPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](RunUpPage, _super);
    function RunUpPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    RunUpPage.prototype.render = function () {
        var course = this.props.course;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                course.runUpText && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", null, "Upptakt"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "normal", dangerouslySetInnerHTML: { __html: course.runUpText } })),
                course.responsibleTeachers && course.responsibleTeachers.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "L\u00E4rare"),
                    course.responsibleTeachers.map(function (teacher, i) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: i },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: interpretTeacherUrl(teacher.url) }, teacher.name));
                    })),
                course.workFlowLink && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", href: course.workFlowLink }, "Arbetsg\u00E5ng"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "\u00C4mnets f\u00F6rm\u00E5gor", subTitle: "F\u00F6rm\u00E5gor", abilities: course.abilities, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Kursens centrala inneh\u00E5ll", subTitle: "Centralt inneh\u00E5ll", centralContent: course.centralContent, className: "larger" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsTable"], { title: "Kursens kunskapskrav", requirements: course.knowledgeRequirements, className: "larger" })),
            course.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_resource_list__WEBPACK_IMPORTED_MODULE_5__["ResourceList"], { resources: course.resources }))));
    };
    return RunUpPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function interpretTeacherUrl(url) {
    if (url.indexOf(':') === -1 && url.indexOf('@') >= 0)
        return "mailto:" + url;
    return url;
}


/***/ }),

/***/ "./src/components/course-viewer/course-page/task-assignments.tsx":
/*!***********************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-assignments.tsx ***!
  \***********************************************************************/
/*! exports provided: TaskAssignments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskAssignments", function() { return TaskAssignments; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! downloadjs */ "./node_modules/downloadjs/download.js");
/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var _urkund_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./urkund-utils */ "./src/components/course-viewer/course-page/urkund-utils.ts");
/* harmony import */ var _course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../course-builder-ks/logic/is-employee */ "./src/components/course-builder-ks/logic/is-employee.ts");
/* harmony import */ var _apis_google_picker__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../apis/google-picker */ "./src/apis/google-picker.ts");
/* harmony import */ var _apis_buttons__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../../apis/buttons */ "./src/apis/buttons.tsx");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../../features */ "./src/features/index.ts");














var MAX_URKUND_FILE_SIZE_MB = 50;
var MAX_NONURKUND_FILE_SIZE_MB = 100;
var ALLOWED_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc",
    ".cad",
    ".wav",
    ".mp3",
    ".mpeg4",
    ".mp4",
    ".zip",
    ".png",
    ".jpg",
    ".jpeg",
    ".gif"
];
var URKUND_EXTENSIONS = [
    ".pdf",
    ".odt",
    ".docx",
    ".doc"
];
var TaskAssignments = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskAssignments, _super);
    function TaskAssignments(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            assignments: [],
            loading: true
        };
        return _this;
    }
    TaskAssignments.prototype.setStatePromised = function (cb) {
        var _this = this;
        return new Promise(function (resolve) { return _super.prototype.setState.call(_this, cb, resolve); });
    };
    TaskAssignments.prototype.componentDidMount = function () {
        this.load();
    };
    TaskAssignments.prototype.componentWillReceiveProps = function (nextProps) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var err_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 4, , 5]);
                        if (!(nextProps.taskId !== this.props.taskId ||
                            nextProps.courseId !== this.props.courseId)) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.setStatePromised(function () { return ({
                                assignments: [],
                                loading: true
                            }); })];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3: return [3 /*break*/, 5];
                    case 4:
                        err_1 = _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err_1);
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.update = function (assignments, assignment) {
        var retval = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([
            assignment
        ], assignments.filter(function (_a) {
            var user = _a.user, filename = _a.filename;
            return user !== assignment.user ||
                filename !== assignment.filename;
        }));
        return retval;
    };
    TaskAssignments.prototype.refreshAssignment = function (assignment) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, user, filename, req, _b, _c, resJson_1, e_1;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        user = assignment.user, filename = assignment.filename;
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: true }))
                                });
                            })];
                    case 1:
                        _d.sent();
                        _d.label = 2;
                    case 2:
                        _d.trys.push([2, 8, , 10]);
                        return [4 /*yield*/, client.get("assignments/urkund/" + school + "/" + courseId + "/" + taskId + "/" + user + "/" + filename)];
                    case 3:
                        req = _d.sent();
                        if (!(req.status >= 400)) return [3 /*break*/, 5];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, req.status];
                        return [4 /*yield*/, req.text()];
                    case 4: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 5: return [4 /*yield*/, req.text()];
                    case 6:
                        resJson_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment.metadata, { urkundResponse: resJson_1 }) }))
                                });
                            })];
                    case 7:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 8:
                        e_1 = _d.sent();
                        return [4 /*yield*/, this.setState(function (_a) {
                                var assignments = _a.assignments;
                                return ({
                                    assignments: _this.update(assignments, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, assignment, { isRefreshing: false, refreshError: e_1 }))
                                });
                            })];
                    case 9:
                        _d.sent();
                        return [3 /*break*/, 10];
                    case 10: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_2, _a, client, _b, courseId, taskId, school, teacherAtSchool, res, _c, _d, assignments, refreshableAssigments, refreshableAssigments_1, refreshableAssigments_1_1, a, e_2_1, error_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_e) {
                switch (_e.label) {
                    case 0:
                        _e.trys.push([0, 13, , 14]);
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _b = this.props, courseId = _b.courseId, taskId = _b.taskId, school = _b.school;
                        teacherAtSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
                        return [4 /*yield*/, (teacherAtSchool ?
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId) :
                                client.get("assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail))];
                    case 1:
                        res = _e.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _c = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _d = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_c.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _d.concat([_e.sent()])))();
                    case 3: return [4 /*yield*/, res.json()];
                    case 4:
                        assignments = _e.sent();
                        this.setState({
                            error: null,
                            loading: false,
                            assignments: assignments
                        });
                        if (!teacherAtSchool) return [3 /*break*/, 12];
                        refreshableAssigments = assignments.filter(function (a) {
                            return a.metadata && // Must have metadata.urkundExternalId Otherwise not possible to refresh
                                !a.metadata.urkundUploadError && ( // Not possible to refresh if upload has failed
                            !a.metadata.urkundLastPoll || // Never checked status yet
                                (['Accepted', 'Submitted'].indexOf(JSON.parse(a.metadata.urkundResponse)[0].Status.State) >= 0 &&
                                    parseInt(a.metadata.urkundLastPoll) < moment__WEBPACK_IMPORTED_MODULE_5___default()().add(-15, "seconds").toDate().getTime()));
                        }
                        // Checked status for a long time ago
                        );
                        _e.label = 5;
                    case 5:
                        _e.trys.push([5, 10, 11, 12]);
                        refreshableAssigments_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](refreshableAssigments), refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        _e.label = 6;
                    case 6:
                        if (!!refreshableAssigments_1_1.done) return [3 /*break*/, 9];
                        a = refreshableAssigments_1_1.value;
                        return [4 /*yield*/, this.refreshAssignment(a)];
                    case 7:
                        _e.sent();
                        _e.label = 8;
                    case 8:
                        refreshableAssigments_1_1 = refreshableAssigments_1.next();
                        return [3 /*break*/, 6];
                    case 9: return [3 /*break*/, 12];
                    case 10:
                        e_2_1 = _e.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 12];
                    case 11:
                        try {
                            if (refreshableAssigments_1_1 && !refreshableAssigments_1_1.done && (_a = refreshableAssigments_1.return)) _a.call(refreshableAssigments_1);
                        }
                        finally { if (e_2) throw e_2.error; }
                        return [7 /*endfinally*/];
                    case 12: return [3 /*break*/, 14];
                    case 13:
                        error_1 = _e.sent();
                        this.setState({
                            loading: false,
                            error: "Kunde inte ladda inl\u00E4mningsuppgifter",
                            assignments: []
                        });
                        console.error(error_1);
                        return [3 /*break*/, 14];
                    case 14: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.onDrag = function (ev) {
        ev.stopPropagation();
        ev.preventDefault();
        ev.dataTransfer.dropEffect = 'copy';
    };
    TaskAssignments.prototype.verifyAndUpload = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var error_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 3, , 4]);
                        if (!file)
                            return [2 /*return*/];
                        if (this.state.assignments.some(function (a) {
                            return a.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                a.filename === file.name;
                        })) {
                            if (!confirm("Ers\u00E4tta befintlig fil (" + file.name + ")?")) {
                                return [2 /*return*/];
                            }
                        }
                        if (this.props.school.toLowerCase() !== _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school.toLowerCase()) {
                            if (!confirm("Uppgiften tillh\u00F6r en annan skola (" + this.props.school + ").\n" +
                                "Vill du \u00E4nd\u00E5 l\u00E4mna in ditt arbete h\u00E4r?")) {
                                return [2 /*return*/];
                            }
                        }
                        this.setState({ uploadingFile: file });
                        return [4 /*yield*/, this.upload(file)];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.load()];
                    case 2:
                        _a.sent();
                        this.setState({
                            uploadingFile: null
                        });
                        return [3 /*break*/, 4];
                    case 3:
                        error_2 = _a.sent();
                        this.setState({
                            error: "Kunde inte ladda upp filen. " + (error_2.message || error_2),
                            uploadingFile: null
                        });
                        console.error(error_2);
                        return [3 /*break*/, 4];
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.upload = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var client, _a, courseId, taskId, school, mail, isUrkundExtension, lowerFilename, body, res, _b, _c;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_d) {
                switch (_d.label) {
                    case 0:
                        client = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http;
                        _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
                        mail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail;
                        isUrkundExtension = URKUND_EXTENSIONS
                            .indexOf("." + file.name.split('.').reverse()[0].toLowerCase()) >= 0;
                        if (isUrkundExtension) {
                            if (file.size > MAX_URKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filer av denna typ f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_URKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        else {
                            if (file.size > MAX_NONURKUND_FILE_SIZE_MB * 1024 * 1024) {
                                throw new Error("Filen f\u00E5r inte vara st\u00F6rre \u00E4n " + MAX_NONURKUND_FILE_SIZE_MB + " MB");
                            }
                        }
                        lowerFilename = file.name.toLowerCase();
                        if (!ALLOWED_EXTENSIONS.some(function (ext) { return lowerFilename.endsWith(ext); })) {
                            throw new Error("Filens \u00E4ndelse m\u00E5ste vara " + ALLOWED_EXTENSIONS.join(' / '));
                        }
                        body = new FormData();
                        body.append('files', file);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch("assignments/" + school + "/" + courseId + "/" + taskId + "/" + mail, 'put', {}, {
                                userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName
                            }, {
                                body: body
                            })];
                    case 1:
                        res = _d.sent();
                        if (!(res.status !== 200)) return [3 /*break*/, 3];
                        _b = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _c = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_b.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _c.concat([_d.sent()])))();
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.download = function (file) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, blob, err_2;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 5, , 6]);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(file.mediaLink, 'get', {})];
                    case 1:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 3];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 2: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 3: return [4 /*yield*/, res.blob()];
                    case 4:
                        blob = _c.sent();
                        downloadjs__WEBPACK_IMPORTED_MODULE_8___default()(blob, file.filename, file.contentType);
                        return [3 /*break*/, 6];
                    case 5:
                        err_2 = _c.sent();
                        this.setState({ error: "Kunde inte ladda ned filen. " + (err_2.message || err_2) });
                        console.error(err_2);
                        return [3 /*break*/, 6];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.delete = function (url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var res, _a, _b, err_3;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _c.trys.push([0, 6, , 7]);
                        return [4 /*yield*/, this.setStatePromised(function (_a) {
                                var assignments = _a.assignments;
                                return ({ assignments: assignments.map(function (a) { return a.mediaLink === url ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a, { metadata: tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a.metadata, { $meta: 'delete' }) }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, a); }) });
                            })];
                    case 1:
                        _c.sent();
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.http.fetch(url, 'delete', {})];
                    case 2:
                        res = _c.sent();
                        if (!(res.status >= 400)) return [3 /*break*/, 4];
                        _a = kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"].bind;
                        _b = [void 0, res.status];
                        return [4 /*yield*/, res.text()];
                    case 3: throw new (_a.apply(kedbackend_client__WEBPACK_IMPORTED_MODULE_6__["HttpError"], _b.concat([_c.sent()])))();
                    case 4: return [4 /*yield*/, this.load()];
                    case 5:
                        _c.sent();
                        return [3 /*break*/, 7];
                    case 6:
                        err_3 = _c.sent();
                        this.setState({ error: "Kunde inte ta bort filen. " + (err_3.message || err_3) });
                        console.error(err_3);
                        return [3 /*break*/, 7];
                    case 7: return [2 /*return*/];
                }
            });
        });
    };
    TaskAssignments.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseId = _a.courseId, taskId = _a.taskId, school = _a.school;
        var _b = this.state, loading = _b.loading, assignments = _b.assignments, error = _b.error, uploadingFile = _b.uploadingFile;
        var teacherAtThisSchool = Object(_access_control__WEBPACK_IMPORTED_MODULE_7__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser, school);
        var files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](assignments);
        var showGooglePicker = _features__WEBPACK_IMPORTED_MODULE_13__["features"].picker;
        if (uploadingFile) {
            var virtualFile_1 = {
                school: school,
                courseId: courseId,
                taskId: taskId,
                filename: uploadingFile.name,
                size: uploadingFile.size,
                user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail,
                contentType: uploadingFile.type,
                uploadDate: Date.now(),
                mediaLink: "assignments/" + school + "/" + courseId + "/" + taskId + "/" + _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail + "/" + uploadingFile.name,
                metadata: { $meta: 'add', userDisplayName: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.displayName }
            };
            files = files.filter(function (file) { return file.mediaLink !== virtualFile_1.mediaLink; });
            files = tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](files, [virtualFile_1]);
        }
        files = files.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProps"])([
            "metadata.userDisplayName",
            "filename",
            "uploadDate"
        ], ["sv", "en"], { sensitivity: 'base' }));
        var hasOwnDocs = files.some(function (file) { return file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail; });
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { onDragOver: function (ev) { return _this.onDrag(ev); }, onDrop: function (ev) {
                ev.stopPropagation();
                ev.preventDefault();
                _this.verifyAndUpload(ev.dataTransfer.files[0]);
            } },
            error ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "error" }, error)) : undefined,
            loading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                " Laddar inl\u00E4mnade filer...") : files.length === 0 ?
                teacherAtThisSchool ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Ingen elev har l\u00E4mnat in n\u00E5got arbete \u00E4nnu.") :
                    undefined
                : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", { className: "task-assignments-table" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null,
                                teacherAtThisSchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Elev") : undefined,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Filnamn"),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Inl\u00E4mnat den"),
                                teacherAtThisSchool && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Rapport"),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null, "Niv\u00E5")),
                                hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", null))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, files.map(function (file) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: file.mediaLink, style: file.metadata.$meta ? { opacity: 0.5 } : {} },
                            teacherAtThisSchool ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "mailto:" + file.user }, file.metadata.userDisplayName || file.user)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                            ev.preventDefault();
                                            ev.stopPropagation();
                                            _this.download(file);
                                        } }, file.filename)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm')),
                                file.metadata.$meta === 'add' ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                        " Laddar upp...") :
                                    file.metadata.$meta === 'delete' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Tar bort...") :
                                        (function () {
                                            var metadata = file.metadata;
                                            var urkundResponses = metadata.urkundResponse && JSON.parse(metadata.urkundResponse);
                                            var urkundResponse = urkundResponses && urkundResponses[0];
                                            if (!urkundResponse && file.metadata.urkundUploadError) {
                                                urkundResponse = {
                                                    Status: {
                                                        ErrorCode: -1,
                                                        Message: file.metadata.urkundUploadError,
                                                        State: 'Error'
                                                    },
                                                    ExternalId: file.metadata.urkundExternalId
                                                };
                                            }
                                            if (file.isRefreshing)
                                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                                    " Uppdaterar...");
                                            return urkundResponse ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: urkundResponse.Report && urkundResponse.Report.ReportUrl, onClick: function (ev) {
                                                            if (['Accepted', 'Submitted'].indexOf(urkundResponse.Status.State) === -1)
                                                                return; // Follow HREF instead.
                                                            ev.preventDefault();
                                                            ev.stopPropagation();
                                                            _this.refreshAssignment(file);
                                                        }, target: "_blank", title: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundHoverText"])(urkundResponse) },
                                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundStatusClass"])(urkundResponse) }))),
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "urkund-status-col" },
                                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: Object(_urkund_utils__WEBPACK_IMPORTED_MODULE_9__["getUrkundSignificanceClass"])(urkundResponse) }, urkundResponse.Report && typeof urkundResponse.Report.Significance === 'number' ?
                                                        urkundResponse.Report.Significance.toFixed() + "%" : ' '))) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { colSpan: 2 });
                                        })()) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null,
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                            ev.preventDefault();
                                            ev.stopPropagation();
                                            _this.download(file);
                                        } }, file.filename)),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { className: "assignment-date-col" }, file.metadata.$meta === 'add' ?
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                        " Laddar upp...") :
                                    file.metadata.$meta === 'delete' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null),
                                            " Tar bort...") :
                                        moment__WEBPACK_IMPORTED_MODULE_5___default()(file.uploadDate).format('YYYY-MM-DD HH:mm'))),
                            hasOwnDocs && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", null, !file.metadata.$meta && file.user === _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail &&
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: "#", onClick: function (ev) {
                                        ev.stopPropagation();
                                        ev.preventDefault();
                                        if (confirm("Radera inl\u00E4mnad fil " + file.filename + "?"))
                                            _this.delete(file.mediaLink);
                                    } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))); })))),
            Object(_course_builder_ks_logic_is_employee__WEBPACK_IMPORTED_MODULE_10__["isEmployee"])() ? undefined : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "drop-zone task-assignment-drop-zone" },
                    "Droppa ditt f\u00E4rdiga arbete h\u00E4r.",
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
                    "Det g\u00E5r ocks\u00E5 bra att anv\u00E4nda bl\u00E4ddra-knappen nedan."),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "file", onChange: function (ev) { return _this.verifyAndUpload(ev.target.files[0]); } }),
                showGooglePicker && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_apis_buttons__WEBPACK_IMPORTED_MODULE_12__["DriveButton"], { label: "H\u00E4mta fr\u00E5n Google Drive", action: function () {
                        var picker = new _apis_google_picker__WEBPACK_IMPORTED_MODULE_11__["GooglePicker"]({ upload: true });
                        picker.show().then(function (files) {
                            picker.downloadFile({
                                file: files[0],
                                limitSize: MAX_NONURKUND_FILE_SIZE_MB
                            }).then(function (file) { return _this.verifyAndUpload(file); });
                        });
                    } }))));
    };
    return TaskAssignments;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/course-page/task-page.tsx":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/course-page/task-page.tsx ***!
  \****************************************************************/
/*! exports provided: TaskPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskPage", function() { return TaskPage; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../subcomponents/abilities-box */ "./src/components/course-viewer/subcomponents/abilities-box.tsx");
/* harmony import */ var _subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../subcomponents/central-content-box */ "./src/components/course-viewer/subcomponents/central-content-box.tsx");
/* harmony import */ var _subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../subcomponents/knowledge-requirements-table */ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _task_assignments__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./task-assignments */ "./src/components/course-viewer/course-page/task-assignments.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../../access-control */ "./src/access-control/index.ts");












var TaskPage = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskPage, _super);
    function TaskPage(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: undefined,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()().week()
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    TaskPage.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onUserTasksChanged);
    };
    TaskPage.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.task.id !== this.props.task.id) {
            var userTask = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === nextProps.task.id; }) || null;
            this.setState({
                userTask: userTask,
                weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
            });
        }
    };
    TaskPage.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var userTask = userTasks.find(function (ut) { return ut.task && ut.task.length > 0 && ut.task[0].id === _this.props.task.id; }) || null;
        this.setState({
            userTask: userTask,
            weekPlannerWeek: moment__WEBPACK_IMPORTED_MODULE_9___default()(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate).week()
        });
    };
    TaskPage.prototype.toggleTask = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var weekDate, userTask, _a, course, task, module, latestTimeStamp, userTask_1;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        weekDate = _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].persistedState.weekDate;
                        userTask = this.state.userTask;
                        _a = this.props, course = _a.course, task = _a.task;
                        module = course.modules.find(function (m) { return m.taskIds.some(function (id) { return id === task.id; }); });
                        if (!module)
                            return [2 /*return*/]; // Oh uh!
                        if (userTask === undefined)
                            return [2 /*return*/]; // Not yet loaded.
                        if (!!userTask) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(_repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].mem.items.map(function (t) { return t.dateTime; })));
                        userTask_1 = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["createUUID"])(),
                            courseName: course.name,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: task.learningGoal || module.name,
                            name: task.name,
                            url: task.url,
                            task: [task],
                            course: [course],
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not own tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_7__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (task.deadline) {
                            userTask_1.deadline = task.deadline;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(this.props.course.name, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask_1])
                            ])];
                    case 1:
                        _b.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete([userTask.id])];
                    case 3:
                        _b.sent();
                        _b.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskPage.prototype.render = function () {
        var _this = this;
        var _a = this.props, task = _a.task, course = _a.course;
        var _b = this.state, userTask = _b.userTask, weekPlannerWeek = _b.weekPlannerWeek;
        var abilities = task.abilities.map(function (a) { return course.abilities.find(function (ab) { return ab.id === a.id; }); }).filter(function (a) { return !!a; });
        var centralContent = task.centralContent.map(function (c) { return course.centralContent.find(function (cc) { return cc.id == c.id; }); }).filter(function (c) { return !!c; });
        var requirements = task.knowledgeRequirements.map(function (k) { return course.knowledgeRequirements.find(function (kr) { return kr.id === k.id; }); }).filter(function (k) { return !!k; });
        var isWorking = userTask && (userTask.$meta === 'adding' || userTask.$meta === 'deleting');
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_9___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "loggboken" :
            weekPlannerWeek === currentWeek + 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (n\u00E4sta vecka)"], ["vald vecka (n\u00E4sta vecka)"]))) :
                weekPlannerWeek === currentWeek - 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (f\u00F6rra veckan)"], ["vald vecka (f\u00F6rra veckan)"]))) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["vald vecka (v ", ")"], ["vald vecka (v ", ")"])), weekPlannerWeek);
        var deadlineTooLate = task.deadline && moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).endOf('day') < moment__WEBPACK_IMPORTED_MODULE_9___default()();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet sv-use-margins sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-text-portlet-content" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h1", { className: "h1" }, task.name))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                task.content && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { dangerouslySetInnerHTML: { __html: task.content } })),
                task.learningGoal && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Uppgiftens l\u00E4randem\u00E5l"),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, task.learningGoal)),
                task.url && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: task.url, className: "btn btn-large" }, "G\u00E5 till uppgiften")),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            task.assignment ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Inl\u00E4mningsuppgift"),
                Object(_access_control__WEBPACK_IMPORTED_MODULE_11__["isTeacherAtSchool"])(_globals_KED_env__WEBPACK_IMPORTED_MODULE_8__["default"].currentUser, course.school) ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "H\u00E4r kan du som l\u00E4rare se elevernas inl\u00E4mnade arbeten.") : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, "Det h\u00E4r \u00E4r en inl\u00E4mningsuppgift. L\u00E4mna in ditt arbete som en pdf, doc eller odt fil genom att dra det till f\u00E4ltet under. Du kan \u00E4ven ladda up en fil eller v\u00E4lja en fil fr\u00E5n din Google Drive."),
                    task.deadline ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("b", null,
                            "Den h\u00E4r uppgiften ",
                            deadlineTooLate ? 'skulle ha lämnats in ' : 'ska vara inlämnad ',
                            moment__WEBPACK_IMPORTED_MODULE_9___default()(task.deadline).format('YYYY-MM-DD'))) : undefined),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_assignments__WEBPACK_IMPORTED_MODULE_10__["TaskAssignments"], { courseId: course.id, taskId: task.id, school: course.school }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)) : undefined,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                abilities.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_abilities_box__WEBPACK_IMPORTED_MODULE_2__["AbilitiesBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande f\u00F6rm\u00E5gor", className: "larger", headerOpen: false, abilities: abilities }),
                centralContent.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_central_content_box__WEBPACK_IMPORTED_MODULE_3__["CentralContentBox"], { title: "Den h\u00E4r uppgiften behandlar f\u00F6ljande centrala inneh\u00E5ll", className: "larger", headerOpen: false, centralContent: centralContent }),
                requirements.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_subcomponents_knowledge_requirements_table__WEBPACK_IMPORTED_MODULE_4__["KnowledgeRequirementsTable"], { title: "I den h\u00E4r uppgiften bed\u00F6ms f\u00F6ljande kunskapskrav", className: "larger", headerOpen: true, requirements: requirements })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            userTask !== undefined && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (userTask && userTask.$meta !== 'deleting' ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && _this.toggleTask(); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" }, userTask ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort uppgiften fr\u00E5n ", ""], ["Ta bort uppgiften fr\u00E5n ", ""])), forWeekString) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till uppgiften i ", ""], ["L\u00E4gg till uppgiften i ", ""])), forWeekString)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            task.resources && task.resources.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, "Resurser kopplade till uppgiften"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, task.resources.map(function (r, idx) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: r.url }, r.name)));
                })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
    };
    return TaskPage;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-viewer/course-page/urkund-utils.ts":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/course-page/urkund-utils.ts ***!
  \******************************************************************/
/*! exports provided: getUrkundStatusClass, getUrkundHoverText, getUrkundSignificanceClass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundStatusClass", function() { return getUrkundStatusClass; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundHoverText", function() { return getUrkundHoverText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getUrkundSignificanceClass", function() { return getUrkundSignificanceClass; });
function getUrkundStatusClass(res) {
    if (!res || !res.Status) {
        return null;
    }
    else
        switch (res.Status.State) {
            case 'Error':
                return "urkund-status urkund-status-error";
            case 'Submitted':
                return "urkund-status urkund-status-submitted";
            case 'Accepted':
                return "urkund-status urkund-status-accepted";
            case 'Analyzed':
                return "urkund-status urkund-status-analyzed";
        }
}
function getUrkundHoverText(res) {
    if (!res || !res.Status)
        return null;
    switch (res.Status.State) {
        case 'Error':
            return res.ExternalId ?
                "Kunde inte tas emot av urkund. Felkod: " + res.Status.ErrorCode + "\n" +
                    ("External ID: " + res.ExternalId + "\nFelmeddelande: " + res.Status.Message)
                :
                    res.Status.Message;
        case 'Submitted':
            return "Filen \u00E4r uppladdad till Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Accepted':
            return "Filen analyseras fortfarande av Urkund. Klicka f\u00F6r att uppdatera status.";
        case 'Analyzed':
            return "Rapport skapad. Klicka f\u00F6r att \u00F6ppna rapporten i nytt f\u00F6nster";
    }
}
function getUrkundSignificanceClass(res) {
    if (!res || !res.Status)
        return '';
    switch (res.Status.State) {
        case 'Error': return 'urkund-significance-error';
        case 'Submitted': return 'urkund-significance-submitted';
        case 'Accepted': return 'urkund-significance-accepted';
    }
    var report = res.Report;
    if (!report) {
        return "";
    }
    if (report.Significance < 1)
        //return `${cdn}/images/urkund/0.gif`;
        return "urkund-significance urkund-significance-0";
    if (report.Significance < 10)
        //return `${cdn}/images/urkund/1.gif`;
        return "urkund-significance urkund-significance-1";
    if (report.Significance < 25)
        return "urkund-significance urkund-significance-2";
    //return `${cdn}/images/urkund/2.gif`;
    if (report.Significance < 40)
        return "urkund-significance urkund-significance-3";
    //return `${cdn}/images/urkund/3.gif`;
    if (report.Significance < 55)
        return "urkund-significance urkund-significance-4";
    //return `${cdn}/images/urkund/4.gif`;
    if (report.Significance < 70)
        return "urkund-significance urkund-significance-5";
    //return `${cdn}/images/urkund/5.gif`;
    if (report.Significance < 85)
        return "urkund-significance urkund-significance-6";
    //return `${cdn}/images/urkund/6.gif`;
    if (report.Significance < 99.9)
        return "urkund-significance urkund-significance-7";
    //return `${cdn}/images/urkund/7.gif`;
    if (report.Significance >= 99.9)
        return "urkund-significance urkund-significance-8";
    //return `${cdn}/images/urkund/8.gif`;
    return "";
}


/***/ }),

/***/ "./src/components/course-viewer/index.tsx":
/*!************************************************!*\
  !*** ./src/components/course-viewer/index.tsx ***!
  \************************************************/
/*! exports provided: CourseViewer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseViewer", function() { return CourseViewer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/error-success-feedback */ "./src/utils/error-success-feedback.tsx");
/* harmony import */ var _course_builder_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/utils */ "./src/components/course-builder/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _course_page__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./course-page */ "./src/components/course-viewer/course-page/index.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../list-courses/list-courses-page */ "./src/components/list-courses/list-courses-page.tsx");









var CourseViewer = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CourseViewer, _super);
    function CourseViewer(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            course: null,
            isLoading: true
        };
        return _this;
    }
    CourseViewer.prototype.componentWillMount = function () {
        var _this = this;
        this.load().catch(_utils_utils__WEBPACK_IMPORTED_MODULE_2__["showError"])
            .then(function () { return _this.setState({ isLoading: false }); });
    };
    CourseViewer.prototype.load = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var courseId, course, _a;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        courseId = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_7__["parseQueryString"])(location.search)["courseId"];
                        if (!courseId) return [3 /*break*/, 2];
                        return [4 /*yield*/, Object(_course_builder_utils__WEBPACK_IMPORTED_MODULE_4__["loadCourse"])(courseId)];
                    case 1:
                        _a = _b.sent();
                        return [3 /*break*/, 3];
                    case 2:
                        _a = null;
                        _b.label = 3;
                    case 3:
                        course = _a;
                        this.setState({ course: course });
                        document.title =
                            course ?
                                course.name + " - " + course.points + "p" :
                                "Kurser";
                        return [2 /*return*/];
                }
            });
        });
    };
    CourseViewer.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "course-viewer" },
            this.state.isLoading ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_5__["Spinner"], null) :
                this.state.course ?
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_page__WEBPACK_IMPORTED_MODULE_6__["CoursePage"], { course: this.state.course, courseBuilderUrl: this.props.courseBuilderUrl }) :
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_list_courses_list_courses_page__WEBPACK_IMPORTED_MODULE_8__["ListCoursesPage"], null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utils_error_success_feedback__WEBPACK_IMPORTED_MODULE_3__["ErrorSuccessFeedback"], null));
    };
    return CourseViewer;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/abilities-box.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/abilities-box.tsx ***!
  \**********************************************************************/
/*! exports provided: AbilitiesBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbilitiesBox", function() { return AbilitiesBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var AbilitiesBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AbilitiesBox, _super);
    function AbilitiesBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    AbilitiesBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, abilities = _a.abilities, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    abilities.map(function (a) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: a.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: a.name } })));
                    }))));
    };
    return AbilitiesBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/central-content-box.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/central-content-box.tsx ***!
  \****************************************************************************/
/*! exports provided: CentralContentBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CentralContentBox", function() { return CentralContentBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var CentralContentBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](CentralContentBox, _super);
    function CentralContentBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    CentralContentBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, subTitle = _a.subTitle, centralContent = _a.centralContent, className = _a.className;
        var headerOpen = this.state.headerOpen;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "abilityList" },
                    subTitle && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentHeader" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, subTitle)),
                    centralContent.map(function (cc) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: cc.id, className: "contentPart" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "contentText" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { dangerouslySetInnerHTML: { __html: cc.name } })));
                    }))));
    };
    return CentralContentBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/confirmation.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/confirmation.tsx ***!
  \*********************************************************************/
/*! exports provided: Confirmation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Confirmation", function() { return Confirmation; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

function Confirmation(props) {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "confirmation-box " + props.className + (props.visible ? " visible" : "") },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("p", null, props.text),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onConfirm(); } }, "OK"),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("button", { onClick: function () { return props.onCancel(); } }, "Avbryt"));
}


/***/ }),

/***/ "./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx":
/*!*************************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/knowledge-requirements-table.tsx ***!
  \*************************************************************************************/
/*! exports provided: KnowledgeRequirementsTable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KnowledgeRequirementsTable", function() { return KnowledgeRequirementsTable; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");



var KnowledgeRequirementsTable = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](KnowledgeRequirementsTable, _super);
    function KnowledgeRequirementsTable(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {};
        return _this;
    }
    KnowledgeRequirementsTable.prototype.render = function () {
        var _a = this.props, title = _a.title, requirements = _a.requirements, className = _a.className, includedIds = _a.includedIds, headerOpen = _a.headerOpen, explainedRequirements = _a.explainedRequirements;
        var columns = ["E", "C", "A"];
        var rows = [];
        var reqs = requirements.slice();
        var row = null;
        while (true) {
            row = columns.map(function (grade) {
                var pNext = reqs.findIndex(function (r) { return r.gradeStep.toUpperCase() === grade; });
                if (pNext < 0)
                    return null;
                var rv = reqs[pNext];
                reqs.splice(pNext, 1);
                return includedIds ?
                    (includedIds[rv.id] ? rv : undefined) :
                    rv;
            });
            if (row.every(function (r) { return r === null; }))
                break;
            if (!row.every(function (r) { return !r; })) {
                rows.push(row);
            }
        }
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, title), className: className, headerOpen: headerOpen },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("table", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("thead", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, columns.map(function (c) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("th", { key: c }, c); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tbody", null, rows.map(function (row, i) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], { key: i },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", { key: i }, row.map(function (column, j) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, dangerouslySetInnerHTML: { __html: column ? column.name : "" } });
                    })),
                    explainedRequirements && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("tr", null, row.map(function (column, j) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("td", { key: j, className: "explained-requirement" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, (column && explainedRequirements[column.id]) || ""));
                    }))); }))));
    };
    return KnowledgeRequirementsTable;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/learning-goals-list.tsx":
/*!****************************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/learning-goals-list.tsx ***!
  \****************************************************************************/
/*! exports provided: LearningGoalsList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LearningGoalsList", function() { return LearningGoalsList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _task_list__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./task-list */ "./src/components/course-viewer/subcomponents/task-list.tsx");



var LearningGoalsList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](LearningGoalsList, _super);
    function LearningGoalsList() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LearningGoalsList.prototype.render = function () {
        var _a = this.props, commonTasks = _a.commonTasks, learningGoals = _a.learningGoals;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            learningGoals.map(function (lg) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, lg.name),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: lg.learningTasks })); }),
            commonTasks.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                learningGoals.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "\u00D6vergripande"),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_task_list__WEBPACK_IMPORTED_MODULE_2__["TaskList"], { learningTasks: commonTasks })));
    };
    return LearningGoalsList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/resource-list.tsx":
/*!**********************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/resource-list.tsx ***!
  \**********************************************************************/
/*! exports provided: ResourceList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResourceList", function() { return ResourceList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


var ResourceList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ResourceList, _super);
    function ResourceList(props) {
        return _super.call(this, props) || this;
    }
    ResourceList.prototype.render = function () {
        var resources = this.props.resources;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, resources.map(function (resource, idx) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal", key: idx },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: resource.url }, resource.name)));
            })));
    };
    return ResourceList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/course-viewer/subcomponents/task-list.tsx":
/*!******************************************************************!*\
  !*** ./src/components/course-viewer/subcomponents/task-list.tsx ***!
  \******************************************************************/
/*! exports provided: TaskList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TaskList", function() { return TaskList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../repos/user-tasks-repo */ "./src/repos/user-tasks-repo.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _confirmation__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./confirmation */ "./src/components/course-viewer/subcomponents/confirmation.tsx");








var TaskList = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TaskList, _super);
    function TaskList(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            confirmations: []
        };
        _this.onChange = _this.onChange.bind(_this);
        return _this;
    }
    TaskList.prototype.onChange = function (userTasks, persisted) {
        if (persisted.weekDate !== this.state.weekDate) {
            this.setState({
                confirmations: []
            });
        }
        this.setState({
            userTasks: userTasks,
            weekDate: persisted.weekDate
        });
    };
    TaskList.prototype.componentDidMount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].subscribe(this.onChange);
    };
    TaskList.prototype.componentWillUnmount = function () {
        _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].unsubscribe(this.onChange);
    };
    TaskList.prototype.toggleTask = function (learningTask) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var userTasks, weekDate, latestTimeStamp, userTask;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        userTasks = this.state.userTasks.filter(function (ut) {
                            return learningTask.task ?
                                ut.task && ut.task.some(function (t) { return t.id === learningTask.id; }) :
                                ut.siteVisionPageId === learningTask.id;
                        });
                        weekDate = this.state.weekDate;
                        if (!(userTasks.length === 0)) return [3 /*break*/, 2];
                        latestTimeStamp = Math.max.apply(Math.max, [weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        userTask = {
                            id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                            courseName: learningTask.courseName,
                            dateTime: latestTimeStamp + 2000,
                            learningGoal: learningTask.learningGoal,
                            name: learningTask.name,
                            url: learningTask.url,
                            acl: [
                                // Default ACL: Let user self have full control over this item:
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("email", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail, "S"),
                                // Additional ACL: Let employees on same school have read access to it.
                                // This currently only applies to tasks that refer to course tasks (not custom tasks!)
                                new kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["DocumentAccess"]("schoolRole", _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school + "/EMPLOYEE", "R")
                            ].map(function (ac) { return ac.toString(); })
                        };
                        if (learningTask.task && learningTask.task.deadline) {
                            userTask.deadline = learningTask.task.deadline;
                        }
                        if (learningTask.task) {
                            userTask.task = [learningTask.task];
                            if (learningTask.course) {
                                userTask.course = [learningTask.course];
                            }
                            else if (learningTask.courseInfo) {
                                userTask.courseInfo = learningTask.courseInfo;
                            }
                        }
                        else {
                            userTask.siteVisionPageId = learningTask.id;
                        }
                        if (learningTask.step) {
                            userTask.step = learningTask.step;
                        }
                        return [4 /*yield*/, Promise.all([
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].setWeekPlannerBoxOpen(learningTask.courseName, true),
                                _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].insert([userTask])
                            ])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: 
                    // Already present in weekplanner. It's time to delete those that matched us.
                    return [4 /*yield*/, _repos_user_tasks_repo__WEBPACK_IMPORTED_MODULE_5__["userTasksRepo"].delete(userTasks.map(function (t) { return t.id; }))];
                    case 3:
                        // Already present in weekplanner. It's time to delete those that matched us.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    TaskList.prototype.render = function () {
        var _this = this;
        var learningTasks = this.props.learningTasks;
        var userTasks = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["arrayToMap"])(this.state.userTasks, function (ut) { return ut.task && ut.task.length > 0 ?
            ut.task.map(function (t) { return t.id; })[0] : // course-builder tasks looked up by id
            ut.siteVisionPageId ? ut.siteVisionPageId : // non-course-builder tasks
                ut.url; });
        var confirmations = this.state.confirmations;
        var weekPlannerWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()(this.state.weekDate).week();
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_3___default()().week();
        var forWeekString = weekPlannerWeek === currentWeek ? "" :
            weekPlannerWeek === currentWeek + 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r n\u00E4sta vecka (v", ")"], ["f\u00F6r n\u00E4sta vecka (v", ")"])), weekPlannerWeek) :
                weekPlannerWeek === currentWeek - 1 ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r f\u00F6rra veckan (v", ")"], ["f\u00F6r f\u00F6rra veckan (v", ")"])), weekPlannerWeek) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_3 || (templateObject_3 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["f\u00F6r vecka ", ""], ["f\u00F6r vecka ", ""])), weekPlannerWeek);
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, learningTasks.map(function (learningTask, idx) {
            var taskLookupId = learningTask.id;
            var userTask = userTasks[taskLookupId] || { $meta: 'deleted' }; // No exist = $meta: 'deleted'
            var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting';
            var selected = userTask.$meta !== 'deleted' && userTask.$meta !== 'deleting';
            var describedAction = selected ? Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_4 || (templateObject_4 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Ta bort uppgiften fr\u00E5n egen veckoplanering ", ""], ["Ta bort uppgiften fr\u00E5n egen veckoplanering ", ""])), forWeekString) : Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["L"])(templateObject_5 || (templateObject_5 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["L\u00E4gg till uppgiften i egen veckoplanering ", ""], ["L\u00E4gg till uppgiften i egen veckoplanering ", ""])), forWeekString);
            var confirmationVisible = confirmations.some(function (tid) { return taskLookupId === tid; });
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: learningTask.id },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: taskLookupId, className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "selectedBox" + (selected ? ' selected' : ''), style: isWorking ? { opacity: 0.5 } : {}, onClick: function () { return !isWorking && weekPlannerWeek === currentWeek ?
                                _this.toggleTask(learningTask) :
                                confirmationVisible ?
                                    _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) }) :
                                    _this.setState({ confirmations: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](confirmations).concat(taskLookupId) }); }, title: describedAction })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: learningTask.url }, learningTask.name))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_confirmation__WEBPACK_IMPORTED_MODULE_7__["Confirmation"], { visible: confirmationVisible, text: describedAction, onConfirm: function () {
                        _this.toggleTask(learningTask);
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    }, onCancel: function () {
                        _this.setState({ confirmations: confirmations.filter(function (tid) { return tid !== taskLookupId; }) });
                    } }));
        }));
    };
    return TaskList;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;


/***/ }),

/***/ "./src/components/course-viewer/utils/get-included-ids.ts":
/*!****************************************************************!*\
  !*** ./src/components/course-viewer/utils/get-included-ids.ts ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return getIncludedIds; });
function getIncludedIds(module, course) {
    var result = {};
    course.tasks.filter(function (t) { return module.taskIds.indexOf(t.id) !== -1; }).forEach(function (task) {
        task.abilities.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.centralContent.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
        task.knowledgeRequirements.forEach(function (_a) {
            var id = _a.id;
            return result[id] = true;
        });
    });
    return result;
}


/***/ }),

/***/ "./src/components/course-viewer/utils/manual-scroll-restoration.ts":
/*!*************************************************************************!*\
  !*** ./src/components/course-viewer/utils/manual-scroll-restoration.ts ***!
  \*************************************************************************/
/*! exports provided: initManualScrollRestoration, restoreScrollPosition */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "initManualScrollRestoration", function() { return initManualScrollRestoration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "restoreScrollPosition", function() { return restoreScrollPosition; });
var initialized = false;
function initManualScrollRestoration() {
    if (!initialized) {
        initialized = true;
        document.documentElement.addEventListener('click', function (ev) {
            var target = ev.target;
            if (target && target.tagName === 'A') {
                history.replaceState({ pageYOffset: window.pageYOffset }, null, null);
            }
        });
        if (history.scrollRestoration)
            history.scrollRestoration = 'manual';
    }
}
function restoreScrollPosition(_a) {
    var fallbackScrollPosition = _a.fallbackScrollPosition;
    if (history.state && history.state.pageYOffset !== undefined) {
        window.scrollTo(0, history.state.pageYOffset);
    }
    else if (fallbackScrollPosition !== undefined) {
        window.scrollTo(0, fallbackScrollPosition);
    }
}


/***/ }),

/***/ "./src/components/list-courses/list-courses-page.tsx":
/*!***********************************************************!*\
  !*** ./src/components/list-courses/list-courses-page.tsx ***!
  \***********************************************************/
/*! exports provided: ListCoursesPage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCoursesPage", function() { return ListCoursesPage; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../course-viewer/course-page/course-banner */ "./src/components/course-viewer/course-page/course-banner.tsx");
/* harmony import */ var _list_courses__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./list-courses */ "./src/components/list-courses/list-courses.tsx");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");




function ListCoursesPage() {
    return react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_course_viewer_course_page_course_banner__WEBPACK_IMPORTED_MODULE_1__["CourseBanner"], { title: _globals_KED_env__WEBPACK_IMPORTED_MODULE_3__["default"].currentUser.school, backgroundImage: "", tabs: [{ name: "Skolans kurser", link: "#" }], activeTab: "#" }),
        react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-row sv-layout" },
            react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-layout sv-skip-spacer sv-column-12" },
                react__WEBPACK_IMPORTED_MODULE_0__["createElement"]("div", { className: "sv-spacer-20pxvt sv-vertical sv-layout sv-skip-spacer" },
                    react__WEBPACK_IMPORTED_MODULE_0__["createElement"](_list_courses__WEBPACK_IMPORTED_MODULE_2__["ListCourses"], null)))));
}


/***/ }),

/***/ "./src/components/list-courses/list-courses.tsx":
/*!******************************************************!*\
  !*** ./src/components/list-courses/list-courses.tsx ***!
  \******************************************************/
/*! exports provided: ListCourses */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListCourses", function() { return ListCourses; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../repos/hidden-courses-repo */ "./src/repos/hidden-courses-repo.ts");








var ListCourses = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ListCourses, _super);
    function ListCourses(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isLoading: true,
            courses: [],
            headerOpen: false
        };
        _this.updateHiddenCourses = _this.updateHiddenCourses.bind(_this);
        return _this;
    }
    ListCourses.prototype.componentWillMount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].subscribe(this.updateHiddenCourses, { fullCourse: true });
    };
    ListCourses.prototype.componentWillUnmount = function () {
        _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].unsubscribe(this.updateHiddenCourses);
    };
    ListCourses.prototype.updateHiddenCourses = function (courses) {
        this.setState({ courses: courses, isLoading: false });
    };
    ListCourses.prototype.hideCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_1 || (templateObject_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].hideCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.showCourse = function (course) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["L"])(templateObject_2 || (templateObject_2 = tslib__WEBPACK_IMPORTED_MODULE_0__["__makeTemplateObject"](["Sparar..."], ["Sparar..."]))));
                        return [4 /*yield*/, _repos_hidden_courses_repo__WEBPACK_IMPORTED_MODULE_7__["hiddenCoursesRepo"].showCourse(course)];
                    case 1:
                        _a.sent();
                        Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showInfo"])("");
                        return [2 /*return*/];
                }
            });
        });
    };
    ListCourses.prototype.render = function () {
        var _this = this;
        if (this.state.isLoading)
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_4__["Spinner"], null);
        var courses = this.state.courses;
        var visibleCourses = courses.filter(function (course) { return course.visible; });
        var hiddenCourses = courses.filter(function (course) { return !course.visible; });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["parseQueryString"])(location.search);
        var viewCourseUrl = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_2__["default"].KED_COURSE_VIEWER_URL;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null, "Skolans kurser"),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, visibleCourses.map(function (course) {
                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "hideItem", onClick: function () { return _this.hideCourse(course); } })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_access_control_index__WEBPACK_IMPORTED_MODULE_6__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: course.id }) }, course.name))),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
            })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openClose" + (this.state.headerOpen ? " open" : "") },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader", onClick: function () { return _this.setState({ headerOpen: !_this.state.headerOpen }); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, "Dolda kurser")),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer odd-even" }, hiddenCourses.map(function (course) {
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "studentCourse", key: course.id },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top pull-right" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "showItem", onClick: function () { return _this.showCourse(course); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_5__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, query, { courseId: course.id })) }, course.name)),
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { className: "small" }, course.description)));
                    })))));
    };
    return ListCourses;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

var templateObject_1, templateObject_2;


/***/ }),

/***/ "./src/components/utility-components/LanguageContext.tsx":
/*!***************************************************************!*\
  !*** ./src/components/utility-components/LanguageContext.tsx ***!
  \***************************************************************/
/*! exports provided: LanguageContext */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LanguageContext", function() { return LanguageContext; });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);

var LanguageContext = react__WEBPACK_IMPORTED_MODULE_0__["createContext"]({ intl: null });


/***/ }),

/***/ "./src/components/utility-components/SetupLanguageIntl.tsx":
/*!*****************************************************************!*\
  !*** ./src/components/utility-components/SetupLanguageIntl.tsx ***!
  \*****************************************************************/
/*! exports provided: setupIntl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setupIntl", function() { return setupIntl; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl/locale-data/en */ "./node_modules/react-intl/locale-data/en.js");
/* harmony import */ var react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-intl/locale-data/sv */ "./node_modules/react-intl/locale-data/sv.js");
/* harmony import */ var react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../translations/sv.json */ "./src/translations/sv.json");
var _translations_sv_json__WEBPACK_IMPORTED_MODULE_4___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/sv.json */ "./src/translations/sv.json", 1);
/* harmony import */ var _translations_en_json__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../translations/en.json */ "./src/translations/en.json");
var _translations_en_json__WEBPACK_IMPORTED_MODULE_5___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../../translations/en.json */ "./src/translations/en.json", 1);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_8__);









var setupIntl = function (Component) {
    return /** @class */ (function (_super) {
        tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_SetupLanguageIntl, _super);
        function _SetupLanguageIntl(props) {
            var _this = _super.call(this, props) || this;
            Object(react_intl__WEBPACK_IMPORTED_MODULE_1__["addLocaleData"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](react_intl_locale_data_en__WEBPACK_IMPORTED_MODULE_2___default.a, react_intl_locale_data_sv__WEBPACK_IMPORTED_MODULE_3___default.a));
            _this.messages = {
                'sv': _translations_sv_json__WEBPACK_IMPORTED_MODULE_4__,
                'en': _translations_en_json__WEBPACK_IMPORTED_MODULE_5__
            };
            moment__WEBPACK_IMPORTED_MODULE_8___default()().locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE);
            return _this;
        }
        _SetupLanguageIntl.prototype.render = function () {
            return react__WEBPACK_IMPORTED_MODULE_6__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_1__["IntlProvider"], { locale: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE, messages: this.messages[_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_7__["default"].KED_LOCALE] },
                react__WEBPACK_IMPORTED_MODULE_6__["createElement"](Component, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.props)));
        };
        return _SetupLanguageIntl;
    }(react__WEBPACK_IMPORTED_MODULE_6__["Component"]));
};


/***/ }),

/***/ "./src/components/utility-components/dialogs.tsx":
/*!*******************************************************!*\
  !*** ./src/components/utility-components/dialogs.tsx ***!
  \*******************************************************/
/*! exports provided: Dialogs */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialogs", function() { return Dialogs; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ "react-dom");
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react_dom__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jquery */ "jquery");
/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_4__);





var Dialogs = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](Dialogs, _super);
    function Dialogs(props) {
        return _super.call(this, props) || this;
    }
    Dialogs.prototype.componentDidUpdate = function (prevProps) {
        if (this.lastDiv !== null && prevProps.dialogs.length > this.props.dialogs.length) {
            // A dialog was closed. Now focus the last dialog:
            jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(this.lastDiv)).find(':input').first().focus();
        }
    };
    Dialogs.prototype.render = function () {
        var _this = this;
        this.lastDiv = null;
        var _a = this.props, dialogs = _a.dialogs, popDialog = _a.popDialog;
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').attr('aria-disabled', dialogs.length > 0);
        jquery__WEBPACK_IMPORTED_MODULE_4___default()('body').css('overflow', dialogs.length > 0 ? 'hidden' : 'auto');
        return dialogs.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, dialogs.map(function (dialog, idx) {
            var div;
            function onKeyPress(ev) {
                if (ev.which === 13 && (!ev.target || ev.target.tagName !== 'TEXTAREA')) {
                    jquery__WEBPACK_IMPORTED_MODULE_4___default()(Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div)).find('.btn-default').click();
                }
                ev.stopPropagation();
            }
            function onKeyDown(ev) {
                if (ev.which === 27) { // Escape
                    popDialog();
                    ev.stopPropagation();
                    return;
                }
                if (ev.which === 83 && (ev.ctrlKey || ev.metaKey)) { // CTRL-S
                    var domNode = Object(react_dom__WEBPACK_IMPORTED_MODULE_3__["findDOMNode"])(div);
                    ev.preventDefault();
                    var defaultButton = jquery__WEBPACK_IMPORTED_MODULE_4___default()(domNode).find('.btn-default');
                    defaultButton.click();
                    ev.stopPropagation();
                }
            }
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: idx },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "darken" }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page-wrap" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "modal-page", ref: function (elem) {
                            div = elem;
                            if (idx === dialogs.length - 1)
                                _this.lastDiv = elem;
                        }, tabIndex: 0, "aria-disabled": idx < dialogs.length - 1, onKeyPress: onKeyPress, onKeyDown: onKeyDown },
                        dialog,
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_2__["RemoveItem"], { onClick: popDialog }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stopFloats" }))));
        }));
    };
    return Dialogs;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-text-input.tsx":
/*!*********************************************************************!*\
  !*** ./src/components/utility-components/form-field-text-input.tsx ***!
  \*********************************************************************/
/*! exports provided: TextInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextInput", function() { return TextInput; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextInput = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextInput, _super);
    function TextInput(props) {
        return _super.call(this, props) || this;
    }
    TextInput.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", autoFocus: this.props.autoFocus, id: this.props.id, size: 35, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder }))));
    };
    return TextInput;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field-textarea.tsx":
/*!*******************************************************************!*\
  !*** ./src/components/utility-components/form-field-textarea.tsx ***!
  \*******************************************************************/
/*! exports provided: TextAreaFormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextAreaFormField", function() { return TextAreaFormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _form_field__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./form-field */ "./src/components/utility-components/form-field.tsx");



var TextAreaFormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](TextAreaFormField, _super);
    function TextAreaFormField(props) {
        return _super.call(this, props) || this;
    }
    TextAreaFormField.prototype.render = function () {
        var _this = this;
        return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_form_field__WEBPACK_IMPORTED_MODULE_2__["FormField"], { label: this.props.label, id: this.props.id },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { autoFocus: this.props.autoFocus, id: this.props.id, cols: 35, rows: this.props.rows || 5, value: this.props.value, onChange: function (ev) { return _this.props.onChange(ev.target.value); }, placeholder: this.props.placeholder })),
                !!this.props.children && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" }, this.props.children))));
    };
    return TextAreaFormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/form-field.tsx":
/*!**********************************************************!*\
  !*** ./src/components/utility-components/form-field.tsx ***!
  \**********************************************************/
/*! exports provided: FormField */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormField", function() { return FormField; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);


function findId(node) {
    var recucheck = new Set();
    return (function findId(node) {
        if (typeof node === 'string')
            return null;
        if (recucheck.has(node)) {
            return;
        }
        recucheck.add(node);
        if (node.props) {
            if (node.props.id)
                return node.props.id;
            if (node.props.children) {
                return findId(node.props.children);
            }
            return;
        }
        if (node.length) {
            for (var i = 0; i < node.length; ++i) {
                var child = node[i];
                if (child) {
                    var childId = findId(child);
                    if (childId)
                        return childId;
                    //console.log(child);
                }
            }
        }
    })(node);
}
var FormField = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](FormField, _super);
    function FormField(props) {
        return _super.call(this, props) || this;
    }
    FormField.prototype.render = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("label", { className: "kclabel", htmlFor: this.props.id || findId(this.props.children) }, this.props.label),
            this.props.children);
    };
    return FormField;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/utility-components/open-close-box.tsx":
/*!**************************************************************!*\
  !*** ./src/components/utility-components/open-close-box.tsx ***!
  \**************************************************************/
/*! exports provided: OpenCloseBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OpenCloseBox", function() { return OpenCloseBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../charts/goal-progress */ "./src/components/charts/goal-progress.tsx");
/* REFACTOR: Move this component outside coursebuilder!
   This is a general-purpose component
*/



var OpenCloseBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](OpenCloseBox, _super);
    function OpenCloseBox(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            headerOpen: props.headerOpen || false
        };
        return _this;
    }
    OpenCloseBox.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.headerOpen !== this.props.headerOpen) {
            this.setState({ headerOpen: nextProps.headerOpen });
        }
    };
    OpenCloseBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, title = _a.title, className = _a.className, children = _a.children, headerClassName = _a.headerClassName, contentClassName = _a.contentClassName, displayProgress = _a.displayProgress, progressData = _a.progressData;
        var headerOpen = this.state.headerOpen;
        //var currentProgressData = //progressData();
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: (className || '') + " openClose" + (headerOpen ? " open" : "") },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeader" + (headerClassName ? " " + headerClassName : ""), onClick: function () {
                    if (_this.props.onOpenClose)
                        _this.props.onOpenClose(!_this.state.headerOpen);
                    _this.setState({ headerOpen: !_this.state.headerOpen });
                } },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openHeaderContainer" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null, title),
                    displayProgress && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_goal_progress__WEBPACK_IMPORTED_MODULE_2__["GoalProgress"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, progressData)))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "openContent" + (contentClassName ? " " + contentClassName : "") }, children));
    };
    return OpenCloseBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-goal.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-goal.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomGoal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomGoal", function() { return AddCustomGoal; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");



var AddCustomGoal = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomGoal, _super);
    function AddCustomGoal(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            learningGoal: props.learningGoal || ''
        };
        return _this;
    }
    AddCustomGoal.prototype.render = function () {
        var _this = this;
        var learningGoal = this.state.learningGoal;
        var onSave = this.props.onSave;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoalTitle", defaultMessage: "L\u00E4gg till eget l\u00E4randem\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "weekplanner.addLearningGoal", defaultMessage: "M\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("input", { type: "text", tabIndex: 1, size: 50, autoFocus: true, value: learningGoal, onChange: function (e) { return _this.setState({ learningGoal: e.target.value }); } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top spaced" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(learningGoal); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_2__["FormattedMessage"], { id: "common.save", defaultMessage: "save" }))));
    };
    return AddCustomGoal;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-custom-task.tsx":
/*!********************************************************!*\
  !*** ./src/components/weekplanner/add-custom-task.tsx ***!
  \********************************************************/
/*! exports provided: AddCustomTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddCustomTask", function() { return AddCustomTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");






var AddCustomTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddCustomTask, _super);
    function AddCustomTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            name: '',
            description: '',
            url: ''
        };
        return _this;
    }
    AddCustomTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var _b = this.props, isTask = _b.isTask, onSave = _b.onSave;
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "customTask.addWorkGoalTitle", defaultMessage: "L\u00E4gg till eget arbetsm\u00E5l" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.nameLabel', defaultMessage: 'Namn' }), id: "AddCustomTask:name", placeholder: intl.formatMessage({ id: 'customTask.enterNamePlhd', defaultMessage: 'Ange namn...' }), value: name, autoFocus: true, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { rows: 7, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddCustomTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: "Lägg till en beskrivning..." }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Länk' }), id: "AddCustomTask:url", placeholder: "http://www...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return onSave(name, description, url); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddCustomTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_4__["LanguageContext"];
    return AddCustomTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/add-or-edit-sub-task.tsx":
/*!*************************************************************!*\
  !*** ./src/components/weekplanner/add-or-edit-sub-task.tsx ***!
  \*************************************************************/
/*! exports provided: AddOrEditSubTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AddOrEditSubTask", function() { return AddOrEditSubTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");







var AddOrEditSubTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](AddOrEditSubTask, _super);
    function AddOrEditSubTask(props) {
        var _this = _super.call(this, props) || this;
        if (props.mode === 'edit') {
            var subTask = props.subTask;
            _this.state = {
                name: subTask.name || '',
                description: subTask.description || '',
                url: subTask.url || ''
            };
        }
        else {
            _this.state = {
                name: '',
                description: '',
                url: ''
            };
        }
        return _this;
    }
    AddOrEditSubTask.prototype.save = function () {
        // Update repo:
        var props = this.props;
        var userTask = props.userTask, closeDialog = props.closeDialog, userTasksRepo = props.userTasksRepo;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        if (props.mode === 'edit') {
            // Edit existing:
            userTasksRepo.update([userTask], function (ut) {
                var subTasks = ut.subTasks;
                if (subTasks) {
                    ut.subTasks = subTasks.map(function (st) {
                        return st.id === props.subTask.id ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st, { name: name, description: description, url: url }) : tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, st);
                    });
                }
            });
        }
        else {
            // Create new task
            var newSubTask_1 = {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                name: name,
                description: description,
                url: url
            };
            // Update repo:
            userTasksRepo.update([userTask], function (ut) {
                if (!ut.subTasks) {
                    ut.subTasks = [];
                }
                ut.subTasks = ut.subTasks.concat(newSubTask_1);
            });
        }
        // Close dialog
        closeDialog();
    };
    AddOrEditSubTask.prototype.delete = function () {
        // Update repo:
        var props = this.props;
        if (props.mode !== 'edit') {
            throw new Error("Can only delete in edit mode");
        }
        props.userTasksRepo.update([props.userTask], function (ut) {
            if (ut.subTasks) {
                ut.subTasks = ut.subTasks.filter(function (t) { return t.id !== props.subTask.id; });
            }
        });
        // Close dialog:
        props.closeDialog();
    };
    AddOrEditSubTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url;
        var props = this.props;
        var isEditMode = props.mode === 'edit';
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet sv-skip-spacer" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isEditMode ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.editSubtask", defaultMessage: 'Redigera underuppgift' }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.addSubtask", defaultMessage: 'L\u00E4gg till underuppgift' })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { autoFocus: true, label: intl.formatMessage({ id: 'addeditsubtask.nameLabel', defaultMessage: 'Underuppgiftens namn' }), id: "AddUserSubTask:name", placeholder: "", value: this.state.name, onChange: function (name) { return _this.setState({ name: name }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_3__["TextAreaFormField"], { label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "AddUserSubTask:description", rows: 7, placeholder: "", value: this.state.description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_2__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: 'Länk' }), id: "AddUserSubTask:url", placeholder: "", value: this.state.url, onChange: function (url) { return _this.setState({ url: url }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null)),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "sv-html-portlet sv-portlet" },
                props.mode === 'edit' && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn btn-warning btn-large pull-right", onClick: function (ev) { return _this.delete(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "addeditsubtask.deleteSubtask", defaultMessage: "Ta bort underuppgift" })),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-large btn-default", onClick: function () { return _this.save(); } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_5__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))));
    };
    AddOrEditSubTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_6__["LanguageContext"];
    return AddOrEditSubTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/edit-user-task.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/edit-user-task.tsx ***!
  \*******************************************************/
/*! exports provided: EditUserTask */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EditUserTask", function() { return EditUserTask; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var react_datepicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-datepicker */ "./node_modules/react-datepicker/es/index.js");
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");
/* harmony import */ var _utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utility-components/form-field-text-input */ "./src/components/utility-components/form-field-text-input.tsx");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/form-field */ "./src/components/utility-components/form-field.tsx");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utility-components/form-field-textarea */ "./src/components/utility-components/form-field-textarea.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");












var EditUserTask = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](EditUserTask, _super);
    function EditUserTask(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTask: props.userTask,
            name: props.userTask.name,
            description: props.userTask.description,
            url: props.userTask.url,
            deadline: props.userTask.deadline,
            subTasks: props.userTask.subTasks
        };
        _this.onUserTasksChanged = _this.onUserTasksChanged.bind(_this);
        return _this;
    }
    EditUserTask.prototype.componentDidMount = function () {
        this.props.userTasksRepo.subscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.onUserTasksChanged = function (userTasks) {
        var _this = this;
        var myUserTask = userTasks.find(function (ut) { return ut.id === _this.props.userTask.id; });
        if (!myUserTask) {
            this.props.closeDialog();
            return;
        }
        this.setState({
            userTask: myUserTask,
            subTasks: myUserTask.subTasks
        });
    };
    EditUserTask.prototype.componentWillUnmount = function () {
        this.props.userTasksRepo.unsubscribe(this.onUserTasksChanged);
    };
    EditUserTask.prototype.isModified = function () {
        // Don't count subtask changes! They live their own life and is maintained
        // in add-or-edit-sub-task.tsx. Reason: User would expect added /edited subtasks
        // to be persisted right away. May click away this dialog.
        // Also reason: Can invoke that dialog by itself from other components. From WeekPlanner
        // when clicking the subtask for example!
        var _a = this.state, deadline = _a.deadline, description = _a.description, name = _a.name, url = _a.url, userTask = _a.userTask;
        return (deadline !== userTask.deadline ||
            description !== userTask.description ||
            name !== userTask.name ||
            url !== userTask.url);
    };
    EditUserTask.prototype.addSubTask = function () {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "add", userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.editSubTask = function (subTask) {
        this.props.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_8__["AddOrEditSubTask"], { mode: "edit", subTask: subTask, userTask: this.state.userTask, closeDialog: this.props.closeDialog, userTasksRepo: this.props.userTasksRepo }));
    };
    EditUserTask.prototype.render = function () {
        var _this = this;
        var _a = this.state, name = _a.name, description = _a.description, url = _a.url, deadline = _a.deadline, subTasks = _a.subTasks, showCalendar = _a.showCalendar, userTask = _a.userTask;
        var id = userTask.id, courseName = userTask.courseName;
        var _b = this.props, onUpdate = _b.onUpdate, onDelete = _b.onDelete;
        var isModified = this.isModified();
        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_2__["getTaskType"])(userTask);
        var isCustomTask = taskType === 'customTask';
        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline) < moment__WEBPACK_IMPORTED_MODULE_6___default()();
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "editTaskDialog sv-html-portlet sv-portlet sv-skip-spacer" },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h2", null, isCustomTask ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editWorkGoals", defaultMessage: 'Redigera arbetsm\u00E5l' }) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.editTask", defaultMessage: 'Redigera uppgift' })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { autoFocus: true, label: isCustomTask ? intl.formatMessage({ id: 'task.targetNameLabel', defaultMessage: 'Arbetsmålets namn' }) : intl.formatMessage({ id: 'task.taskNameLabel', defaultMessage: 'Uppgiftens namn' }), id: "EditUserTask:name", placeholder: isCustomTask ? intl.formatMessage({ id: 'task.whatShouldYouDoPlhd', defaultMessage: 'Vad ska du göra?' }) : intl.formatMessage({ id: 'task.enterTaskNamePlhd', defaultMessage: 'Ange uppgiftens namn...' }), value: name, onChange: function (name) { return _this.setState({ name: name }); } }),
            isCustomTask && react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_textarea__WEBPACK_IMPORTED_MODULE_9__["TextAreaFormField"], { rows: 5, label: intl.formatMessage({ id: 'common.descriptionLabel', defaultMessage: 'Beskrivning' }), id: "EditUserTask:description", placeholder: intl.formatMessage({ id: 'common.addDescriptionPlhd', defaultMessage: 'Lägg till en beskrivning...' }), value: description, onChange: function (description) { return _this.setState({ description: description }); } }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field_text_input__WEBPACK_IMPORTED_MODULE_5__["TextInput"], { label: intl.formatMessage({ id: 'common.linkLabel', defaultMessage: "Länk" }), id: "EdutUserTask:url", placeholder: "http(s)://...", value: url, onChange: function (url) { return _this.setState({ url: url }); } })),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.setDeadline', defaultMessage: 'Ange deadline' }) }, (deadline || showCalendar) ?
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_datepicker__WEBPACK_IMPORTED_MODULE_3__["default"], { ref: function (elem) { return _this.datePicker = elem; }, id: "EditUserTask:deadline", nextMonthButtonLabel: "", previousMonthButtonLabel: "", showWeekNumbers: true, selected: deadline && moment__WEBPACK_IMPORTED_MODULE_6___default()(deadline).toDate(), autoFocus: showCalendar, dateFormat: "YYYY-MM-dd", className: expired ? "expired" : undefined, locale: intl.locale, popperPlacement: isCustomTask ? "top-start" : "bottom-start", onBlur: function () { return _this.setState({ showCalendar: false }); }, onChange: function (value) {
                                _this.setState({
                                    deadline: value && moment__WEBPACK_IMPORTED_MODULE_6___default()(value).format("YYYY-MM-DD"),
                                    showCalendar: false
                                });
                            } })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "deleteDate", href: "#", title: intl.formatMessage({ id: 'task.removeDeadline', defaultMessage: 'Ta bort deadline' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.setState({ deadline: null, showCalendar: false });
                            } }))) :
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top", ref: function () { _this.datePicker = null; } },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function (ev) {
                            if (_this.datePicker) {
                                _this.datePicker.setOpen(true);
                            }
                            _this.setState({
                                showCalendar: true
                            });
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-calendar", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.setDeadlineLabel", defaultMessage: "Ange deadline..." })))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_form_field__WEBPACK_IMPORTED_MODULE_7__["FormField"], { label: intl.formatMessage({ id: 'task.subTasks', defaultMessage: 'Underuppgifter' }) },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, subTasks && subTasks.map(function (subTask) { return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id, className: "align-horizontal" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { onClick: function () { return _this.editSubTask(subTask); }, href: "#" }, subTask.name))); }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "top" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { id: "EditUserTask:addSubTask", className: "btn", onClick: function () { return _this.addSubTask(); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                            " ",
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.addSubtask", defaultMessage: "L\u00E4gg till underuppgift" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "divider large" }),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-default", onClick: function () {
                            isModified ? onUpdate(function (userTask) {
                                userTask.name = name;
                                userTask.description = description;
                                userTask.url = url;
                                userTask.deadline = deadline;
                            }) : _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.save", defaultMessage: "Spara" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalButton top" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn", onClick: function () {
                            _this.props.closeDialog();
                        } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "common.cancel", defaultMessage: "Avbryt" }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "confirm top pull-right" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { tabIndex: 1, className: "btn btn-warning", onClick: function () {
                            onDelete(id);
                        } }, isCustomTask ?
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeWorkGoals", defaultMessage: "Ta bort arbetsm\u00E5l" }) :
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_10__["FormattedMessage"], { id: "task.removeThisTask", defaultMessage: "Ta bort den h\u00E4r uppgiften" })))));
    };
    EditUserTask.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_11__["LanguageContext"];
    return EditUserTask;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/components/weekplanner/get-task-type.ts":
/*!*****************************************************!*\
  !*** ./src/components/weekplanner/get-task-type.ts ***!
  \*****************************************************/
/*! exports provided: getTaskType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTaskType", function() { return getTaskType; });
function getTaskType(userTask) {
    return userTask.course && userTask.task && userTask.course.length > 0 && userTask.task.length > 0 ?
        'courseBuilderTask' :
        userTask.siteVisionPageId ?
            'siteVisionTask' :
            userTask.courseInfo ?
                'subjectPlannerTask' :
                'customTask';
}


/***/ }),

/***/ "./src/components/weekplanner/index.ts":
/*!*********************************************!*\
  !*** ./src/components/weekplanner/index.ts ***!
  \*********************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _weekplanner__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./weekplanner */ "./src/components/weekplanner/weekplanner.tsx");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return _weekplanner__WEBPACK_IMPORTED_MODULE_0__["WeekPlanner"]; });




/***/ }),

/***/ "./src/components/weekplanner/refiner.ts":
/*!***********************************************!*\
  !*** ./src/components/weekplanner/refiner.ts ***!
  \***********************************************/
/*! exports provided: refine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "refine", function() { return refine; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");


function refine(tasks) {
    var e_1, _a, e_2, _b;
    var result = [];
    var mapper = {};
    var tasksPerCourse = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(tasks, function (t) { return t.courseName || ''; });
    try {
        for (var _c = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerCourse).sort().filter(function (x) { return x; }).concat(tasksPerCourse[''] ?
            [''] : [])), _d = _c.next(); !_d.done; _d = _c.next()) {
            var courseName = _d.value;
            var courseTasks = tasksPerCourse[courseName] || tasksPerCourse[''];
            var tasksPerLearningGoal = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["arrayToLookup"])(courseTasks, function (t) { return t.learningGoal; });
            var resultLearningGoals = [];
            try {
                for (var _e = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(tasksPerLearningGoal)), _f = _e.next(); !_f.done; _f = _e.next()) {
                    var learningGoal = _f.value;
                    var lgTasks = tasksPerLearningGoal[learningGoal].sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_1__["compareProp"])("dateTime"));
                    var learningGoalTask = lgTasks
                        .filter(function (t) { return t.name == null; }) // If name is undefined or null, this represents a learning goal
                    [0];
                    var url = learningGoalTask && learningGoalTask.url;
                    resultLearningGoals.push({
                        name: learningGoal,
                        allTasks: lgTasks,
                        url: url,
                        step: lgTasks.map(function (t) { return t.step; }).filter(function (step) { return step; })[0],
                        tasks: lgTasks.filter(function (t) { return t.name; })
                    });
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                }
                finally { if (e_2) throw e_2.error; }
            }
            result.push({
                courseName: courseName,
                learningGoals: resultLearningGoals
            });
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}


/***/ }),

/***/ "./src/components/weekplanner/user-tasks-box.tsx":
/*!*******************************************************!*\
  !*** ./src/components/weekplanner/user-tasks-box.tsx ***!
  \*******************************************************/
/*! exports provided: UserTasksBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksBox", function() { return UserTasksBox; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _access_control__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../access-control */ "./src/access-control/index.ts");
/* harmony import */ var _calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../calendar/course-name-to-css-class */ "./src/components/calendar/course-name-to-css-class.ts");
/* harmony import */ var _get_task_type__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./get-task-type */ "./src/components/weekplanner/get-task-type.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");











;
var UserTasksBox = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksBox, _super);
    function UserTasksBox(props) {
        return _super.call(this, props) || this;
    }
    UserTasksBox.prototype.render = function () {
        var _this = this;
        var _a = this.props, courseName = _a.courseName, learningGoals = _a.learningGoals, progressData = _a.progressData, displayProgress = _a.displayProgress;
        var isOpen = !!this.props.openCourses[courseName];
        var features = new _features__WEBPACK_IMPORTED_MODULE_7__["Features"]();
        var intl = this.context.intl;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_2__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null, courseName || react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: "userTasks.goals", defaultMessage: "Egna l\u00E4randem\u00E5l" })), headerOpen: isOpen, className: courseName && Object(_calendar_course_name_to_css_class__WEBPACK_IMPORTED_MODULE_4__["courseNameToCssClass"])('wp-course-', courseName), onOpenClose: function (becameOpen) { return _this.props.setIsOpen(courseName, becameOpen); }, displayProgress: displayProgress, progressData: progressData }, learningGoals.map(function (lg) {
            return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: lg.name, className: "learningGoalContainer" },
                lg.step && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "stepIndicator" }, lg.step),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalText horizontalItem top" }, lg.name),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                        "\u00A0",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "trash", href: "#", title: intl.formatMessage({ id: 'userTasks.deleteLearningGoal', defaultMessage: 'Ta bort lärandemålet och dess uppgifter' }), onClick: function (ev) {
                                ev.preventDefault();
                                _this.props.removeLearningGoal(lg);
                            } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-trash" })))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTasks" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "taskContainer" }, lg.tasks.map(function (userTask) {
                        var isWorking = userTask.$meta === 'adding' || userTask.$meta === 'deleting' || userTask.$meta === 'updating';
                        var taskType = Object(_get_task_type__WEBPACK_IMPORTED_MODULE_5__["getTaskType"])(userTask);
                        var expired = moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).startOf('day') < moment__WEBPACK_IMPORTED_MODULE_6___default()().startOf('day');
                        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: userTask.id, style: isWorking ? { opacity: 0.5 } : {} },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "align-horizontal" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (userTask.done ? " checked" : ""), onClick: function (ev) { return !isWorking && _this.props.setTaskDone(userTask, !userTask.done); } })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                    taskType === 'courseBuilderTask' ?
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getTaskUrl(userTask, _this.props.viewCourseUrl) }, userTask.name) :
                                        taskType === 'subjectPlannerTask' ?
                                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: getSubjectPlannerTaskUrl(userTask) }, userTask.name) :
                                            taskType === 'siteVisionTask' ?
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: userTask.url }, userTask.name) :
                                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: !userTask.url ? "link-less" : "", href: userTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                        "_self" :
                                                        "_blank" }, userTask.name),
                                    userTask.deadline && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "dateSet" + (expired ? ' expired' : '') },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { title: moment__WEBPACK_IMPORTED_MODULE_6___default()(userTask.deadline).format("YYYY-MM-DD"), className: "fa fa-calendar", "aria-hidden": "true", onClick: function () { } }))),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editTask(userTask); } }))),
                            userTask.subTasks && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "subtasks" }, userTask.subTasks.map(function (subTask) {
                                return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: subTask.id },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "checkBox" + (subTask.done ? " checked" : ""), onClick: function (ev) {
                                                return !isWorking &&
                                                    _this.props.setSubTaskDone(userTask, subTask, !subTask.done);
                                            } })),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { href: subTask.url || undefined, target: (userTask.url + '').toLowerCase().startsWith(location.host.toLowerCase()) ?
                                                "_self" :
                                                "_blank", className: subTask.url ?
                                                undefined :
                                                'link-less' }, subTask.name)),
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem top taskEdit" },
                                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "editItem", onClick: function () { return _this.props.editSubTask(userTask, subTask); } })));
                            })));
                    }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "learningGoalTools" },
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn addOwnGoal", onClick: function () { return _this.props.addOwnTask(_this.props.courseName, lg.name); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-plus", "aria-hidden": "true" }),
                        " ",
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_9__["FormattedMessage"], { id: 'userTasks.addLearningGoal', defaultMessage: 'Eget arbetsm\u00E5l' }))),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("br", null));
        }));
    };
    UserTasksBox.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_10__["LanguageContext"];
    return UserTasksBox;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));

function getTaskUrl(userTask, viewCourseUrl) {
    if (userTask.course && userTask.course.length > 0 && userTask.task && userTask.task.length > 0) {
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(viewCourseUrl, { courseId: userTask.course[0].id });
        return courseUrl + "#/task/" + userTask.task[0].id;
    }
    return userTask.url;
}
function getSubjectPlannerTaskUrl(userTask) {
    if (userTask.courseInfo && userTask.task && userTask.task.length > 0) {
        var _a = userTask.courseInfo, school = _a.school, course = _a.course, tab = _a.tab;
        var courseUrl = Object(_access_control__WEBPACK_IMPORTED_MODULE_3__["preserveImpersonationQuery"])(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_8__["default"].KED_SUBJECT_PLANNER_URL, {});
        return courseUrl + "#/" + school + "/courses/" + course + "/tabs/" + tab + "/tasks/" + userTask.task[0].id;
    }
    return userTask.url;
}


/***/ }),

/***/ "./src/components/weekplanner/weekplanner-persisted-state.ts":
/*!*******************************************************************!*\
  !*** ./src/components/weekplanner/weekplanner-persisted-state.ts ***!
  \*******************************************************************/
/*! exports provided: WeekPlannerPersistedState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlannerPersistedState", function() { return WeekPlannerPersistedState; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/moment-sv-locale */ "./src/globals/moment-sv-locale.ts");



var WeekPlannerPersistedState = /** @class */ (function () {
    function WeekPlannerPersistedState(userOrCopy) {
        if (typeof userOrCopy === 'string') {
            this.user = userOrCopy;
            this.lastWrite = Date.now();
            this.weekDate = Object(_globals_moment_sv_locale__WEBPACK_IMPORTED_MODULE_2__["localMoment"])().startOf('week').valueOf();
            this.openCourses = {};
        }
        else {
            Object.assign(this, userOrCopy);
        }
    }
    WeekPlannerPersistedState.load = function (user) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var cookie, storedData, state;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                cookie = localStorage.getItem('WeekPlannerPersistedState2');
                storedData = cookie && JSON.parse(cookie);
                state = new WeekPlannerPersistedState(user);
                if (storedData)
                    Object.assign(state, storedData);
                return [2 /*return*/, state.user === user && !state.isExpired(moment__WEBPACK_IMPORTED_MODULE_1___default()()) ?
                        state : new WeekPlannerPersistedState(user)];
            });
        });
    };
    WeekPlannerPersistedState.prototype.save = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var json;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                this.lastWrite = Date.now();
                json = JSON.stringify(this);
                localStorage.setItem('WeekPlannerPersistedState2', json);
                return [2 /*return*/];
            });
        });
    };
    WeekPlannerPersistedState.prototype.isExpired = function (asOf) {
        return moment__WEBPACK_IMPORTED_MODULE_1___default()(this.lastWrite)
            .isBefore(asOf.add(0 - WeekPlannerPersistedState.EXPIRATION_HOURS, 'hours'));
    };
    WeekPlannerPersistedState.EXPIRATION_HOURS = 12;
    WeekPlannerPersistedState.VERSION = 2;
    return WeekPlannerPersistedState;
}());



/***/ }),

/***/ "./src/components/weekplanner/weekplanner.tsx":
/*!****************************************************!*\
  !*** ./src/components/weekplanner/weekplanner.tsx ***!
  \****************************************************/
/*! exports provided: WeekPlanner */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "WeekPlanner", function() { return WeekPlanner; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _user_tasks_box__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./user-tasks-box */ "./src/components/weekplanner/user-tasks-box.tsx");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _refiner__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./refiner */ "./src/components/weekplanner/refiner.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utility-components/dialogs */ "./src/components/utility-components/dialogs.tsx");
/* harmony import */ var _add_custom_goal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./add-custom-goal */ "./src/components/weekplanner/add-custom-goal.tsx");
/* harmony import */ var _add_custom_task__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./add-custom-task */ "./src/components/weekplanner/add-custom-task.tsx");
/* harmony import */ var _edit_user_task__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./edit-user-task */ "./src/components/weekplanner/edit-user-task.tsx");
/* harmony import */ var _course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../utility-components/open-close-box */ "./src/components/utility-components/open-close-box.tsx");
/* harmony import */ var _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../utils/pending-job */ "./src/utils/pending-job.ts");
/* harmony import */ var _add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./add-or-edit-sub-task */ "./src/components/weekplanner/add-or-edit-sub-task.tsx");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../../utils/weekutil */ "./src/utils/weekutil.ts");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var _charts_progress__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../charts/progress */ "./src/components/charts/progress.tsx");
/* harmony import */ var _charts_charts_utils__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../charts/charts-utils */ "./src/components/charts/charts-utils.ts");
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../../features */ "./src/features/index.ts");





















var MAX_STRATEGY_LENGTH = 16384;
var MAX_ASSESSMENT_LENGTH = 16384;
var WeekPlanner = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](WeekPlanner, _super);
    function WeekPlanner(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            userTasks: [],
            weekDate: Date.now(),
            openCourses: {},
            dialogs: [],
            saving: false,
            weekTextsUT: null,
            isLoading: true,
            isCopyingTasks: false
        };
        _this.onChange = _this.onChange.bind(_this);
        _this.weekTextsSavingJob = new _utils_pending_job__WEBPACK_IMPORTED_MODULE_13__["PendingJob"](function () { return _this.saveWeekTexts(); });
        return _this;
    }
    WeekPlanner.prototype.componentDidMount = function () {
        this.props.env.userTasksRepo.subscribe(this.onChange);
    };
    WeekPlanner.prototype.componentWillUnmount = function () {
        this.props.env.userTasksRepo.unsubscribe(this.onChange);
        this.weekTextsSavingJob.stop();
    };
    WeekPlanner.prototype.onChange = function (userTasks, persisted, weekTextsUT) {
        var newState = {
            userTasks: userTasks,
            weekDate: persisted.weekDate,
            openCourses: persisted.openCourses,
            weekTextsUT: weekTextsUT,
            isLoading: false
        };
        if (!this.state.weekTextsUT || (weekTextsUT.dateTime !== this.state.weekTextsUT.dateTime)) {
            // Changing week. Reset to new week's values
            newState.strategy = weekTextsUT.weekTexts.strategy;
            newState.assessment = weekTextsUT.weekTexts.assessment;
        }
        this.setState(newState); // React's use of Pick instead of Partial makes things complex here.
    };
    WeekPlanner.prototype.isWeekTextsEdited = function () {
        var _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
        return !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy || assessment !== weekTextsUT.weekTexts.assessment);
    };
    WeekPlanner.prototype.saveWeekTexts = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, strategy, assessment, weekTextsUT;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        console.log("Saving texts...");
                        _a = this.state, strategy = _a.strategy, assessment = _a.assessment, weekTextsUT = _a.weekTextsUT;
                        if (!this.isWeekTextsEdited()) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.props.env.userTasksRepo.upsert(weekTextsUT, function (ut) {
                                ut.weekTexts = { strategy: strategy, assessment: assessment };
                            })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.prevWeek = function () {
        //this.saveWeekTexts();
        this.props.env.userTasksRepo.changeWeek(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).add(-1, 'week').toDate());
    };
    WeekPlanner.prototype.nextWeek = function () {
        //this.saveWeekTexts();
        this.props.env.userTasksRepo.changeWeek(moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).add(1, 'week').toDate());
    };
    WeekPlanner.prototype.openDialog = function (dialog) {
        this.setState({ dialogs: tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"](this.state.dialogs, [dialog]) });
    };
    WeekPlanner.prototype.openAddGoalDialog = function () {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_goal__WEBPACK_IMPORTED_MODULE_8__["AddCustomGoal"], { onSave: function (learningGoal) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!learningGoal)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.emptyLearningGoalErr', defaultMessage: 'Lärandemålet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomGoal(learningGoal)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.openAddOwnTaskDialog = function (courseName, learningGoalName) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_custom_task__WEBPACK_IMPORTED_MODULE_9__["AddCustomTask"], { isTask: !courseName, onSave: function (name, description, url) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            if (!name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameCannotBeEmpty', defaultMessage: 'Namnet kan inte vara tomt' }));
                            if (!!this.state.saving) return [3 /*break*/, 5];
                            this.setState({ saving: true });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, , 3, 4]);
                            return [4 /*yield*/, this.addCustomTask(courseName, learningGoalName, name, description, url)];
                        case 2:
                            _a.sent();
                            return [3 /*break*/, 4];
                        case 3:
                            this.setState({ saving: false });
                            return [7 /*endfinally*/];
                        case 4:
                            this.closeDialog();
                            _a.label = 5;
                        case 5: return [2 /*return*/];
                    }
                });
            }); } }));
    };
    WeekPlanner.prototype.editTask = function (userTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_edit_user_task__WEBPACK_IMPORTED_MODULE_10__["EditUserTask"], { userTasksRepo: this.props.env.userTasksRepo, userTask: userTask, onUpdate: function (updater) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var test;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            test = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, userTask);
                            updater(test);
                            if (!test.name)
                                throw new Error(this.context.intl.formatMessage({ id: 'weekplanner.nameMustNotBeEmpty', defaultMessage: 'Namnet får inte vara tomt' }));
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.update([userTask], updater)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, onDelete: function (id) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this.closeDialog();
                            return [4 /*yield*/, this.props.env.userTasksRepo.delete([id])];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); }, openDialog: function (dialog) { return _this.openDialog(dialog); }, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.editSubTask = function (userTask, subTask) {
        var _this = this;
        this.openDialog(react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_add_or_edit_sub_task__WEBPACK_IMPORTED_MODULE_14__["AddOrEditSubTask"], { userTasksRepo: this.props.env.userTasksRepo, mode: "edit", userTask: userTask, subTask: subTask, closeDialog: function () { return _this.closeDialog(); } }));
    };
    WeekPlanner.prototype.closeDialog = function () {
        this.setState({ dialogs: this.state.dialogs.slice(0, this.state.dialogs.length - 1) });
    };
    WeekPlanner.prototype.addCustomGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    learningGoal: learningGoal,
                                    dateTime: latestTimeStamp + 2000
                                }])];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.props.env.userTasksRepo.setWeekPlannerBoxOpen("", true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.removeLearningGoal = function (learningGoal) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (learningGoal.tasks.length > 0) {
                            if (!confirm(this.context.intl.formatMessage({ id: 'weekplanner.confirmRemoveLearningObjectives', defaultMessage: 'Ta bort lärandemål samt {learningGoalsNumber} uppgifter?' }, { learningGoalsNumber: learningGoal.tasks.length }))) {
                                return [2 /*return*/];
                            }
                        }
                        return [4 /*yield*/, this.props.env.userTasksRepo.delete(learningGoal.allTasks.map(function (t) { return t.id; }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.addCustomTask = function (courseName, learningGoal, name, description, url) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var latestTimeStamp;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        latestTimeStamp = Math.max.apply(Math.max, [this.state.weekDate].concat(this.state.userTasks.map(function (t) { return t.dateTime; })));
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])(),
                                    dateTime: latestTimeStamp + 2000,
                                    courseName: courseName,
                                    learningGoal: learningGoal,
                                    name: name,
                                    description: description,
                                    url: url
                                }])];
                    case 1:
                        /*const emptyLearningGoalPlaceholder = this.state.userTasks.find(ut =>
                          ut.name == null &&
                          !ut.courseName &&
                          ut.learningGoal === learningGoal);
                    
                        if (emptyLearningGoalPlaceholder) {
                          // Hijack learning-goal placeholder and make it the real task.
                          // This will make the learning goal disappear once this task
                          // is deleted.
                          await userTasksRepo.update([emptyLearningGoalPlaceholder], ut => {
                            Object.assign(ut, { name, description, url });
                          });
                        } else {*/
                        // Add another task to same learning-goal
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setIsOpen = function (courseName, isOpen) {
        this.props.env.userTasksRepo.setWeekPlannerBoxOpen(courseName, isOpen);
    };
    WeekPlanner.prototype.setTaskDone = function (task, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setTaskDoneState(task, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.setSubTaskDone = function (task, subTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.props.env.userTasksRepo.setSubTaskDoneState(task, subTask.id, done)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.copyFromPreviousWeek = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, userTasks_1, openCourses, weekDate, prevWeekNo, prevKEDWeek, prevTasks, latestTimeStamp_1, copies;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0: return [4 /*yield*/, this.setState({ isCopyingTasks: true })];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2:
                        _b.trys.push([2, , 5, 6]);
                        _a = this.state, userTasks_1 = _a.userTasks, openCourses = _a.openCourses, weekDate = _a.weekDate;
                        prevWeekNo = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["getAdjustedWeek"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(weekDate).add(-1, 'week'));
                        prevKEDWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_15__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_6___default()(weekDate).year(), prevWeekNo);
                        return [4 /*yield*/, this.props.env.kedBackendClient.list("usertasks", {
                                from: prevKEDWeek.notBefore,
                                to: prevKEDWeek.notAfter,
                                role: "USER",
                                include: ["task", "course", "acl"],
                                flags: ["includeIdsOnly"]
                            })];
                    case 3:
                        prevTasks = _b.sent();
                        prevTasks = prevTasks
                            .filter(function (prevTask) { return !prevTask.done; }) // Don't copy done tasks
                            .filter(function (prevTask) { return !!prevTask.name; }) // Don't copy empty learning goals
                            .filter(function (prevTask) { return !userTasks_1.some(function (taskOfCurrentWeek) {
                            return taskOfCurrentWeek.name === prevTask.name &&
                                taskOfCurrentWeek.learningGoal === prevTask.learningGoal &&
                                taskOfCurrentWeek.courseName === prevTask.courseName;
                        }); }); // Ignore identical tasks (already copied)
                        latestTimeStamp_1 = Math.max.apply(Math.max, [weekDate].concat(userTasks_1.map(function (t) { return t.dateTime; })));
                        copies = prevTasks.sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_5__["compareProp"])("dateTime")).map(function (task) {
                            var copy = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, task, { dateTime: latestTimeStamp_1 += 1000 });
                            copy.id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["createUUID"])();
                            if (copy.subTasks) {
                                copy.subTasks = copy.subTasks.filter(function (st) { return !st.done; });
                            }
                            delete copy.$etag;
                            return copy;
                        });
                        // Store it
                        return [4 /*yield*/, this.props.env.userTasksRepo.insert(copies)];
                    case 4:
                        // Store it
                        _b.sent();
                        return [3 /*break*/, 6];
                    case 5:
                        this.setState({ isCopyingTasks: false });
                        return [7 /*endfinally*/];
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    WeekPlanner.prototype.getHeaderTitle = function () {
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h4", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.logBook", defaultMessage: "Loggbok" }));
    };
    WeekPlanner.prototype.render = function () {
        var _this = this;
        var weekNumber = moment__WEBPACK_IMPORTED_MODULE_6___default()(this.state.weekDate).week();
        var showProgressCharts = _features__WEBPACK_IMPORTED_MODULE_20__["features"].weekplannerCharts;
        //console.log("Weekydate: "  + new Date(this.state.weekDate) + " which is week no " + weekNumber);
        var currentWeek = moment__WEBPACK_IMPORTED_MODULE_6___default()().week();
        var taskSets = Object(_refiner__WEBPACK_IMPORTED_MODULE_4__["refine"])(this.state.userTasks);
        var _a = this.state, dialogs = _a.dialogs, weekTextsUT = _a.weekTextsUT, strategy = _a.strategy, assessment = _a.assessment, isLoading = _a.isLoading, isCopyingTasks = _a.isCopyingTasks;
        var isSaving = weekTextsUT && (weekTextsUT.$meta === 'adding' || weekTextsUT.$meta === 'updating');
        var isStrategyEdited = !!weekTextsUT && (strategy !== weekTextsUT.weekTexts.strategy);
        var isAssessmentEdited = !!weekTextsUT && (assessment !== weekTextsUT.weekTexts.assessment);
        var enableSaveButton = !isSaving && (isStrategyEdited || isAssessmentEdited);
        var chartTasks = Object(_charts_charts_utils__WEBPACK_IMPORTED_MODULE_19__["getWeekplannerProgressData"])(taskSets);
        var percentage = taskSets.length > 0 ? chartTasks.completedTasks / chartTasks.totalNumberOfTasks * 100 : 0;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "ked_boxed weekPlanner" + (weekNumber === currentWeek ? " currentWeek" : ""), onKeyDown: function (ev) {
                    if (ev.which === 83 && ev.ctrlKey) {
                        ev.preventDefault();
                        if (!isSaving && _this.isWeekTextsEdited()) {
                            _this.weekTextsSavingJob.triggerChange(0);
                        }
                    }
                } },
                showProgressCharts && this.getHeaderTitle(),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "widgets" },
                    showProgressCharts ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "progressBar" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_charts_progress__WEBPACK_IMPORTED_MODULE_18__["Progress"], { percentage: percentage })) : this.getHeaderTitle(),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "weekSelect" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.weekNumber", values: { weekNumber: weekNumber }, defaultMessage: "Vecka {weekNumber}" }))),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "horizontalItem" },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn-group" },
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.prevWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-left", "aria-hidden": "true" })),
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("button", { className: "btn", onClick: function () { return _this.nextWeek(); } },
                                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-angle-right", "aria-hidden": "true" })))))),
                taskSets.length > 0 && react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                taskSets.map(function (props) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_user_tasks_box__WEBPACK_IMPORTED_MODULE_2__["UserTasksBox"], tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({ key: props.courseName }, props, { courseName: props.courseName, learningGoals: props.learningGoals, viewCourseUrl: _this.props.viewCourseUrl, openCourses: _this.state.openCourses, addOwnTask: function (courseName, learningGoalName) { return _this.openAddOwnTaskDialog(courseName, learningGoalName); }, setIsOpen: _this.setIsOpen.bind(_this), setTaskDone: _this.setTaskDone.bind(_this), setSubTaskDone: _this.setSubTaskDone.bind(_this), editTask: function (task) { return _this.editTask(task); }, editSubTask: function (task, subTask) { return _this.editSubTask(task, subTask); }, removeLearningGoal: function (lg) { return _this.removeLearningGoal(lg); }, displayProgress: showProgressCharts, progressData: chartTasks.subjectData[props.courseName] }));
                }),
                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                isLoading ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_11__["Spinner"], null) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", null,
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", onClick: function (ev) { return _this.openAddGoalDialog(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-list-alt", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.learningGoal", defaultMessage: "Eget l\u00E4randem\u00E5l" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", style: isCopyingTasks ? { opacity: 0.5 } : undefined, onClick: function (ev) { return (!isCopyingTasks) && _this.copyFromPreviousWeek(); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-clone", "aria-hidden": "true" }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.copyPreviousWeekTaks", defaultMessage: "Kopiera ej klara fr\u00E5n f\u00F6reg\u00E5ende vecka" })),
                    react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_open_close_box__WEBPACK_IMPORTED_MODULE_12__["OpenCloseBox"], { title: react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h5", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategyAndEvaluation", defaultMessage: "Strategi & Utv\u00E4rdering" })), headerOpen: this.state.openCourses["StratUtv"], onOpenClose: function (becameOpen) { return _this.setIsOpen("StratUtv", becameOpen); } },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategy", defaultMessage: "Strategi" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.strategyDescription", defaultMessage: "Hur jag ska g\u00F6ra f\u00F6r att l\u00E4ra mig." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", disabled: this.props.env.tutored, value: strategy && strategy.substr(0, MAX_STRATEGY_LENGTH), onChange: function (ev) {
                                _this.setState({ strategy: (ev.target.value || '').substr(0, MAX_STRATEGY_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("h3", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.evaluation", defaultMessage: "Utv\u00E4rdering" })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null,
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "weekplanner.evaluationDescription", defaultMessage: "Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utv\u00E4rdera i f\u00F6rh\u00E5llande till dina m\u00E5l." })),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("hr", null),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("textarea", { className: "weekplanner-textarea", value: assessment && assessment.substr(0, MAX_ASSESSMENT_LENGTH), disabled: this.props.env.tutored, onChange: function (ev) {
                                _this.setState({ assessment: (ev.target.value || '').substr(0, MAX_ASSESSMENT_LENGTH) });
                                _this.weekTextsSavingJob.triggerChange(500);
                            } }),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "btn", tabIndex: 0, style: enableSaveButton ? {} : { opacity: 0.5 }, onClick: function () { return !isSaving && _this.weekTextsSavingJob.triggerChange(0); } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("i", { className: "fa fa-floppy-o", "aria-hidden": "true" }),
                            enableSaveButton ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "common.save", defaultMessage: " Spara" }) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react_intl__WEBPACK_IMPORTED_MODULE_16__["FormattedMessage"], { id: "common.saved", defaultMessage: " Sparad" }))))),
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_utility_components_dialogs__WEBPACK_IMPORTED_MODULE_7__["Dialogs"], { dialogs: dialogs, popDialog: function () {
                    _this.setState(function (_a) {
                        var dialogs = _a.dialogs;
                        return ({ dialogs: dialogs.slice(0, dialogs.length - 1) });
                    });
                } }));
    };
    WeekPlanner.contextType = _utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_17__["LanguageContext"];
    return WeekPlanner;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/elements/KEDAppCourseViewer/app.courseviewer.client.tsx":
/*!*********************************************************************!*\
  !*** ./src/elements/KEDAppCourseViewer/app.courseviewer.client.tsx ***!
  \*********************************************************************/
/*! exports provided: KEDAppCourseViewer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDAppCourseViewer", function() { return KEDAppCourseViewer; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _global_setters_set_all__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../global-setters/set-all */ "./src/global-setters/set-all.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _components_course_viewer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../components/course-viewer */ "./src/components/course-viewer/index.tsx");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var _components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../components/course-builder/sub-components/spinner */ "./src/components/course-builder/sub-components/spinner.tsx");
/* harmony import */ var _components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../components/utility-components/LanguageContext */ "./src/components/utility-components/LanguageContext.tsx");
/* harmony import */ var react_intl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-intl */ "./node_modules/react-intl/lib/index.es.js");
/* harmony import */ var _components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../components/utility-components/SetupLanguageIntl */ "./src/components/utility-components/SetupLanguageIntl.tsx");




var bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer(); // Start getting bearer as soon as possible.



 // TODO: Move outside of course-builder!



var _KEDAppCourseViewer = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](_KEDAppCourseViewer, _super);
    function _KEDAppCourseViewer(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isTokenLoaded: false
        };
        return _this;
    }
    _KEDAppCourseViewer.prototype.componentWillMount = function () {
        var _this = this;
        bearerPromise.then(function () {
            _this.setState({ isTokenLoaded: true });
        }).catch(function (err) {
            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_6__["showError"])(err);
        });
    };
    _KEDAppCourseViewer.prototype.render = function () {
        var intl = this.props.intl;
        return this.state.isTokenLoaded ?
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_utility_components_LanguageContext__WEBPACK_IMPORTED_MODULE_8__["LanguageContext"].Provider, { value: { intl: intl } },
                react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_course_viewer__WEBPACK_IMPORTED_MODULE_5__["CourseViewer"], { courseBuilderUrl: _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_COURSE_BUILDER_URL })) :
            react__WEBPACK_IMPORTED_MODULE_4__["createElement"]("p", null,
                react__WEBPACK_IMPORTED_MODULE_4__["createElement"](_components_course_builder_sub_components_spinner__WEBPACK_IMPORTED_MODULE_7__["Spinner"], null),
                "V.g. v\u00E4nta... autenticerar...");
    };
    return _KEDAppCourseViewer;
}(react__WEBPACK_IMPORTED_MODULE_4__["Component"]));
var KEDAppCourseViewer = Object(_components_utility_components_SetupLanguageIntl__WEBPACK_IMPORTED_MODULE_10__["setupIntl"])(Object(react_intl__WEBPACK_IMPORTED_MODULE_9__["injectIntl"])(_KEDAppCourseViewer));


/***/ }),

/***/ "./src/elements/KEDAppCourseViewer/webpack-entry.ts":
/*!**********************************************************!*\
  !*** ./src/elements/KEDAppCourseViewer/webpack-entry.ts ***!
  \**********************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _globals_KED__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../globals/KED */ "./src/globals/KED.ts");
/* harmony import */ var _app_courseviewer_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app.courseviewer.client */ "./src/elements/KEDAppCourseViewer/app.courseviewer.client.tsx");



// Add KEDAppCourseViewer to the set of components in KED.components
_globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, _globals_KED__WEBPACK_IMPORTED_MODULE_1__["default"].components, { KEDAppCourseViewer: _app_courseviewer_client__WEBPACK_IMPORTED_MODULE_2__["KEDAppCourseViewer"] });


/***/ }),

/***/ "./src/features/feature-flags.json":
/*!*****************************************!*\
  !*** ./src/features/feature-flags.json ***!
  \*****************************************/
/*! exports provided: picker, ksTutorComment, kgTutorComment, termplannerCharts, weekplannerCharts, teacherRights, studyGroups, default */
/***/ (function(module) {

module.exports = {"picker":"Integrate coursebuilder and subjectplanner with Google Picker","ksTutorComment":"Integrate KSTermplanner with tutor comments","kgTutorComment":"Integrate KSTermplanner  with tutor comments","termplannerCharts":"Integrate KSTermplanner with progress charts","weekplannerCharts":"Integrate Weekplanner with progress charts","teacherRights":"Activate course builder teacher rights","studyGroups":"Add study groups functionality"};

/***/ }),

/***/ "./src/features/features.ts":
/*!**********************************!*\
  !*** ./src/features/features.ts ***!
  \**********************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return Features; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "features", function() { return features; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./feature-flags.json */ "./src/features/feature-flags.json");
var _feature_flags_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./feature-flags.json */ "./src/features/feature-flags.json", 1);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");




var Features = /** @class */ (function () {
    function Features() {
        var e_1, _a;
        this._initialized = false;
        var _loop_1 = function (featureName) {
            Object.defineProperty(this_1, featureName, {
                get: function () {
                    if (!this._initialized)
                        this.init();
                    return this._features[featureName];
                },
                set: function (value) {
                    throw new Error('Feature flags cannot be set here');
                }
            });
        };
        var this_1 = this;
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                _loop_1(featureName);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    Features.prototype.init = function () {
        var e_2, _a;
        if (this._initialized)
            return;
        var turnedOnFeatures = (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["cfg"].KED_FEATURES || "").split(',').map(function (name) { return name.trim().toLowerCase(); });
        var query = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(location.search, { toLower: true });
        if (query.testversion) {
            turnedOnFeatures = ["*"];
        }
        if (query.features) {
            turnedOnFeatures = query.features
                .split(',')
                .map(function (feature) { return feature.trim().toLowerCase(); });
        }
        var turnOnAll = turnedOnFeatures.includes('*');
        this._features = {};
        try {
            for (var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](Object.keys(_feature_flags_json__WEBPACK_IMPORTED_MODULE_2__)), _c = _b.next(); !_c.done; _c = _b.next()) {
                var featureName = _c.value;
                this._features[featureName] = turnOnAll ||
                    turnedOnFeatures.includes(featureName.toLowerCase());
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._initialized = true;
    };
    return Features;
}());

var features = new Features();


/***/ }),

/***/ "./src/features/index.ts":
/*!*******************************!*\
  !*** ./src/features/index.ts ***!
  \*******************************/
/*! exports provided: Features, features */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./features */ "./src/features/features.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["Features"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "features", function() { return _features__WEBPACK_IMPORTED_MODULE_0__["features"]; });




/***/ }),

/***/ "./src/global-setters/configure.ts":
/*!*****************************************!*\
  !*** ./src/global-setters/configure.ts ***!
  \*****************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");

_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].ENVIRONMENT = "test";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_API_URL = "https://backend.kedschools.com/kedbackend-next/api/"; // "https://kedbackendtest.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].EDS_API_URL = "https://edsportalowinapitest.azurewebsites.net/studentportal/"; // "https://edsportalowinapi.azurewebsites.net/api/"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_TOKEN_URL = ""; // "https://kedauthtest.azurewebsites.net/token"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_ID = ""; // "devclient", "testclient", "..."
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_CLIENT_SECRET = "";
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_REALM = "SE1"; // "SE1"
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_LOCALE || "sv"; // "sv", "en". Only set from process.env if not set from SiteVision element config.
_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE = _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_0__["default"].KED_SCHOOL_LOCALE || "sv"; // "sv", "en_sin", "en_nin". Only set from process.env if not set from SiteVision element config.


/***/ }),

/***/ "./src/global-setters/set-all.ts":
/*!***************************************!*\
  !*** ./src/global-setters/set-all.ts ***!
  \***************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _configure__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./configure */ "./src/global-setters/configure.ts");
/* harmony import */ var _set_bearer_providers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./set-bearer-providers */ "./src/global-setters/set-bearer-providers.ts");
/* harmony import */ var _set_ked_backend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./set-ked-backend-client */ "./src/global-setters/set-ked-backend-client.ts");
/* harmony import */ var _set_eds_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./set-eds-client */ "./src/global-setters/set-eds-client.ts");
/* These scripts assume some of the global vars have already been set:
  * KED.cfg
  * KED.env.currentUser

  The rest will be set here (client side)
*/






/***/ }),

/***/ "./src/global-setters/set-bearer-providers.ts":
/*!****************************************************!*\
  !*** ./src/global-setters/set-bearer-providers.ts ***!
  \****************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _utils_query_string__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/query-string */ "./src/utils/query-string.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _access_control_index__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../access-control/index */ "./src/access-control/index.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");








function getMergedTokenPath(tokenPath, locationSearch, scopes) {
    // Merge configured query params of token path with params given to current page
    var currentQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(locationSearch);
    var impersonationProps = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_7__["cherryPickProps"])(currentQuery, _access_control_index__WEBPACK_IMPORTED_MODULE_6__["IMPERSONATION_QUERY_PARAMS"]);
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["splitUrlAndQuery"])(tokenPath), 2), tokenPathWithoutQuery = _a[0], tokenQueryString = _a[1];
    var tokenPathQuery = Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["parseQueryString"])(tokenQueryString);
    return tokenPathWithoutQuery + Object(_utils_query_string__WEBPACK_IMPORTED_MODULE_1__["generateQueryString"])(tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, tokenPathQuery, impersonationProps, { scopes: scopes.join(',') }));
}
function getTokenId(mergedTokenPath, userEmail) {
    return mergedTokenPath + "/" + userEmail;
}
function saveUserInfo(user, tokenId) {
    _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = user;
    sessionStorage.setItem("userInfo" + tokenId, JSON.stringify(user));
}
function loadUserInfo(tokenId) {
    var storedSessionUser = sessionStorage.getItem("userInfo" + tokenId);
    if (storedSessionUser) {
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser = JSON.parse(storedSessionUser);
    }
}
function createBearerProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        if (res.user) {
            saveUserInfo(res.user, tokenId);
        }
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createGoogleTokenProvider(mergedTokenPath, userEmail) {
    var tokenId = getTokenId(mergedTokenPath, userEmail);
    return new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["WebServerBearerProvider"](mergedTokenPath, function (responseText) {
        var res = JSON.parse(responseText);
        if (!res.ok)
            throw new Error(res.error);
        return { token: res.token, expires: Date.now() + 59 * 60 * 1000 };
    }, tokenId);
}
function createTestTokenProvider(tokenUrl, user, scopes) {
    return new kedbackend_client__WEBPACK_IMPORTED_MODULE_3__["KedBearerProvider"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["storage"], tokenUrl + user.mail + location.search, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID, _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET, tokenUrl, {
        email: user.mail.toLowerCase(),
        roles: user.roles,
        school: user.school,
        schoolType: user.schoolType,
        scopes: scopes
    });
}
// env.currentUser.mail is set by SiteVision server initially.
// A response from /api/token may change the mail attribute of the current
// user, so env.currentUser.mail may be different after getting a response.
// However, the initial value is valuable always in order to distinguish the case
// when one normal user logs out and another user logs in.
var initialUserEmail = _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser && _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser.mail; // Initial value of mail. May change.
if (initialUserEmail) {
    // KED
    if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH) {
        //
        //
        // Production / SiteVision proxied /api/token to request tokens from:
        //
        //
        var mergedTokenPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createBearerProvider(mergedTokenPath, initialUserEmail);
        loadUserInfo(getTokenId(mergedTokenPath, initialUserEmail));
        // Google
        var googleMergedPath = getMergedTokenPath(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_PATH, location.search, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createGoogleTokenProvider(googleMergedPath, initialUserEmail);
    }
    else if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_ID && _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_CLIENT_SECRET) {
        //
        //
        // Test - go directly to KEDAUTH server to retrieve tokens
        //
        //
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].bearerProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "kedbackend",
            "EDS",
        ]);
        _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].googleTokenProvider = createTestTokenProvider(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_4__["default"].KED_TOKEN_URL + "/google", _globals_KED_env__WEBPACK_IMPORTED_MODULE_5__["default"].currentUser, [
            "https://www.googleapis.com/auth/calendar.readonly",
        ]);
    }
    else {
        throw new Error("Missing configuration parameter KED_TOKEN_PATH");
    }
}


/***/ }),

/***/ "./src/global-setters/set-eds-client.ts":
/*!**********************************************!*\
  !*** ./src/global-setters/set-eds-client.ts ***!
  \**********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");




_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].edsClient = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_3__["EdsClient"](kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["isomorphic"], _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].EDS_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail; });


/***/ }),

/***/ "./src/global-setters/set-ked-backend-client.ts":
/*!******************************************************!*\
  !*** ./src/global-setters/set-ked-backend-client.ts ***!
  \******************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");
/* harmony import */ var kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/clientweb */ "../kedbackend/clientweb.js");



_globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient = new kedbackend_clientweb__WEBPACK_IMPORTED_MODULE_2__["KedBackendClientWeb"](_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_API_URL, _globals_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].bearerProvider);


/***/ }),

/***/ "./src/globals/KED.cfg.ts":
/*!********************************!*\
  !*** ./src/globals/KED.cfg.ts ***!
  \********************************/
/*! exports provided: default, cfg */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cfg", function() { return cfg; });
/* harmony import */ var _KED__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED */ "./src/globals/KED.ts");

;
if (!_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg)
    _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg = {};
/* harmony default export */ __webpack_exports__["default"] = (_KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg);
var cfg = _KED__WEBPACK_IMPORTED_MODULE_0__["default"].cfg;


/***/ }),

/***/ "./src/globals/KED.env.ts":
/*!********************************!*\
  !*** ./src/globals/KED.env.ts ***!
  \********************************/
/*! exports provided: default, env */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "env", function() { return env; });
/* harmony import */ var _ked__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ked */ "./src/globals/ked.ts");

if (!_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env)
    _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env = {};
/* harmony default export */ __webpack_exports__["default"] = (_ked__WEBPACK_IMPORTED_MODULE_0__["default"].env);
var env = _ked__WEBPACK_IMPORTED_MODULE_0__["default"].env;


/***/ }),

/***/ "./src/globals/KED.ts":
/*!****************************!*\
  !*** ./src/globals/KED.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/db.ts":
/*!***************************!*\
  !*** ./src/globals/db.ts ***!
  \***************************/
/*! exports provided: db, globalId, Schools, CourseInstances */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "db", function() { return db; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "globalId", function() { return globalId; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Schools", function() { return Schools; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CourseInstances", function() { return CourseInstances; });
/* harmony import */ var _KED_env__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kedbackend/repo */ "../kedbackend/repo.js");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _KED_cfg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./KED.cfg */ "./src/globals/KED.cfg.ts");




var db = new kedbackend_repo__WEBPACK_IMPORTED_MODULE_1__["KedBackendRepo"](function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].kedBackendClient; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; }, function () { return _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser ?
    _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.displayName || _KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.mail :
    ""; });
var globalId = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["getGlobalId"])(_KED_cfg__WEBPACK_IMPORTED_MODULE_3__["default"].KED_REALM);
var Schools = {
    standardSchool: db.schools.name("standard").cacheOptimized().single(),
    get mySchool() { return db.schools.name(_KED_env__WEBPACK_IMPORTED_MODULE_0__["default"].currentUser.school).cacheOptimized().single(); }
};
var CourseInstances = {
    getBranchId: function (school, courseId) {
        return school.switchMap(function (school) {
            return db.branches
                .hasEdgesFrom([school.officialBranchId])
                .name("draft")
                .tags(courseId)
                .idsOnly()
                .map(function (_a) {
                var id = _a.id;
                return id;
            })
                .toValue()
                .map(function (ids) { return ids.length > 0 ? ids[0] : undefined; });
        });
    },
    /** Get a DRAFT branch for given course ID and given school.
     * If there is not yet such a branch, create it using mutationsOnEmpty() which will
     * lead to the C# code DocumentRepository.ReadOrMutate() via DocumentController.
     */
    getOrCreateBranchId: function (school, courseId) {
        return db.courseInstances.idsOnly().id(courseId).switchMap(function () {
            return school.switchMap(function (school) {
                return db.branches
                    .hasEdgesFrom([school.officialBranchId])
                    .name("draft")
                    .tags(courseId)
                    .idsOnly()
                    .mutationsOnEmpty(function (tx) {
                    // These 2 mutations will occur server side, atomically.
                    // Will be sent on each request in the query, but will only execute if query results in zero items.
                    //console.log("School:", school);
                    var id = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
                    tx.add("branches", {
                        id: id,
                        acl: [
                            "role:USER:R",
                            "schoolRole:" + school.name + "/EMPLOYEE:S"
                        ],
                        name: 'draft',
                        schoolId: school.id,
                        treeParentId: school.officialBranchId,
                        tags: [courseId]
                    });
                    // Approving the branch makes sure that it was created by an EMPLOYEE on given school.
                    tx.link2("branches", school.officialBranchId, "approvedChildren", id);
                })
                    .single()
                    .map(function (_a) {
                    var id = _a.id;
                    return id;
                });
            });
        });
    },
    getAllDescendantIds: function (courseId) {
        return db.courseBlocks.tags(courseId).idsOnly().concat(db.courseContents.tags(courseId).idsOnly()).concat(db.courseTabs.tags(courseId).idsOnly()).concat(db.tasks.tags(courseId).idsOnly())
            .map(function (x) { return x.id; });
    }
};


/***/ }),

/***/ "./src/globals/ked.ts":
/*!****************************!*\
  !*** ./src/globals/ked.ts ***!
  \****************************/
/*! exports provided: KED_NAMESPACE, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KED_NAMESPACE", function() { return KED_NAMESPACE; });
var KED_NAMESPACE = "KED";
var result = typeof KED === 'undefined' ? {} : KED;
if (typeof window !== 'undefined' && typeof KED === 'undefined') {
    window[KED_NAMESPACE] = result;
}
/* harmony default export */ __webpack_exports__["default"] = (result);


/***/ }),

/***/ "./src/globals/moment-sv-locale.ts":
/*!*****************************************!*\
  !*** ./src/globals/moment-sv-locale.ts ***!
  \*****************************************/
/*! exports provided: localMoment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "localMoment", function() { return localMoment; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../globals/KED.cfg */ "./src/globals/KED.cfg.ts");


if (_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE === "sv") {
    moment__WEBPACK_IMPORTED_MODULE_0___default.a.updateLocale('sv', {
        months: 'januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december'.split('_'),
        monthsShort: 'jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec'.split('_'),
        weekdays: 'söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag'.split('_'),
        weekdaysShort: 'sön_mån_tis_ons_tor_fre_lör'.split('_'),
        weekdaysMin: 'sö_må_ti_on_to_fr_lö'.split('_'),
        longDateFormat: {
            LT: 'HH:mm',
            LTS: 'HH:mm:ss',
            L: 'YYYY-MM-DD',
            LL: 'D MMMM YYYY',
            LLL: 'D MMMM YYYY [kl.] HH:mm',
            LLLL: 'dddd D MMMM YYYY [kl.] HH:mm',
            lll: 'D MMM YYYY HH:mm',
            llll: 'ddd D MMM YYYY HH:mm'
        },
        calendar: {
            sameDay: '[Idag] LT',
            nextDay: '[Imorgon] LT',
            lastDay: '[Igår] LT',
            nextWeek: '[På] dddd LT',
            lastWeek: '[I] dddd[s] LT',
            sameElse: 'L'
        },
        relativeTime: {
            future: 'om %s',
            past: 'för %s sedan',
            s: 'några sekunder',
            ss: '%d sekunder',
            m: 'en minut',
            mm: '%d minuter',
            h: 'en timme',
            hh: '%d timmar',
            d: 'en dag',
            dd: '%d dagar',
            M: 'en månad',
            MM: '%d månader',
            y: 'ett år',
            yy: '%d år'
        },
        dayOfMonthOrdinalParse: /\d{1,2}(e|a)/,
        ordinal: function (number) {
            var b = number % 10, output = (~~(number % 100 / 10) === 1) ? 'e' :
                (b === 1) ? 'a' :
                    (b === 2) ? 'a' :
                        (b === 3) ? 'e' : 'e';
            return number + output;
        },
        week: {
            dow: 1,
            doy: 4 // The week that contains Jan 4th is the first week of the year.
        }
    });
}
var localMoment = function () {
    return moment__WEBPACK_IMPORTED_MODULE_0___default.a.apply(this, arguments).locale(_globals_KED_cfg__WEBPACK_IMPORTED_MODULE_1__["default"].KED_LOCALE);
};


/***/ }),

/***/ "./src/repos/hidden-courses-repo.ts":
/*!******************************************!*\
  !*** ./src/repos/hidden-courses-repo.ts ***!
  \******************************************/
/*! exports provided: hiddenCoursesRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hiddenCoursesRepo", function() { return hiddenCoursesRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _utils_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/utils */ "./src/utils/utils.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../apis/edsclient */ "./src/apis/edsclient.ts");
/* harmony import */ var _utils_school_moment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/school-moment */ "./src/utils/school-moment.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__);








var hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo;
var HiddenCoursesRepo = /** @class */ (function () {
    function HiddenCoursesRepo() {
        var _this = this;
        this.result = null;
        this.subscribers = [];
        this.fullCourse = false;
        this.notifySubscriber = function (subscriber, options) {
            try {
                subscriber(options.fullCourse ? _this.result : _this.result.filter(function (c) { return c.visible; }));
            }
            catch (err) {
                console.error(err);
            }
        };
        this.kedRepo = new _ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]({
            getClient: function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; },
            optimistic: true,
            table: "userhiddencourses",
            user: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                return [2 /*return*/, ({ role: "USER" })];
            }); }); },
        });
        var initPromise = this.init();
        Promise.all([
            initPromise,
            this.kedCoursesPromise,
            this.edsCoursesPromise
        ]).catch(function (err) { return Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["showError"])(err); });
    }
    HiddenCoursesRepo.prototype.init = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var bearerPromise, resolveUserHiddenCoursesPromise, userHiddenCoursesResolved;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        bearerPromise = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider ? _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].bearerProvider.getBearer() : Promise.resolve({});
                        // In parallell, we request:
                        //  1) KEDBackend: Schools.activeCourses
                        //  2) EDS.getActiveAcourses()
                        //  3) (via subscription): KEDBackend: userHiddenCourses
                        this.kedCoursesPromise = bearerPromise.then(function () { return _this.listKedCourses(); });
                        this.edsCoursesPromise = bearerPromise.then(function () { return _this.listEDSCourses(); });
                        userHiddenCoursesResolved = false;
                        this.userHiddenCoursesPromise = new Promise(function (resolve) { return resolveUserHiddenCoursesPromise = function (x) {
                            if (userHiddenCoursesResolved) {
                                _this.userHiddenCoursesPromise = Promise.resolve(x);
                            }
                            else {
                                userHiddenCoursesResolved = true;
                                resolve(x);
                            }
                        }; });
                        return [4 /*yield*/, bearerPromise];
                    case 1:
                        _a.sent();
                        this.kedRepo.mem.subscribe(function (userHiddenCourses) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _a, activeCourses, edsActiveCourses, _b;
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                                switch (_c.label) {
                                    case 0: return [4 /*yield*/, Promise.all([
                                            this.kedCoursesPromise,
                                            this.edsCoursesPromise
                                        ])];
                                    case 1:
                                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 2]), activeCourses = _a[0], edsActiveCourses = _a[1];
                                        // Refine the three results into a single result
                                        _b = this;
                                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                                    case 2:
                                        // Refine the three results into a single result
                                        _b.result = _c.sent();
                                        // Notify our subscribers:
                                        this.subscribers.forEach(function (subscriber) { return _this.notifySubscriber(subscriber.subscriber, subscriber.options); });
                                        resolveUserHiddenCoursesPromise(userHiddenCourses);
                                        return [2 /*return*/];
                                }
                            });
                        }); });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listKedCourses = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var fullCourse, schools, activeCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        fullCourse = this.fullCourse;
                        console.log("FullCourse: " + fullCourse);
                        return [4 /*yield*/, _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient.list('schools', {
                                role: "USER",
                                name: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.school,
                                include: "activeCourses",
                                flags: fullCourse ? [] : ["includeIdsAndNamesOnly"],
                                cacheBust: _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.username
                            })];
                    case 1:
                        schools = _a.sent();
                        activeCourses = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["flatten"])(schools.map(function (school) { return school.activeCourses; })).sort(Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["compareProp"])("name"));
                        return [2 /*return*/, activeCourses];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.listEDSCourses = function () {
        var periodName = new _apis_edsclient__WEBPACK_IMPORTED_MODULE_5__["EDSPeriod"](Object(_utils_school_moment__WEBPACK_IMPORTED_MODULE_6__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_7___default()())).period;
        return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.indexOf('EMPLOYEE') === -1 ?
            // STUDENTs should, by default, only show courses that is listed in EDS
            _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].edsClient.getActiveCourses({ periodName: periodName }) :
            // EMPLOYEEs should, by default, show all courses on school - no need to query EDS
            null;
    };
    HiddenCoursesRepo.prototype.createCoursesList = function (edsActiveCourses, userHiddenCourses, activeCourses) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var hiddenCoursesMap, visibleCoursesMap, isStudent, edsCourseMap, result;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        hiddenCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return !hc.show; }), function (hc) { return hc.name; });
                        visibleCoursesMap = Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(userHiddenCourses.filter(function (hc) { return hc.show; }), function (hc) { return hc.name; });
                        isStudent = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser.roles.some(function (role) { return role === 'STUDENT'; });
                        edsCourseMap = edsActiveCourses ?
                            Object(_utils_utils__WEBPACK_IMPORTED_MODULE_3__["arrayToMap"])(edsActiveCourses, function (c) { return c.name; }) :
                            {};
                        return [4 /*yield*/, Promise.all(activeCourses.map(function (_a) {
                                var id = _a.id, name = _a.name, description = _a.description, modifiedBy = _a.modifiedBy;
                                return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                                    var edsCourse, defaultVisible, visible;
                                    return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                                        edsCourse = edsCourseMap[name];
                                        defaultVisible = isStudent ?
                                            edsCourse != null : // Course name also listed in EDS
                                            true;
                                        visible = defaultVisible ?
                                            !hiddenCoursesMap[id] : // Visible unless user has overridden that.
                                            !!visibleCoursesMap[id];
                                        // Resolve description:
                                        if (modifiedBy && modifiedBy.name && !description) {
                                            description = modifiedBy.name + "s version";
                                        }
                                        return [2 /*return*/, {
                                                id: id,
                                                name: name,
                                                description: description,
                                                visible: visible,
                                                defaultVisible: defaultVisible
                                            }];
                                    });
                                });
                            }))];
                    case 1:
                        result = _a.sent();
                        return [2 /*return*/, result.sort(function (_a, _b) {
                                var a = _a.name;
                                var b = _b.name;
                                return a < b ? -1 : a > b ? 1 : 0;
                            })];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.hideCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.insert([{
                                    id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                    name: c.id
                                }])];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.showCourse = function (c) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var overrides;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        overrides = this.kedRepo.mem.items.filter(function (hc) { return hc.name === c.id; });
                        if (!c.defaultVisible) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.kedRepo.delete(overrides.map(function (ov) { return ov.id; }))];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this.kedRepo.insert([{
                                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_4__["createUUID"])(),
                                name: c.id,
                                show: true
                            }])];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.subscribe = function (subscriber, options) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, activeCourses, edsActiveCourses, userHiddenCourses, _b;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        if (!(!this.fullCourse && options.fullCourse)) return [3 /*break*/, 3];
                        // The subscriber demands full courses
                        // Need to query that before notifying
                        // Also affect state for future internal notification
                        this.fullCourse = options.fullCourse;
                        this.kedCoursesPromise = this.listKedCourses(); // Redo this call, now loading full courses
                        return [4 /*yield*/, Promise.all([
                                this.kedCoursesPromise,
                                this.edsCoursesPromise,
                                this.userHiddenCoursesPromise
                            ])];
                    case 1:
                        _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"].apply(void 0, [_c.sent(), 3]), activeCourses = _a[0], edsActiveCourses = _a[1], userHiddenCourses = _a[2];
                        // Assemble result:
                        _b = this;
                        return [4 /*yield*/, this.createCoursesList(edsActiveCourses, userHiddenCourses, activeCourses)];
                    case 2:
                        // Assemble result:
                        _b.result = _c.sent();
                        _c.label = 3;
                    case 3: return [4 /*yield*/, this.userHiddenCoursesPromise];
                    case 4:
                        _c.sent(); // So we know that this.result is there.
                        this.notifySubscriber(subscriber, options);
                        this.subscribers.push({ subscriber: subscriber, options: options });
                        return [2 /*return*/];
                }
            });
        });
    };
    HiddenCoursesRepo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s.subscriber !== subscriber; });
    };
    return HiddenCoursesRepo;
}());
if (!hiddenCoursesRepo) {
    hiddenCoursesRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].hiddenCoursesRepo = new HiddenCoursesRepo();
}


/***/ }),

/***/ "./src/repos/ked-repo.ts":
/*!*******************************!*\
  !*** ./src/repos/ked-repo.ts ***!
  \*******************************/
/*! exports provided: KedRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KedRepo", function() { return KedRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./repo */ "./src/repos/repo.ts");
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");



var KedRepo = /** @class */ (function () {
    function KedRepo(options) {
        var _this = this;
        var table = options.table, getClient = options.getClient, getQueryOptions = options.getQueryOptions;
        this.mem = new _repo__WEBPACK_IMPORTED_MODULE_1__["Repo"]({ query: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var queryOptions;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, getQueryOptions()];
                        case 1:
                            queryOptions = _a.sent();
                            return [4 /*yield*/, getClient().list(table, tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, queryOptions, { cacheBust: this.getCacheBust() }))];
                        case 2: return [2 /*return*/, _a.sent()];
                    }
                });
            }); } });
        this.options = options;
    }
    KedRepo.prototype.getCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = localStorage.getItem('cache-bust-' + table + '-' + user);
        return cacheBust || this.regenerateCacheBust();
    };
    KedRepo.prototype.regenerateCacheBust = function () {
        var _a = this.options, table = _a.table, user = _a.user;
        var cacheBust = Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])();
        localStorage.setItem('cache-bust-' + table + '-' + user, cacheBust);
        return cacheBust;
    };
    KedRepo.prototype.upsert = function (item, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItem;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!!item.$etag) return [3 /*break*/, 2];
                        updatedItem = Object.assign({}, item);
                        updater(updatedItem);
                        return [4 /*yield*/, this.insert([updatedItem])];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2: 
                    // We have an $etag, so we can expect it to live on the server.
                    // However, take care of the unlikely situation that it was deleted from server,
                    // and if so, insert it again.
                    return [4 /*yield*/, this.update([item], updater).catch(function (e) {
                            if (e.name === "http404") {
                                var updatedItem = Object.assign({}, item);
                                updater(updatedItem);
                                return _this.insert([updatedItem]);
                            }
                            return Promise.reject(e);
                        })];
                    case 3:
                        // We have an $etag, so we can expect it to live on the server.
                        // However, take care of the unlikely situation that it was deleted from server,
                        // and if so, insert it again.
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.update = function (items, updater) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItems, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItems = items.map(function (item) {
                            var memRepoItem = _this.mem.items.find(function (it) { return it.id === item.id; });
                            item = Object.assign({}, memRepoItem || item);
                            updater(item);
                            return item;
                        });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(modifiedItems.map(function (x) { return Object.assign({}, x, { $meta: 'updating' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); })
                            .catch(function (e) { return e.name === "http409" ? // conflict
                            // Get a fresh version from server:
                            client.list(table, { ids: items.map(function (item) { return item.id; }) }, { cache: 'no-cache' }).then(function (freshItems) {
                                // Update local version:
                                var modifiedItems = freshItems.map(function (freshItem) {
                                    // Clone the fresh item
                                    var modified = Object.assign({}, freshItem);
                                    // Re-run the updater on the clone:
                                    updater(modified);
                                    return modified;
                                });
                                // Re-do the the put operation towards the server.
                                return client.do(function (br) { return modifiedItems.forEach(function (item) { return br.put(table, item); }); });
                            }) :
                            // Other unexpected error:
                            Promise.resolve(optimistic &&
                                _this.mem.update(items)) // Undo optimistic update
                                .then(function () {
                                return Promise.reject(e); // Reject with the error no matter.
                            }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        modifiedItems.forEach(function (item) {
                            item.$etag = res.newEtags[item.id];
                            item.$meta = undefined;
                        });
                        return [4 /*yield*/, this.mem.update(modifiedItems)];
                    case 4:
                        _b.sent(); // Ensures new etag is is applied on next action.
                        return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.stripGraphs = function (items, graphs) {
        return items.map(function (item) {
            var clone = Object.assign({}, item);
            graphs.forEach(function (graph) {
                if (item[graph]) {
                    clone[graph] = item[graph].map(function (doc) { return ({ id: doc.id }); });
                }
            });
            return clone;
        });
    };
    KedRepo.prototype.insert = function (items) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var e_1, _a, _b, getClient, optimistic, table, getQueryOptions, client, queryOptions, graphs, stripped, br, _loop_1, stripped_1, stripped_1_1, item, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_c) {
                switch (_c.label) {
                    case 0:
                        _b = this.options, getClient = _b.getClient, optimistic = _b.optimistic, table = _b.table, getQueryOptions = _b.getQueryOptions;
                        client = getClient();
                        return [4 /*yield*/, getQueryOptions()];
                    case 1:
                        queryOptions = _c.sent();
                        graphs = [].concat(queryOptions.include);
                        // Give IDs to each item:
                        items = items.map(function (item) { return item.id ? item : Object.assign({}, item, { id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["createUUID"])() }); });
                        stripped = this.stripGraphs(items, graphs);
                        if (!optimistic) return [3 /*break*/, 3];
                        return [4 /*yield*/, this.mem.insert(stripped.map(function (x) { return Object.assign({}, x, { $meta: 'adding' }); }))];
                    case 2:
                        _c.sent();
                        _c.label = 3;
                    case 3:
                        br = new kedbackend_client__WEBPACK_IMPORTED_MODULE_2__["BatchRunner"]();
                        _loop_1 = function (item) {
                            var e_2, _a;
                            var _loop_2 = function (graph) {
                                var foreignItems = item[graph];
                                if (foreignItems) {
                                    foreignItems.forEach(function (doc) {
                                        br.link2(table, item.id, graph, doc.id);
                                    });
                                }
                            };
                            try {
                                // Also add links to all foreign related items:
                                for (var graphs_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](graphs), graphs_1_1 = graphs_1.next(); !graphs_1_1.done; graphs_1_1 = graphs_1.next()) {
                                    var graph = graphs_1_1.value;
                                    _loop_2(graph);
                                }
                            }
                            catch (e_2_1) { e_2 = { error: e_2_1 }; }
                            finally {
                                try {
                                    if (graphs_1_1 && !graphs_1_1.done && (_a = graphs_1.return)) _a.call(graphs_1);
                                }
                                finally { if (e_2) throw e_2.error; }
                            }
                            br.add(table, item);
                        };
                        try {
                            for (stripped_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](stripped), stripped_1_1 = stripped_1.next(); !stripped_1_1.done; stripped_1_1 = stripped_1.next()) {
                                item = stripped_1_1.value;
                                _loop_1(item);
                            }
                        }
                        catch (e_1_1) { e_1 = { error: e_1_1 }; }
                        finally {
                            try {
                                if (stripped_1_1 && !stripped_1_1.done && (_a = stripped_1.return)) _a.call(stripped_1);
                            }
                            finally { if (e_1) throw e_1.error; }
                        }
                        return [4 /*yield*/, client.batch(br.mutationRequests).catch(function (e) {
                                if (optimistic)
                                    _this.mem.delete(items.map(function (item) { return item.id; }));
                                return Promise.reject(e);
                            })];
                    case 4:
                        res = _c.sent();
                        this.regenerateCacheBust();
                        items.forEach(function (item) { return item.$etag = res.newEtags[item.id]; });
                        if (!optimistic) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.mem.update(items)];
                    case 5:
                        _c.sent(); // Update with new $etag.
                        return [3 /*break*/, 8];
                    case 6: return [4 /*yield*/, this.mem.insert(items)];
                    case 7:
                        _c.sent();
                        _c.label = 8;
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    KedRepo.prototype.delete = function (ids) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, res;
            var _this = this;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(ids
                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                .filter(function (x) { return x; })
                                .map(function (x) { return Object.assign({}, x, { $meta: 'deleting' }); }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.do(function (br) { return ids.forEach(function (id) { return br.delete(table, id); }); }).catch(function (e) { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                            var _this = this;
                            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        if (!optimistic) return [3 /*break*/, 2];
                                        return [4 /*yield*/, this.mem.update(ids
                                                .map(function (id) { return _this.mem.items.find(function (x) { return x.id === id; }); })
                                                .filter(function (x) { return x; })
                                                .map(function (x) {
                                                x = Object.assign({}, x);
                                                delete x.$meta;
                                                return x;
                                            }))];
                                    case 1:
                                        _a.sent();
                                        _a.label = 2;
                                    case 2: throw e;
                                }
                            });
                        }); })];
                    case 3:
                        res = _b.sent();
                        this.regenerateCacheBust();
                        return [4 /*yield*/, this.mem.delete(ids)];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return KedRepo;
}());



/***/ }),

/***/ "./src/repos/repo.ts":
/*!***************************!*\
  !*** ./src/repos/repo.ts ***!
  \***************************/
/*! exports provided: Repo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Repo", function() { return Repo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var Repo = /** @class */ (function () {
    function Repo(comm) {
        this.comm = comm;
        this.listPromise = null;
        this.items = null;
        this.subscribers = [];
    }
    Repo.prototype.subscribe = function (subscriber) {
        var _this = this;
        return this.ensureHasData().then(function () {
            subscriber(_this.items, _this.error);
            _this.subscribers.push(subscriber);
        });
    };
    Repo.prototype.unsubscribe = function (subscriber) {
        this.subscribers = this.subscribers.filter(function (s) { return s !== subscriber; });
    };
    Repo.prototype.notifySubscribers = function () {
        var _this = this;
        this.subscribers.forEach(function (s) { return s(_this.items, _this.error); });
    };
    Repo.prototype.ensureHasData = function () {
        if (!this.listPromise)
            this.refreshFromServer();
        return this.listPromise;
    };
    Repo.prototype.refreshFromServer = function () {
        var _this = this;
        this.listPromise = this.comm.query().then(function (items) {
            _this.items = items;
            _this.error = null;
            _this.notifySubscribers();
        }).catch(function (error) {
            _this.error = error;
            _this.items = _this.items || [];
            _this.notifySubscribers();
        });
        return this.listPromise;
    };
    Repo.prototype.update = function (item) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var updatedItems;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.ensureHasData()];
                    case 1:
                        _a.sent();
                        updatedItems = Array.isArray(item) ? item : [item];
                        this.items = this.items.map(function (it) {
                            var updatedItem = updatedItems.find(function (_a) {
                                var id = _a.id;
                                return it.id === id;
                            });
                            return updatedItem ?
                                Object.assign({}, updatedItem) :
                                it;
                        });
                        this.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    Repo.prototype.insert = function (item) {
        var _this = this;
        return this.ensureHasData().then(function () {
            _this.items = _this.items.concat(item);
            _this.notifySubscribers();
        });
    };
    Repo.prototype.delete = function (id) {
        var _this = this;
        var ids = Array.isArray(id) ? id : [id];
        return this.ensureHasData().then(function () {
            _this.items = _this.items.filter(function (it) { return !ids.some(function (id) { return it.id === id; }); });
            _this.notifySubscribers();
        });
    };
    return Repo;
}());



/***/ }),

/***/ "./src/repos/user-tasks-repo.ts":
/*!**************************************!*\
  !*** ./src/repos/user-tasks-repo.ts ***!
  \**************************************/
/*! exports provided: userTasksRepo, UserTasksRepo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "userTasksRepo", function() { return userTasksRepo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserTasksRepo", function() { return UserTasksRepo; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _ked_repo__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ked-repo */ "./src/repos/ked-repo.ts");
/* harmony import */ var _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/KED.env */ "./src/globals/KED.env.ts");
/* harmony import */ var _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/weekplanner/weekplanner-persisted-state */ "./src/components/weekplanner/weekplanner-persisted-state.ts");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var kedbackend_client__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kedbackend/client */ "../kedbackend/client.js");
/* harmony import */ var _utils_weekutil__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../utils/weekutil */ "./src/utils/weekutil.ts");







var userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo;
var UserTasksRepo = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](UserTasksRepo, _super);
    function UserTasksRepo(getClient, getCurrentUser) {
        var _this = _super.call(this, {
            getClient: getClient,
            optimistic: true,
            table: "usertasks",
            user: getCurrentUser() ? getCurrentUser().mail : "",
            getQueryOptions: function () { return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](_this, void 0, void 0, function () {
                var currentUser, userEmail, _a, weekDate, weekNumber, kedWeek;
                return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                    switch (_b.label) {
                        case 0:
                            currentUser = getCurrentUser();
                            userEmail = currentUser ? currentUser.mail : "";
                            if (!!this.persistedState) return [3 /*break*/, 2];
                            _a = this;
                            return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(userEmail)];
                        case 1:
                            _a.persistedState = _b.sent();
                            _b.label = 2;
                        case 2:
                            weekDate = this.persistedState.weekDate;
                            weekNumber = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).week();
                            kedWeek = Object(_utils_weekutil__WEBPACK_IMPORTED_MODULE_6__["KEDWeek"])(moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).year(), weekNumber);
                            /*const [from, to] = [moment(weekDate).startOf('week'), moment(weekDate).endOf('week')]
                              .map(m => m.toDate().getTime());*/
                            return [2 /*return*/, {
                                    from: kedWeek.notBefore,
                                    to: kedWeek.notAfter,
                                    role: "USER",
                                    include: ["task", "course"],
                                    flags: ["includeIdsOnly"],
                                }];
                    }
                });
            }); }
        }) || this;
        _this.persistedState = null;
        _this.getCurrentUser = getCurrentUser;
        return _this;
    }
    UserTasksRepo.prototype.updatePersistedState = function (stateChanges) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        Object.assign(this.persistedState, stateChanges);
                        return [4 /*yield*/, this.persistedState.save()];
                    case 1:
                        _a.sent();
                        this.mem.notifySubscribers();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setTaskDoneState = function (userTask, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client, modifiedItem, similarTasks, identicalTasks;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        modifiedItem = Object.assign({}, userTask, { done: done });
                        if (!optimistic) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.mem.update(Object.assign({}, modifiedItem, { $meta: 'updating' }))];
                    case 1:
                        _b.sent();
                        _b.label = 2;
                    case 2: return [4 /*yield*/, client.list('usertasks', {
                            name: userTask.name,
                            role: "USER",
                            include: ["task", "course"],
                            flags: ["includeIdsOnly"],
                            from: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(-3, 'weeks').valueOf(),
                            to: moment__WEBPACK_IMPORTED_MODULE_4___default()(this.persistedState.weekDate).add(3, 'weeks').valueOf()
                        }, {
                            cache: 'no-cache'
                        })];
                    case 3:
                        similarTasks = _b.sent();
                        identicalTasks = similarTasks.filter(function (t) {
                            return t.courseName === userTask.courseName &&
                                t.learningGoal === userTask.learningGoal &&
                                (!userTask.task || t.task.map(function (t) { return t.id; }).join('') === userTask.task.map(function (t) { return t.id; }).join('')) &&
                                (!userTask.course || t.course.map(function (c) { return c.id; }).join('') === userTask.course.map(function (c) { return c.id; }).join(''));
                        });
                        if (identicalTasks.length === 0) {
                            // Workaround for issue in SubjectPlanner migration (usertasks with long names is not found)
                            identicalTasks.push(userTask);
                        }
                        return [4 /*yield*/, this.update(identicalTasks, function (t) { return t.done = done; })];
                    case 4:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setSubTaskDoneState = function (userTask, subTaskId, done) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var _a, getClient, optimistic, table, client;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.options, getClient = _a.getClient, optimistic = _a.optimistic, table = _a.table;
                        client = getClient();
                        return [4 /*yield*/, this.update([userTask], function (t) { return t.subTasks && t.subTasks.filter(function (st) { return st.id === subTaskId; })
                                .forEach(function (st) { return st.done = done; }); })];
                    case 1:
                        _b.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.setWeekPlannerBoxOpen = function (courseName, isOpen) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var openCourses;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        openCourses = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, this.persistedState.openCourses);
                        if (isOpen)
                            openCourses[courseName] = true;
                        else
                            delete openCourses[courseName];
                        return [4 /*yield*/, this.updatePersistedState({ openCourses: openCourses })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.changeWeek = function (weekDate) {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            var persistedState, newPersisted;
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        persistedState = this.persistedState;
                        if (!!persistedState) return [3 /*break*/, 2];
                        return [4 /*yield*/, _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"].load(this.options.user)];
                    case 1:
                        persistedState = _a.sent();
                        _a.label = 2;
                    case 2:
                        newPersisted = new _components_weekplanner_weekplanner_persisted_state__WEBPACK_IMPORTED_MODULE_3__["WeekPlannerPersistedState"](persistedState);
                        newPersisted.weekDate = moment__WEBPACK_IMPORTED_MODULE_4___default()(weekDate).startOf('week').valueOf();
                        newPersisted.save();
                        this.persistedState = newPersisted;
                        return [4 /*yield*/, this.mem.refreshFromServer()];
                    case 3:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    UserTasksRepo.prototype.subscribe = function (subscriber) {
        var _this = this;
        var proxySubscriber = function (userTasks) {
            subscriber(userTasks.filter(function (ut) { return !ut.weekTexts; }), _this.persistedState, userTasks.filter(function (ut) { return !!ut.weekTexts; })[0] || {
                id: Object(kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["createUUID"])(),
                dateTime: _this.persistedState.weekDate,
                weekTexts: { assessment: '', strategy: '' },
                acl: [
                    // Default ACL: Let user self have full control over this item:
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("email", _this.getCurrentUser().mail, "S"),
                    // Additional ACL: Let employees on same school have read access to it.
                    // This currently only applies to tasks that refer to course tasks (not own tasks!)
                    new kedbackend_client__WEBPACK_IMPORTED_MODULE_5__["DocumentAccess"]("schoolRole", _this.getCurrentUser().school + "/EMPLOYEE", "R")
                ].map(function (ac) { return ac.toString(); })
            });
        };
        proxySubscriber["subscriber"] = subscriber;
        this.mem.subscribe(proxySubscriber);
    };
    UserTasksRepo.prototype.unsubscribe = function (subscriber) {
        this.mem.subscribers = this.mem.subscribers.filter(function (s) { return s["subscriber"] !== subscriber; });
    };
    return UserTasksRepo;
}(_ked_repo__WEBPACK_IMPORTED_MODULE_1__["KedRepo"]));

if (!userTasksRepo) {
    userTasksRepo = _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].userTasksRepo = new UserTasksRepo(function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].kedBackendClient; }, function () { return _globals_KED_env__WEBPACK_IMPORTED_MODULE_2__["default"].currentUser; });
    userTasksRepo.mem.ensureHasData();
}


/***/ }),

/***/ "./src/translations/en.json":
/*!**********************************!*\
  !*** ./src/translations/en.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, addeditsubtask.addSubtask, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.ict, termplanner.loadingTermplanner, termplanner.maths, termplanner.modernLanguage, termplanner.noFinalStepAvailable, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, termplanner.yoga, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.deleteSubtask":"Delete subtask","addeditsubtask.editSubtask":"Edit subtask","addeditsubtask.nameLabel":"Name of subtask","addeditsubtask.addSubtask":"Add sub-task","calendar.currentDate":"Week {week}, {year}","calendar.fullDayEventLocation":"Place: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"W{weekNumber}","common.addDescriptionPlhd":"Add description...","common.cancel":"Cancel","common.changesNotSavedErrorOccured":"An error occured while saving data. Your changes were not saved.","common.changesNotSavedUnauthorized":"The changes were not saved due to insufficient authority","common.descriptionLabel":"Description","common.errorSavingData":"An error occured while saving data.","common.linkLabel":"Link","common.loading":"Loading...","common.nameLabel":"Name","common.save":" Save","common.saved":" Saved","common.saving":"Saving","common.remove":"Delete","customTask.addWorkGoalTitle":"Add own working goal","customTask.enterNamePlhd":"Enter Name...","task.addSubtask":"Add subtask","task.editTask":"Edit task","task.editWorkGoals":"Edit working goal","task.enterTaskNamePlhd":"Enter the name of task...","task.removeDeadline":"Delete deadline","task.removeThisTask":"Delete this task","task.removeWorkGoals":"Delete working goal","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Set deadline...","task.subTasks":"Subtasks","task.targetNameLabel":"Name of working goal","task.taskNameLabel":"Name of task","task.whatShouldYouDoPlhd":"What should you do?","termplanner.comments":"Comments","termplanner.course":"Theme course","termplanner.edsGoalGrades":"Intermediate goals","termplanner.englishLanguage":"Eng","termplanner.finalStep":"Final Step","termplanner.firstTerm":"FT {year}","termplanner.hindiLanguage":"Hindi","termplanner.ict":"ICT","termplanner.loadingTermplanner":"Loading Termplanner","termplanner.maths":"Maths","termplanner.modernLanguage":"MFL","termplanner.noFinalStepAvailable":"No final step available","termplanner.secondTerm":"ST {year}","termplanner.termPlanning":"Term planner","termplanner.weekNumber":"Week","termplanner.yoga":"Yoga","tutorNoteDialog.weekComment":"Note for week {weekNumber}","test.chooseComponentLabel":"Component","test.pageDescription":"Test page for the components on the starting page","userTasks.addLearningGoal":"Own working goal","userTasks.deleteLearningGoal":"Delete learning goal and its tasks","userTasks.goals":"Own learning goal","weekNotebook.title":"Notepad","weekplanner.addLearningGoal":"Goal:","weekplanner.addLearningGoalTitle":"Add own learning goal","weekplanner.confirmRemoveLearningObjectives":"Delete learning goal and {learningGoalsNumber} tasks?","weekplanner.copyPreviousWeekTaks":"Copy from previous week","weekplanner.emptyLearningGoalErr":"The learning goal cannot be empty","weekplanner.evaluation":"Evaluation","weekplanner.evaluationDescription":"Reflection on your work effort and your chosen strategies during the week. Evaluate in relation to your goals.","weekplanner.learningGoal":"Own learning goal","weekplanner.logBook":"Logbook","weekplanner.nameCannotBeEmpty":"Name cannot be empty","weekplanner.nameMustNotBeEmpty":"Name must not be empty","weekplanner.strategy":"Strategy","weekplanner.strategyAndEvaluation":"Strategy & Evaluation","weekplanner.strategyDescription":"What I should do to learn","weekplanner.weekNumber":"Week {weekNumber}","wysiwyg.bold":"Bold","wysiwyg.code":"Code","wysiwyg.heading1":"Heading 1","wysiwyg.heading2":"Heading 2","wysiwyg.heading3":"Heading 3","wysiwyg.image":"Insert image","wysiwyg.imagePromptMsg":"Enter the URL of the image","wysiwyg.italic":"Italics","wysiwyg.line":"Horizontal line","wysiwyg.link":"Insert link","wysiwyg.olist":"Ordered list","wysiwyg.paragraph":"Paragraph","wysiwyg.quote":"Quote","wysiwyg.strikethrough":"Strikethrough","wysiwyg.ulist":"Bullet list","wysiwyg.underline":"Underline"};

/***/ }),

/***/ "./src/translations/sv.json":
/*!**********************************!*\
  !*** ./src/translations/sv.json ***!
  \**********************************/
/*! exports provided: addeditsubtask.addSubtask, addeditsubtask.deleteSubtask, addeditsubtask.editSubtask, addeditsubtask.nameLabel, calendar.currentDate, calendar.fullDayEventLocation, calendar.loadCalendarEvents, calendar.loadingCalendar, calendar.weekNumber, common.addDescriptionPlhd, common.cancel, common.changesNotSavedErrorOccured, common.changesNotSavedUnauthorized, common.descriptionLabel, common.errorSavingData, common.linkLabel, common.loading, common.nameLabel, common.save, common.saved, common.saving, common.remove, customTask.addWorkGoalTitle, customTask.enterNamePlhd, task.addSubtask, task.editTask, task.editWorkGoals, task.enterTaskNamePlhd, task.removeDeadline, task.removeThisTask, task.removeWorkGoals, task.setDeadline, task.setDeadlineLabel, task.subTasks, task.targetNameLabel, task.taskNameLabel, task.whatShouldYouDoPlhd, termplanner.comments, termplanner.course, termplanner.edsGoalGrades, termplanner.englishLanguage, termplanner.swedishLanguage, termplanner.finalStep, termplanner.firstTerm, termplanner.hindiLanguage, termplanner.loadingTermplanner, termplanner.modernLanguageFullname, termplanner.mathsFullname, termplanner.noFinalStepAvailable, termplanner.swedishLanguageFullName, termplanner.englishLanguageFullName, termplanner.maths, termplanner.modernLanguage, termplanner.secondTerm, termplanner.termPlanning, termplanner.weekNumber, tutorNoteDialog.weekComment, test.chooseComponentLabel, test.pageDescription, userTasks.addLearningGoal, userTasks.deleteLearningGoal, userTasks.goals, weekNotebook.title, weekplanner.addLearningGoal, weekplanner.addLearningGoalTitle, weekplanner.confirmRemoveLearningObjectives, weekplanner.copyPreviousWeekTaks, weekplanner.emptyLearningGoalErr, weekplanner.evaluation, weekplanner.evaluationDescription, weekplanner.learningGoal, weekplanner.logBook, weekplanner.nameCannotBeEmpty, weekplanner.nameMustNotBeEmpty, weekplanner.strategy, weekplanner.strategyAndEvaluation, weekplanner.strategyDescription, weekplanner.weekNumber, wysiwyg.bold, wysiwyg.code, wysiwyg.heading1, wysiwyg.heading2, wysiwyg.heading3, wysiwyg.image, wysiwyg.imagePromptMsg, wysiwyg.italic, wysiwyg.line, wysiwyg.link, wysiwyg.olist, wysiwyg.paragraph, wysiwyg.quote, wysiwyg.strikethrough, wysiwyg.ulist, wysiwyg.underline, default */
/***/ (function(module) {

module.exports = {"addeditsubtask.addSubtask":"Lägg till underuppgift","addeditsubtask.deleteSubtask":"Ta bort underuppgift","addeditsubtask.editSubtask":"Redigera underuppgift","addeditsubtask.nameLabel":"Underuppgiftens namn","calendar.currentDate":"Vecka {week}, {year}","calendar.fullDayEventLocation":"Plats: {location}","calendar.loadCalendarEvents":"Load calendar events...","calendar.loadingCalendar":"Loading calendars... (listing...)","calendar.weekNumber":"V{weekNumber}","common.addDescriptionPlhd":"Lägg till en beskrivning...","common.cancel":"Avbryt","common.changesNotSavedErrorOccured":"För tillfället problem att spara data. Dina ändringar sparades inte.","common.changesNotSavedUnauthorized":"Ändringarna sparades inte p.g.a. otillräcklig behörighet.","common.descriptionLabel":"Beskrivning","common.errorSavingData":"Kunde inte spara.","common.linkLabel":"Länk","common.loading":"Laddar...","common.nameLabel":"Namn","common.save":" Spara","common.saved":" Sparad","common.saving":"Sparar...","common.remove":"Ta bort","customTask.addWorkGoalTitle":"Lägg till eget arbetsmål","customTask.enterNamePlhd":"Ange namn...","task.addSubtask":"Lägg till underuppgift","task.editTask":"Redigera uppgift","task.editWorkGoals":"Redigera arbetsmål","task.enterTaskNamePlhd":"Ange uppgiftens namn...","task.removeDeadline":"Ta bort deadline","task.removeThisTask":"Ta bort den här uppgiften","task.removeWorkGoals":"Ta bort arbetsmål","task.setDeadline":"Set deadline","task.setDeadlineLabel":"Ange deadline...","task.subTasks":"Underuppgifter","task.targetNameLabel":"Arbetsmålets namn","task.taskNameLabel":"Uppgiftens namn","task.whatShouldYouDoPlhd":"Vad ska du göra?","termplanner.comments":"Kommentar","termplanner.course":"Kurs","termplanner.edsGoalGrades":"Terminsmål","termplanner.englishLanguage":"Eng","termplanner.swedishLanguage":"Sv/SvA","termplanner.finalStep":"Slutsteg","termplanner.firstTerm":"VT {year}","termplanner.hindiLanguage":"","termplanner.loadingTermplanner":"V.g. vänta medan terminsplaner laddas...","termplanner.modernLanguageFullname":"M.språk","termplanner.mathsFullname":"Matematik","termplanner.noFinalStepAvailable":"Inget slutsteg tillgängligt","termplanner.swedishLanguageFullName":"Svenska","termplanner.englishLanguageFullName":"Engelska","termplanner.maths":"Ma","termplanner.modernLanguage":"M.spr","termplanner.secondTerm":"HT {year}","termplanner.termPlanning":"Terminsplanering","termplanner.weekNumber":"Vecka","tutorNoteDialog.weekComment":"Kommentar för vecka {weekNumber}","test.chooseComponentLabel":"Komponent","test.pageDescription":"Testsida för komponenter till nya startsidan","userTasks.addLearningGoal":"Eget arbetsmål","userTasks.deleteLearningGoal":"Ta bort lärandemålet och dess uppgifter","userTasks.goals":"Egna lärandemål","weekNotebook.title":"Anteckningar","weekplanner.addLearningGoal":"Mål:","weekplanner.addLearningGoalTitle":"Lägg till eget lärandemål","weekplanner.confirmRemoveLearningObjectives":"Ta bort lärandemål samt {learningGoalsNumber} uppgifter?","weekplanner.copyPreviousWeekTaks":"Kopiera ej klara från föregående vecka","weekplanner.emptyLearningGoalErr":"Lärandemålet kan inte vara tomt","weekplanner.evaluation":"Utvärdering","weekplanner.evaluationDescription":"Reflektion kring din arbetsinsats och dina valda strategier under veckan.Utvärdera i förhållande till dina mål.","weekplanner.learningGoal":"Eget lärandemål","weekplanner.logBook":"Loggbok","weekplanner.nameCannotBeEmpty":"Namnet kan inte vara tomt","weekplanner.nameMustNotBeEmpty":"Namnet får inte vara tomt","weekplanner.strategy":"Strategi","weekplanner.strategyAndEvaluation":"Strategi & Utvärdering","weekplanner.strategyDescription":"Hur jag ska göra för att lära mig.","weekplanner.weekNumber":"Vecka {weekNumber}","wysiwyg.bold":"Fetstil","wysiwyg.code":"Programkod","wysiwyg.heading1":"Rubrik 1","wysiwyg.heading2":"Rubrik 2","wysiwyg.heading3":"Rubrik 3","wysiwyg.image":"Infoga bild","wysiwyg.imagePromptMsg":"Ange bildens URL","wysiwyg.italic":"Kursiv","wysiwyg.line":"Vågrät linje","wysiwyg.link":"Infoga länk","wysiwyg.olist":"Ordnad lista","wysiwyg.paragraph":"Paragraf","wysiwyg.quote":"Citat","wysiwyg.strikethrough":"Struken","wysiwyg.ulist":"Punktlista","wysiwyg.underline":"Understruken"};

/***/ }),

/***/ "./src/utils/error-success-feedback.tsx":
/*!**********************************************!*\
  !*** ./src/utils/error-success-feedback.tsx ***!
  \**********************************************/
/*! exports provided: ErrorSuccessFeedback */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ErrorSuccessFeedback", function() { return ErrorSuccessFeedback; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _globals_db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../globals/db */ "./src/globals/db.ts");
/* harmony import */ var _components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/course-builder/sub-components/remove-item */ "./src/components/course-builder/sub-components/remove-item.tsx");




var ErrorSuccessFeedback = /** @class */ (function (_super) {
    tslib__WEBPACK_IMPORTED_MODULE_0__["__extends"](ErrorSuccessFeedback, _super);
    function ErrorSuccessFeedback(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            errors: [],
            infos: []
        };
        _this._unhandledRejection = _this._unhandledRejection.bind(_this);
        _this._error = _this._error.bind(_this);
        _this._customError = _this._customError.bind(_this);
        _this._onInfo = _this._onInfo.bind(_this);
        _this._dbWriterError = _this._dbWriterError.bind(_this);
        _this._dbWriterStateChanged = _this._dbWriterStateChanged.bind(_this);
        return _this;
    }
    ErrorSuccessFeedback.prototype._addError = function (message, details, retryable) {
        var _this = this;
        //console.error(message, {retryable: !!retryable, details});
        this.setState(function (_a) {
            var errors = _a.errors;
            if (errors.some(function (e) { return e.message === message; }))
                return { errors: errors };
            if (errors.length > 2)
                errors = errors.slice(1);
            return {
                errors: errors.concat([{ message: message, details: details, retryable: retryable }])
            };
        });
        // Remove non-retryable errors after 30 seconds:
        if (!retryable)
            setTimeout(function () {
                _this.setState(function (_a) {
                    var errors = _a.errors;
                    return ({
                        errors: errors.filter(function (e) { return e.message !== message; })
                    });
                });
            }, 30000);
    };
    ErrorSuccessFeedback.prototype._addInfo = function (message) {
        var _this = this;
        if (message === "") {
            // Turn off current info messages
            this.setState({ infos: [] });
            return;
        }
        this.setState(function (_a) {
            var infos = _a.infos;
            if (infos.some(function (info) { return info === message; }))
                return { infos: infos };
            if (infos.length > 1)
                infos = infos.slice(1);
            return {
                infos: [message] // was: infos.concat(message). But it sucks!
            };
        });
        // Remove info message after 10 seconds:
        setTimeout(function () {
            _this.setState(function (_a) {
                var infos = _a.infos;
                return ({
                    infos: infos.filter(function (msg) { return msg !== message; })
                });
            });
        }, 10000);
    };
    ErrorSuccessFeedback.prototype._dbWriterError = function (error, retryable) {
        this._addError("Det g\u00E5r inte att spara till servern", error, retryable);
    };
    ErrorSuccessFeedback.prototype._dbWriterStateChanged = function (_a) {
        var isEdited = _a.isEdited, isSaving = _a.isSaving;
        if (!isEdited) {
            // If isEdited is false, a successful write must have happened, and
            // there cannot be any retryable error anymore
            this.setState(function (_a) {
                var errors = _a.errors;
                errors = errors.filter(function (e) { return !e.retryable; });
                return { errors: errors };
            });
        }
        this.setState({
            dbWriterIsEdited: isEdited,
            dbWriterIsSaving: isSaving
        });
    };
    ErrorSuccessFeedback.prototype.componentDidMount = function () {
        window.addEventListener('unhandledrejection', this._unhandledRejection);
        window.addEventListener('error', this._error);
        window.addEventListener('customerror', this._customError);
        window.addEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onError(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.onStateChange(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype.componentWillUnmount = function () {
        window.removeEventListener('unhandledrejection', this._unhandledRejection);
        window.removeEventListener('error', this._error);
        window.removeEventListener('customerror', this._customError);
        window.removeEventListener('info', this._onInfo);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterError);
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.off(this._dbWriterStateChanged);
    };
    ErrorSuccessFeedback.prototype._unhandledRejection = function (ev) {
        this._addError("Ett ok\u00E4nt fel intr\u00E4ffade...", ev.reason);
    };
    ErrorSuccessFeedback.prototype._error = function (ev) {
        this._addError(ev.error ? ev.error.message : "Ett ok\u00E4nt fel intr\u00E4ffade...", ev.error);
    };
    ErrorSuccessFeedback.prototype._customError = function (ev) {
        this._addError(ev.detail);
    };
    ErrorSuccessFeedback.prototype._onInfo = function (ev) {
        this._addInfo(ev.detail);
    };
    ErrorSuccessFeedback.prototype.render = function () {
        var _this = this;
        var _a = this.state, errors = _a.errors, infos = _a.infos, dbWriterIsSaving = _a.dbWriterIsSaving;
        return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { className: "error-success-feedback", style: {
                position: "fixed",
                left: 0,
                top: 0,
                width: "100%",
                pointerEvents: 'none'
            } },
            react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { display: 'table', margin: "0 auto" } },
                errors.filter(function (e) { return !e.retryable || !dbWriterIsSaving; })
                    .map(function (_a) {
                    var message = _a.message, details = _a.details, retryable = _a.retryable, showDetails = _a.showDetails;
                    return (react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { key: message, className: "error" },
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { float: 'left' } }, message),
                        react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            react__WEBPACK_IMPORTED_MODULE_1__["createElement"](_components_course_builder_sub_components_remove_item__WEBPACK_IMPORTED_MODULE_3__["RemoveItem"], { onClick: function () { return _this.removeError(message); } })),
                        details || retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("div", { style: { pointerEvents: 'auto' } },
                            details ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null,
                                react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.toggleDetails(message); } }, showDetails ? "Dölj detailer" : "Visa detailjer"),
                                "\u00A0") : undefined,
                            showDetails ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", null, '' + details) : react__WEBPACK_IMPORTED_MODULE_1__["createElement"](react__WEBPACK_IMPORTED_MODULE_1__["Fragment"], null, "\u00A0"),
                            retryable ? react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("a", { className: "btn", onClick: function () { return _this.retrySave(); } }, "F\u00F6rs\u00F6k spara nu") : undefined) : undefined));
                }),
                infos.map(function (message) {
                    return react__WEBPACK_IMPORTED_MODULE_1__["createElement"]("p", { key: message, className: "info" }, message);
                })));
    };
    ErrorSuccessFeedback.prototype.removeError = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({
                errors: errors.filter(function (e) { return e.message !== message; })
            });
        });
    };
    ErrorSuccessFeedback.prototype.retrySave = function () {
        _globals_db__WEBPACK_IMPORTED_MODULE_2__["db"].writer.retrySave();
    };
    ErrorSuccessFeedback.prototype.toggleDetails = function (message) {
        this.setState(function (_a) {
            var errors = _a.errors;
            return ({ errors: errors.map(function (error) { return error.message === message ? tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, error, { showDetails: !error.showDetails }) :
                    error; })
            });
        });
    };
    return ErrorSuccessFeedback;
}(react__WEBPACK_IMPORTED_MODULE_1__["Component"]));



/***/ }),

/***/ "./src/utils/make-suspense-api.ts":
/*!****************************************!*\
  !*** ./src/utils/make-suspense-api.ts ***!
  \****************************************/
/*! exports provided: makeSuspenseApi */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "makeSuspenseApi", function() { return makeSuspenseApi; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var DEFAULT_CACHE_EXPIRATION = 30 * 60 * 1000; // 30 minutes.
var defaultOptions = {
    isApiMethod: function (f) { return typeof f === 'function'; },
    cacheExpiration: DEFAULT_CACHE_EXPIRATION
};
function makeSuspenseApi(api, options) {
    if (options === void 0) { options = defaultOptions; }
    options = tslib__WEBPACK_IMPORTED_MODULE_0__["__assign"]({}, defaultOptions, options);
    var isApiMethod = options.isApiMethod, cacheExpiration = options.cacheExpiration;
    var rv = Object.create(api);
    var cache = {};
    // Walk the instance + prototype chain to generate suspense version of each promise returning method
    for (var proto = api; proto && proto !== Object.prototype; proto = Object.getPrototypeOf(proto)) {
        suspendify(proto);
    }
    function suspendify(proto) {
        Object.keys(proto).forEach(function (prop) {
            if (!rv.hasOwnProperty(prop) && isApiMethod(prop)) {
                rv[prop] = function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    var key = JSON.stringify(tslib__WEBPACK_IMPORTED_MODULE_0__["__spread"]([prop], args));
                    var cachedEntry = cache[key];
                    if (cachedEntry !== undefined) {
                        if (cachedEntry.promise)
                            throw cachedEntry.promise;
                        if (cachedEntry.error)
                            throw cachedEntry.error;
                        if (cachedEntry.timeout > Date.now()) {
                            return cachedEntry.value;
                        }
                    }
                    try {
                        var promise = proto[prop].apply(api, args).then(function (result) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, value: result };
                        }).catch(function (error) {
                            cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                        });
                        cache[key] = { timeout: Date.now() + cacheExpiration, promise: promise };
                        throw promise;
                    }
                    catch (error) {
                        if (error.then)
                            throw error;
                        cache[key] = { timeout: Date.now() + cacheExpiration, error: error };
                    }
                };
            }
        });
    }
    return rv;
}


/***/ }),

/***/ "./src/utils/pending-job.ts":
/*!**********************************!*\
  !*** ./src/utils/pending-job.ts ***!
  \**********************************/
/*! exports provided: PendingJob */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PendingJob", function() { return PendingJob; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

var PendingJob = /** @class */ (function () {
    function PendingJob(callback) {
        this.timeoutId = null;
        this.cancelled = false;
        this.pending = false;
        this.isJobExecuting = false;
        this.jobCallback = callback;
    }
    PendingJob.prototype.triggerChange = function (throttle) {
        var _this = this;
        if (this.cancelled)
            return;
        this.pending = true;
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = setTimeout(function () { return _this.launchJob(); }, throttle);
    };
    PendingJob.prototype.stop = function () {
        if (this.timeoutId !== null)
            clearTimeout(this.timeoutId);
        this.timeoutId = null;
        this.cancelled = true;
    };
    PendingJob.prototype.launchJob = function () {
        return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this, void 0, void 0, function () {
            return tslib__WEBPACK_IMPORTED_MODULE_0__["__generator"](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.cancelled)
                            return [2 /*return*/];
                        if (!this.pending)
                            return [2 /*return*/];
                        if (this.isJobExecuting)
                            return [2 /*return*/];
                        this.timeoutId = null;
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, , 3, 4]);
                        this.isJobExecuting = true;
                        this.pending = false;
                        return [4 /*yield*/, this.jobCallback()];
                    case 2:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 3:
                        this.isJobExecuting = false;
                        return [7 /*endfinally*/];
                    case 4:
                        if (!this.pending) return [3 /*break*/, 6];
                        return [4 /*yield*/, this.launchJob()];
                    case 5:
                        _a.sent();
                        _a.label = 6;
                    case 6: return [2 /*return*/];
                }
            });
        });
    };
    return PendingJob;
}());



/***/ }),

/***/ "./src/utils/query-string.ts":
/*!***********************************!*\
  !*** ./src/utils/query-string.ts ***!
  \***********************************/
/*! exports provided: parseQueryString, generateQueryString, parseHashQueryString, generateHashQueryString, splitUrlAndQuery */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseQueryString", function() { return parseQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateQueryString", function() { return generateQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parseHashQueryString", function() { return parseHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "generateHashQueryString", function() { return generateHashQueryString; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "splitUrlAndQuery", function() { return splitUrlAndQuery; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function parseQueryString(locationSearch, options) {
    var toLower = (options || {}).toLower;
    var result = {};
    if (locationSearch && locationSearch.length > 1)
        locationSearch.substr(1)
            .split('&')
            .map(function (part) { return part.split('=').map(function (s) { return decodeURIComponent(s.trim()); }); })
            .forEach(function (_a) {
            var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a, 2), key = _b[0], value = _b[1];
            return result[toLower ? key.toLowerCase() : key] = value;
        });
    return result;
}
function encodeParams(params) {
    return Object.keys(params).filter(function (key) { return params[key] !== undefined; }).map(function (key) { return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]); }).join('&');
}
function generateQueryString(params) {
    return "?" + encodeParams(params);
}
function parseHashQueryString(locationHash, options) {
    return parseQueryString(locationHash, options);
}
function generateHashQueryString(params) {
    return "#" + encodeParams(params);
}
function splitUrlAndQuery(urlWithPossibleQuery) {
    var pQuery = urlWithPossibleQuery.indexOf('?');
    return pQuery >= 0 ?
        [urlWithPossibleQuery.substr(0, pQuery), urlWithPossibleQuery.substr(pQuery)] :
        [urlWithPossibleQuery, ""];
}


/***/ }),

/***/ "./src/utils/school-moment.ts":
/*!************************************!*\
  !*** ./src/utils/school-moment.ts ***!
  \************************************/
/*! exports provided: getFirstAndLastWeekOfTerm, getTermStartAndEnd, getSchoolMoment, addYear, nextAcademicYear, prevAcademicYear */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFirstAndLastWeekOfTerm", function() { return getFirstAndLastWeekOfTerm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getTermStartAndEnd", function() { return getTermStartAndEnd; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSchoolMoment", function() { return getSchoolMoment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "addYear", function() { return addYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nextAcademicYear", function() { return nextAcademicYear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "prevAcademicYear", function() { return prevAcademicYear; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);


function getFirstAndLastWeekOfTerm(term) {
    return term === 'AT' ?
        [32, 51] :
        [1, 25];
}
function getTermStartAndEnd(now) {
    return now.month() >= 6 ? // 6 = July in JS Dates and in moment as well!
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 7, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 11, 31))] : // aug1 - dec31
        [moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 0, 1)), moment__WEBPACK_IMPORTED_MODULE_1___default()(new Date(now.year(), 6, 31))]; // jan1 - july31
}
function getSchoolMoment(m) {
    var thisYear = m.year();
    var isAutumn = m.month() >= 6; // determine 
    var _a = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](isAutumn ?
        [thisYear, thisYear + 1] :
        [thisYear - 1, thisYear], 2), autumnYear = _a[0], springYear = _a[1];
    var academicYear = '' + autumnYear + '/' + springYear;
    var term = isAutumn ? 'AT' : 'ST';
    var week = m.week();
    return { academicYear: academicYear, term: term, week: week };
}
function addYear(aYear, numYearsToAdd) {
    return aYear.split('/')
        .map(function (yearStr) { return parseInt(yearStr) + numYearsToAdd; })
        .map(function (year) { return '' + year; })
        .join('/');
}
function nextAcademicYear(aYear) {
    return addYear(aYear, 1);
}
function prevAcademicYear(aYear) {
    return addYear(aYear, -1);
}


/***/ }),

/***/ "./src/utils/school-term.ts":
/*!**********************************!*\
  !*** ./src/utils/school-term.ts ***!
  \**********************************/
/*! exports provided: SchoolTerm */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SchoolTerm", function() { return SchoolTerm; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _school_moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./school-moment */ "./src/utils/school-moment.ts");


function isSchoolMoment(obj) {
    return 'academicYear' in obj;
}
var SchoolTerm = /** @class */ (function () {
    function SchoolTerm(dateOrSchoolMoment) {
        var schoolMoment = isSchoolMoment(dateOrSchoolMoment) ?
            dateOrSchoolMoment : Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["getSchoolMoment"])(moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrSchoolMoment));
        this.academicYear = schoolMoment.academicYear;
        this.term = schoolMoment.term;
    }
    Object.defineProperty(SchoolTerm.prototype, "year", {
        get: function () {
            return parseInt(this.academicYear
                .split('/')[this.term === 'AT' ? 0 : 1]);
        },
        enumerable: true,
        configurable: true
    });
    SchoolTerm.prototype.nextTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: this.academicYear
            } :
            {
                term: 'AT',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, 1)
            });
    };
    SchoolTerm.prototype.prevTerm = function () {
        return new SchoolTerm(this.term === 'AT' ?
            {
                term: 'ST',
                academicYear: Object(_school_moment__WEBPACK_IMPORTED_MODULE_1__["addYear"])(this.academicYear, -1)
            } :
            {
                term: 'AT',
                academicYear: this.academicYear
            });
    };
    SchoolTerm.prototype.toLocaleString = function (intl, shortYear) {
        var year = this.term === 'AT' ?
            this.academicYear.split('/')[0] :
            this.academicYear.split('/')[1];
        if (shortYear)
            year = year.substr(2);
        return this.term === 'AT' ? intl.formatMessage({ id: 'termplanner.secondTerm', defaultMessage: 'HT {year}' }, { year: year }) :
            intl.formatMessage({ id: 'termplanner.firstTerm', defaultMessage: 'VT {year}' }, { year: year });
    };
    return SchoolTerm;
}());



/***/ }),

/***/ "./src/utils/utils.ts":
/*!****************************!*\
  !*** ./src/utils/utils.ts ***!
  \****************************/
/*! exports provided: capitalizeFirst, extend, clone, flatten, compareProp, compareProps, L, TC, dateTimeReviver, showInfo, showError, maxLength, arrayToLookup, arrayToMap, cherryPickProps, distinct, shallowEquals */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "capitalizeFirst", function() { return capitalizeFirst; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "extend", function() { return extend; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clone", function() { return clone; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "flatten", function() { return flatten; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProp", function() { return compareProp; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "compareProps", function() { return compareProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "L", function() { return L; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TC", function() { return TC; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "dateTimeReviver", function() { return dateTimeReviver; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showInfo", function() { return showInfo; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "showError", function() { return showError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "maxLength", function() { return maxLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToLookup", function() { return arrayToLookup; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "arrayToMap", function() { return arrayToMap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "cherryPickProps", function() { return cherryPickProps; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shallowEquals", function() { return shallowEquals; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");

function capitalizeFirst(str) {
    for (var i = 0, l = str.length; i < l; ++i) {
        if (str.charCodeAt(i) < 0x2000) {
            return str.substr(0, i) + str[i].toLocaleUpperCase() + str.substr(i + 1);
        }
    }
    return str;
}
function extend(obj, extension) {
    if (typeof extension !== 'object')
        return obj;
    Object.keys(extension).forEach(function (key) {
        obj[key] = extension[key];
    });
    return obj;
}
function clone(obj, extension) {
    var clone = {};
    Object.getOwnPropertyNames(obj).forEach(function (key) {
        Object.defineProperty(clone, key, Object.getOwnPropertyDescriptor(obj, key));
    });
    if (extension)
        extend(clone, extension);
    return clone;
}
var concat = [].concat;
function flatten(a) {
    return concat.apply([], a);
}
function compareProp(prop) {
    return function (a, b) {
        var aProp = a[prop], bProp = b[prop];
        return aProp > bProp ? 1 : aProp < bProp ? -1 : 0;
    };
}
function compareProps(props, locales, options) {
    props = Array.isArray(props) ? props : [props];
    var localeCompare = function (a, b) {
        return typeof a === 'string' ?
            a.localeCompare(b, locales, options) :
            a < b ? -1 : a > b ? 1 : 0;
    };
    function cmpPart(a, b, firstPart, rest) {
        var firstA = a[firstPart];
        if (firstA == null)
            return -1;
        var firstB = b[firstPart];
        if (firstB == null)
            return 1;
        return rest.length === 0 ?
            localeCompare(firstA, firstB) :
            cmpPart(firstA, firstB, rest[0], rest.slice(1));
    }
    return props
        .map(function (prop) { return prop.split('.'); })
        .map(function (_a) {
        var _b = tslib__WEBPACK_IMPORTED_MODULE_0__["__read"](_a), firstPart = _b[0], rest = _b.slice(1);
        return function (a, b) { return cmpPart(a, b, firstPart, rest); };
    })
        .reduce(function (cmp1, cmp2) {
        return function (a, b) { return cmp1(a, b) || cmp2(a, b); };
    });
}
function L(text) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        args[_i - 1] = arguments[_i];
    }
    var first = text[0];
    return buildMessage(text, args);
}
function buildMessage(text, args) {
    var rv = text[0];
    for (var i = 1, l = text.length; i < l; ++i) {
        rv += args[i - 1] + text[i];
    }
    return rv;
}
var TC = /** @class */ (function () {
    function TC(template) {
        extend(this, template);
    }
    return TC;
}());

function dateTimeReviver(key, value) {
    var a;
    if (typeof value === 'string') {
        a = /\/Date\((\d*)\)\//.exec(value);
        if (a) {
            return new Date(+a[1]);
        }
    }
    return value;
}
//let infoSerial = 1;
function showInfo(msg) {
    var event = new CustomEvent('info', { 'detail': msg });
    window.dispatchEvent(event);
}
function showError(errMsg) {
    var msg = typeof errMsg === 'string' ? errMsg : errMsg.message;
    var event = new CustomEvent('customerror', { 'detail': msg });
    console.error(errMsg);
    window.dispatchEvent(event);
}
function maxLength(str, maxLen) {
    return str.length > maxLen ?
        str.substr(0, maxLen - 3) + "..." :
        str;
}
function arrayToLookup(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        var array = result[key];
        if (array)
            array.push(item);
        else
            result[key] = [item];
    }
    return result;
}
function arrayToMap(a, keyAccessor) {
    var result = {};
    for (var i = 0, l = a.length; i < l; ++i) {
        var item = a[i];
        var key = keyAccessor(item);
        result[key] = item;
    }
    return result;
}
function cherryPickProps(obj, propsToPick) {
    var e_1, _a;
    var result = {};
    try {
        for (var propsToPick_1 = tslib__WEBPACK_IMPORTED_MODULE_0__["__values"](propsToPick), propsToPick_1_1 = propsToPick_1.next(); !propsToPick_1_1.done; propsToPick_1_1 = propsToPick_1.next()) {
            var param = propsToPick_1_1.value;
            if (param in obj)
                result[param] = obj[param];
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (propsToPick_1_1 && !propsToPick_1_1.done && (_a = propsToPick_1.return)) _a.call(propsToPick_1);
        }
        finally { if (e_1) throw e_1.error; }
    }
    return result;
}
function distinct(a, keyAccessor) {
    var map = arrayToMap(a, keyAccessor || (function (x) { return x; }));
    return Object.keys(map).map(function (key) { return map[key]; });
}
function shallowEquals(a, b) {
    if (a === b)
        return true;
    if (!a || !b)
        return false;
    if (typeof a !== 'object' || typeof b !== 'object')
        return false;
    var keysA = Object.keys(a);
    var keysB = Object.keys(b);
    if (keysA.length !== keysB.length)
        return false;
    for (var i = 0, l = keysA.length; i < l; ++i) {
        var key = keysA[i];
        if (keysB[i] !== key)
            return false;
        if (a[key] !== b[key])
            return false;
    }
    return true;
}


/***/ }),

/***/ "./src/utils/weekutil.ts":
/*!*******************************!*\
  !*** ./src/utils/weekutil.ts ***!
  \*******************************/
/*! exports provided: KEDWeek, getAdjustedWeek */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "KEDWeek", function() { return KEDWeek; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getAdjustedWeek", function() { return getAdjustedWeek; });
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! moment */ "./node_modules/moment/moment.js");
/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);

function KEDWeek(year, week) {
    var m = moment__WEBPACK_IMPORTED_MODULE_0___default()(new Date(year, 1, 1)).week(week);
    var res = {
        year: year,
        week: week,
        notBefore: m.clone().startOf('week').add(-2, 'days').toDate().getTime(),
        notAfter: m.clone().startOf('week').add(5, 'days').toDate().getTime()
    };
    return res;
}
function getAdjustedWeek(m) {
    var clone = m.clone();
    return m.weekday() >= 5 ? // Lördag 00:00 / Söndag 00:00?
        m.week() + 1 : // Tillhör nästa vecka
        m.week();
}
/*export function getWeekLimits (m: Moment) {
  const clonedSwedish = m.clone().locale('sv');
  const limits = {
    notBefore: clonedSwedish.startOf('week').add(-2, 'days'),
    notAfter: clonedSwedish.startOf('week').add(5, 'days')
  };
}
*/


/***/ }),

/***/ 0:
/*!*****************************************!*\
  !*** ../locale-data/index.js (ignored) ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 1:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ 2:
/*!*******************************!*\
  !*** ./lib/locales (ignored) ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

/* (ignored) */

/***/ }),

/***/ "jquery":
/*!*************************!*\
  !*** external "jQuery" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = jQuery;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "React" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = React;

/***/ }),

/***/ "react-dom":
/*!***************************!*\
  !*** external "ReactDOM" ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = ReactDOM;

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvY2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2NsaWVudHdlYi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC13ZWIvYmVhcmVyLXN0b3JhZ2Utc2Vzc2lvbnN0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2hhc2gtcmVzdG9yZXIuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2FjY2Vzcy1jb250cm9sLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L2h0dHAtZXJyb3IuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQva2VkLWJlYXJlci1wcm92aWRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLWNsaWVudC9yZXN0Y2xpZW50LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9jYWNoZS1idXN0LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9kZWx0YS1jb2xsZWN0aW9uL2FwcGx5LW11dGF0aW9ucy1vbi1kZWx0YXMuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY2FjaGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vZGVsdGEtbWVyZ2UuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2luZGV4LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9rZWRiYWNrZW5kLWNvbGxlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2tlZGJhY2tlbmQtcXVlcnkuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2tlZGJhY2tlbmQtcmVwby5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8va2VkYmFja2VuZC1zdWJzY3JpcHRpb24uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtYmFja2VuZC1yZXBvL2tlZGJhY2tlbmQtd3JpdGVyLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby9tdXRhdGlvbi1xdWV1ZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1iYWNrZW5kLXJlcG8vcXVlcnktc2V0LmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwby91dGlscy5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9pbmRleC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLWNvdXJzZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL2tlZC1tb2RlbC1taWdyYXRvci9taWdyYXRlLXRhc2suanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9rZWQtbW9kZWwtbWlncmF0b3IvbWlncmF0ZS5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvY29sbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvZW1pdHRlci5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvZmliZXItY29udGV4dC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL21hcC5qcyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4va2VkYmFja2VuZC9qcy9kaXN0L2pzL29ic2VydmFibGUvbWl4aW4uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL29ic2VydmFibGUuanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4uL2tlZGJhY2tlbmQvanMvZGlzdC9qcy9vYnNlcnZhYmxlL3ZhbHVlLmpzIiwid2VicGFjazovL1tuYW1lXS8uLi9rZWRiYWNrZW5kL3JlcG8uanMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUgc3luYyBzdnxlbiIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYWNjZXNzLWNvbnRyb2wvZ2V0LXVzZXItY2xhaW1zLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9hY2Nlc3MtY29udHJvbC9pbmRleC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9idXR0b25zLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvYXBpcy9lZHNjbGllbnQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2FwaXMvZ29vZ2xlLXBpY2tlci50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jYWxlbmRhci9jb3Vyc2UtbmFtZS10by1jc3MtY2xhc3MudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2hhcnRzL2NoYXJ0cy11dGlscy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jaGFydHMvZ29hbC1wcm9ncmVzcy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY2hhcnRzL3Byb2dyZXNzLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci1rcy9sb2dpYy9pcy1lbXBsb3llZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS9jb3Vyc2UtYmFubmVyLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL2NvdXJzZS1tb2R1bGUtcGFnZS50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS9nZXQtY3VzdG9taXplZC10YXNrLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvaW5kZXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvcnVuLXVwLXBhZ2UudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvdGFzay1hc3NpZ25tZW50cy50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9jb3Vyc2UtcGFnZS90YXNrLXBhZ2UudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvY291cnNlLXBhZ2UvdXJrdW5kLXV0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvaW5kZXgudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9hYmlsaXRpZXMtYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL2NvbmZpcm1hdGlvbi50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL2tub3dsZWRnZS1yZXF1aXJlbWVudHMtdGFibGUudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvc3ViY29tcG9uZW50cy9sZWFybmluZy1nb2Fscy1saXN0LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyL3N1YmNvbXBvbmVudHMvcmVzb3VyY2UtbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci9zdWJjb21wb25lbnRzL3Rhc2stbGlzdC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvY291cnNlLXZpZXdlci91dGlscy9nZXQtaW5jbHVkZWQtaWRzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2NvdXJzZS12aWV3ZXIvdXRpbHMvbWFudWFsLXNjcm9sbC1yZXN0b3JhdGlvbi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy9saXN0LWNvdXJzZXMvbGlzdC1jb3Vyc2VzLXBhZ2UudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL2xpc3QtY291cnNlcy9saXN0LWNvdXJzZXMudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9TZXR1cExhbmd1YWdlSW50bC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL2RpYWxvZ3MudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHRhcmVhLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94LnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9hZGQtY3VzdG9tLWdvYWwudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2FkZC1jdXN0b20tdGFzay50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvYWRkLW9yLWVkaXQtc3ViLXRhc2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2VkaXQtdXNlci10YXNrLnRzeCIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci9nZXQtdGFzay10eXBlLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL2luZGV4LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL3JlZmluZXIudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvdXNlci10YXNrcy1ib3gudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9jb21wb25lbnRzL3dlZWtwbGFubmVyL3dlZWtwbGFubmVyLXBlcnNpc3RlZC1zdGF0ZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvY29tcG9uZW50cy93ZWVrcGxhbm5lci93ZWVrcGxhbm5lci50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2VsZW1lbnRzL0tFREFwcENvdXJzZVZpZXdlci9hcHAuY291cnNldmlld2VyLmNsaWVudC50c3giLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2VsZW1lbnRzL0tFREFwcENvdXJzZVZpZXdlci93ZWJwYWNrLWVudHJ5LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9mZWF0dXJlcy9mZWF0dXJlcy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZmVhdHVyZXMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL2NvbmZpZ3VyZS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWFsbC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFsLXNldHRlcnMvc2V0LWJlYXJlci1wcm92aWRlcnMudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbC1zZXR0ZXJzL3NldC1lZHMtY2xpZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWwtc2V0dGVycy9zZXQta2VkLWJhY2tlbmQtY2xpZW50LnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL0tFRC5jZmcudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvS0VELmVudi50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvZ2xvYmFscy9LRUQudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMvZGIudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL2dsb2JhbHMva2VkLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9nbG9iYWxzL21vbWVudC1zdi1sb2NhbGUudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL2hpZGRlbi1jb3Vyc2VzLXJlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3JlcG9zL2tlZC1yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy9yZXBvLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9yZXBvcy91c2VyLXRhc2tzLXJlcG8udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL2Vycm9yLXN1Y2Nlc3MtZmVlZGJhY2sudHN4Iiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy9tYWtlLXN1c3BlbnNlLWFwaS50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvcGVuZGluZy1qb2IudHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3F1ZXJ5LXN0cmluZy50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLW1vbWVudC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi9zcmMvdXRpbHMvc2Nob29sLXRlcm0udHMiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy91dGlscy93ZWVrdXRpbC50cyIsIndlYnBhY2s6Ly9bbmFtZV0vLi4vbG9jYWxlLWRhdGEvaW5kZXguanMgKGlnbm9yZWQpIiwid2VicGFjazovL1tuYW1lXS8uL2xpYi9sb2NhbGVzIChpZ25vcmVkKSIsIndlYnBhY2s6Ly9bbmFtZV0vLi9saWIvbG9jYWxlcyAoaWdub3JlZCk/YTE3NyIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJqUXVlcnlcIiIsIndlYnBhY2s6Ly9bbmFtZV0vZXh0ZXJuYWwgXCJSZWFjdFwiIiwid2VicGFjazovL1tuYW1lXS9leHRlcm5hbCBcIlJlYWN0RE9NXCIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdCQUFRLG9CQUFvQjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUFpQiw0QkFBNEI7QUFDN0M7QUFDQTtBQUNBLDBCQUFrQiwyQkFBMkI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esa0RBQTBDLGdDQUFnQztBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdFQUF3RCxrQkFBa0I7QUFDMUU7QUFDQSx5REFBaUQsY0FBYztBQUMvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQXlDLGlDQUFpQztBQUMxRSx3SEFBZ0gsbUJBQW1CLEVBQUU7QUFDckk7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBMkIsMEJBQTBCLEVBQUU7QUFDdkQseUNBQWlDLGVBQWU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOERBQXNELCtEQUErRDs7QUFFckg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUFnQix1QkFBdUI7QUFD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QUMsS0FBSyxFQUFFLENBQUM7SUFDeEIsT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQywrQkFBK0I7UUFDckQsQ0FBQyxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsc0JBQXNCO1FBQ3JDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNmLENBQUM7QUFFRDs7Ozs7OztFQU9FOzs7Ozs7Ozs7Ozs7QUMzQkYsZTs7Ozs7Ozs7Ozs7QUNBQSxlOzs7Ozs7Ozs7OztBQ0FBLGU7Ozs7Ozs7Ozs7O0FDQUEsd0I7Ozs7Ozs7Ozs7O0FDQUEsdUI7Ozs7Ozs7Ozs7O0FDQUEsMEIiLCJmaWxlIjoia2VkYXBwY291cnNldmlld2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0XCJrZWRhcHBjb3Vyc2V2aWV3ZXJcIjogMFxuIFx0fTtcblxuIFx0dmFyIGRlZmVycmVkTW9kdWxlcyA9IFtdO1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHR2YXIganNvbnBBcnJheSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucF9uYW1lX1wiXSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucF9uYW1lX1wiXSB8fCBbXTtcbiBcdHZhciBvbGRKc29ucEZ1bmN0aW9uID0ganNvbnBBcnJheS5wdXNoLmJpbmQoanNvbnBBcnJheSk7XG4gXHRqc29ucEFycmF5LnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjaztcbiBcdGpzb25wQXJyYXkgPSBqc29ucEFycmF5LnNsaWNlKCk7XG4gXHRmb3IodmFyIGkgPSAwOyBpIDwganNvbnBBcnJheS5sZW5ndGg7IGkrKykgd2VicGFja0pzb25wQ2FsbGJhY2soanNvbnBBcnJheVtpXSk7XG4gXHR2YXIgcGFyZW50SnNvbnBGdW5jdGlvbiA9IG9sZEpzb25wRnVuY3Rpb247XG5cblxuIFx0Ly8gYWRkIGVudHJ5IG1vZHVsZSB0byBkZWZlcnJlZCBsaXN0XG4gXHRkZWZlcnJlZE1vZHVsZXMucHVzaChbXCIuL3NyYy9lbGVtZW50cy9LRURBcHBDb3Vyc2VWaWV3ZXIvd2VicGFjay1lbnRyeS50c1wiLFwidmVuZG9yc1wiXSk7XG4gXHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIHJlYWR5XG4gXHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiIsImV4cG9ydCAqIGZyb20gJy4vanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQnOyIsImV4cG9ydCAqIGZyb20gJy4vanMvZGlzdC9qcy9rZWQtYmFja2VuZC1jbGllbnQtd2ViJzsiLCJ2YXIgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCkge1xyXG4gICAgfVxyXG4gICAgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24gKGlkLCB0b2tlbkluZm8pIHtcclxuICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiYmVhcmVyLVwiICsgaWQsIEpTT04uc3RyaW5naWZ5KHRva2VuSW5mbykpO1xyXG4gICAgfTtcclxuICAgIEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZS5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHZhciBqc29uID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcImJlYXJlci1cIiArIGlkKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShqc29uID8gSlNPTi5wYXJzZShqc29uKSA6IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBCZWFyZXJTdG9yYWdlU2Vzc2lvblN0b3JhZ2U7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1iZWFyZXItc3RvcmFnZS1zZXNzaW9uc3RvcmFnZS5qcy5tYXAiLCJ2YXIgcmVkaXJIYXNoID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcInJlZGlyLWhhc2hcIik7XHJcbmlmIChyZWRpckhhc2gpXHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBfYSA9IEpTT04ucGFyc2UocmVkaXJIYXNoKSwgdGltZSA9IF9hLnRpbWUsIGhhc2ggPSBfYS5oYXNoO1xyXG4gICAgICAgIGlmICh0aW1lICYmIHRpbWUgPiBEYXRlLm5vdygpIC0gNjAwMDApIHtcclxuICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShcInJlZGlyLWhhc2hcIik7XHJcbiAgICAgICAgICAgIGxvY2F0aW9uLmhhc2ggPSBoYXNoO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChfKSB7IH1cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbWVtYmVySGFzaExvY2F0aW9uKCkge1xyXG4gICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInJlZGlyLWhhc2hcIiwgSlNPTi5zdHJpbmdpZnkoeyB0aW1lOiBEYXRlLm5vdygpLCBoYXNoOiBsb2NhdGlvbi5oYXNoIH0pKTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXNoLXJlc3RvcmVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDbGllbnQsIEh0dHBFcnJvciB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudCc7XHJcbmltcG9ydCB7IEJlYXJlclN0b3JhZ2VTZXNzaW9uU3RvcmFnZSB9IGZyb20gXCIuL2JlYXJlci1zdG9yYWdlLXNlc3Npb25zdG9yYWdlXCI7XHJcbmltcG9ydCB7IGF2b2lkU2ltdWx0YW5vdXNDYWxscyB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudC91dGlscyc7XHJcbmltcG9ydCB7IEtlZE1vZGVsTWlncmF0b3JNaXhpbiB9IGZyb20gJy4uL2tlZC1tb2RlbC1taWdyYXRvcic7XHJcbmltcG9ydCAnLi9oYXNoLXJlc3RvcmVyJztcclxuaW1wb3J0IHsgcmVtZW1iZXJIYXNoTG9jYXRpb24gfSBmcm9tICcuL2hhc2gtcmVzdG9yZXInO1xyXG5LZWRNb2RlbE1pZ3JhdG9yTWl4aW4oS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUpO1xyXG5leHBvcnQgdmFyIHN0b3JhZ2UgPSBuZXcgQmVhcmVyU3RvcmFnZVNlc3Npb25TdG9yYWdlKCk7XHJcbnZhciB0aW1lT2ZQYWdlTG9hZCA9IERhdGUubm93KCk7XHJcbnZhciBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKHRva2VuUGF0aCwgdG9rZW5SZXNwb25zZU1hcHBlciwgdG9rZW5JZCkge1xyXG4gICAgICAgIHRoaXMudG9rZW5QYXRoID0gdG9rZW5QYXRoO1xyXG4gICAgICAgIHRoaXMudG9rZW5SZXNwb25zZU1hcHBlciA9IHRva2VuUmVzcG9uc2VNYXBwZXI7XHJcbiAgICAgICAgdGhpcy50b2tlbklkID0gdG9rZW5JZDtcclxuICAgICAgICB0aGlzLnRva2VuSW5mbyA9IHsgdG9rZW46IG51bGwsIGV4cGlyZXM6IDAgfTtcclxuICAgICAgICB0aGlzLmdldEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldEJlYXJlci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5yZWZyZXNoQmVhcmVyLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLmdldEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIXRoaXMudG9rZW5JbmZvLnRva2VuKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnRva2VuSWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHN0b3JhZ2UubG9hZCh0aGlzLnRva2VuSWQpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy50b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoQmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlci5wcm90b3R5cGUucmVmcmVzaEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iLCBfYywgX2Q7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfZSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfZS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2godGhpcy50b2tlblBhdGgsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgQWNjZXB0OiBcInRleHQvcGxhaW47IGFwcGxpY2F0aW9uL2pzb25cIiB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3Q6ICdtYW51YWwnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6ICduby1jYWNoZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsczogXCJzYW1lLW9yaWdpblwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDMwMiB8fCAoIXJlcy5zdGF0dXMgJiYgcmVzLnR5cGUgPT09IFwib3BhcXVlcmVkaXJlY3RcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZXIgc2Vzc2lvbiB0aW1lZCBvdXQgYW5kIHNlcnZlciB3YW50cyB0byByZWRpcmVjdCBlbnRpcmUgcGFnZSB0byBsb2dpbiBwYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUaW1lIHRvIHJlbG9hZCBjdXJyZW50IHBhZ2UgdG8gZm9yY2UgYSByZWRpcmVjdCBvZiB0aGUgZW50aXJlIHBhZ2UgaW5zdGVhZCBmb3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGp1c3QgcmVkaXJlY3RpbmcgdG8gL2FwaS90b2tlbiBvciB3aGF0ZXZlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gdGltZU9mUGFnZUxvYWQgPiA2MDAwMCkgeyAvLyBwcm9oaWJpdCBlbmRsZXNzIGxvb3Agb2YgcmVsb2FkaW5nIHNlbGYuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53YW50c1JlZGlyZWN0ID0gdHJ1ZTsgLy8gU28gdGhhdCBsaXN0ZW5lcnMgdG8gb25iZWZvcmV1bmxvYWQgY291bGQgc2hvdyBhbHRlcm5hdGUgbWVzc2FnZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlZGlyZWN0IHdhbnRlZC4gUmVsb2FkIHBhZ2UuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWVtYmVySGFzaExvY2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCh0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSHR0cEVycm9yKDMwMiwgXCJSZWRpcmVjdGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBcIkhUVFBcIiArIHJlcy5zdGF0dXMgKyBcIiBcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEVycm9yLCBbdm9pZCAwLCBfYiArIChfZS5zZW50KCkpXSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYyA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kID0gdGhpcy50b2tlblJlc3BvbnNlTWFwcGVyO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRva2VuSW5mbyA9IF9kLmFwcGx5KHRoaXMsIFtfZS5zZW50KCldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZS5zYXZlKHRoaXMudG9rZW5JZCwgdGhpcy50b2tlbkluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gV2ViU2VydmVyQmVhcmVyUHJvdmlkZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyIH07XHJcbmV4cG9ydCB2YXIgaXNvbW9ycGhpYyA9IHsgZmV0Y2g6IGZldGNoLmJpbmQoc2VsZiksIGJ0b2E6IGJ0b2EuYmluZChzZWxmKSB9O1xyXG52YXIgS2VkQmFja2VuZENsaWVudFdlYiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEtlZEJhY2tlbmRDbGllbnRXZWIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ2xpZW50V2ViKGFwaUJhc2VVcmwsIHByb3ZpZGVyT3JUb2tlblBhdGgsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBiZWFyZXJQcm92aWRlciA9IHR5cGVvZiBwcm92aWRlck9yVG9rZW5QYXRoICE9PSAnc3RyaW5nJyA/XHJcbiAgICAgICAgICAgIHByb3ZpZGVyT3JUb2tlblBhdGggOlxyXG4gICAgICAgICAgICBuZXcgV2ViU2VydmVyQmVhcmVyUHJvdmlkZXIocHJvdmlkZXJPclRva2VuUGF0aCwgKG9wdGlvbnMgJiYgb3B0aW9ucy50b2tlblJlc3BvbnNlTWFwcGVyKSB8fCAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuICh7IHRva2VuOiB4LCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDYwIH0pOyB9KSwgb3B0aW9ucyAmJiBvcHRpb25zLnRva2VuSWQpO1xyXG4gICAgICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgaXNvbW9ycGhpYywgYmVhcmVyUHJvdmlkZXIsIGFwaUJhc2VVcmwpIHx8IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEtlZEJhY2tlbmRDbGllbnRXZWI7XHJcbn0oS2VkQmFja2VuZENsaWVudCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsInZhciBEb2N1bWVudEFjY2VzcyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERvY3VtZW50QWNjZXNzKGFjY2Vzc0NsYWltVHlwZSwgYWNjZXNzQ2xhaW1WYWx1ZSwgcmlnaHQpIHtcclxuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVHlwZSA9IGFjY2Vzc0NsYWltVHlwZTtcclxuICAgICAgICB0aGlzLmFjY2Vzc0NsYWltVmFsdWUgPSBhY2Nlc3NDbGFpbVZhbHVlO1xyXG4gICAgICAgIHRoaXMucmlnaHQgPSByaWdodDtcclxuICAgIH1cclxuICAgIERvY3VtZW50QWNjZXNzLmZyb21TdHJpbmcgPSBmdW5jdGlvbiAoYWMpIHtcclxuICAgICAgICBpZiAoIWFjKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB2YXIgc3BsaXQgPSBhYy5zcGxpdCgnOicpO1xyXG4gICAgICAgIGlmIChzcGxpdC5sZW5ndGggPCAzKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFjY2VzcyBzdHJpbmc6IFwiICsgYWMpO1xyXG4gICAgICAgIHZhciBjbGFpbVR5cGUgPSBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZShzcGxpdFswXSk7XHJcbiAgICAgICAgdmFyIGNsYWltVmFsdWUgPSBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZShzcGxpdFsxXSk7XHJcbiAgICAgICAgdmFyIHJpZ2h0ID0gc3BsaXRbMl07XHJcbiAgICAgICAgaWYgKHJpZ2h0ICE9PSAnUicgJiYgcmlnaHQgIT09ICdXJyAmJiByaWdodCAhPT0gJ1MnKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGFjY2VzcyBzdHJpbmc6IFwiICsgYWMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgRG9jdW1lbnRBY2Nlc3MoY2xhaW1UeXBlLCBjbGFpbVZhbHVlLCByaWdodCk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRBY2Nlc3MuZXNjYXBlID0gZnVuY3Rpb24gKGFjY2Vzc0NvbXBvbmVudCkge1xyXG4gICAgICAgIHJldHVybiBhY2Nlc3NDb21wb25lbnQucmVwbGFjZSgvXFwlL2csIFwiJTI1XCIpLnJlcGxhY2UoL1xcOi9nLCBcIiUzQVwiKTtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy51bmVzY2FwZSA9IGZ1bmN0aW9uIChhY2Nlc3NDb21wb25lbnQpIHtcclxuICAgICAgICByZXR1cm4gYWNjZXNzQ29tcG9uZW50LnJlcGxhY2UoL1xcJTNBL2csIFwiOlwiKS5yZXBsYWNlKC9cXCUyNS9nLCBcIiVcIik7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRBY2Nlc3MucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVR5cGUpICsgXCI6XCIgK1xyXG4gICAgICAgICAgICBEb2N1bWVudEFjY2Vzcy5lc2NhcGUodGhpcy5hY2Nlc3NDbGFpbVZhbHVlKSArIFwiOlwiICtcclxuICAgICAgICAgICAgdGhpcy5yaWdodDtcclxuICAgIH07XHJcbiAgICBEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nQXJyYXkgPSBmdW5jdGlvbiAoYWNsKSB7XHJcbiAgICAgICAgcmV0dXJuIGFjbFxyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChhYykgeyByZXR1cm4gRG9jdW1lbnRBY2Nlc3MuZnJvbVN0cmluZyhhYyk7IH0pXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFjKSB7IHJldHVybiBhYzsgfSk7XHJcbiAgICB9O1xyXG4gICAgRG9jdW1lbnRBY2Nlc3MudG9TdHJpbmdBcnJheSA9IGZ1bmN0aW9uIChhY2wpIHtcclxuICAgICAgICByZXR1cm4gYWNsLm1hcChmdW5jdGlvbiAoYWMpIHsgcmV0dXJuIGFjLnRvU3RyaW5nKCk7IH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEb2N1bWVudEFjY2VzcztcclxufSgpKTtcclxuZXhwb3J0IHsgRG9jdW1lbnRBY2Nlc3MgfTtcclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0FjY2VzcyhhY2wsIHVzZXJDbGFpbXMsIHJlcXVlc3RlZFJpZ2h0KSB7XHJcbiAgICBpZiAodXNlckNsYWltcy5zb21lKGZ1bmN0aW9uIChjbGFpbSkgeyByZXR1cm4gY2xhaW0udHlwZSA9PT0gJ3JvbGUnICYmIGNsYWltLnZhbHVlID09PSBcIkFETUlOXCI7IH0pKVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgcmV0dXJuIGFjbC5zb21lKGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJDbGFpbXMuc29tZShmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICByZXR1cm4gYS5hY2Nlc3NDbGFpbVR5cGUgPT09IGMudHlwZSAmJlxyXG4gICAgICAgICAgICAgICAgYS5hY2Nlc3NDbGFpbVZhbHVlID09PSBjLnZhbHVlICYmICgoYS5yaWdodCA9PT0gJ1InICYmIHJlcXVlc3RlZFJpZ2h0ID09PSAnUicpIHx8XHJcbiAgICAgICAgICAgICAgICAoYS5yaWdodCA9PT0gJ1cnICYmIFsnUicsICdXJ10uaW5kZXhPZihyZXF1ZXN0ZWRSaWdodCkgPj0gMCkgfHxcclxuICAgICAgICAgICAgICAgIChhLnJpZ2h0ID09PSAnUycpKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjY2Vzcy1jb250cm9sLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbnZhciBIdHRwRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhIdHRwRXJyb3IsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBIdHRwRXJyb3IoY29kZSwgbWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIFwiSFRUUFwiICsgY29kZSArIFwiIFwiICsgbWVzc2FnZSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcclxuICAgICAgICBfdGhpcy5uYW1lID0gXCJodHRwXCIgKyBjb2RlO1xyXG4gICAgICAgIF90aGlzLm1lc3NhZ2UgPSBcIkhUVFBcIiArIGNvZGUgKyBcIiBcIiArIG1lc3NhZ2U7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEh0dHBFcnJvcjtcclxufShFcnJvcikpO1xyXG5leHBvcnQgeyBIdHRwRXJyb3IgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1lcnJvci5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBSZXN0Q2xpZW50IH0gZnJvbSAnLi9yZXN0Y2xpZW50JztcclxuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7XHJcbmV4cG9ydCB7IEtlZEJlYXJlclByb3ZpZGVyIH0gZnJvbSAnLi9rZWQtYmVhcmVyLXByb3ZpZGVyJztcclxuZXhwb3J0ICogZnJvbSAnLi9hY2Nlc3MtY29udHJvbCc7XHJcbmV4cG9ydCB7IFJlc3RDbGllbnQgfTtcclxuaW1wb3J0IHsgSHR0cEVycm9yIH0gZnJvbSAnLi9odHRwLWVycm9yJztcclxuZXhwb3J0IHsgSHR0cEVycm9yIH07XHJcbmV4cG9ydCAqIGZyb20gJy4vcmVzdGNsaWVudCc7XHJcbjtcclxudmFyIEtlZEJhY2tlbmRDbGllbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kQ2xpZW50KGlzb21vcnBoaWMsIGJlYXJlclByb3ZpZGVyLCBiYXNlVXJsKSB7XHJcbiAgICAgICAgdGhpcy5odHRwID0gbmV3IFJlc3RDbGllbnQoaXNvbW9ycGhpYywgYmFzZVVybCwgeyBiZWFyZXJQcm92aWRlcjogYmVhcmVyUHJvdmlkZXIgfSk7XHJcbiAgICB9XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5nZXRNeUNsYWltcyA9IGZ1bmN0aW9uICh0YWJsZSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmh0dHAuZ2V0KFwibWUvY2xhaW1zL1wiICsgKHRhYmxlIHx8IFwiXCIpLCBudWxsLCBmZXRjaE9wdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5nZXQodGFibGUgKyBcIi9cIiArIGlkLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5saXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBvcHRpb25zLCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5LCByZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9IHRzbGliXzEuX19hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLm11dGF0aW9uc09uRW1wdHkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeS5tdXRhdGlvbnNPbkVtcHR5ID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5tdXRhdGlvbnNPbkVtcHR5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmdldChcIlwiICsgdGFibGUsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmVzLnN0YXR1cyAhPSAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5iYXRjaCA9IGZ1bmN0aW9uIChyZXFzLCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlb3JkZXIgb3BlcmF0aW9ucyBzbyB0aGF0ICdhZGQncyBjb21lIGZpcnN0IGFuZCAnZGVsZXRlJ3MgY29tZSBsYXN0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXFzID0gcmVxcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKHJlcTEsIHJlcTIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXExLm9wID09PSAnYWRkJyA/IC0xIDogcmVxMi5vcCA9PT0gJ2FkZCcgPyAxIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXExLm9wID09PSAnZGVsZXRlJyA/IDEgOiByZXEyLm9wID09PSAnZGVsZXRlJyA/IC0xIDogMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuaHR0cC5wb3N0KFwiYmF0Y2hcIiwgcmVxcywgZmV0Y2hPcHRpb25zKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuZG8gPSBmdW5jdGlvbiAoc2NvcGVGbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcnVubmVyO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bm5lciA9IG5ldyBCYXRjaFJ1bm5lcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZUZuKHJ1bm5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYmF0Y2gocnVubmVyLm11dGF0aW9uUmVxdWVzdHMpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbMiAvKnJldHVybiovLCBfYS5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5kZWxldGVSZWFsbSA9IGZ1bmN0aW9uIChyZWFsbSkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzLCBfYSwgX2I7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYy5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5odHRwLmRlbGV0ZShcInJlYWxtcy9cIiArIHJlYWxtKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgIT0gMjAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gSHR0cEVycm9yLmJpbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gW3ZvaWQgMCwgcmVzLnN0YXR1c107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHJlcy50ZXh0KCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogdGhyb3cgbmV3IChfYS5hcHBseShIdHRwRXJyb3IsIF9iLmNvbmNhdChbX2Muc2VudCgpXSkpKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLmpzb24oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Muc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHRhYmxlLCBkb2MsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIuYWRkKHRhYmxlLCBkb2MpOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ2xpZW50LnByb3RvdHlwZS5wdXQgPSBmdW5jdGlvbiAodGFibGUsIGRvYykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnB1dCh0YWJsZSwgZG9jKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIudXBkYXRlKHRhYmxlLCBpZCwgZGVsdGFEb2MsIGJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZG8oZnVuY3Rpb24gKHIpIHsgcmV0dXJuIHIubWVyZ2UoYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuY2xlYXJCcmFuY2ggPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5jbGVhckJyYW5jaChicmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5kZWxldGUodGFibGUsIGlkKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5zaGFyZSh0YWJsZSwgaWQsIGFjbCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVuc2hhcmUgPSBmdW5jdGlvbiAodGFibGUsIGlkLCBhY2wpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bnNoYXJlKHRhYmxlLCBpZCwgYWNsKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci5saW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLmxpbmsyID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVubGluayA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldFRhYmxlLCB0YXJnZXRJZCwgbGFiZWwpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENsaWVudC5wcm90b3R5cGUudW5saW5rMiA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIHRhcmdldElkLCBsYWJlbCwgYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kbyhmdW5jdGlvbiAocikgeyByZXR1cm4gci51bmxpbmsyKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDbGllbnQucHJvdG90eXBlLnVuZG9MaW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0SWQsIGxhYmVsLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRvKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnVuZG9MaW5rKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCk7IH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kQ2xpZW50O1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50IH07XHJcbnZhciBCYXRjaFJ1bm5lciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJhdGNoUnVubmVyKCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cyA9IFtdO1xyXG4gICAgfVxyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdhZGQnLCB0YWJsZTogdGFibGUsIGRvYzogZG9jLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnB1dCA9IGZ1bmN0aW9uICh0YWJsZSwgZG9jKSB7XHJcbiAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jKTtcclxuICAgICAgICBkZWxldGUgZG9jLmFjbDsgLy8gRm9yYmlkZGVuIHRvIHNlbmQgYWNsIHdpdGggcHV0KCkgY2FsbHMuXHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3B1dCcsIHRhYmxlOiB0YWJsZSwgZG9jOiBkb2MgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQsIGRlbHRhRG9jLCBicmFuY2hJZCkge1xyXG4gICAgICAgIGRlbHRhRG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZGVsdGFEb2MpO1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1cGRhdGUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgZGVsdGFEb2M6IGRlbHRhRG9jLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLm1lcmdlID0gZnVuY3Rpb24gKGJyYW5jaElkLCB0YXJnZXRCcmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdtZXJnZScsIGJyYW5jaElkOiBicmFuY2hJZCwgdGFyZ2V0QnJhbmNoSWQ6IHRhcmdldEJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS5jbGVhckJyYW5jaCA9IGZ1bmN0aW9uIChicmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh0YWJsZSwgaWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAnZGVsZXRlJywgdGFibGU6IHRhYmxlLCBpZDogaWQgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3NoYXJlJywgdGFibGU6IHRhYmxlLCBpZDogaWQsIGFjbDogYWNsIH0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIEJhdGNoUnVubmVyLnByb3RvdHlwZS51bnNoYXJlID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgYWNsKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ3Vuc2hhcmUnLCB0YWJsZTogdGFibGUsIGlkOiBpZCwgYWNsOiBhY2wgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLmxpbmsgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCB0YXJnZXRUYWJsZSwgdGFyZ2V0SWQsIGxhYmVsKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2xpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0VGFibGU6IHRhcmdldFRhYmxlLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUubGluazIgPSBmdW5jdGlvbiAoc291cmNlVGFibGUsIHNvdXJjZUlkLCBsYWJlbCwgdGFyZ2V0SWQsIGJyYW5jaElkKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblJlcXVlc3RzLnB1c2goeyBvcDogJ2xpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5saW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgdGFyZ2V0VGFibGUsIHRhcmdldElkLCBsYWJlbCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0VGFibGU6IHRhcmdldFRhYmxlLCB0YXJnZXRJZDogdGFyZ2V0SWQsIGxhYmVsOiBsYWJlbCB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBCYXRjaFJ1bm5lci5wcm90b3R5cGUudW5saW5rMiA9IGZ1bmN0aW9uIChzb3VyY2VUYWJsZSwgc291cmNlSWQsIGxhYmVsLCB0YXJnZXRJZCwgYnJhbmNoSWQpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUmVxdWVzdHMucHVzaCh7IG9wOiAndW5saW5rJywgc291cmNlVGFibGU6IHNvdXJjZVRhYmxlLCBzb3VyY2VJZDogc291cmNlSWQsIHRhcmdldElkOiB0YXJnZXRJZCwgbGFiZWw6IGxhYmVsLCBicmFuY2hJZDogYnJhbmNoSWQgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgQmF0Y2hSdW5uZXIucHJvdG90eXBlLnVuZG9MaW5rID0gZnVuY3Rpb24gKHNvdXJjZVRhYmxlLCBzb3VyY2VJZCwgbGFiZWwsIHRhcmdldElkLCBicmFuY2hJZCkge1xyXG4gICAgICAgIHRoaXMubXV0YXRpb25SZXF1ZXN0cy5wdXNoKHsgb3A6ICd1bmRvLWxpbmsnLCBzb3VyY2VUYWJsZTogc291cmNlVGFibGUsIHNvdXJjZUlkOiBzb3VyY2VJZCwgdGFyZ2V0SWQ6IHRhcmdldElkLCBsYWJlbDogbGFiZWwsIGJyYW5jaElkOiBicmFuY2hJZCB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQmF0Y2hSdW5uZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEJhdGNoUnVubmVyIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICcuL3Jlc3RjbGllbnQnO1xyXG5pbXBvcnQgeyBhdm9pZFNpbXVsdGFub3VzQ2FsbHMgfSBmcm9tICcuL3V0aWxzJztcclxudmFyIEtlZEJlYXJlclByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmVhcmVyUHJvdmlkZXIoaXNvbW9ycGhpYywgc3RvcmFnZSwgdG9rZW5JZCwgY2xpZW50SWQsIGNsaWVudFNlY3JldCwgdG9rZW5VcmwsIHRva2VuUXVlcnkpIHtcclxuICAgICAgICB0aGlzLmlzb21vcnBoaWMgPSBpc29tb3JwaGljO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IHN0b3JhZ2U7XHJcbiAgICAgICAgdGhpcy50b2tlbklkID0gdG9rZW5JZDtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5jbGllbnRTZWNyZXQgPSBjbGllbnRTZWNyZXQ7XHJcbiAgICAgICAgdGhpcy50b2tlblVybCA9IHRva2VuVXJsO1xyXG4gICAgICAgIHRoaXMudG9rZW5RdWVyeSA9IHRva2VuUXVlcnk7XHJcbiAgICAgICAgdGhpcy50b2tlbkluZm8gPSB7IHRva2VuOiBudWxsLCBleHBpcmVzOiAwIH07XHJcbiAgICAgICAgdGhpcy5jbGllbnQgPSBuZXcgUmVzdENsaWVudChpc29tb3JwaGljLCBcIlwiLCB7XHJcbiAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLmNsaWVudElkLFxyXG4gICAgICAgICAgICBwYXNzd29yZDogdGhpcy5jbGllbnRTZWNyZXRcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmdldEJlYXJlciA9IGF2b2lkU2ltdWx0YW5vdXNDYWxscyh0aGlzLmdldEJlYXJlci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hCZWFyZXIgPSBhdm9pZFNpbXVsdGFub3VzQ2FsbHModGhpcy5yZWZyZXNoQmVhcmVyLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG4gICAgS2VkQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLmdldEJlYXJlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hLCB0b2tlbiwgZXhwaXJlcywgX2IsIGVfMTtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYSA9IHRoaXMudG9rZW5JbmZvLCB0b2tlbiA9IF9hLnRva2VuLCBleHBpcmVzID0gX2EuZXhwaXJlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuICYmIGV4cGlyZXMgPj0gRGF0ZS5ub3coKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMSwgNCwgLCA2XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5zdG9yYWdlLmxvYWQodGhpcy5jbGllbnRJZCArIFwiL1wiICsgdGhpcy50b2tlbklkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50b2tlbkluZm8gPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRva2VuSW5mby50b2tlbiAmJiB0aGlzLnRva2VuSW5mby5leHBpcmVzID49IERhdGUubm93KCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdGhpcy50b2tlbkluZm9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hCZWFyZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB0aGlzLnRva2VuSW5mb107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlXzEgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaEJlYXJlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmVhcmVyUHJvdmlkZXIucHJvdG90eXBlLnJlZnJlc2hCZWFyZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXMsIHJldHJpZXMsIF9hLCBfYjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXRyaWVzID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocmV0cmllcyA8IDYpKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSZXRyaWV2aW5nIHRva2VuIGZvciBcIiArIHRoaXMudG9rZW5JZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50LmdldCh0aGlzLnRva2VuVXJsLCB0aGlzLnRva2VuUXVlcnksIHsgY2FjaGU6ICdyZWxvYWQnIH0pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IF9jLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiR290IFwiICsgcmVzLnN0YXR1cyArIFwiIFwiICsgcmVzLnN0YXR1c1RleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMudGV4dCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRva2VuSW5mbyA9IChfYi50b2tlbiA9IF9jLnNlbnQoKSwgX2IuZXhwaXJlcyA9IERhdGUubm93KCkgKyA1OSAqIDYwICogMTAwMCwgX2IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCB0b2tlbiBmb3IgXCIgKyB0aGlzLnRva2VuSWQgKyBcIjogXCIgKyBKU09OLnN0cmluZ2lmeSh0aGlzLnRva2VuSW5mbykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JhZ2Uuc2F2ZSh0aGlzLmNsaWVudElkICsgXCIvXCIgKyB0aGlzLnRva2VuSWQsIHRoaXMudG9rZW5JbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudG9rZW5JbmZvXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICsrcmV0cmllcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OiB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmV0cmlldmUgdG9rZW4gZm9yIFwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy50b2tlbklkKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCZWFyZXJQcm92aWRlcjtcclxufSgpKTtcclxuZXhwb3J0IHsgS2VkQmVhcmVyUHJvdmlkZXIgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkLWJlYXJlci1wcm92aWRlci5qcy5tYXAiLCIvKlxyXG5kZWNsYXJlIHZhciBCdWZmZXI7IC8vIG5vZGUgYnVpbHQtaW5cclxuXHJcblxyXG5mdW5jdGlvbiBiYXNpY0F1dGhIZWFkZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICByZXR1cm4gXCJCYXNpYyBcIiArIG5ldyBCdWZmZXIodXNlcm5hbWUgKyBcIjpcIiArIHBhc3N3b3JkKS50b1N0cmluZyhcImJhc2U2NFwiKTtcclxufVxyXG4qL1xyXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSBcIi4vdXRpbHNcIjtcclxuaW1wb3J0IHsgRW1pdHRlciB9IGZyb20gJy4uL29ic2VydmFibGUvZW1pdHRlcic7XHJcbnZhciBSZXN0Q2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUmVzdENsaWVudChpc29tb3JwaGljLCBiYXNlVXJsLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5pc29tb3JwaGljID0gaXNvbW9ycGhpYztcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5udW1PdXRzdGFuZGluZ09wZXJhdGlvbnMgPSAwO1xyXG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IG5ldyBFbWl0dGVyKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZmV0Y2hPcHRpb25zID0geyBtb2RlOiAnY29ycycgfTtcclxuICAgICAgICB0aGlzLmF1dGhIZWFkZXIgPSBvcHRpb25zLmJlYXJlciA/XHJcbiAgICAgICAgICAgIFwiQmVhcmVyIFwiICsgb3B0aW9ucy5iZWFyZXIgOlxyXG4gICAgICAgICAgICBvcHRpb25zLnVzZXJuYW1lID9cclxuICAgICAgICAgICAgICAgIFwiQmFzaWMgXCIgKyBpc29tb3JwaGljLmJ0b2Eob3B0aW9ucy51c2VybmFtZSArIFwiOlwiICsgKG9wdGlvbnMucGFzc3dvcmQgfHwgXCJcIikpIDpcclxuICAgICAgICAgICAgICAgIG51bGw7XHJcbiAgICAgICAgdGhpcy5iZWFyZXJQcm92aWRlciA9IG9wdGlvbnMuYmVhcmVyUHJvdmlkZXIgfHwgbnVsbDtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN0Q2xpZW50LnByb3RvdHlwZSwgXCJzdGF0dXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICArK3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xyXG4gICAgICAgIHRoaXMuX3N0YXR1cy5kaXNwYXRjaCh0aGlzKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZmV0Y2gocGF0aCwgbWV0aG9kLCBoZWFkZXJzLCBxdWVyeSwgZmV0Y2hPcHRpb25zKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcbiAgICAgICAgICAgIC0tX3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xyXG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzLmRpc3BhdGNoKF90aGlzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIC0tX3RoaXMubnVtT3V0c3RhbmRpbmdPcGVyYXRpb25zO1xyXG4gICAgICAgICAgICBfdGhpcy5fc3RhdHVzLmRpc3BhdGNoKF90aGlzKTtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuX2ZldGNoID0gZnVuY3Rpb24gKHBhdGgsIG1ldGhvZCwgaGVhZGVycywgcXVlcnksIGZldGNoT3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcXVlcnlTdHIsIF9hLCBhdXRoSGVhZGVyLCB0b2tlbkluZm8sIGJlYXJlclByb3ZpZGVyLCBfYiwgX2MsIHVybCwgcmVzLCB3d3dhdXRoLCBfZDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9lKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9lLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmV0Y2hPcHRpb25zICYmIGZldGNoT3B0aW9ucy5jYWNoZSA9PT0gJ25vLWNhY2hlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgYmFjay1idXR0b24gbm90IHJlc3BlY3RpbmcgY2FjaGUgY29udHJvbCBpbiBDaHJvbWUvT3BlcmEuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBlbmQgYSBxdWVyeSBwYXJhbWV0ZXIgdG8gZm9yY2UgYSBjYWNoZSBlbnRyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBxdWVyeSwgeyBub2NhY2hlOiBjcmVhdGVVVUlEKCkgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHIgPSBxdWVyeSAmJiBPYmplY3Qua2V5cyhxdWVyeSkuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIHF1ZXJ5W2tleV0gIT09IHVuZGVmaW5lZDsgfSkubWFwKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCI9XCIgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kZVVSSUNvbXBvbmVudChxdWVyeVtrZXldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKCcmJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcywgYXV0aEhlYWRlciA9IF9hLmF1dGhIZWFkZXIsIHRva2VuSW5mbyA9IF9hLnRva2VuSW5mbywgYmVhcmVyUHJvdmlkZXIgPSBfYS5iZWFyZXJQcm92aWRlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoIWF1dGhIZWFkZXIgJiYgIXRva2VuSW5mbyAmJiBiZWFyZXJQcm92aWRlcikpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGJlYXJlclByb3ZpZGVyLmdldEJlYXJlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRva2VuSW5mbyA9IHRva2VuSW5mbyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2UubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b2tlbkluZm8pIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0b2tlbkluZm8uZXhwaXJlcyA8IERhdGUubm93KCkpKSByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUb2tlbiBleHBpcmVkLiBSZWZyZXNoIGl0OlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBiZWFyZXJQcm92aWRlci5yZWZyZXNoQmVhcmVyKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2MudG9rZW5JbmZvID0gdG9rZW5JbmZvID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoSGVhZGVyID0gXCJCZWFyZXIgXCIgKyB0b2tlbkluZm8udG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9lLmxhYmVsID0gNTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIG9uZSB3YXkgb3IgYW5vdGhlciwgd2UndmUgY29uY2x1ZGVkIGFuIEF1dGhvcml6YXRpb24gaGVhZGVyIHRvIHVzZTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF1dGhIZWFkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IGF1dGhIZWFkZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsID0gdGhpcy5iYXNlVXJsICsgcGF0aCArIChxdWVyeVN0ciA/IFwiP1wiICsgcXVlcnlTdHIgOiBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pc29tb3JwaGljLmZldGNoKHVybCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5mZXRjaE9wdGlvbnMsIHsgaGVhZGVyczogaGVhZGVycywgbWV0aG9kOiBtZXRob2QgfSwgZmV0Y2hPcHRpb25zKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyZXMuc3RhdHVzID09IDQwMSAmJiB0aGlzLmJlYXJlclByb3ZpZGVyKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHd3d2F1dGggPSByZXMuaGVhZGVycy5nZXQoXCJ3d3ctYXV0aGVudGljYXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvdCBcIiArIHJlcy5zdGF0dXMgKyBcIiBmcm9tIFwiICsgKHRoaXMuYmFzZVVybCArIHBhdGgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEod3d3YXV0aCAmJiAvQmVhcmVyL2kudGVzdCh3d3dhdXRoKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZCA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuYmVhcmVyUHJvdmlkZXIucmVmcmVzaEJlYXJlcigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kLnRva2VuSW5mbyA9IF9lLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5BdXRob3JpemF0aW9uID0gXCJCZWFyZXIgXCIgKyB0aGlzLnRva2VuSW5mby50b2tlbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5pc29tb3JwaGljLmZldGNoKHVybCwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5mZXRjaE9wdGlvbnMsIHsgaGVhZGVyczogaGVhZGVycywgbWV0aG9kOiBtZXRob2QgfSwgZmV0Y2hPcHRpb25zKSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzID0gX2Uuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZS5sYWJlbCA9IDk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qLywgcmVzXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHBhdGgsIHF1ZXJ5LCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIkdFVFwiLCB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uOyB0ZXh0L3BsYWluXCIgfSwgcXVlcnksIGZldGNoT3B0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgUmVzdENsaWVudC5wcm90b3R5cGUucG9zdCA9IGZ1bmN0aW9uIChwYXRoLCBkYXRhLCBmZXRjaE9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mZXRjaChwYXRoLCBcIlBPU1RcIiwge1xyXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgICAgXCJBY2NlcHRcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgICB9LCBudWxsLCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSkgfSkpO1xyXG4gICAgfTtcclxuICAgIFJlc3RDbGllbnQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXRoLCBxdWVyeSwgYm9keSwgZmV0Y2hPcHRpb25zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmV0Y2gocGF0aCwgXCJERUxFVEVcIiwgeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvbjsgdGV4dC9wbGFpblwiIH0sIHF1ZXJ5LCB0c2xpYl8xLl9fYXNzaWduKHt9LCBmZXRjaE9wdGlvbnMsIHsgYm9keTogYm9keSB9KSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFJlc3RDbGllbnQ7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IFJlc3RDbGllbnQgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVzdGNsaWVudC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVVVJRCgpIHtcclxuICAgIC8vIERlY2VudCBzb2x1dGlvbiBmcm9tIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MDM0L2hvdy10by1jcmVhdGUtYS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdFxyXG4gICAgdmFyIGQgPSBEYXRlLm5vdygpO1xyXG4gICAgdmFyIHV1aWQgPSAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgdmFyIHIgPSAoZCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7XHJcbiAgICAgICAgZCA9IE1hdGguZmxvb3IoZCAvIDE2KTtcclxuICAgICAgICByZXR1cm4gKGMgPT09ICd4JyA/IHIgOiAociAmIDB4NyB8IDB4OCkpLnRvU3RyaW5nKDE2KTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHV1aWQ7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGF2b2lkU2ltdWx0YW5vdXNDYWxscyhtZXRob2QpIHtcclxuICAgIHZhciBvbmdvaW5nUHJvbWlzZSA9IG51bGw7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghb25nb2luZ1Byb21pc2UpIHtcclxuICAgICAgICAgICAgb25nb2luZ1Byb21pc2UgPSBtZXRob2QuYXBwbHkodGhpcywgYXJndW1lbnRzKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIG9uZ29pbmdQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb25nb2luZ1Byb21pc2U7XHJcbiAgICB9O1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRHbG9iYWxJZChyZWFsbSkge1xyXG4gICAgdmFyIHByZWZpeCA9ICdlYzk2YjNiZS00NWZjLTQxZDMtYjY5ZS0nO1xyXG4gICAgdmFyIHBhZCA9IFsnNTAnLCAnMDgnLCAnZTEnLCAnNDAnLCAnZTQnLCAnZTcnXTtcclxuICAgIGlmIChyZWFsbS5sZW5ndGggPiA2KVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRvbyBsb25nIHJlYWxtXCIpO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZWFsbS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIHZhciBoZXggPSByZWFsbS5jaGFyQ29kZUF0KGkpLnRvU3RyaW5nKDE2KTtcclxuICAgICAgICBwYWRbaV0gPSBoZXgubGVuZ3RoID09PSAyID9cclxuICAgICAgICAgICAgaGV4IDpcclxuICAgICAgICAgICAgJzAnICsgaGV4O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHByZWZpeCArIHBhZC5qb2luKCcnKTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVByZWRlc3RpbmF0ZWRJZChpbnB1dCkge1xyXG4gICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGVuY29kZXIsIGRhdGEsIGRpZ2VzdCwgX2EsIGk7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICBlbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGVuY29kZXIuZW5jb2RlKGlucHV0KTtcclxuICAgICAgICAgICAgICAgICAgICBfYSA9IFVpbnQ4QXJyYXkuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGRhdGEpXTtcclxuICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICBkaWdlc3QgPSBuZXcgKF9hLmFwcGx5KFVpbnQ4QXJyYXksIFt2b2lkIDAsIF9iLnNlbnQoKV0pKSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKC9beHldL2csIGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmliYmxlID0gZGlnZXN0W2krK10gJSAxNiB8IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd2FzaGVkTmliYmxlID0gYyA9PT0gJ3gnID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuaWJibGUgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5pYmJsZSAmIDB4NyB8IDB4ODtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3YXNoZWROaWJibGUudG9TdHJpbmcoMTYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcbi8qZXhwb3J0IGZ1bmN0aW9uIGJ1ZjJoZXgoYnVmZmVyOiBBcnJheUJ1ZmZlcikge1xyXG4gIHJldHVybiBBcnJheS5wcm90b3R5cGUubWFwLmNhbGwoXHJcbiAgICBuZXcgVWludDhBcnJheShidWZmZXIpLFxyXG4gICAgKHg6IG51bWJlcikgPT4gKCcwMCcgKyB4LnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpKS5qb2luKCcnKTtcclxufSovXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBcnJheShhLCBtYXBwZXIpIHtcclxuICAgIHZhciByZXR2YWwgPSBhO1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBhLmxlbmd0aDsgaSA8IGw7ICsraSkge1xyXG4gICAgICAgIHZhciB0ID0gYVtpXTtcclxuICAgICAgICB2YXIgbWFwcGVkID0gbWFwcGVyKHQpO1xyXG4gICAgICAgIGlmIChtYXBwZWQgIT09IHQpIHtcclxuICAgICAgICAgICAgaWYgKHJldHZhbCA9PT0gYSlcclxuICAgICAgICAgICAgICAgIHJldHZhbCA9IGEuc2xpY2UoKTtcclxuICAgICAgICAgICAgcmV0dmFsW2ldID0gbWFwcGVkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXR2YWw7XHJcbn1cclxuLypcclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUFycmF5PFQ+KGE6IFRbXSwgbWFwcGVyOiAodDogVCkgPT4gVCB8IGZhbHNlKTogVFtdIHtcclxuICBsZXQgcmV0dmFsID0gYTtcclxuICBsZXQgaiA9IDA7XHJcbiAgZm9yIChsZXQgaT0wLGw9YS5sZW5ndGg7IGk8bDsgKytpLCArK2opIHtcclxuICAgIGNvbnN0IHQgPSBhW2ldO1xyXG4gICAgY29uc3QgbWFwcGVkID0gbWFwcGVyKHQpO1xyXG4gICAgaWYgKG1hcHBlZCA9PT0gZmFsc2UpIHtcclxuICAgICAgLy8gTWFwcGVyIHdhbnRzIHRvIGRlbGV0ZSB0aGlzIGRvYy5cclxuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xyXG4gICAgICByZXR2YWwuc3BsaWNlKGosIDEpO1xyXG4gICAgICAtLWo7IC8vIGNvbXBlbnNhdGUgZm9yICsralxyXG4gICAgfSBlbHNlIGlmIChtYXBwZWQgIT09IHQpIHtcclxuICAgICAgaWYgKHJldHZhbCA9PT0gYSkgcmV0dmFsID0gYS5zbGljZSgpO1xyXG4gICAgICByZXR2YWxbal0gPSBtYXBwZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHJldHVybiByZXR2YWw7XHJcbn1cclxuKi8gXHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImltcG9ydCAqIGFzIEpzb25TY2hlbWEgZnJvbSBcImtlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uXCI7XHJcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsIH0gZnJvbSBcIi4vdXRpbHNcIjtcclxudmFyIENhY2hlQnVzdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENhY2hlQnVzdCgpIHtcclxuICAgIH1cclxuICAgIENhY2hlQnVzdC5nZXRDYWNoZUJ1c3QgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCB1c2VyLCBpbmNsdWRlcykge1xyXG4gICAgICAgIHZhciBpbnZvbHZlZEl0ZW1zID0gQ2FjaGVCdXN0LmdldEludm9sdmVkSXRlbXModGFibGUsIHF1ZXJ5LCBpbmNsdWRlcyk7XHJcbiAgICAgICAgcmV0dXJuIGludm9sdmVkSXRlbXNcclxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjYWNoZS1idXN0LVwiICsgdXNlciArIFwiLVwiICsgaXRlbSk7IH0pXHJcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAhIXZhbHVlOyB9KVxyXG4gICAgICAgICAgICAuam9pbignLycpIHx8ICdzdGF0aWMnO1xyXG4gICAgfTtcclxuICAgIENhY2hlQnVzdC5pbnZhbGlkYXRlQ2FjaGUgPSBmdW5jdGlvbiAocmVxcywgdXNlcikge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBDYWNoZUJ1c3QuZ2V0Q2FjaGVJbnZhbGlkYXRpb25zKHJlcXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgaXRlbSA9IF9hW19pXTtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJjYWNoZS1idXN0LVwiICsgdXNlciArIFwiLVwiICsgaXRlbSwgJycgKyBEYXRlLm5vdygpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ2FjaGVCdXN0LmdldEludm9sdmVkSXRlbXMgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xyXG4gICAgICAgIHZhciBoYXNFZGdlc0Zyb20gPSBxdWVyeS5oYXNFZGdlc0Zyb207XHJcbiAgICAgICAgdmFyIHJlbGF0ZWRUYWJsZXMgPSBpbmNsdWRlc1xyXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gSnNvblNjaGVtYS50YWJsZXNbdGFibGVdLnJlbGF0aW9uc2hpcHNbbGFiZWxdOyB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh0YWJsZSkgeyByZXR1cm4gISF0YWJsZTsgfSk7XHJcbiAgICAgICAgaWYgKGhhc0VkZ2VzRnJvbSlcclxuICAgICAgICAgICAgcmVsYXRlZFRhYmxlcy5wdXNoKFwiaGVmXCIgKyB0YWJsZSk7XHJcbiAgICAgICAgcmV0dXJuIFt0YWJsZSwgJ21hc3RlcicsIHF1ZXJ5LmJyYW5jaElkXS5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuICEheDsgfSkuY29uY2F0KHJlbGF0ZWRUYWJsZXMpLnNvcnQoKTtcclxuICAgIH07XHJcbiAgICBDYWNoZUJ1c3QuZ2V0Q2FjaGVJbnZhbGlkYXRpb25zID0gZnVuY3Rpb24gKHJlcXMpIHtcclxuICAgICAgICB2YXIgaW52YWxpZGF0aW9uU2V0ID0ge307XHJcbiAgICAgICAgcmVxcy5mb3JFYWNoKGZ1bmN0aW9uIChyZXEpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChyZXEub3ApIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2FkZCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdwdXQnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YWJsZV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnbGluayc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICd1bmxpbmsnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAndW5kby1saW5rJzpcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLnNvdXJjZVRhYmxlXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W1wiaGVmLVwiICsgZ2V0VGFibGVGcm9tTGFiZWwocmVxLnNvdXJjZVRhYmxlLCByZXEubGFiZWwpXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjbGVhci1icmFuY2gnOlxyXG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRhdGlvblNldFtyZXEuYnJhbmNoSWRdID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21lcmdlJzpcclxuICAgICAgICAgICAgICAgICAgICBpbnZhbGlkYXRpb25TZXRbcmVxLmJyYW5jaElkXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52YWxpZGF0aW9uU2V0W3JlcS50YXJnZXRCcmFuY2hJZCB8fCBcIm1hc3RlclwiXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoaW52YWxpZGF0aW9uU2V0KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ2FjaGVCdXN0O1xyXG59KCkpO1xyXG5leHBvcnQgeyBDYWNoZUJ1c3QgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2FjaGUtYnVzdC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBtZXJnZURlbHRhcyB9IGZyb20gJy4uL2RlbHRhLW1lcmdlJztcclxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5TXV0YXRpb25zT25EZWx0YXMoYnJhbmNoSWQsIGRlbHRhcywgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB1c2VyRGlzcGxheU5hbWUsIGhhc0FkZGl0aW9uYWxGaWx0ZXIpIHtcclxuICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG0pIHtcclxuICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcclxuICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIEFkZFJlbGF0ZWQgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXNBZGRpdGlvbmFsRmlsdGVyICYmIG0uYnJhbmNoSWQgPT09IGJyYW5jaElkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gW3tcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdhZGQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlSWQ6IG0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRJZDogbS5yZWxhdGVkRG9jLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG0uZ3JhcGhQcm9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVGFibGU6IG0udGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWV0YTogb3B0aW1pc3RpYyA/ICdhZGRpbmcnIDogJ3BlcnNpc3RlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG0ucmVsYXRlZERvYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3I6IHVzZXJEaXNwbGF5TmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjbGVhci1icmFuY2gnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIENsZWFyQnJhbmNoIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gRGVsZXRlIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgdHlwZSBvZiBtdXRhdGlvbiBjYW4gbm90IGJlIHBlcmZvcm1lZCBvbnRvIGJyYW5jaGVzLiBUaGVyZSdzIG5vIGJyYW5jaElkIHByb3BlcnR5IG9uIG0uXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnbWVyZ2UnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIE1lcmdlIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkID09PSBicmFuY2hJZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAobS50YXJnZXRCcmFuY2hJZCA9PT0gYnJhbmNoSWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGNoYW5nZSB3aWxsIGFwcGVuZCBuZXcgZGVsdGFzIHRvIG91ciBkZWx0YXMgYXJyYXkgYnV0IHdlIGRvbid0IGtub3cgd2hhdCB3b3VsZCBjb21lLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIE5lZWQgdG8gcmVmZXRjaCBmcm9tIHNlcnZlci5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBudWxsIH07IC8vIENhbGxlciBzaG91bGQgY2hlY2sgZm9yIG51bGwgYW5kIHJlLWZldGNoIGRhdGEgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAncmVtb3ZlLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZS1SZWxhdGVkIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmIChoYXNBZGRpdGlvbmFsRmlsdGVyIHx8IG0uYnJhbmNoSWQgIT09IGJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XHJcbiAgICAgICAgICAgICAgICBkZWx0YXMgPSBbe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVtb3ZlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlSWQ6IG0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldElkOiBtLnJlbGF0ZWREb2MuaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG0ucmVsYXRlZERvYy5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogbS5ncmFwaFByb3AsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRhYmxlOiBtLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcjogdXNlckRpc3BsYXlOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogRGF0ZS5ub3coKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJG1ldGE6IG9wdGltaXN0aWMgPyAnYWRkaW5nJyA6ICdwZXJzaXN0ZWQnXHJcbiAgICAgICAgICAgICAgICAgICAgfV0uY29uY2F0KGRlbHRhcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAndW5kby1saW5rJzpcclxuICAgICAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgICAgICAvLyBVbmRvLUxpbmsgUmVwb011dGF0aW9uXHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgaWYgKG0uYnJhbmNoSWQgIT09IGJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcImNvbnRpbnVlXCI7XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IGRlbHRhcy5maW5kSW5kZXgoZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChkLnR5cGUgPT09ICdhZGQnIHx8IGQudHlwZSA9PT0gJ3JlbW92ZScgfHwgZC50eXBlID09PSAndW5kby1saW5rJykgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuc291cmNlSWQgPT09IG0uaWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQudGFyZ2V0SWQgPT09IG0ucmVsYXRlZElkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHggPCAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIFwiYWRkXCIgb3IgXCJyZW1vdmVcIiBkZWx0YSB0byBjaGFuZ2U6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wdGltaXN0aWMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhUmVsYXRpb24gPSBkZWx0YXNbaWR4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayB0aGUgZXhpc3RpbmcgYWRkL3JlbW92ZSBkZWx0YSBhcyBjdXJyZW5sdHkgYmVpbmcgZGVsZXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWx0YXMgPSBkZWx0YXMuc2xpY2UoMCwgaWR4KS5jb25jYXQoW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHNsaWJfMS5fX2Fzc2lnbih7fSwgZGVsdGFSZWxhdGlvbiwgeyAkbWV0YTogb3B0aW1pc3RpYyA/ICdyZW1vdmluZycgOiAncGVyc2lzdGVkJyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdLCBkZWx0YXMuc2xpY2UoaWR4ICsgMSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUGVyc2lzdGVkLiBKdXN0IHJlbW92ZSBpdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gZGVsdGFzLnNsaWNlKDAsIGlkeCkuY29uY2F0KGRlbHRhcy5zbGljZShpZHggKyAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAvL1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIFJlcG9NdXRhdGlvblxyXG4gICAgICAgICAgICAgICAgLy9cclxuICAgICAgICAgICAgICAgIGlmIChtLmJyYW5jaElkICE9PSBicmFuY2hJZClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSBkZWx0YXMuZmluZEluZGV4KGZ1bmN0aW9uIChkZWx0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGVsdGEudHlwZSA9PT0gJ21vZGlmeScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhLnRhcmdldElkID09PSBtLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHggPCAwICYmICFoYXNBZGRpdGlvbmFsRmlsdGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IFt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21vZGlmeScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG0udGFibGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TmFtZTogbS50YXJnZXROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG0uZGVsdGFEb2MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJpYnV0b3JzOiBbdXNlckRpc3BsYXlOYW1lXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWV0YTogb3B0aW1pc3RpYyA/ICdhZGRpbmcnIDogJ3BlcnNpc3RlZCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XS5jb25jYXQoZGVsdGFzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0RlbHRhRG9jID0gZGVsdGFzW2lkeF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250cmlidXRvcnMgPSBleGlzdGluZ0RlbHRhRG9jLmNvbnRyaWJ1dG9ycy5zbGljZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbnRyaWJ1dG9ycy5pbmNsdWRlcyh1c2VyRGlzcGxheU5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cmlidXRvcnMucHVzaCh1c2VyRGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdEYXRhID0gbWVyZ2VEZWx0YXMoZXhpc3RpbmdEZWx0YURvYy5kYXRhLCBtLmRlbHRhRG9jLCB7IHJlbW92ZVVuc2V0UHJvcHM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYyAmJiBPYmplY3Qua2V5cyhuZXdEYXRhKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1pdHRlZCBtdXRhdGlvbiB0aGF0IHJlc2V0cyBhIGRlbHRhRG9jLiBSZW1vdmUgdGhlIGRlbHRhRG9jIGVudGlyZWx5OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsdGFzID0gZGVsdGFzLnNsaWNlKDAsIGlkeCkuY29uY2F0KGRlbHRhcy5zbGljZShpZHggKyAxKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbHRhcyA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdtb2RpZnknLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZTogbS50YWJsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG0uaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWU6IG0udGFyZ2V0TmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbmV3RGF0YSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IERhdGUubm93KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyaWJ1dG9yczogY29udHJpYnV0b3JzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWV0YTogb3B0aW1pc3RpYyA/ICd1cGRhdGluZycgOiAncGVyc2lzdGVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmNvbmNhdChkZWx0YXMuc2xpY2UoMCwgaWR4KSwgZGVsdGFzLnNsaWNlKGlkeCArIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIG11dGF0aW9uc18xID0gbXV0YXRpb25zOyBfaSA8IG11dGF0aW9uc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBtID0gbXV0YXRpb25zXzFbX2ldO1xyXG4gICAgICAgIHZhciBzdGF0ZV8xID0gX2xvb3BfMShtKTtcclxuICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZV8xLnZhbHVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlbHRhcztcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBseS1tdXRhdGlvbnMtb24tZGVsdGFzLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEh0dHBFcnJvciB9IGZyb20gJy4uLy4uL2tlZC1iYWNrZW5kLWNsaWVudCc7XHJcbmltcG9ydCB7IGFwcGx5TXV0YXRpb25zT25EZWx0YXMgfSBmcm9tICcuL2FwcGx5LW11dGF0aW9ucy1vbi1kZWx0YXMnO1xyXG52YXIgRGVsdGFDYWNoZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERlbHRhQ2FjaGUoZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUpIHtcclxuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcclxuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHRoaXMubG9va3VwID0ge307XHJcbiAgICB9XHJcbiAgICBEZWx0YUNhY2hlLnByb3RvdHlwZS5hcHBseU11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIF9hKSB7XHJcbiAgICAgICAgdmFyIG9wdGltaXN0aWMgPSAoX2EgPT09IHZvaWQgMCA/IHsgb3B0aW1pc3RpYzogZmFsc2UgfSA6IF9hKS5vcHRpbWlzdGljO1xyXG4gICAgICAgIC8vIEFwcGx5IG11dGF0aW9ucyBsb2NhbGx5IG9udG8gdGhlIERlbHRhQ2FjaGUgYW5kIG5vdGlmeSB0aGVpciBzdWJzY3JpYmVyc1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2IgPSBPYmplY3Qua2V5cyh0aGlzLmxvb2t1cCk7IF9pIDwgX2IubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeUtleSA9IF9iW19pXTtcclxuICAgICAgICAgICAgdmFyIGNhY2hlRW50cnkgPSB0aGlzLmxvb2t1cFtxdWVyeUtleV07XHJcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJbnN0ZWFkIGhlcmU6IFN0b3JlIHRoZSBtdXRhdGlvbnMgb24gY2FjaGVFbnRyeS4gTm8gbWF0dGVyIGlmIGl0IHlldCBoYXMgdmFsdWUgb3Igbm90LlxyXG4gICAgICAgICAgICAgICAgLy8gVGhlbiBhcHBseSBtdXRhdGlvbiB3aGVuZXZlciBzdWJzY3JpYmluZyEgKEJldHRlciBoYW5kbGluZyBvZiBtdXRhdGlvbnMgdGhhdCBhcnJpdmVzIGJlZm9yZSBmZXRjaCgpIGlzIGRvbmUpXHJcbiAgICAgICAgICAgICAgICAvLyAoU2VlIGhvdyBJIGhhbmRsZSB0aGlzIGluIHF1ZXJ5LXNldC50cylcclxuICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IGFwcGx5TXV0YXRpb25zT25EZWx0YXMoY2FjaGVFbnRyeS5xdWVyeS5icmFuY2hJZCwgY2FjaGVFbnRyeS52YWx1ZSwgbXV0YXRpb25zLCBvcHRpbWlzdGljLCB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSgpLCAhIWNhY2hlRW50cnkucXVlcnkudGFncyk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VmFsdWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgbXV0YXRpb24gcmVxdWlyZXMgY2FjaGVFbnRyeSB0byBiZSByZWZldGNoZWQgZnJvbSBzZXJ2ZXJcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW9wdGltaXN0aWMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FsbGVyIGhhcyBzdWNjZXNzZnVsbHkgcGVyZm9ybWVkIHRoZSBtdXRhdGlvbnMgYW5kIGdvdCBzdWNjZXNzIGJhY2sgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0J3Mgb2sgdG8gcmVmZXRjaCB0aGUgZGVsdGFzIGZyb20gc2VydmVyIG5vdzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS5mZXRjaCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZnRlciBmZXRjaCBjb21wbGV0ZXMsIGl0IHdpbGwgbm90aWZ5IHRoZSBzdWJzY3JpYmVycy5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobmV3VmFsdWUgIT09IGNhY2hlRW50cnkudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZUVudHJ5Lm9wdGltaXN0aWNWYWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghb3B0aW1pc3RpYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVFbnRyeS52YWx1ZSA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkubm90aWZ5KG5ld1ZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBEZWx0YUNhY2hlLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbiAocXVlcnksIG9ic2VydmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY2FjaGVFbnRyeSA9IHRoaXMubG9va3VwW3F1ZXJ5LmJyYW5jaElkICsgcXVlcnkudGFnc107XHJcbiAgICAgICAgaWYgKCFjYWNoZUVudHJ5KSB7XHJcbiAgICAgICAgICAgIGNhY2hlRW50cnkgPSBuZXcgRGVsdGFDYWNoZUVudHJ5KHRoaXMuZ2V0Q2xpZW50KCksIHF1ZXJ5KTtcclxuICAgICAgICAgICAgdGhpcy5sb29rdXBbcXVlcnkuYnJhbmNoSWQgKyBxdWVyeS50YWdzXSA9IGNhY2hlRW50cnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjYWNoZUVudHJ5LmNsZWFudXBUaW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQoY2FjaGVFbnRyeS5jbGVhbnVwVGltZXIpO1xyXG4gICAgICAgICAgICBjYWNoZUVudHJ5LmNsZWFudXBUaW1lciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB7XHJcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjYWNoZUVudHJ5LnN1YnNjcmliZXJzID0gY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBfYS5vYnNlcnZlcjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbyAhPT0gb2JzZXJ2ZXI7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlRW50cnkuY2xlYW51cFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LnN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzLmxvb2t1cFtxdWVyeS5icmFuY2hJZCArIHF1ZXJ5LnRhZ3NdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2FjaGVFbnRyeS5zdWJzY3JpYmVycy5wdXNoKHsgb2JzZXJ2ZXI6IG9ic2VydmVyLCBzdWJzY3JpcHRpb246IHN1YnNjcmlwdGlvbiB9KTtcclxuICAgICAgICBpZiAoY2FjaGVFbnRyeS52YWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBWYWx1ZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgcmV0cmlldmVkIGFscmVhZHkuIFBpY2sgZnJvbSBjYWNoZS5cclxuICAgICAgICAgICAgb2JzZXJ2ZXIoY2FjaGVFbnRyeS5vcHRpbWlzdGljVmFsdWUgfHwgY2FjaGVFbnRyeS52YWx1ZSwgbnVsbCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2FjaGVFbnRyeS5pc0ZldGNoaW5nKSB7XHJcbiAgICAgICAgICAgIC8vIEEgdmFsdWUgaXMgb24gaXRzIHdheS4gU2l0IGJhY2sgYW5kIHJlbGF4LiBBbGwgcmVnaXN0ZXJlZFxyXG4gICAgICAgICAgICAvLyBvYnNlcnZlcnMgKGluY2x1ZGluZyB0aGlzIG9uZSkgd2lsbCBiZSBub3RpZmllZCB3aGVuIGRhdGEgYXJyaXZlc1xyXG4gICAgICAgICAgICAvLyBvciBmYWlscy5cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2FjaGVFbnRyeS5lcnJvcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlcihudWxsLCBjYWNoZUVudHJ5LmVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY2FjaGVFbnRyeS5mZXRjaCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEZWx0YUNhY2hlO1xyXG59KCkpO1xyXG5leHBvcnQgeyBEZWx0YUNhY2hlIH07XHJcbnZhciBEZWx0YUNhY2hlRW50cnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBEZWx0YUNhY2hlRW50cnkoY2xpZW50LCBxdWVyeSkge1xyXG4gICAgICAgIHRoaXMuZmV0Y2hPcGVyYXRpb25JZCA9IDA7IC8vIE1ha2VzIHN1cmUgYSByZS1mZXRjaCB3aWxsIGRpc2NhcmQgdGhlIHJlc3VsdCBmcm9tIGFueSBvbmdvaW5nIGZldGNoLlxyXG4gICAgICAgIHRoaXMuY2xpZW50ID0gY2xpZW50O1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9wdGltaXN0aWNWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2xlYW51cFRpbWVyID0gbnVsbDtcclxuICAgIH1cclxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgZmV0Y2hPcGVyYXRpb25JZCA9ICsrdGhpcy5mZXRjaE9wZXJhdGlvbklkO1xyXG4gICAgICAgIHRoaXMuaXNGZXRjaGluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5mZXRjaEZyb21TZXJ2ZXIoKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAvLyBTdWNjZXNzXHJcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pc0ZldGNoaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBiLmRhdGVUaW1lIC0gYS5kYXRlVGltZTsgfSk7IC8vIExhdGVzdCBmaXJzdFxyXG4gICAgICAgICAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIF90aGlzLm9wdGltaXN0aWNWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMubm90aWZ5KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAvLyBGYWlsXHJcbiAgICAgICAgICAgIGlmIChmZXRjaE9wZXJhdGlvbklkID09PSBfdGhpcy5mZXRjaE9wZXJhdGlvbklkKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5pc0ZldGNoaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5lcnJvciA9IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZmFpbChlcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEZWx0YUNhY2hlRW50cnkucHJvdG90eXBlLmZldGNoRnJvbVNlcnZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlcywgX2EsIF9iO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2MpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5xdWVyeS5icmFuY2hJZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGVsdGFzIG9ubHkgYXZhaWxhYmxlIG9uIGJyYW5jaGVzJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuY2xpZW50Lmh0dHAuZ2V0KCdkZWx0YXMnLCB0aGlzLnF1ZXJ5KV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMgPSBfYy5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHJlcy5zdGF0dXMgPj0gMzAwIHx8IHJlcy5zdGF0dXMgPCAyMDApKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSBIdHRwRXJyb3IuYmluZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2IgPSBbdm9pZCAwLCByZXMuc3RhdHVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcmVzLnRleHQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOiB0aHJvdyBuZXcgKF9hLmFwcGx5KEh0dHBFcnJvciwgX2IuY29uY2F0KFtfYy5zZW50KCldKSkpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzQgLyp5aWVsZCovLCByZXMuanNvbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6IHJldHVybiBbMiAvKnJldHVybiovLCBfYy5zZW50KCldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBEZWx0YUNhY2hlRW50cnkucHJvdG90eXBlLm5vdGlmeSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLnN1YnNjcmliZXJzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgX2IgPSBfYVtfaV0sIG9ic2VydmVyID0gX2Iub2JzZXJ2ZXIsIHN1YnNjcmlwdGlvbiA9IF9iLnN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIG51bGwsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIERlbHRhQ2FjaGVFbnRyeS5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIHZhciBjb3B5ID0gdGhpcy5zdWJzY3JpYmVycy5zbGljZSgpO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGNvcHlfMSA9IGNvcHk7IF9pIDwgY29weV8xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgX2EgPSBjb3B5XzFbX2ldLCBvYnNlcnZlciA9IF9hLm9ic2VydmVyLCBzdWJzY3JpcHRpb24gPSBfYS5zdWJzY3JpcHRpb247XHJcbiAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVsdGFDYWNoZUVudHJ5O1xyXG59KCkpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kZWx0YS1jYWNoZS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vLi4vb2JzZXJ2YWJsZSc7XHJcbnZhciBEZWx0YUNvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhEZWx0YUNvbGxlY3Rpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBEZWx0YUNvbGxlY3Rpb24oZGVsdGFDYWNoZSwgcXVlcnkpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLmRlbHRhQ2FjaGUuc3Vic2NyaWJlKHF1ZXJ5LCBvYnNlcnZlcik7IH0pIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuZGVsdGFDYWNoZSA9IGRlbHRhQ2FjaGU7XHJcbiAgICAgICAgX3RoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBEZWx0YUNvbGxlY3Rpb24ucHJvdG90eXBlLnRhZ3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRhZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB0YWdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgRGVsdGFDb2xsZWN0aW9uKHRoaXMuZGVsdGFDYWNoZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSwgeyB0YWdzOiB0YWdzIH0pKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVsdGFDb2xsZWN0aW9uO1xyXG59KENvbGxlY3Rpb24pKTtcclxuZXhwb3J0IHsgRGVsdGFDb2xsZWN0aW9uIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlbHRhLWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RGVsdGEoZG9jLCBkZWx0YSkge1xyXG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkZWx0YSk7XHJcbiAgICB2YXIgdGFyZ2V0RG9jID0gZG9jO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga2V5ID0ga2V5c18xW19pXTtcclxuICAgICAgICBpZiAodGFyZ2V0RG9jID09PSBkb2MpXHJcbiAgICAgICAgICAgIHRhcmdldERvYyA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRvYyk7XHJcbiAgICAgICAgdmFyIHZhbCA9IGRlbHRhW2tleV07XHJcbiAgICAgICAgaWYgKHZhbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICB2YXIgbWV0YUluc3RydWN0aW9ucyA9IE9iamVjdC5rZXlzKHZhbClcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4ga2V5LnN0YXJ0c1dpdGgoJyQnKTsgfSk7XHJcbiAgICAgICAgICAgIGlmIChtZXRhSW5zdHJ1Y3Rpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKG1pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pVmFsdWUgPSB2YWxbbWldO1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobWkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiR1bnNldFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEbyBub3RoaW5nIG9uIHRhcmdldCBkb2MhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREb2MuJHdhc1Vuc2V0ID0gdHJ1ZTsgLy8gSnVzdCBtYXJrIGl0IGZvciByZS1yZXRyaWV2YWwgYWZ0ZXIgc3VjY2Vzc2Z1bCBwb3N0aW5nIGNoYW5nZXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJGFkZFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGQgPSBtaVZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvQWRkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIiRhZGQgaW5zdHJ1Y3Rpb24gbXVzdCBjb250YWluIGFycmF5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFycmF5ID0gdGFyZ2V0RG9jW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodGFyZ2V0QXJyYXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5ID0gdGFyZ2V0QXJyYXkuc2xpY2UoKTsgLy8gT24gSlMgc2lkZSwgd2UgbXVzdCBiZSBpbW11dGFibGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldERvY1trZXldID0gdGFyZ2V0QXJyYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHZhbHVlc1RvQWRkXzEgPSB2YWx1ZXNUb0FkZDsgX2kgPCB2YWx1ZXNUb0FkZF8xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ID0gdmFsdWVzVG9BZGRfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRBcnJheS5pbmNsdWRlcyh2KSkgeyAvLyBhdm9pZCBkdXBzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFycmF5LnB1c2godik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIiRyZW1vdmVcIjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlc1RvUmVtb3ZlXzEgPSBtaVZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlc1RvUmVtb3ZlXzEpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJHJlbW92ZSBpbnN0cnVjdGlvbiBtdXN0IGNvbnRhaW4gYXJyYXlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QXJyYXkgPSB0YXJnZXREb2Nba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0YXJnZXRBcnJheSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RG9jW2tleV0gPSB0YXJnZXRBcnJheS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsgcmV0dXJuICF2YWx1ZXNUb1JlbW92ZV8xLmluY2x1ZGVzKHQpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgbWV0YUluc3RydWN0aW9uc18xID0gbWV0YUluc3RydWN0aW9uczsgX2EgPCBtZXRhSW5zdHJ1Y3Rpb25zXzEubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pID0gbWV0YUluc3RydWN0aW9uc18xW19hXTtcclxuICAgICAgICAgICAgICAgICAgICBfbG9vcF8xKG1pKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRhcmdldERvY1trZXldID0gdmFsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldERvYztcclxufVxyXG4vLyB7bmFtZTogXCJVbGxhXCJ9LCB7bmFtZTogeyR1bnNldDowfVxyXG4vLyB7dGFnczogeyRhZGQ6IFwiaGVqXCJ9fSwge3RhZ3M6IHskdW5zZXQ6MH1cIn1cclxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlRGVsdGFzKGRlbHRhMSwgZGVsdGEyLCBfYSkge1xyXG4gICAgdmFyIHJlbW92ZVVuc2V0UHJvcHMgPSAoX2EgPT09IHZvaWQgMCA/IHsgcmVtb3ZlVW5zZXRQcm9wczogZmFsc2UgfSA6IF9hKS5yZW1vdmVVbnNldFByb3BzO1xyXG4gICAgLy9yZXR1cm4gey4uLmRlbHRhMSwgLi4uZGVsdGEyfTtcclxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGVsdGEyKTtcclxuICAgIHZhciB0YXJnZXREZWx0YSA9IHRzbGliXzEuX19hc3NpZ24oe30sIGRlbHRhMSk7XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMiA9IGtleXM7IF9pIDwga2V5c18yLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBrZXkgPSBrZXlzXzJbX2ldO1xyXG4gICAgICAgIHZhciB2YWwgPSBkZWx0YTJba2V5XTtcclxuICAgICAgICBpZiAodmFsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhSW5zdHJ1Y3Rpb25zID0gT2JqZWN0LmtleXModmFsKVxyXG4gICAgICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBrZXkuc3RhcnRzV2l0aCgnJCcpOyB9KTtcclxuICAgICAgICAgICAgaWYgKG1ldGFJbnN0cnVjdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9sb29wXzIgPSBmdW5jdGlvbiAobWkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWlWYWx1ZSA9IHZhbFttaV07XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChtaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHVuc2V0XCI6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1vdmVVbnNldFByb3BzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldERlbHRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBObyBtYXR0ZXIgaWYgdGFyZ2V0RGVsdGEgaXMgZW1wdHkgb3IgaGFzIHZhbHVlLiBTZXQgaXQgdG8geyR1bnNldDowfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvIG1ha2Ugc3VyZSB0aGUgdmVyeSBlbmQgcmVzdWx0IHdpbGwgaGF2ZSB7JHVuc2V0OjB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0RGVsdGFba2V5XSA9IHsgJHVuc2V0OiAwIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJGFkZFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9BZGRfMiA9IG1pVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9BZGRfMikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkYWRkIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldERlbHRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldE1ldGFQcm9wID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGFyZ2V0TWV0YVByb3ApIDoge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCwganVzdCBjaGVjayBpZiB0YXJnZXQgbWV0YVByb3AgaGFzIHskcmVtb3ZlOiBbLi4uaXRlbXNdfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHJlbW92ZSBhbnkgZXF1YWwgaXRlbXMgZnJvbSB0aGVyZSBiZWZvcmUgbWVyZ2luZyB0aGUgeyRhZGQ6IFsuLi5dfSBhcnJheXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UmVtb3ZlQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFyZ2V0UmVtb3ZlQXJyYXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJHJlbW92ZSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvQWRkXzIuaW5jbHVkZXModCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiAkcmVtb3ZlIGFycmF5IGJlY2FtZSBlbXRweS4gUmVtb3ZlIHRoZSAkcmVtb3ZlIHByb3AuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkYWRkIGFycmF5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJGFkZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFkZEFycmF5ID0gdGFyZ2V0QWRkQXJyYXkgPyB0YXJnZXRBZGRBcnJheS5jb25jYXQodmFsdWVzVG9BZGRfMikgOiB2YWx1ZXNUb0FkZF8yLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kYWRkID0gdGFyZ2V0QWRkQXJyYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiJHJlbW92ZVwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVzVG9SZW1vdmVfMiA9IG1pVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWVzVG9SZW1vdmVfMikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIkcmVtb3ZlIGluc3RydWN0aW9uIG11c3QgY29udGFpbiBhcnJheVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldERlbHRhW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcCA9IHRhcmdldE1ldGFQcm9wID8gdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGFyZ2V0TWV0YVByb3ApIDoge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdGFyZ2V0TWV0YVByb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCwganVzdCBjaGVjayBpZiB0YXJnZXQgbWV0YVByb3AgaGFzIHskYWRkOiBbLi4uaXRlbXNdfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgc28sIHJlbW92ZSBhbnkgZXF1YWwgaXRlbXMgZnJvbSB0aGVyZSBiZWZvcmUgbWVyZ2luZyB0aGUgeyRyZW1vdmU6IFsuLi5dfSBhcnJheXMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0QWRkQXJyYXkgPSB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGFyZ2V0QWRkQXJyYXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0TWV0YVByb3AuJGFkZCA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEFkZEFycmF5LmZpbHRlcihmdW5jdGlvbiAodCkgeyByZXR1cm4gIXZhbHVlc1RvUmVtb3ZlXzIuaW5jbHVkZXModCk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRNZXRhUHJvcC4kYWRkLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiAkYWRkIGFycmF5IGJlY2FtZSBlbXRweS4gUmVtb3ZlIHRoZSAkYWRkIHByb3AuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXRNZXRhUHJvcC4kYWRkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdyBpdCdzIHRpbWUgdG8gbWVyZ2Ugb3IgY3JlYXRlIHRhcmdldCAkcmVtb3ZlIGFycmF5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldFJlbW92ZUFycmF5ID0gdGFyZ2V0TWV0YVByb3AuJHJlbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldFJlbW92ZUFycmF5ID0gdGFyZ2V0UmVtb3ZlQXJyYXkgPyB0YXJnZXRSZW1vdmVBcnJheS5jb25jYXQodmFsdWVzVG9SZW1vdmVfMikgOiB2YWx1ZXNUb1JlbW92ZV8yLnNsaWNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRNZXRhUHJvcC4kcmVtb3ZlID0gdGFyZ2V0UmVtb3ZlQXJyYXk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IDAsIG1ldGFJbnN0cnVjdGlvbnNfMiA9IG1ldGFJbnN0cnVjdGlvbnM7IF9iIDwgbWV0YUluc3RydWN0aW9uc18yLmxlbmd0aDsgX2IrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IG1ldGFJbnN0cnVjdGlvbnNfMltfYl07XHJcbiAgICAgICAgICAgICAgICAgICAgX2xvb3BfMihtaSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YXJnZXREZWx0YVtrZXldID0gdmFsO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRhcmdldERlbHRhO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlbHRhLW1lcmdlLmpzLm1hcCIsImV4cG9ydCAqIGZyb20gJy4va2VkYmFja2VuZC1jb2xsZWN0aW9uJztcclxuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXF1ZXJ5JztcclxuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXJlcG8nO1xyXG5leHBvcnQgKiBmcm9tICcuL2tlZGJhY2tlbmQtc3Vic2NyaXB0aW9uJztcclxuZXhwb3J0ICogZnJvbSAnLi9rZWRiYWNrZW5kLXdyaXRlcic7XHJcbmV4cG9ydCAqIGZyb20gJy4vbXV0YXRpb24tcXVldWUnO1xyXG5leHBvcnQgKiBmcm9tICcuL3F1ZXJ5LXNldCc7XHJcbmV4cG9ydCAqIGZyb20gJy4uL29ic2VydmFibGUvbWl4aW4nO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBCYXRjaFJ1bm5lciB9IGZyb20gJy4uL2tlZC1iYWNrZW5kLWNsaWVudCc7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9rZWRiYWNrZW5kLXN1YnNjcmlwdGlvblwiO1xyXG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfSBmcm9tICcuL2tlZGJhY2tlbmQtcXVlcnknO1xyXG5pbXBvcnQgeyBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZS9jb2xsZWN0aW9uJztcclxuLyoqXHJcbiAqIFJlcHJlc2VudHMgYSBcImxpdmVcIiBxdWVyeSBhZ2FpbnN0IGEgdGFibGUgb3IgZmlsdGVyZWQgdGFibGUuXHJcbiAqL1xyXG52YXIgS2VkQmFja2VuZENvbGxlY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhLZWRCYWNrZW5kQ29sbGVjdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRDb2xsZWN0aW9uKHJlcG8sIHRhYmxlLCBxdWVyeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IEtlZEJhY2tlbmRTdWJzY3JpcHRpb24ob2JzZXJ2ZXIsIF90aGlzKTtcclxuICAgICAgICAgICAgX3RoaXMucmVwby5xdWVyeVNldC5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcclxuICAgICAgICB9KSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnJlcG8gPSByZXBvO1xyXG4gICAgICAgIF90aGlzLnRhYmxlID0gdGFibGU7XHJcbiAgICAgICAgX3RoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLCBcInF1ZXJ5S2V5XCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEtlZEJhY2tlbmRRdWVyeS5xdWVyeUtleSh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUsIFwiaW5jbHVkZXNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5jbHVkZXMgfHwgKHRoaXMuX2luY2x1ZGVzID0gW10uY29uY2F0KHRoaXMucXVlcnkuaW5jbHVkZSB8fCBbXSkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmFwcGx5UXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKHRoaXMucmVwbywgdGhpcy50YWJsZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSwgcXVlcnkpKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkVG9RdWVyeUFycmF5UHJvcCA9IGZ1bmN0aW9uIChhcnJheVByb3AsIGVudHJpZXMpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSgoX2EgPSB7fSwgX2FbYXJyYXlQcm9wXSA9ICh0aGlzLnF1ZXJ5W2FycmF5UHJvcF0gfHwgW10pLmNvbmNhdChlbnRyaWVzKSwgX2EpKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYWRkRmxhZ3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGZsYWdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgZmxhZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImZsYWdzXCIsIGZsYWdzKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGRlYnVnOiB0cnVlIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pZHNPbmx5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzT25seVwiKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaWRzQW5kTmFtZXNPbmx5XCIpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzT25seSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZGRGbGFncyhcImluY2x1ZGVJZHNPbmx5XCIpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlSWRzQW5kTmFtZXNPbmx5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFkZEZsYWdzKFwiaW5jbHVkZUlkc0FuZE5hbWVzT25seVwiKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYmV0d2VlbiA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBmcm9tOiBmcm9tLCB0bzogdG8gfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJvbGUgPSBmdW5jdGlvbiAocm9sZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyByb2xlOiByb2xlIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5oYXNFZGdlc0Zyb20gPSBmdW5jdGlvbiAoaWRzLCBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGlkIGxpc3QgZ2l2ZW4gdG8gQ29sbGVjdGlvbi5oYXNFZGdlc0Zyb20oXCIgKyBKU09OLnN0cmluZ2lmeShpZHMpICsgXCIpXCIpO1xyXG4gICAgICAgIHZhciBoZWYgPSB0aGlzLmFkZFRvUXVlcnlBcnJheVByb3AoXCJoYXNFZGdlc0Zyb21cIiwgaWRzKTtcclxuICAgICAgICByZXR1cm4gb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGVEZWx0YUVkZ2VzID9cclxuICAgICAgICAgICAgaGVmLmFkZEZsYWdzKFwiaW5jbHVkZURlbHRhRWRnZXNcIikgOlxyXG4gICAgICAgICAgICBoZWY7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmhhc0VkZ2VzVG8gPSBmdW5jdGlvbiAoaWRzLCBvcHRpb25zKSB7XHJcbiAgICAgICAgaWYgKGlkcy5sZW5ndGggPT09IDAgfHwgaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAhaWQ7IH0pKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGlkIGxpc3QgZ2l2ZW4gdG8gQ29sbGVjdGlvbi5oYXNFZGdlc1RvKFwiICsgSlNPTi5zdHJpbmdpZnkoaWRzKSArIFwiKVwiKTtcclxuICAgICAgICB2YXIgaGV0ID0gdGhpcy5hZGRUb1F1ZXJ5QXJyYXlQcm9wKFwiaGFzRWRnZXNUb1wiLCBpZHMpO1xyXG4gICAgICAgIHJldHVybiBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZURlbHRhRWRnZXMgP1xyXG4gICAgICAgICAgICBoZXQuYWRkRmxhZ3MoXCJpbmNsdWRlRGVsdGFFZGdlc1wiKSA6XHJcbiAgICAgICAgICAgIGhldDtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuaWQgPSBmdW5jdGlvbiAoaWQpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBpZHM6IFtpZF0gfSkuc2luZ2xlKHtcclxuICAgICAgICAgICAgb25aZXJvOiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBmaW5kIGVudGl0eSBpbiBcIiArIF90aGlzLnRhYmxlICsgXCIgd2l0aCBpZCBcIiArIGlkKTsgfSxcclxuICAgICAgICAgICAgb25NYW55OiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIk11bHRpcGxlIGVudHJpZXMgaW4gXCIgKyBfdGhpcy50YWJsZSArIFwiIHdpdGggaWQgXCIgKyBpZCk7IH0sXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLmlkcyA9IGZ1bmN0aW9uIChpZHMpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgaWRzOiBpZHMgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLm5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBuYW1lOiBuYW1lIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS50YWdzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0YWdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdGFnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgdGFnczogdGFncyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuYnJhbmNoSWQgPSBmdW5jdGlvbiAoYnJhbmNoSWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcHBseVF1ZXJ5KHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5pbmNsdWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBncmFwaHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBncmFwaHNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkVG9RdWVyeUFycmF5UHJvcChcImluY2x1ZGVcIiwgZ3JhcGhzKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuY2FjaGVPcHRpbWl6ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlRdWVyeSh7IGNhY2hlQnVzdDogQ2FjaGVCdXN0LmdldENhY2hlQnVzdCh0aGlzLnRhYmxlLCB0aGlzLnF1ZXJ5LCB0aGlzLnJlcG8uZ2V0VXNlcigpLCB0aGlzLmluY2x1ZGVzKSB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUubXV0YXRpb25zT25FbXB0eSA9IGZ1bmN0aW9uIChtdXRhdGlvbkZhY3RvcnkpIHtcclxuICAgICAgICB2YXIgdHggPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgICAgICBtdXRhdGlvbkZhY3RvcnkodHgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFwcGx5UXVlcnkoeyBtdXRhdGlvbnNPbkVtcHR5OiB0eC5tdXRhdGlvblJlcXVlc3RzIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5zaW5nbGUgPSBmdW5jdGlvbiAodGhyb3dlcnMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBfYSA9IHRocm93ZXJzIHx8IHt9LCBvblplcm8gPSBfYS5vblplcm8sIG9uTWFueSA9IF9hLm9uTWFueTtcclxuICAgICAgICByZXR1cm4gdGhpcy50b1ZhbHVlKCkubWFwKGZ1bmN0aW9uIChpdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob25aZXJvKVxyXG4gICAgICAgICAgICAgICAgICAgIG9uWmVybygpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBub25lIHdhcyBmb3VuZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIGRlYnVnZ2VyO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9uTWFueSlcclxuICAgICAgICAgICAgICAgICAgICBvbk1hbnkoKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNpbmdsZSBpdGVtIG9mIFwiICsgX3RoaXMudGFibGUgKyBcIiBleHBlY3RlZCB0byBiZSByZXR1cm5lZCBieSBxdWVyeSBcIiArIEpTT04uc3RyaW5naWZ5KF90aGlzLnF1ZXJ5KSArIFwiIGJ1dCBcIiArIGl0ZW1zLmxlbmd0aCArIFwiIHdhcyBmb3VuZC5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zWzBdO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qY29tYmluZUxhdGVzdDxUT3RoZXI+KG90aGVyOiBRdWVyeU9ic2VydmFibGU8VE90aGVyPikge1xyXG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXIoeCA9PiB4KS5jb21iaW5lTGF0ZXN0KG90aGVyKTtcclxuICAgIH0qL1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIChkb2MsIGNoYW5nZXMsIGRlYm91bmNlKSB7XHJcbiAgICAgICAgaWYgKGRlYm91bmNlID09PSB2b2lkIDApIHsgZGVib3VuY2UgPSAxMDAwOyB9XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAndXBkYXRlJyxcclxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgICAgICAgICAgZGVsdGFEb2M6IGNoYW5nZXMsXHJcbiAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBkb2MubmFtZVxyXG4gICAgICAgICAgICB9XSwgZGVib3VuY2UpO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRDb2xsZWN0aW9uLnByb3RvdHlwZS5hZGRSZWxhdGVkID0gZnVuY3Rpb24gKGlkLCBsYWJlbCwgcmVsYXRlZERvYykge1xyXG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XHJcbiAgICAgICAgICAgICAgICBvcDogJ2FkZC1yZWxhdGVkJyxcclxuICAgICAgICAgICAgICAgIHRhYmxlOiB0aGlzLnRhYmxlLFxyXG4gICAgICAgICAgICAgICAgYnJhbmNoSWQ6IHRoaXMucXVlcnkuYnJhbmNoSWQsXHJcbiAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICBncmFwaFByb3A6IGxhYmVsLFxyXG4gICAgICAgICAgICAgICAgcmVsYXRlZERvYzogcmVsYXRlZERvY1xyXG4gICAgICAgICAgICB9XSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnJlbW92ZVJlbGF0ZWQgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkRG9jKSB7XHJcbiAgICAgICAgdGhpcy5yZXBvLndyaXRlci5tdXRhdGUoW3tcclxuICAgICAgICAgICAgICAgIG9wOiAncmVtb3ZlLXJlbGF0ZWQnLFxyXG4gICAgICAgICAgICAgICAgdGFibGU6IHRoaXMudGFibGUsXHJcbiAgICAgICAgICAgICAgICBicmFuY2hJZDogdGhpcy5xdWVyeS5icmFuY2hJZCxcclxuICAgICAgICAgICAgICAgIGlkOiBpZCxcclxuICAgICAgICAgICAgICAgIGdyYXBoUHJvcDogbGFiZWwsXHJcbiAgICAgICAgICAgICAgICByZWxhdGVkRG9jOiByZWxhdGVkRG9jXHJcbiAgICAgICAgICAgIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUudW5kb0xpbmsgPSBmdW5jdGlvbiAoaWQsIGxhYmVsLCByZWxhdGVkSWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMucXVlcnkuYnJhbmNoSWQpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVuZG8gbGlua3MgY2FuIG9ubHkgYmUgcGVyZm9ybWVkIG9uIGJyYW5jaGVzXCIpO1xyXG4gICAgICAgIHRoaXMucmVwby53cml0ZXIubXV0YXRlKFt7XHJcbiAgICAgICAgICAgICAgICBvcDogJ3VuZG8tbGluaycsXHJcbiAgICAgICAgICAgICAgICB0YWJsZTogdGhpcy50YWJsZSxcclxuICAgICAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLnF1ZXJ5LmJyYW5jaElkLFxyXG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICAgICAgZ3JhcGhQcm9wOiBsYWJlbCxcclxuICAgICAgICAgICAgICAgIHJlbGF0ZWRJZDogcmVsYXRlZElkXHJcbiAgICAgICAgICAgIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kQ29sbGVjdGlvbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGlkcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGlkc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnJlcG8ud3JpdGVyLm11dGF0ZShpZHMubWFwKGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gKHtcclxuICAgICAgICAgICAgb3A6ICdkZWxldGUnLFxyXG4gICAgICAgICAgICB0YWJsZTogX3RoaXMudGFibGUsXHJcbiAgICAgICAgICAgIGlkOiBpZFxyXG4gICAgICAgIH0pOyB9KSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKHN1YnNjcmlwdGlvbikge1xyXG4gICAgICAgIHRoaXMucmVwby5xdWVyeVNldC51bnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kQ29sbGVjdGlvbjtcclxufShDb2xsZWN0aW9uKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH07XHJcbi8qbWl4aW4oXHJcbiAgS2VkQmFja2VuZENvbGxlY3Rpb24ucHJvdG90eXBlLFxyXG4gIE1hcHBlZENvbGxlY3Rpb24ucHJvdG90eXBlLFxyXG4gIFwibWFwXCIsIFwiZmxhdFwiLCBcImNvbmNhdFwiLCBcInJlbmRlclwiLCBcImxvYWRcIik7Ki9cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1jb2xsZWN0aW9uLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IHVwZGF0ZUFycmF5IH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50L3V0aWxzJztcclxuaW1wb3J0IHsgYnJhbmNoU2Vuc2l0aXZlLCBnZXRUYWJsZUZyb21MYWJlbCB9IGZyb20gJy4vdXRpbHMnO1xyXG5pbXBvcnQgeyBhcHBseURlbHRhIH0gZnJvbSAnLi9kZWx0YS1tZXJnZSc7XHJcbnZhciBLZWRCYWNrZW5kUXVlcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBLZWRCYWNrZW5kUXVlcnkodGFibGUsIHF1ZXJ5LCB1c2VyLCByZXBvLCBtdXRhdGlvblF1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy50YWJsZSA9IHRhYmxlO1xyXG4gICAgICAgIHRoaXMucXVlcnkgPSBxdWVyeTtcclxuICAgICAgICB0aGlzLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgIHRoaXMucmVwbyA9IHJlcG87XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSBbXTtcclxuICAgICAgICB0aGlzLmRhdGEgPSBbXTtcclxuICAgICAgICB0aGlzLmdvdEluaXRpYWxSZXNwb25zZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaW52YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubG9hZGVkVmVyc2lvbiA9IDA7XHJcbiAgICAgICAgdGhpcy5fbG9hZFByb21pc2UgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW5jbHVkZXMgPSBxdWVyeS5pbmNsdWRlID9cclxuICAgICAgICAgICAgdHlwZW9mIHF1ZXJ5LmluY2x1ZGUgPT09ICdzdHJpbmcnID9cclxuICAgICAgICAgICAgICAgIFtxdWVyeS5pbmNsdWRlXSA6XHJcbiAgICAgICAgICAgICAgICBxdWVyeS5pbmNsdWRlIDpcclxuICAgICAgICAgICAgW107XHJcbiAgICB9XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5KSB7XHJcbiAgICAgICAgdmFyIG11dGF0aW9uc09uRW1wdHkgPSBxdWVyeS5tdXRhdGlvbnNPbkVtcHR5LCBjb21wYXJhYmxlUHJvcHMgPSB0c2xpYl8xLl9fcmVzdChxdWVyeSwgW1wibXV0YXRpb25zT25FbXB0eVwiXSk7XHJcbiAgICAgICAgcmV0dXJuIHRhYmxlICsgSlNPTi5zdHJpbmdpZnkoY29tcGFyYWJsZVByb3BzKTtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZSwgXCJxdWVyeUtleVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBLZWRCYWNrZW5kUXVlcnkucXVlcnlLZXkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEsIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgJiYgIXRoaXMuaW52YWxpZCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQodGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLCB0cnVlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24ubm90aWZ5U3Vic2NyaWJlcihkYXRhLCB0aGlzLmVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gdGhpcy5xdWVyeUxvY2FsbHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5ub3RpZnlTdWJzY3JpYmVyKGRhdGEsIHRoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgbG9hZFByb21pc2U7XHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtdXRhdGlvbnNPbkVtcHR5IHNob3VsZCBuZXZlciBiZSB1c2VkIHR3aWNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMucXVlcnkubXV0YXRpb25zT25FbXB0eTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISghdmVyc2lvbiAmJiB0aGlzLl9sb2FkUHJvbWlzZSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9sb2FkUHJvbWlzZV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiBcclxuICAgICAgICAgICAgICAgICAgICAvLyBsb2FkaW5nIGlzIG9uZ29pbmcsIGFuZCBjYWxsZXIgZG9lcyBub3QgcmVxdWlyZSBhIHJlY2VudCByZWZyZXNoLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBvbmdvaW5nIGxvYWQgdG8gY29tcGxldGVcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uIHx8IHRoaXMucmVwby53cml0ZXIucGVyc2lzdGVkVmVyc2lvbi52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFByb21pc2UgPSB0aGlzLl9sb2FkUHJvbWlzZSA9IHRoaXMuX2xvYWQodmVyc2lvbikudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkZWRWZXJzaW9uID0gTWF0aC5tYXgoX3RoaXMubG9hZGVkVmVyc2lvbiwgdmVyc2lvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBUaGUgZXJyb3IgaXMgdGhlIGZpbmFsIHJlc3VsdC4gU2V0IGl0LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkUHJvbWlzZSA9PT0gbG9hZFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb29uZSBoYXMgcmVmcmVzaGVkIG91ciBsb2FkLiBXZSdyZSBmaW5pc2hlZC4gRGF0YSBvciBlcnJvciBpcyBhbHJlYWR5IHNldC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIGdvdEluaXRpYWxSZXNwb25zZSB0byB0cnVlIGFuZCBub3RpZnkgc3Vic2NyaWJlcnMuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRQcm9taXNlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5nb3RJbml0aWFsUmVzcG9uc2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLm5vdGlmeVN1YnNjcmliZXJzKF90aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQSBtb3JlIHJlY2VudCBjYWxsIHRvIGxvYWQoKSBpcyBvbmdvaW5nLCBPUiB3YXMgb25nb2luZyBidXQgcmVzcG9uZGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmVmb3JlIHVzLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluIGFueSBjYXNlIHJldHVybiB0aGlzLl9sb2FkUHJvbWlzZS4gSWYgaXQncyBvbmdvaW5nIHdlJ2xsIHdhaXQgZm9yIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdG8gZmluaXNoLiBJZiBpdCdzIG51bGwsIHdlJ2xsIGJlIHJldHVybmluZyBmaW5hbGx5IGhlcmUgd2l0aG91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFueSBhY3Rpb24sIGJlY2F1c2UgdGhlIGFjdGlvbiB3YXMgdGFrZW4gYnkgdGhlIHJlZnJlc2hlci5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX2xvYWRQcm9taXNlOyAvLyBXYWl0IGZvciB0aGUgcmVmcmVzaGVkIGxvYWQgdG8gY29tcGxldGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGxvYWRQcm9taXNlXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLl9sb2FkID0gZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubXV0YXRpb25RdWV1ZS5hZmZlY3RzUXVlcnkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSwgdGhpcy5pbmNsdWRlcykpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSBhcmUgb3V0Z29pbmcgbXV0YXRpb25zIHRoYXQgYWZmZWN0cyB0aGlzIHF1ZXJ5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHdhaXQgdGlsbCB0aGV5IHJlYWNoIHNlcnZlciBhbmQgc2VydmVyIHJlc3BvbmRzIHdpdGggT0sgYmVmb3JlIHF1ZXJ5aW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzZXJ2ZXIuIE90aGVyd2lzZSwgd2UgbWF5IGdldCBpbmFjY3VyYXRlIGRhdGEgZnJvbSBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVwby53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgYXJlIG91dGdvaW5nIG11dGF0aW9ucyB0aGF0IGFmZmVjdHMgdGhpcyBxdWVyeS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmVlZCB0byB3YWl0IHRpbGwgdGhleSByZWFjaCBzZXJ2ZXIgYW5kIHNlcnZlciByZXNwb25kcyB3aXRoIE9LIGJlZm9yZSBxdWVyeWluZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc2VydmVyLiBPdGhlcndpc2UsIHdlIG1heSBnZXQgaW5hY2N1cmF0ZSBkYXRhIGZyb20gc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucXVlcnlTZXJ2ZXIoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qLywgX2Euc2VudCgpXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB0aGlzLnN1YnNjcmlwdGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChzKSB7IHJldHVybiBzICE9PSBzdWJzY3JpcHRpb247IH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUuY29tbWl0TXV0YXRpb25zID0gZnVuY3Rpb24gKG11dGF0aW9ucywgdmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2ksIG11dGF0aW9uc18xLCBtLCBkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5kYXRhKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2kgPSAwLCBtdXRhdGlvbnNfMSA9IG11dGF0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBtdXRhdGlvbnNfMS5sZW5ndGgpKSByZXR1cm4gWzMgLypicmVhayovLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG11dGF0aW9uc18xW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEobS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgJiYgKG0uYnJhbmNoSWQgPT09IHRoaXMucXVlcnkuYnJhbmNoSWQpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucmVmcmVzaE9ySW52YWxpZGF0ZSh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKG0ub3AgPT09ICdtZXJnZScgJiYgKCFtLnRhcmdldEJyYW5jaElkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLmJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtLnRhcmdldEJyYW5jaElkID09PSB0aGlzLnF1ZXJ5LmJyYW5jaElkKSkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnJlZnJlc2hPckludmFsaWRhdGUodmVyc2lvbildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShtLm9wID09PSAndXBkYXRlJyAmJiAoKG0uZGVsdGFEb2MudGFncyAmJiB0aGlzLnF1ZXJ5LnRhZ3MpIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobS5kZWx0YURvYy5uYW1lICYmIHRoaXMucXVlcnkubmFtZSkpKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgdGFnIG1heSBoYXZlIGJlZW4gYWRkZWQsIG9yIHJlbmFtZWQsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbW1pdCB0aGUgbXV0YXRpb25zIGxvY2FsbHkgYXMgd2UgZG9uJ3QgaGF2ZSBhbGwgaW5mby5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZWZyZXNoT3JJbnZhbGlkYXRlKHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgdGFnIG1heSBoYXZlIGJlZW4gYWRkZWQsIG9yIHJlbmFtZWQsIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcXVlcnkgaXMgZGVwZW5kZW50IG9uIHRoZSBzYW1lIHByb3BlcnR5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGUgcXVlcnkgbXVzdCBiZSByZWZyZXNoZWQgZnJvbSBzZXJ2ZXIgYXMgd2UgY2Fubm90XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbW1pdCB0aGUgbXV0YXRpb25zIGxvY2FsbHkgYXMgd2UgZG9uJ3QgaGF2ZSBhbGwgaW5mby5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaSsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChtdXRhdGlvbnMsIGZhbHNlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRRdWVyeS5wcm90b3R5cGUucmVmcmVzaE9ySW52YWxpZGF0ZSA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMubG9hZCh2ZXJzaW9uKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5ub3RpZnlTdWJzY3JpYmVycyA9IGZ1bmN0aW9uIChvcHRpbWlzdGljTXV0YXRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5kYXRhICYmIHRoaXMuZ290SW5pdGlhbFJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhXzEgPSB0aGlzLmdldERhdGFXaXRoTXV0YXRpb25zQXBwbGllZChvcHRpbWlzdGljTXV0YXRpb25zLCB0cnVlLCB0aGlzLmRhdGEpO1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAocykge1xyXG4gICAgICAgICAgICAgICAgcy5ub3RpZnlTdWJzY3JpYmVyKGRhdGFfMSwgX3RoaXMuZXJyb3IpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVwby5xdWVyeVNldC5xdWVyeUxvY2FsbHkodGhpcy50YWJsZSwgdGhpcy5xdWVyeSwgdGhpcy5pbmNsdWRlcyk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5xdWVyeVNlcnZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5yZXBvLmdldENsaWVudCgpLmxpc3QodGhpcy50YWJsZSwgdHNsaWJfMS5fX2Fzc2lnbih7fSwgdGhpcy5xdWVyeSkpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBkYXRhXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5nZXREYXRhV2l0aE11dGF0aW9uc0FwcGxpZWQgPSBmdW5jdGlvbiAobXV0YXRpb25zLCBvcHRpbWlzdGljLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHtcclxuICAgICAgICAgICAgZGF0YSA9IF90aGlzLmFwcGx5TXV0YXRpb25zT25EYXRhKGRhdGEsIG11dGF0aW9uLCBvcHRpbWlzdGljKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUXVlcnkucHJvdG90eXBlLmFwcGx5TXV0YXRpb25zT25EYXRhID0gZnVuY3Rpb24gKGRhdGEsIG0sIG9wdGltaXN0aWMpIHtcclxuICAgICAgICBpZiAoYnJhbmNoU2Vuc2l0aXZlKG0pICYmIG0uYnJhbmNoSWQgIT0gdGhpcy5xdWVyeS5icmFuY2hJZClcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgdmFyIF9hID0gdGhpcywgdGFibGUgPSBfYS50YWJsZSwgaW5jbHVkZXMgPSBfYS5pbmNsdWRlcywgbGlzdE9wdGlvbnMgPSBfYS5xdWVyeTtcclxuICAgICAgICB2YXIgc291cmNlSWRzID0gbGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tID8gW10uY29uY2F0KGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSB8fCBbXSkgOiBbXTtcclxuICAgICAgICB2YXIgcmVxdWVzdGVkVGFncyA9IGxpc3RPcHRpb25zLnRhZ3MgPyBbXS5jb25jYXQobGlzdE9wdGlvbnMudGFncyB8fCBbXSkgOiBbXTtcclxuICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcclxuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzoge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkID09PSBtLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGRlbHRhIG9uIHVwZGF0ZWQgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWREb2MgPSBhcHBseURlbHRhKGRvYywgbS5kZWx0YURvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZERvYy4kbWV0YSA9ICd1cGRhdGluZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cGRhdGVkRG9jO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBpZCBkb2VzIG5vdCBhcHBseSB0byB0aGlzIGRvYywgc2VhcmNoIGluIGdyYXBocyB0aGUgaWQgaXMgZm91bmRcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbW9uZyBncmFwaCBpbmNsdWRlZCBkb2NzLCBhbmQgaWYgc28sIHVwZGF0ZSB0aGF0IG9uZTpcclxuICAgICAgICAgICAgICAgICAgICBpbmNsdWRlcy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmNsdWRlZERvY3MgPSBkb2NbbGFiZWxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5jbHVkZWREb2NzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZEFycmF5ID0gdXBkYXRlQXJyYXkoaW5jbHVkZWREb2NzLCBmdW5jdGlvbiAocmVsYXRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVsYXRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZFJlbGF0ZWQgPSBhcHBseURlbHRhKHJlbGF0ZWQsIG0uZGVsdGFEb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpbWlzdGljKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkUmVsYXRlZC4kbWV0YSA9ICd1cGRhdGluZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRSZWxhdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlZEFycmF5ICE9PSBpbmNsdWRlZERvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBkb2MsIChfYSA9IHt9LCBfYVtsYWJlbF0gPSB1cGRhdGVkQXJyYXksIF9hKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRhYmxlID09PSBtLnRhYmxlICYmIGluY2x1ZGVzLmluZGV4T2YobS5ncmFwaFByb3ApICE9PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIGV4cHJlc3Npb24gaXMgYGRiLmNvdXJzZUJsb2Nrcy4uLi53aGF0ZXZlci4uIC5pbmNsdWRlKFwiYWJpbGl0aWVzXCIpYCwgZGV0ZWN0OiBkYi5jb3Vyc2VCbG9ja3MuYWRkUmVsYXRlZChibG9ja0lkLCAnYWJpbGl0aWVzJywgLi4uKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIC4uLmJlY2F1c2UgdGFibGUgPSAnY291cnNlQmxvY2tzJyBhbmQgaW5jbHVkZXMgaGFzIFwiYWJpbGl0aWVzXCIuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2MgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLnJlbGF0ZWREb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW1pc3RpYylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0ZWREb2MuJG1ldGEgPSAnYWRkaW5nJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IGRvY1ttLmdyYXBoUHJvcF0uY29uY2F0KFtyZWxhdGVkRG9jXSksIF9hKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAobGlzdE9wdGlvbnMuaGFzRWRnZXNGcm9tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZUlkcy5pbmNsdWRlcyhtLmlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBleHByZXNzaW9uIGlzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGBkYi5jb3Vyc2VCbG9ja3MuaGFzRWRnZXNGcm9tKFtjb3Vyc2VJZF0pYCAgKG1lYW5pbmcgdGFibGU9J2NvdXJzZUJsb2NrcycgYW5kIHNvdXJjZUlkcyBpbmNsdWRlcyBjb3Vyc2VJZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLCBkZXRlY3Q6IGRiLmNvdXJzZUluc3RhbmNlcy5hZGRSZWxhdGVkKGNvdXJzZUlkLCAnY291cnNlQmxvY2tzJywgLi4uLikgLy8gbS5ncmFwaFByb3AgPT09ICdibG9ja3MnLS0+IGdldFRhYmxlRnJvbUxhYmVsIC0tPiAnY291cnNlQmxvY2tzJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IGdldFRhYmxlRnJvbUxhYmVsKG0udGFibGUsIG0uZ3JhcGhQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFsaXN0T3B0aW9ucy50YWdzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvbmNhdCh0aGlzLnNldEdyYXBoUHJvcHMobS5yZWxhdGVkRG9jKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobS5yZWxhdGVkRG9jLnRhZ3MgJiYgcmVxdWVzdGVkVGFncy5zb21lKGZ1bmN0aW9uICh0YWcpIHsgcmV0dXJuIG0ucmVsYXRlZERvYy50YWdzLmluY2x1ZGVzKHRhZyk7IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChsaXN0T3B0aW9ucy5pZHMgJiYgbGlzdE9wdGlvbnMuaWRzLnNvbWUoZnVuY3Rpb24gKGlkKSB7IHJldHVybiBpZCA9PT0gbS5yZWxhdGVkRG9jLmlkOyB9KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEEgY2VydGFpbiBJRCBpcyBvYnNlcnZlZC4gQSBkb2Mgd2l0aCB0aGlzIGlkIGlzIGJlaW5nIGFkZGVkLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgZG9jIHRvIHRoZSByZXN1bHQuIEV4YWN0bHkgdGhpcyBXSUxMIGhhcHBlbiBpbiB0aGUgZm9sbG93aW5nIHR5cGljYWwgc2NlbmFyaW86XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMS4gVXNlciBhZGRzIGEgcmVsYXRlZCBkb2N1bWVudCB0byBhIGxpc3QuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gMi4gRG9jdW1lbnQgcmVtYWlucyB3aXRoaW4gdGhlIE11dGF0aW9uUXVldWUgd2hpbGUgYmF0Y2gtcmVxdWVzdCBpcyBiZWluZyBwcm9jZXNzZWQgYnkgc2VydmVyLlxyXG4gICAgICAgICAgICAgICAgICAgIC8vIDMuIFVzZXIgY2xpY2tzIHRoZSBhZGRlZCBpdGVtIHRvIGVkaXQgb3IgdmlldyBpdCAob3Igb3VyIGNvbXBvbmVudCByZWRpcmVjdHMgdG8gaXRzIGVkaXRvcilcclxuICAgICAgICAgICAgICAgICAgICAvLyA0LiBBIG5ldyBxdWVyeSBvZiB0aGF0IHBhcnRpY3VsYXIgSUQgaXMgc3Vic2NyaWJlZCB0byB7aWRzPVt0aGVJZF19XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgS2VkQmFja2VuZFF1ZXJ5LnN1YnNjcmliZSB0aGVuIGRvZXMgdGhpczpcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgIDEuIENhbGwgcXVlcnlMb2NhbGx5KCkgYmVmb3JlIHF1ZXJ5aW5nIHNlcnZlclxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgMi4gcXVlcnlMb2NhbGx5KCkgaW5zcGVjdHMgbXV0YXRpb25zIGFuZCBmaW5kcyBhIG1hdGNoLCByZXR1cm5pbmcgYW4gZW1wdHkgbGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgKGFzc3VtZXMgYXMgd2UgYXJlIGFkZGluZyBpdCwgaXQgY2FuJ3QgZXhpc3Qgb24gdGhlIHNlcnZlciBhbnl3YXkpXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAzLiBLZWRCYWNrZW5kUVVlcnkgYXBwbGllcyBtdXRhdGlvbnMgb250byB0aGUgZW1wdHkgbGlzdCwgYW5kIGVuZHMgdXAgaGVyZSB0byBhZGRcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIGl0IG9wdGltaXN0aWNhbGx5LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNC4gV2hlbiBzZXJ2ZXIgcmVzcG9uZHMgd2l0aCAyMDAgT0ssIGNhbGxzIHVzIGhlcmUgYWdhaW4gd2l0aCBvcHRpbWlzdGljPWZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB0byBcInBlcnNpc3RcIiBpdCBpbiB0aGUgcXVlcnkncyBkYXRhIGFycmF5LlxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgNEI6IElmIG5vdCAyMDAgT0ssIG11dGF0aW9uIG1heSBiZSBnb25lIGFuZCB0aGUgc3Vic2NyaWJlciB3aWxsIHNlIGFuIGVycm9yIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIFwiQ291bGQgbm90IGZpbmQgZW50aXR5IHdpdGggaWQgWC5cIiBhbG9uZyB3aXRoIGEgcmVkIGVycm9yIG1lc3NhZ2Ugb24gdGhlIHNjcmVlblxyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgYWJvdXQgdGhhdCBpdCBmYWlsZWQgdG8gc2F2ZSBvbiBzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY29uY2F0KHRoaXMuc2V0R3JhcGhQcm9wcyhtLnJlbGF0ZWREb2MpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICBpZiAodGFibGUgPT09IG0udGFibGUgJiYgaW5jbHVkZXMuaW5kZXhPZihtLmdyYXBoUHJvcCkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZUFycmF5KGRhdGEsIGZ1bmN0aW9uIChkb2MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5jbHVkZWREb2NzID0gZG9jW20uZ3JhcGhQcm9wXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpbmNsdWRlZERvY3MpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmlkICE9PSBtLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hc3NpZ24oe30sIGRvYywgKF9hID0ge30sIF9hW20uZ3JhcGhQcm9wXSA9IG9wdGltaXN0aWMgP1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFyayByZWxhdGVkLWRvYy10by1yZW1vdmUgd2l0aCAkbWV0YTogJ2RlbGV0aW5nJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZWREb2NzLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5yZWxhdGVkRG9jLmlkID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkIDogdHNsaWJfMS5fX2Fzc2lnbih7fSwgZCwgeyAkbWV0YTogJ2RlbGV0aW5nJyB9KTsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGVsZXRlIHJlbGF0ZWQtZG9jLXRvLXJlbW92ZSBmcm9tIGRvY1tncmFwUHJvcF06XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmNsdWRlZERvY3MuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkICE9PSBtLnJlbGF0ZWREb2MuaWQ7IH0pLCBfYSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGxpc3RPcHRpb25zLmhhc0VkZ2VzRnJvbSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2VJZHMuaW5jbHVkZXMobS5pZCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvcHRpbWlzdGljID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubWFwKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkLmlkID09PSBtLnJlbGF0ZWREb2MuaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgIT09IG0ucmVsYXRlZERvYy5pZDsgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgY2FzZSAnZGVsZXRlJzpcclxuICAgICAgICAgICAgICAgIGlmICh0YWJsZSA9PT0gbS50YWJsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gZC5pZCAhPT0gbS5pZDsgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChsaXN0T3B0aW9ucy5pbmNsdWRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluY2x1ZGVkVGFibGVzID0gaW5jbHVkZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuICh7IGxhYmVsOiBsYWJlbCwgdGFibGU6IGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgfSk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsYWJlbHNfMSA9IGluY2x1ZGVkVGFibGVzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gX2EudGFibGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWJsZSA9PT0gbS50YWJsZTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGFiZWxzXzEubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXBkYXRlQXJyYXkoZGF0YSwgZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzXzEuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSBfYS5sYWJlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbGF0ZWREb2NzID0gZG9jW2xhYmVsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVsYXRlZERvY3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jLCAoX2IgPSB7fSwgX2JbbGFiZWxdID0gb3B0aW1pc3RpYyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkRG9jcy5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQuaWQgPT09IG0uaWQgPyB0c2xpYl8xLl9fYXNzaWduKHt9LCBkLCB7ICRtZXRhOiAnZGVsZXRpbmcnIH0pIDogZDsgfSkgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVsYXRlZERvY3MuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IF9hLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpZCAhPT0gbS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBfYikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRvYztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFF1ZXJ5LnByb3RvdHlwZS5zZXRHcmFwaFByb3BzID0gZnVuY3Rpb24gKGRvYykge1xyXG4gICAgICAgIHZhciBjb3B5ID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgZG9jKTtcclxuICAgICAgICB0aGlzLmluY2x1ZGVzLmZvckVhY2goZnVuY3Rpb24gKGxhYmVsKSB7IHJldHVybiBjb3B5W2xhYmVsXSA9IGNvcHlbbGFiZWxdIHx8IFtdOyB9KTtcclxuICAgICAgICByZXR1cm4gY29weTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFF1ZXJ5O1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kUXVlcnkgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a2VkYmFja2VuZC1xdWVyeS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyB0YWJsZXMgfSBmcm9tICdrZWRiYWNrZW5kLXNjaGVtYS9zY2hlbWEuanNvbic7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRDb2xsZWN0aW9uIH0gZnJvbSAnLi9rZWRiYWNrZW5kLWNvbGxlY3Rpb24nO1xyXG5pbXBvcnQgeyBRdWVyeVNldCB9IGZyb20gJy4vcXVlcnktc2V0JztcclxuaW1wb3J0IHsgTXV0YXRpb25RdWV1ZSB9IGZyb20gJy4vbXV0YXRpb24tcXVldWUnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH0gZnJvbSAnLi9rZWRiYWNrZW5kLXdyaXRlcic7XHJcbmltcG9ydCB7IERlbHRhQ29sbGVjdGlvbiB9IGZyb20gJy4vZGVsdGEtY29sbGVjdGlvbi9kZWx0YS1jb2xsZWN0aW9uJztcclxudmFyIEtlZEJhY2tlbmRSZXBvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gS2VkQmFja2VuZFJlcG8oZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUsIGRlZmF1bHRRdWVyeU9wdGlvbnMsIG11dGF0aW9uUXVldWUsIHF1ZXJ5U2V0LCB3cml0ZXIsIGNhY2hlT3B0aW1pemVkKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmdldENsaWVudCA9IGdldENsaWVudDtcclxuICAgICAgICB0aGlzLmdldFVzZXIgPSBnZXRVc2VyO1xyXG4gICAgICAgIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lID0gZ2V0VXNlckRpc3BsYXlOYW1lO1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyA9IGRlZmF1bHRRdWVyeU9wdGlvbnM7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XHJcbiAgICAgICAgdGhpcy53cml0ZXIgPSB3cml0ZXI7XHJcbiAgICAgICAgdGhpcy5jYWNoZU9wdGltaXplZCA9IGNhY2hlT3B0aW1pemVkO1xyXG4gICAgICAgIGlmICghZGVmYXVsdFF1ZXJ5T3B0aW9ucylcclxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zID0ge307XHJcbiAgICAgICAgaWYgKCFtdXRhdGlvblF1ZXVlKVxyXG4gICAgICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBuZXcgTXV0YXRpb25RdWV1ZSgpO1xyXG4gICAgICAgIGlmICghcXVlcnlTZXQpXHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZXQgPSBuZXcgUXVlcnlTZXQodGhpcy5tdXRhdGlvblF1ZXVlKTtcclxuICAgICAgICBpZiAoIXdyaXRlcilcclxuICAgICAgICAgICAgdGhpcy53cml0ZXIgPSBuZXcgS2VkQmFja2VuZFdyaXRlcih0aGlzLm11dGF0aW9uUXVldWUsIHRoaXMucXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKTtcclxuICAgICAgICBPYmplY3Qua2V5cyh0YWJsZXMpLmZvckVhY2goZnVuY3Rpb24gKHRhYmxlKSB7XHJcbiAgICAgICAgICAgIHZhciBjb2xsZWN0aW9uID0gbmV3IEtlZEJhY2tlbmRDb2xsZWN0aW9uKF90aGlzLCB0YWJsZSwgZGVmYXVsdFF1ZXJ5T3B0aW9ucyB8fCB7fSk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZU9wdGltaXplZCkge1xyXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb24uY2FjaGVPcHRpbWl6ZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfdGhpc1t0YWJsZV0gPSBjb2xsZWN0aW9uO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZGVsdGFzID0gbmV3IERlbHRhQ29sbGVjdGlvbih0aGlzLndyaXRlci5kZWx0YUNhY2hlLCB7XHJcbiAgICAgICAgICAgIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQgLy8gSWYgYnJhbmNoSWQgaXMgdW5kZWZpbmVkLiBEZWx0YUNvbGxlY3Rpb24gd2lsbCByZXNwb25kIHdpdGggRXJyb3Igb24gc3Vic2NyaWJlKClcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS50YWJsZSA9IGZ1bmN0aW9uICh0YWJsZU5hbWUpIHtcclxuICAgICAgICB2YXIgY29sbGVjdGlvbiA9IG5ldyBLZWRCYWNrZW5kQ29sbGVjdGlvbih0aGlzLCB0YWJsZU5hbWUsIHRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FjaGVPcHRpbWl6ZWQpXHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uLmNhY2hlT3B0aW1pemVkKCk7XHJcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLl9jbG9uZSA9IGZ1bmN0aW9uIChxdWVyeU9wdGlvbnMsIGNhY2hlT3B0aW1pemVkKSB7XHJcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IEtlZEJhY2tlbmRSZXBvKHRoaXMuZ2V0Q2xpZW50LCB0aGlzLmdldFVzZXIsIHRoaXMuZ2V0VXNlckRpc3BsYXlOYW1lLCB0c2xpYl8xLl9fYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMsIHF1ZXJ5T3B0aW9ucyksIHRoaXMubXV0YXRpb25RdWV1ZSwgdGhpcy5xdWVyeVNldCwgdGhpcy53cml0ZXIsIGNhY2hlT3B0aW1pemVkID09PSB1bmRlZmluZWQgPyB0aGlzLmNhY2hlT3B0aW1pemVkIDogY2FjaGVPcHRpbWl6ZWQpO1xyXG4gICAgICAgIHJldHVybiBjbG9uZTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUuYnJhbmNoID0gZnVuY3Rpb24gKGJyYW5jaElkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Nsb25lKHsgYnJhbmNoSWQ6IGJyYW5jaElkIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5yb2xlID0gZnVuY3Rpb24gKHJvbGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2xvbmUoeyByb2xlOiByb2xlIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRSZXBvLnByb3RvdHlwZS5vcHRpbWl6ZUNhY2hlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jbG9uZSh7fSwgdHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLmNsZWFyQnJhbmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgY2xlYXIgbWFzdGVyIGJyYW5jaFwiKTtcclxuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdjbGVhci1icmFuY2gnLCBicmFuY2hJZDogdGhpcy5kZWZhdWx0UXVlcnlPcHRpb25zLmJyYW5jaElkIH1dLCAwKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kUmVwby5wcm90b3R5cGUubWVyZ2UgPSBmdW5jdGlvbiAodGFyZ2V0QnJhbmNoSWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZGVmYXVsdFF1ZXJ5T3B0aW9ucy5icmFuY2hJZClcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IG1lcmdlIGZyb20gbWFzdGVyIGJyYW5jaFwiKTtcclxuICAgICAgICB0aGlzLndyaXRlci5tdXRhdGUoW3sgb3A6ICdtZXJnZScsIGJyYW5jaElkOiB0aGlzLmRlZmF1bHRRdWVyeU9wdGlvbnMuYnJhbmNoSWQsIHRhcmdldEJyYW5jaElkOiB0YXJnZXRCcmFuY2hJZCB9XSwgMCk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFJlcG8ucHJvdG90eXBlLnNhdmVOb3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy53cml0ZXIud2FpdEZvclZlcnNpb25Ub1BlcnNpc3QodGhpcy53cml0ZXIuY3VycmVudFZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFJlcG87XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEtlZEJhY2tlbmRSZXBvIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtcmVwby5qcy5tYXAiLCJ2YXIgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24oc3Vic2NyaWJlciwgY29sbGVjdGlvbikge1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlciA9IHN1YnNjcmliZXI7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uID0gY29sbGVjdGlvbjtcclxuICAgIH1cclxuICAgIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24ucHJvdG90eXBlLm5vdGlmeVN1YnNjcmliZXIgPSBmdW5jdGlvbiAoZGF0YSwgZXJyb3IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN1YnNjcmliZXIoW10sIGVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YSAhPT0gdGhpcy5sYXN0Tm90aWZpZWREYXRhKSB7IC8vIFdpbGwgaW4tZmFjdCBiZSBlcXVhbCBieSByZWZlcmVuY2UgaWYgZGF0YSBpcyBzYW1lIGFzIGxhc3Qgbm90aWZpY2F0aW9uIChhcyB3ZSB1c2UgYW4gaW1tdXRhYmxlIGFwcHJvYWNoIG9uIGRhdGEpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3ROb3RpZmllZERhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVyKGRhdGEsIGVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlcihbXSwgZXgsIHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChleDIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBub3RpZnlpbmcgS2VkQmFja2VuZFN1YnNjcmliZXI6XCIsIGV4MiwgJ29yaWdpbmFsbHkgbm90aWZpZWQgZXJyb3I6JywgZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRTdWJzY3JpcHRpb24ucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY29sbGVjdGlvbi51bnN1YnNjcmliZSh0aGlzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gS2VkQmFja2VuZFN1YnNjcmlwdGlvbjtcclxufSgpKTtcclxuZXhwb3J0IHsgS2VkQmFja2VuZFN1YnNjcmlwdGlvbiB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1rZWRiYWNrZW5kLXN1YnNjcmlwdGlvbi5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBNdXRhdGlvblF1ZXVlIH0gZnJvbSAnLi9tdXRhdGlvbi1xdWV1ZSc7XHJcbmltcG9ydCB7IEJhdGNoUnVubmVyIH0gZnJvbSAnLi4va2VkLWJhY2tlbmQtY2xpZW50JztcclxuaW1wb3J0IHsgdGFibGVzIH0gZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xyXG5pbXBvcnQgeyBDYWNoZUJ1c3QgfSBmcm9tICcuL2NhY2hlLWJ1c3QnO1xyXG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSAnLi4vb2JzZXJ2YWJsZSc7XHJcbmltcG9ydCB7IERlbHRhQ2FjaGUgfSBmcm9tICcuL2RlbHRhLWNvbGxlY3Rpb24vZGVsdGEtY2FjaGUnO1xyXG52YXIgS2VkQmFja2VuZFdyaXRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEtlZEJhY2tlbmRXcml0ZXIobXV0YXRpb25RdWV1ZSwgcXVlcnlTZXQsIGdldENsaWVudCwgZ2V0VXNlciwgZ2V0VXNlckRpc3BsYXlOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlID0gbXV0YXRpb25RdWV1ZTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0ID0gcXVlcnlTZXQ7XHJcbiAgICAgICAgdGhpcy5nZXRDbGllbnQgPSBnZXRDbGllbnQ7XHJcbiAgICAgICAgdGhpcy5nZXRVc2VyID0gZ2V0VXNlcjtcclxuICAgICAgICB0aGlzLmdldFVzZXJEaXNwbGF5TmFtZSA9IGdldFVzZXJEaXNwbGF5TmFtZTtcclxuICAgICAgICB0aGlzLl90aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2lzU2F2aW5nUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IDA7XHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uID0gbmV3IEVtaXR0ZXIoMCk7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5kZWx0YUNhY2hlID0gbmV3IERlbHRhQ2FjaGUoZ2V0Q2xpZW50LCBnZXRVc2VyLCBnZXRVc2VyRGlzcGxheU5hbWUpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLCBcImlzU2F2aW5nXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEhdGhpcy5faXNTYXZpbmdQcm9taXNlOyB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZSwgXCJpc0VkaXRlZFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCkubGVuZ3RoID4gMDsgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzLnB1c2goY2FsbGJhY2spO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm9uU3RhdGVDaGFuZ2UgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLnN0YXRlU3Vic2NyaWJlcnMucHVzaChjYWxsYmFjayk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmliZXJzID0gdGhpcy5lcnJvclN1YnNjcmliZXJzLmZpbHRlcihmdW5jdGlvbiAocykgeyByZXR1cm4gcyAhPT0gY2FsbGJhY2s7IH0pO1xyXG4gICAgICAgIHRoaXMuc3RhdGVTdWJzY3JpYmVycyA9IHRoaXMuc3RhdGVTdWJzY3JpYmVycy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHMgIT09IGNhbGxiYWNrOyB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yLCByZXRyeWFibGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZXJyb3JTdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soZXJyb3IsIHJldHJ5YWJsZSwgX3RoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoIChfKSB7IH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5kaXNwYXRjaFN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zdGF0ZVN1YnNjcmliZXJzLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhfdGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKF8pIHsgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm11dGF0ZSA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIGRlYm91bmNlKSB7XHJcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmFkZChtdXRhdGlvbnMpO1xyXG4gICAgICAgICsrdGhpcy5jdXJyZW50VmVyc2lvbjtcclxuICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcclxuICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICAgICAgdGhpcy5kZWx0YUNhY2hlLmFwcGx5TXV0YXRpb25zKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKSwgeyBvcHRpbWlzdGljOiB0cnVlIH0pO1xyXG4gICAgICAgIGlmICghdGhpcy5faXNTYXZpbmdQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dElkKTtcclxuICAgICAgICAgICAgdGhpcy5fdGltZW91dElkID0gc2V0VGltZW91dCh0aGlzLnNhdmUuYmluZCh0aGlzKSwgZGVib3VuY2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBpc1NhdmluZywgd2UgZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZywgYmVjYXNlIGl0IHdpbGwgcmUtY2hlY2sgaWYgYWRkaXRpb25hbFxyXG4gICAgICAgIC8vIG11dGF0aW9ucyBoYXZlIGNvbWUsIHdoZW4gc2F2aW5nIGlzIGRvbmUuXHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUucmV0cnlTYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmUoKTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS53YWl0Rm9yVmVyc2lvblRvUGVyc2lzdCA9IGZ1bmN0aW9uICh2ZXJzaW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwZXJzaXN0ZWRWZXJzaW9uO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMucGVyc2lzdGVkVmVyc2lvbi5sb2FkKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdGVkVmVyc2lvbiA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEocGVyc2lzdGVkVmVyc2lvbiA8IHZlcnNpb24pKSByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKCk7IC8vIEJlIG1vcmUgZWFnZXIgdG8gc2F2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnBlcnNpc3RlZFZlcnNpb24uZmlsdGVyKGZ1bmN0aW9uIChwZXJzaXN0ZWRWZXJzaW9uKSB7IHJldHVybiBwZXJzaXN0ZWRWZXJzaW9uID49IHZlcnNpb247IH0pLmxvYWQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgS2VkQmFja2VuZFdyaXRlci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLl90aW1lb3V0SWQpXHJcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0SWQpO1xyXG4gICAgICAgIGlmICh0aGlzLl9pc1NhdmluZ1Byb21pc2UpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1NhdmluZ1Byb21pc2U7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRWRpdGVkKVxyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5fdGltZW91dElkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9pc1NhdmluZ1Byb21pc2UgPSB0aGlzLl9zYXZlKCk7XHJcbiAgICAgICAgdGhpcy5faXNTYXZpbmdQcm9taXNlLmNhdGNoKGZ1bmN0aW9uICgpIHsgfSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5faXNTYXZpbmdQcm9taXNlID0gbnVsbDsgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzU2F2aW5nUHJvbWlzZTtcclxuICAgIH07XHJcbiAgICBLZWRCYWNrZW5kV3JpdGVyLnByb3RvdHlwZS5fc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG11dGF0aW9ucywgdmVyc2lvbiwgbXV0YXRpb25SZXF1ZXN0cywgcmVzXzEsIGV0YWdNdXRhdGlvbnMsIGVycm9yXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucyA9IHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbiA9IHRoaXMuY3VycmVudFZlcnNpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubXV0YXRpb25RdWV1ZS5tb3ZlVG9TYXZpbmdRdWV1ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvblJlcXVlc3RzID0gdGhpcy5tYXBNdXRhdGlvbnMobXV0YXRpb25zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFsxLCA2LCAxMSwgMTJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5nZXRDbGllbnQoKS5iYXRjaChtdXRhdGlvblJlcXVlc3RzKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXRhZ011dGF0aW9ucyA9IE9iamVjdC5rZXlzKHJlc18xLm5ld0V0YWdzKS5tYXAoZnVuY3Rpb24gKGlkKSB7IHJldHVybiAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3A6ICd1cGRhdGUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGU6IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogaWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWx0YURvYzogeyAkZXRhZzogcmVzXzEubmV3RXRhZ3NbaWRdIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lOiBudWxsIC8vIFdlIGRvbid0IGhhdmUgdGhlIHRhcmdldCBuYW1lLiBCdXQgdGhpcyBtdXRhdGlvbiB3b24ndCBiZSB2aXNpYmxlIGluIGEgRGVsdGFDb2xsZWN0aW9uIGFueXdheSwgc28gaXQgd29udCBiZSB1c2VkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRhdGUgY2FjaGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgQ2FjaGVCdXN0LmludmFsaWRhdGVDYWNoZShtdXRhdGlvblJlcXVlc3RzLCB0aGlzLmdldFVzZXIoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbW1taXQgbXV0YXRpb25zIGFsb25nIHdpdGggZXRhZ011dGF0aW9ucyBpbnRvIHF1ZXJpZXMgY2FjaGVkIGRhdGFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoKHZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbHRhQ2FjaGUuYXBwbHlNdXRhdGlvbnMobXV0YXRpb25zLCB7IG9wdGltaXN0aWM6IGZhbHNlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLnF1ZXJ5U2V0LmNvbW1pdE11dGF0aW9ucyhNdXRhdGlvblF1ZXVlLm1lcmdlKG11dGF0aW9ucywgZXRhZ011dGF0aW9ucyksIHZlcnNpb24pXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT24gc3VjY2VzcywgY2xlYXIgc2F2aW5nIHF1ZXVlIGFzIHRoZSBtdXRhdGlvbnMgd2lsbCBub3cgYmUgY29tbWl0dGVkIHRvIGFsbCBxdWVyeSdzIGRhdGEgaW5zdGVhZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7IC8vIGlzRWRpdGVkIG1heSBoYXZlIHR1cm5lZCB0byBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5hbGx5LCBub3RpZnkgc3Vic2NyaWJlcnMgc28gdGhhdCB2aWV3cyBnZXQgdXBkYXRlZCB3aXRoIGNvbW1pdHRlZCByZXN1bHRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTZXQubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodGhpcy5tdXRhdGlvblF1ZXVlLmdldCgpLmxlbmd0aCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBtdXRhdGlvbnMgaGFwcGVuZCB3aGlsZSB3ZSB3ZXJlIHNhdmluZy4gSGFuZGxlIHRoZW0gYXMgd2VsbC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fc2F2ZSgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFzIHdlbGwuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgMTJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wZXJzaXN0ZWRWZXJzaW9uLmRpc3BhdGNoRXJyb3IoZXJyb3JfMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGVycm9yXzEgJiYgZXJyb3JfMS5uYW1lICYmIGVycm9yXzEubmFtZS5zdGFydHNXaXRoKFwiaHR0cDRcIikpKSByZXR1cm4gWzMgLypicmVhayovLCA5XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWNjZXNzIENvbnRyb2wgZGVuaWVkLCBiYWQgcmVxdWVzdCBvciBzaW1pbGFyLiBUaHJvdyBtdXRhdGlvbnMgYXdheS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLmNsZWFyU2F2aW5nUXVldWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFN0YXRlQ2hhbmdlKCk7IC8vIGlzRWRpdGVkIG1heSBoYXZlIHR1cm5lZCB0byBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U2V0Lm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMubXV0YXRpb25RdWV1ZS5nZXQoKS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvIGhvISBBZGRpdGlvbmFsIG11dGF0aW9ucyBoYXBwZW5kIHdoaWxlIHdlIHdlcmUgc2F2aW5nLiBIYW5kbGUgdGhlbSBhbG9uZS4gVEhleSBtaWdodCBiZSBtb3JlIGx1Y2t5LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLl9zYXZlKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG8gaG8hIEFkZGl0aW9uYWwgbXV0YXRpb25zIGhhcHBlbmQgd2hpbGUgd2Ugd2VyZSBzYXZpbmcuIEhhbmRsZSB0aGVtIGFsb25lLiBUSGV5IG1pZ2h0IGJlIG1vcmUgbHVja3kuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA4O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFszIC8qYnJlYWsqLywgMTBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaEVycm9yKGVycm9yXzEsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDEwO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEyXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoU3RhdGVDaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs3IC8qZW5kZmluYWxseSovXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEtlZEJhY2tlbmRXcml0ZXIucHJvdG90eXBlLm1hcE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMpIHtcclxuICAgICAgICB2YXIgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG0ub3ApIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudXBkYXRlKG0udGFibGUsIG0uaWQsIG0uZGVsdGFEb2MsIG0uYnJhbmNoSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkLXJlbGF0ZWQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbS5yZWxhdGVkRG9jLiRldGFnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vICRldGFnIG1lYW5zIHRoaXMgaXMgYSBuZXcgZG9jdW1lbnQuIEFkZCBpdCBiZWZvcmUgbGlua2luZyB0byBpdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnIuYWRkKHRhYmxlc1ttLnRhYmxlXS5yZWxhdGlvbnNoaXBzW20uZ3JhcGhQcm9wXSwgbS5yZWxhdGVkRG9jLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnIubGluazIobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZERvYy5pZCwgbS5icmFuY2hJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZW1vdmUtcmVsYXRlZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudW5saW5rMihtLnRhYmxlLCBtLmlkLCBtLmdyYXBoUHJvcCwgbS5yZWxhdGVkRG9jLmlkLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VuZG8tbGluayc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIudW5kb0xpbmsobS50YWJsZSwgbS5pZCwgbS5ncmFwaFByb3AsIG0ucmVsYXRlZElkLCBtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgYnIuZGVsZXRlKG0udGFibGUsIG0uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXItYnJhbmNoJzpcclxuICAgICAgICAgICAgICAgICAgICBici5jbGVhckJyYW5jaChtLmJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ21lcmdlJzpcclxuICAgICAgICAgICAgICAgICAgICBici5tZXJnZShtLmJyYW5jaElkLCBtLnRhcmdldEJyYW5jaElkKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBici5tdXRhdGlvblJlcXVlc3RzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBLZWRCYWNrZW5kV3JpdGVyO1xyXG59KCkpO1xyXG5leHBvcnQgeyBLZWRCYWNrZW5kV3JpdGVyIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtlZGJhY2tlbmQtd3JpdGVyLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGdldFRhYmxlRnJvbUxhYmVsLCBicmFuY2hTZW5zaXRpdmUsIGdsb2JhbE9wIH0gZnJvbSAnLi91dGlscyc7XHJcbmltcG9ydCB7IG1lcmdlRGVsdGFzIH0gZnJvbSAnLi9kZWx0YS1tZXJnZSc7XHJcbnZhciBNdXRhdGlvblF1ZXVlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTXV0YXRpb25RdWV1ZSgpIHtcclxuICAgICAgICB0aGlzLnF1ZXVlID0gW107XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xyXG4gICAgfVxyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG11dGF0aW9ucykge1xyXG4gICAgICAgIHRoaXMucXVldWUgPSBNdXRhdGlvblF1ZXVlLm1lcmdlKHRoaXMucXVldWUsIG11dGF0aW9ucyk7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUubW92ZVRvU2F2aW5nUXVldWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IE11dGF0aW9uUXVldWUubWVyZ2UodGhpcy5zYXZpbmdRdWV1ZSwgdGhpcy5xdWV1ZSk7XHJcbiAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmNsZWFyU2F2aW5nUXVldWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zYXZpbmdRdWV1ZSA9IFtdO1xyXG4gICAgfTtcclxuICAgIE11dGF0aW9uUXVldWUucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zYXZpbmdRdWV1ZS5jb25jYXQodGhpcy5xdWV1ZSk7XHJcbiAgICB9O1xyXG4gICAgTXV0YXRpb25RdWV1ZS5wcm90b3R5cGUuYWZmZWN0c1F1ZXJ5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSwgaW5jbHVkZXMpIHtcclxuICAgICAgICB2YXIgbXV0YXRpb25zID0gdGhpcy5nZXQoKTtcclxuICAgICAgICBpZiAobXV0YXRpb25zLnNvbWUoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0ub3AgPT09ICdtZXJnZScgfHwgbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCc7IH0pKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAocXVlcnkuaWRzKSB7XHJcbiAgICAgICAgICAgIC8vIEEgcXVlcnkgd2l0aCBcImlkc1wiIGZpbHRlciB3aWxsIGJlIGVhc3kgdG8gZGV0ZWN0IGEgbm8tbWF0Y2ggb246XHJcbiAgICAgICAgICAgIHJldHVybiBtdXRhdGlvbnMuc29tZShmdW5jdGlvbiAobSkgeyByZXR1cm4gZ2xvYmFsT3AobSkgfHwgKCFicmFuY2hTZW5zaXRpdmUobSkgfHwgbS5icmFuY2hJZCA9PT0gcXVlcnkuYnJhbmNoSWQpICYmXHJcbiAgICAgICAgICAgICAgICBxdWVyeS5pZHMuaW5jbHVkZXMobS5pZCk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBPdGhlcndpc2UsIGNoZWNrIGlmIG11dGF0aW9ucyBhZmZlY3Qgc2FtZSBicmFuY2ggYW5kIHRhYmxlLiBDb3VsZCBiZSBkb25lIG1vcmUgZmluZSBncmFpbmVkLFxyXG4gICAgICAgIC8vIGJ1dCB0aGF0IHdvdWxkIG9ubHkgYmUgYSBzdWJvcHRpbWl6YXRpb24uXHJcbiAgICAgICAgcmV0dXJuIG11dGF0aW9ucy5zb21lKGZ1bmN0aW9uIChtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBtLm9wID09PSAnZGVsZXRlJyA/XHJcbiAgICAgICAgICAgICAgICBtLnRhYmxlID09PSB0YWJsZSB8fCAoaW5jbHVkZXMuc29tZShmdW5jdGlvbiAobGFiZWwpIHsgcmV0dXJuIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkgPT09IG0udGFibGU7IH0pKSA6XHJcbiAgICAgICAgICAgICAgICBnbG9iYWxPcChtKSA/IHRydWUgOlxyXG4gICAgICAgICAgICAgICAgICAgIG0uYnJhbmNoSWQgPT0gcXVlcnkuYnJhbmNoSWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgKG0udGFibGUgPT09IHRhYmxlIHx8IChtLm9wICE9PSAndXBkYXRlJyAmJiAoW3RhYmxlXS5jb25jYXQoaW5jbHVkZXMubWFwKGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gZ2V0VGFibGVGcm9tTGFiZWwodGFibGUsIGxhYmVsKTsgfSkpLnNvbWUoZnVuY3Rpb24gKHRhYmxlKSB7IHJldHVybiBnZXRUYWJsZUZyb21MYWJlbChtLnRhYmxlLCBtLmdyYXBoUHJvcCkgPT09IHRhYmxlOyB9KSkpKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNdXRhdGlvblF1ZXVlLm1lcmdlID0gZnVuY3Rpb24gKHF1ZXVlMSwgcXVldWUyKSB7XHJcbiAgICAgICAgdmFyIG11dGFibGVRdWV1ZTEgPSBxdWV1ZTEuc2xpY2UoKTtcclxuICAgICAgICB2YXIgbXV0YWJsZVF1ZXVlMiA9IHF1ZXVlMi5zbGljZSgpO1xyXG4gICAgICAgIC8vaWYgKG11dGFibGVRdWV1ZTEubGVuZ3RoID4gMCkgZGVidWdnZXI7XHJcbiAgICAgICAgdmFyIGxlbiA9IHF1ZXVlMS5sZW5ndGg7XHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICB2YXIgbSA9IHF1ZXVlMVtpXTtcclxuICAgICAgICAgICAgaWYgKG0ub3AgPT09ICd1cGRhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3ZlcmxhcHBpbmdJZE9wSWR4ID0gbXV0YWJsZVF1ZXVlMi5maW5kSW5kZXgoZnVuY3Rpb24gKG5ld011dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXdNdXQub3AgPT09ICd1cGRhdGUnICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld011dC5icmFuY2hJZCA9PT0gbS5icmFuY2hJZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdNdXQuaWQgPT09IG0uaWQ7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChvdmVybGFwcGluZ0lkT3BJZHggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTFbaV0gPSB0c2xpYl8xLl9fYXNzaWduKHt9LCBtLCB7IGRlbHRhRG9jOiBtZXJnZURlbHRhcyhtLmRlbHRhRG9jLCBtdXRhYmxlUXVldWUyW292ZXJsYXBwaW5nSWRPcElkeF0uZGVsdGFEb2MpIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG11dGFibGVRdWV1ZTIuc3BsaWNlKG92ZXJsYXBwaW5nSWRPcElkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcclxuICAgICAgICAgICAgX2xvb3BfMShpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG11dGFibGVRdWV1ZTEuY29uY2F0KG11dGFibGVRdWV1ZTIpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNdXRhdGlvblF1ZXVlO1xyXG59KCkpO1xyXG5leHBvcnQgeyBNdXRhdGlvblF1ZXVlIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW11dGF0aW9uLXF1ZXVlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRRdWVyeSB9IGZyb20gJy4va2VkYmFja2VuZC1xdWVyeSc7XHJcbmltcG9ydCAqIGFzIEpzb25TY2hlbWEgZnJvbSAna2VkYmFja2VuZC1zY2hlbWEvc2NoZW1hLmpzb24nO1xyXG5pbXBvcnQgeyBxdWVyeUFycmF5IH0gZnJvbSAnLi91dGlscyc7XHJcbnZhciBRdWVyeVNldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFF1ZXJ5U2V0KG11dGF0aW9uUXVldWUpIHtcclxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBtdXRhdGlvblF1ZXVlO1xyXG4gICAgICAgIHRoaXMucXVlcmllcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLmNvbW1pdE11dGF0aW9ucyA9IGZ1bmN0aW9uIChtdXRhdGlvbnMsIHZlcnNpb24pIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbCh0aGlzLnF1ZXJpZXMubWFwKGZ1bmN0aW9uIChxKSB7IHJldHVybiBxLmNvbW1pdE11dGF0aW9ucyhtdXRhdGlvbnMsIHZlcnNpb24pOyB9KSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFudXBJbnZhbGlkUXVlcmllcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5jbGVhbnVwSW52YWxpZFF1ZXJpZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzID0gdGhpcy5xdWVyaWVzLmZpbHRlcihmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICBpZiAocS5pbnZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocS50aW1lb3V0SGFuZGxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHEudGltZW91dEhhbmRsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcS50aW1lb3V0SGFuZGxlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUubm90aWZ5U3Vic2NyaWJlcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG9wdGltaXN0aWNNdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XHJcbiAgICAgICAgdGhpcy5xdWVyaWVzLmZvckVhY2goZnVuY3Rpb24gKHEpIHtcclxuICAgICAgICAgICAgcS5ub3RpZnlTdWJzY3JpYmVycyhvcHRpbWlzdGljTXV0YXRpb25zKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBRdWVyeVNldC5wcm90b3R5cGUuZmluZFF1ZXJ5ID0gZnVuY3Rpb24gKHRhYmxlLCBxdWVyeSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXJpZXMuZmluZChmdW5jdGlvbiAocSkgeyByZXR1cm4gcS5xdWVyeUtleSA9PT0gS2VkQmFja2VuZFF1ZXJ5LnF1ZXJ5S2V5KHRhYmxlLCBxdWVyeSk7IH0pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS5xdWVyeUxvY2FsbHkgPSBmdW5jdGlvbiAodGFibGUsIHF1ZXJ5LCBpbmNsdWRlcykge1xyXG4gICAgICAgIC8vIEZvciBub3csIG9ubHkgaGFuZGxlIHRoaXMgdmVyeSBjb21tb24gYW5kIHNwZWNpYWwgY2FzZSAod2hpY2hcclxuICAgICAgICAvLyB3aWxsIHNhdmUgYSBsb3Qgb2YgdW5uZXNjZXNzYXJ5IG5ldHdvcmsgdHJhZmZpYyBpZiBJIGFtIHRoaW5raW5nIHJpZ2h0Li4uKVxyXG4gICAgICAgIHZhciBtdXRhdGlvbnMgPSB0aGlzLm11dGF0aW9uUXVldWUuZ2V0KCk7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHF1ZXJ5IHdhbnRzIHRvIGdldCBhIHNpbmdsZSBlbnRpdHkgYnkgaXRzIElEOlxyXG4gICAgICAgIGlmIChxdWVyeS5pZHMgJiYgcXVlcnkuaWRzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAvLyBBbmQgaWYgc28sIGlmIHdlIGhhdmUgYW4gb3V0Z29pbmcgbXV0YXRpb24gdG8gY3JlYXRlIHRoYXQgZW50aXR5OlxyXG4gICAgICAgICAgICBpZiAobXV0YXRpb25zLnNvbWUoZnVuY3Rpb24gKG0pIHsgcmV0dXJuIG0ub3AgPT09ICdhZGQtcmVsYXRlZCcgJiYgbS5yZWxhdGVkRG9jLmlkID09PSBxdWVyeS5pZHNbMF07IH0pKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUaGVuIHJldHVybiBhbiBFTVBUWSByZXNwb25zZSwgc2lnbmFsbGluZyB0aGF0IHdlIGNhbiByZXNvbHZlIHRoaXMgbG9jYWxseSxcclxuICAgICAgICAgICAgICAgIC8vIGJ1dCBsZXQgdGhlIG9wdGlzdGljIGZlYXR1cmUgb2YgS2VkQmFja2VuZFF1ZXJ5IGFwcGx5IHRoZSBtdXRhdGlvbiBiZWZvcmVcclxuICAgICAgICAgICAgICAgIC8vIG5vdGlmeWluZyBzdWJzY3JpYmVycyAod2UgZG9uJ3Qgd2FudCBpdCB0byBiZSBwZXJzaXN0ZW50IGJlZm9yZSB0aGUgc2VydmVyXHJcbiAgICAgICAgICAgICAgICAvLyBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIE9LLCBhbm90aGVyIHF1aXRlIGNvbW1vbiBjYXNlIGlzIHdoZW4gd2UgYXNrIGZvciBhIGNlcnRhaW4gSUQgYW5kIHRoYXQgSUQgcmVwbGllc1xyXG4gICAgICAgIC8vIHdpdGhpbiBhbm90aGVyIHF1ZXJ5XHJcbiAgICAgICAgaWYgKHF1ZXJ5Lmhhc0VkZ2VzRnJvbSB8fCBxdWVyeS5oYXNFZGdlc1RvKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gTm90IHBvc3NpYmxlIHRvIGhhbmRsZVxyXG4gICAgICAgIGlmICghcXVlcnkuaWRzKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gRm9yIG5vdywganVzdCB0YWtlIGhpZ2h0IGZvciB0aGlzIHBhcnRpY3VsYXIgYW5kIG1vc3QgY29tbW9uIGNhc2UhXHJcbiAgICAgICAgdmFyIF9sb29wXzEgPSBmdW5jdGlvbiAocSkge1xyXG4gICAgICAgICAgICBpZiAoIXEuZ290SW5pdGlhbFJlc3BvbnNlKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgaWYgKHEucXVlcnkuYnJhbmNoSWQgIT09IHF1ZXJ5LmJyYW5jaElkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgaWYgKHEucXVlcnkuZmxhZ3MpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiOyAvLyBJdCB3b3VsZCBiZSBjb21wbGV4IHRvIHN1cHBvcnQgdmFyaW91cyBmbGFncy4gUXVlcnkncyBkYXRhIG1heSBpbmNsdWRlIGlkcyBvbmx5LiBDYW4ndCByZWx5IG9uIHRoZSBxdWVyeS5cclxuICAgICAgICAgICAgdmFyIHFJbmNsdWRlcyA9IHEuaW5jbHVkZXM7XHJcbiAgICAgICAgICAgIGlmIChxSW5jbHVkZXMubGVuZ3RoID4gMCAmJiAoIXF1ZXJ5LmluY2x1ZGUgfHwgcXVlcnkuaW5jbHVkZS5sZW5ndGggPT09IDApKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCBpbmNsdWRlLCBidXQgdGhpcyBxdWVyeSBkb2VzLiBDaGVjayBpZiB3ZSBjYW4gZmluZCBvdXIgcmVzdWx0IHdpdGhpbiBpdC5cclxuICAgICAgICAgICAgICAgIHZhciBsYWJlbCA9IHFJbmNsdWRlcy5maW5kKGZ1bmN0aW9uIChsKSB7IHJldHVybiBKc29uU2NoZW1hLnRhYmxlc1txLnRhYmxlXVtcInJlbGF0aW9uc2hpcHNcIl1bbF0gPT09IHRhYmxlOyB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChsYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNfMSA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBxLmRhdGE7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJEYXRhID0gcXVlcnlBcnJheShxdWVyeSwgZW50aXR5W2xhYmVsXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YkRhdGEuZm9yRWFjaChmdW5jdGlvbiAocikgeyByZXR1cm4gcmVzXzFbci5pZF0gPSByOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdF8xID0gT2JqZWN0LmtleXMocmVzXzEpLm1hcChmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIHJlc18xW2lkXTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT25seSByZXR1cm4gcmVzdWx0IGlmIHdlIGNvdWxkIGxvb2sgdXAgZXZlcnkgcmVxdWVzdGVkIElEOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcXVlcnkuaWRzLmV2ZXJ5KGZ1bmN0aW9uIChpZCkgeyByZXR1cm4gcmVzdWx0XzEuc29tZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5pZCA9PT0gaWQ7IH0pOyB9KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogcmVzdWx0XzEgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIWluY2x1ZGVzLmV2ZXJ5KGZ1bmN0aW9uIChsYWJlbCkgeyByZXR1cm4gcUluY2x1ZGVzLmluY2x1ZGVzKGxhYmVsKTsgfSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJjb250aW51ZVwiO1xyXG4gICAgICAgICAgICAvLyBMYXN0bHksIGlmIHRoZSBxdWVyeSBpbmNsdWRlcyBhbGwgZ3JhcGhzIHRoYXQgd2UgZG8sIHBpY2sgdGhlIHN1YnNldCBmcm9tIHRoYXQgcXVlcnkuXHJcbiAgICAgICAgICAgIC8vIENvbmNyZXRlIGV4YW1wbGU6IFdlIG9ic2VydmUgYSBjZXJ0YWluIFRhc2sgYnkgSUQgYW5kIHdhbnQgaXRzIGtub3dsZWRnZVJlcXVpcmVtZW50cyBhbG9uZyB3aXRoIGl0LFxyXG4gICAgICAgICAgICAvLyBhbmQgdGhlcmUncyBhbm90aGVyIHF1ZXJ5IG9mIGFsbCB0YXNrcyB0aGF0IGFsc28gaW5jbHVkZXMga25vd2xlZGdlUmVxdWlyZW1lbnRzLiBVc2UgaXQuIFxyXG4gICAgICAgICAgICBpZiAocS50YWJsZSA9PT0gdGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHRfMiA9IHF1ZXJ5QXJyYXkocXVlcnksIHEuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHJldHVybiByZXN1bHQgaWYgd2UgY291bGQgbG9vayB1cCBldmVyeSByZXF1ZXN0ZWQgSUQ6XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXJ5Lmlkcy5ldmVyeShmdW5jdGlvbiAoaWQpIHsgcmV0dXJuIHJlc3VsdF8yLnNvbWUoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguaWQgPT09IGlkOyB9KTsgfSkpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiByZXN1bHRfMiB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5xdWVyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgcSA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHN0YXRlXzEgPSBfbG9vcF8xKHEpO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgUXVlcnlTZXQucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB2YXIgX2EgPSBzdWJzY3JpcHRpb24uY29sbGVjdGlvbiwgdGFibGUgPSBfYS50YWJsZSwgcXVlcnkgPSBfYS5xdWVyeSwgcmVwbyA9IF9hLnJlcG87XHJcbiAgICAgICAgdmFyIGtiUXVlcnkgPSB0aGlzLmZpbmRRdWVyeSh0YWJsZSwgcXVlcnkpO1xyXG4gICAgICAgIGlmICgha2JRdWVyeSkge1xyXG4gICAgICAgICAgICBrYlF1ZXJ5ID0gbmV3IEtlZEJhY2tlbmRRdWVyeSh0YWJsZSwgcXVlcnksIHJlcG8uZ2V0VXNlcigpLCByZXBvLCB0aGlzLm11dGF0aW9uUXVldWUpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJpZXMucHVzaChrYlF1ZXJ5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUpO1xyXG4gICAgICAgICAgICAgICAga2JRdWVyeS50aW1lb3V0SGFuZGxlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBrYlF1ZXJ5LnN1YnNjcmliZShzdWJzY3JpcHRpb24pO1xyXG4gICAgfTtcclxuICAgIFF1ZXJ5U2V0LnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uIChzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBfYSA9IHN1YnNjcmlwdGlvbi5jb2xsZWN0aW9uLCB0YWJsZSA9IF9hLnRhYmxlLCBxdWVyeSA9IF9hLnF1ZXJ5LCByZXBvID0gX2EucmVwbztcclxuICAgICAgICB2YXIga2JRdWVyeSA9IHRoaXMuZmluZFF1ZXJ5KHRhYmxlLCBxdWVyeSk7XHJcbiAgICAgICAgaWYgKGtiUXVlcnkpIHtcclxuICAgICAgICAgICAgLy8gUHJvaGliaXQgZnVydGhlciBub3RpZmljYXRpb25zIHRvIHRoaXMgc3Vic2NyaXB0aW9uOlxyXG4gICAgICAgICAgICBrYlF1ZXJ5LnVuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIC8vIFJlbGVhc2UgdW5uZXNjZXNzYXJ5IG1lbW9yeSB3aGVuIHRoZXJlIGFyZSBubyBtb3JlIHN1YnNjcmlwdGlvbnMgb2YgdGhpcyBxdWVyeSwgYnkgcmVtb3ZpbmcgdGhlIHF1ZXJ5IGl0c2VsZlxyXG4gICAgICAgICAgICAvLyBUbyB0aGF0IGluIGEgZGVsYXllZCBtYW5uZXIsIHNvIHRoYXQgYW4gdW5zdWJzY3JpYmUoKSBmb2xsb3dlZCBieSBhbiBpbW1lZGlhdGUgc3Vic2NyaWJlKCkgZG9uJ3QgaGF2ZSB0byByZS1xdWVyeSB0aGUgc2VydmVyOlxyXG4gICAgICAgICAgICBpZiAoa2JRdWVyeS5zdWJzY3JpcHRpb25zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU2NoZWR1bGUgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiBpbiA1IG1pbnV0ZXM6XHJcbiAgICAgICAgICAgICAgICBrYlF1ZXJ5LnRpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBrYlF1ZXJ5IHN0aWxsIGhhcyBubyBzdWJzY3JpcHRpb25zIChub3QgY2VydGFpbiEgQSBuZXcgc3Vic2NyaWJlciBtYXkgaGF2ZSBjb21lIGFsb25nLi4uKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChrYlF1ZXJ5LnN1YnNjcmlwdGlvbnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0aWxsIG5vIHN1YnNjcmlwdGlvbnMgb24gaXQsIHRpbWUgdG8gcmVsZWFzZSBzb21lIG1lbW9yeSBhbmQgZm9yZ2V0IHRoZSBpbi1tZW1vcnkgY2FjaGUgb2YgdGhlIHF1ZXJ5IHJlc3VsdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5xdWVyaWVzID0gX3RoaXMucXVlcmllcy5maWx0ZXIoZnVuY3Rpb24gKHEpIHsgcmV0dXJuIHEgIT09IGtiUXVlcnk7IH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIHRoaXMucXVlcmllcy5sZW5ndGggPiA1MCA/XHJcbiAgICAgICAgICAgICAgICAgICAgNTAwIDogLy8gRG9uJ3QgaG9zdCB0b28gbWFueSBxdWVyaWVzLiBHYXJiYWdlIGNvbGxlY3QgdGhpcyB3aXRoaW4gNTAwIG1zXHJcbiAgICAgICAgICAgICAgICAgICAgNSAqIDYwMDAwKTsgLy8gQWxsb3cgcXVlcnkgaW4gbWVtb3J5IGZvciBhbm90aGVyIDUgbWludXRlc1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBRdWVyeVNldDtcclxufSgpKTtcclxuZXhwb3J0IHsgUXVlcnlTZXQgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVlcnktc2V0LmpzLm1hcCIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJ2tlZGJhY2tlbmQtc2NoZW1hL3NjaGVtYS5qc29uJztcclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhYmxlRnJvbUxhYmVsKHRhYmxlLCBsYWJlbCkge1xyXG4gICAgcmV0dXJuIHRhYmxlc1t0YWJsZV0ucmVsYXRpb25zaGlwc1tsYWJlbF07XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIHF1ZXJ5QXJyYXkocXVlcnksIGRhdGEpIHtcclxuICAgIHZhciBmaWx0ZXIgPSBnZXRGaWx0ZXJGcm9tUXVlcnkocXVlcnkpO1xyXG4gICAgcmV0dXJuIGRhdGEuZmlsdGVyKGZpbHRlcik7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIEFORChmaWx0ZXIxLCBmaWx0ZXIyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIGZpbHRlcjEoeCkgJiYgZmlsdGVyMih4KTsgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlsdGVyRnJvbVF1ZXJ5KHF1ZXJ5KSB7XHJcbiAgICB2YXIgZmlsdGVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWU7IH07XHJcbiAgICBpZiAocXVlcnkuZnJvbSlcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguZGF0ZVRpbWUgPj0gcXVlcnkuZnJvbTsgfSk7XHJcbiAgICBpZiAocXVlcnkudG8pXHJcbiAgICAgICAgcmV0dXJuIEFORChmaWx0ZXIsIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LmRhdGVUaW1lIDwgcXVlcnkudG87IH0pO1xyXG4gICAgaWYgKHF1ZXJ5LmlkcylcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHF1ZXJ5Lmlkcy5pbmNsdWRlcyh4LmlkKTsgfSk7XHJcbiAgICBpZiAocXVlcnkubmFtZSlcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgubmFtZSA9PT0gcXVlcnkubmFtZTsgfSk7XHJcbiAgICBpZiAocXVlcnkudGFncylcclxuICAgICAgICByZXR1cm4gQU5EKGZpbHRlciwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudGFncyAmJiBbXS5jb25jYXQocXVlcnkudGFncyB8fCBbXSkuc29tZShmdW5jdGlvbiAodGFnKSB7IHJldHVybiB4LnRhZ3MuaW5jbHVkZXModGFnKTsgfSk7IH0pO1xyXG4gICAgLy8gcXVlcnkuaGFzRWRnZXNGcm9tIGFuZCBxdWVyeS5oYXNFZGdlc1RvIGNhbm5vdCBieSBmaWx0ZXJlZCBoZXJlXHJcbiAgICByZXR1cm4gZmlsdGVyO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBicmFuY2hTZW5zaXRpdmUobSkge1xyXG4gICAgcmV0dXJuIG0ub3AgIT09ICdkZWxldGUnO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBnbG9iYWxPcChtKSB7XHJcbiAgICByZXR1cm4gbS5vcCA9PT0gJ2NsZWFyLWJyYW5jaCcgfHwgbS5vcCA9PT0gJ21lcmdlJztcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZSBmcm9tICcuL21pZ3JhdGUnO1xyXG5leHBvcnQgdmFyIEtlZE1vZGVsTWlncmF0b3JNaXhpbiA9IGZ1bmN0aW9uIChjbGllbnQpIHtcclxuICAgIGlmIChjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbilcclxuICAgICAgICByZXR1cm47XHJcbiAgICBjbGllbnQuX19taWdyYXRvcl9taXhlZF9pbiA9IHRydWU7XHJcbiAgICB2YXIgZ2V0ID0gY2xpZW50LmdldDtcclxuICAgIHZhciBsaXN0ID0gY2xpZW50Lmxpc3Q7XHJcbiAgICBjbGllbnQuZ2V0ID0gZnVuY3Rpb24gKHRhYmxlLCBpZCwgb3B0aW9ucykge1xyXG4gICAgICAgIHZhciBpbmNsdWRlID0gb3B0aW9ucyAmJiBvcHRpb25zLmluY2x1ZGU7XHJcbiAgICAgICAgcmV0dXJuIGdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBtaWdyYXRlKHJlc3VsdCwgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIGNsaWVudC5saXN0ID0gZnVuY3Rpb24gKHRhYmxlLCBvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIGluY2x1ZGUgPSBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZTtcclxuICAgICAgICByZXR1cm4gbGlzdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoZG9jKSB7IHJldHVybiBtaWdyYXRlKGRvYywgdGFibGUsIGluY2x1ZGUgJiYgaW5jbHVkZS50b1N0cmluZygpLnNwbGl0KCcsJykpOyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gY2xpZW50O1xyXG59O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgbWlncmF0ZVRhc2sgZnJvbSAnLi9taWdyYXRlLXRhc2snO1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtaWdyYXRlQ291cnNlKGNvdXJzZSwgZ3JhcGhzKSB7XHJcbiAgICBpZiAoIWNvdXJzZS5tb2R1bGVzKVxyXG4gICAgICAgIGNvdXJzZS5tb2R1bGVzID0gW107XHJcbiAgICBjb3Vyc2UubW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGUpIHtcclxuICAgICAgICBpZiAoIW1vZHVsZS5yZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgbW9kdWxlLnJlc291cmNlcyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIW1vZHVsZS50YXNrSWRzKSB7XHJcbiAgICAgICAgICAgIG1vZHVsZS50YXNrSWRzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBpZiAoIWNvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzKSB7XHJcbiAgICAgICAgY291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMgPSBbXTtcclxuICAgIH1cclxuICAgIC8vIEVhcmxpZXIgd3Jvbmcgc3BlbGxpbmcgb2YgcmVzb3VyY2VzXHJcbiAgICBpZiAoJ3Jlc291cnNlcycgaW4gY291cnNlICYmICEoJ3Jlc291cmNlcycgaW4gY291cnNlKSkge1xyXG4gICAgICAgIGNvdXJzZS5yZXNvdXJjZXMgPSBjb3Vyc2UucmVzb3Vyc2VzO1xyXG4gICAgICAgIGRlbGV0ZSBjb3Vyc2UucmVzb3Vyc2VzO1xyXG4gICAgfVxyXG4gICAgaWYgKCFjb3Vyc2UucmVzb3VyY2VzKSB7XHJcbiAgICAgICAgY291cnNlLnJlc291cmNlcyA9IFtdO1xyXG4gICAgfVxyXG4gICAgaWYgKGdyYXBocykge1xyXG4gICAgICAgIGdyYXBocy5mb3JFYWNoKGZ1bmN0aW9uIChsYWJlbCkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKGxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICd0YXNrcyc6XHJcbiAgICAgICAgICAgICAgICAgICAgY291cnNlLnRhc2tzLmZvckVhY2goZnVuY3Rpb24gKHRhc2spIHsgcmV0dXJuIG1pZ3JhdGVUYXNrKHRhc2spOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1pZ3JhdGUtY291cnNlLmpzLm1hcCIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGVUYXNrKHRhc2spIHtcclxuICAgIGlmICghdGFzay5yZXNvdXJjZXMpXHJcbiAgICAgICAgdGFzay5yZXNvdXJjZXMgPSBbXTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLXRhc2suanMubWFwIiwiaW1wb3J0IG1pZ3JhdGVDb3Vyc2UgZnJvbSAnLi9taWdyYXRlLWNvdXJzZSc7XHJcbmltcG9ydCBtaWdyYXRlVGFzayBmcm9tICcuL21pZ3JhdGUtdGFzayc7XHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1pZ3JhdGUoZG9jLCB0YWJsZSwgZ3JhcGhzKSB7XHJcbiAgICBzd2l0Y2ggKHRhYmxlKSB7XHJcbiAgICAgICAgY2FzZSBcImNvdXJzZXNcIjpcclxuICAgICAgICAgICAgbWlncmF0ZUNvdXJzZShkb2MsIGdyYXBocyk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJ0YXNrc1wiOlxyXG4gICAgICAgICAgICBtaWdyYXRlVGFzayhkb2MpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIH1cclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taWdyYXRlLmpzLm1hcCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9vYnNlcnZhYmxlXCI7XHJcbmltcG9ydCB7IGluaXRNYXBNZXRob2QgfSBmcm9tIFwiLi9tYXBcIjtcclxuaW1wb3J0IHsgVmFsdWUgfSBmcm9tIFwiLi92YWx1ZVwiO1xyXG5pbXBvcnQgeyBFbWl0dGVyIH0gZnJvbSBcIi4vZW1pdHRlclwiO1xyXG52YXIgQ29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENvbGxlY3Rpb24sIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBDb2xsZWN0aW9uKHN1YnNjcmliZSkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBzdWJzY3JpYmUpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5fbWFwID0gZnVuY3Rpb24gKG1hcHBlcikge1xyXG4gICAgICAgIHRocm93IFwibWl4ZWRpblwiO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24uZnJvbSA9IGZ1bmN0aW9uICh4KSB7XHJcbiAgICAgICAgaWYgKHguc3Vic2NyaWJlKVxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbGxlY3Rpb24oZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHguc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh4KSkge1xyXG4gICAgICAgICAgICB2YXIgZW1pdHRlcl8xID0gbmV3IEVtaXR0ZXIoeCk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gZW1pdHRlcl8xLnN1YnNjcmliZShzKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9ic2VydmFibGVDb2xsZWN0aW9uLmZyb20oKSBjYW4gb25seSB0YWtlIGFycmF5cyBvciBvYnNlcnZhYmxlc1wiKTtcclxuICAgIH07XHJcbiAgICBDb2xsZWN0aW9uLnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbiAobWFwcGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21hcChmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gbWFwcGVyKGl0ZW0pOyB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZmxhdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCBpdGVtcyk7IH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmaWx0ZXIpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbWFwKGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMuZmlsdGVyKGZpbHRlcik7IH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHJldHVybiBDb2xsZWN0aW9uLmZyb20odGhpcy50b1ZhbHVlKCkuY29tYmluZUxhdGVzdChvdGhlcikubWFwKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICB2YXIgbWUgPSBfYVswXSwgb3RoZXIgPSBfYVsxXTtcclxuICAgICAgICAgICAgcmV0dXJuIG1lLmNvbmNhdChvdGhlcik7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLm9yZGVyQnkgPSBmdW5jdGlvbiAocHJvcCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVmFsdWUoKS5tYXAoZnVuY3Rpb24gKGFycmF5KSB7IHJldHVybiBhcnJheS5zbGljZSgpLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgdmFyIGFQcm9wID0gYSAmJiBhW3Byb3BdO1xyXG4gICAgICAgICAgICB2YXIgYlByb3AgPSBiICYmIGJbcHJvcF07XHJcbiAgICAgICAgICAgIHJldHVybiBhUHJvcCA+IGJQcm9wID8gMSA6IGFQcm9wIDwgYlByb3AgPyAtMSA6IDA7XHJcbiAgICAgICAgfSk7IH0pLnRvQ29sbGVjdGlvbihmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUudG9WYWx1ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShzKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgQ29sbGVjdGlvbi5wcm90b3R5cGUuZ3JvdXBCeSA9IGZ1bmN0aW9uIChwcm9wKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9WYWx1ZSgpLm1hcChmdW5jdGlvbiAoaXRlbXMpIHtcclxuICAgICAgICAgICAgdmFyIHJ2ID0ge307XHJcbiAgICAgICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gcnZbaXRlbVtwcm9wXV0gfHwgKHJ2W2l0ZW1bcHJvcF1dID0gW10pO1xyXG4gICAgICAgICAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJ2O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIENvbGxlY3Rpb24ucHJvdG90eXBlLmZpcnN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRvVmFsdWUoKS5tYXAoZnVuY3Rpb24gKGFycikgeyByZXR1cm4gYXJyWzBdOyB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29sbGVjdGlvbjtcclxufShPYnNlcnZhYmxlKSk7XHJcbmV4cG9ydCB7IENvbGxlY3Rpb24gfTtcclxuQ29sbGVjdGlvbi5wcm90b3R5cGUuX21hcCA9IGluaXRNYXBNZXRob2QoQ29sbGVjdGlvbik7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbGxlY3Rpb24uanMubWFwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgVmFsdWUgfSBmcm9tIFwiLi92YWx1ZVwiO1xyXG52YXIgRW1pdHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEVtaXR0ZXIsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBFbWl0dGVyKGluaXRpYWxWYWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZXJzID0gX3RoaXMuc3Vic2NyaWJlcnMuZmlsdGVyKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzID0gX2FbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHMgIT09IG9ic2VydmVyO1xyXG4gICAgICAgICAgICAgICAgfSk7IH0sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIF90aGlzLnN1YnNjcmliZXJzLnB1c2goW29ic2VydmVyLCBzdWJzY3JpcHRpb25dKTtcclxuICAgICAgICAgICAgaWYgKF90aGlzLmVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyKF90aGlzLnZhbHVlLCB1bmRlZmluZWQsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5zdWJzY3JpYmVycyA9IFtdO1xyXG4gICAgICAgIF90aGlzLnZhbHVlID0gaW5pdGlhbFZhbHVlO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIEVtaXR0ZXIucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2goKTtcclxuICAgIH07XHJcbiAgICBFbWl0dGVyLnByb3RvdHlwZS5kaXNwYXRjaEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xyXG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoKCk7XHJcbiAgICB9O1xyXG4gICAgRW1pdHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBfYVswXSwgc3Vic2NyaXB0aW9uID0gX2FbMV07XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZlcihfdGhpcy52YWx1ZSwgX3RoaXMuZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEVtaXR0ZXI7XHJcbn0oVmFsdWUpKTtcclxuZXhwb3J0IHsgRW1pdHRlciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbWl0dGVyLmpzLm1hcCIsInZhciBzdGFjayA9IFtdO1xyXG52YXIgY3VycmVudEZpYmVyID0gbnVsbDtcclxudmFyIHByb3ZpZGVycyA9IFtmdW5jdGlvbiAoKSB7IHJldHVybiBjdXJyZW50RmliZXI7IH1dO1xyXG5mdW5jdGlvbiBwdXNoRmliZXIoZmliZXIpIHtcclxuICAgIHN0YWNrLnB1c2goY3VycmVudEZpYmVyKTtcclxuICAgIGN1cnJlbnRGaWJlciA9IGZpYmVyO1xyXG59XHJcbmZ1bmN0aW9uIHBvcEZpYmVyKCkge1xyXG4gICAgY3VycmVudEZpYmVyID0gc3RhY2sucG9wKCk7XHJcbn1cclxuZXhwb3J0IHZhciBGaWJlckNvbnRleHQgPSB7XHJcbiAgICBnZXQgY3VycmVudCgpIHsgcmV0dXJuIGN1cnJlbnRGaWJlcjsgfSxcclxuICAgIC8qcnVuOiBmdW5jdGlvbiByZXJ1bjxSPihmaWJlcjogRmliZXIsIGZuOiAoKT0+Uik6IFIgfCBQcm9taXNlPFI+IHtcclxuICAgICAgcHVzaEZpYmVyKGZpYmVyKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZuKCkpO1xyXG4gICAgICB9IGNhdGNoIChwKSB7XHJcbiAgICAgICAgaWYgKHAgJiYgdHlwZW9mIHAudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgcmV0dXJuIHAudGhlbigoKT0+cmVydW4oZmliZXIsIGZuKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZmluYWxseSB7XHJcbiAgICAgICAgcG9wRmliZXIoKTtcclxuICAgICAgfVxyXG4gICAgfSwqL1xyXG4gICAgYWRkUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcclxuICAgICAgICBwcm92aWRlcnMucHVzaChnZXRDdXJyZW50RmliZXIpO1xyXG4gICAgICAgIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCk7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlUHJvdmlkZXI6IGZ1bmN0aW9uIChnZXRDdXJyZW50RmliZXIpIHtcclxuICAgICAgICBwcm92aWRlcnMgPSBwcm92aWRlcnMuZmlsdGVyKGZ1bmN0aW9uIChwKSB7IHJldHVybiBwICE9PSBnZXRDdXJyZW50RmliZXI7IH0pO1xyXG4gICAgICAgIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCk7XHJcbiAgICB9XHJcbn07XHJcbmZ1bmN0aW9uIHNldEN1cnJlbnRHZXR0ZXJGcm9tUHJvdmlkZXJzKCkge1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpYmVyQ29udGV4dCwgXCJjdXJyZW50XCIsIHtcclxuICAgICAgICBnZXQ6IHByb3ZpZGVycy5yZWR1Y2UoZnVuY3Rpb24gKHAsIGMpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHAoKSB8fCBjKCk7IH07IH0pLFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoXCJVc2UgRmliZXJDb250ZXh0LnB1c2goKSB0byBjaGFuZ2UgY3VycmVudCBmaWJlclwiKTsgfVxyXG4gICAgfSk7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmliZXItY29udGV4dC5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL29ic2VydmFibGUnO1xyXG5leHBvcnQgKiBmcm9tICcuL3ZhbHVlJztcclxuZXhwb3J0ICogZnJvbSAnLi9jb2xsZWN0aW9uJztcclxuZXhwb3J0ICogZnJvbSAnLi9lbWl0dGVyJztcclxuZXhwb3J0ICogZnJvbSAnLi9maWJlci1jb250ZXh0JztcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0IGZ1bmN0aW9uIGluaXRNYXBNZXRob2QoY3Rvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgY3RvcihmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobWFwcGVyKHZhbHVlKSwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pOyB9KTtcclxuICAgIH07XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWFwLmpzLm1hcCIsImV4cG9ydCBmdW5jdGlvbiBtaXhpbih0YXJnZXRQcm90bywgbWl4aW5Qcm90bykge1xyXG4gICAgdmFyIHByb3BzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHByb3BzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgcHJvcHMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkgeyByZXR1cm4gdGFyZ2V0UHJvdG9bcHJvcF0gPSBtaXhpblByb3RvW3Byb3BdOyB9KTtcclxufVxyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1taXhpbi5qcy5tYXAiLCJ2YXIgT2JzZXJ2YWJsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vc3RhdGljIGdldCBbU3ltYm9sLnNwZWNpZXNdKCkgeyByZXR1cm4gdGhpczsgfVxyXG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZShfc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgdGhpcy5fc3Vic2NyaWJlID0gX3N1YnNjcmliZTtcclxuICAgIH1cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUoZnVuY3Rpb24gKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKGl0ZW1zLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnIsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHsgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHsgfSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE9ic2VydmFibGU7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IE9ic2VydmFibGUgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2YWJsZS5qcy5tYXAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcIi4vb2JzZXJ2YWJsZVwiO1xyXG5pbXBvcnQgeyBpbml0TWFwTWV0aG9kIH0gZnJvbSBcIi4vbWFwXCI7XHJcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tIFwiLi9jb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IEZpYmVyQ29udGV4dCB9IGZyb20gJy4vZmliZXItY29udGV4dCc7XHJcbnZhciBWYWx1ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFZhbHVlLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gVmFsdWUoc3Vic2NyaWJlKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHN1YnNjcmliZSkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFZhbHVlLmZyb20gPSBmdW5jdGlvbiAoeCkge1xyXG4gICAgICAgIGlmICh4LnN1YnNjcmliZSlcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAocykgeyByZXR1cm4geC5zdWJzY3JpYmUocyk7IH0pO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlLmZyb20oKSBjYW4gb25seSB0YWtlIG9ic2VydmFibGVzXCIpO1xyXG4gICAgfTtcclxuICAgIFZhbHVlLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZXNvbHZlZCA9IGZhbHNlLCByZXN1bHQsIGVyciwgbm90aWZ5O1xyXG4gICAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB0aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY2lwdGlvbikge1xyXG4gICAgICAgICAgICByZXNvbHZlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xyXG4gICAgICAgICAgICBlcnIgPSBlcnJvcjtcclxuICAgICAgICAgICAgaWYgKGVycm9yICYmIG5vdGlmeSlcclxuICAgICAgICAgICAgICAgIG5vdGlmeShudWxsLCBlcnJvciwgc3Vic2NpcHRpb24pO1xyXG4gICAgICAgICAgICBlbHNlIGlmIChub3RpZnkpXHJcbiAgICAgICAgICAgICAgICBub3RpZnkodmFsdWUsIG51bGwsIHN1YnNjaXB0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAocmVzb2x2ZWQpIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnRGaWJlciA9IEZpYmVyQ29udGV4dC5jdXJyZW50O1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEZpYmVyIENvbnRleHRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSBjdXJyZW50RmliZXIuc3Vic2NyaXB0aW9ucywgb2JzZXJ2ZXIgPSBjdXJyZW50RmliZXIub2JzZXJ2ZXI7XHJcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICBub3RpZnkgPSBvYnNlcnZlcjtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBub3RpZnkgPSBmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgc3Vic2NpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnJvcilcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgc3Vic2NpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChmbikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAodmFsdWUsIGVycm9yLCBzdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGZuKHZhbHVlKSlcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uIChwcmVmaXgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKHgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cocHJlZml4LCB4KTtcclxuICAgICAgICAgICAgcmV0dXJuIHg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLnRvQ29sbGVjdGlvbiA9IGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ29sbGVjdGlvbihmdW5jdGlvbiAocykgeyByZXR1cm4gX3RoaXMubWFwKG1hcHBlcikuc3Vic2NyaWJlKHMpOyB9KTtcclxuICAgIH07XHJcbiAgICBWYWx1ZS5wcm90b3R5cGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uIChvdGhlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWYWx1ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtudWxsLCBudWxsXTtcclxuICAgICAgICAgICAgdmFyIG15U3Vic2NyaXB0aW9uLCBvdGhlclN1YnNjcmlwdGlvbjtcclxuICAgICAgICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbXlTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBvdGhlclN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBteVN1YnNjcmlwdGlvbiA9IF90aGlzLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMsIGVycm9yLCBzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBzLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIobnVsbCwgZXJyb3IsIHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YWx1ZXNbMF0gPSBpdGVtcztcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbMV0gIT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWVzLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgb3RoZXJTdWJzY3JpcHRpb24gPSBvdGhlci5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcy51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFsdWVzWzFdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzWzBdICE9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKHZhbHVlcywgbnVsbCwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgVmFsdWUucHJvdG90eXBlLnN3aXRjaE1hcCA9IGZ1bmN0aW9uIChtYXBwZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgVmFsdWUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgdmFyIHJldHVybmVkU3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICAgICAgICAgICAgdW5zdWJzY3JpYmU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWFwcGVkU3Vic2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gX3RoaXMuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gcztcclxuICAgICAgICAgICAgICAgIGlmIChtYXBwZWRTdWJzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKVxyXG4gICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG51bGwsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZU9yVmFsdWUgPSBtYXBwZXIoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZhYmxlT3JWYWx1ZSAmJiB0eXBlb2Ygb2JzZXJ2YWJsZU9yVmFsdWUuc3Vic2NyaWJlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBwZWRTdWJzY3JpcHRpb24gPSBvYnNlcnZhYmxlT3JWYWx1ZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHZhbHVlLCBlcnJvciwgcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcHBlZFN1YnNjcmlwdGlvbiA9IHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIodmFsdWUsIGVycm9yLCByZXR1cm5lZFN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyKG9ic2VydmFibGVPclZhbHVlLCBudWxsLCBzdWJzY3JpcHRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlcihudWxsLCBlcnJvciwgc3Vic2NyaXB0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmV0dXJuZWRTdWJzY3JpcHRpb247XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFZhbHVlO1xyXG59KE9ic2VydmFibGUpKTtcclxuZXhwb3J0IHsgVmFsdWUgfTtcclxuVmFsdWUucHJvdG90eXBlLm1hcCA9IGluaXRNYXBNZXRob2QoVmFsdWUpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD12YWx1ZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tICcuL2pzL2Rpc3QvanMva2VkLWJhY2tlbmQtcmVwbyc7XHJcbiIsInZhciBtYXAgPSB7XG5cdFwiLi9lbi1TR1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tU0cuanNcIixcblx0XCIuL2VuLVNHLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1TRy5qc1wiLFxuXHRcIi4vZW4tYXVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWF1LmpzXCIsXG5cdFwiLi9lbi1hdS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tYXUuanNcIixcblx0XCIuL2VuLWNhXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1jYS5qc1wiLFxuXHRcIi4vZW4tY2EuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWNhLmpzXCIsXG5cdFwiLi9lbi1nYlwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tZ2IuanNcIixcblx0XCIuL2VuLWdiLmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1nYi5qc1wiLFxuXHRcIi4vZW4taWVcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWllLmpzXCIsXG5cdFwiLi9lbi1pZS5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4taWUuanNcIixcblx0XCIuL2VuLWlsXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1pbC5qc1wiLFxuXHRcIi4vZW4taWwuanNcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL2VuLWlsLmpzXCIsXG5cdFwiLi9lbi1uelwiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvZW4tbnouanNcIixcblx0XCIuL2VuLW56LmpzXCI6IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZS9lbi1uei5qc1wiLFxuXHRcIi4vc3ZcIjogXCIuL25vZGVfbW9kdWxlcy9tb21lbnQvbG9jYWxlL3N2LmpzXCIsXG5cdFwiLi9zdi5qc1wiOiBcIi4vbm9kZV9tb2R1bGVzL21vbWVudC9sb2NhbGUvc3YuanNcIlxufTtcblxuXG5mdW5jdGlvbiB3ZWJwYWNrQ29udGV4dChyZXEpIHtcblx0dmFyIGlkID0gd2VicGFja0NvbnRleHRSZXNvbHZlKHJlcSk7XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKGlkKTtcbn1cbmZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0UmVzb2x2ZShyZXEpIHtcblx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhtYXAsIHJlcSkpIHtcblx0XHR2YXIgZSA9IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyByZXEgKyBcIidcIik7XG5cdFx0ZS5jb2RlID0gJ01PRFVMRV9OT1RfRk9VTkQnO1xuXHRcdHRocm93IGU7XG5cdH1cblx0cmV0dXJuIG1hcFtyZXFdO1xufVxud2VicGFja0NvbnRleHQua2V5cyA9IGZ1bmN0aW9uIHdlYnBhY2tDb250ZXh0S2V5cygpIHtcblx0cmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59O1xud2VicGFja0NvbnRleHQucmVzb2x2ZSA9IHdlYnBhY2tDb250ZXh0UmVzb2x2ZTtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0NvbnRleHQ7XG53ZWJwYWNrQ29udGV4dC5pZCA9IFwiLi9ub2RlX21vZHVsZXMvbW9tZW50L2xvY2FsZSBzeW5jIHJlY3Vyc2l2ZSBzdnxlblwiOyIsImltcG9ydCB7IFVzZXIgfSBmcm9tIFwiLi4vY29udHJhY3RzL2tlZC1tb2RlbHNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFVzZXJDbGFpbXMgKHVzZXI6IFVzZXIpIHtcclxuICByZXR1cm4gW3tcclxuICAgIHR5cGU6IFwiZW1haWxcIixcclxuICAgIHZhbHVlOiB1c2VyLm1haWxcclxuICB9LHtcclxuICAgIHR5cGU6IFwic2Nob29sXCIsXHJcbiAgICB2YWx1ZTogdXNlci5zY2hvb2xcclxuICB9XS5jb25jYXQodXNlci5yb2xlcy5tYXAocm9sZSA9PiAoe1xyXG4gICAgdHlwZTogXCJyb2xlXCIsXHJcbiAgICB2YWx1ZTogcm9sZVxyXG4gIH0pKSkuY29uY2F0KHVzZXIucm9sZXMubWFwKHJvbGUgPT4gKHtcclxuICAgIHR5cGU6IFwic2Nob29sUm9sZVwiLFxyXG4gICAgdmFsdWU6IHVzZXIuc2Nob29sICsgXCIvXCIgKyByb2xlXHJcbiAgfSkpKTtcclxufVxyXG4iLCJpbXBvcnQgeyBBY2Nlc3NDbGFpbSwgRG9jdW1lbnRBY2Nlc3MsIGhhc0FjY2VzcyBhcyBfaGFzQWNjZXNzLCBBY2Nlc3NSaWdodCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgRG9jdW1lbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBnZXRVc2VyQ2xhaW1zIGZyb20gJy4vZ2V0LXVzZXItY2xhaW1zJztcclxuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZywgZ2VuZXJhdGVRdWVyeVN0cmluZyB9IGZyb20gXCIuLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuZXhwb3J0IHsgZ2V0VXNlckNsYWltcyB9O1xyXG5cclxuZXhwb3J0IGNvbnN0IElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TID0gW1widXNlclwiLFwicm9sZVwiLFwic2Nob29sXCIsXCJkZWJ1Z1wiLFwidGVzdFZlcnNpb25cIixcInRlc3R2ZXJzaW9uXCIsXCJzY2hvb2xUeXBlXCIsXCJzY2hvb2x0eXBlXCJdO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhc0FjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50LCByZXF1ZXN0ZWRSaWdodDogQWNjZXNzUmlnaHQpIHtcclxuICB2YXIgY2xhaW1zID0gZ2V0VXNlckNsYWltcyh1c2VyKTtcclxuICBpZiAocmVxdWVzdGVkUmlnaHQgIT09ICdSJyAmJiB1c2VyLnR1dG9yRm9yKSB7XHJcbiAgICBjbGFpbXMgPSBjbGFpbXMuZmlsdGVyKGNsYWltID0+IGNsYWltLnR5cGUgIT09ICdlbWFpbCcpO1xyXG4gIH1cclxuICB2YXIgcmVzdWx0ID0gX2hhc0FjY2VzcyhEb2N1bWVudEFjY2Vzcy5mcm9tU3RyaW5nQXJyYXkoZG9jLmFjbCB8fCBbXSksIGNsYWltcywgcmVxdWVzdGVkUmlnaHQpO1xyXG4gIC8vY29uc29sZS5sb2coYEhhcyAke3JlcXVlc3RlZFJpZ2h0fSBhY2Nlc3MgdG8gJHtkb2MubmFtZX0vJHtkb2MuaWR9OiAke3Jlc3VsdH1gKTtcclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzUmVhZEFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XHJcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdSJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNXcml0ZUFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XHJcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdXJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNTaGFyZUFjY2Vzcyh1c2VyOiBVc2VyLCBkb2M6IERvY3VtZW50KSB7XHJcbiAgcmV0dXJuIGhhc0FjY2Vzcyh1c2VyLCBkb2MsICdTJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1RlYWNoZXJBdFNjaG9vbCh1c2VyOiBVc2VyLCBzY2hvb2w6IHN0cmluZykge1xyXG4gIGNvbnN0IGlzVGVhY2hlciA9IHVzZXIucm9sZXMuc29tZShyb2xlID0+IHJvbGUgPT09ICdFTVBMT1lFRScgfHwgcm9sZSA9PT0gJ0FETUlOJyk7XHJcbiAgY29uc3QgYmVsb25nc1RvU2Nob29sID0gKHNjaG9vbHx8XCJcIikudG9Mb3dlckNhc2UoKSA9PT0gdXNlci5zY2hvb2wudG9Mb3dlckNhc2UoKTtcclxuICByZXR1cm4gKGlzVGVhY2hlciAmJiBiZWxvbmdzVG9TY2hvb2wpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNBZG1pbk9yVGVhY2hlckF0U2Nob29sKHVzZXI6IFVzZXIsIHNjaG9vbDogc3RyaW5nKSB7XHJcbiAgcmV0dXJuIHVzZXIucm9sZXMuaW5jbHVkZXMoXCJBRE1JTlwiKSB8fCBpc1RlYWNoZXJBdFNjaG9vbCh1c2VyLCBzY2hvb2wpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgaW1wZXJzb25hdGlvbkVudiA9IHtcclxuICBhY3RBcyAob3B0aW9uczoge3JvbGUsIHNjaG9vbCwgdXJsP30pIHtcclxuICAgIGNvbnN0IHtyb2xlLCBzY2hvb2wsIHVybH0gPSBvcHRpb25zO1xyXG4gICAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xyXG4gICAgY29uc3QgbmV3UXVlcnkgPSB7Li4uY3VycmVudFF1ZXJ5LCByb2xlLCBzY2hvb2x9O1xyXG4gICAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKG5ld1F1ZXJ5KTtcclxuICAgIGlmICh1cmwpIHtcclxuICAgICAgbG9jYXRpb24uaHJlZiA9IGAke3VybH0ke25ld1F1ZXJ5U3RyaW5nfWA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBsb2NhdGlvbi5oYXNoID0gXCIjXCI7XHJcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCA9IG5ld1F1ZXJ5U3RyaW5nO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFjdEFzKG9wdGlvbnM6IHtyb2xlLCBzY2hvb2wsIHVybD99KSB7XHJcbiAgaW1wZXJzb25hdGlvbkVudi5hY3RBcyhvcHRpb25zKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5ICh1cmw6IHN0cmluZywgcXVlcnk6IHtbbmFtZTogc3RyaW5nXSA6IHN0cmluZ30pIHtcclxuICBjb25zdCBjdXJyZW50UXVlcnkgPSBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgY29uc3QgcHJlc2VydmVkUXVlcnkgPSB7fTtcclxuICBmb3IgKGNvbnN0IHBhcmFtIG9mIElNUEVSU09OQVRJT05fUVVFUllfUEFSQU1TKSB7XHJcbiAgICBpZiAoY3VycmVudFF1ZXJ5W3BhcmFtXSkgcHJlc2VydmVkUXVlcnlbcGFyYW1dID0gY3VycmVudFF1ZXJ5W3BhcmFtXTtcclxuICB9XHJcbiAgY29uc3QgbmV3UXVlcnlTdHJpbmcgPSBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHsuLi5wcmVzZXJ2ZWRRdWVyeSwgLi4ucXVlcnl9KTtcclxuICBjb25zdCBwSGFzaCA9IHVybC5pbmRleE9mKCcjJyk7XHJcbiAgcmV0dXJuIHBIYXNoID49IDAgP1xyXG4gICAgYCR7dXJsLnN1YnN0cigwLHBIYXNoKX0ke25ld1F1ZXJ5U3RyaW5nfSR7dXJsLnN1YnN0cihwSGFzaCl9YCA6XHJcbiAgICBgJHt1cmx9JHtuZXdRdWVyeVN0cmluZ31gO1xyXG59XHJcbiIsImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuXHJcbmNvbnN0IEljb25Ecml2ZSA9ICh7IHNpemUgPSAzMCB9KSA9PiAoXHJcbiAgPHN2Z1xyXG4gICAgd2lkdGg9e3NpemV9XHJcbiAgICB2ZXJzaW9uPVwiMS4xXCJcclxuICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxyXG4gICAgeG1sbnNYbGluaz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIlxyXG4gICAgdmlld0JveD1cIjAgMCA1MDguNTIgNTA4LjUyXCJcclxuICAgIGZpbGw9XCIjZmZmZmZmXCJcclxuICAgIHN0eWxlPXt7dmVydGljYWxBbGlnbjogXCJtaWRkbGVcIiwgbWFyZ2luUmlnaHQ6IFwiNHB4XCJ9fVxyXG4gID5cclxuICAgIDxwb2x5Z29uIHBvaW50cz1cIjQ4NC40OTIsMjg0LjU4IDMzOS4wMjQsMzIuNTc3IDE2OS40OTYsMzIuNTc3IDMxNC45OTYsMjg0LjU4XCIgLz5cclxuICAgIDxwb2x5Z29uIHBvaW50cz1cIjE0NS40MzcsNzQuMjc2IDAsMzI2LjI3OSA4NC43NjQsNDczLjA1IDIzMC4xNjksMjIxLjE0M1wiIC8+XHJcbiAgICA8cG9seWdvbiBwb2ludHM9XCIyMzQuMzk2LDMxNi4zNjMgMTQzLjM3MSw0NzUuOTQzIDQyMy43NTYsNDc1Ljk0MyA1MDguNTIsMzE2LjM2XCIgLz5cclxuICA8L3N2Zz5cclxuKTtcclxuXHJcbmNvbnN0IEljb25DbGFzc3Jvb20gPSAoeyBzaXplID0gMzAgfSkgPT4gKFxyXG4gIDxzdmdcclxuICAgIHdpZHRoPXtzaXplfVxyXG4gICAgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiXHJcbiAgICB4bWxuc1hsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiXHJcbiAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcclxuICAgIHZlcnNpb249XCIxLjFcIlxyXG4gID5cclxuICAgIDxwYXRoIGQ9XCJNNSAyQzMuMzQ4IDIgMiAzLjM0OCAyIDV2MTRjMCAxLjY1MiAxLjM0OCAzIDMgM2gxNGMxLjY1MiAwIDMtMS4zNDggMy0zVjVjMC0xLjY1Mi0xLjM0OC0zLTMtM3ptMCAyaDE0Yy41NSAwIDEgLjQ1IDEgMXYxNGMwIC41NS0uNDUgMS0xIDFoLTF2LTJoLTV2Mkg1Yy0uNTUgMC0xLS40NS0xLTFWNWMwLS41NS40NS0xIDEtMXptNyAyYTEuOTk5IDEuOTk5IDAgMSAwIDAgNCAxLjk5OSAxLjk5OSAwIDEgMCAwLTR6TTcuNSA4YTEuNSAxLjUgMCAxIDAgMCAzIDEuNSAxLjUgMCAwIDAgMC0zem05IDBhMS41IDEuNSAwIDEgMCAwIDMgMS41IDEuNSAwIDAgMCAwLTN6TTEyIDExYy0yLjY2IDAtMy41IDIuNS0zLjUgMi41IDAtLjg0OC41LTEuNS41LTEuNS0uMy0uMTg4LTEuMDctLjMxMy0xLjQzOC0uMzEzLTEuMjE0IDAtMi41NjIgMS4xOTItMi41NjIgMlYxNmgxNHYtMi4zMTNjMC0uODA4LTEuNTEyLTItMi41NjMtMi0uMzY3IDAtMS4xMzYuMTI2LTEuNDM3LjMxMyAwIDAgLjUuNjUyLjUgMS41IDAgMC0uODQtMi41LTMuNS0yLjV6XCIgLz5cclxuICA8L3N2Zz5cclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBEcml2ZUJ1dHRvbiA9ICh7bGFiZWw9J0dvb2dsZSBEcml2ZScsIGFjdGlvbn0pID0+IFxyXG4gIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2FjdGlvbn0+PEljb25Ecml2ZSBzaXplPXsxNn0gLz4ge2xhYmVsfTwvYT5cclxuIiwiaW1wb3J0IHsgRURTQ291cnNlLCBFRFNBc3Nlc3NtZW50LCBFRFNTdHVkeVBsYW4sIEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5LCBFRFNTdHVkZW50LCBFRFNUdWl0aW9uR3JvdXAsIEVEU1R1aXRpb25TdHVkZW50LCBFRFNUZWFjaGVyLCBNb2NrRURTQWNhZGVtaWNZZWFyLCBNb2NrRURTRGF0ZVJhbmdlIH0gZnJvbSAnLi4vY29udHJhY3RzL2Vkcyc7XHJcbmltcG9ydCB7IFJlc3RDbGllbnQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IElzb21vcnBoaWNFbnYsIEJlYXJlclByb3ZpZGVyLCBIdHRwRXJyb3IgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IFNjaG9vbE1vbWVudCB9IGZyb20gJy4uL3V0aWxzL3NjaG9vbC1tb21lbnQnO1xyXG5pbXBvcnQgeyBTY2hvb2xUZXJtIH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLXRlcm0nO1xyXG5pbXBvcnQgeyBkYXRlVGltZVJldml2ZXIsIEwgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCBtb2NrSnNvbkZpbGUgZnJvbSAnLi9tb2NrL21vY2stZWRzLWRhdGEuanNvbic7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgU3VzcGVuc2VCYXNlZEFQSSwgbWFrZVN1c3BlbnNlQXBpIH0gZnJvbSAnLi4vdXRpbHMvbWFrZS1zdXNwZW5zZS1hcGknO1xyXG5cclxuZXhwb3J0IGNsYXNzIEVkc0NsaWVudCB7XHJcbiAgaHR0cDogUmVzdENsaWVudDtcclxuICB1c2VyRW1haWxHZXR0ZXI6ICgpPT5zdHJpbmc7XHJcbiAgc3VzcGVuc2U6IFN1c3BlbnNlQmFzZWRBUEk8RWRzQ2xpZW50PjtcclxuXHJcbiAgY29uc3RydWN0b3IgKFxyXG4gICAgaXNvbW9ycGhpYzogSXNvbW9ycGhpY0VudixcclxuICAgIGJhc2VVcmw6IHN0cmluZyxcclxuICAgIGJlYXJlclByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcixcclxuICAgIHVzZXJFbWFpbEdldHRlcjogKCk9PnN0cmluZ1xyXG4gICkge1xyXG4gICAgdGhpcy5odHRwID0gbmV3IFJlc3RDbGllbnQgKGlzb21vcnBoaWMsIGJhc2VVcmwsIHtiZWFyZXJQcm92aWRlcn0pO1xyXG4gICAgdGhpcy51c2VyRW1haWxHZXR0ZXIgPSB1c2VyRW1haWxHZXR0ZXI7XHJcbiAgICBjb25zdCBpc0FwaU1ldGhvZCA9IG0gPT5cclxuICAgICAgdHlwZW9mIHRoaXNbbV0gPT09ICdmdW5jdGlvbicgJiZcclxuICAgICAgbSAhPT0gJ2NvbnN0cnVjdG9yJyAmJiAvLyBTaW5jZSBtYWtlU3VzcGVuc2VBcGkoKSB3YWxrcyBwcm90b3R5cGUgY2hhaW5cclxuICAgICAgbSAhPT0gJ3ByaXZhdGl6aW5nQ2FjaGVCdXN0JyAmJlxyXG4gICAgICBtICE9PSAndXNlckVtYWlsR2V0dGVyJyAvLyBMaXN0IG5vbi1BUEkgbWV0aG9kcyBoZXJlLi4uXHJcbiAgICAgIDtcclxuXHJcbiAgICBPYmplY3Qua2V5cyhFZHNDbGllbnQucHJvdG90eXBlKS5mb3JFYWNoKG1ldGhvZCA9PiB7XHJcbiAgICAgIGlmIChpc0FwaU1ldGhvZChtZXRob2QpKSB7XHJcbiAgICAgICAgdGhpc1ttZXRob2RdID0gYXZvaWRTaW11bHRhbm91c0NhbGxzKHRoaXNbbWV0aG9kXSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdGhpcy5zdXNwZW5zZSA9IG1ha2VTdXNwZW5zZUFwaSh0aGlzLCB7aXNBcGlNZXRob2R9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcHJpdmF0aXppbmdDYWNoZUJ1c3QoKSB7XHJcbiAgICByZXR1cm4ge3VzZXI6IHRoaXMudXNlckVtYWlsR2V0dGVyKCl9O1xyXG4gIH1cclxuXHJcbi8qKlxyXG4gICAqIFJldHJpZXZlIGFjdGl2ZSBjb3Vyc2VzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiBzdHVkZW50LlxyXG4gICAqXHJcbiAgICogQHBhcmFtIGNvdXJzZUNvZGUgU2hvcnQtbmFtZSBvZiB0aGUgY291cnNlLiBPcHRpb25hbC5cclxuICAgKi9cclxuICBhc3luYyBnZXRBY3RpdmVDb3Vyc2VzKHE6IHtjb3Vyc2VDb2RlPzogc3RyaW5nLCBwZXJpb2ROYW1lOiBzdHJpbmd9KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XHJcbiAgICAgIGlmIChxKSB7XHJcbiAgICAgICAgaWYgKHEuY291cnNlQ29kZSkgcXVlcnkuQ291cnNlQ29kZSA9IHEuY291cnNlQ29kZTtcclxuICAgICAgICBpZiAocS5wZXJpb2ROYW1lKSBxdWVyeS5QZXJpb2ROYW1lID0gcS5wZXJpb2ROYW1lO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50YWN0aXZlY291cnNlc1wiLCBxdWVyeSk7XHJcbiAgICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICAgIHJldHVybiBqc29uLmNvdXJzZXMgYXMgRURTQ291cnNlW107XHJcbiAgICB9IGNhdGNoIChleCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZnJvbSBFRFM6IFwiICsgZXgpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoTGBLdW5kZSB0eXbDpHJyIGludGUgbGFkZGEgdGVybWluc23DpWwgZWxsZXIgYXZrbGFyYWRlIHN0ZWcgZnLDpW4gRURTLiBGw7Zyc8O2ayBpZ2VuIHNlbmFyZS4uLmApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0cmlldmUgbGF0ZXN0IGFzc2Vzc21lbnRzIGZvciBjdXJyZW50IGxvZ2dlZCBpbiB1c2VyLlxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdFxyXG4gICAqL1xyXG4gIGFzeW5jIGdldExhdGVzdEFzc2Vzc21lbnRzKGxpbWl0PzogbnVtYmVyKSB7XHJcbiAgICBjb25zdCBxdWVyeTphbnkgPSB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCk7XHJcbiAgICBpZiAoIWlzTmFOKGxpbWl0KSkgcXVlcnkuQ291bnQgPSBsaW1pdDtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50YXNzZXNzbWVudHNcIiwgcXVlcnkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5hc3Nlc3NtZW50cyBhcyBFRFNBc3Nlc3NtZW50W107ICAgIFxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0cmlldmUgc3R1ZHlwbGFucyBmb3IgY3VycmVudCBsb2dnZWQtaW4gdXNlclxyXG4gICAqL1xyXG4gIGFzeW5jIGdldFN0dWRlbnRHb2FscygpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJzdHVkZW50Z29hbHNcIiwgdGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpKTtcclxuICAgIGlmIChyZXMuc3RhdHVzICE9IDIwMCkgdGhyb3cgbmV3IEh0dHBFcnJvcihyZXMuc3RhdHVzLCBhd2FpdCByZXMudGV4dCgpKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xyXG4gICAgcmV0dXJuIGpzb24uc3R1ZGVudEdvYWxzIGFzIEVEU1N0dWR5UGxhbltdOyAgICBcclxuICB9XHJcblxyXG4gIGFzeW5jIGdldFN0dWRlbnRGdXR1cmVBYmlsaXRpZXMoKSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwic3R1ZGVudEZ1dHVyZUFiaWxpdGllc1wiLCB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zdHVkZW50RnV0dXJlQWJpbGl0aWVzIGFzIEVEU1N0dWRlbnRGdXR1cmVBYmlsaXR5W107XHJcbiAgfVxyXG5cclxuICBhc3luYyBnZXRUZWFjaGVyVHV0b3JTdHVkZW50cygpIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJ0ZWFjaGVydHV0b3JzdHVkZW50c1wiLCB0aGlzLnByaXZhdGl6aW5nQ2FjaGVCdXN0KCkpO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi5zdHVkZW50cyBhcyBFRFNTdHVkZW50W107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBnZXRTY2hvb2xUdWl0aW9uR3JvdXBzKClcclxuICAgKiBcclxuICAgKiBSZXR1cm4gdHVpdGlvbmdyb3VwcyBmb3Igc2Nob29sXHJcbiAgICogXHJcbiAgICogQHBhcmFtIHNjaG9vbE5hbWUgLSBuYW1lIG9mIHNjaG9vbFxyXG4gICAqIEBwYXJhbSBjb3Vyc2VDb2RlIC0gU2tvbHZlcmtldHMgY29kZSBmb3IgY291cnNlXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0U2Nob29sVHVpdGlvbkdyb3VwcyhxOiB7c2Nob29sTmFtZTogc3RyaW5nLCBjb3Vyc2VDb2RlOiBzdHJpbmd9KSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiU2Nob29sVHVpdGlvbkdyb3Vwc1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBqc29uLnNjaG9vbFR1aXRpb25Hcm91cHMgYXMgRURTVHVpdGlvbkdyb3VwW107XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cygpXHJcbiAgICogXHJcbiAgICogUmV0dXJuIG5hbWUgYW5kIG1haWxhZHJlc3NlcyBmb3IgdHV0aXRpb25ncm91cHMgaW4gc2Nob29sc1xyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBzY2hvb2xOYW1lIC0gbmFtZSBvZiBzY2hvb2xcclxuICAgKiBAcGFyYW0gdHVpdGlvbkdyb3VwTmFtZSAtIHR1aXRpb24gZ3J1b3AgbmFtZSBpbiBFRFNcclxuICAgKi9cclxuICBhc3luYyBnZXRUdWl0aW9uR3JvdXBTdHVkZW50cyhxOiB7c2Nob29sTmFtZTogc3RyaW5nLCB0dWl0aW9uR3JvdXBOYW1lOiBzdHJpbmd9KSB7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLmh0dHAuZ2V0KFwiVHVpdGlvbkdyb3VwU3R1ZGVudHNcIiwgey4uLnRoaXMucHJpdmF0aXppbmdDYWNoZUJ1c3QoKSwgLi4ucX0pO1xyXG4gICAgaWYgKHJlcy5zdGF0dXMgIT0gMjAwKSB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICByZXR1cm4ganNvbi50dWl0aW9uR3JvdXBTdHVkZW50cyBhcyBFRFNUdWl0aW9uU3R1ZGVudFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogZ2V0U2Nob29sVGVhY2hlcnMoKVxyXG4gICAqIFxyXG4gICAqIFJldHVybiBuYW1lIGFuZCBtYWlsYWRyZXNzZXMgZm9yIHR1dGl0aW9uZ3JvdXBzIGluIHNjaG9vbHNcclxuICAgKiBcclxuICAgKiBAcGFyYW0gc2Nob29sTmFtZSAtIG5hbWUgb2Ygc2Nob29sXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0U2Nob29sVGVhY2hlcnMocToge3NjaG9vbE5hbWU6IHN0cmluZ30pIHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQoXCJTY2hvb2xUZWFjaGVyc1wiLCB7Li4udGhpcy5wcml2YXRpemluZ0NhY2hlQnVzdCgpLCAuLi5xfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPSAyMDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTtcclxuICAgIHJldHVybiBqc29uLnNjaG9vbFRlYWNoZXJzIGFzIEVEU1RlYWNoZXJbXTtcclxuICB9XHJcbiAgLy8gd2UgYXNzdW1lIHRoYXQgdGhlIEVEUyB3aWxsIHJldHVybiB0aGUgY3VycmVudCBhY2FkZW1pYyB5ZWFyIGRhdGVzIGRldGVybWluZWQgYnkgdGhlIGN1cnJlbnQgZGF0ZVxyXG4gIGFzeW5jIGdldEFjYWRlbWljWWVhclRlcm1zKHNjaG9vbExvY2FsZTogc3RyaW5nLCBkYXRlOiBEYXRlKSB7XHJcbiAgICAvLyBtb2NrIGRhdGFcclxuICAgIHN3aXRjaCAoc2Nob29sTG9jYWxlKSB7XHJcbiAgICAgIGNhc2UgJ2VuX3Npbic6XHJcbiAgICAgIHJldHVybiBtb2NrSnNvbkZpbGUuU291dGhJbmRpYS5maWx0ZXIoZiA9PiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JBZnRlcihmLmZpcnN0VGVybS5zdGFydERhdGUpICYmIG1vbWVudChkYXRlKS5pc1NhbWVPckJlZm9yZShmLnNlY29uZFRlcm0uZW5kRGF0ZSkpWzBdIGFzIE1vY2tFRFNBY2FkZW1pY1llYXI7XHJcbiAgICAgIGNhc2UgJ2VuX25pbic6XHJcbiAgICAgIHJldHVybiBtb2NrSnNvbkZpbGUuTm9ydGhJbmRpYS5maWx0ZXIoZiA9PiBtb21lbnQoZGF0ZSkuaXNTYW1lT3JBZnRlcihmLmZpcnN0VGVybS5zdGFydERhdGUpICYmIG1vbWVudChkYXRlKS5pc1NhbWVPckJlZm9yZShmLnNlY29uZFRlcm0uZW5kRGF0ZSkpWzBdIGFzIE1vY2tFRFNBY2FkZW1pY1llYXI7XHJcbiAgICAgIGNhc2UgJ3N2JzpcclxuICAgICAge1xyXG4gICAgICB2YXIgaG9saWRheXMgPSBbXSBhcyBNb2NrRURTRGF0ZVJhbmdlW107XHJcbiAgICAgIHZhciBhZGRZZWFyID0gZGF0ZS5nZXRNb250aCgpID49IDY7XHJcbiAgICAgIFxyXG4gICAgICB2YXIgZmlyc3RUZXJtWWVhciA9IGFkZFllYXIgPyBkYXRlLmdldEZ1bGxZZWFyKCkgOiBkYXRlLmdldEZ1bGxZZWFyKCkgLSAxO1xyXG4gICAgICB2YXIgc2Vjb25kVGVybVllYXIgPSBhZGRZZWFyID8gZGF0ZS5nZXRGdWxsWWVhcigpICsgMSA6IGRhdGUuZ2V0RnVsbFllYXIoKTtcclxuXHJcbiAgICAgIC8vVGhlIHN0YXJ0IGRhdGUgY2FuIGJlIGluIHRoZSBsYXN0IHdlZWsgb2YgdGhlIHByZXZpb3VzIHllYXJcclxuICAgICAgIHZhciBmaXJzdFRlcm1ZZWFyTW9tZW50ID0gbW9tZW50KGZpcnN0VGVybVllYXIudG9TdHJpbmcoKSwgXCJZWVlZXCIpO1xyXG4gICAgICAgdmFyIHNlY29uZFRlcm1ZZWFyTW9tZW50ID0gbW9tZW50KHNlY29uZFRlcm1ZZWFyLnRvU3RyaW5nKCksIFwiWVlZWVwiKTtcclxuXHJcbiAgICAgICBpZihmaXJzdFRlcm1ZZWFyTW9tZW50LndlZWsoKSAhPSAxKVxyXG4gICAgICAge1xyXG4gICAgICAgIGZpcnN0VGVybVllYXJNb21lbnQgPSBmaXJzdFRlcm1ZZWFyTW9tZW50LmNsb25lKCkuYWRkKDEsICd3ZWVrJyk7XHJcbiAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHNlY29uZFRlcm1ZZWFyTW9tZW50LndlZWsoKSAhPSAxKVxyXG4gICAgICAge1xyXG4gICAgICAgIHNlY29uZFRlcm1ZZWFyTW9tZW50ID0gc2Vjb25kVGVybVllYXJNb21lbnQuY2xvbmUoKS5hZGQoMSwgJ3dlZWsnKTtcclxuICAgICAgIH1cclxuXHJcbiAgICAgIHZhciBzdGFydEZpcnN0VGVybURhdGUgPSBtb21lbnQoZmlyc3RUZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDMyKS5zdGFydE9mKCd3ZWVrJyk7XHJcbiAgICAgIHZhciBlbmRGaXJzdFRlcm1EYXRlID0gbW9tZW50KGZpcnN0VGVybVllYXJNb21lbnQuY2xvbmUoKSkud2Vlayg1MSkuZW5kT2YoJ3dlZWsnKTtcclxuXHJcbiAgICAgIHZhciBzdGFydFNlY29uZFRlcm1EYXRlID0gbW9tZW50KHNlY29uZFRlcm1ZZWFyTW9tZW50LmNsb25lKCkpOyAvLyBkb24ndCBzZXQgYXMgdGhlIHN0YXJ0IG9mIHRoZSB3ZWVrIGJlY2F1c2UgaXQgY2FuIGJlIGluIHRoZSBwcmV2aW91cyB5ZWFyXHJcbiAgICAgIHZhciBlbmRTZWNvbmRUZXJtRGF0ZSA9IG1vbWVudChzZWNvbmRUZXJtWWVhck1vbWVudC5jbG9uZSgpKS53ZWVrKDI1KS5lbmRPZignd2VlaycpO1xyXG5cclxuICAgICAgY29uc3QgZmlyc3RUZXJtID0ge3N0YXJ0RGF0ZTogbmV3IERhdGUoZmlyc3RUZXJtWWVhciwgc3RhcnRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIHN0YXJ0Rmlyc3RUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpLCBlbmREYXRlOiBuZXcgRGF0ZShmaXJzdFRlcm1ZZWFyLCBlbmRGaXJzdFRlcm1EYXRlLm1vbnRoKCksIGVuZEZpcnN0VGVybURhdGUuZGF0ZSgpKS50b0RhdGVTdHJpbmcoKX07XHJcbiAgICAgIGNvbnN0IHNlY29uZFRlcm0gPSB7c3RhcnREYXRlOiBuZXcgRGF0ZShzZWNvbmRUZXJtWWVhciwgc3RhcnRTZWNvbmRUZXJtRGF0ZS5tb250aCgpLCBzdGFydFNlY29uZFRlcm1EYXRlLmRhdGUoKSkudG9EYXRlU3RyaW5nKCksIGVuZERhdGU6IG5ldyBEYXRlKHNlY29uZFRlcm1ZZWFyLCBlbmRTZWNvbmRUZXJtRGF0ZS5tb250aCgpLCBlbmRTZWNvbmRUZXJtRGF0ZS5kYXRlKCkpLnRvRGF0ZVN0cmluZygpfTtcclxuICAgICAgcmV0dXJuIHtmaXJzdFRlcm0sIHNlY29uZFRlcm0sIGhvbGlkYXlzfTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVEU1BlcmlvZCB7XHJcbiAgcGVyaW9kOiBzdHJpbmc7XHJcbiAgdGVybTogJ0FUJyB8ICdTVCc7XHJcbiAgeWVhcjogbnVtYmVyO1xyXG4gIGNvbnN0cnVjdG9yIChwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm06IHN0cmluZyB8IFNjaG9vbE1vbWVudCkge1xyXG4gICAgaWYgKHR5cGVvZiBwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm0gPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIHRoaXMucGVyaW9kID0gcGVyaW9kU3RyaW5nT3JTY2hvb2xUZXJtO1xyXG4gICAgICB0aGlzLnRlcm0gPSB0aGlzLnBlcmlvZC5zdGFydHNXaXRoKCdIVCcpID8gJ0FUJyA6ICdTVCc7XHJcbiAgICAgIHRoaXMueWVhciA9IHBhcnNlSW50KHRoaXMucGVyaW9kLnN1YnN0cigyKSk7XHJcbiAgICAgIGlmIChpc05hTih0aGlzLnllYXIpKSB0aHJvdyBuZXcgRXJyb3IgKGBJbnZhbGlkIHBlcmlvZDogJHt0aGlzLnBlcmlvZH1gKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IHNjaG9vbFRlcm0gPSBuZXcgU2Nob29sVGVybShwZXJpb2RTdHJpbmdPclNjaG9vbFRlcm0pO1xyXG4gICAgICB0aGlzLnBlcmlvZCA9IChzY2hvb2xUZXJtLnRlcm0gPT09ICdBVCcgPyBcIkhUXCIgOiBcIlZUXCIpICsgc2Nob29sVGVybS55ZWFyO1xyXG4gICAgICB0aGlzLnRlcm0gPSBzY2hvb2xUZXJtLnRlcm07XHJcbiAgICAgIHRoaXMueWVhciA9IHNjaG9vbFRlcm0ueWVhcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldCBzY2hvb2xUZXJtICgpIDogU2Nob29sVGVybSB7XHJcbiAgICByZXR1cm4gbmV3IFNjaG9vbFRlcm0oe1xyXG4gICAgICBhY2FkZW1pY1llYXI6IHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgICAgYCR7dGhpcy55ZWFyfS8ke3RoaXMueWVhciArIDF9YCA6XHJcbiAgICAgICAgYCR7dGhpcy55ZWFyLTF9LyR7dGhpcy55ZWFyfWAsXHJcbiAgICAgIHRlcm06IHRoaXMudGVybVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiB0aGlzLnBlcmlvZDtcclxuICB9XHJcblxyXG4gIHZhbHVlT2YoKSB7XHJcbiAgICByZXR1cm4gdGhpcy55ZWFyICsgXCI6XCIgKyAodGhpcy50ZXJtID09PSAnU1QnID8gXCIxXCIgOiBcIjJcIik7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VKc29uRGF0ZV9vbGQgKGpzb25EYXRlU3RyOiBzdHJpbmcpIDogRGF0ZSB7XHJcbiAgY29uc3QgZGF0ZSA9IGRhdGVUaW1lUmV2aXZlcihcIlwiLCBqc29uRGF0ZVN0cik7XHJcbiAgaWYgKCEoZGF0ZSBpbnN0YW5jZW9mIERhdGUpKSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIEpTT04gZGF0ZSBzdHJpbmc6IFwiICsganNvbkRhdGVTdHIpO1xyXG4gIHJldHVybiBkYXRlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhdm9pZFNpbXVsdGFub3VzQ2FsbHM8VCxBPihtZXRob2Q6ICguLi5hcmdzOkFbXSk9PlByb21pc2U8VD4pIDogKC4uLmFyZ3M6QVtdKT0+UHJvbWlzZTxUPiB7XHJcbiAgbGV0IG9uZ29pbmdQcm9taXNlczoge1thcmdzSnNvbjogc3RyaW5nXTogUHJvbWlzZTxUPn0gPSB7fTtcclxuICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICBjb25zdCBhcmdzSnNvbiA9IEpTT04uc3RyaW5naWZ5KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKSk7XHJcbiAgICBpZiAoIW9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl0pIHtcclxuICAgICAgb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXSA9IG1ldGhvZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpLnRoZW4ocmVzdWx0PT57XHJcbiAgICAgICAgZGVsZXRlIG9uZ29pbmdQcm9taXNlc1thcmdzSnNvbl07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb25nb2luZ1Byb21pc2VzW2FyZ3NKc29uXTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQmVhcmVyUHJvdmlkZXIgfSBmcm9tIFwia2VkYmFja2VuZC9jbGllbnRcIjtcclxuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyByZWplY3RzIH0gZnJvbSAnYXNzZXJ0JztcclxuXHJcbmludGVyZmFjZSBvcHRpb25zIHtcclxuICB1cGxvYWQ/OiBib29sZWFuO1xyXG4gIG11bHRpcGxlPzogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIHNlbGVjdGVkRmlsZSB7XHJcbiAgZmlsZUlkOiBzdHJpbmc7XHJcbiAgdXJsOiBzdHJpbmc7XHJcbiAgbWltZVR5cGU6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgbW9kaWZpZWRUaW1lOiBudW1iZXI7XHJcbiAgY2FuRXhwb3J0OiBib29sZWFuO1xyXG4gIGljb25Vcmw/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBkb3dubG9hZEFyZ3Mge1xyXG4gIGZpbGU6IHNlbGVjdGVkRmlsZTtcclxuICBsaW1pdFNpemU/OiBudW1iZXI7XHJcbn1cclxuXHJcblxyXG4vKipcclxuICogR29vZ2xlUGlja2VyXHJcbiAqIEluY2x1ZGVzIHRoZSBpbml0aWF0aW9uIG9mIHRoZSBjb3JyZWN0IGFwaTpzLlxyXG4gKiBDZXJ0YWluIG9wdGlvbnMgY2FuIGJlIHBhc3NlZCB0byB0aGUgY29uc3RydWN0b3JcclxuICogYW5kIHRoZXJlIGNvdWxkIGJlIG90aGVycyB3b3J0aCBpbmNvcnBvcmF0aW5nIChpLmUuIFRlYW0gRHJpdmUtc3VwcG9ydCkuXHJcbiAqIFxyXG4gKiBSaWdodCBub3cgdHdvIG9wdGlvbnMgYXJlIGhhbmRsZWQ6XHJcbiAqIC0gdXBsb2FkOiBpZiBhIHVzZXIgY2FuIHVwbG9hZCB0byBEcml2ZSBpbiB0aGUgR29vZ2xlIERyaXZlIFBpY2tlclxyXG4gKiAtIG11bHRpcGxlOiBpZiBhIHVzZXIgY2FuIHNlbGVjdCBtdWx0aXBsZSBmaWxlc1xyXG4gKiBcclxuICogQ29tcGFyZWQgdG8gR29vZ2xlQ2FsZW5kYXIgdGhlIHRva2VuUHJvdmlkZXIgaXMgc2V0IGluIHRoZSBjb25zdHJ1Y3RvclxyXG4gKiBhbmQgaXMgbm90IHBhc3NlZCBhcyBhbiBhcmd1bWVudC4gV2UgY291bGQgcHJvYmFibHkgZG8gdGhlIHNhbWUgaW4gR29vZ2xlQ2FsZW5kYXJcclxuICogYmVjYXVzZSB0aGUgZW52IGlzIGdsb2JhbGx5IGF2YWlsYWJsZSBhdCBhbGwgdGltZXMuXHJcbiAqIFxyXG4gKiBXZSBjb3VsZCBwcm9iYWJseSBzcGxpdCB0aGlzIGludG8gZ29vZ2xlLXBpY2tlciBhbmQgZ29vZ2xlLWRyaXZlIHdoZXJlIGdvb2dsZS1kcml2ZVxyXG4gKiBoYW5kbGVzIHRoZSBleHBsaWNpdCBjYWxscyB0byB0aGUgZ29vZ2xlIGRyaXZlIGFwaS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVQaWNrZXIge1xyXG4gIHRva2VuRXhwaXJhdGlvbjogRGF0ZTtcclxuICBnb29nbGVUb2tlblByb3ZpZGVyOiBCZWFyZXJQcm92aWRlcjtcclxuICBwaWNrZXI6IGdvb2dsZS5waWNrZXIuUGlja2VyO1xyXG4gIGF1dGhUb2tlbjogc3RyaW5nO1xyXG4gIG9wdGlvbnM6IG9wdGlvbnM7XHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBvcHRpb25zKSB7XHJcbiAgICB0aGlzLmdvb2dsZVRva2VuUHJvdmlkZXIgPSBlbnYuZ29vZ2xlVG9rZW5Qcm92aWRlcjtcclxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgfHwge3VwbG9hZDogZmFsc2UsIG11bHRpcGxlOiBmYWxzZX07XHJcbiAgfVxyXG5cclxuICBhc3luYyBlbnN1cmVJbml0ZWQoKSB7XHJcbiAgICAvLyBMb2FkIEdBUElcclxuICAgIGlmICh0eXBlb2YgZ2FwaSA9PT0gXCJ1bmRlZmluZWRcIikgYXdhaXQgdGhpcy5sb2FkR2FwaSgpO1xyXG5cclxuICAgIC8vIEtFRFNTY2hvb2xzXHJcbiAgICBjb25zdCBDTElFTlRfSUQgPSBcIjQyMTU3MjI2MjI2OS11Njh2NWxmNW84c3M1dDY4bDhna3EzcGZhcmg2ZGJrdi5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbVwiO1xyXG4gICAgXHJcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSxyZWplY3QpID0+IHtcclxuICAgICAgZ2FwaS5sb2FkKFwiY2xpZW50OmF1dGgyXCIsICgpID0+IHtcclxuICAgICAgICAvLyBDYWxscyBhdXRob3JpemUgd2l0aG91dCBwcm9tcHRpbmcgdGhlIHVzZXIuIElmIGF1dGhvcml6YXRpb24gaGFzbid0IGJlZW4gZ2l2ZW4gYnlcclxuICAgICAgICAvLyB0aGUgdXNlciBhbiBlcnJvciBpcyByZXR1cm5lZCBhbmQgd2UgY2FsbCBhdXRob3JpemUgYWdhaW4gd2l0aCBjb25zZW50LXNjcmVlblxyXG4gICAgICAgIHJldHVybiBnYXBpLmF1dGgyLmF1dGhvcml6ZSh7XHJcbiAgICAgICAgICBjbGllbnRfaWQ6IENMSUVOVF9JRCxcclxuICAgICAgICAgIHNjb3BlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZScsXHJcbiAgICAgICAgICByZXNwb25zZV90eXBlOiAnaWRfdG9rZW4gcGVybWlzc2lvbicsXHJcbiAgICAgICAgICBwcm9tcHQ6ICdub25lJ1xyXG4gICAgICAgIH0sIChyZXNwKSA9PiB7XHJcbiAgICAgICAgICBpZiAocmVzcC5lcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2FwaS5hdXRoMi5hdXRob3JpemUoe1xyXG4gICAgICAgICAgICAgIGNsaWVudF9pZDogQ0xJRU5UX0lELFxyXG4gICAgICAgICAgICAgIHNjb3BlOiAnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9kcml2ZScsXHJcbiAgICAgICAgICAgICAgcmVzcG9uc2VfdHlwZTogJ2lkX3Rva2VuIHBlcm1pc3Npb24nLFxyXG4gICAgICAgICAgICAgIHByb21wdDogJ2NvbnNlbnQnXHJcbiAgICAgICAgICAgIH0sIChyZXNwKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdCgnUGlja2VyOiBObyBhY2Nlc3MgdG9rZW4nKTtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSByZXNwLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoVG9rZW4gPSByZXNwLmFjY2Vzc190b2tlbjtcclxuICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgKX0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gTG9hZCBQaWNrZXIgQVBJXHJcbiAgICBpZiAodHlwZW9mIGdvb2dsZSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgZ29vZ2xlLnBpY2tlciA9PT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcclxuICAgICAgICBnYXBpLmxvYWQoXCJwaWNrZXJcIiwgKCkgPT4ge3Jlc29sdmUoKX0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxvYWRHYXBpKCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgaWYgKHR5cGVvZiBnYXBpICE9PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gcmVzb2x2ZSgpO1xyXG4gICAgICBjb25zdCBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO1xyXG4gICAgICBzY3JpcHQuc3JjID0gXCJodHRwczovL2FwaXMuZ29vZ2xlLmNvbS9qcy9jbGllbnQuanM/b25sb2FkPWdhYXBpX2xvYWRlZFwiO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0uYXBwZW5kQ2hpbGQoc2NyaXB0KTtcclxuICAgICAgKHdpbmRvdyBhcyBhbnkpLmdhYXBpX2xvYWRlZCA9IHJlc29sdmU7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHNob3coKVxyXG4gICAqIFxyXG4gICAqIElmIGEgc2luZ2xlIGZpbGUgaXMgcmVxdWVzdGVkIGZyb20gdGhlIHBpY2tlciBhIGxpc3Qgb2YgZmlsZXMgd2l0aCBvbmUgZWxlbWVudCBpcyByZXR1cm5lZC5cclxuICAgKiBJdCBpcyB1cCB0byB0aGUgY2FsbGVyIHRvIGhhbmRsZSB0aGUgbGlzdCBpbiBhIHJlbGV2YW50IG1hbm5lci5cclxuICAgKiBcclxuICAgKiBNb3JlIGRhdGEgZnJvbSB0aGUgZmlsZSBjb3VsZCBiZSBleHRyYWN0ZWQgaWYgaXQgaXMgZGVlbWVkIG5lY2Vzc2FyeS5cclxuICAgKiBcclxuICAgKi9cclxuICBhc3luYyBzaG93KCkge1xyXG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0ZWQoKTtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTxzZWxlY3RlZEZpbGVbXT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBjb25zdCBjYWxsYmFjayA9IChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIGlmIChyZXNwb25zZVsnYWN0aW9uJ10gPT0gZ29vZ2xlLnBpY2tlci5BY3Rpb24uQ0FOQ0VMKSB7XHJcbiAgICAgICAgICAgIHJlamVjdCgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2VbJ2FjdGlvbiddID09IGdvb2dsZS5waWNrZXIuQWN0aW9uLlBJQ0tFRCkge1xyXG4gICAgICAgICAgbGV0IHNlbGVjdGVkID0gW107XHJcbiAgICAgICAgICByZXNwb25zZS5kb2NzLmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB7aWQ6IGZpbGVJZCwgbWltZVR5cGUsIG5hbWUsIG1vZGlmaWVkVGltZSwgaWNvblVybCwgdXJsfSA9IGRvYztcclxuICAgICAgICAgICAgY29uc3QgY2FuRXhwb3J0ID0gbWltZVR5cGUuaW5jbHVkZXMoJ2dvb2dsZS1hcHBzJyk7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkLnB1c2goe2ZpbGVJZCwgbWltZVR5cGUsIG5hbWUsIG1vZGlmaWVkVGltZSwgY2FuRXhwb3J0LCBpY29uVXJsLCB1cmx9KTtcclxuICAgICAgICAgICAgLy8gdXBkYXRlIHBlcm1pc3Npb25zIHRvIHJlYWQgYnkgYWxsIGluIGRvbWFpblxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVBlcm1pc3Npb25zKGZpbGVJZCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGVjdGVkKTtcclxuICAgICAgICAgIHJlc29sdmUoc2VsZWN0ZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHBpY2tlcmJ1aWxkZXIgPSBuZXcgZ29vZ2xlLnBpY2tlci5QaWNrZXJCdWlsZGVyKClcclxuICAgICAgICAuYWRkVmlldyhcclxuICAgICAgICAgIG5ldyBnb29nbGUucGlja2VyLkRvY3NWaWV3KClcclxuICAgICAgICAgICAgLnNldE93bmVkQnlNZSh0cnVlKSAvLyBzaG91bGQgdGhpcyBiZSBhbiBvcHRpb24/XHJcbiAgICAgICAgICAgIC5zZXRJbmNsdWRlRm9sZGVycyh0cnVlKVxyXG4gICAgICAgIClcclxuICAgICAgICAuc2V0TG9jYWxlKFwic3ZcIikgLy8gc2hvdWxkIHRoaXMgYmUgYW4gb3B0aW9uP1xyXG4gICAgICAgIC5zZXRTaXplKDEwNTEsNjUwKSAvLyBzaG91bGQgdGhpcyBiZSBhbiBvcHRpb24/XHJcbiAgICAgICAgLnNldE9BdXRoVG9rZW4odGhpcy5hdXRoVG9rZW4pIC8vIHRlbXBcclxuICAgICAgICAuc2V0Q2FsbGJhY2soY2FsbGJhY2spO1xyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnVwbG9hZCkge1xyXG4gICAgICAgIHBpY2tlcmJ1aWxkZXIuYWRkVmlldyhuZXcgZ29vZ2xlLnBpY2tlci5Eb2NzVXBsb2FkVmlldygpLnNldEluY2x1ZGVGb2xkZXJzKHRydWUpKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5vcHRpb25zLm11bHRpcGxlKSB7XHJcbiAgICAgICAgcGlja2VyYnVpbGRlci5lbmFibGVGZWF0dXJlKGdvb2dsZS5waWNrZXIuRmVhdHVyZS5NVUxUSVNFTEVDVF9FTkFCTEVEKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnBpY2tlciA9IHBpY2tlcmJ1aWxkZXIuYnVpbGQoKTtcclxuICAgICAgdGhpcy5waWNrZXIuc2V0VmlzaWJsZSh0cnVlKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdXBkYXRlUGVybWlzc2lvbnMoKVxyXG4gICAqIFxyXG4gICAqIEBwYXJhbSBmaWxlSWQgXHJcbiAgICogXHJcbiAgICogTWFrZSB0aGUgZmlsZSBhY2Nlc3NpYmxlIHRvIGFsbCBpbiB0aGUgZG9tYWluLiBTaG91bGQgYmUgdW5uZWNlc3NhcnkgYnV0IHNvbWVcclxuICAgKiB0ZWFjaGVycyBoYXZlIGNoYW5nZWQgdGhlaXIgZGVmYXVsdCBwZXJtaXNzaW9ucy5cclxuICAgKiBXZSBkb24ndCBjYXJlIHJpZ2h0IG5vdyBpZiB0aGlzIGZhaWxzIGJlY2F1c2UgdGhpcyBpcyBqdXN0IGFuIGV4dHJhIHByZWNhdXRpb24uXHJcbiAgICogSWYgd2UgcGxhbiBvbiB1c2luZyB0aGlzIG9uIG90aGVyIGRvbWFpbnMgdGhlIGRvbWFpbi1hdHRyaWJ1dGUgbmVlZHMgdG8gYmUgZHluYW1pYy5cclxuICAgKiBcclxuICAgKi9cclxuICBhc3luYyB1cGRhdGVQZXJtaXNzaW9ucyhmaWxlSWQpIHtcclxuICAgIGF3YWl0IGdhcGkuY2xpZW50LmluaXQoe1xyXG4gICAgICBkaXNjb3ZlcnlEb2NzOiBbXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9kaXNjb3ZlcnkvdjEvYXBpcy9kcml2ZS92My9yZXN0XCJdXHJcbiAgICB9KTtcclxuICAgIGdhcGkuY2xpZW50LmRyaXZlLnBlcm1pc3Npb25zLmNyZWF0ZSg8YW55PntcclxuICAgICAgZmlsZUlkOiBmaWxlSWQsXHJcbiAgICAgIHNlbmROb3RpZmljYXRpb25FbWFpbDogZmFsc2UsXHJcbiAgICAgIHJvbGU6ICdyZWFkZXInLFxyXG4gICAgICB0eXBlOiAnZG9tYWluJyxcclxuICAgICAgZG9tYWluOiAna3Vuc2thcHNza29sYW4uc2UnXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBkb3dubG9hZEZpbGUoKVxyXG4gICAqIEBwYXJhbSBmaWxlIFxyXG4gICAqIFxyXG4gICAqIFdoZW4gQ2xhc3Nyb29tIGhhcyBiZWVuIGludGVncmF0ZWQgd2Ugd2lsbCB3YW50IHRvIGhhbmRsZSBvbmx5IHRoZSBmaWxlSWQ6c1xyXG4gICAqIHNvIHRoYXQgZWRpdGluZyBjYXBhYmlsaXRpZXMgYXJlIHBlc2VydmVkIG9uIHRoZSBmaWxlIChpZiBpdCBpcyBhIGdvb2dsZS1hcHBzIGZpbGUpXHJcbiAgICogUmlnaHQgbm93IGdvb2dsZS1hcHBzIGZpbGVzIGFyZSBjb252ZXJ0ZWQgdG8gcGRmIGFuZCBwYXNzZWQgaW50byB0aGUgY3VycmVudCBmbG93LlxyXG4gICAqIFxyXG4gICAqIFRPRE86IGVycm9yIGhhbmRsaW5nXHJcbiAgICovXHJcblxyXG4gIGFzeW5jIGRvd25sb2FkRmlsZSh7ZmlsZSwgbGltaXRTaXplfSkge1xyXG4gICAgLy8gQSBmaWxlIHRoYXQgY2FuIGJlIGV4cG9ydGVkIHRvIFBERiBpcyByZXRyZWl2ZWQgd2l0aFxyXG4gICAgLy8gZmlsZS5leHBvcnQoKSBmcm9tIERyaXZlLCBjb252ZXJ0ZWQgdG8gYSBibG9iIGFuZCB0aGVuXHJcbiAgICAvLyB0byBhIEZpbGUuXHJcbiAgICAvLyBBIGZpbGUgdGhhdCBjYW4gbm90IGJlIGV4cG9ydGVkIHRvIFBERiBpcyByZXRyaWV2ZWRcclxuICAgIC8vIHRocm91Z2ggWEhSIGFuZCBjb252ZXJ0ZWQgdG8gYSBGaWxlLlxyXG5cclxuICAgIC8vIElmIHdlIGRvbid0IG5lZWQgdG8gaGFuZGxlIHRoZSBwaHlzaWNhbCBmaWxlcyBvbiB0aGUgY2xpZW50XHJcbiAgICAvLyB3ZSBjb3VsZCBzYXZlIG9ubHkgdGhlIGZpbGVJZDpzIGFuZCBkaXNwbGF5IGZpbGVuYW1lIGFuZCBtaW1lVHlwZVxyXG4gICAgLy8gZm9yIHRoZSBmaWxlIGluIG91ciBsaXN0aW5ncy4gV2hlbi9pZiB3ZSB1c2UgR29vZ2xlIENsYXNzcm9vbSBmb3JcclxuICAgIC8vIG91ciB0YXNrLWhhbmRsaW5nIHRoYXQgd291bGQgYmUgdGhlIHByZWZlcnJlZCBhcHByb2FjaCB0byBrZWVwXHJcbiAgICAvLyB0aGUgZmlsZSBhcyBhbiBlZGl0YWJsZSBHb29nbGUgZmlsZVxyXG5cclxuICAgIC8vIEluaXQgdGhlIGRyaXZlLWFwaSAob25seSBuZWVkZWQgZm9yIGRvd25sb2FkIHNvIG5vdCBsb2FkZWQgaW5pdGlhbGx5KVxyXG4gICAgYXdhaXQgZ2FwaS5jbGllbnQuaW5pdCh7XHJcbiAgICAgIGRpc2NvdmVyeURvY3M6IFtcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2Rpc2NvdmVyeS92MS9hcGlzL2RyaXZlL3YzL3Jlc3RcIl1cclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChmaWxlLmNhbkV4cG9ydCkge1xyXG4gICAgICByZXR1cm4gbmV3IFByb21pc2U8RmlsZT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIGdhcGkuY2xpZW50LmRyaXZlLmZpbGVzLmV4cG9ydCh7XHJcbiAgICAgICAgICBmaWxlSWQ6IGZpbGUuZmlsZUlkLFxyXG4gICAgICAgICAgbWltZVR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnfVxyXG4gICAgICAgICkudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgIGNvbnN0IGxlbiA9IHJlc3AuYm9keS5sZW5ndGg7XHJcbiAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkobmV3IEFycmF5QnVmZmVyKGxlbikpO1xyXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBkYXRhW2ldID0gcmVzcC5ib2R5LmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ2FwcGxpY2F0aW9uL3BkZid9KTtcclxuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gZmlsZS5uYW1lKycucGRmJztcclxuICAgICAgICAgIHJlc29sdmUobmV3IEZpbGUoW2Jsb2JdLCBmaWxlbmFtZSwge3R5cGU6ICdhcHBsaWNhdGlvbi9wZGYnLCBsYXN0TW9kaWZpZWQ6IGZpbGUubW9kaWZpZWRUaW1lfSkpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pOyAgXHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgLy8gYSBmaWxlIHRoYXQgaXNuJ3QgYSBnb29nbGUtYXBwcyBmaWxlIG5lZWRzIHRvIGJlIGZldGNoZWQgdmlhIFhIUlxyXG4gICAgICAvLyBiZWNhdXNlIHJlc3BvbnNlVHlwZSBhbmQgP2FsdD1tZWRpYSBuZWVkcyB0byBiZSBzZXQgdG8gYXZvaWQgQ09SU1xyXG4gICAgICBjb25zdCB4aHJEb3dubG9hZCA9IChmaWxlOnNlbGVjdGVkRmlsZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxGaWxlPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgIHhoci5vcGVuKFwiR0VUXCIsIFwiaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vZHJpdmUvdjMvZmlsZXMvXCIrZmlsZS5maWxlSWQrJz9hbHQ9bWVkaWEnLCB0cnVlKTtcclxuICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBdXRob3JpemF0aW9uJywnQmVhcmVyICcrdGhpcy5hdXRoVG9rZW4pO1xyXG4gICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xyXG4gICAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJlc29sdmUobmV3IEZpbGUoW3hoci5yZXNwb25zZV0sIGZpbGUubmFtZSwge3R5cGU6IGZpbGUubWltZVR5cGUsIGxhc3RNb2RpZmllZDogZmlsZS5tb2RpZmllZFRpbWV9KSk7XHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgeGhyLnNlbmQoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPEZpbGU+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICBpZiAobGltaXRTaXplICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGdhcGkuY2xpZW50LmRyaXZlLmZpbGVzLmdldCh7XHJcbiAgICAgICAgICAgIGZpbGVJZDogZmlsZS5maWxlSWQsXHJcbiAgICAgICAgICAgIGZpZWxkczogJ3NpemUnXHJcbiAgICAgICAgICB9KS50aGVuKHJlc3AgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzaXplID0gTnVtYmVyKHJlc3AucmVzdWx0LnNpemUpO1xyXG4gICAgICAgICAgICBpZiAoc2l6ZSA+IGxpbWl0U2l6ZSoxMDI0KjEwMjQpIHtcclxuICAgICAgICAgICAgICByZWplY3QoJ0dvb2dsZVBpY2tlckVycm9yOiBGaWxzaXplIGlzIHRvbyBsYWFyZ2UnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgeGhyRG93bmxvYWQoZmlsZSkudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgICByZXNvbHZlKHJlc3ApO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgeGhyRG93bmxvYWQoZmlsZSkudGhlbihyZXNwID0+IHtcclxuICAgICAgICAgICAgcmVzb2x2ZShyZXNwKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZnVuY3Rpb24gY291cnNlTmFtZVRvQ3NzQ2xhc3MoY3NzUHJlZml4OiBzdHJpbmcsIGNvdXJzZU5hbWU6IHN0cmluZykge1xyXG4gIHJldHVybiBgJHtjc3NQcmVmaXh9JHtjb3Vyc2VOYW1lLnN1YnN0cigwLDMpLnRvTG93ZXJDYXNlKCl9YDtcclxufVxyXG4iLCJpbXBvcnQgeyBVc2VyVGFza3NCb3hQcm9wcyB9IGZyb20gXCIuLi93ZWVrcGxhbm5lci91c2VyLXRhc2tzLWJveFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhKHRhc2tTZXRzOiBQYXJ0aWFsPFVzZXJUYXNrc0JveFByb3BzPltdKSB7XHJcbiAgICB2YXIgY2hhcnRUYXNrczoge1xyXG4gICAgICAgIGNvbXBsZXRlZFRhc2tzOiBudW1iZXIsIFxyXG4gICAgICAgIHRvdGFsTnVtYmVyT2ZUYXNrczogbnVtYmVyLFxyXG4gICAgICAgIHN1YmplY3REYXRhOiB7XHJcbiAgICAgICAgICAgIFtjb2x1bW5IZWFkZXI6IHN0cmluZ106IHsgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogbnVtYmVyLCBudW1iZXJPZlRhc2tzOiBudW1iZXIgfVxyXG4gICAgICAgIH1cclxuICAgIH0gPSB7Y29tcGxldGVkVGFza3M6IDAsIHRvdGFsTnVtYmVyT2ZUYXNrczogMCAsIHN1YmplY3REYXRhOiB7fX07XHJcblxyXG4gICAgdGFza1NldHMuZm9yRWFjaChlbGVtID0+IGVsZW0ubGVhcm5pbmdHb2Fscy5mb3JFYWNoKHggPT4ge1xyXG4gICAgICAgIHZhciBzdWJqZWN0Q29tcGxldGVkVGFza3MgPSB4LnRhc2tzLmZpbHRlcih0ID0+IHQuZG9uZSkubGVuZ3RoO1xyXG4gICAgICAgIGNoYXJ0VGFza3Muc3ViamVjdERhdGFbZWxlbS5jb3Vyc2VOYW1lXSA9IHsgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogc3ViamVjdENvbXBsZXRlZFRhc2tzLCBudW1iZXJPZlRhc2tzOiB4LnRhc2tzLmxlbmd0aCB9O1xyXG4gICAgICAgIGNoYXJ0VGFza3MuY29tcGxldGVkVGFza3MgKz0gc3ViamVjdENvbXBsZXRlZFRhc2tzO1xyXG4gICAgICAgIGNoYXJ0VGFza3MudG90YWxOdW1iZXJPZlRhc2tzICs9IHgudGFza3MubGVuZ3RoO1xyXG4gICAgfSkpO1xyXG4gICAgcmV0dXJuIGNoYXJ0VGFza3M7XHJcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gICAgbnVtYmVyT2ZUYXNrczogbnVtYmVyO1xyXG4gICAgY29tcGxldGVkTnVtYmVyT2ZUYXNrczogbnVtYmVyO1xyXG4gICAgbWF4aW11bVRhc2tzRGlzcGxheWVkPzogbnVtYmVyO1xyXG4gICAgYmFja2dyb3VuZENvbG9yPzogc3RyaW5nO1xyXG4gICAgcHJvZ3Jlc3NDb2xvcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEdvYWxQcm9ncmVzcyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gICAgcHVibGljIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XHJcbiAgICAgICAgbnVtYmVyb2ZUYXNrczogMCxcclxuICAgICAgICBjb21wbGV0ZWROdW1iZXJPZlRhc2tzOiAwLFxyXG4gICAgICAgIG1heGltdW1UYXNrc0Rpc3BsYXllZDogMTAsXHJcbiAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcImxpZ2h0Z3JleVwiLFxyXG4gICAgICAgIHByb2dyZXNzQ29sb3I6IFwiIzNkYmNhMlwiLFxyXG4gICAgfTtcclxuXHJcbiAgICBjcmVhdGVQcm9ncmVzcyA9ICgpID0+IHtcclxuICAgICAgICBjb25zdCB7IG51bWJlck9mVGFza3MsIGNvbXBsZXRlZE51bWJlck9mVGFza3MsIG1heGltdW1UYXNrc0Rpc3BsYXllZCwgYmFja2dyb3VuZENvbG9yLCBwcm9ncmVzc0NvbG9yIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICAgIGxldCBwcm9ncmVzcyA9IFtdO1xyXG4gICAgICAgIGlmKG51bWJlck9mVGFza3MgPiBtYXhpbXVtVGFza3NEaXNwbGF5ZWQpe1xyXG4gICAgICAgICAgIHJldHVybiA8ZGl2PiB7Y29tcGxldGVkTnVtYmVyT2ZUYXNrc30gLyB7bnVtYmVyT2ZUYXNrc30gPC9kaXY+O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgdGFza05vID0gMTsgdGFza05vIDw9IG51bWJlck9mVGFza3M7IHRhc2tObysrKSB7XHJcbiAgICAgICAgICAgIHByb2dyZXNzLnB1c2goXHJcbiAgICAgICAgICAgIDxzdmcga2V5PXt0YXNrTm99PlxyXG4gICAgICAgICAgICAgICAgPGNpcmNsZSBjbGFzc05hbWU9XCJjaXJjbGUtY2hhcnQtYmFja2dyb3VuZFwiIGZpbGw9e3Rhc2tObyA+IGNvbXBsZXRlZE51bWJlck9mVGFza3MgPyBiYWNrZ3JvdW5kQ29sb3IgOiBwcm9ncmVzc0NvbG9yfSBjeD1cIjhcIiBjeT1cIjhcIiByPVwiOFwiIC8+XHJcbiAgICAgICAgICAgIDwvc3ZnPlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcHJvZ3Jlc3M7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCl7ICBcclxuICAgICAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJnb2Fscy1wcm9ncmVzc1wiPnt0aGlzLmNyZWF0ZVByb2dyZXNzKCl9PC9kaXY+XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gICAgcGVyY2VudGFnZTogbnVtYmVyO1xyXG4gICAgYmFja2dyb3VuZENvbG9yPzogc3RyaW5nO1xyXG4gICAgcHJvZ3Jlc3NDb2xvcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2dyZXNzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgICBwdWJsaWMgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcclxuICAgICAgICBwZXJjZW50YWdlOiAwLFxyXG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjRjFGNUY0XCIsXHJcbiAgICAgICAgcHJvZ3Jlc3NDb2xvcjogXCIjM2RiY2EyXCIsXHJcbiAgICB9O1xyXG5cclxuICAgIHJlbmRlcigpe1xyXG4gICAgICAgIGNvbnN0IHtwZXJjZW50YWdlLCBiYWNrZ3JvdW5kQ29sb3IsIHByb2dyZXNzQ29sb3J9ID0gdGhpcy5wcm9wcztcclxuICAgICAgICBjb25zdCByb3VuZGVkUGVyY2VudGFnZSA9IE1hdGgucm91bmQocGVyY2VudGFnZSk7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgPHN2ZyBjbGFzc05hbWU9XCJwcm9ncmVzcy1jaGFydFwiIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjI1XCI+XHJcbiAgICAgICAgICAgIDxyZWN0IGZpbGw9e2JhY2tncm91bmRDb2xvcn0gIHdpZHRoPVwiMTAwJVwiIGhlaWdodD1cIjEwMCVcIiByeD1cIjRcIi8+XHJcbiAgICAgICAgICAgIDxyZWN0IGNsYXNzTmFtZT1cImZpbGxcIiBmaWxsPXtwcm9ncmVzc0NvbG9yfSB3aWR0aD17YCR7cm91bmRlZFBlcmNlbnRhZ2V9JWB9IGhlaWdodD1cIjEwMCVcIiByeD1cIjRcIi8+XHJcbiAgICAgICAgICAgIDx0ZXh0IGNsYXNzTmFtZT1cImZpbGxlZC10ZXh0XCIgdGV4dEFuY2hvcj1cIm1pZGRsZVwiIHg9XCI1MCVcIiB5PVwiNTAlXCIgZHk9XCIuM2VtXCI+e2Ake3JvdW5kZWRQZXJjZW50YWdlfSVgfTwvdGV4dD5cdFxyXG4gICAgICAgICAgICA8L3N2Zz5cclxuICAgICAgICApXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IGlzVGVhY2hlckF0U2Nob29sIH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1wbG95ZWUoYXRTY2hvb2w/OiBzdHJpbmcpIHtcclxuICByZXR1cm4gYXRTY2hvb2wgP1xyXG4gICAgaXNUZWFjaGVyQXRTY2hvb2woZW52LmN1cnJlbnRVc2VyLCBhdFNjaG9vbCkgfHwgZW52LmN1cnJlbnRVc2VyLnJvbGVzLmluY2x1ZGVzKFwiQURNSU5cIikgOlxyXG4gICAgZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnRU1QTE9ZRUUnIHx8IHJvbGUgPT09ICdBRE1JTicpO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gXCIuLi8uLi8uLi91dGlscy91dGlsc1wiO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBvbkNsaWNrLFxyXG4gIGNsYXNzTmFtZT8sXHJcbiAgc3R5bGU/LFxyXG4gIHRpdGxlP1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IFJlbW92ZUl0ZW0gPSAoeyBvbkNsaWNrLCBjbGFzc05hbWUsIHN0eWxlLCB0aXRsZSB9OiBQcm9wcykgPT5cclxuXHJcbiAgPGRpdlxyXG4gICAgdGl0bGU9e3RpdGxlIHx8IExgUmFkZXJhYH1cclxuICAgIGNsYXNzTmFtZT17XCJyZW1vdmVJdGVtIFwiICsgKGNsYXNzTmFtZSB8fCBcIlwiKX1cclxuICAgIG9uQ2xpY2s9e29uQ2xpY2t9IHN0eWxlPXtzdHlsZX0gLz5cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuZXhwb3J0IGNvbnN0IFNwaW5uZXIgPSAoKT0+IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4mbmJzcDs8L3NwYW4+O1xyXG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IERvY3VtZW50LCBSZXNvdXJjZSwgTW9kaWZpY2F0aW9uVHJhY2tlZCwgQ291cnNlLCBUYXNrLCBTb2Z0RG9jdW1lbnRBY2Nlc3MgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IEJhdGNoUnVubmVyLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xyXG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IGdldEZpcnN0QW5kTGFzdFdlZWtPZlRlcm0gfSBmcm9tICcuLi8uLi91dGlscy9zY2hvb2wtbW9tZW50JztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVEb2N1bWVudEdyYXBocyhvbGREb2MsIG5ld0RvYywgdGFibGU6IHN0cmluZywgZ3JhcGhzOiB7IFtsYWJlbDogc3RyaW5nXTogc3RyaW5nIH0sIGJhdGNoOiBCYXRjaFJ1bm5lcikge1xyXG4gIGNvbnN0IGRvY1VwZGF0ZXMgPSB7fTtcclxuICBjb25zdCBkb2NJZCA9IG5ld0RvYy5pZDtcclxuICBmb3IgKGxldCBuYXZQcm9wIG9mIE9iamVjdC5rZXlzKGdyYXBocykpIHtcclxuICAgIGNvbnN0IGZvcmVpZ25UYWJsZSA9IGdyYXBoc1tuYXZQcm9wXTtcclxuICAgIGNvbnN0IG9sZExpc3Q6IERvY3VtZW50W10gPSBvbGREb2NbbmF2UHJvcF0gfHwgW107XHJcbiAgICBjb25zdCBuZXdMaXN0OiBEb2N1bWVudFtdID0gbmV3RG9jW25hdlByb3BdO1xyXG4gICAgaWYgKCFuZXdMaXN0KSBjb250aW51ZTtcclxuICAgIGNvbnN0IHR1cGxlcyA9IG5ld0xpc3RcclxuICAgICAgLm1hcCgoZG9jLCBpZHgpPT4oe2RvYywgaWR4fSkpOyAvLyBDcmVhdGUgdHVibGVzIG9mIHtkb2MsIGFycmF5LWluZGV4fSBzbyB3ZSBjYW4gdXBkYXRlIHJlc3VsdFxyXG4gICAgY29uc3QgYWRkZWQgPSB0dXBsZXMuZmlsdGVyKHR1cGxlID0+ICFvbGRMaXN0LnNvbWUobyA9PiBvLmlkID09PSB0dXBsZS5kb2MuaWQpKTsgLy8gRmluZCBhZGRlZCBpdGVtc1xyXG5cclxuICAgIGZvciAobGV0IGEgb2YgYWRkZWQpIHtcclxuICAgICAgY29uc3QgbXV0YXRlZFN1YkRvYyA9IHsuLi5hLmRvY307XHJcbiAgICAgIGNvbnN0IG1ldGEgPSBtdXRhdGVkU3ViRG9jLiRtZXRhO1xyXG4gICAgICBkZWxldGUgbXV0YXRlZFN1YkRvYy4kbWV0YTsgLy8gRGVsZXRlICRtZXRhIHNvIHRoYXQgXCJhZGRcIiBvciBcInVwZGF0ZVwiIGRvZXMgbm90IHBlcnNpc3RlIHRvIG5leHQgc3RhdGUuXHJcbiAgICAgIGlmIChtZXRhID09PSAnYWRkJykge1xyXG4gICAgICAgIGlmICghbXV0YXRlZFN1YkRvYy5pZCkgbXV0YXRlZFN1YkRvYy5pZCA9IGNyZWF0ZVVVSUQoKTsgLy8gR2VuZXJhdGUgSUQgaWYgbm90IGRvbmUgeWV0LlxyXG4gICAgICAgIC8vIE5vdyBwdXQgYW4gJ2FkZCcgbXV0YXRpb24gaW4gdGhlIGJhdGNoIHF1ZXVlLlxyXG4gICAgICAgIGJhdGNoLmFkZChmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MpO1xyXG4gICAgICB9IGVsc2UgaWYgKG1ldGEgPT09ICd1cGRhdGUnKSB7XHJcbiAgICAgICAgYmF0Y2gucHV0KGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYyk7XHJcbiAgICAgIH1cclxuICAgICAgYmF0Y2gubGluayh0YWJsZSwgZG9jSWQsIGZvcmVpZ25UYWJsZSwgbXV0YXRlZFN1YkRvYy5pZCwgbmF2UHJvcCk7XHJcblxyXG4gICAgICAvLyBVcGRhdGUgcmVzdWx0IHNvIHRoYXQgc3RhdGUgaXMgcmVmbGVjdGVkIGFmdGVyIHN1Y2Nlc2Z1bCBQT1NUIHRvIHNlcnZlci5cclxuICAgICAgaWYgKCFkb2NVcGRhdGVzW25hdlByb3BdKSBkb2NVcGRhdGVzW25hdlByb3BdID0ge307XHJcbiAgICAgIGRvY1VwZGF0ZXNbbmF2UHJvcF1bYS5pZHhdID0geyRzZXQ6IG11dGF0ZWRTdWJEb2N9O1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVtb3ZlZCA9IG9sZExpc3QuZmlsdGVyKG8gPT4gIW5ld0xpc3Quc29tZShuID0+IG4uaWQgPT09IG8uaWQpKTtcclxuICAgIGZvciAobGV0IHIgb2YgcmVtb3ZlZCkge1xyXG4gICAgICBiYXRjaC51bmxpbmsodGFibGUsIGRvY0lkLCBmb3JlaWduVGFibGUsIHIuaWQsIG5hdlByb3ApO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdXBkYXRlZCA9IHR1cGxlcy5maWx0ZXIodHVwbGUgPT4gb2xkTGlzdC5zb21lKG8gPT4gby5pZCA9PT0gdHVwbGUuZG9jLmlkICYmIHR1cGxlLmRvYy4kbWV0YSA9PT0gJ3VwZGF0ZScpKTtcclxuICAgIGZvciAobGV0IHUgb2YgdXBkYXRlZCkge1xyXG4gICAgICBjb25zdCBtdXRhdGVkU3ViRG9jID0gey4uLnUuZG9jfTtcclxuICAgICAgZGVsZXRlIG11dGF0ZWRTdWJEb2MuJG1ldGE7XHJcbiAgICAgIGJhdGNoLnB1dChmb3JlaWduVGFibGUsIG11dGF0ZWRTdWJEb2MpO1xyXG5cclxuICAgICAgLy8gVXBkYXRlIHJlc3VsdCBzbyB0aGF0ICRtZXRhIGlzIHJlbW92ZWQgZnJvbSBuYXZpZ2F0aW9uIHByb3AgYWZ0ZXIgc3VjY2Vzc2Z1bCBQT1NUIHRvIHNlcnZlci5cclxuICAgICAgaWYgKCFkb2NVcGRhdGVzW25hdlByb3BdKSBkb2NVcGRhdGVzW25hdlByb3BdID0ge307XHJcbiAgICAgIGRvY1VwZGF0ZXNbbmF2UHJvcF1bdS5pZHhdID0geyRzZXQ6IG11dGF0ZWRTdWJEb2N9O1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gdXBkYXRlKG5ld0RvYywgZG9jVXBkYXRlcyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkdEZvcm1hdChkYXRlVGltZTogbnVtYmVyIHwgRGF0ZSB8IG1vbWVudC5Nb21lbnQpIHtcclxuICByZXR1cm4gbW9tZW50KGRhdGVUaW1lKS5mb3JtYXQoJ1lZTU1ERCBISDptbScpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvcnREYXRlRm9ybWF0KGRhdGVUaW1lOiBudW1iZXIgfCBEYXRlIHwgbW9tZW50Lk1vbWVudCkge1xyXG4gIHJldHVybiBtb21lbnQoZGF0ZVRpbWUpLmZvcm1hdCgnWVlNTUREJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG9ydFBlcnNvbk5hbWVGb3JtYXQobmFtZTogc3RyaW5nKSB7XHJcbiAgaWYgKCFuYW1lKSByZXR1cm4gXCJcIjtcclxuICBjb25zdCBuYW1lcyA9IG5hbWUuc3BsaXQoJyAnKS5maWx0ZXIobiA9PiAhIW4pO1xyXG4gIGNvbnN0IGxhc3ROYW1lID0gbmFtZXMucG9wKCk7XHJcbiAgcmV0dXJuIG5hbWVzLm1hcChuYW1lID0+IGAke25hbWVbMF19LmApLmNvbmNhdChsYXN0TmFtZSkuam9pbignICcpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlTW9kaWZpY2F0aW9uU3RhbXAgKG5vdzogbnVtYmVyLCBvYmo6IE1vZGlmaWNhdGlvblRyYWNrZWQsIHVzZXI6IFVzZXIpIHtcclxuICByZXR1cm4gdXBkYXRlKG9iaiwge1xyXG4gICAgZGF0ZVRpbWU6IHskc2V0OiBub3d9LCAvLyBGb3IgcXVlcmllcy4uLlxyXG4gICAgbW9kaWZpZWREYXRlOiB7JHNldDogbm93fSxcclxuICAgIG1vZGlmaWVkQnk6IHtcclxuICAgICAgJHNldDoge1xyXG4gICAgICAgIG5hbWU6IHVzZXIuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDcmVhdGlvblN0YW1wPFQgZXh0ZW5kcyBNb2RpZmljYXRpb25UcmFja2VkPiAobm93OiBudW1iZXIsIG9iajogVCwgdXNlcjogVXNlcik6IFQge1xyXG4gIHJldHVybiB1cGRhdGUob2JqLCB7XHJcbiAgICBjcmVhdGVkRGF0ZTogeyRzZXQ6IG5vd30sXHJcbiAgICBjcmVhdGVkQnk6IHtcclxuICAgICAgJHNldDoge1xyXG4gICAgICAgIG5hbWU6IHVzZXIuZGlzcGxheU5hbWUsXHJcbiAgICAgICAgdXJsOiBcIm1haWx0bzpcIiArIHVzZXIubWFpbFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbWFpbEZyb21Eb2NBY2Nlc3MgKHJlc291cmNlOiBTb2Z0RG9jdW1lbnRBY2Nlc3MpIHtcclxuICBpZiAocmVzb3VyY2UuZW1haWwpIHJldHVybiByZXNvdXJjZS5lbWFpbDtcclxuICByZXR1cm4gcmVzb3VyY2UudXJsID9cclxuICAgIHJlc291cmNlLnVybC5zdGFydHNXaXRoKCdtYWlsdG86JykgP1xyXG4gICAgICByZXNvdXJjZS51cmwuc3Vic3RyaW5nKCdtYWlsdG86Jy5sZW5ndGgpIDpcclxuICAgICAgcmVzb3VyY2UudXJsIDpcclxuICAgIHJlc291cmNlLnVybDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vZGlmaWNhdGlvbkFuZENyZWF0aW9uU3RhbXBzKG9iajogTW9kaWZpY2F0aW9uVHJhY2tlZCwgdXNlcjogVXNlcikge1xyXG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgb2JqID0gdXBkYXRlTW9kaWZpY2F0aW9uU3RhbXAobm93LCBvYmosIHVzZXIpO1xyXG4gIGlmICghb2JqLmNyZWF0ZWRCeSkgb2JqID0gdXBkYXRlQ3JlYXRpb25TdGFtcChub3csIG9iaiwgdXNlcik7XHJcbiAgcmV0dXJuIG9iajtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5RXRhZ3MoZG9jOiBEb2N1bWVudCwgbmV3RXRhZ3M6IHtbaWQ6IHN0cmluZ106IHN0cmluZ30sIGdyYXBoczogc3RyaW5nW10pIHtcclxuICBjb25zdCByZXMgPSB7Li4uZG9jfTtcclxuICBjb25zdCBldGFnID0gbmV3RXRhZ3NbZG9jLmlkXTtcclxuICBpZiAoZXRhZylcclxuICAgIHJlcy4kZXRhZyA9IGV0YWc7XHJcbiAgZm9yIChsZXQgbGFiZWwgb2YgZ3JhcGhzKSB7XHJcbiAgICBjb25zdCBuZXdMaXN0ID0gZG9jW2xhYmVsXS5tYXAoZCA9PiBhcHBseUV0YWdzKGQsIG5ld0V0YWdzLCBbXSkpO1xyXG4gICAgcmVzW2xhYmVsXSA9IG5ld0xpc3Q7XHJcbiAgfVxyXG4gIHJldHVybiByZXM7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWFkQmxvYihibG9iOiBCbG9iLCBtOiAocjpGaWxlUmVhZGVyKT0+dm9pZCkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgcmVhZGVyLm9ubG9hZCA9IGV2ID0+IHJlc29sdmUoKGV2LnRhcmdldCBhcyBhbnkpLnJlc3VsdCk7XHJcbiAgICByZWFkZXIub25hYm9ydCA9IGV2ID0+IHJlamVjdChuZXcgRXJyb3IoXCJmaWxlIHJlYWQgYWJvcnRlZFwiKSk7XHJcbiAgICByZWFkZXIub25lcnJvciA9IGV2ID0+IHJlamVjdCgoZXYudGFyZ2V0IGFzIGFueSkuZXJyb3IpO1xyXG4gICAgbShyZWFkZXIpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQgKGJsb2I6IEJsb2IpIHtcclxuICByZXR1cm4gcmVhZEJsb2IoYmxvYiwgcj0+ci5yZWFkQXNUZXh0KGJsb2IpKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlYWRCbG9iQXNEYXRhVXJsIChibG9iOiBCbG9iKSB7XHJcbiAgcmV0dXJuIHJlYWRCbG9iKGJsb2IsIHI9PnIucmVhZEFzRGF0YVVSTChibG9iKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhbGxvd0NvcHkoZTogUmVhY3QuRHJhZ0V2ZW50PEhUTUxEaXZFbGVtZW50Pikge1xyXG4gIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnY29weSc7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDb3Vyc2VCdWlsZGVyU3RhdHVzKHN0YXR1czogJ3Vuc2F2ZWQnIHwgJ3NhdmVkJyB8ICdlcnJvcicgfCAnJykge1xyXG4gIGNvbnN0IGRpdiA9ICQoJ2Rpdi5jb3Vyc2UtYnVpbGRlcicpWzBdO1xyXG4gIGlmIChkaXYpIGRpdi5jbGFzc05hbWUgPSBcImNvdXJzZS1idWlsZGVyXCIgKyAoc3RhdHVzID8gXCIgc3RhdHVzIFwiICsgc3RhdHVzIDogXCJcIik7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkQ291cnNlKGlkOiBzdHJpbmcsIG9wdGlvbnM/OiB7XHJcbiAgICBpbmNsdWRlVGVtcGxhdGVDaGFpbj86IGJvb2xlYW4sXHJcbiAgICBpbmNsdWRlPzogc3RyaW5nW11cclxuICB9KTogUHJvbWlzZTxDb3Vyc2U+XHJcbntcclxuICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudDtcclxuICBjb25zdCBpbmNsdWRlVGVtcGxhdGVDaGFpbiA9IG9wdGlvbnMgJiYgb3B0aW9ucy5pbmNsdWRlVGVtcGxhdGVDaGFpbjtcclxuICBjb25zdCBpbmNsdWRlVGFza3MgPSAhb3B0aW9ucyB8fCAhb3B0aW9ucy5pbmNsdWRlIHx8IG9wdGlvbnMuaW5jbHVkZS5pbmRleE9mKFwidGFza3NcIikgIT09IC0xO1xyXG4gIGNvbnN0IFtjb3Vyc2UsIGNvdXJzZVRhc2tzLCB0ZW1wbGF0ZUNoYWluXSA9IChhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICBjbGllbnQuZ2V0KFwiY291cnNlc1wiLCBpZCwge1xyXG4gICAgICBpbmNsdWRlOiBvcHRpb25zICYmIG9wdGlvbnMuaW5jbHVkZSA/IG9wdGlvbnMuaW5jbHVkZS5maWx0ZXIoaSA9PiBpICE9PSBcInRhc2tzXCIpIDogW1xyXG4gICAgICAgIFwiY2VudHJhbENvbnRlbnRcIixcclxuICAgICAgICBcImtub3dsZWRnZVJlcXVpcmVtZW50c1wiLFxyXG4gICAgICAgIFwiYWJpbGl0aWVzXCIsXHJcbiAgICAgICAgXCJpbWFnZXNcIixcclxuICAgICAgICBcImFjbFwiIC8vIERvbid0IGluY2x1ZGUgdGFza3MgaGVyZS4uLlxyXG4gICAgICBdXHJcbiAgICB9KSxcclxuICAgIC8vIC4uLiBidXQgaW5jbHVkZSB0YXNrcyBoZXJlIGluc3RlYWQgc28gdGhhdCB3ZSBjYW4gbG9hZCB0aGUgZ3JhcGhzIGZvciB0aGVcclxuICAgIC8vIHRhc2tzIGFzIHdlbGwhXHJcbiAgICBpbmNsdWRlVGFza3MgJiYgY2xpZW50Lmxpc3QoXCJ0YXNrc1wiLCB7XHJcbiAgICAgIGhhc0VkZ2VzRnJvbTogaWQsXHJcbiAgICAgIGluY2x1ZGU6IFsna25vd2xlZGdlUmVxdWlyZW1lbnRzJywgJ2NlbnRyYWxDb250ZW50JywgJ2FiaWxpdGllcycsICdhY2wnXSxcclxuICAgICAgZmxhZ3M6IFsnaW5jbHVkZUlkc09ubHknXSAvLyBEb24ndCBuZWVkIHJlZHVuZGFudCBpbmZvIHRoYXQncyBhbHJlYWR5IG9uIGNvdXJzZVxyXG4gICAgfSksXHJcbiAgICBpbmNsdWRlVGVtcGxhdGVDaGFpbiAmJiBjbGllbnQubGlzdChcImNvdXJzZXNcIiwge1xyXG4gICAgICBoYXNFZGdlc0Zyb206IGlkLFxyXG4gICAgICBmbGFnczogWydpZHNPbmx5J11cclxuICAgIH0pXHJcbiAgXSkpIGFzIFtDb3Vyc2UsIFRhc2tbXSwgQ291cnNlW11dO1xyXG4gIGNvdXJzZS50YXNrcyA9IGNvdXJzZVRhc2tzO1xyXG5cclxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBBYmlsaXRpZXNcclxuICBpZiAoY291cnNlLmFiaWxpdGllcyAmJiBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIpIHtcclxuICAgIGNvdXJzZS5hYmlsaXRpZXMgPSBjb3Vyc2UuYWJpbGl0aWVzT3JkZXIubWFwKGlkID0+XHJcbiAgICAgIGNvdXJzZS5hYmlsaXRpZXMuZmluZChhID0+IGEuaWQgPT09IGlkKSk7XHJcbiAgfVxyXG5cclxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBLbm93bGVkZ2VSZXF1aXJlbWVudHNcclxuICBpZiAoY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cyAmJiBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIpIHtcclxuICAgIGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMgPSBjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzT3JkZXIubWFwKGlkID0+XHJcbiAgICAgIGNvdXJzZS5rbm93bGVkZ2VSZXF1aXJlbWVudHMuZmluZChjID0+IGMuaWQgPT09IGlkKSk7XHJcbiAgfVxyXG5cclxuICAvLyBDb3JyZWN0IHRoZSBvcmRlciBvZiBDZW50cmFsQ29udGVudFxyXG4gIGlmIChjb3Vyc2UuY2VudHJhbENvbnRlbnQgJiYgY291cnNlLmNlbnRyYWxDb250ZW50T3JkZXIpIHtcclxuICAgIGNvdXJzZS5jZW50cmFsQ29udGVudCA9IGNvdXJzZS5jZW50cmFsQ29udGVudE9yZGVyLm1hcChpZCA9PlxyXG4gICAgICBjb3Vyc2UuY2VudHJhbENvbnRlbnQuZmluZChjYyA9PiBjYy5pZCA9PT0gaWQpKTsvLy5maWx0ZXIoeCA9PiAhIXgpOy8vIERlYnVnZ2luZyBzb210aGluJyAuIE5vcm1hbGx5IHRoZSBsYXN0IC5maWx0ZXIoKS4uLiBwYXJ0IHNob3VsZCBub3QgYmUgbmVzY2Vzc2FyeS4uLlxyXG4gIH1cclxuICBcclxuICAvLyBJbmNsdWRlIHRlbXBsYXRlIGNoYWluIGlmIHJlcXVlc3RlZC5cclxuICBpZiAoaW5jbHVkZVRlbXBsYXRlQ2hhaW4pIGNvdXJzZS50ZW1wbGF0ZUNoYWluID0gdGVtcGxhdGVDaGFpbjtcclxuICByZXR1cm4gY291cnNlO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5cclxudHlwZSBDYWxsYmFjayA9ICgpPT52b2lkO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0aXRsZTogc3RyaW5nLFxyXG4gIGJhY2tncm91bmRJbWFnZTogc3RyaW5nLFxyXG4gIHRhYnM6IHtuYW1lOiBzdHJpbmcgfCBKU1guRWxlbWVudCwga2V5Pzogc3RyaW5nLCBsaW5rOiBzdHJpbmd9W10sXHJcbiAgYWN0aXZlVGFiOiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IENvdXJzZUJhbm5lciA9IChwcm9wczogUHJvcHMpID0+IHtcclxuICBjb25zdCB7IHRpdGxlLCBiYWNrZ3JvdW5kSW1hZ2UsIHRhYnMsIGFjdGl2ZVRhYiB9ID0gcHJvcHM7XHJcblxyXG4gIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtbGF5b3V0IHN2LXNraXAtc3BhY2VyIHN2LWNvbHVtbi0xMlwiPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXNjcmlwdC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICB7YmFja2dyb3VuZEltYWdlICYmIDxzdHlsZT57YFxyXG4gICAgICAgIC5wYWdlSGVhZGVyIHtcclxuICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnJHtiYWNrZ3JvdW5kSW1hZ2V9JykgIWltcG9ydGFudDtcclxuICAgICAgICB9XHJcbiAgICAgIGB9PC9zdHlsZT59XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlSGVhZGVyXCI+XHJcbiAgICAgICAgICA8YT5cclxuICAgICAgICAgICAgPGgxPnt0aXRsZX08L2gxPlxyXG4gICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zRmllbGRcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidXR0b25zQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+PC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9J2hvcml6b250YWxNZW51Jz5cclxuICAgICAgICAgICAgICAgIDx1bD5cclxuICAgICAgICAgICAgICAgICAge3RhYnMubWFwKCh7bmFtZSwga2V5LCBsaW5rfSwgaWR4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBY3RpdmUgPSBhY3RpdmVUYWIgPT09IGxpbms7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDxsaSBrZXk9e2tleSB8fCAodHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnID8gbmFtZSA6IGlkeCl9IGNsYXNzTmFtZT17aXNBY3RpdmUgPyBcImFjdGl2ZVBhZ2VcIiA6IFwiXCJ9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17bGlua30+e25hbWV9PC9hPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvbGk+XHJcbiAgICAgICAgICAgICAgICAgIH0pfVxyXG4gICAgICAgICAgICAgICAgPC91bD5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICA8L2Rpdj5cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEwsIGFycmF5VG9Mb29rdXAgfSBmcm9tICcuLi8uLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZSB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2tub3dsZWRnZS1yZXF1aXJlbWVudHMtdGFibGVcIjtcclxuaW1wb3J0IGdldEluY2x1ZGVkSWRzIGZyb20gJy4uL3V0aWxzL2dldC1pbmNsdWRlZC1pZHMnO1xyXG5pbXBvcnQgeyBBYmlsaXRpZXNCb3ggfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9hYmlsaXRpZXMtYm94XCI7XHJcbmltcG9ydCB7IENlbnRyYWxDb250ZW50Qm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvY2VudHJhbC1jb250ZW50LWJveFwiO1xyXG5pbXBvcnQgeyBMZWFybmluZ0dvYWxzTGlzdCB9IGZyb20gJy4uL3N1YmNvbXBvbmVudHMvbGVhcm5pbmctZ29hbHMtbGlzdCc7XHJcbmltcG9ydCB7IFRhc2tMaXN0IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy90YXNrLWxpc3QnO1xyXG5pbXBvcnQgeyBnZXRDdXN0b21pemVkVGFzayB9IGZyb20gJy4vZ2V0LWN1c3RvbWl6ZWQtdGFzayc7XHJcblxyXG4vLyBWaWV3c1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2U6IENvdXJzZTtcclxuICBtb2R1bGU6IENvdXJzZU1vZHVsZTtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvdXJzZU1vZHVsZVBhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyBtb2R1bGUsIGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IGluY2x1ZWRJZHMgPSBnZXRJbmNsdWRlZElkcyhtb2R1bGUsIGNvdXJzZSk7XHJcbiAgICBjb25zdCBsZWFybmluZ1Rhc2tzID0gbW9kdWxlLnRhc2tJZHNcclxuICAgICAgLm1hcChpZCA9PiBjb3Vyc2UudGFza3MuZmluZCh0ID0+IHQuaWQgPT09IGlkKSlcclxuICAgICAgLmZpbHRlcih0YXNrID0+ICEhdGFzaylcclxuICAgICAgLm1hcCh0YXNrID0+ICh7XHJcbiAgICAgICAgaWQ6IHRhc2suaWQsXHJcbiAgICAgICAgdGFzazogZ2V0Q3VzdG9taXplZFRhc2sobW9kdWxlLCB0YXNrKSxcclxuICAgICAgICBjb3Vyc2UsXHJcbiAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgIHVybDogYCMke2VuY29kZVVSSUNvbXBvbmVudChtb2R1bGUubmFtZS50cmltKCkpfS8ke3Rhc2suaWR9YCwgLy8gRsO2cnPDpHR0c2JsYWRldHMgVVJMXHJcbiAgICAgICAgY291cnNlTmFtZTogY291cnNlLm5hbWUsXHJcbiAgICAgICAgbGVhcm5pbmdHb2FsOiB0YXNrLmxlYXJuaW5nR29hbCB8fCBtb2R1bGUubmFtZSxcclxuICAgICAgfSkpO1xyXG4gICAgY29uc3QgYXNzaWdubWVudFRhc2tzID0gbGVhcm5pbmdUYXNrcy5maWx0ZXIodCA9PiB0LnRhc2sgJiYgdC50YXNrLmFzc2lnbm1lbnQpO1xyXG4gICAgY29uc3Qgbm9uQXNzaWdubWVudFRhc2tzID0gbGVhcm5pbmdUYXNrcy5maWx0ZXIodCA9PiAhdC50YXNrIHx8ICF0LnRhc2suYXNzaWdubWVudCk7XHJcbiAgICBjb25zdCBjb21tb25UYXNrcyA9IG5vbkFzc2lnbm1lbnRUYXNrcy5maWx0ZXIodCA9PiAhdC50YXNrLmxlYXJuaW5nR29hbCk7XHJcbiAgICBjb25zdCBsZWFybmluZ0dvYWxzID0gYXJyYXlUb0xvb2t1cChcclxuICAgICAgbm9uQXNzaWdubWVudFRhc2tzLmZpbHRlcih0ID0+ICEhdC50YXNrLmxlYXJuaW5nR29hbCksXHJcbiAgICAgIHQgPT4gdC5sZWFybmluZ0dvYWwpO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdGV4dC1wb3J0bGV0IHN2LXVzZS1tYXJnaW5zIHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxyXG4gICAgICAgICAgPGgxIGNsYXNzTmFtZT1cImgxXCI+e21vZHVsZS5uYW1lfTwvaDE+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXZlcnRpY2FsIHN2LWxheW91dFwiPlxyXG4gICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3sgX19odG1sOiBtb2R1bGUubWFuZGF0b3J5Q29udGVudCB9fT5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJrZWRfYm94ZWRcIj5cclxuICAgICAgICAgIDxoMz5Nb2R1bGVucyBrdW5za2Fwc2tyYXYsIGbDtnJtw6Vnb3Igb2NoIGNlbnRyYWxhIGlubmVow6VsbDwvaDM+XHJcbiAgICAgICAgICB7KCEhbW9kdWxlLnN0YXJ0V2VlayB8fCAhIW1vZHVsZS5lbmRXZWVrKSAmJiA8ZGl2IGNsYXNzTmFtZT1cIndlZWstcGVyaW9kLWRpdlwiPlxyXG4gICAgICAgICAgICA8ZGl2PlN0YXJ0dmVja2E8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdj57bW9kdWxlLnN0YXJ0V2VlayB8fCBcIi0tXCJ9PC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXY+U2x1dHZlY2thPC9kaXY+XHJcbiAgICAgICAgICAgIDxkaXY+e21vZHVsZS5lbmRXZWVrIHx8IFwiLS1cIn08L2Rpdj5cclxuICAgICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICA8aHIgLz5cclxuXHJcbiAgICAgICAgICA8S25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGVcclxuICAgICAgICAgICAgdGl0bGU9XCJJIGRlbiBow6RyIG1vZHVsZW4gYmVkw7ZtcyBmw7ZsamFuZGUga3Vuc2thcHNrcmF2XCJcclxuICAgICAgICAgICAgcmVxdWlyZW1lbnRzPXtjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzfVxyXG4gICAgICAgICAgICBpbmNsdWRlZElkcz17aW5jbHVlZElkc30gLz5cclxuXHJcbiAgICAgICAgICA8QWJpbGl0aWVzQm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiRGVuIGjDpHIgbW9kdWxlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGbDtnJtw6Vnb3JcIlxyXG4gICAgICAgICAgICBhYmlsaXRpZXM9e2NvdXJzZS5hYmlsaXRpZXMuZmlsdGVyKGEgPT4gaW5jbHVlZElkc1thLmlkXSl9IC8+XHJcblxyXG4gICAgICAgICAgPENlbnRyYWxDb250ZW50Qm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiRGVuIGjDpHIgbW9kdWxlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGNlbnRyYWxhIGlubmVow6VsbFwiXHJcbiAgICAgICAgICAgIGNlbnRyYWxDb250ZW50PXtjb3Vyc2UuY2VudHJhbENvbnRlbnQuZmlsdGVyKGMgPT4gaW5jbHVlZElkc1tjLmlkXSl9IC8+XHJcblxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuXHJcbiAgICAgIHttb2R1bGUudGFza0lkcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3Ytc2NyaXB0LXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XHJcbiAgICAgICAgICB7YXNzaWdubWVudFRhc2tzLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IDw+XHJcbiAgICAgICAgICAgIDxoMj5JbmzDpG1uaW5nc3VwcGdpZnRlcjwvaDI+XHJcbiAgICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgICA8VGFza0xpc3QgbGVhcm5pbmdUYXNrcz17YXNzaWdubWVudFRhc2tzfSAvPlxyXG4gICAgICAgICAgPC8+fVxyXG4gICAgICAgICAge25vbkFzc2lnbm1lbnRUYXNrcy5sZW5ndGggPT09IDAgPyB1bmRlZmluZWQgOiA8PlxyXG4gICAgICAgICAgICA8aDI+VXBwZ2lmdGVyPC9oMj5cclxuICAgICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICAgIDxMZWFybmluZ0dvYWxzTGlzdFxyXG4gICAgICAgICAgICAgIGNvbW1vblRhc2tzPXtjb21tb25UYXNrc31cclxuICAgICAgICAgICAgICBsZWFybmluZ0dvYWxzPXtPYmplY3Qua2V5cyhsZWFybmluZ0dvYWxzKS5tYXAobGVhcm5pbmdHb2FsID0+ICh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBsZWFybmluZ0dvYWwsXHJcbiAgICAgICAgICAgICAgICBsZWFybmluZ1Rhc2tzOiBsZWFybmluZ0dvYWxzW2xlYXJuaW5nR29hbF1cclxuICAgICAgICAgICAgICB9KSl9IC8+XHJcbiAgICAgICAgICAgIDwvPn1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+fVxyXG4gICAgICB7bW9kdWxlLnJlc291cmNlcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImtlZF9ib3hlZFwiPlxyXG4gICAgICAgICAgPGgyPlJlc3Vyc2VyPC9oMj5cclxuICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+e21vZHVsZS5yZXNvdXJjZXMubWFwKChyLCBpZHgpID0+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiIGtleT17aWR4fT5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgPGEgaHJlZj17ci51cmx9PntyLm5hbWV9PC9hPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2Pn1cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBDb3Vyc2VNb2R1bGUsIFRhc2sgfSBmcm9tIFwia2VkYmFja2VuZC9tb2RlbHNcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXN0b21pemVkVGFzayhtb2R1bGU6IENvdXJzZU1vZHVsZSwgdGFzazogVGFzaykge1xyXG4gIHJldHVybiBtb2R1bGUudGFza0N1c3RvbWl6YXRpb25zID9cclxuICAgIHsuLi50YXNrLCAuLi5tb2R1bGUudGFza0N1c3RvbWl6YXRpb25zW3Rhc2suaWRdfSA6XHJcbiAgICB0YXNrO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCwgc2hvd0Vycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBDb3Vyc2VCYW5uZXIgfSBmcm9tIFwiLi9jb3Vyc2UtYmFubmVyXCI7XHJcbmltcG9ydCB7IENvdXJzZSwgQ291cnNlTW9kdWxlLCBUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBwYXJzZUhhc2hRdWVyeVN0cmluZyB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgQ291cnNlTW9kdWxlUGFnZSB9IGZyb20gJy4vY291cnNlLW1vZHVsZS1wYWdlJztcclxuaW1wb3J0IHsgUnVuVXBQYWdlIH0gZnJvbSAnLi9ydW4tdXAtcGFnZSc7XHJcbmltcG9ydCB7IGluaXRNYW51YWxTY3JvbGxSZXN0b3JhdGlvbiwgcmVzdG9yZVNjcm9sbFBvc2l0aW9uIH0gZnJvbSAnLi4vdXRpbHMvbWFudWFsLXNjcm9sbC1yZXN0b3JhdGlvbic7XHJcbmltcG9ydCB7IGhhc1dyaXRlQWNjZXNzLCBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gJy4uLy4uLy4uL2FjY2Vzcy1jb250cm9sJztcclxuaW1wb3J0IHsgV2Vla1BsYW5uZXIgfSBmcm9tIFwiLi4vLi4vd2Vla3BsYW5uZXJcIjtcclxuaW1wb3J0IHsgVGFza1BhZ2UgfSBmcm9tIFwiLi90YXNrLXBhZ2VcIjtcclxuaW1wb3J0IHsgZ2V0Q3VzdG9taXplZFRhc2sgfSBmcm9tICcuL2dldC1jdXN0b21pemVkLXRhc2snO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNvdXJzZTogQ291cnNlO1xyXG4gIGNvdXJzZUJ1aWxkZXJVcmw6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBtb2R1bGU6IENvdXJzZU1vZHVsZSB8IG51bGw7XHJcbiAgdGFzazogVGFzayB8IG51bGw7XHJcbn1cclxuXHJcblxyXG5pbml0TWFudWFsU2Nyb2xsUmVzdG9yYXRpb24oKTtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb3Vyc2VQYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLm9uSGFzaENoYW5nZSA9IHRoaXMub25IYXNoQ2hhbmdlLmJpbmQodGhpcyk7XHJcbiAgICBjb25zdCB7bW9kdWxlLCB0YXNrfSA9IHRoaXMuZ2V0TW9kdWxlQW5kVGFza0Zyb21IYXNoKCk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBtb2R1bGUsXHJcbiAgICAgIHRhc2tcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXRNb2R1bGVBbmRUYXNrRnJvbUhhc2goKSB7XHJcbiAgICBsZXQgc3BsaXQgPSAobG9jYXRpb24uaGFzaC5zdWJzdHIoMSkgfHwgXCJcIikuc3BsaXQoJy8nKTtcclxuICAgIGlmIChzcGxpdC5sZW5ndGggPiAwICYmICFzcGxpdFswXSkgc3BsaXQgPSBzcGxpdC5zbGljZSgxKTsgLy8gQWxsb3cgbGVhZGluZyBzbGFzaCAjL21vZHVsZS90YXNrXHJcbiAgICBjb25zdCBbbW9kdWxlTmFtZSwgdGFza0lkXSA9IHNwbGl0Lm1hcChwYXJ0ID0+IGRlY29kZVVSSUNvbXBvbmVudChwYXJ0KSk7XHJcbiAgICBsZXQgbW9kdWxlID0gdGhpcy5wcm9wcy5jb3Vyc2UubW9kdWxlc1xyXG4gICAgICAuZmlsdGVyKG0gPT4gKG0ubmFtZSB8fCBcIlwiKVxyXG4gICAgICAgIC50cmltKCkudG9Mb3dlckNhc2UoKSA9PT0gKG1vZHVsZU5hbWUgfHwgXCJcIikudHJpbSgpLnRvTG93ZXJDYXNlKCkpWzBdIHx8IG51bGw7XHJcbiAgICBsZXQgdGFzayA9IHRhc2tJZCA/XHJcbiAgICAgIHRoaXMucHJvcHMuY291cnNlLnRhc2tzLmZpbmQodCA9PiB0LmlkID09PSB0YXNrSWQpIHx8IG51bGwgOlxyXG4gICAgICBudWxsO1xyXG4gICAgaWYgKHRhc2sgJiYgIW1vZHVsZSkge1xyXG4gICAgICAvLyBSZXNvbHZlIG1vZHVsZSBieSBmaW5kaW5nIHRoZSBtb2R1bGUgdGhhdCBob2xkcyB0aGUgdGFzazpcclxuICAgICAgbW9kdWxlID0gdGhpcy5nZXRPcmRlcmVkTW9kdWxlcygpXHJcbiAgICAgICAgLmZpbHRlcihtID0+IG0udGFza0lkc1xyXG4gICAgICAgICAgLnNvbWUodGFza0lkID0+IHRhc2suaWQgPT09IHRhc2tJZCkpWzBdO1xyXG4gICAgfVxyXG4gICAgaWYgKHRhc2sgJiYgbW9kdWxlKSB7XHJcbiAgICAgIHRhc2sgPSBnZXRDdXN0b21pemVkVGFzayhtb2R1bGUsIHRhc2spO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHttb2R1bGUsIHRhc2t9O1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHRoaXMub25IYXNoQ2hhbmdlKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLm9uSGFzaENoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBvbkhhc2hDaGFuZ2UoKSB7XHJcbiAgICBjb25zdCB7bW9kdWxlLCB0YXNrfSA9IHRoaXMuZ2V0TW9kdWxlQW5kVGFza0Zyb21IYXNoKCk7XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgbW9kdWxlLFxyXG4gICAgICB0YXNrXHJcbiAgICB9LCAoKT0+e1xyXG4gICAgICBcclxuICAgICAgbGV0IGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gPSB1bmRlZmluZWQ7XHJcbiAgICAgIGlmICh0YXNrKSB7XHJcbiAgICAgICAgY29uc3QgdGFza0FuY2hvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZWQtdGFzay1hbmNob3InKTtcclxuICAgICAgICBpZiAodGFza0FuY2hvcikgZmFsbGJhY2tTY3JvbGxQb3NpdGlvbiA9ICh3aW5kb3cucGFnZVlPZmZzZXQgKyB0YXNrQW5jaG9yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCk7XHJcbiAgICAgICAgZWxzZSBmYWxsYmFja1Njcm9sbFBvc2l0aW9uID0gMDtcclxuICAgICAgfVxyXG4gICAgICByZXN0b3JlU2Nyb2xsUG9zaXRpb24oe2ZhbGxiYWNrU2Nyb2xsUG9zaXRpb259KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0T3JkZXJlZE1vZHVsZXMoKSB7XHJcbiAgICBjb25zdCB7IGNvdXJzZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IG1vZHVsZU9yZGVyID0gY291cnNlLm1vZHVsZU9yZGVyIHx8IGNvdXJzZS5tb2R1bGVzLm1hcChtID0+IG0uaWQpO1xyXG4gICAgcmV0dXJuIG1vZHVsZU9yZGVyXHJcbiAgICAgIC8vIE1hcCBvcmRlcmVkIGlkIHRvIG1vZHVsZVxyXG4gICAgICAubWFwKGlkID0+IGNvdXJzZS5tb2R1bGVzLmZpbmQobSA9PiBtLmlkID09PSBpZCAmJiAhbS5pbmFjdGl2ZSkpXHJcbiAgICAgIC8vIElnbm9yZSBlbnRyaWVzIHRoYXQgb25seSBleGlzdHMgaW4gbW9kdWxlT3JkZXIgYnV0IG5vdCBpbiBtb2R1bGVzXHJcbiAgICAgIC5maWx0ZXIobSA9PiAhIW0pXHJcbiAgICAgIC8vIEFwcGVuZCBtb2R1bGVzIGF0IGVuZCB0aGF0IGFyZSBub3QgbGlzdGVkIGluIG1vZHVsZU9yZGVyXHJcbiAgICAgIC5jb25jYXQgKGNvdXJzZS5tb2R1bGVzLmZpbHRlcihtID0+ICFtb2R1bGVPcmRlci5maW5kKGlkID0+IG0uaWQgPT09IGlkKSkpO1xyXG4gIH0gIFxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7Y291cnNlLCBjb3Vyc2VCdWlsZGVyVXJsfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7bW9kdWxlLCB0YXNrfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBvcmRlcmVkTW9kdWxlcyA9IHRoaXMuZ2V0T3JkZXJlZE1vZHVsZXMoKTtcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8Q291cnNlQmFubmVyXHJcbiAgICAgICAgdGl0bGU9e2NvdXJzZS5uYW1lICsgXCIgLSBcIiArIGNvdXJzZS5wb2ludHMgKyBcInBcIn1cclxuICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U9eyhjb3Vyc2UuaW1hZ2VzLmZpbmQoaW1nID0+IGltZy5pZCA9PT0gY291cnNlLmltYWdlSWQpIHx8IHt1cmw6Jyd9KS51cmx9XHJcbiAgICAgICAgdGFicz17W3tuYW1lOiBcIlVwcHRha3RcIiBhcyBzdHJpbmcgfCBKU1guRWxlbWVudCwgbGluazogXCIjXCIsIGtleTogXCJVcHB0YWt0XCJ9XVxyXG4gICAgICAgICAgLmNvbmNhdChvcmRlcmVkTW9kdWxlcy5tYXAoKHsgbmFtZSB9KSA9PiAoeyBuYW1lLCBsaW5rOiBcIiNcIiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSwga2V5OiBuYW1lIH0pKSlcclxuICAgICAgICAgIC5jb25jYXQoY291cnNlLndvcmtGbG93TGluayA/IFt7XHJcbiAgICAgICAgICAgIG5hbWU6IFwiQXJiZXRzZ8OlbmdcIixcclxuICAgICAgICAgICAga2V5OiBcIndvcmtmbG93XCIsXHJcbiAgICAgICAgICAgIGxpbms6IGNvdXJzZS53b3JrRmxvd0xpbmtcclxuICAgICAgICAgIH1dIDogW10pXHJcbiAgICAgICAgICAuY29uY2F0KGhhc1dyaXRlQWNjZXNzKGVudi5jdXJyZW50VXNlciwgY291cnNlKSA/IFt7XHJcbiAgICAgICAgICAgIG5hbWU6IDxzcGFuPjxpIGNsYXNzTmFtZT1cImZhIGZhLXBlbmNpbFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gUmVkaWdlcmEgZGVubmEga3Vyczwvc3Bhbj4sXHJcbiAgICAgICAgICAgIGtleTogXCJlZGl0XCIsXHJcbiAgICAgICAgICAgIGxpbms6IGAke3ByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KGNvdXJzZUJ1aWxkZXJVcmwsIHt9KX0jL2NvdXJzZXMvJHtjb3Vyc2UuaWR9L2VkaXRgfV0gOiBbXSlcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFjdGl2ZVRhYj17bW9kdWxlID8gXCIjXCIrZW5jb2RlVVJJQ29tcG9uZW50KG1vZHVsZS5uYW1lKSA6IFwiI1wifVxyXG4gICAgICAvPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIlxyXG4gICAgICAgIC8vaWQ9XCJrZWQtdGFzay1hbmNob3JcIiAvLyBGb3Igd2luZG93LnNjcm9sbFRvIHRvIHBvc2l0aW9uIGhlcmUhLiBTa2lwcGluZyB0aGlzLiBzY3JvbGwgdG8gdG9wIGluc3RlYWQhXHJcbiAgICAgID5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWxheW91dCBzdi1za2lwLXNwYWNlciBzdi1jb2x1bW4tMTJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytc3BhY2VyLTIwcHh2dCBzdi12ZXJ0aWNhbCBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwYWdlY29udGVudCBzdi1sYXlvdXQgc3Ytc3BhY2VyLTIwcHh2dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3Ytcm93IHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTdcIj5cclxuICAgICAgICAgICAgICAgICAge3Rhc2sgP1xyXG4gICAgICAgICAgICAgICAgICAgIDxUYXNrUGFnZSB0YXNrPXt0YXNrfSBjb3Vyc2U9e2NvdXJzZX0gLz4gOlxyXG4gICAgICAgICAgICAgICAgICAgbW9kdWxlID9cclxuICAgICAgICAgICAgICAgICAgICA8Q291cnNlTW9kdWxlUGFnZSBjb3Vyc2U9e2NvdXJzZX0gbW9kdWxlPXttb2R1bGV9IC8+IDpcclxuICAgICAgICAgICAgICAgICAgICA8UnVuVXBQYWdlIGNvdXJzZT17Y291cnNlfSAvPn1cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3YtY29sdW1uLTVcIj5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi12ZXJ0aWNhbCBzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8V2Vla1BsYW5uZXIgdmlld0NvdXJzZVVybD17Jyd9IGVudj17ZW52fS8+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuLy8gVmlld3NcclxuaW1wb3J0IHsgQWJpbGl0aWVzQm94IH0gZnJvbSAnLi4vc3ViY29tcG9uZW50cy9hYmlsaXRpZXMtYm94JztcclxuaW1wb3J0IHsgQ2VudHJhbENvbnRlbnRCb3ggfSBmcm9tICcuLi9zdWJjb21wb25lbnRzL2NlbnRyYWwtY29udGVudC1ib3gnO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZSB9IGZyb20gJy4uL3N1YmNvbXBvbmVudHMva25vd2xlZGdlLXJlcXVpcmVtZW50cy10YWJsZSc7XHJcbmltcG9ydCB7IFJlc291cmNlTGlzdCB9IGZyb20gJy4uL3N1YmNvbXBvbmVudHMvcmVzb3VyY2UtbGlzdCc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGNvdXJzZTogQ291cnNlO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUnVuVXBQYWdlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge31cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgY291cnNlIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXQgc3Ytc2tpcC1zcGFjZXJcIj5cclxuICAgICAgICAgIHtjb3Vyc2UucnVuVXBUZXh0ICYmIDxkaXY+XHJcbiAgICAgICAgICAgIDxoMT5VcHB0YWt0PC9oMT5cclxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwibm9ybWFsXCIgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGNvdXJzZS5ydW5VcFRleHR9fSAvPlxyXG4gICAgICAgICAgPC9kaXY+fVxyXG4gICAgICAgICAge2NvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzICYmIGNvdXJzZS5yZXNwb25zaWJsZVRlYWNoZXJzLmxlbmd0aCA+IDAgJiYgPGRpdj5cclxuICAgICAgICAgICAgPGgyPkzDpHJhcmU8L2gyPlxyXG4gICAgICAgICAgICB7Y291cnNlLnJlc3BvbnNpYmxlVGVhY2hlcnMubWFwKCh0ZWFjaGVyLCBpKSA9PlxyXG4gICAgICAgICAgICAgIDxwIGtleT17aX0+PGEgaHJlZj17aW50ZXJwcmV0VGVhY2hlclVybCh0ZWFjaGVyLnVybCl9Pnt0ZWFjaGVyLm5hbWV9PC9hPjwvcD5cclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgIHtjb3Vyc2Uud29ya0Zsb3dMaW5rICYmIDxhIGNsYXNzTmFtZT1cImJ0blwiIGhyZWY9e2NvdXJzZS53b3JrRmxvd0xpbmt9PkFyYmV0c2fDpW5nPC9hPn1cclxuICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgICA8QWJpbGl0aWVzQm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiw4RtbmV0cyBmw7ZybcOlZ29yXCJcclxuICAgICAgICAgICAgc3ViVGl0bGU9XCJGw7ZybcOlZ29yXCJcclxuICAgICAgICAgICAgYWJpbGl0aWVzPXtjb3Vyc2UuYWJpbGl0aWVzfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIiAvPlxyXG5cclxuICAgICAgICAgIDxDZW50cmFsQ29udGVudEJveFxyXG4gICAgICAgICAgICB0aXRsZT1cIkt1cnNlbnMgY2VudHJhbGEgaW5uZWjDpWxsXCJcclxuICAgICAgICAgICAgc3ViVGl0bGU9XCJDZW50cmFsdCBpbm5laMOlbGxcIlxyXG4gICAgICAgICAgICBjZW50cmFsQ29udGVudD17Y291cnNlLmNlbnRyYWxDb250ZW50fVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIiAvPlxyXG5cclxuICAgICAgICAgIDxLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZVxyXG4gICAgICAgICAgICB0aXRsZT1cIkt1cnNlbnMga3Vuc2thcHNrcmF2XCJcclxuICAgICAgICAgICAgcmVxdWlyZW1lbnRzPXtjb3Vyc2Uua25vd2xlZGdlUmVxdWlyZW1lbnRzfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIiAvPlxyXG5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICB7Y291cnNlLnJlc291cmNlcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XHJcbiAgICAgICAgICAgIDxoMj5SZXN1cnNlcjwvaDI+XHJcbiAgICAgICAgICAgIDxociAvPlxyXG4gICAgICAgICAgICA8UmVzb3VyY2VMaXN0IHJlc291cmNlcz17Y291cnNlLnJlc291cmNlc30gLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnRlcnByZXRUZWFjaGVyVXJsKHVybDogc3RyaW5nKSB7XHJcbiAgaWYgKHVybC5pbmRleE9mKCc6JykgPT09IC0xICYmIHVybC5pbmRleE9mKCdAJykgPj0gMCkgcmV0dXJuIFwibWFpbHRvOlwiICsgdXJsO1xyXG4gIHJldHVybiB1cmw7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IEFzc2lnbm1lbnQsIFVya3VuZFJlc3BvbnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBzaG93RXJyb3IsIGNvbXBhcmVQcm9wcyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IEh0dHBFcnJvciwgY3JlYXRlVVVJRCB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IHsgaGFzV3JpdGVBY2Nlc3MsIGlzVGVhY2hlckF0U2Nob29sIH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5pbXBvcnQgZG93bmxvYWQgZnJvbSAnZG93bmxvYWRqcyc7XHJcbmltcG9ydCB7XHJcbiAgZ2V0VXJrdW5kU2lnbmlmaWNhbmNlQ2xhc3MsXHJcbiAgZ2V0VXJrdW5kU3RhdHVzQ2xhc3MsXHJcbiAgZ2V0VXJrdW5kSG92ZXJUZXh0fSBmcm9tICcuL3Vya3VuZC11dGlscyc7XHJcbmltcG9ydCB7IGlzRW1wbG95ZWUgfSBmcm9tICcuLi8uLi9jb3Vyc2UtYnVpbGRlci1rcy9sb2dpYy9pcy1lbXBsb3llZSc7XHJcbmltcG9ydCB7IEdvb2dsZVBpY2tlciB9IGZyb20gJy4uLy4uLy4uL2FwaXMvZ29vZ2xlLXBpY2tlcic7XHJcbmltcG9ydCB7IERyaXZlQnV0dG9uIH0gZnJvbSBcIi4uLy4uLy4uL2FwaXMvYnV0dG9uc1wiO1xyXG5pbXBvcnQgeyBmZWF0dXJlcyB9IGZyb20gJy4uLy4uLy4uL2ZlYXR1cmVzJztcclxuXHJcbmNvbnN0IE1BWF9VUktVTkRfRklMRV9TSVpFX01CID0gNTA7XHJcbmNvbnN0IE1BWF9OT05VUktVTkRfRklMRV9TSVpFX01CID0gMTAwO1xyXG5jb25zdCBBTExPV0VEX0VYVEVOU0lPTlMgPSBbXHJcbiAgXCIucGRmXCIsXHJcbiAgXCIub2R0XCIsXHJcbiAgXCIuZG9jeFwiLFxyXG4gIFwiLmRvY1wiLFxyXG4gIFwiLmNhZFwiLFxyXG4gIFwiLndhdlwiLFxyXG4gIFwiLm1wM1wiLFxyXG4gIFwiLm1wZWc0XCIsXHJcbiAgXCIubXA0XCIsXHJcbiAgXCIuemlwXCIsXHJcbiAgXCIucG5nXCIsXHJcbiAgXCIuanBnXCIsXHJcbiAgXCIuanBlZ1wiLFxyXG4gIFwiLmdpZlwiXHJcbl07XHJcbmNvbnN0IFVSS1VORF9FWFRFTlNJT05TID0gW1xyXG4gIFwiLnBkZlwiLFxyXG4gIFwiLm9kdFwiLFxyXG4gIFwiLmRvY3hcIixcclxuICBcIi5kb2NcIlxyXG5dO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBjb3Vyc2VJZDogc3RyaW5nO1xyXG4gIHRhc2tJZDogc3RyaW5nO1xyXG4gIHNjaG9vbDogc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGFzc2lnbm1lbnRzOiBBc3NpZ25tZW50W107XHJcbiAgbG9hZGluZzogYm9vbGVhbjtcclxuICB1cGxvYWRpbmdGaWxlPzogRmlsZTtcclxuICBlcnJvcj86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRhc2tBc3NpZ25tZW50cyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGFzc2lnbm1lbnRzOiBbXSxcclxuICAgICAgbG9hZGluZzogdHJ1ZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFN0YXRlUHJvbWlzZWQoY2I6IChwcmV2U3RhdGU6IFJlYWRvbmx5PFN0YXRlPiwgcHJvcHM6IFByb3BzKSA9PiBQYXJ0aWFsPFN0YXRlPikge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc3VwZXIuc2V0U3RhdGUoY2IgYXMgYW55LCByZXNvbHZlKSk7XHJcbiAgfSAgXHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdGhpcy5sb2FkKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wczogUHJvcHMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChuZXh0UHJvcHMudGFza0lkICE9PSB0aGlzLnByb3BzLnRhc2tJZCB8fFxyXG4gICAgICAgICAgbmV4dFByb3BzLmNvdXJzZUlkICE9PSB0aGlzLnByb3BzLmNvdXJzZUlkKVxyXG4gICAgICB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zZXRTdGF0ZVByb21pc2VkKCgpPT4oe1xyXG4gICAgICAgICAgYXNzaWdubWVudHM6IFtdLFxyXG4gICAgICAgICAgbG9hZGluZzogdHJ1ZVxyXG4gICAgICAgIH0pKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWQoKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIHNob3dFcnJvcihlcnIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlKGFzc2lnbm1lbnRzOiBBc3NpZ25tZW50W10sIGFzc2lnbm1lbnQ6IEFzc2lnbm1lbnQpOiBBc3NpZ25tZW50W10ge1xyXG4gICAgY29uc3QgcmV0dmFsID0gW1xyXG4gICAgICBhc3NpZ25tZW50LFxyXG4gICAgICAuLi5hc3NpZ25tZW50cy5maWx0ZXIoKHt1c2VyLCBmaWxlbmFtZX0pID0+XHJcbiAgICAgICAgdXNlciAhPT0gYXNzaWdubWVudC51c2VyIHx8XHJcbiAgICAgICAgZmlsZW5hbWUgIT09IGFzc2lnbm1lbnQuZmlsZW5hbWUpXTtcclxuICAgIHJldHVybiByZXR2YWw7XHJcbiAgfVxyXG5cclxuICBhc3luYyByZWZyZXNoQXNzaWdubWVudChhc3NpZ25tZW50OiBBc3NpZ25tZW50KSB7XHJcbiAgICBjb25zdCBjbGllbnQgPSBlbnYua2VkQmFja2VuZENsaWVudC5odHRwO1xyXG4gICAgY29uc3Qge2NvdXJzZUlkLCB0YXNrSWQsIHNjaG9vbH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3Qge3VzZXIsIGZpbGVuYW1lfSA9IGFzc2lnbm1lbnQ7XHJcbiAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICBhc3NpZ25tZW50czogdGhpcy51cGRhdGUoYXNzaWdubWVudHMsIHsuLi5hc3NpZ25tZW50LCBpc1JlZnJlc2hpbmc6IHRydWV9KVxyXG4gICAgfSkpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVxID0gYXdhaXQgY2xpZW50LmdldChgYXNzaWdubWVudHMvdXJrdW5kLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH0vJHt1c2VyfS8ke2ZpbGVuYW1lfWApO1xyXG4gICAgICBpZiAocmVxLnN0YXR1cyA+PSA0MDApIHRocm93IG5ldyBIdHRwRXJyb3IocmVxLnN0YXR1cywgYXdhaXQgcmVxLnRleHQoKSk7XHJcbiAgICAgIGNvbnN0IHJlc0pzb24gPSBhd2FpdCByZXEudGV4dCgpO1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICAgIGFzc2lnbm1lbnRzOiB0aGlzLnVwZGF0ZShhc3NpZ25tZW50cywgey4uLmFzc2lnbm1lbnQsIGlzUmVmcmVzaGluZzogZmFsc2UsIG1ldGFkYXRhOiB7XHJcbiAgICAgICAgICAuLi5hc3NpZ25tZW50Lm1ldGFkYXRhLFxyXG4gICAgICAgICAgdXJrdW5kUmVzcG9uc2U6IHJlc0pzb25cclxuICAgICAgICB9fSlcclxuICAgICAgfSkpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlKCh7YXNzaWdubWVudHN9KSA9PiAoe1xyXG4gICAgICAgIGFzc2lnbm1lbnRzOiB0aGlzLnVwZGF0ZShhc3NpZ25tZW50cywge1xyXG4gICAgICAgICAgLi4uYXNzaWdubWVudCxcclxuICAgICAgICAgIGlzUmVmcmVzaGluZzogZmFsc2UsXHJcbiAgICAgICAgICByZWZyZXNoRXJyb3I6IGVcclxuICAgICAgICB9KVxyXG4gICAgICB9KSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkKCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2xpZW50ID0gZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cDtcclxuICAgICAgY29uc3Qge2NvdXJzZUlkLCB0YXNrSWQsIHNjaG9vbH0gPSB0aGlzLnByb3BzO1xyXG4gICAgICBjb25zdCB0ZWFjaGVyQXRTY2hvb2wgPSBpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIHNjaG9vbCk7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0ICh0ZWFjaGVyQXRTY2hvb2wgP1xyXG4gICAgICAgIGNsaWVudC5nZXQoYGFzc2lnbm1lbnRzLyR7c2Nob29sfS8ke2NvdXJzZUlkfS8ke3Rhc2tJZH1gKSA6XHJcbiAgICAgICAgY2xpZW50LmdldChgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke2Vudi5jdXJyZW50VXNlci5tYWlsfWApKTtcclxuICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGFzc2lnbm1lbnRzID0gYXdhaXQgcmVzLmpzb24oKSBhcyBBc3NpZ25tZW50W107XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGVycm9yOiBudWxsLFxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGFzc2lnbm1lbnRzXHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAodGVhY2hlckF0U2Nob29sKSB7XHJcbiAgICAgICAgY29uc3QgcmVmcmVzaGFibGVBc3NpZ21lbnRzID0gYXNzaWdubWVudHMuZmlsdGVyKGEgPT5cclxuICAgICAgICAgIGEubWV0YWRhdGEgJiYgLy8gTXVzdCBoYXZlIG1ldGFkYXRhLnVya3VuZEV4dGVybmFsSWQgT3RoZXJ3aXNlIG5vdCBwb3NzaWJsZSB0byByZWZyZXNoXHJcbiAgICAgICAgICAhYS5tZXRhZGF0YS51cmt1bmRVcGxvYWRFcnJvciAmJiAoIC8vIE5vdCBwb3NzaWJsZSB0byByZWZyZXNoIGlmIHVwbG9hZCBoYXMgZmFpbGVkXHJcbiAgICAgICAgICAgICFhLm1ldGFkYXRhLnVya3VuZExhc3RQb2xsIHx8IC8vIE5ldmVyIGNoZWNrZWQgc3RhdHVzIHlldFxyXG4gICAgICAgICAgICAoXHJcbiAgICAgICAgICAgICAgWydBY2NlcHRlZCcsICdTdWJtaXR0ZWQnXS5pbmRleE9mKChKU09OLnBhcnNlKGEubWV0YWRhdGEudXJrdW5kUmVzcG9uc2UpWzBdIGFzIFVya3VuZFJlc3BvbnNlKS5TdGF0dXMuU3RhdGUpID49IDAgJiZcclxuICAgICAgICAgICAgICBwYXJzZUludChhLm1ldGFkYXRhLnVya3VuZExhc3RQb2xsKSA8IG1vbWVudCgpLmFkZCgtMTUsIFwic2Vjb25kc1wiKS50b0RhdGUoKS5nZXRUaW1lKCkpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgLy8gQ2hlY2tlZCBzdGF0dXMgZm9yIGEgbG9uZyB0aW1lIGFnb1xyXG4gICAgICAgICAgKTtcclxuICAgICAgICBmb3IgKGxldCBhIG9mIHJlZnJlc2hhYmxlQXNzaWdtZW50cykge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoQXNzaWdubWVudChhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBgS3VuZGUgaW50ZSBsYWRkYSBpbmzDpG1uaW5nc3VwcGdpZnRlcmAsXHJcbiAgICAgICAgYXNzaWdubWVudHM6IFtdXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uRHJhZyAoZXY6IFJlYWN0LkRyYWdFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcclxuICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIGV2LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xyXG4gIH1cclxuICBcclxuICBhc3luYyB2ZXJpZnlBbmRVcGxvYWQoZmlsZTogRmlsZSkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgaWYgKCFmaWxlKSByZXR1cm47XHJcbiAgICAgIGlmICh0aGlzLnN0YXRlLmFzc2lnbm1lbnRzLnNvbWUoYSA9PlxyXG4gICAgICAgIGEudXNlciA9PT0gZW52LmN1cnJlbnRVc2VyLm1haWwgJiZcclxuICAgICAgICBhLmZpbGVuYW1lID09PSBmaWxlLm5hbWUpKVxyXG4gICAgICB7XHJcbiAgICAgICAgaWYgKCFjb25maXJtKGBFcnPDpHR0YSBiZWZpbnRsaWcgZmlsICgke2ZpbGUubmFtZX0pP2ApKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLnByb3BzLnNjaG9vbC50b0xvd2VyQ2FzZSgpICE9PSBlbnYuY3VycmVudFVzZXIuc2Nob29sLnRvTG93ZXJDYXNlKCkpIHtcclxuICAgICAgICBpZiAoIWNvbmZpcm0oYFVwcGdpZnRlbiB0aWxsaMO2ciBlbiBhbm5hbiBza29sYSAoJHt0aGlzLnByb3BzLnNjaG9vbH0pLlxcbmArXHJcbiAgICAgICAgICBgVmlsbCBkdSDDpG5kw6UgbMOkbW5hIGluIGRpdHQgYXJiZXRlIGjDpHI/YCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLnNldFN0YXRlKHt1cGxvYWRpbmdGaWxlOiBmaWxlfSk7XHJcbiAgICAgIGF3YWl0IHRoaXMudXBsb2FkKGZpbGUpO1xyXG4gICAgICBhd2FpdCB0aGlzLmxvYWQoKTtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgICAgdXBsb2FkaW5nRmlsZTogbnVsbFxyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGVycm9yOiBcIkt1bmRlIGludGUgbGFkZGEgdXBwIGZpbGVuLiBcIiArIChlcnJvci5tZXNzYWdlIHx8IGVycm9yKSxcclxuICAgICAgICB1cGxvYWRpbmdGaWxlOiBudWxsXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgYXN5bmMgdXBsb2FkKGZpbGU6IEZpbGUpIHtcclxuICAgIGNvbnN0IGNsaWVudCA9IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmh0dHA7XHJcbiAgICBjb25zdCB7Y291cnNlSWQsIHRhc2tJZCwgc2Nob29sfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7bWFpbH0gPSBlbnYuY3VycmVudFVzZXI7XHJcbiAgICBjb25zdCBpc1Vya3VuZEV4dGVuc2lvbiA9IFVSS1VORF9FWFRFTlNJT05TXHJcbiAgICAgIC5pbmRleE9mKFwiLlwiK2ZpbGUubmFtZS5zcGxpdCgnLicpLnJldmVyc2UoKVswXS50b0xvd2VyQ2FzZSgpKSA+PSAwO1xyXG4gICAgaWYgKGlzVXJrdW5kRXh0ZW5zaW9uKSB7XHJcbiAgICAgIGlmIChmaWxlLnNpemUgPiBNQVhfVVJLVU5EX0ZJTEVfU0laRV9NQiAqIDEwMjQgKiAxMDI0KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlciBhdiBkZW5uYSB0eXAgZsOlciBpbnRlIHZhcmEgc3TDtnJyZSDDpG4gJHtNQVhfVVJLVU5EX0ZJTEVfU0laRV9NQn0gTUJgKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGZpbGUuc2l6ZSA+IE1BWF9OT05VUktVTkRfRklMRV9TSVpFX01CICogMTAyNCAqIDEwMjQpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVuIGbDpXIgaW50ZSB2YXJhIHN0w7ZycmUgw6RuICR7TUFYX05PTlVSS1VORF9GSUxFX1NJWkVfTUJ9IE1CYCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGNvbnN0IGxvd2VyRmlsZW5hbWUgPSBmaWxlLm5hbWUudG9Mb3dlckNhc2UoKTtcclxuICAgIGlmICghQUxMT1dFRF9FWFRFTlNJT05TLnNvbWUoZXh0ID0+IGxvd2VyRmlsZW5hbWUuZW5kc1dpdGgoZXh0KSkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlbnMgw6RuZGVsc2UgbcOlc3RlIHZhcmEgJHtBTExPV0VEX0VYVEVOU0lPTlMuam9pbignIC8gJyl9YCk7XHJcbiAgICB9IFxyXG4gICAgY29uc3QgYm9keSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgYm9keS5hcHBlbmQoJ2ZpbGVzJywgZmlsZSk7XHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKFxyXG4gICAgICBgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke21haWx9YCxcclxuICAgICAgJ3B1dCcsXHJcbiAgICAgIHt9LFxyXG4gICAgICB7XHJcbiAgICAgICAgdXNlckRpc3BsYXlOYW1lOiBlbnYuY3VycmVudFVzZXIuZGlzcGxheU5hbWVcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGJvZHlcclxuICAgICAgfSk7XHJcbiAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7XHJcbiAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBkb3dubG9hZChmaWxlOiBBc3NpZ25tZW50KSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBlbnYua2VkQmFja2VuZENsaWVudC5odHRwLmZldGNoKGZpbGUubWVkaWFMaW5rLCAnZ2V0Jywge30pO1xyXG4gICAgICBpZiAocmVzLnN0YXR1cyA+PSA0MDApIHtcclxuICAgICAgICB0aHJvdyBuZXcgSHR0cEVycm9yKHJlcy5zdGF0dXMsIGF3YWl0IHJlcy50ZXh0KCkpO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCByZXMuYmxvYigpO1xyXG4gICAgICBkb3dubG9hZChibG9iLCBmaWxlLmZpbGVuYW1lLCBmaWxlLmNvbnRlbnRUeXBlKTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtlcnJvcjogXCJLdW5kZSBpbnRlIGxhZGRhIG5lZCBmaWxlbi4gXCIgKyAoZXJyLm1lc3NhZ2UgfHwgZXJyKX0pO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9ICAgIFxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZGVsZXRlKHVybDogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCB0aGlzLnNldFN0YXRlUHJvbWlzZWQoKHthc3NpZ25tZW50c30pID0+ICh7YXNzaWdubWVudHM6IGFzc2lnbm1lbnRzLm1hcChhID0+IGEubWVkaWFMaW5rID09PSB1cmwgP1xyXG4gICAgICAgIHsuLi5hLCBtZXRhZGF0YTogey4uLmEubWV0YWRhdGEsICRtZXRhOiAnZGVsZXRlJ319IDogey4uLmF9KX0pKTtcclxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZW52LmtlZEJhY2tlbmRDbGllbnQuaHR0cC5mZXRjaCh1cmwsICdkZWxldGUnLCB7fSk7XHJcbiAgICAgIGlmIChyZXMuc3RhdHVzID49IDQwMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBIdHRwRXJyb3IocmVzLnN0YXR1cywgYXdhaXQgcmVzLnRleHQoKSk7XHJcbiAgICAgIH1cclxuICAgICAgYXdhaXQgdGhpcy5sb2FkKCk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7ZXJyb3I6IFwiS3VuZGUgaW50ZSB0YSBib3J0IGZpbGVuLiBcIiArIChlcnIubWVzc2FnZSB8fCBlcnIpfSk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtjb3Vyc2VJZCwgdGFza0lkLCBzY2hvb2x9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IHtsb2FkaW5nLCBhc3NpZ25tZW50cywgZXJyb3IsIHVwbG9hZGluZ0ZpbGV9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHRlYWNoZXJBdFRoaXNTY2hvb2wgPSBpc1RlYWNoZXJBdFNjaG9vbChlbnYuY3VycmVudFVzZXIsIHNjaG9vbCk7XHJcbiAgICBsZXQgZmlsZXMgPSBbLi4uYXNzaWdubWVudHNdO1xyXG4gICAgY29uc3Qgc2hvd0dvb2dsZVBpY2tlciA9IGZlYXR1cmVzLnBpY2tlcjtcclxuICAgIFxyXG4gICAgaWYgKHVwbG9hZGluZ0ZpbGUpIHtcclxuICAgICAgY29uc3QgdmlydHVhbEZpbGU6IEFzc2lnbm1lbnQgPSB7XHJcbiAgICAgICAgc2Nob29sLFxyXG4gICAgICAgIGNvdXJzZUlkLFxyXG4gICAgICAgIHRhc2tJZCxcclxuICAgICAgICBmaWxlbmFtZTogdXBsb2FkaW5nRmlsZS5uYW1lLFxyXG4gICAgICAgIHNpemU6IHVwbG9hZGluZ0ZpbGUuc2l6ZSxcclxuICAgICAgICB1c2VyOiBlbnYuY3VycmVudFVzZXIubWFpbCxcclxuICAgICAgICBjb250ZW50VHlwZTogdXBsb2FkaW5nRmlsZS50eXBlLFxyXG4gICAgICAgIHVwbG9hZERhdGU6IERhdGUubm93KCksXHJcbiAgICAgICAgbWVkaWFMaW5rOiBgYXNzaWdubWVudHMvJHtzY2hvb2x9LyR7Y291cnNlSWR9LyR7dGFza0lkfS8ke2Vudi5jdXJyZW50VXNlci5tYWlsfS8ke3VwbG9hZGluZ0ZpbGUubmFtZX1gLFxyXG4gICAgICAgIG1ldGFkYXRhOiB7JG1ldGE6ICdhZGQnLCB1c2VyRGlzcGxheU5hbWU6IGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZX0gYXMgQXNzaWdubWVudFtcIm1ldGFkYXRhXCJdXHJcbiAgICAgIH07XHJcbiAgICAgIGZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5tZWRpYUxpbmsgIT09IHZpcnR1YWxGaWxlLm1lZGlhTGluayk7XHJcbiAgICAgIGZpbGVzID0gWy4uLmZpbGVzLCB2aXJ0dWFsRmlsZV07XHJcbiAgICB9XHJcbiAgICBmaWxlcyA9IGZpbGVzLnNvcnQoY29tcGFyZVByb3BzKFtcclxuICAgICAgXCJtZXRhZGF0YS51c2VyRGlzcGxheU5hbWVcIixcclxuICAgICAgXCJmaWxlbmFtZVwiLFxyXG4gICAgICBcInVwbG9hZERhdGVcIlxyXG4gICAgICBdLCBbXCJzdlwiLCBcImVuXCJdLCB7c2Vuc2l0aXZpdHk6ICdiYXNlJ30pKTtcclxuICAgIGNvbnN0IGhhc093bkRvY3MgPSBmaWxlcy5zb21lKGZpbGUgPT4gZmlsZS51c2VyID09PSBlbnYuY3VycmVudFVzZXIubWFpbCk7XHJcbiAgICBcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxkaXYgb25EcmFnT3Zlcj17ZXYgPT4gdGhpcy5vbkRyYWcoZXYpfSBvbkRyb3A9e2V2PT57XHJcbiAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLnZlcmlmeUFuZFVwbG9hZChldi5kYXRhVHJhbnNmZXIuZmlsZXNbMF0pO1xyXG4gICAgICB9fT5cclxuICAgICAgICB7ZXJyb3IgPyA8PlxyXG4gICAgICAgICAgPHAgY2xhc3NOYW1lPVwiZXJyb3JcIj57ZXJyb3J9PC9wPlxyXG4gICAgICAgIDwvPjogdW5kZWZpbmVkfVxyXG4gICAgICAgIHtsb2FkaW5nID8gPD5cclxuICAgICAgICAgIDxTcGlubmVyIC8+IExhZGRhciBpbmzDpG1uYWRlIGZpbGVyLi4uXHJcbiAgICAgICAgPC8+IDogZmlsZXMubGVuZ3RoID09PSAwID9cclxuICAgICAgICAgIHRlYWNoZXJBdFRoaXNTY2hvb2wgP1xyXG4gICAgICAgICAgICA8cD5JbmdlbiBlbGV2IGhhciBsw6RtbmF0IGluIG7DpWdvdCBhcmJldGUgw6RubnUuPC9wPiA6XHJcbiAgICAgICAgICAgIHVuZGVmaW5lZFxyXG4gICAgICAgIDogPD5cclxuICAgICAgICAgIDx0YWJsZSBjbGFzc05hbWU9XCJ0YXNrLWFzc2lnbm1lbnRzLXRhYmxlXCI+PHRoZWFkPjx0cj5cclxuICAgICAgICAgICAge3RlYWNoZXJBdFRoaXNTY2hvb2wgPyA8dGg+RWxldjwvdGg+IDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICA8dGg+RmlsbmFtbjwvdGg+XHJcbiAgICAgICAgICAgIDx0aD5JbmzDpG1uYXQgZGVuPC90aD5cclxuICAgICAgICAgICAge3RlYWNoZXJBdFRoaXNTY2hvb2wgJiYgPD5cclxuICAgICAgICAgICAgICA8dGg+UmFwcG9ydDwvdGg+XHJcbiAgICAgICAgICAgICAgPHRoPk5pdsOlPC90aD5cclxuICAgICAgICAgICAgPC8+fVxyXG4gICAgICAgICAgICB7aGFzT3duRG9jcyAmJiA8dGggLz59XHJcbiAgICAgICAgICA8L3RyPjwvdGhlYWQ+PHRib2R5PntcclxuICAgICAgICAgICAgZmlsZXMubWFwKGZpbGUgPT4gPHRyXHJcbiAgICAgICAgICAgICAga2V5PXtmaWxlLm1lZGlhTGlua31cclxuICAgICAgICAgICAgICBzdHlsZT17ZmlsZS5tZXRhZGF0YS4kbWV0YSA/IHtvcGFjaXR5OiAwLjV9OiB7fX1cclxuICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgIHt0ZWFjaGVyQXRUaGlzU2Nob29sID8gPD48dGQ+XHJcbiAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2BtYWlsdG86JHtmaWxlLnVzZXJ9YH0+XHJcbiAgICAgICAgICAgICAgICAgICAge2ZpbGUubWV0YWRhdGEudXNlckRpc3BsYXlOYW1lIHx8IGZpbGUudXNlcn1cclxuICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZD48YSBocmVmPVwiI1wiIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuZG93bmxvYWQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICB9fT57ZmlsZS5maWxlbmFtZX08L2E+PC90ZD5cclxuICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJhc3NpZ25tZW50LWRhdGUtY29sXCI+e21vbWVudChmaWxlLnVwbG9hZERhdGUpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbScpfTwvdGQ+XHJcbiAgICAgICAgICAgICAgICB7ZmlsZS5tZXRhZGF0YS4kbWV0YSA9PT0gJ2FkZCcgP1xyXG4gICAgICAgICAgICAgICAgICA8dGQgY29sU3Bhbj17Mn0+PFNwaW5uZXIgLz4gTGFkZGFyIHVwcC4uLjwvdGQ+OlxyXG4gICAgICAgICAgICAgICAgICBmaWxlLm1ldGFkYXRhLiRtZXRhID09PSAnZGVsZXRlJyA/XHJcbiAgICAgICAgICAgICAgICAgIDx0ZCBjb2xTcGFuPXsyfT48U3Bpbm5lciAvPiBUYXIgYm9ydC4uLjwvdGQ+IDpcclxuICAgICAgICAgICAgICAgICAgKCgpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qge21ldGFkYXRhfSA9IGZpbGU7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJrdW5kUmVzcG9uc2VzOiBVcmt1bmRSZXNwb25zZVtdID0gbWV0YWRhdGEudXJrdW5kUmVzcG9uc2UgJiYgSlNPTi5wYXJzZShtZXRhZGF0YS51cmt1bmRSZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVya3VuZFJlc3BvbnNlID0gdXJrdW5kUmVzcG9uc2VzICYmIHVya3VuZFJlc3BvbnNlc1swXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXVya3VuZFJlc3BvbnNlICYmIGZpbGUubWV0YWRhdGEudXJrdW5kVXBsb2FkRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHVya3VuZFJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBTdGF0dXM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBFcnJvckNvZGU6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2U6IGZpbGUubWV0YWRhdGEudXJrdW5kVXBsb2FkRXJyb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgU3RhdGU6ICdFcnJvcidcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgRXh0ZXJuYWxJZDogZmlsZS5tZXRhZGF0YS51cmt1bmRFeHRlcm5hbElkXHJcbiAgICAgICAgICAgICAgICAgICAgICB9IGFzIFVya3VuZFJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZS5pc1JlZnJlc2hpbmcpIHJldHVybiA8dGQgY29sU3Bhbj17Mn0+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8U3Bpbm5lciAvPiBVcHBkYXRlcmFyLi4uXHJcbiAgICAgICAgICAgICAgICAgICAgPC90ZD47XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVya3VuZFJlc3BvbnNlID8gPD5cclxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ1cmt1bmQtc3RhdHVzLWNvbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e3Vya3VuZFJlc3BvbnNlLlJlcG9ydCAmJiB1cmt1bmRSZXNwb25zZS5SZXBvcnQuUmVwb3J0VXJsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2PT57XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoWydBY2NlcHRlZCcsICdTdWJtaXR0ZWQnXS5pbmRleE9mKHVya3VuZFJlc3BvbnNlLlN0YXR1cy5TdGF0ZSkgPT09IC0xKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vIEZvbGxvdyBIUkVGIGluc3RlYWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hBc3NpZ25tZW50KGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PVwiX2JsYW5rXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17Z2V0VXJrdW5kSG92ZXJUZXh0KHVya3VuZFJlc3BvbnNlKX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2dldFVya3VuZFN0YXR1c0NsYXNzKHVya3VuZFJlc3BvbnNlKX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC90ZD5cclxuICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzc05hbWU9XCJ1cmt1bmQtc3RhdHVzLWNvbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17Z2V0VXJrdW5kU2lnbmlmaWNhbmNlQ2xhc3ModXJrdW5kUmVzcG9uc2UpfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7dXJrdW5kUmVzcG9uc2UuUmVwb3J0ICYmIHR5cGVvZiB1cmt1bmRSZXNwb25zZS5SZXBvcnQuU2lnbmlmaWNhbmNlID09PSAnbnVtYmVyJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgJHt1cmt1bmRSZXNwb25zZS5SZXBvcnQuU2lnbmlmaWNhbmNlLnRvRml4ZWQoKX0lYCA6ICcgJ31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L3RkPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvPiA6IDx0ZCBjb2xTcGFuPXsyfS8+XHJcbiAgICAgICAgICAgICAgICAgIH0pKClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICA8Lz4gOiA8PlxyXG4gICAgICAgICAgICAgICAgPHRkPlxyXG4gICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZG93bmxvYWQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgIH19PntmaWxlLmZpbGVuYW1lfTwvYT5cclxuICAgICAgICAgICAgICAgIDwvdGQ+XHJcbiAgICAgICAgICAgICAgICA8dGQgY2xhc3NOYW1lPVwiYXNzaWdubWVudC1kYXRlLWNvbFwiPntmaWxlLm1ldGFkYXRhLiRtZXRhID09PSAnYWRkJyA/XHJcbiAgICAgICAgICAgICAgICAgIDw+PFNwaW5uZXIgLz4gTGFkZGFyIHVwcC4uLjwvPiA6XHJcbiAgICAgICAgICAgICAgICAgIGZpbGUubWV0YWRhdGEuJG1ldGEgPT09ICdkZWxldGUnID9cclxuICAgICAgICAgICAgICAgICAgPD48U3Bpbm5lciAvPiBUYXIgYm9ydC4uLjwvPiA6XHJcbiAgICAgICAgICAgICAgICAgIG1vbWVudChmaWxlLnVwbG9hZERhdGUpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbScpfTwvdGQ+XHJcbiAgICAgICAgICAgICAgPC8+fVxyXG4gICAgICAgICAgICAgIHtoYXNPd25Eb2NzICYmIDx0ZD57IWZpbGUubWV0YWRhdGEuJG1ldGEgJiYgZmlsZS51c2VyID09PSBlbnYuY3VycmVudFVzZXIubWFpbCAmJlxyXG4gICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiBvbkNsaWNrPXtldiA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICBpZiAoY29uZmlybShgUmFkZXJhIGlubMOkbW5hZCBmaWwgJHtmaWxlLmZpbGVuYW1lfT9gKSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZShmaWxlLm1lZGlhTGluayk7XHJcbiAgICAgICAgICAgICAgICB9fT48aSBjbGFzc05hbWU9XCJmYSBmYS10cmFzaFwiLz48L2E+fTwvdGQ+fVxyXG4gICAgICAgICAgICA8L3RyPilcclxuICAgICAgICAgIH08L3Rib2R5PjwvdGFibGU+XHJcbiAgICAgICAgPC8+fVxyXG4gICAgICAgIHtpc0VtcGxveWVlKCkgPyB1bmRlZmluZWQgOiA8PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZHJvcC16b25lIHRhc2stYXNzaWdubWVudC1kcm9wLXpvbmVcIj5cclxuICAgICAgICAgICAgRHJvcHBhIGRpdHQgZsOkcmRpZ2EgYXJiZXRlIGjDpHIuPGJyLz5EZXQgZ8OlciBvY2tzw6UgYnJhIGF0dCBhbnbDpG5kYSBibMOkZGRyYS1rbmFwcGVuIG5lZGFuLlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8aW5wdXQgdHlwZT1cImZpbGVcIiBvbkNoYW5nZT17ZXYgPT4gdGhpcy52ZXJpZnlBbmRVcGxvYWQoZXYudGFyZ2V0LmZpbGVzWzBdKX0gLz5cclxuICAgICAgICAgIHtzaG93R29vZ2xlUGlja2VyICYmIDxEcml2ZUJ1dHRvbiBsYWJlbD1cIkjDpG10YSBmcsOlbiBHb29nbGUgRHJpdmVcIiBhY3Rpb249eygpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGlja2VyID0gbmV3IEdvb2dsZVBpY2tlcih7dXBsb2FkOnRydWV9KTtcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgcGlja2VyLnNob3coKS50aGVuKGZpbGVzID0+IHtcclxuICAgICAgICAgICAgICBwaWNrZXIuZG93bmxvYWRGaWxlKHtcclxuICAgICAgICAgICAgICAgICBmaWxlOiBmaWxlc1swXSxcclxuICAgICAgICAgICAgICAgIGxpbWl0U2l6ZTogTUFYX05PTlVSS1VORF9GSUxFX1NJWkVfTUJcclxuICAgICAgICAgICAgICB9KS50aGVuKGZpbGUgPT4gdGhpcy52ZXJpZnlBbmRVcGxvYWQoZmlsZSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgPC8+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICk7XHJcblxyXG4gIH1cclxufSIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgVGFzaywgQ291cnNlLCBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgQWJpbGl0aWVzQm94IH0gZnJvbSBcIi4uL3N1YmNvbXBvbmVudHMvYWJpbGl0aWVzLWJveFwiO1xyXG5pbXBvcnQgeyBDZW50cmFsQ29udGVudEJveCB9IGZyb20gXCIuLi9zdWJjb21wb25lbnRzL2NlbnRyYWwtY29udGVudC1ib3hcIjtcclxuaW1wb3J0IHsgS25vd2xlZGdlUmVxdWlyZW1lbnRzVGFibGUgfSBmcm9tIFwiLi4vc3ViY29tcG9uZW50cy9rbm93bGVkZ2UtcmVxdWlyZW1lbnRzLXRhYmxlXCI7XHJcbmltcG9ydCB7IHVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xyXG5pbXBvcnQgeyBMIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvdXRpbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlELCBEb2N1bWVudEFjY2VzcyB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50JztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IFRhc2tBc3NpZ25tZW50cyB9IGZyb20gJy4vdGFzay1hc3NpZ25tZW50cyc7XHJcbmltcG9ydCB7IGlzVGVhY2hlckF0U2Nob29sIH0gZnJvbSAnLi4vLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB0YXNrOiBUYXNrXHJcbiAgY291cnNlOiBDb3Vyc2VcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICB1c2VyVGFzazogVXNlclRhc2sgfCBudWxsIHwgdW5kZWZpbmVkO1xyXG4gIHdlZWtQbGFubmVyV2VlazogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGFza1BhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIHVzZXJUYXNrOiB1bmRlZmluZWQsXHJcbiAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KCkud2VlaygpXHJcbiAgICB9O1xyXG4gICAgdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQgPSB0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB1c2VyVGFza3NSZXBvLnN1YnNjcmliZSh0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZCk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vblVzZXJUYXNrc0NoYW5nZWQpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XHJcbiAgICBpZiAobmV4dFByb3BzLnRhc2suaWQgIT09IHRoaXMucHJvcHMudGFzay5pZCkge1xyXG4gICAgICBjb25zdCB1c2VyVGFzayA9IHVzZXJUYXNrc1JlcG8ubWVtLml0ZW1zLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gbmV4dFByb3BzLnRhc2suaWQpIHx8IG51bGw7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIHVzZXJUYXNrLFxyXG4gICAgICAgIHdlZWtQbGFubmVyV2VlazogbW9tZW50KHVzZXJUYXNrc1JlcG8ucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUpLndlZWsoKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uVXNlclRhc2tzQ2hhbmdlZCh1c2VyVGFza3M6IFVzZXJUYXNrW10pIHtcclxuICAgIGNvbnN0IHVzZXJUYXNrID0gdXNlclRhc2tzLmZpbmQodXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgJiYgdXQudGFza1swXS5pZCA9PT0gdGhpcy5wcm9wcy50YXNrLmlkKSB8fCBudWxsO1xyXG4gICAgdGhpcy5zZXRTdGF0ZSh7XHJcbiAgICAgIHVzZXJUYXNrLFxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWs6IG1vbWVudCh1c2VyVGFza3NSZXBvLnBlcnNpc3RlZFN0YXRlLndlZWtEYXRlKS53ZWVrKClcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdG9nZ2xlVGFzayAoKSB7XHJcbiAgICBjb25zdCB7IHdlZWtEYXRlIH0gPSB1c2VyVGFza3NSZXBvLnBlcnNpc3RlZFN0YXRlO1xyXG4gICAgY29uc3QgeyB1c2VyVGFzayB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHsgY291cnNlLCB0YXNrIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgbW9kdWxlID0gY291cnNlLm1vZHVsZXMuZmluZChtID0+IG0udGFza0lkcy5zb21lKGlkID0+IGlkID09PSB0YXNrLmlkKSk7XHJcbiAgICBpZiAoIW1vZHVsZSkgcmV0dXJuOyAvLyBPaCB1aCFcclxuICAgIGlmICh1c2VyVGFzayA9PT0gdW5kZWZpbmVkKSByZXR1cm47IC8vIE5vdCB5ZXQgbG9hZGVkLlxyXG4gICAgaWYgKCF1c2VyVGFzaykge1xyXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXHJcbiAgICAgICAgTWF0aC5tYXgsXHJcbiAgICAgICAgW3dlZWtEYXRlXS5jb25jYXQodXNlclRhc2tzUmVwby5tZW0uaXRlbXMubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXJUYXNrOiBVc2VyVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIGNvdXJzZU5hbWU6IGNvdXJzZS5uYW1lLFxyXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxyXG4gICAgICAgIGxlYXJuaW5nR29hbDogdGFzay5sZWFybmluZ0dvYWwgfHwgbW9kdWxlLm5hbWUsXHJcbiAgICAgICAgbmFtZTogdGFzay5uYW1lLFxyXG4gICAgICAgIHVybDogdGFzay51cmwsXHJcbiAgICAgICAgdGFzazogW3Rhc2tdLFxyXG4gICAgICAgIGNvdXJzZTogW2NvdXJzZV0sXHJcbiAgICAgICAgYWNsOiBbXHJcbiAgICAgICAgICAvLyBEZWZhdWx0IEFDTDogTGV0IHVzZXIgc2VsZiBoYXZlIGZ1bGwgY29udHJvbCBvdmVyIHRoaXMgaXRlbTpcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIEFDTDogTGV0IGVtcGxveWVlcyBvbiBzYW1lIHNjaG9vbCBoYXZlIHJlYWQgYWNjZXNzIHRvIGl0LlxyXG4gICAgICAgICAgLy8gVGhpcyBjdXJyZW50bHkgb25seSBhcHBsaWVzIHRvIHRhc2tzIHRoYXQgcmVmZXIgdG8gY291cnNlIHRhc2tzIChub3Qgb3duIHRhc2tzISlcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAodGFzay5kZWFkbGluZSkge1xyXG4gICAgICAgIHVzZXJUYXNrLmRlYWRsaW5lID0gdGFzay5kZWFkbGluZTtcclxuICAgICAgfVxyXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4odGhpcy5wcm9wcy5jb3Vyc2UubmFtZSwgdHJ1ZSksXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5pbnNlcnQoW3VzZXJUYXNrXSldKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8uZGVsZXRlKFt1c2VyVGFzay5pZF0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyB0YXNrLCBjb3Vyc2UgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IHVzZXJUYXNrLCB3ZWVrUGxhbm5lcldlZWsgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCBhYmlsaXRpZXMgPSB0YXNrLmFiaWxpdGllcy5tYXAoYSA9PiBjb3Vyc2UuYWJpbGl0aWVzLmZpbmQoYWIgPT4gYWIuaWQgPT09IGEuaWQpKS5maWx0ZXIoYSA9PiAhIWEpO1xyXG4gICAgY29uc3QgY2VudHJhbENvbnRlbnQgPSB0YXNrLmNlbnRyYWxDb250ZW50Lm1hcChjID0+IGNvdXJzZS5jZW50cmFsQ29udGVudC5maW5kKGNjID0+IGNjLmlkID09IGMuaWQpKS5maWx0ZXIoYyA9PiAhIWMpO1xyXG4gICAgY29uc3QgcmVxdWlyZW1lbnRzID0gdGFzay5rbm93bGVkZ2VSZXF1aXJlbWVudHMubWFwKGsgPT4gY291cnNlLmtub3dsZWRnZVJlcXVpcmVtZW50cy5maW5kKGtyID0+IGtyLmlkID09PSBrLmlkKSkuZmlsdGVyKGsgPT4gISFrKTtcclxuICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrICYmICh1c2VyVGFzay4kbWV0YSA9PT0gJ2FkZGluZycgfHwgdXNlclRhc2suJG1ldGEgPT09ICdkZWxldGluZycpO1xyXG4gICAgY29uc3QgY3VycmVudFdlZWsgPSBtb21lbnQoKS53ZWVrKCk7XHJcbiAgICBjb25zdCBmb3JXZWVrU3RyaW5nID0gd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/IFwibG9nZ2Jva2VuXCIgOlxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrICsgMSA/IExgdmFsZCB2ZWNrYSAobsOkc3RhIHZlY2thKWAgOlxyXG4gICAgICB3ZWVrUGxhbm5lcldlZWsgPT09IGN1cnJlbnRXZWVrIC0gMSA/IExgdmFsZCB2ZWNrYSAoZsO2cnJhIHZlY2thbilgIDpcclxuICAgICAgTGB2YWxkIHZlY2thICh2ICR7d2Vla1BsYW5uZXJXZWVrfSlgO1xyXG4gICAgY29uc3QgZGVhZGxpbmVUb29MYXRlID0gdGFzay5kZWFkbGluZSAmJiBtb21lbnQodGFzay5kZWFkbGluZSkuZW5kT2YoJ2RheScpIDwgbW9tZW50KCk7XHJcblxyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtdGV4dC1wb3J0bGV0IHN2LXVzZS1tYXJnaW5zIHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi10ZXh0LXBvcnRsZXQtY29udGVudFwiPlxyXG4gICAgICAgICAgPGgxIGNsYXNzTmFtZT1cImgxXCI+e3Rhc2submFtZX08L2gxPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgICAgIHt0YXNrLmNvbnRlbnQgJiYgPD5cclxuICAgICAgICAgIDxkaXYgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRhc2suY29udGVudH19IC8+XHJcbiAgICAgICAgPC8+fVxyXG4gICAgICAgIHt0YXNrLmxlYXJuaW5nR29hbCAmJiA8ZGl2PjxoMj5VcHBnaWZ0ZW5zIGzDpHJhbmRlbcOlbDwvaDI+XHJcbiAgICAgICAgICA8cD57dGFzay5sZWFybmluZ0dvYWx9PC9wPlxyXG4gICAgICAgIDwvZGl2Pn1cclxuICAgICAgICB7dGFzay51cmwgJiYgPGEgaHJlZj17dGFzay51cmx9IGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2VcIj5Hw6UgdGlsbCB1cHBnaWZ0ZW48L2E+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGJyLz5cclxuICAgICAge3Rhc2suYXNzaWdubWVudCA/IDw+XHJcbiAgICAgICAgPGgyPklubMOkbW5pbmdzdXBwZ2lmdDwvaDI+XHJcbiAgICAgICAge2lzVGVhY2hlckF0U2Nob29sKGVudi5jdXJyZW50VXNlciwgY291cnNlLnNjaG9vbCkgP1xyXG4gICAgICAgICAgPHA+SMOkciBrYW4gZHUgc29tIGzDpHJhcmUgc2UgZWxldmVybmFzIGlubMOkbW5hZGUgYXJiZXRlbi5cclxuICAgICAgICAgIDwvcD4gOiA8PlxyXG4gICAgICAgICAgICA8cD5EZXQgaMOkciDDpHIgZW4gaW5sw6RtbmluZ3N1cHBnaWZ0LiBMw6RtbmEgaW4gZGl0dCBhcmJldGUgc29tIGVuIHBkZiwgZG9jIGVsbGVyIG9kdCBmaWxcclxuICAgICAgICAgICAgICBnZW5vbSBhdHQgZHJhIGRldCB0aWxsIGbDpGx0ZXQgdW5kZXIuIER1IGthbiDDpHZlbiBsYWRkYSB1cCBlbiBmaWwgZWxsZXIgdsOkbGphIGVuIGZpbFxyXG4gICAgICAgICAgICAgIGZyw6VuIGRpbiBHb29nbGUgRHJpdmUuXHJcbiAgICAgICAgICAgIDwvcD5cclxuICAgICAgICAgICAge3Rhc2suZGVhZGxpbmUgPyA8cD48Yj5cclxuICAgICAgICAgICAgICBEZW4gaMOkciB1cHBnaWZ0ZW4ge2RlYWRsaW5lVG9vTGF0ZSA/ICdza3VsbGUgaGEgbMOkbW5hdHMgaW4gJyA6ICdza2EgdmFyYSBpbmzDpG1uYWQgJ31cclxuICAgICAgICAgICAgICB7bW9tZW50KHRhc2suZGVhZGxpbmUpLmZvcm1hdCgnWVlZWS1NTS1ERCcpfVxyXG4gICAgICAgICAgICA8L2I+PC9wPiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgPC8+fVxyXG4gICAgICAgICAgPFRhc2tBc3NpZ25tZW50c1xyXG4gICAgICAgICAgICBjb3Vyc2VJZD17Y291cnNlLmlkfVxyXG4gICAgICAgICAgICB0YXNrSWQ9e3Rhc2suaWR9XHJcbiAgICAgICAgICAgIHNjaG9vbD17Y291cnNlLnNjaG9vbH1cclxuICAgICAgICAgICAvPlxyXG4gICAgICAgIDxici8+XHJcbiAgICAgIDwvPiA6IHVuZGVmaW5lZH1cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIHthYmlsaXRpZXMubGVuZ3RoID4gMCAmJiA8QWJpbGl0aWVzQm94XHJcbiAgICAgICAgICAgIHRpdGxlPVwiRGVuIGjDpHIgdXBwZ2lmdGVuIGJlaGFuZGxhciBmw7ZsamFuZGUgZsO2cm3DpWdvclwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiXHJcbiAgICAgICAgICAgIGhlYWRlck9wZW49e2ZhbHNlfVxyXG4gICAgICAgICAgICBhYmlsaXRpZXM9e2FiaWxpdGllc30gLz59XHJcblxyXG4gICAgICAgIHtjZW50cmFsQ29udGVudC5sZW5ndGggPiAwICYmIDxDZW50cmFsQ29udGVudEJveFxyXG4gICAgICAgICAgICB0aXRsZT1cIkRlbiBow6RyIHVwcGdpZnRlbiBiZWhhbmRsYXIgZsO2bGphbmRlIGNlbnRyYWxhIGlubmVow6VsbFwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cImxhcmdlclwiXHJcbiAgICAgICAgICAgIGhlYWRlck9wZW49e2ZhbHNlfVxyXG4gICAgICAgICAgICBjZW50cmFsQ29udGVudD17Y2VudHJhbENvbnRlbnR9IC8+fVxyXG5cclxuICAgICAgICB7cmVxdWlyZW1lbnRzLmxlbmd0aCA+IDAgJiYgPEtub3dsZWRnZVJlcXVpcmVtZW50c1RhYmxlXHJcbiAgICAgICAgICB0aXRsZT1cIkkgZGVuIGjDpHIgdXBwZ2lmdGVuIGJlZMO2bXMgZsO2bGphbmRlIGt1bnNrYXBza3JhdlwiXHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJsYXJnZXJcIlxyXG4gICAgICAgICAgaGVhZGVyT3Blbj17dHJ1ZX1cclxuICAgICAgICAgIHJlcXVpcmVtZW50cz17cmVxdWlyZW1lbnRzfVxyXG4gICAgICAgICAgLz59XHJcbiAgICAgIDwvZGl2PiAgICAgIFxyXG4gICAgICA8aHIvPlxyXG4gICAgICB7dXNlclRhc2sgIT09IHVuZGVmaW5lZCAmJiA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BzZWxlY3RlZEJveCR7dXNlclRhc2sgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZycgPyAnIHNlbGVjdGVkJyA6ICcnfWB9XHJcbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtpc1dvcmtpbmcgPyB7b3BhY2l0eTogMC41fToge319XHJcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT4haXNXb3JraW5nICYmIHRoaXMudG9nZ2xlVGFzaygpfT5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICB7dXNlclRhc2sgP1xyXG4gICAgICAgICAgICAgICAgTGBUYSBib3J0IHVwcGdpZnRlbiBmcsOlbiAke2ZvcldlZWtTdHJpbmd9YDpcclxuICAgICAgICAgICAgICAgIExgTMOkZ2cgdGlsbCB1cHBnaWZ0ZW4gaSAke2ZvcldlZWtTdHJpbmd9YH1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L2Rpdj59XHJcbiAgICAgIDxoci8+XHJcbiAgICAgIHt0YXNrLnJlc291cmNlcyAmJiB0YXNrLnJlc291cmNlcy5sZW5ndGggPiAwICYmIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8aDI+UmVzdXJzZXIga29wcGxhZGUgdGlsbCB1cHBnaWZ0ZW48L2gyPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxyXG4gICAgICAgICAge3Rhc2sucmVzb3VyY2VzLm1hcCgociwgaWR4KSA9PlxyXG4gICAgICAgICAgICA8ZGl2IGtleT17aWR4fSBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3IudXJsfT57ci5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxiciAvPlxyXG4gICAgICA8L2Rpdj59XHJcblxyXG4gXHJcbiAgICAgIDxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPjxiciAvPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7VXJrdW5kUmVzcG9uc2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTdGF0dXNDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9IGVsc2Ugc3dpdGNoIChyZXMuU3RhdHVzLlN0YXRlKSB7XHJcbiAgICBjYXNlICdFcnJvcic6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLWVycm9yYDtcclxuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLXN1Ym1pdHRlZGA7XHJcbiAgICBjYXNlICdBY2NlcHRlZCc6XHJcbiAgICAgIHJldHVybiBgdXJrdW5kLXN0YXR1cyB1cmt1bmQtc3RhdHVzLWFjY2VwdGVkYDtcclxuICAgIGNhc2UgJ0FuYWx5emVkJzpcclxuICAgICAgcmV0dXJuIGB1cmt1bmQtc3RhdHVzIHVya3VuZC1zdGF0dXMtYW5hbHl6ZWRgO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFVya3VuZEhvdmVyVGV4dCAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSByZXR1cm4gbnVsbDtcclxuICBzd2l0Y2ggKHJlcy5TdGF0dXMuU3RhdGUpIHtcclxuICAgIGNhc2UgJ0Vycm9yJzpcclxuICAgICAgcmV0dXJuIHJlcy5FeHRlcm5hbElkID9cclxuICAgICAgICBgS3VuZGUgaW50ZSB0YXMgZW1vdCBhdiB1cmt1bmQuIEZlbGtvZDogJHtyZXMuU3RhdHVzLkVycm9yQ29kZX1cXG5gK1xyXG4gICAgICAgIGBFeHRlcm5hbCBJRDogJHtyZXMuRXh0ZXJuYWxJZH1cXG5GZWxtZWRkZWxhbmRlOiAke3Jlcy5TdGF0dXMuTWVzc2FnZX1gXHJcbiAgICAgICAgOlxyXG4gICAgICAgIHJlcy5TdGF0dXMuTWVzc2FnZTtcclxuICAgIGNhc2UgJ1N1Ym1pdHRlZCc6XHJcbiAgICAgIHJldHVybiBgRmlsZW4gw6RyIHVwcGxhZGRhZCB0aWxsIFVya3VuZC4gS2xpY2thIGbDtnIgYXR0IHVwcGRhdGVyYSBzdGF0dXMuYDtcclxuICAgIGNhc2UgJ0FjY2VwdGVkJzpcclxuICAgICAgcmV0dXJuIGBGaWxlbiBhbmFseXNlcmFzIGZvcnRmYXJhbmRlIGF2IFVya3VuZC4gS2xpY2thIGbDtnIgYXR0IHVwcGRhdGVyYSBzdGF0dXMuYDtcclxuICAgIGNhc2UgJ0FuYWx5emVkJzpcclxuICAgICAgcmV0dXJuIGBSYXBwb3J0IHNrYXBhZC4gS2xpY2thIGbDtnIgYXR0IMO2cHBuYSByYXBwb3J0ZW4gaSBueXR0IGbDtm5zdGVyYDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRVcmt1bmRTaWduaWZpY2FuY2VDbGFzcyAocmVzOiBVcmt1bmRSZXNwb25zZSkge1xyXG4gIGlmICghcmVzIHx8ICFyZXMuU3RhdHVzKSByZXR1cm4gJyc7XHJcblxyXG4gIHN3aXRjaCAocmVzLlN0YXR1cy5TdGF0ZSkge1xyXG4gICAgY2FzZSAnRXJyb3InOiByZXR1cm4gJ3Vya3VuZC1zaWduaWZpY2FuY2UtZXJyb3InO1xyXG4gICAgY2FzZSAnU3VibWl0dGVkJzogcmV0dXJuICd1cmt1bmQtc2lnbmlmaWNhbmNlLXN1Ym1pdHRlZCc7XHJcbiAgICBjYXNlICdBY2NlcHRlZCc6IHJldHVybiAndXJrdW5kLXNpZ25pZmljYW5jZS1hY2NlcHRlZCc7XHJcbiAgfVxyXG4gIGNvbnN0IHJlcG9ydCA9IHJlcy5SZXBvcnQ7XHJcbiAgaWYgKCFyZXBvcnQpIHtcclxuICAgIHJldHVybiBcIlwiO1xyXG4gIH1cclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEpXHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvMC5naWZgO1xyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTBcIjtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDEwKVxyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzEuZ2lmYDtcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS0xXCI7XHJcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCAyNSlcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS0yXCI7XHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvMi5naWZgO1xyXG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgNDApXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtM1wiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzMuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDU1KVxyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLTRcIjtcclxuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC80LmdpZmA7XHJcbiAgaWYgKHJlcG9ydC5TaWduaWZpY2FuY2UgPCA3MClcclxuICAgIHJldHVybiBcInVya3VuZC1zaWduaWZpY2FuY2UgdXJrdW5kLXNpZ25pZmljYW5jZS01XCI7XHJcbiAgICAvL3JldHVybiBgJHtjZG59L2ltYWdlcy91cmt1bmQvNS5naWZgO1xyXG4gIGlmIChyZXBvcnQuU2lnbmlmaWNhbmNlIDwgODUpXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtNlwiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzYuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA8IDk5LjkpXHJcbiAgICByZXR1cm4gXCJ1cmt1bmQtc2lnbmlmaWNhbmNlIHVya3VuZC1zaWduaWZpY2FuY2UtN1wiO1xyXG4gICAgLy9yZXR1cm4gYCR7Y2RufS9pbWFnZXMvdXJrdW5kLzcuZ2lmYDtcclxuICBpZiAocmVwb3J0LlNpZ25pZmljYW5jZSA+PSA5OS45KVxyXG4gICAgcmV0dXJuIFwidXJrdW5kLXNpZ25pZmljYW5jZSB1cmt1bmQtc2lnbmlmaWNhbmNlLThcIjtcclxuICAgIC8vcmV0dXJuIGAke2Nkbn0vaW1hZ2VzL3Vya3VuZC84LmdpZmA7XHJcbiAgcmV0dXJuIFwiXCI7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBMLCBzaG93RXJyb3IgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IEVycm9yU3VjY2Vzc0ZlZWRiYWNrIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3Itc3VjY2Vzcy1mZWVkYmFjayc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBsb2FkQ291cnNlIH0gZnJvbSBcIi4uL2NvdXJzZS1idWlsZGVyL3V0aWxzXCI7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xyXG5pbXBvcnQgeyBDb3Vyc2VQYWdlIH0gZnJvbSBcIi4vY291cnNlLXBhZ2VcIjtcclxuaW1wb3J0IHsgcGFyc2VRdWVyeVN0cmluZyB9IGZyb20gXCIuLi8uLi91dGlscy9xdWVyeS1zdHJpbmdcIjtcclxuaW1wb3J0IHsgTGlzdENvdXJzZXNQYWdlIH0gZnJvbSAnLi4vbGlzdC1jb3Vyc2VzL2xpc3QtY291cnNlcy1wYWdlJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgY291cnNlQnVpbGRlclVybD86IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBjb3Vyc2U6IENvdXJzZSB8IG51bGwsXHJcbiAgaXNMb2FkaW5nOiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb3Vyc2VWaWV3ZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGNvdXJzZTogbnVsbCxcclxuICAgICAgaXNMb2FkaW5nOiB0cnVlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICB0aGlzLmxvYWQoKS5jYXRjaChzaG93RXJyb3IpXHJcbiAgICAgIC50aGVuKCgpPT50aGlzLnNldFN0YXRlKHtpc0xvYWRpbmc6IGZhbHNlfSkpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZCgpIHtcclxuICAgIGNvbnN0IGNvdXJzZUlkID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpW1wiY291cnNlSWRcIl07XHJcbiAgICBjb25zdCBjb3Vyc2UgPSBjb3Vyc2VJZCA/IGF3YWl0IGxvYWRDb3Vyc2UgKGNvdXJzZUlkKSA6IG51bGw7XHJcbiAgICB0aGlzLnNldFN0YXRlKHtjb3Vyc2V9KTtcclxuICAgIGRvY3VtZW50LnRpdGxlID1cclxuICAgICAgY291cnNlID9cclxuICAgICAgICBjb3Vyc2UubmFtZSArIFwiIC0gXCIgKyBjb3Vyc2UucG9pbnRzICsgXCJwXCIgOlxyXG4gICAgICAgIFwiS3Vyc2VyXCI7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJjb3Vyc2Utdmlld2VyXCI+XHJcbiAgICAgIHt0aGlzLnN0YXRlLmlzTG9hZGluZyA/XHJcbiAgICAgICAgPFNwaW5uZXIgLz4gOlxyXG4gICAgICAgIHRoaXMuc3RhdGUuY291cnNlID9cclxuICAgICAgICAgIDxDb3Vyc2VQYWdlXHJcbiAgICAgICAgICAgIGNvdXJzZT17dGhpcy5zdGF0ZS5jb3Vyc2V9IFxyXG4gICAgICAgICAgICBjb3Vyc2VCdWlsZGVyVXJsPXt0aGlzLnByb3BzLmNvdXJzZUJ1aWxkZXJVcmx9IC8+IDpcclxuICAgICAgICAgIDxMaXN0Q291cnNlc1BhZ2UgLz5cclxuICAgICAgfVxyXG4gICAgICA8RXJyb3JTdWNjZXNzRmVlZGJhY2sgLz5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEFiaWxpdHkgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3ViVGl0bGU/OiBzdHJpbmc7XHJcbiAgYWJpbGl0aWVzOiBBYmlsaXR5W107XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGhlYWRlck9wZW46IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBYmlsaXRpZXNCb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGhlYWRlck9wZW46IHByb3BzLmhlYWRlck9wZW4gfHwgZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IHRpdGxlLCBzdWJUaXRsZSwgYWJpbGl0aWVzLCBjbGFzc05hbWUgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPXsoY2xhc3NOYW1lfHwnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XHJcbiAgICAgICAgPHA+e3RpdGxlfTwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFiaWxpdHlMaXN0XCI+XHJcbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XHJcbiAgICAgICAgICAgIDxoNT57c3ViVGl0bGV9PC9oNT5cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgIHthYmlsaXRpZXMubWFwKGEgPT5cclxuICAgICAgICAgICAgPGRpdiBrZXk9e2EuaWR9IGNsYXNzTmFtZT1cImNvbnRlbnRQYXJ0XCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50VGV4dFwiPlxyXG4gICAgICAgICAgICAgICAgPHAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IGEubmFtZX19IC8+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgKX1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ2VudHJhbENvbnRlbnQgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgc3ViVGl0bGU/OiBzdHJpbmc7XHJcbiAgY2VudHJhbENvbnRlbnQ6IENlbnRyYWxDb250ZW50W107XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIGhlYWRlck9wZW4/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGhlYWRlck9wZW46IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDZW50cmFsQ29udGVudEJveCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgaGVhZGVyT3BlbjogcHJvcHMuaGVhZGVyT3BlbiB8fCBmYWxzZVxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgdGl0bGUsIHN1YlRpdGxlLCBjZW50cmFsQ29udGVudCwgY2xhc3NOYW1lIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgeyBoZWFkZXJPcGVuIH0gPSB0aGlzLnN0YXRlO1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZSB8fCAnJykgKyBcIiBvcGVuQ2xvc2VcIiArIChoZWFkZXJPcGVuID8gXCIgb3BlblwiIDogXCJcIil9PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm9wZW5IZWFkZXJcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KX0+XHJcbiAgICAgICAgPHA+e3RpdGxlfTwvcD5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwib3BlbkNvbnRlbnRcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFiaWxpdHlMaXN0XCI+XHJcbiAgICAgICAgICB7c3ViVGl0bGUgJiYgPGRpdiBjbGFzc05hbWU9XCJjb250ZW50SGVhZGVyXCI+XHJcbiAgICAgICAgICAgIDxoNT57c3ViVGl0bGV9PC9oNT5cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICAgIHtjZW50cmFsQ29udGVudC5tYXAoY2MgPT5cclxuICAgICAgICAgICAgPGRpdiBrZXk9e2NjLmlkfSBjbGFzc05hbWU9XCJjb250ZW50UGFydFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGVudFRleHRcIj5cclxuICAgICAgICAgICAgICAgIDxwIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBjYy5uYW1lfX0gLz5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICB2aXNpYmxlOiBib29sZWFuO1xyXG4gIHRleHQ6IHN0cmluZztcclxuICBjbGFzc05hbWU/OiBzdHJpbmc7XHJcbiAgb25Db25maXJtOiAoKT0+dm9pZDtcclxuICBvbkNhbmNlbDogKCk9PnZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBDb25maXJtYXRpb24gKHByb3BzOiBQcm9wcykge1xyXG4gIHJldHVybiA8ZGl2XHJcbiAgICBjbGFzc05hbWU9e2Bjb25maXJtYXRpb24tYm94ICR7cHJvcHMuY2xhc3NOYW1lfSR7cHJvcHMudmlzaWJsZSA/IFwiIHZpc2libGVcIiA6IFwiXCJ9YH0+XHJcbiAgICA8cD57cHJvcHMudGV4dH08L3A+XHJcbiAgICA8YnV0dG9uIG9uQ2xpY2s9eygpPT5wcm9wcy5vbkNvbmZpcm0oKX0+T0s8L2J1dHRvbj5cclxuICAgIDxidXR0b24gb25DbGljaz17KCk9PnByb3BzLm9uQ2FuY2VsKCl9PkF2YnJ5dDwvYnV0dG9uPlxyXG4gIDwvZGl2PjtcclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEtub3dsZWRnZVJlcXVpcmVtZW50IH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBPcGVuQ2xvc2VCb3ggfSBmcm9tIFwiLi4vLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94XCI7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nO1xyXG4gIHJlcXVpcmVtZW50czogS25vd2xlZGdlUmVxdWlyZW1lbnRbXTtcclxuICBleHBsYWluZWRSZXF1aXJlbWVudHM/OiB7W3JlcXVpcmVtZW50SWQ6IHN0cmluZ106IHN0cmluZ307XHJcbiAgaW5jbHVkZWRJZHM/OiB7W2lkOiBzdHJpbmddIDogdHJ1ZX07XHJcbiAgaGVhZGVyT3Blbj86IGJvb2xlYW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBLbm93bGVkZ2VSZXF1aXJlbWVudHNUYWJsZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHt9O1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3QgeyB0aXRsZSwgcmVxdWlyZW1lbnRzLCBjbGFzc05hbWUsIGluY2x1ZGVkSWRzLCBoZWFkZXJPcGVuLCBleHBsYWluZWRSZXF1aXJlbWVudHMgfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgY29uc3QgY29sdW1ucyA9IFtcIkVcIiwgXCJDXCIsIFwiQVwiXTtcclxuICAgIGNvbnN0IHJvd3M6IEtub3dsZWRnZVJlcXVpcmVtZW50W11bXSA9IFtdO1xyXG4gICAgY29uc3QgcmVxcyA9IHJlcXVpcmVtZW50cy5zbGljZSgpO1xyXG4gICAgbGV0IHJvdzogS25vd2xlZGdlUmVxdWlyZW1lbnRbXSB8IG51bGwgPSBudWxsO1xyXG4gICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgcm93ID0gY29sdW1ucy5tYXAoZ3JhZGUgPT4ge1xyXG4gICAgICAgIGNvbnN0IHBOZXh0ID0gcmVxcy5maW5kSW5kZXgociA9PiByLmdyYWRlU3RlcC50b1VwcGVyQ2FzZSgpID09PSBncmFkZSk7XHJcbiAgICAgICAgaWYgKHBOZXh0IDwgMCkgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgY29uc3QgcnYgPSByZXFzW3BOZXh0XTtcclxuICAgICAgICByZXFzLnNwbGljZShwTmV4dCwgMSk7XHJcbiAgICAgICAgcmV0dXJuIGluY2x1ZGVkSWRzID9cclxuICAgICAgICAgIChpbmNsdWRlZElkc1tydi5pZF0gPyBydiA6IHVuZGVmaW5lZCkgOlxyXG4gICAgICAgICAgcnY7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAocm93LmV2ZXJ5KHIgPT4gciA9PT0gbnVsbCkpXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGlmICghcm93LmV2ZXJ5KHIgPT4gIXIpKSB7XHJcbiAgICAgICAgcm93cy5wdXNoKHJvdyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveCB0aXRsZT17PHA+e3RpdGxlfTwvcD59IGNsYXNzTmFtZT17Y2xhc3NOYW1lfSBoZWFkZXJPcGVuPXtoZWFkZXJPcGVufT5cclxuICAgICAgPHRhYmxlPlxyXG4gICAgICAgIDx0aGVhZD5cclxuICAgICAgICAgIDx0cj5cclxuICAgICAgICAgICAge2NvbHVtbnMubWFwKGMgPT4gPHRoIGtleT17Y30+e2N9PC90aD4pfVxyXG4gICAgICAgICAgPC90cj5cclxuICAgICAgICA8L3RoZWFkPlxyXG4gICAgICAgIDx0Ym9keT5cclxuICAgICAgICAgIHtyb3dzLm1hcCgocm93LGkpID0+IDxSZWFjdC5GcmFnbWVudCBrZXk9e2l9PlxyXG4gICAgICAgICAgICAgIDx0ciBrZXk9e2l9PlxyXG4gICAgICAgICAgICAgICAge3Jvdy5tYXAoKGNvbHVtbixqKSA9PlxyXG4gICAgICAgICAgICAgICAgICA8dGQga2V5PXtqfSBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogY29sdW1uID8gY29sdW1uLm5hbWUgOiBcIlwifX0gLz5cclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgPC90cj5cclxuICAgICAgICAgICAgICB7ZXhwbGFpbmVkUmVxdWlyZW1lbnRzICYmIDx0cj5cclxuICAgICAgICAgICAgICAgIHtyb3cubWFwKChjb2x1bW4saikgPT5cclxuICAgICAgICAgICAgICAgICAgPHRkIGtleT17an0gY2xhc3NOYW1lPVwiZXhwbGFpbmVkLXJlcXVpcmVtZW50XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdj57KGNvbHVtbiAmJiBleHBsYWluZWRSZXF1aXJlbWVudHNbY29sdW1uLmlkXSkgfHwgXCJcIn08L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC90ZD4pfVxyXG4gICAgICAgICAgICAgIDwvdHI+fVxyXG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxyXG4gICAgICAgICAgKX1cclxuICAgICAgICA8L3Rib2R5PlxyXG4gICAgICA8L3RhYmxlPlxyXG4gICAgPC9PcGVuQ2xvc2VCb3g+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgTGVhcm5pbmdNb2R1bGVUYXNrLCBUYXNrTGlzdCB9IGZyb20gJy4vdGFzay1saXN0JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgY29tbW9uVGFza3M6IExlYXJuaW5nTW9kdWxlVGFza1tdXHJcbiAgbGVhcm5pbmdHb2FsczogTGVhcm5pbmdHb2FsW11cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ0dvYWwge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBsZWFybmluZ1Rhc2tzOiBMZWFybmluZ01vZHVsZVRhc2tbXTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIExlYXJuaW5nR29hbHNMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge2NvbW1vblRhc2tzLCBsZWFybmluZ0dvYWxzfSA9IHRoaXMucHJvcHM7XHJcbiAgICByZXR1cm4gPGRpdj57bGVhcm5pbmdHb2Fscy5tYXAobGcgPT4gPGRpdiBrZXk9e2xnLm5hbWV9PlxyXG4gICAgICA8aDU+e2xnLm5hbWV9PC9oNT5cclxuICAgICAgPFRhc2tMaXN0IGxlYXJuaW5nVGFza3M9e2xnLmxlYXJuaW5nVGFza3N9IC8+XHJcbiAgICA8L2Rpdj4pfVxyXG4gICAge2NvbW1vblRhc2tzLmxlbmd0aCA+IDAgJiYgPGRpdj5cclxuICAgICAge2xlYXJuaW5nR29hbHMubGVuZ3RoID4gMCAmJiA8aDU+w5Z2ZXJncmlwYW5kZTwvaDU+fVxyXG4gICAgICA8VGFza0xpc3QgbGVhcm5pbmdUYXNrcz17Y29tbW9uVGFza3N9IC8+XHJcbiAgICA8L2Rpdj59XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59IiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQge1Jlc291cmNlfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIHJlc291cmNlczogUmVzb3VyY2VbXTtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJlc291cmNlTGlzdCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge3Jlc291cmNlc30gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lclwiPlxyXG4gICAgICAgIHtyZXNvdXJjZXMubWFwKChyZXNvdXJjZSwgaWR4KSA9PiBcclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiIGtleT17aWR4fT5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICA8YSBocmVmPXtyZXNvdXJjZS51cmx9PntyZXNvdXJjZS5uYW1lfTwvYT5cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgQ291cnNlLCBDb3Vyc2VNb2R1bGUsIFRhc2ssIFVzZXJUYXNrIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgZW52IGZyb20gJy4uLy4uLy4uL2dsb2JhbHMvS0VELmVudic7XHJcbmltcG9ydCB7IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUgfSBmcm9tIFwiLi4vLi4vd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlXCI7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCwgQmF0Y2hSdW5uZXIsIERvY3VtZW50QWNjZXNzIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgeyB1c2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcclxuaW1wb3J0IHsgYXJyYXlUb01hcCwgTCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gJy4uLy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3NwaW5uZXInO1xyXG5pbXBvcnQgeyBDb25maXJtYXRpb24gfSBmcm9tICcuL2NvbmZpcm1hdGlvbic7XHJcblxyXG5pbnRlcmZhY2UgUHJvcHMge1xyXG4gIGxlYXJuaW5nVGFza3M6IExlYXJuaW5nTW9kdWxlVGFza1tdXHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgd2Vla0RhdGU6IG51bWJlcjtcclxuICB1c2VyVGFza3M6IFVzZXJUYXNrW107XHJcbiAgY29uZmlybWF0aW9uczogc3RyaW5nW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdNb2R1bGVUYXNrIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICAvKiogY291cnNlTmFtZVxyXG4gICAqIEZvciBLRzogY291cnNlTmFtZVxyXG4gICAqIEZvciBLUzogU3ViamVjdCBuYW1lXHJcbiAgICovXHJcbiAgY291cnNlTmFtZTogc3RyaW5nO1xyXG4gIC8qKiBsZWFybmluZ0dvYWxcclxuICAgKiBGb3IgS0c6IG1vZHVsZSBuYW1lIG9yIGxlYXJuaW5nIGdvYWwgb2YgdGhlIHRhc2tcclxuICAgKiBGb3IgS1Mvc3RlcC1jb3Vyc2U6IGNvdXJzZSBuYW1lXHJcbiAgICogRm9yIEtTL3RoZW1lLWNvdXJzZTogbGVhcm5pbmcgZ29hbFxyXG4gICAqL1xyXG4gIGxlYXJuaW5nR29hbDogc3RyaW5nO1xyXG4gIC8qKiBTdGVwXHJcbiAgICogT25seSBwcmVzZW50IGluIEtTL3N0ZXAtY291cnNlXHJcbiAgICovXHJcbiAgc3RlcD86IG51bWJlcjtcclxuICAvKiogdGFza1xyXG4gICAqIE9ubHkgZm9yIGNvdXJzZXMgYnVpbHQgYnkgY291cnNlYnVpbGRlclxyXG4gICAqL1xyXG4gIHRhc2s/OiBUYXNrO1xyXG4gIC8qKiBjb3Vyc2VcclxuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWx0IGJ5IGNvdXJzZWJ1aWxkZXJcclxuICAgKi9cclxuICBjb3Vyc2U/OiBDb3Vyc2U7XHJcbiAgLyoqIGNvdXJzZUluZm9cclxuICAgKiBPbmx5IGZvciBjb3Vyc2VzIGJ1aWxkIGJ5IHN1YmplY3RwbGFubmVyXHJcbiAgICovXHJcbiAgY291cnNlSW5mbz86IHtcclxuICAgIHNjaG9vbDogc3RyaW5nIC8vIFNjaG9vbCBuYW1lXHJcbiAgICBjb3Vyc2U6IHN0cmluZyAvLyBDb3Vyc2UgSW5zdGFuY2UgSURcclxuICAgIHRhYjogc3RyaW5nICAgIC8vIENvdXJzZVRhYiBJRFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRhc2tMaXN0IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICB1c2VyVGFza3M6IFtdLFxyXG4gICAgICB3ZWVrRGF0ZTogRGF0ZS5ub3coKSxcclxuICAgICAgY29uZmlybWF0aW9uczogW11cclxuICAgIH1cclxuICAgIHRoaXMub25DaGFuZ2UgPSB0aGlzLm9uQ2hhbmdlLmJpbmQodGhpcyk7ICAgIFxyXG4gIH1cclxuXHJcbiAgb25DaGFuZ2UgKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlKSB7XHJcbiAgICBpZiAocGVyc2lzdGVkLndlZWtEYXRlICE9PSB0aGlzLnN0YXRlLndlZWtEYXRlKSB7XHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgIGNvbmZpcm1hdGlvbnM6IFtdXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgdXNlclRhc2tzLFxyXG4gICAgICB3ZWVrRGF0ZTogcGVyc2lzdGVkLndlZWtEYXRlXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyB0b2dnbGVUYXNrIChsZWFybmluZ1Rhc2s6IExlYXJuaW5nTW9kdWxlVGFzaykge1xyXG4gICAgY29uc3QgdXNlclRhc2tzID0gdGhpcy5zdGF0ZS51c2VyVGFza3MuZmlsdGVyKHV0ID0+IHtcclxuICAgICAgcmV0dXJuIGxlYXJuaW5nVGFzay50YXNrID9cclxuICAgICAgICB1dC50YXNrICYmIHV0LnRhc2suc29tZSh0ID0+IHQuaWQgPT09IGxlYXJuaW5nVGFzay5pZCkgOlxyXG4gICAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPT09IGxlYXJuaW5nVGFzay5pZDtcclxuICAgIH0pO1xyXG4gICAgY29uc3Qge3dlZWtEYXRlfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBcclxuICAgIGlmICh1c2VyVGFza3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIC8vIE5vIHRhc2sgbWF0Y2hlcyB0aGlzIGxlYXJuaW5nTW9kdWxlVGFzayAtIG5vdCBwcmVzZW50IGluIHdlZWtwbGFubmVyLlxyXG4gICAgICBsZXQgbGF0ZXN0VGltZVN0YW1wID0gTWF0aC5tYXguYXBwbHkoXHJcbiAgICAgICAgTWF0aC5tYXgsXHJcbiAgICAgICAgW3dlZWtEYXRlXS5jb25jYXQodGhpcy5zdGF0ZS51c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcclxuXHJcbiAgICAgIGNvbnN0IHVzZXJUYXNrOiBVc2VyVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIGNvdXJzZU5hbWU6IGxlYXJuaW5nVGFzay5jb3Vyc2VOYW1lLFxyXG4gICAgICAgIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKyAyMDAwLFxyXG4gICAgICAgIGxlYXJuaW5nR29hbDogbGVhcm5pbmdUYXNrLmxlYXJuaW5nR29hbCxcclxuICAgICAgICBuYW1lOiBsZWFybmluZ1Rhc2submFtZSxcclxuICAgICAgICB1cmw6IGxlYXJuaW5nVGFzay51cmwsXHJcbiAgICAgICAgYWNsOiBbXHJcbiAgICAgICAgICAvLyBEZWZhdWx0IEFDTDogTGV0IHVzZXIgc2VsZiBoYXZlIGZ1bGwgY29udHJvbCBvdmVyIHRoaXMgaXRlbTpcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIGVudi5jdXJyZW50VXNlci5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAvLyBBZGRpdGlvbmFsIEFDTDogTGV0IGVtcGxveWVlcyBvbiBzYW1lIHNjaG9vbCBoYXZlIHJlYWQgYWNjZXNzIHRvIGl0LlxyXG4gICAgICAgICAgLy8gVGhpcyBjdXJyZW50bHkgb25seSBhcHBsaWVzIHRvIHRhc2tzIHRoYXQgcmVmZXIgdG8gY291cnNlIHRhc2tzIChub3QgY3VzdG9tIHRhc2tzISlcclxuICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICBdLm1hcChhYyA9PiBhYy50b1N0cmluZygpKVxyXG4gICAgICB9O1xyXG4gICAgICBpZiAobGVhcm5pbmdUYXNrLnRhc2sgJiYgbGVhcm5pbmdUYXNrLnRhc2suZGVhZGxpbmUpIHtcclxuICAgICAgICB1c2VyVGFzay5kZWFkbGluZSA9IGxlYXJuaW5nVGFzay50YXNrLmRlYWRsaW5lO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZWFybmluZ1Rhc2sudGFzaykge1xyXG4gICAgICAgIHVzZXJUYXNrLnRhc2sgPSBbbGVhcm5pbmdUYXNrLnRhc2tdO1xyXG4gICAgICAgIGlmIChsZWFybmluZ1Rhc2suY291cnNlKSB7XHJcbiAgICAgICAgICB1c2VyVGFzay5jb3Vyc2UgPSBbbGVhcm5pbmdUYXNrLmNvdXJzZV07XHJcbiAgICAgICAgfSBlbHNlIGlmIChsZWFybmluZ1Rhc2suY291cnNlSW5mbykge1xyXG4gICAgICAgICAgdXNlclRhc2suY291cnNlSW5mbyA9IGxlYXJuaW5nVGFzay5jb3Vyc2VJbmZvO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1c2VyVGFzay5zaXRlVmlzaW9uUGFnZUlkID0gbGVhcm5pbmdUYXNrLmlkO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChsZWFybmluZ1Rhc2suc3RlcCkge1xyXG4gICAgICAgIHVzZXJUYXNrLnN0ZXAgPSBsZWFybmluZ1Rhc2suc3RlcDtcclxuICAgICAgfVxyXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4obGVhcm5pbmdUYXNrLmNvdXJzZU5hbWUsIHRydWUpLFxyXG4gICAgICAgIHVzZXJUYXNrc1JlcG8uaW5zZXJ0KFt1c2VyVGFza10pXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBBbHJlYWR5IHByZXNlbnQgaW4gd2Vla3BsYW5uZXIuIEl0J3MgdGltZSB0byBkZWxldGUgdGhvc2UgdGhhdCBtYXRjaGVkIHVzLlxyXG4gICAgICBhd2FpdCB1c2VyVGFza3NSZXBvLmRlbGV0ZSh1c2VyVGFza3MubWFwKHQgPT4gdC5pZCkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7bGVhcm5pbmdUYXNrc30gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgdXNlclRhc2tzID0gYXJyYXlUb01hcCh0aGlzLnN0YXRlLnVzZXJUYXNrcywgdXQgPT4gdXQudGFzayAmJiB1dC50YXNrLmxlbmd0aCA+IDAgP1xyXG4gICAgICB1dC50YXNrLm1hcCh0ID0+IHQuaWQpWzBdIDogLy8gY291cnNlLWJ1aWxkZXIgdGFza3MgbG9va2VkIHVwIGJ5IGlkXHJcbiAgICAgIHV0LnNpdGVWaXNpb25QYWdlSWQgPyB1dC5zaXRlVmlzaW9uUGFnZUlkIDogLy8gbm9uLWNvdXJzZS1idWlsZGVyIHRhc2tzXHJcbiAgICAgIHV0LnVybCk7XHJcbiAgICBjb25zdCB7Y29uZmlybWF0aW9uc30gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3Qgd2Vla1BsYW5uZXJXZWVrID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcclxuICAgIGNvbnN0IGN1cnJlbnRXZWVrID0gbW9tZW50KCkud2VlaygpO1xyXG4gICAgY29uc3QgZm9yV2Vla1N0cmluZyA9IHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgPyBcIlwiIDpcclxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgKyAxID8gTGBmw7ZyIG7DpHN0YSB2ZWNrYSAodiR7d2Vla1BsYW5uZXJXZWVrfSlgIDpcclxuICAgIHdlZWtQbGFubmVyV2VlayA9PT0gY3VycmVudFdlZWsgLSAxID8gTGBmw7ZyIGbDtnJyYSB2ZWNrYW4gKHYke3dlZWtQbGFubmVyV2Vla30pYCA6XHJcbiAgICBMYGbDtnIgdmVja2EgJHt3ZWVrUGxhbm5lcldlZWt9YDtcclxuXHJcbiAgICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcbiAgICAgIHtsZWFybmluZ1Rhc2tzLm1hcCgobGVhcm5pbmdUYXNrLCBpZHgpID0+IHtcclxuICAgICAgICBjb25zdCB0YXNrTG9va3VwSWQgPSBsZWFybmluZ1Rhc2suaWQ7XHJcbiAgICAgICAgY29uc3QgdXNlclRhc2sgPSB1c2VyVGFza3NbdGFza0xvb2t1cElkXSB8fCB7JG1ldGE6ICdkZWxldGVkJ30gYXMgUGFydGlhbDxVc2VyVGFzaz47IC8vIE5vIGV4aXN0ID0gJG1ldGE6ICdkZWxldGVkJ1xyXG4gICAgICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJztcclxuICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHVzZXJUYXNrLiRtZXRhICE9PSAnZGVsZXRlZCcgJiYgdXNlclRhc2suJG1ldGEgIT09ICdkZWxldGluZyc7XHJcbiAgICAgICAgY29uc3QgZGVzY3JpYmVkQWN0aW9uID0gc2VsZWN0ZWQgP1xyXG4gICAgICAgICAgICAgICAgICBMYFRhIGJvcnQgdXBwZ2lmdGVuIGZyw6VuIGVnZW4gdmVja29wbGFuZXJpbmcgJHtmb3JXZWVrU3RyaW5nfWAgOlxyXG4gICAgICAgICAgICAgICAgICBMYEzDpGdnIHRpbGwgdXBwZ2lmdGVuIGkgZWdlbiB2ZWNrb3BsYW5lcmluZyAke2ZvcldlZWtTdHJpbmd9YDtcclxuICAgICAgICBjb25zdCBjb25maXJtYXRpb25WaXNpYmxlID1cclxuICAgICAgICAgIGNvbmZpcm1hdGlvbnMuc29tZSh0aWQgPT4gdGFza0xvb2t1cElkID09PSB0aWQpO1xyXG5cclxuICAgICAgICByZXR1cm4gPGRpdiBrZXk9e2xlYXJuaW5nVGFzay5pZH0+PGRpdiBrZXk9e3Rhc2tMb29rdXBJZH0gY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BzZWxlY3RlZEJveCR7c2VsZWN0ZWQgPyAnIHNlbGVjdGVkJyA6ICcnfWB9XHJcbiAgICAgICAgICAgICAgICBzdHlsZT17aXNXb3JraW5nID8ge29wYWNpdHk6IDAuNX06IHt9fVxyXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCk9PiFpc1dvcmtpbmcgJiYgd2Vla1BsYW5uZXJXZWVrID09PSBjdXJyZW50V2VlayA/XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFzayhsZWFybmluZ1Rhc2spIDpcclxuICAgICAgICAgICAgICAgICAgY29uZmlybWF0aW9uVmlzaWJsZSA/IFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2NvbmZpcm1hdGlvbnM6IGNvbmZpcm1hdGlvbnMuZmlsdGVyKHRpZCA9PiB0aWQgIT09IHRhc2tMb29rdXBJZCl9KSA6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y29uZmlybWF0aW9uczogWy4uLmNvbmZpcm1hdGlvbnNdLmNvbmNhdCh0YXNrTG9va3VwSWQpfSl9XHJcbiAgICAgICAgICAgICAgICB0aXRsZT17ZGVzY3JpYmVkQWN0aW9ufT5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPGEgaHJlZj17bGVhcm5pbmdUYXNrLnVybH0+e2xlYXJuaW5nVGFzay5uYW1lfTwvYT5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDxDb25maXJtYXRpb25cclxuICAgICAgICAgICAgdmlzaWJsZT17Y29uZmlybWF0aW9uVmlzaWJsZX1cclxuICAgICAgICAgICAgdGV4dD17ZGVzY3JpYmVkQWN0aW9ufVxyXG4gICAgICAgICAgICBvbkNvbmZpcm09eygpPT57XHJcbiAgICAgICAgICAgICAgdGhpcy50b2dnbGVUYXNrKGxlYXJuaW5nVGFzayk7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7Y29uZmlybWF0aW9uczogY29uZmlybWF0aW9ucy5maWx0ZXIodGlkID0+IHRpZCAhPT0gdGFza0xvb2t1cElkKX0pO1xyXG4gICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICBvbkNhbmNlbD17KCk9PntcclxuICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjb25maXJtYXRpb25zOiBjb25maXJtYXRpb25zLmZpbHRlcih0aWQgPT4gdGlkICE9PSB0YXNrTG9va3VwSWQpfSk7XHJcbiAgICAgICAgICAgIH19IC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgfVxyXG4gICAgICApfVxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7Q291cnNlTW9kdWxlLCBDb3Vyc2V9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEluY2x1ZGVkSWRzIChtb2R1bGU6IENvdXJzZU1vZHVsZSwgY291cnNlOiBDb3Vyc2UpIHtcclxuICBjb25zdCByZXN1bHQgPSB7fTtcclxuICBjb3Vyc2UudGFza3MuZmlsdGVyKHQgPT4gbW9kdWxlLnRhc2tJZHMuaW5kZXhPZih0LmlkKSAhPT0gLTEpLmZvckVhY2godGFzayA9PiB7XHJcbiAgICB0YXNrLmFiaWxpdGllcy5mb3JFYWNoKCh7aWR9KSA9PiByZXN1bHRbaWRdID0gdHJ1ZSk7XHJcbiAgICB0YXNrLmNlbnRyYWxDb250ZW50LmZvckVhY2goKHtpZH0pID0+IHJlc3VsdFtpZF0gPSB0cnVlKTtcclxuICAgIHRhc2sua25vd2xlZGdlUmVxdWlyZW1lbnRzLmZvckVhY2goKHtpZH0pID0+IHJlc3VsdFtpZF0gPSB0cnVlKTtcclxuICB9KTtcclxuICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbiIsImxldCBpbml0aWFsaXplZCA9IGZhbHNlO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRNYW51YWxTY3JvbGxSZXN0b3JhdGlvbigpIHtcclxuICBpZiAoIWluaXRpYWxpemVkKSB7XHJcbiAgICBpbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldiA9PiB7XHJcbiAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQudGFnTmFtZSA9PT0gJ0EnKSB7XHJcbiAgICAgICAgaGlzdG9yeS5yZXBsYWNlU3RhdGUoeyBwYWdlWU9mZnNldDogd2luZG93LnBhZ2VZT2Zmc2V0IH0sIG51bGwsIG51bGwpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGlmIChoaXN0b3J5LnNjcm9sbFJlc3RvcmF0aW9uKSBoaXN0b3J5LnNjcm9sbFJlc3RvcmF0aW9uID0gJ21hbnVhbCc7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVzdG9yZVNjcm9sbFBvc2l0aW9uICh7ZmFsbGJhY2tTY3JvbGxQb3NpdGlvbn0pIHtcclxuICBpZiAoaGlzdG9yeS5zdGF0ZSAmJiBoaXN0b3J5LnN0YXRlLnBhZ2VZT2Zmc2V0ICE9PSB1bmRlZmluZWQpIHtcclxuICAgIHdpbmRvdy5zY3JvbGxUbygwLCBoaXN0b3J5LnN0YXRlLnBhZ2VZT2Zmc2V0KTtcclxuICB9IGVsc2UgaWYgKGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgd2luZG93LnNjcm9sbFRvKDAsIGZhbGxiYWNrU2Nyb2xsUG9zaXRpb24pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IENvdXJzZUJhbm5lciB9IGZyb20gXCIuLi9jb3Vyc2Utdmlld2VyL2NvdXJzZS1wYWdlL2NvdXJzZS1iYW5uZXJcIjtcclxuaW1wb3J0IHsgTGlzdENvdXJzZXMgfSBmcm9tICcuL2xpc3QtY291cnNlcyc7XHJcbmltcG9ydCB7IEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIExpc3RDb3Vyc2VzUGFnZSgpIHtcclxuICByZXR1cm4gPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldFwiPlxyXG4gICAgPENvdXJzZUJhbm5lclxyXG4gICAgICB0aXRsZT17ZW52LmN1cnJlbnRVc2VyLnNjaG9vbH1cclxuICAgICAgYmFja2dyb3VuZEltYWdlPVwiXCJcclxuICAgICAgdGFicz17W3sgbmFtZTogXCJTa29sYW5zIGt1cnNlclwiLCBsaW5rOiBcIiNcIiB9XX1cclxuICAgICAgYWN0aXZlVGFiPXtcIiNcIn1cclxuICAgIC8+XHJcbiAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LXJvdyBzdi1sYXlvdXRcIj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1sYXlvdXQgc3Ytc2tpcC1zcGFjZXIgc3YtY29sdW1uLTEyXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1zcGFjZXItMjBweHZ0IHN2LXZlcnRpY2FsIHN2LWxheW91dCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgICAgPExpc3RDb3Vyc2VzIC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgPC9kaXY+XHJcbn0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IENvdXJzZSwgU2Nob29sLCBVc2VySGlkZGVuQ291cnNlIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCB7IHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AsIHNob3dJbmZvLCBMIH0gZnJvbSBcIi4uLy4uL3V0aWxzL3V0aWxzXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi4vY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiO1xyXG5pbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nIH0gZnJvbSBcIi4uLy4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xyXG5pbXBvcnQgeyBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSB9IGZyb20gJy4uLy4uL2FjY2Vzcy1jb250cm9sL2luZGV4JztcclxuaW1wb3J0IHsgaGlkZGVuQ291cnNlc1JlcG8sIENvdXJzZVdpdGhIaWRkZW5TdGF0ZSB9IGZyb20gJy4uLy4uL3JlcG9zL2hpZGRlbi1jb3Vyc2VzLXJlcG8nO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBpc0xvYWRpbmc6IGJvb2xlYW5cclxuICBjb3Vyc2VzOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXVxyXG4gIGhlYWRlck9wZW46IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIExpc3RDb3Vyc2VzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBpc0xvYWRpbmc6IHRydWUsXHJcbiAgICAgIGNvdXJzZXM6IFtdLFxyXG4gICAgICBoZWFkZXJPcGVuOiBmYWxzZVxyXG4gICAgfTtcclxuICAgIHRoaXMudXBkYXRlSGlkZGVuQ291cnNlcyA9IHRoaXMudXBkYXRlSGlkZGVuQ291cnNlcy5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xyXG4gICAgaGlkZGVuQ291cnNlc1JlcG8uc3Vic2NyaWJlKHRoaXMudXBkYXRlSGlkZGVuQ291cnNlcywge2Z1bGxDb3Vyc2U6IHRydWV9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgaGlkZGVuQ291cnNlc1JlcG8udW5zdWJzY3JpYmUodGhpcy51cGRhdGVIaWRkZW5Db3Vyc2VzKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUhpZGRlbkNvdXJzZXMoY291cnNlczogQ291cnNlV2l0aEhpZGRlblN0YXRlW10pIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoe2NvdXJzZXMsIGlzTG9hZGluZzogZmFsc2V9KTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGhpZGVDb3Vyc2UoY291cnNlOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUpIHtcclxuICAgIHNob3dJbmZvKExgU3BhcmFyLi4uYCk7XHJcbiAgICBhd2FpdCBoaWRkZW5Db3Vyc2VzUmVwby5oaWRlQ291cnNlKGNvdXJzZSk7XHJcbiAgICBzaG93SW5mbyhcIlwiKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNob3dDb3Vyc2UoY291cnNlOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUpIHtcclxuICAgIHNob3dJbmZvKExgU3BhcmFyLi4uYCk7XHJcbiAgICBhd2FpdCBoaWRkZW5Db3Vyc2VzUmVwby5zaG93Q291cnNlKGNvdXJzZSk7XHJcbiAgICBzaG93SW5mbyhcIlwiKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGlmICh0aGlzLnN0YXRlLmlzTG9hZGluZykgcmV0dXJuIDxTcGlubmVyIC8+O1xyXG4gICAgY29uc3Qge2NvdXJzZXN9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHZpc2libGVDb3Vyc2VzID0gY291cnNlcy5maWx0ZXIoY291cnNlID0+IGNvdXJzZS52aXNpYmxlKTtcclxuICAgIGNvbnN0IGhpZGRlbkNvdXJzZXMgPSBjb3Vyc2VzLmZpbHRlcihjb3Vyc2UgPT4gIWNvdXJzZS52aXNpYmxlKTtcclxuICAgIGNvbnN0IHF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvbi5zZWFyY2gpO1xyXG4gICAgY29uc3Qgdmlld0NvdXJzZVVybCA9IGNmZy5LRURfQ09VUlNFX1ZJRVdFUl9VUkw7XHJcblxyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwia2VkX2JveGVkXCI+XHJcbiAgICAgIDxoMz5Ta29sYW5zIGt1cnNlcjwvaDM+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGFza0NvbnRhaW5lciBvZGQtZXZlblwiPlxyXG4gICAgICAgIHt2aXNpYmxlQ291cnNlcy5tYXAoY291cnNlID0+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0dWRlbnRDb3Vyc2VcIiBrZXk9e2NvdXJzZS5pZH0+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHB1bGwtcmlnaHRcIj5cclxuICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImhpZGVJdGVtXCIgb25DbGljaz17KCkgPT4gdGhpcy5oaWRlQ291cnNlKGNvdXJzZSl9IC8+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgIDxhIGhyZWY9e3ByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KHZpZXdDb3Vyc2VVcmwsIHtjb3Vyc2VJZDogY291cnNlLmlkfSl9Pntjb3Vyc2UubmFtZX08L2E+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInNtYWxsXCI+e2NvdXJzZS5kZXNjcmlwdGlvbn08L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+KX1cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT17XCJvcGVuQ2xvc2VcIiArICh0aGlzLnN0YXRlLmhlYWRlck9wZW4gPyBcIiBvcGVuXCIgOiBcIlwiKX0+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyXCIgb25DbGljaz17KCkgPT4gdGhpcy5zZXRTdGF0ZSh7IGhlYWRlck9wZW46ICF0aGlzLnN0YXRlLmhlYWRlck9wZW4gfSl9PlxyXG4gICAgICAgICAgPGg1PkRvbGRhIGt1cnNlcjwvaDU+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuQ29udGVudFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyIG9kZC1ldmVuXCI+XHJcbiAgICAgICAgICAgIHtoaWRkZW5Db3Vyc2VzLm1hcChjb3Vyc2UgPT4gXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3R1ZGVudENvdXJzZVwiIGtleT17Y291cnNlLmlkfT5cclxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHB1bGwtcmlnaHRcIj5cclxuICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwic2hvd0l0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnNob3dDb3Vyc2UoY291cnNlKX0+PC9hPlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8YSBocmVmPXtnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHsuLi5xdWVyeSwgY291cnNlSWQ6IGNvdXJzZS5pZH0pfT57Y291cnNlLm5hbWV9PC9hPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJzbWFsbFwiPntjb3Vyc2UuZGVzY3JpcHRpb259PC9wPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuZXhwb3J0IGNvbnN0IExhbmd1YWdlQ29udGV4dCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQoe2ludGw6IG51bGx9KTsiLCJpbXBvcnQge0ludGxQcm92aWRlciwgYWRkTG9jYWxlRGF0YX0gZnJvbSAncmVhY3QtaW50bCc7XHJcbmltcG9ydCBsb2NhbGVfZW4gZnJvbSAncmVhY3QtaW50bC9sb2NhbGUtZGF0YS9lbic7XHJcbmltcG9ydCBsb2NhbGVfc3YgZnJvbSAncmVhY3QtaW50bC9sb2NhbGUtZGF0YS9zdic7XHJcbmltcG9ydCBtZXNzYWdlc19zdiBmcm9tIFwiLi4vLi4vdHJhbnNsYXRpb25zL3N2Lmpzb25cIjtcclxuaW1wb3J0IG1lc3NhZ2VzX2VuIGZyb20gXCIuLi8uLi90cmFuc2xhdGlvbnMvZW4uanNvblwiO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5cclxuZXhwb3J0IGNvbnN0IHNldHVwSW50bCA9IDxQIGV4dGVuZHMgb2JqZWN0PihDb21wb25lbnQ6IFJlYWN0LkNvbXBvbmVudFR5cGU8UD4pID0+XHJcbiAgICBjbGFzcyBfU2V0dXBMYW5ndWFnZUludGwgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UD57XHJcbiAgICAgICAgbWVzc2FnZXMgOiBvYmplY3Q7XHJcblxyXG4gICAgICAgIGNvbnN0cnVjdG9yKHByb3BzKXtcclxuICAgICAgICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICAgICAgICBhZGRMb2NhbGVEYXRhKFsuLi5sb2NhbGVfZW4sLi4ubG9jYWxlX3N2XSk7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSB7XHJcbiAgICAgICAgICAgICdzdic6IG1lc3NhZ2VzX3N2LFxyXG4gICAgICAgICAgICAnZW4nOiBtZXNzYWdlc19lblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtb21lbnQoKS5sb2NhbGUoY2ZnLktFRF9MT0NBTEUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmVuZGVyKCl7XHJcbiAgICAgICAgICAgIHJldHVybiA8SW50bFByb3ZpZGVyIGxvY2FsZT17Y2ZnLktFRF9MT0NBTEV9IG1lc3NhZ2VzPXt0aGlzLm1lc3NhZ2VzW2NmZy5LRURfTE9DQUxFXX0+XHJcbiAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi50aGlzLnByb3BzIGFzIFB9IC8+XHJcbiAgICAgICAgICAgIDwvSW50bFByb3ZpZGVyPlxyXG4gICAgICAgIH1cclxuICAgIH0iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFJlbW92ZUl0ZW0gfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XHJcbmltcG9ydCB7IGZpbmRET01Ob2RlIH0gZnJvbSAncmVhY3QtZG9tJztcclxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgZGlhbG9nczogUmVhY3QuQ29tcG9uZW50W107XHJcbiAgcG9wRGlhbG9nOiAoKT0+dm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIERpYWxvZ3MgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBsYXN0RGl2OiBIVE1MRGl2RWxlbWVudCB8IG51bGw7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wczogUHJvcHMpIHtcclxuICAgIGlmICh0aGlzLmxhc3REaXYgIT09IG51bGwgJiYgcHJldlByb3BzLmRpYWxvZ3MubGVuZ3RoID4gdGhpcy5wcm9wcy5kaWFsb2dzLmxlbmd0aCkge1xyXG4gICAgICAvLyBBIGRpYWxvZyB3YXMgY2xvc2VkLiBOb3cgZm9jdXMgdGhlIGxhc3QgZGlhbG9nOlxyXG4gICAgICAkKGZpbmRET01Ob2RlKHRoaXMubGFzdERpdikpLmZpbmQoJzppbnB1dCcpLmZpcnN0KCkuZm9jdXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlciAoKSB7XHJcbiAgICB0aGlzLmxhc3REaXYgPSBudWxsO1xyXG4gICAgY29uc3Qge2RpYWxvZ3MsIHBvcERpYWxvZ30gPSB0aGlzLnByb3BzO1xyXG4gICAgJCgnYm9keScpLmF0dHIoJ2FyaWEtZGlzYWJsZWQnLCBkaWFsb2dzLmxlbmd0aCA+IDApO1xyXG4gICAgJCgnYm9keScpLmNzcygnb3ZlcmZsb3cnLCBkaWFsb2dzLmxlbmd0aCA+IDAgPyAnaGlkZGVuJyA6ICdhdXRvJyk7XHJcblxyXG4gICAgcmV0dXJuIGRpYWxvZ3MubGVuZ3RoID4gMCAmJiA8ZGl2PlxyXG4gICAgICB7ZGlhbG9ncy5tYXAoKGRpYWxvZywgaWR4KSA9PiB7XHJcbiAgICAgICAgbGV0IGRpdjogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICAgICAgZnVuY3Rpb24gb25LZXlQcmVzcyhldjogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MRGl2RWxlbWVudD4pIHtcclxuICAgICAgICAgIGlmIChldi53aGljaCA9PT0gMTMgJiYgKCFldi50YXJnZXQgfHwgKGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudCkudGFnTmFtZSAhPT0gJ1RFWFRBUkVBJykpIHtcclxuICAgICAgICAgICAgJChmaW5kRE9NTm9kZShkaXYpKS5maW5kKCcuYnRuLWRlZmF1bHQnKS5jbGljaygpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uS2V5RG93bihldikge1xyXG4gICAgICAgICAgaWYgKGV2LndoaWNoID09PSAyNykgeyAvLyBFc2NhcGVcclxuICAgICAgICAgICAgcG9wRGlhbG9nKCk7XHJcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDgzICYmIChldi5jdHJsS2V5IHx8IGV2Lm1ldGFLZXkpKSB7IC8vIENUUkwtU1xyXG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlID0gZmluZERPTU5vZGUoZGl2KTtcclxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgY29uc3QgZGVmYXVsdEJ1dHRvbiA9ICQoZG9tTm9kZSkuZmluZCgnLmJ0bi1kZWZhdWx0Jyk7XHJcbiAgICAgICAgICAgIGRlZmF1bHRCdXR0b24uY2xpY2soKTtcclxuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiA8ZGl2IGtleT17aWR4fT5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkYXJrZW5cIiAvPlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1vZGFsLXBhZ2Utd3JhcFwiPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtcGFnZVwiIHJlZj17ZWxlbSA9PiB7XHJcbiAgICAgICAgICBkaXYgPSBlbGVtO1xyXG4gICAgICAgICAgaWYgKGlkeCA9PT0gZGlhbG9ncy5sZW5ndGggLSAxKSB0aGlzLmxhc3REaXYgPSBlbGVtO1xyXG4gICAgICAgIH19XHJcbiAgICAgICAgICAgIHRhYkluZGV4PXswfVxyXG4gICAgICAgICAgICBhcmlhLWRpc2FibGVkPXtpZHggPCBkaWFsb2dzLmxlbmd0aCAtIDF9XHJcbiAgICAgICAgICAgIG9uS2V5UHJlc3M9e29uS2V5UHJlc3N9XHJcbiAgICAgICAgICAgIG9uS2V5RG93bj17b25LZXlEb3dufT5cclxuICAgICAgICAgIHtkaWFsb2d9XHJcbiAgICAgICAgICA8UmVtb3ZlSXRlbSBvbkNsaWNrPXtwb3BEaWFsb2d9IC8+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInN0b3BGbG9hdHNcIj48L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj59KX1cclxuICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgRm9ybUZpZWxkIH0gZnJvbSAnLi9mb3JtLWZpZWxkJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgbGFiZWw6IGFueTtcclxuICBpZDogc3RyaW5nO1xyXG4gIHZhbHVlOiBzdHJpbmc7XHJcbiAgcGxhY2Vob2xkZXI/OiBzdHJpbmc7XHJcbiAgYXV0b0ZvY3VzPzogYm9vbGVhbjtcclxuICBvbkNoYW5nZTogKHZhbHVlOiBzdHJpbmcpID0+IHZvaWQ7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0SW5wdXQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8Rm9ybUZpZWxkIGxhYmVsPXt0aGlzLnByb3BzLmxhYmVsfT5cclxuICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICA8aW5wdXQgdHlwZT1cInRleHRcIiBhdXRvRm9jdXM9e3RoaXMucHJvcHMuYXV0b0ZvY3VzfSBpZD17dGhpcy5wcm9wcy5pZH0gc2l6ZT17MzV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnByb3BzLm9uQ2hhbmdlKGV2LnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9IC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9Gb3JtRmllbGQ+XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBGb3JtRmllbGQgfSBmcm9tICcuL2Zvcm0tZmllbGQnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBsYWJlbDogYW55O1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgdmFsdWU6IHN0cmluZztcclxuICBwbGFjZWhvbGRlcj86IHN0cmluZztcclxuICBhdXRvRm9jdXM/OiBib29sZWFuO1xyXG4gIHJvd3M/OiBudW1iZXI7XHJcbiAgY2hpbGRyZW4/O1xyXG4gIG9uQ2hhbmdlOiAodmFsdWU6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRBcmVhRm9ybUZpZWxkIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17dGhpcy5wcm9wcy5sYWJlbH0gaWQ9e3RoaXMucHJvcHMuaWR9PlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPHRleHRhcmVhIGF1dG9Gb2N1cz17dGhpcy5wcm9wcy5hdXRvRm9jdXN9IGlkPXt0aGlzLnByb3BzLmlkfSBjb2xzPXszNX0gcm93cz17dGhpcy5wcm9wcy5yb3dzIHx8IDV9IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfVxyXG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtldiA9PiB0aGlzLnByb3BzLm9uQ2hhbmdlKGV2LnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9e3RoaXMucHJvcHMucGxhY2Vob2xkZXJ9IC8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIHshIXRoaXMucHJvcHMuY2hpbGRyZW4gJiYgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxyXG4gICAgICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cclxuICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9Gb3JtRmllbGQ+XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxuICBsYWJlbDogYW55O1xyXG4gIGNoaWxkcmVuOiBhbnk7XHJcbiAgaWQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbmRJZChub2RlKSB7XHJcbiAgY29uc3QgcmVjdWNoZWNrID0gbmV3IFNldCgpO1xyXG4gIHJldHVybiAoZnVuY3Rpb24gZmluZElkKG5vZGUpe1xyXG4gICAgaWYgKHR5cGVvZiBub2RlID09PSAnc3RyaW5nJykgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAocmVjdWNoZWNrLmhhcyhub2RlKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZWN1Y2hlY2suYWRkKG5vZGUpO1xyXG4gICAgaWYgKG5vZGUucHJvcHMpIHtcclxuICAgICAgaWYgKG5vZGUucHJvcHMuaWQpIHJldHVybiBub2RlLnByb3BzLmlkO1xyXG4gICAgICBpZiAobm9kZS5wcm9wcy5jaGlsZHJlbikge1xyXG4gICAgICAgIHJldHVybiBmaW5kSWQobm9kZS5wcm9wcy5jaGlsZHJlbik7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKG5vZGUubGVuZ3RoKSB7XHJcbiAgICAgIGZvciAobGV0IGk9MDtpPG5vZGUubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICBjb25zdCBjaGlsZCA9IG5vZGVbaV07XHJcbiAgICAgICAgaWYgKGNoaWxkKSB7XHJcbiAgICAgICAgICBjb25zdCBjaGlsZElkID0gZmluZElkKGNoaWxkKTtcclxuICAgICAgICAgIGlmIChjaGlsZElkKSByZXR1cm4gY2hpbGRJZDtcclxuICAgICAgICAgIC8vY29uc29sZS5sb2coY2hpbGQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pKG5vZGUpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRm9ybUZpZWxkIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzPiB7XHJcbiAgY29uc3RydWN0b3IgKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgcmV0dXJuIDw+XHJcbiAgICAgICAgPGxhYmVsIGNsYXNzTmFtZT1cImtjbGFiZWxcIiBodG1sRm9yPXt0aGlzLnByb3BzLmlkIHx8IGZpbmRJZCh0aGlzLnByb3BzLmNoaWxkcmVuKX0+e3RoaXMucHJvcHMubGFiZWx9PC9sYWJlbD5cclxuICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cclxuICAgIDwvPlxyXG4gIH1cclxufVxyXG4iLCIvKiBSRUZBQ1RPUjogTW92ZSB0aGlzIGNvbXBvbmVudCBvdXRzaWRlIGNvdXJzZWJ1aWxkZXIhXHJcbiAgIFRoaXMgaXMgYSBnZW5lcmFsLXB1cnBvc2UgY29tcG9uZW50XHJcbiovXHJcblxyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEdvYWxQcm9ncmVzcyB9IGZyb20gJy4uL2NoYXJ0cy9nb2FsLXByb2dyZXNzJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgdGl0bGU6IHN0cmluZyB8IEpTWC5FbGVtZW50O1xyXG4gIGNsYXNzTmFtZT86IHN0cmluZztcclxuICBoZWFkZXJDbGFzc05hbWU/OiBzdHJpbmc7XHJcbiAgY29udGVudENsYXNzTmFtZT86IHN0cmluZztcclxuICBoZWFkZXJPcGVuPzogYm9vbGVhbjtcclxuICBvbk9wZW5DbG9zZT86IChiZWNhbWVPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIGRpc3BsYXlQcm9ncmVzcz86IGJvb2xlYW47XHJcbiAgcHJvZ3Jlc3NEYXRhPzoge2NvbXBsZXRlZE51bWJlck9mVGFza3M6IG51bWJlciwgbnVtYmVyT2ZUYXNrczogbnVtYmVyfTtcclxuICBjaGlsZHJlbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBoZWFkZXJPcGVuOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgT3BlbkNsb3NlQm94IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLFN0YXRlPiB7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICBoZWFkZXJPcGVuOiBwcm9wcy5oZWFkZXJPcGVuIHx8IGZhbHNlXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyAobmV4dFByb3BzOiBQcm9wcykge1xyXG4gICAgaWYgKG5leHRQcm9wcy5oZWFkZXJPcGVuICE9PSB0aGlzLnByb3BzLmhlYWRlck9wZW4pIHtcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7aGVhZGVyT3BlbjogbmV4dFByb3BzLmhlYWRlck9wZW59KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgdGl0bGUsIGNsYXNzTmFtZSwgY2hpbGRyZW4sIGhlYWRlckNsYXNzTmFtZSwgY29udGVudENsYXNzTmFtZSwgZGlzcGxheVByb2dyZXNzLCBwcm9ncmVzc0RhdGEgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7IGhlYWRlck9wZW4gfSA9IHRoaXMuc3RhdGU7XHJcbiAgICAvL3ZhciBjdXJyZW50UHJvZ3Jlc3NEYXRhID0gLy9wcm9ncmVzc0RhdGEoKTtcclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17KGNsYXNzTmFtZXx8JycpICsgXCIgb3BlbkNsb3NlXCIgKyAoaGVhZGVyT3BlbiA/IFwiIG9wZW5cIiA6IFwiXCIpfT5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkhlYWRlclwiICsgKGhlYWRlckNsYXNzTmFtZSA/IFwiIFwiICsgaGVhZGVyQ2xhc3NOYW1lIDogXCJcIil9XHJcbiAgICAgICAgb25DbGljaz17KCkgPT4ge1xyXG4gICAgICAgICAgaWYgKHRoaXMucHJvcHMub25PcGVuQ2xvc2UpIHRoaXMucHJvcHMub25PcGVuQ2xvc2UoIXRoaXMuc3RhdGUuaGVhZGVyT3Blbik7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgaGVhZGVyT3BlbjogIXRoaXMuc3RhdGUuaGVhZGVyT3BlbiB9KTtcclxuICAgICAgICB9fSA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJvcGVuSGVhZGVyQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICA8ZGl2Pnt0aXRsZX08L2Rpdj5cclxuICAgICAgICAgIHtkaXNwbGF5UHJvZ3Jlc3MgJiYgPEdvYWxQcm9ncmVzcyB7Li4ucHJvZ3Jlc3NEYXRhfS8+fVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9e1wib3BlbkNvbnRlbnRcIiArIChjb250ZW50Q2xhc3NOYW1lID8gXCIgXCIgKyBjb250ZW50Q2xhc3NOYW1lIDogXCJcIil9PlxyXG4gICAgICAgIHtjaGlsZHJlbn1cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj47XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgbGVhcm5pbmdHb2FsPzogc3RyaW5nO1xyXG4gIG9uU2F2ZTogKGxlYXJuaW5nR29hbDogc3RyaW5nKSA9PiB2b2lkO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGxlYXJuaW5nR29hbDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWRkQ3VzdG9tR29hbCBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKVxyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgbGVhcm5pbmdHb2FsOiBwcm9wcy5sZWFybmluZ0dvYWwgfHwgJydcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtsZWFybmluZ0dvYWx9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHtvblNhdmV9ID0gdGhpcy5wcm9wcztcclxuICAgIHJldHVybiA8ZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgICAgICA8aDI+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxUaXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiTMOkZ2cgdGlsbCBlZ2V0IGzDpHJhbmRlbcOlbFwiLz48L2gyPlxyXG4gICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5hZGRMZWFybmluZ0dvYWxcIiBkZWZhdWx0TWVzc2FnZT1cIk3DpWxcIi8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtIHRvcFwiPlxyXG4gICAgICAgICAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIHRhYkluZGV4PXsxfSBzaXplPXs1MH0gYXV0b0ZvY3VzXHJcbiAgICAgICAgICAgICAgICB2YWx1ZT17bGVhcm5pbmdHb2FsfVxyXG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e2UgPT4gdGhpcy5zZXRTdGF0ZSh7bGVhcm5pbmdHb2FsOiBlLnRhcmdldC52YWx1ZX0pfSAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3Agc3BhY2VkXCIgLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGJyIC8+PC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxyXG4gICAgICAgICAgb25DbGljaz17KCk9Pm9uU2F2ZShsZWFybmluZ0dvYWwpfT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCJzYXZlXCIvPjwvYnV0dG9uPlxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gIH1cclxufVxyXG5cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBUZXh0SW5wdXQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0LWlucHV0JztcclxuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XHJcbmltcG9ydCB7TGFuZ3VhZ2VDb250ZXh0fSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0JztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgaXNUYXNrOiBib29sZWFuXHJcbiAgb25TYXZlOiAobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCB1cmw6IHN0cmluZykgPT4gdm9pZDtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFkZEN1c3RvbVRhc2sgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcylcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIG5hbWU6ICcnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJycsXHJcbiAgICAgIHVybDogJydcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHVybCB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIGNvbnN0IHsgaXNUYXNrLCBvblNhdmUgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICByZXR1cm4gPGRpdj5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIDxoMj48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImN1c3RvbVRhc2suYWRkV29ya0dvYWxUaXRsZVwiIGRlZmF1bHRNZXNzYWdlPVwiTMOkZ2cgdGlsbCBlZ2V0IGFyYmV0c23DpWxcIi8+PC9oMj5cclxuICAgICAgICA8aHIgLz5cclxuICAgICAgICA8VGV4dElucHV0XHJcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLm5hbWVMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOiAnTmFtbid9KX1cclxuICAgICAgICAgIGlkPVwiQWRkQ3VzdG9tVGFzazpuYW1lXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPXtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidjdXN0b21UYXNrLmVudGVyTmFtZVBsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ0FuZ2UgbmFtbi4uLid9KX1cclxuICAgICAgICAgIHZhbHVlPXtuYW1lfVxyXG4gICAgICAgICAgYXV0b0ZvY3VzXHJcbiAgICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XHJcblxyXG4gICAgICAgIDxUZXh0QXJlYUZvcm1GaWVsZFxyXG4gICAgICAgICAgcm93cz17N31cclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonQmVza3Jpdm5pbmcnfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZEN1c3RvbVRhc2s6ZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J2NvbW1vbi5hZGREZXNjcmlwdGlvblBsaGQnLCBkZWZhdWx0TWVzc2FnZTogXCJMw6RnZyB0aWxsIGVuIGJlc2tyaXZuaW5nLi4uXCJ9KX1cclxuICAgICAgICAgIHZhbHVlPXtkZXNjcmlwdGlvbn1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbj0+dGhpcy5zZXRTdGF0ZSh7ZGVzY3JpcHRpb259KX0gLz5cclxuXHJcbiAgICAgICAgPFRleHRJbnB1dFxyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidjb21tb24ubGlua0xhYmVsJywgZGVmYXVsdE1lc3NhZ2U6J0zDpG5rJ30pfSBcclxuICAgICAgICAgIGlkPVwiQWRkQ3VzdG9tVGFzazp1cmxcIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJodHRwOi8vd3d3Li4uXCJcclxuICAgICAgICAgIHZhbHVlPXt1cmx9XHJcbiAgICAgICAgICBvbkNoYW5nZT17dXJsID0+IHRoaXMuc2V0U3RhdGUoe3VybH0pfSAvPlxyXG5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3YtaHRtbC1wb3J0bGV0IHN2LXBvcnRsZXRcIj5cclxuICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICB0YWJJbmRleD17MX1cclxuICAgICAgICAgIGNsYXNzTmFtZT1cImJ0biBidG4tbGFyZ2UgYnRuLWRlZmF1bHRcIlxyXG4gICAgICAgICAgb25DbGljaz17KCkgPT4gb25TYXZlKG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwpfT48Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCJTcGFyYVwiLz48L2J1dHRvbj5cclxuICAgICAgPC9kaXY+XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgVGV4dElucHV0IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dC1pbnB1dCc7XHJcbmltcG9ydCB7IFRleHRBcmVhRm9ybUZpZWxkIH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL2Zvcm0tZmllbGQtdGV4dGFyZWEnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrc1JlcG8gfSBmcm9tICcuLi8uLi9yZXBvcy91c2VyLXRhc2tzLXJlcG8nO1xyXG5pbXBvcnQge0Zvcm1hdHRlZE1lc3NhZ2V9IGZyb20gJ3JlYWN0LWludGwnO1xyXG5pbXBvcnQge0xhbmd1YWdlQ29udGV4dH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XHJcblxyXG50eXBlIFByb3BzID0ge1xyXG4gIC8vIEVkaXQgTW9kZVxyXG4gIG1vZGU6ICdhZGQnO1xyXG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcclxuICBjbG9zZURpYWxvZztcclxuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXHJcbn0gfCB7XHJcbiAgbW9kZTogJ2VkaXQnO1xyXG4gIHVzZXJUYXNrOiBVc2VyVGFzaztcclxuICBzdWJUYXNrOiBVc2VyU3ViVGFzaztcclxuICBjbG9zZURpYWxvZzogKCk9PnZvaWQ7XHJcbiAgdXNlclRhc2tzUmVwbzogVXNlclRhc2tzUmVwb1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIHVybDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWRkT3JFZGl0U3ViVGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIHN0YXRpYyBjb250ZXh0VHlwZSA9IExhbmd1YWdlQ29udGV4dDtcclxuICBjb25zdHJ1Y3RvciAocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XHJcbiAgICAgIGNvbnN0IHtzdWJUYXNrfSA9IHByb3BzO1xyXG4gICAgICB0aGlzLnN0YXRlID0ge1xyXG4gICAgICAgIG5hbWU6IHN1YlRhc2submFtZSB8fCAnJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogc3ViVGFzay5kZXNjcmlwdGlvbiB8fCAnJyxcclxuICAgICAgICB1cmw6IHN1YlRhc2sudXJsIHx8ICcnXHJcbiAgICAgIH07XHJcbiAgICB9IGVsc2UgeyAgXHJcbiAgICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICcnLFxyXG4gICAgICAgIHVybDogJydcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNhdmUoKSB7XHJcbiAgICAvLyBVcGRhdGUgcmVwbzpcclxuICAgIGNvbnN0IHtwcm9wc30gPSB0aGlzO1xyXG4gICAgY29uc3Qge3VzZXJUYXNrLCBjbG9zZURpYWxvZywgdXNlclRhc2tzUmVwb30gPSBwcm9wcztcclxuICAgIGNvbnN0IHtuYW1lLCBkZXNjcmlwdGlvbiwgdXJsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBpZiAocHJvcHMubW9kZSA9PT0gJ2VkaXQnKSB7XHJcbiAgICAgIC8vIEVkaXQgZXhpc3Rpbmc6XHJcbiAgICAgIHVzZXJUYXNrc1JlcG8udXBkYXRlKFt1c2VyVGFza10sIHV0ID0+IHtcclxuICAgICAgICBjb25zdCB7c3ViVGFza3N9ID0gdXQ7XHJcbiAgICAgICAgaWYgKHN1YlRhc2tzKSB7XHJcbiAgICAgICAgICB1dC5zdWJUYXNrcyA9IHN1YlRhc2tzLm1hcChzdCA9PlxyXG4gICAgICAgICAgICBzdC5pZCA9PT0gcHJvcHMuc3ViVGFzay5pZCA/IHsuLi5zdCwgbmFtZSwgZGVzY3JpcHRpb24sIHVybH0gOlxyXG4gICAgICAgICAgICB7Li4uc3R9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBDcmVhdGUgbmV3IHRhc2tcclxuICAgICAgY29uc3QgbmV3U3ViVGFzayA9IHtcclxuICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgdXJsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBVcGRhdGUgcmVwbzpcclxuICAgICAgdXNlclRhc2tzUmVwby51cGRhdGUoW3VzZXJUYXNrXSwgdXQgPT4ge1xyXG4gICAgICAgIGlmICghdXQuc3ViVGFza3MpIHtcclxuICAgICAgICAgIHV0LnN1YlRhc2tzID0gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHV0LnN1YlRhc2tzID0gdXQuc3ViVGFza3MuY29uY2F0KG5ld1N1YlRhc2spO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDbG9zZSBkaWFsb2dcclxuICAgIGNsb3NlRGlhbG9nKCk7ICAgIFxyXG4gIH1cclxuXHJcbiAgZGVsZXRlKCkge1xyXG4gICAgLy8gVXBkYXRlIHJlcG86XHJcbiAgICBjb25zdCBwcm9wcyA9IHRoaXMucHJvcHM7ICBcclxuICAgIGlmIChwcm9wcy5tb2RlICE9PSAnZWRpdCcpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FuIG9ubHkgZGVsZXRlIGluIGVkaXQgbW9kZVwiKTtcclxuICAgIH1cclxuICAgIHByb3BzLnVzZXJUYXNrc1JlcG8udXBkYXRlKFtwcm9wcy51c2VyVGFza10sIHV0ID0+IHtcclxuICAgICAgaWYgKHV0LnN1YlRhc2tzKSB7XHJcbiAgICAgICAgdXQuc3ViVGFza3MgPSB1dC5zdWJUYXNrcy5maWx0ZXIodCA9PiB0LmlkICE9PSBwcm9wcy5zdWJUYXNrLmlkKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gQ2xvc2UgZGlhbG9nOlxyXG4gICAgcHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtuYW1lLCBkZXNjcmlwdGlvbiwgdXJsfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBjb25zdCB7cHJvcHN9ID0gdGhpcztcclxuICAgIGNvbnN0IGlzRWRpdE1vZGUgPSBwcm9wcy5tb2RlID09PSAnZWRpdCc7XHJcbiAgICBjb25zdCB7aW50bH0gPSB0aGlzLmNvbnRleHQ7XHJcbiAgICByZXR1cm4gPD5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzdi1odG1sLXBvcnRsZXQgc3YtcG9ydGxldCBzdi1za2lwLXNwYWNlclwiPlxyXG4gICAgICAgIDxoMj57aXNFZGl0TW9kZSA/IDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwiYWRkZWRpdHN1YnRhc2suZWRpdFN1YnRhc2tcIiBkZWZhdWx0TWVzc2FnZT0nUmVkaWdlcmEgdW5kZXJ1cHBnaWZ0Jy8+IDogPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5hZGRTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9J0zDpGdnIHRpbGwgdW5kZXJ1cHBnaWZ0Jy8+IH08L2gyPlxyXG4gICAgICAgIDxociAvPlxyXG4gICAgICAgIDxUZXh0SW5wdXRcclxuICAgICAgICAgIGF1dG9Gb2N1c1xyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOidhZGRlZGl0c3VidGFzay5uYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonVW5kZXJ1cHBnaWZ0ZW5zIG5hbW4nfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZFVzZXJTdWJUYXNrOm5hbWVcIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9XCJcIlxyXG4gICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUubmFtZX1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtuYW1lID0+IHRoaXMuc2V0U3RhdGUoe25hbWV9KX1cclxuICAgICAgICAgICAgLz5cclxuICAgICAgICA8VGV4dEFyZWFGb3JtRmllbGRcclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTonQmVza3Jpdm5pbmcnfSl9XHJcbiAgICAgICAgICBpZD1cIkFkZFVzZXJTdWJUYXNrOmRlc2NyaXB0aW9uXCJcclxuICAgICAgICAgIHJvd3M9ezd9XHJcbiAgICAgICAgICBwbGFjZWhvbGRlcj1cIlwiXHJcbiAgICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5kZXNjcmlwdGlvbn1cclxuICAgICAgICAgIG9uQ2hhbmdlPXtkZXNjcmlwdGlvbiA9PiB0aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfVxyXG4gICAgICAgICAgICAvPlxyXG4gICAgICAgIDxUZXh0SW5wdXRcclxuICAgICAgICAgIGxhYmVsPSB7aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOidMw6Ruayd9KX1cclxuICAgICAgICAgIGlkPVwiQWRkVXNlclN1YlRhc2s6dXJsXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiXCJcclxuICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnVybH1cclxuICAgICAgICAgIG9uQ2hhbmdlPXt1cmwgPT4gdGhpcy5zZXRTdGF0ZSh7dXJsfSl9XHJcbiAgICAgICAgICAgIC8+XHJcbiAgICAgICAgPGJyIC8+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0XCI+XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgcHJvcHMubW9kZSA9PT0gJ2VkaXQnICYmIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi13YXJuaW5nIGJ0bi1sYXJnZSBwdWxsLXJpZ2h0XCJcclxuICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+IHRoaXMuZGVsZXRlKCl9PlxyXG4gICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJhZGRlZGl0c3VidGFzay5kZWxldGVTdWJ0YXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IHVuZGVydXBwZ2lmdFwiLz48L2J1dHRvbj59XHJcbiAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgdGFiSW5kZXg9ezF9XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLnNhdmUoKX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwiU3BhcmFcIi8+PC9idXR0b24+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC8+XHJcbiAgfVxyXG59XHJcblxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgUmVuYW1lYWJsZVRleHQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvcmVuYW1lYWJsZS10ZXh0JztcclxuaW1wb3J0IHsgTCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IHsgZ2V0VGFza1R5cGUgfSBmcm9tICcuL2dldC10YXNrLXR5cGUnO1xyXG5pbXBvcnQgUmVhY3REYXRlUGlja2VyLCB7IFJlYWN0RGF0ZVBpY2tlclByb3BzIH0gZnJvbSAncmVhY3QtZGF0ZXBpY2tlcic7XHJcbmltcG9ydCAnLi4vLi4vZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlJztcclxuaW1wb3J0IHtUZXh0SW5wdXR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkLXRleHQtaW5wdXQnO1xyXG5pbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IEZvcm1GaWVsZCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9mb3JtLWZpZWxkJztcclxuaW1wb3J0IHsgQWRkT3JFZGl0U3ViVGFzayB9IGZyb20gJy4vYWRkLW9yLWVkaXQtc3ViLXRhc2snO1xyXG5pbXBvcnQgeyBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgdXBkYXRlIGZyb20gJ3JlYWN0LWFkZG9ucy11cGRhdGUnO1xyXG5pbXBvcnQgeyBVc2VyVGFza3NSZXBvIH0gZnJvbSAnLi4vLi4vcmVwb3MvdXNlci10YXNrcy1yZXBvJztcclxuaW1wb3J0IHsgVGV4dEFyZWFGb3JtRmllbGQgfSBmcm9tICcuLi91dGlsaXR5LWNvbXBvbmVudHMvZm9ybS1maWVsZC10ZXh0YXJlYSc7XHJcbmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gXCIuLi91dGlsaXR5LWNvbXBvbmVudHMvTGFuZ3VhZ2VDb250ZXh0XCJcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgdXNlclRhc2s6IFVzZXJUYXNrO1xyXG4gIG9uVXBkYXRlOiAodXBkYXRlcjogKHVzZXJUYXNrOiBVc2VyVGFzaykgPT4gdm9pZCkgPT4gdm9pZDtcclxuICBvbkRlbGV0ZTogKHVzZXJUYXNrSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuICBvcGVuRGlhbG9nOiAoZGlhbG9nKSA9PiB2b2lkO1xyXG4gIGNsb3NlRGlhbG9nOiAoKT0+dm9pZDtcclxuICB1c2VyVGFza3NSZXBvOiBVc2VyVGFza3NSZXBvXHJcbn1cclxuXHJcbmludGVyZmFjZSBTdGF0ZSB7XHJcbiAgdXNlclRhc2s6IFVzZXJUYXNrO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICBkZXNjcmlwdGlvbj86IHN0cmluZztcclxuICBkZWFkbGluZT86IHN0cmluZztcclxuICB1cmw6IHN0cmluZztcclxuICBzdWJUYXNrcz86IFVzZXJTdWJUYXNrW107XHJcbiAgc2hvd0NhbGVuZGFyPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVkaXRVc2VyVGFzayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGRhdGVQaWNrZXI6IGFueTtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgdXNlclRhc2s6IHByb3BzLnVzZXJUYXNrLFxyXG4gICAgICBuYW1lOiBwcm9wcy51c2VyVGFzay5uYW1lLFxyXG4gICAgICBkZXNjcmlwdGlvbjogcHJvcHMudXNlclRhc2suZGVzY3JpcHRpb24sXHJcbiAgICAgIHVybDogcHJvcHMudXNlclRhc2sudXJsLFxyXG4gICAgICBkZWFkbGluZTogcHJvcHMudXNlclRhc2suZGVhZGxpbmUsXHJcbiAgICAgIHN1YlRhc2tzOiBwcm9wcy51c2VyVGFzay5zdWJUYXNrc1xyXG4gICAgfVxyXG4gICAgdGhpcy5vblVzZXJUYXNrc0NoYW5nZWQgPSB0aGlzLm9uVXNlclRhc2tzQ2hhbmdlZC5iaW5kKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG8uc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIG9uVXNlclRhc2tzQ2hhbmdlZCh1c2VyVGFza3M6IFVzZXJUYXNrW10pIHtcclxuICAgIGNvbnN0IG15VXNlclRhc2sgPSB1c2VyVGFza3MuZmluZCh1dCA9PiB1dC5pZCA9PT0gdGhpcy5wcm9wcy51c2VyVGFzay5pZCk7XHJcbiAgICBpZiAoIW15VXNlclRhc2spIHtcclxuICAgICAgdGhpcy5wcm9wcy5jbG9zZURpYWxvZygpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgdXNlclRhc2s6IG15VXNlclRhc2ssXHJcbiAgICAgIHN1YlRhc2tzOiBteVVzZXJUYXNrLnN1YlRhc2tzXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgdGhpcy5wcm9wcy51c2VyVGFza3NSZXBvLnVuc3Vic2NyaWJlKHRoaXMub25Vc2VyVGFza3NDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIGlzTW9kaWZpZWQoKSB7XHJcbiAgICAvLyBEb24ndCBjb3VudCBzdWJ0YXNrIGNoYW5nZXMhIFRoZXkgbGl2ZSB0aGVpciBvd24gbGlmZSBhbmQgaXMgbWFpbnRhaW5lZFxyXG4gICAgLy8gaW4gYWRkLW9yLWVkaXQtc3ViLXRhc2sudHN4LiBSZWFzb246IFVzZXIgd291bGQgZXhwZWN0IGFkZGVkIC9lZGl0ZWQgc3VidGFza3NcclxuICAgIC8vIHRvIGJlIHBlcnNpc3RlZCByaWdodCBhd2F5LiBNYXkgY2xpY2sgYXdheSB0aGlzIGRpYWxvZy5cclxuICAgIC8vIEFsc28gcmVhc29uOiBDYW4gaW52b2tlIHRoYXQgZGlhbG9nIGJ5IGl0c2VsZiBmcm9tIG90aGVyIGNvbXBvbmVudHMuIEZyb20gV2Vla1BsYW5uZXJcclxuICAgIC8vIHdoZW4gY2xpY2tpbmcgdGhlIHN1YnRhc2sgZm9yIGV4YW1wbGUhXHJcblxyXG4gICAgY29uc3Qge2RlYWRsaW5lLCBkZXNjcmlwdGlvbiwgbmFtZSwgdXJsLCB1c2VyVGFza30gPSB0aGlzLnN0YXRlO1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZGVhZGxpbmUgIT09IHVzZXJUYXNrLmRlYWRsaW5lIHx8XHJcbiAgICAgIGRlc2NyaXB0aW9uICE9PSB1c2VyVGFzay5kZXNjcmlwdGlvbiB8fFxyXG4gICAgICBuYW1lICE9PSB1c2VyVGFzay5uYW1lIHx8XHJcbiAgICAgIHVybCAhPT0gdXNlclRhc2sudXJsKTtcclxuICB9XHJcblxyXG4gIGFkZFN1YlRhc2soKTogYW55IHtcclxuICAgIHRoaXMucHJvcHMub3BlbkRpYWxvZyg8QWRkT3JFZGl0U3ViVGFza1xyXG4gICAgICBtb2RlPVwiYWRkXCJcclxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XHJcbiAgICAgIGNsb3NlRGlhbG9nPXt0aGlzLnByb3BzLmNsb3NlRGlhbG9nfVxyXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XHJcbiAgICAvPik7XHJcbiAgfVxyXG5cclxuICBlZGl0U3ViVGFzayhzdWJUYXNrOiBVc2VyU3ViVGFzaykge1xyXG4gICAgdGhpcy5wcm9wcy5vcGVuRGlhbG9nKDxBZGRPckVkaXRTdWJUYXNrXHJcbiAgICAgIG1vZGU9XCJlZGl0XCJcclxuICAgICAgc3ViVGFzaz17c3ViVGFza31cclxuICAgICAgdXNlclRhc2s9e3RoaXMuc3RhdGUudXNlclRhc2t9XHJcbiAgICAgIGNsb3NlRGlhbG9nPXt0aGlzLnByb3BzLmNsb3NlRGlhbG9nfVxyXG4gICAgICB1c2VyVGFza3NSZXBvPXt0aGlzLnByb3BzLnVzZXJUYXNrc1JlcG99XHJcbiAgICAvPik7XHJcbiAgfVxyXG4gIFxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHVybCwgZGVhZGxpbmUsIHN1YlRhc2tzLCBzaG93Q2FsZW5kYXIsIHVzZXJUYXNrIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgeyBpZCwgY291cnNlTmFtZSB9ID0gdXNlclRhc2s7XHJcbiAgICBjb25zdCB7IG9uVXBkYXRlLCBvbkRlbGV0ZSB9ID0gdGhpcy5wcm9wcztcclxuICAgIGNvbnN0IGlzTW9kaWZpZWQgPSB0aGlzLmlzTW9kaWZpZWQoKTtcclxuXHJcbiAgICBjb25zdCB0YXNrVHlwZSA9IGdldFRhc2tUeXBlKHVzZXJUYXNrKTtcclxuICAgIGNvbnN0IGlzQ3VzdG9tVGFzayA9IHRhc2tUeXBlID09PSAnY3VzdG9tVGFzayc7XHJcbiAgICBjb25zdCBleHBpcmVkID0gbW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKSA8IG1vbWVudCgpO1xyXG4gICAgY29uc3Qge2ludGx9ID0gdGhpcy5jb250ZXh0O1xyXG5cclxuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImVkaXRUYXNrRGlhbG9nIHN2LWh0bWwtcG9ydGxldCBzdi1wb3J0bGV0IHN2LXNraXAtc3BhY2VyXCI+XHJcbiAgICAgIDxoMj57aXNDdXN0b21UYXNrID8gXHJcbiAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLmVkaXRXb3JrR29hbHNcIiBkZWZhdWx0TWVzc2FnZT0nUmVkaWdlcmEgYXJiZXRzbcOlbCcvPiA6IFxyXG4gICAgICAgIDxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwidGFzay5lZGl0VGFza1wiIGRlZmF1bHRNZXNzYWdlPSdSZWRpZ2VyYSB1cHBnaWZ0Jy8+fVxyXG4gICAgICA8L2gyPlxyXG4gICAgICA8aHIgLz5cclxuICAgICAgPFRleHRJbnB1dFxyXG4gICAgICAgIGF1dG9Gb2N1c1xyXG4gICAgICAgIGxhYmVsPXtpc0N1c3RvbVRhc2sgPyBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndGFzay50YXJnZXROYW1lTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTogJ0FyYmV0c23DpWxldHMgbmFtbid9KSAgOiBpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAndGFzay50YXNrTmFtZUxhYmVsJywgZGVmYXVsdE1lc3NhZ2U6ICdVcHBnaWZ0ZW5zIG5hbW4nfSl9XHJcbiAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6bmFtZVwiXHJcbiAgICAgICAgcGxhY2Vob2xkZXI9e2lzQ3VzdG9tVGFzayA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLndoYXRTaG91bGRZb3VEb1BsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ1ZhZCBza2EgZHUgZ8O2cmE/J30pIDogaW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2suZW50ZXJUYXNrTmFtZVBsaGQnLCBkZWZhdWx0TWVzc2FnZTogJ0FuZ2UgdXBwZ2lmdGVucyBuYW1uLi4uJ30pIH1cclxuICAgICAgICB2YWx1ZT17bmFtZX1cclxuICAgICAgICBvbkNoYW5nZT17bmFtZSA9PiB0aGlzLnNldFN0YXRlKHtuYW1lfSl9IC8+XHJcbiAgICAgIFxyXG4gICAgICB7aXNDdXN0b21UYXNrICYmIDw+XHJcbiAgICAgICAgPFRleHRBcmVhRm9ybUZpZWxkXHJcbiAgICAgICAgICByb3dzPXs1fVxyXG4gICAgICAgICAgbGFiZWw9IHtpbnRsLmZvcm1hdE1lc3NhZ2Uoe2lkOiAnY29tbW9uLmRlc2NyaXB0aW9uTGFiZWwnLCBkZWZhdWx0TWVzc2FnZTogJ0Jlc2tyaXZuaW5nJ30pfVxyXG4gICAgICAgICAgaWQ9XCJFZGl0VXNlclRhc2s6ZGVzY3JpcHRpb25cIlxyXG4gICAgICAgICAgcGxhY2Vob2xkZXI9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICdjb21tb24uYWRkRGVzY3JpcHRpb25QbGhkJywgZGVmYXVsdE1lc3NhZ2U6ICdMw6RnZyB0aWxsIGVuIGJlc2tyaXZuaW5nLi4uJ30pfVxyXG4gICAgICAgICAgdmFsdWU9e2Rlc2NyaXB0aW9ufVxyXG4gICAgICAgICAgb25DaGFuZ2U9e2Rlc2NyaXB0aW9uPT50aGlzLnNldFN0YXRlKHtkZXNjcmlwdGlvbn0pfSAvPlxyXG5cclxuICAgICAgICA8VGV4dElucHV0XHJcbiAgICAgICAgICBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDonY29tbW9uLmxpbmtMYWJlbCcsIGRlZmF1bHRNZXNzYWdlOlwiTMOkbmtcIn0pfVxyXG4gICAgICAgICAgaWQ9XCJFZHV0VXNlclRhc2s6dXJsXCJcclxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiaHR0cChzKTovLy4uLlwiXHJcbiAgICAgICAgICB2YWx1ZT17dXJsfVxyXG4gICAgICAgICAgb25DaGFuZ2U9e3VybCA9PiB0aGlzLnNldFN0YXRlKHt1cmx9KX0gPlxyXG5cclxuICAgICAgICA8L1RleHRJbnB1dD48Lz59XHJcblxyXG4gICAgICAgIDxGb3JtRmllbGQgbGFiZWw9e2ludGwuZm9ybWF0TWVzc2FnZSh7aWQ6ICd0YXNrLnNldERlYWRsaW5lJywgZGVmYXVsdE1lc3NhZ2U6ICdBbmdlIGRlYWRsaW5lJ30pfT5cclxuICAgICAgICAgIHsoZGVhZGxpbmUgfHwgc2hvd0NhbGVuZGFyKSA/XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICA8UmVhY3REYXRlUGlja2VyIHJlZj17ZWxlbSA9PiB0aGlzLmRhdGVQaWNrZXIgPSBlbGVtfVxyXG4gICAgICAgICAgICAgICAgICBpZD1cIkVkaXRVc2VyVGFzazpkZWFkbGluZVwiXHJcbiAgICAgICAgICAgICAgICAgIG5leHRNb250aEJ1dHRvbkxhYmVsPVwiXCIgXHJcbiAgICAgICAgICAgICAgICAgIHByZXZpb3VzTW9udGhCdXR0b25MYWJlbD1cIlwiIFxyXG4gICAgICAgICAgICAgICAgICBzaG93V2Vla051bWJlcnM9e3RydWV9XHJcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkPXtkZWFkbGluZSAmJiBtb21lbnQoZGVhZGxpbmUpLnRvRGF0ZSgpfVxyXG4gICAgICAgICAgICAgICAgICBhdXRvRm9jdXM9e3Nob3dDYWxlbmRhcn1cclxuICAgICAgICAgICAgICAgICAgZGF0ZUZvcm1hdD1cIllZWVktTU0tZGRcIlxyXG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2V4cGlyZWQgPyBcImV4cGlyZWRcIiA6IHVuZGVmaW5lZH1cclxuICAgICAgICAgICAgICAgICAgbG9jYWxlPXtpbnRsLmxvY2FsZX1cclxuICAgICAgICAgICAgICAgICAgcG9wcGVyUGxhY2VtZW50PXtpc0N1c3RvbVRhc2sgPyBcInRvcC1zdGFydFwiIDogXCJib3R0b20tc3RhcnRcIn1cclxuICAgICAgICAgICAgICAgICAgb25CbHVyPXsoKT0+dGhpcy5zZXRTdGF0ZSh7c2hvd0NhbGVuZGFyOiBmYWxzZX0pfVxyXG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dmFsdWU9PntcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgIGRlYWRsaW5lOiB2YWx1ZSAmJiBtb21lbnQodmFsdWUpLmZvcm1hdChcIllZWVktTU0tRERcIiksXHJcbiAgICAgICAgICAgICAgICAgICAgICBzaG93Q2FsZW5kYXI6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJkZWxldGVEYXRlXCIgaHJlZj1cIiNcIiB0aXRsZT17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2sucmVtb3ZlRGVhZGxpbmUnLCBkZWZhdWx0TWVzc2FnZTogJ1RhIGJvcnQgZGVhZGxpbmUnfSl9IG9uQ2xpY2s9e2V2PT57XHJcbiAgICAgICAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2RlYWRsaW5lOiBudWxsLCBzaG93Q2FsZW5kYXI6IGZhbHNlfSk7XHJcbiAgICAgICAgICAgICAgICB9fT48L2E+XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PiA6XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidG9wXCIgcmVmPXsoKT0+e3RoaXMuZGF0ZVBpY2tlciA9IG51bGx9fT5cclxuICAgICAgICAgICAgICAgIDxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGF0ZVBpY2tlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGF0ZVBpY2tlci5zZXRPcGVuKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dDYWxlbmRhcjogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtY2FsZW5kYXJcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnNldERlYWRsaW5lTGFiZWxcIiBkZWZhdWx0TWVzc2FnZT1cIkFuZ2UgZGVhZGxpbmUuLi5cIi8+XHJcbiAgICAgICAgICAgICAgPC9hPiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIDwvZGl2Pn1cclxuICAgICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICAgPEZvcm1GaWVsZCBsYWJlbD17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDogJ3Rhc2suc3ViVGFza3MnLCBkZWZhdWx0TWVzc2FnZTogJ1VuZGVydXBwZ2lmdGVyJ30pfSA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0YXNrQ29udGFpbmVyXCI+XHJcblxyXG4gICAgICAgICAgICAgIHtzdWJUYXNrcyAmJiBzdWJUYXNrcy5tYXAoc3ViVGFzayA9PiA8ZGl2IGtleT17c3ViVGFzay5pZH0gY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj48YVxyXG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKT0+dGhpcy5lZGl0U3ViVGFzayhzdWJUYXNrKX1cclxuICAgICAgICAgICAgICAgICAgaHJlZj1cIiNcIj57c3ViVGFzay5uYW1lfTwvYT48L2Rpdj5cclxuICAgICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRvcFwiPlxyXG4gICAgICAgICAgICA8YnV0dG9uIGlkPVwiRWRpdFVzZXJUYXNrOmFkZFN1YlRhc2tcIiBjbGFzc05hbWU9XCJidG5cIlxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpPT50aGlzLmFkZFN1YlRhc2soKX0+XHJcbiAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtcGx1c1wiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT4gPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLmFkZFN1YnRhc2tcIiBkZWZhdWx0TWVzc2FnZT1cIkzDpGdnIHRpbGwgdW5kZXJ1cHBnaWZ0XCIvPlxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICA8L0Zvcm1GaWVsZD5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJkaXZpZGVyIGxhcmdlXCIgLz5cclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbGlnbi1ob3Jpem9udGFsXCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsQnV0dG9uIHRvcFwiPlxyXG4gICAgICAgICAgPGJ1dHRvbiB0YWJJbmRleD17MX1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgICAgb25DbGljaz17KCk9PntcclxuICAgICAgICAgICAgICBpc01vZGlmaWVkID8gb25VcGRhdGUodXNlclRhc2sgPT4ge1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICB1c2VyVGFzay5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2sudXJsID0gdXJsO1xyXG4gICAgICAgICAgICAgICAgdXNlclRhc2suZGVhZGxpbmUgPSBkZWFkbGluZTtcclxuICAgICAgICAgICAgICB9KSA6IHRoaXMucHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgfX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZVwiIGRlZmF1bHRNZXNzYWdlPVwiU3BhcmFcIi8+IFxyXG4gICAgICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxCdXR0b24gdG9wXCI+XHJcbiAgICAgICAgICA8YnV0dG9uIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJidG5cIlxyXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xyXG4gICAgICAgICAgICAgIHRoaXMucHJvcHMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICAgICAgfX0+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uY2FuY2VsXCIgZGVmYXVsdE1lc3NhZ2U9XCJBdmJyeXRcIi8+PC9idXR0b24+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25maXJtIHRvcCBwdWxsLXJpZ2h0XCI+XHJcbiAgICAgICAgICA8YnV0dG9uXHJcbiAgICAgICAgICAgIHRhYkluZGV4PXsxfVxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLXdhcm5pbmdcIlxyXG4gICAgICAgICAgICBvbkNsaWNrPXsoKT0+e1xyXG4gICAgICAgICAgICAgIG9uRGVsZXRlKGlkKTtcclxuICAgICAgICAgICAgfX0+e2lzQ3VzdG9tVGFzayA/XHJcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnJlbW92ZVdvcmtHb2Fsc1wiIGRlZmF1bHRNZXNzYWdlPVwiVGEgYm9ydCBhcmJldHNtw6VsXCIvPiA6XHJcbiAgICAgICAgICAgICAgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ0YXNrLnJlbW92ZVRoaXNUYXNrXCIgZGVmYXVsdE1lc3NhZ2U9XCJUYSBib3J0IGRlbiBow6RyIHVwcGdpZnRlblwiLz5cclxuICAgICAgICAgIH08L2J1dHRvbj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICB7Lyo8ZGl2IGNsYXNzTmFtZT1cImJ0biBidG4td2FybmluZyBidG4tbGFyZ2UgcHVsbC1yaWdodFwiIG9uQ2xpY2s9e2V2ID0+IG9uRGVsZXRlKGlkKX0+XHJcbiAgICAgICAge0xgVGEgYm9ydCBhcmJldHNtw6VsYH08L2Rpdj5cclxuICAgICAge2lzTW9kaWZpZWQgJiZcclxuICAgICAgICA8ZGl2XHJcbiAgICAgICAgICBjbGFzc05hbWU9XCJidG4gYnRuLWxhcmdlIGJ0bi1kZWZhdWx0XCJcclxuICAgICAgICAgIHRhYkluZGV4PXswfVxyXG4gICAgICAgICAgb25DbGljaz17KCk9Pm9uVXBkYXRlKHVzZXJUYXNrID0+IHtcclxuICAgICAgICAgICAgdXNlclRhc2submFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgIHVzZXJUYXNrLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgIHVzZXJUYXNrLnVybCA9IHVybDtcclxuICAgICAgICAgIH0pfT4gU3BhcmE8L2Rpdj59Ki99XHJcbiAgICA8L2Rpdj5cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IFVzZXJUYXNrIH0gZnJvbSBcImtlZGJhY2tlbmQvbW9kZWxzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFza1R5cGUgKHVzZXJUYXNrOiBVc2VyVGFzaykgOiAnY291cnNlQnVpbGRlclRhc2snIHwgJ3NpdGVWaXNpb25UYXNrJyB8ICdzdWJqZWN0UGxhbm5lclRhc2snIHwgJ2N1c3RvbVRhc2snIHtcclxuICByZXR1cm4gdXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2suY291cnNlLmxlbmd0aCA+IDAgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwID9cclxuICAgICdjb3Vyc2VCdWlsZGVyVGFzaycgOlxyXG4gICAgdXNlclRhc2suc2l0ZVZpc2lvblBhZ2VJZCA/XHJcbiAgICAgICdzaXRlVmlzaW9uVGFzaycgOlxyXG4gICAgICAgIHVzZXJUYXNrLmNvdXJzZUluZm8gP1xyXG4gICAgICAgICAgJ3N1YmplY3RQbGFubmVyVGFzaycgOlxyXG4gICAgICAgICAgJ2N1c3RvbVRhc2snO1xyXG59XHJcbiIsImV4cG9ydCB7V2Vla1BsYW5uZXJ9IGZyb20gJy4vd2Vla3BsYW5uZXInO1xyXG4iLCJpbXBvcnQgeyBVc2VyVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHsgVXNlclRhc2tzQm94UHJvcHMgfSBmcm9tICcuL3VzZXItdGFza3MtYm94JztcclxuaW1wb3J0IHsgYXJyYXlUb01hcCwgYXJyYXlUb0xvb2t1cCwgY29tcGFyZVByb3AsIEwgfSBmcm9tIFwiLi4vLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmlydHVhbExlYXJuaW5nR29hbCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIGFsbFRhc2tzOiBVc2VyVGFza1tdO1xyXG4gIHN0ZXA/OiBudW1iZXI7XHJcbiAgdXJsPzogc3RyaW5nO1xyXG4gIHRhc2tzOiBVc2VyVGFza1tdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmVmaW5lKHRhc2tzOiBVc2VyVGFza1tdKSB7XHJcbiAgY29uc3QgcmVzdWx0ID0gW10gYXMgUGFydGlhbDxVc2VyVGFza3NCb3hQcm9wcz5bXTtcclxuICBjb25zdCBtYXBwZXIgPSB7fSBhcyB7IFtuYW1lOiBzdHJpbmddOiBVc2VyVGFza3NCb3hQcm9wcyB9O1xyXG4gIGNvbnN0IHRhc2tzUGVyQ291cnNlID0gYXJyYXlUb0xvb2t1cCh0YXNrcywgdCA9PiB0LmNvdXJzZU5hbWUgfHwgJycpO1xyXG4gIGZvciAoY29uc3QgY291cnNlTmFtZSBvZiBPYmplY3Qua2V5cyh0YXNrc1BlckNvdXJzZSkuc29ydCgpLmZpbHRlcih4ID0+IHgpLmNvbmNhdCh0YXNrc1BlckNvdXJzZVsnJ10gP1xyXG4gICAgWycnXSA6IFtdKSkge1xyXG4gICAgY29uc3QgY291cnNlVGFza3MgPSB0YXNrc1BlckNvdXJzZVtjb3Vyc2VOYW1lXSB8fCB0YXNrc1BlckNvdXJzZVsnJ107XHJcbiAgICBjb25zdCB0YXNrc1BlckxlYXJuaW5nR29hbCA9IGFycmF5VG9Mb29rdXAoY291cnNlVGFza3MsIHQgPT4gdC5sZWFybmluZ0dvYWwpO1xyXG4gICAgY29uc3QgcmVzdWx0TGVhcm5pbmdHb2FsczogVmlydHVhbExlYXJuaW5nR29hbFtdID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGxlYXJuaW5nR29hbCBvZiBPYmplY3Qua2V5cyh0YXNrc1BlckxlYXJuaW5nR29hbCkpIHtcclxuICAgICAgY29uc3QgbGdUYXNrcyA9IHRhc2tzUGVyTGVhcm5pbmdHb2FsW2xlYXJuaW5nR29hbF0uc29ydChjb21wYXJlUHJvcChcImRhdGVUaW1lXCIpKTtcclxuICAgICAgY29uc3QgbGVhcm5pbmdHb2FsVGFzayA9IGxnVGFza3NcclxuICAgICAgICAuZmlsdGVyKHQgPT4gdC5uYW1lID09IG51bGwpIC8vIElmIG5hbWUgaXMgdW5kZWZpbmVkIG9yIG51bGwsIHRoaXMgcmVwcmVzZW50cyBhIGxlYXJuaW5nIGdvYWxcclxuICAgICAgICBbMF07XHJcbiAgICAgIGNvbnN0IHVybCA9IGxlYXJuaW5nR29hbFRhc2sgJiYgbGVhcm5pbmdHb2FsVGFzay51cmw7XHJcbiAgICAgIHJlc3VsdExlYXJuaW5nR29hbHMucHVzaCh7XHJcbiAgICAgICAgbmFtZTogbGVhcm5pbmdHb2FsLFxyXG4gICAgICAgIGFsbFRhc2tzOiBsZ1Rhc2tzLFxyXG4gICAgICAgIHVybCxcclxuICAgICAgICBzdGVwOiBsZ1Rhc2tzLm1hcCh0ID0+IHQuc3RlcCkuZmlsdGVyKHN0ZXAgPT4gc3RlcClbMF0sXHJcbiAgICAgICAgdGFza3M6IGxnVGFza3MuZmlsdGVyKHQgPT4gdC5uYW1lKVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHJlc3VsdC5wdXNoKHtcclxuICAgICAgY291cnNlTmFtZSxcclxuICAgICAgbGVhcm5pbmdHb2FsczogcmVzdWx0TGVhcm5pbmdHb2Fsc1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IE9wZW5DbG9zZUJveCB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9vcGVuLWNsb3NlLWJveCc7XHJcbmltcG9ydCB7IEwgfSBmcm9tICcuLi8uLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5IH0gZnJvbSAnLi4vLi4vYWNjZXNzLWNvbnRyb2wnO1xyXG5pbXBvcnQgeyBjb3Vyc2VOYW1lVG9Dc3NDbGFzcyB9IGZyb20gJy4uL2NhbGVuZGFyL2NvdXJzZS1uYW1lLXRvLWNzcy1jbGFzcyc7XHJcbmltcG9ydCB7IGdldFRhc2tUeXBlIH0gZnJvbSAnLi9nZXQtdGFzay10eXBlJztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBWaXJ0dWFsTGVhcm5pbmdHb2FsIH0gZnJvbSAnLi9yZWZpbmVyJztcclxuaW1wb3J0IHsgRmVhdHVyZXMgfSBmcm9tICcuLi8uLi9mZWF0dXJlcyc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuaW1wb3J0IHtGb3JtYXR0ZWRNZXNzYWdlfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBVc2VyVGFza3NCb3hQcm9wcyB7XHJcbiAgY291cnNlTmFtZTogc3RyaW5nO1xyXG4gIGxlYXJuaW5nR29hbHM6IFZpcnR1YWxMZWFybmluZ0dvYWxbXSxcclxuICB2aWV3Q291cnNlVXJsOiBzdHJpbmc7XHJcbiAgb3BlbkNvdXJzZXM/OiB7IFtwYXRoOiBzdHJpbmddOiBib29sZWFuIH07XHJcbiAgc2V0SXNPcGVuPzogKGNvdXJzZU5hbWU6IHN0cmluZywgaXNPcGVuOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIHNldFRhc2tEb25lPzogKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIHNldFN1YlRhc2tEb25lOiAodGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrLCBkb25lOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gIGFkZE93blRhc2s/OiAoY291cnNlTmFtZTogc3RyaW5nLCBsZWFybmluZ0dvYWxOYW1lOiBzdHJpbmcpID0+IHZvaWQ7XHJcbiAgZWRpdFRhc2s6ICh0YXNrOiBVc2VyVGFzaykgPT4gdm9pZDtcclxuICBlZGl0U3ViVGFzazogKHRhc2s6IFVzZXJUYXNrLCBzdWJUYXNrOiBVc2VyU3ViVGFzaykgPT4gdm9pZDtcclxuICByZW1vdmVMZWFybmluZ0dvYWw6IChsZzogVmlydHVhbExlYXJuaW5nR29hbCk9PnZvaWQ7XHJcbiAgZGlzcGxheVByb2dyZXNzOiBib29sZWFuO1xyXG4gIHByb2dyZXNzRGF0YToge2NvbXBsZXRlZE51bWJlck9mVGFza3M6IG51bWJlciwgbnVtYmVyT2ZUYXNrczogbnVtYmVyfTtcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBVc2VyVGFza3NCb3ggZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8VXNlclRhc2tzQm94UHJvcHM+IHtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFVzZXJUYXNrc0JveFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgfVxyXG5cclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICBjb3Vyc2VOYW1lLFxyXG4gICAgICBsZWFybmluZ0dvYWxzLCBcclxuICAgICAgcHJvZ3Jlc3NEYXRhLFxyXG4gICAgICBkaXNwbGF5UHJvZ3Jlc3NcclxuICAgIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgY29uc3QgaXNPcGVuID0gISF0aGlzLnByb3BzLm9wZW5Db3Vyc2VzW2NvdXJzZU5hbWVdO1xyXG4gICAgY29uc3QgZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcclxuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMuY29udGV4dDtcclxuXHJcbiAgICByZXR1cm4gPE9wZW5DbG9zZUJveFxyXG4gIHRpdGxlPXs8aDU+e2NvdXJzZU5hbWUgfHwgPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ1c2VyVGFza3MuZ29hbHNcIiAgZGVmYXVsdE1lc3NhZ2U9XCJFZ25hIGzDpHJhbmRlbcOlbFwiLz4gfTwvaDU+fVxyXG4gICAgICBoZWFkZXJPcGVuPXtpc09wZW59XHJcbiAgICAgIGNsYXNzTmFtZT17Y291cnNlTmFtZSAmJiBjb3Vyc2VOYW1lVG9Dc3NDbGFzcygnd3AtY291cnNlLScsIGNvdXJzZU5hbWUpfVxyXG4gICAgICBvbk9wZW5DbG9zZT17YmVjYW1lT3BlbiA9PiB0aGlzLnByb3BzLnNldElzT3Blbihjb3Vyc2VOYW1lLCBiZWNhbWVPcGVuKX1cclxuICAgICAgZGlzcGxheVByb2dyZXNzPSB7ZGlzcGxheVByb2dyZXNzfSAgICAgICBcclxuICAgICAgcHJvZ3Jlc3NEYXRhID0ge3Byb2dyZXNzRGF0YX1cclxuICAgICAgPlxyXG4gICAgICB7bGVhcm5pbmdHb2Fscy5tYXAobGcgPT5cclxuICAgICAgICA8ZGl2IGtleT17bGcubmFtZX0gY2xhc3NOYW1lPVwibGVhcm5pbmdHb2FsQ29udGFpbmVyXCI+XHJcbiAgICAgICAgICB7bGcuc3RlcCAmJiA8ZGl2IGNsYXNzTmFtZT1cInN0ZXBJbmRpY2F0b3JcIj57bGcuc3RlcH08L2Rpdj59XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFsaWduLWhvcml6b250YWxcIj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUZXh0IGhvcml6b250YWxJdGVtIHRvcFwiPntsZy5uYW1lfTwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XHJcbiAgICAgICAgICAgICAgJm5ic3A7PGFcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRyYXNoXCJcclxuICAgICAgICAgICAgICAgIGhyZWY9XCIjXCJcclxuICAgICAgICAgICAgICAgICB0aXRsZT17aW50bC5mb3JtYXRNZXNzYWdlKHtpZDondXNlclRhc2tzLmRlbGV0ZUxlYXJuaW5nR29hbCcsIGRlZmF1bHRNZXNzYWdlOiAnVGEgYm9ydCBsw6RyYW5kZW3DpWxldCBvY2ggZGVzcyB1cHBnaWZ0ZXInfSl9XHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrPXtldj0+e1xyXG4gICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnByb3BzLnJlbW92ZUxlYXJuaW5nR29hbChsZyk7XHJcbiAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLXRyYXNoXCIgLz5cclxuICAgICAgICAgICAgICA8L2E+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJsZWFybmluZ0dvYWxUYXNrc1wiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRhc2tDb250YWluZXJcIj5cclxuICAgICAgICAgICAgICB7bGcudGFza3MubWFwKHVzZXJUYXNrID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzV29ya2luZyA9IHVzZXJUYXNrLiRtZXRhID09PSAnYWRkaW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ2RlbGV0aW5nJyB8fCB1c2VyVGFzay4kbWV0YSA9PT0gJ3VwZGF0aW5nJztcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YXNrVHlwZSA9IGdldFRhc2tUeXBlKHVzZXJUYXNrKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZWQgPSBtb21lbnQodXNlclRhc2suZGVhZGxpbmUpLnN0YXJ0T2YoJ2RheScpIDwgbW9tZW50KCkuc3RhcnRPZignZGF5Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDxkaXYga2V5PXt1c2VyVGFzay5pZH0gc3R5bGU9e2lzV29ya2luZyA/IHsgb3BhY2l0eTogMC41IH0gOiB7fX0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYWxpZ24taG9yaXpvbnRhbFwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJjaGVja0JveFwiICsgKHVzZXJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZXYgPT4gIWlzV29ya2luZyAmJiB0aGlzLnByb3BzLnNldFRhc2tEb25lKHVzZXJUYXNrLCAhdXNlclRhc2suZG9uZSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIHt0YXNrVHlwZSA9PT0gJ2NvdXJzZUJ1aWxkZXJUYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dldFRhc2tVcmwodXNlclRhc2ssIHRoaXMucHJvcHMudmlld0NvdXJzZVVybCl9Pnt1c2VyVGFzay5uYW1lfTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgIHRhc2tUeXBlID09PSAnc3ViamVjdFBsYW5uZXJUYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9e2dldFN1YmplY3RQbGFubmVyVGFza1VybCh1c2VyVGFzayl9Pnt1c2VyVGFzay5uYW1lfTwvYT4gOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXNrVHlwZSA9PT0gJ3NpdGVWaXNpb25UYXNrJyA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj17dXNlclRhc2sudXJsfT57dXNlclRhc2submFtZX08L2E+IDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXshdXNlclRhc2sudXJsID8gXCJsaW5rLWxlc3NcIjogXCJcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY9e3VzZXJUYXNrLnVybCB8fCB1bmRlZmluZWR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ9eyh1c2VyVGFzay51cmwrJycpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChsb2NhdGlvbi5ob3N0LnRvTG93ZXJDYXNlKCkpID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfc2VsZlwiIDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA+e3VzZXJUYXNrLm5hbWV9PC9hPn1cclxuICAgICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5kZWFkbGluZSAmJiA8ZGl2IGNsYXNzTmFtZT17XCJkYXRlU2V0XCIgKyAoZXhwaXJlZCA/ICcgZXhwaXJlZCcgOiAnJyl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aSB0aXRsZT17bW9tZW50KHVzZXJUYXNrLmRlYWRsaW5lKS5mb3JtYXQoXCJZWVlZLU1NLUREXCIpfSBjbGFzc05hbWU9XCJmYSBmYS1jYWxlbmRhclwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCk9Pnt9fT48L2k+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3AgdGFza0VkaXRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmVkaXRUYXNrKHVzZXJUYXNrKX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PiBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICB7dXNlclRhc2suc3ViVGFza3MgJiYgPGRpdiBjbGFzc05hbWU9XCJzdWJ0YXNrc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgIHt1c2VyVGFzay5zdWJUYXNrcy5tYXAoc3ViVGFzayA9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e3N1YlRhc2suaWR9ID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiY2hlY2tCb3hcIiArIChzdWJUYXNrLmRvbmUgPyBcIiBjaGVja2VkXCIgOiBcIlwiKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2V2ID0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICFpc1dvcmtpbmcgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5zZXRTdWJUYXNrRG9uZSh1c2VyVGFzaywgc3ViVGFzaywgIXN1YlRhc2suZG9uZSl9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbSB0b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZj17c3ViVGFzay51cmwgfHwgdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0PXsodXNlclRhc2sudXJsKycnKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgobG9jYXRpb24uaG9zdC50b0xvd2VyQ2FzZSgpKSA/XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9zZWxmXCIgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfYmxhbmtcIn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlRhc2sudXJsID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQgOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsaW5rLWxlc3MnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfT57c3ViVGFzay5uYW1lfTwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbEl0ZW0gdG9wIHRhc2tFZGl0XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiZWRpdEl0ZW1cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLnByb3BzLmVkaXRTdWJUYXNrKHVzZXJUYXNrLCBzdWJUYXNrKX0gLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4pfVxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj59XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICB9KX1cclxuICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxlYXJuaW5nR29hbFRvb2xzXCI+XHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuIGFkZE93bkdvYWxcIlxyXG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRoaXMucHJvcHMuYWRkT3duVGFzayh0aGlzLnByb3BzLmNvdXJzZU5hbWUsIGxnLm5hbWUpfT5cclxuICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1wbHVzXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPiA8Rm9ybWF0dGVkTWVzc2FnZSBpZD0ndXNlclRhc2tzLmFkZExlYXJuaW5nR29hbCcgZGVmYXVsdE1lc3NhZ2U9J0VnZXQgYXJiZXRzbcOlbCcvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPGJyIC8+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICA8L09wZW5DbG9zZUJveD5cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFRhc2tVcmwodXNlclRhc2s6IFVzZXJUYXNrLCB2aWV3Q291cnNlVXJsOiBzdHJpbmcpIHtcclxuICBpZiAodXNlclRhc2suY291cnNlICYmIHVzZXJUYXNrLmNvdXJzZS5sZW5ndGggPiAwICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XHJcbiAgICBjb25zdCBjb3Vyc2VVcmwgPSBwcmVzZXJ2ZUltcGVyc29uYXRpb25RdWVyeSh2aWV3Q291cnNlVXJsLCB7IGNvdXJzZUlkOiB1c2VyVGFzay5jb3Vyc2VbMF0uaWQgfSk7XHJcbiAgICByZXR1cm4gYCR7Y291cnNlVXJsfSMvdGFzay8ke3VzZXJUYXNrLnRhc2tbMF0uaWR9YDtcclxuICB9XHJcbiAgcmV0dXJuIHVzZXJUYXNrLnVybDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3ViamVjdFBsYW5uZXJUYXNrVXJsKHVzZXJUYXNrOiBVc2VyVGFzaykge1xyXG4gIGlmICh1c2VyVGFzay5jb3Vyc2VJbmZvICYmIHVzZXJUYXNrLnRhc2sgJiYgdXNlclRhc2sudGFzay5sZW5ndGggPiAwKSB7XHJcbiAgICBjb25zdCB7c2Nob29sLCBjb3Vyc2UsIHRhYiB9ID0gdXNlclRhc2suY291cnNlSW5mbztcclxuICAgIGNvbnN0IGNvdXJzZVVybCA9IHByZXNlcnZlSW1wZXJzb25hdGlvblF1ZXJ5KGNmZy5LRURfU1VCSkVDVF9QTEFOTkVSX1VSTCwge30pO1xyXG4gICAgcmV0dXJuIGAke2NvdXJzZVVybH0jLyR7c2Nob29sfS9jb3Vyc2VzLyR7Y291cnNlfS90YWJzLyR7dGFifS90YXNrcy8ke3VzZXJUYXNrLnRhc2tbMF0uaWR9YDtcclxuICB9XHJcbiAgcmV0dXJuIHVzZXJUYXNrLnVybDtcclxufVxyXG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IGxvY2FsTW9tZW50IH0gZnJvbSAnLi4vLi4vZ2xvYmFscy9tb21lbnQtc3YtbG9jYWxlJztcclxuXHJcbnR5cGUgTW9tZW50ID0gbW9tZW50Lk1vbWVudDtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIHtcclxuICBzdGF0aWMgRVhQSVJBVElPTl9IT1VSUyA9IDEyO1xyXG4gIHN0YXRpYyBWRVJTSU9OID0gMjtcclxuXHJcbiAgdXNlcjogc3RyaW5nO1xyXG4gIGxhc3RXcml0ZTogbnVtYmVyO1xyXG4gIHdlZWtEYXRlOiBudW1iZXI7XHJcbiAgb3BlbkNvdXJzZXM6IHsgW3BhdGg6IHN0cmluZ106IGJvb2xlYW4gfVxyXG5cclxuICBjb25zdHJ1Y3RvciAodXNlck9yQ29weTogc3RyaW5nIHwgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSkge1xyXG4gICAgaWYgKHR5cGVvZiB1c2VyT3JDb3B5ID09PSAnc3RyaW5nJykge1xyXG4gICAgICB0aGlzLnVzZXIgPSB1c2VyT3JDb3B5O1xyXG4gICAgICB0aGlzLmxhc3RXcml0ZSA9IERhdGUubm93KCk7XHJcbiAgICAgIHRoaXMud2Vla0RhdGUgPSBsb2NhbE1vbWVudCgpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XHJcbiAgICAgIHRoaXMub3BlbkNvdXJzZXMgPSB7fTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgdXNlck9yQ29weSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgYXN5bmMgbG9hZCh1c2VyOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGNvb2tpZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlMicpO1xyXG4gICAgY29uc3Qgc3RvcmVkRGF0YSA9IGNvb2tpZSAmJiAoSlNPTi5wYXJzZShjb29raWUpIGFzIFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUpO1xyXG4gICAgY29uc3Qgc3RhdGUgPSBuZXcgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSh1c2VyKTtcclxuICAgIGlmIChzdG9yZWREYXRhKSBPYmplY3QuYXNzaWduKHN0YXRlLCBzdG9yZWREYXRhKTtcclxuXHJcbiAgICByZXR1cm4gc3RhdGUudXNlciA9PT0gdXNlciAmJiAhc3RhdGUuaXNFeHBpcmVkKG1vbWVudCgpKSA/XHJcbiAgICAgIHN0YXRlIDogbmV3IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUodXNlcik7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlKCkge1xyXG4gICAgdGhpcy5sYXN0V3JpdGUgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KHRoaXMpO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ1dlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUyJywganNvbik7XHJcbiAgfVxyXG5cclxuICBpc0V4cGlyZWQgKGFzT2Y6IE1vbWVudCkge1xyXG4gICAgICByZXR1cm4gbW9tZW50KHRoaXMubGFzdFdyaXRlKVxyXG4gICAgICAgIC5pc0JlZm9yZShcclxuICAgICAgICAgICAgYXNPZi5hZGQoXHJcbiAgICAgICAgICAgICAgICAwLVdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUuRVhQSVJBVElPTl9IT1VSUywgJ2hvdXJzJylcclxuICAgICAgICApO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IFVzZXJUYXNrc0JveCB9IGZyb20gJy4vdXNlci10YXNrcy1ib3gnO1xyXG5pbXBvcnQgeyBVc2VyVGFzaywgVXNlclN1YlRhc2sgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQsIEh0dHBFcnJvciB9IGZyb20gXCJrZWRiYWNrZW5kL2NsaWVudFwiO1xyXG5pbXBvcnQgeyByZWZpbmUsIFZpcnR1YWxMZWFybmluZ0dvYWwgfSBmcm9tICcuL3JlZmluZXInO1xyXG5pbXBvcnQgeyBFbnYgfSBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBMLCBjb21wYXJlUHJvcCB9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWxzJztcclxuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG4vL2ltcG9ydCB7IEN1c3RvbUdvYWwgfSBmcm9tICcuLi8uLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcbmltcG9ydCB7IFRTT04gfSBmcm9tICcuLi8uLi91dGlscy90c29uJztcclxuaW1wb3J0IHsgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB9IGZyb20gJy4vd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlJztcclxuaW1wb3J0IHsgUmVtb3ZlSXRlbSB9IGZyb20gJy4uL2NvdXJzZS1idWlsZGVyL3N1Yi1jb21wb25lbnRzL3JlbW92ZS1pdGVtJztcclxuaW1wb3J0IHsgRGlhbG9ncyB9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9kaWFsb2dzJztcclxuaW1wb3J0IHsgQWRkQ3VzdG9tR29hbCB9IGZyb20gJy4vYWRkLWN1c3RvbS1nb2FsJztcclxuaW1wb3J0IHsgQWRkQ3VzdG9tVGFzayB9IGZyb20gJy4vYWRkLWN1c3RvbS10YXNrJztcclxuaW1wb3J0IHsgRWRpdFVzZXJUYXNrIH0gZnJvbSAnLi9lZGl0LXVzZXItdGFzayc7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tICcuLi9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9zcGlubmVyJztcclxuaW1wb3J0IHsgT3BlbkNsb3NlQm94IH0gZnJvbSAnLi4vdXRpbGl0eS1jb21wb25lbnRzL29wZW4tY2xvc2UtYm94JztcclxuaW1wb3J0IHsgUGVuZGluZ0pvYiB9IGZyb20gJy4uLy4uL3V0aWxzL3BlbmRpbmctam9iJztcclxuaW1wb3J0IHsgQWRkT3JFZGl0U3ViVGFzayB9IGZyb20gJy4vYWRkLW9yLWVkaXQtc3ViLXRhc2snO1xyXG5pbXBvcnQgeyBnZXRBZGp1c3RlZFdlZWssIEtFRFdlZWsgfSBmcm9tICcuLi8uLi91dGlscy93ZWVrdXRpbCc7XHJcbmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgfSBmcm9tICdyZWFjdC1pbnRsJztcclxuaW1wb3J0IHtMYW5ndWFnZUNvbnRleHR9IGZyb20gJy4uL3V0aWxpdHktY29tcG9uZW50cy9MYW5ndWFnZUNvbnRleHQnO1xyXG5pbXBvcnQgeyBQcm9ncmVzcyB9IGZyb20gJy4uL2NoYXJ0cy9wcm9ncmVzcyc7XHJcbmltcG9ydCB7Z2V0V2Vla3BsYW5uZXJQcm9ncmVzc0RhdGF9IGZyb20gJy4uL2NoYXJ0cy9jaGFydHMtdXRpbHMnXHJcbmltcG9ydCB7IGZlYXR1cmVzIH0gZnJvbSAnLi4vLi4vZmVhdHVyZXMnO1xyXG5cclxuY29uc3QgTUFYX1NUUkFURUdZX0xFTkdUSCA9IDE2Mzg0O1xyXG5jb25zdCBNQVhfQVNTRVNTTUVOVF9MRU5HVEggPSAxNjM4NDtcclxuXHJcbmludGVyZmFjZSBQcm9wcyB7XHJcbiAgdmlld0NvdXJzZVVybDogc3RyaW5nO1xyXG4gIGVudjogRW52O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIHdlZWtEYXRlOiBudW1iZXI7XHJcbiAgZGlhbG9nczogYW55W107XHJcbiAgdXNlclRhc2tzOiBVc2VyVGFza1tdO1xyXG4gIG9wZW5Db3Vyc2VzOiB7IFtwYXRoOiBzdHJpbmddOiBib29sZWFuIH1cclxuICBzdHJhdGVneT86IHN0cmluZztcclxuICBhc3Nlc3NtZW50Pzogc3RyaW5nO1xyXG4gIHdlZWtUZXh0c1VUOiBVc2VyVGFzayB8IG51bGw7XHJcbiAgc2F2aW5nOiBib29sZWFuO1xyXG4gIGlzTG9hZGluZzogYm9vbGVhbjtcclxuICBpc0NvcHlpbmdUYXNrczogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFdlZWtQbGFubmVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xyXG4gIHdlZWtUZXh0c1NhdmluZ0pvYjogUGVuZGluZ0pvYjtcclxuICBzdGF0aWMgY29udGV4dFR5cGUgPSBMYW5ndWFnZUNvbnRleHQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xyXG4gICAgc3VwZXIocHJvcHMpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgdXNlclRhc2tzOiBbXSxcclxuICAgICAgd2Vla0RhdGU6IERhdGUubm93KCksXHJcbiAgICAgIG9wZW5Db3Vyc2VzOiB7fSxcclxuICAgICAgZGlhbG9nczogW10sXHJcbiAgICAgIHNhdmluZzogZmFsc2UsXHJcbiAgICAgIHdlZWtUZXh0c1VUOiBudWxsLFxyXG4gICAgICBpc0xvYWRpbmc6IHRydWUsXHJcbiAgICAgIGlzQ29weWluZ1Rhc2tzOiBmYWxzZVxyXG4gICAgfVxyXG4gICAgdGhpcy5vbkNoYW5nZSA9IHRoaXMub25DaGFuZ2UuYmluZCh0aGlzKTtcclxuICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iID0gbmV3IFBlbmRpbmdKb2IoKCk9PnRoaXMuc2F2ZVdlZWtUZXh0cygpKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xyXG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcclxuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8udW5zdWJzY3JpYmUodGhpcy5vbkNoYW5nZSk7XHJcbiAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi5zdG9wKCk7XHJcbiAgfVxyXG5cclxuICBvbkNoYW5nZSh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZDogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSwgd2Vla1RleHRzVVQ6IFVzZXJUYXNrKSB7XHJcbiAgICBjb25zdCBuZXdTdGF0ZSA6IFBhcnRpYWw8U3RhdGU+ID0ge1xyXG4gICAgICB1c2VyVGFza3MsXHJcbiAgICAgIHdlZWtEYXRlOiBwZXJzaXN0ZWQud2Vla0RhdGUsXHJcbiAgICAgIG9wZW5Db3Vyc2VzOiBwZXJzaXN0ZWQub3BlbkNvdXJzZXMsXHJcbiAgICAgIHdlZWtUZXh0c1VULFxyXG4gICAgICBpc0xvYWRpbmc6IGZhbHNlXHJcbiAgICB9XHJcbiAgICBpZiAoIXRoaXMuc3RhdGUud2Vla1RleHRzVVQgfHwgKHdlZWtUZXh0c1VULmRhdGVUaW1lICE9PSB0aGlzLnN0YXRlLndlZWtUZXh0c1VULmRhdGVUaW1lKSkge1xyXG4gICAgICAvLyBDaGFuZ2luZyB3ZWVrLiBSZXNldCB0byBuZXcgd2VlaydzIHZhbHVlc1xyXG4gICAgICBuZXdTdGF0ZS5zdHJhdGVneSA9IHdlZWtUZXh0c1VULndlZWtUZXh0cy5zdHJhdGVneTtcclxuICAgICAgbmV3U3RhdGUuYXNzZXNzbWVudCA9IHdlZWtUZXh0c1VULndlZWtUZXh0cy5hc3Nlc3NtZW50O1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSBhcyBhbnkpOyAvLyBSZWFjdCdzIHVzZSBvZiBQaWNrIGluc3RlYWQgb2YgUGFydGlhbCBtYWtlcyB0aGluZ3MgY29tcGxleCBoZXJlLlxyXG4gIH1cclxuXHJcbiAgaXNXZWVrVGV4dHNFZGl0ZWQoKSB7XHJcbiAgICBjb25zdCB7IHN0cmF0ZWd5LCBhc3Nlc3NtZW50LCB3ZWVrVGV4dHNVVCB9ID0gdGhpcy5zdGF0ZTtcclxuICAgIHJldHVybiAhIXdlZWtUZXh0c1VUICYmIChzdHJhdGVneSAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLnN0cmF0ZWd5IHx8IGFzc2Vzc21lbnQgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5hc3Nlc3NtZW50KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgc2F2ZVdlZWtUZXh0cygpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiU2F2aW5nIHRleHRzLi4uXCIpO1xyXG4gICAgY29uc3QgeyBzdHJhdGVneSwgYXNzZXNzbWVudCwgd2Vla1RleHRzVVQgfSA9IHRoaXMuc3RhdGU7XHJcbiAgICBpZiAodGhpcy5pc1dlZWtUZXh0c0VkaXRlZCgpKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8udXBzZXJ0KHdlZWtUZXh0c1VULCB1dCA9PiB7XHJcbiAgICAgICAgdXQud2Vla1RleHRzID0geyBzdHJhdGVneSwgYXNzZXNzbWVudCB9O1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByZXZXZWVrKCkge1xyXG4gICAgLy90aGlzLnNhdmVXZWVrVGV4dHMoKTtcclxuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uY2hhbmdlV2Vlayhtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkuYWRkKC0xLCAnd2VlaycpLnRvRGF0ZSgpKTtcclxuICB9XHJcblxyXG4gIG5leHRXZWVrKCkge1xyXG4gICAgLy90aGlzLnNhdmVXZWVrVGV4dHMoKTtcclxuICAgIHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uY2hhbmdlV2Vlayhtb21lbnQodGhpcy5zdGF0ZS53ZWVrRGF0ZSkuYWRkKDEsICd3ZWVrJykudG9EYXRlKCkpO1xyXG4gIH1cclxuXHJcbiAgb3BlbkRpYWxvZyhkaWFsb2cpIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoeyBkaWFsb2dzOiBbLi4udGhpcy5zdGF0ZS5kaWFsb2dzLCBkaWFsb2ddIH0pO1xyXG4gIH1cclxuXHJcbiAgb3BlbkFkZEdvYWxEaWFsb2coKSB7XHJcbiAgICB0aGlzLm9wZW5EaWFsb2coPEFkZEN1c3RvbUdvYWxcclxuICAgICAgb25TYXZlPXthc3luYyAobGVhcm5pbmdHb2FsOiBzdHJpbmcpID0+IHtcclxuICAgICAgICBpZiAoIWxlYXJuaW5nR29hbCkgdGhyb3cgbmV3IEVycm9yICh0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDond2Vla3BsYW5uZXIuZW1wdHlMZWFybmluZ0dvYWxFcnInLCBkZWZhdWx0TWVzc2FnZTogJ0zDpHJhbmRlbcOlbGV0IGthbiBpbnRlIHZhcmEgdG9tdCd9KSk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnN0YXRlLnNhdmluZykge1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNhdmluZzogdHJ1ZSB9KTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWRkQ3VzdG9tR29hbChsZWFybmluZ0dvYWwpO1xyXG4gICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNhdmluZzogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9fSAvPik7XHJcbiAgfVxyXG5cclxuICBvcGVuQWRkT3duVGFza0RpYWxvZyhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykge1xyXG4gICAgdGhpcy5vcGVuRGlhbG9nKDxBZGRDdXN0b21UYXNrXHJcbiAgICAgIGlzVGFzaz17IWNvdXJzZU5hbWV9XHJcbiAgICAgIG9uU2F2ZT17YXN5bmMgKG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgdXJsOiBzdHJpbmcpID0+IHtcclxuICAgICAgICBpZiAoIW5hbWUpIHRocm93IG5ldyBFcnJvciAodGhpcy5jb250ZXh0LmludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3dlZWtwbGFubmVyLm5hbWVDYW5ub3RCZUVtcHR5JywgZGVmYXVsdE1lc3NhZ2U6ICdOYW1uZXQga2FuIGludGUgdmFyYSB0b210J30pKTtcclxuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuc2F2aW5nKSB7XHJcbiAgICAgICAgICB0aGlzLnNldFN0YXRlKHsgc2F2aW5nOiB0cnVlIH0pO1xyXG4gICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5hZGRDdXN0b21UYXNrKGNvdXJzZU5hbWUsIGxlYXJuaW5nR29hbE5hbWUsIG5hbWUsIGRlc2NyaXB0aW9uLCB1cmwpO1xyXG4gICAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNhdmluZzogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9fSAvPik7XHJcbiAgfVxyXG5cclxuICBlZGl0VGFzayh1c2VyVGFzazogVXNlclRhc2spIHtcclxuICAgIHRoaXMub3BlbkRpYWxvZyg8RWRpdFVzZXJUYXNrXHJcbiAgICAgIHVzZXJUYXNrc1JlcG89e3RoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG99XHJcbiAgICAgIHVzZXJUYXNrPXt1c2VyVGFza31cclxuICAgICAgb25VcGRhdGU9e2FzeW5jICh1cGRhdGVyOiAodXQ6IFVzZXJUYXNrKSA9PiB2b2lkKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdGVzdCA9IHsuLi51c2VyVGFza307XHJcbiAgICAgICAgdXBkYXRlcih0ZXN0KTtcclxuICAgICAgICBpZiAoIXRlc3QubmFtZSkgdGhyb3cgbmV3IEVycm9yICh0aGlzLmNvbnRleHQuaW50bC5mb3JtYXRNZXNzYWdlKHtpZDond2Vla3BsYW5uZXIubmFtZU11c3ROb3RCZUVtcHR5JywgZGVmYXVsdE1lc3NhZ2U6ICdOYW1uZXQgZsOlciBpbnRlIHZhcmEgdG9tdCd9KSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8udXBkYXRlKFt1c2VyVGFza10sIHVwZGF0ZXIpO1xyXG4gICAgICB9fVxyXG4gICAgICBvbkRlbGV0ZT17YXN5bmMgaWQgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTtcclxuICAgICAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLmRlbGV0ZShbaWRdKTtcclxuICAgICAgfX1cclxuICAgICAgb3BlbkRpYWxvZz17ZGlhbG9nPT50aGlzLm9wZW5EaWFsb2coZGlhbG9nKX1cclxuICAgICAgY2xvc2VEaWFsb2c9eygpPT50aGlzLmNsb3NlRGlhbG9nKCl9XHJcbiAgICAvPik7XHJcbiAgfVxyXG5cclxuICBlZGl0U3ViVGFzayh1c2VyVGFzazogVXNlclRhc2ssIHN1YlRhc2s6IFVzZXJTdWJUYXNrKSB7XHJcbiAgICB0aGlzLm9wZW5EaWFsb2coPEFkZE9yRWRpdFN1YlRhc2tcclxuICAgICAgdXNlclRhc2tzUmVwbz17dGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwb31cclxuICAgICAgbW9kZT1cImVkaXRcIlxyXG4gICAgICB1c2VyVGFzaz17dXNlclRhc2t9XHJcbiAgICAgIHN1YlRhc2s9e3N1YlRhc2t9XHJcbiAgICAgIGNsb3NlRGlhbG9nPXsoKT0+dGhpcy5jbG9zZURpYWxvZygpfVxyXG4gICAgLz4pO1xyXG4gIH1cclxuXHJcbiAgY2xvc2VEaWFsb2coKSB7XHJcbiAgICB0aGlzLnNldFN0YXRlKHsgZGlhbG9nczogdGhpcy5zdGF0ZS5kaWFsb2dzLnNsaWNlKDAsIHRoaXMuc3RhdGUuZGlhbG9ncy5sZW5ndGggLSAxKSB9KTtcclxuICB9XHJcblxyXG5cclxuXHJcbiAgYXN5bmMgYWRkQ3VzdG9tR29hbChsZWFybmluZ0dvYWw6IHN0cmluZykge1xyXG4gICAgbGV0IGxhdGVzdFRpbWVTdGFtcCA9IE1hdGgubWF4LmFwcGx5KFxyXG4gICAgICBNYXRoLm1heCxcclxuICAgICAgW3RoaXMuc3RhdGUud2Vla0RhdGVdLmNvbmNhdCh0aGlzLnN0YXRlLnVzZXJUYXNrcy5tYXAodCA9PiB0LmRhdGVUaW1lKSkpO1xyXG5cclxuICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uaW5zZXJ0KFt7XHJcbiAgICAgIGlkOiBjcmVhdGVVVUlEKCksXHJcbiAgICAgIGxlYXJuaW5nR29hbCxcclxuICAgICAgZGF0ZVRpbWU6IGxhdGVzdFRpbWVTdGFtcCArIDIwMDBcclxuICAgIH1dKTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnNldFdlZWtQbGFubmVyQm94T3BlbihcIlwiLCB0cnVlKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHJlbW92ZUxlYXJuaW5nR29hbChsZWFybmluZ0dvYWw6IFZpcnR1YWxMZWFybmluZ0dvYWwpIHtcclxuICAgIGlmIChsZWFybmluZ0dvYWwudGFza3MubGVuZ3RoID4gMCkge1xyXG4gICAgICBpZiAoIWNvbmZpcm0odGhpcy5jb250ZXh0LmludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3dlZWtwbGFubmVyLmNvbmZpcm1SZW1vdmVMZWFybmluZ09iamVjdGl2ZXMnLCBkZWZhdWx0TWVzc2FnZTogJ1RhIGJvcnQgbMOkcmFuZGVtw6VsIHNhbXQge2xlYXJuaW5nR29hbHNOdW1iZXJ9IHVwcGdpZnRlcj8nfSwge2xlYXJuaW5nR29hbHNOdW1iZXI6IGxlYXJuaW5nR29hbC50YXNrcy5sZW5ndGh9KSkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uZGVsZXRlKGxlYXJuaW5nR29hbC5hbGxUYXNrcy5tYXAodCA9PiB0LmlkKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBhZGRDdXN0b21UYXNrKGNvdXJzZU5hbWU6IHN0cmluZywgbGVhcm5pbmdHb2FsOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgdXJsOiBzdHJpbmcpIHtcclxuICAgIGxldCBsYXRlc3RUaW1lU3RhbXAgPSBNYXRoLm1heC5hcHBseShcclxuICAgICAgTWF0aC5tYXgsXHJcbiAgICAgIFt0aGlzLnN0YXRlLndlZWtEYXRlXS5jb25jYXQodGhpcy5zdGF0ZS51c2VyVGFza3MubWFwKHQgPT4gdC5kYXRlVGltZSkpKTtcclxuXHJcbiAgICAvKmNvbnN0IGVtcHR5TGVhcm5pbmdHb2FsUGxhY2Vob2xkZXIgPSB0aGlzLnN0YXRlLnVzZXJUYXNrcy5maW5kKHV0ID0+XHJcbiAgICAgIHV0Lm5hbWUgPT0gbnVsbCAmJlxyXG4gICAgICAhdXQuY291cnNlTmFtZSAmJlxyXG4gICAgICB1dC5sZWFybmluZ0dvYWwgPT09IGxlYXJuaW5nR29hbCk7XHJcblxyXG4gICAgaWYgKGVtcHR5TGVhcm5pbmdHb2FsUGxhY2Vob2xkZXIpIHtcclxuICAgICAgLy8gSGlqYWNrIGxlYXJuaW5nLWdvYWwgcGxhY2Vob2xkZXIgYW5kIG1ha2UgaXQgdGhlIHJlYWwgdGFzay5cclxuICAgICAgLy8gVGhpcyB3aWxsIG1ha2UgdGhlIGxlYXJuaW5nIGdvYWwgZGlzYXBwZWFyIG9uY2UgdGhpcyB0YXNrXHJcbiAgICAgIC8vIGlzIGRlbGV0ZWQuXHJcbiAgICAgIGF3YWl0IHVzZXJUYXNrc1JlcG8udXBkYXRlKFtlbXB0eUxlYXJuaW5nR29hbFBsYWNlaG9sZGVyXSwgdXQgPT4ge1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odXQsIHsgbmFtZSwgZGVzY3JpcHRpb24sIHVybCB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgeyovXHJcbiAgICAgIC8vIEFkZCBhbm90aGVyIHRhc2sgdG8gc2FtZSBsZWFybmluZy1nb2FsXHJcbiAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uaW5zZXJ0KFt7XHJcbiAgICAgICAgaWQ6IGNyZWF0ZVVVSUQoKSxcclxuICAgICAgICBkYXRlVGltZTogbGF0ZXN0VGltZVN0YW1wICsgMjAwMCxcclxuICAgICAgICBjb3Vyc2VOYW1lLFxyXG4gICAgICAgIGxlYXJuaW5nR29hbCxcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgICAgIHVybFxyXG4gICAgICB9XSk7XHJcbiAgICAvL31cclxuICB9XHJcblxyXG4gIHNldElzT3Blbihjb3Vyc2VOYW1lOiBzdHJpbmcsIGlzT3BlbjogYm9vbGVhbikge1xyXG4gICAgdGhpcy5wcm9wcy5lbnYudXNlclRhc2tzUmVwby5zZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZSwgaXNPcGVuKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIHNldFRhc2tEb25lKHRhc2s6IFVzZXJUYXNrLCBkb25lOiBib29sZWFuKSB7XHJcbiAgICBhd2FpdCB0aGlzLnByb3BzLmVudi51c2VyVGFza3NSZXBvLnNldFRhc2tEb25lU3RhdGUodGFzaywgZG9uZSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRTdWJUYXNrRG9uZSh0YXNrOiBVc2VyVGFzaywgc3ViVGFzazogVXNlclN1YlRhc2ssIGRvbmU6IGJvb2xlYW4pIHtcclxuICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uc2V0U3ViVGFza0RvbmVTdGF0ZSh0YXNrLCBzdWJUYXNrLmlkLCBkb25lKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGNvcHlGcm9tUHJldmlvdXNXZWVrKCkge1xyXG4gICAgYXdhaXQgdGhpcy5zZXRTdGF0ZSh7aXNDb3B5aW5nVGFza3M6IHRydWV9KTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHsgdXNlclRhc2tzLCBvcGVuQ291cnNlcywgd2Vla0RhdGUgfSA9IHRoaXMuc3RhdGU7XHJcblxyXG4gICAgICBjb25zdCBwcmV2V2Vla05vID0gZ2V0QWRqdXN0ZWRXZWVrIChtb21lbnQod2Vla0RhdGUpLmFkZCgtMSwgJ3dlZWsnKSwgKTtcclxuICAgICAgY29uc3QgcHJldktFRFdlZWsgPSBLRURXZWVrKG1vbWVudCh3ZWVrRGF0ZSkueWVhcigpLCBwcmV2V2Vla05vKTtcclxuICAgICAgLy8gUmVhZCBsYXN0IHdlZWsncyBnb2FscyBhbmQgdGFza3NcclxuICAgICAgbGV0IHByZXZUYXNrcyA9IGF3YWl0IHRoaXMucHJvcHMuZW52LmtlZEJhY2tlbmRDbGllbnQubGlzdDxVc2VyVGFzaz4oXCJ1c2VydGFza3NcIiwge1xyXG4gICAgICAgIGZyb206IHByZXZLRURXZWVrLm5vdEJlZm9yZSxcclxuICAgICAgICB0bzogcHJldktFRFdlZWsubm90QWZ0ZXIsXHJcbiAgICAgICAgcm9sZTogXCJVU0VSXCIsXHJcbiAgICAgICAgaW5jbHVkZTogW1widGFza1wiLCBcImNvdXJzZVwiLCBcImFjbFwiXSxcclxuICAgICAgICBmbGFnczogW1wiaW5jbHVkZUlkc09ubHlcIl1cclxuICAgICAgfSk7XHJcbiAgICAgIHByZXZUYXNrcyA9IHByZXZUYXNrc1xyXG4gICAgICAgIC5maWx0ZXIocHJldlRhc2sgPT4gIXByZXZUYXNrLmRvbmUpICAvLyBEb24ndCBjb3B5IGRvbmUgdGFza3NcclxuICAgICAgICAuZmlsdGVyKHByZXZUYXNrID0+ICEhcHJldlRhc2submFtZSkgLy8gRG9uJ3QgY29weSBlbXB0eSBsZWFybmluZyBnb2Fsc1xyXG4gICAgICAgIC5maWx0ZXIocHJldlRhc2sgPT4gIXVzZXJUYXNrcy5zb21lKHRhc2tPZkN1cnJlbnRXZWVrID0+XHJcbiAgICAgICAgICB0YXNrT2ZDdXJyZW50V2Vlay5uYW1lID09PSBwcmV2VGFzay5uYW1lICYmXHJcbiAgICAgICAgICB0YXNrT2ZDdXJyZW50V2Vlay5sZWFybmluZ0dvYWwgPT09IHByZXZUYXNrLmxlYXJuaW5nR29hbCAmJlxyXG4gICAgICAgICAgdGFza09mQ3VycmVudFdlZWsuY291cnNlTmFtZSA9PT0gcHJldlRhc2suY291cnNlTmFtZSkpOyAvLyBJZ25vcmUgaWRlbnRpY2FsIHRhc2tzIChhbHJlYWR5IGNvcGllZClcclxuXHJcbiAgICAgIC8vIE5vdyBjcmVhdGUgY29waWVzIGJ1dCBwbGFjZSB0aGVtIGluIHRoZSBjdXJyZW50IHdlZWsuXHJcbiAgICAgIGxldCBsYXRlc3RUaW1lU3RhbXAgPSBNYXRoLm1heC5hcHBseShNYXRoLm1heCwgW3dlZWtEYXRlXS5jb25jYXQodXNlclRhc2tzLm1hcCh0ID0+IHQuZGF0ZVRpbWUpKSk7XHJcblxyXG4gICAgICBjb25zdCBjb3BpZXMgPSBwcmV2VGFza3Muc29ydChjb21wYXJlUHJvcChcImRhdGVUaW1lXCIpKS5tYXAodGFzayA9PiB7XHJcbiAgICAgICAgY29uc3QgY29weTogVXNlclRhc2sgPSB7IC4uLnRhc2ssIGRhdGVUaW1lOiBsYXRlc3RUaW1lU3RhbXAgKz0gMTAwMCB9O1xyXG4gICAgICAgIGNvcHkuaWQgPSBjcmVhdGVVVUlEKCk7XHJcbiAgICAgICAgaWYgKGNvcHkuc3ViVGFza3MpIHtcclxuICAgICAgICAgIGNvcHkuc3ViVGFza3MgPSBjb3B5LnN1YlRhc2tzLmZpbHRlcihzdCA9PiAhc3QuZG9uZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlbGV0ZSBjb3B5LiRldGFnO1xyXG4gICAgICAgIHJldHVybiBjb3B5O1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFN0b3JlIGl0XHJcbiAgICAgIGF3YWl0IHRoaXMucHJvcHMuZW52LnVzZXJUYXNrc1JlcG8uaW5zZXJ0KGNvcGllcyk7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICB0aGlzLnNldFN0YXRlKHtpc0NvcHlpbmdUYXNrczogZmFsc2V9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldEhlYWRlclRpdGxlKCl7XHJcbiAgICByZXR1cm4gPGg0PjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIubG9nQm9va1wiICBkZWZhdWx0TWVzc2FnZT1cIkxvZ2dib2tcIi8+PC9oND47XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB3ZWVrTnVtYmVyID0gbW9tZW50KHRoaXMuc3RhdGUud2Vla0RhdGUpLndlZWsoKTtcclxuICAgIGNvbnN0IHNob3dQcm9ncmVzc0NoYXJ0cyA9IGZlYXR1cmVzLndlZWtwbGFubmVyQ2hhcnRzO1xyXG4gICAgLy9jb25zb2xlLmxvZyhcIldlZWt5ZGF0ZTogXCIgICsgbmV3IERhdGUodGhpcy5zdGF0ZS53ZWVrRGF0ZSkgKyBcIiB3aGljaCBpcyB3ZWVrIG5vIFwiICsgd2Vla051bWJlcik7XHJcbiAgICBjb25zdCBjdXJyZW50V2VlayA9IG1vbWVudCgpLndlZWsoKTtcclxuICAgIGNvbnN0IHRhc2tTZXRzID0gcmVmaW5lKHRoaXMuc3RhdGUudXNlclRhc2tzKTtcclxuICAgIGNvbnN0IHsgZGlhbG9ncywgd2Vla1RleHRzVVQsIHN0cmF0ZWd5LCBhc3Nlc3NtZW50LCBpc0xvYWRpbmcsIGlzQ29weWluZ1Rhc2tzIH0gPSB0aGlzLnN0YXRlO1xyXG4gICAgY29uc3QgaXNTYXZpbmcgPSB3ZWVrVGV4dHNVVCAmJiAod2Vla1RleHRzVVQuJG1ldGEgPT09ICdhZGRpbmcnIHx8IHdlZWtUZXh0c1VULiRtZXRhID09PSAndXBkYXRpbmcnKTtcclxuICAgIGNvbnN0IGlzU3RyYXRlZ3lFZGl0ZWQgPSAhIXdlZWtUZXh0c1VUICYmIChzdHJhdGVneSAhPT0gd2Vla1RleHRzVVQud2Vla1RleHRzLnN0cmF0ZWd5KTtcclxuICAgIGNvbnN0IGlzQXNzZXNzbWVudEVkaXRlZCA9ICEhd2Vla1RleHRzVVQgJiYgKGFzc2Vzc21lbnQgIT09IHdlZWtUZXh0c1VULndlZWtUZXh0cy5hc3Nlc3NtZW50KTtcclxuICAgIGNvbnN0IGVuYWJsZVNhdmVCdXR0b24gPSAhaXNTYXZpbmcgJiYgKGlzU3RyYXRlZ3lFZGl0ZWQgfHwgaXNBc3Nlc3NtZW50RWRpdGVkKTtcclxuXHJcbiAgICB2YXIgY2hhcnRUYXNrcyA9IGdldFdlZWtwbGFubmVyUHJvZ3Jlc3NEYXRhKHRhc2tTZXRzKTtcclxuXHJcbiAgICB2YXIgcGVyY2VudGFnZSA9IHRhc2tTZXRzLmxlbmd0aCA+IDAgPyBjaGFydFRhc2tzLmNvbXBsZXRlZFRhc2tzIC8gY2hhcnRUYXNrcy50b3RhbE51bWJlck9mVGFza3MgKiAxMDAgOiAwO1xyXG4gICAgcmV0dXJuIDxkaXY+XHJcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtga2VkX2JveGVkIHdlZWtQbGFubmVyJHt3ZWVrTnVtYmVyID09PSBjdXJyZW50V2VlayA/IFwiIGN1cnJlbnRXZWVrXCIgOiBcIlwifWB9XHJcbiAgICAgICAgb25LZXlEb3duPXtldiA9PiB7XHJcbiAgICAgICAgICBpZiAoZXYud2hpY2ggPT09IDgzICYmIGV2LmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYgKCFpc1NhdmluZyAmJiB0aGlzLmlzV2Vla1RleHRzRWRpdGVkKCkpIHtcclxuICAgICAgICAgICAgICB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfX0+XHJcbiAgICAgICAge3Nob3dQcm9ncmVzc0NoYXJ0cyAmJiB0aGlzLmdldEhlYWRlclRpdGxlKCl9XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aWRnZXRzXCI+XHJcbiAgICAgICAgICB7c2hvd1Byb2dyZXNzQ2hhcnRzID8gPGRpdiBjbGFzc05hbWU9XCJwcm9ncmVzc0JhclwiPjxQcm9ncmVzcyBwZXJjZW50YWdlID0ge3BlcmNlbnRhZ2V9Lz48L2Rpdj4gOiB0aGlzLmdldEhlYWRlclRpdGxlKCl9XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHdlZWtTZWxlY3RgfT5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJob3Jpem9udGFsSXRlbVwiPlxyXG4gICAgICAgICAgICAgIDxwPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIud2Vla051bWJlclwiIHZhbHVlcz17e3dlZWtOdW1iZXI6IHdlZWtOdW1iZXJ9fSBkZWZhdWx0TWVzc2FnZT1cIlZlY2thIHt3ZWVrTnVtYmVyfVwiLz48L3A+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImhvcml6b250YWxJdGVtXCI+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXBcIj5cclxuICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3NOYW1lPVwiYnRuXCIgb25DbGljaz17KCkgPT4gdGhpcy5wcmV2V2VlaygpfT5cclxuICAgICAgICAgICAgICAgICAgPGkgY2xhc3NOYW1lPVwiZmEgZmEtYW5nbGUtbGVmdFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKSA9PiB0aGlzLm5leHRXZWVrKCl9PlxyXG4gICAgICAgICAgICAgICAgICA8aSBjbGFzc05hbWU9XCJmYSBmYS1hbmdsZS1yaWdodFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cclxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICB7dGFza1NldHMubGVuZ3RoID4gMCAmJiA8aHIgLz59XHJcblxyXG4gICAgICAgIHt0YXNrU2V0cy5tYXAocHJvcHMgPT5cclxuICAgICAgICAgIDxVc2VyVGFza3NCb3hcclxuICAgICAgICAgICAga2V5PXtwcm9wcy5jb3Vyc2VOYW1lfVxyXG4gICAgICAgICAgICB7Li4ucHJvcHN9XHJcbiAgICAgICAgICAgIGNvdXJzZU5hbWU9e3Byb3BzLmNvdXJzZU5hbWV9XHJcbiAgICAgICAgICAgIGxlYXJuaW5nR29hbHM9e3Byb3BzLmxlYXJuaW5nR29hbHN9XHJcbiAgICAgICAgICAgIHZpZXdDb3Vyc2VVcmw9e3RoaXMucHJvcHMudmlld0NvdXJzZVVybH1cclxuICAgICAgICAgICAgb3BlbkNvdXJzZXM9e3RoaXMuc3RhdGUub3BlbkNvdXJzZXN9XHJcbiAgICAgICAgICAgIGFkZE93blRhc2s9eyhjb3Vyc2VOYW1lOiBzdHJpbmcsIGxlYXJuaW5nR29hbE5hbWU6IHN0cmluZykgPT4gdGhpcy5vcGVuQWRkT3duVGFza0RpYWxvZyhjb3Vyc2VOYW1lLCBsZWFybmluZ0dvYWxOYW1lKX1cclxuICAgICAgICAgICAgc2V0SXNPcGVuPXt0aGlzLnNldElzT3Blbi5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBzZXRUYXNrRG9uZT17dGhpcy5zZXRUYXNrRG9uZS5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBzZXRTdWJUYXNrRG9uZT17dGhpcy5zZXRTdWJUYXNrRG9uZS5iaW5kKHRoaXMpfVxyXG4gICAgICAgICAgICBlZGl0VGFzaz17dGFzayA9PiB0aGlzLmVkaXRUYXNrKHRhc2spfVxyXG4gICAgICAgICAgICBlZGl0U3ViVGFzaz17KHRhc2ssIHN1YlRhc2spID0+IHRoaXMuZWRpdFN1YlRhc2sodGFzaywgc3ViVGFzayl9XHJcbiAgICAgICAgICAgIHJlbW92ZUxlYXJuaW5nR29hbD17bGcgPT4gdGhpcy5yZW1vdmVMZWFybmluZ0dvYWwobGcpfSBcclxuICAgICAgICAgICAgZGlzcGxheVByb2dyZXNzID0ge3Nob3dQcm9ncmVzc0NoYXJ0c31cclxuICAgICAgICAgICAgcHJvZ3Jlc3NEYXRhID0ge2NoYXJ0VGFza3Muc3ViamVjdERhdGFbcHJvcHMuY291cnNlTmFtZV19IC8+KX1cclxuXHJcbiAgICAgICAgPGhyIC8+XHJcblxyXG4gICAgICAgIHtpc0xvYWRpbmcgPyA8U3Bpbm5lciAvPiA6IDxkaXY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9e2V2ID0+IHRoaXMub3BlbkFkZEdvYWxEaWFsb2coKX0+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWxpc3QtYWx0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxyXG4gICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmxlYXJuaW5nR29hbFwiIGRlZmF1bHRNZXNzYWdlPVwiRWdldCBsw6RyYW5kZW3DpWxcIi8+XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYnRuXCIgc3R5bGU9e2lzQ29weWluZ1Rhc2tzID8ge29wYWNpdHk6IDAuNX0gOiB1bmRlZmluZWR9IG9uQ2xpY2s9e2V2ID0+ICghaXNDb3B5aW5nVGFza3MpICYmIHRoaXMuY29weUZyb21QcmV2aW91c1dlZWsoKX0+XHJcbiAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWNsb25lXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxyXG4gICAgICAgICAgICA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cIndlZWtwbGFubmVyLmNvcHlQcmV2aW91c1dlZWtUYWtzXCIgZGVmYXVsdE1lc3NhZ2U9XCJLb3BpZXJhIGVqIGtsYXJhIGZyw6VuIGbDtnJlZ8OlZW5kZSB2ZWNrYVwiLz5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPE9wZW5DbG9zZUJveFxyXG4gICAgICAgICAgICB0aXRsZT17PGg1PjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuc3RyYXRlZ3lBbmRFdmFsdWF0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJTdHJhdGVnaSAmIFV0dsOkcmRlcmluZ1wiLz48L2g1Pn1cclxuICAgICAgICAgICAgaGVhZGVyT3Blbj17dGhpcy5zdGF0ZS5vcGVuQ291cnNlc1tcIlN0cmF0VXR2XCJdfVxyXG4gICAgICAgICAgICBvbk9wZW5DbG9zZT17YmVjYW1lT3BlbiA9PiB0aGlzLnNldElzT3BlbihcIlN0cmF0VXR2XCIsIGJlY2FtZU9wZW4pfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8aDM+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneVwiIGRlZmF1bHRNZXNzYWdlPVwiU3RyYXRlZ2lcIi8+PC9oMz5cclxuICAgICAgICAgICAgPHA+PEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJ3ZWVrcGxhbm5lci5zdHJhdGVneURlc2NyaXB0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJIdXIgamFnIHNrYSBnw7ZyYSBmw7ZyIGF0dCBsw6RyYSBtaWcuXCIvPjwvcD5cclxuICAgICAgICAgICAgPGhyLz5cclxuICAgICAgICAgICAgPHRleHRhcmVhXHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2Vla3BsYW5uZXItdGV4dGFyZWFcIlxyXG4gICAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnByb3BzLmVudi50dXRvcmVkfVxyXG4gICAgICAgICAgICAgIHZhbHVlPXtzdHJhdGVneSAmJiBzdHJhdGVneS5zdWJzdHIoMCwgTUFYX1NUUkFURUdZX0xFTkdUSCl9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe3N0cmF0ZWd5OiAoZXYudGFyZ2V0LnZhbHVlIHx8ICcnKS5zdWJzdHIoMCwgTUFYX1NUUkFURUdZX0xFTkdUSCl9KTtcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcclxuICAgICAgICAgICAgICB9fSAvPlxyXG5cclxuICAgICAgICAgICAgPGgzPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuZXZhbHVhdGlvblwiIGRlZmF1bHRNZXNzYWdlPVwiVXR2w6RyZGVyaW5nXCIvPjwvaDM+XHJcbiAgICAgICAgICAgIDxwPjxGb3JtYXR0ZWRNZXNzYWdlIGlkPVwid2Vla3BsYW5uZXIuZXZhbHVhdGlvbkRlc2NyaXB0aW9uXCIgZGVmYXVsdE1lc3NhZ2U9XCJSZWZsZWt0aW9uIGtyaW5nIGRpbiBhcmJldHNpbnNhdHMgb2NoIGRpbmEgdmFsZGEgc3RyYXRlZ2llciB1bmRlciB2ZWNrYW4uVXR2w6RyZGVyYSBpIGbDtnJow6VsbGFuZGUgdGlsbCBkaW5hIG3DpWwuXCIvPjwvcD5cclxuICAgICAgICAgICAgPGhyLz5cclxuICAgICAgICAgICAgPHRleHRhcmVhXHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2Vla3BsYW5uZXItdGV4dGFyZWFcIlxyXG4gICAgICAgICAgICAgIHZhbHVlPXthc3Nlc3NtZW50ICYmIGFzc2Vzc21lbnQuc3Vic3RyKDAsIE1BWF9BU1NFU1NNRU5UX0xFTkdUSCl9XHJcbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZW52LnR1dG9yZWR9XHJcbiAgICAgICAgICAgICAgb25DaGFuZ2U9e2V2ID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe2Fzc2Vzc21lbnQ6IChldi50YXJnZXQudmFsdWUgfHwgJycpLnN1YnN0cigwLCBNQVhfQVNTRVNTTUVOVF9MRU5HVEgpfSlcclxuICAgICAgICAgICAgICAgIHRoaXMud2Vla1RleHRzU2F2aW5nSm9iLnRyaWdnZXJDaGFuZ2UoNTAwKTtcclxuICAgICAgICAgICAgICB9IH0vPlxyXG4gICAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuXCJcclxuICAgICAgICAgICAgICB0YWJJbmRleD17MH1cclxuICAgICAgICAgICAgICBzdHlsZT17ZW5hYmxlU2F2ZUJ1dHRvbiA/IHt9IDoge29wYWNpdHk6IDAuNX19XHJcbiAgICAgICAgICAgICAgb25DbGljaz17KCk9PiFpc1NhdmluZyAmJiB0aGlzLndlZWtUZXh0c1NhdmluZ0pvYi50cmlnZ2VyQ2hhbmdlKDApfT5cclxuICAgICAgICAgICAgICAgIDxpIGNsYXNzTmFtZT1cImZhIGZhLWZsb3BweS1vXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgLz5cclxuICAgICAgICAgICAgICAgICAge2VuYWJsZVNhdmVCdXR0b24gPyA8Rm9ybWF0dGVkTWVzc2FnZSBpZD1cImNvbW1vbi5zYXZlXCIgZGVmYXVsdE1lc3NhZ2U9XCIgU3BhcmFcIi8+IDogPEZvcm1hdHRlZE1lc3NhZ2UgaWQ9XCJjb21tb24uc2F2ZWRcIiBkZWZhdWx0TWVzc2FnZT1cIiBTcGFyYWRcIi8+fVxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8L09wZW5DbG9zZUJveD5cclxuXHJcbiAgICAgICAgPC9kaXY+fVxyXG4gICAgICA8L2Rpdj5cclxuICAgICAgPERpYWxvZ3NcclxuICAgICAgICBkaWFsb2dzPXtkaWFsb2dzfVxyXG4gICAgICAgIHBvcERpYWxvZz17KCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKFxyXG4gICAgICAgICAgICAgICh7ZGlhbG9nc30pID0+ICh7IGRpYWxvZ3M6IGRpYWxvZ3Muc2xpY2UoMCwgZGlhbG9ncy5sZW5ndGggLSAxKSB9KSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSAvPlxyXG4gICAgPC9kaXY+XHJcbiAgfVxyXG59IiwiaW1wb3J0ICcuLi8uLi9nbG9iYWwtc2V0dGVycy9zZXQtYWxsJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uLy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmNvbnN0IGJlYXJlclByb21pc2UgPSBlbnYuYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCk7IC8vIFN0YXJ0IGdldHRpbmcgYmVhcmVyIGFzIHNvb24gYXMgcG9zc2libGUuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0ICogYXMgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcclxuaW1wb3J0IHsgQ291cnNlVmlld2VyIH0gZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb3Vyc2Utdmlld2VyJztcclxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcclxuaW1wb3J0IHsgc2hvd0Vycm9yLCBzaG93SW5mbyB9IGZyb20gXCIuLi8uLi91dGlscy91dGlsc1wiO1xyXG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvY291cnNlLWJ1aWxkZXIvc3ViLWNvbXBvbmVudHMvc3Bpbm5lclwiOyAvLyBUT0RPOiBNb3ZlIG91dHNpZGUgb2YgY291cnNlLWJ1aWxkZXIhXHJcbmltcG9ydCB7IExhbmd1YWdlQ29udGV4dCB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL0xhbmd1YWdlQ29udGV4dCc7XHJcbmltcG9ydCB7IEluamVjdGVkSW50bFByb3BzLCBpbmplY3RJbnRsIH0gZnJvbSAncmVhY3QtaW50bCc7XHJcbmltcG9ydCB7IHNldHVwSW50bCB9IGZyb20gJy4uLy4uL2NvbXBvbmVudHMvdXRpbGl0eS1jb21wb25lbnRzL1NldHVwTGFuZ3VhZ2VJbnRsJztcclxuXHJcbmludGVyZmFjZSBQcm9wcyBleHRlbmRzIEluamVjdGVkSW50bFByb3Bze1xyXG59XHJcblxyXG5pbnRlcmZhY2UgU3RhdGUge1xyXG4gIGlzVG9rZW5Mb2FkZWQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNsYXNzIF9LRURBcHBDb3Vyc2VWaWV3ZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsU3RhdGU+IHtcclxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGUgPSB7XHJcbiAgICAgIGlzVG9rZW5Mb2FkZWQ6IGZhbHNlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsTW91bnQoKSB7XHJcbiAgICBiZWFyZXJQcm9taXNlLnRoZW4oKCk9PntcclxuICAgICAgdGhpcy5zZXRTdGF0ZSh7aXNUb2tlbkxvYWRlZDogdHJ1ZX0pO1xyXG4gICAgfSkuY2F0Y2goZXJyID0+IHtcclxuICAgICAgc2hvd0Vycm9yKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHtpbnRsfSA9IHRoaXMucHJvcHM7XHJcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pc1Rva2VuTG9hZGVkID9cclxuICAgICAgPExhbmd1YWdlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17eyBpbnRsIH19PlxyXG4gICAgICAgIDxDb3Vyc2VWaWV3ZXIgY291cnNlQnVpbGRlclVybD17Y2ZnLktFRF9DT1VSU0VfQlVJTERFUl9VUkx9IC8+XHJcbiAgICAgIDwvTGFuZ3VhZ2VDb250ZXh0LlByb3ZpZGVyPiA6XHJcbiAgICAgIDxwPjxTcGlubmVyIC8+Vi5nLiB2w6RudGEuLi4gYXV0ZW50aWNlcmFyLi4uPC9wPlxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IEtFREFwcENvdXJzZVZpZXdlciA9IHNldHVwSW50bChpbmplY3RJbnRsKF9LRURBcHBDb3Vyc2VWaWV3ZXIpKTtcclxuIiwiaW1wb3J0IEtFRCBmcm9tICcuLi8uLi9nbG9iYWxzL0tFRCc7XHJcbmltcG9ydCB7S0VEQXBwQ291cnNlVmlld2VyfSBmcm9tICcuL2FwcC5jb3Vyc2V2aWV3ZXIuY2xpZW50JztcclxuXHJcbi8vIEFkZCBLRURBcHBDb3Vyc2VWaWV3ZXIgdG8gdGhlIHNldCBvZiBjb21wb25lbnRzIGluIEtFRC5jb21wb25lbnRzXHJcbktFRC5jb21wb25lbnRzID0gey4uLktFRC5jb21wb25lbnRzLCBLRURBcHBDb3Vyc2VWaWV3ZXJ9O1xyXG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nIH0gZnJvbSAnLi4vdXRpbHMvcXVlcnktc3RyaW5nJztcclxuaW1wb3J0IEZlYXR1cmVEZXNjcmlwdGlvbnMgZnJvbSAnLi9mZWF0dXJlLWZsYWdzLmpzb24nO1xyXG5pbXBvcnQgeyBjZmcgfSBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5cclxudHlwZSBGZWF0dXJlRmxhZ3MgPSB7cmVhZG9ubHkgW1AgaW4ga2V5b2YgdHlwZW9mIEZlYXR1cmVEZXNjcmlwdGlvbnNdOiBib29sZWFufTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZXMgZXh0ZW5kcyBGZWF0dXJlRmxhZ3Mge31cclxuXHJcbmV4cG9ydCBjbGFzcyBGZWF0dXJlcyB7XHJcbiAgcHJpdmF0ZSBfZmVhdHVyZXM6IEZlYXR1cmVGbGFncztcclxuICBwcml2YXRlIF9pbml0aWFsaXplZCA9IGZhbHNlO1xyXG5cclxuICBpbml0KCkge1xyXG4gICAgaWYgKHRoaXMuX2luaXRpYWxpemVkKSByZXR1cm47XHJcbiAgICBsZXQgdHVybmVkT25GZWF0dXJlcyA9IChjZmcuS0VEX0ZFQVRVUkVTIHx8IFwiXCIpLnNwbGl0KCcsJykubWFwKG5hbWUgPT4gbmFtZS50cmltKCkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICBjb25zdCBxdWVyeSA9IHBhcnNlUXVlcnlTdHJpbmcobG9jYXRpb24uc2VhcmNoLCB7dG9Mb3dlcjogdHJ1ZX0pO1xyXG5cclxuICAgIGlmIChxdWVyeS50ZXN0dmVyc2lvbikge1xyXG4gICAgICB0dXJuZWRPbkZlYXR1cmVzID0gW1wiKlwiXTtcclxuICAgIH1cclxuICAgIGlmIChxdWVyeS5mZWF0dXJlcykge1xyXG4gICAgICB0dXJuZWRPbkZlYXR1cmVzID0gcXVlcnkuZmVhdHVyZXNcclxuICAgICAgICAuc3BsaXQoJywnKVxyXG4gICAgICAgIC5tYXAoZmVhdHVyZSA9PiBmZWF0dXJlLnRyaW0oKS50b0xvd2VyQ2FzZSgpKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHR1cm5PbkFsbCA9IHR1cm5lZE9uRmVhdHVyZXMuaW5jbHVkZXMoJyonKTtcclxuICAgIHRoaXMuX2ZlYXR1cmVzID0ge30gYXMgRmVhdHVyZUZsYWdzO1xyXG4gICAgZm9yIChjb25zdCBmZWF0dXJlTmFtZSBvZiBPYmplY3Qua2V5cyhGZWF0dXJlRGVzY3JpcHRpb25zKSkge1xyXG4gICAgICB0aGlzLl9mZWF0dXJlc1tmZWF0dXJlTmFtZV0gPSB0dXJuT25BbGwgfHxcclxuICAgICAgICB0dXJuZWRPbkZlYXR1cmVzLmluY2x1ZGVzKGZlYXR1cmVOYW1lLnRvTG93ZXJDYXNlKCkpXHJcbiAgICB9XHJcbiAgICB0aGlzLl9pbml0aWFsaXplZCA9IHRydWU7ICAgIFxyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgZm9yIChjb25zdCBmZWF0dXJlTmFtZSBvZiBPYmplY3Qua2V5cyhGZWF0dXJlRGVzY3JpcHRpb25zKSkge1xyXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgZmVhdHVyZU5hbWUsIHtcclxuICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICBpZiAoIXRoaXMuX2luaXRpYWxpemVkKSB0aGlzLmluaXQoKTtcclxuICAgICAgICAgIHJldHVybiB0aGlzLl9mZWF0dXJlc1tmZWF0dXJlTmFtZV07XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQodmFsdWUpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmVhdHVyZSBmbGFncyBjYW5ub3QgYmUgc2V0IGhlcmUnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZmVhdHVyZXMgPSBuZXcgRmVhdHVyZXMoKTtcclxuIiwiZXhwb3J0ICogZnJvbSAnLi9mZWF0dXJlcyc7XHJcbiIsImltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuXHJcbmRlY2xhcmUgdmFyIHByb2Nlc3M6IGFueTtcclxuXHJcbmNmZy5FTlZJUk9OTUVOVCA9IHByb2Nlc3MuZW52LkVOVklST05NRU5UIGFzIFwicHJvZHVjdGlvblwiIHwgXCJkZXZlbG9wbWVudFwiIHwgXCJ0ZXN0XCI7XHJcbmNmZy5LRURfQVBJX1VSTCA9IHByb2Nlc3MuZW52LktFRF9BUElfVVJMOyAvLyBcImh0dHBzOi8va2VkYmFja2VuZHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpL1wiXHJcbmNmZy5FRFNfQVBJX1VSTCA9IHByb2Nlc3MuZW52LkVEU19BUElfVVJMOyAvLyBcImh0dHBzOi8vZWRzcG9ydGFsb3dpbmFwaS5henVyZXdlYnNpdGVzLm5ldC9hcGkvXCJcclxuY2ZnLktFRF9UT0tFTl9VUkwgPSBwcm9jZXNzLmVudi5LRURfVE9LRU5fVVJMOyAvLyBcImh0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW5cIlxyXG5jZmcuS0VEX0NMSUVOVF9JRCA9IHByb2Nlc3MuZW52LktFRF9DTElFTlRfSUQ7IC8vIFwiZGV2Y2xpZW50XCIsIFwidGVzdGNsaWVudFwiLCBcIi4uLlwiXHJcbmNmZy5LRURfQ0xJRU5UX1NFQ1JFVCA9IHByb2Nlc3MuZW52LktFRF9DTElFTlRfU0VDUkVUO1xyXG5jZmcuS0VEX1JFQUxNID0gcHJvY2Vzcy5lbnYuS0VEX1JFQUxNOyAvLyBcIlNFMVwiXHJcbmNmZy5LRURfTE9DQUxFID0gY2ZnLktFRF9MT0NBTEUgfHwgcHJvY2Vzcy5lbnYuS0VEX0xPQ0FMRTsgLy8gXCJzdlwiLCBcImVuXCIuIE9ubHkgc2V0IGZyb20gcHJvY2Vzcy5lbnYgaWYgbm90IHNldCBmcm9tIFNpdGVWaXNpb24gZWxlbWVudCBjb25maWcuXHJcbmNmZy5LRURfU0NIT09MX0xPQ0FMRSA9IGNmZy5LRURfU0NIT09MX0xPQ0FMRSB8fCBwcm9jZXNzLmVudi5LRURfU0NIT09MX0xPQ0FMRTsgLy8gXCJzdlwiLCBcImVuX3NpblwiLCBcImVuX25pblwiLiBPbmx5IHNldCBmcm9tIHByb2Nlc3MuZW52IGlmIG5vdCBzZXQgZnJvbSBTaXRlVmlzaW9uIGVsZW1lbnQgY29uZmlnLlxyXG4iLCIvKiBUaGVzZSBzY3JpcHRzIGFzc3VtZSBzb21lIG9mIHRoZSBnbG9iYWwgdmFycyBoYXZlIGFscmVhZHkgYmVlbiBzZXQ6XHJcbiAgKiBLRUQuY2ZnXHJcbiAgKiBLRUQuZW52LmN1cnJlbnRVc2VyXHJcblxyXG4gIFRoZSByZXN0IHdpbGwgYmUgc2V0IGhlcmUgKGNsaWVudCBzaWRlKVxyXG4qL1xyXG5pbXBvcnQgJy4vY29uZmlndXJlJztcclxuaW1wb3J0ICcuL3NldC1iZWFyZXItcHJvdmlkZXJzJztcclxuaW1wb3J0ICcuL3NldC1rZWQtYmFja2VuZC1jbGllbnQnO1xyXG5pbXBvcnQgJy4vc2V0LWVkcy1jbGllbnQnO1xyXG4iLCJpbXBvcnQgeyBwYXJzZVF1ZXJ5U3RyaW5nLCBnZW5lcmF0ZVF1ZXJ5U3RyaW5nLCBzcGxpdFVybEFuZFF1ZXJ5IH0gZnJvbSBcIi4uL3V0aWxzL3F1ZXJ5LXN0cmluZ1wiO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViLCBXZWJTZXJ2ZXJCZWFyZXJQcm92aWRlciwgaXNvbW9ycGhpYywgc3RvcmFnZSB9IGZyb20gJ2tlZGJhY2tlbmQvY2xpZW50d2ViJztcclxuaW1wb3J0IHsgQmVhcmVyUHJvdmlkZXIsIEtlZEJlYXJlclByb3ZpZGVyIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gXCIuLi9jb250cmFjdHMva2VkLW1vZGVsc1wiO1xyXG5pbXBvcnQgeyBJTVBFUlNPTkFUSU9OX1FVRVJZX1BBUkFNUyB9IGZyb20gXCIuLi9hY2Nlc3MtY29udHJvbC9pbmRleFwiO1xyXG5pbXBvcnQgeyBjaGVycnlQaWNrUHJvcHMgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHNcIjtcclxuXHJcbmZ1bmN0aW9uIGdldE1lcmdlZFRva2VuUGF0aCh0b2tlblBhdGg6IHN0cmluZywgbG9jYXRpb25TZWFyY2g6IHN0cmluZywgc2NvcGVzOiBzdHJpbmdbXSkge1xyXG4gIC8vIE1lcmdlIGNvbmZpZ3VyZWQgcXVlcnkgcGFyYW1zIG9mIHRva2VuIHBhdGggd2l0aCBwYXJhbXMgZ2l2ZW4gdG8gY3VycmVudCBwYWdlXHJcbiAgY29uc3QgY3VycmVudFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaCk7XHJcbiAgY29uc3QgaW1wZXJzb25hdGlvblByb3BzID0gY2hlcnJ5UGlja1Byb3BzKGN1cnJlbnRRdWVyeSwgSU1QRVJTT05BVElPTl9RVUVSWV9QQVJBTVMpO1xyXG4gIGNvbnN0IFt0b2tlblBhdGhXaXRob3V0UXVlcnksIHRva2VuUXVlcnlTdHJpbmddID0gc3BsaXRVcmxBbmRRdWVyeSh0b2tlblBhdGgpO1xyXG4gIGNvbnN0IHRva2VuUGF0aFF1ZXJ5ID0gcGFyc2VRdWVyeVN0cmluZyh0b2tlblF1ZXJ5U3RyaW5nKTtcclxuICByZXR1cm4gdG9rZW5QYXRoV2l0aG91dFF1ZXJ5ICsgZ2VuZXJhdGVRdWVyeVN0cmluZyh7XHJcbiAgICAuLi50b2tlblBhdGhRdWVyeSxcclxuICAgIC4uLmltcGVyc29uYXRpb25Qcm9wcyxcclxuICAgIHNjb3Blczogc2NvcGVzLmpvaW4oJywnKVxyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIHJldHVybiBtZXJnZWRUb2tlblBhdGggKyBcIi9cIiArIHVzZXJFbWFpbDtcclxufVxyXG5cclxuZnVuY3Rpb24gc2F2ZVVzZXJJbmZvKHVzZXI6IFVzZXIsIHRva2VuSWQ6IHN0cmluZykge1xyXG4gIGVudi5jdXJyZW50VXNlciA9IHVzZXI7XHJcbiAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShcInVzZXJJbmZvXCIgKyB0b2tlbklkLCBKU09OLnN0cmluZ2lmeSh1c2VyKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxvYWRVc2VySW5mbyh0b2tlbklkOiBzdHJpbmcpIHtcclxuICBjb25zdCBzdG9yZWRTZXNzaW9uVXNlciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJ1c2VySW5mb1wiICsgdG9rZW5JZCk7XHJcbiAgaWYgKHN0b3JlZFNlc3Npb25Vc2VyKSB7XHJcbiAgICBlbnYuY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKHN0b3JlZFNlc3Npb25Vc2VyKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcclxuICByZXR1cm4gbmV3IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aCwgcmVzcG9uc2VUZXh0ID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XHJcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XHJcbiAgICBpZiAocmVzLnVzZXIpIHtcclxuICAgICAgc2F2ZVVzZXJJbmZvKHJlcy51c2VyLCB0b2tlbklkKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7IHRva2VuOiByZXMudG9rZW4sIGV4cGlyZXM6IERhdGUubm93KCkgKyA1OSAqIDYwICogMTAwMCB9O1xyXG4gIH0sIHRva2VuSWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVHb29nbGVUb2tlblByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aDogc3RyaW5nLCB1c2VyRW1haWw6IHN0cmluZykge1xyXG4gIGNvbnN0IHRva2VuSWQgPSBnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgdXNlckVtYWlsKTtcclxuICByZXR1cm4gbmV3IFdlYlNlcnZlckJlYXJlclByb3ZpZGVyKG1lcmdlZFRva2VuUGF0aCwgcmVzcG9uc2VUZXh0ID0+IHtcclxuICAgIGNvbnN0IHJlcyA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KSBhcyB7IG9rOiBib29sZWFuLCBlcnJvcj86IHN0cmluZywgdG9rZW4/OiBzdHJpbmcsIHVzZXI/OiBVc2VyIH07XHJcbiAgICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKHJlcy5lcnJvcik7XHJcbiAgICByZXR1cm4geyB0b2tlbjogcmVzLnRva2VuLCBleHBpcmVzOiBEYXRlLm5vdygpICsgNTkgKiA2MCAqIDEwMDAgfTtcclxuICB9LCB0b2tlbklkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlVGVzdFRva2VuUHJvdmlkZXIodG9rZW5Vcmw6IHN0cmluZywgdXNlcjogVXNlciwgc2NvcGVzOiBzdHJpbmdbXSkge1xyXG4gIHJldHVybiBuZXcgS2VkQmVhcmVyUHJvdmlkZXIoXHJcbiAgICBpc29tb3JwaGljLFxyXG4gICAgc3RvcmFnZSxcclxuICAgIHRva2VuVXJsICsgdXNlci5tYWlsICsgbG9jYXRpb24uc2VhcmNoLFxyXG4gICAgY2ZnLktFRF9DTElFTlRfSUQsXHJcbiAgICBjZmcuS0VEX0NMSUVOVF9TRUNSRVQsXHJcbiAgICB0b2tlblVybCwge1xyXG4gICAgICBlbWFpbDogdXNlci5tYWlsLnRvTG93ZXJDYXNlKCksXHJcbiAgICAgIHJvbGVzOiB1c2VyLnJvbGVzLFxyXG4gICAgICBzY2hvb2w6IHVzZXIuc2Nob29sLFxyXG4gICAgICBzY2hvb2xUeXBlOiB1c2VyLnNjaG9vbFR5cGUsXHJcbiAgICAgIHNjb3Blc1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIGVudi5jdXJyZW50VXNlci5tYWlsIGlzIHNldCBieSBTaXRlVmlzaW9uIHNlcnZlciBpbml0aWFsbHkuXHJcbi8vIEEgcmVzcG9uc2UgZnJvbSAvYXBpL3Rva2VuIG1heSBjaGFuZ2UgdGhlIG1haWwgYXR0cmlidXRlIG9mIHRoZSBjdXJyZW50XHJcbi8vIHVzZXIsIHNvIGVudi5jdXJyZW50VXNlci5tYWlsIG1heSBiZSBkaWZmZXJlbnQgYWZ0ZXIgZ2V0dGluZyBhIHJlc3BvbnNlLlxyXG4vLyBIb3dldmVyLCB0aGUgaW5pdGlhbCB2YWx1ZSBpcyB2YWx1YWJsZSBhbHdheXMgaW4gb3JkZXIgdG8gZGlzdGluZ3Vpc2ggdGhlIGNhc2VcclxuLy8gd2hlbiBvbmUgbm9ybWFsIHVzZXIgbG9ncyBvdXQgYW5kIGFub3RoZXIgdXNlciBsb2dzIGluLlxyXG5jb25zdCBpbml0aWFsVXNlckVtYWlsID0gZW52LmN1cnJlbnRVc2VyICYmIGVudi5jdXJyZW50VXNlci5tYWlsOyAvLyBJbml0aWFsIHZhbHVlIG9mIG1haWwuIE1heSBjaGFuZ2UuXHJcbmlmIChpbml0aWFsVXNlckVtYWlsKSB7XHJcbiAgLy8gS0VEXHJcbiAgaWYgKGNmZy5LRURfVE9LRU5fUEFUSCkge1xyXG4gICAgLy9cclxuICAgIC8vXHJcbiAgICAvLyBQcm9kdWN0aW9uIC8gU2l0ZVZpc2lvbiBwcm94aWVkIC9hcGkvdG9rZW4gdG8gcmVxdWVzdCB0b2tlbnMgZnJvbTpcclxuICAgIC8vXHJcbiAgICAvL1xyXG4gICAgY29uc3QgbWVyZ2VkVG9rZW5QYXRoID0gZ2V0TWVyZ2VkVG9rZW5QYXRoKFxyXG4gICAgICBjZmcuS0VEX1RPS0VOX1BBVEgsXHJcbiAgICAgIGxvY2F0aW9uLnNlYXJjaCwgW1xyXG4gICAgICAgIFwia2VkYmFja2VuZFwiLFxyXG4gICAgICAgIFwiRURTXCIsXHJcbiAgICAgIF0pO1xyXG4gICAgZW52LmJlYXJlclByb3ZpZGVyID0gY3JlYXRlQmVhcmVyUHJvdmlkZXIobWVyZ2VkVG9rZW5QYXRoLCBpbml0aWFsVXNlckVtYWlsKTtcclxuICAgIGxvYWRVc2VySW5mbyhnZXRUb2tlbklkKG1lcmdlZFRva2VuUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCkpO1xyXG5cclxuICAgIC8vIEdvb2dsZVxyXG4gICAgY29uc3QgZ29vZ2xlTWVyZ2VkUGF0aCA9IGdldE1lcmdlZFRva2VuUGF0aChcclxuICAgICAgY2ZnLktFRF9UT0tFTl9QQVRILFxyXG4gICAgICBsb2NhdGlvbi5zZWFyY2gsIFtcclxuICAgICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcclxuICAgICAgXSk7XHJcbiAgICBlbnYuZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGNyZWF0ZUdvb2dsZVRva2VuUHJvdmlkZXIoZ29vZ2xlTWVyZ2VkUGF0aCwgaW5pdGlhbFVzZXJFbWFpbCk7XHJcbiAgfSBlbHNlIGlmIChjZmcuS0VEX1RPS0VOX1VSTCAmJiBjZmcuS0VEX0NMSUVOVF9JRCAmJiBjZmcuS0VEX0NMSUVOVF9TRUNSRVQpIHtcclxuICAgIC8vXHJcbiAgICAvL1xyXG4gICAgLy8gVGVzdCAtIGdvIGRpcmVjdGx5IHRvIEtFREFVVEggc2VydmVyIHRvIHJldHJpZXZlIHRva2Vuc1xyXG4gICAgLy9cclxuICAgIC8vXHJcbiAgICBlbnYuYmVhcmVyUHJvdmlkZXIgPSBjcmVhdGVUZXN0VG9rZW5Qcm92aWRlcihjZmcuS0VEX1RPS0VOX1VSTCwgZW52LmN1cnJlbnRVc2VyLCBbXHJcbiAgICAgIFwia2VkYmFja2VuZFwiLFxyXG4gICAgICBcIkVEU1wiLFxyXG4gICAgXSk7XHJcbiAgICBlbnYuZ29vZ2xlVG9rZW5Qcm92aWRlciA9IGNyZWF0ZVRlc3RUb2tlblByb3ZpZGVyKGNmZy5LRURfVE9LRU5fVVJMICsgXCIvZ29vZ2xlXCIsIGVudi5jdXJyZW50VXNlciwgW1xyXG4gICAgICBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2F1dGgvY2FsZW5kYXIucmVhZG9ubHlcIixcclxuICAgIF0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3NpbmcgY29uZmlndXJhdGlvbiBwYXJhbWV0ZXIgS0VEX1RPS0VOX1BBVEhgKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4uL2dsb2JhbHMvS0VELmNmZyc7XHJcbmltcG9ydCB7IGlzb21vcnBoaWMgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudHdlYic7XHJcbmltcG9ydCB7IEVkc0NsaWVudCB9IGZyb20gJy4uL2FwaXMvZWRzY2xpZW50JztcclxuXHJcbmVudi5lZHNDbGllbnQgPSBuZXcgRWRzQ2xpZW50IChcclxuICBpc29tb3JwaGljLFxyXG4gIGNmZy5FRFNfQVBJX1VSTCxcclxuICBlbnYuYmVhcmVyUHJvdmlkZXIsXHJcbiAgKCk9PmVudi5jdXJyZW50VXNlci5tYWlsKTtcclxuXHJcbiIsImltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IGNmZyBmcm9tICcuLi9nbG9iYWxzL0tFRC5jZmcnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50V2ViIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnR3ZWInO1xyXG5cclxuZW52LmtlZEJhY2tlbmRDbGllbnQgPSBuZXcgS2VkQmFja2VuZENsaWVudFdlYiAoXHJcbiAgY2ZnLktFRF9BUElfVVJMLFxyXG4gIGVudi5iZWFyZXJQcm92aWRlcik7XHJcblxyXG4iLCJpbXBvcnQgS0VEIGZyb20gJy4vS0VEJztcclxuXHJcbi8qIFRoaXMgZGVmYXVsdCBjb25maWd1cmF0aW9uIGlzIHVzZWQgYXMgYSBmYWxsYmFjay5cclxuTm9ybWFsbHkgYm90aCB0ZXN0IHBhZ2VzIGFuZCBwcm9kdWN0aW9uIHBhZ2VzIHdpbGwgb3ZlcnJpZGUgdGhlc2UgY29uZmlncmF0aW9uc1xyXG4qL1xyXG4vKmNvbnN0IGRlZmF1bHRDb25maWd1cmF0aW9uID0ge1xyXG4gIC8vIEVudmlyb25tZW50XHJcbiAgRU5WSVJPTk1FTlQ6ICdkZXZlbG9wbWVudCcgYXMgJ3Byb2R1Y3Rpb24nIHwgJ2RldmVsb3BtZW50JyB8ICd0ZXN0JyxcclxuICAvLyBBdXRoZW50aWNhdGlvbiBTZXJ2ZXI6XHJcbiAgS0VEX1RPS0VOX1VSTDogJ2h0dHBzOi8va2VkYXV0aHRlc3QuYXp1cmV3ZWJzaXRlcy5uZXQvdG9rZW4nLFxyXG4gIEtFRF9UT0tFTl9QQVRIOiAnL2FwaS90b2tlbi5Ta3JpcHQucG9ydGxldD9zdi5jb250ZW50dHlwZT1hcHBsaWNhdGlvbi9qc29uJyxcclxuICBLRURfQ0xJRU5UX0lEOiAnZGV2Y2xpZW50JyxcclxuICBLRURfQ0xJRU5UX1NFQ1JFVDogJzRmUmRmUXBXdEpxalRXZicsXHJcbiAgLy8gU2VydmljZXM6XHJcbiAgS0VEX0FQSV9VUkw6ICdodHRwczovL2tlZGJhY2tlbmR0ZXN0LmF6dXJld2Vic2l0ZXMubmV0L2FwaS8nLCAgXHJcbiAgRURTX0FQSV9VUkw6ICdodHRwczovL2Vkc3BvcnRhbG93aW5hcGkuYXp1cmV3ZWJzaXRlcy5uZXQvYXBpLydcclxufSovXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElLZWRDb25maWd1cmF0aW9uIHtcclxuICBFTlZJUk9OTUVOVDogJ3Byb2R1Y3Rpb24nIHwgJ2RldmVsb3BtZW50JyB8ICd0ZXN0JztcclxuICBLRURfUkVBTE06IHN0cmluZztcclxuICBLRURfVE9LRU5fVVJMOiBzdHJpbmc7XHJcbiAgS0VEX1RPS0VOX1BBVEg6IHN0cmluZztcclxuICBLRURfQ0xJRU5UX0lEOiBzdHJpbmc7XHJcbiAgS0VEX0NMSUVOVF9TRUNSRVQ6IHN0cmluZztcclxuICBLRURfQVBJX1VSTDogc3RyaW5nO1xyXG4gIEVEU19BUElfVVJMOiBzdHJpbmc7XHJcbiAgS0VEX0xPQ0FMRTogc3RyaW5nO1xyXG4gIEtFRF9TQ0hPT0xfTE9DQUxFOiBzdHJpbmc7XHJcbiAgS0VEX0NPVVJTRV9CVUlMREVSX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9DT1VSU0VfVklFV0VSX1VSTDogc3RyaW5nO1xyXG4gIEtFRF9TVUJKRUNUX1BMQU5ORVJfQURNSU5fVVJMOiBzdHJpbmc7XHJcbiAgS0VEX1NVQkpFQ1RfUExBTk5FUl9VUkw6IHN0cmluZztcclxuICBLRURfRkVBVFVSRVM6IHN0cmluZztcclxufTtcclxuXHJcbmlmICghS0VELmNmZykgS0VELmNmZyA9IHt9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgS0VELmNmZyBhcyBJS2VkQ29uZmlndXJhdGlvbjtcclxuZXhwb3J0IGNvbnN0IGNmZzogSUtlZENvbmZpZ3VyYXRpb24gPSBLRUQuY2ZnO1xyXG4iLCJpbXBvcnQge1VzZXIsIExlYXJuaW5nTW9kdWxlVGFza3N9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuaW1wb3J0IHsgS2VkQmFja2VuZENsaWVudCwgQmVhcmVyUHJvdmlkZXIgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7VXNlclRhc2t9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IHtLZWRSZXBvfSBmcm9tICcuLi9yZXBvcy9rZWQtcmVwbyc7XHJcbmltcG9ydCB7RWRzQ2xpZW50fSBmcm9tICcuLi9hcGlzL2Vkc2NsaWVudCc7XHJcbmltcG9ydCBLRUQgZnJvbSAnLi9rZWQnO1xyXG5pbXBvcnQgeyBLU1Rlcm1QbGFubmVyUmVwbyB9IGZyb20gJy4uL3JlcG9zL2tzLXRlcm1wbGFubmVyLXJlcG8nO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFbnYge1xyXG4gICAgY3VycmVudFVzZXI/OiBVc2VyO1xyXG4gICAgbGVhcm5pbmdNb2R1bGVUYXNrcz86IExlYXJuaW5nTW9kdWxlVGFza3M7XHJcbiAgICBiZWFyZXJQcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xyXG4gICAgZ29vZ2xlVG9rZW5Qcm92aWRlcj86IEJlYXJlclByb3ZpZGVyO1xyXG4gICAga2VkQmFja2VuZENsaWVudD86IEtlZEJhY2tlbmRDbGllbnQ7XHJcbiAgICBlZHNDbGllbnQ/OiBFZHNDbGllbnQ7XHJcbiAgICB1c2VyVGFza3NSZXBvPztcclxuICAgIGhpZGRlbkNvdXJzZXNSZXBvPztcclxuICAgIHdlZWtOb3Rlc1JlcG8/O1xyXG4gICAga2dUZXJtUGxhbm5lclJlcG8/O1xyXG4gICAga3NUZXJtUGxhbm5lclJlcG8/OiBLU1Rlcm1QbGFubmVyUmVwb1xyXG4gICAgdHV0b3JlZDogYm9vbGVhbjtcclxuICAgIGVycm9yPzogRXJyb3I7XHJcbn1cclxuXHJcbmlmICghS0VELmVudikgS0VELmVudiA9IHt9O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgS0VELmVudiBhcyBFbnY7XHJcbmV4cG9ydCBjb25zdCBlbnY6IEVudiA9IEtFRC5lbnY7XHJcbiIsIlxyXG5leHBvcnQgY29uc3QgS0VEX05BTUVTUEFDRSA9IFwiS0VEXCI7XHJcblxyXG5kZWNsYXJlIHZhciBLRUQ6IGFueTtcclxuXHJcbnZhciByZXN1bHQgPSB0eXBlb2YgS0VEID09PSAndW5kZWZpbmVkJyA/IHt9IDogS0VEO1xyXG5cclxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICB3aW5kb3dbS0VEX05BTUVTUEFDRV0gPSByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJlc3VsdDtcclxuIiwiaW1wb3J0IGVudiBmcm9tICcuL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kUmVwbyB9IGZyb20gJ2tlZGJhY2tlbmQvcmVwbyc7XHJcbmltcG9ydCB7IGdldEdsb2JhbElkLCBjcmVhdGVVVUlEIH0gZnJvbSAna2VkYmFja2VuZC9jbGllbnQnO1xyXG5pbXBvcnQgY2ZnIGZyb20gJy4vS0VELmNmZyc7XHJcbmltcG9ydCB7IFNjaG9vbCwgQnJhbmNoIH0gZnJvbSAna2VkYmFja2VuZC9tb2RlbHMnO1xyXG5pbXBvcnQgeyBWYWx1ZSB9IGZyb20gJ2tlZGJhY2tlbmQvb2JzZXJ2YWJsZSc7XHJcblxyXG5leHBvcnQgY29uc3QgZGIgPSBuZXcgS2VkQmFja2VuZFJlcG8oXHJcbiAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxyXG4gICgpPT5lbnYuY3VycmVudFVzZXIgP1xyXG4gICAgZW52LmN1cnJlbnRVc2VyLm1haWwgOlxyXG4gICAgXCJcIixcclxuICAoKT0+ZW52LmN1cnJlbnRVc2VyID9cclxuICAgIGVudi5jdXJyZW50VXNlci5kaXNwbGF5TmFtZSB8fCBlbnYuY3VycmVudFVzZXIubWFpbCA6XHJcbiAgICBcIlwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBnbG9iYWxJZCA9IGdldEdsb2JhbElkKGNmZy5LRURfUkVBTE0pO1xyXG5leHBvcnQgY29uc3QgU2Nob29scyA9IHtcclxuICBzdGFuZGFyZFNjaG9vbDogZGIuc2Nob29scy5uYW1lKFwic3RhbmRhcmRcIikuY2FjaGVPcHRpbWl6ZWQoKS5zaW5nbGUoKSxcclxuICBnZXQgbXlTY2hvb2wgKCkgeyByZXR1cm4gZGIuc2Nob29scy5uYW1lKGVudi5jdXJyZW50VXNlci5zY2hvb2wpLmNhY2hlT3B0aW1pemVkKCkuc2luZ2xlKCk7IH1cclxufTtcclxuZXhwb3J0IGNvbnN0IENvdXJzZUluc3RhbmNlcyA9IHtcclxuICBnZXRCcmFuY2hJZChzY2hvb2w6IFZhbHVlPFNjaG9vbD4sIGNvdXJzZUlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBzY2hvb2wuc3dpdGNoTWFwKHNjaG9vbCA9PlxyXG4gICAgICBkYi5icmFuY2hlc1xyXG4gICAgICAgIC5oYXNFZGdlc0Zyb20oW3NjaG9vbC5vZmZpY2lhbEJyYW5jaElkXSlcclxuICAgICAgICAubmFtZShcImRyYWZ0XCIpXHJcbiAgICAgICAgLnRhZ3MoY291cnNlSWQpXHJcbiAgICAgICAgLmlkc09ubHkoKVxyXG4gICAgICAgIC5tYXAoKHtpZH0pID0+IGlkKVxyXG4gICAgICAgIC50b1ZhbHVlKClcclxuICAgICAgICAubWFwKGlkcyA9PiBpZHMubGVuZ3RoID4gMCA/IGlkc1swXSA6IHVuZGVmaW5lZCkpO1xyXG4gIH0sXHJcblxyXG4gIC8qKiBHZXQgYSBEUkFGVCBicmFuY2ggZm9yIGdpdmVuIGNvdXJzZSBJRCBhbmQgZ2l2ZW4gc2Nob29sLlxyXG4gICAqIElmIHRoZXJlIGlzIG5vdCB5ZXQgc3VjaCBhIGJyYW5jaCwgY3JlYXRlIGl0IHVzaW5nIG11dGF0aW9uc09uRW1wdHkoKSB3aGljaCB3aWxsXHJcbiAgICogbGVhZCB0byB0aGUgQyMgY29kZSBEb2N1bWVudFJlcG9zaXRvcnkuUmVhZE9yTXV0YXRlKCkgdmlhIERvY3VtZW50Q29udHJvbGxlci5cclxuICAgKi9cclxuICBnZXRPckNyZWF0ZUJyYW5jaElkKHNjaG9vbDogVmFsdWU8U2Nob29sPiwgY291cnNlSWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGRiLmNvdXJzZUluc3RhbmNlcy5pZHNPbmx5KCkuaWQoY291cnNlSWQpLnN3aXRjaE1hcCgoKT0+IC8vIFRIaXMgZmlyc3QgbGluZSB2ZXJpZmllcyBjb3Vyc2UgZXhpc3RzLiBJZiBkZWxldGVkLCBkb24ndCB0cnkgdG8gcmVjcmVhdGUgaXRzIGJyYW5jaCFcclxuICAgICAgc2Nob29sLnN3aXRjaE1hcChzY2hvb2wgPT4gXHJcbiAgICAgIGRiLmJyYW5jaGVzXHJcbiAgICAgICAgLmhhc0VkZ2VzRnJvbShbc2Nob29sLm9mZmljaWFsQnJhbmNoSWRdKVxyXG4gICAgICAgIC5uYW1lKFwiZHJhZnRcIilcclxuICAgICAgICAudGFncyhjb3Vyc2VJZClcclxuICAgICAgICAuaWRzT25seSgpXHJcbiAgICAgICAgLm11dGF0aW9uc09uRW1wdHkodHggPT4ge1xyXG4gICAgICAgICAgLy8gVGhlc2UgMiBtdXRhdGlvbnMgd2lsbCBvY2N1ciBzZXJ2ZXIgc2lkZSwgYXRvbWljYWxseS5cclxuICAgICAgICAgIC8vIFdpbGwgYmUgc2VudCBvbiBlYWNoIHJlcXVlc3QgaW4gdGhlIHF1ZXJ5LCBidXQgd2lsbCBvbmx5IGV4ZWN1dGUgaWYgcXVlcnkgcmVzdWx0cyBpbiB6ZXJvIGl0ZW1zLlxyXG4gICAgICAgICAgLy9jb25zb2xlLmxvZyhcIlNjaG9vbDpcIiwgc2Nob29sKTtcclxuICAgICAgICAgIGNvbnN0IGlkID0gY3JlYXRlVVVJRCgpO1xyXG4gICAgICAgICAgdHguYWRkKFwiYnJhbmNoZXNcIiwge1xyXG4gICAgICAgICAgICBpZCxcclxuICAgICAgICAgICAgYWNsOiBbXHJcbiAgICAgICAgICAgICAgXCJyb2xlOlVTRVI6UlwiLFxyXG4gICAgICAgICAgICAgIGBzY2hvb2xSb2xlOiR7c2Nob29sLm5hbWV9L0VNUExPWUVFOlNgXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIG5hbWU6ICdkcmFmdCcsXHJcbiAgICAgICAgICAgIHNjaG9vbElkOiBzY2hvb2wuaWQsXHJcbiAgICAgICAgICAgIHRyZWVQYXJlbnRJZDogc2Nob29sLm9mZmljaWFsQnJhbmNoSWQsXHJcbiAgICAgICAgICAgIHRhZ3M6IFtjb3Vyc2VJZF1cclxuICAgICAgICAgIH0gYXMgQnJhbmNoKTtcclxuICAgICAgICAgIC8vIEFwcHJvdmluZyB0aGUgYnJhbmNoIG1ha2VzIHN1cmUgdGhhdCBpdCB3YXMgY3JlYXRlZCBieSBhbiBFTVBMT1lFRSBvbiBnaXZlbiBzY2hvb2wuXHJcbiAgICAgICAgICB0eC5saW5rMihcImJyYW5jaGVzXCIsIHNjaG9vbC5vZmZpY2lhbEJyYW5jaElkLCBcImFwcHJvdmVkQ2hpbGRyZW5cIiwgaWQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnNpbmdsZSgpXHJcbiAgICAgICAgLm1hcCgoe2lkfSkgPT4gaWQpKSk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0QWxsRGVzY2VuZGFudElkcyhjb3Vyc2VJZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gZGIuY291cnNlQmxvY2tzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKS5jb25jYXQoXHJcbiAgICAgIGRiLmNvdXJzZUNvbnRlbnRzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSkuY29uY2F0KFxyXG4gICAgICBkYi5jb3Vyc2VUYWJzLnRhZ3MoY291cnNlSWQpLmlkc09ubHkoKSkuY29uY2F0KFxyXG4gICAgICBkYi50YXNrcy50YWdzKGNvdXJzZUlkKS5pZHNPbmx5KCkpXHJcbiAgICAgIC5tYXAoeCA9PiB4LmlkKTtcclxuICB9XHJcbn1cclxuIiwiXHJcbmV4cG9ydCBjb25zdCBLRURfTkFNRVNQQUNFID0gXCJLRURcIjtcclxuXHJcbmRlY2xhcmUgdmFyIEtFRDogYW55O1xyXG5cclxudmFyIHJlc3VsdCA9IHR5cGVvZiBLRUQgPT09ICd1bmRlZmluZWQnID8ge30gOiBLRUQ7XHJcblxyXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIEtFRCA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgIHdpbmRvd1tLRURfTkFNRVNQQUNFXSA9IHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcmVzdWx0O1xyXG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCBjZmcgZnJvbSAnLi4vZ2xvYmFscy9LRUQuY2ZnJztcclxuXHJcbmlmIChjZmcuS0VEX0xPQ0FMRSA9PT0gXCJzdlwiKSB7XHJcbiAgICBtb21lbnQudXBkYXRlTG9jYWxlKCdzdicsIHtcclxuICAgICAgICBtb250aHM6ICdqYW51YXJpX2ZlYnJ1YXJpX21hcnNfYXByaWxfbWFqX2p1bmlfanVsaV9hdWd1c3RpX3NlcHRlbWJlcl9va3RvYmVyX25vdmVtYmVyX2RlY2VtYmVyJy5zcGxpdCgnXycpLFxyXG4gICAgICAgIG1vbnRoc1Nob3J0OiAnamFuX2ZlYl9tYXJfYXByX21hal9qdW5fanVsX2F1Z19zZXBfb2t0X25vdl9kZWMnLnNwbGl0KCdfJyksXHJcbiAgICAgICAgd2Vla2RheXM6ICdzw7ZuZGFnX23DpW5kYWdfdGlzZGFnX29uc2RhZ190b3JzZGFnX2ZyZWRhZ19sw7ZyZGFnJy5zcGxpdCgnXycpLFxyXG4gICAgICAgIHdlZWtkYXlzU2hvcnQ6ICdzw7ZuX23DpW5fdGlzX29uc190b3JfZnJlX2zDtnInLnNwbGl0KCdfJyksXHJcbiAgICAgICAgd2Vla2RheXNNaW46ICdzw7ZfbcOlX3RpX29uX3RvX2ZyX2zDticuc3BsaXQoJ18nKSxcclxuICAgICAgICBsb25nRGF0ZUZvcm1hdDoge1xyXG4gICAgICAgICAgICBMVDogJ0hIOm1tJyxcclxuICAgICAgICAgICAgTFRTOiAnSEg6bW06c3MnLFxyXG4gICAgICAgICAgICBMOiAnWVlZWS1NTS1ERCcsXHJcbiAgICAgICAgICAgIExMOiAnRCBNTU1NIFlZWVknLFxyXG4gICAgICAgICAgICBMTEw6ICdEIE1NTU0gWVlZWSBba2wuXSBISDptbScsXHJcbiAgICAgICAgICAgIExMTEw6ICdkZGRkIEQgTU1NTSBZWVlZIFtrbC5dIEhIOm1tJyxcclxuICAgICAgICAgICAgbGxsOiAnRCBNTU0gWVlZWSBISDptbScsXHJcbiAgICAgICAgICAgIGxsbGw6ICdkZGQgRCBNTU0gWVlZWSBISDptbSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNhbGVuZGFyOiB7XHJcbiAgICAgICAgICAgIHNhbWVEYXk6ICdbSWRhZ10gTFQnLFxyXG4gICAgICAgICAgICBuZXh0RGF5OiAnW0ltb3Jnb25dIExUJyxcclxuICAgICAgICAgICAgbGFzdERheTogJ1tJZ8Olcl0gTFQnLFxyXG4gICAgICAgICAgICBuZXh0V2VlazogJ1tQw6VdIGRkZGQgTFQnLFxyXG4gICAgICAgICAgICBsYXN0V2VlazogJ1tJXSBkZGRkW3NdIExUJyxcclxuICAgICAgICAgICAgc2FtZUVsc2U6ICdMJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVsYXRpdmVUaW1lOiB7XHJcbiAgICAgICAgICAgIGZ1dHVyZTogJ29tICVzJyxcclxuICAgICAgICAgICAgcGFzdDogJ2bDtnIgJXMgc2VkYW4nLFxyXG4gICAgICAgICAgICBzOiAnbsOlZ3JhIHNla3VuZGVyJyxcclxuICAgICAgICAgICAgc3M6ICclZCBzZWt1bmRlcicsXHJcbiAgICAgICAgICAgIG06ICdlbiBtaW51dCcsXHJcbiAgICAgICAgICAgIG1tOiAnJWQgbWludXRlcicsXHJcbiAgICAgICAgICAgIGg6ICdlbiB0aW1tZScsXHJcbiAgICAgICAgICAgIGhoOiAnJWQgdGltbWFyJyxcclxuICAgICAgICAgICAgZDogJ2VuIGRhZycsXHJcbiAgICAgICAgICAgIGRkOiAnJWQgZGFnYXInLFxyXG4gICAgICAgICAgICBNOiAnZW4gbcOlbmFkJyxcclxuICAgICAgICAgICAgTU06ICclZCBtw6VuYWRlcicsXHJcbiAgICAgICAgICAgIHk6ICdldHQgw6VyJyxcclxuICAgICAgICAgICAgeXk6ICclZCDDpXInXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkYXlPZk1vbnRoT3JkaW5hbFBhcnNlOiAvXFxkezEsMn0oZXxhKS8sXHJcbiAgICAgICAgb3JkaW5hbDogZnVuY3Rpb24gKG51bWJlcikge1xyXG4gICAgICAgICAgICB2YXIgYiA9IG51bWJlciAlIDEwLFxyXG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gKH5+KG51bWJlciAlIDEwMCAvIDEwKSA9PT0gMSkgPyAnZScgOlxyXG4gICAgICAgICAgICAgICAgICAgIChiID09PSAxKSA/ICdhJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChiID09PSAyKSA/ICdhJyA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYiA9PT0gMykgPyAnZScgOiAnZSc7XHJcbiAgICAgICAgICAgIHJldHVybiBudW1iZXIgKyBvdXRwdXQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB3ZWVrOiB7XHJcbiAgICAgICAgICAgIGRvdzogMSwgLy8gTW9uZGF5IGlzIHRoZSBmaXJzdCBkYXkgb2YgdGhlIHdlZWsuXHJcbiAgICAgICAgICAgIGRveTogNCAgLy8gVGhlIHdlZWsgdGhhdCBjb250YWlucyBKYW4gNHRoIGlzIHRoZSBmaXJzdCB3ZWVrIG9mIHRoZSB5ZWFyLlxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydCBjb25zdCBsb2NhbE1vbWVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBtb21lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKS5sb2NhbGUoY2ZnLktFRF9MT0NBTEUpO1xyXG59XHJcbiIsImltcG9ydCB7IEtlZFJlcG8gfSBmcm9tICcuL2tlZC1yZXBvJztcclxuaW1wb3J0IHsgVXNlckhpZGRlbkNvdXJzZSwgU2Nob29sLCBDb3Vyc2UgfSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcbmltcG9ydCBlbnYgZnJvbSAnLi4vZ2xvYmFscy9LRUQuZW52JztcclxuaW1wb3J0IHsgRURTQ291cnNlIH0gZnJvbSAnLi4vY29udHJhY3RzL2Vkcyc7XHJcbmltcG9ydCB7IHNob3dFcnJvciwgZmxhdHRlbiwgY29tcGFyZVByb3AsIGFycmF5VG9NYXAgfSBmcm9tICcuLi91dGlscy91dGlscyc7XHJcbmltcG9ydCB7IGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IEVEU1BlcmlvZCB9IGZyb20gJy4uL2FwaXMvZWRzY2xpZW50JztcclxuaW1wb3J0IHsgZ2V0U2Nob29sTW9tZW50IH0gZnJvbSAnLi4vdXRpbHMvc2Nob29sLW1vbWVudCc7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuZXhwb3J0IGxldCBoaWRkZW5Db3Vyc2VzUmVwbyA9IGVudi5oaWRkZW5Db3Vyc2VzUmVwbyBhcyBIaWRkZW5Db3Vyc2VzUmVwbztcclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvdXJzZVdpdGhIaWRkZW5TdGF0ZSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICBuYW1lOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbiAgdmlzaWJsZTogYm9vbGVhbjtcclxuICBkZWZhdWx0VmlzaWJsZTogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgSGlkZGVuQ291cnNlc1N1YnNjcmliZXIgPSAoY291cnNlczogQ291cnNlV2l0aEhpZGRlblN0YXRlW10pID0+IHZvaWQ7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFN1YnNjcmliZXJPcHRpb25zIHtcclxuICBmdWxsQ291cnNlOiBib29sZWFuO1xyXG59XHJcblxyXG5jbGFzcyBIaWRkZW5Db3Vyc2VzUmVwbyB7XHJcbiAgcmVzdWx0OiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGVbXSB8IG51bGwgPSBudWxsO1xyXG4gIHN1YnNjcmliZXJzOiB7c3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zfVtdID0gW107XHJcbiAgZnVsbENvdXJzZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIGtlZENvdXJzZXNQcm9taXNlOiBQcm9taXNlPFBhcnRpYWw8Q291cnNlPltdPjtcclxuICBlZHNDb3Vyc2VzUHJvbWlzZTogUHJvbWlzZTxFRFNDb3Vyc2VbXT47XHJcbiAgdXNlckhpZGRlbkNvdXJzZXNQcm9taXNlOiBQcm9taXNlPFVzZXJIaWRkZW5Db3Vyc2VbXT47XHJcbiAga2VkUmVwbzogS2VkUmVwbzxVc2VySGlkZGVuQ291cnNlPjtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmtlZFJlcG8gPSBuZXcgS2VkUmVwbzxVc2VySGlkZGVuQ291cnNlPih7XHJcbiAgICAgIGdldENsaWVudDogKCkgPT4gZW52LmtlZEJhY2tlbmRDbGllbnQsXHJcbiAgICAgIG9wdGltaXN0aWM6IHRydWUsXHJcbiAgICAgIHRhYmxlOiBcInVzZXJoaWRkZW5jb3Vyc2VzXCIsXHJcbiAgICAgIHVzZXI6IGVudi5jdXJyZW50VXNlciA/IGVudi5jdXJyZW50VXNlci5tYWlsIDogXCJcIixcclxuICAgICAgZ2V0UXVlcnlPcHRpb25zOiBhc3luYyAoKSA9PiAoe3JvbGU6IFwiVVNFUlwifSksXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBpbml0UHJvbWlzZSA9IHRoaXMuaW5pdCgpO1xyXG5cclxuICAgIFByb21pc2UuYWxsKFtcclxuICAgICAgaW5pdFByb21pc2UsXHJcbiAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UsXHJcbiAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2VcclxuICAgIF0pLmNhdGNoKGVyciA9PiBzaG93RXJyb3IoZXJyKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBpbml0KCkge1xyXG4gICAgLy8gV2FpdCB0aWxsIHdlIGhhdmUgYSBjdXJyZW50VXNlciB0aGF0IGlzIGFjY3VyYXRlIGFsc28gZm9yIGltcGVyc29uYXRlZCB1c2Vycy5cclxuICAgIGNvbnN0IGJlYXJlclByb21pc2UgPSBlbnYuYmVhcmVyUHJvdmlkZXIgPyBlbnYuYmVhcmVyUHJvdmlkZXIuZ2V0QmVhcmVyKCkgOiBQcm9taXNlLnJlc29sdmUoe30pO1xyXG5cclxuICAgIC8vIEluIHBhcmFsbGVsbCwgd2UgcmVxdWVzdDpcclxuICAgIC8vICAxKSBLRURCYWNrZW5kOiBTY2hvb2xzLmFjdGl2ZUNvdXJzZXNcclxuICAgIC8vICAyKSBFRFMuZ2V0QWN0aXZlQWNvdXJzZXMoKVxyXG4gICAgLy8gIDMpICh2aWEgc3Vic2NyaXB0aW9uKTogS0VEQmFja2VuZDogdXNlckhpZGRlbkNvdXJzZXNcclxuICAgIFxyXG4gICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSA9IGJlYXJlclByb21pc2UudGhlbigoKT0+dGhpcy5saXN0S2VkQ291cnNlcygpKTtcclxuICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2UgPSBiZWFyZXJQcm9taXNlLnRoZW4oKCk9PnRoaXMubGlzdEVEU0NvdXJzZXMoKSk7XHJcbiAgICBsZXQgcmVzb2x2ZVVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTogKHg6IFVzZXJIaWRkZW5Db3Vyc2VbXSk9PnZvaWQ7XHJcbiAgICBsZXQgdXNlckhpZGRlbkNvdXJzZXNSZXNvbHZlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy51c2VySGlkZGVuQ291cnNlc1Byb21pc2UgPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlc29sdmVVc2VySGlkZGVuQ291cnNlc1Byb21pc2UgPSB4ID0+IHtcclxuICAgICAgaWYgKHVzZXJIaWRkZW5Db3Vyc2VzUmVzb2x2ZWQpIHtcclxuICAgICAgICB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSh4KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB1c2VySGlkZGVuQ291cnNlc1Jlc29sdmVkID0gdHJ1ZTtcclxuICAgICAgICByZXNvbHZlKHgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIGF3YWl0IGJlYXJlclByb21pc2U7XHJcblxyXG4gICAgdGhpcy5rZWRSZXBvLm1lbS5zdWJzY3JpYmUoYXN5bmMgdXNlckhpZGRlbkNvdXJzZXMgPT4ge1xyXG4gICAgICAvLyBDaGFuZ2Ugb3IgaW5pdGlhbCB2YWx1ZSByZWFkeSB0byBiZSBub3RpZmllZCBvdXQuXHJcbiAgICAgIC8vIEJ1dCBmaXJzdCwgY2hlY2sgd2UgaGF2ZSBhbGwgdGhlIHJlbGF0ZWQgZGF0YSByZXNwb25zZXMgd2UgbmVlZC5cclxuICAgICAgY29uc3QgW2FjdGl2ZUNvdXJzZXMsIGVkc0FjdGl2ZUNvdXJzZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UsIFxyXG4gICAgICAgIHRoaXMuZWRzQ291cnNlc1Byb21pc2VdKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlZmluZSB0aGUgdGhyZWUgcmVzdWx0cyBpbnRvIGEgc2luZ2xlIHJlc3VsdFxyXG4gICAgICB0aGlzLnJlc3VsdCA9IGF3YWl0IHRoaXMuY3JlYXRlQ291cnNlc0xpc3QoZWRzQWN0aXZlQ291cnNlcywgdXNlckhpZGRlbkNvdXJzZXMsIGFjdGl2ZUNvdXJzZXMpO1xyXG4gICAgICAvLyBOb3RpZnkgb3VyIHN1YnNjcmliZXJzOlxyXG4gICAgICB0aGlzLnN1YnNjcmliZXJzLmZvckVhY2goc3Vic2NyaWJlciA9PiB0aGlzLm5vdGlmeVN1YnNjcmliZXIoc3Vic2NyaWJlci5zdWJzY3JpYmVyLCBzdWJzY3JpYmVyLm9wdGlvbnMpKTtcclxuICAgICAgcmVzb2x2ZVVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZSh1c2VySGlkZGVuQ291cnNlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxpc3RLZWRDb3Vyc2VzKCkge1xyXG4gICAgY29uc3QgZnVsbENvdXJzZSA9IHRoaXMuZnVsbENvdXJzZTtcclxuICAgIGNvbnNvbGUubG9nKFwiRnVsbENvdXJzZTogXCIrIGZ1bGxDb3Vyc2UpO1xyXG4gICAgY29uc3Qgc2Nob29scyA9IGF3YWl0IGVudi5rZWRCYWNrZW5kQ2xpZW50Lmxpc3Q8U2Nob29sPignc2Nob29scycsIHtcclxuICAgICAgcm9sZTogXCJVU0VSXCIsIC8vIFdvcmthcm91bmQgZnJvbSBzaG93aW5nIGFjdGl2YXRlZCB0ZW1wbGF0ZXMgYW1vbmcgY291cnNlcyBvZiB0aGUgc2Nob29sXHJcbiAgICAgIG5hbWU6IGVudi5jdXJyZW50VXNlci5zY2hvb2wsXHJcbiAgICAgIGluY2x1ZGU6IFwiYWN0aXZlQ291cnNlc1wiLFxyXG4gICAgICBmbGFnczogZnVsbENvdXJzZSA/IFtdIDogW1wiaW5jbHVkZUlkc0FuZE5hbWVzT25seVwiXSxcclxuICAgICAgY2FjaGVCdXN0OiBlbnYuY3VycmVudFVzZXIudXNlcm5hbWVcclxuICAgIH0pO1xyXG4gICAgY29uc3QgYWN0aXZlQ291cnNlcyA9IGZsYXR0ZW4oc2Nob29scy5tYXAoc2Nob29sID0+IHNjaG9vbC5hY3RpdmVDb3Vyc2VzKSkuc29ydChjb21wYXJlUHJvcChcIm5hbWVcIikpXHJcbiAgICByZXR1cm4gYWN0aXZlQ291cnNlcztcclxuICB9XHJcblxyXG4gIGxpc3RFRFNDb3Vyc2VzKCk6IFByb21pc2U8RURTQ291cnNlW10gfCBudWxsPiB7XHJcbiAgICBjb25zdCBwZXJpb2ROYW1lID0gbmV3IEVEU1BlcmlvZChnZXRTY2hvb2xNb21lbnQobW9tZW50KCkpKS5wZXJpb2Q7XHJcbiAgICByZXR1cm4gZW52LmN1cnJlbnRVc2VyLnJvbGVzLmluZGV4T2YoJ0VNUExPWUVFJykgPT09IC0xID9cclxuICAgICAgLy8gU1RVREVOVHMgc2hvdWxkLCBieSBkZWZhdWx0LCBvbmx5IHNob3cgY291cnNlcyB0aGF0IGlzIGxpc3RlZCBpbiBFRFNcclxuICAgICAgZW52LmVkc0NsaWVudC5nZXRBY3RpdmVDb3Vyc2VzKHtwZXJpb2ROYW1lfSkgOlxyXG4gICAgICAvLyBFTVBMT1lFRXMgc2hvdWxkLCBieSBkZWZhdWx0LCBzaG93IGFsbCBjb3Vyc2VzIG9uIHNjaG9vbCAtIG5vIG5lZWQgdG8gcXVlcnkgRURTXHJcbiAgICAgIG51bGw7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjcmVhdGVDb3Vyc2VzTGlzdChcclxuICAgIGVkc0FjdGl2ZUNvdXJzZXM6IEVEU0NvdXJzZVtdIHwgbnVsbCxcclxuICAgIHVzZXJIaWRkZW5Db3Vyc2VzOiBVc2VySGlkZGVuQ291cnNlW10sXHJcbiAgICBhY3RpdmVDb3Vyc2VzOiBQYXJ0aWFsPENvdXJzZT5bXSkgOiBQcm9taXNlPENvdXJzZVdpdGhIaWRkZW5TdGF0ZVtdPlxyXG4gIHtcclxuICAgIGNvbnN0IGhpZGRlbkNvdXJzZXNNYXAgPSBhcnJheVRvTWFwKHVzZXJIaWRkZW5Db3Vyc2VzLmZpbHRlcihoYyA9PiAhaGMuc2hvdyksIGhjID0+IGhjLm5hbWUpO1xyXG4gICAgY29uc3QgdmlzaWJsZUNvdXJzZXNNYXAgPSBhcnJheVRvTWFwKHVzZXJIaWRkZW5Db3Vyc2VzLmZpbHRlcihoYyA9PiBoYy5zaG93KSwgaGMgPT4gaGMubmFtZSk7XHJcblxyXG4gICAgY29uc3QgaXNTdHVkZW50ID0gZW52LmN1cnJlbnRVc2VyLnJvbGVzLnNvbWUocm9sZSA9PiByb2xlID09PSAnU1RVREVOVCcpO1xyXG5cclxuICAgIGNvbnN0IGVkc0NvdXJzZU1hcCA9IGVkc0FjdGl2ZUNvdXJzZXMgP1xyXG4gICAgICBhcnJheVRvTWFwKGVkc0FjdGl2ZUNvdXJzZXMsIGMgPT4gYy5uYW1lKSA6XHJcbiAgICAgIHt9O1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UuYWxsKGFjdGl2ZUNvdXJzZXMubWFwKGFzeW5jICh7aWQsIG5hbWUsIGRlc2NyaXB0aW9uLCBtb2RpZmllZEJ5fSkgPT4ge1xyXG5cclxuICAgICAgbGV0IGVkc0NvdXJzZSA9IGVkc0NvdXJzZU1hcFtuYW1lXTtcclxuXHJcbiAgICAgIGxldCBkZWZhdWx0VmlzaWJsZSA9IGlzU3R1ZGVudCA/XHJcbiAgICAgICAgZWRzQ291cnNlICE9IG51bGwgOiAvLyBDb3Vyc2UgbmFtZSBhbHNvIGxpc3RlZCBpbiBFRFNcclxuICAgICAgICB0cnVlOyAvLyBUZWFjaGVycyBub3QgZGVwZW5kZW50IG9uIEVEUyBsaXN0aW5nXHJcblxyXG4gICAgICBsZXQgdmlzaWJsZSA9IGRlZmF1bHRWaXNpYmxlID9cclxuICAgICAgICAhaGlkZGVuQ291cnNlc01hcFtpZF0gOiAvLyBWaXNpYmxlIHVubGVzcyB1c2VyIGhhcyBvdmVycmlkZGVuIHRoYXQuXHJcbiAgICAgICAgISF2aXNpYmxlQ291cnNlc01hcFtpZF07IC8vIEhpZGRlbiB1bmxlc3MgdXNlciBoYXMgb3ZlcnJpZGRlbiB0aGF0LlxyXG4gICAgICBcclxuICAgICAgLy8gUmVzb2x2ZSBkZXNjcmlwdGlvbjpcclxuICAgICAgaWYgKG1vZGlmaWVkQnkgJiYgbW9kaWZpZWRCeS5uYW1lICYmICFkZXNjcmlwdGlvbikge1xyXG4gICAgICAgIGRlc2NyaXB0aW9uID0gYCR7bW9kaWZpZWRCeS5uYW1lfXMgdmVyc2lvbmA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgaWQsXHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICB2aXNpYmxlLFxyXG4gICAgICAgIGRlZmF1bHRWaXNpYmxlXHJcbiAgICAgIH07XHJcbiAgICB9KSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdC5zb3J0KCh7bmFtZTogYX0sIHtuYW1lOiBifSkgPT4gYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDApO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgaGlkZUNvdXJzZShjOiBDb3Vyc2VXaXRoSGlkZGVuU3RhdGUpIHtcclxuICAgIGNvbnN0IG92ZXJyaWRlcyA9IHRoaXMua2VkUmVwby5tZW0uaXRlbXMuZmlsdGVyKGhjID0+IGhjLm5hbWUgPT09IGMuaWQpO1xyXG4gICAgaWYgKGMuZGVmYXVsdFZpc2libGUpIHtcclxuICAgICAgYXdhaXQgdGhpcy5rZWRSZXBvLmluc2VydChbe1xyXG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXHJcbiAgICAgICAgbmFtZTogYy5pZFxyXG4gICAgICB9XSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhd2FpdCB0aGlzLmtlZFJlcG8uZGVsZXRlKG92ZXJyaWRlcy5tYXAob3YgPT4gb3YuaWQpKTsgICAgICBcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIHNob3dDb3Vyc2UoYzogQ291cnNlV2l0aEhpZGRlblN0YXRlKSB7XHJcbiAgICBjb25zdCBvdmVycmlkZXMgPSB0aGlzLmtlZFJlcG8ubWVtLml0ZW1zLmZpbHRlcihoYyA9PiBoYy5uYW1lID09PSBjLmlkKTtcclxuICAgIGlmIChjLmRlZmF1bHRWaXNpYmxlKSB7XHJcbiAgICAgIGF3YWl0IHRoaXMua2VkUmVwby5kZWxldGUob3ZlcnJpZGVzLm1hcChvdiA9PiBvdi5pZCkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgdGhpcy5rZWRSZXBvLmluc2VydChbe1xyXG4gICAgICAgIGlkOiBjcmVhdGVVVUlEKCksXHJcbiAgICAgICAgbmFtZTogYy5pZCxcclxuICAgICAgICBzaG93OiB0cnVlXHJcbiAgICAgIH1dKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5vdGlmeVN1YnNjcmliZXIgPSAoc3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIsIG9wdGlvbnM6IFN1YnNjcmliZXJPcHRpb25zKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBzdWJzY3JpYmVyKG9wdGlvbnMuZnVsbENvdXJzZSA/IHRoaXMucmVzdWx0IDogdGhpcy5yZXN1bHQuZmlsdGVyKGMgPT4gYy52aXNpYmxlKSk7XHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgc3Vic2NyaWJlIChzdWJzY3JpYmVyOiBIaWRkZW5Db3Vyc2VzU3Vic2NyaWJlciwgb3B0aW9uczogU3Vic2NyaWJlck9wdGlvbnMpIHtcclxuICAgIGlmICghdGhpcy5mdWxsQ291cnNlICYmIG9wdGlvbnMuZnVsbENvdXJzZSkge1xyXG4gICAgICAvLyBUaGUgc3Vic2NyaWJlciBkZW1hbmRzIGZ1bGwgY291cnNlc1xyXG4gICAgICAvLyBOZWVkIHRvIHF1ZXJ5IHRoYXQgYmVmb3JlIG5vdGlmeWluZ1xyXG4gICAgICAvLyBBbHNvIGFmZmVjdCBzdGF0ZSBmb3IgZnV0dXJlIGludGVybmFsIG5vdGlmaWNhdGlvblxyXG4gICAgICB0aGlzLmZ1bGxDb3Vyc2UgPSBvcHRpb25zLmZ1bGxDb3Vyc2U7XHJcbiAgICAgIHRoaXMua2VkQ291cnNlc1Byb21pc2UgPSB0aGlzLmxpc3RLZWRDb3Vyc2VzKCk7IC8vIFJlZG8gdGhpcyBjYWxsLCBub3cgbG9hZGluZyBmdWxsIGNvdXJzZXNcclxuICAgICAgLy8gV2FpdCBmb3IgYWxsIG91dHN0YW5kaW5nIGZldGNoKCkgY2FsbHMgdG8gY29tcGxldGU6XHJcbiAgICAgIGNvbnN0IFthY3RpdmVDb3Vyc2VzLCBlZHNBY3RpdmVDb3Vyc2VzLCB1c2VySGlkZGVuQ291cnNlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgdGhpcy5rZWRDb3Vyc2VzUHJvbWlzZSwgXHJcbiAgICAgICAgdGhpcy5lZHNDb3Vyc2VzUHJvbWlzZSxcclxuICAgICAgICB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZV0pO1xyXG4gICAgICAvLyBBc3NlbWJsZSByZXN1bHQ6XHJcbiAgICAgIHRoaXMucmVzdWx0ID0gYXdhaXQgdGhpcy5jcmVhdGVDb3Vyc2VzTGlzdChlZHNBY3RpdmVDb3Vyc2VzLCB1c2VySGlkZGVuQ291cnNlcywgYWN0aXZlQ291cnNlcyk7XHJcbiAgICB9XHJcbiAgICBhd2FpdCB0aGlzLnVzZXJIaWRkZW5Db3Vyc2VzUHJvbWlzZTsgLy8gU28gd2Uga25vdyB0aGF0IHRoaXMucmVzdWx0IGlzIHRoZXJlLlxyXG4gICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVyKHN1YnNjcmliZXIsIG9wdGlvbnMpO1xyXG4gICAgdGhpcy5zdWJzY3JpYmVycy5wdXNoKHtzdWJzY3JpYmVyLCBvcHRpb25zfSk7XHJcbiAgfVxyXG5cclxuICB1bnN1YnNjcmliZSAoc3Vic2NyaWJlcjogSGlkZGVuQ291cnNlc1N1YnNjcmliZXIpIHtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlcihzID0+IHMuc3Vic2NyaWJlciAhPT0gc3Vic2NyaWJlcik7XHJcbiAgfVxyXG59XHJcblxyXG5pZiAoIWhpZGRlbkNvdXJzZXNSZXBvKSB7XHJcbiAgaGlkZGVuQ291cnNlc1JlcG8gPSBlbnYuaGlkZGVuQ291cnNlc1JlcG8gPSBuZXcgSGlkZGVuQ291cnNlc1JlcG8oKTtcclxufVxyXG4iLCJpbXBvcnQgeyBSZXBvLCBSZXBvQ29tbXVuaWNhdG9yfSBmcm9tICcuL3JlcG8nO1xyXG5pbXBvcnQgeyBLZWRCYWNrZW5kQ2xpZW50LCBMaXN0T3B0aW9ucywgQmF0Y2hSdW5uZXIsIGNyZWF0ZVVVSUQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IERvY3VtZW50fSBmcm9tICdrZWRiYWNrZW5kL21vZGVscyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEtlZFJlcG9PcHRpb25zPFQgZXh0ZW5kcyBEb2N1bWVudD4ge1xyXG4gIGdldENsaWVudDogKCk9PktlZEJhY2tlbmRDbGllbnQ7XHJcbiAgZ2V0UXVlcnlPcHRpb25zOiAoKT0+UHJvbWlzZTxMaXN0T3B0aW9ucz47XHJcbiAgb3B0aW1pc3RpYzogYm9vbGVhbjtcclxuICB0YWJsZTogc3RyaW5nO1xyXG4gIHVzZXI6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEtlZFJlcG88VCBleHRlbmRzIERvY3VtZW50PiB7XHJcbiAgbWVtOiBSZXBvPFQ+O1xyXG4gIG9wdGlvbnM6IEtlZFJlcG9PcHRpb25zPFQ+O1xyXG4gIFxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEtlZFJlcG9PcHRpb25zPFQ+KSB7XHJcbiAgICBjb25zdCB7dGFibGUsIGdldENsaWVudCwgZ2V0UXVlcnlPcHRpb25zfSA9IG9wdGlvbnM7XHJcbiAgICB0aGlzLm1lbSA9IG5ldyBSZXBvPFQ+KHtxdWVyeTogYXN5bmMgKCk9PntcclxuICAgICAgY29uc3QgcXVlcnlPcHRpb25zID0gYXdhaXQgZ2V0UXVlcnlPcHRpb25zKCk7XHJcbiAgICAgIHJldHVybiBhd2FpdCBnZXRDbGllbnQoKS5saXN0PFQ+KHRhYmxlLCB7XHJcbiAgICAgICAgLi4ucXVlcnlPcHRpb25zLFxyXG4gICAgICAgIGNhY2hlQnVzdDogdGhpcy5nZXRDYWNoZUJ1c3QoKX0pO1xyXG4gICAgfX0pO1xyXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0Q2FjaGVCdXN0KCkge1xyXG4gICAgY29uc3Qge3RhYmxlLCB1c2VyfSA9IHRoaXMub3B0aW9ucztcclxuICAgIGNvbnN0IGNhY2hlQnVzdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWNoZS1idXN0LScgKyB0YWJsZSArICctJyArIHVzZXIpO1xyXG4gICAgcmV0dXJuIGNhY2hlQnVzdCB8fCB0aGlzLnJlZ2VuZXJhdGVDYWNoZUJ1c3QoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVnZW5lcmF0ZUNhY2hlQnVzdCgpIHtcclxuICAgIGNvbnN0IHt0YWJsZSwgdXNlcn0gPSB0aGlzLm9wdGlvbnM7XHJcbiAgICBjb25zdCBjYWNoZUJ1c3QgPSBjcmVhdGVVVUlEKCk7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FjaGUtYnVzdC0nICsgdGFibGUgKyAnLScgKyB1c2VyLCBjYWNoZUJ1c3QpO1xyXG4gICAgcmV0dXJuIGNhY2hlQnVzdDtcclxuICB9XHJcblxyXG4gIGFzeW5jIHVwc2VydChpdGVtOiBULCB1cGRhdGVyOiAoaXRlbTogVCkgPT4gdm9pZCkge1xyXG4gICAgaWYgKCFpdGVtLiRldGFnKSB7XHJcbiAgICAgIC8vIEl0ZW1zIHdpdGhvdXQgJGV0YWcgY2Fubm90IGJlIHJldHJpZXZlZCBmcm9tIHNlcnZlciwgc28gaXQgc2hvdWxkIGJlIGluc2VydGVkLlxyXG4gICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pO1xyXG4gICAgICB1cGRhdGVyKHVwZGF0ZWRJdGVtKTtcclxuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaW5zZXJ0KFt1cGRhdGVkSXRlbV0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gV2UgaGF2ZSBhbiAkZXRhZywgc28gd2UgY2FuIGV4cGVjdCBpdCB0byBsaXZlIG9uIHRoZSBzZXJ2ZXIuXHJcbiAgICAgIC8vIEhvd2V2ZXIsIHRha2UgY2FyZSBvZiB0aGUgdW5saWtlbHkgc2l0dWF0aW9uIHRoYXQgaXQgd2FzIGRlbGV0ZWQgZnJvbSBzZXJ2ZXIsXHJcbiAgICAgIC8vIGFuZCBpZiBzbywgaW5zZXJ0IGl0IGFnYWluLlxyXG4gICAgICBhd2FpdCB0aGlzLnVwZGF0ZShbaXRlbV0sIHVwZGF0ZXIpLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgIGlmIChlLm5hbWUgPT09IFwiaHR0cDQwNFwiKSB7XHJcbiAgICAgICAgICBjb25zdCB1cGRhdGVkSXRlbSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pO1xyXG4gICAgICAgICAgdXBkYXRlcih1cGRhdGVkSXRlbSk7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5pbnNlcnQoW3VwZGF0ZWRJdGVtXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyB1cGRhdGUoaXRlbXM6IFRbXSwgdXBkYXRlcjogKGl0ZW06IFQpID0+IHZvaWQpIHtcclxuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlfSA9IHRoaXMub3B0aW9ucztcclxuICAgIGNvbnN0IGNsaWVudCA9IGdldENsaWVudCgpO1xyXG4gICAgY29uc3QgbW9kaWZpZWRJdGVtczogVFtdID0gaXRlbXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICBjb25zdCBtZW1SZXBvSXRlbSA9IHRoaXMubWVtLml0ZW1zLmZpbmQoaXQgPT4gaXQuaWQgPT09IGl0ZW0uaWQpO1xyXG4gICAgICBpdGVtID0gT2JqZWN0LmFzc2lnbih7fSwgbWVtUmVwb0l0ZW0gfHwgaXRlbSk7XHJcbiAgICAgIHVwZGF0ZXIoaXRlbSk7XHJcbiAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgfSk7XHJcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKG1vZGlmaWVkSXRlbXMubWFwKHggPT4gT2JqZWN0LmFzc2lnbih7fSwgeCwgeyRtZXRhOiAndXBkYXRpbmcnfSkpKTtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNsaWVudC5kbyAoYnIgPT4gbW9kaWZpZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4gYnIucHV0KHRhYmxlLCBpdGVtKSkpXHJcbiAgICAuY2F0Y2goZSA9PiBlLm5hbWUgPT09IFwiaHR0cDQwOVwiID8gLy8gY29uZmxpY3RcclxuICAgICAgLy8gR2V0IGEgZnJlc2ggdmVyc2lvbiBmcm9tIHNlcnZlcjpcclxuICAgICAgY2xpZW50Lmxpc3Q8VD4odGFibGUsIHtpZHM6IGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uaWQpfSwge2NhY2hlOiAnbm8tY2FjaGUnfSkudGhlbihmcmVzaEl0ZW1zID0+IHtcclxuICAgICAgICAvLyBVcGRhdGUgbG9jYWwgdmVyc2lvbjpcclxuICAgICAgICBjb25zdCBtb2RpZmllZEl0ZW1zID0gZnJlc2hJdGVtcy5tYXAoZnJlc2hJdGVtID0+IHtcclxuICAgICAgICAgIC8vIENsb25lIHRoZSBmcmVzaCBpdGVtXHJcbiAgICAgICAgICBjb25zdCBtb2RpZmllZCA9IE9iamVjdC5hc3NpZ24oe30sIGZyZXNoSXRlbSk7XHJcbiAgICAgICAgICAvLyBSZS1ydW4gdGhlIHVwZGF0ZXIgb24gdGhlIGNsb25lOlxyXG4gICAgICAgICAgdXBkYXRlcihtb2RpZmllZCk7XHJcbiAgICAgICAgICByZXR1cm4gbW9kaWZpZWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gUmUtZG8gdGhlIHRoZSBwdXQgb3BlcmF0aW9uIHRvd2FyZHMgdGhlIHNlcnZlci5cclxuICAgICAgICByZXR1cm4gY2xpZW50LmRvKGJyID0+IG1vZGlmaWVkSXRlbXMuZm9yRWFjaChpdGVtID0+IGJyLnB1dCh0YWJsZSwgaXRlbSkpKTtcclxuICAgICAgfSkgOlxyXG4gICAgICAvLyBPdGhlciB1bmV4cGVjdGVkIGVycm9yOlxyXG4gICAgICBQcm9taXNlLnJlc29sdmUob3B0aW1pc3RpYyAmJlxyXG4gICAgICAgIHRoaXMubWVtLnVwZGF0ZShpdGVtcykpIC8vIFVuZG8gb3B0aW1pc3RpYyB1cGRhdGVcclxuICAgICAgLnRoZW4oKCk9PntcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7IC8vIFJlamVjdCB3aXRoIHRoZSBlcnJvciBubyBtYXR0ZXIuXHJcbiAgICAgIH0pKTtcclxuICAgIHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xyXG4gICAgbW9kaWZpZWRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICBpdGVtLiRldGFnID0gcmVzLm5ld0V0YWdzW2l0ZW0uaWRdO1xyXG4gICAgICBpdGVtLiRtZXRhID0gdW5kZWZpbmVkO1xyXG4gICAgfSk7XHJcbiAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUobW9kaWZpZWRJdGVtcyk7IC8vIEVuc3VyZXMgbmV3IGV0YWcgaXMgaXMgYXBwbGllZCBvbiBuZXh0IGFjdGlvbi5cclxuICB9XHJcblxyXG4gIHN0cmlwR3JhcGhzIChpdGVtczogVFtdLCBncmFwaHM6IHN0cmluZ1tdKSB7XHJcbiAgICByZXR1cm4gaXRlbXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICBjb25zdCBjbG9uZSA9IE9iamVjdC5hc3NpZ24oe30sIGl0ZW0pO1xyXG4gICAgICBncmFwaHMuZm9yRWFjaChncmFwaCA9PiB7XHJcbiAgICAgICAgaWYgKGl0ZW1bZ3JhcGhdKSB7XHJcbiAgICAgICAgICBjbG9uZVtncmFwaF0gPSAoaXRlbVtncmFwaF0gYXMge2lkOnN0cmluZ31bXSkubWFwIChkb2MgPT4gKHtpZDogZG9jLmlkfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBjbG9uZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgaW5zZXJ0KGl0ZW1zOiBUW10pIHtcclxuICAgIGNvbnN0IHtnZXRDbGllbnQsIG9wdGltaXN0aWMsIHRhYmxlLCBnZXRRdWVyeU9wdGlvbnN9ID0gdGhpcy5vcHRpb25zO1xyXG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XHJcbiAgICBjb25zdCBxdWVyeU9wdGlvbnMgPSBhd2FpdCBnZXRRdWVyeU9wdGlvbnMoKTtcclxuICAgIGNvbnN0IGdyYXBocyA9IFtdLmNvbmNhdChxdWVyeU9wdGlvbnMuaW5jbHVkZSk7XHJcbiAgICAvLyBHaXZlIElEcyB0byBlYWNoIGl0ZW06XHJcbiAgICBpdGVtcyA9IGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uaWQgPyBpdGVtIDogT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwge2lkOiBjcmVhdGVVVUlEKCl9KSk7XHJcbiAgICBjb25zdCBzdHJpcHBlZCA9IHRoaXMuc3RyaXBHcmFwaHMoaXRlbXMsIGdyYXBocyk7XHJcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0uaW5zZXJ0KHN0cmlwcGVkLm1hcCh4ID0+IE9iamVjdC5hc3NpZ24oe30sIHgsIHskbWV0YTogJ2FkZGluZyd9KSkpO1xyXG4gICAgY29uc3QgYnIgPSBuZXcgQmF0Y2hSdW5uZXIoKTtcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBzdHJpcHBlZCkge1xyXG4gICAgICAvLyBBbHNvIGFkZCBsaW5rcyB0byBhbGwgZm9yZWlnbiByZWxhdGVkIGl0ZW1zOlxyXG4gICAgICBmb3IgKGNvbnN0IGdyYXBoIG9mIGdyYXBocykge1xyXG4gICAgICAgIGNvbnN0IGZvcmVpZ25JdGVtczogRG9jdW1lbnRbXSA9IGl0ZW1bZ3JhcGhdO1xyXG4gICAgICAgIGlmIChmb3JlaWduSXRlbXMpIHtcclxuICAgICAgICAgIGZvcmVpZ25JdGVtcy5mb3JFYWNoKGRvYyA9PiB7XHJcbiAgICAgICAgICAgIGJyLmxpbmsyKHRhYmxlLCBpdGVtLmlkLCBncmFwaCwgZG9jLmlkKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBici5hZGQodGFibGUsIGl0ZW0pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcmVzID0gYXdhaXQgY2xpZW50LmJhdGNoKGJyLm11dGF0aW9uUmVxdWVzdHMpLmNhdGNoKGUgPT4ge1xyXG4gICAgICBpZiAob3B0aW1pc3RpYykgdGhpcy5tZW0uZGVsZXRlKGl0ZW1zLm1hcChpdGVtID0+IGl0ZW0uaWQpKTtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xyXG4gICAgfSlcclxuICAgIHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xyXG4gICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IGl0ZW0uJGV0YWcgPSByZXMubmV3RXRhZ3NbaXRlbS5pZF0pO1xyXG4gICAgaWYgKG9wdGltaXN0aWMpXHJcbiAgICAgIGF3YWl0IHRoaXMubWVtLnVwZGF0ZShpdGVtcyk7IC8vIFVwZGF0ZSB3aXRoIG5ldyAkZXRhZy5cclxuICAgIGVsc2VcclxuICAgICAgYXdhaXQgdGhpcy5tZW0uaW5zZXJ0KGl0ZW1zKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGRlbGV0ZSAoaWRzOiBzdHJpbmdbXSkge1xyXG4gICAgY29uc3Qge2dldENsaWVudCwgb3B0aW1pc3RpYywgdGFibGV9ID0gdGhpcy5vcHRpb25zO1xyXG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XHJcbiAgICBpZiAob3B0aW1pc3RpYykgYXdhaXQgdGhpcy5tZW0udXBkYXRlKGlkc1xyXG4gICAgICAubWFwKGlkID0+IHRoaXMubWVtLml0ZW1zLmZpbmQoeCA9PiB4LmlkID09PSBpZCkpXHJcbiAgICAgIC5maWx0ZXIoeCA9PiB4KVxyXG4gICAgICAubWFwKHggPT4gT2JqZWN0LmFzc2lnbih7fSwgeCwgeyRtZXRhOiAnZGVsZXRpbmcnfSkpKTtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNsaWVudC5kbyAoYnIgPT4gaWRzLmZvckVhY2goaWQgPT4gYnIuZGVsZXRlKHRhYmxlLCBpZCkpKS5jYXRjaChhc3luYyBlID0+IHtcclxuICAgICAgaWYgKG9wdGltaXN0aWMpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLm1lbS51cGRhdGUoaWRzXHJcbiAgICAgICAgICAubWFwKGlkID0+IHRoaXMubWVtLml0ZW1zLmZpbmQoeCA9PiB4LmlkID09PSBpZCkpXHJcbiAgICAgICAgICAuZmlsdGVyKHggPT4geClcclxuICAgICAgICAgIC5tYXAoeCA9PiB7XHJcbiAgICAgICAgICAgIHggPSBPYmplY3QuYXNzaWduKHt9LCB4KTtcclxuICAgICAgICAgICAgZGVsZXRlIHguJG1ldGE7XHJcbiAgICAgICAgICAgIHJldHVybiB4O1xyXG4gICAgICAgICAgfSkpO1xyXG4gICAgICB9XHJcbiAgICAgIHRocm93IGU7XHJcbiAgICB9KTtcclxuICAgIHRoaXMucmVnZW5lcmF0ZUNhY2hlQnVzdCgpO1xyXG4gICAgYXdhaXQgdGhpcy5tZW0uZGVsZXRlKGlkcyk7XHJcbiAgfVxyXG59XHJcbiIsIlxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSZXBvQ29tbXVuaWNhdG9yPFQgZXh0ZW5kcyB7aWQ6IHN0cmluZ30+IHtcclxuICBxdWVyeSgpOiBQcm9taXNlPFRbXT47XHJcbn1cclxuXHJcbnR5cGUgU3Vic2NyaWJlcjxUPiA9IChpdGVtczpUW10sIGVycm9yOiB1bmRlZmluZWQgfCBFcnJvcikgPT4gYW55O1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlcG88VCBleHRlbmRzIHtpZDogc3RyaW5nfT4ge1xyXG4gIGxpc3RQcm9taXNlOiBQcm9taXNlPHZvaWQ+O1xyXG4gIGl0ZW1zOiBUW107XHJcbiAgZXJyb3I/OiBFcnJvcjtcclxuICBzdWJzY3JpYmVyczogU3Vic2NyaWJlcjxUPltdO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgY29tbTogUmVwb0NvbW11bmljYXRvcjxUPikge1xyXG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aGlzLml0ZW1zID0gbnVsbDtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSBbXTtcclxuICB9XHJcblxyXG4gIHN1YnNjcmliZShzdWJzY3JpYmVyOiBTdWJzY3JpYmVyPFQ+KSB7XHJcbiAgICByZXR1cm4gdGhpcy5lbnN1cmVIYXNEYXRhKCkudGhlbigoKT0+e1xyXG4gICAgICBzdWJzY3JpYmVyKHRoaXMuaXRlbXMsIHRoaXMuZXJyb3IpO1xyXG4gICAgICB0aGlzLnN1YnNjcmliZXJzLnB1c2goc3Vic2NyaWJlcik7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVuc3Vic2NyaWJlKHN1YnNjcmliZXI6IFN1YnNjcmliZXI8VD4pIHtcclxuICAgIHRoaXMuc3Vic2NyaWJlcnMgPSB0aGlzLnN1YnNjcmliZXJzLmZpbHRlciAocyA9PiBzICE9PSBzdWJzY3JpYmVyKTtcclxuICB9XHJcblxyXG4gIG5vdGlmeVN1YnNjcmliZXJzKCkge1xyXG4gICAgdGhpcy5zdWJzY3JpYmVycy5mb3JFYWNoKHMgPT4gcyh0aGlzLml0ZW1zLCB0aGlzLmVycm9yKSk7XHJcbiAgfVxyXG5cclxuICBlbnN1cmVIYXNEYXRhKCkge1xyXG4gICAgaWYgKCF0aGlzLmxpc3RQcm9taXNlKSB0aGlzLnJlZnJlc2hGcm9tU2VydmVyKCk7XHJcbiAgICByZXR1cm4gdGhpcy5saXN0UHJvbWlzZTtcclxuICB9XHJcblxyXG4gIHJlZnJlc2hGcm9tU2VydmVyKCkge1xyXG4gICAgdGhpcy5saXN0UHJvbWlzZSA9IHRoaXMuY29tbS5xdWVyeSgpLnRoZW4oaXRlbXMgPT4ge1xyXG4gICAgICB0aGlzLml0ZW1zID0gaXRlbXM7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xyXG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICB9KS5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMgfHwgW107XHJcbiAgICAgIHRoaXMubm90aWZ5U3Vic2NyaWJlcnMoKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMubGlzdFByb21pc2U7XHJcbiAgfVxyXG4gIFxyXG4gIGFzeW5jIHVwZGF0ZShpdGVtOiBUIHwgVFtdKSB7XHJcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUhhc0RhdGEoKTtcclxuICAgIGNvbnN0IHVwZGF0ZWRJdGVtcyA9IEFycmF5LmlzQXJyYXkoaXRlbSkgPyBpdGVtIDogW2l0ZW1dO1xyXG4gICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMubWFwKGl0ID0+IHtcclxuICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSB1cGRhdGVkSXRlbXMuZmluZCgoe2lkfSkgPT4gaXQuaWQgPT09IGlkKTtcclxuICAgICAgcmV0dXJuIHVwZGF0ZWRJdGVtID9cclxuICAgICAgICBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkSXRlbSkgOlxyXG4gICAgICAgIGl0O1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgfVxyXG5cclxuICBpbnNlcnQoaXRlbTogVCB8IFRbXSkge1xyXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuY29uY2F0KGl0ZW0pO1xyXG4gICAgICB0aGlzLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZShpZDogc3RyaW5nIHwgc3RyaW5nW10pIHtcclxuICAgIGNvbnN0IGlkcyA9IEFycmF5LmlzQXJyYXkoaWQpID8gaWQgOiBbaWRdO1xyXG4gICAgcmV0dXJuIHRoaXMuZW5zdXJlSGFzRGF0YSgpLnRoZW4oKCk9PntcclxuICAgICAgdGhpcy5pdGVtcyA9IHRoaXMuaXRlbXMuZmlsdGVyKGl0ID0+ICFpZHMuc29tZShpZCA9PiBpdC5pZCA9PT0gaWQpKTtcclxuICAgICAgdGhpcy5ub3RpZnlTdWJzY3JpYmVycygpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7S2VkUmVwb30gZnJvbSAnLi9rZWQtcmVwbyc7XHJcbmltcG9ydCB7IFVzZXJUYXNrLCBVc2VyU3ViVGFzayB9IGZyb20gJ2tlZGJhY2tlbmQvbW9kZWxzJztcclxuaW1wb3J0IGVudiBmcm9tICcuLi9nbG9iYWxzL0tFRC5lbnYnO1xyXG5pbXBvcnQgeyBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvd2Vla3BsYW5uZXIvd2Vla3BsYW5uZXItcGVyc2lzdGVkLXN0YXRlXCI7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IHsgY3JlYXRlVVVJRCwgRG9jdW1lbnRBY2Nlc3MsIEtlZEJhY2tlbmRDbGllbnQgfSBmcm9tICdrZWRiYWNrZW5kL2NsaWVudCc7XHJcbmltcG9ydCB7IGdldEFkanVzdGVkV2VlaywgS0VEV2VlayB9IGZyb20gJy4uL3V0aWxzL3dlZWt1dGlsJztcclxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uL2NvbnRyYWN0cy9rZWQtbW9kZWxzJztcclxuXHJcbmV4cG9ydCBsZXQgdXNlclRhc2tzUmVwbyA9IGVudi51c2VyVGFza3NSZXBvIGFzIFVzZXJUYXNrc1JlcG87XHJcblxyXG5leHBvcnQgY2xhc3MgVXNlclRhc2tzUmVwbyBleHRlbmRzIEtlZFJlcG88VXNlclRhc2s+IHtcclxuICBwZXJzaXN0ZWRTdGF0ZTogV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZSB8IG51bGw7XHJcbiAgZ2V0Q3VycmVudFVzZXI6ICgpPT5Vc2VyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihnZXRDbGllbnQ6ICgpPT5LZWRCYWNrZW5kQ2xpZW50LCBnZXRDdXJyZW50VXNlcjogKCk9PlVzZXIpIHsgICAgXHJcbiAgICBzdXBlcih7XHJcbiAgICAgIGdldENsaWVudCxcclxuICAgICAgb3B0aW1pc3RpYzogdHJ1ZSxcclxuICAgICAgdGFibGU6IFwidXNlcnRhc2tzXCIsXHJcbiAgICAgIHVzZXI6IGdldEN1cnJlbnRVc2VyKCkgPyBnZXRDdXJyZW50VXNlcigpLm1haWwgOiBcIlwiLFxyXG4gICAgICBnZXRRdWVyeU9wdGlvbnM6IGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCBjdXJyZW50VXNlciA9IGdldEN1cnJlbnRVc2VyKCk7XHJcbiAgICAgICAgY29uc3QgdXNlckVtYWlsID0gY3VycmVudFVzZXIgPyBjdXJyZW50VXNlci5tYWlsIDogXCJcIjtcclxuICAgICAgICBpZiAoIXRoaXMucGVyc2lzdGVkU3RhdGUpXHJcbiAgICAgICAgICB0aGlzLnBlcnNpc3RlZFN0YXRlID0gYXdhaXQgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZS5sb2FkKHVzZXJFbWFpbCk7XHJcbiAgICAgICAgY29uc3QgeyB3ZWVrRGF0ZSB9ID0gdGhpcy5wZXJzaXN0ZWRTdGF0ZTtcclxuICAgICAgICBjb25zdCB3ZWVrTnVtYmVyID0gbW9tZW50KHdlZWtEYXRlKS53ZWVrKCk7XHJcbiAgICAgICAgY29uc3Qga2VkV2VlayA9IEtFRFdlZWsobW9tZW50KHdlZWtEYXRlKS55ZWFyKCksIHdlZWtOdW1iZXIpO1xyXG4gICAgICAgIC8qY29uc3QgW2Zyb20sIHRvXSA9IFttb21lbnQod2Vla0RhdGUpLnN0YXJ0T2YoJ3dlZWsnKSwgbW9tZW50KHdlZWtEYXRlKS5lbmRPZignd2VlaycpXVxyXG4gICAgICAgICAgLm1hcChtID0+IG0udG9EYXRlKCkuZ2V0VGltZSgpKTsqL1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZnJvbToga2VkV2Vlay5ub3RCZWZvcmUsXHJcbiAgICAgICAgICAgIHRvOiBrZWRXZWVrLm5vdEFmdGVyLFxyXG4gICAgICAgICAgICByb2xlOiBcIlVTRVJcIixcclxuICAgICAgICAgICAgaW5jbHVkZTogW1widGFza1wiLCBcImNvdXJzZVwiXSxcclxuICAgICAgICAgICAgZmxhZ3M6IFtcImluY2x1ZGVJZHNPbmx5XCJdLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHRoaXMucGVyc2lzdGVkU3RhdGUgPSBudWxsO1xyXG4gICAgdGhpcy5nZXRDdXJyZW50VXNlciA9IGdldEN1cnJlbnRVc2VyO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgdXBkYXRlUGVyc2lzdGVkU3RhdGUoc3RhdGVDaGFuZ2VzOiBQYXJ0aWFsPFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGU+KSB7XHJcbiAgICBPYmplY3QuYXNzaWduKHRoaXMucGVyc2lzdGVkU3RhdGUsIHN0YXRlQ2hhbmdlcyk7XHJcbiAgICBhd2FpdCB0aGlzLnBlcnNpc3RlZFN0YXRlLnNhdmUoKTtcclxuICAgIHRoaXMubWVtLm5vdGlmeVN1YnNjcmliZXJzKCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRUYXNrRG9uZVN0YXRlKHVzZXJUYXNrOiBVc2VyVGFzaywgZG9uZTogYm9vbGVhbikge1xyXG4gICAgY29uc3Qge2dldENsaWVudCwgb3B0aW1pc3RpYywgdGFibGV9ID0gdGhpcy5vcHRpb25zO1xyXG4gICAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7XHJcbiAgICBjb25zdCBtb2RpZmllZEl0ZW0gPSBPYmplY3QuYXNzaWduKHt9LCB1c2VyVGFzaywge2RvbmV9KTtcclxuICAgIGlmIChvcHRpbWlzdGljKSBhd2FpdCB0aGlzLm1lbS51cGRhdGUoT2JqZWN0LmFzc2lnbih7fSwgbW9kaWZpZWRJdGVtLCB7JG1ldGE6ICd1cGRhdGluZyd9KSk7XHJcbiAgICAvLyBOb3cgbWFrZSBzdXJlIHRvIGNoYW5nZSB0aGUgc3RhdGUgZm9yIG90aGVyIHdlZWtzIGFzIHdlbGw6XHJcbiAgICBjb25zdCBzaW1pbGFyVGFza3MgPSBhd2FpdCBjbGllbnQubGlzdDxVc2VyVGFzaz4oJ3VzZXJ0YXNrcycsIHtcclxuICAgICAgbmFtZTogdXNlclRhc2submFtZSxcclxuICAgICAgcm9sZTogXCJVU0VSXCIsXHJcbiAgICAgIGluY2x1ZGU6IFtcInRhc2tcIixcImNvdXJzZVwiXSxcclxuICAgICAgZmxhZ3M6IFtcImluY2x1ZGVJZHNPbmx5XCJdLFxyXG4gICAgICBmcm9tOiBtb21lbnQodGhpcy5wZXJzaXN0ZWRTdGF0ZS53ZWVrRGF0ZSkuYWRkKC0zLCAnd2Vla3MnKS52YWx1ZU9mKCksXHJcbiAgICAgIHRvOiBtb21lbnQodGhpcy5wZXJzaXN0ZWRTdGF0ZS53ZWVrRGF0ZSkuYWRkKDMsICd3ZWVrcycpLnZhbHVlT2YoKVxyXG4gICAgfSwge1xyXG4gICAgICBjYWNoZTogJ25vLWNhY2hlJ1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBpZGVudGljYWxUYXNrcyA9IHNpbWlsYXJUYXNrcy5maWx0ZXIodCA9PlxyXG4gICAgICB0LmNvdXJzZU5hbWUgPT09IHVzZXJUYXNrLmNvdXJzZU5hbWUgJiZcclxuICAgICAgdC5sZWFybmluZ0dvYWwgPT09IHVzZXJUYXNrLmxlYXJuaW5nR29hbCAmJlxyXG4gICAgICAoIXVzZXJUYXNrLnRhc2sgfHwgdC50YXNrLm1hcCh0PT50LmlkKS5qb2luKCcnKSA9PT0gdXNlclRhc2sudGFzay5tYXAodD0+dC5pZCkuam9pbignJykpICYmXHJcbiAgICAgICghdXNlclRhc2suY291cnNlIHx8IHQuY291cnNlLm1hcChjPT5jLmlkKS5qb2luKCcnKSA9PT0gdXNlclRhc2suY291cnNlLm1hcChjPT5jLmlkKS5qb2luKCcnKSkpO1xyXG4gICAgaWYgKGlkZW50aWNhbFRhc2tzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAvLyBXb3JrYXJvdW5kIGZvciBpc3N1ZSBpbiBTdWJqZWN0UGxhbm5lciBtaWdyYXRpb24gKHVzZXJ0YXNrcyB3aXRoIGxvbmcgbmFtZXMgaXMgbm90IGZvdW5kKVxyXG4gICAgICBpZGVudGljYWxUYXNrcy5wdXNoKHVzZXJUYXNrKVxyXG4gICAgfVxyXG4gICAgYXdhaXQgdGhpcy51cGRhdGUoaWRlbnRpY2FsVGFza3MsIHQgPT4gdC5kb25lID0gZG9uZSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRTdWJUYXNrRG9uZVN0YXRlICh1c2VyVGFzazogVXNlclRhc2ssIHN1YlRhc2tJZDogc3RyaW5nLCBkb25lOiBib29sZWFuKSB7XHJcbiAgICBjb25zdCB7Z2V0Q2xpZW50LCBvcHRpbWlzdGljLCB0YWJsZX0gPSB0aGlzLm9wdGlvbnM7XHJcbiAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcclxuICAgIGF3YWl0IHRoaXMudXBkYXRlKFt1c2VyVGFza10sXHJcbiAgICAgIHQgPT4gdC5zdWJUYXNrcyAmJiB0LnN1YlRhc2tzLmZpbHRlcihzdCA9PiBzdC5pZCA9PT0gc3ViVGFza0lkKVxyXG4gICAgICAgIC5mb3JFYWNoKHN0ID0+IHN0LmRvbmUgPSBkb25lKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzZXRXZWVrUGxhbm5lckJveE9wZW4oY291cnNlTmFtZTogc3RyaW5nLCBpc09wZW46IGJvb2xlYW4pIHtcclxuICAgIGNvbnN0IG9wZW5Db3Vyc2VzID0geyAuLi50aGlzLnBlcnNpc3RlZFN0YXRlLm9wZW5Db3Vyc2VzIH07XHJcbiAgICBpZiAoaXNPcGVuKVxyXG4gICAgICBvcGVuQ291cnNlc1tjb3Vyc2VOYW1lXSA9IHRydWU7XHJcbiAgICBlbHNlXHJcbiAgICAgIGRlbGV0ZSBvcGVuQ291cnNlc1tjb3Vyc2VOYW1lXTtcclxuICAgIGF3YWl0IHRoaXMudXBkYXRlUGVyc2lzdGVkU3RhdGUoe29wZW5Db3Vyc2VzfSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBjaGFuZ2VXZWVrKHdlZWtEYXRlOiBEYXRlKSB7XHJcbiAgICBsZXQgcGVyc2lzdGVkU3RhdGUgPSB0aGlzLnBlcnNpc3RlZFN0YXRlO1xyXG4gICAgaWYgKCFwZXJzaXN0ZWRTdGF0ZSkge1xyXG4gICAgICBwZXJzaXN0ZWRTdGF0ZSA9IGF3YWl0IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUubG9hZCh0aGlzLm9wdGlvbnMudXNlcik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBuZXdQZXJzaXN0ZWQgPSBuZXcgV2Vla1BsYW5uZXJQZXJzaXN0ZWRTdGF0ZShwZXJzaXN0ZWRTdGF0ZSk7XHJcbiAgICBuZXdQZXJzaXN0ZWQud2Vla0RhdGUgPSBtb21lbnQod2Vla0RhdGUpLnN0YXJ0T2YoJ3dlZWsnKS52YWx1ZU9mKCk7XHJcbiAgICBuZXdQZXJzaXN0ZWQuc2F2ZSgpO1xyXG4gICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSA9IG5ld1BlcnNpc3RlZDtcclxuICAgIGF3YWl0IHRoaXMubWVtLnJlZnJlc2hGcm9tU2VydmVyKCk7XHJcbiAgfVxyXG5cclxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcjogKHVzZXJUYXNrczogVXNlclRhc2tbXSwgcGVyc2lzdGVkU3RhdGU6IFdlZWtQbGFubmVyUGVyc2lzdGVkU3RhdGUsIHdlZWtUZXh0c1VUOiBVc2VyVGFzaykgPT4gdm9pZCkge1xyXG4gICAgY29uc3QgcHJveHlTdWJzY3JpYmVyID0gKHVzZXJUYXNrczogVXNlclRhc2tbXSkgPT4ge1xyXG4gICAgICBzdWJzY3JpYmVyKFxyXG4gICAgICAgIHVzZXJUYXNrcy5maWx0ZXIodXQgPT4gIXV0LndlZWtUZXh0cyksXHJcbiAgICAgICAgdGhpcy5wZXJzaXN0ZWRTdGF0ZSxcclxuICAgICAgICB1c2VyVGFza3MuZmlsdGVyKHV0ID0+ICEhdXQud2Vla1RleHRzKVswXSB8fCB7XHJcbiAgICAgICAgICBpZDogY3JlYXRlVVVJRCgpLFxyXG4gICAgICAgICAgZGF0ZVRpbWU6IHRoaXMucGVyc2lzdGVkU3RhdGUud2Vla0RhdGUsXHJcbiAgICAgICAgICB3ZWVrVGV4dHM6IHthc3Nlc3NtZW50OicnLCBzdHJhdGVneTonJ30sXHJcbiAgICAgICAgICBhY2w6IFtcclxuICAgICAgICAgICAgLy8gRGVmYXVsdCBBQ0w6IExldCB1c2VyIHNlbGYgaGF2ZSBmdWxsIGNvbnRyb2wgb3ZlciB0aGlzIGl0ZW06XHJcbiAgICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcImVtYWlsXCIsIHRoaXMuZ2V0Q3VycmVudFVzZXIoKS5tYWlsLCBcIlNcIiksXHJcbiAgICAgICAgICAgIC8vIEFkZGl0aW9uYWwgQUNMOiBMZXQgZW1wbG95ZWVzIG9uIHNhbWUgc2Nob29sIGhhdmUgcmVhZCBhY2Nlc3MgdG8gaXQuXHJcbiAgICAgICAgICAgIC8vIFRoaXMgY3VycmVudGx5IG9ubHkgYXBwbGllcyB0byB0YXNrcyB0aGF0IHJlZmVyIHRvIGNvdXJzZSB0YXNrcyAobm90IG93biB0YXNrcyEpXHJcbiAgICAgICAgICAgIG5ldyBEb2N1bWVudEFjY2VzcyhcInNjaG9vbFJvbGVcIiwgYCR7dGhpcy5nZXRDdXJyZW50VXNlcigpLnNjaG9vbH0vRU1QTE9ZRUVgLCBcIlJcIilcclxuICAgICAgICAgIF0ubWFwKGFjID0+IGFjLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcHJveHlTdWJzY3JpYmVyW1wic3Vic2NyaWJlclwiXSA9IHN1YnNjcmliZXI7XHJcbiAgICB0aGlzLm1lbS5zdWJzY3JpYmUocHJveHlTdWJzY3JpYmVyKTtcclxuICB9XHJcblxyXG4gIHVuc3Vic2NyaWJlKHN1YnNjcmliZXI6ICh1c2VyVGFza3M6IFVzZXJUYXNrW10sIHBlcnNpc3RlZFN0YXRlOiBXZWVrUGxhbm5lclBlcnNpc3RlZFN0YXRlLCB3ZWVrVGV4dHNVVDogVXNlclRhc2spID0+IHZvaWQpIHtcclxuICAgIHRoaXMubWVtLnN1YnNjcmliZXJzID0gdGhpcy5tZW0uc3Vic2NyaWJlcnMuZmlsdGVyIChzID0+IHNbXCJzdWJzY3JpYmVyXCJdICE9PSBzdWJzY3JpYmVyKTtcclxuICB9XHJcbiAgXHJcbn1cclxuXHJcbmlmICghdXNlclRhc2tzUmVwbykge1xyXG4gIHVzZXJUYXNrc1JlcG8gPSBlbnYudXNlclRhc2tzUmVwbyA9IG5ldyBVc2VyVGFza3NSZXBvKFxyXG4gICAgKCk9PmVudi5rZWRCYWNrZW5kQ2xpZW50LFxyXG4gICAgKCk9PmVudi5jdXJyZW50VXNlcik7XHJcbiAgdXNlclRhc2tzUmVwby5tZW0uZW5zdXJlSGFzRGF0YSgpO1xyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtMfSBmcm9tICcuL3V0aWxzJztcclxuaW1wb3J0IHtkYn0gZnJvbSAnLi4vZ2xvYmFscy9kYic7XHJcbmltcG9ydCB7IEtlZEJhY2tlbmRXcml0ZXIgfSBmcm9tICdrZWRiYWNrZW5kL3JlcG8nO1xyXG5pbXBvcnQgeyBSZW1vdmVJdGVtIH0gZnJvbSAnLi4vY29tcG9uZW50cy9jb3Vyc2UtYnVpbGRlci9zdWItY29tcG9uZW50cy9yZW1vdmUtaXRlbSc7XHJcblxyXG5cclxuaW50ZXJmYWNlIFByb3BzIHtcclxufVxyXG5cclxuaW50ZXJmYWNlIFN0YXRlIHtcclxuICBlcnJvcnM6IEVycm9yU3RydWN0W107XHJcbiAgaW5mb3M6IHN0cmluZ1tdO1xyXG4gIC8vZGJXcml0ZXJSZXRyeWFibGVFcnJvcj86IEVycm9yO1xyXG4gIGRiV3JpdGVySXNTYXZpbmc/OiBib29sZWFuO1xyXG4gIGRiV3JpdGVySXNFZGl0ZWQ/OiBib29sZWFuO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRXJyb3JTdHJ1Y3Qge1xyXG4gIG1lc3NhZ2U6IHN0cmluZztcclxuICByZXRyeWFibGU/OiBib29sZWFuO1xyXG4gIGRldGFpbHM/OiBFcnJvcjtcclxuICBzaG93RGV0YWlscz86IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFcnJvclN1Y2Nlc3NGZWVkYmFjayBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcyxTdGF0ZT4ge1xyXG4gIGNvbnN0cnVjdG9yIChwcm9wczogUHJvcHMpIHtcclxuICAgIHN1cGVyKHByb3BzKTtcclxuICAgIHRoaXMuc3RhdGU9e1xyXG4gICAgICBlcnJvcnM6IFtdLFxyXG4gICAgICBpbmZvczogW11cclxuICAgIH07XHJcbiAgICB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24gPSB0aGlzLl91bmhhbmRsZWRSZWplY3Rpb24uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2Vycm9yID0gdGhpcy5fZXJyb3IuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2N1c3RvbUVycm9yID0gdGhpcy5fY3VzdG9tRXJyb3IuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX29uSW5mbyA9IHRoaXMuX29uSW5mby5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5fZGJXcml0ZXJFcnJvciA9IHRoaXMuX2RiV3JpdGVyRXJyb3IuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkID0gdGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2FkZEVycm9yKG1lc3NhZ2U6IHN0cmluZywgZGV0YWlscz86IEVycm9yLCByZXRyeWFibGU/OiBib29sZWFuKSB7XHJcbiAgICAvL2NvbnNvbGUuZXJyb3IobWVzc2FnZSwge3JldHJ5YWJsZTogISFyZXRyeWFibGUsIGRldGFpbHN9KTtcclxuICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcnMuc29tZShlID0+IGUubWVzc2FnZSA9PT0gbWVzc2FnZSkpIHJldHVybiB7ZXJyb3JzfTtcclxuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAyKSBlcnJvcnMgPSBlcnJvcnMuc2xpY2UoMSk7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgZXJyb3JzOiBlcnJvcnMuY29uY2F0KFt7bWVzc2FnZSwgZGV0YWlscywgcmV0cnlhYmxlfV0pXHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICAgIC8vIFJlbW92ZSBub24tcmV0cnlhYmxlIGVycm9ycyBhZnRlciAzMCBzZWNvbmRzOlxyXG4gICAgaWYgKCFyZXRyeWFibGUpIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+ICh7XHJcbiAgICAgICAgZXJyb3JzOiBlcnJvcnMuZmlsdGVyKGUgPT4gZS5tZXNzYWdlICE9PSBtZXNzYWdlKVxyXG4gICAgICB9KSk7XHJcbiAgICB9LCAzMDAwMCk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9hZGRJbmZvKG1lc3NhZ2U6IHN0cmluZykge1xyXG4gICAgaWYgKG1lc3NhZ2UgPT09IFwiXCIpIHtcclxuICAgICAgLy8gVHVybiBvZmYgY3VycmVudCBpbmZvIG1lc3NhZ2VzXHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2luZm9zOiBbXX0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldFN0YXRlKCh7aW5mb3N9KSA9PiB7XHJcbiAgICAgIGlmIChpbmZvcy5zb21lKGluZm8gPT4gaW5mbyA9PT0gbWVzc2FnZSkpIHJldHVybiB7aW5mb3N9O1xyXG4gICAgICBpZiAoaW5mb3MubGVuZ3RoID4gMSkgaW5mb3MgPSBpbmZvcy5zbGljZSgxKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpbmZvczogW21lc3NhZ2VdIC8vIHdhczogaW5mb3MuY29uY2F0KG1lc3NhZ2UpLiBCdXQgaXQgc3Vja3MhXHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuICAgIC8vIFJlbW92ZSBpbmZvIG1lc3NhZ2UgYWZ0ZXIgMTAgc2Vjb25kczpcclxuICAgIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgdGhpcy5zZXRTdGF0ZSgoe2luZm9zfSkgPT4gKHtcclxuICAgICAgICBpbmZvczogaW5mb3MuZmlsdGVyKG1zZyA9PiBtc2cgIT09IG1lc3NhZ2UpXHJcbiAgICAgIH0pKTtcclxuICAgIH0sIDEwMDAwKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2RiV3JpdGVyRXJyb3IgKGVycm9yOiBFcnJvciwgcmV0cnlhYmxlOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLl9hZGRFcnJvcihgRGV0IGfDpXIgaW50ZSBhdHQgc3BhcmEgdGlsbCBzZXJ2ZXJuYCwgZXJyb3IsIHJldHJ5YWJsZSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIF9kYldyaXRlclN0YXRlQ2hhbmdlZCAoe2lzRWRpdGVkLCBpc1NhdmluZ306IEtlZEJhY2tlbmRXcml0ZXIpIHtcclxuICAgIGlmICghaXNFZGl0ZWQpIHtcclxuICAgICAgLy8gSWYgaXNFZGl0ZWQgaXMgZmFsc2UsIGEgc3VjY2Vzc2Z1bCB3cml0ZSBtdXN0IGhhdmUgaGFwcGVuZWQsIGFuZFxyXG4gICAgICAvLyB0aGVyZSBjYW5ub3QgYmUgYW55IHJldHJ5YWJsZSBlcnJvciBhbnltb3JlXHJcbiAgICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiB7XHJcbiAgICAgICAgZXJyb3JzID0gZXJyb3JzLmZpbHRlcihlID0+ICFlLnJldHJ5YWJsZSk7XHJcbiAgICAgICAgcmV0dXJuIHtlcnJvcnN9O1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICBkYldyaXRlcklzRWRpdGVkOiBpc0VkaXRlZCxcclxuICAgICAgZGJXcml0ZXJJc1NhdmluZzogaXNTYXZpbmdcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuX2Vycm9yKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjdXN0b21lcnJvcicsIHRoaXMuX2N1c3RvbUVycm9yKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcclxuICAgIGRiLndyaXRlci5vbkVycm9yKHRoaXMuX2RiV3JpdGVyRXJyb3IpO1xyXG4gICAgZGIud3JpdGVyLm9uU3RhdGVDaGFuZ2UodGhpcy5fZGJXcml0ZXJTdGF0ZUNoYW5nZWQpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XHJcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndW5oYW5kbGVkcmVqZWN0aW9uJywgdGhpcy5fdW5oYW5kbGVkUmVqZWN0aW9uKTtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuX2Vycm9yKTtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdjdXN0b21lcnJvcicsIHRoaXMuX2N1c3RvbUVycm9yKTtcclxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpbmZvJywgdGhpcy5fb25JbmZvKTtcclxuICAgIGRiLndyaXRlci5vZmYodGhpcy5fZGJXcml0ZXJFcnJvcik7XHJcbiAgICBkYi53cml0ZXIub2ZmKHRoaXMuX2RiV3JpdGVyU3RhdGVDaGFuZ2VkKTtcclxuICB9XHJcblxyXG4gIF91bmhhbmRsZWRSZWplY3Rpb24gKGV2OiBFdmVudCAmIHtyZWFzb246IEVycm9yfSkge1xyXG4gICAgdGhpcy5fYWRkRXJyb3IoYEV0dCBva8OkbnQgZmVsIGludHLDpGZmYWRlLi4uYCwgZXYucmVhc29uKTtcclxuICB9XHJcblxyXG4gIF9lcnJvciAoZXY6IEV2ZW50ICYge2Vycm9yOiBFcnJvcn0pIHtcclxuICAgIHRoaXMuX2FkZEVycm9yKGV2LmVycm9yID8gZXYuZXJyb3IubWVzc2FnZSA6IGBFdHQgb2vDpG50IGZlbCBpbnRyw6RmZmFkZS4uLmAsIGV2LmVycm9yKTtcclxuICB9XHJcblxyXG4gIF9jdXN0b21FcnJvciAoZXY6IEN1c3RvbUV2ZW50KSB7XHJcbiAgICB0aGlzLl9hZGRFcnJvcihldi5kZXRhaWwpO1xyXG4gIH1cclxuXHJcbiAgX29uSW5mbyhldjogQ3VzdG9tRXZlbnQpIHtcclxuICAgIHRoaXMuX2FkZEluZm8oZXYuZGV0YWlsKTtcclxuICB9IFxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7ZXJyb3JzLCBpbmZvcywgZGJXcml0ZXJJc1NhdmluZ30gPSB0aGlzLnN0YXRlO1xyXG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3Itc3VjY2Vzcy1mZWVkYmFja1wiIHN0eWxlPXt7XHJcbiAgICAgIHBvc2l0aW9uOiBcImZpeGVkXCIsXHJcbiAgICAgIGxlZnQ6IDAsXHJcbiAgICAgIHRvcDogMCxcclxuICAgICAgd2lkdGg6IFwiMTAwJVwiLFxyXG4gICAgICBwb2ludGVyRXZlbnRzOiAnbm9uZSdcclxuICAgIH19PlxyXG4gICAgICA8ZGl2IHN0eWxlPXt7ZGlzcGxheTogJ3RhYmxlJywgbWFyZ2luOiBcIjAgYXV0b1wifX0+XHJcbiAgICAgICAge2Vycm9ycy5maWx0ZXIoZSA9PiAhZS5yZXRyeWFibGUgfHwgIWRiV3JpdGVySXNTYXZpbmcpXHJcbiAgICAgICAgLm1hcCgoe21lc3NhZ2UsIGRldGFpbHMsIHJldHJ5YWJsZSwgc2hvd0RldGFpbHN9KSA9PiAoXHJcbiAgICAgICAgICA8ZGl2IGtleT17bWVzc2FnZX0gY2xhc3NOYW1lPVwiZXJyb3JcIj5cclxuICAgICAgICAgICAgPGRpdiBzdHlsZT17e2Zsb2F0OidsZWZ0J319PnttZXNzYWdlfTwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPXt7cG9pbnRlckV2ZW50czogJ2F1dG8nfX0+XHJcbiAgICAgICAgICAgICAgPFJlbW92ZUl0ZW0gb25DbGljaz17KCk9PnRoaXMucmVtb3ZlRXJyb3IobWVzc2FnZSl9IC8+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICB7ZGV0YWlscyB8fCByZXRyeWFibGUgPyA8ZGl2IHN0eWxlPXt7cG9pbnRlckV2ZW50czogJ2F1dG8nfX0+XHJcbiAgICAgICAgICAgICAge2RldGFpbHMgPyA8PjxhIGNsYXNzTmFtZT1cImJ0blwiIG9uQ2xpY2s9eygpPT50aGlzLnRvZ2dsZURldGFpbHMobWVzc2FnZSl9PntzaG93RGV0YWlscyA/IFwiRMO2bGogZGV0YWlsZXJcIiA6IFwiVmlzYSBkZXRhaWxqZXJcIn08L2E+Jm5ic3A7PC8+IDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICAgIHtzaG93RGV0YWlscyA/IDxwPnsnJytkZXRhaWxzfTwvcD46IDw+Jm5ic3A7PC8+fVxyXG4gICAgICAgICAgICAgIHtyZXRyeWFibGUgPyA8YSBjbGFzc05hbWU9XCJidG5cIiBvbkNsaWNrPXsoKT0+dGhpcy5yZXRyeVNhdmUoKX0+RsO2cnPDtmsgc3BhcmEgbnU8L2E+IDogdW5kZWZpbmVkfVxyXG4gICAgICAgICAgICA8L2Rpdj46IHVuZGVmaW5lZH1cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICkpfVxyXG4gICAgICAgIHtpbmZvcy5tYXAobWVzc2FnZSA9PiBcclxuICAgICAgICAgIDxwIGtleT17bWVzc2FnZX0gY2xhc3NOYW1lPVwiaW5mb1wiPnttZXNzYWdlfTwvcD5cclxuICAgICAgICApfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PjtcclxuICB9XHJcbiAgcmVtb3ZlRXJyb3IobWVzc2FnZTogc3RyaW5nKTogYW55IHtcclxuICAgIHRoaXMuc2V0U3RhdGUoKHtlcnJvcnN9KSA9PiAoe1xyXG4gICAgICBlcnJvcnM6IGVycm9ycy5maWx0ZXIoZSA9PiBlLm1lc3NhZ2UgIT09IG1lc3NhZ2UpXHJcbiAgICB9KSk7XHJcbiAgfVxyXG5cclxuICByZXRyeVNhdmUoKSB7XHJcbiAgICBkYi53cml0ZXIucmV0cnlTYXZlKCk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVEZXRhaWxzKG1lc3NhZ2U6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5zZXRTdGF0ZSgoe2Vycm9yc30pID0+ICh7ZXJyb3JzOiBlcnJvcnMubWFwKGVycm9yID0+IGVycm9yLm1lc3NhZ2UgPT09IG1lc3NhZ2UgP1xyXG4gICAgICB7XHJcbiAgICAgICAgLi4uZXJyb3IsXHJcbiAgICAgICAgc2hvd0RldGFpbHM6ICFlcnJvci5zaG93RGV0YWlsc1xyXG4gICAgICB9IDpcclxuICAgICAgZXJyb3IpXHJcbiAgICB9KSk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTiA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzLlxyXG5cclxudHlwZSBQcm9taXNlUmV0dXJuaW5nTWV0aG9kTmFtZXM8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIEFQSV06IEFQSVtNRVRIT0RdIGV4dGVuZHMgKC4uLmFyZ3M6IGFueVtdKSA9PiBQcm9taXNlPGFueT4gPyBNRVRIT0QgOiBuZXZlclxyXG59XHJcblxyXG50eXBlIENvbnZlcnRNZXRob2RUb1N1c3BlbnNlPEY+ID0gRiBleHRlbmRzICguLi5hcmdzOiBpbmZlciBBKSA9PiBQcm9taXNlPGluZmVyIFI+ID9cclxuICAoLi4uYXJnczogQSkgPT4gUiA6XHJcbiAgRjtcclxuXHJcbmV4cG9ydCB0eXBlIFN1c3BlbnNlQmFzZWRBUEk8QVBJPiA9IHtcclxuICBbTUVUSE9EIGluIGtleW9mIFByb21pc2VSZXR1cm5pbmdNZXRob2ROYW1lczxBUEk+XTogQ29udmVydE1ldGhvZFRvU3VzcGVuc2U8QVBJW01FVEhPRF0+XHJcbn1cclxuXHJcbnR5cGUgT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZD86IChwcm9wOiBzdHJpbmcpPT5ib29sZWFuLFxyXG4gIGNhY2hlRXhwaXJhdGlvbj86IG51bWJlclxyXG59XHJcblxyXG5jb25zdCBkZWZhdWx0T3B0aW9uczogT3B0aW9ucyA9IHtcclxuICBpc0FwaU1ldGhvZDogZiA9PiB0eXBlb2YgZiA9PT0gJ2Z1bmN0aW9uJyxcclxuICBjYWNoZUV4cGlyYXRpb246IERFRkFVTFRfQ0FDSEVfRVhQSVJBVElPTlxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VTdXNwZW5zZUFwaTxBUEk+KGFwaTogQVBJLCBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnMpOiBTdXNwZW5zZUJhc2VkQVBJPEFQST5cclxue1xyXG4gIG9wdGlvbnMgPSB7Li4uZGVmYXVsdE9wdGlvbnMsIC4uLm9wdGlvbnN9O1xyXG4gIGNvbnN0IHtpc0FwaU1ldGhvZCwgY2FjaGVFeHBpcmF0aW9ufSA9IG9wdGlvbnM7XHJcblxyXG4gIGNvbnN0IHJ2OiBTdXNwZW5zZUJhc2VkQVBJPEFQST4gPSBPYmplY3QuY3JlYXRlKGFwaSBhcyBhbnkpIGFzIFN1c3BlbnNlQmFzZWRBUEk8QVBJPjtcclxuICBjb25zdCBjYWNoZToge1trZXk6IHN0cmluZ106IHt0aW1lb3V0OiBudW1iZXIsIHZhbHVlPzogYW55LCBlcnJvcj86IGFueSwgcHJvbWlzZT86IFByb21pc2U8YW55Pn19ID0ge307XHJcblxyXG4gIC8vIFdhbGsgdGhlIGluc3RhbmNlICsgcHJvdG90eXBlIGNoYWluIHRvIGdlbmVyYXRlIHN1c3BlbnNlIHZlcnNpb24gb2YgZWFjaCBwcm9taXNlIHJldHVybmluZyBtZXRob2RcclxuICBmb3IgKGxldCBwcm90byA9IGFwaTsgcHJvdG8gJiYgcHJvdG8gIT09IE9iamVjdC5wcm90b3R5cGU7IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSkge1xyXG4gICAgc3VzcGVuZGlmeShwcm90byk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzdXNwZW5kaWZ5KHByb3RvKSB7XHJcbiAgICBPYmplY3Qua2V5cyhwcm90bykuZm9yRWFjaChwcm9wID0+IHtcclxuICAgICAgaWYgKCFydi5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJiBpc0FwaU1ldGhvZChwcm9wKSkge1xyXG4gICAgICAgIHJ2W3Byb3BdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgIGNvbnN0IGtleSA9IEpTT04uc3RyaW5naWZ5KFtwcm9wLCAuLi5hcmdzXSk7XHJcbiAgICAgICAgICBjb25zdCBjYWNoZWRFbnRyeSA9IGNhY2hlW2tleV07XHJcbiAgICAgICAgICBpZiAoY2FjaGVkRW50cnkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoY2FjaGVkRW50cnkucHJvbWlzZSkgdGhyb3cgY2FjaGVkRW50cnkucHJvbWlzZTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LmVycm9yKSB0aHJvdyBjYWNoZWRFbnRyeS5lcnJvcjtcclxuICAgICAgICAgICAgaWYgKGNhY2hlZEVudHJ5LnRpbWVvdXQgPiBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZEVudHJ5LnZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9taXNlID0gcHJvdG9bcHJvcF0uYXBwbHkoYXBpLCBhcmdzKS50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCB2YWx1ZTogcmVzdWx0fTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgIGNhY2hlW2tleV0gPSB7dGltZW91dDogRGF0ZS5ub3coKSArIGNhY2hlRXhwaXJhdGlvbiwgZXJyb3J9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBwcm9taXNlfTtcclxuICAgICAgICAgICAgdGhyb3cgcHJvbWlzZTtcclxuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnJvci50aGVuKSB0aHJvdyBlcnJvcjtcclxuICAgICAgICAgICAgY2FjaGVba2V5XSA9IHt0aW1lb3V0OiBEYXRlLm5vdygpICsgY2FjaGVFeHBpcmF0aW9uLCBlcnJvcn07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBhcyBhbnk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHJ2O1xyXG59XHJcbiIsIlxyXG5leHBvcnQgY2xhc3MgUGVuZGluZ0pvYiB7XHJcbiAgcHJpdmF0ZSB0aW1lb3V0SWQgPSBudWxsO1xyXG4gIHByaXZhdGUgY2FuY2VsbGVkID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBwZW5kaW5nID0gZmFsc2U7XHJcbiAgcHJpdmF0ZSBpc0pvYkV4ZWN1dGluZyA9IGZhbHNlO1xyXG4gIHByaXZhdGUgam9iQ2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT47XHJcbiAgXHJcbiAgY29uc3RydWN0b3IoY2FsbGJhY2s6ICgpPT5Qcm9taXNlPGFueT4pIHtcclxuICAgIHRoaXMuam9iQ2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIHRyaWdnZXJDaGFuZ2UodGhyb3R0bGU6IG51bWJlcik6IGFueSB7XHJcbiAgICBpZiAodGhpcy5jYW5jZWxsZWQpIHJldHVybjtcclxuICAgIHRoaXMucGVuZGluZyA9IHRydWU7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRJZCk7XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCk9PnRoaXMubGF1bmNoSm9iKCksIHRocm90dGxlKTtcclxuICB9XHJcblxyXG4gIHN0b3AoKSB7XHJcbiAgICBpZiAodGhpcy50aW1lb3V0SWQgIT09IG51bGwpXHJcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRJZCk7XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICB0aGlzLmNhbmNlbGxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGxhdW5jaEpvYigpIHtcclxuICAgIGlmICh0aGlzLmNhbmNlbGxlZCkgcmV0dXJuO1xyXG4gICAgaWYgKCF0aGlzLnBlbmRpbmcpIHJldHVybjtcclxuICAgIGlmICh0aGlzLmlzSm9iRXhlY3V0aW5nKSByZXR1cm47XHJcbiAgICB0aGlzLnRpbWVvdXRJZCA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLmlzSm9iRXhlY3V0aW5nID0gdHJ1ZTtcclxuICAgICAgdGhpcy5wZW5kaW5nID0gZmFsc2U7XHJcbiAgICAgIGF3YWl0IHRoaXMuam9iQ2FsbGJhY2soKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHRoaXMuaXNKb2JFeGVjdXRpbmcgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnBlbmRpbmcpXHJcbiAgICAgIGF3YWl0IHRoaXMubGF1bmNoSm9iKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMge1xyXG4gIHRvTG93ZXI/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VRdWVyeVN0cmluZyhsb2NhdGlvblNlYXJjaDogc3RyaW5nLCBvcHRpb25zPzogUGFyc2VRdWVyeVN0cmluZ09wdGlvbnMpOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9IHtcclxuICBjb25zdCB7dG9Mb3dlcn0gPSAob3B0aW9ucyB8fMKge30pIGFzIFBhcnNlUXVlcnlTdHJpbmdPcHRpb25zO1xyXG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gIGlmIChsb2NhdGlvblNlYXJjaCAmJiBsb2NhdGlvblNlYXJjaC5sZW5ndGggPiAxKVxyXG4gICAgbG9jYXRpb25TZWFyY2guc3Vic3RyKDEpXHJcbiAgICAgIC5zcGxpdCgnJicpXHJcbiAgICAgIC5tYXAocGFydCA9PiBwYXJ0LnNwbGl0KCc9JykubWFwKHMgPT4gZGVjb2RlVVJJQ29tcG9uZW50KHMudHJpbSgpKSkpXHJcbiAgICAgIC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHJlc3VsdFt0b0xvd2VyID8ga2V5LnRvTG93ZXJDYXNlKCkgOiBrZXldID0gdmFsdWUpO1xyXG4gIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuY29kZVBhcmFtcyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5maWx0ZXIoa2V5ID0+IHBhcmFtc1trZXldICE9PSB1bmRlZmluZWQpLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHBhcmFtc1trZXldKX1gKS5qb2luKCcmJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVF1ZXJ5U3RyaW5nKHBhcmFtczoge1trZXk6IHN0cmluZ106c3RyaW5nfSkge1xyXG4gIHJldHVybiBcIj9cIiArIGVuY29kZVBhcmFtcyhwYXJhbXMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VIYXNoUXVlcnlTdHJpbmcobG9jYXRpb25IYXNoOiBzdHJpbmcsIG9wdGlvbnM/OiBQYXJzZVF1ZXJ5U3RyaW5nT3B0aW9ucykge1xyXG4gIHJldHVybiBwYXJzZVF1ZXJ5U3RyaW5nKGxvY2F0aW9uSGFzaCwgb3B0aW9ucyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUhhc2hRdWVyeVN0cmluZyhwYXJhbXM6IHtba2V5OiBzdHJpbmddOnN0cmluZ30pIHtcclxuICByZXR1cm4gXCIjXCIgKyBlbmNvZGVQYXJhbXMocGFyYW1zKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNwbGl0VXJsQW5kUXVlcnkgKHVybFdpdGhQb3NzaWJsZVF1ZXJ5OiBzdHJpbmcpIHtcclxuICBjb25zdCBwUXVlcnkgPSB1cmxXaXRoUG9zc2libGVRdWVyeS5pbmRleE9mKCc/Jyk7XHJcbiAgcmV0dXJuIHBRdWVyeSA+PSAwID9cclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeS5zdWJzdHIoMCwgcFF1ZXJ5KSwgdXJsV2l0aFBvc3NpYmxlUXVlcnkuc3Vic3RyKHBRdWVyeSldIDpcclxuICAgIFt1cmxXaXRoUG9zc2libGVRdWVyeSwgXCJcIl07XHJcbn1cclxuIiwiaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xyXG5pbXBvcnQgeyBUZXJtLCBBY2FkZW1pY1llYXIgfSBmcm9tICcuLi9jb250cmFjdHMva2VkLW1vZGVscyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbE1vbWVudCB7XHJcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XHJcbiAgdGVybTogVGVybTtcclxuICB3ZWVrPzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Rmlyc3RBbmRMYXN0V2Vla09mVGVybSh0ZXJtOiBUZXJtKSB7XHJcbiAgcmV0dXJuIHRlcm0gPT09ICdBVCcgP1xyXG4gICAgWzMyLCA1MV0gOlxyXG4gICAgWzEsIDI1XTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRlcm1TdGFydEFuZEVuZChub3c6IG1vbWVudC5Nb21lbnQpIDogbW9tZW50Lk1vbWVudFtdIHtcclxuICAgIHJldHVybiBub3cubW9udGgoKSA+PSA2ID8gLy8gNiA9IEp1bHkgaW4gSlMgRGF0ZXMgYW5kIGluIG1vbWVudCBhcyB3ZWxsIVxyXG4gICAgW21vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCA3LCAxKSksIG1vbWVudChuZXcgRGF0ZShub3cueWVhcigpLCAxMSwgMzEpKV0gOiAvLyBhdWcxIC0gZGVjMzFcclxuICAgIFttb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgMCwgMSkpLCBtb21lbnQobmV3IERhdGUobm93LnllYXIoKSwgNiwgMzEpKV07IC8vIGphbjEgLSBqdWx5MzFcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNjaG9vbE1vbWVudChtOiBtb21lbnQuTW9tZW50KTogU2Nob29sTW9tZW50IHtcclxuICBjb25zdCB0aGlzWWVhciA9IG0ueWVhcigpO1xyXG4gIGNvbnN0IGlzQXV0dW1uID0gbS5tb250aCgpID49IDY7IC8vIGRldGVybWluZSBcclxuICBjb25zdCBbYXV0dW1uWWVhciwgc3ByaW5nWWVhcl0gPSBpc0F1dHVtbiA/XHJcbiAgICBbdGhpc1llYXIsIHRoaXNZZWFyICsgMV0gOlxyXG4gICAgW3RoaXNZZWFyIC0gMSwgdGhpc1llYXJdO1xyXG4gIGNvbnN0IGFjYWRlbWljWWVhciA9ICcnICsgYXV0dW1uWWVhciArICcvJyArIHNwcmluZ1llYXI7XHJcbiAgY29uc3QgdGVybSA9IGlzQXV0dW1uID8gJ0FUJyA6ICdTVCc7XHJcbiAgY29uc3Qgd2VlayA9IG0ud2VlaygpO1xyXG4gIHJldHVybiB7IGFjYWRlbWljWWVhciwgdGVybSwgd2VlayB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkWWVhcihhWWVhcjogQWNhZGVtaWNZZWFyLCBudW1ZZWFyc1RvQWRkOiBudW1iZXIpOiBBY2FkZW1pY1llYXIge1xyXG4gIHJldHVybiBhWWVhci5zcGxpdCgnLycpXHJcbiAgICAubWFwKHllYXJTdHIgPT4gcGFyc2VJbnQoeWVhclN0cikgKyBudW1ZZWFyc1RvQWRkKVxyXG4gICAgLm1hcCh5ZWFyID0+ICcnICsgeWVhcilcclxuICAgIC5qb2luKCcvJyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBuZXh0QWNhZGVtaWNZZWFyKGFZZWFyOiBBY2FkZW1pY1llYXIpOiBBY2FkZW1pY1llYXIge1xyXG4gIHJldHVybiBhZGRZZWFyKGFZZWFyLCAxKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByZXZBY2FkZW1pY1llYXIoYVllYXI6IEFjYWRlbWljWWVhcik6IEFjYWRlbWljWWVhciB7XHJcbiAgcmV0dXJuIGFkZFllYXIoYVllYXIsIC0xKTtcclxufVxyXG4iLCJpbXBvcnQgbW9tZW50IGZyb20gJ21vbWVudCc7XHJcbmltcG9ydCB7IFNjaG9vbE1vbWVudCwgZ2V0U2Nob29sTW9tZW50LCBhZGRZZWFyIH0gZnJvbSAnLi9zY2hvb2wtbW9tZW50JztcclxuaW1wb3J0IHsgQWNhZGVtaWNZZWFyLCBUZXJtIH0gZnJvbSAnLi4vY29udHJhY3RzL2tlZC1tb2RlbHMnO1xyXG5pbXBvcnQge0luamVjdGVkSW50bH0gZnJvbSAncmVhY3QtaW50bCc7XHJcblxyXG50eXBlIE1vbWVudCA9IG1vbWVudC5Nb21lbnQ7XHJcblxyXG5mdW5jdGlvbiBpc1NjaG9vbE1vbWVudChvYmo6IERhdGUgfCBTY2hvb2xNb21lbnQpOiBvYmogaXMgU2Nob29sTW9tZW50IHtcclxuICByZXR1cm4gJ2FjYWRlbWljWWVhcicgaW4gb2JqO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU2Nob29sVGVybSB7XHJcbiAgYWNhZGVtaWNZZWFyOiBBY2FkZW1pY1llYXI7XHJcbiAgdGVybTogVGVybTtcclxuXHJcbiAgY29uc3RydWN0b3IoZGF0ZU9yU2Nob29sTW9tZW50OiBEYXRlIHwgU2Nob29sTW9tZW50KSB7XHJcbiAgICBjb25zdCBzY2hvb2xNb21lbnQgPSBpc1NjaG9vbE1vbWVudChkYXRlT3JTY2hvb2xNb21lbnQpID9cclxuICAgICAgZGF0ZU9yU2Nob29sTW9tZW50IDogZ2V0U2Nob29sTW9tZW50KG1vbWVudChkYXRlT3JTY2hvb2xNb21lbnQpKTtcclxuICAgIHRoaXMuYWNhZGVtaWNZZWFyID0gc2Nob29sTW9tZW50LmFjYWRlbWljWWVhcjtcclxuICAgIHRoaXMudGVybSA9IHNjaG9vbE1vbWVudC50ZXJtO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHllYXIoKSB7XHJcbiAgICByZXR1cm4gcGFyc2VJbnQodGhpcy5hY2FkZW1pY1llYXJcclxuICAgICAgICAuc3BsaXQoJy8nKVt0aGlzLnRlcm0gPT09ICdBVCcgPyAwIDogMV0pO1xyXG4gIH1cclxuXHJcbiAgbmV4dFRlcm0oKSB7XHJcbiAgICByZXR1cm4gbmV3IFNjaG9vbFRlcm0odGhpcy50ZXJtID09PSAnQVQnID9cclxuICAgICAge1xyXG4gICAgICAgIHRlcm06ICdTVCcsXHJcbiAgICAgICAgYWNhZGVtaWNZZWFyOiB0aGlzLmFjYWRlbWljWWVhclxyXG4gICAgICB9IDpcclxuICAgICAge1xyXG4gICAgICAgIHRlcm06ICdBVCcsXHJcbiAgICAgICAgYWNhZGVtaWNZZWFyOiBhZGRZZWFyKHRoaXMuYWNhZGVtaWNZZWFyLCAxKVxyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHByZXZUZXJtKCkge1xyXG4gICAgcmV0dXJuIG5ldyBTY2hvb2xUZXJtKHRoaXMudGVybSA9PT0gJ0FUJyA/XHJcbiAgICAgIHtcclxuICAgICAgICB0ZXJtOiAnU1QnLFxyXG4gICAgICAgIGFjYWRlbWljWWVhcjogYWRkWWVhcih0aGlzLmFjYWRlbWljWWVhciwgLTEpXHJcbiAgICAgIH0gOlxyXG4gICAgICB7XHJcbiAgICAgICAgdGVybTogJ0FUJyxcclxuICAgICAgICBhY2FkZW1pY1llYXI6IHRoaXMuYWNhZGVtaWNZZWFyXHJcbiAgICAgIH0pO1xyXG4gICAgXHJcbiAgfVxyXG5cclxuICB0b0xvY2FsZVN0cmluZyhpbnRsOiBJbmplY3RlZEludGwsIHNob3J0WWVhcj86IGJvb2xlYW4pIHtcclxuICAgIGxldCB5ZWFyID0gdGhpcy50ZXJtID09PSAnQVQnID9cclxuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVswXTpcclxuICAgICAgdGhpcy5hY2FkZW1pY1llYXIuc3BsaXQoJy8nKVsxXTtcclxuXHJcbiAgICBpZiAoc2hvcnRZZWFyKVxyXG4gICAgICB5ZWFyID0geWVhci5zdWJzdHIoMik7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMudGVybSA9PT0gJ0FUJyA/IGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3Rlcm1wbGFubmVyLnNlY29uZFRlcm0nLCBkZWZhdWx0TWVzc2FnZTonSFQge3llYXJ9J30sIHt5ZWFyOiB5ZWFyfSkgOiBcclxuICAgIGludGwuZm9ybWF0TWVzc2FnZSh7aWQ6J3Rlcm1wbGFubmVyLmZpcnN0VGVybScsIGRlZmF1bHRNZXNzYWdlOidWVCB7eWVhcn0nfSwge3llYXI6IHllYXJ9KTtcclxuICB9XHJcbn1cclxuIiwiXHJcbmV4cG9ydCBmdW5jdGlvbiBjYXBpdGFsaXplRmlyc3QgKHN0cikge1xyXG4gICAgZm9yIChsZXQgaT0wLCBsPXN0ci5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgaWYgKHN0ci5jaGFyQ29kZUF0KGkpIDwgMHgyMDAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdHIuc3Vic3RyKDAsIGkpICsgc3RyW2ldLnRvTG9jYWxlVXBwZXJDYXNlKCkgKyBzdHIuc3Vic3RyKGkgKyAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc3RyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKG9iaiwgZXh0ZW5zaW9uKSB7XHJcbiAgICBpZiAodHlwZW9mIGV4dGVuc2lvbiAhPT0gJ29iamVjdCcpIHJldHVybiBvYmo7XHJcbiAgICBPYmplY3Qua2V5cyhleHRlbnNpb24pLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBvYmpba2V5XSA9IGV4dGVuc2lvbltrZXldO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gb2JqO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xvbmU8VCxFPiAob2JqIDogVCwgZXh0ZW5zaW9uPzogRSkge1xyXG4gICAgbGV0IGNsb25lID0ge307XHJcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xvbmUsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSkpO1xyXG4gICAgfSk7XHJcbiAgICBpZiAoZXh0ZW5zaW9uKSBleHRlbmQoY2xvbmUsIGV4dGVuc2lvbik7XHJcbiAgICByZXR1cm4gY2xvbmUgYXMgKFQgJiBFKTtcclxufVxyXG5cclxuY29uc3QgY29uY2F0ID0gW10uY29uY2F0O1xyXG5leHBvcnQgZnVuY3Rpb24gZmxhdHRlbjxUPiAoYSA6IChUIHwgVFtdKVtdKSB7XHJcbiAgICByZXR1cm4gY29uY2F0LmFwcGx5KFtdLCBhKSBhcyBUW107XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlUHJvcDxUPihwcm9wOmtleW9mIFQpIHtcclxuICAgIHJldHVybiAoYTogVCxiOiBUKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYVByb3AgPSBhW3Byb3BdLCBiUHJvcCA9IGJbcHJvcF07XHJcbiAgICAgICAgcmV0dXJuIGFQcm9wID4gYlByb3AgPyAxIDogYVByb3AgPCBiUHJvcCA/IC0xIDogMDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVQcm9wcyhcclxuICAgIHByb3BzOiBzdHJpbmcgfCBzdHJpbmdbXSxcclxuICAgIGxvY2FsZXM/OiBzdHJpbmcgfCBzdHJpbmdbXSxcclxuICAgIG9wdGlvbnM/OiBJbnRsLkNvbGxhdG9yT3B0aW9ucyk6IChhOiBhbnksIGI6IGFueSkgPT4gbnVtYmVyXHJcbntcclxuICAgIHByb3BzID0gQXJyYXkuaXNBcnJheShwcm9wcykgPyBwcm9wcyA6IFtwcm9wc107XHJcblxyXG4gICAgY29uc3QgbG9jYWxlQ29tcGFyZSA9IChhLGIpID0+XHJcbiAgICAgICAgdHlwZW9mIGEgPT09ICdzdHJpbmcnID9cclxuICAgICAgICAgICAgYS5sb2NhbGVDb21wYXJlKGIsIGxvY2FsZXMsIG9wdGlvbnMpIDpcclxuICAgICAgICAgICAgYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDA7XHJcblxyXG4gICAgZnVuY3Rpb24gY21wUGFydCAoYSxiLGZpcnN0UGFydDogc3RyaW5nLHJlc3Q6IHN0cmluZ1tdKSB7XHJcbiAgICAgICAgY29uc3QgZmlyc3RBID0gYVtmaXJzdFBhcnRdO1xyXG4gICAgICAgIGlmIChmaXJzdEEgPT0gbnVsbCkgcmV0dXJuIC0xO1xyXG4gICAgICAgIGNvbnN0IGZpcnN0QiA9IGJbZmlyc3RQYXJ0XTtcclxuICAgICAgICBpZiAoZmlyc3RCID09IG51bGwpIHJldHVybiAxO1xyXG4gICAgICAgIHJldHVybiByZXN0Lmxlbmd0aCA9PT0gMCA/XHJcbiAgICAgICAgICAgIGxvY2FsZUNvbXBhcmUoZmlyc3RBLCBmaXJzdEIpIDpcclxuICAgICAgICAgICAgY21wUGFydChmaXJzdEEsIGZpcnN0QiwgcmVzdFswXSwgcmVzdC5zbGljZSgxKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHByb3BzXHJcbiAgICAgICAgLm1hcChwcm9wID0+IHByb3Auc3BsaXQoJy4nKSlcclxuICAgICAgICAubWFwKChbZmlyc3RQYXJ0LCAuLi5yZXN0XSkgPT4gKGEsYikgPT4gY21wUGFydChhLGIsIGZpcnN0UGFydCwgcmVzdCkpXHJcbiAgICAgICAgLnJlZHVjZSgoY21wMSwgY21wMikgPT5cclxuICAgICAgICAgICAgKGEsYikgPT4gY21wMShhLGIpIHx8IGNtcDIoYSxiKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBMKHRleHQsIC4uLmFyZ3MpIHtcclxuICAgIGxldCBmaXJzdCA9IHRleHRbMF07XHJcbiAgICByZXR1cm4gYnVpbGRNZXNzYWdlKHRleHQsIGFyZ3MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZE1lc3NhZ2UgKHRleHQsIGFyZ3MpIHtcclxuICAgIGxldCBydiA9IHRleHRbMF07XHJcbiAgICBmb3IgKGxldCBpPTEsIGw9dGV4dC5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgcnYgKz0gYXJnc1tpLTFdICsgdGV4dFtpXTtcclxuICAgIH1cclxuICAgIHJldHVybiBydjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRDPFQ+IHtcclxuICAgIGNvbnN0cnVjdG9yKHRlbXBsYXRlOiBUKSB7XHJcbiAgICAgICAgZXh0ZW5kKHRoaXMsIHRlbXBsYXRlKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVUaW1lUmV2aXZlciAoa2V5LCB2YWx1ZSkge1xyXG4gICAgdmFyIGE7XHJcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGEgPSAvXFwvRGF0ZVxcKChcXGQqKVxcKVxcLy8uZXhlYyh2YWx1ZSk7XHJcbiAgICAgICAgaWYgKGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKCthWzFdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbi8vbGV0IGluZm9TZXJpYWwgPSAxO1xyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0luZm8gKG1zZykge1xyXG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdpbmZvJywgeyAnZGV0YWlsJzogbXNnIH0pO1xyXG4gICAgd2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Vycm9yIChlcnJNc2c6IHN0cmluZyB8IEVycm9yKSB7XHJcbiAgICBjb25zdCBtc2cgPSB0eXBlb2YgZXJyTXNnID09PSAnc3RyaW5nJyA/IGVyck1zZyA6IGVyck1zZy5tZXNzYWdlO1xyXG4gICAgdmFyIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjdXN0b21lcnJvcicsIHsgJ2RldGFpbCc6IG1zZyB9KTtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyTXNnKTtcclxuICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG1heExlbmd0aChzdHI6IHN0cmluZywgbWF4TGVuOiBudW1iZXIpIHtcclxuICAgIHJldHVybiBzdHIubGVuZ3RoID4gbWF4TGVuID9cclxuICAgICAgICBzdHIuc3Vic3RyKDAsIG1heExlbiAtIDMpICsgXCIuLi5cIiA6XHJcbiAgICAgICAgc3RyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlUb0xvb2t1cDxUPihhOiBUW10sIGtleUFjY2Vzc29yOiAoaXRlbTogVCkgPT4gc3RyaW5nIHwgbnVtYmVyKSB7XHJcbiAgICBjb25zdCByZXN1bHQgOiB7W2tleTogc3RyaW5nXSA6IFRbXX0gPSB7fTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcclxuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcclxuICAgICAgICBsZXQgYXJyYXkgPSByZXN1bHRba2V5XTtcclxuICAgICAgICBpZiAoYXJyYXkpIGFycmF5LnB1c2goaXRlbSk7XHJcbiAgICAgICAgZWxzZSByZXN1bHRba2V5XSA9IFtpdGVtXTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcnJheVRvTWFwPFQ+KGE6IFRbXSwga2V5QWNjZXNzb3I6IChpdGVtOiBUKSA9PiBzdHJpbmcgfCBudW1iZXIpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA6IHtba2V5OiBzdHJpbmddIDogVH0gPSB7fTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1hLmxlbmd0aDsgaTxsOyArK2kpIHtcclxuICAgICAgICBjb25zdCBpdGVtID0gYVtpXTtcclxuICAgICAgICBjb25zdCBrZXkgPSBrZXlBY2Nlc3NvcihpdGVtKTtcclxuICAgICAgICByZXN1bHRba2V5XSA9IGl0ZW07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlcnJ5UGlja1Byb3BzPFQ+IChvYmo6IFQsIHByb3BzVG9QaWNrOiBzdHJpbmdbXSk6IFBhcnRpYWw8VD4ge1xyXG4gICAgY29uc3QgcmVzdWx0ID0ge307XHJcbiAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIHByb3BzVG9QaWNrKSB7XHJcbiAgICAgIGlmIChwYXJhbSBpbiBvYmopIHJlc3VsdFtwYXJhbV0gPSBvYmpbcGFyYW1dO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdCBhcyBQYXJ0aWFsPFQ+O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlzdGluY3Q8VD4gKGE6IFRbXSwga2V5QWNjZXNzb3I/OiAoaXRlbTogVCkgPT4gYW55KSB7XHJcbiAgICBjb25zdCBtYXAgPSBhcnJheVRvTWFwKGEsIGtleUFjY2Vzc29yIHx8ICh4ID0+IHgpKTtcclxuICAgIHJldHVybiBPYmplY3Qua2V5cyhtYXApLm1hcChrZXkgPT4gbWFwW2tleV0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hhbGxvd0VxdWFscyhhOiBhbnksIGI6IGFueSkge1xyXG4gICAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlO1xyXG4gICAgaWYgKCFhIHx8ICFiKSByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAodHlwZW9mIGEgIT09ICdvYmplY3QnIHx8IHR5cGVvZiBiICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xyXG4gICAgY29uc3Qga2V5c0EgPSBPYmplY3Qua2V5cyhhKTtcclxuICAgIGNvbnN0IGtleXNCID0gT2JqZWN0LmtleXMoYik7XHJcbiAgICBpZiAoa2V5c0EubGVuZ3RoICE9PSBrZXlzQi5sZW5ndGgpIHJldHVybiBmYWxzZTtcclxuICAgIGZvciAobGV0IGk9MCwgbD1rZXlzQS5sZW5ndGg7IGk8bDsgKytpKSB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0ga2V5c0FbaV07XHJcbiAgICAgICAgaWYgKGtleXNCW2ldICE9PSBrZXkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAoYVtrZXldICE9PSBiW2tleV0pIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbiIsImltcG9ydCBtb21lbnQsIHsgTW9tZW50IH0gZnJvbSBcIm1vbWVudFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEtFRFdlZWsgKHllYXI6IG51bWJlciwgd2VlazogbnVtYmVyKSB7XHJcbiAgY29uc3QgbSA9IG1vbWVudChuZXcgRGF0ZSh5ZWFyLCAxLCAxKSkud2Vlayh3ZWVrKTtcclxuICBjb25zdCByZXMgPSB7XHJcbiAgICB5ZWFyLFxyXG4gICAgd2VlayxcclxuICAgIG5vdEJlZm9yZTogbS5jbG9uZSgpLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoLTIsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgbm90QWZ0ZXI6IG0uY2xvbmUoKS5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJykudG9EYXRlKCkuZ2V0VGltZSgpXHJcbiAgfTtcclxuICByZXR1cm4gcmVzO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWRqdXN0ZWRXZWVrKG06IE1vbWVudCkge1xyXG4gIGNvbnN0IGNsb25lID0gbS5jbG9uZSgpO1xyXG4gIHJldHVybiBtLndlZWtkYXkoKSA+PSA1ID8gLy8gTMO2cmRhZyAwMDowMCAvIFPDtm5kYWcgMDA6MDA/XHJcbiAgICAgIG0ud2VlaygpICsgMSA6IC8vIFRpbGxow7ZyIG7DpHN0YSB2ZWNrYVxyXG4gICAgICBtLndlZWsoKTtcclxufVxyXG5cclxuLypleHBvcnQgZnVuY3Rpb24gZ2V0V2Vla0xpbWl0cyAobTogTW9tZW50KSB7XHJcbiAgY29uc3QgY2xvbmVkU3dlZGlzaCA9IG0uY2xvbmUoKS5sb2NhbGUoJ3N2Jyk7XHJcbiAgY29uc3QgbGltaXRzID0ge1xyXG4gICAgbm90QmVmb3JlOiBjbG9uZWRTd2VkaXNoLnN0YXJ0T2YoJ3dlZWsnKS5hZGQoLTIsICdkYXlzJyksXHJcbiAgICBub3RBZnRlcjogY2xvbmVkU3dlZGlzaC5zdGFydE9mKCd3ZWVrJykuYWRkKDUsICdkYXlzJylcclxuICB9O1xyXG59XHJcbiovXHJcbiIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIi8qIChpZ25vcmVkKSAqLyIsIm1vZHVsZS5leHBvcnRzID0galF1ZXJ5OyIsIm1vZHVsZS5leHBvcnRzID0gUmVhY3Q7IiwibW9kdWxlLmV4cG9ydHMgPSBSZWFjdERPTTsiXSwic291cmNlUm9vdCI6IiJ9